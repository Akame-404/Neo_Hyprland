"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[1313],{215342:(e,t,s)=>{s.d(t,{n:()=>o});s(667294);var n=s(11751),r=s(785893);function o(){return(0,r.jsx)(r.Fragment,{children:(0,n.t)({width:16,pointerEvents:"none"})})}},352823:(e,t,s)=>{s.d(t,{f:()=>h,h:()=>p});s(667294);var n=s(886628),r=s(724405),o=s(841892),i=s(11751),a=s(531701),l=s(521273),d=s(215342),c=s(152183),u=s(785893);function h(e){const{variant:t,style:s}=e;let r;return r=(0,n.VK)((()=>l.Z.shouldShowAssistantFace()),[])?(0,u.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,u.jsx)(c.P,{variant:t,shadowVariant:"light"})}):(0,u.jsx)(d.n,{}),(0,u.jsx)("div",{style:s,children:r})}function p(){const e=(0,n.VK)((()=>l.Z.shouldShowAssistantFace()),[]),t=(0,r.yK)((e=>({faceImgStyles:{width:20,height:20,background:e.assistantCornerButtonBackground,borderRadius:"50%",border:`1px solid ${e.tableDividerColor}`,marginRight:4},sparklesIconStyle:{width:16,height:16,fill:a.FN.light.purple[400],marginRight:4}})),[]);return e?(0,u.jsx)("img",{style:t.faceImgStyles,src:o.Z.images.assistantStaticTransparentFaceMiniPng,role:"presentation",alt:"Notion AI Face"}):(0,i.t)(t.sparklesIconStyle)}},922715:(e,t,s)=>{s.d(t,{Z:()=>i});s(667294);var n=s(800480),r=s(724405),o=(s(858047),s(785893));function i(){(0,n.O7)(),(0,r.yK)((e=>({container:{margin:"8px 16px",background:e.accentColors.yellow[100],borderRadius:8,height:"fit-content"}})),[]);return(0,o.jsx)(o.Fragment,{})}},193481:(e,t,s)=>{s.d(t,{Z:()=>w});var n=s(667294),r=s(800480),o=s(184747),i=s(886628),a=s(724405),l=s(569651),d=s(709291),c=s(401898),u=s(45257),h=s(897638),p=s(223196),g=s(41558),m=s(552275),f=s(203386),v=s(489728),x=s(953437),y=s(158297),S=s(83264),b=s(500255),C=s(975689),I=s(991642),M=s(608319),j=s(785893);const w=function(e){let{onChange:t,onMenuDismiss:s,showButtons:n,title:a,value:l,disabled:d,dateFormat:c,icon:u,mode:h,focused:p}=e;const m=(0,r.O7)(),f=(0,i.qz)(void 0,g.Z);(0,o.Z)((()=>{O({value:l},f)}));const{device:v}=m;return v.isMobile?(0,j.jsx)(K,{onChange:t,onMenuDismiss:s,showButtons:n,title:a,value:l,disabled:d,dateFormat:c,icon:u,mode:h,store:f}):(0,j.jsx)(N,{onChange:t,onMenuDismiss:s,showButtons:n,title:a,value:l,disabled:d,dateFormat:c,focused:p,icon:u,mode:h,store:f})};function k(e){const{device:t}=e;return t.isMobile?p.k.SlideUp:p.k.Popup}function P(e){return{buttonMenuItem:{color:e.mediumTextColor},activeMenuItem:{color:e.regularTextColor}}}function T(e){e.preventDefault&&e.preventDefault()}function R(e){e({starting:void 0,ending:void 0})}function F(e){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:12,paddingBottom:8},menuItemTitleDesktop:{width:"100%"},sectionMenuItem:{display:"flex"},summary:{display:"inline-flex"}}}function Z(e,t){t||e.setState({...e.state,isOpen:!0,focus:"starting"})}function B(e,t,s,n,r){const{temporaryDateRange:o}=s.state;h.zD(e)||(r||t(o),s.setState({...s.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),n&&n())}function O(e,t){if(!e.error)return t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}})}function L(e){let{disabled:t,icon:s,title:o,store:i}=e;const a=(0,r.O7)(),l=(0,n.useCallback)((()=>Z(i,t)),[i,t]),d=F(a);return(0,j.jsx)(m.Z,{disabled:t,focused:!1,icon:s(d.icon),title:o,onClick:l})}function A(e){let{disabled:t,title:s,value:o,dateFormat:i,onChange:a,store:c}=e;const u=(0,d.useIntl)(),p=(0,r.O7)(),g=(0,n.useCallback)((()=>Z(c,t)),[c,t]),m=F(p),f=(0,j.jsxs)("div",{style:m.summary,children:[(0,l.C)(m.iconActiveMobile),h._Q(o,u,i)]});return(0,j.jsx)(C.Z,{disabled:t,onClick:g,onClickClear:()=>R(a),label:s,title:f})}function D(e){let{disabled:t,value:s,dateFormat:o,focused:i,onChange:c,store:u}=e;const p=(0,d.useIntl)(),g=(0,a.Fg)(),f=(0,r.O7)(),v=(0,n.useCallback)((()=>Z(u,t)),[u,t]),x=F(f),y=P(g),S={...x.menuItem,...y.activeMenuItem},C=h._Q(s,p,o),I=(0,j.jsx)(b.Z,{onClick:()=>R(c),disabled:t});return(0,j.jsx)(m.Z,{focused:i,disabled:t,icon:(0,l.C)(x.iconActiveDesktop),title:C,right:I,isTokenTitle:!0,alignIconTop:!0,onClick:v,desktopTitleStyle:x.menuItemTitleDesktop,desktopIconStyle:x.iconActiveDesktopWrapper,style:S})}function E(e){let{disabled:t,title:s,icon:o,focused:i,mode:l,store:d}=e;const c=(0,a.Fg)(),u=(0,r.O7)(),h=(0,n.useCallback)((()=>Z(d,t)),[d,t]),p=F(u),g=P(c),f={...p.menuItem,...g.buttonMenuItem,...l===M.z.Pill?{width:"fit-content",border:"solid 1px",paddingLeft:0,paddingRight:0,borderRadius:20,fontSize:12}:{}};return(0,j.jsx)(m.Z,{focused:i,disabled:t,icon:o(p.icon),title:s,onClick:h,style:f})}function V(e){let{disabled:t,value:s,title:r,store:o}=e;const i=(0,n.useCallback)((()=>Z(o,t)),[o,t]);return(0,j.jsx)(u.Z,{on:Boolean(s.starting||s.ending),icon:(0,l.C)({width:16,marginRight:6,fill:"currentColor"}),title:(0,j.jsx)("span",{children:r}),onClick:i})}function q(e){let{onChange:t,onMenuDismiss:s,showButtons:r,title:o,value:a,store:l}=e;const c=(0,n.useCallback)((e=>B(e,t,l,s,r)),[t,l,s,r]),u=(0,n.useCallback)((e=>O(e,l)),[l]),h=(0,i.VK)((()=>function(e,t){const{temporaryDateRange:s}=t.state;return{...e,...s}}(a,l)),[l,a]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(S.Z,{title:o,value:h,onUpdate:u,store:l,onDismiss:c}),r&&(0,j.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",padding:"0px 10px"},children:[(0,j.jsx)(v.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:c,children:(0,j.jsx)(d.FormattedMessage,{defaultMessage:"Cancel",id:"searchDateFilter.cancelButton.label"})}),(0,j.jsx)(y.Z,{onClick:()=>t(l.state.temporaryDateRange),children:(0,j.jsx)(d.FormattedMessage,{defaultMessage:"Accept",id:"searchDateFilter.acceptButton.label"})})]})]})}function N(e){let{mode:t,onChange:s,onMenuDismiss:o,showButtons:a,title:l,value:d,disabled:u,dateFormat:h,focused:p,icon:g,store:m}=e;const v=(0,r.O7)(),y=(0,n.useCallback)((e=>B(e,s,m,o,a)),[s,m,o,a]),S=(0,n.useCallback)((()=>(0,j.jsx)(q,{onChange:s,onMenuDismiss:o,showButtons:a,title:l,value:d,store:m})),[s,o,a,l,d,m]),b=F(v),C=t===M.z.Section,w=C?l:void 0,P=t===M.z.Section?(0,j.jsx)(D,{disabled:u,value:d,dateFormat:h,focused:p,onChange:s,store:m}):t===M.z.Button?(0,j.jsx)(E,{disabled:u,title:l,icon:g,focused:p,mode:t,store:m}):t===M.z.Pill?(0,j.jsx)(V,{disabled:u,value:d,title:l,store:m}):void(0,c.t1)(t),R=(0,i.VK)((()=>m.state.isOpen),[m]);return(0,j.jsx)(I.Z,{title:w,marginAfter:C,children:(0,j.jsx)(f.Z,{debugName:"SearchDateFilter",capture:R,onUp:T,onDown:T,onEnter:T,children:(0,j.jsx)(x.ZP,{popupType:k(v),open:R,origin:P,render:S,onDismiss:y,placementToOrigin:x.ZP.Placement.Bottom,alignmentToOrigin:x.ZP.Alignment.Start,keepFocus:!0,style:b.popup})})})}function K(e){let{mode:t,onChange:s,onMenuDismiss:r,showButtons:o,title:a,value:l,disabled:d,dateFormat:c,icon:u,store:h}=e;const g=(0,i.VK)((()=>h.state.isOpen),[h]),m=(0,n.useCallback)((e=>B(e,s,h,r,o)),[s,h,r,o]),f=(0,n.useCallback)((()=>(0,j.jsx)(q,{onChange:s,onMenuDismiss:r,showButtons:o,title:a,value:l,store:h})),[s,r,o,a,l,h]),v=t===M.z.Section?(0,j.jsx)(A,{disabled:d,title:a,value:l,dateFormat:c,onChange:s,store:h}):(0,j.jsx)(L,{disabled:d,icon:u,title:a,store:h});return(0,j.jsx)(x.ZP,{popupType:p.k.SlideUp,open:g,origin:v,render:f,onDismiss:m,preventScaleTransition:!0})}},333991:(e,t,s)=>{s.r(t),s.d(t,{DEFAULT_MODAL_WIDTH_WITH_SIDE_PEEK:()=>ne,INACTIVE_TIMEOUT_MS:()=>Y,SearchCopyLinkSource:()=>se,SearchStaticContext:()=>ee,SearchStoresContext:()=>te,default:()=>oe,getSearchResultMetadata:()=>le});s(757658);var n=s(667294),r=s(883355),o=s(118466),i=s(701302),a=s(749085),l=s(815145),d=s(401800),c=s(512174),u=s(471924),h=s(915157),p=s(145366),g=s(494804),m=(s(76233),s(653965)),f=s(401898),v=s(619584),x=s(751787),y=s(247839),S=s(398730),b=s(240468),C=s(587531),I=s(81598),M=s(610358),j=(s(95477),s(510102)),w=s(843250),k=s(973744),P=(s(469988),s(798165)),T=(s(165598),s(259139)),R=s(897638),F=(s(195697),s(702688)),Z=s(966324),B=s(80444),O=s(521273),L=s(148168),A=s(833110),D=s(319385),E=s(832470),V=s(155320),q=s(492338),N=s(926249),K=s(629026);class _ extends a.default{getInitialState(){return{insertedActionResultsCount:0,localResults:void 0,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0,serverResultsAllLoaded:!1,errorState:H,selectedQueryResultQuery:void 0,timesToRender:new Map}}setState(e){const t={...this.instanceState};if(!(0,N.Z)(this.instanceState,t))return;const s=function(e){const{newState:t,priorState:s}=e,{localResults:n,serverError:r,serverResultsLoading:o,serverResults:i}=t,a=Boolean(n),l=o?void 0:r;if(!a&&o)return!s.errorState.isLoading&&s.errorState.showMajorError?s.errorState:{isLoading:o};if(a)return{hasLocalResults:a,serverError:l,isLoading:!1,showMajorError:!1};if(l)return{hasLocalResults:a,serverError:l,isLoading:!1,showMajorError:!0};if(0===(null==i?void 0:i.results.length))return{hasLocalResults:a,serverError:q.Ix.NoResults,isLoading:!1,showMajorError:!0};return{hasLocalResults:a,serverError:l,isLoading:!1,showMajorError:!1}}({newState:e,priorState:t});super.setState({...e,errorState:s})}getResultCount(){const{serverResults:e,localResults:t}=this.state,s=(null==e?void 0:e.total)??(null==t?void 0:t.total)??0,n=Boolean(e&&s>=100);return{count:s,isLowerBound:Boolean(e&&t&&s<K.Xv)||n}}}const H={showMajorError:!1,isLoading:!1,hasLocalResults:!1,serverError:void 0};const W=_;var U=s(530857),z=s(787956),$=s(88893),G=s(709019),Q=s(851739),X=s(140586),J=s(785893);const Y=120*v.C0,ee=n.createContext(null);ee.displayName="SearchStaticContext";const te=n.createContext(null);te.displayName="SearchStoresContext";let se=function(e){return e[e.SidePeekPanel=0]="SidePeekPanel",e[e.KeyboardShortcut=1]="KeyboardShortcut",e}({});const ne=755;class re extends r.Z{constructor(){super(...arguments),this.inactiveTimer=void 0,this.spaceId=void 0,this.isOpen=!1,this.shouldClearServerResultsOnQueryChange=!1,this.queryResultsSectionRef=n.createRef(),this.searchFilterMenuRef=n.createRef(),this.modalBodyMenuRef=n.createRef(),this.searchResultStore=new W,this.secondarySearchResultStore=new W,this.focusedIndexStore=a.default.createValue(void 0,{name:"focusedIndexStore"}),this.defaultBodyFocusedResultStore=a.default.createValue(void 0,{name:"defaultBodyFocusedResultStore"}),this.shouldShowAssistantResultStore=a.default.createValue(!1,{name:"shouldShowAssistantResultStore"}),this.getStaticContext=m.HP((()=>({queryResultsSectionRef:this.queryResultsSectionRef,searchFilterMenuRef:this.searchFilterMenuRef,modalBodyMenuRef:this.modalBodyMenuRef,handleSelectSearchResult:this.handleSelectSearchResult,handleCopySearchItemLink:this.handleCopySearchItemLink,handleQueryChange:he,handlePopupOpen:ce,handlePopupClose:ue,searchResultStore:this.searchResultStore,secondarySearchResultStore:this.secondarySearchResultStore,focusedIndexStore:this.focusedIndexStore,defaultBodyFocusedResultStore:this.defaultBodyFocusedResultStore,shouldShowAssistantResultStore:this.shouldShowAssistantResultStore,isQuickSearch:this.props.quickSearchMode}))),this.getStoresContext=m.HP((e=>({parentStore:e}))),this.renderContent=e=>{const t=this.currentModeStore.state,s=this.isPopupOpenStore.state,n=this.props.quickSearchMode?j.FP.commandSearch:this.environment.device.isMobile?this.props.renderAsPage?j.FP.mobileNative:j.FP.mobileSearch:j.FP.searchPane;return(0,J.jsx)(ee.Provider,{value:this.getStaticContext(),children:(0,J.jsx)(te.Provider,{value:this.getStoresContext(this.props.parentStore),children:(0,J.jsxs)(j.JU,{surface:n,children:[this.props.quickSearchMode&&!s&&(0,J.jsx)("div",{style:{position:"absolute",height:X.$,width:"100%"},className:w.pMC}),"search"===t?(0,J.jsx)(Q.$T,{renderAsPage:this.props.renderAsPage,quickSearchMode:this.props.quickSearchMode,searchContentPaneType:e,onClose:this.handleComponentClose}):(0,J.jsx)(I.LazySearchAssistantPane,{renderAsPage:this.props.renderAsPage,quickSearchMode:this.props.quickSearchMode,searchContentPaneType:e,onClose:this.handleComponentClose})]})})})},this.handleComponentOpenClose=()=>{const e=V.default.state.open||V.default.state.openAsPage;this.isOpen!==e&&(this.isOpen=e,(V.default.state.open||V.default.state.openAsPage)&&(clearTimeout(this.inactiveTimer),K.ZP.update((e=>({...e,hasScrolled:!1})))))},this.handleComponentClose=e=>{const{device:t}=this.environment,{selectedQueryResult:s,numKeystrokes:n,numServerRequests:r,numLocalRequests:o,hadMetaClick:i}=U.default.state,{serverEventProperties:a}=this.searchResultStore.state,{query:l,hasScrolled:d,mode:u}=K.ZP.state;if(n>0&&(r>0||o>0)&&!s&&!i&&(V.default.state.openAsPage||V.default.state.open)){const e=Date.now(),s=V.default.state.openedTimeMs,o=V.default.state.sessionId,i=e-s,c=U.default.state.firstKeyStrokeTimeMs;x.EH(this.environment,{...a,timeToAbandonMs:i,timeFromFirstKeyStrokeToAbandonMs:c?e-c:void 0,numKeystrokes:n,numResultsAboveFold:this.getNumResultsAboveFold(),searchSessionId:o,searchSessionFlowNumber:r,hasScrolled:d,numLocalResults:this.getNumLocalResults(),numTotalLocalResults:this.getNumTotalLocalResults(),numVisibleMembers:(0,$.qX)(),isMobile:t.isMobile}),C.X2({environment:this.environment,timeToAbandonMs:i,query:l.text})}"assistant"===u&&"keydown"===(null==e?void 0:e.type)?(K.ZP.switchToSearchPane(),y.quickSearchSetSearchAssistantMode(!1)):this.props.quickSearchMode?(V.default.closeAndResetMetricsState(),U.default.reset(),s&&!i&&this.resetState(),y.closeQuickSearch()):C.IB(this.environment),"assistant"===u&&L.N.setAssistantLastViewedTime(),""===l.text.trim()&&"assistant"!==u&&K.ZP.reset();const h=D.default.getEligibleGroup({experimentId:"search-shorten-inactive-timer",defaultGroup:"control"});let p=Y;"control"!==h&&c.g6["search-shorten-inactive-timer"].includes(h)&&(p=parseInt(h,10)*v.C0),this.inactiveTimer&&clearTimeout(this.inactiveTimer),p>0?this.inactiveTimer=window.setTimeout(this.resetState,p):this.resetState(),!this.props.renderAsPage&&t.isMobile&&Z.close(),U.default.reset()},this.handleVisibilityWillChange=(e,t,s,n)=>{if(!this.props.quickSearchMode)return;const r=F.ZP;if("stopQueueingSubscriptions"in r&&r.stopQueueingSubscriptions(this.environment),t){let e;e="tray-icon"===s?"quick-search-tray-icon":"shortcut"===s?"quick-search-shortcut":"debug-menu"===s?"quick-search-debug-menu":"quick-search",n&&O.Z.shouldShowSearchMenuItemAskAI(this.environment.device)?C.iN({environment:this.environment}):!0!==n&&C.L3(),C.UT({environment:this.environment,analyticsFrom:e,isQuickSearch:!0,renderAsPage:!0}),i.default.afterNextFlush((()=>y.quickSearchRenderCompleted()))}else this.handleComponentClose()},this.handlePotentialWebSearchAbandon=e=>{this.props.renderAsPage&&this.handleComponentClose()},this.constructSelectSearchItemContext=e=>{let{index:t,actionItemCount:s,context:n,selectedResult:r,allSearchResults:o,fromSidePeekPanel:i,sessionId:a,openedTimeMs:l}=e;const{serverEventProperties:d,store:c}=r,u=Date.now(),{numKeystrokes:h,hadMetaClick:g}=U.default.state,{firstKeyStrokeTimeMs:m}=U.default.state,{numServerRequests:f}=U.default.state,{query:v}=K.ZP.state;return{...d,context:n,queryStringLength:v.text.trim().length,numQueryTokens:p.wS(v.text.trim()).length,hasFilters:R.FN(v.filters),activeFilters:v.filters,selectedItemIndex:t.global-s,selectedItemLocalIndex:{section:t.local.section,index:t.local.indexLocal},numKeystrokes:h,fromSidePeekPanel:i,isSidePeekPanelOpen:K.ZP.state.isSidePeekPanelOpen,isSidebarOpen:K.ZP.isDebugSidebarOpen(),timeToSelectMs:u-l,timeFromFirstKeyStrokeToSelectMs:m?u-m:u-l,sources:null==r?void 0:r.sources,localSources:[...(null==r?void 0:r.localSource)??[]],hadMetaClick:g,numResultsAboveFold:this.getNumResultsAboveFold(),selectedSearchResultMetadata:le(r),selectedSearchResultContent:void 0,allSearchResultMetadata:null==o?void 0:o.slice(0,50).map((e=>le(e))),totalSearchResultCount:null==o?void 0:o.length,searchSessionId:a,searchSessionFlowNumber:f,originalPosition:null==r?void 0:r.originalPosition,numLocalResults:this.getNumLocalResults(),numTotalLocalResults:this.getNumTotalLocalResults(),numVisibleMembers:(0,$.qX)(),isMobile:this.environment.device.isMobile,timeToRenderResult:this.searchResultStore.state.timesToRender.get(c.id)}},this.handleSelectSearchResult=e=>{let{index:t,actionItemCount:s,event:n,context:r,selectedResult:o,allSearchResults:i,fromSidePeekPanel:a}=e;const{serverEventProperties:c,store:u}=o;if(!V.default.state.open&&!V.default.state.openAsPage)return;const h=k.DJ(n);"query_results"===r&&(U.default.update((e=>({...e,selectedQueryResult:!0}))),this.searchResultStore.update((e=>({...e,selectedQueryResultQuery:K.ZP.state.query}))));const{sessionId:p,openedTimeMs:m,isNewElectronTab:v}=V.default.state,{tabs:S}=A.Z.state,{numServerRequests:C}=U.default.state;x.nL(this.environment,{...this.constructSelectSearchItemContext({index:t,actionItemCount:s,context:r,selectedResult:o,allSearchResults:i,fromSidePeekPanel:a,sessionId:p,openedTimeMs:m}),isMetaClick:Boolean(h)});const I=(null==c?void 0:c["server-queryId"])??(0,g.A7)({searchSessionId:p,searchSessionFlowNumber:C});let M;"recent_pages"===r?M=l.tY.SearchRecents:"query_results"===r?M=l.tY.SearchQuery:"tabs"===r||"new_page"===r?M=l.tY.SearchTabs:(0,f.t1)(r);if(this.environment.device.isElectron&&this.props.quickSearchMode){const e=(0,d.Z)({pageModel:o.store.getModel(),pageId:o.store.id,scrollToBlockId:(0,R.dy)(o),pageVisitSource:M,queryId:I});y.openQuickSearchResult(e)}else b.PR({searchResult:o,environment:this.environment,pageVisitSource:M,queryId:I,openInNew:h,openInSidePeek:false,electronTabSearch:{tabs:S,isNewTab:Boolean(v)},context:r});z.Z.setState({queryId:I,pageId:u.id,timeEntered:new Date}),h?U.default.update((e=>({...e,hadMetaClick:!0}))):this.handleComponentClose()},this.handleCopySearchItemLink=e=>{let{index:t,actionItemCount:s,context:n,selectedResult:r,allSearchResults:o,fromSidePeekPanel:i,source:a}=e;if(!V.default.state.open&&!V.default.state.openAsPage)return;const{sessionId:l,openedTimeMs:d}=V.default.state;x.sb(this.environment,{...this.constructSelectSearchItemContext({index:t,actionItemCount:s,context:n,selectedResult:r,allSearchResults:o,fromSidePeekPanel:i,sessionId:l,openedTimeMs:d}),source:a})},this.getNumResultsAboveFold=()=>R.MQ({environment:this.environment,searchResultsSection:this.queryResultsSectionRef.current,modalBodyMenu:this.modalBodyMenuRef.current,searchFilterMenu:this.searchFilterMenuRef.current,actionItemCount:this.shouldShowAssistantResultStore.state?1:0}),this.getNumLocalResults=()=>{var e;return(null===(e=this.searchResultStore.state.localResults)||void 0===e?void 0:e.results.length)??0},this.getNumTotalLocalResults=()=>{var e;return(null===(e=this.searchResultStore.state.localResults)||void 0===e?void 0:e.total)??0},this.handleSpaceChange=()=>{const e=B.default.state.currentSpaceStore&&B.default.state.currentSpaceStore.id;this.spaceId!==e&&(this.spaceId=e,this.resetStateWhenSpaceChange(),S.S(this.environment),this.spaceId&&B.default.state.currentUserStore&&this.props.quickSearchMode&&y.quickSearchReady())},this.resetState=()=>{K.ZP.reset(),this.searchResultStore.reset(),this.secondarySearchResultStore.reset(),U.default.reset(),this.props.quickSearchMode?(V.default.closeAndResetMetricsState(),(0,M.clearActiveAssistantSession)({environment:this.environment})):V.default.reset()},this.resetStateWhenSpaceChange=()=>{K.ZP.reset(),this.searchResultStore.reset(),this.secondarySearchResultStore.reset(),this.props.quickSearchMode||(V.default.reset(),U.default.reset())},this.currentModeStore=this.createComputedStore((()=>K.ZP.state.mode)),this.isPopupOpenStore=this.createComputedStore((()=>K.ZP.state.isPopupOpen))}UNSAFE_willMount(e){var t;this.spaceId=null===(t=B.default.state.currentSpaceStore)||void 0===t?void 0:t.id,(0,E.lO)(),B.default.state.currentSpaceStore&&B.default.state.currentUserStore&&e.quickSearchMode&&y.quickSearchReady()}UNSAFE_willMountOrUpdate(e){if(e.renderAsPage&&!e.quickSearchMode&&!V.default.state.sessionId){const e=u.Il();V.default.update((t=>({...t,open:!1,openAsPage:!0,openedTimeMs:Date.now(),sessionId:e}))),x.wF(this.environment,{from:"nativeTab-search-direct-link",searchSessionId:e})}}didMount(){B.default.addListener(this.handleSpaceChange),V.default.addListener(pe),this.props.renderAsPage&&!this.props.quickSearchMode||V.default.addListener(this.handleComponentOpenClose),this.props.quickSearchMode?y.quickSearchVisibilityState.addListener(this.handleVisibilityWillChange):(y.openSearchModalFromQuickSearch.addListener((()=>ge(this.environment,!1))),y.openNotionAiFromQuickSearch.addListener((()=>{"chat"!==this.environment.RouterStore.state.route.name&&ge(this.environment,!0)}))),b.TT.addListener(this.handlePotentialWebSearchAbandon),y.openSearchModalForNewTab.addListener((()=>{C.UT({environment:this.environment,isNewElectronTab:!0,analyticsFrom:"new-tab"})}))}willUnmount(){this.resetState(),this.props.renderAsPage&&!this.props.quickSearchMode||(V.default.removeListener(this.handleComponentOpenClose),y.openSearchModalFromQuickSearch.removeListener((()=>ge(this.environment,!1))),y.openNotionAiFromQuickSearch.removeListener((()=>ge(this.environment,!0)))),this.props.quickSearchMode&&y.quickSearchVisibilityState.removeListener(this.handleVisibilityWillChange),b.TT.removeListener(this.handlePotentialWebSearchAbandon),B.default.removeListener(this.handleSpaceChange),V.default.removeListener(pe),y.openSearchModalForNewTab.removeListener((()=>{V.default.update((e=>({...e,isNewElectronTab:void 0})))})),this.inactiveTimer&&(clearTimeout(this.inactiveTimer),this.inactiveTimer=void 0)}renderComponent(){const e=Boolean(K.ZP.state.query.text.trim())||R.VA(K.ZP.state.query.filters)?"search_results":"default_body";if(this.props.renderAsPage)return this.renderContent(e);const{device:t,mobileNative:s}=this.environment,n=Boolean(V.default.state.open);return(0,J.jsx)(G.Z,{open:n,onDismiss:this.handleComponentClose,modalStyle:de(e,this.props.renderAsPage,this.environment,this.theme),disableAnimation:!t.isMobile||(null==s?void 0:s.supportsNativeHomeOnPhone())||!1,renderContent:()=>this.renderContent(e)})}}re.displayName="Search";const oe=re;function ie(e){return R.bC(e)}function ae(e){const t=(0,E.gq)({device:e.device}),s=(0,Q.X1)({device:e.device,isPublicAccessPermissionForPage:ie(e).hasPublicAccessPermission});if(t)return"90vw";if((0,T.rd)(e))return ne;let n=660;return s&&(n+=250),n}function le(e){const{store:t,highlight:s,sources:n,localSource:r}=e;return o.Z.withListenerIgnored((()=>{var o,i,a,l,d;return{blockId:t.id,blockType:t.getType(),lowestNavigableAncestorId:null===(o=t.getNavigableBlockStore())||void 0===o?void 0:o.id,depth:P.qA(t).length,matchesText:Boolean(null==s?void 0:s.text),matchesPathText:Boolean((null==s?void 0:s.pathText)||(null==s?void 0:s.title)),matchesTitle:Boolean(null==s?void 0:s.title),isNavigable:t.isNavigableBlock(),lastEditedTime:t.getLastEditedTime(),isTeamArchived:null===(i=(0,P.VP)(t))||void 0===i?void 0:i.isArchived(),sources:n,localSource:[...r??[]],badges:(null===(a=e.badges)||void 0===a?void 0:a.map((e=>e.type)))??[],isCollectionPropertyMatch:void 0!==(null===(l=e.matchedCollectionProperties)||void 0===l?void 0:l.collectionText),isCollectionPropertyHighlight:void 0!==(null===(d=e.highlight)||void 0===d?void 0:d.collectionText),featureGroups:e.featureGroups}}))}function de(e,t,s,n){const r=(0,Q.ip)({searchContentPaneType:e,renderAsPage:t,environment:s});return{width:"100%",minHeight:r.minHeight,maxHeight:r.maxHeight,transform:"translate3d(0,0,0)",background:n.popoverBackground,maxWidth:ae(s),borderRadius:12}}function ce(){K.ZP.setIsAnyPopupOpen(!0)}function ue(){K.ZP.setIsAnyPopupOpen(!1)}function he(e){""!==e?(U.default.update((e=>({...e,numKeystrokes:e.numKeystrokes+1}))),K.ZP.updateQueryText(e)):K.ZP.resetQuery({resetFilters:!1})}function pe(){var e;const t=null===(e=B.default.state.currentUserStore)||void 0===e?void 0:e.id;t&&h.Z.set({userId:t,key:g.Y6,value:V.default.state.preferSidePeekOpen})}function ge(e,t){t&&K.ZP.update((e=>({...e,mode:"assistant"}))),C.UT({environment:e,analyticsFrom:"keyboard-shortcut-quick-search-hotkey",isQuickSearch:!1,renderAsPage:!1})}},940465:(e,t,s)=>{s.d(t,{Z:()=>v});var n=s(294184),r=s.n(n),o=s(667294),i=s(724405),a=s(908597),l=s(775e3),d=s(552275),c=s(828992),u=s(863296),h=s(164369),p=s(785893);function g(e,t){const{inline:s,title:n,focused:o,className:l,blueOutlineFocused:h,compact:g,shouldShowArrowUp:v}=e,{icon:x,...y}=e,S=(0,i.yK)((e=>({hoveredStyle:{background:e.buttonHoveredBackground}})),[]),b=(0,i.yK)((e=>({style:{minHeight:36,paddingTop:8,paddingBottom:8,width:g?"min-content":"100%",display:"flex",...h?{boxShadow:e.focusedShadow,borderRadius:6}:{}},textWrapper:{marginLeft:4,alignItems:void 0,flex:void 0,display:"block",textOverflow:"ellipsis",...s&&{alignItems:"baseline"}},icon:{display:"block",flexShrink:0,height:18,width:18,color:e.mediumTextColor,overflow:"visible",marginRight:6},enterIcon:{height:12,width:12,fill:e.mediumIconColor},iconContainer:{overflow:"visible"},compactButtonHover:{background:e.buttonHoveredBackground},compactButton:{borderRadius:44,marginLeft:10,marginRight:10,padding:"6px 12px",display:"inline-flex",boxShadow:h?e.focusedShadow:void 0,maxWidth:"calc(100% - 20px)"},menuItem:{overflow:"hidden"},menuItemTextWrapper:{marginLeft:0,marginRight:0},right:{marginLeft:o?8:void 0,marginRight:2}})),[s,h,o,g]),C={title:n,icon:x?m(x,b.icon,b.iconContainer):void 0,style:b.style,textWrapperStyle:b.textWrapper,right:v?(0,a.Z)(b.enterIcon):f(o,b.enterIcon),className:r()("notranslate",l),buttonStyle:{paddingLeft:2,width:g?"min-content":void 0},hoveredStyle:S.hoveredStyle};return g?(0,p.jsx)(u.Z,{style:b.compactButton,icon:e=>C.icon,...y,ref:t,hoveredStyle:b.compactButtonHover,children:(0,p.jsx)(c.Z,{title:(0,p.jsx)("div",{style:b.menuItem,children:n}),textWrapperStyle:b.menuItemTextWrapper,style:b.menuItem,allowTextSelection:void 0,right:o?C.right:void 0,rightStyle:b.right})}):(0,p.jsx)(d.Z,{...y,...C,disableTransition:!0,ignoreLocalHoverState:!0,ref:t})}function m(e,t,s){return(0,p.jsx)(h.Z,{style:s,children:e(t)})}function f(e,t){const s={...t,opacity:e?1:0};return(0,p.jsx)("div",{style:{display:"flex"},children:(0,l.U)(s)})}const v=o.forwardRef(g)},851739:(e,t,s)=>{s.d(t,{$T:()=>ur,ip:()=>pr,X1:()=>vr});var n=s(667294),r=s(800480),o=s(886628),i=s(724405),a=s(815145),l=s(380503),d=s(653965),c=s(937850),u=s(800893),h=s(398730),p=s(843250),g=s(484210),m=s(460709),f=s(259139),v=s(897638),x=s(982063),y=s(905162),S=s(80444),b=s(788632),C=s(869454),I=s(832470),M=s(155320),j=s(629026),w=s(436488),k=s(256940),P=s(203386),T=s(478140),R=s(840721),F=s(483785),Z=s(922715),B=s(333991),O=s(973935),L=s(512174),A=s(967220),D=s(569651),E=s(964275),V=s(206637),q=s(660291),N=s(937612),K=s(983303),_=s(153772),H=s(709291),W=s(401898),U=s(137810),z=s(95477),$=s(934700),G=s(195697),Q=s(61766),X=s(319385),J=s(623063),Y=s(164921),ee=s(552275),te=s(231945),se=s(260458),ne=s(489728),re=s(672495),oe=s(193481),ie=s(776619),ae=s(983890),le=s(813993),de=s(45257),ce=s(886825),ue=s(975689),he=s(991642),pe=s(608319),ge=s(785893);const me=function(e){let{title:t,value:s,disabled:n,icon:o,style:i,onChange:a,focused:l,mode:d}=e;const c=(0,r.O7)(),{device:u}=c;return u.isMobile?(0,ge.jsx)(Se,{title:t,value:s,disabled:n,icon:o,style:i,onChange:a,focused:l,mode:d}):(0,ge.jsx)(ye,{title:t,icon:o,value:s,style:i,onChange:a,focused:l,mode:d})};function fe(e,t){t(!e)}function ve(e){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"},pillIcon:{height:16,width:16,fill:"currentColor",marginRight:6},sectionMenuItem:{display:"flex"}}}function xe(e){let{mode:t,title:s,icon:n,value:o,style:a,onChange:l,focused:d}=e;const c=(0,i.Fg)(),u=ve((0,r.O7)()),h=function(e){return{menuItem:{color:e.mediumTextColor}}}(c),p={...u.menuItem,...h.menuItem,...a};return t===pe.z.Pill?(0,ge.jsx)(de.Z,{on:o,hideChevron:!0,title:(0,ge.jsx)("span",{children:s}),onClick:()=>fe(o,l),icon:n(u.pillIcon)}):(0,ge.jsx)(ce.Z,{title:s,icon:n(u.icon),on:o,onClick:()=>fe(o,l),style:p,focused:d})}function ye(e){let{mode:t,title:s,icon:n,value:o,style:i,onChange:a,focused:l}=e;const d=(0,r.O7)();return(0,ge.jsx)(he.Z,{marginAfter:!1,style:ve(d).sectionMenuItem,children:(0,ge.jsx)(xe,{title:s,icon:n,value:o,style:i,onChange:a,mode:t,focused:l})})}function Se(e){let{mode:t,title:s,value:n,disabled:r,icon:o,style:i,onChange:a,focused:l}=e;return t===pe.z.Button?(0,ge.jsx)(xe,{title:s,icon:o,value:n,style:i,onChange:a,mode:t,focused:l}):(0,ge.jsx)(ue.Z,{disabled:r,onClick:()=>fe(n,a),label:s,isToggle:!0,isToggleActive:n})}var be=s(542853),Ce=s(531701),Ie=s(632163);function Me(e){const t=(0,r.Fy)();return(0,ge.jsx)(te.ZP,{popupType:t.isMobile?te.Z4.SlideUp:te.Z4.Popup,renderOrigin:t=>(0,ge.jsx)(we,{events:t,...e}),render:t=>(0,ge.jsx)(je,{parent:t,...e})})}function je(e){let{parent:t,experiment:s,onChange:n}=e;const o=(0,r.Fy)(),a=(0,i.yK)((()=>({menuOptionStyle:{color:Ce.ZP.mediumTextColor}})),[]);let l;l=o.isMobile?{menuType:m.og.Modal,title:s.experimentId,right:(0,ge.jsx)(H.FormattedMessage,{defaultMessage:"Done",id:"appearanceSettings.modal.done"}),onClickRight:t.close}:{menuType:m.og.Popup,width:250};const d=s.groups.map((e=>({key:e,action:r=>{n({experimentId:s.experimentId,group:e}),t.close()},render:(t,s)=>(0,ge.jsx)(ee.Z,{...t,title:e,style:a.menuOptionStyle})})));return(0,ge.jsx)(T.Z,{...l,children:(0,ge.jsx)(Ie.Z,{type:Ie.i.Vertical,initialFocus:void 0,sections:[{key:s.experimentId,render:e=>(0,ge.jsx)(re.Z,{...e}),items:d}]})})}function we(e){let{experiment:t,events:s,searchExperimentOverrides:r}=e;const o=(0,i.yK)((e=>({experimentGroupButtonChevronStyle:{width:10,fill:e.lightIconColor},experimentGroupButtonStyle:{overflowX:"hidden",justifyContent:"left",overflow:"hidden",marginLeft:6,color:e.mediumTextColor},rowContainer:{display:"flex",overflow:"hidden",flexDirection:"row"},groupCell:{overflow:"hidden",marginRight:4}})),[]);return(0,n.createElement)(ne.Z,{...s,isSmall:!0,key:t.experimentId,style:o.experimentGroupButtonStyle},(0,ge.jsxs)("div",{style:o.rowContainer,children:[(0,ge.jsx)("div",{style:o.groupCell,children:r[t.experimentId]||t.group}),(0,ge.jsx)("div",{children:(0,be.i)(o.experimentGroupButtonChevronStyle)})]}))}function ke(e){return{fontSize:14,lineHeight:1.2,color:e.mediumTextColor,marginRight:4,display:"flex",alignItems:"center",whiteSpace:"nowrap"}}const Pe=function(e){const{experiment:t}=e,{leftOverrides:s,rightOverrides:r,experimentDiffers:a,experimentAgreesButNondefault:l}=(0,o.VK)((()=>{const e=I.v_.state.searchExperimentOverrides,s=I.BJ.state.searchExperimentOverrides,n=(e[t.experimentId]??t.group)!==(s[t.experimentId]??t.group);return{leftOverrides:e,rightOverrides:s,experimentDiffers:n,experimentAgreesButNondefault:!n&&void 0!==s[t.experimentId]&&e[t.experimentId]!==t.group}}),[t]),d=(0,i.yK)((e=>({rowContainer:{backgroundColor:a?e.equationErrorPlaceholderBackground:l?e.accentColors.yellow[100]:void 0},titleCell:{...ke(e),maxWidth:180,textOverflow:"ellipsis",overflow:"hidden"}})),[l,a]),c=(0,n.useCallback)((e=>{const{experimentId:t,group:s,store:n}=e;n.setState({...n.state,searchExperimentOverrides:{...n.state.searchExperimentOverrides,[t]:s}})}),[]);return(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsx)("div",{style:{...d.titleCell,...d.rowContainer},children:t.experimentId.replace("search-","")}),(0,ge.jsx)("div",{style:d.rowContainer,children:(0,ge.jsx)(Me,{experiment:t,searchExperimentOverrides:s,onChange:e=>{c({...e,store:I.v_})}})}),(0,ge.jsx)("div",{style:d.rowContainer,children:(0,ge.jsx)(Me,{experiment:t,searchExperimentOverrides:r,onChange:e=>{c({...e,store:I.BJ})}})})]})};var Te=s(253877),Re=s(842875),Fe=s(222686),Ze=s(90028);let Be=function(e){return e[e.Button=0]="Button",e[e.MenuItem=1]="MenuItem",e}({});function Oe(e){let{mode:t,icon:s,title:n,filter:r,isLastInSection:o,onMenuDismiss:i,focused:a}=e;return t===Be.Button?(0,ge.jsx)(He,{icon:s,title:n,filter:r,isLastInSection:o,onMenuDismiss:i}):t===Be.MenuItem?(0,ge.jsx)(We,{icon:s,title:n,filter:r,focused:a,isLastInSection:o,onMenuDismiss:i}):void(0,W.t1)(t)}function Le(e){const t=(0,o.VK)((()=>Ee()),[]);return t?(0,ge.jsx)(Oe,{icon:Ze.j,title:(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.quickFilters.inCurrentPage",defaultMessage:"In current page"}),filter:t,...e}):null}function Ae(e){const t=qe((0,r.O7)());return t?(0,ge.jsx)(Oe,{icon:Fe.f,title:(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.quickFilters.createdByMe",defaultMessage:"Created by me"}),filter:t,...e}):null}function De(e){const t=Ve();return t?(0,ge.jsx)(Oe,{icon:D.C,title:(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.quickFilters.editedLastWeek",defaultMessage:"Edited last week"}),filter:t,...e}):null}function Ee(){const{mainEditorCurrentBlockStore:e}=S.default.state;if(e&&e.id)return{ancestors:[e.id]}}function Ve(){return{lastEditedTime:{starting:Te.Oo((0,Re.r)()),ending:Te.Lg((0,Re.r)())}}}function qe(e){const{id:t}=e.currentUser;if(t)return{createdBy:[t]}}function Ne(e,t,s){const{device:n}=t;return{menuItem:{color:n.isDesktop?s.mediumTextColor:void 0,...e&&{boxShadow:void 0}},buttonFilter:{color:s.mediumTextColor}}}function Ke(e,t){!function(e){j.ZP.updateFilters(e)}(e),j.ZP.isDebugSidebarOpen()||j.ZP.setState({...j.ZP.state,isDebugSidebarOpen:!0}),t&&t()}function _e(e){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},buttonFilter:{padding:"4px 8px",display:"flex",alignItems:"center",overflow:"hidden"},buttonText:{...U.Z.textOverflowStyle},icon:{display:"inline-block",height:14,width:14,fill:"currentColor"},buttonIcon:{marginRight:6}}}function He(e){let{icon:t,title:s,filter:n,isLastInSection:o,onMenuDismiss:a}=e;const l=(0,i.Fg)(),d=(0,r.O7)(),c=_e(d),u=Ne(o,d,l);return(0,ge.jsxs)(Y.Z,{style:{...c.buttonFilter,...u.buttonFilter},onClick:()=>Ke(n,a),children:[t&&t({...c.icon,...c.buttonIcon}),(0,ge.jsx)("span",{style:c.buttonText,children:s})]})}function We(e){let{icon:t,title:s,filter:n,focused:o,isLastInSection:a,onMenuDismiss:l}=e;const d=(0,i.Fg)(),c=(0,r.O7)(),u=_e(c),h=Ne(a,c,d),p={...u.menuItem,...h.menuItem};return(0,ge.jsx)(ee.Z,{icon:t&&t(u.icon),focused:o,title:s,onClick:()=>Ke(n,l),style:p})}var Ue=s(301743),ze=s(374194);function $e(e){const{leftValue:t,rightValue:s,setLeftValue:r,setRightValue:o,placeholder:a,label:l}=e,{titleCell:d,rightTitleCell:c,leftTitleCell:u}=(0,i.yK)((e=>{const n=ke(e);return{titleCell:n,rightTitleCell:{...n,color:s?n.color:e.lightTextColor,width:"95%"},leftTitleCell:{...n,color:t?n.color:e.lightTextColor,width:"95%"}}}),[t,s]),[h,p]=(0,n.useState)(s),[g,m]=(0,n.useState)(t);(0,n.useEffect)((()=>{void 0===s&&p(void 0),void 0===t&&m(void 0)}),[s,t]);const f=(0,n.useCallback)((()=>{o(h)}),[o,h]),v=(0,n.useCallback)((()=>{r(g)}),[r,g]),x=(0,n.useCallback)((e=>{p(e.target.value)}),[]),y=(0,n.useCallback)((e=>{m(e.target.value)}),[]);return(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsx)("div",{style:d,children:l}),(0,ge.jsxs)(Ue.Z,{debugName:"SearchStringOverrideControls",capture:!0,allowMenuList:!1,children:[(0,ge.jsx)(ze.Z,{style:u,onBlur:v,value:g,onChange:y,placeholder:a}),(0,ge.jsx)(ze.Z,{style:c,onBlur:f,value:h,onChange:x,placeholder:a})]})]})}let Ge=function(e){return e.Button="Button",e.Section="Section",e}({});function Qe(e,t){let{isMobile:s,mode:r}=e;const i=(0,o.qz)(void 0,Q.Z),a=(0,o.VK)((()=>(0,W.qP)(L.g6).map((e=>{let[t,s]=e;return{experimentId:t,experimentVersion:1,group:X.default.getGroup(t),groups:["control",...s]}}))),[]),l=(0,n.useRef)(null),d=(0,n.useRef)(null);return(0,n.useImperativeHandle)(t,(()=>({getClientHeight:()=>{if(null!==l.current){const e=l.current.getAnchor(),t=O.findDOMNode(e);return(null==t?void 0:t.clientHeight)??0}return null!==d.current?d.current.clientHeight:0}}))),s?r===Ge.Button?(0,ge.jsx)(It,{ref:l,isMobile:s,buttonPopupStore:i}):r===Ge.Section?(0,ge.jsx)(Ct,{ref:d,buttonPopupStore:i}):void(0,W.t1)(r):(0,ge.jsx)(St,{ref:d,isMobile:s,searchExperimentsToToggle:a})}function Xe(e){let{columnStore:t}=e;const s=(0,o.VK)((()=>t.state.visible),[t]);return(0,ge.jsx)(ee.Z,{icon:(0,ge.jsx)(se.Z,{checked:s,size:14,onClick:()=>t.update((e=>({...e,visible:!e.visible})))}),focused:!1,title:"Show",onClick:()=>t.update((e=>({...e,visible:!e.visible})))})}function Je(e){let{title:t,searchExperimentOverrides:s}=e;return(0,ge.jsx)(ee.Z,{focused:!1,title:t,onClick:()=>{I.BJ.update((e=>({...e,visible:!1}))),I.v_.update((e=>({...e,searchExperimentOverrides:s})))}})}const Ye=n.forwardRef(Qe);function et(e){return t=>j.ZP.updateFilters({[e]:t})}function tt(){return null}function st(){const e=(0,o.VK)((()=>I.ZP.state.showDebugInfo),[]);return(0,ge.jsx)(me,{mode:pe.z.Button,focused:!1,title:"Show debug info",icon:A.S,value:e,onChange:e=>{I.ZP.setState({...I.ZP.state,showDebugInfo:Boolean(e)})}})}function nt(){const e=(0,o.VK)((()=>"everything"===I.ZP.state.debug),[]);return(0,ge.jsx)(me,{mode:pe.z.Button,focused:!1,title:"Profile query",icon:A.S,value:e,onChange:e=>{I.ZP.setState({...I.ZP.state,debug:e?"everything":void 0})}})}function rt(e){let{mode:t}=e;const s=(0,o.VK)((()=>j.ZP.state.query.filters),[]);return(0,ge.jsx)(me,{mode:t,focused:!1,title:(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.deletedOnlyToggle.label",defaultMessage:"Deleted only"}),icon:N.y,value:s.isDeletedOnly||!1,onChange:et("isDeletedOnly")})}function ot(){return(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFiltersSection.title",defaultMessage:"More filters"})}function it(e){j.ZP.updateFilters({navigableBlockContentOnly:e})}function at(){j.ZP.update((e=>({...e,isDebugSidebarOpen:!1})))}function lt(e){let{mode:t}=e;const{filters:s}=(0,o.VK)((()=>j.ZP.state.query),[]);return(0,ge.jsx)(me,{mode:t,focused:!1,title:(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Title only"}),icon:K.c,value:s.navigableBlockContentOnly||!1,onChange:it})}function dt(e){return{sidebar:{paddingTop:12,paddingBottom:24,overflowY:"auto",overflowX:"hidden",flex:"0 0 250px",minHeight:400},sidebarHidden:{display:"none"},addFilterButtonMobile:{fontSize:e?U.Z.fontSize.UISmall.mobile:U.Z.fontSize.UISmall.desktop,fontWeight:U.Z.fontWeight.medium,marginRight:-8}}}function ct(e){const{isMobile:t}=e,s=dt(t);return(0,ge.jsx)(ne.Z,{...e,style:s.addFilterButtonMobile,icon:V.I,isBlue:!0,children:(0,ge.jsx)(H.FormattedMessage,{defaultMessage:"Add filter",id:"search.addFilter.button.label"})})}function ut(e){e.setState({...e.state,open:!1})}function ht(e){let{buttonPopupStore:t}=e;const s=(0,r.O7)(),i=(0,n.useCallback)((()=>ut(t)),[t]),{filters:a}=(0,o.VK)((()=>j.ZP.state.query),[]),l=function(e,t){const s=qe(e);if(!s)return!1;if(!s.createdBy)return!1;const n=s.createdBy[0];return-1!==t.createdBy.indexOf(n)}(s,a),c=function(e){const{lastEditedTime:t}=Ve();return d.Xy(t,e.lastEditedTime)}(a),u=(0,o.VK)((()=>function(e){const t=Ee();if(!t)return!1;if(!t.ancestors)return!1;const s=t.ancestors[0];return-1!==e.ancestors.indexOf(s)}(a)),[a]);return l&&c&&u?null:(0,ge.jsxs)(he.Z,{title:(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.quickFiltersSection.title",defaultMessage:"Quick filters"}),marginAfter:!0,children:[!l&&(0,ge.jsx)(Ae,{mode:Be.MenuItem,focused:!1,onMenuDismiss:i}),!c&&(0,ge.jsx)(De,{mode:Be.MenuItem,focused:!1,onMenuDismiss:i}),!u&&(0,ge.jsx)(Le,{mode:Be.MenuItem,focused:!1,onMenuDismiss:i,isLastInSection:!0})]})}function pt(e){let{searchExperimentsToToggle:t}=e;return(0,_.x)(z.default)?(0,ge.jsx)(he.Z,{title:"Dev Tools",children:(0,ge.jsx)(J.Z,{isVisible:!0,animationStyle:{height:"100%"},render:()=>(0,ge.jsxs)("div",{style:{overflow:"scroll"},children:[(0,ge.jsx)(st,{}),(0,ge.jsx)(nt,{}),(0,ge.jsx)(tt,{}),(0,ge.jsxs)(he.Z,{style:{marginTop:16},title:"Quick Switch",children:[(0,ge.jsx)(Je,{title:"No local at all",searchExperimentOverrides:{"search-no-local-blending":"on","search-debug-only-no-recent-boosting":"on"}}),(0,ge.jsx)(Je,{title:"No local results",searchExperimentOverrides:{"search-no-local-blending":"on"}}),(0,ge.jsx)(Je,{title:"No local boosting",searchExperimentOverrides:{"search-debug-only-no-recent-boosting":"on"}}),(0,ge.jsx)(Je,{title:"Vector only",searchExperimentOverrides:{"search-vectors":"log-norm"}})]}),(0,ge.jsx)(he.Z,{style:{marginTop:16},title:"Dev Experiments",right:(0,ge.jsx)(ne.Z,{onClick:()=>{I.v_.reset(),I.BJ.reset()},style:{paddingLeft:0,paddingRight:0,height:"unset"},children:(0,q.b)({width:12})}),children:(0,ge.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr 1fr",minWidth:"100%",maxWidth:"100%",paddingLeft:14},children:[(0,ge.jsx)("div",{}),(0,ge.jsx)("div",{}),(0,ge.jsx)(Xe,{columnStore:I.BJ}),t.map((e=>(0,ge.jsx)(Pe,{experiment:e},e.experimentId))),(0,ge.jsx)($e,{leftValue:I.v_.state.forcedClusterPattern,rightValue:I.BJ.state.forcedClusterPattern,setLeftValue:I.v_.updateForcedClusterPattern,setRightValue:I.BJ.updateForcedClusterPattern,placeholder:"cluster-pattern",label:"forced cluster pattern"}),(0,ge.jsx)($e,{leftValue:I.v_.state.forcedBlockIds,rightValue:I.BJ.state.forcedBlockIds,setLeftValue:I.v_.updateForcedBlockIds,setRightValue:I.BJ.updateForcedBlockIds,placeholder:"block ids",label:"forced block ids"})]})})]})})}):null}function gt(e){let{mode:t,buttonPopupStore:s}=e;const r=(0,n.useCallback)((()=>ut(s)),[s]),{filters:i}=(0,o.VK)((()=>j.ZP.state.query),[]);return(0,ge.jsx)(B.SearchStoresContext.Consumer,{children:e=>{let{parentStore:s}=e;return(0,ge.jsx)(ie.Z,{mode:t,focused:!1,title:(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In"}),parentStore:s,blockIds:i.ancestors,onMenuDismiss:r,onChange:et("ancestors")})}})}function mt(e){let{mode:t,buttonPopupStore:s}=e;const r=(0,n.useCallback)((()=>ut(s)),[s]),{filters:i}=(0,o.VK)((()=>j.ZP.state.query),[]);return(0,ge.jsx)(B.SearchStoresContext.Consumer,{children:e=>{let{parentStore:s}=e;return(0,ge.jsx)(ae.Z,{mode:t,focused:!1,title:(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.createdBy",defaultMessage:"Created by"}),parentStore:s,userIds:i.createdBy,onMenuDismiss:r,onChange:et("createdBy")})}})}function ft(e){let{mode:t,buttonPopupStore:s}=e;const r=(0,n.useCallback)((()=>ut(s)),[s]),{filters:i}=(0,o.VK)((()=>j.ZP.state.query),[]);return(0,ge.jsx)(oe.Z,{mode:t,focused:!1,title:(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"}),icon:D.C,value:i.createdTime,onMenuDismiss:r,onChange:et("createdTime")})}function vt(e){let{mode:t,buttonPopupStore:s}=e;const r=(0,n.useCallback)((()=>ut(s)),[s]),{filters:i}=(0,o.VK)((()=>j.ZP.state.query),[]);return(0,ge.jsx)(oe.Z,{mode:t,focused:!1,title:(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),icon:D.C,value:i.lastEditedTime,onMenuDismiss:r,onChange:et("lastEditedTime")})}function xt(e){let{mode:t,buttonPopupStore:s}=e;const r=(0,n.useCallback)((()=>ut(s)),[s]),{filters:i}=(0,o.VK)((()=>j.ZP.state.query),[]);return(0,o.VK)((()=>(0,G.bq)()),[])?(0,ge.jsx)(B.SearchStoresContext.Consumer,{children:e=>{let{parentStore:s}=e;return(0,ge.jsx)(le.Z,{mode:t,focused:!1,title:(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.inTeams",defaultMessage:"Teamspace"}),parentStore:s,teamIds:i.inTeams,onMenuDismiss:r,onChange:et("inTeams")})}}):null}function yt(e){let{activeFilters:t,mode:s,buttonPopupStore:r}=e;return(0,ge.jsxs)(n.Fragment,{children:[t.createdBy&&(0,ge.jsx)(mt,{buttonPopupStore:r,mode:s}),t.createdTime&&(0,ge.jsx)(ft,{buttonPopupStore:r,mode:s}),t.lastEditedTime&&(0,ge.jsx)(vt,{buttonPopupStore:r,mode:s}),t.ancestors&&(0,ge.jsx)(gt,{buttonPopupStore:r,mode:s}),t.inTeams&&(0,ge.jsx)(xt,{buttonPopupStore:r,mode:s})]})}const St=n.forwardRef((function(e,t){let{isMobile:s,searchExperimentsToToggle:n}=e;const a=(0,i.Fg)(),l=(0,r.O7)(),d=dt(s),c=function(e){return{sidebar:{backgroundColor:e.sidebarSecondaryBackground,borderLeft:`1px solid ${e.regularDividerColor}`}}}(a),u=(0,o.VK)((()=>j.ZP.isDebugSidebarOpen()),[]),h=(0,o.VK)((()=>(0,f.bN)(l)),[l]),p={...d.sidebar,...c.sidebar,...!u&&d.sidebarHidden};return(0,ge.jsxs)("aside",{ref:t,style:p,children:[(0,ge.jsx)(Y.Z,{onClick:at,style:{display:"flex",alignItems:"center",justifyContent:"center",background:void 0,borderRadius:6,width:16,height:16,position:"absolute",top:10,right:10,...h&&(0,$.X)({noDrag:!0})},children:(0,E.D)({width:14,fill:a.mediumTextColor})}),(0,ge.jsx)(pt,{searchExperimentsToToggle:n})]})}));function bt(e){let{buttonPopupStore:t}=e;return(0,ge.jsxs)(T.Z,{menuType:m.og.ActionSheet,children:[(0,ge.jsx)(ht,{buttonPopupStore:t}),(0,ge.jsxs)(he.Z,{title:(0,ge.jsx)(ot,{}),children:[(0,ge.jsx)(mt,{buttonPopupStore:t,mode:pe.z.Button}),(0,ge.jsx)(ft,{buttonPopupStore:t,mode:pe.z.Button}),(0,ge.jsx)(vt,{buttonPopupStore:t,mode:pe.z.Button}),(0,ge.jsx)(gt,{buttonPopupStore:t,mode:pe.z.Button}),(0,ge.jsx)(xt,{buttonPopupStore:t,mode:pe.z.Button})]})]})}const Ct=n.forwardRef((function(e,t){let{buttonPopupStore:s}=e;const n=(0,o.VK)((()=>j.ZP.state),[]),r=(0,o.VK)((()=>v.De(n.query.filters)),[n.query.filters]);return(0,ge.jsxs)(re.Z,{ref:t,disableMobilePadding:!0,disableMobileBorders:!0,children:[(0,ge.jsx)(lt,{mode:pe.z.Section}),(0,ge.jsx)(rt,{mode:pe.z.Section}),(0,ge.jsx)(yt,{buttonPopupStore:s,activeFilters:r,mode:pe.z.Section})]})})),It=n.forwardRef((function(e,t){let{isMobile:s,buttonPopupStore:r}=e;const o=(0,n.useCallback)((()=>(0,ge.jsx)(bt,{buttonPopupStore:r})),[r]);return(0,ge.jsx)(te.ZP,{ref:t,popupType:te.Z4.SlideUp,buttonPopupStore:r,renderOrigin:e=>(0,ge.jsx)(ct,{...e,isMobile:s}),render:o})}));var Mt=s(828992),jt=s(698519),wt=s(825464),kt=s(307931);const Pt=function(e){const t=n.useRef(),s=(0,r.Fy)(),{isMobile:o}=s,{activeOption:a,items:l}=n.useMemo((()=>function(e){const{currentSortBy:t,setSortBy:s,sortOptions:n,selectButton:r}=e;let o=n[0];const i=n.map((e=>{const n=t.field,i=`${n}.${"relevance"===n?"":t.direction}`,a=e.key===i;return a&&(o=e),{key:e.key,action:()=>{s(e.sort),r&&r.current&&r.current.closeMenu()},render:t=>(0,ge.jsx)(ee.Z,{...t,title:e.formattedName,right:a&&(0,jt.k)({fill:Ce.ZP.regularIconColor,width:14,height:14})})}}));return{activeOption:o,items:i}}({...e,selectButton:t})),[e,t]),d=(0,i.yK)((e=>({selectedTitle:{color:e.mediumTextColor},label:{marginRight:2,fontSize:o?U.Z.fontSize.UISmall.mobile:U.Z.fontSize.UISmall.desktop,transform:"translateY(0.5px)"},innerButton:{color:e.mediumTextColor,fontWeight:U.Z.fontWeight.semibold,fontSize:o?U.Z.fontSize.UISmall.mobile:U.Z.fontSize.UISmall.desktop,height:20,padding:"2px 4px",marginRight:1,transform:"translateY(0.5px)"},menu:{minWidth:200}})),[o]),c=o?(0,ge.jsx)(H.FormattedMessage,{id:"search.sort.sortMenuTitle",defaultMessage:"Sort By"}):void 0;return(0,ge.jsx)(kt.Z,{ref:e=>{e&&(t.current=e)},alignmentToOrigin:wt.v.Start,selectedTitle:(0,ge.jsx)("div",{style:d.selectedTitle,children:a.formattedName}),label:void 0,renderMenuSections:()=>[{key:"searchSortOrder",render:e=>(0,ge.jsx)(he.Z,{...e,title:c,desktopStyle:d.menu,disableDesktopPadding:!1}),items:l}],labelStyle:d.label,innerButtonStyle:d.innerButton})};const Tt=[{key:"relevance.",formattedName:(0,ge.jsx)(H.FormattedMessage,{id:"search.sort.sortOrder.bestMatches",defaultMessage:"Best matches"}),sort:{field:"relevance"}},{key:"lastEdited.desc",formattedName:(0,ge.jsx)(H.FormattedMessage,{id:"search.sort.sortOrder.lastEdited.newestFirst",defaultMessage:"Last edited: Newest first"}),sort:{field:"lastEdited",direction:"desc"}},{key:"lastEdited.asc",formattedName:(0,ge.jsx)(H.FormattedMessage,{id:"search.sort.sortOrder.lastEdited.oldestFirst",defaultMessage:"Last edited: Oldest first"}),sort:{field:"lastEdited",direction:"asc"}},{key:"created.desc",formattedName:(0,ge.jsx)(H.FormattedMessage,{id:"search.sort.sortOrder.created.newestFirst",defaultMessage:"Created: Newest first"}),sort:{field:"created",direction:"desc"}},{key:"created.asc",formattedName:(0,ge.jsx)(H.FormattedMessage,{id:"search.sort.sortOrder.created.oldestFirst",defaultMessage:"Created: Oldest first"}),sort:{field:"created",direction:"asc"}}],Rt=function(e){let{isPublicPageSearch:t}=e;const s=(0,r.O7)(),{device:n}=s,o=function(e){return{menuItemMobile:{paddingBottom:0},titleWrapper:{flex:void 0,marginTop:-3,marginBottom:-1},showSidebarButton:()=>{const{device:t}=e;return{padding:"0 4px",fontSize:t.isMobile?U.Z.fontSize.UISmall.mobile:U.Z.fontSize.UISmall.desktop,fontWeight:U.Z.fontWeight.medium,borderRadius:4,height:20,lineHeight:"20px"}}}}(s),i={...n.isMobile&&o.menuItemMobile},a=t?void 0:(0,ge.jsx)(Zt,{});return(0,ge.jsx)(Mt.Z,{title:(0,ge.jsx)(Ft,{}),right:a,textWrapperStyle:o.titleWrapper,style:i})};function Ft(){const e=(0,o.VK)((()=>j.ZP.state.query.sort),[]);return(0,ge.jsx)(Pt,{currentSortBy:e,setSortBy:e=>{j.ZP.setState({...j.ZP.state,query:{...j.ZP.state.query,sort:e}})},sortOptions:Tt})}function Zt(){const e=(0,r.O7)(),{device:t}=e;return t.isMobile?(0,ge.jsx)(Ye,{isMobile:!0,mode:Ge.Button}):null}var Bt=s(140586),Ot=s(161496);const Lt=(0,s(745238).IU)("title",{viewBox:"0 0 14 10",svg:(0,ge.jsx)("path",{d:"M10.674 9.45c.293 0 .576-.052.85-.153.273-.098.515-.238.726-.422.215-.184.383-.4.504-.65h.03v.662a.569.569 0 00.163.416c.11.101.25.152.422.152a.579.579 0 00.428-.164c.11-.105.164-.256.164-.451V4.973c0-.43-.104-.805-.31-1.125-.208-.32-.5-.569-.88-.744-.378-.18-.828-.27-1.347-.27-.594 0-1.114.115-1.559.346-.445.226-.75.533-.914.92-.031.07-.056.14-.076.21a.684.684 0 00-.03.194c0 .148.05.27.147.363.102.09.23.135.387.135a.61.61 0 00.287-.064.555.555 0 00.217-.2c.172-.32.377-.554.615-.703.238-.148.533-.223.885-.223.426 0 .76.112 1.002.334.242.223.363.528.363.915v.486l-1.828.1c-.77.042-1.361.23-1.775.562-.41.328-.616.773-.616 1.336 0 .379.09.71.27.996.183.285.435.508.756.668.324.16.697.24 1.119.24zm.328-.938c-.367 0-.666-.092-.897-.276a.906.906 0 01-.345-.738.86.86 0 01.34-.709c.23-.184.558-.29.984-.322l1.664-.106v.598c0 .293-.078.557-.234.791a1.69 1.69 0 01-.627.557c-.266.136-.56.205-.885.205zM.689 9.414c.2 0 .354-.045.463-.135.114-.086.202-.234.264-.445l.65-1.816h3.346l.65 1.816c.063.21.149.36.258.445.114.09.268.135.463.135.207 0 .371-.057.492-.17a.593.593 0 00.188-.463c0-.129-.027-.27-.082-.422L4.79 1.357c-.09-.246-.22-.43-.393-.55C4.23.686 4.012.625 3.742.625c-.508 0-.847.244-1.02.732L.116 8.39a1.3 1.3 0 00-.076.404c0 .195.057.348.17.457.117.11.277.164.48.164zm1.717-3.486L3.73 2.119h.03l1.324 3.809H2.406z"})});var At=s(915157),Dt=s(434859),Et=s(279131),Vt=s(953336),qt=s(676725),Nt=s(421202),Kt=s(429369),_t=s(519889),Ht=s(492338),Wt=s(307928),Ut=s(433929),zt=s(206258);function $t(e){const{filterUIName:t}=e,{parentStore:s}=(0,n.useContext)(B.SearchStoresContext),r=(0,o.VK)((()=>j.ZP.state.query.filters),[]),a=(0,i.yK)((e=>({title:{maxWidth:220,...U.Z.textOverflowStyle}})),[]),l=(0,o.VK)((()=>{switch(t){case"personFilter":return function(e,t){const s=e.createdBy,n=Ut.default.getIntl(),r=d.oA(s.map((e=>{const s=zt.U6.createChildStore(t,{table:_t.KJ,id:e});return(0,Wt.Nz)(n,s.getModel())})));return(0,qt.Z)(r,Jt)}(r,s);case"teamsFilter":case"dev_notInTeamFilter":return function(e,t){const s=(0,Ht.iY)(e.inTeams);if(!s)return[];const n=d.oA(s.map((e=>zt.zX.createChildStore(t,{table:Kt.e0,id:e}).getName())));return(0,qt.Z)(n,Jt)}(r,s);case"pageFilter":case"pageFilter":case"dev_notInPageFilter":return Yt(r,s);case"dateFilter":return function(e){const t=Ut.default.getIntl(),s=Qt(e);if("createdTime"===s)return v._Q(e.createdTime,t);if("lastEditedTime"===s)return v._Q(e.lastEditedTime,t);return""}(r);case"titleToggle":return[];default:(0,W.t1)(t)}}),[s,t,r]);return(0,ge.jsx)("div",{style:a.title,children:(0,ge.jsx)(H.FormattedMessage,{defaultMessage:"{filterName}{colon} {filterOperator} {filterValues}",id:"search.filterBarFilter.title",values:{filterName:Gt(t),filterOperator:0===l.length?void 0:Xt(t,r),filterValues:l,colon:0===l.length?void 0:":"}})})}function Gt(e){switch(e){case"personFilter":return(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.person",defaultMessage:"Created by"});case"teamsFilter":return(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.inTeams",defaultMessage:"Teamspace"});case"pageFilter":return(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In"});case"dateFilter":return(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.date",defaultMessage:"Date"});case"titleToggle":return(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Title only"});case"dev_notInPageFilter":return(0,ge.jsx)(H.FormattedMessage,{id:"[DO NOT TRANSLATE].search.filterMenu.notInPageFilter.label",defaultMessage:"[dev] Not in page"});case"dev_notInTeamFilter":return(0,ge.jsx)(H.FormattedMessage,{id:"[DO NOT TRANSLATE].search.filterMenu.notInTeamFilter.label",defaultMessage:"[dev] Not in teamspace"})}(0,W.t1)(e)}function Qt(e){const t=v.VD.createdTime(e.createdTime),s=v.VD.lastEditedTime(e.lastEditedTime);return t?"createdTime":s?"lastEditedTime":void 0}function Xt(e,t){switch(e){case"personFilter":case"teamsFilter":case"pageFilter":case"dev_notInPageFilter":case"dev_notInTeamFilter":case"dateFilter":case"titleToggle":return}(0,W.t1)(e)}function Jt(e){return", "}function Yt(e,t){const s=e.ancestors,n=d.oA(s.map((e=>{const s=zt.G.createChildStore(t,{table:Nt.iU,id:e});return s.isDefined()?s.getModel().getRenderTitle({getRecordModel:s.getRecordModel,userTimeZone:(0,Re.r)(),intl:Ut.default.getIntl()}):""})));return(0,qt.Z)(n,Jt)}var es=s(883355),ts=s(223196),ss=s(41558),ns=s(953437),rs=s(814871),os=s(83264);const is={today:(0,ge.jsx)(H.FormattedMessage,{defaultMessage:"Today",id:"searchDateFilter.quickActions.today.label"}),pastWeek:(0,ge.jsx)(H.FormattedMessage,{defaultMessage:"Last 7 days",id:"searchDateFilter.quickActions.last7Days.label"}),pastMonth:(0,ge.jsx)(H.FormattedMessage,{defaultMessage:"Last 30 days",id:"searchDateFilter.quickActions.last30Days.label"})};function as(e){let{date:t,onClick:s,onDismiss:n}=e;const r=(0,Re.r)(),o=Te.Lg(r),i=o;let a;const l=is[t];"today"===t?a=o:"pastWeek"===t?a=Te.Oo(r):"pastMonth"===t?a=Te.dj(r):(0,W.t1)(t);return(0,ge.jsx)(ee.Z,{focused:!1,icon:(0,D.C)({height:18,width:18}),title:l,onClick:e=>{s({value:{starting:{type:"date",start_date:a.start_date},ending:{type:"date",start_date:i.start_date}}}),n(e)}})}class ls extends es.Z{constructor(){super(...arguments),this.storeTypes={store:ss.Z},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderPopupContents=()=>(0,ge.jsx)(Ms,{onMenuDismiss:this.props.onMenuDismiss,title:this.props.title,value:this.props.value,store:this.stores.store}),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleOriginActivate=()=>fs(this.stores.store,this.props.disabled,this.props.onMenuOpen),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMenuClose=e=>vs(e,this.stores.store,this.props.onMenuDismiss),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClear=()=>xs(this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_updateTemporary=e=>ys(e,this.stores.store)}didMount(){ys({value:this.props.value},this.stores.store)}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?(0,ge.jsx)(ws,{onMenuDismiss:this.props.onMenuDismiss,title:this.props.title,value:this.props.value,disabled:this.props.disabled,onMenuOpen:this.props.onMenuOpen,dateFormat:this.props.dateFormat,intl:this.props.intl,icon:this.props.icon,store:this.stores.store,mode:t}):(0,ge.jsx)(js,{onMenuDismiss:this.props.onMenuDismiss,title:this.props.title,value:this.props.value,disabled:this.props.disabled,onMenuOpen:this.props.onMenuOpen,icon:this.props.icon,store:this.stores.store,mode:t})}}ls.displayName="SearchGenericDateFilter";const ds=(0,H.injectIntl)(ls);function cs(e,t){j.ZP.updateFilters({[e]:t})}function us(e){return{lastEditedTime:(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),createdTime:(0,ge.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"})}[e]}function hs(e){const{device:t}=e;return t.isMobile?ts.k.SlideUp:ts.k.Popup}function ps(){const e=(0,r.O7)(),{device:t}=e;return(0,be.i)({width:10,height:10,...t.isMobile&&{marginTop:2}})}function gs(e){e.preventDefault&&e.preventDefault()}function ms(e,t){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},sectionMenuItem:{display:"flex"},icon:{height:14,width:14,fill:"currentColor"},pillIcon:{height:16,width:16,fill:"currentColor",marginRight:6},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:12,paddingBottom:8},menuItemTitleDesktop:{width:"100%"},summary:{display:"inline-flex"},quickDatesWrapper:{marginTop:12,boxShadow:`0 1px 0 ${t.regularDividerColor}`,paddingBottom:15,marginBottom:15},clearButton:{color:t.mediumTextColor,fill:t.lightIconColor,fontWeight:500,fontSize:13,paddingLeft:2,paddingRight:2,paddingBottom:2,borderRadius:4,flexShrink:0},dateFilterHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginLeft:12,marginRight:12}}}function fs(e,t,s){t||(s&&s(),e.setState({...e.state,isOpen:!0,focus:"starting"}))}function vs(e,t,s){const{temporaryDateRange:n,dateFilterType:r}=t.state;v.zD(e)||(cs(r,n),t.setState({...t.state,isOpen:!1}),s&&s())}function xs(e){const{dateFilterType:t}=e.state;cs(t,{starting:void 0,ending:void 0}),e.clearTemporaryDateRange()}function ys(e,t){if(e.error)return;t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}});const{dateFilterType:s,temporaryDateRange:n}=t.state,{starting:r,ending:o}=n;r&&o&&cs(s,{starting:r,ending:o})}function Ss(e){let{value:t,store:s}=e;const n=(0,i.Fg)(),a=(0,r.O7)(),{device:l}=a,d=(0,o.VK)((()=>s.state.dateFilterType),[s]),c={width:190,items:["createdTime","lastEditedTime"],selectedItem:d,getKey:e=>e,onSelect:e=>function(e,t,s){const{dateFilterType:n}=s.state;cs(e,t),e!==n&&(cs(n,{starting:void 0,ending:void 0}),s.setState({...s.state,dateFilterType:e}))}(e,t,s),renderItem:e=>(0,ge.jsx)(ee.Z,{title:us(e.value),...e}),renderOrigin:e=>(0,ge.jsx)(Y.Z,{...e,style:{paddingLeft:2,paddingRight:2,paddingBottom:2,borderRadius:4,flexShrink:0},children:(0,ge.jsxs)("div",{style:{display:"flex",alignItems:"center",...!l.isMobile&&{color:n.mediumTextColor,fill:n.lightIconColor,fontWeight:500,fontSize:13}},children:[(0,ge.jsx)("span",{style:{marginRight:4},children:us(d)}),(0,ge.jsx)(ps,{})]})})};return(0,ge.jsx)(rs.Z,{...c,mobileActionSheet:!0})}function bs(e){let{disabled:t,onMenuOpen:s,icon:o,title:a,store:l}=e;const d=(0,i.Fg)(),c=(0,r.O7)(),u=(0,n.useCallback)((()=>fs(l,t,s)),[l,t,s]),h=ms(c,d);return(0,ge.jsx)(ee.Z,{disabled:t,focused:!1,icon:o(h.icon),title:a,onClick:u})}function Cs(e){let{disabled:t,onMenuOpen:s,title:o,value:a,dateFormat:l,store:d}=e;const c=(0,i.Fg)(),u=(0,r.O7)(),h=(0,H.useIntl)(),p=(0,n.useCallback)((()=>xs(d)),[d]),g=(0,n.useCallback)((()=>fs(d,t,s)),[d,t,s]),m=ms(u,c),f=(0,ge.jsxs)("div",{style:m.summary,children:[(0,D.C)(m.iconActiveMobile),v._Q(a,h,l)]});return(0,ge.jsx)(ue.Z,{disabled:t,onClick:g,onClickClear:p,label:o,title:f})}function Is(e){let{disabled:t,onMenuOpen:s,icon:a,title:l,store:d}=e;const c=(0,i.Fg)(),u=(0,r.O7)(),h=(0,n.useCallback)((()=>fs(d,t,s)),[d,t,s]),p=ms(u,c),g=(0,o.VK)((()=>d.state.dateFilterType),[d]),m=(0,o.VK)((()=>j.ZP.state.query.filters[g].starting),[g]);return(0,ge.jsx)(de.Z,{on:Boolean(m),icon:a(p.pillIcon),title:(0,ge.jsx)("span",{children:l}),onClick:h})}function Ms(e){let{onMenuDismiss:t,title:s,value:a,store:l}=e;const d=(0,i.Fg)(),c=(0,r.O7)(),u=(0,n.useCallback)((e=>vs(e,l,t)),[l,t]),h=(0,n.useCallback)((e=>ys(e,l)),[l]),p=(0,n.useCallback)((()=>xs(l)),[l]),g=(0,o.VK)((()=>function(e){const{dateFilterType:t,temporaryDateRange:s}=e.state;return{...j.ZP.state.query.filters[t],...s}}(l)),[l]);return(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsxs)("div",{style:ms(c,d).dateFilterHeader,children:[(0,ge.jsx)(Ss,{value:a,store:l}),(0,ge.jsx)(Y.Z,{style:ms(c,d).clearButton,onClick:p,children:(0,ge.jsx)(H.FormattedMessage,{defaultMessage:"Clear",id:"searchDateFilter.clearButton.label"})})]}),(0,ge.jsxs)("div",{style:ms(c,d).quickDatesWrapper,children:[(0,ge.jsx)(as,{date:"today",onClick:h,onDismiss:u}),(0,ge.jsx)(as,{date:"pastWeek",onClick:h,onDismiss:u}),(0,ge.jsx)(as,{date:"pastMonth",onClick:h,onDismiss:u})]}),(0,ge.jsx)(os.Z,{title:s,value:g,onUpdate:h,store:l,onDismiss:u,hideDateInputMenuItems:!0})]})}function js(e){let{mode:t,onMenuDismiss:s,title:a,value:l,disabled:d,onMenuOpen:c,icon:u,store:h}=e;const p=(0,i.Fg)(),g=(0,r.O7)(),m=(0,n.useCallback)((e=>vs(e,h,s)),[h,s]),f=(0,n.useCallback)((()=>(0,ge.jsx)(Ms,{onMenuDismiss:s,title:a,value:l,store:h})),[s,a,l,h]),v=ms(g,p),x=(0,o.VK)((()=>h.state.isOpen),[h]);return(0,ge.jsx)(he.Z,{style:v.sectionMenuItem,children:(0,ge.jsx)(P.Z,{debugName:"SearchGenericDateFilter",capture:x,onUp:gs,onDown:gs,onEnter:gs,children:(0,ge.jsx)(ns.ZP,{popupType:hs(g),open:x,origin:(0,ge.jsx)(Is,{disabled:d,onMenuOpen:c,icon:u,title:a,store:h}),render:f,onDismiss:m,placementToOrigin:ns.ZP.Placement.Bottom,alignmentToOrigin:ns.ZP.Alignment.Start,keepFocus:!0,style:v.popup})})})}function ws(e){let{mode:t,onMenuDismiss:s,title:r,value:i,disabled:a,onMenuOpen:l,dateFormat:d,intl:c,icon:u,store:h}=e;const p=(0,n.useCallback)((e=>vs(e,h,s)),[h,s]),g=(0,n.useCallback)((()=>(0,ge.jsx)(Ms,{onMenuDismiss:s,title:r,value:i,store:h})),[s,r,i,h]),m=(0,o.VK)((()=>h.state.isOpen),[h]),f=t===pe.z.Section?(0,ge.jsx)(Cs,{disabled:a,onMenuOpen:l,title:r,value:i,dateFormat:d,store:h}):(0,ge.jsx)(bs,{disabled:a,onMenuOpen:l,icon:u,title:r,store:h});return(0,ge.jsx)(ns.ZP,{popupType:ts.k.SlideUp,open:m,origin:f,render:g,onDismiss:p,preventScaleTransition:!0})}s(757658);var ks=s(222109);function Ps(e){const t=j.ZP.state.query.sort,s=Tt.find((e=>d.Xy(e.sort,t)))??Tt[0],n="relevance"===s.sort.field?(0,ge.jsx)(H.FormattedMessage,{id:"search.sort.sortOrder.bestMatches.title",defaultMessage:"Sort"}):s.formattedName;return(0,ge.jsx)(de.Z,{disabled:!1,title:n,onClick:e.onClick,icon:(0,ks.T)({width:16,marginRight:6,fill:"currentColor"})})}function Ts(){const e=j.ZP.state.query.sort,t=Tt.findIndex((t=>d.Xy(t.sort,e))),s=[];for(const n of Tt)s.push({key:n.key,render:e=>(0,ge.jsx)(ee.Z,{...e,title:n.formattedName}),action:()=>{j.ZP.setState({...j.ZP.state,query:{...j.ZP.state.query,sort:n.sort}})}});return(0,ge.jsx)(T.Z,{menuType:m.og.Popup,children:(0,ge.jsx)(Ie.Z,{type:Ie.i.Vertical,initialFocus:t<0?0:t,sections:[{key:"sortOptions",items:s,render:e=>(0,ge.jsx)(re.Z,{...e,disableDesktopPadding:!0})}]})})}const Rs=function(e){const t=(0,i.yK)((()=>({popup:{paddingTop:12,paddingBottom:8}})),[]);return(0,ge.jsx)(te.ZP,{popupType:te.Z4.Popup,renderOrigin:Ps,render:Ts,disabled:!1,placementToOrigin:ns.ZP.Placement.Bottom,alignmentToOrigin:ns.ZP.Alignment.Start,style:t.popup,onClick:e.onMenuOpen,onClose:e.onMenuDismiss})},Fs="SearchFilterSettings";function Zs(e){const{isMobile:t}=e,{parentStore:s}=(0,n.useContext)(B.SearchStoresContext),{handlePopupOpen:a,handlePopupClose:l}=(0,n.useContext)(B.SearchStaticContext),c=(0,r.O7)(),u=(0,o.VK)((()=>c.currentUser.id),[c]),h=(0,o.VK)((()=>j.ZP),[]),p=(0,o.Kw)(h),g=p.query.filters,m=(0,o.VK)((()=>M.default.state.isPublicPageSearch),[]),f=(0,o.VK)((()=>(0,G.bq)()&&X.default.checkGate({gateName:"enable_search_team_filter"})&&!m),[m]),v=(0,o.VK)((()=>!m),[m]),x=!1,y=(0,i.yK)((e=>({scroller:{display:"flex",alignItems:"center",paddingTop:10,paddingRight:12,paddingBottom:10,paddingLeft:12},barContainer:{display:"flex",alignItems:"center"},scrollerContainer:{position:"relative",flexGrow:0,overflow:"hidden"},draggableList:{display:"flex",flexShrink:0,marginLeft:6},divider:{height:16,width:1,borderRadius:1,backgroundColor:e.stroke.deemphasized}})),[]),S=(0,n.useCallback)((e=>t=>h.updateFilters({[e]:t})),[h]),b=(0,n.useCallback)((e=>{const{onMenuDismiss:t,onMenuOpen:n}=e;if(v)return(0,ge.jsx)(ae.Z,{mode:pe.z.Pill,focused:!1,title:(0,ge.jsx)($t,{filterUIName:"personFilter"}),parentStore:s,userIds:g.createdBy,onMenuDismiss:t,onMenuOpen:n,onChange:S("createdBy")})}),[v,s,g.createdBy,S]),C=(0,n.useCallback)((e=>{const{onMenuDismiss:t,onMenuOpen:n}=e;return f&&(0,ge.jsx)(le.Z,{mode:pe.z.Pill,focused:!1,title:(0,ge.jsx)($t,{filterUIName:"teamsFilter"}),parentStore:s,teamIds:g.inTeams,onMenuDismiss:t,onMenuOpen:n,onChange:S("inTeams")})}),[s,g.inTeams,S,f]),I=(0,n.useCallback)((e=>{const{onMenuDismiss:t,onMenuOpen:n}=e;return(0,ge.jsx)(ie.Z,{mode:pe.z.Pill,focused:!1,title:(0,ge.jsx)($t,{filterUIName:"pageFilter"}),parentStore:s,blockIds:g.ancestors,onMenuDismiss:t,onMenuOpen:n,onChange:S("ancestors")})}),[s,g.ancestors,S]),w=(0,n.useCallback)((()=>null),[s,g.dev_excludedPages,S,x]),k=(0,n.useCallback)((()=>null),[s,g.dev_excludedTeams,S,x]),P=(0,n.useCallback)((e=>{const{onMenuDismiss:t,onMenuOpen:s}=e;return(0,ge.jsx)(ds,{mode:pe.z.Pill,focused:!1,title:(0,ge.jsx)($t,{filterUIName:"dateFilter"}),icon:D.C,value:g.lastEditedTime,onMenuDismiss:t,onMenuOpen:s})}),[g.lastEditedTime]),T=(0,n.useCallback)((()=>!t&&(0,ge.jsx)(me,{mode:pe.z.Pill,focused:!1,title:(0,ge.jsx)($t,{filterUIName:"titleToggle"}),icon:Lt,value:g.navigableBlockContentOnly||!1,onChange:S("navigableBlockContentOnly")})),[g.navigableBlockContentOnly,S,t]);(0,n.useEffect)((()=>{const e=At.Z.get({userId:u,key:Fs});e&&d.Xy(new Set(e.filterOrder),new Set(p.filterBar.order))&&!d.Xy(e.filterOrder,p.filterBar.order)&&e.filterOrder&&h.updateFilterOrder(e.filterOrder)}),[p.filterBar.order,u,h]);const R={onMenuOpen:a,onMenuDismiss:l},F={titleToggle:T(),personFilter:b(R),teamsFilter:C(R),pageFilter:I(R),dateFilter:P(R),dev_notInPageFilter:w(),dev_notInTeamFilter:k()};const Z=(0,n.useCallback)((e=>{const{onMenuDismiss:t,onMenuOpen:s}=e;return(0,ge.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,ge.jsx)(Rs,{onMenuOpen:s,onMenuDismiss:t}),(0,ge.jsx)("div",{style:y.divider})]})}),[y.divider]);return(0,ge.jsx)("div",{style:y.barContainer,children:(0,ge.jsx)("div",{style:y.scrollerContainer,children:(0,ge.jsxs)(Vt.Z,{type:Dt.Z.X,style:y.scroller,showLeftRightOverlay:!1,children:[(0,ge.jsx)(ge.Fragment,{children:Z(R)}),(0,ge.jsx)(ge.Fragment,{children:(0,ge.jsx)(Et.ZP,{direction:"horizontal",keys:p.filterBar.order,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,renderKey:e=>F[e],style:y.draggableList,onDrop:e=>function(e){const t={filterOrder:e};At.Z.set({userId:u,key:Fs,value:t}),h.updateFilterOrder(e)}(e)})})]})})})}var Bs=s(587531),Os=s(352823),Ls=s(521273),As=s(798180),Ds=s(229798),Es=s(749085),Vs=s(296994),qs=s(612457),Ns=s(475024),Ks=s(568785),_s=s(550506),Hs=s(863296),Ws=s(125904),Us=s(454642),zs=s(547307),$s=s(164964),Gs=s(801310),Qs=s(292660);const Xs=(0,H.defineMessages)({additionalInformationPlaceholder:{id:"SearchBadResultsForm.additionalInformation.placeholder",defaultMessage:"What went wrong with this search? Please be as specific as possible."},submitFailed:{id:"SearchBadResultsForm.submitFailed",defaultMessage:"Failed to submit report"},submitSuccess:{id:"SearchBadResultsForm.submitSuccess",defaultMessage:"Your report has been submitted, thanks!"},title:{id:"SearchBadResultsForm.title",defaultMessage:"Give search feedback"},warning:{id:"SearchBadResultsForm.warning",defaultMessage:"The pages from the search results will be sent to Notion for quality improvement."},cancel:{id:"SearchBadResultsForm.cancel",defaultMessage:"Cancel"},submit:{id:"SearchBadResultsForm.submit",defaultMessage:"Submit"},urlPlaceholder:{id:"SearchBadResultsForm.url.placeholder",defaultMessage:"Link to page you were looking for..."}});function Js(){Ws.Z.reset()}const Ys=function(e){const{serverResults:t,localResults:s,exposedSearchExperiments:a,debugInfo:l}=e,d=null==l?void 0:l.traceLogs,{isMobile:c}=(0,r.Fy)(),u=(0,i.yK)((e=>({wrap:{display:"flex",flexDirection:"column",width:c?"min(100%, 600px)":void 0,minHeight:128,maxHeight:c?void 0:"max(calc(100vh - 78px), 300px)"},modalWrap:{width:"32rem",padding:24,fontSize:14,maxWidth:"100%"},modalTitle:{fontSize:16,fontWeight:U.Z.fontWeight.medium},modalWarning:{fontSize:13,color:e.lightTextColor},titleContainer:{marginBottom:12},buttonArea:{display:"flex",justifyContent:"flex-end",marginTop:18,gap:8},outlineButton:{marginRight:12},feedbackArea:{marginTop:17,padding:8}})),[c]),[h]=(0,n.useState)(j.ZP),p=(0,o.VK)((()=>S.default.state.currentSpaceStore),[]),[g,m]=(0,o.AF)(Ws.Z),f=(0,r.O7)(),x=(0,n.useCallback)((()=>{!function(e){var t,s,n;let{searchStoreState:r,currentSpaceStore:o,serverResults:i,localResults:a,environment:l,exposedSearchExperiments:d,traceLogs:c}=e;const u=Ws.Z.getState(),h=v.AX(i),p=v.AX(a),g=void 0,m={query:r.query,limit:r.limit,debug:g},{publicAccessPermissionAncestorBlockId:f}=v.bC(l),x=v.gC({input:m,spaceId:null==o?void 0:o.id,publicAccessPermissionAncestorBlockId:f,source:"report_bad_search"});if(!x)return;const y=null===(t=document.getElementsByClassName("notion-overlay-container notion-default-overlay-container")[0])||void 0===t?void 0:t.outerHTML,S=document.getElementsByClassName("notion-app-inner notion-dark-theme")[0],b=null==S?void 0:S.style.cssText,C=document.createElement("div");C.innerHTML=y,C.style.cssText=b,null===(s=C.querySelector("[data-search-suggested-text]"))||void 0===s||s.remove(),null===(n=C.querySelector("[data-search-snapshot-delete-nearest-overlay]"))||void 0===n||null===(n=n.closest("[data-overlay]"))||void 0===n||n.remove();const I=h.some((e=>e.sources.includes(Ht.vp.VectorDBBlock)||e.sources.includes(Ht.vp.VectorDBCollection)));I&&h.splice(0,-20);const M=d?Object.fromEntries(d.entries()):{},j={queryText:r.query.text.trim(),apiRequest:x,serverResults:JSON.stringify(h,null,2),localResults:JSON.stringify(p,((e,t)=>t instanceof Set?Array.from(t):t),2),additionalInformation:u.additionalInformation,desiredUrl:u.desiredUrl,renderedHtml:C.outerHTML,experiments:JSON.stringify(M,null,2),isVectorSearchEnabled:I,traceLogs:null==c?void 0:c.log};Us.reportBadSearch(l,j).then((e=>{"failed"===e.type?zs.showErrorMessage((0,ge.jsx)("h1",{children:Ut.default.formatMessage(Xs.submitFailed)})):$s.oV({label:Ut.default.formatMessage(Xs.submitSuccess),durationMs:Gs.JY})})),Ws.Z.reset()}({searchStoreState:h.state,currentSpaceStore:p,serverResults:t,localResults:s,exposedSearchExperiments:a,environment:f,traceLogs:d})}),[f,h,p,t,s,a,d]);return(0,ge.jsx)(Qs.Z,{onDismiss:Js,render:()=>(0,ge.jsx)(w.Z,{allowMobileAutoScroll:!0,capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:e=>(0,ge.jsx)("div",{style:u.wrap,"data-search-snapshot-delete-nearest-overlay":!0,children:(0,ge.jsxs)("div",{style:u.modalWrap,...e,children:[(0,ge.jsxs)("div",{style:u.titleContainer,children:[(0,ge.jsx)("div",{style:u.modalTitle,children:Ut.default.formatMessage(Xs.title)}),(0,ge.jsx)("div",{style:u.modalWarning,children:Ut.default.formatMessage(Xs.warning)})]}),(0,ge.jsx)(ze.Z,{placeholder:Ut.default.formatMessage(Xs.additionalInformationPlaceholder),value:g.additionalInformation,onChange:e=>{m({...g,additionalInformation:e.target.value})},focusInitial:!0,inputStyle:{padding:8},style:u.feedbackArea,textarea:!0}),false,(0,ge.jsxs)("div",{style:u.buttonArea,children:[(0,ge.jsx)(Hs.Z,{isLarge:!0,onClick:Js,style:u.outlineButton,children:Ut.default.formatMessage(Xs.cancel)}),(0,ge.jsx)(Hs.Z,{isRed:!0,isLarge:!0,onClick:x,disabledFeedback:!0,children:Ut.default.formatMessage(Xs.submit)})]})]})})}),isOpen:g.open})};var en=s(59592);function tn(e){const[t,s]=(0,o.AF)(Ws.Z),n=(0,i.yK)((t=>({button:{...(0,en.r)(t),...e.buttonStyles}})),[e.buttonStyles]);return(0,ge.jsxs)(Hs.Z,{style:n.button,onClick:()=>{s({...t,open:!0})},children:[(0,ge.jsx)(H.FormattedMessage,{defaultMessage:"Give search feedback",id:"search.header.badSearch.button.label"}),(0,ge.jsx)(Ys,{...e})]})}var sn=s(688357);const nn=Es.default.createClass(!1,{name:"RequestModalOpenStore"}),rn=Es.default.createClass(!1,{name:"ResponseModalOpenStore"});const on=function(e){var t;let{searchResultStore:s,shouldShow:n,showSpinner:a}=e;const l=(0,H.useIntl)(),d=(0,i.Fg)(),c=(0,r.O7)(),u=(0,o.qz)(void 0,rn),h=(0,o.qz)(void 0,nn),{localResults:p,serverResults:g}=(0,o.VK)((()=>{const{localResults:e,serverResults:t}=s.state;return{localResults:e,serverResults:t}}),[s]),{count:m,isLowerBound:v}=(0,o.VK)((()=>s.getResultCount()),[s]),x=(0,o.VK)((()=>(0,f.rd)(c)),[c]),y=(0,o.VK)((()=>!x&&X.default.checkGate({gateName:"search-show-report-bad-search"})),[x]);if(!n)return null;const S=an(c,d),b=function(e){return{footerText:{color:e.lightTextColor},resultCount:{color:e.mediumTextColor},keyboardShortcut:{color:e.mediumTextColor}}}(d),C={...S.resultCount,...b.resultCount},I=(0,ge.jsx)("span",{style:S.resultText,children:v?l.formatMessage({id:"SearchResultsFooter.helpText.resultCountApproximate",defaultMessage:"{resultCount, plural, other {<resultwrapper>{resultCount}+</resultwrapper> results}}"},{resultCount:m,resultwrapper:e=>(0,ge.jsx)("span",{style:C,children:e})}):l.formatMessage({id:"SearchResultsFooter.helpText.resultCount",defaultMessage:"{resultCount, plural, one {<resultwrapper>{resultCount}</resultwrapper> result} other {<resultwrapper>{resultCount}</resultwrapper> results}}"},{resultCount:m,resultwrapper:e=>(0,ge.jsx)("span",{style:C,children:e})})}),M=(0,f.XP)()||x,j=M?(0,ge.jsx)(sn.Z,{}):(0,ge.jsxs)("div",{style:S.resultCountWrapper,children:[M?void 0:(0,ge.jsxs)("div",{children:[I,(0,ge.jsx)(ln,{showSpinner:a})]}),(0,ge.jsx)("div",{style:S.navigationHints,children:(0,ge.jsx)(sn.Z,{})})]});return(0,ge.jsx)(en.Z,{title:j,right:(0,ge.jsxs)(ge.Fragment,{children:[y&&(0,ge.jsx)(tn,{exposedSearchExperiments:null==g||null===(t=g.serverEventProperties)||void 0===t?void 0:t["server-searchExperiments"],localResults:null==p?void 0:p.results,serverResults:null==g?void 0:g.results,debugInfo:null==g?void 0:g.debugInfo}),(0,ge.jsx)(dn,{searchResultStore:s,requestModalOpenStore:h,responseModalOpenStore:u})]})})};function an(e,t){return{footer:()=>{const{device:t}=e;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:t.isMobile?U.Z.fontSize.UIRegular.mobile:U.Z.fontSize.UIRegular.desktop}},footerText:{fontSize:Ns.yv(e,"UISmall"),...U.Z.textOverflowStyle},inlineHint:{display:"inline",marginRight:16},resultCountWrapper:{display:"flex",alignItems:"center",...U.Z.textOverflowStyle},resultCount:{fontWeight:U.Z.fontWeight.medium},resultText:{verticalAlign:"middle",marginRight:6},spinner:{display:"inline",width:12,height:12,verticalAlign:"middle"},keyboardShortcut:{marginRight:4,marginBottom:1,fontVariant:"all-small-caps",fontSize:1.1*Ns.yv(e,"UISmall")},commandGlyph:{fontSize:.75*Ns.yv(e,"UIRegular")},footerDebugButton:(0,en.r)(t),debugModalStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll",padding:10},navigationHints:{marginLeft:15}}}function ln(e){let{showSpinner:t}=e;const s=(0,i.Fg)(),n=an((0,r.O7)(),s);return(0,ge.jsx)(qs.Z,{show:t,showDelay:500,showHold:200,render:e=>e&&(0,ge.jsx)(Ks.Z,{style:n.spinner})})}function dn(e){var t;let{searchResultStore:s,requestModalOpenStore:n,responseModalOpenStore:a}=e;const l=(0,i.Fg)(),d=(0,r.O7)(),{debug:c,showDebugInfo:u}=(0,o.VK)((()=>{const{debug:e,showDebugInfo:t}=I.ZP.state;return{debug:e,showDebugInfo:t}}),[]),h=(0,o.VK)((()=>s.state.serverResults),[s]),p=(0,o.VK)((()=>n.state),[n]),g=(0,o.VK)((()=>a.state),[a]);if(!c&&!u)return null;const{rawRequests:m,rawResponses:f}=(null==h||null===(t=h.debugInfo)||void 0===t?void 0:t.response)||{};return(0,ge.jsxs)(ge.Fragment,{children:[m&&(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsx)(_s.Z,{open:p,innerStyle:an(d,l).debugModalStyle,onDismiss:()=>{n.setState(!1)},render:()=>(0,ge.jsx)(Vs.Ki,{showCopyButton:"large",defaultCollapsed:!1,data:m})}),(0,ge.jsx)(Hs.Z,{style:an(d,l).footerDebugButton,onClick:()=>n.setState(!0),children:"Open Request"})]}),f&&(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsx)(_s.Z,{open:g,innerStyle:an(d,l).debugModalStyle,onDismiss:()=>{a.setState(!1)},render:()=>(0,ge.jsx)(Vs.Ki,{showCopyButton:"large",data:{rawResponses:f},defaultCollapsed:!1})}),(0,ge.jsx)(Hs.Z,{style:an(d,l).footerDebugButton,onClick:()=>a.setState(!0),children:"Open Response"})]})]})}var cn=s(136896),un=s(44604),hn=s(636596),pn=s(743765),gn=s(543145),mn=s(940465),fn=s(139634),vn=s(316354);const xn=function(e){const{style:t,captionStyle:s,title:n,caption:o}=e,i=(0,r.O7)(),a=bn(i),l={...a.menuItem,...t},d={...a.caption,...s};return(0,ge.jsx)(Mt.Z,{...e,title:(0,ge.jsx)(Cn,{title:n}),caption:(0,ge.jsx)(Sn,{caption:o,captionStyle:d}),textWrapperStyle:bn(i).text,style:l,captionStyle:d})};function yn(e){return{title:{color:e.mediumTextColor},caption:{color:e.lightTextColor}}}function Sn(e){let{captionStyle:t,caption:s}=e;const n=(0,i.Fg)();if(!s)return null;const r={...t,...yn(n).caption};return(0,ge.jsx)("div",{style:r,children:s})}function bn(e){return{menuItem:{minHeight:void 0,...e.device.isMobile&&{background:void 0,boxShadow:void 0},paddingTop:32,paddingBottom:32},text:{textAlign:"center"},title:{margin:0,fontWeight:U.Z.fontWeight.medium,fontSize:Ns.yv(e,"UIRegular"),lineHeight:Ns.Dp(e,"UIRegular")},caption:{fontSize:Ns.yv(e,"UIRegular")}}}function Cn(e){let{title:t}=e;const s=(0,i.Fg)(),n=(0,r.O7)();if(!t)return null;const o=bn(n),a=yn(s),l={...o.title,...a.title};return(0,ge.jsx)("div",{role:"alert",style:l,children:t})}const In=(0,ge.jsx)(H.FormattedMessage,{defaultMessage:"No results",id:"searchErrorMenuItem.error.noResults"});const Mn=function(e){const t=(0,i.yK)((e=>({menuItem:{marginTop:"auto",marginBottom:"auto"},caption:{marginTop:"auto"},reportProblemButton:{display:"inline",color:e.blueColor},searchDeletedButton:{display:"inline",lineHeight:"25px",color:e.blueColor}})),[]),s=(0,r.O7)(),{isQuickSearch:a}=(0,n.useContext)(B.SearchStaticContext),l=()=>{fn.j({environment:s,from:"quick_find"})};function d(s){const n=function(s){if(s)return;const n=v.FN(c);if(!v.VD.isDeletedOnly(c.isDeletedOnly))return(0,ge.jsx)(H.FormattedMessage,{id:"searchErrorMenuItem.errorPrompt.searchDeleted",defaultMessage:"Some results may be in your deleted pages.{br}<searchdeleted>Search deleted pages</searchdeleted>",values:{searchdeleted:s=>(0,ge.jsx)(vn.Z,{onClick:e.handleSearchDeletedOnly,style:t.searchDeletedButton,children:s}),br:(0,ge.jsx)("br",{})}});return n?(0,ge.jsx)(H.FormattedMessage,{defaultMessage:"Try different search terms or filters",id:"searchErrorMenuItem.errorPrompt.searchTermsAndFilters"}):(0,ge.jsx)(H.FormattedMessage,{defaultMessage:"Try different search terms",id:"searchErrorMenuItem.errorPrompt.searchTerms"})}(s);return{title:In,caption:n}}const c=(0,o.VK)((()=>j.ZP.state.query.filters),[]);return(0,ge.jsx)(xn,{...function(s){const n=e.error;switch(n.type){case Ht.Ix.NoResults.type:return d(s);case Ht.Ix.Offline.type:return function(){const e=(0,ge.jsx)(H.FormattedMessage,{defaultMessage:"Go online for more results.",id:"searchErrorMenuItem.errorPrompt.goOnline"});return{title:In,caption:e}}();case Ht.Ix.RequestFailed.type:return{title:(0,ge.jsx)(H.FormattedMessage,{id:"searchErrorMenuItem.error.genericErrorMessage",defaultMessage:"Something went wrong"}),caption:(0,ge.jsx)(H.FormattedMessage,{id:"searchErrorMenuItem.errorPrompt.refreshOrReport",defaultMessage:"Try refreshing or <reportlink>report a problem</reportlink>.",values:{reportlink:e=>(0,ge.jsx)(vn.Z,{onClick:l,style:t.reportProblemButton,children:e})}})};default:(0,W.t1)(n)}}(a??!1),style:t.menuItem,captionStyle:t.caption,shouldWrapCaption:!0})};var jn=s(469680);const wn=8;function kn(e){const{numberOfShimmerResults:t,assistantActionsEnabled:s}=e,n=t===wn&&s,r=(0,i.yK)((e=>({container:{margin:(n?"0px":"8px")+" 10px 6px 10px",display:"flex",flexDirection:"column",gap:10},icon:{width:20,height:20,borderRadius:5,marginLeft:6},titleAndPath:{width:"100%",display:"flex",flexDirection:"column",gap:5},title:{height:18,borderRadius:5},path:{height:12,borderRadius:5},resultContainer:{display:"flex",gap:10,boxShadow:`0 1px 0 ${e.lightDividerColor}`,paddingBottom:10},sectionHeader:{marginBottom:7,marginTop:8}})),[n]),o=Array.from({length:t},(()=>!0));return(0,ge.jsxs)("div",{children:[n&&(0,ge.jsx)(re.Z,{desktopTitleStyle:r.sectionHeader,title:(0,ge.jsx)(H.FormattedMessage,{id:"search.searchResultsShimmer.bestMatches.text",defaultMessage:"Best matches"})}),(0,ge.jsx)("div",{style:r.container,children:o.map(((e,t)=>(0,ge.jsxs)("div",{style:{...r.resultContainer,...t===o.length-1&&{boxShadow:"none"}},children:[(0,ge.jsx)(hn.Z,{style:r.icon}),(0,ge.jsxs)("div",{style:r.titleAndPath,children:[(0,ge.jsx)(hn.Z,{style:{...r.title,width:d.UP(["30%","45%","55%","60%","70%","75%","80%","90%"])}}),(0,ge.jsx)(hn.Z,{style:{...r.path,width:d.UP(["10%","15%","20%","25%","30%","35%","55%","70%"])}})]})]},`shimmer-item-${t}`)))})]})}const Pn=n.memo(kn);function Tn(e,t,s){if(!t.isLoading)return t.showMajorError?(0,ge.jsx)(Mn,{error:t.serverError,handleSearchDeletedOnly:()=>{const t=j.ZP.state.query.text;Bs.IB(e),cn.Z.setState({...cn.Z.state,open:!0}),un.ZP.setState({...un.ZP.state,currentTab:"all_pages",filter:t,limit:un.ZP.startLimit})}}):t.serverError&&t.serverError!==Ht.Ix.NoResults?function(e,t){return(0,ge.jsx)(re.Z,{disableMobilePadding:!0,disableMobileBorders:!0,children:(0,ge.jsx)(pn.Z,{title:e,style:t})})}(t.serverError.message,s):void 0}function Rn(e,t){return(0,ge.jsx)(re.Z,{disableMobilePadding:!0,disableMobileBorders:!0,topBorder:!1,style:{marginTop:0,paddingTop:0},children:(0,ge.jsx)(Mt.Z,{body:e,bodyStyle:t})})}function Fn(e){const{type:t,title:s,icon:n,action:r,shouldShowArrowUp:o}=e;return{key:`actionMenuItem.${t}`,action:r,render:e=>(0,ge.jsx)(mn.Z,{type:t,...e,title:s,icon:n,shouldShowArrowUp:o})}}const Zn=(0,H.injectIntl)((function(e){var t,s,a,l,c,u,h;const[g,m]=(0,n.useState)(!1),x=(0,r.Fy)().isMobile,y=(0,i.yK)((e=>({results:{flex:1,display:"flex",flexDirection:"column",overflow:"auto",height:"100%"},messageMenuItem:{...x&&{background:void 0,boxShadow:void 0}},debugMessageMenuItemTextStyle:{whiteSpace:"pre-wrap",fontFamily:"monospace",marginTop:0},actionMenuItemTitle:{fontWeight:U.Z.fontWeight.medium,lineHeight:"20px",fontSize:15,color:e.mediumTextColor,textOverflow:"ellipsis",overflow:"hidden",display:"block"},menuListContainer:{display:"flex",flexDirection:"column",gap:12,marginTop:x?13:void 0,marginBottom:4}})),[x]),{searchResultStore:S,localResults:b,serverResults:C,resultListStore:M,searchExperimentOverrides:w,intl:k,assistantResultItem:P,extraTopPadding:T}=e,R=e.errorState,F=(0,o.VK)((()=>j.ZP.state.query.text),[]),{focusedIndexStore:Z}=(0,n.useContext)(B.SearchStaticContext),L=(0,o.VK)((()=>{var e;return null===(e=Z.state)||void 0===e?void 0:e.global}),[Z]),A=P?{key:"actions",render:e=>(0,ge.jsx)(re.Z,{...e,shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,extraTopPadding:T,title:(0,ge.jsx)(H.FormattedMessage,{id:"search.searchActions.actions.text",defaultMessage:"Actions"}),titleClassName:p.Xjk}),items:d.oA([Fn({...P,title:P.renderTitle(F,k,y.actionMenuItemTitle),shouldShowArrowUp:void 0!==P.shouldShowArrowUp&&P.shouldShowArrowUp({currentGlobalFocusedIndex:L})})])}:void 0,D=(0,o.VK)((()=>(0,f.XP)()),[]),E=(0,v.IV)({intentBasedGrouping:D,localResults:b,serverResults:C}),{allSearchResults:V}=E,q=(0,n.useCallback)((t=>{const{results:s,sectionTitle:r,compact:o}=t,{id:i,title:a}=function(e){if(!e)return{id:"allSearchResults",title:void 0};switch(e.type){case"unique-id":return{id:"uniqueIdSearchResults",title:(0,ge.jsx)(H.FormattedMessage,{id:"search.searchResultBuckets.uniqueID.text",defaultMessage:"ID matches"})};case"jump-back-in":return{id:"jumpBackInSearchResults",title:(0,ge.jsx)(H.FormattedMessage,{id:"search.searchResultBuckets.topResults.text",defaultMessage:"Top results"})};case"server":return{id:"serverOnlySearchResults",title:(0,ge.jsx)(H.FormattedMessage,{id:"search.searchResultBuckets.server.text",defaultMessage:"{count}{maybeLowerBoundSign} results",values:{count:e.values.count,maybeLowerBoundSign:e.values.isLowerBound?"+":""}})};case"main":return{id:"mainSearchResults",title:(0,ge.jsx)(H.FormattedMessage,{id:"search.searchResultBuckets.bestMatches.text",defaultMessage:"Best matches"})};default:(0,W.t1)(e)}}(r);return s.length>0?{key:i,render:e=>(0,ge.jsx)(re.Z,{...e,shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:a,titleClassName:p.Xjk}),items:d.oA(s.map(((t,s)=>{var r;return function(e){var t;const{selectedResult:s,index:r,actionItemCount:o,allSearchResults:i,props:a,compact:l}=e,{store:d}=s,c=d.isNavigableBlock()?d:d.getNavigableBlockStore();if(!c)return;const u=n.createRef(),h=Boolean(I.ZP.getDebugLevel()),g=h&&s.sources.includes(Ht.vp.Local)?{id:s.id,localSource:s.localSource,score:s.score,localRelevancies:s.localRelevancies,frecencyScore:s.frecencyScore,personalizationBoost:s.personalizationBoost,terms:s.terms}:void 0,m=h&&(s.sources.includes(Ht.vp.ElasticSearch)||s.sources.includes(Ht.vp.VectorDBBlock)||s.sources.includes(Ht.vp.VectorDBCollection))?null===(t=a.debugInfo)||void 0===t||null===(t=t.response)||void 0===t?void 0:t.resultsDebugMap[d.id]:void 0,f=a.clusterInfo;return{key:`${d.id}:${r}`,action:e=>{const{event:t}=e;function n(e){const s=O.findDOMNode(e.current);return Boolean(s&&"target"in t&&t.target&&(s===t.target||s.contains(t.target)))}u.current&&n(u)||a.handleSelectResult({event:e.event,index:{local:e.indexLocal,global:e.index},selectedResult:s,allSearchResults:i,fromSidePeekPanel:!1,actionItemCount:o,context:"query_results"})},render:e=>{var t;return(0,ge.jsx)(jn.Z,{...e,index:r,originalPosition:s.originalPosition,isFirstInSection:0===r,store:c,hidePath:!1,result:s,className:p.ulv,debugLocal:g,debugHits:m,debugAreaRef:u,clusterInfo:f,inline:l&&!h,inlineCaptionMinWidthPercentage:20,queryId:null===(t=s.serverEventProperties)||void 0===t?void 0:t["server-queryId"],type:"query_results"})}}}({selectedResult:t,index:s,actionItemCount:(null==A||null===(r=A.items)||void 0===r?void 0:r.length)??0,allSearchResults:V,props:e,compact:o})})))}:void 0}),[null==A||null===(t=A.items)||void 0===t?void 0:t.length,V,e]),N=(0,o.VK)((()=>q({results:"intent-based-grouping"===E.type?E.sections.jumpBackInSearchResults:[],sectionTitle:{type:"jump-back-in"},compact:!0})),[q,E.sections,E.type]),K=(0,o.VK)((()=>{const e="intent-based-grouping"===E.type?E.sections.serverOnlySearchResults:[],{count:t,isLowerBound:s}=S.getResultCount();return q({results:e,sectionTitle:{type:"server",values:{count:t,isLowerBound:s}},compact:!1})}),[q,E.sections,E.type,S]),_=(0,o.VK)((()=>q({results:"uniqueIdSearchResults"in E.sections?E.sections.uniqueIdSearchResults:[],sectionTitle:{type:"unique-id"},compact:!1})),[q,E.sections]),z=(0,o.VK)((()=>q({results:"unique-id"===E.type?E.sections.nonUniqueIdSearchResults:"all"===E.type?E.sections.allSearchResults:[],sectionTitle:"unique-id"===E.type||((null==A?void 0:A.items)??[]).length>0?{type:"main"}:void 0,compact:!1})),[null==A?void 0:A.items,q,E.sections,E.type]),$=[A,N,_,K,z].filter(W.$K),G=null===(s=e.debugInfo)||void 0===s||null===(s=s.response)||void 0===s?void 0:s.parsedQueries,Q=null===(a=e.debugInfo)||void 0===a||null===(a=a.response)||void 0===a?void 0:a.detectedLanguages,X=null===(l=e.debugInfo)||void 0===l?void 0:l.traceLogs,J=null===(c=e.debugInfo)||void 0===c||null===(c=c.response)||void 0===c?void 0:c.debugUrls,Y=(0,n.useCallback)(((t,s)=>{const{onMaybeLoadMoreResults:n}=e,r=t<=200;r&&!g&&n(),m(r),s.offsetFromTop&&j.ZP.update((e=>({...e,hasScrolled:!0})))}),[g,e]),ee=0===((null==b?void 0:b.length)??0)&&"serverError"in R&&"NoResultsFound"===(null===(u=R.serverError)||void 0===u?void 0:u.type)?0:(null==A||null===(h=A.items)||void 0===h?void 0:h.length)??0,te=(0,o.VK)((()=>Ls.Z.showSearchAiFeatures()),[]),se=(0,r.O7)(),ne=(0,o.VK)((()=>{const e=void 0===C;if(!(e&&(te||(0,f.rd)(se))))return 0;const t=S.state.serverResultsLoading,s=(null==b?void 0:b.length)??0,n="serverError"in R&&void 0!==R.serverError;return(e&&!t||t)&&!n?wn-s:0}),[se,S,null==b?void 0:b.length,C,R,te]);return(0,ge.jsx)(B.SearchStaticContext.Consumer,{children:e=>{let{queryResultsSectionRef:t}=e;return(0,ge.jsxs)("section",{style:y.results,ref:t,children:[!d.xb(w)&&Rn((0,ge.jsx)(ge.Fragment,{children:(0,ge.jsx)(Vs.Ki,{data:{searchExperimentOverrides:w},showCopyButton:!1,showModalButton:!1,defaultCollapsed:!1})}),y.debugMessageMenuItemTextStyle),G&&Rn((0,ge.jsx)(Vs.Ki,{data:{parsedQueries:G},customCollapsedRenderers:[Dn],showCopyButton:"small",showModalButton:!0,defaultCollapsed:!0}),y.debugMessageMenuItemTextStyle),Q&&Rn((0,ge.jsx)(Vs.Ki,{data:{detectedLanguages:Q},customCollapsedRenderers:[Ln]}),y.debugMessageMenuItemTextStyle),X&&Rn((0,ge.jsx)(Vs.Ki,{data:{tracer:{traceLogs:X}},customCollapsedRenderers:[On],defaultCollapsed:!0}),y.debugMessageMenuItemTextStyle),J&&Rn((0,ge.jsx)(Vs.Ki,{data:{debugUrls:J},defaultCollapsed:!0,customCollapsedRenderers:[Vn],showCopyButton:"small",showModalButton:!0,maxLinkValueLength:40}),y.debugMessageMenuItemTextStyle),$&&(0,ge.jsx)("div",{className:"search-results-list",children:(0,ge.jsx)(Ie.Z,{type:Ie.i.Vertical,initialFocus:ee,store:M,disableKeyboardArrowWrap:!0,sections:$,style:y.menuListContainer})}),Tn(se,R,y.messageMenuItem)||(0,ge.jsx)(gn.Z,{onChange:Y}),ne>0&&(0,ge.jsx)(Pn,{numberOfShimmerResults:ne,assistantActionsEnabled:te})]})}})}));function Bn(e){const t=e.replaceAll(/\(MatchNoDocsQuery\("Matching no documents because no terms present"\)\)\^[0-9\.]/g,"").replaceAll(/MatchNoDocsQuery\("Matching no documents because no terms present"\)/g,"").replaceAll(/ConstantScore\(([^)]+):([^)]+)\)/g,"<i>$1</i>:<b>$2</b>").replace(/function score \(\((.*)\), functions:.*\)/,"$1").replaceAll("( ","(").replaceAll(" )",")").replaceAll("|","| <br/>").replaceAll(/([^( ]+):"([^"]+)"/g,'<i>$1</i>:<b>"$2"</b>').replaceAll(/([^( ]+):([^) ]+)/g,"<i>$1</i>:<b>$2</b>");return(0,ge.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})}function On(e){let{data:t,keyPath:s}=e;if("traceLogs"===(null==s?void 0:s[0])&&d.PO(t)&&Array.isArray(t.log)&&t.log.length>0){const{log:e,startTimeMs:s}=t;return{element:(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsx)("div",{children:(0,ge.jsx)("b",{children:`Trace started at ${s}`})}),e.map(((e,t)=>(0,ge.jsxs)("div",{children:[(0,ge.jsx)("span",{style:En,children:`[${e.timestamp-s}ms][${e.callerFileName.split(".")[0]}]`}),(0,ge.jsx)("span",{children:`${e.msg}`})]},t)))]}),expanded:!1}}return null}function Ln(e){let{data:t,keyPath:s}=e;return"detectedLanguages"===s.join(".")&&d.PO(t)?{element:(0,ge.jsx)(ge.Fragment,{children:Object.entries(t).filter((e=>{let[t,s]=e;return Boolean(s)})).map((e=>{let[t]=e;return t})).join(", ")||"None"}),expanded:!1}:null}const An=["type","description","time_in_nanos"];function Dn(e){var t,s;let{data:n,keyPath:r}=e;const o=n,i=Object.values(o).find((e=>void 0!==e));if(!i)return null;if(!An.every((e=>i[e])))return null;if(1===r.length)return{element:Bn(i.description),expanded:!1};let a=i.description??"";return null!==(t=a)&&void 0!==t&&t.includes("permissions.teamIds")&&(a="PermissionsQuery"),null!==(s=a)&&void 0!==s&&s.includes("(_id:[")&&(a="BoostRecentPageIds"),{element:Bn(a),expanded:!1}}const En={color:"blue"};function Vn(e){let{data:t}=e;const s=t;if(!s)return null;const n=Object.values(s).find((e=>{let{clusterName:t}=e;return void 0!==t}));if(n){const{clusterName:e}=n;return{element:(0,ge.jsx)(ge.Fragment,{children:e}),expanded:!1}}return{element:(0,ge.jsx)(ge.Fragment,{children:"unknown"}),expanded:!1}}const qn=function(e){const{searchResultStore:t,sxsMode:s,searchDebugColumnStore:a,extraTopPadding:l}=e,d=(0,r.O7)(),c=(0,r.Fy)(),u=(0,o.VK)((()=>Ls.Z.shouldShowSearchMenuItemAskAI(c)),[c]),h=(0,i.yK)((e=>({container:{display:"flex",flexDirection:"column",width:s?"50%":"100%",flex:1,overflow:"hidden",paddingTop:u?void 0:5},askAiLabel:{color:e.regularTextColor,fontWeight:U.Z.fontWeight.medium,fontSize:14},askAiQuery:{fontWeight:U.Z.fontWeight.regular},askAiIcon:{fill:e.aiPurpleColor}})),[s,u]),p=(0,o.qz)(void 0,Ds.Z),g=(0,o.VK)((()=>p.state.focus),[p]),{handleSelectSearchResult:m,focusedIndexStore:x,shouldShowAssistantResultStore:y,isQuickSearch:S}=(0,n.useContext)(B.SearchStaticContext),{localResults:C,serverResults:M,clusterInfo:w,debugInfo:k,serverResultsLoading:P,searchExperimentOverrides:T,hasPublicAccessPermission:R,errorState:F,serverResultsAllLoaded:Z}=(0,o.VK)((()=>{var e,s;const{hasPublicAccessPermission:n}=v.bC(d);return{localResults:t.state.localResults,serverResults:t.state.serverResults,serverResultsLoading:t.state.serverResultsLoading,clusterInfo:null===(e=t.state.serverResults)||void 0===e?void 0:e.clusterInfo,debugInfo:null===(s=t.state.serverResults)||void 0===s?void 0:s.debugInfo,searchExperimentOverrides:a.state.searchExperimentOverrides,hasPublicAccessPermission:n,errorState:t.state.errorState,serverResultsAllLoaded:t.state.serverResultsAllLoaded}}),[t,a,d]),O=!1===F.isLoading&&F.showMajorError,L=Boolean(C||M),A=(0,n.useCallback)((()=>{!P&&!Z&&void 0!==M&&j.ZP.update((e=>({...e,limit:e.limit+j.Xv,isScrolled:!0,source:"quick_find_scroll"})))}),[P,Z,M]),D=(0,o.VK)((()=>v.oO({localResults:null==C?void 0:C.results,serverResults:null==M?void 0:M.results})),[C,M]),E=(0,o.VK)((()=>{if(s)return;const e={type:"assistant",renderTitle:(e,t,s)=>function(e,t){return(0,ge.jsx)("div",{className:"notranslate",style:t,children:e})}((0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsx)("span",{children:(0,ge.jsx)(H.FormattedMessage,{id:"searchResultsBody.askAiMenuItem.title",defaultMessage:"Ask AI"})}),(0,ge.jsx)("span",{style:h.askAiQuery,children:e?` ${e}`:""})]}),{...s,...h.askAiLabel}),icon:e=>(0,ge.jsx)(Os.f,{style:{...e,...h.askAiIcon},variant:"xsmall"}),action:e=>{Bs.Ky({environment:d,shouldResetAssistantStore:j.ZP.state.query.text.length>0||As.default.wasActiveSessionLastOpenedOutsideOfHistorySavedWindow(),quickSearchMode:S,device:c,event:e.event})},shouldShow:()=>b.Z.state.online&&Ls.Z.shouldShowSearchMenuItemAskAI(c),shouldShowArrowUp:e=>{let{currentGlobalFocusedIndex:t}=e;return void 0!==t&&1===t}};return e.shouldShow(d)?e:void 0}),[s,h.askAiQuery,h.askAiLabel,h.askAiIcon,d,c,S],{useDeepEqual:!0}),V=(0,o.VK)((()=>s||!E?0:(y.update((e=>!0)),1)),[s,E,y]);(0,o.VK)((()=>{const e=t.state.insertedActionResultsCount,s=V;e!==s&&t.update((e=>({...e,insertedActionResultsCount:s})))}),[t,V]);const q=(0,n.useCallback)((()=>p.update((e=>e.focus.isInitialized&&0===e.focus.section&&0===e.focus.indexLocal&&0===e.focus.indexGlobal||void 0!==D&&void 0!==e.focus.indexGlobal&&e.focus.indexGlobal<=D.length?e:{...e,focus:E?{section:1,indexLocal:0,indexGlobal:1}:{section:0,indexLocal:0,indexGlobal:0}}))),[p,D,E]);(0,n.useEffect)((()=>{q()}),[D,q]),(0,n.useEffect)((()=>{void 0!==g.section&&void 0!==g.indexLocal&&void 0!==g.indexGlobal?x.setState({local:{section:g.section,indexLocal:g.indexLocal},global:g.indexGlobal}):x.setState(void 0)}),[x,g]);const N=(0,o.VK)((()=>{const e=I.ZP.state.showDebugInfo;return!O&&L&&!c.isMobile&&!(0,f.rd)(d)||e||s}),[c.isMobile,L,O,s,d]);return(0,ge.jsxs)("div",{style:h.container,children:[(0,ge.jsx)(Zn,{errorState:F,handleSelectResult:m,onMaybeLoadMoreResults:A,resultListStore:p,searchResultStore:t,localResults:null==C?void 0:C.results,serverResults:null==M?void 0:M.results,debugInfo:k,clusterInfo:w,publicAccessPermission:R,searchExperimentOverrides:T,assistantResultItem:E,extraTopPadding:l}),(0,ge.jsx)(on,{searchResultStore:t,showSpinner:P,shouldShow:N})]})};function Nn(e){const{searchContentPaneType:t}=e,{searchFilterMenuRef:s,handleSelectSearchResult:a,searchResultStore:l,secondarySearchResultStore:d}=(0,n.useContext)(B.SearchStaticContext),c=(0,r.Fy)(),{errorState:u,shouldShowSxSView:h}=(0,o.VK)((()=>({shouldShowSxSView:Boolean((0,I.gq)({device:c})&&I.BJ.state.visible),errorState:l.state.errorState})),[l,c]),p=(0,i.yK)((()=>({container:{display:"flex",flexDirection:"column",width:h?"50%":"100%"},sxsContainer:{display:"flex",flexDirection:"row",height:"100%",overflow:"hidden",maxWidth:"100%"}})),[h]),g=!1===u.isLoading&&u.showMajorError,m=(0,o.VK)((()=>j.ZP.state.filterBar.show),[]),f=!c.isMobile&&!m,v={searchResultStore:l,searchDebugColumnStore:I.v_,sxsMode:h,extraTopPadding:f},x=(0,o.VK)((()=>{var e;return null===(e=S.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]);return(0,ge.jsxs)(ge.Fragment,{children:[!c.isMobile&&m&&(0,ge.jsx)(Zs,{isMobile:c.isMobile}),"search_results"===t?(0,ge.jsxs)(ge.Fragment,{children:[!g&&c.isMobile&&(0,ge.jsx)(Ye,{isMobile:!0,mode:Ge.Section,ref:s}),(0,ge.jsxs)("div",{style:p.sxsContainer,children:[(0,ge.jsx)(qn,{...v}),h&&(0,ge.jsx)(qn,{...v,searchResultStore:d,searchDebugColumnStore:I.BJ})]})]}):x?(0,ge.jsx)(Ot.Z,{onSelect:a,spaceId:x,extraTopPadding:f}):null]})}var Kn=s(266897),_n=s(97439),Hn=s(727714),Wn=s(418442),Un=s(11751),zn=s(590683),$n=s(637034),Gn=s(816402),Qn=s(883165),Xn=s(573063),Jn=s(58261),Yn=s(584076),er=s(731278),tr=s(526388);function sr(e){const{itemName:t,itemValue:s,associatedUser:n}=e,r=(0,i.yK)((e=>({itemName:{fontSize:12,color:e.lightTextColor},itemValue:{fontSize:12,...n&&{display:"grid",gridTemplateColumns:"1fr auto auto",gap:5,textAlign:"right"}},itemContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:12},metadataActorName:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}})),[n]),o=n;return(0,ge.jsxs)("div",{style:r.itemContainer,children:[(0,ge.jsx)("div",{style:r.itemName,children:t}),(0,ge.jsxs)("div",{style:r.itemValue,children:[o&&(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsx)(tr.Z,{delayThreshold:50,placement:wt.u.Top,allowHover:!0,renderTooltip:()=>(0,ge.jsxs)("div",{style:{display:"flex",gap:5},children:[o.avatar,o.name]}),closeDelay:0,render:e=>(0,ge.jsx)("span",{...e,style:r.metadataActorName,children:o.name})}),(0,ge.jsx)("span",{children:""})]}),(0,ge.jsx)("span",{children:s})]})]})}const nr={createdBy:(0,ge.jsx)(H.FormattedMessage,{id:"search.preview.metadata.createdBy",defaultMessage:"Created by"}),created:(0,ge.jsx)(H.FormattedMessage,{id:"search.preview.metadata.created",defaultMessage:"Created"}),lastEditedBy:(0,ge.jsx)(H.FormattedMessage,{id:"search.preview.metadata.lastEditedBy",defaultMessage:"Last edited by"}),lastEdited:(0,ge.jsx)(H.FormattedMessage,{id:"search.preview.metadata.lastEdited",defaultMessage:"Edited"})},rr={type:"page_content"},or="large";function ir(e){var t;const{selectedResult:s,onClickPreview:l,handleClickCopyLink:d}=e,c="page_result"===s.type,h=(0,i.yK)((e=>({sidePeekPanel:{width:250,overflowY:"auto",overflowX:"hidden",minHeight:400,borderLeft:`1px solid ${e.lightDividerColor}`,display:"flex",flexDirection:c?"column":"row",justifyContent:c?"space-between":"center",alignItems:c?"normal":"center",zIndex:1},emoji:{width:20},sidePeekContentContainer:{margin:16},report:{fontSize:12,position:"absolute",bottom:0,right:0,margin:16,display:"flex",gap:10},sidePeekActionContainer:{margin:16},pageIconAndTitleContainer:{marginTop:12,display:"flex",gap:8,flexDirection:"column",justifyContent:"space-between"},title:{fontSize:16,fontWeight:U.Z.fontWeight.semibold,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},untitledPageColor:{color:e.text.tertiary},titleAndLinkContainer:{display:"grid",gridTemplateColumns:"1fr auto",width:"fit-content",gap:5},previewContainer:{marginTop:8,marginBottom:8,display:"flex",flexDirection:"column",position:"relative"},hoveredOrPressedPreview:{background:"unset",boxShadow:"unset"},preview:{borderRadius:6,background:"unset",boxShadow:"unset",border:`1px solid ${e.lightDividerColor}`,padding:12},contentCover:{color:e.text.primary,fontSize:11,lineHeight:1.5,marginBottom:0,width:"110%",transform:"translateX(-12px) translateY(-4px) scale(0.91)",paddingLeft:12,paddingRight:12,paddingTop:12,paddingBottom:0,borderRadius:6,border:`1px solid ${e.lightDividerColor}`,background:"transparent"},contentCoverFade:{height:48,background:`linear-gradient(to bottom, transparent, ${"light"===e.mode?e.contentBackground:e.sidebarBackground} 100%)`},metadataContainer:{marginTop:8,display:"flex",flexDirection:"column",gap:8},action:{borderRadius:4,background:"unset",fontSize:12,display:"flex"},metadataActorWrapper:{overflow:"hidden"},metadataActorAvatar:{marginRight:5},doubleChevronIcon:{color:e.accentColors.gray[400],cursor:"pointer",width:"max-content"},debugGearIcon:{color:e.accentColors.gray[400]},hoveredDebugGearIcon:{color:e.accentColors.gray[600]}})),[c]),p=(0,o.VK)((()=>h.sidePeekPanel),[h.sidePeekPanel]),m=(0,r.O7)(),f=(0,H.useIntl)(),v=(0,o.VK)((()=>"page_result"===s.type?{type:"page_result",store:s.value.selectedResult.store}:{type:"assistant",store:void 0}),[s]),x=(0,o.VK)((()=>{if("page_result"!==v.type)return;const e=(0,$n.V)(v.store,f,m,!Ls.Z.isXMLAssistantEnabled());return e&&e.trim().length>0?e:void 0}),[f,m,v]),y=(0,n.useCallback)((e=>{const{id:t,spaceStore:s,table:n,showAvatar:r}=e;if(void 0===t||void 0===n)return;const o=(0,Kn.Hl)({pointer:{id:t,spaceId:s.id,table:n},getRecordModel:s.getRecordModel}).asActor;return!o||o.isUser()&&!(0,Qn.VK)(s,o.id).isMember()||o.isBot()&&!(0,Qn.Wz)(s,o.id).isMember()?void 0:{name:(0,Kn.$4)(f,o),avatar:r?(0,zn.a)({actor:o,size:18,style:h.metadataActorAvatar}):void 0}}),[f,h.metadataActorAvatar]),b=(0,n.useCallback)((e=>(0,Gn.IS)(e,{useUltraCompactFormat:!0,useWeeks:!0,useLowercase:!0})),[]),{createdBy:C,created:I,lastEditedBy:M,lastEdited:w}=(0,o.VK)((()=>{const e=S.default.state.currentSpaceStore;if(void 0===e||"page_result"!==s.type)return{createdBy:void 0,created:void 0,lastEditedBy:void 0,lastEdited:void 0};const t=s.value.selectedResult.store;return{createdBy:y({id:t.getCreatedById(),table:t.getCreatedByTable(),spaceStore:e,showAvatar:!0}),created:b(t.getCreatedTime()),lastEditedBy:y({id:t.getLastEditedById(),table:t.getLastEditedByTable(),spaceStore:e,showAvatar:!0}),lastEdited:b(t.getLastEditedTime())}}),[b,y,s]),k=[{key:"created",itemName:nr.created,itemValue:I,associatedUser:C},{key:"lastEdited",itemName:nr.lastEdited,itemValue:w,associatedUser:M}],{previewIcon:P,isEmptyPage:T}=(0,o.VK)((()=>{if("page_result"!==s.type)return{previewIcon:void 0,isEmptyPage:!0};const e=s.value.selectedResult.store;return{previewIcon:e.getIcon(),isEmptyPage:e.isEmptyPage()}}),[s]),R=(0,o.VK)((()=>{if("page_result"!==s.type)return;const e=s.value.selectedResult.store;return(0,g.ZP)({store:e,collectionViewId:e.id,fullyQualified:!0,pageVisitSource:a.tY.SearchQuery})}),[s]),F=(0,n.useCallback)((()=>{R&&(u.RD({environment:m,stringValue:R,copiedMessage:u.tq.copiedLinkToClipboard}),d&&d({source:B.SearchCopyLinkSource.SidePeekPanel}))}),[d,m,R]),Z=(0,o.VK)((()=>X.default.checkGate({gateName:"search_toggle_side_peek"})),[]),O=(0,o.VK)((()=>X.default.checkGate({gateName:"search-show-report-bad-search"})),[]),{searchResultStore:L}=(0,n.useContext)(B.SearchStaticContext),{localResults:A,serverResults:D}=(0,o.VK)((()=>{const{localResults:e,serverResults:t}=L.state;return{localResults:e,serverResults:t}}),[L]),E=(0,_.x)(z.default);return(0,ge.jsxs)("aside",{style:p,children:[(0,ge.jsx)("div",{style:h.sidePeekContentContainer,children:"page_result"===s.type?(0,ge.jsxs)(ge.Fragment,{children:[Z&&(0,ge.jsx)("div",{onClick:()=>Bs.bn(),style:h.doubleChevronIcon,children:(0,_n.D)({width:15,height:15})}),(0,ge.jsxs)("div",{style:h.pageIconAndTitleContainer,children:[(0,ge.jsx)(er.Z,{disabled:!0,icon:P,isEmptyPage:T,size:26,largeIcon:!0}),(0,ge.jsxs)("span",{style:h.titleAndLinkContainer,children:[(0,ge.jsx)("span",{style:{...h.title,...!x&&h.untitledPageColor},children:x??(0,ge.jsx)(H.FormattedMessage,{id:"search.preview.untitledPage",defaultMessage:"Untitled"})}),(0,ge.jsx)(lr,{onClick:F})]})]}),(0,ge.jsx)(Yn.Z,{style:h.previewContainer,href:R,hoveredStyle:h.hoveredOrPressedPreview,pressedStyle:h.hoveredOrPressedPreview,onClick:l,children:(0,ge.jsx)(Vs.Ss,{variant:"default",store:s.value.selectedResult.store,coverFormat:rr,coverSizeFormat:or,showEmptyGalleryCover:!1,coverContentFadedOverlay:!0,coverContentFadedOverlayStyle:h.contentCoverFade,contentWrapStyle:h.contentCover,coverHeight:180,onLoadProxiedImage:()=>{},renderAdditionalBlocks:!0,rendererBlockStyle:{fontSize:9}})}),(0,ge.jsx)("div",{style:h.metadataContainer,children:k.filter((e=>void 0!==e.itemValue)).map(((e,t)=>(0,ge.jsx)(sr,{isFirstInList:0===t,itemName:e.itemName,itemValue:e.itemValue,associatedUser:e.associatedUser},e.key)))})]}):(0,ge.jsx)(ar,{query:s.value??""})}),O?(0,ge.jsxs)("div",{style:h.report,children:[(0,ge.jsx)(tn,{exposedSearchExperiments:null==D||null===(t=D.serverEventProperties)||void 0===t?void 0:t["server-searchExperiments"],localResults:null==A?void 0:A.results,serverResults:null==D?void 0:D.results,debugInfo:null==D?void 0:D.debugInfo}),E&&(0,ge.jsx)(Xn.Z,{ariaLabel:"Button to open search's debug side panel",onClick:()=>j.ZP.setState({...j.ZP.state,isDebugSidebarOpen:!0}),style:h.debugGearIcon,hoveredStyle:h.hoveredDebugGearIcon,icon:e=>(0,Wn.H)({width:12,height:12})})]}):null]})}function ar(e){const{query:t}=e,s=(0,i.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:30},chatAndAvatarContainer:{display:"flex",gap:6,alignItems:"flex-end"},chatContainer:{display:"flex",flexDirection:"column",gap:10,flexGrow:1,justifyContent:"center"},questionBubble:{backgroundColor:e.cardHoveredBackground,color:e.lightTextColor,padding:8,borderRadius:16,fontSize:12,minWidth:40,minHeight:32,width:"fit-content",maxWidth:180,alignSelf:"flex-end",userSelect:"none",overflow:"hidden",textOverflow:"ellipsis"},introBubble:{backgroundColor:e.accentColors.purple[50],color:e.accentColors.purple[500],padding:"8px 12px",borderRadius:16,fontSize:14,width:170,userSelect:"none",overflow:"hidden",display:"flex",flexDirection:"column",gap:6,textOverflow:"ellipsis"},helperDescription:{textAlign:"center",fontSize:12,color:e.lightTextColor,display:"flex",justifyContent:"center"},loadingDots:{border:`1px solid ${e.lightDividerColor}`,padding:12,borderRadius:100,width:"max-content"},writingIndicatorCircle:{height:5,width:5,opacity:.6,backgroundColor:e.lightIconColor,borderRadius:"100%"},writingButtonWrapper:{display:"flex",alignItems:"center",justifyContent:"center",gap:3,width:"inherit",height:"inherit"}})),[]);return(0,ge.jsxs)("div",{style:s.container,children:[(0,ge.jsxs)("div",{style:s.chatAndAvatarContainer,children:[(0,ge.jsx)(dr,{}),(0,ge.jsx)("div",{style:s.chatContainer,children:t?(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsx)("div",{style:s.questionBubble,children:t}),(0,ge.jsx)("div",{style:s.loadingDots,children:(0,ge.jsxs)("div",{role:"decorative",style:s.writingButtonWrapper,children:[(0,ge.jsx)("div",{role:"decorative",style:s.writingIndicatorCircle}),(0,ge.jsx)("div",{role:"decorative",style:s.writingIndicatorCircle}),(0,ge.jsx)("div",{role:"decorative",style:s.writingIndicatorCircle})]})})]}):(0,ge.jsxs)("div",{style:s.introBubble,children:[(0,ge.jsx)("div",{children:(0,ge.jsx)(H.FormattedMessage,{id:"searchSidePeekPanel.welcomeMessage.title",defaultMessage:"Hi! Im Notion AI."})}),(0,ge.jsx)(H.FormattedMessage,{id:"searchSidePeekPanel.welcomeMessage.caption",defaultMessage:"Let me help you find information and answer questions."})]})})]}),(0,ge.jsx)("div",{style:s.helperDescription,children:(0,ge.jsx)("div",{style:{width:"90%"},children:(0,ge.jsx)(H.FormattedMessage,{id:"SearchSidePeek.caption",defaultMessage:"Get quick answers for anything in your workspace"})})})]})}function lr(e){const t=(0,r.Fy)(),s=(0,i.yK)((e=>({linkIcon:{width:14,height:14,fill:"light"===e.mode?e.accentColors.gray[300]:e.accentColors.gray[500]},hoveredBackground:{backgroundColor:e.buttonHoveredBackground},shortcutLabel:{color:e.mediumInvertedTextColor},tooltipContent:{display:"flex",flexDirection:"column"}})),[]),n=(0,o.VK)((()=>t.isElectron),[t]);return(0,ge.jsx)(tr.Z,{delayThreshold:600,placement:wt.u.Top,allowHover:!0,renderTooltip:()=>(0,ge.jsxs)("div",{style:s.tooltipContent,children:[(0,ge.jsx)(H.FormattedMessage,{id:"search.preview.copyLink",defaultMessage:"Copy link"}),n&&(0,ge.jsx)(Jn.Z,{style:s.shortcutLabel,name:"copyLinkToCurrentPage"})]}),closeDelay:0,render:t=>(0,ge.jsx)(Xn.Z,{...t,icon:e=>(0,Hn.N)(s.linkIcon),ariaLabel:"Button to toggle the filter bar",hoveredStyle:s.hoveredBackground,onClick:e.onClick})})}function dr(){const e=(0,i.yK)((e=>({faceImgWrap:{width:32,height:32,borderRadius:"100%",background:e.whiteButtonBackground,border:`1px solid ${e.lightDividerColor}`,overflow:"hidden",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center"},faceImg:{width:40,pointerEvents:"none"},aiSparklesFill:{height:14,width:14,fill:e.mediumIconColor,pointerEvents:"none"}})),[]);return(0,ge.jsx)("div",{style:e.faceImgWrap,children:(0,Un.t)(e.aiSparklesFill)})}const cr=570;function ur(e){const t=(0,r.Fy)(),s=(0,r.O7)();return(0,n.useEffect)((()=>{h.S(s)}),[s]),(0,x.Z)(),(0,ge.jsx)(k.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!t.isMobile,render:()=>(0,ge.jsx)(w.Z,{capture:!0,allowMenuList:!0,render:t=>(0,ge.jsx)(hr,{...e,ignoreAreaEvents:t})})})}function hr(e){const{ignoreAreaEvents:t,renderAsPage:s,quickSearchMode:l,onClose:c,searchContentPaneType:h}=e,{handleQueryChange:x,searchFilterMenuRef:y,modalBodyMenuRef:S,searchResultStore:w,focusedIndexStore:k,defaultBodyFocusedResultStore:R,shouldShowAssistantResultStore:F,handleSelectSearchResult:O,handleCopySearchItemLink:L}=(0,n.useContext)(B.SearchStaticContext),[A,D]=(0,n.useState)(!1),[E,V]=(0,n.useState)(!1),q=(0,r.O7)(),N=(0,r.Fy)(),K=(0,o.VK)((()=>j.ZP.state.query.text),[]),{isSearchMenuOpen:_,shouldShowDebugSidebar:H,hasPublicAccessPermission:W,shouldShowSpinner:U}=(0,o.VK)((()=>{const e=Boolean(b.Z.state.online),{hasPublicAccessPermission:t}=v.bC(q);return{isSearchMenuOpen:M.default.state.open,shouldShowSpinner:e&&Boolean(K)&&w.state.serverResultsLoading&&!A,shouldShowDebugSidebar:vr({device:N,isPublicAccessPermissionForPage:t}),hasPublicAccessPermission:t}}),[A,w,N,q,K]),z=(0,n.useMemo)((()=>d.Ds((()=>{const{activeElement:e}=document;e instanceof HTMLInputElement&&e.blur()}),500,{leading:!0})),[]),$=(0,n.useCallback)((()=>{E&&z()}),[z,E]),G=(0,n.useCallback)((e=>{V(e),e||N.isMobileNative&&C.Z.updateKeyboardPhase(q,C.i.willHide,0)}),[N.isMobileNative,q]),Q=(0,o.VK)((()=>F.state),[F]),X=(0,o.VK)((()=>v.pG({searchResultStore:w,focusedIndexStore:k,showingAssistantResult:Q})),[w,k,Q]),J=(0,o.VK)((()=>R.state),[R]),Y=(0,n.useMemo)((()=>(0,ge.jsx)(Bt.Z,{isOpen:Boolean(s||_),onTypingChange:D,onFocusChange:G,showSpinner:U,onQueryChange:x,quickSearchMode:l,selectedResultStore:"page_result"===(null==X?void 0:X.type)?X.value.selectedResult.store:void 0})),[s,_,G,U,x,l,X]),ee=(0,o.VK)((()=>pr({searchContentPaneType:h,renderAsPage:s,environment:q})),[h,s,q]),te=(0,i.yK)((e=>({body:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",zIndex:2},topbar:{height:void 0,marginTop:10,marginLeft:16,marginBottom:10,marginRight:16},topbarRightButtonWrapper:{flex:void 0,paddingLeft:16},topbarButton:{fontWeight:void 0,padding:0,color:e.mediumTextColor},scroller:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between",maxHeight:ee.maxHeight,minHeight:ee.minHeight}})),[ee.maxHeight,ee.minHeight]),se=(0,n.useMemo)((()=>{if(N.isMobile){return{menuType:m.og.Modal,left:Y,shouldRenderLeftDirectly:!0,width:s?"100vw":void 0,...mr({isPhone:N.isPhone,renderAsPage:s,style:te.topbarRightButtonWrapper,onClick:c}),header:"search_results"===h&&(0,ge.jsx)(Rt,{isPublicPageSearch:W}),disableHeaderShadow:!0,topbarStyle:te.topbar,leftRightButtonStyle:te.topbarButton,onScroll:fr(N)?$:void 0,bodyScrollerClassName:p.GZn,...t}}return{menuType:m.og.Popup,maxHeight:ee.maxHeight,minHeight:ee.minHeight,maxWidth:"100%",...l?{width:"100vw"}:{},disableScroller:!0,scrollerStyle:te.scroller,...t}}),[N,te,t,Y,s,c,h,W,$,ee.minHeight,ee.maxHeight,l]),ne=J||X;"assistant"===(null==ne?void 0:ne.type)&&(ne.value=K);const re=(0,o.VK)((()=>{if("page_result"===(null==ne?void 0:ne.type)){const{index:e,selectedResult:t,allSearchResults:s}=ne.value;return n=>O({event:n,index:e,selectedResult:t,allSearchResults:s,fromSidePeekPanel:!0,actionItemCount:F?1:0,context:"search_results"===h?"query_results":"recent_pages"})}}),[O,h,ne,F]),oe=(0,o.VK)((()=>{if("page_result"===(null==ne?void 0:ne.type)){const{index:e,selectedResult:t,allSearchResults:s}=ne.value;return n=>{const{source:r}=n;L({index:e,selectedResult:t,allSearchResults:s,fromSidePeekPanel:r===B.SearchCopyLinkSource.SidePeekPanel,actionItemCount:F.state?1:0,context:"search_results"===h?"query_results":"recent_pages",source:r})}}}),[L,h,ne,F]),ie=(0,o.VK)((()=>!(0,f.bN)(q)&&q.WindowSizeStore.state.width<B.DEFAULT_MODAL_WIDTH_WITH_SIDE_PEEK),[q]),ae=(0,o.VK)((()=>!((0,I.gq)({device:N})||ie||j.ZP.state.isDebugSidebarOpen||void 0===ne||"default_body"===h)&&(0,f.Qi)(q)),[q,h,ne,N,ie]);(0,o.VK)((()=>{j.ZP.state.isSidePeekPanelOpen!==ae&&j.ZP.update((e=>({...e,isSidePeekPanelOpen:ae})))}),[ae]);const le=(0,n.useCallback)((()=>{if(!q.device.isElectron||!ne||"page_result"!==ne.type)return;const e=ne.value.selectedResult.store,t=(0,g.Hu)({store:e,collectionViewId:e.id,fullyQualified:!0,pageVisitSource:a.tY.SearchQuery});t&&(u.RD({environment:q,stringValue:t,copiedMessage:u.tq.copiedLinkToClipboard}),oe&&oe({source:B.SearchCopyLinkSource.KeyboardShortcut}))}),[q,oe,ne]);return(0,ge.jsx)(P.Z,{debugName:"SearchContentPane",capture:!0,onCopyLinkToCurrentPage:e=>{le()},onCopyLinkToPageInCommandSearch:e=>{le()},children:(0,ge.jsx)(T.Z,{...se,className:p.Oau,ref:S,children:(0,ge.jsxs)(gr,{enableLazyLoading:s,children:[(0,ge.jsxs)("div",{style:te.body,children:[(0,ge.jsx)(Z.Z,{}),!N.isMobile&&Y,(0,ge.jsx)(Nn,{searchContentPaneType:h})]}),ae&&void 0!==ne?(0,ge.jsx)(ir,{selectedResult:ne,onClickPreview:re,handleClickCopyLink:oe}):void 0,H&&(0,ge.jsx)(Ye,{ref:y})]})})})}function pr(e){const{searchContentPaneType:t,renderAsPage:s,environment:n}=e;if(s)return{maxHeight:"100vh",minHeight:"100vh"};if((0,f.rd)(n)){const e=n.WindowSizeStore.state.height,s=(0,l.u3)(n.device.isElectronMac),r=e>cr+s?cr:0;return{minHeight:`max(${"search_results"===t?70:50}vh, ${r}px)`,maxHeight:`max(${"search_results"===t?70:50}vh, ${r}px)`}}return"assistant"===j.ZP.state.mode?{maxHeight:"80vh",minHeight:cr}:{maxHeight:"80vh",minHeight:50}}function gr(e){const{enableLazyLoading:t,children:s}=e,o=(0,r.O7)();return t?(0,ge.jsx)(F.Z,{fetch:async()=>{var e;await c.Vs(0),await S.default.waitUntil((()=>void 0!==S.default.state.currentSpaceStore)),null===(e=o.mobileNative)||void 0===e||e.markTransitionReady({type:"search"})},loading:()=>(0,ge.jsx)(n.Fragment,{}),render:()=>s}):(0,ge.jsx)(n.Fragment,{children:s})}function mr(e){let{isPhone:t,style:s,renderAsPage:n,onClick:r}=e;return t&&(0,y.Y)("supportsNativeHome")||n?{rightOuterStyle:{display:"none"}}:{right:(0,ge.jsx)(R.CancelMenuText,{}),onClickRight:r,rightOuterStyle:s}}function fr(e){return!!e.isMobile&&(!e.isIOS||e.isMobileNative)}function vr(e){let{device:t,isPublicAccessPermissionForPage:s}=e;if(!s&&!t.isMobile)return j.ZP.isDebugSidebarOpen()}},161496:(e,t,s)=>{s.d(t,{Z:()=>J,e:()=>X});s(757658);var n=s(667294),r=s(800480),o=s(886628),i=s(724405),a=s(815145),l=s(248780),d=s(11751),c=s(89101),u=s(421202),h=s(492338),p=s(709291),g=s(653965),m=s(401898),f=s(137810),v=s(240468),x=s(587531),y=s(244458),S=s(416091),b=s(81598),C=s(352823),I=s(296994),M=s(615447),j=s(548779),w=s(277907),k=s(966324),P=s(80444),T=s(521273),R=s(798180),F=s(788632),Z=s(424042),B=s(833110),O=s(319385),L=s(269327),A=s(229798),D=s(188923),E=s(206258),V=s(155320),q=s(27724),N=s(632163),K=s(543145),_=s(672495),H=s(333991),W=s(940465),U=s(59592),z=s(688357),$=s(469680),G=s(785893);function Q(e,t){return{store:e,id:e.id,score:-1,spaceId:e.getSpaceId(),sources:[h.vp.Local],featureGroups:[],originalPosition:t,serverEventProperties:void 0}}function X(e){switch(e){case"today":return(0,G.jsx)(p.FormattedMessage,{id:"search.recentPagesTimeBuckets.today.text",defaultMessage:"Today"});case"yesterday":return(0,G.jsx)(p.FormattedMessage,{id:"search.recentPagesTimeBuckets.yesterday.text",defaultMessage:"Yesterday"});case"past_week":return(0,G.jsx)(p.FormattedMessage,{id:"search.recentPagesTimeBuckets.pastWeek.text",defaultMessage:"Past week"});case"past_30_days":return(0,G.jsx)(p.FormattedMessage,{id:"search.recentPagesTimeBuckets.past30Days.text",defaultMessage:"Past 30 days"});case"older":return(0,G.jsx)(p.FormattedMessage,{id:"search.recentPagesTimeBuckets.older.text",defaultMessage:"Older"})}(0,m.t1)(e)}const J=function(e){const{onSelect:t,spaceId:s,extraTopPadding:h}=e,[J,Y]=n.useState(!1),[ee,te]=n.useState(!1),se=(0,o.qz)(void 0,A.Z),{section:ne,indexLocal:re,indexGlobal:oe}=(0,o.VK)((()=>se.state.focus),[se]),ie=(0,r.O7)(),ae=(0,r.Fy)(),le=(0,o.VK)((()=>F.Z.state.online&&T.Z.shouldShowSearchMenuItemAskAI(ae)),[ae]),de=(0,o.VK)((()=>T.Z.shouldShowAssistantFace()),[]),ce=(0,i.yK)((e=>({wrapper:{paddingTop:h||!le?8:void 0,width:"100%",height:"100%",overflowX:"hidden",overflowY:"auto"},sectionHeader:{marginBottom:8},section:{marginBottom:18},sectionBorderBottom:{paddingBottom:10,boxShadow:`0 1px 0 ${e.lightDividerColor}`},notionAiLabel:{lineHeight:"20px",fontSize:14,textOverflow:"ellipsis",overflow:"hidden",display:"block",fontWeight:f.Z.fontWeight.medium},notionAiIcon:{fill:e.aiPurpleColor,overflow:"visible",...de&&{height:18,width:18}},menuItemLabel:{lineHeight:"20px",fontSize:14,fontWeight:f.Z.fontWeight.medium}})),[h,de,le]),{defaultBodyFocusedResultStore:ue,isQuickSearch:he}=(0,n.useContext)(H.SearchStaticContext),pe=(0,o.VK)((()=>{const e=D.default.state,t=D.default.isCenterPeekOpen()||q.default.isInPeekRenderer();return e.open&&(t||e.isOpening)?e.targetStore:P.default.state.mainEditorCurrentBlockStore}),[]),ge=(0,o.VK)((()=>M.X4.state.filter((e=>e.pageId!==(null==pe?void 0:pe.id)))),[null==pe?void 0:pe.id]),me=(0,o.VK)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:t,mainEditorCurrentBlockStore:s}=P.default.state;return!!(t&&s&&s.canRead())&&T.Z.isQnATooltipsVisible(ie.device,e)}),[ie.device]);(0,n.useEffect)((()=>()=>{ue.setState(void 0)}),[ue]);const fe=(0,n.useRef)(null),{value:ve}=(0,w.XJ)(b.assistantDependency),xe=(0,o.VK)((()=>{var e;const s=[];le&&s.push({key:"actionMenuItem.assistant",action:e=>{const{currentUserSettingsStore:t}=P.default.state;t&&(0,y.setQnaOnboardingPhase)(ie,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipClose",userSettingsStore:t}),x.Ky({environment:ie,shouldResetAssistantStore:R.default.wasActiveSessionLastOpenedOutsideOfHistorySavedWindow(),quickSearchMode:he,device:ae,event:e.event}),null==ve||ve.assistantActions.updateAssistantTimestampsAfterSessionInitialization({environment:ie})},render:e=>{const t=null==pe?void 0:pe.getSpaceStore(),s=t?(0,j.rn)(ie,t):void 0,n=(0,G.jsx)("div",{className:"notranslate",style:ce.notionAiLabel,children:s?(0,G.jsx)(p.FormattedMessage,{id:"searchDefaultBody.searchActionMenuItem.askAiInSpace",defaultMessage:"Ask AI in {spaceName}",values:{spaceName:s}}):(0,G.jsx)(p.FormattedMessage,{id:"searchDefaultBody.searchActionMenuItem.askNotionAi",defaultMessage:"Ask Notion AI about..."})});return me?(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(S.gc,{origin:fe}),(0,G.jsx)(W.Z,{type:"assistant",...e,blueOutlineFocused:!0,ref:fe,title:n,icon:e=>(0,d.t)({...e,...ce.notionAiIcon})})]}):(0,G.jsx)(W.Z,{type:"assistant",...e,title:n,icon:e=>(0,G.jsx)(C.f,{style:{...e,...ce.notionAiIcon},variant:"xsmall"})})}});const{isNewElectronTab:n}=V.default.state,r=null===(e=Z.Z.state.preferences)||void 0===e?void 0:e.isNewTabSearchEnabled;if(n&&r){const e=(0,G.jsx)("div",{style:ce.menuItemLabel,children:(0,G.jsx)(p.FormattedMessage,{id:"searchDefaultBody.searchActionMenuItem.newPage",defaultMessage:"Create a new page"})});s.push({key:"actionMenuItem.newPage",action:async e=>{const s=a.tY.SearchTabs,n=await(0,k.quickAddPage)({environment:ie,from:"electron_new_tab_search",pageVisitSource:s});n&&t({index:{local:e.indexLocal,global:e.index},event:e.event,selectedResult:Q(n,xe.length),fromSidePeekPanel:!1,actionItemCount:xe.length,context:"new_page"})},render:t=>(0,G.jsx)(W.Z,{type:"new_page",...t,title:e,icon:e=>(0,l.l)({...e})})})}return s}),[he,le,ie,pe,me,ce,ve,t,ae]),ye=(0,o.VK)((()=>{var e;const s=ae.isElectron&&(null===(e=Z.Z.state.preferences)||void 0===e?void 0:e.isNewTabSearchEnabled)&&B.Z.getState().tabs,n=V.default.state.isNewElectronTab,{currentSpaceStore:r}=P.default.state;if(!r||!s||!n)return[];return s.slice(0,4).map(((e,s)=>{let n;if(e.pageId){var o;const i=(null===(o=ge.find((t=>{let{pageId:s}=t;return e.pageId===s})))||void 0===o?void 0:o.store)??E.G.createChildStore(r,{table:u.iU,id:e.pageId});n={key:`${i.id}:${e.id}`,action:e=>t({index:{local:e.indexLocal,global:e.index},event:e.event,selectedResult:Q(i,s),fromSidePeekPanel:!1,actionItemCount:xe.length,context:"tabs"}),render:e=>(0,G.jsx)($.Z,{...e,inline:!0,store:i,hidePath:!1,buttonStyle:{paddingLeft:1},type:"tabs"})}}else if("chat"===e.type){const t=(0,G.jsx)("div",{style:{...ce.menuItemLabel,marginLeft:2},children:(0,G.jsx)(p.FormattedMessage,{id:"searchDefaultBody.searchTabMenuItem.notionAI",defaultMessage:"Notion AI"})});n={key:e.id,action:t=>v.Fm({tabId:e.id,url:c._j.chat,event:t.event,environment:ie}),render:e=>(0,G.jsx)(W.Z,{type:"assistant",...e,title:t,icon:e=>(0,G.jsx)(C.f,{style:{...e,...ce.notionAiIcon,marginRight:0},variant:"xsmall"})})}}return n})).filter(m.$K)}),[ae.isElectron,t,xe.length,ge,ce.menuItemLabel,ce.notionAiIcon,ie]),Se=(0,o.VK)((()=>{const e={};return ge.forEach((t=>{let{pageId:s,visitedAt:n}=t;return e[s]=n})),e}),[ge]),be=(0,o.VK)((()=>{const e=new Map;return ge.map(((s,n)=>{const r=M._5(s.visitedAt),o="today"!==r&&"yesterday"!==r,i={key:`${s.store.id}:${n}`,action:e=>t({index:{local:e.indexLocal,global:e.index},event:e.event,selectedResult:Q(s.store,n),fromSidePeekPanel:!1,actionItemCount:xe.length+ye.length,context:"recent_pages"}),render:e=>(0,G.jsx)($.Z,{...e,inline:!ae.isMobile,store:s.store,hidePath:!1,lastViewed:o?Se[s.store.id]:void 0,buttonStyle:{paddingLeft:1},type:"recent_pages"})},a={result:i,store:s.store};var l;e.has(r)?null===(l=e.get(r))||void 0===l||l.push(a):e.set(r,[a])})),e}),[xe.length,ae.isMobile,ge,t,Se,ye.length]),Ce=(0,w.XJ)(I.FF.AppTemplates),Ie=(0,o.VK)((()=>(0,j.kO)().function),[]),Me=(0,o.VK)((()=>{var e;const t=null===(e=Ce.value)||void 0===e?void 0:e.templatePickerItems.getSuggestedTemplatesForSearch({persona:Ie,environment:ie}).slice(0,3),s=null==t?void 0:t.map(((e,t)=>({key:`${t}:${e.name}`,action:()=>{x.IB(ie),e.onClick()},render:t=>(0,G.jsx)(W.Z,{...t,title:e.name,icon:()=>e.icon,type:"page_result"})})));return s}),[Ce,Ie,ie]),je=(0,o.VK)((()=>!(!Me||0===Me.length)&&"on"===O.default.getEligibleGroup({experimentId:"search_modal_suggested_templates"})),[Me]),we=(0,o.VK)((()=>{const e=[];xe.length>0&&e.push({key:"actions",items:xe,render:e=>(0,G.jsx)(_.Z,{title:"Actions",desktopTitleStyle:ce.sectionHeader,disableDesktopPadding:!0,style:ce.section,children:e.children})}),ye.length>0&&e.push({key:"tabs",items:ye,render:e=>(0,G.jsx)(_.Z,{title:"Tabs",desktopTitleStyle:ce.sectionHeader,disableDesktopPadding:!0,style:ce.section,children:e.children})});for(const[t,s]of be.entries()){const n=X(t),r={key:t,items:s.map((e=>e.result)),render:e=>(0,G.jsx)(_.Z,{title:n,desktopTitleStyle:ce.sectionHeader,disableDesktopPadding:!0,style:{...ce.section},children:e.children})};e.push(r)}return!he&&Me&&Me.length>0&&je&&e.push({key:"templates",items:Me,render:e=>(0,G.jsx)(_.Z,{title:(0,G.jsx)(p.FormattedMessage,{id:"search.templateSuggestions.header",defaultMessage:"Start with a template"}),desktopTitleStyle:ce.sectionHeader,disableDesktopPadding:!0,style:ce.section,children:e.children})}),e}),[he,xe,be,ce.section,ce.sectionHeader,Me,je,ye]),ke=(0,n.useCallback)((e=>{const t=()=>{const e=L.Z.getWithoutSubscribing(s),t=e[e.length-1];return null==t?void 0:t.visitedAt},n=g.P2((async()=>{const e=t(),n=ie.currentUser.id;if(!n||!e)return;Y(!0);const r=await M.Od(e,{environment:ie,userId:n,spaceId:s});Y(!1),r||te(!0)}),300);t()&&e<=200&&!J&&!ee&&n()}),[ee,J,ie,s]);(0,n.useEffect)((()=>{var e;if(void 0===ne||void 0===re||void 0===oe)return;const t=null===(e=we[ne])||void 0===e?void 0:e.key;if(t&&"string"==typeof t)if("actions"===t)ue.setState({type:"assistant"});else if(M._k.includes(t)){var s;const e=null===(s=be.get(t))||void 0===s||null===(s=s[re])||void 0===s?void 0:s.store;e&&ue.setState({type:"page_result",value:{index:{local:{indexLocal:re,section:ne},global:oe},selectedResult:Q(e,oe-xe.length)}})}}),[xe.length,ue,oe,ne,re,be,we]);const Pe=(0,o.VK)((()=>xe.length),[xe.length]),Te=!ae.isMobile&&ge.length>0;return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)("div",{style:ce.wrapper,children:[(0,G.jsx)(N.Z,{store:se,type:N.i.Vertical,initialFocus:Pe,disableKeyboardArrowWrap:!0,sections:we,unfocusOnScroll:!0}),(0,G.jsx)(K.Z,{onChange:ke})]}),Te&&(0,G.jsx)(U.Z,{title:(0,G.jsx)(z.Z,{})})]})}},59592:(e,t,s)=>{s.d(t,{Z:()=>v,r:()=>f});s(667294);var n=s(800480),r=s(886628),o=s(724405),i=s(418442),a=s(153772),l=s(137810),d=s(95477),c=s(475024),u=s(629026),h=s(828992),p=s(489728),g=s(672495),m=s(785893);function f(e){return{fontSize:12,color:e.lightTextColor,marginLeft:6,paddingRight:4,paddingLeft:4,height:24}}const v=function(e){const t=(0,o.Fg)(),s=function(e,t){return{footer:()=>{const{device:t}=e;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:t.isMobile?l.Z.fontSize.UIRegular.mobile:l.Z.fontSize.UIRegular.desktop}},footerWrapper:{flexShrink:0},footerText:{color:t.lightTextColor,fontSize:c.yv(e,"UISmall"),...l.Z.textOverflowStyle},footerDebugButton:{...f(t),marginRight:6},debugGearIcon:{color:t.accentColors.gray[400]},hoveredDebugGearIcon:{color:t.accentColors.gray[600]}}}((0,n.O7)(),t),v=(0,r.VK)((()=>u.ZP.state.isDebugSidebarOpen),[]);return(0,m.jsx)("footer",{style:s.footerWrapper,children:(0,m.jsxs)(g.Z,{topBorder:!0,style:s.footer(),disableDesktopPadding:!0,children:[(0,m.jsx)(h.Z,{...e,style:s.footerText}),(0,a.x)(d.default)&&!v&&(0,m.jsx)(p.Z,{onClick:()=>u.ZP.setState({...u.ZP.state,isDebugSidebarOpen:!0}),isSmall:!0,style:s.debugGearIcon,hoveredStyle:s.hoveredDebugGearIcon,children:(0,i.H)({width:12,height:12})})]})})}},688357:(e,t,s)=>{s.d(t,{Z:()=>L});var n=s(667294),r=s(800480),o=s(886628),i=s(724405),a=s(841892),l=s(222109),d=s(775e3),c=s(745238),u=s(785893);const h=(0,c.IU)("flatNotionLogoMenuBar",{viewBox:"0 0 128 128",svg:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M76.8 10.25H51.2C42.07 10.25 35.839 10.258 31.0171 10.6519C26.3149 11.0361 23.8625 11.7357 22.1257 12.6206C18.0332 14.7059 14.7059 18.0332 12.6206 22.1257C11.7357 23.8625 11.0361 26.3149 10.6519 31.0171C10.258 35.839 10.25 42.07 10.25 51.2V76.8C10.25 85.93 10.258 92.161 10.6519 96.9829C11.0361 101.685 11.7357 104.138 12.6206 105.874C14.7059 109.967 18.0332 113.294 22.1257 115.379C23.8625 116.264 26.3149 116.964 31.0171 117.348C35.839 117.742 42.07 117.75 51.2 117.75H76.8C85.93 117.75 92.161 117.742 96.9829 117.348C101.685 116.964 104.138 116.264 105.874 115.379C109.967 113.294 113.294 109.967 115.379 105.874C116.264 104.138 116.964 101.685 117.348 96.9829C117.742 92.161 117.75 85.93 117.75 76.8V51.2C117.75 42.07 117.742 35.839 117.348 31.0171C116.964 26.3149 116.264 23.8625 115.379 22.1257C113.294 18.0332 109.967 14.7059 105.874 12.6206C104.138 11.7357 101.685 11.0361 96.9829 10.6519C92.161 10.258 85.93 10.25 76.8 10.25ZM3.48779 17.4723C0 24.3175 0 33.2783 0 51.2V76.8C0 94.7217 0 103.683 3.48779 110.528C6.55574 116.549 11.4511 121.444 17.4723 124.512C24.3175 128 33.2783 128 51.2 128H76.8C94.7217 128 103.683 128 110.528 124.512C116.549 121.444 121.444 116.549 124.512 110.528C128 103.683 128 94.7217 128 76.8V51.2C128 33.2783 128 24.3175 124.512 17.4723C121.444 11.4511 116.549 6.55574 110.528 3.48779C103.683 0 94.7217 0 76.8 0H51.2C33.2783 0 24.3175 0 17.4723 3.48779C11.4511 6.55574 6.55574 11.4511 3.48779 17.4723Z"}),(0,u.jsx)("path",{d:"M34.8247 30H51.877L82.6339 73.8338V38.7877L72.8 36.9046C72.5211 35.0215 72.9047 33.4174 73.9508 32.0923C74.997 30.6974 76.6708 30 78.9723 30H99.5816C100.14 31.4646 100.105 32.7897 99.4769 33.9754C98.919 35.161 97.838 36.1026 96.2339 36.8L92.8862 38.3692V97.1631C90.9334 98.0697 89.4339 98.6626 88.3877 98.9415C87.3416 99.2205 86.0513 99.36 84.517 99.36C82.4246 99.36 80.5416 98.8718 78.8677 97.8954C77.1939 96.919 75.6595 95.4195 74.2646 93.3969L45.4954 52.7015V89.3169L55.957 91.2C56.2359 93.0831 55.8523 94.722 54.8062 96.1169C53.76 97.5118 52.0862 98.2092 49.7847 98.2092C48.32 98.2092 46.2975 98.1744 43.717 98.1046C41.1365 98.0349 38.8 98 36.7077 98C34.8944 98 33.1857 98.0349 31.5816 98.1046C30.0472 98.1046 29.0011 98.1395 28.4431 98.2092C28.3036 97.8605 28.199 97.4769 28.1293 97.0585C28.0595 96.64 28.0247 96.2564 28.0247 95.9077C28.0247 94.9313 28.2688 94.0246 28.757 93.1877C29.3149 92.3508 30.2565 91.6882 31.5816 91.2L35.2431 89.7354V37.9508L28.6524 36.5908C28.3734 34.7077 28.757 33.1385 29.8031 31.8831C30.8493 30.6277 32.5231 30 34.8247 30Z"})]})});var p=s(709291),g=s(137810),m=s(751787),f=s(247839),v=s(662134),x=s(259139),y=s(475024),S=s(886706),b=s(825464),C=s(424042),I=s(319385),M=s(155320),j=s(629026),w=s(58261),k=s(974420),P=s(526388);const T=(0,c.IU)("command",{viewBox:"0 0 16 16",svg:(0,u.jsx)("path",{d:"M4.35938 5.5625L4.35938 9.21094L2.78906 9.21094C1.25 9.21094 0 10.4219 0 11.9688C0 13.5156 1.25 14.7656 2.78906 14.7656C4.32812 14.7656 5.57812 13.5156 5.57812 11.9688L5.57812 10.4062L9.17969 10.4062L9.17969 11.9688C9.17969 13.5156 10.4297 14.7656 11.9688 14.7656C13.5078 14.7656 14.7578 13.5156 14.7578 11.9688C14.7578 10.4219 13.5078 9.21094 11.9688 9.21094L10.3984 9.21094L10.3984 5.5625L11.9688 5.5625C13.5078 5.5625 14.7578 4.35156 14.7578 2.80469C14.7578 1.25781 13.5078 0 11.9688 0C10.4297 0 9.17969 1.25781 9.17969 2.80469L9.17969 4.36719L5.57812 4.36719L5.57812 2.80469C5.57812 1.25781 4.32812 0 2.78906 0C1.25 0 0 1.25781 0 2.80469C0 4.35156 1.25 5.5625 2.78906 5.5625ZM2.78906 4.38281C1.92969 4.38281 1.21875 3.67188 1.21875 2.80469C1.21875 1.9375 1.92969 1.21875 2.78906 1.21875C3.64844 1.21875 4.35938 1.9375 4.35938 2.80469L4.35938 4.38281ZM11.9688 4.38281L10.3984 4.38281L10.3984 2.80469C10.3984 1.9375 11.1094 1.21875 11.9688 1.21875C12.8281 1.21875 13.5391 1.9375 13.5391 2.80469C13.5391 3.67188 12.8281 4.38281 11.9688 4.38281ZM5.57812 9.22656L5.57812 5.54688L9.17969 5.54688L9.17969 9.22656ZM2.78906 10.3828L4.35938 10.3828L4.35938 11.9609C4.35938 12.8281 3.64844 13.5391 2.78906 13.5391C1.92969 13.5391 1.21875 12.8281 1.21875 11.9609C1.21875 11.0938 1.92969 10.3828 2.78906 10.3828ZM11.9688 10.3828C12.8281 10.3828 13.5391 11.0938 13.5391 11.9609C13.5391 12.8281 12.8281 13.5391 11.9688 13.5391C11.1094 13.5391 10.3984 12.8281 10.3984 11.9609L10.3984 10.3828Z"})}),R=(0,c.IU)("control",{viewBox:"0 0 16 16",svg:(0,u.jsx)("path",{d:"M0.210938 6.41406C0.078125 6.55469 0 6.72656 0 6.92188C0 7.32812 0.304688 7.64062 0.710938 7.64062C0.914062 7.64062 1.09375 7.55469 1.21875 7.42969L7.20312 1.32031L6.36719 1.32031L12.3516 7.42969C12.4844 7.55469 12.6641 7.64062 12.8594 7.64062C13.2656 7.64062 13.5703 7.32812 13.5703 6.92188C13.5703 6.72656 13.4922 6.55469 13.3594 6.41406L7.3125 0.226562C7.17969 0.078125 6.98438 0 6.78906 0C6.58594 0 6.40625 0.078125 6.25781 0.226562Z"})}),F=(0,c.IU)("option",{viewBox:"0 0 16 16",svg:(0,u.jsx)("path",{d:"M4.5 0L0.734375 0C0.320312 0 0 0.304688 0 0.703125C0 1.10156 0.320312 1.41406 0.734375 1.41406L4.17188 1.41406C4.45312 1.41406 4.65625 1.53906 4.77344 1.79688L9.92188 13.3594C10.2109 14.0156 10.6875 14.3203 11.4062 14.3203L15.2188 14.3203C15.625 14.3203 15.9531 14.0078 15.9531 13.6172C15.9531 13.2266 15.625 12.9062 15.2188 12.9062L11.7578 12.9062C11.4453 12.9062 11.25 12.7891 11.125 12.5312L6 0.976562C5.73438 0.367188 5.17188 0 4.5 0ZM15.2188 0L10.1641 0C9.75 0 9.42969 0.296875 9.42969 0.695312C9.42969 1.09375 9.75 1.39844 10.1641 1.39844L15.2188 1.39844C15.6328 1.39844 15.9453 1.09375 15.9453 0.695312C15.9453 0.296875 15.6328 0 15.2188 0Z"})}),Z=(0,c.IU)("shift",{viewBox:"0 0 16 16",svg:(0,u.jsx)("path",{d:"M5.99219 14.5L10.8125 14.5C11.9062 14.5 12.4922 13.8594 12.4922 12.8281L12.4922 9.32812L15.6641 9.32812C16.3047 9.32812 16.8047 8.9375 16.8047 8.34375C16.8047 7.97656 16.6172 7.70312 16.3359 7.42188L9.36719 0.476562C9.0625 0.171875 8.75 0 8.39844 0C8.05469 0 7.73438 0.171875 7.4375 0.476562L0.46875 7.42188C0.164062 7.71875 0 7.97656 0 8.34375C0 8.9375 0.5 9.32812 1.13281 9.32812L4.3125 9.32812L4.3125 12.8281C4.3125 13.8594 4.89844 14.5 5.99219 14.5ZM6.11719 13.2891C5.82031 13.2891 5.61719 13.0859 5.61719 12.7969L5.61719 8.41406C5.61719 8.21875 5.54688 8.14844 5.35938 8.14844L1.75 8.14844C1.69531 8.14844 1.66406 8.125 1.66406 8.08594C1.66406 8.05469 1.67969 8.03125 1.71094 7.99219L8.23438 1.50781C8.29688 1.44531 8.35156 1.42969 8.39844 1.42969C8.45312 1.42969 8.50781 1.44531 8.5625 1.50781L15.0859 7.99219C15.125 8.03125 15.1328 8.05469 15.1328 8.08594C15.1328 8.125 15.1094 8.14844 15.0469 8.14844L11.4453 8.14844C11.2578 8.14844 11.1875 8.21875 11.1875 8.41406L11.1875 12.7969C11.1875 13.0781 10.9766 13.2891 10.6875 13.2891Z"})});function B(e){const{shortcut:t,iconStyles:s,containerStyles:n}=e,r=(0,i.yK)((e=>({container:{display:"flex",gap:3,alignItems:"center",color:e.mediumIconColor,...n},icon:{strokeWidth:.25,overflow:"visible",stroke:e.mediumIconColor,...s}})),[n,s]);return t?(0,u.jsxs)("div",{style:r.container,children:[t.shift?Z(r.icon):void 0,t.control?R(r.icon):void 0,t.option?F(r.icon):void 0,t.command?T(r.icon):void 0,t.key?1===t.key.length?t.key.toUpperCase():t.key:void 0]}):null}var O=s(333991);function L(){const e=(0,r.O7)(),t=(0,p.useIntl)(),{isQuickSearch:s}=(0,n.useContext)(O.SearchStaticContext),a=(0,r.Fy)(),c=(0,o.VK)((()=>a.isElectron),[a.isElectron]),h=(0,o.VK)((()=>.75*y.yv(e,"UIRegular")),[e]),S=(0,i.yK)((t=>({listStyle:{...y.mK,...g.Z.textOverflowStyle,display:"inline-flex",alignItems:"center",fontSize:y.yv(e,"UISmall"),color:t.lightTextColor,gap:20},upDownIcon:{display:"inline",width:h+2,height:h+2,fill:t.mediumIconColor},enterIcon:{display:"inline",width:h+1,height:h+1,fill:t.mediumIconColor},commandGlyph:{fontSize:.75*y.yv(e,"UIRegular"),paddingRight:1,color:t.mediumIconColor},inlineHint:{display:"flex",gap:6,alignItems:"center",height:"max-content"},forwardSlash:{fontSize:9,userSelect:"none",fontWeight:500,display:"flex",lineHeight:1.4},toggleSidePeekHotkey:{display:"inline-flex",marginRight:4},icons:{width:h-1,height:h-1,marginTop:.5},keyboardShortcutContainer:{fontSize:y.yv(e,"UISmall")}})),[e,h]),b=(0,o.VK)((()=>(0,x.rd)(e)),[e]),k=(0,o.VK)((()=>{var t;const n=null===(t=C.Z.state.preferences)||void 0===t?void 0:t.isQuickSearchEnabled;return e.device.isElectron&&n&&(b||s)}),[e.device.isElectron,s,b]),[P,T]=(0,o.VK)((()=>{const t=j.ZP.state.query.text.length>0;return[b&&I.default.checkGate({gateName:"search_toggle_side_peek"})&&t,(0,x.Qi)(e)]}),[e,b]),R=(0,n.useCallback)((()=>{(M.default.state.open||M.default.state.openAsPage)&&m.Sn(e,{searchSessionId:M.default.state.sessionId})}),[e]),F=(0,o.VK)((()=>e.device.isMac),[e.device.isMac]),{command:Z}=v.fg(e);return(0,u.jsxs)("ul",{style:S.listStyle,children:[(0,u.jsxs)("li",{style:S.inlineHint,children:[(0,l.T)(S.upDownIcon),t.formatMessage({id:"searchFooter.helpText.selectHint",defaultMessage:"Select"})]}),(0,u.jsxs)("li",{style:S.inlineHint,children:[(0,d.U)(S.enterIcon),t.formatMessage({id:"searchFooter.helpText.openHint",defaultMessage:"Open"})]}),c?(0,u.jsxs)("li",{style:S.inlineHint,children:[F?(0,u.jsx)(B,{shortcut:{command:!0,key:"L"},iconStyles:S.icons,containerStyles:S.keyboardShortcutContainer}):(0,u.jsx)(w.Z,{name:"copyLinkToCurrentPage"}),t.formatMessage({id:"searchFooter.helpText.copyLink",defaultMessage:"Copy link"})]}):void 0,k?(0,u.jsx)("li",{style:S.inlineHint,onClick:()=>{R(),f.openQuickSearchShortcutSetting()},children:(0,u.jsx)(A,{environment:e,containerStyles:S.inlineHint})}):void 0,b?null:(0,u.jsxs)("li",{style:S.inlineHint,children:[(0,u.jsxs)("span",{children:[(0,u.jsx)("span",{style:S.commandGlyph,children:Z}),(0,d.U)(S.enterIcon)]}),t.formatMessage({id:"searchFooter.helpText.openNewTab",defaultMessage:"Open in a new tab"})]}),P?(0,u.jsxs)("li",{style:S.inlineHint,children:[(0,u.jsxs)("span",{style:S.toggleSidePeekHotkey,children:[(0,u.jsx)("span",{style:S.commandGlyph,children:Z}),(0,u.jsx)("span",{style:S.forwardSlash,children:"\\"})]}),T?t.formatMessage({id:"searchFooter.helpText.closeSidePeek",defaultMessage:"Close preview"}):t.formatMessage({id:"searchFooter.helpText.openSidePeek",defaultMessage:"Preview"})]}):null]})}function A(e){const{environment:t,containerStyles:s}=e,[r,a]=(0,n.useState)(!1),l=(0,o.VK)((()=>.75*y.yv(t,"UIRegular")),[t]),d=(0,i.yK)((e=>({container:{...s,cursor:"pointer"},commandSearchHint:{display:"flex",alignItems:"center"},commandText:{padding:"2px 4px",borderRadius:4,background:r?e.buttonHoveredBackground:void 0},hintAndBadgeContainer:{display:"flex",gap:3,alignItems:"center",width:"max-content"},tooltip:{background:"transparent",boxShadow:"none"},icons:{width:l-1,height:l-1,marginTop:.5},keyboardShortcutContainer:{fontSize:y.yv(t,"UISmall")}})),[s,t,r,l]),c=(0,o.VK)((()=>t.device.isMac),[t.device.isMac]),h=(0,p.useIntl)(),{commandSearchShortcut:g,commandSearchShortcutToString:v}=(0,o.VK)((()=>{var e;const t=null===(e=C.Z.state.preferences)||void 0===e?void 0:e.quickSearchShortcut;if(!t)return{commandSearchShortcut:void 0,commandSearchShortcutToString:void 0};const s=(0,S.Uy)(t);return{commandSearchShortcut:s,commandSearchShortcutToString:(0,S.K9)(s,c)}}),[c]),x=(0,n.useCallback)((()=>{(M.default.state.open||M.default.state.openAsPage)&&m.Zb(t,{searchSessionId:M.default.state.sessionId})}),[t]);return(0,u.jsx)(P.Z,{delayThreshold:400,placement:b.u.Bottom,originGap:8,disableTooltip:!c,renderTooltip:()=>(x(),(0,u.jsx)(D,{shortcut:v})),closeDelay:0,style:d.tooltip,render:e=>(0,u.jsxs)("div",{...e,style:d.container,onClick:()=>f.openQuickSearchShortcutSetting(),onMouseEnter:t=>{e.onMouseEnter&&e.onMouseEnter(t),r||a(!0)},onMouseLeave:t=>{e.onMouseLeave&&e.onMouseLeave(t),r&&setTimeout((()=>{a(!1)}),200)},children:[(0,u.jsx)("span",{style:d.commandText,children:c?(0,u.jsx)(B,{shortcut:g,iconStyles:d.icons,containerStyles:d.keyboardShortcutContainer}):v}),(0,u.jsx)("div",{style:d.commandSearchHint,children:r?(0,u.jsx)("span",{children:h.formatMessage({id:"searchFooter.commandSearch.editText",defaultMessage:"Click to edit shortcut"})}):(0,u.jsxs)("div",{style:d.hintAndBadgeContainer,children:[h.formatMessage({id:"searchFooter.commandSearch.defaultText",defaultMessage:"Command Search"}),(0,u.jsx)(k.Z,{style:{marginLeft:0}})]})})]})})}function D(e){const{shortcut:t}=e,s=a.Z.images.commandSearch.tooltipPng,[r,o]=(0,n.useState)(!1);(0,n.useEffect)((()=>{const e=new Image;e.src=s,e.onload=()=>{o(!0)}}),[s]);const l=(0,i.yK)((e=>({container:{width:260,borderRadius:8,backgroundColor:"transparent"},textContainer:{whiteSpace:"break-spaces",padding:15,display:"flex",flexDirection:"column",gap:1,backgroundColor:"light"===e.mode?e.accentColors.gray[700]:e.accentColors.gray[300],borderTopRightRadius:8,borderTopLeftRadius:8},description:{fontWeight:g.Z.fontWeight.regular,color:"light"===e.mode?e.accentColors.gray[300]:e.accentColors.gray[600]},image:{width:"100%"}})),[]);return r?(0,u.jsxs)("div",{style:l.container,children:[(0,u.jsxs)("div",{style:l.textContainer,children:[(0,u.jsx)("div",{children:(0,u.jsx)(p.FormattedMessage,{id:"searchFooter.commandSearch.tooltip.header",defaultMessage:"Use search and Q&A anywhere"})}),(0,u.jsx)("div",{style:l.description,children:(0,u.jsx)(p.FormattedMessage,{id:"searchFooter.commandSearch.tooltip.description",defaultMessage:"Try {shortcut} or click on {menuBarIcon} in your menubar to access search and Ask AI anytime, even with Notion minimized.",values:{shortcut:t,menuBarIcon:(0,u.jsx)(E,{})}})})]}),(0,u.jsx)("img",{style:l.image,src:s})]}):null}function E(){const e=(0,i.yK)((e=>({container:{display:"inline-block",position:"relative"},placeholder:{width:15,height:15,display:"inline-block"},flatMenuIcon:{position:"absolute",left:0,top:3,width:15,height:15,fill:"light"===e.mode?e.accentColors.gray[300]:e.accentColors.gray[600]}})),[]);return(0,u.jsxs)("div",{style:e.container,children:[(0,u.jsx)("span",{style:e.placeholder}),h(e.flatMenuIcon)]})}},140586:(e,t,s)=>{s.d(t,{$:()=>J,Z:()=>te});var n=s(667294),r=s(883355),o=s(800480),i=s(886628),a=s(724405),l=s(206637),d=s(745238),c=s(785893);const u=(0,d.IU)("newWindowPlus",{viewBox:"0 0 33 25",svg:(0,c.jsx)("path",{d:"M5.11328 10.5V3.92578C5.11328 2.66797 5.4375 1.71875 6.08594 1.07812C6.73438 0.4375 7.69141 0.117188 8.95703 0.117188H29.0195C30.293 0.117188 31.2539 0.4375 31.9023 1.07812C32.5508 1.71875 32.875 2.66797 32.875 3.92578V18.1875C32.875 19.4375 32.5508 20.3828 31.9023 21.0234C31.2539 21.6719 30.293 21.9961 29.0195 21.9961H12.8711C13.0898 21.6523 13.2695 21.2852 13.4102 20.8945C13.5586 20.5039 13.668 20.1016 13.7383 19.6875H28.8906C29.4297 19.6875 29.8438 19.5469 30.1328 19.2656C30.4219 18.9844 30.5664 18.5586 30.5664 17.9883V6.1875H7.42188V10.5C7.22656 10.4688 7.03125 10.4453 6.83594 10.4297C6.64062 10.4141 6.44922 10.4062 6.26172 10.4062C6.06641 10.4062 5.87109 10.4141 5.67578 10.4297C5.48828 10.4375 5.30078 10.4609 5.11328 10.5ZM8.07812 3.15234C8.07812 3.44141 8.18359 3.69531 8.39453 3.91406C8.61328 4.13281 8.87109 4.24219 9.16797 4.24219C9.47266 4.24219 9.73047 4.13281 9.94141 3.91406C10.1602 3.69531 10.2695 3.44141 10.2695 3.15234C10.2695 2.86328 10.1602 2.60938 9.94141 2.39062C9.73047 2.17187 9.47266 2.0625 9.16797 2.0625C8.87109 2.0625 8.61328 2.17187 8.39453 2.39062C8.18359 2.60938 8.07812 2.86328 8.07812 3.15234ZM11.5352 3.15234C11.5352 3.44922 11.6406 3.70703 11.8516 3.92578C12.0625 4.13672 12.3203 4.24219 12.625 4.24219C12.9297 4.24219 13.1875 4.13672 13.3984 3.92578C13.6172 3.70703 13.7266 3.44922 13.7266 3.15234C13.7266 2.86328 13.6172 2.60938 13.3984 2.39062C13.1875 2.17187 12.9297 2.0625 12.625 2.0625C12.3203 2.0625 12.0625 2.17187 11.8516 2.39062C11.6406 2.60938 11.5352 2.86328 11.5352 3.15234ZM14.9922 3.15234C14.9922 3.44922 15.0977 3.70703 15.3086 3.92578C15.5195 4.13672 15.7773 4.24219 16.082 4.24219C16.3789 4.24219 16.6328 4.13672 16.8438 3.92578C17.0625 3.70703 17.1719 3.44922 17.1719 3.15234C17.1719 2.86328 17.0625 2.60938 16.8438 2.39062C16.6328 2.17187 16.3789 2.0625 16.082 2.0625C15.7773 2.0625 15.5195 2.17187 15.3086 2.39062C15.0977 2.60938 14.9922 2.86328 14.9922 3.15234ZM6.27344 24.1406C5.44531 24.1406 4.66797 23.9844 3.94141 23.6719C3.21484 23.3594 2.57422 22.9219 2.01953 22.3594C1.46484 21.8047 1.03125 21.1641 0.71875 20.4375C0.398438 19.7109 0.238281 18.9336 0.238281 18.1055C0.238281 17.2773 0.398438 16.5 0.71875 15.7734C1.03125 15.0469 1.46484 14.4062 2.01953 13.8516C2.57422 13.2891 3.21484 12.8516 3.94141 12.5391C4.66797 12.2266 5.44531 12.0703 6.27344 12.0703C7.10156 12.0703 7.87891 12.2266 8.60547 12.5391C9.33203 12.8516 9.97266 13.2852 10.5273 13.8398C11.082 14.3945 11.5156 15.0391 11.8281 15.7734C12.1484 16.5 12.3086 17.2773 12.3086 18.1055C12.3086 18.9258 12.1484 19.6992 11.8281 20.4258C11.5156 21.1602 11.0781 21.8047 10.5156 22.3594C9.96094 22.9141 9.31641 23.3477 8.58203 23.6602C7.85547 23.9805 7.08594 24.1406 6.27344 24.1406ZM6.27344 21.9258C6.51562 21.9258 6.70703 21.8516 6.84766 21.7031C6.99609 21.5547 7.07031 21.3633 7.07031 21.1289V18.9023H9.29688C9.53125 18.9023 9.72266 18.832 9.87109 18.6914C10.0195 18.543 10.0938 18.3477 10.0938 18.1055C10.0938 17.8633 10.0195 17.6719 9.87109 17.5312C9.72266 17.3828 9.53125 17.3086 9.29688 17.3086H7.07031V15.082C7.07031 14.8477 6.99609 14.6562 6.84766 14.5078C6.70703 14.3594 6.51562 14.2852 6.27344 14.2852C6.03125 14.2852 5.83594 14.3594 5.6875 14.5078C5.54688 14.6562 5.47656 14.8477 5.47656 15.082V17.3086H3.25C3.01562 17.3086 2.82422 17.3828 2.67578 17.5312C2.52734 17.6719 2.45312 17.8633 2.45312 18.1055C2.45312 18.3477 2.52734 18.543 2.67578 18.6914C2.82422 18.832 3.01562 18.9023 3.25 18.9023H5.47656V21.1289C5.47656 21.3633 5.54688 21.5547 5.6875 21.7031C5.83594 21.8516 6.03125 21.9258 6.27344 21.9258Z"})});var h=s(435840),p=s(494804),g=s(76233),m=s(709291),f=s(137810),v=s(612457),x=s(843250),y=s(259139),S=s(897638),b=s(548779),C=s(825464),I=s(905162),M=s(80444),j=s(521273),w=s(424042),k=s(833110),P=s(125904),T=s(155320),R=s(530857),F=s(629026),Z=s(573063),B=s(374194),O=s(568785),L=s(731278),A=s(526388),D=s(872787),E=s(653965),V=s(751787),q=s(587531),N=s(970782),K=s(81598),_=s(460709),H=s(687258),W=s(269327),U=s(231945),z=s(478140),$=s(953437),G=s(333991);function Q(e){const{events:t,spaceIcon:s,spaceName:r}=e,[o,i]=(0,n.useState)(!1),l=(0,a.yK)((e=>({downIcon:{height:8,width:8,stroke:e.icon.tertiary},wrapper:{display:"flex",alignItems:"center",gap:2,paddingRight:5,cursor:"pointer"},recordIcon:{backgroundColor:o?e.buttonHoveredBackground:void 0,padding:4,height:void 0,width:void 0}})),[o]);return(0,c.jsxs)("span",{...t,style:l.wrapper,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),role:"button",children:[(0,c.jsx)(L.Z,{bucket:"public",disabled:!0,icon:s,isEmptyPage:!1,size:24,style:l.recordIcon,title:r}),(0,D.Y)(l.downIcon)]})}const X=function(){const e=(0,i.VK)((()=>M.default.state.currentSpaceStore),[]),t=(0,i.VK)((()=>null==e?void 0:e.id),[null==e?void 0:e.id]),s=(0,o.O7)(),r=(0,i.VK)((()=>s.currentUser.id),[s.currentUser.id]),{handlePopupOpen:a,handlePopupClose:l}=(0,n.useContext)(G.SearchStaticContext),d=(0,n.useCallback)((async e=>{const{newSpaceViewStore:t,associatedUserId:n,closeSwitcherPopupFn:o}=e,i=t.getSpaceId();if(t&&r&&i){var a;const e=null===(a=M.default.state.currentSpaceViewStore)||void 0===a?void 0:a.id,l=T.default.state.sessionId;e&&l&&i&&V.fh(s,{currentSearchSessionId:l,currentWorkspaceId:e,newWorkspaceId:i}),o(),M.default.update((e=>({...e,currentSpaceViewStore:t,currentSpaceStore:null==t?void 0:t.getSpaceStore()}))),r!==n&&await N.x({environment:s,newCurrentUserId:n}),j.Z.isAiEnabled()&&K.assistantDependency.load().then((e=>{let{assistantActions:t}=e;t.clearAllAssistantSessions()})),W.Z.reinitializeState(s,n,i),T.default.closeAndResetMetricsState(),R.default.reset(),q.UT({environment:s,analyticsFrom:"quick-search-switch-workspace",isQuickSearch:!0,renderAsPage:!0})}}),[r,s]),{spaceIcon:u,spaceName:h}=(0,i.VK)((()=>e?{spaceName:e.getName(),spaceIcon:(0,b.Wd)(s,e)}:{spaceName:void 0,spaceIcon:void 0}),[e,s]),p=[...s.currentUser.loggedInUserIds],g=(0,i.VK)((()=>{var e;return E.mN(E.oA((null===(e=M.default.state.currentUserRootStore)||void 0===e?void 0:e.getSpaceViewStores())??[]),(e=>e.getSpaceId()))}),[]);return e?!t||!r||!e||g.length<=1&&1===p.length?null:(0,c.jsx)(U.ZP,{popupType:U.Z4.Popup,renderOrigin:e=>(0,c.jsx)(Q,{events:e,spaceIcon:u,spaceName:h}),render:e=>(0,c.jsx)(z.Z,{menuType:_.og.Popup,children:p.map(((t,s)=>(0,c.jsx)(H.LP,{onSpaceClick:s=>d({newSpaceViewStore:s.spaceViewStore,associatedUserId:t,closeSwitcherPopupFn:e.close}),userId:t,isLastUser:s===p.length-1,disableAccountActions:!0,hideShortcuts:!0},`commandSearch-userworkspaces-${s}`)))}),onClick:a,onClose:l,disabled:!1,placementToOrigin:$.ZP.Placement.Bottom,alignmentToOrigin:$.ZP.Alignment.Start,style:{marginRight:30}}):null},J=48;class Y extends r.Z{constructor(){super(...arguments),this.typingTimer=void 0,this.renderLeft=()=>{const{showSpinner:e,selectedResultStore:t,quickSearchMode:s}=this.props,{device:n}=this.environment,r=this.styles,o=se(this.theme),i={...o.searchIcon,...r.searchIcon};if(s)return(0,c.jsx)(X,{});const a=Boolean(this.isElectronNewTabStore.state),l=Boolean(F.ZP.state.query.text.trim())&&!n.isMobile,d=null==t?void 0:t.getIcon(),p=()=>{switch(!0){case e:return(0,c.jsx)(O.Z,{style:i});case l:return(0,c.jsx)(L.Z,{disabled:!0,icon:d,isEmptyPage:Boolean(d),size:20});case a:return u({...o.searchIcon,width:18,height:18});default:return(0,h.R)(i)}};return(0,c.jsx)(v.Z,{show:e,showDelay:500,showHold:200,render:e=>(0,c.jsx)("div",{style:r.headerIcon,children:p()})})},this.handleQueryChange=e=>{this.handleTyping();const t=String(e.target.value);this.props.onQueryChange(t)},this.isPopupOpenStore=this.createComputedStore((()=>F.ZP.state.isPopupOpen)),this.electronTabsStore=this.createComputedStore((()=>k.Z.state.tabs)),this.isElectronNewTabStore=this.createComputedStore((()=>T.default.state.isNewElectronTab)),this.isElectronTabSearchEnabledStore=this.createComputedStore((()=>{var e;return null===(e=w.Z.state.preferences)||void 0===e?void 0:e.isNewTabSearchEnabled})),this.styles={inputDesktop:{fontSize:18,height:J,paddingLeft:12,paddingRight:16,alignItems:"center",flexGrow:0,flexShrink:0,zIndex:1},inputMobile:{fontSize:16,border:"none",boxShadow:"none",borderRadius:7,lineHeight:"1.2",padding:"6px 8px"},searchIcon:{width:16,height:16},headerIcon:{height:24,width:24,display:"flex",alignItems:"center",justifyContent:"center"},input:{minWidth:0,...f.Z.textOverflowStyle},suggestedText:{whiteSpace:"pre",color:this.theme.mediumTextColor},suggestedTextWrapper:{overflow:"hidden",textOverflow:"ellipsis"},autoCompletedText:{background:this.theme.tint.regular},clearButton:{marginLeft:8},userInputAndSuggestedTextContainer:{display:"grid",gridTemplateColumns:"auto 1fr"}}}willUnmount(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=void 0)}renderComponent(){const{device:e}=this.environment,{isOpen:t,selectedResultStore:s,quickSearchMode:n}=this.props,r=this.styles,o=se(this.theme),i=Boolean(this.isElectronTabSearchEnabledStore.state)?this.electronTabsStore.state:[],a=Boolean(this.isElectronNewTabStore.state)&&Boolean(this.isElectronTabSearchEnabledStore.state),l=F.ZP.state.query.text,d=function(e,t,s,n,r,o){if(0===n.length||n.length>=20||t.isMobile||void 0===s)return;const i=g.Jcv(s.getTitleValue()),a=i.replaceAll("\n"," "),l=i.slice(0,n.length),d=i.length>0&&l.toLocaleLowerCase()===n.toLocaleLowerCase(),c=d?a.substring(n.length):"";switch(!0){case t.isElectron&&r.some((e=>e.pageId===s.id)):return`${c}  ${e.formatMessage(Y.messages.switchTab)}`;case t.isElectron&&o:return`${c}  ${e.formatMessage(Y.messages.openInTab)}`;default:return`${c}  ${e.formatMessage(Y.messages.open)}`}}(this.props.intl,e,s,l,i,a),u=l.trim().length>0&&d?(0,c.jsxs)("div",{style:r.userInputAndSuggestedTextContainer,"data-search-suggested-text":!0,children:[(0,c.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:l}),(0,c.jsx)("div",{style:{...r.suggestedTextWrapper},className:n&&!this.isPopupOpenStore.state?x.pMC:void 0,children:(0,c.jsx)("span",{style:r.autoCompletedText,children:d})})]}):"",h=e.isMobile?B.B.ExtraLarge:B.B.Transparent,p=function(e,t,s){const{currentSpaceStore:n,mainEditorCurrentBlockStore:r}=M.default.state,o=n&&(0,b.rn)(t,n);if(s)return e.formatMessage({id:"searchInputMenuItem.placeholder.newTab",defaultMessage:"Open in new tab..."});if(o&&j.Z.showSearchAiFeatures())return e.formatMessage({id:"searchInputMenuItem.placeholder.SearchOrAskQuestionInSpace",defaultMessage:"Search or ask question in {spaceName}"},{spaceName:o});if(o)return e.formatMessage({id:"searchInputMenuItem.placeholder.searchInSpace",defaultMessage:"Search {spaceName}"},{spaceName:o});if(r){const t=100,s=g.Jcv(r.getTitleValue()).slice(0,t);return e.formatMessage({id:"searchInputMenuItem.placeholder.namedPage",defaultMessage:"Search in {pageTitle}"},{pageTitle:s})}return e.formatMessage({id:"searchInputMenuItem.placeholder.unnamedPage",defaultMessage:"Search in page"})}(this.props.intl,this.environment,a),m=e.isMobile?{...r.inputMobile,...o.inputMobile}:{...r.inputDesktop,...o.inputDesktop},f=j.Z.showSearchAiFeatures()||(0,y.rd)(this.environment),v={...r.input,width:0===l.length&&n?`min(${p.length}ch, 100%)`:"100%"};return(0,c.jsx)("div",{style:{display:"flex",flex:1},className:n&&!this.isPopupOpenStore.state?x.pMC:void 0,children:(0,c.jsx)(B.Z,{format:h,placeholder:p,left:this.renderLeft(),value:l,suggestedText:u,suggestedTextStyle:r.suggestedText,focus:e.isMobile?void 0:t&&!P.Z.state.open,focusInitial:!(0,I.Y)("supportsNativeHome")&&e.isMobile,focusAfterAnimation:!0,showClearButton:!0,right:!e.isMobile&&f&&(0,c.jsx)(ee,{quickSearchMode:n}),isRightLastElementOfInput:!0,selectAll:!0,onChange:this.handleQueryChange,onClearButtonClick:ne,onFocus:()=>{(0,this.props.onFocusChange)(!0)},onBlur:()=>{(0,this.props.onFocusChange)(!1)},style:m,inputStyle:v})})}handleTyping(){void 0===R.default.state.firstKeyStrokeTimeMs&&R.default.update((e=>({...e,firstKeyStrokeTimeMs:Date.now()})));const{onTypingChange:e}=this.props;this.typingTimer&&window.clearTimeout(this.typingTimer),e(!0),this.typingTimer=window.setTimeout((()=>e(!1)),300)}}function ee(e){const[t,s]=(0,i.VK)((()=>{const e=F.ZP.state.query.filters,t=(0,S.FN)(e);return[F.ZP.state.filterBar.show,t]}),[]),n=(0,o.O7)();(0,i.VK)((()=>{const e=n.currentUser.id;if(!e)return;!1===(0,p.fe)(e)&&!0===t&&F.ZP.collapseFilterBar()}),[n,t]);const r=(0,a.yK)((e=>({container:{padding:4,marginLeft:5,borderRadius:4,height:"fit-content",width:"fit-content",display:"flex"},hoveredContainerStyles:{background:s?e.accentColors.uiBlue[100]:e.buttonHoveredBackground},icon:{width:17,height:17,cursor:"pointer",fill:s?e.accentColors.uiBlue[600]:"light"===e.mode?e.accentColors.gray[300]:e.accentColors.gray[500]}})),[s]);return(0,c.jsx)(A.Z,{renderTooltip:()=>(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("div",{children:t?(0,c.jsx)(m.FormattedMessage,{id:"searchInputMenuItem.filterBarToggleButtonTooltip.hide",defaultMessage:"Hide filters"}):(0,c.jsx)(m.FormattedMessage,{id:"searchInputMenuItem.filterBarToggleButtonTooltip.show",defaultMessage:"Show filters"})})}),placement:C.u.Bottom,alignment:C.v.Start,disableTooltip:n.device.isMobile,delayThreshold:400,render:e=>(0,c.jsx)(Z.Z,{...e,icon:e=>(0,l.I)(r.icon),ariaLabel:"Button to toggle the filter bar",style:r.container,hoveredStyle:r.hoveredContainerStyles,onClick:()=>t?F.ZP.collapseFilterBar():F.ZP.expandFilterBar()})})}Y.displayName="SearchInputMenuItem",Y.messages=(0,m.defineMessages)({open:{id:"search.inputMenu.suggestedText.open",defaultMessage:"Open"},openInTab:{id:"search.inputMenu.suggestedText.openInTab",defaultMessage:"Open in tab"},switchTab:{id:"search.inputMenu.suggestedText.switchTab",defaultMessage:"Switch tab"}});const te=(0,m.injectIntl)(Y);function se(e){return{inputDesktop:{boxShadow:`0 1px 0 ${e.regularDividerColor}`},inputMobile:{background:e.inputBackground},searchIcon:{fill:e.mediumIconColor}}}function ne(){F.ZP.resetQuery({resetFilters:!0}),F.ZP.update((e=>({...e,source:"quick_find"})))}},469680:(e,t,s)=>{s.d(t,{Z:()=>he});s(757658);var n=s(294184),r=s.n(n),o=s(667294),i=s(883355),a=s(800480),l=s(886628),d=s(724405),c=s(749085),u=s(815145);function h(e){var t;let{explanation:s,simple:n=!1,filterZeros:r=!1}=e;return function e(t,s){if(!t)return[];const{value:o,description:i,details:a}=t;if(0===o&&r)return[];const l=(0===o?"0":o.toFixed(4)).padStart(8);function d(e){return`${"  ".repeat(s+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0))}${e}`}const c=`[${l}] ${i}`;if(i.startsWith("match on required clause")){return[d(`[${l}] match on required clause ${null==a?void 0:a[1].description}`)]}if(["max of:","sum of:","min of:"].includes(i)&&1===(null==a?void 0:a.length))return e(a[0],s);if(i.startsWith("tf")||i.startsWith("idf")){var u;const e=i.split(",")[0],t=null===(u=i.split(" computed as ")[1])||void 0===u?void 0:u.replace(" from:","");return[d(`[${l}] ${e}: [${(a??[]).map((e=>`${e.description.split(",")[0]}=${e.value}`)).join(" ")}] --\x3e ${t}`)]}if(i.startsWith("ConstantScore(_id:"))return[d(`[${l}] ids query`)];const h=n&&0!==s&&(i.startsWith("weight")||i.startsWith("Function"));return[d(c.replace(", result of:","").replace(" from:","").replace(" [PerFieldSimilarity]","").replace(/:$/,"").trim()),...(h?[]:a??[]).flatMap((t=>e(t,s+1)))]}(null==s||null===(t=s.details)||void 0===t?void 0:t[0],0)}var p=s(875553),g=s(775e3),m=s(332240),f=s(394308),v=s(758203),x=s(421202),y=s(492338);var S=s(709291),b=s(531701),C=(s(653965),s(401898)),I=s(137810),M=s(800893),j=s(321862),w=s(240468),k=s(297820),P=(s(95477),s(296994)),T=s(628020),R=s(469988),F=s(484210),Z=s(433929),B=s(98742),O=s(798165),L=s(259139),A=s(816402),D=s(825464),E=s(424042),V=s(833110),q=s(319385),N=s(206258),K=s(832470),_=s(629026),H=s(535057),W=s(824039),U=s(690403),z=s(552275),$=s(164133),G=s(573063),Q=s(550506),X=s(731278),J=s(186176),Y=s(776798),ee=s(526388),te=(s(303043),s(460709),s(195697),s(164921),s(231945),s(396525),s(478140),s(632163),s(840721),s(489728),s(511470),s(672495),s(785893));var se=s(266897),ne=s(745238);const re=(0,ne.IU)("arrowRightSquare",{viewBox:"0 0 18 18",svg:(0,te.jsx)("path",{d:"M3.06641 17.998L14.9121 17.998C16.9629 17.998 17.9785 16.9824 17.9785 14.9707L17.9785 3.04688C17.9785 1.03516 16.9629 0.0195312 14.9121 0.0195312L3.06641 0.0195312C1.02539 0.0195312 0 1.02539 0 3.04688L0 14.9707C0 16.9922 1.02539 17.998 3.06641 17.998ZM14.1797 8.98438C14.1797 9.20898 14.082 9.38477 13.8867 9.57031L10.4883 12.9785C10.3516 13.1152 10.1758 13.1934 9.96094 13.1934C9.54102 13.1934 9.22852 12.8711 9.22852 12.4512C9.22852 12.2363 9.31641 12.0508 9.45312 11.9141L10.7129 10.6738L11.9238 9.6582L9.79492 9.73633L4.56055 9.73633C4.12109 9.73633 3.80859 9.42383 3.80859 8.98438C3.80859 8.53516 4.12109 8.22266 4.56055 8.22266L9.79492 8.22266L11.9238 8.31055L10.7129 7.29492L9.45312 6.05469C9.32617 5.9082 9.22852 5.72266 9.22852 5.50781C9.22852 5.08789 9.54102 4.77539 9.96094 4.77539C10.1758 4.77539 10.3516 4.84375 10.4883 4.98047L13.8867 8.39844C14.0918 8.60352 14.1797 8.75977 14.1797 8.98438Z"})}),oe=(0,ne.IU)("sidebarRight",{viewBox:"0 0 23 18",svg:(0,te.jsx)("path",{d:"M3.06641 17.998L19.9609 17.998C22.0117 17.998 23.0273 16.9824 23.0273 14.9707L23.0273 3.04688C23.0273 1.03516 22.0117 0.0195312 19.9609 0.0195312L3.06641 0.0195312C1.02539 0.0195312 0 1.02539 0 3.04688L0 14.9707C0 16.9922 1.02539 17.998 3.06641 17.998ZM3.08594 16.4258C2.10938 16.4258 1.57227 15.9082 1.57227 14.8926L1.57227 3.125C1.57227 2.10938 2.10938 1.5918 3.08594 1.5918L19.9414 1.5918C20.9082 1.5918 21.4551 2.10938 21.4551 3.125L21.4551 14.8926C21.4551 15.9082 20.9082 16.4258 19.9414 16.4258ZM14.082 16.7285L15.6152 16.7285L15.6152 1.29883L14.082 1.29883ZM17.4902 5.21484L19.5801 5.21484C19.8828 5.21484 20.1367 4.95117 20.1367 4.66797C20.1367 4.375 19.8828 4.12109 19.5801 4.12109L17.4902 4.12109C17.1973 4.12109 16.9336 4.375 16.9336 4.66797C16.9336 4.95117 17.1973 5.21484 17.4902 5.21484ZM17.4902 7.74414L19.5801 7.74414C19.8828 7.74414 20.1367 7.48047 20.1367 7.1875C20.1367 6.89453 19.8828 6.65039 19.5801 6.65039L17.4902 6.65039C17.1973 6.65039 16.9336 6.89453 16.9336 7.1875C16.9336 7.48047 17.1973 7.74414 17.4902 7.74414ZM17.4902 10.2637L19.5801 10.2637C19.8828 10.2637 20.1367 10.0195 20.1367 9.72656C20.1367 9.43359 19.8828 9.17969 19.5801 9.17969L17.4902 9.17969C17.1973 9.17969 16.9336 9.43359 16.9336 9.72656C16.9336 10.0195 17.1973 10.2637 17.4902 10.2637Z"})});var ie=s(590683),ae=s(155320);function le(e){const{store:t}=e,s=(0,l.VK)((()=>{const e=t.getCreatedByPointer();if(e)return(0,se.Hl)({pointer:e,getRecordValue:t.getRecordValue})}),[t]),n=(0,l.VK)((()=>{const e=t.getLastEditedByPointer();if(e)return(0,se.Hl)({pointer:e,getRecordValue:t.getRecordValue})}),[t]),r=(0,d.yK)((e=>({container:{backgroundColor:b.FN.light.gray[900],display:"flex",flexDirection:"column",borderRadius:8},preview:{fontSize:14,color:b.FN.light.gray[100],fontWeight:400,display:"flex",gap:10,alignItems:"center"}})),[]),o=(0,S.useIntl)();return(0,te.jsxs)("div",{style:r.container,children:[s&&(0,te.jsx)(de,{store:t,activity:"created",actor:s}),n&&(0,te.jsx)(de,{store:t,activity:"edited",actor:n}),(0,te.jsxs)("div",{style:{padding:10,display:"flex",justifyContent:"space-between",cursor:"pointer",alignItems:"center"},onClick:()=>ae.default.update((e=>({...e,preferSidePeekOpen:!0}))),children:[(0,te.jsxs)("div",{style:r.preview,children:[(0,te.jsx)("span",{children:oe({height:14,width:14})}),(0,te.jsx)("span",{children:o.formatMessage({id:"searchResultMenuItem.tooltip.sidePeek",defaultMessage:"Preview"})})]}),(0,te.jsx)("div",{style:{color:"#7F7F7F"},children:re({height:14,width:14})})]})]})}function de(e){const{activity:t,actor:s,store:n}=e,r=(0,d.yK)((e=>({container:{display:"flex",flexDirection:"column",padding:"8px 10px 10px 10px",gap:8,borderBottom:`1px solid ${b.FN.light.gray[800]}`,minWidth:195},actorAvatarAndName:{display:"flex",alignItems:"center",gap:5},actorActivityInfo:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:10,fontSize:14},description:{color:"#7F7F7F",fontSize:12,fontWeight:600},date:{color:"#7F7F7F",fontSize:12}})),[]),[o]=(0,l.VK)((()=>{const e="created"===t?n.getCreatedTime():n.getLastEditedTime();return[(0,A.IS)(e,{useCompactFormat:!0,useLowercase:!0})]}),[t,n]),i=(0,S.useIntl)();return(0,te.jsxs)("div",{style:r.container,children:[(0,te.jsx)("div",{style:r.description,children:"edited"===t?i.formatMessage({id:"searchResultMenuItem.tooltip.lastEditedBy",defaultMessage:"Last edited by"}):i.formatMessage({id:"searchResultMenuItem.tooltip.createdBy",defaultMessage:"Created by"})}),(0,te.jsxs)("div",{style:r.actorActivityInfo,children:[(0,te.jsxs)("div",{style:r.actorAvatarAndName,children:[(0,te.jsx)("span",{children:(0,ie.a)({actor:s,size:20,style:{}})}),(0,te.jsx)("span",{children:(0,se.$4)(i,s)})]}),(0,te.jsx)("div",{style:r.date,children:o})]})]})}const ce=(0,S.defineMessages)({openInSidePeekButtonLabel:{id:"search.result.openInSidePeek.button.label",defaultMessage:"Open search result in side peek"},copySearchResultLinkButtonLabel:{id:"search.result.copyLink.button.label",defaultMessage:"Copy link to search result"}});class ue extends i.Z{constructor(){super(...arguments),this.storeTypes={explanationModalOpenStore:c.default.createClass(!1,{name:"explanationModalOpenStore"})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_debugHitCustomRenderer=e=>Ee(e,this.stores.explanationModalOpenStore)}renderComponent(){const{focused:e,isLastInSection:t,inline:s,className:n}=this.props,o=je(this.environment,this.theme,this.props.inline),i=Me(this.theme),a={...o.menuItem,...!s&&!t&&!e&&!this.props.isBeforeFocused&&i.menuItemBorder},l={...o.caption,...i.caption},d={...o.timestamp,...i.timestamp},c={...o.textWrapper,...this.props.inline&&o.inlineTextWrapper},u={title:(0,te.jsx)(De,{store:this.props.store,result:this.props.result,placeholder:this.props.placeholder,index:this.props.index,inline:this.props.inline,focused:this.props.focused,originalPosition:this.props.originalPosition}),icon:(0,te.jsx)(be,{store:this.props.store}),caption:(0,te.jsx)(Ve,{store:this.props.store,inline:this.props.inline,result:this.props.result,debugLocal:this.props.debugLocal,debugHits:this.props.debugHits,debugAreaRef:this.props.debugAreaRef,explanationModalOpenStore:this.stores.explanationModalOpenStore}),body:(0,te.jsx)(we,{result:this.props.result,store:this.props.store,inline:this.props.inline}),right:(0,te.jsx)(Ae,{inline:this.props.inline,focused:this.props.focused,store:this.props.store,type:this.props.type,lastViewed:this.props.lastViewed,queryId:this.props.queryId,result:this.props.result}),rightStyle:e?void 0:d,dontShrinkRight:!0,captionStyle:l,style:a,spacerStyle:(h=this.props.store,p=this.props.hidePath,p||!(0,J.Lk)(h)?xe:void 0),textWrapperStyle:c,className:r()("notranslate",n),buttonStyle:{paddingLeft:2},hoveredStyle:{background:this.theme.tint.regular}};var h,p;const g=q.default.checkGate({gateName:"search_toggle_side_peek"}),m=(0,L.rd)(this.environment)&&g,f=(0,H.Mk)()&&!(0,L.Qi)(this.environment)&&!_.ZP.state.isDebugSidebarOpen,v=f&&m&&this.props.focused;return f?(0,te.jsx)(ee.Z,{delayThreshold:50,placement:D.u.Right,originGap:18,renderTooltip:()=>(0,te.jsx)(Ie,{store:this.props.store}),style:v?o.sidePeekTooltip:o.tooltip,forceVisibleState:!!v||void 0,allowHover:!!v,render:e=>(0,te.jsx)(z.Z,{...this.props,...u,disableTransition:!0,...(0,B.Z)(this.props,e)}),closeDelay:0}):(0,te.jsx)(z.Z,{...this.props,...u,disableTransition:!0,ignoreLocalHoverState:!0})}shouldComponentUpdate(e,t,s){var n,r;const o=e.focused!==this.props.focused,i=(null===(n=e.result)||void 0===n?void 0:n.highlight)!==(null===(r=this.props.result)||void 0===r?void 0:r.highlight),a=e.isLastInSection!==this.props.isLastInSection,l=e.isBeforeFocused!==this.props.isBeforeFocused;return o||i||a||l}}ue.displayName="SearchResultMenuItem";const he=ue;function pe(e){let{data:t}=e;const s=t;if(!s)return null;if("localSource"in s){const{localSource:e}=s,t=e||["unknown"];return{element:(0,te.jsx)(te.Fragment,{children:`from ${[...t].join(",")}`}),expanded:!1}}return null}const ge={paddingLeft:5,paddingRight:20,paddingTop:2,paddingBottom:2,border:"1px solid black",color:b.FN.dark.green[900]},me={...ge,color:b.FN.dark.gray[30]},fe={maxHeight:200,overflowY:"scroll"},ve={border:"1px solid black"};const xe={visibility:"hidden"};function ye(e){return e&&!e.sources.includes(y.vp.Local)}function Se(e){var t;let{result:s,index:n,originalPosition:r}=e;const o=null===(t=(null==s?void 0:s.sources)??[])||void 0===t?void 0:t.flatMap((e=>e===y.vp.Local?[""]:e===y.vp.ElasticSearch?[""]:e===y.vp.Postgres?[""]:e===y.vp.VectorDBBlock||e===y.vp.VectorDBCollection?[""]:e===y.vp.ElasticsearchRandom?[""]:e===y.vp.ElasticsearchUniqueID?[""]:e===y.vp.ElasticsearchForcedRecentRecall?[""]:void(0,C.t1)(e))).reverse(),i=[...void 0===n||void 0===r?[" "]:n>r?[""]:n<r?[""]:[],...o].join("").trim();return i?(0,te.jsx)("span",{children:i}):null}function be(e){let{store:t}=e;const s=(0,l.VK)((()=>t.getIcon()),[t]),n=(0,l.VK)((()=>t.isEmptyPage()),[t]);return(0,te.jsx)(X.Z,{disabled:!0,icon:s,isEmptyPage:n,size:20,largeIcon:!1})}function Ce(e){return"recent_pages"===e?u.tY.SearchRecents:u.tY.SearchQuery}function Ie(e){let{store:t}=e;const s=(0,a.O7)();return(0,L.rd)(s)?(0,te.jsx)(le,{store:t}):(0,te.jsx)(W.Z,{store:t})}function Me(e){return{nonHighlightedTextColor:{color:e.text.secondary},menuItemBorder:{boxShadow:`0 1px 0 ${e.lightDividerColor}`},highlightedText:{color:e.text.primary},enterIcon:{fill:e.icon.secondary},bookmarkedIcon:{fill:e.topbarFavorite},caption:{color:e.text.secondary},captionTooltip:{color:e.text.contrast},captionTooltipDivider:{color:e.text.contrast},timestamp:{color:e.text.tertiary},tooltipTitle:{color:e.text.secondary},tooltipText:{color:e.text.primary},tooltipValue:{color:e.text.tertiary}}}function je(e,t,s){return{title:{fontWeight:I.Z.fontWeight.medium,lineHeight:"20px"},titleContent:{display:"flex",...s?{}:{width:0,flexGrow:1}},menuItem:{minHeight:36,paddingTop:e.device.isMobile?12:8,paddingBottom:e.device.isMobile?12:8},textWrapper:{marginLeft:4,alignItems:"center",width:"100%"},inlineTextWrapper:{alignItems:"center"},highlight:{fontWeight:I.Z.fontWeight.medium},vectorHighlight:{fontWeight:I.Z.fontWeight.medium,whiteSpace:"pre-wrap"},rightContentWrapper:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},rightIcon:{height:12,width:12},rightIconButtonIcon:{height:12,width:12},rightIconButtonWrapper:{height:18,width:18,marginRight:6},uniqueIDBadgeWrapper:{display:"flex",gap:8,marginRight:8,alignItems:"center"},caption:{marginTop:1},debugArea:{fontFamily:"monospace"},timestamp:{fontSize:I.Z.fontSize.UISmall.desktop,fontWeight:I.Z.fontWeight.regular},tooltip:{maxWidth:300},sidePeekTooltip:{background:"transparent",boxShadow:"none"},tooltipTitle:{fontWeight:I.Z.fontWeight.medium,fontSize:I.Z.fontSize.UISmall.desktop},tooltipText:{fontWeight:I.Z.fontWeight.medium,fontSize:I.Z.fontSize.UISmall.desktop,marginLeft:0,paddingRight:20},tooltipValue:{fontSize:I.Z.fontSize.UISmall.desktop,fontWeight:I.Z.fontWeight.regular},tooltipMenuItem:{minHeight:20},badge:{background:"light"===t.mode?t.accentColors.blue[30]:t.accentColors.blue[200]},badgeContent:{display:"flex",alignItems:"center",width:"100%"},badgeCaption:{marginLeft:2,color:t.blueColor},grayedOutBadgeCaption:{marginLeft:1},vectorBadge:{background:t.invoiceGreen,color:t.contentBackground},verifiedBadgeIcon:{width:10,height:10,fill:t.blueColor},right:{display:"flex"},collectionTextMatchingProperty:{lineHeight:2,fontSize:12},switchToTab:{fontSize:I.Z.fontSize.UISmall.desktop,fontWeight:I.Z.fontWeight.regular,color:t.text.secondary,marginRight:4}}}function we(e){var t,s;let{result:n,store:r,inline:o}=e;const i=(0,d.Fg)(),c=(0,a.O7)(),u=n?N.G.createChildStore(r,{table:x.iU,id:n.id,spaceId:n.spaceId}):void 0,h=(0,l.VK)((()=>null==u?void 0:u.isNavigableBlock()),[u]);if(!n)return null;if(!n.highlight)return null;if(h&&!ye(n))return null;let p,g;if(n.highlight.text)p=n.highlight.text;else if(n.highlight.collectionText){var m;p=n.highlight.collectionText,g=null==n||null===(m=n.matchedCollectionProperties)||void 0===m?void 0:m.collectionText}if(p=(0,v.$B)(p),!p)return null;const f=(0,R.ZP)(p);let S=!1;if(ye(n)){const e=e=>e.filter(R.il).map((e=>e[0].toLowerCase())),t=t=>void 0===t?[]:e((0,R.ZP)(t)),s=[...new Set([...t(n.highlight.title),...t(n.highlight.pathText)])],r=e=>s.some((t=>t.includes(e)));S=e(f).every((e=>r(e)))}const b=null!==(t=n.sources)&&void 0!==t&&t.includes(y.vp.VectorDBBlock)||null!==(s=n.sources)&&void 0!==s&&s.includes(y.vp.VectorDBCollection)?je(c,i,o).vectorHighlight:je(c,i,o).highlight,{highlightedText:C}=Me(i),I=S?{}:{...b,...C};return(0,te.jsxs)(te.Fragment,{children:[void 0!==g&&(0,te.jsx)(k.Z,{propertySchema:g,showIcon:!0,style:je(c,i,o).collectionTextMatchingProperty}),(0,te.jsx)($.Z,{text:p,highlighter:{tokenize:e=>(0,R.Vu)(f),style:I}})]})}function ke(e){let{label:t,inline:s}=e;const n=(0,d.Fg)(),r=(0,a.O7)();return(0,te.jsx)(U.Z,{style:je(r,n,s).badge,content:(0,te.jsxs)("div",{style:je(r,n,s).badgeContent,children:[(0,f.f)(je(r,n,s).verifiedBadgeIcon),(0,te.jsx)("div",{style:je(r,n,s).badgeCaption,children:t})]})})}function Pe(e){let{label:t,inline:s}=e;const n=(0,d.Fg)(),r=(0,a.O7)();return(0,te.jsx)(U.Z,{style:je(r,n,s).badge,content:(0,te.jsx)("div",{style:je(r,n,s).badgeCaption,children:t})})}function Te(e){let{label:t,inline:s}=e;const n=(0,d.Fg)(),r=(0,a.O7)();return(0,te.jsx)(U.Z,{style:je(r,n,s).badge,content:(0,te.jsx)("div",{style:je(r,n,s).badgeCaption,children:t})})}function Re(e){let{label:t,inline:s}=e;const n=(0,d.Fg)(),r=(0,a.O7)();return(0,te.jsx)(U.Z,{content:(0,te.jsx)("div",{style:je(r,n,s).grayedOutBadgeCaption,children:t})})}function Fe(e){let{inline:t}=e;const s=(0,d.Fg)(),n=(0,a.O7)();return(0,te.jsx)(U.Z,{content:(0,te.jsx)("div",{style:je(n,s,t).grayedOutBadgeCaption,children:(0,te.jsx)(S.FormattedMessage,{id:"search.result.archived.badge.text",defaultMessage:"Archived"})})})}function Ze(e){let{inline:t}=e;const s=(0,d.Fg)(),n=(0,a.O7)();return(0,te.jsx)(U.Z,{content:(0,te.jsx)("div",{style:je(n,s,t).grayedOutBadgeCaption,children:(0,te.jsx)(S.FormattedMessage,{id:"search.result.current.page.badge.text",defaultMessage:"Current Page"})})})}function Be(e){let{focused:t,inline:s,store:n,type:r,lastViewed:o,queryId:i,result:c}=e;const u=(0,a.O7)(),h=(0,d.Fg)(),f=(0,l.VK)((()=>V.Z.getState().tabs),[]),v=(0,l.VK)((()=>{var e;return Boolean(null===(e=E.Z.state.preferences)||void 0===e?void 0:e.isNewTabSearchEnabled)&&u.device.isElectron}),[u.device.isElectron]),x=(0,l.VK)((()=>(0,T.zj)()),[]),y=x&&x===(null==c?void 0:c.id),b=v&&("tabs"===r||f.some((e=>e.pageId===(null==c?void 0:c.id)&&"page"===e.type))),C=(0,l.VK)((()=>!1),[b]);if(u.device.isMobile)return null;if(o&&!t)return(0,te.jsx)(te.Fragment,{children:(0,A.IS)(o,{useCompactFormat:!0})});const I=je(u,h,s),k=Me(h),P={...I.rightIcon,...k.enterIcon,opacity:t?1:0},R={...I.rightIconButtonIcon,opacity:t?1:0},B=b&&!y&&t;return(0,te.jsxs)("div",{style:I.rightContentWrapper,children:[C&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(G.Z,{icon:m.y,iconStyle:R,showShadow:t,style:I.rightIconButtonWrapper,onClick:()=>function(e,t,s,n,r){const o=Ce(t);r?w.PR({searchResult:r,openInSidePeek:!0,environment:s,pageVisitSource:o,queryId:n,openInNew:void 0}):j.r({store:e,queryId:n,environment:s,pageVisitSource:o,openInSidePeek:!0,peekMode:"s"})}(n,r,u,i,c),ariaLabel:Z.default.formatMessage(ce.openInSidePeekButtonLabel)}),(0,te.jsx)(G.Z,{icon:p.U,iconStyle:R,showShadow:t,style:I.rightIconButtonWrapper,onClick:()=>function(e,t,s,n){const r=(0,F.ZP)({store:e,pageVisitSource:Ce(t),queryId:n});M.RD({environment:s,stringValue:r,copiedMessage:M.tq.copiedLinkToClipboard})}(n,r,u,i),ariaLabel:Z.default.formatMessage(ce.copySearchResultLinkButtonLabel)})]}),B&&(0,te.jsx)("div",{style:je(u,h).switchToTab,children:(0,te.jsx)(S.FormattedMessage,{id:"search.result.switchTab.text",defaultMessage:"Switch tab"})}),(0,g.U)(P)]})}function Oe(e,t,s,n){const{words:r,removeDuplicate:o}=e;if(0===r.length)return;const i={...je(t,s,n).highlight,...Me(s).highlightedText},a=o?new Set:void 0;return{tokenize:e=>(0,R.XT)({text:e,patterns:r,uniqueTokenHighlighterContext:a}),style:i}}function Le(e){var t;let{result:s,focused:n,inline:r}=e;const o=(0,d.Fg)(),i=(0,a.O7)(),c=null==s||null===(t=s.highlight)||void 0===t?void 0:t.uniqueId,u=(0,l.VK)((()=>"dark"===i.ThemeStore.state.mode),[i]);if(!c)return null;const h=je(i,o,r),p=Oe({words:[c]},i,o,r),g=n?u?b.FN.dark.translucentGray[300]:b.se.light.darkgray.alpha(.09):u?b.FN.dark.translucentGray[200]:b.se.light.darkgray.alpha(.06);return(0,te.jsxs)("div",{style:h.uniqueIDBadgeWrapper,children:[(0,te.jsx)("div",{children:(0,te.jsx)($.Z,{text:c,highlighter:p})}),(0,te.jsx)("div",{style:{borderRight:`1.5px solid ${g}`,height:14,borderRadius:1}})]})}function Ae(e){let{inline:t,focused:s,store:n,type:r,lastViewed:o,queryId:i,result:l}=e;const c=(0,d.Fg)(),u=(0,a.O7)();return(0,te.jsx)("div",{style:je(u,c,t).right,children:(0,te.jsx)(Be,{focused:s,inline:t,store:n,type:r,lastViewed:o,queryId:i,result:l})})}function De(e){let{store:t,result:s,placeholder:n,index:r,inline:o,focused:i,originalPosition:c}=e;const u=(0,d.Fg)(),h=(0,a.O7)(),p=je(h,u,o),g=Me(u),m=void 0===s,f={...p.title,...!m&&!i&&g.nonHighlightedTextColor},v=(0,l.VK)((()=>{const e=[];if(s&&s.highlight)if(e.push(...(0,R.fe)(s.highlight.pathText)),ye(s))e.push(...(0,R.fe)(s.highlight.title));else{N.G.createChildStore(t,{table:x.iU,id:s.id,spaceId:s.spaceId}).isNavigableBlock()&&e.push(...(0,R.fe)(s.highlight.text))}return e}),[s,t]);const S=i?void 0:Oe({words:v},h,u,o),b=(0,l.VK)((()=>{var e;return null===(e=(0,O.VP)(t))||void 0===e?void 0:e.isArchived()}),[t]),C=function(e){if(e)return e.sources.includes(y.vp.ElasticsearchUniqueID)}(s),I=(0,l.VK)((()=>(0,T.zj)()),[]),M=I&&I===(null==s?void 0:s.id);const j=function(){function e(e){var t;return null==s||null===(t=s.badges)||void 0===t?void 0:t.find((t=>t.type===e))}for(const t of["is_template","popular_this_week","most_viewed","verified"]){const s=e(t);if(void 0!==s)return{type:s.type,label:s.label}}}(),w=(0,l.VK)((()=>(0,H.Mk)()&&!M&&!b||"is_template"===(null==j?void 0:j.type)),[M,b,j])?j:void 0,k={is_template:e=>(0,te.jsx)(Re,{label:e,inline:o}),verified:e=>(0,te.jsx)(ke,{label:e,inline:o}),popular_this_week:e=>(0,te.jsx)(Pe,{label:e,inline:o}),most_viewed:e=>(0,te.jsx)(Te,{label:e,inline:o})},P=(0,l.VK)((()=>K.ZP.state.showDebugInfo),[]);return(0,te.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",...f},children:[(0,te.jsxs)("div",{style:p.titleContent,children:[P&&void 0!==r&&`${r+1}. `,C&&(0,te.jsx)(Le,{focused:i,inline:o,result:s}),(0,te.jsx)(Y.Z,{style:f,store:t,placeholder:n,highlighter:S}),!1,b&&(0,te.jsx)(Fe,{inline:o}),M&&(0,te.jsx)(Ze,{inline:o}),w&&k[w.type](w.label)]}),P&&(0,te.jsx)(Se,{result:s,index:r,originalPosition:c})]})}function Ee(e,t){const{data:s,keyPath:n}=e;if(2===n.length&&"_explanation"===n[0])return{element:(0,te.jsx)(te.Fragment,{children:(0,te.jsx)("button",{onClick:e=>{t.setState(!0),e.stopPropagation()},children:"show simplified explanation"})}),expanded:!1};const r=s._ltrlog;if(r)return function(e){const t=Object.keys(e[0])[0],s=e[0][t].map(((e,t)=>{const s=t%2==0?me:ge;return(0,te.jsxs)("tr",{children:[(0,te.jsx)("td",{style:s,children:`${t}`}),(0,te.jsx)("td",{style:s,children:`${e.name}`}),(0,te.jsx)("td",{style:s,children:`${e.value}`})]},e.name)}));return{element:(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{children:(0,te.jsx)("b",{children:`Featureset: ${t}`})}),(0,te.jsx)("div",{style:fe,children:(0,te.jsx)("table",{style:ve,children:s})})]}),expanded:!1}}(r);if(!["_score","matched_queries"].every((e=>s[e])))return null;const{_score:o,matched_queries:i}=s;return{element:(0,te.jsx)(te.Fragment,{children:`score ${o}, ${(i??[]).length} matched query clauses`}),expanded:!1}}function Ve(e){let{store:t,inline:s,result:n,debugLocal:r,debugHits:i,debugAreaRef:c,explanationModalOpenStore:u}=e;const p=(0,d.Fg)(),g=(0,a.O7)(),m=(0,o.useCallback)((e=>Ee(e,u)),[u]),{device:f}=g,v=Oe({words:(0,R.fe)(n&&n.highlight&&n.highlight.pathText),removeDuplicate:!0},g,p,s),x=s||f.isMobile?0:2,y=(i??[]).find((e=>"elasticsearch"===e.type&&void 0!==e._explanation)),S="elasticsearch"===(null==y?void 0:y.type)?null==y?void 0:y._explanation:void 0,b=(0,l.VK)((()=>Boolean(K.ZP.getDebugLevel())),[]),C=(0,l.VK)((()=>u.state),[u]);return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(J.ZP,{store:t,extraLength:x,showFullPathInTooltip:!0,highlighter:v,enableHoverAncestor:!0,tooltipStyle:Me(p).captionTooltip,tooltipDividerStyle:Me(p).captionTooltipDivider}),(0,te.jsxs)("div",{ref:c,children:[r&&(0,te.jsx)("div",{style:je(g,p,s).debugArea,children:(0,te.jsx)(P.Ki,{data:{debugLocal:r},defaultCollapsed:!0,customCollapsedRenderers:[pe],showCopyButton:!1,showModalButton:!1})}),i&&(0,te.jsx)("div",{style:je(g,p,s).debugArea,children:(0,te.jsx)(P.Ki,{data:{debugHits:i},defaultCollapsed:!0,customCollapsedRenderers:[m],showCopyButton:"small",showModalButton:!0})}),i&&(null==n?void 0:n.rankingSignals)&&(0,te.jsx)("div",{style:je(g,p,s).debugArea,children:(0,te.jsx)(P.Ki,{data:{rankingSignals:n.rankingSignals},defaultCollapsed:!0,showCopyButton:"small",showModalButton:!1})}),b&&(null==n?void 0:n.featureGroups)&&(0,te.jsx)("div",{style:je(g,p,s).debugArea,children:(0,te.jsx)(P.Ki,{data:{featureGroups:n.featureGroups},defaultCollapsed:!0,showCopyButton:"small",showModalButton:!1})}),S&&(0,te.jsx)(Q.Z,{open:C,innerStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll",padding:10},onDismiss:()=>{u.setState(!1)},render:()=>(0,te.jsx)("pre",{children:h({explanation:S}).join("\n")})})]})]})}},982063:(e,t,s)=>{s.d(t,{Z:()=>L});var n=s(667294),r=s(800480),o=s(886628),i=s(653965),a=s(333991),l=s(675822),d=s(832470),c=(s(757658),s(559054)),u=s(421202),h=s(494804),p=s(492338),g=s(401898),m=s(619584),f=s(751787),v=s(433929),x=s(259139),y=s(897638),S=s(318245),b=s(525286),C=s(80444),I=s(788632),M=s(319385),j=s(269327),w=s(184166),k=s(206258),P=s(155320),T=s(530857),R=s(629026);function F(e){let{dependencies:t,debugColumnStore:s,localDebounce:n=75,serverSearchFn:a,searchResultStore:l,permanentFilterOverride:d,enabled:u,preventUpdateSearchMetrics:g}=e;const m=(0,r.O7)(),x=(0,o.VK)((()=>function(e){const{debugColumnStore:t}=e,s=t.state.searchExperimentOverrides;function n(e){return(null==s?void 0:s[e])??M.default.getGroup(e,{disableExposureLogging:!0})}function r(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"control";const r=null==s?void 0:s[e];if(r)return r;const o=M.default.getEligibleGroup({experimentId:e,parameter:t,defaultGroup:n});return void 0===o?"control":o}const o=r("search-local-results-limit-layered","localResultsLimit","control"),i=o&&"control"!==o?parseInt(o):void 0;return{isLocalBlendingDisabled:"on"===n("search-no-local-blending"),shouldUseNewRerankerDebugOverrideEnabled:"on"===r("search-use-local-reranker-layered","shouldUseLocalReranker","control"),maxLocalResultsDebugOverride:i,forcedClusterPattern:t.state.forcedClusterPattern,searchExperimentOverrides:t.state.searchExperimentOverrides,forcedBlockIds:t.state.forcedBlockIds}}({debugColumnStore:s})),[s]);(0,c.r5)((()=>u?async function(e){var t;const{query:s,openAsPage:n,store:r,serverSearchFn:o}=e;if(n&&i.Xy(s,r.state.selectedQueryResultQuery))return;const a=Date.now();!function(e){const{isLocalBlendingDisabled:t,parentStore:s,environment:n,query:r,debug:o,limit:a,hasPublicAccessPermission:l,isOnline:d,store:c,permanentFilterOverride:u,preventUpdateSearchMetrics:g,now:m,shouldUseNewRerankerDebugOverrideEnabled:x,maxLocalResultsDebugOverride:C}=e;if("quick_find_scroll"===R.ZP.state.source||"relevance"!==r.sort.field)return;let I;const M={...r,filters:{...r.filters,...u}},j=function(e){const t=[];e.match(h.LO)&&t.push("literal");e.match(h.nZ)&&t.push("negation");return t}(r.text);j.length>0&&f.Cr(n,{operations:j,searchSessionId:P.default.state.sessionId});(function(e){const{isLocalBlendingDisabled:t,queryOperations:s,queryText:n}=e;return!i.xb(n.trim())&&!t&&0===s.length})({isLocalBlendingDisabled:t,queryOperations:j,queryText:r.text})&&(I=y.b9(function(e){var t;const{parentStore:s,requestInput:n,isOnline:r,environment:o,hasPublicAccessPermission:i,localSearchCache:a,shouldUseNewRerankerDebugOverrideEnabled:l,maxLocalResultsDebugOverride:d}=e,{query:c}=n;if(!a)return;if(!c.text.trim())return;if(i)return;const u=S.default.mark("rum.local_quick_search_query"),h=(0,b.Y)({query:n,localCachedPages:a,parentStore:s,environment:o,isOnline:r,shouldLimitLocalResultsWhenOnline:!0,applyScoreThresholdWhenOnline:!0,canUseLtr:!0,shouldUseNewRerankerDebugOverrideEnabled:l,maxLocalResultsDebugOverride:d});return S.default.measure(u,{environment:o}),null==h||null===(t=h.value)||void 0===t||t.results.forEach((e=>{if(!Boolean(e.store.isTemplate()))return;const t={type:"is_template",properties:{},label:v.default.formatMessage(p.Pe.template)};e.badges=e.badges?[...e.badges,t]:[t]})),h}({parentStore:s,environment:n,requestInput:{query:M,debug:o,limit:a},hasPublicAccessPermission:l,isOnline:d,localSearchCache:w.Z.state.localSearchableBlocksCache,shouldUseNewRerankerDebugOverrideEnabled:x,maxLocalResultsDebugOverride:C})),g||T.default.update((e=>({...e,numLocalRequests:e.numLocalRequests+1}))));c.update((e=>{var t;return null===(t=I)||void 0===t||t.results.forEach((t=>e.timesToRender.set(t.id,Date.now()-m))),{...e,localResults:I}}))}({...e,now:a});const l=new Set;null===(t=r.state.localResults)||void 0===t||t.results.forEach((e=>l.add(e.id))),await o({...e,now:a,excludedBlockIds:[...l]})}({...t,...x,store:l,serverSearchFn:a,environment:m,permanentFilterOverride:d,preventUpdateSearchMetrics:g}):Promise.resolve()),[t,x,l,a,m,d,u,g],{debounce:n})}async function Z(e){var t,s,n,r,o,i;let{parentStore:a,environment:l,query:d,debug:c,isOnline:v,publicAccessPermissionAncestorBlockId:b,currentSpaceStore:C,searchExperimentOverrides:I,forcedClusterPattern:M,store:w,forcedBlockIds:F,limit:Z,permanentFilterOverride:B,excludedBlockIds:O,preventUpdateSearchMetrics:L,now:A}=e;const D={...d,filters:{...d.filters,...B}};if(!D.text.trim()&&!y.FN(D.filters))return;const E=R.ZP.state.source,V="quick_find_scroll"===E,q=V||0===T.default.state.numServerRequests;w.update((e=>{var t;return{...e,serverResultsLoading:!0,...q?{serverResults:e.serverResults,serverEventProperties:null===(t=e.serverResults)||void 0===t?void 0:t.serverEventProperties}:{serverResults:void 0,serverEventProperties:void 0}}})),L||T.default.update((e=>({...e,numServerRequests:e.numServerRequests+1})));const N=(0,h.A7)({searchSessionId:P.default.state.sessionId,searchSessionFlowNumber:T.default.state.numServerRequests}),K={query:D,debug:c,limit:Z},_=await async function(e){const{parentStore:t,requestInput:s,isOnline:n,environment:r,publicAccessPermissionAncestorBlockId:o,searchSessionId:i,searchSessionFlowNumber:a,source:l,spaceId:d,searchExperimentOverrides:c,forcedClusterPattern:h,forcedBlockIds:f,excludedBlockIds:v}=e;if(!n)return{error:p.Ix.Offline};const x=S.default.mark("rum.server_quick_search_query"),b=await y.MS({environment:r,input:s,spaceId:d,publicAccessPermissionAncestorBlockId:o,searchSessionId:i,searchSessionFlowNumber:a,source:l,searchExperimentOverrides:c,forcedClusterPattern:h,recentPagesForBoosting:d&&"on"!==(null==c?void 0:c["search-debug-only-no-recent-boosting"])?j.Z.getWithoutSubscribing(d):[],forcedBlockIds:f,excludedBlockIds:v});if(!b)return;if("failed"===b.type)return b.offline?{error:p.Ix.Offline}:{error:p.Ix.RequestFailed};const{trackEventProperties:C,results:I,total:M,debug:w,clusterInfo:P}=b.data,T=(0,m.m8)((0,g.qP)(C).map((e=>{let[t,s]=e;return[`server-${t}`,s]}))),R=I.map(((e,s)=>({...e,serverEventProperties:T,originalPosition:s,store:k.G.createChildStore(t,{table:u.iU,id:e.id})})));return S.default.measure(x,{environment:r}),{value:{results:R,total:M,debugInfo:w,serverEventProperties:T,clusterInfo:P}}}({parentStore:a,environment:l,requestInput:K,spaceId:null==C?void 0:C.id,searchSessionId:P.default.state.sessionId,searchSessionFlowNumber:T.default.state.numServerRequests,publicAccessPermissionAncestorBlockId:b,isOnline:v,source:E,searchExperimentOverrides:I,forcedClusterPattern:M,forcedBlockIds:F,excludedBlockIds:O});if(N!==(0,h.A7)({searchSessionId:P.default.state.sessionId,searchSessionFlowNumber:T.default.state.numServerRequests}))return;if(!_||_.error)return w.update((e=>({...e,serverError:null==_?void 0:_.error,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0})));const H=V?y.Nu({existingResults:w.state.serverResults,newPageResults:_.value}):_.value;w.update((e=>(_.value.results.forEach((t=>e.timesToRender.set(t.id,Date.now()-A))),{...e,serverError:null==_?void 0:_.error,serverResultsLoading:!1,serverResults:H,serverResultsAllLoaded:_.value.results.length<Z,serverEventProperties:_.value.serverEventProperties})));const W=(null===(t=w.state.serverResults)||void 0===t?void 0:t.results.map((e=>{var t;return{id:e.id,badges:(null===(t=e.badges)||void 0===t?void 0:t.map((e=>e.type)))??[]}})))??[],U=new Map;for(const{badges:u}of W)for(const e of u){const t=U.get(e)??0;U.set(e,t+1)}const{sections:z}=y.IV({intentBasedGrouping:(0,x.XP)(),localResults:null===(s=w.state.localResults)||void 0===s?void 0:s.results,serverResults:null===(n=w.state.serverResults)||void 0===n?void 0:n.results}),$={};for(const[u,h]of Object.entries(z))$[u]=h.map((e=>e.id));f.Zf(l,{numLocalResults:(null===(r=w.state.localResults)||void 0===r?void 0:r.results.length)||0,localResultsIds:(null===(o=w.state.localResults)||void 0===o?void 0:o.results.map((e=>e.id)))||[],numServerResults:(null===(i=w.state.serverResults)||void 0===i?void 0:i.results.length)||0,...w.state.serverEventProperties,badgeCounts:U,badgesByResultId:W,idsBySection:$,timeToRenderById:[...w.state.timesToRender.entries()].map((e=>{let[t,s]=e;return{id:t,timeToRender:s}}))})}const B=(0,i.Ds)(Z,l.rE),O=(0,i.Ds)(Z,l.rE);function L(){const e=(0,r.Fy)(),{searchResultStore:t,secondarySearchResultStore:s}=(0,n.useContext)(a.SearchStaticContext),{parentStore:i}=(0,n.useContext)(a.SearchStoresContext),l=function(e){const t=(0,r.O7)();return(0,o.VK)((()=>{const{hasPublicAccessPermission:s,publicAccessPermissionAncestorBlockId:n}=y.bC(t);return{isOnline:Boolean(I.Z.state.online),limit:R.ZP.state.limit,parentStore:e,hasPublicAccessPermission:s,publicAccessPermissionAncestorBlockId:n,currentSpaceStore:C.default.state.currentSpaceStore,debug:d.ZP.getDebugLevel(),openAsPage:P.default.state.openAsPage,currentSpaceViewStore:C.default.state.currentSpaceViewStore,query:R.ZP.state.query}}),[t,e])}(i),c=(0,o.VK)((()=>Boolean((0,d.gq)({device:e})&&d.BJ.state.visible)),[e]);F({dependencies:l,searchResultStore:t,debugColumnStore:d.v_,enabled:!0,serverSearchFn:B}),F({dependencies:l,searchResultStore:s,debugColumnStore:d.BJ,enabled:c,serverSearchFn:O,preventUpdateSearchMetrics:!0})}},278159:(e,t,s)=>{s.r(t),s.d(t,{ENGLISH_PERSONAL_PRONOUNS:()=>fe,TEST_ONLY__getVisibleSpaceUserIds:()=>ve,getLocalCacheFromAppState:()=>Q,isPersonalPronoun:()=>me,searchActorsById:()=>be,searchCollections:()=>oe,searchCollectionsWithRecents:()=>ie,searchEmailUser:()=>Se,searchInstallableIntegrations:()=>ue,searchMentionablePages:()=>Ce,searchPageIds:()=>J,searchPageIdsInAncestor:()=>ne,searchPagesInAncestor:()=>se,searchPagesInCollection:()=>Y,searchPagesInSpace:()=>X,searchPagesWithParent:()=>ee,searchPublicPages:()=>Me,searchSpaceActorIds:()=>ye,searchSpaceActors:()=>xe,searchSpaceBots:()=>le,searchSpaceGroups:()=>ae,searchTeams:()=>je,searchTrashPages:()=>re,searchUsers:()=>he,searchVisibleSpaceUsers:()=>pe});s(757658);var n=s(443261),r=s.n(n),o=s(715070),i=s(133728),a=s(977657),l=s(158573),d=s(463306),c=s(772141),u=s(145953),h=s(599405),p=s(421202),g=s(177420),m=s(606287),f=s(815047),v=s(519889),x=s(492338),y=s(364684),S=s(76233),b=s(307928),C=s(653965),I=s(307032),M=s(401898),j=s(619584),w=s(454642),k=s(398730),P=s(710274),T=s(95477),R=s(628020),F=s(304708),Z=s(798165),B=s(367669),O=s(615447),L=s(897638),A=s(516639),D=s(394841),E=s(80444),V=s(319385),q=s(269327),N=s(184166),K=s(140061),_=s(206258),H=s(176117),W=s(897630),U=s(88893),z=s(288280),$=s(525286),G=s(596820);async function Q(e){const{currentSpaceStore:t,currentSpaceViewStore:s}=E.default.state;if(!t)return;return"on"===V.default.getEligibleGroup({experimentId:"use_global_local_search_cache"})?(await k.S(e),N.Z.state.localSearchableBlocksCache):await(0,G.S)({environment:e,currentSpaceStore:t,currentSpaceViewStore:s,excludeCurrentPage:!1})}async function X(e){const{environment:t,query:s,limit:n,currentPageId:r,searchSessionId:o,searchSessionFlowNumber:i,recentlyMentionedPageIds:a,spaceId:l,requireEditPermissions:d,excludeTemplates:c,source:h,boostRecentlyViewedPages:p,ignoresHighlight:g}=e,{currentSpaceStore:m}=E.default.state,f={results:[],recordMap:u.PF.create().toJson({allowVersionDowngrade:!1}),total:0,trackEventProperties:void 0};if(!m)return f;const v=await Q(t),y=x.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:c,requireEditPermissions:d||void 0}),S={field:"relevance"};if(!s&&v){const e=(0,$.f)({query:{query:{text:s,filters:y,sort:S},limit:n},localCachedPages:v,userId:t.currentUser.id,environment:t});return e||f}const b=await w.search(t,{type:x.n8.BlocksInSpace,query:s,spaceId:l,currentPageId:r,searchSessionId:o,searchSessionFlowNumber:i,recentlyMentionedPageIds:a,limit:n,filters:y,sort:S,source:h,recentPagesForBoosting:p?(0,O.Wk)(q.Z.getWithoutSubscribing(l)):void 0,ignoresHighlight:g});if("failed"===b.type)throw b.error;return b.data}async function J(e){const t=await X(e);return{results:t.results.map((e=>e.id)),recordMap:t.recordMap}}async function Y(e){const{environment:t,query:s,collectionId:n,limit:r,spaceId:o,excludeTemplates:i,source:a,includePublicPagesWithoutExplicitAccess:l,boostRecentlyViewedPages:d,ignoresHighlight:c}=e,u=new Array,h=await Q(t),p=x.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,includePublicPagesWithoutExplicitAccess:l,excludeTemplates:i}),g={field:"relevance"},f=w.search(t,{type:x.n8.BlocksInCollection,query:s,spaceId:o,collectionId:n,limit:r,filters:p,sort:g,source:a,recentPagesForBoosting:d?(0,O.Wk)(q.Z.getWithoutSubscribing(o)):void 0,ignoresHighlight:c});if(h){const e={table:m.vF,id:n,spaceId:o},i=new _.NW(t,e);await i.load();const a=(0,$.f)({query:{query:{text:s,filters:i.isPageTreeCollection()?{...p,ancestors:[n]}:{...p,parentId:n},sort:g},limit:r},localCachedPages:h,userId:t.currentUser.id,environment:t});a&&u.push(...a.results)}const v=await f;if("failed"===v.type){if(0===u.length)throw v.error}else{let e=v.data.results;s||(e=L.YB({sort:g,batchSize:r,currentUserId:t.currentUser.id,unsorted:e})),u.push(...e)}return{results:C.oA(C.jj(u.map((e=>e.id))))}}async function ee(e){const{environment:t,query:s,parentId:n,limit:r,spaceId:o,excludeTemplates:i,source:a,includePublicPagesWithoutExplicitAccess:l,boostRecentlyViewedPages:d,ignoresHighlight:c}=e,[u,h]=await Promise.all([w.search(t,{type:x.n8.BlocksInParent,query:s,spaceId:o,parentId:n,limit:r,filters:x.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,includePublicPagesWithoutExplicitAccess:l,excludeTemplates:i}),sort:{field:"relevance"},source:a,recentPagesForBoosting:d?(0,O.Wk)(q.Z.getWithoutSubscribing(o)):void 0,ignoresHighlight:c}),te(e)]);if("failed"===u.type)throw u.error;return{results:C.oA(C.jj([h,...u.data.results.map((e=>e.id))]))}}async function te(e){const{environment:t,query:s,parentId:n,spaceId:r}=e,o=(0,h.parseRoute)({url:s,baseUrl:T.default.domainBaseUrl,publicDomainName:T.default.publicDomainName,isMobile:t.device.isMobile,protocol:T.default.protocol,currentUrl:window.location.href}),i="page"===o.name?o.peekViewBlockId||o.blockId:void 0,a=((0,I.qn)(s)?(0,I.wr)(s):void 0)||i;if(a){const e={table:p.iU,id:a},s=new _.G(t,e);await s.load();const o=s.id,i=s.getParentId(),l=s.getSpaceId();if(i===n&&l===r)return o}}async function se(e){const{environment:t,query:s,ancestorId:n,limit:r,excludeTemplates:o,source:i,currentPageId:a,searchSessionId:l,searchSessionFlowNumber:d,recentlyMentionedPageIds:c,ignoresHighlight:u}=e,h=await w.search(t,{type:x.n8.BlocksInAncestor,query:s,ancestorId:n,filters:x.u4({navigableBlockContentOnly:!0,excludeTemplates:o}),sort:{field:"relevance"},limit:r,source:i,currentPageId:a,searchSessionId:l,searchSessionFlowNumber:d,recentlyMentionedPageIds:c,ignoresHighlight:u});if("failed"===h.type)throw h.error;return h.data}async function ne(e){return{results:(await se(e)).results.map((e=>e.id))}}async function re(e){const{environment:t,query:s,limit:n,ancestorIds:r,spaceId:o}=e,i=0===s.trim().length?{field:"lastEdited",direction:"desc"}:{field:"relevance"},a=V.default.checkGate({gateName:"improved_trash_ui"}),l={query:s,filters:x.u4({isDeletedOnly:!0,navigableBlockContentOnly:!0,excludeTemplates:!1,editedBy:e.editedByIds||[],ancestors:e.ancestorIds||[],inTeams:e.teamspaceIds||[]}),sort:i,limit:n,spaceId:o,source:"trash"},d=r&&r.length>0&&!a?w.search(t,{type:x.n8.BlocksInAncestor,...l,ancestorId:r[0]}):w.search(t,{type:x.n8.BlocksInSpace,...l}),c=await d;if("failed"===c.type)throw c.error;{const{results:e,recordMap:t,total:s}=c.data;return{results:e.map((e=>e.id)),recordMap:u.PF.create(t),endOfResultsReached:s===e.length}}}async function oe(e,t){const{query:s,limit:n,source:r,requireEditPermissions:o,databaseType:i,spaceStore:a,searchSessionId:l}=t;if(!a)return{results:[],total:0};const d=a.id,[c,u]=await Promise.all([we(e,{...t,spaceId:d,requireEditPermissions:o,databaseType:i,parentStore:a}),w.search(e,{type:x.n8.CollectionsInSpace,query:s,spaceId:d,limit:n,filters:{...x.u4({excludeTemplates:!0,requireEditPermissions:o,databaseType:i})},sort:{field:"relevance"},source:r,recentPagesForBoosting:(0,O.Wk)(q.Z.get(d)),searchSessionId:l})]),h=C.G0("success"===u.type?C.oA(u.data.results.map((e=>e.collectionId))):[],c).slice(0,n);return{results:h,total:"success"===u.type?u.data.total:h.length}}async function ie(e){const{environment:t,collectionViewBlockStore:s,spaceStore:n,parentStore:r,query:o,limit:i,requireEditPermissions:a,databaseType:l,searchSessionId:d}=e;if(!r.isDefaultRecordCache())return{results:[],total:0};let c=[],u=0;if(!o){const e=t.currentUser.id;n&&(c=[...P.lG({currentUserId:e,spaceId:n.id}).map((e=>_.NW.createChildStore(r,{table:m.vF,id:e})))]),c=[...C.oA(null==s?void 0:s.getCollectionViewStores().map((e=>e.getCollectionStore()))),...c],l&&(c=c.filter((e=>{const t=e.getDatabaseType();return!!t&&l.includes(t)}))),c=C.mN(c,(e=>e.id)).filter((e=>!a||e.canEdit()))}const h=await oe(t,{query:o,limit:i,source:"collection_settings_source",requireEditPermissions:a,databaseType:l,spaceStore:n,searchSessionId:d});return c=[...c,...h.results.map((e=>_.NW.createChildStore(r,{table:m.vF,id:e})))],u=h.total,c=c.filter((e=>!(0,Z.wf)(e)&&e.canRead())),await Promise.all(c.map((async e=>{await e.load()}))),{results:C.mN(c,(e=>e.id)).slice(0,i).map((e=>e.id)),total:u}}function ae(e){const{query:t,intl:s}=e,{currentSpaceStore:n}=E.default.state,r=null==n?void 0:n.getPermissionGroups();if(!r)return[];return t?(0,l.ZP)(t,r,(e=>(0,A.kF)({intl:s,group:e})),{normalizeFuzzyScore:!0}):r}async function le(e){const{query:t}=e,{currentSpaceStore:s}=E.default.state;if(!s)return[];return ce({parentStore:s,query:t,botIds:await de(e)})}async function de(e){const{environment:t}=e,{currentSpaceStore:s}=E.default.state;if(!s)return[];const n=s.id;await W.OR({environment:t,spaceId:n});const r=z.subscriptionDataStoreInstance.state;if(!r)return[];const o=(0,U.NM)(r);return C.jj(o.map((e=>e.botId)))}async function ce(e){const{parentStore:t,query:s,botIds:n}=e,r=C.oA(await Promise.all(n.map((async e=>{const s=t.table===f.bx?t.id:void 0,n=(0,_.Kv)(t,{table:g.cZ,id:e,spaceId:s});return await n.load(),n.getValue()}))));return s?(0,l.ZP)(s,r,o.y2):r}async function ue(e){const{query:t,environment:s,spaceId:n,botSettings:r}=e;if(!n)return[];const o=await w.searchIntegrations(s,{query:t});if("success"===o.type){const e=o.data.integrationIds,t=r&&r.integration_approval_statuses?Object.keys(r.integration_approval_statuses):[],s=Boolean(null==r?void 0:r.integration_restrictions),n=Boolean("approved_or_built_by_notion"===(null==r?void 0:r.integration_restrictions));return s?e.filter((e=>n?t.includes(e)||(0,a.BP)({integrationId:e,env:"production"}):t.includes(e))):e}if("failed"===o.type)throw o.error;(0,M.t1)(o)}async function he(e){var t;let{parentStore:s,query:n,userIds:r,minFuzzyScore:o,placeSelfFirst:a}=e;const d=C.oA(await Promise.all(r.map((async e=>{const t=_.U6.createChildStore(s,{table:v.KJ,id:e});return await t.load(),t.getValue()}))));let c;const u=null===(t=E.default.state.currentUserStore)||void 0===t?void 0:t.userId;if(a&&u){const e=d.findIndex((e=>u===e.id));e>-1&&(c=d[e],d.splice(e,1))}const h=H.O.state??{},p=Math.max(...Object.values(h));function g(e){var t;return e===(null===(t=E.default.state.currentUserRootStore)||void 0===t?void 0:t.userId)?p+1e-5:h[e]??0}const m=C.xb(h)?d:d.sort(((e,t)=>{const s=g(e.id);return g(t.id)-s}));if(s.table!==f.bx)return c?[c,...d]:d;const x=new Set(s.getEmailDomains()),y=n?(0,l.ZP)(n,m,b.of,{minThreshold:o,getSortScore:e=>{const{original:t,score:s}=e,n=t.email&&(0,i.Gd)(t.email);return s*(n&&x.has(n)?-2:-1)}}):d;return c?[c,...y]:y}async function pe(e){const{currentSpaceStore:t}=E.default.state;if(!t)return[];const s=e.query.startsWith("@")?e.query.slice(1):e.query,n=await ge(e);return await he({parentStore:t,query:s,userIds:n,minFuzzyScore:e.minFuzzyScore,placeSelfFirst:e.placeSelfFirst})}async function ge(e){const{environment:t,membersOnly:s}=e,{currentSpaceStore:n}=E.default.state;if(!n)return[];await W.OR({environment:t,spaceId:n.id});const r=z.subscriptionDataStoreInstance.state;if(!r)return[];const o=(0,U.CM)(r).filter((e=>!(s&&!(0,c.Jy)(e.role)))),{mainEditorCurrentBlockStore:i,currentUserStore:a}=E.default.state,l=i&&!s?(0,B.YO)(i).flatMap((e=>{let{permissionItem:t}=e;return(0,c.jg)(t)?[t.user_id]:[]})):[],d=(0,F.F$)()&&i?function(e,t){const s=Z.VP(e);if(s){const e=new Set((0,y.Hf)({membership:s.getRawMembership()}));return t.filter((t=>"none"!==t.role||t.isPageGuest||t.isTeamGuest&&e.has(t.userId)))}return t.filter((e=>"none"!==e.role||e.isPageGuest))}(i,o):o,u=d.map((e=>e.userId));return C.jj([...C.oA([null==a?void 0:a.userId]),...l,...u])}function me(e,t){return!(!t.startsWith("en-")||!fe.has(e.toLowerCase()))}const fe=new Set(["me","you","i"]),ve=ge;async function xe(e){const[t,s]=await Promise.all([pe(e),le(e)]);return{users:t,bots:s}}async function ye(e){const[t,s]=await Promise.all([ge(e),de(e)]);return{userIds:t,botIds:s}}async function Se(e,t){const s=(0,i.H3)(t);if((0,i.oH)(s)&&s){const t=await w.findUser(e,{email:s});if("failed"===t.type)throw t.error;const n=t.data;return n.value?{user:n.value.value}:{email:s}}return{}}async function be(e){const{query:t,userIds:s,botIds:n,store:r}=e;let o=r;if(!o){const{currentSpaceStore:e}=E.default.state;if(!e)return{users:[],bots:[]};o=e}const[i,a]=await Promise.all([he({parentStore:o,query:t,userIds:s}),ce({parentStore:o,query:t,botIds:n})]);return{users:i,bots:a}}async function Ce(e){const{nearBlock:t,environment:s,query:n,source:r,searchSessionId:o,searchSessionFlowNumber:i}=e,{currentSpaceStore:a}=E.default.state,l=(0,R.zj)(),d=t&&(0,B.YO)(t).find((e=>{let{permissionItem:t}=e;return(0,c.$D)(t)})),u=K.Z.getMentionedIds(s.currentUser.id);if(a){return Ie(await X({environment:s,query:n,limit:20,spaceId:a.id,currentPageId:l,searchSessionId:o,searchSessionFlowNumber:i,recentlyMentionedPageIds:u,requireEditPermissions:!1,excludeTemplates:!0,source:r,boostRecentlyViewedPages:!0,ignoresHighlight:!0}))}if(d&&d.from.table===p.iU){return Ie(await se({environment:s,query:n,limit:20,ancestorId:d.from.blockId,excludeTemplates:!0,source:r,currentPageId:l,searchSessionId:o,searchSessionFlowNumber:i,recentlyMentionedPageIds:u,ignoresHighlight:!0}))}return[]}function Ie(e){const{trackEventProperties:t,results:s}=e,n=(0,j.m8)((0,M.qP)(t).map((e=>{let[t,s]=e;return[`server-${t}`,s]})));return s.map((e=>({...e,serverEventProperties:n})))}async function Me(e){const{environment:t,query:s,source:n,limit:r}=e,{currentSpaceStore:o}=E.default.state;if(!o)return[];return(await X({environment:t,query:s,limit:r||20,spaceId:o.id,requireEditPermissions:!0,excludeTemplates:!0,source:n,boostRecentlyViewedPages:!1})).results.filter((e=>{const t=_.G.createChildStore(o,{table:p.iU,id:e.id}),s=(0,Z.fJ)(t);return(0,d.$t)(s)}))}async function je(e){let{spaceViewStore:t,query:s,teamStores:n}=e;const r=C.oA(await Promise.all(n.map((async e=>(await e.load(),e.getValue()))))),o=t.getTeamsStores(),i=new Set(o.map((e=>e.id)));return s?(0,l.ZP)(s,r,(e=>e.name),{getSortScore:e=>{const{original:t,score:s}=e;return s*(i.has(t.id)?-2:-1)}}):r}function we(e,t){const{query:s,limit:n,spaceId:o,requireEditPermissions:i,databaseType:a}=t,l=[];if(n>0){const d=new AbortController;e.defaultRecordCache.inMemoryRecordCache.forEachRecord(e.currentUser.id,(e=>{let{model:u,role:h}=e;if(u.table===m.vF){const e=u.space_id===o,p=!i||(0,c.J5)(h);if(!e||!p||(0,D.Kj)(u.getParentId()))return;const g=u.getDatabaseType();if(!(!a||g&&a.includes(g)))return;const m=(0,S.QaF)(u.getName());if(!r().test(s,m))return;const f=_.NW.createChildStore(t.parentStore,u.pointer),v=Z.qA(f);if(!Z.fl(v))return;l.push(u.pointer.id),l.length>=n&&d.abort()}}),d.signal)}return l}},886706:(e,t,s)=>{s.d(t,{K9:()=>y,Uy:()=>x,nx:()=>h});s(757658);var n=s(667294),r=s(800480),o=s(724405),i=s(709291),a=s(653965),l=s(374194),d=s(785893);const c=["control+t","control+shift+n","control+shift+t","control+w","control+shift+w","control+r","control+shift+r","control+shift+i","control+\\","control+=","control+-","control+0","control+[","control+]","control+shift+tab","control+tab","control+1","control+2","control+3","control+4","control+5","control+6","control+7","control+8","control+9"],u=["command+,","command+t","command+shift+n","command+shift+t","command+w","command+shift+w","command+r","command+shift+r","alt+command+i","command+\\","command+=","command+-","command+0","command+[","command+]","control+shift+tab","control+tab","command+option+left","command+option+right","command+shift+[","command+shift+]","command+1","command+2","command+3","command+4","command+5","command+6","command+7","command+8","command+9"];function h(e){function t(){return e.shortcut?x(e.shortcut):void 0}const{isMac:s,isWindows:h}=(0,r.Fy)(),{KeyboardShortcutStackStore:S}=(0,r.O7)(),[b,C]=(0,n.useState)(t()),[I,M]=(0,n.useState)(new Set([])),[j,w]=(0,n.useState)(),[k,P]=(0,n.useState)(!1),T=(0,n.useRef)(!1),R=(0,n.useRef)(!1),F=(0,n.useRef)(!1),Z=(0,o.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:10,alignItems:"flex-end"},takenShortcutError:{color:e.accentColors.red[500],fontSize:12}})),[]);function B(){if(b&&F.current)if(b.key)if(s?b.control||b.option||b.command:b.control||b.option)if(function(e,t,s){for(const r of Object.values(e.shortcutMap))for(const e of r)if(a.Xy(x(e),t))return!0;const n=s?u:c;for(const r of n)if(a.Xy(x(r),t))return!0;return!1}(S,b,s)||function(e,t){for(const s of t)if(a.Xy(x(s),e))return!0;return!1}(b,e.conflictingShortcuts||[])){C(t());const e=y(b,s);w((0,d.jsx)(i.FormattedMessage,{id:"desktopQuickSearch.error.shortcutAlreadyUsed",defaultMessage:"{reservedShortcut} is already used",values:{reservedShortcut:e}}))}else{const t=function(e,t){const s=[];e.shift&&s.push("shift");e.control&&(t?s.push("control"):s.push("ctrl"));e.option&&(t?s.push("option"):s.push("alt"));e.command&&(t?s.push("command"):s.push("meta"));e.key&&s.push(e.key.toLowerCase());return s.join("+")}(b,s);e.onChange(t)}else C(t()),w(s?(0,d.jsx)(i.FormattedMessage,{id:"desktopQuickSearch.error.macModifierRequired",defaultMessage:"Use one of Option, Control, or Command for global keyboard shortcuts"}):(0,d.jsx)(i.FormattedMessage,{id:"desktopQuickSearch.error.windowsModifierRequired",defaultMessage:"Use one of Control or Alt for global keyboard shortcuts"}));else C(void 0);else F.current||C(t());T.current=!0,P(!1),F.current=!1}function O(e){if(h&&e.startsWith("Meta"))return;const t=new Set([...I,e]),s=function(e){const t={};for(const n of e)n.startsWith(g)?t.command=!0:n.startsWith(f)?t.option=!0:n.startsWith(m)?t.shift=!0:n.startsWith(v)?t.control=!0:n.startsWith("Key")?t.key=n.substring(3).toLowerCase():n.startsWith("Digit")?t.key=n.substring(5):p[n]&&(t.key=p[n]);const s=0===Object.values(t).filter((e=>!a.o8(e))).length;return s?void 0:t}(t);M(t),C(s),w(void 0),F.current=!0}return(0,d.jsxs)("div",{style:Z.container,children:[(0,d.jsx)(l.Z,{onKeyDown:function(e){R.current=!0,"Escape"===e.key?e.currentTarget.blur():"Tab"!==e.key&&(e.preventDefault(),e.stopPropagation(),O(e.code))},onKeyUp:function(e){R.current&&function(e){const t=new Set([...I]);if(t.delete(e),e.startsWith("Meta"))for(const s of t)s.startsWith(m)||s.startsWith(f)||s.startsWith(v)||t.delete(s);M(t),0===t.size&&B()}(e.code)},onFocus:function(e){C(void 0),P(!0)},onBlur:function(e){T.current||B(),T.current=!1,R.current=!1,M(new Set),P(!1)},focus:k,readOnly:!0,inputStyle:{textAlign:"center",caretColor:"transparent"},value:b&&y(b,s)}),j&&(0,d.jsx)("div",{style:Z.takenShortcutError,children:j})]})}const p={ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",Backquote:"`",Backslash:"\\",Backspace:"backspace",BracketLeft:"[",BracketRight:"]",Comma:",",Delete:"delete",Enter:"return",Equal:"=",Minus:"-",Period:".",Quote:"'",Semicolon:";",Slash:"/",Space:"space"},g="Meta",m="Shift",f="Alt",v="Control";function x(e){const t={};for(let s of e.split("+"))s=s.toLowerCase(),"command"===s||"meta"===s?t.command=!0:"option"===s||"alt"===s?t.option=!0:"shift"===s?t.shift=!0:"control"===s||"ctrl"===s?t.control=!0:t.key=s;return t}function y(e,t){const s=[];if(e.shift&&(t?s.push("shift"):s.push("Shift")),e.control&&(t?s.push("control"):s.push("Ctrl")),e.option&&(t?s.push("option"):s.push("Alt")),e.command&&(t?s.push(""):s.push("Win")),e.key){const t=1===e.key.length?e.key.toUpperCase():e.key;s.push(t)}return s.join("+")}},863334:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(749085);class r extends n.default{getInitialState(){return{}}}const o=r},125904:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(749085);class r extends n.default{getInitialState(){return{open:!1}}}const o=new r},530857:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});var n=s(749085);class r extends n.default{getInitialState(){return{selectedQueryResult:!1,numKeystrokes:0,numServerRequests:0,numLocalRequests:0,hadMetaClick:!1,firstKeyStrokeTimeMs:void 0}}}const o=new r},54983:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(749085);class r extends n.default{getInitialState(){return{}}}const o=r},908597:(e,t,s)=>{s.d(t,{Z:()=>o});s(667294);var n=s(745238),r=s(785893);const o=(0,n.IU)("arrowUp",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8 14.5586C8.44434 14.5586 8.74512 14.251 8.74512 13.7998V5.30957L8.69043 3.83984L10.4951 5.84961L12.0469 7.38086C12.1836 7.51074 12.3682 7.59961 12.5801 7.59961C12.9902 7.59961 13.291 7.28516 13.291 6.86816C13.291 6.66992 13.2158 6.49219 13.0586 6.32812L8.55371 1.81641C8.40332 1.66602 8.20508 1.57715 8 1.57715C7.79492 1.57715 7.59668 1.66602 7.44629 1.81641L2.94141 6.32812C2.78418 6.49219 2.70898 6.66992 2.70898 6.86816C2.70898 7.28516 3.0166 7.59961 3.42676 7.59961C3.63184 7.59961 3.82324 7.51074 3.95312 7.38086L5.50488 5.84961L7.30957 3.83301L7.25488 5.30957V13.7998C7.25488 14.251 7.5625 14.5586 8 14.5586Z"})})},967220:(e,t,s)=>{s.d(t,{S:()=>o});s(667294);var n=s(745238),r=s(785893);const o=(0,n.IU)("bot",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M7.996 16C12.381 16 16 12.38 16 8s-3.627-8-8.012-8C3.611 0 0 3.62 0 8s3.62 8 7.996 8zm0-1.594A6.375 6.375 0 011.61 8a6.366 6.366 0 016.38-6.398A6.393 6.393 0 0114.398 8a6.383 6.383 0 01-6.403 6.406zM4.648 8.518c0 .21.17.364.386.364h2.53l-1.346 3.605c-.202.527.355.813.703.395l4.168-5.176a.515.515 0 00.132-.325c0-.209-.17-.356-.379-.356H8.305l1.346-3.613c.201-.518-.356-.812-.704-.395l-4.16 5.184a.484.484 0 00-.14.317z"})})},248780:(e,t,s)=>{s.d(t,{l:()=>o});s(667294);var n=s(745238),r=s(785893);const o=(0,n.IU)("createPage",{viewBox:"0 0 24 24",svg:(0,r.jsx)("g",{children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M9.944 14.721c.104.094.216.12.336.079l1.703-.688 6.844-6.844-1.406-1.398-6.836 6.836-.711 1.68c-.052.13-.029.242.07.335zm8.102-9.484l1.414 1.406.515-.523a.917.917 0 00.282-.633.76.76 0 00-.258-.61l-.25-.25a.702.702 0 00-.578-.187.975.975 0 00-.617.297l-.508.5zm-9.453.127a3.85 3.85 0 00-3.85 3.85v6.5a3.85 3.85 0 003.85 3.85h6.5a3.85 3.85 0 003.85-3.85V12.95a.85.85 0 10-1.7 0v2.764a2.15 2.15 0 01-2.15 2.15h-6.5a2.15 2.15 0 01-2.15-2.15v-6.5a2.15 2.15 0 012.15-2.15h3.395a.85.85 0 000-1.7H8.593z",clipRule:"evenodd"})})})},206637:(e,t,s)=>{s.d(t,{I:()=>o});s(667294);var n=s(745238),r=s(785893);const o=(0,n.IU)("filterCircled",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.667 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM4.41797 6.75879H11.5889C11.9307 6.75879 12.1699 6.54688 12.1699 6.22559C12.1699 5.9043 11.9307 5.68555 11.5889 5.68555H4.41797C4.07617 5.68555 3.84375 5.9043 3.84375 6.22559C3.84375 6.54688 4.07617 6.75879 4.41797 6.75879ZM5.36816 9.02148H10.6455C10.9805 9.02148 11.2197 8.80273 11.2197 8.48145C11.2197 8.16016 10.9805 7.94141 10.6455 7.94141H5.36816C5.02637 7.94141 4.78711 8.16016 4.78711 8.48145C4.78711 8.80273 5.02637 9.02148 5.36816 9.02148ZM6.35254 11.2773H9.6543C9.99609 11.2773 10.2354 11.0654 10.2354 10.7441C10.2354 10.4229 9.99609 10.2041 9.6543 10.2041H6.35254C6.01074 10.2041 5.77148 10.4229 5.77148 10.7441C5.77148 11.0654 6.01074 11.2773 6.35254 11.2773Z"})})}}]);