"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[28991,75203],{614473:(e,t,o)=>{o.d(t,{O:()=>u});var n=o(815145),r=o(401800),i=o(70853),a=o(80444),l=o(188923),s=o(206258),d=o(436610),c=o(608055);function u(e,t,o,u,g){const{mainEditorCurrentBlockStore:p}=a.default.state;if(!p)return;const y=e.find((e=>e.id===t.id));if(!y)return;let h;if(g){const e=s.G.createChildStore(p,y),t=e.getModel(),a=i.Or(o,e);h=(0,r.Z)({pageId:y.id,pageModel:t,baseUrl:a,pageVisitSource:n.tY.MentionInPage})}else{const e=p.getModel(),t=i.Or(o,p);h=(0,r.Z)({pageId:p.id,pageModel:e,baseUrl:t,peekViewBlockId:y.id,peekMode:(0,l.getUrlParamFromPeekMode)(l.default.state.mode),pageVisitSource:n.tY.MentionInPage}),d.XX(o,{from:u,meta_click:Boolean(g)})}c.c4({environment:o,url:h,openInNew:g})}},464155:(e,t,o)=>{o.d(t,{Z:()=>c});o(667294);var n=o(800480),r=o(724405),i=o(841892),a=o(709291),l=o(137810),s=o(132662),d=o(785893);function c(e){const t=(0,a.useIntl)(),o=function(e){const{isMobile:t}=(0,n.Fy)(),o=t?18:14,i=1,a=6,s=20;return(0,r.yK)((t=>({githubContainer:{display:"flex",alignSelf:"center",flexDirection:"column",width:e||"90%",padding:s,border:`${i}px solid ${t.tableDividerColor}`,borderRadius:a,borderBottomRightRadius:4,cursor:"default"},githubPrTitleRow:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:`calc(100% + ${s}px)`,overflow:"hidden"},githubPrTitle:{display:"inline-flex",fontSize:o,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",background:t.whiteButtonBackground,padding:"2px 4px",borderTopLeftRadius:5,borderBottomLeftRadius:5,borderLeft:`2px solid ${t.blueColor}`,borderTop:`2px solid ${t.blueColor}`,borderBottom:`2px solid ${t.blueColor}`,width:"100%"},githubTask:{background:"light"===t.mode?t.accentColors.blue[50]:t.accentColors.blue[400]},githubPrInfoRow:{display:"inline-flex"},githubPrInfoPill:{display:"flex",flexDirection:"row",alignItems:"center",width:"fit-content",padding:"4px 10px",borderRadius:"2em",background:"#238636",flexShrink:0,...l.Z.textOverflowStyle},githubPrInfoOpenText:{color:"white",fontSize:o-2,fontWeight:500},githubPrInfoMergeInto:{display:"inline-flex",alignItems:"center",fontSize:o-2,color:t.lightTextColor,...l.Z.textOverflowStyle},githubPrInfoMain:{padding:"0px 4px",fontFamily:l.Z.baseFontFamily.githubMono,background:t.cardPressedBackground,borderRadius:a,color:t.regularTextColor,verticalAlign:"text-bottom",...l.Z.textOverflowStyle}})),[o,e])}(e.width),c=(0,d.jsx)("div",{id:"github-preview-github-pr-title-row",style:o.githubPrTitleRow,children:(0,d.jsxs)("div",{id:"github-preview-github-pr-title-wrapper",style:o.githubPrTitle,children:[(0,d.jsx)(s.Z,{size:2}),"[",(0,d.jsxs)("div",{id:"github-preview-github-pr-task",style:o.githubTask,children:[e.uniqueIdPrefix||t.formatMessage(u.idPrefix),e.uniqueIdValue?`-${e.uniqueIdValue}`:"-1"]}),"]",(0,d.jsx)(s.Z,{size:2}),t.formatMessage(u.prTitle)]})}),g=(0,d.jsxs)("div",{id:"github-preview-github-pr-info-row",style:o.githubPrInfoRow,children:[(0,d.jsxs)("div",{id:"github-preview-github-open-pr-pill",style:o.githubPrInfoPill,children:[(0,d.jsx)("img",{src:i.Z.images.externalIntegrations.githubPullOpenIconWhitePng,style:{width:16,height:16}}),(0,d.jsx)(s.Z,{size:2}),(0,d.jsx)("div",{style:o.githubPrInfoOpenText,children:t.formatMessage(u.open)})]}),(0,d.jsx)(s.Z,{size:8}),(0,d.jsx)("div",{id:"github-preview-github-merge-into-main",style:o.githubPrInfoMergeInto,children:(0,d.jsxs)("span",{style:o.githubPrInfoMergeInto,children:[t.formatMessage(u.mergeInto),(0,d.jsx)(s.Z,{size:4}),(0,d.jsx)("span",{style:o.githubPrInfoMain,children:t.formatMessage(u.main)})]})})]});return(0,d.jsxs)("div",{id:"github-preview-github-container",style:o.githubContainer,children:[c,(0,d.jsx)(s.Z,{size:12}),g]})}const u=(0,a.defineMessages)({dismissButtonAriaLabel:{defaultMessage:"A button to dismiss the user education preview.",id:"database.viewSettings.githubConfigTab.preview.dismissButtonAriaLabel"},idPrefix:{defaultMessage:"TASK",id:"database.viewSettings.githubConfigTab.preview.idPrefix"},prTitle:{defaultMessage:"GitHub PR Title",id:"database.viewSettings.githubConfigTab.preview.prTitle"},open:{defaultMessage:"Open",id:"database.viewSettings.githubConfigTab.preview.open"},mergeInto:{defaultMessage:"Merge into",id:"database.viewSettings.githubConfigTab.preview.mergeInto"},main:{defaultMessage:"main",id:"database.viewSettings.githubConfigTab.preview.main"}})},73657:(e,t,o)=>{o.d(t,{Z:()=>l});var n=o(667294),r=o(828992),i=o(785893);function a(e,t){return(0,i.jsx)(r.Z,{...e,ref:t,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}const l=(0,n.forwardRef)(a)},493131:(e,t,o)=>{o.d(t,{Z:()=>h});var n=o(667294),r=o(800480),i=o(886628),a=o(724405),l=o(747453),s=o(709291),d=o(401018),c=o(552275),u=o(731278),g=o(776798),p=o(785893);function y(e){const{pageName:t,targetCollectionStore:o,...n}=e,y=(0,r.Fy)(),h=(0,i.VK)((()=>o.getIcon()),[o]),m=(0,a.yK)((e=>({medium:{color:e.mediumTextColor},dbName:{display:"flex",alignItems:"center",marginLeft:4},title:{marginLeft:d.Qi*(y.isRetina?.5:1)},icon:{width:16,fill:e.mediumIconColor}})),[y.isRetina]),f=(0,p.jsxs)("div",{style:m.dbName,children:[(0,p.jsx)(u.Z,{disabled:!0,icon:h,isEmptyPage:!1,size:y.isMobile?24:20}),(0,p.jsx)(g.Z,{store:o,style:m.title})]});return(0,p.jsx)(c.Z,{title:(0,p.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,p.jsx)(s.FormattedMessage,{id:"database.searchRelation.createNewPageFooter",defaultMessage:"<medium>New</medium> {pageName} <medium> in</medium> {databaseNameWithIcon}",values:{medium:e=>(0,p.jsx)("span",{style:m.medium,children:e}),pageName:(0,p.jsx)("span",{style:{marginLeft:4,marginRight:4},children:t}),databaseNameWithIcon:f}})}),icon:(0,l.R)(m.icon),...n})}const h=n.memo(y)},246247:(e,t,o)=>{o.d(t,{Z:()=>c});o(667294);var n=o(800480),r=o(724405),i=o(584169),a=o(225888),l=o(164921),s=o(316354),d=o(785893);const c=function(e){const t=(0,n.O7)(),o=(0,r.Fg)();return(0,d.jsx)(s.Z,{style:{display:"flex",alignSelf:"stretch",width:36,...e.isRight?{marginRight:-8}:{marginLeft:-8}},external:!0,href:e.href,onClick:()=>a.Fs(t,{from:e.analyticsFrom}),children:(0,d.jsx)(l.Z,{mobileFeedback:!0,style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,i.m)({width:18,marginTop:1,fill:o.lightIconColor})})})}},875203:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Z});var n=o(667294),r=o(800480),i=o(886628),a=o(724405),l=o(12396),s=o(356666),d=o(239132),c=o(561061),u=o(709291),g=o(653965),p=o(137810),y=o(436610),h=o(431869),m=o(496802),f=o(210228),b=o(460709),x=o(729376),v=o(825464),S=o(229798),P=o(73657),M=o(552275),R=o(231945),C=o(279131),k=o(573063),j=o(478140),I=o(632163),w=o(953437),F=o(672495),T=o(526388),D=o(785893);const Z=function(e){let{collectionStore:t,targetCollectionStore:o,property:l,disabled:d,rowType:c}=e;const g=(0,a.Fg)(),p=(0,r.O7)(),h=(0,i.qz)(void 0,S.Z),m=(0,i.VK)((()=>{const e=x.U1({collectionStore:t,property:l}),n=Object.keys(o.getSchema()).map((t=>e.find((e=>e.property===t))??{property:t,visible:!1})),r=e.map((e=>e.property)),i=e=>{const t=r.indexOf(e);return-1!==t?t:1/0};return n.sort(((e,t)=>i(e.property)-i(t.property))),n}),[t,o,l]),f=(0,n.useCallback)((e=>(0,D.jsx)(B,{parent:e,collectionStore:t,property:l,disabled:d,targetCollectionStore:o,menuListStore:h,allRelatedTargetProperties:m})),[t,l,d,o,h,m]);return(0,r.MO)()&&"section"!==c?null:(0,D.jsx)(T.Z,{renderTooltip:()=>(0,D.jsx)(u.FormattedMessage,{id:"database.RelationCustomizeLayoutMenu.tooltip.button.message",defaultMessage:"Customize shown properties"}),placement:"section"===c?v.u.Top:v.u.Right,render:e=>(0,D.jsx)(R.ZP,{popupType:w.kQ.Popup,alignmentToOrigin:v.v.Start,...e,renderOrigin:t=>(0,D.jsx)(k.Z,{icon:s.o,iconStyle:{width:16,color:g.mediumIconColor,fill:g.mediumIconColor},...t,...e}),onClick:()=>{y.gP(p,{from:"section"===c?"relation_section":"configure_relation_modal"})},originGap:16,render:f})})};function V(e){const{props:t,children:o}=e;return(0,D.jsx)(F.Z,{...t,noTextOverflow:!0,isTitleUppercase:!1,title:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"Hidden in relation",id:"database.relationMenu.hiddenInRelationTitle"}),desktopTitleStyle:{height:19},children:o,disableDesktopPadding:!0})}function _(e,t,o,n,r,i,a){const{properties:s,visibility:u}=e;return g.oA(s.map((e=>function(e,t,o,n,r,i,a){const{propertyFormat:s,visibility:u}=e,g=!u,y=r.getSchema();if(!y)return;const m=y[s.property];return m?{key:s.property,render:e=>(0,D.jsx)(M.Z,{...e,showDragHandle:!a,title:(0,D.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,D.jsx)(l.ZP,{icon:m.icon,type:m.type,size:16,theme:o,style:{fill:o.regularIconColor}}),(0,D.jsx)("span",{style:{marginLeft:8,...p.Z.textOverflowStyle},children:m.name})]}),right:(0,D.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,D.jsx)(k.Z,{icon:g?c.B:d.c,iconStyle:{width:16,height:16},isDarkIconColor:!g,onClick:()=>{h.qK({propertyFormat:s,visibility:u,collectionStore:n,property:i,environment:t})},disabled:a||"title"===s.property})})}),action:()=>{}}:void 0}({propertyFormat:e,visibility:u},t,o,n,r,i,a))))}function L(e){const t=(0,r.O7)(),{collectionStore:o,property:n,menuListStore:i,disabled:a,visibleProperties:l,hiddenProperties:s,children:d}=e,c=g.oA([...l.map((e=>e.property)),l.length>0&&s.length>0&&{key:"group-header-hidden-property",draggable:!1},...s.map((e=>e.property))]);return(0,D.jsx)(C.ZP,{direction:"vertical",keys:c,renderKey:(e,t)=>d[t],onDrop:e=>{!function(e,t,o,n,r){const{newPropertyKeys:i}=e,a=x.U1({collectionStore:o,property:n}),l=i.indexOf("group-header-hidden-property"),s=g.oA(i.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const o=a.find((t=>t.property===e));return o?l>0?"title"===e&&t>=l?o:{...o,visible:Boolean(t<l)}:o:{property:e,visible:!(l>0)||Boolean(t<l)}}))),d=a.filter((e=>!i.includes(e.property))),c={...x.ZI(o)};c[n]||(c[n]={}),c[n].related_properties=[...s,...d],f.createAndCommit({userAction:"RelationPropertyCustomizeLayoutMenu.handlePropertyReorder",environment:t,perform:e=>{m.FH({stores:[o],update:{collection_relation_options:c},transaction:e})}}),r.reset()}({newPropertyKeys:e},t,o,n,i)},disabled:a})}function B(e){let{parent:t,collectionStore:o,property:n,disabled:l,targetCollectionStore:s,menuListStore:d,allRelatedTargetProperties:c}=e;const p=(0,a.Fg)(),y=(0,r.O7)(),h=c.filter((e=>e.visible)),m=c.filter((e=>!e.visible)),f=(0,i.VK)((()=>_({properties:h,visibility:!0},y,p,o,s,n,l)),[h,y,p,o,s,n,l]),x=(0,i.VK)((()=>_({properties:m,visibility:!1},y,p,o,s,n,l)),[m,y,p,o,s,n,l]);return c?(0,D.jsxs)(j.Z,{menuType:b.og.Popup,maxWidth:240,maxHeight:500,children:[0===c.length&&(0,D.jsx)(F.Z,{children:(0,D.jsx)(P.Z,{caption:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"No properties",id:"database.relationMenu.noProperties"})})}),c.length>0&&(0,D.jsx)(I.Z,{type:I.i.Vertical,store:d,initialFocus:void 0,sections:g.oA([h.length>0&&{key:"visible_and_hidden_properties",render:e=>(0,D.jsx)(F.Z,{...e,noTextOverflow:!0,isTitleUppercase:!1,title:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"Shown in relation",id:"database.relationMenu.shownInRelationTitle"}),desktopTitleStyle:{height:18},children:(0,D.jsx)(L,{collectionStore:o,property:n,disabled:l,menuListStore:d,visibleProperties:h,hiddenProperties:m,children:e.children})}),items:g.oA([...f,m.length>0&&{key:"group-header-hidden-property",render:e=>(0,D.jsx)(V,{props:e,children:(0,D.jsx)(D.Fragment,{})}),action:()=>{}},...x])},0===h.length&&m.length>0&&{key:"hidden_properties",render:e=>(0,D.jsx)(V,{props:e,children:(0,D.jsx)(L,{collectionStore:o,property:n,disabled:l,menuListStore:d,visibleProperties:h,hiddenProperties:m,children:e.children})}),items:x}])})]}):null}},566890:(e,t,o)=>{o.d(t,{DK:()=>u,L1:()=>d,Y$:()=>c,cu:()=>l,xm:()=>s});o(21703);var n=o(667294),r=o(67381);const i="collectionContextStore",a=(0,r.Q)({displayName:i,legacyContextKey:i,modernContextDefaultValue:void 0}),l=a.context,s=a.legacyPropTypes,d=a.Provider;function c(){const e=n.useContext(l);if(void 0===e)throw new Error(`No context provided: ${i}`);return e}function u(){return n.useContext(l)}},628991:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Gt,handleMobileSearchInputClick:()=>$t});o(757658);var n=o(667294),r=o(800480),i=o(886628),a=o(724405),l=o(815145),s=o(371663),d=o(399036),c=o(180951),u=o(143690),g=o(401800),p=o(977657),y=o(842875),h=o(559054),m=o(747453),f=o(421202),b=o(803791),x=o(709291),v=o(436610),S=o(108406),P=o(100952),M=o(454642),R=o(800893),C=o(547307),k=o(608055),j=o(137231),I=o(210228),w=o(61202),F=o(854428),T=o(552275),D=o(436488),Z=o(268894),V=o(478140),_=o(953437),L=o(731278),B=o(776798),O=o(672495),U=o(246247),K=o(493131),A=o(785893);function G(e){const{targetCollectionStore:t,title:o,onClick:n,focused:l,isSection:s,index:d}=e,c=(0,i.VK)((()=>t.canEdit()),[t]),u=(0,i.VK)((()=>t.isSyncedCollection()),[t]),g=(0,r.Fy)(),p=(0,a.yK)((e=>({wrapper:{borderTop:`1px solid ${e.lightDividerColor}`,paddingTop:4,paddingBottom:4},row:{fontSize:g.isMobile?16:14,minHeight:g.isMobile?44:32}})),[g]);if(!c)return null;const y=(0,A.jsx)(K.Z,{targetCollectionStore:t,pageName:o,onClick:()=>n(d),style:p.row,focused:l});return u?(0,A.jsx)(A.Fragment,{}):s?(0,A.jsx)(O.Z,{style:p.wrapper,disableDesktopPadding:!0,disableMobilePadding:!0,children:y}):y}var N=o(566890),E=o(730459),z=o(970764),W=o(368585),q=o(741195),Q=o(433929),H=o(460709),$=o(729376),Y=o(918514),X=o(318245),J=o(675822),ee=o(70853),te=o(80444),oe=o(319385),ne=o(530874),re=o(206258),ie=o(288280);const ae=(0,x.defineMessages)({syncedCollectionInputPlaceholder:{defaultMessage:"Link a page",id:"relationPropertyMenuInput.syncedCollection.searchPlaceholder"},connectedRelationInputPlaceholder:{defaultMessage:"Find a page",id:"relationPropertyMenuInput.connectedRelation.searchPlaceholder"},connectedRelationGoogleDriveInputPlaceholder:{defaultMessage:"Paste in Google Drive or Google Docs link",id:"relationPropertyMenuInput.connectedRelationGoogleDrive.searchPlaceholder"},connectedRelationFigmaInputPlaceholder:{defaultMessage:"Paste in https://figma.com/...",id:"relationPropertyMenuInput.connectedRelationFigma.searchPlaceholder"},connectedRelationGithubInputPlaceholder:{defaultMessage:"Paste in https://github.com/...",id:"relationPropertyMenuInput.connectedRelationGithub.searchPlaceholder"}}),le=(0,x.defineMessages)({inputPlaceholderEditable:{defaultMessage:"Link or create a page…",id:"relationPropertyMenuInput.placeholder.defaultEditable"},inputPlaceholderUneditable:{defaultMessage:"Search linked pages…",id:"relationPropertyMenuInput.placeholder.defaultUneditable"}}),se=(0,x.defineMessages)({inputPlaceholder:{defaultMessage:"Search...",id:"relationPropertyMenuInput.placeholder.sprint"}});function de(e){let{connectedRelationFlags:t,overlayMode:o,disabled:n}=e;const r=function(e){const{isSyncedCollectionRelation:t,isGithubPrRelation:o,isGoogleDriveRelation:n,isFigmaRelation:r,isConnectedRelation:i}=e;if(t)return ae.syncedCollectionInputPlaceholder;if(o)return ae.connectedRelationGithubInputPlaceholder;if(n)return ae.connectedRelationGoogleDriveInputPlaceholder;if(r)return ae.connectedRelationFigmaInputPlaceholder;if(i)return ae.connectedRelationInputPlaceholder}(t);return r||("view"===(null==o?void 0:o.type)||n?le.inputPlaceholderUneditable:le.inputPlaceholderEditable)}o(21703);var ce=o(568626),ue=o(552629),ge=o(296994),pe=o(451741);async function ye(e){let{environment:t,query:o,targetCollectionStore:n,blockPointers:r}=e;try{const e=await ge.FF.searchActions.load(),{results:i}=await e.searchPagesInCollection({environment:t,query:o.query,collectionId:n.id,limit:o.limit,spaceId:n.getSpaceId(),excludeTemplates:!0,source:"relation_menu",includePublicPagesWithoutExplicitAccess:!0,boostRecentlyViewedPages:!0,ignoresHighlight:!0});return he({results:i,targetCollectionStore:n,blockPointers:r})}catch(i){return ce.log({level:"error",from:"relationPropertySearchRequest",type:"performDefaultSearchRequest",error:(0,ue.Ui)(i)}),[]}}function he(e){let{results:t,targetCollectionStore:o,blockPointers:n}=e;const r=new Set(n.map((e=>e.id))),i=[];return t.forEach((e=>{const t={spaceId:o.getSpaceId(),id:e,table:f.iU};if(r.has(e)){const o={key:e,type:pe.Rt.SelectedPage,pointer:t};i.push(o)}else{const o={key:e,type:pe.Rt.SearchPage,pointer:t};i.push(o)}})),i}const me=(0,n.createContext)(void 0);function fe(e){const{children:t,relationPropertyMenuStore:o,targetCollectionStore:r,propertySchema:i,targetParentUrl:a,connectedRelationFlags:l}=e,[s,d]=(0,n.useState)(!1),c=(0,n.useMemo)((()=>({relationPropertyMenuStore:o,targetCollectionStore:r,propertySchema:i,targetParentUrl:a,connectedRelationFlags:l,isSearchLoading:s,setIsSearchLoading:d})),[o,r,i,a,l,s,d]);return(0,A.jsx)(me.Provider,{value:c,children:t})}me.displayName="RelationPropertyMenuContext";var be=o(749085);class xe extends be.default{getInitialState(){return{searchQuery:"",searchLimit:xe.limitIncrement,searchPopupOpen:!1,addingPage:!1}}}xe.limitIncrement=20,xe.incrementScrollOffset=200;const ve=xe;var Se=o(137810),Pe=o(374194),Me=o(584076);function Re(e){const{showTargetDatabase:t,inputPlaceholder:o,addPage:l}=e,{analyticsFrom:s,collectionStore:d,blockPropertyValueOverlayStore:c,blockStore:u,insertChar:g}=(0,n.useContext)(F.m),p=(0,n.useContext)(me),y=(0,r.O7)(),h=(0,r.Fy)(),{searchQuery:m,searchPopupOpen:f}=(0,i.VK)((()=>(null==p?void 0:p.relationPropertyMenuStore.state)??{searchQuery:g??"",searchPopupOpen:!1}),[null==p?void 0:p.relationPropertyMenuStore,g]),b=(0,i.VK)((()=>null==p?void 0:p.targetCollectionStore.getIcon()),[null==p?void 0:p.targetCollectionStore]),S=(0,a.yK)((e=>({regular:{color:e.mediumTextColor,whiteSpace:"nowrap",marginLeft:4},headerWrap:{display:"flex",width:"100%",position:"relative",zIndex:2,padding:"6px 10px",fontSize:14,background:e.inputBackground,boxShadow:`\n\t\t\t\t\t0 1px 0 ${e.darkDividerColor}\n\t\t\t\t`},recordTitle:{fontWeight:Se.Z.fontWeight.semibold,fontSize:14,marginLeft:pe.Qi*(h.isRetina?.5:1)},searchIcon:{fill:e.mediumIconColor,width:14,height:14,marginRight:10},input:{flexGrow:1},targetDatabase:{display:"flex",marginLeft:10,alignItems:"center"},linkBoxOuterStyle:{marginLeft:pe.Qi},linkBoxInnerStyle:{display:"flex"}})),[h.isRetina]);if(!(d&&u&&c&&p))return null;const{relationPropertyMenuStore:P,targetCollectionStore:M,targetParentUrl:R}=p,C=o?Q.default.formatMessage(o):void 0;return(0,A.jsxs)("div",{style:S.headerWrap,children:[(0,A.jsx)(Pe.Z,{style:S.input,value:m,placeholder:C,forceShowClearButton:Boolean(m||f),focus:!0,onChange:e=>{const t=e.target.value;P.setState({...P.state,searchQuery:t,searchPopupOpen:!!t,searchLimit:ve.limitIncrement})},onClearButtonClick:()=>{P.setState(P.getInitialState())},onClick:()=>{P.setState({...P.state,searchQuery:m,searchPopupOpen:!0,searchLimit:ve.limitIncrement})},onKeyDown:e=>{"Escape"===e.key&&P.setState(P.getInitialState())},format:Pe.B.Transparent,onSubmit:()=>{const e=M.getFormat().integration_id,t=ne.Z.integrations.state.find((t=>t.id===e)),o=M.getFormat().pattern_name;if(!t||!o)return;(0,$.DB)({integration:t,patternName:o,url:m})&&l()}}),t&&(0,A.jsx)("div",{style:S.targetDatabase,children:(0,A.jsx)(x.FormattedMessage,{id:"database.relationProperty.newRelation.targetDatabase",defaultMessage:"<regular>In</regular> {databaseWithIcon}",values:{regular:e=>(0,A.jsx)("span",{style:S.regular,children:e}),databaseWithIcon:(0,A.jsxs)(Me.Z,{href:R,style:S.linkBoxOuterStyle,innerStyle:S.linkBoxInnerStyle,onClick:()=>{s&&v.ZZ(y,{from:s})},children:[(0,A.jsx)(L.Z,{disabled:!0,icon:b,isEmptyPage:!1,size:pe.WO}),(0,A.jsx)(B.Z,{store:M,underline:!0,style:S.recordTitle})]})}})})]})}o(430541);var Ce=o(966673),ke=o(653965),je=o(60971),Ie=o(614473),we=o(279131),Fe=o(568785),Te=o(632163),De=o(953336),Ze=o(543145),Ve=o(89767);function _e(e){const{targetCollectionStore:t,onClick:o,focused:l,isSection:s,index:d,onMouseEnter:c,blockPropertyValueOverlayStore:u}=e,g=(0,i.VK)((()=>t.canEdit()),[t]),p=(0,i.VK)((()=>t.isSyncedCollection()),[t]),y=(0,r.Fy)(),h=(0,a.yK)((e=>({medium:{fontWeight:Se.Z.fontWeight.medium},wrapper:{borderTop:`1px solid ${e.lightDividerColor}`},icon:{width:14,fill:"#A6A299",marginRight:-2,marginLeft:0},row:{fontSize:y.isMobile?16:14,minHeight:y.isMobile?44:32}})),[y]),m=(0,A.jsx)(T.Z,{focused:l,onMouseEnter:c,icon:(0,Ve.R)(h.icon),style:h.row,onClick:(0,n.useCallback)((()=>{o(d),u.setState({isOpen:!1})}),[d,o,u]),title:(0,A.jsx)(x.FormattedMessage,{id:"database.searchRelation.MoveToBacklogFooter",defaultMessage:"<medium>Move to backlog</medium>",values:{medium:e=>(0,A.jsx)("span",{style:h.medium,children:e})}})}),f=s?(0,A.jsx)(O.Z,{style:h.wrapper,disableDesktopPadding:!0,disableMobilePadding:!0,children:m}):m;return g?p?null:f:null}var Le=o(875203),Be=o(973744),Oe=o(434859),Ue=o(245452),Ke=o(229798),Ae=o(730120),Ge=o(407057),Ne=o(253877),Ee=o(484795),ze=o(520270),We=o(375071),qe=o(471924),Qe=o(959753),He=o(744805),$e=o(544876),Ye=o(531701),Xe=o(619584),Je=o(389475),et=o(634406),tt=o(526388),ot=o(95477),nt=o(924990),rt=o(206398),it=o(212534),at=o(98742),lt=o(165598),st=o(825464),dt=o(1634);function ct(){const e=(0,r.O7)(),t=function(){const e=(0,r.Fy)().isMobile;return(0,a.yK)((t=>({figmaResults:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontSize:e?16:12,padding:16,paddingBottom:4},figmaResultsCopyWrapper:{marginTop:0,color:t.lightTextColor}})),[e])}();return e.device.isMobile?(0,A.jsx)(A.Fragment,{}):(0,A.jsx)(A.Fragment,{children:(0,A.jsx)("div",{style:t.figmaResults,children:(0,A.jsx)("p",{style:t.figmaResultsCopyWrapper,children:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"To link, paste the Figma File URL above",id:"connectedRelationPropertyMenuResults.figmaRelationUserEducationPasteUrl.description"})})})})}var ut=o(990559),gt=o(875553),pt=o(584169),yt=o(774882),ht=o(316956),mt=o(412714),ft=o(51592),bt=o(464155),xt=o(164921),vt=o(661519),St=o(132662);const Pt=(0,x.defineMessages)({githubCopyIdAria:{defaultMessage:"Copy the ID value.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.copyIdAria"},githubAddIdAria:{defaultMessage:"Add a unique id property to the database.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.addIdAria"},githubLearnMoreAria:{defaultMessage:"Learn more about the GitHub Pull Requests feature.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.learnMoreAria"}});function Mt(e){const{pageBlockStore:t,blockPropertyValueOverlayStore:o}=e,n=(0,r.O7)(),a=(0,x.useIntl)(),l=Rt(),s=(0,N.Y$)(),d=(0,i.VK)((()=>s.collectionStore()),[s]),u=(0,i.VK)((()=>s.databaseType),[s]),g=(0,i.VK)((()=>{var e;return d&&(null===(e=d.getRecordKeyStore())||void 0===e?void 0:e.getRecordKey())}),[d]),{uniqueIdPropertyId:y,uniqueIdValue:h}=(0,i.VK)((()=>{const e=t.getSchema(),o=(0,ut.$z)(e);if(1!==o.length)return{uniqueIdPropertyId:void 0,uniqueIdValue:void 0};const n=t.getPropertyValue(o[0]);return{uniqueIdPropertyId:o[0],uniqueIdValue:(0,c.ah)(n)}}),[t]),f=(0,i.VK)((()=>(0,ut.wf)(g,h)),[g,h]),b=(0,i.VK)((()=>!Boolean(g)||!Boolean(h)),[g,h]);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{style:l.githubResults,children:[(0,A.jsx)(Ct,{}),(0,A.jsx)("p",{style:l.githubResultsCopyWrapper,children:b?(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Create a prefixed ID property to paste in the GitHub PR title.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.badIdError"}):(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Copy the {singleItemName} ID and paste it into the title of your PR in GitHub.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducationLinkPastingOn.description",values:{singleItemName:(0,ft.sN)(u)}})}),(0,A.jsx)(bt.Z,{width:"100%",uniqueIdPrefix:g,uniqueIdValue:h})]}),(0,A.jsxs)("div",{style:l.githubResultsButtonsWrapper,children:[(0,A.jsxs)(xt.Z,{style:l.githubResultsLearnMore,ariaLabel:a.formatMessage(Pt.githubLearnMoreAria),onClick:e=>{e.preventDefault(),mt.D({environment:n,url:(0,Y.UY)("guides.githubRelation"),targetSelf:!1})},children:[(0,pt.m)({width:n.device.isMobile?16:12}),(0,A.jsx)(St.Z,{size:4}),(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Learn more",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.learnMore"})]}),b?(0,A.jsxs)(xt.Z,{style:l.githubResultsCTAButton,ariaLabel:a.formatMessage(Pt.githubAddIdAria),onClick:async e=>{e.preventDefault(),d&&(await yt.K({environment:n,collectionStore:d}),I.createAndCommit({userAction:"CollectionSettingsAutoIncrementIdPropertyCreateNewIdProperty",environment:n,perform:e=>{ht.G3({environment:n,collectionStore:d,collectionViewArgs:void 0,propertyType:"auto_increment_id",transaction:e})}}),S._H({environment:n,collectionContextStore:s,from:"github_relation_menu",property_type:"auto_increment_id",integration_id:p.U9}))},children:[(0,m.R)({width:n.device.isMobile?16:12}),(0,A.jsx)(St.Z,{size:4}),(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Add ID property",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.addId"})]}):(0,A.jsxs)(xt.Z,{style:l.githubResultsCTAButton,ariaLabel:a.formatMessage(Pt.githubCopyIdAria),onClick:async e=>{e.preventDefault(),await R.RD({stringValue:f,environment:n,copiedMessage:R.tq.copiedPropertyToClipboard}),y&&S.S$(n,s,{block_id:t.id,property:y,property_type:"auto_increment_id",github_relation_menu:!0}),o.setState({isOpen:!1})},children:[(0,gt.U)({width:n.device.isMobile?16:12}),(0,A.jsx)(St.Z,{size:4}),(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Copy {singleItemName} ID",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.copyId",values:{singleItemName:(0,ft.sN)(u)}})]})]})]})}function Rt(){const e=(0,r.Fy)().isMobile;return(0,a.yK)((t=>({githubResults:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontSize:e?16:12,padding:16,paddingBottom:4},githubResultsCopyWrapper:{marginTop:0,color:t.lightTextColor},githubResultsErrorWrapper:{marginTop:0,color:Ye.ZP.red},githubResultsButtonsWrapper:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",fontSize:e?16:12,padding:"10px"},githubResultsLearnMore:{display:"flex",flexDirection:"row",alignItems:"center",padding:4,borderRadius:5,color:t.lightTextColor},githubResultsCTAButton:{display:"flex",flexDirection:"row",alignItems:"center",padding:4,borderRadius:5,color:t.blueColor},githubLinkPastingSeparator:{border:t.tableDividerColor,width:"100%"},githubLinkPastingContainer:{width:"100%",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",margin:"8px 0px"},githubLinkPastingSeparatorText:{position:"absolute",backgroundColor:t.popoverBackground,color:t.lightTextColor,padding:"0px 8px"}})),[e])}function Ct(){const e=Rt();return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("p",{style:e.githubResultsCopyWrapper,children:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"To link, paste the GitHub PR URL above",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducationPasteUrl.description"})}),(0,A.jsxs)("div",{style:e.githubLinkPastingContainer,children:[(0,A.jsx)(vt.Z,{size:1,style:e.githubLinkPastingSeparator}),(0,A.jsx)("div",{style:e.githubLinkPastingSeparatorText,children:"or"})]}),(0,A.jsx)(St.Z,{size:8})]})}var kt=o(328415);function jt(e){const t=(0,r.O7)(),o=function(){const e=(0,r.Fy)().isMobile;return(0,a.yK)((t=>({googleDriveResults:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontSize:e?16:12,padding:16,paddingBottom:4,paddingTop:4},googleDriveResultsCopyWrapper:{marginTop:0,color:t.lightTextColor,marginBottom:0},googleDriveResultsLearnMore:{display:"flex",flexDirection:"row",alignItems:"center",padding:4,borderRadius:5},googleDriveResultsAccount:{fontSize:12,margin:0},googleDriveLinkPastingSeparator:{border:t.tableDividerColor,width:"100%"},googleDriveLinkPastingContainer:{width:"100%",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",margin:"8px 0px"},googleDriveLinkPastingSeparatorText:{position:"absolute",backgroundColor:t.cardContentBackground,color:t.lightTextColor,padding:"0px 8px"}})),[e])}(),n=(0,i.VK)((()=>ne.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===p.f3}))),[]);return t.device.isMobile?(0,A.jsx)(A.Fragment,{}):(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)("div",{style:o.googleDriveResults,children:[(0,A.jsx)("p",{style:o.googleDriveResultsCopyWrapper,children:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"To link, paste the Google Drive File URL above",id:"connectedRelationPropertyMenuResults.googleDriveRelationUserEducationPasteUrl.description"})}),(0,A.jsxs)("div",{style:o.googleDriveLinkPastingContainer,children:[(0,A.jsx)(vt.Z,{size:1,style:o.googleDriveLinkPastingSeparator}),(0,A.jsx)("div",{style:o.googleDriveLinkPastingSeparatorText,children:"or"})]}),(0,A.jsx)(St.Z,{size:2}),(0,A.jsx)("p",{style:o.googleDriveResultsCopyWrapper,children:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Select an account below to browse files on your Google Drive",id:"connectedRelationPropertyMenuResults.googleDriveRelationUserEducationSourcePicker.description"})}),(0,A.jsx)(St.Z,{size:2}),n.map(((n,r)=>(0,A.jsx)(xt.Z,{style:o.googleDriveResultsLearnMore,onClick:async o=>{o.preventDefault(),await(async(o,n)=>{const r=await w.jh({environment:t,externalAuthenticationValue:n}),i=ne.Z.integrations.state.find((e=>e.id===n.integration_id));if(!i)return;const{id:a,name:l,info:s}=i,{icon:d,dark_icon:c,accent_color:u,accent_icon:g}=s,p="dark"===t.ThemeStore.state.mode&&c?c:d;p&&u&&g&&r&&"failed"!==r.type&&await(0,kt.vE)({environment:t,accessToken:r.data.access_token,callback:(t,n)=>{e.onFileSelect(o,n)},integration:{id:a,name:l,icon:p,accentColor:u,accentIcon:g},from:"connected_relation_property_value"})})(o,n)},children:(0,A.jsx)("p",{style:o.googleDriveResultsAccount,children:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"{account}",id:"connectedRelationPropertyMenuResults.googleDriveRelation.googleDriveAccount.description",values:{account:n.account_name}})})},r)))]})})}function It(){const e=(0,r.O7)(),t=function(){const e=(0,r.Fy)().isMobile;return(0,a.yK)((t=>({salesforceResults:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontSize:e?16:12,padding:16,paddingBottom:4,paddingTop:4},salesforceResultsCopyWrapper:{marginTop:0,color:t.lightTextColor,marginBottom:0},salesforceResultsLearnMore:{display:"flex",flexDirection:"row",alignItems:"center",padding:4,borderRadius:5}})),[e])}();return e.device.isMobile?(0,A.jsx)(A.Fragment,{}):(0,A.jsx)(A.Fragment,{children:(0,A.jsx)("div",{style:t.salesforceResults,children:(0,A.jsx)("p",{style:t.salesforceResultsCopyWrapper,children:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"To link, paste the Salesforce URL above",id:"connectedRelationPropertyMenuResults.salesforceRelationUserEducationPasteUrl.description"})})})})}function wt(e){var t;const{sections:o,collectionStore:n,targetCollectionStore:l,search:s,property:d,propertySchema:u,pageRecordStore:g,blockPropertyValueOverlayStore:m}=e,b=(0,a.yK)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"},settingsMenuSearchBox:{background:e.contentBackground,marginBottom:10},addPageButton:{width:"100%",display:"flex",justifyContent:"center"},suggestionBox:{display:"flex",alignItems:"center",fontSize:12,color:Ye.ZP.white,background:Ye.ZP.blue,borderRadius:6,padding:10,boxShadow:e.largeLightBoxShadow,alignSelf:"center",maxWidth:"80%"},errorMessage:{alignSelf:"center",padding:10,fontSize:14,color:e.errorText},addingPage:{width:"100%",padding:10,display:"flex",justifyContent:"flex-start",fontSize:14,color:e.mediumTextColor},enterText:{color:e.lightTextColor}})),[]),v=c.Kp(u),S=c.gg(u),P=c.ic(u),R=c.R3(u),C=(0,i.VK)((()=>{if(!l)return;const e=l.getFormat().integration_id;return ne.Z.integrations.state.find((t=>t.id===e))}),[l]),k=(0,i.VK)((()=>C?(0,z.NP)(C.id):[]),[C]),j=(0,r.O7)(),I=(0,x.useIntl)(),w=(0,a.Fg)(),F=(0,i.VK)((()=>{const e=ne.Z.state;return e.loaded?e.integrations:[]}),[]),D=(0,i.VK)((()=>{var e;return Boolean(null===(e=te.default.state.currentSpaceStore)||void 0===e?void 0:e.canAdmin())}),[]),Z=(0,i.VK)((()=>{var e;return!(!(null===(e=te.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit())||!(0,z.sw)(j))}),[j]),V=(0,i.VK)((()=>{const e=ne.Z.state;return e.loaded&&C?e.externalAuthentications.filter((e=>e.integration_id===C.id)):[]}),[C]),_=(0,i.VK)((()=>V.length?V[0]:null),[V]),[{value:L,status:B}]=(0,h.r5)((async()=>{if(!_||!C||!(0,p.ok)(C.id))return;const e=_.parent_id;return M.listExternalObjects(j,{bot_id:e,query:s})}),[j,_,s,C],{debounce:1e3}),U=(0,i.VK)((()=>l.getFormat().pattern_name),[l]),K=(0,i.VK)((()=>{if(C&&s)return(0,$.DB)({integration:C,patternName:U,url:s})}),[U,C,s]),G=(0,lt.OY)(g)?g:void 0,N=(0,i.VK)((()=>(0,lt.OY)(g)?g.getPropertyStore(d):void 0),[g,d]),E=(0,i.VK)((()=>null==l?void 0:l.getIcon()),[l]),W=(0,i.VK)((()=>{var e;return null===(e=te.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),q=(0,i.VK)((()=>nt.Z.state),[]),Q={key:"githubPrRelationUserEducation",render:e=>void 0!==G&&(0,A.jsx)(Mt,{pageBlockStore:G,blockPropertyValueOverlayStore:m}),items:[]},H={key:"googleDriveRelation",render:t=>(0,A.jsx)(jt,{onFileSelect:(t,o)=>{(0,it.ZP)({context:it.Af.ButtonMouseDown,callback:()=>{e.addPage(o)},event:t})}}),items:[]},Y={key:"figmaRelation",render:e=>(0,A.jsx)(ct,{}),items:[]},X={key:"salesforceRelation",render:e=>(0,A.jsx)(It,{}),items:[]};if(!n||!N||!C)return(0,A.jsx)(Te.Z,{type:Te.i.Vertical,style:{padding:"4px 0px"},initialFocus:0,sections:o});if(!((null==C?void 0:C.id)===p.U9?null===(t=k[0])||void 0===t?void 0:t.id:null==_?void 0:_.parent_id)){const e=function(e){const{collectionIcon:t,integration:o,environment:n,spaceId:r,isAdmin:i,userAllowedToAuth:a}=e,l=o.id===p.U9,s=()=>{r&&(Je.hM({environment:n,integration:o,spaceId:r,from:"connected_relation_property_menu"}),dt.Z.reset())},d=!l&&o.id!==p.Dv;if(d){if(e.environment.device.isMobile)return{key:"askUseBrowserOrDesktopForAuth",render:e=>(0,A.jsx)(O.Z,{...e,disableMobilePadding:!0,title:(0,A.jsx)("div",{style:{whiteSpace:"normal",paddingTop:8},children:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Please authorize this integration in the browser or a desktop app.",id:"connectedRelationProperty.mobile.guide.title"})})}),items:[]};if(!a)return{key:"askGuestToGetMemberAccess",render:e=>(0,A.jsx)(O.Z,{...e,disableMobilePadding:!0,title:(0,A.jsx)("div",{style:{whiteSpace:"normal",paddingTop:8},children:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"To use {integration} integration, request the workspace admin to add you as a member",id:"connectedRelationProperty.guest.auth.guide",values:{integration:o.name}})})}),items:[]}}const c=!l||i&&a?{key:"authenticateButton",render:e=>(0,A.jsx)(T.Z,{...e,title:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Connect to {integration}",id:"connectedRelationPropertyMenuResults.authenticateButton.title",values:{integration:o.name}}),icon:(0,A.jsx)(et.Z,{src:null==t?void 0:t.icon,style:{width:14}})}),action:()=>s()}:{key:"askAdminToAuthenticateButton",render:e=>(0,A.jsx)(T.Z,{...e,title:(0,A.jsx)("div",{style:{whiteSpace:"normal"},children:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) connection.",id:"connectedRelationPropertyMenuResults.askAdminToAuthenticateButton.title"})}),icon:(0,A.jsx)(et.Z,{src:null==t?void 0:t.icon,style:{width:14}}),hoveredStyle:{cursor:"default",background:void 0},pressedStyle:{background:void 0}}),action:()=>{}};return{key:"authenticateIntegration",render:e=>(0,A.jsx)(O.Z,{...e,disableMobilePadding:!0,title:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Connect to {integration}",id:"connectedRelationPropertyMenuResults.authenticateHeader.title",values:{integration:o.name}})}),items:[c]}}({environment:j,collectionStore:n,integration:C,collectionIcon:E,spaceId:W,isAdmin:D,userAllowedToAuth:Z});return(0,A.jsx)(Te.Z,{type:Te.i.Vertical,style:{padding:"4px 0px"},initialFocus:0,sections:[...o,e]})}const J=("success"===(null==L?void 0:L.type)&&"data"in L.data?L.data.data:[]).map((e=>{const t=e.attributes.flatMap((e=>{const t=(0,$e.GY)(e);return(0,ze.nj)(t)?[t]:(console.error(t),[])})),o=(0,Xe.m8)(t.flatMap((e=>[[e.id,e]])));return{uri:e.uri,attributes:t,attributesById:o}}));function ee(){let e=(0,A.jsx)(x.FormattedMessage,{id:"connectedRelationPropertyMenuResults.addPageButton.label",defaultMessage:"Link page"});return(null==C?void 0:C.id)===p.f3||(null==C?void 0:C.id)===p.mQ?e=(0,A.jsx)(x.FormattedMessage,{id:"connectedRelationPropertyMenuResults.addFileButton.label",defaultMessage:"Link file"}):(null==C?void 0:C.id)===p.Nw?e=(0,A.jsx)(x.FormattedMessage,{id:"connectedRelationPropertyMenuResults.addTicketButton.label",defaultMessage:"Link ticket"}):(null==C?void 0:C.id)===p.U9?e=(0,A.jsx)(x.FormattedMessage,{id:"connectedRelationPropertyMenuResults.addPRButton.label",defaultMessage:"Link PR"}):(null==C?void 0:C.id)===p.eY&&(e=(0,A.jsx)(x.FormattedMessage,{id:"connectedRelationPropertyMenuResults.addObjectButton.label",defaultMessage:"Link Object"})),e}const oe={key:"thirdPartySearchResults",render:e=>(0,A.jsx)(O.Z,{...e,disableMobilePadding:!0}),items:[{key:"addPage",render:e=>(0,A.jsx)(T.Z,{...e,title:ee(),icon:(0,We.f)({width:14}),right:(0,A.jsx)(x.FormattedMessage,{id:"connectedRelationPropertyMenuResults.linkPageButton.enter",defaultMessage:"Enter"}),rightStyle:b.enterText}),action:t=>{(0,it.ZP)({event:t,context:it.Af.ButtonMouseDown,callback:()=>{e.addPage()}})}}]},ie={key:"noResultsFoundInThirdParty",render:e=>(0,A.jsx)(O.Z,{...e,disableMobilePadding:!0,title:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"No results found in {integration}.",id:"connectedRelationPropertyMenuResults.notMatched.help",values:{integration:C.name}})}),items:[]},ae=[];C&&(0,p.ok)(C.id)&&ae.push(...function(e){const{environment:t,intl:o,theme:n,externalIntegrations:r,emojiData:i}=e,a=e.results.flatMap((e=>{const t=e.attributesById.start;if(t&&(0,$e.Gc)(t)){const n=(0,Ne.NK)(t.values[0],(0,y.r)(),o.locale);return[{...e,dateTime:n.start}]}return[]})),l=ke.vM(a,(e=>e.dateTime.toFormat(Ne.Iq))),s=ke.MR(Object.keys(l),(e=>Ae.ou.fromFormat(e,Ne.Iq).valueOf())).flatMap((a=>{const s=l[a],d=ke.MR(s,(e=>e.dateTime.valueOf())),c=(0,Ee.Ki)(a);if(!c)return[];let u;(ke.Xy(c,(0,Ne.Lg)((0,y.r)()))||ke.Xy(c,(0,Ne.Ro)((0,y.r)())))&&(u="relative");const g=(0,Ge.ZV)({value:c,intl:o,allowRelativeDates:Boolean(u),date_format:u});return[{key:g,items:d.flatMap((a=>{const l=new re.G(t,{table:f.iU,id:qe.Il(),spaceId:qe.Il()}),s={id:l.id,type:"external_object_instance",alive:!0,format:{bot_id:"",external_object_id:"",uri:a.uri,attributes:a.attributes},version:0,space_id:"",parent_id:"",parent_table:"block"};let d=null,c=null;const u=a.attributesById.title,g=a.attributesById.start,p=a.attributesById.end;return g&&p&&(0,$e.Gc)(g)&&(0,$e.Gc)(p)&&(d=(0,A.jsx)("div",{children:(0,A.jsxs)("span",{children:[(0,A.jsx)(rt.r4,{style:{color:void 0,display:"inline"},attribute:g,dateStyle:"exact_time"})," - ",(0,A.jsx)(rt.r4,{attribute:p,dateStyle:"exact_time",style:{color:void 0,display:"inline"}})]})}),c=(0,A.jsxs)("div",{children:[(0,A.jsx)("span",{children:(0,A.jsx)(rt.ox,{style:{color:void 0,display:"inline"},store:l,attribute:u})}),d]})),{key:a.uri,render:e=>(0,A.jsx)(tt.Z,{renderTooltip:()=>c,placement:st.u.Left,textWrap:!0,render:a=>(0,A.jsx)(T.Z,{...(0,at.Z)(a||{},e),title:(0,He.dD)({blockModel:Qe.kk.fromBlock(s),intl:o,index:0,style:{},disableHover:!0,disableLinks:!0,isAndroid:!1,theme:n,baseUrl:ot.default.domainBaseUrl,emojiType:"raw",currentUserId:t.currentUser.id,getRecordModel:l.getRecordModel,externalIntegrations:r,emojiData:i}),caption:d})}),action:t=>{(0,it.ZP)({event:t.event,context:it.Af.ButtonMouseDown,callback:()=>{e.addPage(a.uri)}})}}})),render:e=>(0,A.jsx)(O.Z,{...e,disableMobilePadding:!0,title:g})}]}));return s}({environment:j,intl:I,theme:w,externalIntegrations:F,results:J,addPage:e.addPage,emojiData:q}));const le={key:"loadingSpinner",render:t=>(0,A.jsx)(O.Z,{...t,disableMobilePadding:!0,title:(0,A.jsxs)("div",{style:{...b.addingPage,justifyContent:e.addingPage?"center":"flex-start"},children:[(0,A.jsx)(Fe.Z,{}),(0,A.jsx)("span",{style:{marginLeft:10},children:(0,A.jsx)(x.FormattedMessage,{id:"connectedRelationPropertyMenuResults.fetchingData",defaultMessage:"Fetching data..."})})]})}),items:[]},se=[];return"pending"===B||e.addingPage?se.push(le):K?se.push(oe):ae.length>0?se.push(...ae):S?se.push(H):P?se.push(Y):R?se.push(X):v&&0===o.length?se.push(Q):v&&o.length>0||se.push(ie),(0,A.jsx)(Te.Z,{type:Te.i.Vertical,style:{padding:"4px 0px"},initialFocus:0,sections:[...o,...se]})}function Ft(){return(0,A.jsx)("div",{style:{height:"100%",padding:pe.wI,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,A.jsx)(Fe.Z,{style:{margin:"0 auto"}})})}function Tt(e){const{collectionStore:t,targetCollectionStore:o,property:n,showRight:r,disabled:a,style:l}=e,s=(0,i.VK)((()=>o.isSyncedCollection()),[o]),c=(0,i.VK)((()=>{const e=t.getSchema()[n];return Boolean(e&&d.NK(e))}),[t,n]);return(0,A.jsx)(O.Z,{...e,noTextOverflow:!0,isTitleUppercase:!1,right:r&&!s&&!c&&(0,A.jsx)(Le.default,{collectionStore:t,targetCollectionStore:o,property:n,disabled:a}),style:{paddingTop:0,paddingBottom:4,...l},desktopTitleStyle:{height:19,alignItems:"center",marginTop:6,marginBottom:6,paddingLeft:12,paddingRight:9}})}const Dt=function(e){const t=(0,r.Fy)(),o=(0,i.qz)(void 0,Ke.Z),a=(0,i.qz)(void 0,Ue.Z),l=(0,Ce.D9)(e.searchQuery);return(0,n.useEffect)((()=>{!e.searchQuery||(0,ke.Xy)(l,e.searchQuery)||t.isMobile||o.setState({...o.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),[t.isMobile,o,l,e.searchQuery]),t.isMobile?(0,A.jsx)(At,{relationPropertyMenuResultProps:e,menuListStore:o,draggableListStore:a}):(0,A.jsx)(Kt,{relationPropertyMenuResultProps:e,menuListStore:o,draggableListStore:a})};function Zt(e,t){const o=t[e];return Boolean(o&&"relation"===o.type&&1===o.limit)}function Vt(e){const{result:t,pointer:o,environment:n,relationPropertyMenuResultProps:r,canDragRow:i}=e,{disabled:a,parentStore:l,collectionStore:s,targetCollectionStore:d,onAccept:c,property:u,schema:g,blockPropertyValueOverlayStore:p,onClickActionButton:y}=r,h=re.G.createChildStore(l,o);return{key:h.id,render:e=>{let{ref:r,...c}=e;return(0,A.jsx)(ge.aJ,{...c,canDrag:i,collectionStore:s,targetCollectionStore:d,relatedPageStore:h,disabled:a,isSelected:t.type===pe.Rt.SelectedPage,pageStore:l,property:u,rowType:"popup",onActionButtonClick:()=>y(t),blockPropertyValueOverlayStore:p,propertyLimit:Zt(u,g)?1:void 0,onOpenPageButtonClick:()=>{Ie.O([o],h,n,"relation_property")}})},action:e=>{c(t,Be.DJ(e.event))}}}function _t(e){const{canDrag:t,property:o,schema:n,totalRelatedPages:r}=e;return t&&!Zt(o,n)&&r>1}function Lt(e){const{numRelatedPages:t,integrationId:o,property:n,schema:r}=e;return Zt(n,r)?(0,A.jsx)(x.FormattedMessage,{id:"database.relationProperty.relatedPages.limit.subHeader",defaultMessage:"Linked page"}):o===p.f3||o===p.mQ?(0,A.jsx)(x.FormattedMessage,{id:"database.relationProperty.relatedGoogleDriveOrFigmaFiles.subHeader",defaultMessage:"{count, plural, one {{count} linked file} other {{count} linked files}}",values:{count:t}}):o===p.U9?(0,A.jsx)(x.FormattedMessage,{id:"database.relationProperty.relatedGithubPages.subHeader",defaultMessage:"{count, plural, one {{count} linked PR} other {{count} linked PRs}}",values:{count:t}}):(0,A.jsx)(x.FormattedMessage,{id:"database.relationProperty.relatedPages.subHeader",defaultMessage:"{count, plural, one {{count} linked page} other {{count} linked pages}}",values:{count:t}})}function Bt(e){const{loading:t,numRelatedPages:o,numUnrelatedPages:n}=e;if(!t)return 0===n?(0,A.jsx)(x.FormattedMessage,{id:"database.relationProperty.noResults.subHeader",defaultMessage:"No results"}):0===o?(0,A.jsx)(x.FormattedMessage,{id:"database.relationProperty.unrelatedPages.subHeader",defaultMessage:"Link a page"}):(0,A.jsx)(x.FormattedMessage,{id:"database.relationProperty.unrelatedPages.anotherPage.subHeader",defaultMessage:"Link another page"})}function Ot(e){const{targetCollectionStore:t,collectionStore:o,property:n,canConfigureCollection:r,numRelatedPages:i,handleClearProperty:a,overlayMode:l,index:s,blockPropertyValueOverlayStore:d}=e;return{key:"backlog",render:e=>(0,A.jsx)(Tt,{...e,collectionStore:o,targetCollectionStore:t,property:n,showRight:0===i||"add"===(null==l?void 0:l.type),disabled:!r,style:{paddingBottom:0,paddingTop:0}}),items:[{key:"sprints_backlog",render:e=>(0,A.jsx)(_e,{focused:e.focused,onMouseEnter:e.onMouseEnter,targetCollectionStore:t,onClick:a,isSection:!1,index:s,blockPropertyValueOverlayStore:d}),action:()=>{a&&a()}}]}}function Ut(e){let{relationPropertyMenuResultProps:t,menuListStore:o,draggableListStore:a}=e;const{results:l,onDrag:d,parentStore:c,collectionStore:u,targetCollectionStore:g,property:p,canDrag:y,canConfigureCollection:h,loading:m,onCreatePage:f,overlayMode:b,disabled:x,schema:v,searchQuery:S,index:P,handleClearProperty:M,blockPropertyValueOverlayStore:R,relationPropertyMenuStore:C,addPage:k,addingPage:j}=t,I=(0,r.O7)(),w=(0,n.useCallback)(((e,t)=>function(e,t,o,n){n&&n(e),je.sv({store:o,focus:{section:0,indexLocal:t.endPosition,indexGlobal:t.endPosition}})}(e,t,o,d)),[o,d]),{device:F}=I,T=(0,i.VK)((()=>function(e){return e.getDatabaseType()===s.p$?{getCanDragRow:()=>!1,getRelatedSectionHeaderTitle:()=>{},getUnrelatedSectionHeaderTitle:()=>{},getFooterSection:Ot}:{getCanDragRow:_t,getRelatedSectionHeaderTitle:Lt,getUnrelatedSectionHeaderTitle:Bt,getFooterSection:()=>{}}}(g)),[g]),D=v[p],Z=Boolean("relation"===(null==D?void 0:D.type)&&D.connectedRelation),[V,_]=(0,i.VK)((()=>{const e=[],o=[],n=l.filter((e=>e.type===pe.Rt.SelectedPage)).length;for(const r of l)if(r.type===pe.Rt.SearchPage){re.G.createChildStore(c,r.pointer).isTemplate()||o.push(Vt({environment:I,result:r,pointer:r.pointer,relationPropertyMenuResultProps:t,canDragRow:!1}))}else if(r.type===pe.Rt.SelectedPage){const o=T.getCanDragRow({canDrag:y,property:p,schema:v,totalRelatedPages:n});e.push(Vt({environment:I,result:r,pointer:r.pointer,relationPropertyMenuResultProps:t,canDragRow:o}))}return[e,o]}),[I,l,c,t,y,v,T,p]),L=(0,i.VK)((()=>g.getFormat().integration_id),[g]),B=T.getRelatedSectionHeaderTitle({numRelatedPages:V.length,integrationId:L,property:p,schema:v}),O=[];if(V.length>0){const e=V.map((e=>e.key.toString()));O.push({key:"results",render:t=>(0,A.jsx)(Tt,{...t,title:B,collectionStore:u,targetCollectionStore:g,property:p,showRight:"add"!==(null==b?void 0:b.type),disabled:!h,style:{paddingBottom:void 0===B?0:4},children:y&&!Zt(p,v)&&e.length>1?(0,A.jsx)(we.ZP,{direction:"vertical",keys:e,renderKey:o=>t.children[e.indexOf(o)],onDrop:w,store:a}):t.children}),items:V})}if(!Z&&(0===_.length&&0===V.length||_.length>0)){const e=T.getUnrelatedSectionHeaderTitle({loading:m,numRelatedPages:V.length,numUnrelatedPages:_.length}),t=!m&&0===_.length&&!F.isMobile&&!Z&&S;let o;t&&_.push({key:"empty",render:e=>(0,A.jsx)(G,{targetCollectionStore:g,title:S||"",focused:e.focused,onClick:f,isSection:!1,index:P}),action:()=>{f&&f()}}),(t||void 0===e)&&(o={paddingBottom:0});const n={key:"unrelated",render:t=>(0,A.jsx)(Tt,{...t,title:e,collectionStore:u,targetCollectionStore:g,property:p,showRight:0===V.length||"add"===(null==b?void 0:b.type),disabled:!h,style:o}),items:_};"add"===(null==b?void 0:b.type)?O.unshift(n):O.push(n)}if(!F.isMobile&&V.length>0&&!x){const e=T.getFooterSection({targetCollectionStore:g,collectionStore:u,property:p,canConfigureCollection:h,numRelatedPages:V.length,handleClearProperty:M,overlayMode:b,index:P,blockPropertyValueOverlayStore:R});e&&O.push(e)}return Z?(0,A.jsx)(wt,{blockPropertyValueOverlayStore:R,collectionStore:u,targetCollectionStore:g,sections:O,propertySchema:D,property:p,pageRecordStore:c,search:S,relationPropertyMenuStore:C,addPage:k,addingPage:j}):(0,A.jsx)(Te.Z,{type:Te.i.Vertical,store:o,style:{padding:"4px 0px"},initialFocus:I.device.isMobile?void 0:0,sections:O})}function Kt(e){let{relationPropertyMenuResultProps:t,menuListStore:o,draggableListStore:r}=e;const{results:i,loading:a,onScrollOffsetChange:l}=t,s=0===i.length;return(0,A.jsx)(n.Fragment,{children:(0,A.jsxs)(De.Z,{style:{width:"100%",maxHeight:300,position:"relative",...s&&{marginTop:0}},type:Oe.Z.Y,children:[(0,A.jsx)(Ut,{relationPropertyMenuResultProps:t,menuListStore:o,draggableListStore:r}),a&&(0,A.jsx)(Ft,{}),l&&(0,A.jsx)(Ze.Z,{onChange:l})]})})}function At(e){let{relationPropertyMenuResultProps:t,menuListStore:o,draggableListStore:r}=e;const{results:i,loading:a,resultsType:l,schema:s,property:d,blockPropertyValueOverlayStore:c,collectionStore:u,targetCollectionStore:g,parentStore:p,searchQuery:y,relationPropertyMenuStore:h,addPage:m,addingPage:f}=t,b=0===i.length,x=s[d];return Boolean("relation"===(null==x?void 0:x.type)&&x.connectedRelation)&&b?(0,A.jsx)("div",{style:{marginTop:20},children:(0,A.jsx)(wt,{blockPropertyValueOverlayStore:c,collectionStore:u,targetCollectionStore:g,sections:[],propertySchema:x,property:d,pageRecordStore:p,search:y,relationPropertyMenuStore:h,addPage:m,addingPage:f})}):(0,A.jsxs)(n.Fragment,{children:[b&&!a&&"existing"===l?void 0:(0,A.jsx)(Ut,{relationPropertyMenuResultProps:t,menuListStore:o,draggableListStore:r}),a&&(0,A.jsx)(Ft,{})]})}function Gt(){const{collectionStore:e,blockStore:t,schema:o,property:a}=(0,n.useContext)(F.m),l=(0,r.O7)(),u=(0,n.useMemo)((()=>new ve),[]),p=(0,i.VK)((()=>function(e){const{environment:t,collectionStore:o,blockStore:n,schema:r,property:i}=e;if(!n||!o)return;const a=r[i];if("relation"!==(null==a?void 0:a.type))return;const l=d.j0(a);if(!l)return;const s=re.NW.createChildStore(n,l);if(!s)return;const u=s.getParentId();if(!u)return;const p=re.G.createChildStore(s,{table:f.iU,id:u});if(!p)return;const y=p.isDefined()?ee.Or(t,p):void 0,h=(0,g.Z)({pageId:p.id,pageModel:p.getModel(),baseUrl:y,pageVisitSource:void 0});return{propertySchema:a,targetCollectionStore:s,targetParentUrl:h,connectedRelationFlags:{isSyncedCollectionRelation:s.isSyncedCollection(),isGithubPrRelation:c.Kp(a),isGoogleDriveRelation:c.gg(a),isFigmaRelation:c.ic(a),isZendeskRelation:c.U8(a),isSalesforceRelation:c.R3(a),isConnectedRelation:d.NK(a)}}}({environment:l,collectionStore:e,blockStore:t,schema:o,property:a})),[l,e,t,o,a]);if(!p)return null;const{propertySchema:y,targetCollectionStore:h,targetParentUrl:m,connectedRelationFlags:b}=p;return(0,A.jsx)(fe,{relationPropertyMenuStore:u,propertySchema:y,targetCollectionStore:h,targetParentUrl:m,connectedRelationFlags:b,children:(0,A.jsx)(D.Z,{capture:!0,allowMenuList:!0,allowEsc:!0,allowUndo:!0,allowTabUntab:!0,render:()=>{const{getSearchResults:e,getInputPlaceholderText:t,showFooterInViewMode:o,showTargetDatabase:n}=function(e){const t=e.getDatabaseType();if(t===s.p$)return eo;return to}(h);return(0,A.jsx)(Nt,{getSearchResults:e,getInputPlaceholderText:t,showFooterInViewMode:o,showTargetDatabase:n})}})})}function Nt(e){const{getSearchResults:t,getInputPlaceholderText:o,showFooterInViewMode:a,showTargetDatabase:l}=e,{blockStore:s,blockPropertyValueOverlayStore:d,collectionStore:c,overlayMode:u,isDisabled:g,schema:p,property:y,insertChar:m}=(0,n.useContext)(F.m),f=(0,n.useContext)(me),b=(0,r.O7)(),x=(0,r.Fy)(),v=(0,i.VK)((()=>null==f?void 0:f.relationPropertyMenuStore),[null==f?void 0:f.relationPropertyMenuStore]),S=Qt();(0,n.useEffect)((()=>{v&&0===S.length&&v.setState({searchPopupOpen:x.isMobile,searchQuery:m??"",searchLimit:ve.limitIncrement,addingPage:!1})}),[]);const P=function(e){const{blockPointers:t,isDisabled:o}=(0,n.useContext)(F.m),a=(0,n.useContext)(me),l=(0,r.O7)(),s=(0,i.VK)((()=>(null==a?void 0:a.relationPropertyMenuStore.state.searchQuery)??""),[null==a?void 0:a.relationPropertyMenuStore]),d=(0,i.VK)((()=>(null==a?void 0:a.relationPropertyMenuStore.state.searchLimit)??0),[null==a?void 0:a.relationPropertyMenuStore]);null==a||a.setIsSearchLoading(!0);const[{value:c}]=(0,h.r5)((async()=>{if(o)return[];if(null==a||!a.propertySchema||null==a||!a.targetCollectionStore||!d)return[];if(null!=a&&a.connectedRelationFlags.isGoogleDriveRelation||null!=a&&a.connectedRelationFlags.isFigmaRelation)return[];return await e({environment:l,query:{query:s,limit:d},targetCollectionStore:null==a?void 0:a.targetCollectionStore,propertySchema:null==a?void 0:a.propertySchema,blockPointers:t})}),[l,t,o,null==a?void 0:a.connectedRelationFlags,null==a?void 0:a.propertySchema,null==a?void 0:a.targetCollectionStore,e,s,d],{debounce:J.vp});return null==a||a.setIsSearchLoading(!1),c}(t);return f&&v&&c&&p&&s&&d?x.isMobile?(0,A.jsx)(Et,{children:(0,A.jsx)(qt,{searchResults:P})}):(0,A.jsx)(zt,{header:(0,A.jsx)(Re,{inputPlaceholder:o({connectedRelationFlags:f.connectedRelationFlags,overlayMode:u,disabled:g}),showTargetDatabase:l,addPage:()=>Ht({environment:b,collectionStore:c,menuStore:v,blockPropertyValueOverlayStore:d,blockStore:s,schema:p,property:y,targetCollectionStore:f.targetCollectionStore})}),footer:(0,A.jsx)(Wt,{searchResultsLength:(null==P?void 0:P.length)??0,showFooterInViewMode:a}),children:(0,A.jsx)(qt,{searchResults:P})}):null}function Et(e){const{children:t}=e,{collectionStore:o,property:l,schema:s,blockStore:d,blockPropertyValueOverlayStore:c,isDisabled:u,canConfigureCollection:g,blockPointers:y,analyticsFrom:h,overlayMode:f,onChange:b,onDismiss:S}=(0,n.useContext)(F.m),P=(0,n.useContext)(me),M=(0,r.O7)(),R=(0,N.Y$)(),C=Qt(),j=(0,a.yK)((e=>({input:{color:e.mediumTextColor},menuTitle:{display:"flex"},databaseIcon:{display:"flex",marginLeft:2*pe.Qi},databaseTitle:{marginLeft:pe.Qi},addPageButton:{display:"flex",alignItems:"center"},plusIcon:{marginRight:8,width:16,height:16}})),[]),I=(0,i.VK)((()=>null==P?void 0:P.targetCollectionStore.getIcon()),[null==P?void 0:P.targetCollectionStore]),w=(0,i.VK)((()=>{const e=Boolean(ne.Z.bots.state.find((e=>e.integration_id===p.U9))),t=Boolean(ne.Z.bots.state.find((e=>e.integration_id===p.f3))),o=Boolean(ne.Z.bots.state.find((e=>e.integration_id===p.mQ)));return(null==P?void 0:P.connectedRelationFlags.isGithubPrRelation)&&!e||(null==P?void 0:P.connectedRelationFlags.isGoogleDriveRelation)&&!t||(null==P?void 0:P.connectedRelationFlags.isFigmaRelation)&&!o}),[null==P?void 0:P.connectedRelationFlags.isGithubPrRelation,null==P?void 0:P.connectedRelationFlags.isGoogleDriveRelation,null==P?void 0:P.connectedRelationFlags.isFigmaRelation]),D=(0,i.VK)((()=>Boolean(null==P?void 0:P.relationPropertyMenuStore.state.addingPage)),[null==P?void 0:P.relationPropertyMenuStore]),Z=(0,i.VK)((()=>Boolean(null==P?void 0:P.relationPropertyMenuStore.state.searchPopupOpen)),[null==P?void 0:P.relationPropertyMenuStore]);if(!(o&&d&&c&&P))return null;const{relationPropertyMenuStore:U,propertySchema:K,targetCollectionStore:G,targetParentUrl:E,connectedRelationFlags:{isConnectedRelation:z}}=P,W=(0,A.jsx)("div",{style:j.menuTitle,children:(0,A.jsx)(x.FormattedMessage,{id:"database.relationProperty.newRelation.targetDatabase",defaultMessage:"<regular>In</regular> {databaseWithIcon}",values:{regular:e=>e,databaseWithIcon:(0,A.jsxs)("div",{style:j.databaseIcon,children:[(0,A.jsx)(L.Z,{disabled:!0,icon:I,isEmptyPage:!1,size:pe.WO}),(0,A.jsx)(B.Z,{store:G,underline:!0,style:j.databaseTitle})]})}})});return(0,A.jsxs)(V.Z,{menuType:H.og.Modal,title:K.name,right:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Done",id:"relationPropertyMenu.mobileMenuDone.button"}),onClickRight:S,children:[!z&&(0,A.jsx)(O.Z,{disableMobilePadding:!0,children:(0,A.jsx)(T.Z,{focused:!1,title:W,showExtensionArrow:!1,onClick:()=>function(e){const{environment:t,targetParentUrl:o,analyticsFrom:n}=e;k.c4({environment:t,url:o}),n&&v.ZZ(t,{from:n})}({environment:M,targetParentUrl:E,analyticsFrom:h})})}),!w&&(0,A.jsx)(O.Z,{topBorder:!0,disableMobilePadding:!1,children:(0,A.jsx)(_.GI,{popupType:_.kQ.SlideUp,open:Z,origin:(0,A.jsx)(T.Z,{focused:!1,title:(0,A.jsxs)("span",{style:j.addPageButton,children:[(0,m.R)(j.plusIcon),(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Add a page",id:"relationPropertyMenu.addAPage.button"})]}),onClick:()=>$t(U),style:j.input}),render:()=>t})}),(0,A.jsx)(Dt,{collectionStore:o,targetCollectionStore:G,results:C,resultsType:"existing",property:l,schema:s,parentStore:d,disabled:u,canConfigureCollection:g,loading:!1,canDrag:!1,blockPropertyValueOverlayStore:c,onAccept:(e,t)=>function(e){const{environment:t,analyticsFrom:o,result:n,openInNew:r}=e;n.type===pe.Rt.SelectedPage&&Jt({environment:t,analyticsFrom:o,result:n,openInNew:r})}({environment:M,analyticsFrom:h,result:e,openInNew:t}),onClickActionButton:e=>Xt({environment:M,collectionContextStore:R,blockPropertyValueOverlayStore:c,result:e,blockPointers:y,onChange:b,analyticsFrom:h,overlayMode:f,propertySchema:K,targetCollectionStore:G}),onCreatePage:e=>Yt({environment:M,collectionContextStore:R,relationPropertyMenuStore:U,blockPointers:y,onChange:b,index:e,propertySchema:K,targetCollectionStore:G}),handleClearProperty:()=>b({newValues:[],oldValues:y}),relationPropertyMenuStore:U,addPage:e=>Ht({environment:M,collectionStore:o,menuStore:U,blockPropertyValueOverlayStore:c,blockStore:d,schema:s,property:l,targetCollectionStore:G,uri:e}),addingPage:D})]})}function zt(e){const{children:t,header:o,footer:r}=e,l=(0,n.useContext)(me),s=(0,i.VK)((()=>{var e;const t=Boolean(ne.Z.bots.state.find((e=>e.integration_id===p.U9))),o=(null==l?void 0:l.connectedRelationFlags.isGoogleDriveRelation)||(null==l?void 0:l.connectedRelationFlags.isFigmaRelation)||(null==l?void 0:l.connectedRelationFlags.isZendeskRelation)||(null==l?void 0:l.connectedRelationFlags.isSalesforceRelation),n=null===(e=te.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit();return(null==l?void 0:l.connectedRelationFlags.isGithubPrRelation)&&!t||o&&!n}),[null==l?void 0:l.connectedRelationFlags.isGithubPrRelation,null==l?void 0:l.connectedRelationFlags.isGoogleDriveRelation,null==l?void 0:l.connectedRelationFlags.isFigmaRelation,null==l?void 0:l.connectedRelationFlags.isZendeskRelation,null==l?void 0:l.connectedRelationFlags.isSalesforceRelation]),d=(0,a.yK)((e=>({menuContent:{overflow:"hidden",maxHeight:"70vh"}})),[]);return(0,A.jsx)(V.Z,{menuType:H.og.Popup,header:!s&&o,footer:r,children:(0,A.jsx)("div",{style:d.menuContent,children:t})})}function Wt(e){const{searchResultsLength:t,showFooterInViewMode:o}=e,a=(0,n.useContext)(me),{blockPointers:l,onChange:s,overlayMode:d,isDisabled:c,insertChar:u}=(0,n.useContext)(F.m),g=(0,r.O7)(),p=(0,N.Y$)(),y=(0,i.VK)((()=>(null==a?void 0:a.relationPropertyMenuStore.state.searchQuery)??u??""),[null==a?void 0:a.relationPropertyMenuStore,u]);if(!o&&"view"===(null==d?void 0:d.type))return null;if(!a)return null;const{relationPropertyMenuStore:h,propertySchema:m,targetCollectionStore:f}=a;return m.connectedRelation||c||!f?null:0!==t&&y?(0,A.jsx)(G,{targetCollectionStore:f,title:y,onClick:e=>Yt({environment:g,collectionContextStore:p,relationPropertyMenuStore:h,blockPointers:l,onChange:s,index:e,propertySchema:m,targetCollectionStore:f}),focused:!1,isSection:!0,index:"add"===(null==d?void 0:d.type)?null==d?void 0:d.index:void 0}):null}function qt(e){const{searchResults:t}=e,{blockPointers:o,collectionStore:l,property:s,schema:d,blockStore:c,blockPropertyValueOverlayStore:g,isDisabled:p,canConfigureCollection:h,analyticsFrom:m,overlayMode:b,onChange:S,insertChar:P}=(0,n.useContext)(F.m),M=(0,n.useContext)(me),R=(0,r.O7)(),C=(0,r.Fy)(),k=(0,N.Y$)(),{searchQuery:j,addingPage:I}=(0,i.VK)((()=>(null==M?void 0:M.relationPropertyMenuStore.state)??{searchQuery:P??"",addingPage:!1}),[null==M?void 0:M.relationPropertyMenuStore,P]),w=(0,a.yK)((e=>({inputMenu:{...C.isAndroid&&{borderBottom:"none"}}})),[C.isAndroid]),T=Qt(),D=(0,i.VK)((()=>c?j?T.filter((e=>{const t=re.G.createChildStore(c,e.pointer),o=t.getModel();if(o)return(0,u.fY)({block:o,query:j,getRecordModel:t.getRecordModel,userTimeZone:(0,y.r)(),schema:d,intl:Q.default.getIntl(),onlyPropertyIds:["title"]})})):T:[]),[c,d,j,T]);if(!(c&&g&&l&&M))return null;const{relationPropertyMenuStore:_,propertySchema:L,targetCollectionStore:B,connectedRelationFlags:O,isSearchLoading:K}=M,E=[...D];t&&t.forEach((e=>{if((e.type===pe.Rt.SelectedPage||e.type===pe.Rt.SearchPage)&&D.find((t=>(t.type===pe.Rt.SelectedPage||t.type===pe.Rt.SearchPage)&&t.pointer.id===e.pointer.id)))return;const t=L.limit?o.slice(0,1):o,n=e.type!==pe.Rt.NewPage?t.map((e=>e.id)).includes(e.pointer.id):void 0;n&&!j&&"add"===(null==b?void 0:b.type)||(e.type===pe.Rt.SearchPage&&n?E.push({...e,type:pe.Rt.SelectedPage}):e.type!==pe.Rt.SelectedPage||n?E.push(e):E.push({...e,type:pe.Rt.SearchPage}))}));const z=!t&&0===D.length;let W=X.default.mark("rum.relation_search_query");!z&&""!==j&&W&&(X.default.measure(W,{environment:R}),W=void 0);const q=(0,A.jsx)(Dt,{collectionStore:l,targetCollectionStore:B,results:E,resultsType:0===E.length&&0===T.length?"existing":"search",property:s,schema:d,parentStore:c,disabled:p,canConfigureCollection:h,loading:z,canDrag:!p&&0===j.length,blockPropertyValueOverlayStore:g,onAccept:(e,t)=>function(e){const{environment:t,collectionStore:o,collectionContextStore:n,blockPointers:r,result:i,analyticsFrom:a,isDisabled:l,onChange:s,overlayMode:d,openInNew:c,propertySchema:u,targetCollectionStore:g}=e;if(l)return;if(!g||!u)return;const{mainEditorCurrentBlockStore:p}=te.default.state;if(!p)return;if(i.type===pe.Rt.SearchPage){var y,h;if(s({newValues:u.limit?[i.pointer]:"add"===(null==d?void 0:d.type)?[...r.slice(0,d.index),i.pointer,...r.slice(d.index)]:[...r,i.pointer],oldValues:r}),a)v.eW(t,{from:a,collection_id:null==o?void 0:o.id,collection_view_id:null==n||null===(y=n.collectionViewStore())||void 0===y?void 0:y.id,collection_view_block_id:null==n||null===(h=n.collectionViewBlockStore())||void 0===h?void 0:h.id,target_collection_id:null==g?void 0:g.id})}else i.type===pe.Rt.SelectedPage&&Jt({environment:t,analyticsFrom:a,result:i,openInNew:c})}({environment:R,collectionStore:l,collectionContextStore:k,blockPointers:o,result:e,analyticsFrom:m,isDisabled:p,onChange:S,overlayMode:b,openInNew:t,propertySchema:L,targetCollectionStore:B}),onClickActionButton:e=>Xt({environment:R,collectionContextStore:k,blockPropertyValueOverlayStore:g,result:e,blockPointers:o,onChange:S,analyticsFrom:m,overlayMode:b,propertySchema:L,targetCollectionStore:B}),onScrollOffsetChange:e=>function(e){const{offsetFromBottom:t,store:o,isLoading:n,searchResults:r}=e;t<ve.incrementScrollOffset&&!n&&((null==r?void 0:r.length)??0)>=o.state.searchLimit&&o.setState({...o.state,searchLimit:o.state.searchLimit+ve.limitIncrement})}({offsetFromBottom:e,store:_,isLoading:K,searchResults:t}),onDrag:e=>function(e){const{newPageIds:t,blockPointers:o,collectionStore:n,onChange:r,analyticsFrom:i,environment:a}=e;r({newValues:t.map((e=>({id:e,spaceId:n.pointer.spaceId,table:f.iU}))),oldValues:o}),i&&v.yT(a,{from:i})}({environment:R,newPageIds:e,blockPointers:o,collectionStore:l,onChange:S,analyticsFrom:m}),onCreatePage:e=>Yt({environment:R,collectionContextStore:k,relationPropertyMenuStore:_,blockPointers:o,onChange:S,index:e,propertySchema:L,targetCollectionStore:B}),handleClearProperty:()=>S({newValues:[],oldValues:o}),searchQuery:j,overlayMode:b,relationPropertyMenuStore:_,addPage:e=>Ht({environment:R,collectionStore:l,menuStore:_,blockPropertyValueOverlayStore:g,blockStore:c,schema:d,property:s,uri:e,targetCollectionStore:B}),addingPage:I});if(!C.isMobile)return q;const $=de({connectedRelationFlags:O,overlayMode:b,disabled:p});return(0,A.jsx)(V.Z,{menuType:H.og.Modal,title:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Relation",id:"relationPropertyMenu.mobileRelationMenu.title"}),left:(0,A.jsx)(U.Z,{href:(0,Y.UY)("guides.relations"),analyticsFrom:"relation_menu"}),right:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Done",id:"relationPropertyMenu.mobileDoneButton"}),header:(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(Z.ZP,{value:j,disabled:p,onChange:e=>{const t=e.target.value;_.setState({..._.state,searchQuery:t,searchLimit:ve.limitIncrement})},placeholder:Q.default.formatMessage($),showClearButton:!0,focusInitial:!0,style:w.inputMenu}),j&&!p&&!O.isConnectedRelation&&(0,A.jsx)(G,{targetCollectionStore:B,title:j,onClick:e=>Yt({environment:R,collectionContextStore:k,relationPropertyMenuStore:_,blockPointers:o,onChange:S,index:e,propertySchema:L,targetCollectionStore:B}),focused:!1,isSection:!0})]}),onClickRight:()=>_.reset(),children:q})}function Qt(){const e=(0,n.useContext)(me),{blockStore:t,blockPointers:o,overlayMode:r}=(0,n.useContext)(F.m),a=(0,i.VK)((()=>(null==e?void 0:e.relationPropertyMenuStore.state.searchQuery)??""),[null==e?void 0:e.relationPropertyMenuStore]);return(0,i.VK)((()=>t&&null!=e&&e.propertySchema&&null!=e&&e.targetCollectionStore&&(a||"add"!==(null==r?void 0:r.type))?c.j$({relationValue:o,propertySchema:null==e?void 0:e.propertySchema,getRecordModel:t.getRecordModel}).map((e=>({key:e.id,type:pe.Rt.SelectedPage,pointer:e}))):[]),[t,o,r,a,null==e?void 0:e.propertySchema,null==e?void 0:e.targetCollectionStore])}async function Ht(e){const{environment:t,collectionStore:o,menuStore:n,blockPropertyValueOverlayStore:r,blockStore:i,schema:a,property:l,uri:s,targetCollectionStore:d}=e;if(!d)return;const u=d.getFormat().integration_id,g=ne.Z.externalAuthentications.state.filter((e=>e.integration_id===u))[0],y=d.getFormat().pattern_name,h=ne.Z.integrations.state.find((e=>e.id===u)),m=i instanceof re.G?i:void 0,v=i instanceof re.G?i.getNormalizedPropertyStore(l):void 0;n.setState({...n.state,addingPage:!0});try{var k,F;if(!(o&&h&&m&&v))return;const e=c.rq(v.getValue()),i=s||n.state.searchQuery||"";if(!(0,$.DB)({integration:h,patternName:y,url:i}))return void C.showDialog({items:[{label:(0,A.jsx)(x.FormattedMessage,{id:"connectedRelationPropertyMenuResults.unsupportedUrlErrorDialog.copyDebuggingInformation",defaultMessage:"Copy debugging information"}),color:"blue",onAccept:()=>{R.RD({environment:t,stringValue:JSON.stringify({botId:null==g?void 0:g.parent_id,url:i},null,2),copiedMessage:R.tq.copiedToClipboard})}},{label:(0,A.jsx)(x.FormattedMessage,{id:"connectedRelationPropertyMenuResults.unsupportedUrlErrorDialog.closeButton",defaultMessage:"Close"}),onAccept:()=>{}}],showCancel:!1,keepFocus:!1,message:(0,A.jsx)(x.FormattedMessage,{id:"connectedRelationPropertyMenuResults.unsupportedUrlErrorDialog.title",defaultMessage:"This source is currently not supported. Please try a different source."})});const u=a[l],T=c.Kp(u),D=T?v.id:void 0,Z=c.gg(u),V=c.ic(u),_=c.U8(u),L=c.yF(u),B=c.R3(u),O=V&&oe.default.checkGate({gateName:"figma_connected_relation"}),U=_&&oe.default.checkGate({gateName:"zendesk_connected_relation"}),K=L&&oe.default.checkGate({gateName:"cron_connected_relation"}),G=_&&oe.default.checkGate({gateName:"zendesk_ai_enabled"}),N=Z&&oe.default.checkGate({gateName:"google_drive_connected_relation"}),q=B&&oe.default.checkGate({gateName:"salesforce_connected_relation"}),Q=(0,z.NP)(h.id),H=(null==h?void 0:h.id)===p.U9?null===(k=Q[0])||void 0===k?void 0:k.id:null==g?void 0:g.parent_id,Y=T||N||U||K||O||q?Q.map((e=>e.id)):[H],X=await w.yp({environment:t,url:i,botIds:Y,userDefinedExternalCollectionStore:d,relatedPageId:D});if(!X)return;const J=(null===(F=ie.subscriptionDataStoreInstance.state)||void 0===F?void 0:F.addOns)??[];G&&(0,b.de)(J)&&(M.getZendeskTicketConversation(t,{ticketUrl:i,spaceId:X.getSpaceId(),botId:Y[0],pageId:v.id}),E.K4(t,"zendesk_unfurl_ai")),I.createAndCommit({userAction:"connectedRelationPropertyMenuResults.createRelationPage",environment:t,perform:o=>{const n={id:X.id,table:f.iU,spaceId:X.getSpaceId()},i=null!=u&&u.limit?[n]:[...e,n],a=c.ow(i);j.sO({environment:t,store:v,value:a,transaction:o}),r&&r.state.isOpen&&r.state.collectionContextStore&&(S.rv({environment:t,collectionContextStore:r.state.collectionContextStore,block_id:m.id,property:l,property_type:"relation",from:"relation_section",isFromBulkActionsToolbar:!1,integration_id:h.id,action:"add"}),P.W(t,{...(0,W.Pn)(r.state.collectionContextStore),from:"relation_menu",type:"page",integration_id:h.id,creating_block_id:m.id}))}}),n.reset()}finally{n.setState({...n.state,addingPage:!1})}}function $t(e){e.setState({...e.state,searchPopupOpen:!0,searchLimit:ve.limitIncrement})}function Yt(e){const{environment:t,collectionContextStore:o,relationPropertyMenuStore:n,blockPointers:r,onChange:i,index:a,propertySchema:l,targetCollectionStore:s}=e,d=null==s?void 0:s.getSpaceId(),c=null==l?void 0:l.limit,u=(0,q.Ii)({environment:t,table:f.iU,spaceId:d}),g=u.id,p=c?[u]:a?[...r.slice(0,a),u,...r.slice(a)]:[...r,u];i({newPage:{id:g,spaceId:d,name:n.state.searchQuery},newValues:p,oldValues:r}),P.W(t,{...(0,W.Pn)(o),from:"relation_menu",type:"page",target_collection_id:null==s?void 0:s.id,new_page_id:g,creating_block_id:g})}function Xt(e){const{environment:t,collectionContextStore:o,blockPropertyValueOverlayStore:n,result:r,blockPointers:i,onChange:a,analyticsFrom:l,overlayMode:s,propertySchema:d,targetCollectionStore:c}=e,{mainEditorCurrentBlockStore:u}=te.default.state;if(!u)return;const g=null==d?void 0:d.limit;if(r.type===pe.Rt.SearchPage){a({newValues:g?[r.pointer]:"add"===(null==s?void 0:s.type)?[...i.slice(0,s.index),r.pointer,...i.slice(s.index)]:[...i,r.pointer],oldValues:i}),l&&v.eW(t,{from:l,...(0,W.Pn)(o),target_collection_id:null==c?void 0:c.id})}else if(r.type===pe.Rt.SelectedPage){a({newValues:g?[]:i.filter((e=>e.id!==r.pointer.id)),oldValues:i}),l&&v.WF(t,{...(0,W.Pn)(o),from:l,target_collection_id:null==c?void 0:c.id})}g&&(null==n||n.setState({isOpen:!1}))}function Jt(e){const{environment:t,result:o,openInNew:n,analyticsFrom:r}=e,{mainEditorCurrentBlockStore:i}=te.default.state;if(!i)return;let a;if(n){const e=re.G.createChildStore(i,o.pointer),n=e.isDefined()?ee.Or(t,e):void 0;a=(0,g.Z)({pageId:o.pointer.id,pageModel:e.getModel(),baseUrl:n,pageVisitSource:l.tY.LinkInPage})}else{const e=i.isDefined()?ee.Or(t,i):void 0;a=(0,g.Z)({pageId:i.id,pageModel:i.getModel(),baseUrl:e,peekViewBlockId:o.pointer.id,pageVisitSource:l.tY.LinkInPage})}k.c4({environment:t,url:a,openInNew:n}),r&&v.XX(t,{from:r,meta_click:Boolean(n)})}const eo={getSearchResults:async function(e){const{environment:t,query:o,targetCollectionStore:n,blockPointers:r}=e;try{const e=await async function(e){const{environment:t,sprintCollectionStore:o,searchQuery:n}=e,r=o.getPropertyMapping(),i=null==r?void 0:r[s.b0.StatusV2],a=null==r?void 0:r[s.b0.Dates];if(!i||!a)throw new Error("Sprints database does not have the required properties");const l="results",d={userTimeZone:(0,y.r)(),searchQuery:n,sort:[{property:i,direction:"ascending"},{property:a,direction:"ascending"}],reducers:{[l]:{type:"results",limit:100}}},c=o.getParentBlockStore();if(!c)return[];await c.load();const u=c.getCollectionViewStores()[0];if(!u)return[];const g=o.getSpaceId(),p=await M.queryCollection(t,{source:{type:"collection",id:o.id,spaceId:g},collectionView:{id:u.id,spaceId:g},loader:d},void 0,{src:"relation_property_menu"});if("success"!==p.type)return[];const h=p.data.result.reducerResults[l];if("results"!==h.type)return[];return h.blockIds}({environment:t,sprintCollectionStore:n,searchQuery:o.query});return he({results:e,targetCollectionStore:n,blockPointers:r})}catch(i){ce.log({level:"error",from:"relationPropertySearchRequest",type:"performSprintSearchRequest",error:(0,ue.Ui)(i)});return await ye(e)}},getInputPlaceholderText:function(){return se.inputPlaceholder},showFooterInViewMode:!0,showTargetDatabase:!1},to={getSearchResults:ye,getInputPlaceholderText:de,showFooterInViewMode:!1,showTargetDatabase:!0}},451741:(e,t,o)=>{o.d(t,{NW:()=>a,Qi:()=>r,Rt:()=>n,WO:()=>l,wI:()=>i});let n=function(e){return e[e.SelectedPage=0]="SelectedPage",e[e.SearchPage=1]="SearchPage",e[e.NewPage=2]="NewPage",e}({});const r=4,i=32,a=400,l=20},401018:(e,t,o)=>{o.d(t,{NW:()=>n.NW,Qi:()=>n.Qi,ev:()=>r.ev,wI:()=>n.wI});var n=o(451741),r=o(296994)},89767:(e,t,o)=>{o.d(t,{R:()=>i});o(667294);var n=o(745238),r=o(785893);const i=(0,n.IU)("collectionInbox",{viewBox:"0 0 14 14",svg:(0,r.jsx)("path",{d:"M11.0918,0 C11.5383,0 11.9307,0.295898 12.0533,0.725586 L13.9615,7.40332 C13.9871,7.49316 14,7.58594 14,7.67871 L14,13 C14,13.5527 13.5522,14 13,14 L1,14 C0.447754,14 0,13.5527 0,13 L0,7.67871 C0,7.58594 0.0129395,7.49316 0.0384521,7.40332 L1.94666,0.725586 C2.06934,0.295898 2.46167,0 2.9082,0 L11.0918,0 Z M4.27271,1.5 C3.83728,1.5 3.45178,1.78223 3.31982,2.19727 L1.91455,6.61328 C1.70947,7.25879 2.1908,7.91699 2.86755,7.91699 L4.70837,7.91699 C4.70837,8.93652 5.16663,10.168 7,10.168 C8.83337,10.168 9.29163,8.93652 9.29163,7.91699 L11.1478,7.89355 C11.8201,7.88477 12.2927,7.22852 12.0876,6.58887 L10.681,2.19531 C10.5485,1.78125 10.1635,1.5 9.72864,1.5 L4.27271,1.5 Z"})})},239132:(e,t,o)=>{o.d(t,{c:()=>i});o(667294);var n=o(745238),r=o(785893);const i=(0,n.IU)("eye",{viewBox:"0 0 32 32",svg:(0,r.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})},375071:(e,t,o)=>{o.d(t,{f:()=>i});o(667294);var n=o(745238),r=o(785893);const i=(0,n.IU)("plusThick",{viewBox:"0 0 14 14",svg:(0,r.jsx)("path",{d:"M2 7.16357C2 7.59692 2.36011 7.95093 2.78735 7.95093H6.37622V11.5398C6.37622 11.9731 6.73022 12.3271 7.16357 12.3271C7.59692 12.3271 7.95093 11.9731 7.95093 11.5398V7.95093H11.5398C11.9731 7.95093 12.3271 7.59692 12.3271 7.16357C12.3271 6.73022 11.9731 6.37622 11.5398 6.37622H7.95093V2.78735C7.95093 2.36011 7.59692 2 7.16357 2C6.73022 2 6.37622 2.36011 6.37622 2.78735V6.37622H2.78735C2.36011 6.37622 2 6.73022 2 7.16357Z"})})}}]);