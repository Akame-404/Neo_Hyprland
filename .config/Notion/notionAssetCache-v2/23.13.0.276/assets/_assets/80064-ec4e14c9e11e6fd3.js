"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[80064],{980064:(e,t,r)=>{r.r(t),r.d(t,{EmptyGalleryCover:()=>M,default:()=>A});r(757658);var o=r(667294),i=r(883355),s=r(427531),n=r(800480),a=r(886628),l=r(724405),d=r(14577),c=r(541432),p=r(180951),h=r(895538),v=r(966673),y=r(421202),m=r(401898),u=r(110906),g=r(612457),S=r(799445),C=r(417311),x=r(635328),b=r(305971),f=r(206258),F=r(708928),k=r(634406),j=r(343568),I=r(81865),B=r(935541),W=r(785893);function P(e){return"number"==typeof e}function A(e){return(0,b.E)("collection_item_cover_refactor")?(0,W.jsx)(L,{...e}):(0,W.jsx)(w,{...e})}class w extends i.Z{constructor(){super(...arguments),this.renderContentBlock=e=>{const{store:t,renderAdditionalBlocks:r,rendererBlockStyle:o}=this.props,i=f.G.createChildStore(t,{table:y.iU,id:e}),n=i.getType(),a=r&&void 0!==n,l=this.blockIdsToRenderStore.state,d="table_row"===n?i.getParentBlockStore():i,c=a?d&&(0,B.u)({store:d,restrictedBlockIds:l,tableRenderMode:this.getTableRenderMode()}):(0,F.h)(i);if(c)return(0,W.jsx)(s.Dq,{value:this.restrictedContentStore,children:(0,W.jsx)(c,{store:i,disabled:!0,disableCommentMenu:!0,disableHoverMenu:!0,hideContent:(0,x.BX)(i),style:{fontSize:12,opacity:.8,pointerEvents:"none",...o},isQuickFind:!0,numberedListCounterStore:this.createComputedStore((()=>({depth:0,numberedListBlockIdsWithFormat:Y(e,this.numberedListsStore)})))})},e)},this.coverStore=this.createComputedStore((()=>{const{store:e,renderAdditionalBlocks:t=!1,startBlockId:r}=this.props,{ThemeStore:o}=this.environment,i=r?(0,u.wK)({rootStore:e,renderAdditionalBlocks:t,startBlockId:r,tableRenderMode:this.getTableRenderMode()}):(0,u.NU)({rootStore:e,renderAdditionalBlocks:t,theme:o.state.mode});return i.image?i.image:!(this.props.showLoadingShimmer&&0===i.blockIds.length&&!i.isDefined)&&i.blockIds})),this.restrictedContentStore=this.createComputedStore((()=>{const{store:e,renderAdditionalBlocks:t=!1,startBlockId:r}=this.props,o=(0,u.wK)({rootStore:e,renderAdditionalBlocks:t,startBlockId:r,tableRenderMode:this.getTableRenderMode()});return o.image?void 0:o.blockIds})),this.blockIdsToRenderStore=this.createComputedStore((()=>{const e=this.coverStore.state,t=this.restrictedContentStore.state;return e&&Array.isArray(e)?e.filter((e=>!t||t.includes(e))):[]})),this.numberedListsStore=this.createComputedStore((()=>{const{store:e}=this.props,t=this.coverStore.state,r=[];return Array.isArray(t)&&r.push(...(0,S.AM)({blockIds:t,parentStore:e})),r}))}didUpdate(e){this.props.coverFormat.type!==e.coverFormat.type&&this.props.onLoadProxiedImage()}renderComponent(){const{coverFormat:e}=this.props;return"page_cover"===e.type?(0,W.jsx)(Q,{store:this.props.store,coverHeight:this.props.coverHeight,coverSizeFormat:this.props.coverSizeFormat,imageCoverWrapStyle:this.props.imageCoverWrapStyle,coverWidth:this.props.coverWidth,onLoadProxiedImage:this.props.onLoadProxiedImage,style:this.props.style,variant:this.props.variant,coverAspectFormat:this.props.coverAspectFormat,coverPosition:this.props.coverPosition,showEmptyGalleryCover:this.props.showEmptyGalleryCover,emptyGalleryCoverStyle:this.props.emptyGalleryCoverStyle}):"page_content"===e.type?this.renderPageContent():"property"===e.type?(0,W.jsx)(X,{store:this.props.store,coverHeight:this.props.coverHeight,coverSizeFormat:this.props.coverSizeFormat,imageCoverWrapStyle:this.props.imageCoverWrapStyle,onLoadProxiedImage:this.props.onLoadProxiedImage,coverWidth:this.props.coverWidth,style:this.props.style,variant:this.props.variant,coverAspectFormat:this.props.coverAspectFormat,coverPosition:this.props.coverPosition,showEmptyGalleryCover:this.props.showEmptyGalleryCover,emptyGalleryCoverStyle:this.props.emptyGalleryCoverStyle,property:e.property},e.property):void 0}renderPageContent(){var e;const t=this.coverStore.state,r=this.restrictedContentStore.state,o=this.props.renderAdditionalBlocks&&this.props.store.isCollectionView()&&!(null===(e=this.props.store.getModel())||void 0===e?void 0:e.hasWikiBlockUri());if(!1===t)return(0,W.jsx)(V,{coverHeight:this.props.coverHeight,coverSizeFormat:this.props.coverSizeFormat,loadingShimmerStyle:this.props.loadingShimmerStyle});if(t){if(!Array.isArray(t))return o?(0,W.jsxs)("div",{style:N(this.props.variant,this.environment,this.theme,this.props.coverHeight,this.props.coverSizeFormat,this.props.coverContentFadedOverlay,this.props.contentWrapStyle,this.props.isInHomeWidget),children:[(0,W.jsx)(I.Z,{url:t.url,onFinishedLoadingProxyUrl:e=>this.props.onLoadProxiedImage(e),isAuthenticated:!0,permissionRecord:t.pointer,width:E(),render:(e,t)=>{if(t)return(0,W.jsx)(k.Z,{style:{...T(),...J({renderCollectionImage:!0},this.props.variant,this.theme,this.props.coverHeight,this.props.coverSizeFormat),...Z(),objectPosition:`center ${100*(1-R(this.props.store,this.props.coverPosition))}%`},placeholderLoadedStyle:{display:"flex",justifyContent:"center",alignItems:"end"},src:t})}}),(0,W.jsx)($,{variant:this.props.variant}),(0,W.jsx)("div",{style:U(this.theme,this.props.coverContentFadedOverlayStyle)})]}):(0,W.jsxs)("div",{style:K(this.props.coverHeight,this.props.coverSizeFormat,this.props.imageCoverWrapStyle),children:[(0,W.jsx)(I.Z,{url:t.url,onFinishedLoadingProxyUrl:e=>this.props.onLoadProxiedImage(e),isAuthenticated:!0,permissionRecord:t.pointer,width:E(this.props.coverWidth,this.props.coverSizeFormat),render:(e,t)=>{if(t)return(0,W.jsx)(k.Z,{style:{...T(this.props.style),...J({renderCollectionImage:!1},this.props.variant,this.theme,this.props.coverHeight,this.props.coverSizeFormat),...Z(this.props.coverAspectFormat),objectPosition:`center ${100*(1-R(this.props.store,this.props.coverPosition))}%`},src:t,loading:"lazy"})}}),(0,W.jsx)($,{variant:this.props.variant})]});if(t.length>0)return(0,W.jsx)(W.Fragment,{children:(0,W.jsxs)("div",{style:N(this.props.variant,this.environment,this.theme,this.props.coverHeight,this.props.coverSizeFormat,this.props.coverContentFadedOverlay,this.props.contentWrapStyle,this.props.isInHomeWidget),children:[r?t.filter((e=>r.indexOf(e)>=0)).map(this.renderContentBlock):t.map(this.renderContentBlock),this.props.coverContentFadedOverlay&&(0,W.jsx)("div",{style:U(this.theme,this.props.coverContentFadedOverlayStyle)})]})});if(this.props.showEmptyGalleryCover)return(0,W.jsx)(M,{coverHeight:this.props.coverHeight,coverSizeFormat:this.props.coverSizeFormat,emptyGalleryCoverStyle:this.props.emptyGalleryCoverStyle??N(this.props.variant,this.environment,this.theme,this.props.coverHeight,this.props.coverSizeFormat,this.props.coverContentFadedOverlay,this.props.contentWrapStyle,this.props.isInHomeWidget)})}else if(this.props.showEmptyGalleryCover)return(0,W.jsx)(M,{coverHeight:this.props.coverHeight,coverSizeFormat:this.props.coverSizeFormat,emptyGalleryCoverStyle:this.props.emptyGalleryCoverStyle})}getTableRenderMode(){return this.props.renderAdditionalBlocks&&this.props.startBlockId?"table":"image"}}function L(e){const{store:t,coverFormat:r,coverContentFadedOverlay:i,coverContentFadedOverlayStyle:s,coverHeight:l,coverWidth:p,coverAspectFormat:h,coverSizeFormat:m,coverPosition:g,imageCoverWrapStyle:S,onLoadProxiedImage:C,showEmptyGalleryCover:x,showLoadingShimmer:b,loadingShimmerStyle:F,emptyGalleryCoverStyle:k,style:j,rendererBlockStyle:I,contentWrapStyle:B,renderAdditionalBlocks:P=!1,isInHomeWidget:A,variant:w,startBlockId:L}=e,{ThemeStore:G}=(0,n.O7)();(0,v.wr)(null==r?void 0:r.type,((e,t)=>e!==t&&(C(),!0)));const z=(0,o.useCallback)((()=>P&&L?"table":"image"),[P,L]),R=(0,a.VK)((()=>{const e=L?(0,u.wK)({rootStore:t,renderAdditionalBlocks:P,startBlockId:L,tableRenderMode:z()}):(0,u.NU)({rootStore:t,renderAdditionalBlocks:P,theme:G.state.mode});return e.image?e.image:!(b&&0===e.blockIds.length&&!e.isDefined)&&e.blockIds}),[G,t,P,L,b,z]),T=new d.Z((()=>{const e=(0,u.wK)({rootStore:t,renderAdditionalBlocks:P,startBlockId:L,tableRenderMode:z()});return e.image?void 0:e.blockIds}),{debugName:"restrictedContentStore"}),O=new d.Z((()=>{const e=[];if(Array.isArray(R)){let r=0;for(;r<R.length;){let o=R[r],i=f.G.createChildStore(t,{table:y.iU,id:o});if(i.getType()===c.Ti.numberedList){const s=[{blockId:o,idx:1}],n=[{id:o,format:void 0,depth:s.length-1,index:s[0].idx}];for(r+=1;r<R.length&&(o=R[r],i=f.G.createChildStore(t,{table:y.iU,id:o}),i.getType()===c.Ti.numberedList);){{const e=i.getParentId();if(i.getParentId()===s[s.length-1].blockId)s.push({blockId:o,idx:1});else{let t=s[s.length-1].idx;for(;s.length>0&&s[s.length-1].blockId!==e;)t=s[s.length-1].idx,s.pop();s.push({blockId:o,idx:t+1})}n.push({id:o,format:void 0,depth:s.length-1,index:s[s.length-1].idx})}r+=1}e.push(n)}else r+=1}}return e}),{debugName:"numberedListsStore"});return"page_cover"===r.type?(0,W.jsx)(Q,{store:t,coverHeight:l,coverSizeFormat:m,imageCoverWrapStyle:S,coverWidth:p,onLoadProxiedImage:C,style:j,variant:w,coverAspectFormat:h,coverPosition:g,showEmptyGalleryCover:x,emptyGalleryCoverStyle:k}):"page_content"===r.type?(0,W.jsx)(H,{coverData:R,restrictedContentStore:T,renderAdditionalBlocks:P,numberedListsStore:O,store:t,coverHeight:l,coverSizeFormat:m,coverContentFadedOverlay:i,coverContentFadedOverlayStyle:s,contentWrapStyle:B,coverPosition:g,coverWidth:p,coverAspectFormat:h,isInHomeWidget:A,loadingShimmerStyle:F,showEmptyGalleryCover:x,emptyGalleryCoverStyle:k,variant:w,onLoadProxiedImage:C,imageCoverWrapStyle:S,style:j,rendererBlockStyle:I}):"property"===r.type?(0,W.jsx)(X,{store:t,coverHeight:l,coverSizeFormat:m,imageCoverWrapStyle:S,onLoadProxiedImage:C,coverWidth:p,style:j,variant:w,coverAspectFormat:h,coverPosition:g,showEmptyGalleryCover:x,emptyGalleryCoverStyle:k,property:r.property},r.property):null}function H(e){const{coverData:t,restrictedContentStore:r,numberedListsStore:o,renderAdditionalBlocks:i,store:s,coverHeight:n,coverSizeFormat:a,coverContentFadedOverlay:l,coverContentFadedOverlayStyle:d,contentWrapStyle:c,coverPosition:p,coverWidth:h,coverAspectFormat:v,isInHomeWidget:y,loadingShimmerStyle:m,showEmptyGalleryCover:u,emptyGalleryCoverStyle:g,variant:S,onLoadProxiedImage:C,imageCoverWrapStyle:x,style:b,rendererBlockStyle:f}=e;return!1===t?(0,W.jsx)(V,{coverHeight:n,coverSizeFormat:a,loadingShimmerStyle:m}):t?(0,W.jsx)(z,{coverData:t,restrictedContentStore:r,renderAdditionalBlocks:i,store:s,coverHeight:n,coverSizeFormat:a,coverContentFadedOverlay:l,coverContentFadedOverlayStyle:d,contentWrapStyle:c,coverPosition:p,coverWidth:h,coverAspectFormat:v,isInHomeWidget:y,showEmptyGalleryCover:u,emptyGalleryCoverStyle:g,variant:S,onLoadProxiedImage:C,imageCoverWrapStyle:x,style:b,rendererBlockStyle:f,numberedListsStore:o}):u?(0,W.jsx)(M,{coverHeight:n,coverSizeFormat:a,emptyGalleryCoverStyle:g}):null}function G(e){const{store:t,renderAdditionalBlocks:r,rendererBlockStyle:o,blockId:i,blockIdsToRender:n,restrictedContentStore:c,numberedListsStore:p}=e,h=(0,l.yK)((e=>({renderer:{fontSize:12,opacity:.8,pointerEvents:"none",...o}})),[o]),v=f.G.createChildStore(t,{table:y.iU,id:i}),m=(0,a.VK)((()=>v.getType()),[v]),u=(0,a.VK)((()=>{const e="table_row"===m?v.getParentBlockStore():v;return r&&void 0!==m?e&&(0,B.u)({store:e,restrictedBlockIds:n,tableRenderMode:"table"}):(0,F.h)(v)}),[r,m,v,n]),g=new d.Z((()=>({depth:0,numberedListBlockIdsWithFormat:Y(i,p)})),{debugName:"numberedListCounterStore"}),S=(0,a.VK)((()=>(0,x.BX)(v)),[v]);return u?(0,W.jsx)(s.Dq,{value:c,children:(0,W.jsx)(u,{store:v,disabled:!0,disableCommentMenu:!0,disableHoverMenu:!0,hideContent:S,style:h.renderer,isQuickFind:!0,numberedListCounterStore:g})},i):null}function z(e){const{coverData:t,restrictedContentStore:r,numberedListsStore:o,renderAdditionalBlocks:i,store:s,coverHeight:d,coverSizeFormat:c,coverContentFadedOverlay:p,coverContentFadedOverlayStyle:h,contentWrapStyle:v,coverPosition:y,coverWidth:m,coverAspectFormat:u,isInHomeWidget:g,showEmptyGalleryCover:S,emptyGalleryCoverStyle:C,variant:x,onLoadProxiedImage:b,imageCoverWrapStyle:f,style:F,rendererBlockStyle:j}=e,B=(0,n.O7)(),P=(0,l.Fg)(),A=(0,a.VK)((()=>({contentWrapStyle:N(x,B,P,d,c,p,v,g),coverContentFadedOverlay:U(P,h),imageBox:{...T(),...J({renderCollectionImage:!0},x,P,d,c),...Z(),objectPosition:`center ${100*(1-R(s,y))}%`},imageCoverWrap:K(d,c,f),proxiedImageBox:{...T(F),...J({renderCollectionImage:!1},x,P,d,c),...Z(u),objectPosition:`center ${100*(1-R(s,y))}%`}})),[x,B,P,d,y,c,p,h,u,s,F,v,g,f]),w=(0,a.VK)((()=>r.state),[r]),L=(0,a.VK)((()=>t&&Array.isArray(t)?t.filter((e=>!w||w.includes(e))):[]),[t,w]),H=(0,a.VK)((()=>{var e;return i&&s.isCollectionView()&&!(null===(e=s.getModel())||void 0===e?void 0:e.hasWikiBlockUri())}),[i,s]);return Array.isArray(t)?t.length>0?(0,W.jsxs)("div",{style:A.contentWrapStyle,children:[w?t.filter((e=>w.indexOf(e)>=0)).map((e=>(0,W.jsx)(G,{store:s,renderAdditionalBlocks:i,rendererBlockStyle:j,blockId:e,blockIdsToRender:L,restrictedContentStore:r,numberedListsStore:o},e))):t.map((e=>(0,W.jsx)(G,{store:s,renderAdditionalBlocks:i,rendererBlockStyle:F,blockId:e,blockIdsToRender:L,restrictedContentStore:r,numberedListsStore:o},e))),p&&(0,W.jsx)("div",{style:A.coverContentFadedOverlay})]}):S?(0,W.jsx)(M,{coverHeight:d,coverSizeFormat:c,emptyGalleryCoverStyle:C??A.contentWrapStyle}):null:H?(0,W.jsxs)("div",{style:A.contentWrapStyle,children:[(0,W.jsx)(I.Z,{url:t.url,onFinishedLoadingProxyUrl:e=>b(e),isAuthenticated:!0,permissionRecord:t.pointer,width:E(),render:(e,t)=>{if(t)return(0,W.jsx)(k.Z,{style:A.imageBox,placeholderLoadedStyle:{display:"flex",justifyContent:"center",alignItems:"end"},src:t})}}),(0,W.jsx)($,{variant:x}),(0,W.jsx)("div",{style:A.coverContentFadedOverlay})]}):(0,W.jsxs)("div",{style:A.imageCoverWrap,children:[(0,W.jsx)(I.Z,{url:t.url,onFinishedLoadingProxyUrl:e=>b(e),isAuthenticated:!0,permissionRecord:t.pointer,width:E(m,c),render:(e,t)=>{if(t)return(0,W.jsx)(k.Z,{style:A.proxiedImageBox,src:t,loading:"lazy"})}}),(0,W.jsx)($,{variant:x})]})}function R(e,t){if(P(t))return t;if(e.getFormatStore().isDefined()){const{page_cover_position:t,card_cover_position:r}=e.getFormat();if(P(r))return r;if(P(t))return t}return.5}function T(e){return e||{}}function O(e,t){if(e)return e;switch(t){case"large":return C.Z.card.desktop.large.height;case"small":return C.Z.card.desktop.small.height;default:return C.Z.card.desktop.medium.height}}function E(e,t){return e||(0,u.rD)(t)}function Z(e){return{objectFit:void 0===e?"cover":e}}function K(e,t,r){return{height:O(e,t),position:"relative",pointerEvents:"none",overflow:"hidden",...r}}function M(e){let{coverHeight:t,coverSizeFormat:r,emptyGalleryCoverStyle:o}=e;return(0,W.jsx)("div",{style:{height:O(t,r),...o}})}function V(e){let{coverHeight:t,coverSizeFormat:r,loadingShimmerStyle:o}=e;return(0,W.jsx)("div",{style:{height:O(t,r),...o},children:(0,W.jsx)(g.Z,{show:!0,showDelay:100,showHold:0,render:e=>e?(0,W.jsx)(j.Z,{paragraphs:[{lineHeight:12,lineMargin:6,sectionWidths:[100,100,50],repeat:1,sectionMargin:0}]}):void 0})})}function D(e,t,r,o,i){const{ThemeStore:s}=t,n="dark"===s.state.mode,a=i?r.lightDividerColor:r.regularDividerColor;switch(e){case"default":return{};case"gallery":return{background:r.collectionGalleryPreviewCardCover,padding:"8px 8px 0",boxShadow:n?"transparent":`inset 0 -1px 0 0 ${a}`,...o};default:(0,m.t1)(e)}}function U(e,t){return{width:"100%",height:40,position:"absolute",bottom:0,left:0,background:`linear-gradient(to bottom, transparent, ${e.accentColors.gray[30]} 100%)`,...t}}function _(e,t){switch(e){case"default":return{border:`1px solid ${t.stroke.regular}`,borderTopLeftRadius:4,borderTopRightRadius:4,borderBottomRightRadius:4,borderBottomLeftRadius:4};case"gallery":return{borderRadius:0,borderTopLeftRadius:1,borderTopRightRadius:1};default:(0,m.t1)(e)}}function $(e){let{variant:t}=e;const r=(0,l.Fg)();switch(t){case"default":return null;case"gallery":return(0,W.jsx)("div",{style:{position:"absolute",left:0,right:0,bottom:0,borderBottom:`1px solid ${r.regularDividerColor}`}});default:(0,m.t1)(t)}return null}function N(e,t,r,o,i,s,n,a){return{height:O(o,i),pointerEvents:"none",overflow:"hidden",position:s?"relative":"static",...D(e,t,r,n,a),...n}}function q(e,t,r,o){return{width:"100%",height:O(r,o),..._(e,t),objectPosition:"center"}}function Q(e){let{store:t,coverHeight:r,coverSizeFormat:o,imageCoverWrapStyle:i,coverWidth:s,onLoadProxiedImage:n,style:d,variant:c,coverAspectFormat:p,coverPosition:h,showEmptyGalleryCover:v,emptyGalleryCoverStyle:y}=e;const m=(0,l.Fg)(),u=(0,a.VK)((()=>{var e;return null===(e=t.getCover())||void 0===e?void 0:e.cover}),[t]),g=(0,a.VK)((()=>t.pointer),[t]),S=(0,a.VK)((()=>R(t,h)),[h,t]);return u?(0,W.jsxs)("div",{style:K(r,o,i),children:[(0,W.jsx)(I.Z,{url:u,isAuthenticated:!0,permissionRecord:g,width:E(s,o),onFinishedLoadingProxyUrl:e=>n(e),render:(e,t)=>{if(t)return(0,W.jsx)(k.Z,{style:{...T(d),...q(c,m,r,o),...Z(p),objectPosition:`center ${100*(1-S)}%`},src:t,loading:"lazy"})}}),(0,W.jsx)($,{variant:c})]}):v?(0,W.jsx)(M,{coverHeight:r,coverSizeFormat:o,emptyGalleryCoverStyle:y}):null}function X(e){let{property:t,store:r,coverHeight:o,coverSizeFormat:i,imageCoverWrapStyle:s,onLoadProxiedImage:n,coverWidth:d,style:c,variant:v,coverAspectFormat:y,coverPosition:m,showEmptyGalleryCover:u,emptyGalleryCoverStyle:g}=e;const S=(0,l.Fg)(),C=(0,a.VK)((()=>(0,p.g)(r.getPropertyValue(t)).find((e=>(0,h.SR)({url:e.url})))),[t,r]),x=(0,a.VK)((()=>r.pointer),[r]),b=(0,a.VK)((()=>R(r,m)),[m,r]);return C?(0,W.jsxs)("div",{style:K(o,i,s),children:[(0,W.jsx)(I.Z,{onFinishedLoadingProxyUrl:e=>n(e),url:C.url,isAuthenticated:!0,permissionRecord:x,width:E(d,i),render:(e,t)=>{if(t)return(0,W.jsx)(k.Z,{style:{...T(c),...q(v,S,o,i),...Z(y),objectPosition:`center ${100*(1-b)}%`},src:t,loading:"lazy"})}}),(0,W.jsx)($,{variant:v})]}):u?(0,W.jsx)(M,{coverHeight:o,coverSizeFormat:i,emptyGalleryCoverStyle:g}):null}function J(e,t,r,o,i){const{renderCollectionImage:s}=e;return{...q(t,r,o,i),objectPosition:"center center",...s&&{height:void 0,border:`1px solid ${r.lightDividerColor}`,borderBottom:"none",borderBottomLeftRadius:0,borderBottomRightRadius:0}}}function Y(e,t){const r=t.state;for(const o of r)if(o.find((t=>t.id===e)))return o;return[]}w.displayName="CollectionItemCover"}}]);