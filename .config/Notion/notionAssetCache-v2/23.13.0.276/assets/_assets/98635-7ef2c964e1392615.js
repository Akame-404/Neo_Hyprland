"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[98635],{183357:(e,t,r)=>{r.d(t,{$I:()=>z,E4:()=>T,FV:()=>K,Hk:()=>V,N8:()=>k,NV:()=>G,OV:()=>C,h5:()=>B,iT:()=>j,kM:()=>P,li:()=>F,oq:()=>w,s8:()=>M,wh:()=>x,x7:()=>A,yx:()=>D});r(21703),r(757658);var o=r(800480),a=r(724405),n=r(247025),i=r(164945),s=r(202032),l=r(435011),u=r(114714),d=r(399036),c=r(180951),g=r(709291),p=r(653965),y=r(401898),m=r(108406),f=r(234993),h=r(709953),v=r(210228),S=r(51592),b=r(816187),_=r(368585);const x=(0,g.defineMessages)({chartType:{defaultMessage:"Chart type",id:"database.viewSettings.mainTab.chartType.title"},chartDevFeedbackLink:{defaultMessage:"Give dev feedback",id:"database.viewSettings.mainTab.chartDevFeedbackLink"},chartData:{defaultMessage:"Data",id:"database.viewSettings.mainTab.chartData.title"},chartStyle:{defaultMessage:"Style",id:"database.viewSettings.mainTab.chartStyle.title"},chartMoreStyle:{defaultMessage:"More style options",id:"database.viewSettings.mainTab.moreChartStyles.title"},chartXAxis:{defaultMessage:"X axis",id:"database.viewSettings.mainTab.axisChart.xAxis"},chartXAxisGroupByUnique:{defaultMessage:"Unique",id:"database.viewSettings.mainTab.axisChart.xAxis.groupBy.unique"},chartAggregateBy:{defaultMessage:"Aggregate by",id:"database.viewSettings.mainTab.axisChart.aggregateBy"},chartAggregateSection:{defaultMessage:"Aggregate",id:"database.viewSettings.mainTab.axisChart.chartAggregateSection"},chartDistinctSection:{defaultMessage:"Distinct count of",id:"database.viewSettings.mainTab.axisChart.chartDistinctSection"},chartPropertyValueSection:{defaultMessage:"Value of",id:"database.viewSettings.mainTab.axisChart.chartPropertyValueSection"},chartGroupBy:{defaultMessage:"Group by",id:"database.viewSettings.mainTab.axisChart.groupBy"},chartSortBy:{defaultMessage:"Sort by",id:"database.viewSettings.mainTab.axisChart.sortBy"},chartYAxis:{defaultMessage:"Y axis",id:"database.viewSettings.mainTab.axisChart.yAxis"},chartCumulative:{defaultMessage:"Cumulative",id:"database.viewSettings.mainTab.axisChart.cumulative"},chartHelp:{defaultMessage:"Learn about charts",id:"database.viewSettings.mainTab.charts.learnMoreButton"},chartDuplicate:{defaultMessage:"Duplicate chart",id:"database.viewSettings.mainTab.charts.duplicate"},chartReset:{defaultMessage:"Reset chart",id:"database.viewSettings.mainTab.charts.reset"},chartWhatToShow:{defaultMessage:"What to show",id:"database.viewSettings.mainTab.charts.whatToShow"},chartSliceDonutBy:{defaultMessage:"Slice donut by",id:"database.viewSettings.mainTab.charts.sliceDonutBy"},chartSliceDonutAggregation:{defaultMessage:"Each slice represents",id:"database.viewSettings.mainTab.charts.sliceDonutAggregation"},noneMenuItem:{defaultMessage:"None",id:"database.viewSettings.mainTab.charts.noneMenuItem"},noResultsMenuItem:{defaultMessage:"No results",id:"chartSettingsPropertySearchMenuItem.search.noResults.title"}}),C=(0,g.defineMessages)({chartStyleTitle:{defaultMessage:"Style",id:"database.viewSettings.chartStyleTab.title"},chartColor:{defaultMessage:"Color",id:"database.viewSettings.chartStyleTab.chartColor"},chartLineFillArea:{defaultMessage:"Gradient area",id:"database.viewSettings.chartStyleTab.chartLineFillArea"},chartWeightColorValue:{defaultMessage:"Color by value",id:"database.viewSettings.chartStyleTab.chartWeightColorValue"},chartGroupStyle:{defaultMessage:"Group style",id:"database.viewSettings.chartStyleTab.groupStyle"},chartGridLine:{defaultMessage:"Grid line",id:"database.viewSettings.chartStyleTab.chartGridLine"},chartAxisAvatarFormat:{defaultMessage:"Label style",id:"database.viewSettings.chartStyleTab.chartAxisAvatarFormat"},chartAxisName:{defaultMessage:"Axis name",id:"database.viewSettings.chartStyleTab.chartAxisName"},chartLegend:{defaultMessage:"Legend",id:"database.viewSettings.chartStyleTab.chartLegend"},chartCaption:{defaultMessage:"Caption",id:"database.viewSettings.chartStyleTab.chartCaption"},chartHideEmptyGroups:{defaultMessage:"Omit zero values",id:"database.viewSettings.chartStyleTab.chartOmitZeroValues"},chartDataLabels:{defaultMessage:"Data labels",id:"database.viewSettings.chartStyleTab.chartDataLabels"},chartShowDonutValue:{defaultMessage:"Show value in center",id:"database.viewSettings.chartStyleTab.chartHideDonutValue"}}),M=(0,g.defineMessages)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.gridOptions.none"},horizontal:{defaultMessage:"Horizontal",id:"database.viewSettings.chartStyleTab.gridOptions.horizontal"},vertical:{defaultMessage:"Vertical",id:"database.viewSettings.chartStyleTab.gridOptions.vertical"},both:{defaultMessage:"Both",id:"database.viewSettings.chartStyleTab.gridOptions.both"}}),B=(0,g.defineMessages)({auto:{id:"database.viewSettings.chartStyleTab.colorTheme.auto",defaultMessage:"Auto"},colorful:{id:"database.viewSettings.chartStyleTab.colorTheme.colorful",defaultMessage:"Colorful"},gray:{id:"database.viewSettings.chartStyleTab.colorTheme.gray",defaultMessage:"Colorless"},blue:{id:"database.viewSettings.chartStyleTab.colorTheme.blue",defaultMessage:"Blue"},yellow:{id:"database.viewSettings.chartStyleTab.colorTheme.yellow",defaultMessage:"Yellow"},green:{id:"database.viewSettings.chartStyleTab.colorTheme.green",defaultMessage:"Green"},purple:{id:"database.viewSettings.chartStyleTab.colorTheme.purple",defaultMessage:"Purple"},teal:{id:"database.viewSettings.chartStyleTab.colorTheme.teal",defaultMessage:"Teal"},orange:{id:"database.viewSettings.chartStyleTab.colorTheme.orange",defaultMessage:"Orange"},pink:{id:"database.viewSettings.chartStyleTab.colorTheme.pink",defaultMessage:"Pink"},red:{id:"database.viewSettings.chartStyleTab.colorTheme.red",defaultMessage:"Red"}}),w=(0,g.defineMessages)({avatar:{defaultMessage:"Avatar",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.avatar"},avatar_name:{defaultMessage:"Avatar and name",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.avatarName"},name:{defaultMessage:"Name",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.name"}}),F=(0,g.defineMessages)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.axisLabelOptions.none"},x_axis:{defaultMessage:"X axis",id:"database.viewSettings.chartStyleTab.axisLabelOptions.xAxis"},y_axis:{defaultMessage:"Y axis",id:"database.viewSettings.chartStyleTab.axisLabelOptions.yAxis"},both:{defaultMessage:"Both",id:"database.viewSettings.chartStyleTab.axisLabelOptions.both"}}),T=(0,g.defineMessages)({normal:{defaultMessage:"Stacked",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.normal"},percent:{defaultMessage:"Percent",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.percent"},side_by_side:{defaultMessage:"Not stacked",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.side_by_side"}}),G=(0,g.defineMessages)({column:{id:"chartType.bar.vertical",defaultMessage:"Vertical bar"},bar:{id:"chartType.bar.horizontal",defaultMessage:"Horizontal bar"},line:{id:"chartType.line",defaultMessage:"Line"},donut:{id:"chartType.donut",defaultMessage:"Donut"}});function V(e){let{aggregation:t,databaseType:r,intl:o}=e;if((0,s.HK)(t)&&r){const e=(0,p.kC)((0,S.sN)(r));return o.formatMessage({id:"chartYAxis.aggregate.count",defaultMessage:"{value} count"},{value:e})}if((0,s.HK)(t))return o.formatMessage({id:"chartYAxis.aggregate.unTypedCount",defaultMessage:"Count"});if("unique"===t.aggregator)return o.formatMessage({id:"chartYAxis.aggregate.distinct",defaultMessage:"Distinct"});{const e=(0,s.OV)(t);return b.v6[e]}}function A(e){if("placeholder"!==e.type&&"groups_reducer"===e.dataConfig.type)return e.dataConfig.aggregationConfig.aggregation}function k(e,t,r,o,a){var s;if("placeholder"===t.type||t.type===e)return;let l;if("donut"===e){if("donut"===t.type)return;(0,i.u)(t)?l=(0,n.GX)(t):(0,y.t1)(t)}else(0,i.F)(e)?(0,i.u)(t)?l=(0,n.dY)(t,e):"donut"===t.type?l=(0,n.R1)(t,e):(0,y.t1)(t):(0,y.t1)(e);z({environment:r,collectionContextStore:a,chartConfig:l,sort:null===(s=l.chartFormat)||void 0===s?void 0:s.axisSort}),v.createAndCommit({userAction:"chartSettings.setChartType",environment:r,perform:e=>{h.sW({store:o.getFormatStore().getKeyStore("chart_config"),data:l,transaction:e})}}),m.wd({environment:r,collectionContextStore:a,action:"charts_update_chart_type",charts_analytics_context:(0,_.aL)(a)})}function K(e){return{fill:e.accentColors.orange[400]}}function j(e){const t=e.type;if("formula"===t){const t=(0,l.mm)(e);return"text"===t||"checkbox"===t||"person"===t}return"title"===t||"text"===t||"url"===t||"email"===t||"phone_number"===t||"checkbox"===t||"person"===t||"select"===t||"multi_select"===t||"status"===t||"relation"===t||"created_by"===t||"last_edited_by"===t}function D(e){if((0,n.Dv)(e))return"aggregate_and_distinct";if("formula"===e.type){const t="formula"===e.type?(0,l.mm)(e):void 0;return(0,n.Oy)(t)?"distinct":void 0}return(0,d.gB)(e)||(0,d.KR)(e)||(0,d.M0)(e)||(0,d.To)(e)||(0,d.p_)(e)||(0,d.cu)(e)||(0,c.gC)(e)||(0,u.A1)(e.type)||(0,c.TN)(e.type)?"distinct":void 0}function z(e){let{environment:t,collectionContextStore:r,chartConfig:o,sort:a}=e;const n=[];(0,i.u)(o)&&"results_reducer"===o.dataConfig.type&&("x-ascending"===a?n.push({property:o.dataConfig.nameProperty,direction:"ascending"}):"x-descending"===a&&n.push({property:o.dataConfig.nameProperty,direction:"descending"})),f.iU({environment:t,collectionContextStore:r,temporaryState:{...r.temporaryStateStore.state,sorts:{value:n}}})}function P(){const e=250,t=(0,o.Fy)();return(0,a.yK)((()=>({whatToShowRightText:{maxWidth:t.isMobile?e:125},sortByRightText:{maxWidth:t.isMobile?e:163},groupByRightText:{maxWidth:t.isMobile?e:151},donutSliceRightText:{maxWidth:t.isMobile?e:124},donutSliceValueRightText:{maxWidth:t.isMobile?e:95}})),[t.isMobile])}},373590:(e,t,r)=>{r.d(t,{Z:()=>u});r(667294);var o=r(800480),a=r(584169),n=r(225888),i=r(316354),s=r(694166),l=r(785893);const u=function(e){const{title:t,href:r,analyticsFrom:u}=e,d=(0,o.O7)();return(0,l.jsx)(i.Z,{href:r,onClick:()=>n.Fs(d,{from:u}),external:!0,children:(0,l.jsx)(s.Z,{icon:a.m,title:t,isGray:!0})})}},212347:(e,t,r)=>{r.d(t,{D$:()=>te,H5:()=>$,HE:()=>oe,Ko:()=>ae,Pz:()=>I,ZP:()=>ie,aK:()=>re,bc:()=>N,cE:()=>W,cR:()=>q,ci:()=>ee,y3:()=>he});r(21703);var o=r(667294),a=r(800480),n=r(886628),i=r(724405),s=r(749085),l=r(435011),u=r(114714),d=r(356666),c=r(239132),g=r(561061),p=r(937612),y=r(709291),m=r(653965),f=r(401898),h=r(108406),v=r(554569),S=r(805149),b=r(496802),_=r(210228),x=r(538769),C=r(475498),M=r(552275),B=r(279131),w=r(205145),F=r(573063),T=r(568785),G=r(828992),V=r(489728),A=r(672495),k=r(886825),K=r(297820),j=r(892918),D=r(918514),z=r(658421),P=r(373590),R=r(497372),O=r(694166),Z=r(18533),E=r(785893);const L=s.default.createClass(void 0,{name:"ReducerResultStore"}),H=s.default.createClass(j.XD,{name:"GroupsLimitStore"});function I(e){let{collectionContextStore:t,groupByKey:r,groupsFormatKey:o,reducerResult:a,groupsLimit:i}=e;return(0,n.VK)((()=>{var e;const n=t.normalizedFormatStore.state,s=t.normalizedSchemaStore.state,l=t.collectionViewBlockStore(),d=(0,u.b7)(n,r);if(!d||!l||!a)return;const c=(0,u.Qq)({schema:s,groupBy:d}),g=a.results,p=a?a.total:0,y=(0,j.Cz)({groupBy:d,schema:s,formatGroups:n[o]||[],schemaGroups:c,reducerResults:g,getRecordModel:l.getRecordModel,relativeVariableResult:t.relativeVariableStore.state,viewAppConfigUri:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormat().app_config_uri,allowedCollectionStores:t.collectionStoresStore.state}),m=y.filter((e=>!(0,u.eF)(e))).slice(0,i),f=y.filter((e=>(0,u.eF)(e)));return{currentGroups:[...m,...f],visibleGroups:m,hiddenGroups:f,total:p}}),[t,r,a,o,i])}function N(e){return e?(0,E.jsx)(K.Z,{propertySchema:e,showIcon:!1}):(0,E.jsx)(y.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.groupTab.noGroupingSetMessage"})}function W(e,t){return"collection_group_by"===e&&"board"===t?(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Sub-group by",id:"database.viewSettings.groupTab.subGroupProperty"}):(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Group by",id:"database.viewSettings.groupTab.groupProperty"})}function U(e,t){return"manual"===t?(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Manual",id:"database.viewSettings.groupTab.sortType.manual"}):"ascending"===t?(0,u.ib)(e)||"formula"===e.type&&"date"===e.groupBy.type?(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Oldest first",id:"database.viewSettings.groupTab.sortType.chronological"}):(0,u.aB)(e)||"relation"===e.type||"select"===e.type||"multi_select"===e.type||"formula"===e.type&&"text"===e.groupBy.type?(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Alphabetical",id:"database.viewSettings.groupTab.sortType.alphabetical"}):(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Ascending",id:"database.viewSettings.groupTab.sortType.ascending"}):"descending"===t?(0,u.ib)(e)||"formula"===e.type&&"date"===e.groupBy.type?(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Newest first",id:"database.viewSettings.groupTab.sortType.reverseChronological"}):(0,u.aB)(e)||"relation"===e.type||"select"===e.type||"multi_select"===e.type||"formula"===e.type&&"text"===e.groupBy.type?(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Reverse alphabetical",id:"database.viewSettings.groupTab.sortType.reverseAlphabetical"}):(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Descending",id:"database.viewSettings.groupTab.sortType.descending"}):void(0,f.t1)(t)}function Q(e){const{groupBy:t,schema:r}=e,o=r[t.property];if(!o||!(0,u.LG)(o))return;let a;if("formula"===o.type){const e=(0,l.mm)(o);if("unknown"===e||"array"===e)return;a="block"===e?"relation":e}else a=o.type;return(0,u.A1)(a)||(0,u.HB)(a)||"number"===a||"status"===a?a:void 0}function q(e){const t=Q(e);if(t)return(0,u.A1)(t)?(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Date by",id:"database.viewSettings.groupByTypeTab.dateBy"}):(0,u.HB)(t)?(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Text by",id:"database.viewSettings.groupByTypeTab.textBy"}):"number"===t?(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Number by",id:"database.viewSettings.groupByTypeTab.numberBy"}):"status"===t?(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Status by",id:"database.viewSettings.groupByTypeTab.statusBy"}):void 0}function Y(e){return(0,u.ib)(e)?e:"formula"===e.type&&"date"===e.groupBy.type?e.groupBy:void 0}function X(e){return(0,u.aB)(e)?e:"formula"===e.type&&"text"===e.groupBy.type?e.groupBy:void 0}function $(e){return"number"===e.type?e:"formula"===e.type&&"number"===e.groupBy.type?{...e.groupBy,property:e.property}:void 0}function J(e){const{groupBy:t}=e,r=Q(e);if(r)if((0,u.A1)(r)){const e=Y(t);if(e)return ae(e.groupBy)}else if((0,u.HB)(r)){const e=X(t);if(e)return ne(e.groupBy)}else if("number"===r){const e=$(t);if(e)return(0,E.jsx)(y.FormattedMessage,{defaultMessage:"{start} to {end}",id:"database.groupMenu.numberGroupBy.range",values:{start:e.start,end:e.end}})}}const ee=(0,y.defineMessages)({group:{defaultMessage:"Group",id:"database.groupMenu.statusGroupBy.group"},option:{defaultMessage:"Option",id:"database.groupMenu.statusGroupBy.option"}});function te(e){return"group"===e?(0,E.jsx)(y.FormattedMessage,{...ee.group}):"option"===e?(0,E.jsx)(y.FormattedMessage,{...ee.option}):void(0,f.t1)(e)}const re=(0,y.defineMessages)({relative:{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"},day:{defaultMessage:"Day",id:"database.groupMenu.dateGroupBy.day"},week:{defaultMessage:"Week",id:"database.groupMenu.dateGroupBy.week"},month:{defaultMessage:"Month",id:"database.groupMenu.dateGroupBy.month"},year:{defaultMessage:"Year",id:"database.groupMenu.dateGroupBy.year"}}),oe=(0,y.defineMessages)({relative:{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"},day:{defaultMessage:"Days",id:"database.groupMenu.dateGroupBy.days"},week:{defaultMessage:"Weeks",id:"database.groupMenu.dateGroupBy.weeks"},month:{defaultMessage:"Months",id:"database.groupMenu.dateGroupBy.months"},year:{defaultMessage:"Years",id:"database.groupMenu.dateGroupBy.years"}});function ae(e){return"relative"===e?(0,E.jsx)(y.FormattedMessage,{...re.relative}):"day"===e?(0,E.jsx)(y.FormattedMessage,{...re.day}):"week"===e?(0,E.jsx)(y.FormattedMessage,{...re.week}):"month"===e?(0,E.jsx)(y.FormattedMessage,{...re.month}):"year"===e?(0,E.jsx)(y.FormattedMessage,{...re.year}):void(0,f.t1)(e)}function ne(e){return"exact"===e?(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Exact",id:"database.groupMenu.textGroupBy.exact"}):"alphabet_prefix"===e?(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Alphabetical",id:"database.groupMenu.textGroupBy.alphabetical"}):void(0,f.t1)(e)}const ie=function(e){const{collectionContextStore:t,groupsFormatKey:r,groupByKey:o,collectionSettingsStore:i}=e,s=(0,a.O7)(),l=(0,n.qz)(void 0,H),d=(0,n.qz)(void 0,L),c=(0,n.VK)((()=>d.state),[d]),g=(0,n.VK)((()=>l.state),[l]),m=I({collectionContextStore:t,groupByKey:o,groupsFormatKey:r,reducerResult:c,groupsLimit:g}),f=(0,n.VK)((()=>(0,u.b7)(t.normalizedFormatStore.state,o)),[t,o]),v=(0,n.VK)((()=>t.normalizedSchemaStore.state),[t]),S=(0,n.VK)((()=>function(e,t){return le(e)&&(0,j._1)({viewType:se(e),groupByKey:t})}(t,o)),[t,o]);return(0,E.jsxs)(R.ZP,{collectionSettingsStore:i,title:(0,E.jsx)(ue,{collectionSettingsStore:i,collectionContextStore:t}),children:[(0,E.jsxs)(A.Z,{children:[(0,E.jsx)(de,{collectionContextStore:t,collectionSettingsStore:i,groupByKey:o,groupsFormatKey:r,groupBy:f}),f&&Q({groupBy:f,schema:v})&&(0,E.jsx)(ge,{collectionContextStore:t,collectionSettingsStore:i,groupByKey:o,groupsFormatKey:r,groupBy:f}),f&&(0,E.jsx)(pe,{collectionContextStore:t,groupByKey:o,groupBy:f}),f&&(0,E.jsx)(ye,{groupByKey:o,collectionContextStore:t,groupsFormatKey:r,groupsDisplayState:m,groupBy:f}),f&&"board_columns_by"===o&&(0,E.jsx)(ce,{collectionContextStore:t})]}),f&&(0,E.jsx)(ve,{groupsFormatKey:r,collectionContextStore:t,groupByKey:o,reducerResultStore:d,groupsLimitStore:l,groupsDisplayState:m}),(0,E.jsxs)(A.Z,{topBorder:!0,children:[f&&S&&(0,E.jsx)(O.Z,{isGray:!0,icon:p.y,title:(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Remove grouping",id:"database.viewSettings.groupTab.removeButton.title"}),onClick:()=>function(e,t,r,o){const a=t.collectionViewStore();if(!a)return;_.createAndCommit({userAction:"CollectionSettingsViewGroup.handleRemoveClick",environment:e,perform:e=>{b.FH({stores:[a],update:{[r]:void 0,[o]:void 0},transaction:e})}}),h.wd({environment:e,collectionContextStore:t,action:"click_remove_grouping"})}(s,t,o,r),isRed:!0}),(0,E.jsx)(P.Z,{href:(0,D.UY)("guides.databaseGroup"),title:(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Learn about grouping",id:"database.viewSettings.groupTab.learnMoreButton.title"}),analyticsFrom:"view_settings_group"})]})]})};function se(e){var t;const r=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!r)throw new Error("View type was not defined.");return r}function le(e){return e.permissionScopesStore.state.canConfigureBlock}function ue(e){let{collectionSettingsStore:t,collectionContextStore:r}=e;const o=(0,n.VK)((()=>(0,z.n)(t)),[t]),a=(0,n.VK)((()=>se(r)),[r]);return o&&"group"===o.type?"collection_group_by"===o.groupByKey&&"board"===a?(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Sub-group",id:"database.viewSettings.groupTab.subGroup.title"}):(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Group",id:"database.viewSettings.groupTab.group.title"}):null}function de(e){let{groupBy:t,collectionContextStore:r,collectionSettingsStore:o,groupByKey:i,groupsFormatKey:s}=e;const l=(0,a.O7)(),u=(0,n.VK)((()=>r.normalizedSchemaStore.state),[r]),d=t?u[t.property]:void 0,c=(0,n.VK)((()=>le(r)),[r]),g=(0,n.VK)((()=>se(r)),[r]);return(0,E.jsx)(O.Z,{title:W(i,g),showChevron:!0,right:N(d),onClick:()=>{h.wd({environment:l,collectionContextStore:r,action:"click_group_by_property",original_view_type:void 0,property_type:null==d?void 0:d.type}),S.H4({collectionSettingsStore:o,item:{type:"groupByProperty",groupByKey:i,groupsFormatKey:s}})},disabled:!c})}function ce(e){let{collectionContextStore:t}=e;const r=(0,a.O7)(),o=(0,n.VK)((()=>(0,j.h6)(t.normalizedFormatStore.state)),[t]),i=(0,n.VK)((()=>le(t)),[t]);return(0,E.jsx)(k.Z,{title:(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Color columns",id:"database.viewSettings.groupTab.colorColumns"}),on:!o,focused:!1,onClick:()=>{S.iN({environment:r,collectionContextStore:t})},disabled:!i,textWrapperStyle:{opacity:1}})}function ge(e){let{groupBy:t,collectionContextStore:r,collectionSettingsStore:o,groupByKey:i,groupsFormatKey:s}=e;const l=(0,a.O7)(),d=(0,n.VK)((()=>r.normalizedSchemaStore.state),[r]),c=(0,n.VK)((()=>le(r)),[r]),g="formula"===t.type?{...t.groupBy,property:t.property}:t;return(0,u.ib)(g)?(0,E.jsx)(Z.Z,{title:q({groupBy:g,schema:d}),popupStyle:{minWidth:190},selectedKey:g.groupBy,options:u.z8.map((e=>({key:e,title:ae(e)}))),onChange:e=>function(e,t,r,o,a){const n=(0,u.b7)(r.normalizedFormatStore.state,o),i=r.collectionViewStore();if(!n||!i)return;const s=Y(n);if(s){if((0,u.ib)(n))_.createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,perform:t=>{b.FH({stores:[i],update:{[o]:{...n,groupBy:e},[a]:void 0},transaction:t})}});else if("formula"===n.type){const r={...m.CE(s,"property"),type:"date",groupBy:e},l={...n,groupBy:r};_.createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,perform:e=>{b.FH({stores:[i],update:{[o]:l,[a]:void 0},transaction:e})}})}h.wd({environment:t,collectionContextStore:r,action:"update_date_group_by"})}}(e,l,r,i,s),disabled:!c}):(0,u.aB)(g)?(0,E.jsx)(Z.Z,{title:q({groupBy:g,schema:d}),popupStyle:{minWidth:190},selectedKey:g.groupBy,options:u.Kp.map((e=>({key:e,title:ne(e)}))),onChange:e=>function(e,t,r,o,a){const n=(0,u.b7)(r.normalizedFormatStore.state,o),i=r.collectionViewStore();if(!n||!i)return;const s=X(n);if(s){if((0,u.aB)(n))_.createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,perform:t=>{b.FH({stores:[i],update:{[o]:{...n,groupBy:e},[a]:void 0},transaction:t})}});else if("formula"===n.type){const r={...m.CE(s,"property"),groupBy:e},l={...n,groupBy:r};_.createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,perform:e=>{b.FH({stores:[i],update:{[o]:l,[a]:void 0},transaction:e})}})}h.wd({environment:t,collectionContextStore:r,action:"update_text_group_by"})}}(e,l,r,i,s),disabled:!c}):"number"===g.type?(0,E.jsx)(O.Z,{title:q({groupBy:g,schema:d}),showChevron:!0,right:J({groupBy:g,schema:d}),onClick:()=>{S.H4({collectionSettingsStore:o,item:{type:"groupByNumber",groupByKey:i,groupsFormatKey:s}})},disabled:!c}):"status"===g.type?(0,E.jsx)(Z.Z,{title:q({groupBy:g,schema:d}),popupStyle:{minWidth:190},selectedKey:g.groupBy,options:u.vu.map((e=>({key:e,title:te(e)}))),onChange:e=>function(e,t,r,o,a){const n=(0,u.b7)(r.normalizedFormatStore.state,o),i=r.collectionViewStore();n&&i&&"status"===(null==n?void 0:n.type)&&(_.createAndCommit({userAction:"CollectionSettingsViewGroup.handleStatusGroupByTypeChange",environment:t,perform:t=>{b.FH({stores:[i],update:{[o]:{...n,groupBy:e},[a]:void 0},transaction:t})}}),h.wd({environment:t,collectionContextStore:r,action:"update_status_group_by"}))}(e,l,r,i,s),disabled:!c}):null}function pe(e){let{groupBy:t,collectionContextStore:r,groupByKey:o}=e;const i=(0,a.O7)(),s=(0,n.VK)((()=>(0,u.YG)(t)),[t]),l=(0,n.VK)((()=>le(r)),[r]);if(s.length<=1)return null;const d=(0,u.mu)(t);return(0,E.jsx)(Z.Z,{title:(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Sort",id:"database.viewSettings.groupTab.sort"}),popupStyle:{minWidth:190},selectedKey:d.type,options:s.map((e=>({key:e,title:U(t,e)}))),onChange:e=>function(e,t,r,o){const a=(0,u.b7)(r.normalizedFormatStore.state,o),n=r.collectionViewStore();if(a&&n){if("formula"===a.type){const r={...a,groupBy:{...a.groupBy,sort:{type:e}}};_.createAndCommit({userAction:"CollectionSettingsViewGroup.handleSortTypeChange",environment:t,perform:e=>{b.FH({stores:[n],update:{[o]:r},transaction:e})}})}else _.createAndCommit({userAction:"CollectionSettingsViewGroup.handleSortTypeChange",environment:t,perform:t=>{b.FH({stores:[n],update:{[o]:{...a,sort:{type:e}}},transaction:t})}});h.wd({environment:t,collectionContextStore:r,action:"update_group_sort"})}}(e,i,r,o),disabled:!l})}function ye(e){let{groupBy:t,groupByKey:r,collectionContextStore:i,groupsFormatKey:s,groupsDisplayState:l}=e;const d=(0,a.O7)(),c=(0,o.useCallback)((()=>function(e,t,r,o,a){const n=(0,u.b7)(r.normalizedFormatStore.state,t);if(!a)return;const{currentGroups:i}=a,s=r.collectionViewStore();if(!n||!s)return;const l=!n.hideEmptyGroups;_.createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideEmptyGroupsClick",environment:e,perform:e=>{if(l){const t=i.map((e=>!1===e.hidden?{...e,hidden:void 0}:e));v.A6({collectionContextStore:r,newGroups:t,groupsFormatKey:o,transaction:e})}b.FH({stores:[s],update:{[t]:{...n,hideEmptyGroups:l}},transaction:e})}}),h.wd({environment:e,collectionContextStore:r,action:"toggle_hide_empty_groups"})}(d,r,i,s,l)),[d,r,i,s,l]),g=(0,n.VK)((()=>le(i)),[i]);return(0,E.jsx)(k.Z,{title:(0,E.jsx)(y.FormattedMessage,{defaultMessage:"Hide empty groups",id:"database.viewSettings.groupTab.hideEmptyGroups"}),on:Boolean(t.hideEmptyGroups),focused:!1,onClick:c,disabled:!g,textWrapperStyle:{opacity:1}})}function me(e){const t=(0,a.O7)(),{groupFormat:r,canReorder:o,collectionContextStore:i,groupByKey:s,groupsFormatKey:l,groupsDisplayState:d,isLastGroup:p}=e,y=(0,n.VK)((()=>i.normalizedSchemaStore.state),[i]),m=(0,u.eF)(r),f=(0,n.VK)((()=>(0,u.b7)(i.normalizedFormatStore.state,s)),[i,s]),S=(0,n.VK)((()=>le(i)),[i]);if(!f)return null;const b=p&&!m;return(0,E.jsx)(G.Z,{disabled:!S,title:(0,E.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[o&&(0,E.jsx)(w.ZP,{iconSize:12,style:{marginRight:3}}),(0,E.jsx)(x.Z,{groupBy:f,groupFormat:r,currentGroups:(null==d?void 0:d.currentGroups)??[],schema:y,disabled:!0,isHiddenGroup:!1,style:{padding:0},collectionContextStore:i})]}),right:b?null:(0,E.jsx)(F.Z,{icon:m?g.B:c.c,iconStyle:{width:16,height:16},isDarkIconColor:!m,onClick:()=>{!function(e,t,r,o,a){if(!a)return;const{currentGroups:n}=a,i=n.map((t=>(0,u.ZH)(t,e)?{...e,hidden:!(0,u.eF)(e)}:t));_.createAndCommit({userAction:"CollectionSettingsViewGroup.handleToggleGroupVisibility",environment:t,perform:e=>{v.A6({collectionContextStore:r,newGroups:i,groupsFormatKey:o,transaction:e})}}),h.wd({environment:t,collectionContextStore:r,action:"toggle_group_visibility"})}(r,t,i,l,d)},disabled:!S}),textWrapperStyle:{opacity:1}})}function fe(e){const t=(0,a.O7)(),{groups:r,canReorder:i,isHidden:s,collectionContextStore:l,groupByKey:d,groupsFormatKey:c,groupsDisplayState:g,disableHideAll:p}=e,y=(0,n.VK)((()=>le(l)),[l]),f=p&&1===r.length;return i?(0,E.jsx)(B.ZP,{direction:"vertical",keys:r.map((e=>(0,u.mD)(e))),renderKey:(e,t)=>{const o=r[t];return(0,E.jsx)(me,{collectionContextStore:l,groupByKey:d,groupsFormatKey:c,groupsDisplayState:g,groupFormat:o,canReorder:i,isLastGroup:f})},onDrop:e=>{!function(e,t,r,o,a,n){if(!n)return;const{currentGroups:i}=n,s=i.filter((t=>e.indexOf((0,u.mD)(t))<0)),l=i.filter((t=>e.indexOf((0,u.mD)(t))>=0)),d=m.MR(l,(t=>{const r=e.indexOf((0,u.mD)(t));return r>=0?r:1/0})),c=t?[...s,...d]:[...d,...s];_.createAndCommit({userAction:"CollectionSettingsViewGroup.handleGroupReorder",environment:r,perform:e=>{v.A6({collectionContextStore:o,newGroups:c,groupsFormatKey:a,transaction:e})}}),h.wd({environment:r,collectionContextStore:o,action:t?"reorder_hidden_groups":"reorder_groups"})}(e,s,t,l,c,g)},disabled:!y}):(0,E.jsx)(E.Fragment,{children:r.map((e=>(0,E.jsx)(o.Fragment,{children:(0,E.jsx)(me,{collectionContextStore:l,groupByKey:d,groupsFormatKey:c,groupsDisplayState:g,groupFormat:e,canReorder:i,isLastGroup:f})},(0,u.mD)(e))))})}function he(e){let{collectionContextStore:t,groupsFormatKey:r,groupByKey:s,groupsLimitStore:l,groupsDisplayState:c,disableHideAll:g,disableLoadMore:p}=e;const m=(0,i.Fg)(),f=(0,a.O7)(),S=(0,o.useCallback)((()=>function(e,t,r,o,a){if(!a)return;const{currentGroups:n}=a,i=n.map((e=>({...e,hidden:!1})));o.setState(j.XD),_.createAndCommit({userAction:"CollectionSettingsViewGroup.handleShowAllClick",environment:e,perform:e=>{v.A6({collectionContextStore:t,newGroups:i,groupsFormatKey:r,transaction:e})}}),h.wd({environment:e,collectionContextStore:t,action:"click_groups_show_all"})}(f,t,r,l,c)),[f,t,r,l,c]),b=(0,o.useCallback)((()=>function(e,t,r,o,a){if(!a)return;const{currentGroups:n}=a,i=n.map((e=>({...e,hidden:!0})));o.setState(j.XD),_.createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideAllClick",environment:e,perform:e=>{v.A6({collectionContextStore:t,newGroups:i,groupsFormatKey:r,transaction:e})}}),h.wd({environment:e,collectionContextStore:t,action:"click_groups_hide_all"})}(f,t,r,l,c)),[f,t,r,l,c]),x=(0,n.VK)((()=>(0,u.b7)(t.normalizedFormatStore.state,s)),[t,s]),C=x?(0,u.mu)(x):void 0,B=(0,n.VK)((()=>le(t)),[t]),w=(0,n.VK)((()=>"manual"===(null==C?void 0:C.type)&&!f.device.isMobile&&B),[B,C,f]),F=(0,n.VK)((()=>l.state),[l]);if(!x)return null;if(!c)return(0,E.jsx)(A.Z,{topBorder:!0,disableMobileBorders:!0,noTextOverflow:!0,children:(0,E.jsx)("div",{style:{marginTop:6,display:"flex",alignItems:"center",flexDirection:"column"},children:(0,E.jsx)(T.Z,{})})});const{total:G,hiddenGroups:k,visibleGroups:K}=c,D=Math.min(j.kW,G-k.length-K.length),z=D>0&&!Boolean(p)?(0,E.jsx)(M.Z,{disabled:!1,focused:!1,style:{color:m.mediumTextColor},icon:(0,d.o)({width:14,height:14}),title:(0,E.jsx)(y.FormattedMessage,{id:"database.groupMenu.loadMoreButton.text",defaultMessage:"Show {loadMoreAmount, plural, one {{loadMoreAmount} more group} other {{loadMoreAmount} more groups}}",values:{loadMoreAmount:D}}),onClick:()=>{t.isLoadingStore.state||t.loadingDetailsStore.setState({type:"load_groups_menu"}),l.setState(F+j.kW)}}):void 0;return(0,E.jsxs)(E.Fragment,{children:[K.length>0&&(0,E.jsxs)(A.Z,{topBorder:!0,noTextOverflow:!0,isTitleUppercase:!1,title:(0,E.jsx)("span",{style:{alignSelf:"center"},children:(0,E.jsx)(y.FormattedMessage,{id:"database.groupMenu.visibleGroups",defaultMessage:"Visible groups"})}),right:g?null:(0,E.jsx)(V.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:b,disabled:!B,children:(0,E.jsx)(y.FormattedMessage,{id:"database.groupMenu.hideAllGroups",defaultMessage:"Hide all"})}),children:[(0,E.jsx)(fe,{collectionContextStore:t,groupByKey:s,groupsFormatKey:r,groupsDisplayState:c,groups:K,canReorder:w,isHidden:!1,disableHideAll:g}),z]}),k.length>0&&(0,E.jsx)(A.Z,{topBorder:!0,noTextOverflow:!0,isTitleUppercase:!1,title:(0,E.jsx)(y.FormattedMessage,{id:"database.groupMenu.hiddenGroups",defaultMessage:"Hidden groups"}),right:g?null:(0,E.jsx)(V.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:S,disabled:!B,children:(0,E.jsx)(y.FormattedMessage,{id:"database.groupMenu.showAllGroups",defaultMessage:"Show all"})}),children:(0,E.jsx)(fe,{collectionContextStore:t,groupByKey:s,groupsFormatKey:r,groupsDisplayState:c,groups:k,canReorder:w,isHidden:!0,disableHideAll:g})})]})}function ve(e){let{groupsFormatKey:t,collectionContextStore:r,groupByKey:o,reducerResultStore:a,groupsLimitStore:i,groupsDisplayState:s}=e;const l=(0,n.VK)((()=>{const e=r.normalizedFormatStore.state,a=r.normalizedSchemaStore.state,n=r.remoteRequestStore.state,s=(0,u.b7)(r.normalizedFormatStore.state,o);if(s)return(0,j.ej)({groupBy:s,schema:a,format:e,filter:null==n?void 0:n.loader.filter,groupsFormatKey:t,limit:i.state})}),[r,t,o,i]);return l?(0,E.jsx)(C.Z,{id:`group_menu_${t}`,reducer:l,collectionContextStore:r,resultStore:a,render:()=>(0,E.jsx)(he,{collectionContextStore:r,groupsFormatKey:t,groupByKey:o,groupsLimitStore:i,groupsDisplayState:s})}):(0,E.jsx)(he,{collectionContextStore:r,groupsFormatKey:t,groupByKey:o,groupsLimitStore:i,groupsDisplayState:s})}},740040:(e,t,r)=>{r.d(t,{EE:()=>u,GL:()=>c,TR:()=>p,Y9:()=>y,iM:()=>d,zn:()=>g});var o=r(247025),a=r(399036),n=r(997466),i=r(531701),s=r(401898),l=r(892918);function u(e){return void 0!==e&&"auto"!==e&&"colorful"!==e}function d(e,t){if("auto"!==e){if("colorful"===e)return i.ZE.colorful.slice(0,6);if(c(e)){const r="gray"===e?"dark"===t.mode?"white":"black":e;return i.ZE[r]}(0,s.t1)(e)}}function c(e){return o.Fh.includes(e)}function g(e,t,r){const o=function(e,t,r){if("auto"===e)return;let o;if(o="gray"===e?"dark"===r.mode?"white":"black":e,t&&c(e)){const e=i.ZE[o];return[e[0],e[3]]}return i.ZE[o]}(e,t,r);if(o)return c(e)&&t?{colorAxis:{minColor:o[1],maxColor:o[0],showInLegend:!1},colors:o}:{colorAxis:void 0,colors:o}}function p(e){var t,r;let{collectionContextStore:o,groupValue:n,index:s,groupBy:u,theme:d,environment:c}=e;const p=o.normalizedSchemaStore.state,y=o.normalizedFormatStore.state;if("placeholder"===(null===(t=y.chart_config)||void 0===t?void 0:t.type)||void 0===n.value)return"light"===d.mode?i.ZE.translucentGray[0]:i.ZE.translucentGray[1];const m=p[u.property],f=m&&((0,a.cu)(m)||(0,a.gB)(m)),h=(null===(r=y.chart_config)||void 0===r||null===(r=r.chartFormat)||void 0===r?void 0:r.colorTheme)||"auto";if("auto"===h&&f){const e=(0,l.II)({environment:c,groupFormat:{property:u.property,value:n},schema:p,format:y,theme:d,ignoreDisableColorColumns:!0});if(e)return e.chartColor}const v=g("auto"===h?"colorful":h,!1,d),S=(null==v?void 0:v.colors)||i.ZE.colorful;return S[s%S.length]}function y(e,t){return t?"rgba(0, 0, 0, 0)":{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,(0,n.Fq)(e,.1)],[1,(0,n.Fq)(e,0)]]}}},82902:(e,t,r)=>{r.d(t,{C6:()=>k,FZ:()=>T,Iq:()=>j,VB:()=>K,bc:()=>O,d:()=>Z,yd:()=>G});r(757658);var o=r(730120),a=r(266897),n=r(371663),i=r(247025),s=r(164945),l=r(435011),u=r(114714),d=r(399036),c=r(180951),g=r(396367),p=r(421202),y=r(76233),m=r(709291),f=r(531701),h=r(653965),v=r(401898),S=r(51592),b=r(826842),_=r(892918),x=r(433929),C=r(637034),M=r(729376),B=r(740040),w=r(526561),F=r(425044);function T(e){var t,r,o;let{collectionContextStore:a,groupedDataConfig:n,xAxisType:i,groupResults:s,aggregationResults:l,subGroupResults:d,timezone:g,theme:p,environment:y,intl:m}=e;const v=n.groupBy,S=n.aggregationConfig,b=null===(t=a.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!b||"placeholder"===b.type)return;const _=null==b?void 0:b.chartFormat,x=null==_?void 0:_.weightColorValue,C=null==_?void 0:_.axisSort;if(!l||!v||!S)return;if(!(0,u.sM)(v.type))return;const M=a.normalizedSchemaStore.state,w=(0,c.Qm)({schema:M,property:v.property});if(!w)return;const F=Boolean(null===(r=b.chartFormat)||void 0===r?void 0:r.axisHideEmptyGroups),T="datetime"===i||"linear"===i;"formula"!==v.type&&"descending"===v.sort.type&&T&&(s=s.reverse());const G=!T,k=T;let K=[];const j=null===(o=S.stackOptions)||void 0===o?void 0:o.groupBy,P=S.seriesFormat.displayType;if(d&&j){if(!(0,c.Qm)({schema:M,property:j.property}))return;const e=null==_?void 0:_.axisCumulative;let t=0;d.forEach((r=>{const o=r.value,n=D({collectionContextStore:a,groupBy:j,groupValue:o,removeUncategorizedDateOrNumber:!1,environment:y,intl:m,timezone:g});if(!n)return;const i=(0,u.Hd)(o),d=l[i],c=d?z(d):void 0;if(F&&0===c)return;const f=V(n.stringValue,P),h=A({collectionContextStore:a,subGroupKey:i,groupBy:v,hideEmptyGroups:F,groupResults:s,aggregationResults:l,timezone:g,environment:y,shouldSetDataPointColor:"line"!==P&&!x,theme:p,intl:m,useIndexAsX:G,removeUncategorizedDateOrNumber:k});var S;(f.color=(0,B.TR)({collectionContextStore:a,groupValue:o,index:t,groupBy:j,theme:p,environment:y}),"line"===P)&&(f.fillColor=(0,B.Y9)(f.color,Boolean(null===(S=b.chartFormat)||void 0===S?void 0:S.hideLineFillArea)));e&&Z(b)?f.data=E(h):f.data=h,K.push(f),t+=1})),"y-ascending"!==C&&"y-descending"!==C||(K=function(e,t){const r=(0,h.Xh)(e);return r.forEach((e=>{const r=e.data.sort(((e,r)=>"y-ascending"===t?(e.total?e.total:0)-(r.total?r.total:0):(r.total?r.total:0)-(e.total?e.total:0)));r.forEach(((e,t)=>{e.x=t})),e.data=r})),r}(K,C))}else{const e=w.name,t=A({collectionContextStore:a,subGroupKey:void 0,groupBy:v,hideEmptyGroups:F,groupResults:s,aggregationResults:l,timezone:g,environment:y,shouldSetDataPointColor:"line"!==P&&!(0,B.EE)(null==_?void 0:_.colorTheme)&&!x,theme:p,intl:m,useIndexAsX:G,removeUncategorizedDateOrNumber:k}),r=V(e.toString(),P);if("line"===P){var R,O,L;const e=(null===(R=(0,B.zn)((null===(O=b.chartFormat)||void 0===O?void 0:O.colorTheme)||"colorful",!1,p))||void 0===R||null===(R=R.colors)||void 0===R?void 0:R[0])||f.ZE.colorful[0];r.fillColor=(0,B.Y9)(e,Boolean(null===(L=b.chartFormat)||void 0===L?void 0:L.hideLineFillArea))}(null==_?void 0:_.axisCumulative)&&Z(b)?r.data=E(t):r.data=t,K.push(r)}return K}function G(e){var t;const r=[],{groupedDataConfig:o,collectionContextStore:a,groupResults:n,aggregationResults:i,timezone:s,environment:l,theme:u,intl:d}=e,g=null===(t=a.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!g||"placeholder"===g.type)return;const p=null==g?void 0:g.chartFormat,y=null==p?void 0:p.weightColorValue,m=o.groupBy,f=a.normalizedSchemaStore.state,h=(0,c.Qm)({schema:f,property:m.property});if(!h)return;const v=A({collectionContextStore:a,subGroupKey:void 0,groupBy:m,groupResults:n,aggregationResults:i,timezone:s,environment:l,shouldSetDataPointColor:!y,theme:u,intl:d,hideEmptyGroups:!0,useIndexAsX:!0,removeUncategorizedDateOrNumber:!1});return r.push({name:h.name,data:v}),r}function V(e,t){return{name:e,type:"line"===t?"area":t,data:[]}}function A(e){var t,r;let{collectionContextStore:o,subGroupKey:a,groupBy:n,hideEmptyGroups:i,groupResults:l,aggregationResults:d,timezone:c,environment:g,shouldSetDataPointColor:p,theme:y,intl:m,useIndexAsX:f,removeUncategorizedDateOrNumber:v}=e;const S=[],b=null===(t=o.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!b||"placeholder"===b.type)return S;const _=null===(r=b.chartFormat)||void 0===r?void 0:r.axisSort,x=(0,s.u)(b)&&void 0===a&&("y-ascending"===_||"y-descending"===_);let C=0,M=l;if(x||"donut"===b.type){let e="desc";"y-ascending"===_&&(e="asc"),M=(0,h.Xo)(l,(e=>{const t=e.value,r=(0,u.Hd)(t),o=a?(0,u.Lr)([a,r]):r;return z(d[o])}),[e])}return M.forEach((e=>{const t=e.value,r=(0,u.Hd)(t),s=a?(0,u.Lr)([a,r]):r,l=d[s],h=d[r];if(!l||!h)return;const b=D({collectionContextStore:o,groupBy:n,removeUncategorizedDateOrNumber:v,groupValue:t,environment:g,intl:m,timezone:c}),_=z(l),x=z(h),M=p&&!a?(0,B.TR)({collectionContextStore:o,groupValue:t,index:C,groupBy:n,theme:y,environment:g}):void 0;if(void 0!==b&&void 0!==_&&void 0!==x&&(!i||0!==x)){if(f){const e={x:C,y:_,name:b.stringValue,color:M,total:x};b.actorPointer&&(e.actorPointer=b.actorPointer),S.push(e)}else S.push({x:b.numberValue,y:_,name:b.stringValue,color:M,total:x});C+=1}})),S}function k(e){var t,r;let{collectionContextStore:o,resultsDataConfig:a,resultsChartReducerResults:n,chartType:u,timezone:d,theme:g,intl:p}=e;const m=null===(t=o.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!m||"placeholder"===m.type)return;const h=null==m?void 0:m.chartFormat,v=null==h?void 0:h.weightColorValue,S=o.normalizedSchemaStore.state,_=(0,c.Qm)({schema:S,property:a.valueProperty});if(!_)return;const x=Boolean(null===(r=m.chartFormat)||void 0===r?void 0:r.axisHideEmptyGroups),C=[],M=_.name,w="axis"===u?a.valueSeriesFormat.displayType:"column",F=function(e){var t,r,o;let{collectionContextStore:a,hideEmptyGroups:n,resultsDataConfig:u,resultsChartReducerResults:d,shouldSetDataPointColor:g,theme:p,useIndexAsX:m,timezone:f,intl:h}=e;const v=[],S=a.normalizedFormatStore.state.chart_config,_=a.collectionStore();if(!_||!S||"placeholder"===S.type||!d)return[];let x=0;const C=(null===(t=S.chartFormat)||void 0===t?void 0:t.colorTheme)||"auto",M=(0,B.zn)("auto"===C?"colorful":C,!1,p),w=a.normalizedSchemaStore.state,F=(0,c.Qm)({schema:w,property:u.nameProperty}),T=(0,c.Qm)({schema:w,property:u.valueProperty}),G=new Map;if(d.blockIds.forEach((e=>{const t=b.G.createChildStore(_,{table:"block",id:e,spaceId:_.getSpaceId()}),r=t.getModel(),o=(()=>{if("formula"===(null==F?void 0:F.type)){if("text"!==(0,l.mm)(F)||!r)return;return(0,l.py)({schema:w,property:u.nameProperty,blockModel:r,getRecordModel:t.getRecordModel,intl:h,userTimeZone:f,depth:0,resultCache:G})}const e=t.getPropertyValue(u.nameProperty);return(0,y.QaF)(e)})(),a=(()=>{if("formula"===(null==T?void 0:T.type)){if("number"!==(0,l.mm)(T)||!r)return;return(0,l.py)({schema:w,property:u.valueProperty,blockModel:r,getRecordModel:t.getRecordModel,intl:h,userTimeZone:f,depth:0,resultCache:G})}const e=t.getPropertyValue(u.valueProperty);return(0,c.VY)(e)})();if(n&&void 0===a)return;let i;const s=null==M?void 0:M.colors;s&&g&&(i=s[x%s.length]),m&&v.push({x,y:a,name:o,color:i}),x+=1})),(null==S||null===(r=S.chartFormat)||void 0===r?void 0:r.axisCumulative)&&Z(S))return E(v);const V=null===(o=S.chartFormat)||void 0===o?void 0:o.axisSort;if((0,s.u)(S)&&(V===i.hd.yAscending||V===i.hd.yDescending)||"donut"===S.type){const e=v.sort(((e,t)=>"donut"===S.type||V===i.hd.yDescending?t.y-e.y:e.y-t.y));return e.forEach(((e,t)=>{e.x=t})),e}return v}({collectionContextStore:o,hideEmptyGroups:x,resultsDataConfig:a,resultsChartReducerResults:n,shouldSetDataPointColor:"line"!==w&&!v,theme:g,useIndexAsX:!0,timezone:d,intl:p}),T=V(M.toString(),w);if("line"===w){var G,A,k;const e=(null===(G=(0,B.zn)((null===(A=m.chartFormat)||void 0===A?void 0:A.colorTheme)||"colorful",!1,g))||void 0===G||null===(G=G.colors)||void 0===G?void 0:G[0])||f.ZE.colorful[0];T.fillColor=(0,B.Y9)(e,Boolean(null===(k=m.chartFormat)||void 0===k?void 0:k.hideLineFillArea))}return T.data=F,C.push(T),C}function K(e){let{groupedDataConfig:t,hideEmptyGroups:r,axisSort:o}=e;if(r||"y-ascending"===o||"y-descending"===o)return"category";const{type:a}=t.groupBy;return(0,u.ib)(t.groupBy)&&"relative"!==t.groupBy.groupBy?"datetime":"number"===a?"linear":"category"}function j(e){let{axisSort:t,xAxisType:r}=e;return"datetime"===r&&"x-descending"===t||"linear"===r&&"x-descending"===t}function D(e){let{collectionContextStore:t,groupBy:r,groupValue:n,removeUncategorizedDateOrNumber:i,environment:s,intl:l,timezone:y}=e;const m=t.collectionViewBlockStore();if(!m)return;const f=t.normalizedSchemaStore.state,h=(0,c.Qm)({schema:f,property:r.property});if(!h)return;const S=h.name;if(!n.value){if(i&&("number"===n.type&&"number"===(null==h?void 0:h.type)||(0,u.Mc)(n)))return;if((0,u.tL)(n)&&(0,d.p_)(h)){const e=m.getAssociatedCollectionStore();return{stringValue:R(S,!!e&&(0,F.O)({collectionStore:e,property:r.property,propertySchema:h,parentStore:e}))}}return{stringValue:R(S)}}if((0,u.Mc)(n)){const e=(0,_.fZ)({intl:l,value:n.value});if("day"===n.value.type||"month"===n.value.type||"week"===n.value.type||"year"===n.value.type){const e=o.ou.fromISO(n.value.range.start_date,{zone:y}).startOf("day").toMillis();return{stringValue:e.toString(),numberValue:e}}return{stringValue:e}}if((0,u.tL)(n)&&(0,d.p_)(h)){const e=n.value;if((0,u.RA)(e)){const t=e.id,r=b.G.createChildStore(m,{id:t,table:p.iU});return{stringValue:(0,C.vU)({environment:s,intl:l,store:r})}}if((0,u.t2)(e)){var x;const t=(0,M.ke)(h,m);if(!t)return;const r=null===(x=g.qB[t])||void 0===x||null===(x=x[e.value.variable])||void 0===x?void 0:x.messageDescriptor;return r?{stringValue:l.formatMessage(r)}:void 0}}else if((0,u.Rc)(n)){const e=n.value,t=null==e?void 0:e.type;if("by_group"===t&&null!=e&&e.group)return{stringValue:e.group};if("by_option"===t&&null!=e&&e.option)return{stringValue:null==e?void 0:e.option}}else{if("select"===n.type||"multi_select"===n.type)return{stringValue:n.value};if("number"===n.type){const e=n.value,t=e.type,r=(0,w.py)(h,l);if(!r)return;if("range"===t)return{stringValue:r(e.start),numberValue:e.start};if("unique"===t)return{stringValue:r(e.value),numberValue:e.value};if("out_of_range"===t)return;(0,v.t1)(t)}else{if((0,u.q6)(n)){const e=n.value,t=(0,a.Hl)({pointer:e,getRecordModel:m.getRecordModel});if(!t)return;return{stringValue:(0,a.$4)(l,t),actorPointer:e}}if("checkbox"===n.type)return{stringValue:h.name};if((0,u.R7)(n)){if("exact"===n.value.type)return{stringValue:n.value.value}}else if("formula"===n.type&&"formula"===r.type){return D({collectionContextStore:t,groupBy:r,groupValue:n.value,removeUncategorizedDateOrNumber:i,environment:s,intl:l,timezone:y})}}}}function z(e){const t=e.aggregationResult;if("number"===t.type)return t.value}const P=(0,m.defineMessages)({chartUncategorizedGroup:{defaultMessage:"No {name}",id:"database.chartView.uncategorizedGroupLabel"}});function R(e,t){return t?x.default.formatMessage(F.u.sprintUncategorizedGroup,{name:e??x.default.formatMessage(n.Ww.sprint_plural)}):x.default.formatMessage(P.chartUncategorizedGroup,{name:e??(0,S.Q_)(void 0)})}function O(e){if("column"!==e.type&&"bar"!==e.type)return!1;{const r=e.dataConfig.type;var t;if("groups_reducer"===r)return void 0===(null===(t=e.dataConfig.aggregationConfig.stackOptions)||void 0===t?void 0:t.groupBy);if("results_reducer"===r)return!0;(0,v.t1)(r)}}function Z(e){var t;const r=(0,s.u)(e),o="groups_reducer"===e.dataConfig.type?e.dataConfig.aggregationConfig.aggregation.aggregator:"count",a="count"===o||"sum"===o,n=null===(t=e.chartFormat)||void 0===t?void 0:t.axisSort;return r&&a&&"x-ascending"===n}function E(e){const t=[];let r=0;for(const o of e){const e=o.y||0,a={...o,y:e+r};t.push(a),r+=e}return t}},233312:(e,t,r)=>{r.d(t,{M:()=>n,e:()=>i});var o=r(709291),a=r(433929);const n=(0,o.defineMessages)({noData:{defaultMessage:"No data",id:"chartError.noData"},unconfiguredProperty:{id:"chartError.unconfiguredProperty",defaultMessage:"Property is not configured. Please make another selection."},unsupportedProperty:{id:"chartError.unsupportedProperty",defaultMessage:"This property type is not supported. Please select another property"},unsupportedFormula:{id:"chartError.unsupportedFormula",defaultMessage:"This formula is not supported. Please select another property or adjust your formula."},deletedProperty:{id:"chartError.deletedProperty",defaultMessage:"This property has been deleted. Please select another property."},invalidAggregation:{id:"chartError.invalidAggregation",defaultMessage:"Previously selected property is no longer valid with the current aggregation. Please make another selection."},invalidPropertyValueChart:{id:"chartError.invalidPropertyValueChart",defaultMessage:"Selected property is no longer valid with the previous configured chart. Please make another selection."},noValues:{id:"chartError.noValues",defaultMessage:"This property has no values. Please add some values or select another property."}});function i(e){switch(e){case"groupBy_property_not_configured":case"aggregation_property_not_configured":case"name_property_not_configured":case"property_value_property_not_configured":return a.default.formatMessage(n.unconfiguredProperty);case"groupBy_property_not_groupable":case"stackBy_property_not_groupable":return a.default.formatMessage(n.unsupportedProperty);case"groupBy_formula_not_groupable":case"stackBy_formula_not_groupable":return a.default.formatMessage(n.unsupportedFormula);case"groupBy_property_deleted":case"stackBy_property_deleted":case"aggregation_deleted":case"name_property_deleted":case"property_value_property_deleted":return a.default.formatMessage(n.deletedProperty);case"aggregation_invalid":return a.default.formatMessage(n.invalidAggregation);case"stackBy_property_no_values":return a.default.formatMessage(n.noValues);case"name_property_invalid":case"property_value_property_invalid":return a.default.formatMessage(n.invalidPropertyValueChart);default:return}}},434709:(e,t,r)=>{r.d(t,{x:()=>l});var o=r(886628),a=r(974575),n=r(164945),i=r(183357),s=r(870890);function l(e){var t;let{chartConfig:r,chartError:l,collectionContextStore:u}=e;const d=(0,o.VK)((()=>u.normalizedFormatStore.state),[u]),c=(0,o.VK)((()=>(0,s.WT)()),[]),g=(0,o.VK)((()=>(0,s.K9)()),[]),p=(d.collection_groups||[]).map((e=>e.value)),y=r&&(0,n.u)(r)?null===(t=r.chartFormat)||void 0===t?void 0:t.axisHideEmptyGroups:void 0,m=(0,o.VK)((()=>{var e;if(r&&"placeholder"!==r.type&&"groups_reducer"===(null===(e=r.dataConfig)||void 0===e?void 0:e.type))return r.dataConfig.groupBy}),[r]),f=(0,o.VK)((()=>{var e,t;if(r&&(0,n.u)(r)&&"groups_reducer"===(null===(e=r.dataConfig)||void 0===e?void 0:e.type))return null===(t=r.dataConfig.aggregationConfig.stackOptions)||void 0===t?void 0:t.groupBy}),[r]);return(0,o.VK)((()=>{if(l&&!(0,a.se)(l)||!r||!m)return;const e=(0,i.x7)(r);if(!e)return;if(f){return{type:"groups",groupBy:m,limit:c,groupSortPreference:p??[],subGroup:{groupBy:f,limit:g,groupSortPreference:[]},aggregation:{type:"intersection_and_independent",intersectionAggregation:e,groupAggregation:e,subGroupAggregation:e},hideEmptyAggregationGroups:Boolean(y)}}return{type:"groups",limit:c,groupBy:m,groupSortPreference:p??[],aggregation:{type:"independent",groupAggregation:e},hideEmptyAggregationGroups:Boolean(y)}}),[r,l,m,f,p,y,c,g],{useDeepEqual:!0})}},526561:(e,t,r)=>{r.d(t,{V4:()=>C,Xn:()=>T,ff:()=>F,hZ:()=>G,py:()=>M,qQ:()=>w,vY:()=>B});var o=r(730120),a=r(667294),n=r(724405),i=r(266897),s=r(247025),l=r(164945),u=r(114714),d=r(180951),c=r(280162),g=r(158102),p=r(640506),y=r(407057),m=r(959753),f=r(423512),h=r(606746),v=r(531701),S=r(137810),b=r(95477),_=r(892918),x=r(785893);function C(e,t,r){const o=(0,n.yK)((e=>({wrapper:{display:"flex",alignItems:"center",gap:6,minWidth:0},initialStyle:{backgroundColor:e.chartAvatarBackgroundColor,border:`1px solid ${e.chartAvatarBorderColor}`,color:e.chartAvatarColor},avatarStyle:{background:"none"},botStyle:{backgroundColor:e.chartAvatarBackgroundColor,border:`1px solid ${e.chartAvatarBorderColor}`,color:e.chartAvatarColor,fontSize:r?8:10},avatarWrapper:{flexShrink:0},nameWrapper:{minWidth:0,...S.Z.textOverflowStyle}})),[r]);return(0,a.useCallback)(((a,n)=>{var s,l;if(!n)return a.toString();let u,d,p;if(n.actorPointer&&e){var y;const r=(0,i.Hl)({pointer:n.actorPointer,getRecordModel:e});d=null==r?void 0:r.asActor,p=null===(y=d)||void 0===y?void 0:y.getDisplayName(t)}return p||(p=a||t.formatMessage(m.dp.messages.anonymousPlaceholder)),u=null!==(s=d)&&void 0!==s&&s.isUser()?(0,x.jsx)(g.ZP,{userValue:d,avatarSize:r?16:20,baseUrl:b.default.domainBaseUrl,theme:(0,v.Vx)(),fontSize:r?8:10,initialStyle:o.initialStyle,avatarStyle:o.avatarStyle}):null!==(l=d)&&void 0!==l&&l.isBot()?(0,x.jsx)(c.Z,{botValue:d,avatarSize:r?16:20,baseUrl:b.default.domainBaseUrl,theme:(0,v.Vx)(),style:o.botStyle}):(0,x.jsx)(g.ZP,{userValue:{name:"?"},avatarSize:r?16:20,baseUrl:b.default.domainBaseUrl,theme:(0,v.Vx)(),fontSize:r?8:10,initialStyle:o.initialStyle,avatarStyle:o.avatarStyle}),h.Z.renderToStaticMarkup((0,x.jsxs)("div",{style:o.wrapper,children:[(0,x.jsx)("div",{style:o.avatarWrapper,children:u}),r?(0,x.jsx)("div",{style:o.nameWrapper,children:p}):null]}))}),[e,t,r,o])}function M(e,t){const r=F(e);return e=>{if("string"==typeof e)return e;const o=Math.round(100*e)/100;return(0,f.uf)(o,r,t,"compact")}}function B(e){let{groupBy:t,dateFormat:r,intl:o}=e;return(e,a)=>{let n;return n=a?a.name:"string"==typeof e?e:e.toString(),w({dateString:n,dateFormat:r,groupBy:t,intl:o})}}function w(e){let{dateString:t,dateFormat:r,groupBy:a,intl:n}=e;const i=parseInt(t,10);if(isNaN(i))return t;switch(a){case"relative":default:return t;case"day":return(0,y.ZV)({value:{type:"date",start_date:o.ou.fromMillis(i).toISODate()},date_format:r||p.sF,allowRelativeDates:!0,intl:n});case"week":case"month":case"year":const e=o.ou.fromMillis(i),s={type:a,range:{type:"daterange",start_date:e.toISODate(),end_date:e.plus({[`${a}s`]:1}).toISODate()}};return(0,_.fZ)({value:s,intl:n})}}function F(e){let t;return("number"===e.type||"formula"===e.type)&&(t=e.number_format),t}function T(e){let{chartConfig:t,schema:r,highChartsLabel:o,highChartsValue:a,isMultiSeries:n,intl:i}=e,u=o,c=a;if(!t)return{label:u,value:c};const g=t.dataConfig;let p,y,m;if(n){if((0,l.u)(t)&&"groups_reducer"===t.dataConfig.type){var h;const e=t.dataConfig;if(p=null===(h=e.aggregationConfig.stackOptions)||void 0===h?void 0:h.groupBy,p){const e=(0,d.Qm)({schema:r,property:p.property});e&&(0,s.f3)(e)&&(y=e)}const o=e.aggregationConfig.aggregation;"count"!==o.aggregator&&(m=(0,d.Qm)({schema:r,property:o.property}))}}else if("groups_reducer"===g.type){p=g.groupBy,y=(0,d.Qm)({schema:r,property:g.groupBy.property});const e=g.aggregationConfig.aggregation;"count"!==e.aggregator&&(m=(0,d.Qm)({schema:r,property:e.property}))}else m=(0,d.Qm)({schema:r,property:g.valueProperty});if(u=y?G(y,p,o,i):u,c&&"number"==typeof c&&m&&(0,s.Dv)(m)){const e=F(m);c=(0,f.uf)(c,e,i,"compact")}return{label:u,value:c}}function G(e,t,r,o){if(e&&(0,s.Dv)(e)){const t=parseInt(r,10);if(isNaN(t))return r;const a=F(e);return(0,f.uf)(t,a,o,"compact")}return e&&(0,s.l2)(e)&&t&&(0,u.ib)(t)?w({dateString:r,dateFormat:e.date_format,groupBy:t.groupBy,intl:o}):r}},870890:(e,t,r)=>{r.d(t,{K9:()=>l,WT:()=>u,Zl:()=>s});var o=r(319385);const a=1e3,n=1e3,i=1e3;function s(){const e=o.default.getConfigKey("charts_query_collection_limits","max_results_reducer_limit");return e||i}function l(){const e=o.default.getConfigKey("charts_query_collection_limits","max_subgroups_reducer_limit");return e||n}function u(){const e=o.default.getConfigKey("charts_query_collection_limits","max_groups_reducer_limit");return e||a}},20130:(e,t,r)=>{r.d(t,{q:()=>a});var o=r(319385);function a(){return o.default.getConfigKey("collection_reducer_request_settings","chart").debounce_wait_ms}},451741:(e,t,r)=>{r.d(t,{NW:()=>i,Qi:()=>a,Rt:()=>o,WO:()=>s,wI:()=>n});let o=function(e){return e[e.SelectedPage=0]="SelectedPage",e[e.SearchPage=1]="SearchPage",e[e.NewPage=2]="NewPage",e}({});const a=4,n=32,i=400,s=20},401018:(e,t,r)=>{r.d(t,{NW:()=>o.NW,Qi:()=>o.Qi,ev:()=>a.ev,wI:()=>o.wI});var o=r(451741),a=r(296994)},120394:(e,t,r)=>{r.d(t,{FW:()=>a,OS:()=>o,jW:()=>n});const o="ungrouped_chart_results",a="grouped_chart_results",n="aggregation_chart_results"},974575:(e,t,r)=>{r.d(t,{C:()=>y,Ib:()=>g,SO:()=>c,lY:()=>p,o0:()=>m,se:()=>f});var o=r(202032),a=r(435011),n=r(114714),i=r(180951),s=r(107289),l=r(247025),u=r(164945);const d=new Set(["groupBy_property_not_configured","groupBy_property_deleted","groupBy_property_not_groupable","groupBy_formula_not_groupable","aggregation_property_not_configured","aggregation_invalid","aggregation_deleted","stackBy_property_not_groupable","stackBy_formula_not_groupable","stackBy_property_deleted","name_property_not_configured","name_property_deleted","name_property_invalid","property_value_property_not_configured","property_value_property_deleted","property_value_property_invalid"]);function c(e){let{chartConfig:t,collectionSchema:r}=e;if(!t||"placeholder"===t.type)return"chart_config_not_found";if(void 0===t.dataConfig)return"data_model_invalid";if("groups_reducer"===t.dataConfig.type){const e=t.dataConfig.groupBy;if(!e)return"groupBy_property_not_configured";const s=(0,i.Qm)({schema:r,property:e.property});if(!s)return"groupBy_property_deleted";const c=(0,n.LG)(s);if("formula"===s.type&&!c)return"groupBy_formula_not_groupable";if(!c)return"groupBy_property_not_groupable";const g=t.dataConfig.aggregationConfig;if(!g)return"aggregation_property_not_configured";if("count"!==g.aggregation.aggregator){const e=g.aggregation.property,t=(0,i.Qm)({schema:r,property:e});if(!t)return"aggregation_deleted";if((0,o.nC)(g.aggregation)&&t&&!(0,l.Dv)(t))return"aggregation_invalid";if("formula"===(null==t?void 0:t.type)&&"unique"===g.aggregation.aggregator){const e=(0,a.mm)(t);if(!(0,l.Oy)(e))return"aggregation_invalid"}}if((0,u.u)(t)){var d;const e=null===(d=t.dataConfig.aggregationConfig.stackOptions)||void 0===d?void 0:d.groupBy.property;if(e){const t=(0,i.Qm)({schema:r,property:e});if(!t)return"stackBy_property_deleted";const o=(0,n.LG)(t);if("formula"===t.type&&!o)return"stackBy_formula_not_groupable";if(!o)return"stackBy_property_not_groupable"}}}else{if("results_reducer"!==t.dataConfig.type)return"data_model_invalid";{const e=t.dataConfig.nameProperty;if(!e)return"name_property_not_configured";const o=(0,i.Qm)({schema:r,property:e});if(!o)return"name_property_deleted";if(!(0,s.HT)(o))return"name_property_invalid";const a=t.dataConfig.valueProperty;if(!a)return"property_value_property_not_configured";const n=(0,i.Qm)({schema:r,property:a});if(!n)return"property_value_property_deleted";if(!(0,s._i)(n))return"property_value_property_invalid"}}}function g(e){return"groupBy_property_not_configured"===e||"groupBy_property_deleted"===e||"groupBy_property_not_groupable"===e||"groupBy_formula_not_groupable"===e||"name_property_not_configured"===e||"name_property_deleted"===e||"name_property_invalid"===e}function p(e){return"aggregation_property_not_configured"===e||"aggregation_deleted"===e||"aggregation_invalid"===e||"property_value_property_not_configured"===e||"property_value_property_deleted"===e||"property_value_property_invalid"===e}function y(e){return"stackBy_property_deleted"===e||"stackBy_property_not_groupable"===e||"stackBy_formula_not_groupable"===e||"stackBy_property_no_values"===e}function m(e){return d.has(e)}function f(e){return"stackBy_property_no_values"===e}},247025:(e,t,r)=>{r.d(t,{Dv:()=>T,Fh:()=>l,GX:()=>v,Gs:()=>u,II:()=>F,Kx:()=>C,OY:()=>h,Oy:()=>k,PL:()=>w,QJ:()=>m,R1:()=>S,Sw:()=>V,T9:()=>M,UJ:()=>y,Vu:()=>K,Xg:()=>g,Xm:()=>p,dY:()=>b,f3:()=>G,h_:()=>f,hd:()=>d,l2:()=>A,lr:()=>c,qV:()=>B,vi:()=>j,vx:()=>x});var o=r(401898),a=r(435011),n=r(114714),i=r(399036),s=r(180951);const l=["gray","blue","yellow","green","purple","teal","orange","pink","red"],u=["auto","colorful"];let d=function(e){return e.manual="manual",e.resultsAdvanced="results-advanced",e.yAscending="y-ascending",e.yDescending="y-descending",e.xAscending="x-ascending",e.xDescending="x-descending",e}({}),c=function(e){return e.avatar="avatar",e.avatar_name="avatar_name",e.name="name",e}({}),g=function(e){return e.none="none",e.x_axis="x_axis",e.y_axis="y_axis",e.both="both",e}({}),p=function(e){return e.none="none",e.horizontal="horizontal",e.vertical="vertical",e.both="both",e}({}),y=function(e){return e.normal="normal",e.percent="percent",e.side_by_side="side_by_side",e}({});function m(e){if(!e)return!1;return n.vu.includes(e)}function f(e){if(!e)return!1;return n.z8.includes(e)}function h(e){const t=(0,a.r9)(e);return"text"===t||"number"===t||"checkbox"===t||"person"===t||"date"===t}function v(e){let t,r=e.chartFormat;if("groups_reducer"===e.dataConfig.type){var a;const{chartFormat:o,chartGroupByFormat:n}=_(null==e||null===(a=e.dataConfig)||void 0===a?void 0:a.groupBy,null==e?void 0:e.chartFormat,"donut");r=o,t={...e.dataConfig,groupBy:n,aggregationConfig:{aggregation:e.dataConfig.aggregationConfig.aggregation}}}else"results_reducer"===e.dataConfig.type?t=e.dataConfig:(0,o.t1)(e.dataConfig);const n={...e,type:"donut",dataConfig:t};return r&&(n.chartFormat=r),n}function S(e,t){let r;return"groups_reducer"===e.dataConfig.type?r={...e.dataConfig,aggregationConfig:{...e.dataConfig.aggregationConfig,seriesFormat:{displayType:t},stackOptions:void 0}}:"results_reducer"===e.dataConfig.type?r={...e.dataConfig,valueSeriesFormat:{displayType:t}}:(0,o.t1)(e.dataConfig),{...e,type:t,dataConfig:r}}function b(e,t){let r,a=e.chartFormat;if("groups_reducer"===e.dataConfig.type){var n;const{chartFormat:o,chartGroupByFormat:i}=_(null==e||null===(n=e.dataConfig)||void 0===n?void 0:n.groupBy,null==e?void 0:e.chartFormat,t);a=o,r={...e.dataConfig,groupBy:i,aggregationConfig:{...e.dataConfig.aggregationConfig,seriesFormat:{displayType:t}}}}else"results_reducer"===e.dataConfig.type?r={...e.dataConfig,valueSeriesFormat:{displayType:t}}:(0,o.t1)(e.dataConfig);const i={...e,type:t,dataConfig:r};return a&&(i.chartFormat=a),i}function _(e,t,r){if(!((null==t?void 0:t.axisSort)!==d.yAscending&&(null==t?void 0:t.axisSort)!==d.yDescending||"line"!==r&&"donut"!==r)){const r=(0,n.Cc)(e);return{chartFormat:{...t,axisSort:C(r.sort)},chartGroupByFormat:r}}return{chartFormat:t,chartGroupByFormat:e}}function x(){return d.xAscending}function C(e){switch(null==e?void 0:e.type){case"manual":return d.manual;case"descending":return d.xDescending;default:return d.xAscending}}function M(e){let{chartConfig:t,xAxisPropertyId:r,newDataConfigType:a,groupBy:n,aggregation:i,valueProperty:s}=e;const l="groups_reducer"===t.dataConfig.type?t.dataConfig.aggregationConfig.seriesFormat:t.dataConfig.valueSeriesFormat;"groups_reducer"===a?t.dataConfig={type:"groups_reducer",groupBy:n,aggregationConfig:{aggregation:i,seriesFormat:l,stackOptions:"groups_reducer"===t.dataConfig.type?t.dataConfig.aggregationConfig.stackOptions:void 0}}:"results_reducer"===a?t.dataConfig={type:"results_reducer",nameProperty:r,valueProperty:s,valueSeriesFormat:l}:(0,o.t1)(a);const u="formula"===n.type?n.groupBy.sort:n.sort;return t.chartFormat={...t.chartFormat,axisSort:C(u)},t}function B(e){let{property:t,propertySchema:r,groupByOption:o}=e;const i=r.type;if((0,n.LG)(r)){if((0,n.A1)(i)){if(o&&f(o))return{type:i,property:t,groupBy:o,sort:{type:"ascending"}}}else{if((0,n.zb)(i)||"select"===i||"multi_select"===i)return{type:i,property:t,sort:{type:"ascending"}};if((0,n.H1)(i)){if(o&&m(o))return{type:i,property:t,groupBy:o,sort:{type:"ascending"}}}else{if("number"===i)return{type:i,property:t,groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}};if("formula"===i){const e=(0,a.mm)(r);if("number"===e)return{type:"formula",property:t,groupBy:{type:"number",groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}}};if("date"===e&&f(o))return{type:"formula",property:t,groupBy:{type:"date",groupBy:o,sort:{type:"ascending"}}}}else if("person"===i)return{type:i,property:t,sort:{type:"manual"}}}}return(0,n.fw)(t,r)}}function w(e){if((0,n.ib)(e)||(0,n.TD)(e))return e.groupBy;if("formula"===e.type){const t=e.groupBy;if((0,n.ib)(t)||(0,n.TD)(t))return t.groupBy}}function F(e){let{collectionSchema:t,property:r}=e;const o=(0,s.Qm)({schema:t,property:r});return o&&(0,n.LG)(o)?T(o)?[{aggregator:"count"},{aggregator:"sum",property:r},{aggregator:"average",property:r},{aggregator:"min",property:r},{aggregator:"max",property:r},{aggregator:"median",property:r}]:[{aggregator:"count"}]:[]}function T(e){const t="formula"===e.type?(0,a.mm)(e):void 0;return(0,i.G$)(e)||"number"===t}function G(e){const t="formula"===e.type?(0,a.mm)(e):void 0;return(0,n.A1)(e.type)||"date"===t}function V(e){const t="formula"===e.type?(0,a.mm)(e):void 0;return(0,i.U8)(e)||"person"===t}function A(e){return(0,n.A1)(e.type)}function k(e){return"text"===e||"number"===e||"person"===e||"date"===e}function K(e){var t;return("bar"===(null==e?void 0:e.type)||"column"===(null==e?void 0:e.type))&&("groups_reducer"!==e.dataConfig.type||!e.dataConfig.aggregationConfig.stackOptions||"percent"!==(null===(t=e.chartFormat)||void 0===t?void 0:t.axisGroupStyle))}function j(e){return!!K(e)&&(("bar"===(null==e?void 0:e.type)||"column"===(null==e?void 0:e.type))&&(void 0===(null===(t=e.chartFormat)||void 0===t?void 0:t.axisShowDataLabels)||(null===(r=e.chartFormat)||void 0===r?void 0:r.axisShowDataLabels)));var t,r}},280162:(e,t,r)=>{r.d(t,{Z:()=>s});r(667294);var o=r(643593),a=r(517755),n=r(158102),i=r(785893);const s=function(e){const{botValue:t,avatarSize:r,baseUrl:s,theme:l,style:u}=e;if(null!=t&&t.icon){const d=o.F8(t.icon)?a.Q4({url:t.icon,width:e.avatarSize,fullyQualified:!0,stripGoogleIconQuery:!0,baseUrl:s,userId:void 0}):t.icon;return(0,i.jsx)("div",{style:{...(0,n.nH)({theme:l,avatarSize:r}),...u},children:(0,i.jsx)("img",{src:d,style:{display:"block",width:"100%",height:"100%",objectFit:"cover"}})})}if(null!=t&&t.name){const e=t.name[0];return(0,i.jsx)("div",{children:(0,i.jsx)("div",{style:{...(0,n.r4)({theme:l,avatarSize:r}),...u},children:(0,i.jsx)("div",{children:e})})})}return(0,i.jsx)("span",{children:""})}}}]);