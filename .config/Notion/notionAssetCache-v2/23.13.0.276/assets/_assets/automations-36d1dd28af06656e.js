"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[31655],{503630:(e,t,o)=>{o.r(t),o.d(t,{AutomationWorkflowEditor:()=>Eo,AutomationWorkflowEditorActionSection:()=>Ro,PlacedButtonBlockEditor:()=>Uo,automationActions:()=>i,automationExecutionActions:()=>n});var n={};o.r(n),o.d(n,{executeClientAutomation:()=>Ae});var i=o(143627),r=o(940694),a=o(102647),s=o(940470),l=o(401898),c=o(267130);async function u(e){const{action:t,values:o,executionContext:n}=e,i=(0,r.z)(t.getType());return await i.execute({...n,values:o},t)}var d=o(710450),p=o(335102),m=o(568626),g=o(842875),h=o(291627),y=o(519889),f=o(452423),x=o(164964),S=o(95477),v=o(27105),b=o(296994),C=o(730459),k=o(433929),M=o(535057),j=o(318245);const T={...c.Fv,logNotionPerformance(e){const{automationStats:t,environment:o}=e;if((0,c.uz)(t)){const e={metricName:"automation.client.execution_duration_ms",startTime:t.executionStartTime,endTime:t.executionStartTime+t.executionDurationMs};j.default.measure(e,{environment:o,data:{success:t.executionSuccess}})}for(const n of Object.values(t.actionStats))if((0,c.Ov)(n)){const e={metricName:"automation.client.action_execution_duration_ms",startTime:n.executionStartTime,endTime:n.executionStartTime+n.executionDurationMs};j.default.measure(e,{data:{automation_action_type:n.actionType,success:n.executionSuccess},environment:o})}}};o(757658);var A=o(371663),P=o(709291);const w=(0,P.defineMessages)({genericSuccessMessage:{id:"automations.buttonTrigger.genericSuccessMessage",defaultMessage:"Button automation ran successfully"},createdBlocks:{defaultMessage:"Created {numBlocksDuplicated, plural, one {1 block} other {{numBlocksDuplicated} blocks}} on page",id:"automations.buttonTrigger.createdBlocks"},createdSprintsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprints"},updatedSprintsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprints"},createdSprintsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprintsLowercase"},updatedSprintsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprintsLowercase"},createdTasksUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasks"},updatedTasksUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasks"},createdTasksLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasksLowercase"},updatedTasksLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasksLowercase"},createdProjectsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjects"},updatedProjectsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjects"},createdProjectsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjectsLowercase"},updatedProjectsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjectsLowercase"},createdPagesUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPages"},updatedPagesUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPages"},createdPagesLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPagesLowercase"},updatedPagesLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPagesLowercase"}}),V=["sprint","task","project","page"],I={[A.wW]:"project",[A.iS]:"task",[A.zU]:"page",[A.Fi]:"page",[A.p$]:"sprint",[A.GZ]:"page",[A.nG]:"page",[A.Be]:"page"};function F(e){const{typedAutomationExecutionSummary:t,numBlocksDuplicated:o,intl:n}=e,i=function(e){const{typedAutomationExecutionSummary:t,intl:o}=e,n=[];for(const r of V){const e=t[r];if(e){const{numPagesCreated:t,numPagesEdited:o}=e;t>0&&n.push({pageType:r,modificationType:"created",numPagesModified:t}),o>0&&n.push({pageType:r,modificationType:"updated",numPagesModified:o})}}const i=n.slice(0,Z).map(((e,t)=>{let{pageType:n,modificationType:i,numPagesModified:r}=e;const a=B[n][i],s=0===t?a.start:a.append;return o.formatMessage(s,{numPagesModified:r})}));if(i.length>0)return o.formatList(i,{type:"conjunction",style:"long"})}({typedAutomationExecutionSummary:t,intl:n});return i||(o>0?n.formatMessage(w.createdBlocks,{numBlocksDuplicated:o}):n.formatMessage(w.genericSuccessMessage))}const Z=3;const B={sprint:{created:{start:w.createdSprintsUppercase,append:w.createdSprintsLowercase},updated:{start:w.updatedSprintsUppercase,append:w.updatedSprintsLowercase}},task:{created:{start:w.createdTasksUppercase,append:w.createdTasksLowercase},updated:{start:w.updatedTasksUppercase,append:w.updatedTasksLowercase}},project:{created:{start:w.createdProjectsUppercase,append:w.createdProjectsLowercase},updated:{start:w.updatedProjectsUppercase,append:w.updatedProjectsLowercase}},page:{created:{start:w.createdPagesUppercase,append:w.createdPagesLowercase},updated:{start:w.updatedPagesUppercase,append:w.updatedPagesLowercase}}};var K=o(421202),_=o(206258);async function R(e){const{saveTransactionInfos:t,clientContext:o}=e;let n;for(const a of t.slice().reverse()){if("create_page"===a.type){var i;n=_.G.createChildStore(o.parentRecordStore,{table:K.iU,id:a.pageId,spaceId:null===(i=a.collection)||void 0===i?void 0:i.spaceId});break}if("update_pages"===a.type){if(1===a.pageIds.length){var r;n=_.G.createChildStore(o.parentRecordStore,{table:K.iU,id:a.pageIds[0],spaceId:null===(r=a.collection)||void 0===r?void 0:r.spaceId})}else{const e=_.NW.createChildStore(o.parentRecordStore,a.collection);await e.load();const t=e.getParentBlockStore();if(!t)continue;n=t}break}(0,l.t1)(a)}return n}function N(e){const{saveTransactionInfos:t,parentRecordStore:o}=e,n={},i=new Set;for(const u of t)if("create_page"===u.type){var r,a;if(i.has(u.pageId))continue;const e=_.NW.createChildStore(o,u.collection).getDatabaseType(),t=(e&&I[e])??"page",s=(null===(r=n[t])||void 0===r?void 0:r.numPagesEdited)??0,l=(null===(a=n[t])||void 0===a?void 0:a.numPagesCreated)??0;n[t]={numPagesCreated:l+1,numPagesEdited:s},i.add(u.pageId)}else if("update_pages"===u.type){var s,c;const e=_.NW.createChildStore(o,u.collection).getDatabaseType(),t=(e&&I[e])??"page",i=(null===(s=n[t])||void 0===s?void 0:s.numPagesEdited)??0,r=(null===(c=n[t])||void 0===c?void 0:c.numPagesCreated)??0;n[t]={numPagesCreated:r,numPagesEdited:i+u.pageIds.length}}else(0,l.t1)(u);return n}o(21703);var D=o(701302),L=o(815145),O=o(417586),W=o(681532),E=o(881730),H=o(541432),U=o(471924),z=o(300482),$=o(798963),G=o(718844),q=o(23867),Y=o(76233),Q=o(167175),X=o(937850),J=o(436610),ee=o(100952),te=o(454642),oe=o(498834),ne=o(276725),ie=o(13084),re=o(119785),ae=o(268305),se=o(709953),le=o(608055),ce=o(524677),ue=o(210228),de=o(610358),pe=o(484681),me=o(144500),ge=o(521100),he=o(484210),ye=o(741195),fe=o(95802),xe=o(80444),Se=o(558454),ve=o(319385),be=o(188923),Ce=o(44041),ke=o(88893),Me=o(428956),je=o(288280);class Te{constructor(e){this.environment=void 0,this.clientContext=void 0,this.automationModel=void 0,this.numBlocksDuplicated=0,this.saveTransactionInfos=[],this.undoCheckpointName=void 0,this.getCollectionSchema=async e=>{const t=await this.clientContext.parentRecordStore.loadRecordModel(e.pointer);return t?{value:{collectionSchema:t.getNormalizedSchema()}}:{error:new E.Do({actionId:e.actionId,pointer:e.pointer})}},this.runAssistantWithInstructions=async e=>{var t;if(!1===(null===(t=Me.Z.state)||void 0===t?void 0:t.isEligible)){if((0,ke.GJ)(je.subscriptionDataStoreInstance.state)&&!this.environment.device.isMobileNative)return void(0,Ce.y)(this.environment,{from:"ai_assistant_limit_in_app",for:(0,M.zt)(),addOnFeature:"ai"})}const o=k.default.getIntl(),n=this.clientContext.automationStore.getNameWithDefault(o);let i,r;const{automationId:a,config:s,overrideCurrentPagePointer:l}=e;if(!(0,W.aB)({skillType:s.skillType,parameterValues:s.parameterValues}))return void x.oV({label:"The selected skill requires some parameters that are not set."});if((0,C.j)({environment:this.environment,event:{eventName:"assistant_basic_action",eventProperties:{automation_id:a,skill_type:s.skillType}}}),(0,G.tu)(s)){var c;const e=null===(c=s.parameterValues)||void 0===c?void 0:c.initialUserPrompt;r={clientSkill:{...(0,me.createClientGlobalSkill)("custom"),displayName:{id:"notTranslated.runAssistantWithInstructions.customName",defaultMessage:n},assistantMessage:e?{id:"notTranslated.runAssistantWithInstructions.customMessage",defaultMessage:(0,Y.QaF)(e)}:void 0},parameterValues:{...s.parameterValues,name:n}},i=Boolean(null==e?void 0:e.length)}else{const{skillType:e}=s;if(!e)return;r={clientSkill:(0,me.createClientGlobalSkill)(e),parameterValues:s.parameterValues??{}};i=(0,O.Fq)(r.clientSkill.skillType).requiresInput??!1}const u=l?new _.G(this.environment,l):void 0,d=await(0,de.resetAndInitializeAssistantSession)({environment:this.environment,clientSkillWithParameterValues:r,makeActiveSession:!0,currentPageOverrideStore:u});(0,pe.openAssistantRightHandSideMenu)({environment:this.environment,makeActiveSessionId:d.sessionId,from:"automation_button"}),i||await(0,de.sampleNextAssistantStepsAsHumanSubmission)({environment:this.environment,inferenceId:U.Il(),sessionId:d.sessionId})},this.queryCollection=async e=>{const t=await ae.tA(this.environment,{source:"automation",parentRecordStore:this.clientContext.parentRecordStore,collectionPointer:e.collection,filter:e.filter,sort:e.sort,limit:e.limit});return s.x.isFail(t)?{error:new E.Pn({actionId:e.actionId,type:t.error.type,message:t.error.message,cause:t.error})}:{value:{blockIds:t.value.blockIds}}},this.saveTransaction=e=>{const{info:t,operations:o}=e,n=[];if(this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.saveTransaction",environment:this.environment,perform:e=>{for(const t of o)if((0,Q.Qf)(t)){const o=_.G.createChildStore(this.clientContext.parentRecordStore,t.pointer);ue.applyCrdtTextOperation({store:o,operation:t,invertedOperation:void 0,transaction:e})}else if((0,z.V_)(t)||(0,z.SH)(t)){const o=(0,_.Kv)(this.clientContext.parentRecordStore,t.pointer);ue.applyOperation({store:o,operation:t,transaction:e})}else(0,l.t1)(t);n.push(e.id)}}),this.saveTransactionInfos.push(t),"create_page"===t.type)ee.W(this.environment,{type:"page",automation_id:this.automationModel.id,from:"button_automation",new_page_id:t.pageId,creating_block_id:t.pageId});else if("update_pages"===t.type){const{editedProperties:e,pageIds:o}=t;for(const t of o)for(const{id:o,type:n}of e)J.rv(this.environment,{block_id:t,property:o,property_type:n,from:"button_automation",automation_id:this.automationModel.id},!1)}else(0,l.t1)(t);return Promise.resolve({value:{stats:{totalOperations:o.length,transactionIds:n}}})},this.navigateToPage=e=>{const t=xe.default.state.mainEditorCurrentBlockStore;if(!t)return;const o=_.G.createChildStore(t,e.page),n="full_page"===e.openIn?(0,he.ZP)({store:o,fullyQualified:!1,pageVisitSource:L.tY.ButtonAutomation}):(0,he.ZP)({store:t,peekViewBlockId:o.id,peekMode:(0,be.getUrlParamFromPeekMode)(e.openIn),fullyQualified:!1,pageVisitSource:L.tY.ButtonAutomation});le.c4({environment:this.environment,url:n})},this.sendSlackNotification=async e=>{if(!ve.default.checkGate({gateName:"slack_action_enabled_on_button_automation"}))return{value:void 0};const t=this.clientContext.automationStore.getModel();if(!t)return{error:new E.Do({actionId:e.actionPointer.id,pointer:{id:this.clientContext.automationStore.id,table:$.cv}})};const o=e.author;if(!o)return{error:new E.mK({actionId:e.actionPointer.id,pointer:o})};const n=e.config;if(!n||null==n||!n.external_bot_id||!n.target)return{error:new E.Qq({actionId:e.actionPointer.id,missingConfigKey:n?n.target?"external_bot_id":"target":"config"})};(0,a.dw)((0,C.mc)(this.environment),{type:this.clientContext.type});const i=this.saveTransactionInfos,r=F({typedAutomationExecutionSummary:N({saveTransactionInfos:i,parentRecordStore:this.clientContext.parentRecordStore}),numBlocksDuplicated:this.getNumBlocksDuplicated(),intl:this.clientContext.intl}),s=await R({saveTransactionInfos:i,clientContext:this.clientContext}),l=null==s?void 0:s.getSpaceShardedPointer();let c;var u;"button_property"!==this.clientContext.type&&"button_block"!==this.clientContext.type||(c=null===(u=this.clientContext.pageStore)||void 0===u?void 0:u.getSpaceShardedPointer());if(!c)return{error:new E.L({actionId:e.actionPointer.id,contextValueId:"pagePointer"})};const d={spaceId:t.getSpaceId(),slackActionConfig:n,authorPointer:o,slackMessageTextToBeSent:r,blockToOpenPointer:l,pagePointer:c,actionPointer:e.actionPointer},p=await te.handleSlackNotificationActionForButtonAutomation(this.environment,d);return"failed"===p.type?{error:new E.XJ({actionId:e.actionPointer.id,message:"Failure in execution of the handleSlackNotificationActionForButtonAutomation endpoint",cause:p.error})}:{value:void 0}},this.duplicateBlockChildren=async e=>{if("button_block"!==this.clientContext.type)return{error:new E.iR({contextType:this.clientContext.type})};const t=this.clientContext.blockStore,o=t.getRecordStoreUIParent();if(!o)return{value:{}};const n={};let i;"before"===e.insertionPoint?i=!0:"after"===e.insertionPoint?i=!1:(0,l.t1)(e.insertionPoint);const r=_.G.createChildStore(o,e.blockPointer);await r.load();const a=r.getContentStores();i||a.reverse();const s=fe.C.findSelectableFromStore(t),c=[],u=this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.duplicateBlockChildren",environment:this.environment,perform:e=>{const o=a.map((o=>{const[n,r]=ne.Qi({environment:this.environment,stores:[o],transaction:e,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!0,targetSpaceId:(0,q.C)(o.pointer.spaceId),baseUrl:S.default.domainBaseUrl,publicDomainName:S.default.publicDomainName,preferDuplicateLocation:"local",analyticsFrom:"button_automation",useCrdt:t.useCrdt()}),a=n[0];return s&&(i?s.props.onInsertAbove&&c.push(s.props.onInsertAbove({insertStores:[a],transaction:e})[0]):s.props.onInsertBelow&&c.push(s.props.onInsertBelow({insertStores:[a],transaction:e})[0])),{copy:a,onComplete:r}}));return T.aggregateActionStats(n,{transactionIds:[e.id]}),o}}).performResult;return i||c.reverse(),ce.Z5({environment:this.environment,stores:c}),await X.Lc(u,10,(e=>e.onComplete)),D.default.afterNextFlush((()=>{for(const e of c){if(ie.dM({environment:this.environment,isAtStartOfLine:!1,store:e}))break}})),this.numBlocksDuplicated+=c.length,T.aggregateActionStats(n,{blocksCreated:this.getNumBlocksDuplicated()}),{value:{stats:n}}},this.displayModal=async e=>{Se.Z.setState({open:!0,format:e.format,recordStore:this.clientContext.parentRecordStore}),await Se.Z.waitUntil((()=>!Se.Z.state.open));const t=Se.Z.state;let o;return t.open||(o=t.result),o=o??"continue",{value:{result:o}}},this.initializeTemplateInDatabase=async e=>{const t=this.clientContext.parentRecordStore,o={},n=_.G.createChildStore(t,{table:K.iU,id:e.templateId});await n.load();const i=_.NW.createChildStore(t,e.collection),r=(0,ye.TS)({environment:this.environment,table:K.iU,spaceId:i.pointer.spaceId}),{performResult:a}=this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.initializeTemplateInDatabase",environment:this.environment,perform:a=>{const s=se.j4({environment:this.environment,transaction:a,inMemoryRecordCache:t.inMemoryRecordCache,type:H.Ti.page,id:r,useCrdt:e.useCrdt});return re.zw({parentStore:i,childStore:s,transaction:a}),oe.ob({environment:this.environment,store:s,transaction:a,templateStore:n,title:"template",isCreateIn:!1,isKeyboard:!1,from:"automation_actions"}),ge.b({environment:this.environment,store:s,properties:e.propertyUpdates,transaction:a}),T.aggregateActionStats(o,{transactionIds:[a.id]}),s}});return this.saveTransactionInfos.push({type:"create_page",pageId:r,collection:e.collection}),await a.load(),a.isDefined()?{value:{pageId:r,pageModel:a.getModel(),stats:o}}:{error:new E.Do({actionId:e.actionId,pointer:a.pointer})}},this.sendInAppNotification=e=>{throw new Error("Not supported on the client")},this.updateLastExecutedTime=async e=>{const t=this.clientContext.parentRecordStore,o=_.Mz.createChildStore(t,e);return this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.updateLastExecutedTime",environment:this.environment,perform:e=>{se.sW({data:{last_executed_time:Date.now()},store:o,transaction:e})}}),Promise.resolve({value:void 0})},this.environment=e.environment,this.clientContext=e.clientContext,this.automationModel=e.automationModel,this.undoCheckpointName=`execute-client-automation-${U.Il()}`}getNumBlocksDuplicated(){return this.numBlocksDuplicated}createAndCommitForEffect(e){return ue.createAndCommit({...e,undoCheckpoint:this.undoCheckpointName})}}async function Ae(e){const{clientContext:t,environment:o,onUndo:n,store:S}=e,j=await b.FF.formulas.load();await t.automationStore.load();const A=t.automationStore.getModel();if(!A)return;const P=t.automationStore.getActionStores().map((e=>e.getModel())).filter(l.$K),w=A.getTriggerType();if("event"===w)return;const V=(0,C.mc)(o),I=(0,M.zt)();(0,a.rg)(V,{actions:P.map((e=>e.getType())),automation_id:A.id,block_id:S.id,context_type:t.type,space_id:A.getSpaceId(),subscription_tier:I,trigger:w});const Z=new Te({automationModel:A,clientContext:t,environment:o}),B=(0,p.yf)(t.parentRecordStore.getRecordModel,t.parentRecordStore.loadRecordModel),K=o.currentUser.id;let _;"button_property"===t.type?_=(0,d.dG)({blockPointer:S.getSpaceShardedPointer(),currentUserId:K,userTimeZone:(0,g.r)(),createdById:void 0}):"button_block"===t.type?_=(0,d.io)({currentUserId:K,userTimeZone:(0,g.r)(),pagePointer:t.pageStore.pointer}):"event"===t.type?_=(0,d.R4)({blockPointer:S.getSpaceShardedPointer(),currentUserId:K,userTimeZone:(0,g.r)(),createdById:void 0}):"recurrence"===t.type?"completeSprint"===t.recurrence.type?_=(0,d.NG)({completeSprintActionType:t.recurrence.completeSprintActionType,nextSprintDateRange:t.recurrence.nextSprintDateRange}):"default"===t.recurrence.type?_=(0,d.W7)():(0,l.t1)(t.recurrence):"assistant"===t.type?_={values:[]}:(0,l.t1)(t);const D=T.create(A.pointer,"client"),L={automationModel:A,actionModels:P,values:_.values,executeEffectMap:Z,executeContextualFormula:async(e,o)=>{if(!o)return{value:{type:"undefined"}};return await j.executeFormulaAsync(o,{values:e.values,handleDataRequest:B,userTimeZone:(0,g.r)(),intl:t.intl,depth:0,visitedProperties:new Set,resultCache:new Map})},handleDataRequest:B,loadRecordModel:t.parentRecordStore.loadRecordModel,userTimeZone:(0,g.r)(),intl:t.intl,depth:0,visitedProperties:new Set,resultCache:new Map,eventTracker:(0,C.mc)(o),runtimeRecordPointerSet:new h.X,runtimeStats:D,spaceIdCreator:await o.idCreator.getSpaceIdCreator(A.getSpaceId()),useCrdtDefault:()=>v.dy({source:"automation_action"})};K&&(L.author={id:K,table:y.KJ,spaceId:A.getSpaceId()});const O=await async function(e){const{context:t,executeAutomationActionFn:o}=e,{actionModels:n,runtimeStats:i}=t;let r=t.values;const a=performance.now(),d=o??u;let p;for(const l of n){const e=await d({action:l,values:r,executionContext:t});if(s.x.isFail(e)){p=e.error;break}r=r.concat(e.value.values)}const m=await t.executeEffectMap.updateLastExecutedTime(t.automationModel.pointer);s.x.isFail(m)&&(p=m.error);const g=Math.trunc(performance.now()-a);return i&&(i.executionStartTime=a,i.executionDurationMs=g,i.executionSuccess=!(0,l.$K)(p),c.Fv.aggregate(i)),p}({context:L});T.logNotionPerformance({automationStats:D,environment:o});const W=o.currentUser.id?{id:o.currentUser.id,table:"notion_user"}:void 0,E={automationContextType:t.type,automationId:A.id,automationRuntime:D,spaceId:A.getSpaceId(),userId:null==W?void 0:W.id};if(O){0,m.log({actor:W,data:E,error:O,from:"automationActions",level:"error",type:"AutomationExecutionError"}),(0,a.By)(V,{automation_id:A.id,block_id:S.id,context_type:t.type,error_type:O.type,execution_duration_ms:D.executionDurationMs,subscription_tier:I,trigger:w});const e=function(e){if("user_cancelled"===e.type)return i.messages.errorUserCancelled;if("query_collection_too_many_items"===e.type)return i.messages.errorQueryCollectionTooManyPages;if("record_pointer_in_trash"===e.type)return i.messages.errorRecordInTrash;return i.messages.genericErrorMessage}(O),o=k.default.formatMessage(e);x.oV({label:o})}else(0,a.Cz)(V,{automation_id:A.id,block_id:S.id,context_type:t.type,execution_duration_ms:D.executionDurationMs,subscription_tier:I,trigger:w}),m.log({actor:W,data:E,from:"automationActions",level:"info",type:"AutomationExecutionSuccess"}),function(e){if(e.some((e=>Pe.has(e.type))))return!1;return!e.every((e=>!(0,r.z)(e.type).hasSideEffects))}(P)&&await async function(e){const{actionModels:t,environment:o,saveTransactionInfos:n,clientContext:i,undoCheckpointName:a,numBlocksDuplicated:s,onUndo:l}=e,c=N({saveTransactionInfos:n,parentRecordStore:i.parentRecordStore}),u=F({typedAutomationExecutionSummary:c,numBlocksDuplicated:s,intl:i.intl}),d=await R({saveTransactionInfos:n,clientContext:i}),p=function(e){let t;for(const o of e){const e=(0,r.z)(o.type);if(!1===e.invertible)return!1;!0===e.invertible&&(t=!0)}return t}(t),m=!0===p&&f.hv(a)?()=>{f.qB({environment:o,namedRevisionId:a}),x.rN(),l&&l(a)}:void 0;x.d8({blockToOpenStore:d,item:{label:u},performUndo:m})}({actionModels:P,clientContext:t,environment:o,numBlocksDuplicated:Z.getNumBlocksDuplicated(),onUndo:n,saveTransactionInfos:Z.saveTransactionInfos,undoCheckpointName:Z.undoCheckpointName})}const Pe=new Set(["assistant","assistant_basic"]);var we=o(667294),Ve=o(800480),Ie=o(886628),Fe=o(724405),Ze=o(665955),Be=o(627153),Ke=o(898104),_e=o(668709),Re=o(573063),Ne=o(953437),De=o(158297),Le=o(731278),Oe=o(953336),We=o(526388),Ee=o(213148),He=o(745238),Ue=o(785893);const ze=(0,He.IU)("starFilled",{viewBox:"0 0 24 24",svg:(0,Ue.jsx)("path",{d:"M4.603 22.837c.375.277.826.2 1.4-.22l6.002-4.411 6.003 4.41c.561.42 1.024.498 1.387.221.375-.276.463-.73.232-1.403l-2.346-7.075 6.047-4.366c.572-.41.77-.83.627-1.271-.143-.432-.55-.653-1.255-.653l-7.424.045-2.269-7.108C12.787.32 12.457 0 12.005 0c-.463 0-.782.32-1.002 1.006l-2.27 7.108-7.423-.045c-.716 0-1.123.221-1.266.653-.144.442.066.862.638 1.27l6.036 4.367-2.335 7.075c-.231.674-.143 1.127.22 1.403z"})});var $e=o(137810),Ge=o(942402);const qe="https://www.notion.so/help/template-buttons";function Ye(e){const{handleDismissBanner:t}=e,o=(0,Fe.yK)((e=>({banner:{width:"100%",display:"flex",alignItems:"start",backgroundColor:e.accentColors.blue["light"===e.mode?50:300],borderRadius:4,padding:12,fontSize:12,lineHeight:1.5,gap:8},icon:{width:12,color:e.blueColor},bannerContent:{flex:"1 1 auto"},bannerTitle:{fontWeight:$e.Z.fontWeight.medium},bannerCaption:{color:e.mediumTextColor},closeButton:{borderRadius:"50%"},starIcon:{flex:"0 0 auto",marginBlockStart:3},link:{color:e.text.uiBluePrimary}})),[]);return(0,Ue.jsxs)("div",{style:o.banner,children:[(0,Ue.jsx)("div",{style:o.starIcon,children:ze(o.icon)}),(0,Ue.jsxs)("div",{style:o.bannerContent,children:[(0,Ue.jsx)("div",{style:o.bannerTitle,children:(0,Ue.jsx)(P.FormattedMessage,{id:"factoryButton.deprecationBanner.title",defaultMessage:"Your buttons just got better"})}),(0,Ue.jsx)("div",{style:o.bannerCaption,children:(0,Ue.jsx)(P.FormattedMessage,{id:"factoryButton.deprecationBanner.caption",defaultMessage:"Now you can create, edit and open pages and <buttonsHelpCenterLink>more</buttonsHelpCenterLink>.",values:{buttonsHelpCenterLink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,Ue.jsx)(Ge.Z,{href:qe,disableUnderline:!0,style:o.link,children:t})}}})})]}),(0,Ue.jsx)(Re.Z,{icon:Ee.U,ariaLabel:"closeButton",style:o.closeButton,onClick:()=>t()})]})}var Qe=o(159557),Xe=o(938530),Je=o(212534),et=o(98742),tt=o(135314),ot=o(563474),nt=o(434859),it=o(168910),rt=o(409015),at=o(435294),st=o(417501),lt=o(74404),ct=o(819471),ut=o(67473),dt=o(747453),pt=o(552275),mt=o(231945),gt=o(279131),ht=o(932130),yt=o(61766),ft=o(245452),xt=o(312455),St=o(73266),vt=o(161927),bt=o(838862),Ct=o(478140),kt=o(632163),Mt=o(672495),jt=o(672865),Tt=o(521273),At=o(595193),Pt=o(200745),wt=o(140190),Vt=o(847957);const It=(0,P.defineMessages)({codeLabel:{defaultMessage:"Code",id:"automations.AssistantAction.codeLabel"},promptLabel:{defaultMessage:"Prompt",id:"automations.AssistantAction.promptLabel"},humanLabel:{defaultMessage:"User",id:"automations.AssistantAction.humanLabel"},descriptionLabel:{defaultMessage:"Description",id:"automations.AssistantAction.descriptionLabel"}});function Ft(e){const{currentOption:t,disabled:o,onChange:n}=e,i=(0,P.useIntl)(),r=(0,at.d)(),a=(0,Ie.qz)(void 0,yt.Z),s=(0,we.useCallback)((e=>{n&&e!==t&&n(e),a.setState({open:!1})}),[a,t,n]);return(0,Ue.jsx)(mt.ZP,{alignmentToOrigin:mt.vR.End,buttonPopupStore:a,disabled:o,originGap:0,placementToOrigin:mt.pO.Bottom,popupType:r,render:()=>(0,Ue.jsx)(Zt,{currentOption:t,onChange:s}),renderOrigin:e=>(0,Ue.jsx)(wt.S,{...e,disabled:o,children:i.formatMessage(Bt(t))})})}function Zt(e){const{currentOption:t,onChange:o}=e,n=(0,P.useIntl)(),i=(0,At.F)({maxWidth:360}),r=["prompt","code"].map((e=>({key:e,render:o=>(0,Ue.jsx)(pt.Z,{...o,checkState:t===e,title:n.formatMessage(Bt(e))}),action:()=>null==o?void 0:o(e)})));return(0,Ue.jsx)(Ct.Z,{...i,children:(0,Ue.jsx)(kt.Z,{initialFocus:0,sections:[{key:0,render:e=>(0,Ue.jsx)(Mt.Z,{enableActionSheetTitle:!0,...e}),items:r}],type:kt.i.Vertical})})}function Bt(e){switch(e){case"code":return It.codeLabel;case"prompt":return It.promptLabel;case"human":return It.humanLabel}}function Kt(e){const{actionStore:t,disabled:o,value:n,onChange:i}=e,a=(0,Ie.VK)((()=>t.getType()),[t]),s=(0,Fe.yK)((()=>({actionTitle:{display:"flex",gap:"0.5em",alignItems:"center",height:"24px"}})),[]);if(!a)return null;const l=(0,r.z)(a);return(0,Ue.jsxs)("div",{style:s.actionTitle,children:[(0,Ue.jsx)(P.FormattedMessage,{...l.display.name}),(0,Ue.jsx)(Ft,{currentOption:n,disabled:o,onChange:i})]})}var _t=o(51592),Rt=o(241301);function Nt(e){return!e.pathIsDead()&&e.isDefined()}function Dt(e){if(!(0,l.$K)(e))return[];return e.getTemplatePageStores().filter((e=>Nt(e)))}var Lt=o(839477),Ot=o(984619),Wt=o(776798),Et=o(721396),Ht=o(808808);function Ut(e){const{actionStore:t,currentValue:o,contextStore:n,onChange:i,disabled:r,errorMessage:a,skipVariables:s}=e,l=(0,Ie.qz)(void 0,yt.Z),c=(0,Ie.VK)((()=>o&&"collection"===o.type?_.NW.createChildStore(n.context.parentRecordStore,o.collection):void 0),[o,n.context.parentRecordStore]),u=(0,Ie.VK)((()=>{if(t&&o&&"variable"===o.type)return n.getContextValueForActionById(t.id,o.id)}),[t,o,n]),d=(0,we.useCallback)((e=>{"collection"!==e.type&&"variable"!==e.type||(i(e),l.reset())}),[i,l]),p=(0,we.useCallback)((()=>l.reset()),[l]),m=(0,at.d)(),g=Boolean(c||u);return(0,Ue.jsx)(mt.ZP,{buttonPopupStore:l,popupType:m,alignmentToOrigin:mt.vR.End,placementToOrigin:mt.pO.Bottom,originGap:0,disabled:r,renderOrigin:e=>(0,Ue.jsx)(wt.S,{...e,disabled:r,isCompact:!0,isError:Boolean(a),hasActionRequired:!g,tooltipMessage:a,children:c?(0,Ue.jsx)(Wt.Z,{store:c}):u?(0,Ue.jsx)(Et.Fg,{format:Ot.lo.Medium,isSingle:!0,value:u}):(0,Ue.jsx)(P.FormattedMessage,{id:"automations.databasePicker.buttonPlaceholder",defaultMessage:"Select database"})}),render:e=>(0,Ue.jsx)(Ht.L,{actionId:null==t?void 0:t.id,automationContextStore:n,onChange:d,onClose:p,selectedTarget:o,skipPages:!0,skipVariables:s})})}var zt=o(653965),$t=o(240071);function Gt(e){const{collectionStore:t,currentTemplateId:o,onChange:n,disabled:i,errorMessage:r}=e,a=(0,Ve.O7)(),{device:s}=a,l=(0,Ie.VK)((()=>{if(!t)return;if(o){const e=_.G.createChildStore(t,{id:o,spaceId:t.getSpaceId(),table:K.iU});if(!e.pathIsDead())return e}const e=t.getDefaultTemplatePageStore();return e&&!e.pathIsDead()?e:void 0}),[t,o]),c=(0,at.d)(),u=(0,Ie.VK)((()=>Dt(t)),[t]),d=Boolean(o);return(0,Ue.jsx)(mt.ZP,{popupType:c,alignmentToOrigin:mt.vR.End,placementToOrigin:mt.pO.Bottom,originGap:0,disabled:i,renderOrigin:e=>(0,Ue.jsx)(wt.S,{...e,disabled:i,isCompact:!0,isError:Boolean(r),style:{minWidth:50},tooltipMessage:r,children:l&&(d||Nt(l))?(0,Ue.jsx)(Wt.Z,{store:l}):(0,Ue.jsx)(P.FormattedMessage,{id:"automations.templatePicker.buttonPlaceholder",defaultMessage:"Empty"})}),render:e=>{const o=(0,At.U)({device:s,width:280});return(0,Ue.jsx)(Ct.Z,{...o,children:t&&(0,Ue.jsx)(qt,{collectionStore:t,templatePageStores:u,parent:e,onChange:n})})}})}function qt(e){const{collectionStore:t,templatePageStores:o,parent:n,onChange:i}=e,r=(0,Ve.O7)(),{device:a}=r,s=(0,Ie.VK)((()=>t.getDefaultTemplatePageStore()),[t]),l=o.map((e=>{const o={key:e.id,render:o=>(0,we.createElement)($t.Z,{...o,key:e.id,isOverlay:!0,collectionStore:t,canConfigureCollection:!1,templateStore:e,isMobile:a.isMobile,locked:!0,isDefault:s===e,onCancelClick:()=>{},draggable:!1}),action:t=>{i(e.id),n.close()}};return o})),c={key:"empty",render:e=>(0,we.createElement)($t.Z,{...e,key:"empty",isOverlay:!0,collectionStore:t,canConfigureCollection:!1,templateStore:void 0,isMobile:a.isMobile,locked:!0,onCancelClick:()=>{},draggable:!1}),action:e=>{i(void 0),n.close()}};return(0,Ue.jsx)(kt.Z,{type:kt.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,Ue.jsx)(Mt.Z,{...e,title:(0,Ue.jsx)(P.FormattedMessage,{id:"automations.templatePicker.menuHeader",defaultMessage:"Select a template"})}),items:zt.oA([...l,s?void 0:c])}]})}function Yt(e){const{actionStore:t,automationContextStore:o,disabled:n,errorMessage:i,onChange:r,value:a}=e,s=(0,Fe.yK)((()=>({b:{fontWeight:$e.Z.fontWeight.medium},picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50}})),[]),l=(0,Ie.VK)((()=>{let e;if("collection"===(null==a?void 0:a.type)){const o=t.getRecordModel(a.collection);e=null==o?void 0:o.getDatabaseType()}return(0,_t.sN)(e)}),[t,a]);return(0,Ue.jsxs)("div",{style:s.title,children:[(0,Ue.jsx)(P.FormattedMessage,{defaultMessage:"<span>Add <b>{itemType}</b> to </span>{collectionPicker}",id:"automations.CreatePageActionV2.header.title",values:{b:e=>(0,Ue.jsx)("b",{style:s.b,children:e}),collectionPicker:(0,Ue.jsx)("div",{style:s.picker,children:(0,Ue.jsx)(Ut,{actionStore:t,contextStore:o,currentValue:a,disabled:n,errorMessage:i,onChange:r,skipVariables:!0})}),itemType:l,span:e=>(0,Ue.jsx)("span",{style:s.span,children:e})}})," "]})}function Qt(e){const{collectionStore:t,disabled:o,errorMessage:n,onChange:i,value:r}=e,a=(0,Fe.yK)((()=>({picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50}})),[]);return(0,Ue.jsx)("div",{style:a.title,children:(0,Ue.jsx)(P.FormattedMessage,{defaultMessage:"<span>as </span>{collectionTemplatePicker}",id:"automations.CreatePageActionV2.header.template",values:{collectionTemplatePicker:(0,Ue.jsx)(Gt,{collectionStore:t,currentTemplateId:r,disabled:o,errorMessage:n,onChange:i}),span:e=>(0,Ue.jsx)("span",{style:a.span,children:e})}})})}var Xt=o(294184),Jt=o.n(Xt),eo=o(701230),to=o(241490),oo=o(215201),no=o(955217),io=o(279954);const ro=(0,P.defineMessages)({aboveMenuItemLabel:{id:"automations.DuplicateBlocksAction.aboveButtonLabel",defaultMessage:"Above button"},aboveTitle:{id:"automations.DuplicateBlocksAction.aboveTitle",defaultMessage:"above button"},belowMenuItemLabel:{id:"automations.DuplicateBlocksAction.belowButtonLabel",defaultMessage:"Below button"},belowTitle:{id:"automations.DuplicateBlocksAction.belowTitle",defaultMessage:"below button"},title:{defaultMessage:"Insert blocks {insertionPicker}",id:"automations.DuplicateBlocksAction.title"}}),ao={before:{icon:(0,to.F)({width:16}),key:"before",menuItemLabel:ro.aboveMenuItemLabel,title:ro.aboveTitle},after:{icon:(0,eo.H)({width:16}),key:"after",menuItemLabel:ro.belowMenuItemLabel,title:ro.belowTitle}},so=ao.after;function lo(e){const{currentOption:t,disabled:o,onChange:n}=e,i=(0,P.useIntl)(),r=(0,at.d)(),a=(0,Ie.qz)(void 0,yt.Z),s=(0,we.useCallback)((e=>{n&&t.key!==e&&n(e),a.setState({open:!1})}),[a,t,n]);return(0,Ue.jsx)(mt.ZP,{alignmentToOrigin:mt.vR.End,buttonPopupStore:a,disabled:o,originGap:0,placementToOrigin:mt.pO.Bottom,popupType:r,render:()=>(0,Ue.jsx)(co,{currentOption:t,onChange:s}),renderOrigin:e=>(0,Ue.jsx)(wt.S,{...e,disabled:o,isCompact:!0,children:i.formatMessage(t.title)})})}function co(e){const{currentOption:t,onChange:o}=e,n=(0,P.useIntl)(),i=(0,At.F)({maxWidth:360}),r=Object.values(ao).map((e=>({key:e.key,render:o=>(0,Ue.jsx)(pt.Z,{...o,checkState:t.key===e.key,icon:e.icon,title:n.formatMessage(e.menuItemLabel)}),action:()=>o(e.key)})));return(0,Ue.jsx)(Ct.Z,{...i,children:(0,Ue.jsx)(kt.Z,{initialFocus:0,sections:[{key:0,render:e=>(0,Ue.jsx)(Mt.Z,{enableActionSheetTitle:!0,...e}),items:r}],type:kt.i.Vertical})})}function uo(e){const{actionStore:t,disabled:o,contentParentPointer:n,buttonPlacement:r}=e,a=(0,Ve.O7)(),s=(0,Fe.yK)((e=>({listWrap:{background:e.contentBackground,borderRadius:5,boxShadow:e.inputBoxShadow,fontSize:14,minHeight:64,paddingBlock:3,paddingInline:10,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},emptyPlaceholder:{caretColor:e.mediumTextColor,color:e.lightTextColor,fontSize:14,padding:"5px 0",display:"inline-block"}})),[]),l=(0,Ie.VK)((()=>_.G.createChildStore(t,n)),[t,n]),c=(0,Ie.VK)((()=>l.getContentStore()),[l]),u=(0,we.useCallback)((e=>{(0,Je.ZP)({event:e,context:Je.Af.EditorClick,callback:()=>{if(!c)return;(c.getValue()||[]).length>0||ue.createAndCommit({userAction:"DuplicateBlocksAction.handleListClick",environment:a,perform:e=>{i.insertEmptyTextInDuplicateBlockAction({environment:a,parentStore:c,transaction:e})}})}})}),[a,c]);if(!c)return null;const d="inline"===(null==r?void 0:r.type);return(0,Ue.jsx)(Ue.Fragment,{children:(0,Ue.jsx)(io.Z,{store:l,analyticsName:"duplicate_blocks_action",isListContainer:!0,children:(0,Ue.jsx)(_e.p,{allowSelectionWithin:!0,children:(0,Ue.jsx)("div",{style:s.listWrap,onClick:u,className:Jt().focusableWithin,children:(0,Ue.jsx)(oo.O,{displayName:"DuplicateBlocksActionContent",disabled:o,children:(0,Ue.jsx)(no.Z,{disabled:o,store:c,emptyPlaceholder:(0,Ue.jsx)("div",{style:s.emptyPlaceholder,children:d?(0,Ue.jsx)(P.FormattedMessage,{id:"automations.DuplicateBlocksAction.emptyPlaceholder",defaultMessage:"Click to edit or drop blocks here…"}):(0,Ue.jsx)(P.FormattedMessage,{id:"automations.DuplicateBlocksAction.emptyCannotDropPlaceholder",defaultMessage:"Click to edit blocks here…"})}),disableCommentMenu:!0,disableHoverMenu:!1,disableDrag:!1})})})})})})}const po=(0,P.defineMessages)({confirmationMessageLabel:{defaultMessage:"Confirmation message",id:"automations.BaseModalAction.confirmationMessageLabel"},continueButtonTextLabel:{defaultMessage:"Continue button text",id:"automations.BaseModalAction.continueButtonTextLabel"},cancelButtonTextLabel:{defaultMessage:"Cancel button text",id:"automations.BaseModalAction.cancelButtonTextLabel"}});var mo=o(733732);function go(e){const{contextStore:t,actionStore:o,target:n,onChange:i,disabled:r,errorMessage:a}=e,s=(0,Ie.qz)(void 0,yt.Z),l=(0,Ie.VK)((()=>{if(n&&"variable"===n.type)return t.getContextValueForActionById(o.id,n.id)}),[n,t,o.id]),c=(0,at.d)(),u=(0,we.useCallback)((e=>{"page"!==e.type&&"variable"!==e.type||(i(e),s.reset())}),[i,s]),d=(0,we.useCallback)((()=>s.reset()),[s]);return(0,Ue.jsx)(mt.ZP,{buttonPopupStore:s,popupType:c,alignmentToOrigin:mt.vR.End,placementToOrigin:mt.pO.Bottom,originGap:0,disabled:r,renderOrigin:e=>(0,Ue.jsx)(wt.S,{...e,disabled:r,isCompact:!0,isError:Boolean(a),hasActionRequired:!Boolean(n),tooltipMessage:a,children:n&&"page"===n.type?(0,Ue.jsx)(Wt.Z,{store:_.G.createChildStore(t.context.parentRecordStore,n.page)}):l?(0,Ue.jsx)(Et.Fg,{value:l,format:Ot.lo.Medium,isSingle:!0}):(0,Ue.jsx)(P.FormattedMessage,{id:"automations.AutomationPagePicker.pagesDropdown.label",defaultMessage:"Select page"})}),render:e=>(0,Ue.jsx)(Ht.L,{actionId:o.id,automationContextStore:t,onChange:u,onClose:d,selectedTarget:n,skipCollections:!0})})}function ho(e){const{actionStore:t,automationContextStore:o,disabled:n,errorMessage:i,onChange:r,value:a}=e,s=(0,Fe.yK)((()=>({picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50}})),[]);return(0,Ue.jsxs)("div",{style:s.title,children:[(0,Ue.jsx)(P.FormattedMessage,{defaultMessage:"<span>Open </span>{pagePicker}",id:"automations.OpenPageAction.action.title",values:{pagePicker:(0,Ue.jsx)("div",{style:s.picker,children:(0,Ue.jsx)(go,{actionStore:t,contextStore:o,disabled:n,errorMessage:i,onChange:r,target:a})}),span:e=>(0,Ue.jsx)("span",{style:s.span,children:e})}})," "]})}function yo(e){const{actionStore:t,disabled:o,onChange:n}=e,i=(0,Fe.yK)((()=>({picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50}})),[]),r=(0,Ie.VK)((()=>t.getOpenPageIn()),[t]);return(0,Ue.jsx)("div",{style:i.title,children:(0,Ue.jsx)(P.FormattedMessage,{defaultMessage:"<span>in </span>{peekModePicker}",id:"automations.OpenPageAction.peekMode.title",values:{peekModePicker:(0,Ue.jsx)("div",{style:i.picker,children:(0,Ue.jsx)(fo,{disabled:o,onChange:n,value:r})}),span:e=>(0,Ue.jsx)("span",{style:i.span,children:e})}})})}function fo(e){const{disabled:t,onChange:o,value:n}=e,i=(0,Fe.Fg)(),r=(0,Ie.qz)(void 0,yt.Z),a=(0,Ie.VK)((()=>(0,mo.v)({currentViewType:void 0,theme:i}).find((e=>e.key===n))),[n,i]),s=(0,we.useCallback)((()=>r.reset()),[r]),l=(0,we.useCallback)((e=>{e!==(null==a?void 0:a.key)&&o(e),s()}),[s,null==a?void 0:a.key,o]),c=(0,at.d)();return a?(0,Ue.jsx)(mt.ZP,{alignmentToOrigin:mt.vR.End,buttonPopupStore:r,disabled:t,originGap:0,placementToOrigin:mt.pO.Bottom,popupType:c,renderOrigin:e=>(0,Ue.jsx)(wt.S,{...e,disabled:t,isCompact:!0,children:a.title}),render:e=>(0,Ue.jsx)(xo,{onChange:l,value:n})}):null}function xo(e){const{onChange:t,value:o}=e,n=(0,Fe.Fg)(),i=(0,Fe.yK)((()=>({menuItem:{paddingBlock:8}})),[]),r=(0,At.F)({maxWidth:360,width:280}),a=(0,Ie.VK)((()=>(0,mo.v)({currentViewType:void 0,theme:n}).map(((e,n)=>({action:()=>t(e.key),key:n,render:t=>(0,Ue.jsx)(pt.Z,{...t,body:e.body,caption:e.caption,checkState:o===e.key,disabled:!1,icon:e.icon,style:i.menuItem,title:e.title})})))),[t,i.menuItem,n,o]),s=[{key:0,render:e=>(0,Ue.jsx)(Mt.Z,{enableActionSheetTitle:!0,...e}),items:a}];return(0,Ue.jsx)(Ct.Z,{...r,children:(0,Ue.jsx)(kt.Z,{initialFocus:0,sections:s,type:kt.i.Vertical})})}var So=o(603865),vo=o(761586),bo=o(25742),Co=o(460709);const ko=(0,P.defineMessages)({defaultMenuHeader:{defaultMessage:"Select people",id:"automationPersonPicker.defaultMenuHeaderMessage"},personValuePickerPlaceholder:{defaultMessage:"Select up to {maxSelected} people...",id:"automations.personPicker.buttonPlaceholder"}});function Mo(e){const{currentValue:t,contextStore:o,collectionStore:n,disabled:i,onChange:r,formulaTypecheckContextValues:a,menuHeader:s,limit:l,errorMessage:c}=e,u={type:"person_array"},d=(0,P.useIntl)(),p={type:"collection",collectionStore:n,property:"person"},m={menuType:Co.og.Popup,header:(0,Ue.jsx)(Mt.Z,{style:{paddingBottom:0},title:s?d.formatMessage(s):d.formatMessage(ko.defaultMenuHeader)})};return(0,Ue.jsx)(vo.Z,{formulaTypecheckContextValues:a,disabled:i,contextStore:o,context:p,onChange:r,type:u,value:t,menuProps:m,placeholder:l?d.formatMessage(ko.personValuePickerPlaceholder,{maxSelected:l}):void 0,limit:l,errorMessage:c})}var jo=o(332157);const To=(0,P.defineMessages)({property:{id:"automationAction.sendInAppNotification.targetType.property",defaultMessage:"Person property"},formula:{id:"automationAction.sendInAppNotification.targetType.formula",defaultMessage:"Specific people"},default:{id:"automations.targetPicker.targetTypePlaceholder",defaultMessage:"Select recipients"}});function Ao(e){const{disabled:t,errorMessage:o,selectedTargetType:n,onSelectedTargetTypeChange:i}=e,r=(0,Ie.qz)(void 0,yt.Z),a=(0,at.d)(),s=(0,we.useCallback)((e=>{e!==n&&(i(e),r.reset())}),[i,r,n]);return(0,Ue.jsx)("div",{children:(0,Ue.jsx)(mt.ZP,{buttonPopupStore:r,popupType:a,alignmentToOrigin:mt.vR.End,placementToOrigin:mt.pO.Bottom,originGap:0,disabled:t,renderOrigin:e=>(0,Ue.jsx)(wt.S,{...e,disabled:t,isCompact:!0,isError:Boolean(o),hasActionRequired:!Boolean(n),tooltipMessage:o,children:n?(0,Ue.jsx)(P.FormattedMessage,{...To[n]}):(0,Ue.jsx)(P.FormattedMessage,{...To.default})}),render:e=>(0,Ue.jsx)(Po,{handleChange:s,selectedTargetType:n})})})}function Po(e){const{handleChange:t}=e,o=(0,At.F)(),n=[(0,we.useMemo)((()=>({action:()=>null,key:"selectUsers",render:e=>(0,Ue.jsx)(pt.Z,{...e,onClick:()=>t("formula"),title:(0,Ue.jsx)(P.FormattedMessage,{...To.formula})})})),[t]),(0,we.useMemo)((()=>({action:()=>null,key:"selectPersonProperty",render:e=>(0,Ue.jsx)(pt.Z,{...e,onClick:()=>t("property"),title:(0,Ue.jsx)(P.FormattedMessage,{...To.property})})})),[t])].filter(l.$K);if(0===n.length)return null;const i={items:n,key:"targetType",render:e=>(0,Ue.jsx)(Mt.Z,{topBorder:!0,...e,enableActionSheetTitle:!0})};return(0,Ue.jsx)(Ct.Z,{...o,children:(0,Ue.jsx)(kt.Z,{type:kt.i.Vertical,sections:[i],initialFocus:0})})}const wo=(0,P.defineMessages)({notificationMessageLabel:{defaultMessage:"Message",id:"automations.BaseModalAction.notificationMessageLabel"},personPropertyTargetTypeLabel:{defaultMessage:"Property",id:"automations.SendInAppNotificationAction.personPropertyTargetTypeLabel"},usersTargetTypeLabel:{defaultMessage:"People",id:"automations.SendInAppNotificationAction.usersTargetTypeLabel"},propertyPickerPlaceholder:{defaultMessage:"Select a property",id:"automations.SendInAppNotificationAction.propertyPickerPlaceholder"},personValuePickerMenuHeader:{defaultMessage:"Send notification to",id:"automations.personPicker.menuHeader"}});function Vo(e){const{targetsErrorMessage:t,selectedTargetType:o,disabled:n,onTargetTypeChange:i}=e,r=(0,Fe.yK)((()=>({b:{fontWeight:$e.Z.fontWeight.medium},picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50,flexWrap:"wrap",gap:6}})),[]);return(0,Ue.jsxs)("div",{style:r.title,children:[(0,Ue.jsx)(P.FormattedMessage,{defaultMessage:"<span>Send <b>notification</b> to </span>{targetTypePicker}",id:"automations.SendInAppNotificationAction.header.title",values:{b:e=>(0,Ue.jsx)("b",{style:r.b,children:e}),span:e=>(0,Ue.jsx)("span",{style:r.span,children:e}),targetTypePicker:(0,Ue.jsx)("div",{style:r.picker,children:(0,Ue.jsx)(Ao,{onSelectedTargetTypeChange:i,disabled:n,errorMessage:t,selectedTargetType:o})})}})," "]})}function Io(e){const{isMobile:t,selectedTargetType:o}=e,n=(0,Fe.yK)((e=>({inputLabel:{color:e.lightTextColor,fontSize:t?14:12,lineHeight:1.3,fontWeight:$e.Z.fontWeight.medium}})),[t]),i=(0,Ie.VK)((()=>{switch(o){case"property":return wo.personPropertyTargetTypeLabel;case"formula":return wo.usersTargetTypeLabel;default:(0,l.t1)(o)}}),[o]);return(0,Ue.jsx)("label",{style:n.inputLabel,children:(0,Ue.jsx)(P.FormattedMessage,{...i})})}const Fo=20;function Zo(e){const{automationContextStore:t,collectionStore:o,disabled:n,formulaTypecheckContextValues:i,currentProperties:r,currentTargetValue:a,onTargetValueChange:s,errorMessage:c}=e,u=a.type;switch(u){case"formula":return(0,Ue.jsx)(Mo,{contextStore:t,collectionStore:o,currentValue:a.value,disabled:Boolean(n),onChange:e=>s({type:"formula",value:e}),formulaTypecheckContextValues:i,menuHeader:wo.personValuePickerMenuHeader,limit:Fo,errorMessage:c});case"property":return(0,Ue.jsx)(jo.X,{availablePropertyIds:r,currentValue:a.propertyId,collectionStore:o,onChange:e=>s({type:"property",propertyId:e}),disabled:Boolean(n),alreadyHaveProperties:Boolean(a.propertyId),placeholderMessage:wo.propertyPickerPlaceholder,errorMessage:c});default:(0,l.t1)(u)}}var Bo=o(280826);const Ko={create_page:function(e){const{actionStore:t}=e,{automationContextStore:o,disabled:n,maybePersistedTransactionActions:i,suppressActionErrors:a}=(0,xt.i)(),s=(0,r.z)("create_page"),[c,u]=(0,Ie.VK)((()=>{const e=t.getConfig();return[null==e?void 0:e.properties,null==e?void 0:e.values]}),[t]),[d,p]=(0,Ie.VK)((()=>{const e=t.getCollectionStore();return null!=e&&e.isDefined()?[e,{collection:e.getSpaceShardedPointer(),type:"collection"}]:[void 0,void 0]}),[t]),m=(0,Ie.VK)((()=>Dt(d).length>0),[d]),g=(0,Ie.VK)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.template_page_id}),[t]),h=(0,we.useMemo)((()=>({values:u??{},properties:c??[]})),[u,c]),y=(0,Ie.qz)(void 0,yt.Z),f=(0,we.useCallback)((()=>y.reset()),[y]),x=(0,we.useMemo)((()=>(0,Ue.jsx)(Pt.e,{actionStore:t,closeMenu:f})),[t,f]),S=(0,we.useCallback)((e=>{"collection"===e.type&&i.createAndCommit({perform:o=>{se.sW({data:{collection:e.collection,properties:["title"],template_page_id:null,values:null},store:t.getConfigStore(),transaction:o})},userAction:"CreatePageAction.setCollection"})}),[t,i]),v=(0,we.useCallback)((e=>{const{properties:o,values:n}=h;let r=!1;if(e&&o&&1===o.length&&o.includes("title")){var a;const e=null==n?void 0:n.title;e&&null!==(a=e.value)&&void 0!==a&&a.value||(r=!0)}i.createAndCommit({perform:o=>{se.sW({store:t.getConfigStore(),data:{template_page_id:e??null,...r&&{properties:[]}},transaction:o})},userAction:"CreatePageAction.onTemplateChange"})}),[t,i,h]),b=(0,we.useMemo)((()=>!a.includes(t.id)),[a,t]),C=(0,Rt.TU)({actionId:t.id,contextStore:o,errorKey:"collection",shouldShow:b}),k=(0,Rt.TU)({actionId:t.id,contextStore:o,errorKey:"template",shouldShow:b});if(!o)return null;const M=Boolean(n);return(0,Ue.jsxs)(Vt.Ao,{actionMenu:x,buttonPopupStore:y,disabled:M,children:[(0,Ue.jsxs)(Vt.vu,{actionRegistryItem:s,disabled:M,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",columnGap:"6px 0"}},children:[(0,Ue.jsx)(Yt,{actionStore:t,automationContextStore:o,disabled:M,errorMessage:C,onChange:S,value:p}),(0,l.$K)(d)&&m&&(0,Ue.jsx)(Qt,{collectionStore:d,disabled:M,errorMessage:k,onChange:v,value:g})]}),d&&(0,Ue.jsx)(Vt.R7,{disabled:M,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:(0,Ue.jsx)(Lt.QF,{actionStore:t,collectionStore:d,contextStore:o,disabled:M,showSetPropertyActions:!1})})]})},update_pages:o(916269).B,query_collection:function(){return null},open_page:function(e){const{actionStore:t}=e,{automationContextStore:o,disabled:n,maybePersistedTransactionActions:i,suppressActionErrors:a}=(0,xt.i)(),s=(0,Ie.qz)(void 0,yt.Z),l=(0,r.z)("open_page"),c=(0,Ie.VK)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.target}),[t]),u=(0,we.useMemo)((()=>({headerWrap:{paddingInlineEnd:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}})),[]),d=(0,we.useCallback)((e=>{i.createAndCommit({perform:o=>{se.sW({store:t.getConfigStore(),data:{target:e},transaction:o})},userAction:"OpenPageAction.setTarget"})}),[i,t]),p=(0,we.useCallback)((e=>{i.createAndCommit({perform:o=>{se.sW({store:t.getConfigStore(),data:{open_in:e},transaction:o})},userAction:"OpenPageAction.setPeekMode"})}),[i,t]),m=(0,we.useCallback)((()=>s.reset()),[s]),g=(0,we.useMemo)((()=>!a.includes(t.id)),[a,t]),h=(0,Rt.TU)({actionId:t.id,contextStore:o,shouldShow:g}),y=(0,we.useMemo)((()=>(0,Ue.jsx)(Pt.e,{actionStore:t,closeMenu:m})),[t,m]);if(!o)return null;const f=Boolean(n);return(0,Ue.jsx)(Vt.Ao,{actionMenu:y,buttonPopupStore:s,children:(0,Ue.jsxs)(Vt.vu,{actionRegistryItem:l,disabled:f,styles:u,children:[(0,Ue.jsx)(ho,{actionStore:t,automationContextStore:o,disabled:f,errorMessage:h,onChange:d,value:c}),(0,Ue.jsx)(yo,{actionStore:t,disabled:f,onChange:p})]})})},duplicate_blocks:function(e){const{actionStore:t}=e,{disabled:o,editorPlacement:n}=(0,xt.i)(),i=(0,Ve.O7)(),a=(0,Fe.yK)((()=>({title:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0",whiteSpace:"pre-wrap"}})),[]),s=(0,Ie.VK)((()=>(0,zt.Ps)(t.getBlockPointers())),[t],{useDeepEqual:!0}),l=(0,Ie.VK)((()=>function(e){const t=Object.values(ao).find((t=>t.key===e));return t??so}(t.getInsertionPoint())),[t]),c=(0,we.useCallback)((e=>function(e,t,o){ue.createAndCommit({userAction:"DuplicateBlocksAction.setInsertionPoint",environment:e,perform:e=>{se.sW({store:t.getConfigStore(),data:{insertion_point:o},transaction:e})}})}(i,t,e)),[t,i]),u=(0,Ie.qz)(void 0,yt.Z),d=(0,we.useCallback)((()=>u.reset()),[u]),p=(0,we.useMemo)((()=>(0,Ue.jsx)(Pt.e,{actionStore:t,closeMenu:d})),[t,d]),m=(0,r.z)("duplicate_blocks"),g=Boolean(o);return(0,Ue.jsxs)(Vt.Ao,{actionMenu:p,buttonPopupStore:u,disabled:g,children:[(0,Ue.jsx)(Vt.vu,{actionRegistryItem:m,disabled:g,children:(0,Ue.jsx)("div",{style:a.title,children:(0,Ue.jsx)(P.FormattedMessage,{...ro.title,values:{insertionPicker:(0,Ue.jsx)(lo,{currentOption:l,disabled:g,onChange:c})}})})}),(0,Ue.jsx)(Vt.R7,{disabled:g,children:s?(0,Ue.jsx)(uo,{actionStore:t,buttonPlacement:n,contentParentPointer:s,disabled:g}):null})]})},modal_confirmation:function(e){const{actionStore:t}=e,o=(0,P.useIntl)(),{automationContextStore:n,disabled:i,maybePersistedTransactionActions:a}=(0,xt.i)(),s=function(){const{isMobile:e}=(0,Ve.Fy)();return(0,Fe.yK)((t=>({wrap:{display:"flex",flexDirection:"column",gap:10},inputLabel:{color:t.lightTextColor,fontSize:e?14:12,lineHeight:1.3,fontWeight:$e.Z.fontWeight.medium},input:{backgroundColor:t.contentBackground,paddingTop:6,paddingBottom:6}})),[e])}(),l=(0,r.z)("modal_confirmation"),c=(0,Ie.qz)(void 0,yt.Z),u=(0,we.useCallback)((()=>c.reset()),[c]),d=(0,we.useMemo)((()=>(0,Ue.jsx)(Pt.e,{actionStore:t,closeMenu:u})),[t,u]),p=(0,Ie.VK)((()=>t.getConfigStore().getKeyStore("text")),[t]),m=(0,Ie.VK)((()=>p.getValue()),[p]),g=(0,Ie.VK)((()=>t.getConfigStore().getKeyStore("continue_button").getKeyStore("text")),[t]),h=(0,Ie.VK)((()=>t.getConfigStore().getKeyStore("cancel_button").getKeyStore("text")),[t]),y=(0,we.useCallback)((e=>{a.createAndCommit({userAction:"BaseModalAction.handleTextChange",perform:t=>{se.sO({store:p,value:e,transaction:t})}})}),[a,p]);if(!n)return null;const f=Boolean(i);return(0,Ue.jsxs)(Vt.Ao,{actionMenu:d,buttonPopupStore:c,disabled:f,children:[(0,Ue.jsx)(Vt.vu,{actionRegistryItem:l,disabled:f,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:(0,Ue.jsx)(P.FormattedMessage,{...l.display.name})}),(0,Ue.jsxs)(Vt.R7,{disabled:f,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:[(0,Ue.jsx)("label",{style:s.inputLabel,children:(0,Ue.jsx)(P.FormattedMessage,{...po.confirmationMessageLabel})}),(0,Ue.jsx)(jt.D,{disabled:f,value:m,onChange:y,multiline:!0,placeholder:o.formatMessage(po.confirmationMessageLabel),disableFormattingAndMentions:!0,disableMobileActionBar:!0}),(0,Ue.jsx)("label",{style:s.inputLabel,children:(0,Ue.jsx)(P.FormattedMessage,{...po.continueButtonTextLabel})}),(0,Ue.jsx)(ct.Y,{disabled:f,maxlength:$.OO,style:s.input,store:g}),(0,Ue.jsx)("label",{style:s.inputLabel,children:(0,Ue.jsx)(P.FormattedMessage,{...po.cancelButtonTextLabel})}),(0,Ue.jsx)(ct.Y,{disabled:f,maxlength:$.OO,style:s.input,store:h})]})]})},slack_notification:Bo.eQ,assistant:function(e){const{actionStore:t}=e,o=(0,P.useIntl)(),n=(0,Ve.O7)(),i=(0,Ie.VK)((()=>Tt.Z.isJSAssistantEnabled()),[]),{disabled:a,maybePersistedTransactionActions:s}=(0,xt.i)(),l=(0,Fe.yK)((e=>({wrap:{display:"flex",flexDirection:"column",gap:10},plainTextInput:{backgroundColor:e.contentBackground,paddingTop:6,paddingBottom:6},sectionMenuItemTitle:{paddingLeft:0}})),[]),c=(0,Ie.VK)((()=>t.getType()),[t]),u=(0,Ie.VK)((()=>t.getConfigStore().getKeyStore("description")),[t]),d=(0,Ie.VK)((()=>({type:"simple",value:(0,Y.TPx)(u.getValue())})),[u],{useDeepEqual:!0}),p=(0,Ie.VK)((()=>{var e;return(null===(e=t.getConfig())||void 0===e?void 0:e.type)||"prompt"}),[t]),m=(0,Ie.VK)((()=>t.getConfigStore().getKeyStore("value")),[t]),g=(0,Ie.VK)((()=>({type:"simple",value:(0,Y.TPx)(m.getValue())})),[m],{useDeepEqual:!0}),h=(0,Ie.qz)(void 0,yt.Z),y=(0,we.useCallback)((()=>h.reset()),[h]),f=(0,we.useMemo)((()=>(0,Ue.jsx)(Pt.e,{actionStore:t,closeMenu:y})),[t,y]),x=(0,we.useCallback)((e=>{s.createAndCommit({userAction:"AssistantAction.handleAssistantTypeChange",perform:o=>{se.sO({store:t.getConfigStore().getKeyStore("type"),value:e,transaction:o})}})}),[s,t]),S=(0,we.useCallback)((e=>{ue.createAndCommit({userAction:"AssistantAction.handleDescriptionChange",environment:n,perform:t=>{se.sO({store:u,value:(0,Y.QaF)(null==e?void 0:e.value),transaction:t})}})}),[n,u]),v=(0,we.useCallback)((e=>{ue.createAndCommit({userAction:"AssistantAction.handleValueChange",environment:n,perform:t=>{se.sO({store:m,value:(0,Y.QaF)(null==e?void 0:e.value),transaction:t})}})}),[n,m]);if(!i)return null;if(!c)return null;const b=(0,r.z)(c),C=Boolean(a);return(0,Ue.jsxs)(Vt.Ao,{actionMenu:f,buttonPopupStore:h,disabled:C,children:[(0,Ue.jsx)(Vt.vu,{actionRegistryItem:b,disabled:C,children:(0,Ue.jsx)(Kt,{actionStore:t,disabled:C,value:p,onChange:x})}),(0,Ue.jsx)(Vt.R7,{disabled:C,children:(0,Ue.jsxs)("div",{style:l.wrap,children:[(0,Ue.jsx)(jt.D,{disabled:C,value:d,onChange:S,placeholder:o.formatMessage(It.descriptionLabel),disableFormattingAndMentions:!0,disableMobileActionBar:!0}),(0,Ue.jsx)(jt.D,{disabled:C,value:g,onChange:v,placeholder:o.formatMessage(Bt(p)),multiline:!0,disableFormattingAndMentions:!0,disableMobileActionBar:!0,code:"code"===p})]})})]})},send_in_app_notification:function(e){var t;const{actionStore:o}=e,{automationContextStore:n,disabled:i,maybePersistedTransactionActions:a,suppressActionErrors:s}=(0,xt.i)(),c=Boolean(i),u=(0,r.z)("send_in_app_notification"),d=(0,Ie.VK)((()=>null==n?void 0:n.getCollectionStore()),[n]),p=(0,Ie.VK)((()=>{if(!d)return[];return(0,So.NO)({collectionFormat:d.getFormat(),collectionSchema:d.getSchema()})}),[d]),m=(0,Ie.VK)((()=>{var e;return null==o||null===(e=o.getConfig())||void 0===e?void 0:e.target}),[o]),g=(0,Ve.O7)();!function(e){const t=(0,Ve.O7)();(0,Ie.VK)((()=>{(0,Y.lcG)(e).forEach((e=>{new _.U6(t,{table:y.KJ,id:e},{userId:e}).isDefined()}))}),[t,e])}("formula"===(null==m?void 0:m.type)?null==m||null===(t=m.value)||void 0===t?void 0:t.value:void 0);const h=(0,Ie.VK)((()=>{var e;return null===(e=o.getConfig())||void 0===e?void 0:e.notification_message}),[o]),f=(0,Ie.VK)((()=>o.id),[o.id]),x=(0,bo.z)({actionType:"send_in_app_notification",actionId:f}),S=(0,Ie.qz)(void 0,yt.Z),v=(0,we.useCallback)((()=>S.reset()),[S]),b=(0,we.useMemo)((()=>(0,Ue.jsx)(Pt.e,{actionStore:o,closeMenu:v})),[o,v]),C=(0,we.useMemo)((()=>!s.includes(o.id)),[s,o]),k=function(e){const{automationContextStore:t,actionId:o,shouldShowError:n}=e,i={};return i.target=(0,Rt.TU)({contextStore:t,actionId:o,shouldShow:n,errorKey:"target"}),i.notification_message=(0,Rt.TU)({contextStore:t,actionId:o,shouldShow:n,errorKey:"notification_message"}),i.collectionPointer=(0,Rt.TU)({contextStore:t,actionId:o,shouldShow:n,errorKey:"collectionPointer"}),i.propertyId=(0,Rt.TU)({contextStore:t,actionId:o,shouldShow:n,errorKey:"propertyId"}),i.formulaValue=(0,Rt.TU)({contextStore:t,actionId:o,shouldShow:n,errorKey:"formulaValue"}),i}({automationContextStore:n,actionId:o.id,shouldShowError:C}),M=(0,we.useCallback)((e=>{a.createAndCommit({perform:t=>{se.sW({data:{target:{type:e}},store:o.getConfigStore(),transaction:t})},userAction:"SendInAppNotificationAction.setTargetType"})}),[o,a]),j=(0,we.useCallback)((e=>{const t=e.type;switch(t){case"formula":if(!e.value)return;const n=(0,Y.lzi)(e.value.value).filter((e=>{const t=(0,Y.lcG)([e]);if(0===t.length)return!0;return!new _.U6(g,{table:y.KJ,id:t[0]},{userId:t[0]}).getIsDeleted()}));a.createAndCommit({perform:e=>{se.sW({data:{target:{type:"formula",value:{type:"simple",value:n}}},store:o.getConfigStore(),transaction:e})},userAction:"SendInAppNotificationAction.setTarget"});break;case"property":a.createAndCommit({perform:t=>{se.sW({data:{target:{...e,collectionPointer:null==d?void 0:d.getSpaceShardedPointer()}},store:o.getConfigStore(),transaction:t})},userAction:"SendInAppNotificationAction.setTarget"});break;default:(0,l.t1)(t)}}),[o,d,a,g]),T=(0,we.useCallback)((e=>{a.createAndCommit({perform:t=>{se.sW({data:{notification_message:e},store:o.getConfigStore(),transaction:t})},userAction:"SendInAppNotificationAction.setNotificationMessage"})}),[o,a]),{isMobile:A}=(0,Ve.Fy)(),w=(0,Fe.yK)((e=>({inputLabel:{color:e.lightTextColor,fontSize:A?14:12,lineHeight:1.3,fontWeight:$e.Z.fontWeight.medium},input:{paddingTop:6,border:e.outlineButtonBorder,display:"flex",marginBlockEnd:16}})),[A]);if(!n||!d)return null;const V={type:"collection",collectionStore:d,property:"title"};return(0,Ue.jsxs)(Vt.Ao,{actionMenu:b,buttonPopupStore:S,disabled:c,children:[(0,Ue.jsx)(Vt.vu,{actionRegistryItem:u,disabled:i,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:(0,Ue.jsx)(Vo,{targetsErrorMessage:k.target,selectedTargetType:null==m?void 0:m.type,onTargetTypeChange:M,disabled:Boolean(i)})}),m&&(0,Ue.jsxs)(Vt.R7,{children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)(Io,{isMobile:A,selectedTargetType:m.type}),(0,Ue.jsx)("div",{style:w.input,children:(0,Ue.jsx)(Zo,{automationContextStore:n,collectionStore:d,disabled:Boolean(i),formulaTypecheckContextValues:x,currentTargetValue:m,currentProperties:p,onTargetValueChange:j,errorMessage:"property"===m.type?k.propertyId:k.formulaValue})})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{style:w.inputLabel,children:(0,Ue.jsx)(P.FormattedMessage,{...wo.notificationMessageLabel})}),(0,Ue.jsx)("div",{style:{...w.input,marginBlockEnd:0},children:(0,Ue.jsx)(vo.Z,{type:{type:"text"},value:h,onChange:T,disabled:c,contextStore:n,context:V,disableMobileActionBar:!0,formulaTypecheckContextValues:x,disableTemplateVariableMentions:!0,multiline:!0,maximumInputLines:3})})]})]})]})},assistant_basic:function(e){const{actionStore:t}=e,{disabled:o,maybePersistedTransactionActions:n}=(0,xt.i)(),i=(0,Ie.qz)(void 0,yt.Z),r=(0,we.useCallback)((()=>i.reset()),[i]),a=(0,Ie.VK)((()=>t.getConfigStore()),[t]),s=(0,Ie.VK)((()=>null==a?void 0:a.getValue()),[a]),l=(0,we.useCallback)((e=>{n.createAndCommit({userAction:"AssistantBasicAction.setValue",perform:t=>{se.sO({store:a,value:e,transaction:t})}})}),[a,n]);return(0,Ue.jsx)(Vt.Ao,{buttonPopupStore:i,disabled:o,actionMenu:(0,Ue.jsx)(Pt.e,{actionStore:t,closeMenu:r}),children:(0,Ue.jsx)(b.w_,{disabled:o??!1,config:s,onChangeConfig:l})})}};var _o=o(128607);function Ro(e){let{isEditable:t}=e;const{automationContextStore:o,disabled:n}=(0,xt.i)(),{isMobile:i}=(0,Ve.Fy)(),r=(0,St.a)(),a=(0,vt.p)(),s=(0,Ie.VK)((()=>{var e;return((null==o||null===(e=o.context.automationStore)||void 0===e?void 0:e.getActionStores())??[]).map((e=>e.isDefined()&&e.hasConcern("display")?e:null)).filter(l.K0)}),[o]),c=s.length>0,u=(0,Fe.yK)((e=>({section:{display:"flex",flexDirection:"column",gap:6},header:{alignItems:"center",display:"flex",flexDirection:"row"},headerAdd:{marginLeft:"auto",flexGrow:0,flexShrink:0},title:{color:e.lightTextColor,fontSize:i?14:12,lineHeight:1.3,fontWeight:$e.Z.fontWeight.medium}})),[i]),d=!n&&t&&c&&a.length>0,p=!n&&t&&a.length>0,m=t&&!r;return(0,Ue.jsxs)("section",{style:u.section,children:[(0,Ue.jsxs)("header",{style:u.header,children:[(0,Ue.jsx)("div",{style:u.title,children:(0,Ue.jsx)(P.FormattedMessage,{...ht.sY.actionTitle})}),d&&(0,Ue.jsx)("div",{style:u.headerAdd,children:(0,Ue.jsx)(Wo,{disabled:n,hasAnyActions:c,variant:"icon"})})]}),m?(0,Ue.jsx)(Do,{actionStores:s}):(0,Ue.jsx)(No,{actionStores:s}),p&&(0,Ue.jsx)("footer",{children:(0,Ue.jsx)(Wo,{disabled:n,hasAnyActions:c,variant:c?"menuitem":"button"})})]})}function No(e){let{actionStores:t}=e;const o=(0,ut.L5)();return(0,Ue.jsx)("div",{children:t.map((e=>(0,Ue.jsx)("div",{className:o,children:(0,Ue.jsx)(Lo,{actionStore:e})},e.id)))})}function Do(e){let{actionStores:t}=e;const{automationContextStore:o,disabled:n,onActionDragStart:r,onActionDragEnd:a,maybePersistedTransactionActions:s}=(0,xt.i)(),c=(0,Ie.VK)((()=>{var e;const t=(null==o||null===(e=o.context.automationStore)||void 0===e?void 0:e.getActionStores())??[];return new Map(t.map((e=>{if(e.isDefined()&&e.hasConcern("display"))return[e.id,e]})).filter(l.$K))}),[null==o?void 0:o.context.automationStore]),u=(0,we.useMemo)((()=>Array.from(c.keys())),[c]),d=(0,Ie.qz)(void 0,ft.Z),p=(0,we.useCallback)((e=>{const t=e.state;if(t.willDrag){const e=c.get(t.draggingKey);(0,l.$K)(e)&&(0,l.$K)(r)&&r(e)}else t.willDrag||t.isDragging||null==a||a()}),[c,a,r]);(0,we.useEffect)((()=>(d.addListener(p),()=>d.removeListener(p))),[c,d,p]);const m=(0,we.useCallback)((e=>{if(!o)throw new Error("Error reordering actions. Could not find automationContextStore");s.createAndCommit({userAction:"AutomationButtonAction.moveAction",perform:t=>{i.reorderAutomationActions({clientContext:o.context,newActionIds:e,transaction:t})}})}),[o,s]),g=(0,we.useCallback)(((e,t)=>{const o=c.get(e);return(0,l.$K)(o)?(0,Ue.jsx)(Lo,{actionStore:o},o.id):null}),[c]);return t.length>0?(0,Ue.jsx)(Oo,{draggableListStore:d,hasDragging:!n,keys:u,onDrop:m,renderKey:g}):null}function Lo(e){const{actionStore:t}=e,o=(0,Ie.VK)((()=>t.getType()),[t]);if(!o)return null;const n=Ko[o];return(0,Ue.jsx)(n,{actionStore:t})}function Oo(e){const{draggableListStore:t,hasDragging:o,keys:n,onDrop:i,renderKey:r,ruleTopOffset:a}=e,s=(0,ut.RD)({ruleTopOffset:a}),l=(0,ut.L5)();return(0,Ue.jsxs)("div",{style:s.wrap,children:[(0,Ue.jsx)("div",{style:s.verticalRule}),(0,Ue.jsx)(gt.ZP,{childClassName:l,direction:"vertical",disabled:!o,keys:n,onDrop:i,renderKey:r,store:t,style:s.list})]})}function Wo(e){const{disabled:t,hasAnyActions:o,variant:n}=e,{isMobile:i}=(0,Ve.Fy)(),r=(0,at.d)(),a=(0,P.useIntl)(),s=(0,we.useMemo)((()=>({availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"})),[]),l=(0,Ie.qz)(void 0,yt.Z),c=(0,we.useCallback)((()=>l.reset()),[l]),u=(0,Fe.yK)((e=>({buttonWrap:{boxShadow:"initial",background:"transparent"},button:{color:e.mediumTextColor,fill:e.mediumIconColor,margin:0,width:"100%"},buttonIcon:{height:i?18:16,width:24}})),[i]),d=Boolean(t);return(0,Ue.jsx)(mt.ZP,{alignmentToOrigin:mt.vR.Start,buttonPopupStore:l,disabled:d,placementToOrigin:mt.pO.Bottom,popupType:r,render:()=>(0,Ue.jsx)(bt.Z,{initialState:s,onClose:c}),renderOrigin:e=>"icon"===n?(0,Ue.jsx)(Re.Z,{...e,ariaLabel:a.formatMessage(ht.sY.addActionAriaLabel),disabled:d,disabledFeedback:d,icon:dt.R}):"button"===n?(0,Ue.jsx)(_o.D,{...e,ariaLabel:a.formatMessage(ht.sY.addActionAriaLabel),disabled:d,icon:(0,dt.R)({height:24,width:12}),title:(0,Ue.jsx)(P.FormattedMessage,{...ht.sY.addActionLabel})}):(0,Ue.jsx)(pt.Z,{...e,buttonStyle:u.button,disabled:d,disabledFeedback:d,focused:!1,icon:(0,dt.R)(u.buttonIcon),style:u.buttonWrap,title:o?(0,Ue.jsx)(P.FormattedMessage,{id:"automations.addActionButton.nonEmpty.label",defaultMessage:"Add another step"}):(0,Ue.jsx)(P.FormattedMessage,{id:"automations.addActionButton.empty.label",defaultMessage:"Add a step"})})})}function Eo(e){const{areActionsEditable:t,areTriggersEditable:o}=e,{isMobile:n}=(0,Ve.Fy)(),i=(0,Fe.yK)((e=>({verticalRule:{background:e.stroke.regular,marginLeft:20,height:36,width:1},container:{padding:n?"16px 16px 0px 16px":void 0}})),[n]);return(0,Ue.jsxs)("div",{style:i.container,children:[(0,Ue.jsx)(ut.nT,{isEditable:o}),(0,Ue.jsx)("div",{style:i.verticalRule}),(0,Ue.jsx)(Ro,{isEditable:t})]})}const Ho=(0,P.defineMessages)({addIconButtonAriaLabel:{defaultMessage:"Add icon",id:"buttonBlock.button.addIconButtonAriaLabel"},editButtonAriaLabel:{defaultMessage:"Edit button",id:"buttonBlock.button.editButtonAriaLabel"},buttonPlaceholder:{defaultMessage:"New button",id:"buttonBlock.button.placeholder"},buttonInsufficientPermissions:{defaultMessage:"You don’t have permission to run this button",id:"buttonBlock.button.insufficientPermissions"},clickToEdit:{defaultMessage:"Click to edit button",id:"buttonBlock.button.clickToEdit"}});function Uo(e){var t,o,n;const{buttonBlockStore:i}=e,r=(0,Ie.VK)((()=>i.state.editing?i.state:void 0),[i]),a=(0,Fe.yK)((e=>{var t;return{popup:{width:400},editor:{background:e.sidebarBackground,..."inline"===(null==r||null===(t=r.placement)||void 0===t?void 0:t.type)?{marginTop:6,borderRadius:6,border:`1px solid ${e.regularDividerColor}`,maxWidth:600}:{}}}}),[null==r||null===(t=r.placement)||void 0===t?void 0:t.type]),s=(0,at.d)({tabletBehavior:"slideUp"});return r&&r.placement?"popup"===(null===(o=r.placement)||void 0===o?void 0:o.type)?(0,Ue.jsx)(Ne.ZP,{open:!0,popupType:s,render:()=>(0,Ue.jsx)(zo,{...e,style:a.editor}),originRect:r.placement.originRect,style:a.popup,originGap:4,onDismiss:()=>{i.stopEditing()}}):"inline"===(null===(n=r.placement)||void 0===n?void 0:n.type)?(0,Ue.jsx)(zo,{...e,style:a.editor}):void(0,l.t1)(r.placement):null}function zo(e){const{disabled:t,store:o,buttonBlockStore:n}=e,i=(0,Ve.O7)(),r=i.currentUser.id,s=(0,P.useIntl)(),[l,c]=(0,tt.e)(),u=(0,Fe.yK)((e=>({header:{display:"flex",alignItems:"center",padding:"12px 12px 8px 12px",gap:6},scroller:{maxHeight:"75vh"},nameInputWrap:{flexGrow:"1"},factoryButtonDeprecationBanner:{margin:"12px 12px 6px 12px"}})),[]),d=(0,ot.D)(),p=(0,Ie.VK)((()=>o.getAutomationStore()),[o]),m=(0,Ie.VK)((()=>null==p?void 0:p.getSpaceId()),[p]),{maybePersistedAutomationStore:g,maybePersistedTransactionActions:h}=(0,lt.$)({automationId:null==p?void 0:p.id,spaceId:m,defaultValue:void 0,persist:!0}),y=(0,Ie.VK)((()=>null==g?void 0:g.getNameStore()),[g]),f=(0,Ie.VK)((()=>null==g?void 0:g.getIconStore()),[g]),x=(0,Ie.VK)((()=>(null==y?void 0:y.getValue())??""),[y]),S=(0,st.R)({store:o,automationStore:g}),v=(0,Ie.VK)((()=>{var e;return o.canEdit()&&"sufficient"===(null==S||null===(e=S.state)||void 0===e?void 0:e.editPermissionStatus)}),[o,S]),{showFactoryButtonDeprecationBanner:b,handleDismissFactoryButtonMigrationBanner:C}=(0,Qe.N)({blockStore:o}),M=(0,Ie.VK)((()=>null==f?void 0:f.getValue()),[f]),j=(0,Ie.VK)((()=>{const e=o.getRecordStoreUIRoot();if(e instanceof _.G)return e}),[o]),T=(0,Ie.VK)((()=>n.state.editing?n.state.placement:void 0),[n]),A=(0,we.useMemo)((()=>{if(g&&j)return new it.L({type:"button_block",persisted:!0,automationStore:g,blockStore:o,pageStore:j,intl:k.default.getIntl(),parentRecordStore:g,currentUserId:r})}),[g,j,o,r]),w=(0,we.useCallback)((e=>{(0,Je.ZP)({event:e,context:Je.Af.EditorClick,callback:()=>{Ke.ZH({debug:{userAction:"ButtonBlockEditor.handleClick"},environment:i}),ce.ZH({debug:{userAction:"ButtonBlockEditor.handleClick"},environment:i})}})}),[i]),V=(0,we.useCallback)((()=>{n.stopEditing(),(0,a.lN)(d,{block_id:o.id,automation_id:null==g?void 0:g.id})}),[g,n,o,d]),I=(0,we.useCallback)(((e,t)=>{g&&ue.createAndCommit({userAction:"ButtonBlock.updateProperty",environment:i,perform:o=>{se.sW({store:g.getPropertiesStore(),transaction:o,data:{[e]:t??null}})}})}),[g,i]),F=(0,we.useCallback)((e=>I("icon",e)),[I]),Z=(0,we.useCallback)((e=>I("name",e)),[I]),B=(0,we.useCallback)((e=>{Be.$(i,{originRect:e.currentTarget.getBoundingClientRect(),originGap:4,popupWidth:Xe.FZ,popupHeight:Xe.kX,isSmallWidth:!1,title:s.formatMessage({defaultMessage:"Icon",id:"buttonBlock.button.iconHeading"}),currentTab:"icon",tabs:[{type:"icon",onChange:e=>{F(e),Be.Z()}},{type:"emoji",onChange:(e,t)=>{F(e),Be.Z()}}],onDelete:M?()=>{F(void 0),Be.Z()}:void 0})}),[i,F,s,M]),K=(0,Ie.VK)((()=>n.state.suppressErrorsForActionIds),[n]),R=(0,we.useCallback)((e=>n.suppressErrorsForAction(e.id)),[n]),[N,D]=(0,we.useState)(void 0),L=(0,we.useCallback)((e=>D(e.id)),[]),O=(0,we.useCallback)((()=>D(void 0)),[]),W=t||!v;if(!A||!g)return null;const E=e=>(0,Ue.jsx)(Re.Z,{ariaLabel:s.formatMessage(Ho.addIconButtonAriaLabel),style:{width:26,height:26},iconStyle:{width:16,height:16},hasBackground:!0,disabled:W,showShadow:!0,icon:e=>M?(0,Ue.jsx)(Le.Z,{disabled:!0,isEmptyPage:!1,size:24,icon:{icon:M,pointer:o.pointer},style:e}):(0,Ze.o)(e),...(0,et.Z)(e??{},{onClick:B})}),H=M?E():(0,Ue.jsx)(We.Z,{renderTooltip:()=>(0,Ue.jsx)(P.FormattedMessage,{defaultMessage:"Add an icon",id:"buttonBlock.button.addIcon"}),delayThreshold:300,render:E});return(0,Ue.jsx)("div",{ref:l,style:e.style,onClick:w,children:(0,Ue.jsxs)(rt.Z.Provider,{value:{automationContextStore:A,automationStore:g,currentDraggingActionId:N,disabled:W,editorPlacement:T,editorWidth:c,maybePersistedTransactionActions:h,onActionAdded:R,onActionDragEnd:O,onActionDragStart:L,suppressActionErrors:K},children:[b&&(0,Ue.jsx)("div",{style:u.factoryButtonDeprecationBanner,children:(0,Ue.jsx)(Ye,{handleDismissBanner:C})}),(0,Ue.jsxs)(_e.p,{allowSelectionWithin:!0,style:u.header,children:[H,(0,Ue.jsx)(ct.b,{onChange:Z,value:x,disabled:W,placeholder:k.default.formatMessage(Ho.buttonPlaceholder),wrapStyle:u.nameInputWrap}),(0,Ue.jsx)(De.Z,{onClick:V,children:(0,Ue.jsx)(P.FormattedMessage,{defaultMessage:"Done",id:"buttonBlock.button.done"})})]}),(0,Ue.jsx)(Oe.Z,{style:u.scroller,type:nt.Z.Y,children:(0,Ue.jsx)("section",{style:{paddingBlock:8,paddingInline:8},children:(0,Ue.jsx)(Eo,{areActionsEditable:!0,areTriggersEditable:!1})})})]})})}},839477:(e,t,o)=>{o.d(t,{QF:()=>I,li:()=>D});var n=o(667294),i=o(886628),r=o(724405),a=o(603865),s=o(748777),l=o(823290),c=o(576218),u=o(606287),d=o(709291),p=o(653965),m=o(401898),g=o(709953),h=o(552275),y=o(231945),f=o(374194),x=o(478140),S=o(632163),v=o(672495),b=o(761586),C=o(312455),k=o(25742),M=o(73266),j=o(595193),T=o(435294),A=o(140190),P=o(332157),w=o(785893);const V=(0,d.defineMessages)({replaceActionLabel:{id:"automations.AutomationActionSetPropertiesSection.replaceAction.label",defaultMessage:"Replace with"},appendActionLabel:{id:"automations.AutomationActionSetPropertiesSection.appendAction.label",defaultMessage:"Add"},removeActionLabel:{id:"automations.AutomationActionSetPropertiesSection.removeAction.label",defaultMessage:"Remove"},toggleActionLabel:{id:"automations.AutomationActionSetPropertiesSection.toggleAction.label",defaultMessage:"Toggle"},titlePlaceholder:{id:"automations.AutomationActionSetPropertiesSection.titlePlaceholder",defaultMessage:"Untitled"},automationActionPropertyDeleted:{id:"automations.AutomationActionSetPropertiesSection.automationActionPropertyDeleted",defaultMessage:"This property was deleted"}});function I(e){const{contextStore:t,actionStore:o,collectionStore:r,disabled:a,showSetPropertyActions:s}=e,l=(0,i.VK)((()=>o.id),[o.id]),c=(0,i.VK)((()=>o.getType()),[o]),{maybePersistedTransactionActions:u}=(0,C.i)(),d=(0,i.VK)((()=>{var e;return(null===(e=o.getConfig())||void 0===e?void 0:e.values)??{}}),[o]),p=(0,i.VK)((()=>{var e;return(null===(e=o.getConfig())||void 0===e?void 0:e.properties)??[]}),[o]),m=(0,n.useMemo)((()=>({properties:p,values:d})),[p,d]),g=(0,n.useCallback)((e=>{const t=p.concat([e]),n={...d,[e]:void 0};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.propertiesChange",perform:e=>{F({configStore:o.getConfigStore(),properties:t,transaction:e,values:n})}})}),[p,d,u,o]),h=(0,n.useCallback)(((e,t)=>{const n=p.indexOf(e);if(-1===n)return;const i=p.slice(0);i[n]=t;const r={...d,[t]:void 0};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.setProperties",perform:e=>{F({configStore:o.getConfigStore(),properties:i,transaction:e,values:r})}})}),[p,d,u,o]),y=(0,n.useCallback)((e=>{const t=p.filter((t=>t!==e)),n={...d,[e]:void 0};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.removeProperty",perform:e=>{F({configStore:o.getConfigStore(),properties:t,transaction:e,values:n})}})}),[p,d,u,o]),f=(0,n.useCallback)(((e,t)=>{const n={...d,[e]:t};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.handleValueChange",perform:e=>{F({configStore:o.getConfigStore(),properties:p,transaction:e,values:n})}})}),[d,u,o,p]);return(0,w.jsx)(Z,{contextStore:t,actionId:l,actionType:c,config:m,onPropertyAdd:g,onPropertyChange:h,onPropertyRemove:y,onPropertyValueChange:f,collectionStore:r,showSetPropertyActions:s,disabled:a})}function F(e){const{configStore:t,properties:o,transaction:n,values:i}=e;g.sW({store:t,data:{properties:o,values:i},transaction:n})}function Z(e){const{contextStore:t,actionId:o,actionType:n,config:s,collectionStore:l,onPropertyAdd:c,onPropertyChange:u,onPropertyRemove:d,onPropertyValueChange:p,disabled:m,showSetPropertyActions:g}=e,h=(0,r.yK)((e=>({addPropertyValuePlaceholder:{color:e.mediumTextColor,flexGrow:1,textAlign:"right"},addPropertyRow:{display:"flex",alignItems:"center"}})),[]),y=s.properties,f=(0,i.VK)((()=>(0,a.cO)({collectionFormat:l.getFormat(),collectionSchema:l.getSchema(),filter:e=>{let[t]=e;return!y.includes(t)}})),[l,y]),x=0===f.length;return(0,w.jsxs)(w.Fragment,{children:[y.length>0&&(0,w.jsx)(B,{availablePropertyIds:f,actionType:n,contextStore:t,actionId:o,config:{properties:y,values:s.values},collectionStore:l,onPropertyChange:u,onPropertyRemove:d,onPropertyValueChange:p,showSetPropertyActions:g,disabled:m}),!m&&!x&&(0,w.jsx)("div",{style:h.addPropertyRow,children:(0,w.jsx)(P.X,{availablePropertyIds:f,currentValue:void 0,collectionStore:l,onChange:c,disabled:m,alreadyHaveProperties:y.length>0})})]})}function B(e){const{availablePropertyIds:t,contextStore:o,actionId:n,actionType:i,config:a,collectionStore:s,onPropertyChange:l,onPropertyRemove:c,onPropertyValueChange:u,showSetPropertyActions:d,disabled:p}=e,m=(0,M.a)(),g=(0,r.yK)((()=>({wrap:{alignItems:"center",columnGap:4,display:"grid",gridTemplateColumns:m?"100%":"160px 1fr",minWidth:0,rowGap:m?4:8},propertyValue:{...m?{fontSize:14,marginBlockEnd:16}:{}},lastPropertyValue:{...m?{fontSize:14,marginBlockEnd:0}:{}}})),[m]);return(0,w.jsx)("div",{style:g.wrap,children:a.properties.map(((e,r)=>{const m=r===a.properties.length-1;return(0,w.jsx)(K,{actionType:i,actionId:n,availablePropertyIds:t,collectionStore:s,contextStore:o,disabled:p,onPropertyChange:l,onPropertyRemove:c,onPropertyValueChange:u,property:e,showSetPropertyActions:d,value:a.values[e],valueStyle:m?g.lastPropertyValue:g.propertyValue},e)}))})}function K(e){const{actionId:t,actionType:o,availablePropertyIds:a,collectionStore:p,contextStore:m,disabled:g,onPropertyChange:h,onPropertyRemove:y,onPropertyValueChange:x,property:S,showSetPropertyActions:v,value:C,valueStyle:M}=e,j={type:"collection",collectionStore:p,property:S},T=(0,d.useIntl)(),A=(0,r.yK)((e=>({propertyName:{display:"flex"},propertyValue:{display:"flex",gap:4,minWidth:50,...M}})),[M]),I=(0,n.useMemo)((()=>{if("title"===S)return T.formatMessage(V.titlePlaceholder)}),[T,S]),F=(0,i.VK)((()=>p.getSchema()[S]||p.getDeletedSchema()[S]),[p,S]),Z=(0,i.VK)((()=>Boolean(!p.getSchema()[S])),[p,S]),B=(0,i.VK)((()=>{if(F)return(0,c.qW)({table:u.vF,id:p.id,spaceId:p.getSpaceId()},S,F)}),[p,F,S]),K=(0,i.VK)((()=>null==F?void 0:F.type),[F]),R=null==C?void 0:C.value,N=(0,i.VK)((()=>(0,l.o9)(C)),[C]),L=(0,i.VK)((()=>m.context.parentRecordStore.getSpaceId()),[m.context.parentRecordStore]),O=(0,k.z)({actionType:o,actionId:t}),W=(0,n.useCallback)((e=>{h(S,e)}),[h,S]),E=(0,n.useCallback)((()=>y(S)),[y,S]),H=(0,n.useCallback)((e=>{x(S,e)}),[x,S]),U=(0,n.useCallback)((e=>{H({action:e,value:R})}),[R,H]),z=(0,n.useCallback)((e=>{H({action:N,value:e})}),[N,H]);if(!B||!L)return null;const $=D(K);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{style:A.propertyName,children:(0,w.jsx)(P.X,{availablePropertyIds:a,currentValue:S,collectionStore:p,onChange:W,disabled:g,onRemove:E,errorMessage:Z?(0,w.jsx)(d.FormattedMessage,{...V.automationActionPropertyDeleted}):void 0})}),(0,w.jsxs)("div",{style:A.propertyValue,children:[!Z&&v&&F&&s.Y[F.type]&&(0,w.jsx)(_,{disabled:g,onChange:U,value:N}),Z?(0,w.jsx)(f.Z,{disabled:!0,placeholder:T.formatMessage(V.automationActionPropertyDeleted)}):(0,w.jsx)(b.Z,{...$,type:B,value:null==C?void 0:C.value,onChange:z,disabled:g,contextStore:m,context:j,placeholder:I,disableMobileActionBar:!0,formulaTypecheckContextValues:O,disableTemplateVariableMentions:!0})]})]})}function _(e){const{disabled:t,onChange:o,value:n}=e,i=(0,r.yK)((e=>({button:{boxShadow:e.inputBoxShadow}})),[]),a=(0,T.d)();return(0,w.jsx)(y.ZP,{popupType:a,alignmentToOrigin:y.vR.End,placementToOrigin:y.pO.Bottom,originGap:0,disabled:t,renderOrigin:e=>(0,w.jsx)(A.S,{...e,disabled:t,style:i.button,children:(0,w.jsx)(N,{action:n})}),render:e=>(0,w.jsx)(R,{onChange:o,parent:e,value:n})})}function R(e){const{value:t,onChange:o,parent:n}=e,i=(0,j.F)({width:250}),r=p.oA(l.E2.map(((e,i)=>({key:i,render:o=>(0,w.jsx)(h.Z,{...o,disabled:!1,title:(0,w.jsx)(N,{action:e}),checkState:t===e}),action:()=>{e!==t&&o(e),n.close()}}))));return(0,w.jsx)(x.Z,{...i,children:(0,w.jsx)(S.Z,{type:S.i.Vertical,sections:[{key:0,render:e=>(0,w.jsx)(v.Z,{enableActionSheetTitle:!0,...e}),items:r}],initialFocus:0})})}function N(e){const{action:t}=e;return"replace"===t?(0,w.jsx)(d.FormattedMessage,{...V.replaceActionLabel}):"append"===t?(0,w.jsx)(d.FormattedMessage,{...V.appendActionLabel}):"remove"===t?(0,w.jsx)(d.FormattedMessage,{...V.removeActionLabel}):"toggle"===t?(0,w.jsx)(d.FormattedMessage,{...V.toggleActionLabel}):void(0,m.t1)(t)}function D(e){return"email"===e||"phone_number"===e||"url"===e?{disableEmojiCommands:!0,disableFormattingAndMentions:!0}:{}}},128607:(e,t,o)=>{o.d(t,{D:()=>a});o(667294);var n=o(724405),i=o(164921),r=o(785893);function a(e){const{ariaLabel:t,disabled:o,icon:a,onClick:s,title:l}=e,c=(0,n.yK)((e=>({button:{alignItems:"center",background:e.sidebarBackground,border:`1px dashed ${e.stroke.regular}`,borderRadius:6,display:"flex",color:e.accentColors.gray[900],gap:6,justifyContent:"center",padding:16},buttonWrap:{background:e.sidebarBackground,position:"relative"},iconWrap:{fill:e.accentColors.gray[600]},title:{fontSize:14,lineHeight:1.3}})),[]);return(0,r.jsx)("div",{style:c.buttonWrap,children:(0,r.jsxs)(i.Z,{ariaLabel:t,disabled:o,disabledFeedback:o,onClick:s,style:c.button,children:[a&&(0,r.jsx)("div",{"aria-hidden":"true",style:c.iconWrap,children:a}),(0,r.jsx)("div",{style:c.title,children:l})]})})}},67473:(e,t,o)=>{o.d(t,{nT:()=>R,HC:()=>B,L5:()=>Z,RD:()=>F});var n=o(667294),i=o(800480),r=o(886628),a=o(724405),s=o(747453),l=o(709291),c=o(137810),u=o(231945),d=o(573063),p=o(932130),m=o(312455),g=o(73266),h=o(435294),y=o(128607),f=o(745238),x=o(785893);const S=(0,f.IU)("cursorArrowClick2",{viewBox:"0 0 20 20",svg:(0,x.jsxs)("g",{children:[(0,x.jsx)("path",{d:"M0 10.18c0 3.74 2.158 7.04 5.107 8.661 1.026.577 1.875-.79.743-1.445-2.452-1.367-4.18-4.082-4.18-7.217 0-4.609 3.672-8.3 8.281-8.3 4.61 0 8.31 3.691 8.31 8.3 0 .586.45.87.88.87.4 0 .78-.293.78-.87 0-5.449-4.52-9.96-9.97-9.96C4.511.218 0 4.73 0 10.178Z"}),(0,x.jsx)("path",{d:"M3.945 10.18c0 2.177 1.192 4.003 2.618 4.921.986.664 1.835-.654 1.005-1.22a4.41 4.41 0 0 1-2.011-3.702A4.38 4.38 0 0 1 9.95 5.765c2.442 0 4.326 1.944 4.414 4.414.02.45.362.801.81.801.45 0 .802-.351.802-.8 0-3.301-2.725-6.026-6.026-6.026-3.281 0-6.006 2.725-6.006 6.025Z"}),(0,x.jsx)("path",{d:"M9.58 17.25c-.01.38.44.508.684.263l1.494-1.494 1.67 4.121c.078.186.273.274.449.205l.967-.39c.176-.078.244-.283.156-.469l-1.748-4.063 2.1-.078c.37-.02.546-.38.283-.654l-5.332-5.488c-.254-.254-.625-.108-.635.254Z"})]})});var v=o(756812),b=o(166315);function C(){const e=(0,l.useIntl)(),{automationContextStore:t}=(0,m.i)();if(!M((0,r.VK)((()=>null==t?void 0:t.context.automationStore),[t])))return null;const o=e.formatMessage(v.Bo.triggerButtonClicked,{b:k});return(0,x.jsx)(b.R,{icon:S,tooltip:o,children:o})}function k(e){return(0,x.jsx)("span",{style:{fontWeight:c.Z.fontWeight.medium},children:e})}function M(e){return(0,r.VK)((()=>Boolean(null==e?void 0:e.isTriggerType("button"))),[e])}var j=o(753570);function T(){const{automationStore:e}=(0,m.i)(),{removePageAddedTrigger:t}=(0,j.i)(),o=(0,l.useIntl)(),n=(0,a.yK)((()=>({title:{fontWeight:c.Z.fontWeight.medium}})),[]);if(!A(e))return null;const i=v.Mz(o);return(0,x.jsx)(b.R,{icon:s.R,onDelete:t,tooltip:i,children:(0,x.jsx)("div",{style:n.title,children:i})})}function A(e){return(0,r.VK)((()=>{if(!(null!=e&&e.isTriggerType("event")||null!=e&&e.isTriggerType("notification_event")))return!1;const t=e.getEventConfiguration();return Boolean(null==t?void 0:t.pagesAdded)}),[e])}var P=o(275563),w=(o(599184),o(332713));const V="automation-list-item",I="automation-list-item-narrow";function F(e){const{ruleTopOffset:t}=e,o=(0,g.a)();return(0,a.yK)((e=>({wrap:{position:"relative"},list:{marginBottom:o?0:-8},verticalRule:{background:e.stroke.regular,bottom:0,left:20,position:"absolute",top:t??0,width:1}})),[o,t])}function Z(){const e=(0,g.a)();return(0,n.useMemo)((()=>`${V} ${e?I:""}`),[e])}function B(e){const{children:t}=e,o=Z();return(0,x.jsx)("div",{className:o,children:t})}function K(e){const{children:t,ruleTopOffset:o}=e,n=F({ruleTopOffset:o});return(0,x.jsxs)("div",{style:n.wrap,children:[(0,x.jsx)("div",{style:n.verticalRule}),(0,x.jsx)("div",{style:n.list,children:t})]})}function _(e){const{variant:t}=e,o=(0,h.d)(),i=(0,l.useIntl)(),r=(0,n.useMemo)((()=>({type:"eventTriggers"})),[]);return(0,x.jsx)(u.ZP,{alignmentToOrigin:u.vR.End,placementToOrigin:u.pO.Bottom,popupType:o,render:e=>(0,x.jsx)(w.Z,{initialState:r,buttonPopupParent:e}),renderOrigin:e=>"icon"===t?(0,x.jsx)(d.Z,{...e,ariaLabel:i.formatMessage(p.sY.addTriggerAriaLabel),icon:s.R}):(0,x.jsx)(y.D,{...e,ariaLabel:i.formatMessage(p.sY.addTriggerAriaLabel),icon:(0,s.R)({height:24,width:12}),title:(0,x.jsx)(l.FormattedMessage,{...p.sY.addTriggerLabel})})})}function R(e){const{isEditable:t}=e,{isMobile:o}=(0,i.Fy)(),{showAnyPropertyTriggers:n,showButtonClickedTrigger:s,showPageAddedTrigger:u}=function(){const{automationContextStore:e}=(0,m.i)(),t=(0,r.VK)((()=>null==e?void 0:e.context.automationStore),[e]),o=M(t),n=A(t),i=(0,P.Zr)(t);return{showAnyPropertyTriggers:i,showPageAddedTrigger:n,showButtonClickedTrigger:o}}(),d=n||s||u,g=(0,a.yK)((e=>({section:{display:"flex",flexDirection:"column",gap:6},header:{alignItems:"center",display:"flex",flexDirection:"row"},headerAdd:{marginLeft:"auto",flexGrow:0,flexShrink:0,visibility:d?void 0:"hidden"},title:{color:e.lightTextColor,fontSize:o?14:12,lineHeight:1.3,fontWeight:c.Z.fontWeight.medium}})),[d,o]);return(0,x.jsxs)("section",{style:g.section,children:[(0,x.jsxs)("header",{style:g.header,children:[(0,x.jsx)("div",{style:g.title,children:(0,x.jsx)(l.FormattedMessage,{...p.sY.triggerTitle})}),t&&(0,x.jsx)("div",{style:g.headerAdd,children:(0,x.jsx)(_,{variant:"icon"})})]}),(0,x.jsxs)(K,{children:[s&&(0,x.jsx)(C,{}),u&&(0,x.jsx)(T,{}),n&&(0,x.jsx)(P.Dl,{}),!d&&t&&(0,x.jsx)(_,{variant:"button"})]})]})}},332157:(e,t,o)=>{o.d(t,{X:()=>f});var n=o(667294),i=o(800480),r=o(886628),a=o(724405),s=o(12396),l=o(709291),c=o(137810),u=o(657410),d=o(231945),p=o(478140),m=o(595193),g=o(435294),h=o(140190),y=o(785893);function f(e){const{alreadyHaveProperties:t,availablePropertyIds:o,collectionStore:f,currentValue:x,disabled:S,onChange:v,onRemove:b,placeholderMessage:C,errorMessage:k}=e,M=(0,i.O7)(),j=(0,a.Fg)(),{device:T}=M,A=(0,r.VK)((()=>f.getSchema()??{}),[f]),P=(0,r.VK)((()=>f.getFormat()??{}),[f]),w=(0,r.VK)((()=>x?f.getSchema()[x]:void 0),[x,f]),V=(0,r.VK)((()=>x?f.getDeletedSchema()[x]:void 0),[x,f]),I=(0,a.yK)((e=>{const t={fill:e.lightTextColor,height:"auto",marginRight:4,width:16};return{propertyIcon:t,deletedPropertyIcon:{...t,fill:e.text.uiRedPrimary},propertyTitle:{fontWeight:c.Z.fontWeight.medium,...c.Z.textOverflowStyle},deletedPropertyTitle:{color:e.text.uiRedPrimary,fontWeight:c.Z.fontWeight.medium,...c.Z.textOverflowStyle}}}),[]),F=(0,n.useCallback)((()=>o),[o]),Z=(0,g.d)(),B=(0,r.VK)((()=>w?function(e){return(0,y.jsx)(s.ZP,{icon:void 0,size:16,style:{...e,...I.propertyIcon},theme:j,type:w.type})}:V?function(e){return(0,y.jsx)(s.ZP,{icon:void 0,type:V.type,size:16,theme:j,style:{...e,...I.deletedPropertyIcon}})}:void 0),[V,w,I.deletedPropertyIcon,I.propertyIcon,j]),K=Boolean(k),_=!Boolean(w)&&!Boolean(t),R=!Boolean(t);return(0,y.jsx)(d.ZP,{popupType:Z,alignmentToOrigin:d.vR.End,placementToOrigin:d.pO.Bottom,originGap:0,disabled:S,renderOrigin:e=>(0,y.jsx)(h.S,{...e,disabled:S,icon:B,isError:K,hasActionRequired:_,isSecondary:R,tooltipMessage:k,children:w?(0,y.jsx)("div",{style:I.propertyTitle,children:w.name}):V?(0,y.jsx)("div",{style:I.deletedPropertyTitle,children:V.name}):C?(0,y.jsx)(l.FormattedMessage,{...C}):t?(0,y.jsx)(l.FormattedMessage,{id:"automations.propertyPicker.buttonPlaceholderAlreadyHaveProperties",defaultMessage:"Edit another property"}):(0,y.jsx)(l.FormattedMessage,{id:"automations.propertyPicker.buttonPlaceholder",defaultMessage:"Edit a property"})}),render:e=>{const t=(0,m.U)({device:T,width:280,paddingTop:4});return(0,y.jsx)(p.Z,{...t,children:(0,y.jsx)(u.Z,{schema:A,format:P,showRemoveOption:Boolean(b),currentProperty:x,getProperties:F,onAccept:t=>{t&&t!==x?v(t):void 0===t&&(null==b||b(x)),e.close()}})})}})}},293060:(e,t,o)=>{o.d(t,{y:()=>s});var n=o(667294),i=o(724405),r=o(526388),a=o(785893);function s(e){const{caption:t,disable:o,renderOrigin:s,title:l,tooltipAlignment:c,tooltipPlacement:u}=e,d=(0,i.yK)((e=>({tooltipTitle:{margin:0},tooltipCaption:{color:e.mediumInvertedTextColor,margin:0}})),[]),p=(0,n.useCallback)((()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{style:d.tooltipTitle,children:l}),(0,a.jsx)("p",{style:d.tooltipCaption,children:t})]})),[t,l,d.tooltipCaption,d.tooltipTitle]);return(0,a.jsx)(r.Z,{alignment:c,delayThreshold:800,disableTooltip:o,placement:u,render:s,renderTooltip:p,textWrap:!0})}},337867:(e,t,o)=>{o.d(t,{Z:()=>d});o(667294);var n=o(800480),i=o(724405),r=o(984619),a=o(654497),s=o(709291),l=o(685567),c=o(756812),u=o(785893);function d(e){let{key:t,tokenFormat:o=r.lo.Medium,isSingle:d,showRemoveButton:p,onClickRemove:m}=e;const{isMobile:g}=(0,n.Fy)(),h=(0,s.useIntl)(),y=(0,i.yK)((e=>{const t="light"===e.mode?400:800,o="light"===e.mode?50:200,n="light"===e.mode?700:900;return{tokenValueWrap:{display:"inline-flex",gap:"4px",alignItems:"baseline"},warning:{color:e.accentColors.orange[t],height:"auto",width:g?16:14},warningWrap:{alignSelf:"center"},token:{backgroundColor:e.accentColors.yellow[o]},textWrap:{color:e.accentColors.yellow[n]}}}),[g]);return(0,u.jsx)(l.Z,{format:o,isSingle:d??!0,showRemoveButton:p??!1,onClickRemove:m,style:y.token,value:(0,u.jsxs)("span",{style:y.tokenValueWrap,children:[(0,u.jsx)("span",{style:y.warningWrap,children:(0,a.t)(y.warning)}),(0,u.jsx)("span",{style:y.textWrap,children:(0,c.ST)(h)})]})},t)}},200745:(e,t,o)=>{o.d(t,{e:()=>P});var n=o(667294),i=o(800480),r=o(886628),a=o(240745),s=o(908597),l=o(388437),c=o(701230),u=o(241490),d=o(725651),p=o(937612),m=o(709291),g=o(401898),h=o(552275),y=o(291839),f=o(478140),x=o(632163),S=o(672495),v=o(143627),b=o(312455),C=o(595193),k=o(161927),M=o(916269),j=o(838862),T=o(785893);const A=(0,m.defineMessages)({addStepAboveMenuItemLabel:{defaultMessage:"Add step above",id:"automations.actionContextMenu.addStepAboveMenuItemLabel"},addStepBelowMenuItemLabel:{defaultMessage:"Add step below",id:"automations.actionContextMenu.addStepBelowMenuItemLabel"},deleteMenuItemLabel:{defaultMessage:"Delete",id:"automations.actionContextMenu.deleteMenuItemLabel"},duplicateAboveMenuItemLabel:{defaultMessage:"Duplicate above",id:"automations.actionContextMenu.duplicateAboveMenuItemLabel"},duplicateBelowMenuItemLabel:{defaultMessage:"Duplicate below",id:"automations.actionContextMenu.duplicateBelowMenuItemLabel"},duplicatingMenuItemLabel:{defaultMessage:"Duplicating…",id:"automations.actionContextMenu.duplicatingMenuItemLabel"},editMenuItemLabel:{defaultMessage:"Edit",id:"automations.actionContextMenu.editMenuItemLabel"},moveDownMenuItemLabel:{defaultMessage:"Move down",id:"automations.actionContextMenu.moveDownMenuItemLabel"},moveUpMenuItemLabel:{defaultMessage:"Move up",id:"automations.actionContextMenu.moveUpMenuItemLabel"}});function P(e){const{actionStore:t,closeMenu:o}=e,{automationContextStore:a,maybePersistedTransactionActions:s}=(0,b.i)(),l=(0,i.O7)(),[c,u]=(0,n.useState)(),d=(0,r.VK)((()=>null==a?void 0:a.context.automationStore),[a]),p=(0,r.VK)((()=>(null==d?void 0:d.getActionIds())??[]),[d]),m=(0,r.VK)((()=>p.indexOf(t.id)),[t.id,p]),g=(0,r.VK)((()=>(0,M.r)(a,t)),[t,a]),h=(0,r.VK)((()=>{if(!g||!t.isType("update_pages"))return;const e=t.getConfigStore().getKeyStore("properties").getValue();return null==e?void 0:e[0]}),[t,g]),y=0===m,f=m===p.length-1,x=(0,n.useCallback)((()=>{u(void 0),null==o||o()}),[o]),S=(0,k.p)(),C=(0,r.VK)((()=>S.some((e=>e.type===t.getType()))),[t,S]),A=(0,n.useMemo)((()=>{if(d&&C)return async()=>{const e=s.createAndCommit({perform:e=>v.duplicateAutomationAction({environment:l,includeParenting:!0,insertionPoint:{beforeActionId:t.id},sourceActionStore:t,transaction:e}),userAction:"ActionContextMenu.duplicateAction"});await e.performResult.onComplete,x()}}),[t,d,l,x,s,C]),P=(0,n.useMemo)((()=>{if(d&&C)return async()=>{const e=s.createAndCommit({perform:e=>v.duplicateAutomationAction({sourceActionStore:t,environment:l,includeParenting:!0,insertionPoint:{afterActionId:t.id},transaction:e}),userAction:"ActionContextMenu.duplicateAction"});await e.performResult.onComplete,x()}}),[t,d,l,x,s,C]),V=(0,n.useCallback)((()=>{const e=null==a?void 0:a.context;return e?(s.createAndCommit({perform:o=>{v.removeAutomationAction({actionStore:t,clientContext:e,environment:l,transaction:o})},userAction:"ActionContextMenu.removeAction"}),x(),Promise.resolve()):Promise.resolve()}),[t,null==a?void 0:a.context,l,x,s]),F=(0,n.useMemo)((()=>{if(!y)return()=>{const e=null==a?void 0:a.context;if(!e)return Promise.resolve();s.createAndCommit({perform:t=>{const o=I(p,m-1,m);v.reorderAutomationActions({clientContext:e,newActionIds:o,transaction:t})},userAction:"ActionContextMenu.moveAction"}),x()}}),[p,null==a?void 0:a.context,m,x,s,y]),Z=(0,n.useMemo)((()=>{if(!f)return()=>{const e=null==a?void 0:a.context;if(!e)return Promise.resolve();s.createAndCommit({perform:t=>{const o=I(p,m+1,m);v.reorderAutomationActions({clientContext:e,newActionIds:o,transaction:t})},userAction:"ActionContextMenu.moveAction"}),x()}}),[p,null==a?void 0:a.context,m,x,s,f]),B=(0,n.useMemo)((()=>{if(g&&h)return function(){u({initialState:{actionId:t.id,propertyId:h,type:"eventActionProperty"},insertionPoint:void 0})}}),[t.id,g,h]),K=(0,n.useMemo)((()=>{if(0!==S.length)return()=>{u({initialState:{availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"},insertionPoint:{beforeActionId:t.id}})}}),[S.length,t.id]),_=(0,n.useMemo)((()=>{if(0!==S.length)return()=>{u({initialState:{availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"},insertionPoint:{afterActionId:t.id}})}}),[S.length,t.id]);return(0,T.jsxs)(T.Fragment,{children:[!c&&(0,T.jsx)(w,{onAddStepAbove:K,onAddStepBelow:_,onDelete:V,onDuplicateAbove:A,onDuplicateBelow:P,onEdit:B,onMoveDown:Z,onMoveUp:F}),c&&(0,T.jsx)(j.Z,{initialState:c.initialState,insertionPoint:c.insertionPoint,onClose:x})]})}function w(e){const{onAddStepAbove:t,onAddStepBelow:o,onDelete:i,onDuplicateAbove:r,onDuplicateBelow:h,onEdit:y,onMoveDown:v,onMoveUp:b}=e,k=(0,C.F)(),M=function(e){const{hasSeparator:t,onMoveDown:o,onMoveUp:i}=e,r=(0,n.useMemo)((()=>{if(i)return{action:i,key:"moveUp",render:e=>(0,T.jsx)(V,{...e,icon:(0,s.Z)({height:16,width:16}),children:(0,T.jsx)(m.FormattedMessage,{...A.moveUpMenuItemLabel})})}}),[i]),l=(0,n.useMemo)((()=>{if(o)return{action:o,key:"moveDown",render:e=>(0,T.jsx)(V,{...e,icon:(0,a.M)({height:16,width:16}),children:(0,T.jsx)(m.FormattedMessage,{...A.moveDownMenuItemLabel})})}}),[o]),c=[r,l].filter(g.$K);if(0===c.length)return;return{items:c,key:"moveSteps",render:e=>(0,T.jsx)(S.Z,{enableActionSheetTitle:!0,topBorder:t,...e})}}({onMoveDown:v,onMoveUp:b}),j=function(e){const{hasSeparator:t,onAddStepAbove:o,onAddStepBelow:i}=e,r=(0,n.useMemo)((()=>{if(o)return{action:o,key:"addStepAbove",render:e=>(0,T.jsx)(V,{...e,icon:(0,u.F)({height:16,width:16}),children:(0,T.jsx)(m.FormattedMessage,{...A.addStepAboveMenuItemLabel})})}}),[o]),a=(0,n.useMemo)((()=>{if(i)return{action:i,key:"addStepBelow",render:e=>(0,T.jsx)(V,{...e,icon:(0,c.H)({height:16,width:16}),children:(0,T.jsx)(m.FormattedMessage,{...A.addStepBelowMenuItemLabel})})}}),[i]),s=[r,a].filter(g.$K);if(0===s.length)return;return{items:s,key:"addSteps",render:e=>(0,T.jsx)(S.Z,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:Boolean(M),onAddStepAbove:t,onAddStepBelow:o}),P=function(e){const{hasSeparator:t,onDuplicateAbove:o,onDuplicateBelow:i}=e,[r,a]=(0,n.useState)(!1),s=(0,n.useMemo)((()=>{if(o)return{action:async()=>{a(!0);try{await o()}finally{a(!1)}},key:"duplicateAbove",render:e=>(0,T.jsx)(V,{...e,icon:(0,l.a)({height:16,width:16}),isLoading:r,children:r?(0,T.jsx)(m.FormattedMessage,{...A.duplicatingMenuItemLabel}):(0,T.jsx)(m.FormattedMessage,{...A.duplicateAboveMenuItemLabel})})}}),[r,o]),c=(0,n.useMemo)((()=>{if(i)return{action:async()=>{a(!0);try{await i()}finally{a(!1)}},key:"duplicateBelow",render:e=>(0,T.jsx)(V,{...e,icon:(0,l.a)({height:16,width:16}),isLoading:r,children:r?(0,T.jsx)(m.FormattedMessage,{...A.duplicatingMenuItemLabel}):(0,T.jsx)(m.FormattedMessage,{...A.duplicateBelowMenuItemLabel})})}}),[r,i]),u=[s,c].filter(g.$K);if(0===u.length)return;return{items:u,key:"duplicateSteps",render:e=>(0,T.jsx)(S.Z,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:Boolean(M||j),onDuplicateAbove:r,onDuplicateBelow:h}),w=function(e){const{hasSeparator:t,onDelete:o,onEdit:i}=e,r=(0,n.useMemo)((()=>{if(i)return{action:i,key:"edit",render:e=>(0,T.jsx)(V,{...e,icon:(0,d.R)({height:16,width:16}),children:(0,T.jsx)(m.FormattedMessage,{...A.editMenuItemLabel})})}}),[i]),a=(0,n.useMemo)((()=>{if(o)return{action:o,key:"delete",render:e=>(0,T.jsx)(V,{...e,icon:(0,p.y)({height:16,width:16}),children:(0,T.jsx)(m.FormattedMessage,{...A.deleteMenuItemLabel})})}}),[o]),s=[r,a].filter(g.$K);if(0===s.length)return;return{items:s,key:"otherActions",render:e=>(0,T.jsx)(S.Z,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:Boolean(M||j||P),onDelete:i,onEdit:y});return(0,T.jsx)(f.Z,{...k,children:(0,T.jsx)(x.Z,{type:x.i.Vertical,sections:[M,j,P,w].filter(g.$K),initialFocus:0})})}function V(e){const{children:t,icon:o,isLoading:n,...i}=e,r=n?(0,T.jsx)(y.Z,{}):o;return(0,T.jsx)(h.Z,{...i,disabled:n,disabledFeedback:n,icon:r,title:t})}function I(e,t,o){if(t<0||t>=e.length||o<0||o>=e.length)return e;const n=[...e];return n[t]=e[o],n[o]=e[t],n}},838862:(e,t,o)=>{o.d(t,{Z:()=>we});var n=o(667294),i=o(886628),r=o(401898),a=o(991738),s=(o(757658),o(443261)),l=o.n(s),c=o(800480),u=o(724405),d=o(603865),p=o(102647),m=o(12396),g=o(509999),h=o(665422),y=o(605257),f=o(718844),x=o(709291),S=o(552275),v=o(268894),b=o(478140),C=o(632163),k=o(974420),M=o(672495),j=o(849117),T=o(623879),A=o(741195),P=o(433929),w=o(563474),V=o(44041),I=o(535057),F=o(143627),Z=o(312455),B=o(595193),K=o(161927),_=o(785893);const R=(0,x.defineMessages)({searchInputPlaceholder:{id:"automationEventActionMenu.searchInputPlaceholder.label",defaultMessage:"Search for action…"}}),N=["automation_actions","update_this_page_actions"],D=["update_this_page_actions","automation_actions"];function L(e){const{automationActionMenuStore:t,hasSearch:o,hasUpdateThisPagePropertyActions:a,onClose:s}=e,{isMobile:u}=(0,c.Fy)(),m=(0,c.O7)(),g=(0,x.useIntl)(),h=(0,w.D)(),{automationContextStore:y,automationStore:v,maybePersistedTransactionActions:k,onActionAdded:R}=(0,Z.i)(),L=(0,i.VK)((()=>null==y?void 0:y.getCollectionStore()),[y]),E=(0,K.p)(),U=(0,i.VK)((()=>null==y?void 0:y.context.type),[y]),$="event"===U,G=(0,n.useMemo)((()=>$?D:N),[$]),q=(0,i.VK)((()=>t.getInsertionPoint()),[t]),[Y,Q]=n.useState(""),X=(0,i.VK)((()=>o?function(e){const{availableActions:t,searchInput:o}=e;if(0===t.length)return[];const n=new Map,i=t.map((e=>{const t=P.default.formatMessage(e.display.name);return n.set(e.type,t),t})),r=new Set(l().filter(o,i).map((e=>{let{original:t}=e;return t})));return t.filter((e=>{const t=n.get(e.type);return t&&r.has(t)}))}({availableActions:E,searchInput:Y}):E),[E,o,Y]),J=(0,n.useCallback)((e=>{if(!v)return;const t=v.getSpaceId(),{performResult:o}=k.createAndCommit({userAction:"AutomationActionList.addAction",perform:o=>F.addAutomationAction({actionId:(0,A.TS)({environment:m,table:f.Xj,spaceId:t}),actionType:e,automationStore:v,environment:m,insertionPoint:q,intl:g,transaction:o})});o&&((0,p.eI)(h,{automation_id:v.id,automation_action_id:o.id,automation_action_type:e}),null==R||R(o)),s()}),[v,k,s,m,q,g,h,R]),ee=(0,i.VK)((()=>a&&L&&v?function(e){const{automationStore:t,collectionStore:o,searchInput:n}=e,i=new Set(t.getActionStores().flatMap((e=>e.isType("update_pages")?e.getConfigStore().getKeyStore("properties").getValue()??[]:[]))),a=o.getFormat(),s=o.getSchema(),c=(0,d.cO)({collectionFormat:a,collectionSchema:s,filter:e=>{let[t]=e;return!i.has(t)}}),u=new Map,p=c.map((e=>{const t=s[e];if(t){const o=`${t.name} ${T.SO[t.type]}`;return u.set(e,o),o}})).filter(r.$K),m=new Set(l().filter(n,p).map((e=>{let{original:t}=e;return t})));return c.filter((e=>{const t=u.get(e);return t&&m.has(t)}))}({automationStore:v,collectionStore:L,searchInput:Y}):[]),[v,L,a,Y]),te=(0,i.VK)((()=>null==L?void 0:L.getSchema()),[L]),oe=(0,n.useCallback)((()=>{s(),V.y(m,{for:"plus",from:"database_automation_action_item"})}),[m,s]),ne=(0,j.Rr)({contextType:U,environment:m}),ie=(0,i.VK)((()=>!(0,I.sX)()),[]),re=0===E.length&&ie,ae=(0,n.useMemo)((()=>{const e=[];o&&!re&&e.push(function(e){const{onChange:t,value:o}=e;return{items:[{action:()=>{},key:"search-input",render:e=>(0,_.jsx)(O,{...e,onChange:t,value:o})}],key:"search",render:e=>(0,_.jsx)(M.Z,{...e})}}({onChange:e=>Q(e.target.value),value:Y}));const n=G.reduce(((e,o)=>{if("automation_actions"===o){const t=function(e){const{actionRegistryItems:t,hasTopBorder:o,onMenuItemClick:n}=e,i=t.map((e=>function(e){const{actionRegistryItem:t,onClick:o}=e;return{action:()=>o(t.type),key:`${t.type}_action`,render:e=>(0,_.jsx)(W,{...e,actionRegistryItem:t})}}({actionRegistryItem:e,onClick:n}))).filter(r.$K);if(0===i.length)return;return{key:"automation_actions_section",items:i,render:e=>(0,_.jsx)(M.Z,{...e,topBorder:o})}}({actionRegistryItems:X,hasTopBorder:e.length>0,onMenuItemClick:J});t&&e.push(t)}else if("update_this_page_actions"===o){const o=te&&!(ie&&$)&&function(e){const{automationActionMenuStore:t,hasTopBorder:o,normalizedBlockSchema:n,propertyIds:i}=e;if(0===i.length)return;const a=i.map((e=>{const o=n[e];if(o)return function(e){const{automationActionMenuStore:t,propertyId:o,propertySchema:n}=e;return{action:()=>{t.pushSettingsItem({actionId:void 0,propertyId:o,type:"eventActionProperty"})},key:`update_this_page_property_${o}_action`,render:e=>(0,_.jsx)(H,{...e,propertySchema:n})}}({automationActionMenuStore:t,propertyId:e,propertySchema:o})})).filter(r.$K);if(0===a.length)return;return{key:"automation_update_this_page_section",items:a,render:e=>(0,_.jsx)(M.Z,{...e,title:(0,_.jsx)(x.FormattedMessage,{id:"automationEventActionMenu.pagePropertiesEditedSection.title",defaultMessage:"Edit property"}),topBorder:o})}}({automationActionMenuStore:t,hasTopBorder:e.length>0,normalizedBlockSchema:te,propertyIds:ee});o&&e.push(o)}else(0,r.t1)(o);return e}),[]);return 0===n.length?e.push({key:"no_results_section",items:[{key:"no_results_item",action:()=>{},render:e=>(0,_.jsx)(S.Z,{...e,disabled:!0,disabledFeedback:!0,title:(0,_.jsx)(x.FormattedMessage,{defaultMessage:"No results",id:"automations.automationEventActionMenu.noResultsItem"})})}],render:e=>(0,_.jsx)(M.Z,{...e})}):e.push(...n),ie&&ne&&e.push(function(e){const{onUpsellClick:t,hasTopBorder:o}=e;return{key:"upsell_section",items:[{action:t,key:"upsell_item",render:e=>(0,_.jsx)(z,{...e})}],render:e=>(0,_.jsx)(M.Z,{...e,topBorder:o})}}({hasTopBorder:e.length>0,onUpsellClick:oe})),e}),[t,ee,X,ne,te,o,$,ie,re,J,oe,Y,G]),se=(0,B.F)({paddingBottom:6,paddingTop:6,width:266});return u||(se.maxHeight="50vh"),(0,_.jsx)(b.Z,{...se,children:(0,_.jsx)(C.Z,{initialFocus:0,sections:ae,type:C.i.Vertical})})}const O=(0,n.forwardRef)((function(e,t){const{onChange:o,value:n,...i}=e,r=(0,x.useIntl)(),a=(0,u.yK)((()=>({input:{margin:0,padding:0}})),[]);return(0,_.jsx)(v.ZP,{...i,inputOuterStyle:{margin:0},onChange:o,placeholder:r.formatMessage(R.searchInputPlaceholder),ref:t,style:a.input,value:n})}));const W=(0,n.forwardRef)((function(e,t){const{actionRegistryItem:o,...n}=e;return(0,_.jsx)(S.Z,{...n,icon:(0,_.jsx)(E,{actionRegistryItem:o}),ref:t,right:"send_in_app_notification"===o.type&&(0,_.jsx)(k.Z,{}),title:(0,_.jsx)(x.FormattedMessage,{...o.display.name})})}));function E(e){const{actionRegistryItem:t}=e,o="slack_notification"===t.type,n=(0,u.yK)((e=>({icon:{fill:o?void 0:e.blueColor,height:"auto",width:o?16:12},iconWrap:{alignItems:"center",background:o?void 0:"rgba(35, 131, 226, 0.14)",borderRadius:4,display:"flex",height:20,justifyContent:"center",width:20}})),[o]);return(0,_.jsx)("div",{style:n.iconWrap,children:t.display.icon(n.icon)})}const H=(0,n.forwardRef)((function(e,t){const{propertySchema:o,...n}=e,i=(0,u.yK)((e=>({chevronIcon:{marginInlineStart:6,width:12,height:"auto"}})),[]);return(0,_.jsx)(S.Z,{...n,icon:(0,_.jsx)(U,{propertySchema:o}),ref:t,right:(0,y.o)(i.chevronIcon),title:o.name})}));function U(e){const{propertySchema:t}=e,o=(0,u.Fg)(),n=(0,u.yK)((e=>({icon:{fill:e.blueColor,width:12},iconWrap:{alignItems:"center",background:"rgba(35, 131, 226, 0.14)",borderRadius:4,display:"flex",height:20,justifyContent:"center",width:20}})),[]);return(0,_.jsx)("div",{style:n.iconWrap,children:(0,_.jsx)(m.ZP,{icon:t.icon,size:16,style:n.icon,theme:o,type:t.type})})}function z(e){const t=(0,u.yK)((e=>({aliasIcon:{height:"auto",marginBlockStart:2,width:12},icon:{fill:e.icon.yellow,height:"100%",width:"100%"},iconWrap:{background:e.accentColors.yellow[50],borderRadius:4,height:20,padding:3,width:20},right:{alignSelf:"start"}})),[]);return(0,_.jsx)(S.Z,{...e,caption:(0,_.jsx)(x.FormattedMessage,{defaultMessage:"Automatically set properties, create new pages, and more with automations.",id:"automationEventActionMenu.upsellSection.caption"}),icon:(0,_.jsx)("div",{style:t.iconWrap,children:(0,h.K)(t.icon)}),right:(0,g.J)(t.aliasIcon),rightStyle:t.right,shouldWrapCaption:!0,title:(0,_.jsx)(x.FormattedMessage,{defaultMessage:"Upgrade for more actions",id:"automationEventActionMenu.upsellSection.title"})})}var $=o(710450),G=o(830823),q=o(399036),Y=o(576218),Q=o(76233),X=o(137810),J=o(709953),ee=o(908570),te=o(25742),oe=o(839477),ne=o(625757);const ie=(0,x.defineMessages)({menuHeaderTitle:{defaultMessage:"Set {propertyName} to",id:"automations.eventActionProperty.menuHeaderTitle"}});function re(e){var t;const{actionId:o,automationActionMenuStore:r,onClose:a,propertyId:s}=e,{automationContextStore:l,automationStore:u,maybePersistedTransactionActions:d,onActionAdded:m}=(0,Z.i)(),g=(0,x.useIntl)(),h=(0,c.O7)(),y=(0,w.D)(),S=(0,i.VK)((()=>r.getInsertionPoint()),[r]),v=(0,i.VK)((()=>null==l?void 0:l.getCollectionStore()),[l]),b=(0,n.useMemo)((()=>v?{collectionStore:v,property:s,type:"collection"}:void 0),[v,s]),C=(0,i.VK)((()=>null==u?void 0:u.getSpaceId()),[u]),k=o??(0,A.TS)({environment:h,table:f.Xj,spaceId:C}),M=(0,i.VK)((()=>{const e=((null==u?void 0:u.getActionStores())??[]).find((e=>e.id===k));if(e&&e.isType("update_pages"))return e}),[u,k]),j=(0,i.VK)((()=>null==v?void 0:v.getSchema()[s]),[v,s]),T=(0,n.useMemo)((()=>!!j&&("multi_select"===j.type||(0,q.en)(j)&&1!==j.limit)),[j]),P=Boolean(j&&"button"!==j.type&&"rollup"!==j.type&&"formula"!==j.type&&"text"===(0,G.vc)(j.type)),V=Boolean(j&&"button"!==j.type&&"rollup"!==j.type&&"formula"!==j.type&&"number"===(0,G.vc)(j.type)),I=Boolean(j&&"date"===j.type),B=Boolean(j&&"status"===j.type),K=(0,i.VK)((()=>{if(v&&j)return(0,Y.qW)(v.getSpaceShardedPointer(),s,j)}),[v,j,s]),R=(0,i.VK)((()=>{if(M)return M.getConfigStore().getKeyStore("values").getKeyStore(s).getValue()}),[M,s]),[N,D]=(0,n.useState)(R),L=(0,n.useRef)(null==R?void 0:R.value),O=(0,n.useMemo)((()=>{var e;return(0,Y.A6)(null==N||null===(e=N.value)||void 0===e?void 0:e.value)}),[null==N||null===(t=N.value)||void 0===t?void 0:t.value]),W=(0,te.z)({actionType:"update_pages",actionId:null==M?void 0:M.id}),E=(0,n.useCallback)((e=>{if(!u)return;const{performResult:t}=d.createAndCommit({perform:t=>{if(!M)return F.addAutomationAction({actionId:k,actionType:"update_pages",automationStore:u,config:{properties:[s],target:{id:(0,$.J0)(),type:"variable"},values:{[s]:{action:"replace",value:e}}},environment:h,intl:g,insertionPoint:S,transaction:t});J.sW({data:{[s]:{action:"replace",value:e}},store:M.getConfigStore().getKeyStore("values"),transaction:t})},userAction:"UpdateThisPagePropertyActionMenu.saveChanges"});t&&((0,p.eI)(y,{automation_id:u.id,automation_action_id:t.id,automation_action_type:"update_pages"}),null==m||m(t))}),[M,u,h,y,k,S,g,d,m,s]),H=(0,n.useCallback)((()=>{E(L.current),a()}),[E,a]),U=(0,n.useCallback)((e=>{if(L.current=e,P||V||T)D({action:"replace",value:e});else if(I){const t=(0,Y.A6)(null==e?void 0:e.value);0===t.length?H():(0,Y.S3)(t[0])&&(0,Q.fpG)(t[0])&&D({action:"replace",value:e})}}),[I,P,V,T,H]),z=(0,ne.F)({automationTriggerActionMenuStore:r,leftStyle:{flexGrow:0},onClose:H,onDone:T||P||V?H:void 0,rightStyle:{flexGrow:0},title:(0,_.jsx)("div",{style:{display:"inline-flex",minWidth:0,whiteSpace:"pre"},children:g.formatMessage(ie.menuHeaderTitle,{propertyName:(0,_.jsx)("div",{style:{...X.Z.textOverflowStyle},children:(null==j?void 0:j.name)??""})})}),titleStyle:{minWidth:0}});if(!(j&&K&&l&&b))return null;const re=(0,oe.li)(j.type);return(0,_.jsx)(ee.a,{formulaValueContext:b,context:b,contextStore:l,currentSimpleFormulaValueTokens:O,disabled:!1,formulaTypecheckContextValues:W,menuProps:z,onChange:U,onClose:H,showClearButton:!B,type:K,value:null==N?void 0:N.value,...re})}var ae=o(841892),se=o(977657),le=o(332161),ce=o(940470),ue=o(389475),de=o(489728),pe=o(158297),me=o(18441),ge=o(80444),he=o(530874),ye=o(206258);function fe(e){const{type:t,automationActionMenuStore:o,onClose:n}=e,r=Ce(),a=(0,i.VK)((()=>{var e;return null===(e=ge.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),s=(0,i.VK)((()=>ge.default.state.currentUserStore),[]),l=(0,i.VK)((()=>{if("connectToSlackReconnect"===t&&s)return(0,ye.Kv)(s,{table:le.PJ,id:e.externalBotId,spaceId:a}).getValue()}),[a,s,e,t]);let c,u=be({viewType:"connectToSlackDefault"});if("connectToSlackReconnect"===t){if(!l)return null;const{accountName:e,organizationName:t}=(0,me.jg)(l);c=(0,me.jc)(l),u=be({viewType:"connectToSlackReconnect",accountName:e,organizationName:t})}return(0,_.jsx)(ne.Z,{type:"custom",automationTriggerActionMenuStore:o,onClose:n,children:(0,_.jsx)(M.Z,{children:(0,_.jsxs)("div",{style:r.container,children:[(0,_.jsx)(Se,{}),(0,_.jsxs)("div",{style:r.connectToSlackBody,children:[(0,_.jsx)("div",{style:r.connectToSlackTitleText,children:ve(t)}),(0,_.jsx)("div",{style:r.connectToSlackDescriptionText,children:u})]}),(0,_.jsx)(xe,{...e,slackWorkspaceId:c})]})})})}function xe(e){const{automationActionMenuStore:t,slackWorkspaceId:o}=e,n=(0,c.O7)(),a=Ce(),s=(0,i.VK)((()=>{var e;return null===(e=ge.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),l=(0,i.VK)((()=>he.Z.integrations.state.find((e=>e.id===se.nO))),[]);return l&&s?(0,_.jsxs)("div",{style:a.buttonGroup,children:[(0,_.jsx)(pe.Z,{style:a.connectToSlackButton,isLarge:!0,onClick:async()=>{const i=await ue.hM({environment:n,integration:l,spaceId:s,from:"collection_view_settings",options:{slackWorkspaceId:o}});ce.x.isFail(i)?t.replaceSettingsItem({actionStore:e.actionStore,type:"selectWorkspace"}):"connectToSlackReconnect"===e.type||("connectToSlackDefault"===e.type?i.value.externalAuthentication?t.replaceSettingsItem({type:"selectChannelNew",currentExternalAuthentication:i.value.externalAuthentication,actionStore:e.actionStore}):t.replaceSettingsItem({actionStore:e.actionStore,type:"selectWorkspace"}):(0,r.t1)(e))},children:(0,_.jsx)(x.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.connectButton.label",defaultMessage:"Connect"})}),(0,_.jsx)(de.Z,{style:a.cancelButton,isLarge:!0,onClick:()=>{t.popSettingsItem()},children:(0,_.jsx)(x.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.cancelButton.label",defaultMessage:"Cancel"})})]}):null}function Se(){const e=Ce();return(0,_.jsx)("div",{children:(0,_.jsx)("img",{src:ae.Z.images.externalIntegrations.slackIconPng,style:e.slackIcon})})}function ve(e){return"connectToSlackDefault"===e?(0,_.jsx)(x.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.title",defaultMessage:"Connect to Slack"}):"connectToSlackReconnect"===e?(0,_.jsx)(x.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.reconnect.title",defaultMessage:"Reconnect to Slack"}):void(0,r.t1)(e)}function be(e){const{viewType:t}=e;return"connectToSlackDefault"===t?(0,_.jsx)(x.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.description",defaultMessage:"Get notified in channels, see rich previews, and more."}):"connectToSlackReconnect"===t?(0,_.jsx)(x.FormattedMessage,{id:"AutomationSlackConnectToSlackView.reconnect.description",defaultMessage:'Reconnect your Slack account ({accountName}) on {hasOrganizationName, select, true {"{organizationName}"} other {your Slack workspace}} to resume your notifications.',values:{accountName:e.accountName,hasOrganizationName:(0,r.$K)(e.organizationName),organizationName:e.organizationName}}):void(0,r.t1)(t)}function Ce(){return(0,u.yK)((e=>({container:{display:"flex",flexDirection:"column",margin:"10px 15px",justifyContent:"center",textAlign:"center"},connectToSlackBody:{margin:"0px 25px"},connectToSlackTitleText:{marginBottom:2,fontWeight:X.Z.fontWeight.semibold},connectToSlackDescriptionText:{fontSize:13,color:e.mediumTextColor},slackIcon:{width:23,height:"auto"},buttonGroup:{margin:"10px 10px 0px 10px"},connectToSlackButton:{width:"100%"},cancelButton:{color:e.mediumTextColor,width:"100%",justifyContent:"center",fontWeight:X.Z.fontWeight.medium,fontSize:13,marginTop:8}})),[])}var ke=o(186538);function Me(e){const{actionStore:t,automationActionMenuStore:o,onClose:i}=e,{maybePersistedTransactionActions:a}=(0,Z.i)(),s=n.useCallback(((e,o)=>{t&&a.createAndCommit({perform:n=>{J.sW({data:{config:{external_bot_id:o.parent_id,target:{id:e.id,name:"",type:e.type}}},store:t,transaction:n})},userAction:"SlackSelectChannelMenu.handleChannelSelect"}),i()}),[t,a,i]),l=(0,n.useCallback)((()=>{const e=o.getState().stack;e.length<2||("selectWorkspace"===e[e.length-2].type?o.popSettingsItem():o.replaceSettingsItem({actionStore:t,type:"selectWorkspace"}))}),[t,o]);return(0,_.jsx)(ke.ZP,{currentExternalAuthentication:e.currentExternalAuthentication,currentNotificationChannel:"selectChannelNew"===e.type?void 0:"selectChannelUpdate"===e.type?e.currentNotificationChannel:(0,r.t1)(e),onClose:i,onNotificationChannelSelect:s,onNewSlackAccountAdded:l,renderMenu:e=>(0,_.jsx)(ne.Z,{type:"default",automationTriggerActionMenuStore:o,headerTitle:(0,_.jsx)(x.FormattedMessage,{id:"notificationRuleSettings.selectChannelView.title",defaultMessage:"Select Slack channel"}),sections:e,onClose:i})})}o(430541);var je=o(435840);const Te=(0,x.defineMessages)({workspaceSearchPlaceholder:{id:"notificationRuleSettings.selectWorkspaceView.searchInput.placeholder",defaultMessage:"Search…"}});function Ae(e){const{onWorkspaceSelect:t,renderMenu:o,workspaceFilter:r,onNewSlackAccountAdded:a}=e,s=(0,c.O7)(),{isMobile:l}=(0,c.Fy)(),d=(0,i.VK)((()=>{var e;return null===(e=ge.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),p=(0,i.VK)((()=>(0,me.P9)(he.Z.completeSlackAuthentications.state,r)),[r]),m=(0,i.VK)((()=>he.Z.integrations.state.find((e=>e.id===se.nO))),[]),[g,h]=n.useState(""),f=(0,u.yK)((e=>({chevronRight:{width:12,height:"auto",color:e.lightIconColor}})),[]);if(!m)return null;const b=Object.entries((0,me.YJ)(p,g)).map(((e,o)=>{let[n,i]=e;return{key:n,items:i.map((e=>{let{workspaceName:o,externalAuthentication:n}=e;return{key:n.id,action:()=>{t(n)},render:e=>(0,_.jsx)(S.Z,{...e,title:o??(0,_.jsx)(x.FormattedMessage,{id:"notificationRuleSettings.selectWorkspace.untitledWorkspace",defaultMessage:"Slack workspace"}),right:(0,y.o)(f.chevronRight)})}})),render:e=>(0,_.jsx)(M.Z,{...e,title:n,topBorder:0!==o})}}));return b.unshift({key:"search-input-section",items:[{key:"search-input-item",action:()=>{},render:e=>(0,_.jsx)("div",{children:(0,_.jsx)(v.ZP,{...e,inputLeft:(0,_.jsx)(v.f_,{icon:je.R}),showClearButton:!0,placeholder:P.default.formatMessage(Te.workspaceSearchPlaceholder),focus:!l||void 0,value:g,onChange:e=>{h(e.target.value)}})})}],render:e=>(0,_.jsx)(M.Z,{...e})}),b.push({key:"add-another-slack-account-section",items:[{key:"add-another-slack-account-item",action:async()=>{if(!d)return;const e=await ue.hM({environment:s,integration:m,spaceId:d,from:"collection_view_settings"});ce.x.isFail(e)||e.value.externalAuthentication&&(t(e.value.externalAuthentication),null==a||a())},render:e=>(0,_.jsx)(S.Z,{...e,icon:(0,_.jsx)("img",{src:ae.Z.images.externalIntegrations.slackIconPng,style:{width:18,height:"auto"}}),title:(0,_.jsx)(x.FormattedMessage,{id:"notificationRuleSettings.selectWorkspaceView.setupAnotherSlackAccount.label",defaultMessage:"Add another Slack account"})})}],render:e=>(0,_.jsx)(M.Z,{...e,topBorder:!0})}),(0,_.jsx)(_.Fragment,{children:o(b)})}function Pe(e){const{automationActionMenuStore:t,onClose:o}=e,i=n.useCallback((o=>{t.pushSettingsItem({actionStore:e.actionStore,type:"selectChannelNew",currentExternalAuthentication:o})}),[t,e.actionStore]);return(0,_.jsx)(Ae,{onWorkspaceSelect:i,renderMenu:e=>(0,_.jsx)(ne.Z,{type:"default",automationTriggerActionMenuStore:t,headerTitle:(0,_.jsx)(x.FormattedMessage,{id:"notificationRuleSettings.selectSlackWorkspace.title",defaultMessage:"Select Slack workspace"}),sections:e,onClose:o})})}function we(e){const{initialState:t,insertionPoint:o,onClose:s}=e,l=(0,i.VK)((()=>{const e=new a.H0;return e.setState({insertionPoint:o,stack:[t]}),e}),[t,o]),c=(0,i.VK)((()=>l.getCurrentTab()),[l]),u=(0,n.useCallback)((()=>null==s?void 0:s()),[s]);if(!c)return null;if("connectToSlackDefault"===c.type)return(0,_.jsx)(fe,{actionStore:c.actionStore,automationActionMenuStore:l,onClose:u,type:"connectToSlackDefault"});if("connectToSlackReconnect"===c.type)return(0,_.jsx)(fe,{actionStore:c.actionStore,automationActionMenuStore:l,externalBotId:c.externalBotId,notificationActionConfigStore:c.notificationActionConfigStore,onClose:u,type:"connectToSlackReconnect"});if("selectWorkspace"===c.type)return(0,_.jsx)(Pe,{actionStore:c.actionStore,automationActionMenuStore:l,onClose:u});if("selectChannelNew"===c.type)return(0,_.jsx)(Me,{actionStore:c.actionStore,automationActionMenuStore:l,currentExternalAuthentication:c.currentExternalAuthentication,onClose:u,type:"selectChannelNew"});if("selectChannelUpdate"===c.type)return(0,_.jsx)(Me,{actionStore:c.actionStore,automationActionMenuStore:l,currentExternalAuthentication:c.currentExternalAuthentication,currentNotificationChannel:c.currentNotificationChannel,onClose:u,type:"selectChannelUpdate"});if("eventActions"===c.type)return(0,_.jsx)(L,{automationActionMenuStore:l,hasUpdateThisPagePropertyActions:c.hasUpdateThisPagePropertyActions,hasSearch:c.hasSearch,onClose:u});if("eventActionProperty"===c.type){const{propertyId:e,actionId:t}=c;return(0,_.jsx)(re,{actionId:t,automationActionMenuStore:l,onClose:u,propertyId:e})}return(0,r.t1)(c)}},280826:(e,t,o)=>{o.d(t,{eQ:()=>P,pZ:()=>I});var n=o(667294),i=o(800480),r=o(886628),a=o(724405),s=o(940694),l=o(890199),c=o(709291),u=o(653965),d=o(401898),p=o(137810),m=o(231945),g=o(186538),h=o(628020),y=o(367669),f=o(61766),x=o(530874),S=o(868016),v=o(241301),b=o(312455),C=o(435294),k=o(200745),M=o(838862),j=o(140190),T=o(847957),A=o(785893);function P(e){const{actionStore:t}=e,{automationContextStore:o,automationStore:i,disabled:a,suppressActionErrors:l}=(0,b.i)(),u=(0,s.z)("slack_notification"),d=Boolean(a),p=R(i)?(0,A.jsx)(v.So,{content:(0,A.jsx)(c.FormattedMessage,{...v.Mm.slackNotificationAuthenticationError})}):null,m=(0,r.qz)(void 0,f.Z),g=(0,n.useCallback)((()=>m.reset()),[m]),h=(0,n.useMemo)((()=>(0,A.jsx)(k.e,{actionStore:t,closeMenu:g})),[t,g]),y=(0,n.useMemo)((()=>!l.includes(t.id)),[l,t]),x=(0,v.TU)({actionId:t.id,contextStore:o,errorKey:"external_bot_id",shouldShow:y}),S=(0,v.TU)({actionId:t.id,contextStore:o,errorKey:"target",shouldShow:y});return(0,A.jsx)(T.Ao,{actionMenu:h,buttonPopupStore:m,disabled:d,children:(0,A.jsx)(T.vu,{actionRegistryItem:u,disabled:d,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:(0,A.jsx)(w,{actionStore:t,automationStore:i,disabled:d,errorMessage:p??x??S})})})}function w(e){const{actionStore:t,automationStore:o,disabled:n,errorMessage:i}=e,r=(0,a.yK)((()=>({picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50}})),[]);return(0,A.jsx)("div",{style:r.title,children:(0,A.jsx)(c.FormattedMessage,{defaultMessage:"<span><b>Notify</b> </span>{slackTargetPicker}",id:"automations.slackNotificationAction.action.title",values:{b:e=>(0,A.jsx)("b",{style:{fontWeight:p.Z.fontWeight.medium},children:e}),slackTargetPicker:(0,A.jsx)("div",{style:r.picker,children:(0,A.jsx)(V,{actionStore:t,automationStore:o,disabled:n,errorMessage:i})}),span:e=>(0,A.jsx)("span",{style:r.span,children:e})}})})}function V(e){const{actionStore:t,automationStore:o,disabled:i,errorMessage:a}=e,s=(0,r.VK)((()=>{const e=t.getConfigStore(),o=e.getKeyStore("external_bot_id").getValue();if((0,u.xb)(o))return!1;const n=e.getKeyStore("target").getValue();return!(0,u.xb)(null==n?void 0:n.id)}),[t]),l=(0,r.qz)(void 0,f.Z),p=(0,n.useCallback)((()=>l.reset()),[l]),g=function(e){const{actionStore:t,automationStore:o}=e,[n,i]=(0,r.VK)((()=>{const e=t.getConfigStore();return[e.getKeyStore("target").getValue(),e.getKeyStore("external_bot_id").getValue()]}),[t]),a=R(o),s=_(t),l=(0,r.VK)((()=>x.Z.completeSlackAuthentications.state.length??0),[]);if((0,d.$K)(n)&&(0,d.$K)(i))return a?{actionStore:t,externalBotId:i,notificationActionConfigStore:t,type:"connectToSlackReconnect"}:(0,d.$K)(s)?{actionStore:t,currentExternalAuthentication:s,currentNotificationChannel:n,type:"selectChannelUpdate"}:{actionStore:t,type:"connectToSlackDefault"};return 0===l?{actionStore:t,type:"connectToSlackDefault"}:l>1?{actionStore:t,type:"selectWorkspace"}:{actionStore:t,type:"selectChannelNew"}}({actionStore:t,automationStore:o}),h=(0,C.d)();return(0,A.jsx)(m.ZP,{alignmentToOrigin:m.vR.End,buttonPopupStore:l,disabled:i,originGap:0,placementToOrigin:m.pO.Bottom,popupType:h,renderOrigin:e=>(0,A.jsx)(j.S,{...e,disabled:i,isCompact:!0,isError:Boolean(a),hasActionRequired:!s,tooltipMessage:a,children:s?(0,A.jsx)(I,{actionStore:t}):(0,A.jsx)(c.FormattedMessage,{id:"slackNotificationAction.targetPicker.noTarget",defaultMessage:"Select Slack channel"})}),render:()=>(0,A.jsx)(M.Z,{initialState:g,onClose:p})})}function I(e){const{actionStore:t}=e,o=(0,i.O7)(),a=(0,r.VK)((()=>{const e=(0,h.RM)();return!(0,d.$K)(e)||Boolean((0,y.IJ)(o,e))}),[o]),s=function(e){const t=(0,i.O7)(),o=(0,r.VK)((()=>{var t;return null===(t=e.getConfig())||void 0===t||null===(t=t.target)||void 0===t?void 0:t.id}),[e]),a=_(e);return n.useEffect((()=>{a&&(0,g.uV)({botId:a.id,environment:t,spaceId:a.space_id})}),[t,a]),(0,r.VK)((()=>{if(a&&o){const e=S.Z.getStateForBot(a.id).channels[o];if(e)return e}}),[o,a])}(t);return a||!(0,d.$K)(s)?(0,A.jsx)(K,{}):"me"===s.type?(0,A.jsx)(B,{channelName:s.name}):"private"===s.type?(0,A.jsx)(Z,{channelName:s.name}):"public"===s.type?(0,A.jsx)(F,{channelName:s.name}):void(0,d.t1)(s.type)}function F(e){return(0,A.jsx)("span",{style:p.Z.textOverflowStyle,children:`#${e.channelName}`})}function Z(e){const{channelName:t}=e,o=N();return(0,A.jsxs)("div",{style:o.container,children:[(0,l.b)(o.lockIcon),(0,A.jsx)("span",{style:p.Z.textOverflowStyle,children:t})]})}function B(e){const{channelName:t}=e;return(0,A.jsx)("span",{style:p.Z.textOverflowStyle,children:`@${t}`})}function K(){const e=N();return(0,A.jsxs)("div",{style:e.container,children:[(0,l.b)(e.lockIcon),(0,A.jsx)("span",{style:p.Z.textOverflowStyle,children:(0,A.jsx)(c.FormattedMessage,{defaultMessage:"Hidden channel",id:"slackNotificationAction.slackTargetChannel.hiddenName"})})]})}function _(e){return(0,r.VK)((()=>{const t=e.getConfigStore().getKeyStore("external_bot_id").getValue();if(t)return x.Z.completeSlackAuthentications.state.find((e=>t===e.id))}),[e])}function R(e){return(0,r.VK)((()=>"disabled_auth"===e.getStatus()),[e])}function N(){const{isMobile:e}=(0,i.Fy)(),t=e?p.Z.fontSize.UISmall.mobile:p.Z.fontSize.UISmall.desktop;return(0,a.yK)((()=>({container:{alignItems:"baseline",display:"inline-flex",gap:2,minWidth:50,width:"100%"},lockIcon:{alignSelf:"center",height:"auto",width:t}})),[t])}},916269:(e,t,o)=>{o.d(t,{B:()=>ce,r:()=>ue});var n=o(667294),i=o(886628),r=o(335102),a=o(312455),s=(o(21703),o(800480)),l=o(724405),c=o(940694),u=o(576205),d=o(143690),p=o(984619),m=o(709291),g=o(940470),h=o(401898),y=o(137810),f=o(709953),x=o(210228),S=o(51592),v=o(231945),b=o(776798),C=o(721396),k=o(311335),M=o(61766),j=o(206258),T=o(241301),A=o(435294),P=o(200745),w=o(839477),V=o(140190),I=o(808808),F=o(847957),Z=o(694166),B=o(806758),K=o(708982),_=o(478140),R=o(672495),N=o(566890),D=o(595193),L=o(785893);function O(e){const{filter:t,onChange:o,onClose:r,collectionStore:a}=e,s=(0,N.DK)(),l=(0,i.VK)((()=>a.getSchema()),[a]),c=(0,D.F)({minWidth:300,tabletBehavior:"actionSheet"}),d=(0,n.useCallback)(((e,t)=>o(t)),[o]),p=(0,n.useCallback)((()=>{o(void 0),r()}),[o,r]);return(0,L.jsxs)(_.Z,{...c,children:[(0,L.jsx)(K.D,{children:(0,L.jsx)(B.Pq,{collectionViewId:"Automation.FilterMenu",collectionContextStore:s,collectionViewType:"table",combinatorFilter:t||u.hh,index:0,level:0,onChange:d,parentStore:a,schema:l})}),(0,L.jsx)(R.Z,{topBorder:!0,children:(0,L.jsx)(Z.Z,{title:(0,L.jsx)(m.FormattedMessage,{defaultMessage:"Delete filter",id:"automations.AutomationCombinatorFilterPopup.deleteFilter.label"}),onClick:p})})]})}const W=(0,m.defineMessages)({multipleTargetsFilter:{defaultMessage:"<span>Edit </span>{filterPicker}",id:"automations.UpdatePagesAction.multipleTargetsFilter"},multipleTargetsPicker:{defaultMessage:"<span>in </span>{targetPicker}",id:"automations.UpdatePagesAction.multipleTargetsPicker"},singleTarget:{defaultMessage:"<span>Edit </span>{targetPicker}",id:"automations.UpdatePagesAction.singleTarget"}});function E(e){const{actionStore:t}=e,o=(0,s.O7)(),{automationContextStore:r,disabled:l,suppressActionErrors:u}=(0,a.i)(),p=(0,i.VK)((()=>t.getTargetStore()),[t]),m=(0,i.VK)((()=>(0,h.$K)(r)?G(t,r):void 0),[r,t]),g=(0,i.VK)((()=>{var e;const o=t.getCollectionTargetStore(),n=null==o||null===(e=o.getKeyStore("filter"))||void 0===e?void 0:e.getValue();if(n)return(0,d.Ih)(n,(null==m?void 0:m.getSchema())||{})}),[t,m]),y=(0,i.VK)((()=>{const e=t.getVariableTargetStore();if(e)return e.getValue();const o=t.getCollectionTargetStore();if(o){const e=o.getKeyStore("collection").getValue();if(e)return{collection:e,type:"collection"}}}),[t]),S=(0,i.VK)((()=>{if(!y||"variable"!==y.type||!r)return!1;const e=r.getContextValueForActionById(t.id,y.id);return"block"===(null==e?void 0:e.type.type)}),[t.id,r,y]),v=(0,i.qz)(void 0,M.Z),b=(0,n.useCallback)((()=>v.reset()),[v]),C=(0,n.useMemo)((()=>(0,L.jsx)(P.e,{actionStore:t,closeMenu:b})),[t,b]),k=(0,n.useMemo)((()=>!u.includes(t.id)),[u,t]),j=(0,T.TU)({contextStore:r,actionId:t.id,shouldShow:k}),A=(0,n.useCallback)((e=>{x.createAndCommit({userAction:"UpdatePagesAction.filterChange",environment:o,perform:t=>{f.sW({data:{filter:e},store:p,transaction:t})}})}),[o,p]),V=(0,n.useCallback)((e=>{let n;if("collection"===e.type)n="UpdatePageAction.updateCollection";else if("variable"===e.type)n="UpdatePageAction.updateVariable";else{if("page"===e.type||"property"===e.type||"formula"===e.type)throw new Error("Not implemented yet.");(0,h.t1)(e)}x.createAndCommit({userAction:n,environment:o,perform:o=>{f.sW({data:{properties:null,target:e,values:null},store:t.getConfigStore(),transaction:o})}})}),[o,t]),I=Boolean(l),Z=(0,c.z)("update_pages");return r?(0,L.jsxs)(F.Ao,{actionMenu:C,buttonPopupStore:v,disabled:I,children:[(0,L.jsx)(F.vu,{actionRegistryItem:Z,disabled:I,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:S||!m?(0,L.jsx)(H,{actionStore:t,automationContextStore:r,disabled:I,errorMessage:j,onTargetChange:V,value:y}):(0,L.jsx)(U,{actionStore:t,automationContextStore:r,collectionStore:m,disabled:I,errorMessage:j,filter:g,onFilterChange:A,onTargetChange:V,value:y})}),m&&(0,L.jsx)(F.R7,{disabled:I,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:(0,L.jsx)(w.QF,{actionStore:t,collectionStore:m,contextStore:r,disabled:I,showSetPropertyActions:!0})})]}):null}function H(e){const{actionStore:t,automationContextStore:o,disabled:n,errorMessage:i,onTargetChange:r,value:a}=e,s=(0,l.yK)((()=>({b:{fontWeight:y.Z.fontWeight.medium},picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50}})),[]);return(0,L.jsx)("div",{style:s.title,children:(0,L.jsx)(m.FormattedMessage,{...W.singleTarget,values:{b:e=>(0,L.jsx)("b",{style:s.b,children:e}),targetPicker:(0,L.jsx)($,{actionStore:t,automationContextStore:o,disabled:n,errorMessage:i,onChange:r,value:a}),span:e=>(0,L.jsx)("span",{style:s.span,children:e})}})})}function U(e){const{actionStore:t,automationContextStore:o,collectionStore:n,disabled:i,errorMessage:r,filter:a,onFilterChange:s,onTargetChange:c,value:u}=e,d=(0,l.yK)((()=>({b:{fontWeight:y.Z.fontWeight.medium},picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50}})),[]);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{style:d.title,children:[(0,L.jsx)(m.FormattedMessage,{...W.multipleTargetsFilter,values:{filterPicker:(0,L.jsx)(z,{collectionStore:n,disabled:i,filter:a,onChange:s}),span:e=>(0,L.jsx)("span",{style:d.span,children:e})}})," "]}),(0,L.jsx)("div",{style:d.title,children:(0,L.jsx)(m.FormattedMessage,{...W.multipleTargetsPicker,values:{targetPicker:(0,L.jsx)($,{actionStore:t,automationContextStore:o,disabled:i,errorMessage:r,onChange:c,value:u}),span:e=>(0,L.jsx)("span",{style:d.span,children:e})}})})]})}function z(e){var t;const{collectionStore:o,disabled:r,filter:a,onChange:s}=e,c=(0,l.yK)((()=>({b:{fontWeight:y.Z.fontWeight.medium}})),[]),d=(0,i.qz)(void 0,M.Z),p=(0,A.d)({tabletBehavior:"slideUp"}),g=(0,n.useCallback)((()=>d.reset()),[d]),h=(0,i.VK)((()=>{const e=o.getModel(),t=null==e?void 0:e.getDatabaseType();return(0,S.Q_)(t)}),[o]),f=(null==a||null===(t=a.filters)||void 0===t?void 0:t.length)||0;return(0,L.jsx)(v.ZP,{alignmentToOrigin:v.vR.End,disabled:r,originGap:0,placementToOrigin:v.pO.Bottom,popupType:p,renderOrigin:e=>(0,L.jsx)(V.S,{...e,disabled:r,isCompact:!0,onClick:t=>{e.onClick(t),0===f&&s(u.TI)},children:f>0?(0,L.jsx)(m.FormattedMessage,{defaultMessage:"<b>{itemType}</b> that match {ruleCount, plural, one {{ruleCount} filter} other {{ruleCount} filters}}",id:"automations.UpdatePagesAction.FilterPicker.withRules",values:{b:e=>(0,L.jsx)("b",{style:c.b,children:e}),itemType:h,ruleCount:f}}):(0,L.jsx)(m.FormattedMessage,{defaultMessage:"all <b>{itemType}</b>",id:"automations.UpdatePagesAction.FilterPicker.noRules",values:{b:e=>(0,L.jsx)("b",{style:c.b,children:e}),itemType:h}})}),render:()=>(0,L.jsx)(O,{collectionStore:o,disabled:r,filter:a,onChange:s,onClose:g})})}function $(e){const{actionStore:t,automationContextStore:o,disabled:r,errorMessage:a,onChange:s,value:l}=e,c=(0,i.VK)((()=>{if("collection"===(null==l?void 0:l.type))return j.NW.createChildStore(t,l.collection)}),[t,l]),u=(0,i.VK)((()=>{if(l&&"variable"===l.type)return o.getContextValueForActionById(t.id,l.id)}),[l,o,t.id]),d=(0,i.qz)(void 0,M.Z),g=(0,A.d)(),y=(0,n.useCallback)((()=>d.reset()),[d]),f=(0,n.useCallback)((e=>{s(e),y()}),[s,y]);return(0,L.jsx)(v.ZP,{buttonPopupStore:d,popupType:g,alignmentToOrigin:v.vR.End,placementToOrigin:v.pO.Bottom,originGap:0,disabled:r,renderOrigin:e=>(0,L.jsx)(V.S,{...e,disabled:r,isCompact:!0,isError:Boolean(a),hasActionRequired:!Boolean(l||u),tooltipMessage:a,children:(0,h.$K)(c)?(0,L.jsx)(b.Z,{store:c}):u?(0,L.jsx)(C.Fg,{format:p.lo.Medium,isSingle:!0,value:u}):(0,L.jsx)(m.FormattedMessage,{id:"automations.UpdatePagesAction.pagesDropdown.label",defaultMessage:"Select database"})}),render:e=>(0,L.jsx)(I.L,{actionId:t.id,automationContextStore:o,onChange:f,onClose:y,selectedTarget:l,skipPages:!0})})}function G(e,t){const o=e.getTargetStore().getValue();if(o){if("collection"===o.type)return j.NW.createChildStore(e,o.collection);if("variable"===o.type){if(!t)return;const n=t.compilationResultStore.state;if(g.x.isFail(n))return;const i=(0,r.vx)(n.value.valueTypes,o.id);if(i)return(0,k.wB)(i,e)}else{if("page"===o.type)return;(0,h.t1)(o)}}}var q=o(603865),Y=o(838862),Q=o(67653),X=o(334067),J=o(629735),ee=o(842767),te=o(639864),oe=o(280981),ne=o(823745),ie=o(590073),re=o(519656),ae=o(23645);function se(e){var t;const{actionStore:o}=e,{automationContextStore:r,disabled:s}=(0,a.i)(),l=(0,i.VK)((()=>o.getConfig()),[o]),c=(0,i.VK)((()=>(0,h.$K)(r)?G(o,r):void 0),[r,o]),u=(0,i.VK)((()=>null==c?void 0:c.getSchema()),[c]),d=(0,i.VK)((()=>null==c?void 0:c.getDeletedSchema()),[c]),p=(0,i.qz)(void 0,M.Z),m=(0,n.useCallback)((()=>p.reset()),[p]),g=(0,n.useMemo)((()=>(0,L.jsx)(P.e,{actionStore:o,closeMenu:m})),[o,m]),y=((null==l?void 0:l.properties)??[])[0],f=null==u?void 0:u[y],x=null==d?void 0:d[y],S=null==l||null===(t=l.values)||void 0===t?void 0:t[y],v=Boolean(s),b={actionMenu:g,buttonPopupStore:p,disabled:v,value:null==S?void 0:S.value};return!f&&x?(0,L.jsx)(J.RN,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(J.rV,{...e,...b,propertySchema:x})}):f||x?f&&c?(0,q.SF)(f)?"person"===f.type?(0,L.jsx)(le,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(te.Z,{...e,...b,propertySchema:f})}):"status"===f.type?(0,L.jsx)(le,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(ie.yr,{...e,...b,propertySchema:f})}):"select"===f.type?(0,L.jsx)(le,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(ne.D9,{...e,...b,propertySchema:f})}):"multi_select"===f.type?(0,L.jsx)(le,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(ee.m,{...e,...b,propertySchema:f})}):"date"===f.type?(0,L.jsx)(le,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(X.er,{...e,...b,propertySchema:f,valueContext:{collectionStore:c,property:y,type:"collection"}})}):"relation"===f.type?(0,L.jsx)(le,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(oe.ZP,{...e,...b,collectionStore:c,propertySchema:f})}):"checkbox"===f.type?(0,L.jsx)(le,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(Q.Q2,{...e,...b,propertySchema:f})}):"title"===f.type?(0,L.jsx)(le,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(re.QQ,{...e,...b,propertySchema:f})}):"text"===f.type?(0,L.jsx)(le,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(re.Vk,{...e,...b,propertySchema:f})}):"email"===f.type?(0,L.jsx)(le,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(re.Kh,{...e,...b,propertySchema:f})}):"url"===f.type?(0,L.jsx)(le,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(re.GJ,{...e,...b,propertySchema:f})}):"number"===f.type?(0,L.jsx)(le,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(re.go,{...e,...b,propertySchema:f})}):"phone_number"===f.type?(0,L.jsx)(le,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(re.gi,{...e,...b,propertySchema:f})}):null:(0,L.jsx)(ae.l6,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,L.jsx)(ae.OZ,{...e,...b,propertySchema:f})}):null:(0,L.jsx)(J.RN,{actionId:o.id,renderOrigin:e=>(0,L.jsx)(J.PO,{...e,...b})})}function le(e){const{actionId:t,propertyId:o,renderOrigin:r}=e,a=(0,A.d)(),s=(0,i.qz)(void 0,M.Z),l=(0,n.useCallback)((()=>s.reset()),[s]),c=(0,n.useMemo)((()=>({actionId:t,propertyId:o,type:"eventActionProperty"})),[t,o]);return(0,L.jsx)(v.ZP,{buttonPopupStore:s,popupType:a,render:()=>(0,L.jsx)(Y.Z,{initialState:c,onClose:l}),renderOrigin:r})}function ce(e){const{actionStore:t}=e,{automationContextStore:o}=(0,a.i)();return(0,i.VK)((()=>ue(o,t)),[t,o])?(0,L.jsx)(se,{...e}):(0,L.jsx)(E,{...e})}function ue(e,t){var o;if(!t.isType("update_pages"))return!1;const n=t.getConfig(),i="variable"===(null==n||null===(o=n.target)||void 0===o?void 0:o.type)?(0,r.MY)(n.target.id):void 0;return"event"===(null==e?void 0:e.context.type)&&i&&"global"===i.source&&"button_page"===i.global}},67653:(e,t,o)=>{o.d(t,{G7:()=>x,Q2:()=>f});var n=o(667294),i=o(724405),r=o(576218),a=o(765628),s=o(196711),l=o(742283),c=o(709291),u=o(137810),d=o(620776),p=o(825464),m=o(756812),g=o(293060),h=o(847957),y=o(785893);function f(e){const{actionMenu:t,buttonPopupStore:o,disabled:f,onClick:S,propertySchema:v,value:b}=e,C=(0,i.yK)((()=>({content:{alignItems:"center",display:"flex"},propertyName:{...u.Z.textOverflowStyle,fontWeight:u.Z.fontWeight.semibold}})),[]),k=function(e){const{propertySchema:t,styles:o,value:n}=e,i=(0,r.A6)(null==n?void 0:n.value)[0],l=t.name,u=!0===i?(0,s.V)({width:12}):(0,a.z)({width:10}),p=!0===i?(0,y.jsx)(c.FormattedMessage,{...m.Bo.actionCheckboxPropertyChecked}):(0,y.jsx)(c.FormattedMessage,{...m.Bo.actionCheckboxPropertyUnchecked});return(0,y.jsx)(c.FormattedMessage,{...m.hW({propertyName:(0,y.jsx)("span",{style:o.propertyName,children:l}),propertyValue:(0,y.jsx)(d.o,{icon:u,shouldTruncateChildren:!0,children:p})})})}({propertySchema:v,styles:C,value:b}),M=x({propertySchema:v,value:b}),j=(0,n.useCallback)((e=>(0,y.jsx)(h.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:f,icon:l.r,onClick:S,children:(0,y.jsx)("div",{style:C.content,children:k})})),[t,o,f,S,C.content,k]);return(0,y.jsx)(g.y,{renderOrigin:j,title:M,tooltipAlignment:p.v.Center,tooltipPlacement:p.u.Left})}function x(e){const{propertySchema:t,value:o}=e,n=!0===(0,r.A6)(null==o?void 0:o.value)[0]?(0,y.jsx)(c.FormattedMessage,{...m.Bo.actionCheckboxPropertyChecked}):(0,y.jsx)(c.FormattedMessage,{...m.Bo.actionCheckboxPropertyUnchecked});return(0,y.jsx)(c.FormattedMessage,{...m.hW({propertyName:t.name,propertyValue:n})})}},334067:(e,t,o)=>{o.d(t,{er:()=>j,kD:()=>T});var n=o(667294),i=o(886628),r=o(724405),a=o(984619),s=o(407057),l=o(335102),c=o(576218),u=o(842875),d=o(282447),p=o(76233),m=o(709291),g=o(401898),h=o(137810),y=o(721396),f=o(475311),x=o(685567),S=o(825464),v=o(756812),b=o(312455),C=o(293060),k=o(847957),M=o(785893);function j(e){const{actionMenu:t,buttonPopupStore:o,disabled:j,onClick:P,propertySchema:w,value:V,valueContext:I}=e,{automationContextStore:F}=(0,b.i)(),Z=(0,m.useIntl)(),B=(0,r.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre"},propertyName:{...h.Z.textOverflowStyle,fontWeight:h.Z.fontWeight.semibold}})),[]),K=(0,i.VK)((()=>F?function(e){const{automationContextStore:t,intl:o,propertySchema:n,styles:i,value:r,valueContext:d}=e,S=(0,M.jsx)("span",{style:i.propertyName,children:n.name});if(void 0===(null==r?void 0:r.value))return(0,M.jsx)(m.FormattedMessage,{...v.xf({propertyName:S})});let b;const C=t.getAllContextValues(),k=(0,f._)(d),j=(0,c.A6)(null==r?void 0:r.value)[0];if(!(0,g.$K)(j)||"string"==typeof j||"boolean"==typeof j||(0,p.IWo)(j)||(0,p.STW)(j))b=(0,M.jsx)(x.Z,{format:a.lo.Medium,isRound:!0,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:(0,M.jsx)("span",{style:h.Z.textOverflowStyle,children:(0,M.jsx)(m.FormattedMessage,{...v.Bo.unknownValue})})});else if((0,p.wjk)(j)){const e=(0,p.vmO)(j).id,t=(0,l.vx)(C,e);b=t?(0,M.jsx)(y.Fg,{value:t,format:a.lo.Medium,isSingle:!1,shouldShrink:!0}):(0,M.jsx)(x.Z,{format:a.lo.Medium,isRound:!0,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:(0,M.jsx)("span",{style:h.Z.textOverflowStyle,children:(0,M.jsx)(m.FormattedMessage,{...v.Bo.unknownValue})})})}else if((0,p.fpG)(j)){const e=(0,p.zyO)(j);b=e?(0,s.OB)({value:e,date_format:k.dateFormat,time_format:k.timeFormat,userTimeZone:(0,u.r)(),allowRelativeDates:!0,intl:o,shortenDateAndRange:!0,displayInUserTimezone:!0,formatValuesFn:e=>{let{endDate:t,endTime:o,startDate:n}=e;return(0,g.$K)(o)?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(A,{value:n})," → ",(0,M.jsx)(A,{value:o})]}):(0,g.$K)(t)?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(A,{value:n})," → ",(0,M.jsx)(A,{value:t})]}):(0,M.jsx)(A,{value:n})}}):null}else(0,g.t1)(j);return void 0===b?void 0:(0,M.jsx)(m.FormattedMessage,{...v.zU({propertyName:S,propertyValue:b})})}({automationContextStore:F,intl:Z,propertySchema:w,styles:B,value:V,valueContext:I}):void 0),[F,Z,w,B,V,I]),_=(0,i.VK)((()=>F?T({automationContextStore:F,intl:Z,propertySchema:w,value:V,valueContext:I}):void 0),[F,Z,w,V,I]),R=(0,n.useCallback)((e=>(0,M.jsx)(k.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:j,icon:d.V,onClick:P,children:(0,M.jsx)("div",{style:B.content,children:K})})),[t,o,j,P,B.content,K]);return F&&K&&_?(0,M.jsx)(C.y,{disable:j,renderOrigin:R,title:_,tooltipAlignment:S.v.Center,tooltipPlacement:S.u.Left}):null}function T(e){const{automationContextStore:t,intl:o,propertySchema:n,value:i,valueContext:r}=e,a=n.name;if(void 0===(null==i?void 0:i.value))return(0,M.jsx)(m.FormattedMessage,{...v.xf({propertyName:a})});let d;const h=t.getAllContextValues(),x=(0,f._)(r),S=(0,c.A6)(null==i?void 0:i.value)[0];if(!(0,g.$K)(S)||"string"==typeof S||"boolean"==typeof S||(0,p.IWo)(S)||(0,p.STW)(S))d=(0,M.jsx)(m.FormattedMessage,{...v.Bo.unknownValue});else if((0,p.wjk)(S)){const e=(0,p.vmO)(S).id,t=(0,l.vx)(h,e);d=t?(0,y.eP)(t):(0,M.jsx)(m.FormattedMessage,{...v.Bo.unknownValue})}else if((0,p.fpG)(S)){const e=(0,p.zyO)(S);d=e?(0,s.ZV)({value:e,date_format:x.dateFormat,time_format:x.timeFormat,userTimeZone:(0,u.r)(),allowRelativeDates:!0,intl:o,shortenDateAndRange:!0,displayInUserTimezone:!0}):null}else(0,g.t1)(S);return void 0===d?void 0:(0,M.jsx)(m.FormattedMessage,{...v.zU({propertyName:a,propertyValue:d})})}function A(e){const{value:t}=e,o=(0,r.yK)((e=>({token:{marginBlockEnd:4},tokenBackgroundColor:{backgroundColor:e.accentColors.gray[75]}})),[]);return(0,M.jsx)(x.Z,{backgroundColor:o.tokenBackgroundColor.backgroundColor,format:a.lo.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,style:o.token,value:t})}},629735:(e,t,o)=>{o.d(t,{Ox:()=>y,PO:()=>g,RN:()=>h,Si:()=>f,fX:()=>x,rV:()=>m});var n=o(667294),i=o(886628),r=o(724405),a=o(709291),s=o(231945),l=o(61766),c=o(435294),u=o(392688),d=o(23645),p=o(785893);function m(e){const{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,propertySchema:a}=e,s=(0,r.yK)((e=>({icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.accentColors.red[700]}})),[]),l=y({propertySchema:a,styles:s}),c=f({propertySchema:a});return(0,p.jsx)(d.gq,{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,styles:s,tooltip:c,children:l})}function g(e){const{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i}=e,a=(0,r.yK)((e=>({icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.accentColors.red[700]}})),[]),s=x();return(0,p.jsx)(d.gq,{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,styles:a,tooltip:s,children:s})}function h(e){const{actionId:t,propertyId:o,renderOrigin:r}=e,a=(0,c.d)(),d=(0,i.qz)(void 0,l.Z),m=(0,n.useCallback)((()=>d.reset()),[d]);return(0,p.jsx)(s.ZP,{buttonPopupStore:d,popupType:a,render:()=>(0,p.jsx)(u.k,{actionId:t,closeMenu:m,propertyId:o}),renderOrigin:r})}function y(e){const{propertySchema:t,styles:o}=e;return(0,p.jsx)(a.FormattedMessage,{defaultMessage:"{propertyName} property was deleted",id:"updateThisPageUnsupportedPropertyAction.deletedProperty.title",values:{propertyName:(0,p.jsx)("span",{style:o.propertyType,children:t.name})}})}function f(e){const{propertySchema:t}=e;return(0,p.jsx)(a.FormattedMessage,{defaultMessage:"{propertyName} property was deleted",id:"updateThisPageUnsupportedPropertyAction.deletedProperty.title",values:{propertyName:t.name}})}function x(){return(0,p.jsx)(a.FormattedMessage,{defaultMessage:"The property was permanently deleted",id:"updateThisPageUnsupportedPropertyAction.permanentlyDeleted.title"})}},842767:(e,t,o)=>{o.d(t,{H:()=>f,m:()=>x});var n=o(667294),i=o(886628),r=o(724405),a=o(576218),s=o(372050),l=o(709291),c=o(401898),u=o(137810),d=o(825464),p=o(756812),m=o(293060),g=o(847957),h=o(823745),y=o(785893);const f=5;function x(e){const{actionMenu:t,buttonPopupStore:o,disabled:x,limit:S=f,onClick:v,propertySchema:b,value:C}=e,k=(0,l.useIntl)(),M=null!=C&&C.value?(0,a.A6)(null==C?void 0:C.value):[],j=p.oJ({limit:S,optionValues:M.map((e=>"string"==typeof e?e:void 0)).filter(c.$K),propertySchema:b}),T=(0,r.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:j.length<=1?"nowrap":"wrap",whiteSpace:"pre"},propertyName:{...u.Z.textOverflowStyle,fontWeight:u.Z.fontWeight.semibold}})),[j.length]),A=(0,i.VK)((()=>(0,h.F0)({intl:k,propertySchema:b,styles:T,values:j})),[k,j,b,T]),P=(0,i.VK)((()=>(0,h.I7)({intl:k,propertySchema:b,values:j})),[k,j,b]),w=(0,n.useCallback)((e=>(0,y.jsx)(g.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:x,icon:s.A,onClick:v,children:(0,y.jsx)("div",{style:T.content,children:A})})),[t,o,x,v,T.content,A]);return(0,y.jsx)(m.y,{renderOrigin:w,title:P,tooltipAlignment:d.v.Center,tooltipPlacement:d.u.Left})}},639864:(e,t,o)=>{o.d(t,{U:()=>y,Z:()=>h});var n=o(667294),i=o(886628),r=o(266897),a=o(180951),s=o(526774),l=o(401898),c=o(825464),u=o(154583),d=o(113732),p=o(293060),m=o(847957),g=o(785893);function h(e){const{actionMenu:t,buttonPopupStore:o,disabled:r,onClick:a,propertySchema:h,value:f}=e,x=(0,u.Z)(),S=(0,i.VK)((()=>(0,l.$K)(x)?y({getRecordModel:x,propertySchema:h,value:f}):[]),[x,h,f]),{title:v,tooltipTitle:b,styles:C}=(0,d.TY)({actorModels:S,propertySchema:h,messageType:"action"}),k=(0,n.useCallback)((e=>(0,g.jsx)(m.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:r,icon:s.O,onClick:a,children:(0,g.jsx)("div",{style:C.content,children:v})})),[t,o,r,a,C.content,v]);return(0,g.jsx)(p.y,{renderOrigin:k,title:b,tooltipAlignment:c.v.Center,tooltipPlacement:c.u.Left})}function y(e){const{getRecordModel:t,propertySchema:o,value:n}=e;return(0,a.DW)({textValue:null==n?void 0:n.value,propertySchema:o,blockCreatorPointer:void 0}).map((e=>(0,r.Hl)({getRecordModel:t,pointer:e}))).filter(l.$K)}},280981:(e,t,o)=>{o.d(t,{ZP:()=>T,wr:()=>P});var n=o(667294),i=o(800480),r=o(886628),a=o(724405),s=o(984619),l=o(335102),c=o(576218),u=o(492607),d=o(421202),p=o(76233),m=o(709291),g=o(401898),h=o(137810),y=o(721396),f=o(125845),x=o(637034),S=o(825464),v=o(206258),b=o(756812),C=o(25742),k=o(293060),M=o(847957),j=o(785893);function T(e){const{actionMenu:t,buttonPopupStore:o,collectionStore:s,disabled:l,onClick:c,propertySchema:d,value:p}=e,g=(0,i.O7)(),y=(0,m.useIntl)(),f=(0,C.z)({actionType:"update_pages"}),x=(0,a.yK)((()=>({content:{alignItems:"center",display:"flex",flex:"1 1 auto",minWidth:0,whiteSpace:"pre"},propertyName:{...h.Z.textOverflowStyle,fontWeight:h.Z.fontWeight.semibold,minWidth:20},propertyValue:{...h.Z.textOverflowStyle,minWidth:40},propertyValueList:{display:"flex",flexBasis:"100%",flexDirection:"column",listStyle:"none",margin:0,marginBlockStart:10,padding:0,rowGap:10},propertyValueListItem:{display:"flex"}})),[]),v=(0,r.VK)((()=>function(e){const{automationContextValues:t,collectionStore:o,propertySchema:n,styles:i,value:r}=e,a=r?w({automationContextValues:t,limit:n.limit,value:r}):[],s=(0,j.jsx)("span",{style:i.propertyName,children:n.name});let l;l=0===a.length?(0,j.jsx)("div",{style:i.content,children:(0,j.jsx)(m.FormattedMessage,{...b.Iu({propertyName:s})})}):1===a.length?(0,j.jsx)("div",{style:i.content,children:(0,j.jsx)(m.FormattedMessage,{...b.S0({propertyName:s,propertyValue:(0,j.jsx)("span",{style:i.propertyValue,children:(0,j.jsx)(A,{collectionStore:o,value:a[0]})})})})}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{style:i.content,children:(0,j.jsx)(m.FormattedMessage,{...b.om({propertyName:s,propertyValue:[]})})}),(0,j.jsx)("ul",{style:i.propertyValueList,children:a.map(((e,t)=>(0,j.jsx)("li",{style:i.propertyValueListItem,children:(0,j.jsx)(A,{collectionStore:o,value:e})},t)))})]});return l}({automationContextValues:f,collectionStore:s,propertySchema:d,styles:x,value:p})),[f,s,d,x,p]),T=(0,r.VK)((()=>P({automationContextValues:f,collectionStore:s,environment:g,intl:y,propertySchema:d,value:p})),[f,s,g,y,d,p]),V=(0,n.useCallback)((e=>(0,j.jsx)(M.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:l,icon:u.v,onClick:c,children:v})),[t,o,l,c,v]);return(0,j.jsx)(k.y,{renderOrigin:V,title:T,tooltipAlignment:S.v.Center,tooltipPlacement:S.u.Left})}function A(e){const{collectionStore:t,value:o}=e;return"string"==typeof o?(0,j.jsx)(f.Z,{blockId:o,format:s.lo.Medium,isSingle:!0,noUnderline:!0,parentStore:t,shouldShrink:!0}):(0,j.jsx)(y.Fg,{format:s.lo.Medium,isSingle:!0,shouldShrink:!0,value:o})}function P(e){const{automationContextValues:t,collectionStore:o,environment:n,intl:i,propertySchema:r,value:a}=e,s=(a?w({automationContextValues:t,limit:r.limit,value:a}):[]).map((e=>{if("string"==typeof e){const t=v.G.createChildStore(o,{id:e,table:d.iU});return(0,x.vU)({environment:n,intl:i,store:t})}return(0,y.eP)(e)})).filter(g.$K),l=r.name;let c;return c=0===s.length?b.Iu({propertyName:l}):1===s.length?b.S0({propertyName:l,propertyValue:s[0]}):b.om({propertyName:l,propertyValue:i.formatList(s,{style:"long",type:"conjunction"})}),(0,j.jsx)(m.FormattedMessage,{...c})}function w(e){const{automationContextValues:t,limit:o,value:n}=e;return(0,c.A6)(n.value).slice(0,o).map((e=>{if("string"!=typeof e&&"boolean"!=typeof e){if((0,p.wjk)(e)){const o=(0,p.vmO)(e).id,n=(0,l.vx)(t,o);if(!n)return;return n}if((0,p.STW)(e)){const t=(0,p.TOT)(e);if(!t)return;return t}}})).filter(g.$K)}},823745:(e,t,o)=>{o.d(t,{D9:()=>C,F0:()=>k,I7:()=>M});var n=o(667294),i=o(886628),r=o(724405),a=o(984619),s=o(576218),l=o(753866),c=o(709291),u=o(653965),d=o(401898),p=o(137810),m=o(122084),g=o(685567),h=o(825464),y=o(365380),f=o(756812),x=o(293060),S=o(847957),v=o(337867),b=o(785893);function C(e){const{actionMenu:t,buttonPopupStore:o,disabled:a,onClick:d,propertySchema:m,value:g}=e,y=(0,c.useIntl)(),v=(0,r.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"nowrap",whiteSpace:"pre"},propertyName:{...p.Z.textOverflowStyle,fontWeight:p.Z.fontWeight.semibold}})),[]),C=null!=g&&g.value?(0,s.A6)(null==g?void 0:g.value)[0]:void 0,j=f.oJ({propertySchema:m,optionValues:(0,u.HD)(C)?[C]:[]}),T=(0,i.VK)((()=>k({intl:y,propertySchema:m,styles:v,values:j})),[y,j,m,v]),A=(0,i.VK)((()=>M({intl:y,propertySchema:m,values:j})),[y,j,m]),P=(0,n.useCallback)((e=>(0,b.jsx)(S.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:a,icon:l.w,onClick:d,children:(0,b.jsx)("div",{style:v.content,children:T})})),[t,o,a,d,v.content,T]);return(0,b.jsx)(x.y,{renderOrigin:P,title:A,tooltipAlignment:h.v.Center,tooltipPlacement:h.u.Left})}function k(e){const{intl:t,propertySchema:o,styles:n,tokenFormat:i,values:r}=e,s=i??a.lo.Medium,l=(0,b.jsx)("span",{style:n.propertyName,children:o.name}),u=r.map((e=>"deleted"===e.type?(0,b.jsx)(v.Z,{tokenFormat:s},`missing_option_value_${e.value}`):"option"===e.type?(0,b.jsx)(m.a,{color:e.value.color,format:s,isSingle:!0,showRemoveButton:!1,value:e.value.value},e.value.id):"truncation"===e.type?(0,b.jsx)(g.Z,{format:s,isRound:!0,isSingle:!0,showRemoveButton:!1,value:e.value},"More tokens"):void(0,d.t1)(e)));return 0===u.length?(0,b.jsx)(c.FormattedMessage,{...f.Mw({propertyName:l})}):1===u.length?(0,b.jsx)(c.FormattedMessage,{...f.rf({propertyName:l,propertyValue:u[0]})}):(0,b.jsx)(c.FormattedMessage,{...f.Sj({propertyName:l,propertyValue:(0,y.H)(t.formatList(u,{style:"long",type:"conjunction"}))})})}function M(e){const{intl:t,propertySchema:o,values:n}=e,i=o.name,r=n.map((e=>"deleted"===e.type?f.ST(t):"option"===e.type?e.value.value:"truncation"===e.type?e.value:void(0,d.t1)(e)));return 0===r.length?(0,b.jsx)(c.FormattedMessage,{...f.Mw({propertyName:i})}):1===r.length?(0,b.jsx)(c.FormattedMessage,{...f.rf({propertyName:i,propertyValue:r[0]})}):(0,b.jsx)(c.FormattedMessage,{...f.Sj({propertyName:i,propertyValue:(0,y.H)(t.formatList(r,{style:"long",type:"conjunction"}))})})}},590073:(e,t,o)=>{o.d(t,{LQ:()=>f,yr:()=>y});var n=o(667294),i=o(886628),r=o(724405),a=o(576218),s=o(603729),l=o(709291),c=o(137810),u=o(825464),d=o(756812),p=o(293060),m=o(847957),g=o(687181),h=o(785893);function y(e){const{actionMenu:t,buttonPopupStore:o,disabled:y,onClick:x,propertySchema:S,value:v}=e,b=(0,l.useIntl)(),C=(0,a.A6)(null==v?void 0:v.value)[0],k=(0,r.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"nowrap",whiteSpace:"pre"},propertyName:{...c.Z.textOverflowStyle,fontWeight:c.Z.fontWeight.semibold}})),[]),M=(0,i.VK)((()=>function(e){const{intl:t,propertySchema:o,styles:n,value:i}=e;if(!i||"string"!=typeof i)return;const r=(0,h.jsx)("span",{style:n.propertyName,children:o.name}),a=(0,g.L)({intl:t,groupValues:[],optionValues:[i],propertySchema:o});if(0===a.length)return;return(0,h.jsx)(l.FormattedMessage,{...(0,d.Ig)({propertyName:r,propertyValue:a})})}({intl:b,propertySchema:S,styles:k,value:C})),[b,S,C,k]),j=(0,i.VK)((()=>f({intl:b,propertySchema:S,value:C})),[b,S,C]),T=(0,n.useCallback)((e=>(0,h.jsx)(m.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:y,icon:s.T,onClick:x,children:(0,h.jsx)("div",{style:k.content,children:M})})),[t,o,y,x,k.content,M]);return M&&j?(0,h.jsx)(p.y,{renderOrigin:T,title:j,tooltipAlignment:u.v.Center,tooltipPlacement:u.u.Left}):null}function f(e){const{intl:t,propertySchema:o,value:n}=e;if(!n||"string"!=typeof n)return;const i=o.name,r=(0,g.L)({intl:t,isText:!0,groupValues:[],optionValues:[n],propertySchema:o});return 0!==r.length?(0,h.jsx)(l.FormattedMessage,{...(0,d.Ig)({propertyName:i,propertyValue:r})}):void 0}},519656:(e,t,o)=>{o.d(t,{GJ:()=>I,Kh:()=>V,QQ:()=>P,Vk:()=>w,gi:()=>Z,go:()=>F,lG:()=>A});var n=o(667294),i=o(800480),r=o(886628),a=o(724405),s=o(984619),l=o(648524),c=o(155159),u=o(934093),d=o(800108),p=o(983303),m=o(808938),g=o(23867),h=o(709291),y=o(137810),f=o(685567),x=o(360682),S=o(214976),v=o(825464),b=o(756812),C=o(312455),k=o(293060),M=o(847957),j=o(785893);function T(e){const{actionMenu:t,buttonPopupStore:o,disabled:l,icon:c,onClick:u,propertySchema:d,value:p}=e,{automationStore:m}=(0,C.i)(),T=(0,i.O7)(),P=(0,a.Fg)(),w=(0,a.yK)((()=>({content:{alignItems:"center",display:"flex"},propertyName:{...y.Z.textOverflowStyle,fontWeight:y.Z.fontWeight.semibold}})),[]),V=(0,r.VK)((()=>function(e){const{automationStore:t,environment:o,propertySchema:n,styles:i,theme:r,value:a}=e,l=void 0===(null==a?void 0:a.value),c=null!=a&&a.value?(0,S.IY)({disabled:!0,disableDateStyleAnnotations:!0,disableHover:!0,disableLinks:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableSuggestionAnnotations:!0,emojiType:(0,x.e_)(o),environment:o,formulaValueTypes:[],katex:o.KatexStore.getKatex(),parentStore:t,stopLinkPropagation:!0,textValue:{value:null==a?void 0:a.value,spaceId:(0,g.C)(t.pointer.spaceId)},theme:r}):null,u=(0,j.jsx)("span",{style:i.propertyName,children:n.name}),d=(0,j.jsx)(f.Z,{format:s.lo.Medium,isRound:!0,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:(0,j.jsx)("span",{style:y.Z.textOverflowStyle,children:c})}),p=l?b.NZ({propertyName:u}):b.vE({propertyName:u,propertyValue:d});return(0,j.jsx)(h.FormattedMessage,{...p})}({automationStore:m,environment:T,propertySchema:d,styles:w,theme:P,value:p})),[m,T,d,w,P,p]),I=(0,r.VK)((()=>A({automationStore:m,environment:T,propertySchema:d,theme:P,value:p})),[m,T,d,P,p]),F=(0,n.useCallback)((e=>(0,j.jsx)(M.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:l,icon:c,onClick:u,children:(0,j.jsx)("div",{style:w.content,children:V})})),[t,o,l,c,u,w.content,V]);return V&&I?(0,j.jsx)(k.y,{renderOrigin:F,title:I,tooltipAlignment:v.v.Center,tooltipPlacement:v.u.Left}):null}function A(e){const{automationStore:t,environment:o,propertySchema:n,theme:i,value:r}=e,a=void 0===(null==r?void 0:r.value),s=null!=r&&r.value?(0,S.IY)({disabled:!0,disableDateStyleAnnotations:!0,disableHover:!0,disableLinks:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableSuggestionAnnotations:!0,emojiType:(0,x.e_)(o),environment:o,formulaValueTypes:[],katex:o.KatexStore.getKatex(),parentStore:t,stopLinkPropagation:!0,textValue:{value:null==r?void 0:r.value,spaceId:(0,g.C)(t.pointer.spaceId)},theme:i}):null,l=n.name,c=s,u=a?b.NZ({propertyName:l}):b.vE({propertyName:l,propertyValue:c});return(0,j.jsx)(h.FormattedMessage,{...u})}function P(e){return(0,j.jsx)(T,{...e,icon:p.c})}function w(e){return(0,j.jsx)(T,{...e,icon:d.p})}function V(e){return(0,j.jsx)(T,{...e,icon:l.n})}function I(e){return(0,j.jsx)(T,{...e,icon:m.O})}function F(e){return(0,j.jsx)(T,{...e,icon:c.J})}function Z(e){return(0,j.jsx)(T,{...e,icon:u.u})}},23645:(e,t,o)=>{o.d(t,{JS:()=>b,K1:()=>C,OZ:()=>x,gq:()=>S,l6:()=>v});var n=o(667294),i=o(886628),r=o(724405),a=o(654497),s=o(709291),l=o(137810),c=o(231945),u=o(623879),d=o(825464),p=o(61766),m=o(435294),g=o(293060),h=o(847957),y=o(586034),f=o(785893);function x(e){const{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,propertySchema:a}=e,s=(0,r.yK)((e=>({icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.accentColors.red[700]}})),[]),l=b({propertySchema:a,styles:s}),c=C({propertySchema:a});return(0,f.jsx)(S,{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,styles:s,tooltip:c,children:l})}function S(e){const{actionMenu:t,buttonPopupStore:o,children:i,disabled:s,onClick:c,styles:u,tooltip:p}=e,m=(0,r.yK)((e=>({content:{color:e.text.uiRedPrimary,fontWeight:l.Z.fontWeight.medium,whiteSpace:"normal"}})),[]),y=(0,n.useCallback)((e=>(0,f.jsx)(h.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:s,icon:a.t,onClick:c,styles:u,children:(0,f.jsx)("div",{style:m.content,children:i})})),[t,o,i,s,c,u,m.content]);return(0,f.jsx)(g.y,{renderOrigin:y,title:p,tooltipAlignment:d.v.Center,tooltipPlacement:d.u.Left})}function v(e){const{actionId:t,propertyId:o,renderOrigin:r}=e,a=(0,m.d)(),s=(0,i.qz)(void 0,p.Z),l=(0,n.useCallback)((()=>s.reset()),[s]);return(0,f.jsx)(c.ZP,{buttonPopupStore:s,popupType:a,render:()=>(0,f.jsx)(y.qO,{actionId:t,closeMenu:l,propertyId:o}),renderOrigin:r})}function b(e){const{propertySchema:t,styles:o}=e,n=t.type,i=u.SO[n];return(0,f.jsx)(s.FormattedMessage,{defaultMessage:"{propertyTypeDisplayName} property type is not supported",id:"updateThisPageUnsupportedPropertyAction.unsupportedProperty.title",values:{propertyTypeDisplayName:(0,f.jsx)("span",{style:o.propertyType,children:i})}})}function C(e){const{propertySchema:t}=e,o=t.type,n=u.SO[o];return(0,f.jsx)(s.FormattedMessage,{defaultMessage:"{propertyTypeDisplayName} property type is not supported",id:"updateThisPageUnsupportedPropertyAction.unsupportedProperty.title",values:{propertyTypeDisplayName:n}})}},392688:(e,t,o)=>{o.d(t,{_:()=>h,k:()=>g});var n=o(667294),i=o(800480),r=o(886628),a=o(805149),s=o(566890),l=o(658812),c=o(143627),u=o(312455),d=o(753570),p=o(586034),m=o(785893);function g(e){const{actionId:t,closeMenu:o,propertyId:d}=e,{automationContextStore:g,automationStore:h,maybePersistedTransactionActions:y}=(0,u.i)(),f=(0,s.DK)(),x=(0,i.O7)(),S=(0,r.VK)((()=>null==f?void 0:f.settingsStore),[f]),v=(0,r.VK)((()=>h.getName()??""),[h]),b=(0,r.VK)((()=>{const e=h.getActionStores().find((e=>e.id===t));if(null!=e&&e.isDefined())return e}),[h,t]),C=(0,n.useCallback)((()=>{const e=null==g?void 0:g.context;e&&b&&(y.createAndCommit({perform:t=>{c.removeAutomationAction({actionStore:b,clientContext:e,environment:x,transaction:t})},userAction:"UnsupportedPropertyMenu.removeAction"}),null==o||o())}),[b,null==g?void 0:g.context,o,x,y]),k=(0,n.useMemo)((()=>{if(S&&d)return async function(){await(0,l.hL)({automationName:v,hasPendingChanges:!0})&&a.H4({collectionSettingsStore:S,item:{type:"deletedProperties",timelineViewTab:"timeline"}}),null==o||o()}}),[v,o,S,d]);return(0,m.jsx)(p.PO,{onDelete:C,onRestore:k,stepType:"action"})}function h(e){const{closeMenu:t,propertyId:o}=e,{automationStore:i}=(0,u.i)(),c=(0,s.DK)(),{removePropertyTrigger:g}=(0,d.i)(),h=(0,r.VK)((()=>null==c?void 0:c.settingsStore),[c]),y=(0,r.VK)((()=>{const e=null==c?void 0:c.collectionStore();return Boolean(!(null!=e&&e.getSchema()[o]))&&Boolean(!(null!=e&&e.getDeletedSchema()[o]))}),[c,o]),f=(0,r.VK)((()=>i.getName()??""),[i]),x=(0,n.useCallback)((()=>{g(o),null==t||t()}),[t,o,g]),S=(0,n.useMemo)((()=>{if(h&&!y)return async function(){await(0,l.hL)({automationName:f,hasPendingChanges:!0})&&a.H4({collectionSettingsStore:h,item:{timelineViewTab:"timeline",type:"deletedProperties"}}),null==t||t()}}),[f,t,h,y]);return(0,m.jsx)(p.PO,{onDelete:x,onRestore:S,stepType:"trigger"})}},586034:(e,t,o)=>{o.d(t,{Iw:()=>T,PO:()=>A,qO:()=>j});var n=o(667294),i=o(800480),r=o(886628),a=o(724405),s=o(950780),l=o(937612),c=o(355863),u=o(709291),d=o(401898),p=o(805149),m=o(552275),g=o(478140),h=o(632163),y=o(672495),f=o(566890),x=o(658812),S=o(966603),v=o(143627),b=o(312455),C=o(595193),k=o(753570),M=o(785893);function j(e){const{actionId:t,closeMenu:o,propertyId:a}=e,{automationContextStore:s,automationStore:l,maybePersistedTransactionActions:c}=(0,b.i)(),u=(0,f.DK)(),d=(0,i.O7)(),m=(0,r.VK)((()=>null==u?void 0:u.settingsStore),[u]),g=(0,r.VK)((()=>u&&(0,S.jI)({collectionContextStore:u,timelineViewTab:"timeline"})),[u]),h=(0,r.VK)((()=>l.getName()??""),[l]),y=(0,r.VK)((()=>{const e=l.getActionStores().find((e=>e.id===t));if(null!=e&&e.isDefined())return e}),[l,t]),C=(0,n.useCallback)((()=>{const e=null==s?void 0:s.context;e&&y&&(c.createAndCommit({perform:t=>{v.removeAutomationAction({actionStore:y,clientContext:e,environment:d,transaction:t})},userAction:"UnsupportedPropertyMenu.removeAction"}),null==o||o())}),[y,null==s?void 0:s.context,o,d,c]),k=(0,n.useMemo)((()=>{if(m&&g&&a)return async function(){await(0,x.hL)({automationName:h,hasPendingChanges:!0})&&p.H4({collectionSettingsStore:m,item:{type:"property",formatKey:g,property:a}}),null==o||o()}}),[h,o,m,g,a]);return(0,M.jsx)(A,{onDelete:C,onEdit:k,stepType:"action"})}function T(e){const{closeMenu:t,propertyId:o}=e,{automationStore:i}=(0,b.i)(),a=(0,f.DK)(),{removePropertyTrigger:s}=(0,k.i)(),l=(0,r.VK)((()=>null==a?void 0:a.settingsStore),[a]),c=(0,r.VK)((()=>a&&(0,S.jI)({collectionContextStore:a,timelineViewTab:"timeline"})),[a]),u=(0,r.VK)((()=>i.getName()??""),[i]),d=(0,n.useCallback)((()=>{s(o),null==t||t()}),[t,o,s]),m=(0,n.useMemo)((()=>{if(l&&c&&o)return async function(){await(0,x.hL)({automationName:u,hasPendingChanges:!0})&&p.H4({collectionSettingsStore:l,item:{type:"property",formatKey:c,property:o}}),null==t||t()}}),[u,t,l,c,o]);return(0,M.jsx)(A,{onDelete:d,onEdit:m,stepType:"trigger"})}function A(e){const{onDelete:t,onEdit:o,onRestore:r,stepType:p}=e,f=(0,C.F)({width:266}),x=(0,i.Fy)().isMobile,S=(0,a.yK)((e=>({icon:{color:e.accentColors.gray[600],height:"auto",width:x?"12px":"16px"}})),[x]),v=(0,n.useMemo)((()=>(0,d.$K)(o)?{action:o,key:"edit-property-menu-item",render:e=>(0,M.jsx)(m.Z,{...e,icon:(0,s.E)(S.icon),title:(0,M.jsx)(u.FormattedMessage,{defaultMessage:"Edit property",id:"unsupportedPropertyMenu.editMenuItem.title"})})}:void 0),[o,S.icon]),b=(0,n.useMemo)((()=>(0,d.$K)(r)?{action:r,key:"restore-property-menu-item",render:e=>(0,M.jsx)(m.Z,{...e,icon:(0,c.s)(S.icon),title:(0,M.jsx)(u.FormattedMessage,{defaultMessage:"Restore property",id:"unsupportedPropertyMenu.restoreMenuItem.title"})})}:void 0),[r,S.icon]),k=(0,n.useMemo)((()=>(0,d.$K)(t)?{action:t,key:"delete-property-menu-item",render:e=>(0,M.jsx)(m.Z,{...e,icon:(0,l.y)(S.icon),title:"action"===p?(0,M.jsx)(u.FormattedMessage,{id:"automationUnsupportedPropertyMenu.deleteAction.title",defaultMessage:"Delete action"}):(0,M.jsx)(u.FormattedMessage,{id:"automationUnsupportedPropertyMenu.deleteTrigger.title",defaultMessage:"Delete trigger"})})}:void 0),[t,p,S.icon]);return(0,M.jsx)(g.Z,{...f,children:(0,M.jsx)(h.Z,{initialFocus:0,sections:[{key:"actions-section",items:[v,b,k].filter(d.$K),render:e=>(0,M.jsx)(y.Z,{...e})}],type:h.i.Vertical})})}},319616:(e,t,o)=>{o.d(t,{Z:()=>m});var n=o(667294),i=o(800480),r=o(886628),a=o(266897),s=o(576218),l=o(519889),c=o(76233),u=o(992864),d=o(154583),p=o(785893);function m(e){let{handleRemoveToken:t,token:o}=e;const m=(0,i.Fy)(),g=(0,d.Z)(),h=(0,r.VK)((()=>{if((0,s.S3)(o)&&(0,c.IWo)(o)){const e=(0,c.zEN)(o);if(e)return(0,a.Hl)({pointer:{table:l.KJ,id:e},getRecordValue:g})}}),[g,o]),y=(0,n.useCallback)((()=>{t&&t(o)}),[t,o]);return null!=h&&h.asActor&&h.table===l.KJ?(0,p.jsx)(u.ZP,{actor:h,format:m.isMobile?u.ZP.Format.Medium:u.ZP.Format.Small,showRemoveButton:!!t,onClickRemove:y,shouldShrink:!0,isSingle:!1},h.id):null}},625757:(e,t,o)=>{o.d(t,{F:()=>k,Z:()=>S});var n=o(667294),i=o(800480),r=o(886628),a=o(724405),s=o(80721),l=o(612392),c=o(709291),u=o(137810),d=o(573063),p=o(478140),m=o(632163),g=o(840721),h=o(489728),y=o(460709),f=o(785893);const x=(0,c.defineMessages)({backButtonAriaLabel:{id:"notificationRuleSettingsMenu.backButton.ariaLabel",defaultMessage:"Back to previous step"}});function S(e){const{type:t,automationTriggerActionMenuStore:o,headerTitle:n,onClose:i,width:r,onDone:a}=e,s=k({automationTriggerActionMenuStore:o,onClose:i,onDone:a,title:n,width:r});return"custom"===t?(0,f.jsx)(b,{...e,menuProps:s}):(0,f.jsx)(v,{...e,menuProps:s})}function v(e){const{sections:t,menuProps:o}=e;return(0,f.jsx)(p.Z,{...o,children:(0,f.jsx)(m.Z,{type:m.i.Vertical,initialFocus:0,sections:t})})}function b(e){const{children:t,menuProps:o}=e;return(0,f.jsx)(p.Z,{...o,children:t})}function C(e){const{automationActionMenuStore:t,menuHeaderTitle:o,onDone:n}=e,i=(0,c.useIntl)(),l=(0,r.VK)((()=>t.state.stack.length>1),[t]),p=(0,a.yK)((e=>({header:{display:"flex",alignItems:"center",margin:8,color:e.mediumTextColor,fontWeight:u.Z.fontWeight.medium,fontSize:u.Z.fontSize.UISmall.desktop},iconButtonStyle:{marginRight:8,marginLeft:-2,height:22},iconButtonIconStyle:{width:16,height:16},doneButtonStyle:{marginLeft:"auto"}})),[]);return void 0!==o||l?(0,f.jsxs)("div",{style:p.header,children:[l&&(0,f.jsx)(d.Z,{ariaLabel:i.formatMessage(x.backButtonAriaLabel),icon:s.W,style:p.iconButtonStyle,iconStyle:p.iconButtonIconStyle,onClick:()=>{t.popSettingsItem()}}),o,n&&(0,f.jsx)(h.Z,{onClick:n,isBlue:!0,style:p.doneButtonStyle,children:(0,f.jsx)(c.FormattedMessage,{id:"automationTriggerActionMenu.doneButton.title",defaultMessage:"Done"})})]}):null}function k(e){const{automationTriggerActionMenuStore:t,leftStyle:o,onClose:r,onDone:a,rightStyle:s,title:u,titleStyle:p,width:m}=e,{isMobile:h}=(0,i.Fy)(),S=(0,c.useIntl)(),v=(0,n.useCallback)((()=>{1===t.getState().stack.length?r():t.popSettingsItem()}),[t,r]);return(0,n.useMemo)((()=>{let e;return e=h?{leftOuterStyle:o,menuType:y.og.Modal,title:u,titleOuterStyle:p,left:(0,f.jsx)(d.Z,{ariaLabel:S.formatMessage(x.backButtonAriaLabel),icon:l.S,onClick:v}),right:(0,f.jsx)(g.DoneMenuText,{}),rightOuterStyle:s,onClickRight:()=>{null==a||a(),r()}}:{width:m??266,menuType:y.og.Popup,maxHeight:"50vh",header:(0,f.jsx)(C,{automationActionMenuStore:t,menuHeaderTitle:u,onDone:a})},e}),[t,S,h,o,r,a,v,s,u,p,m])}},166315:(e,t,o)=>{o.d(t,{R:()=>b});o(21703);var n=o(667294),i=o(886628),r=o(725651),a=o(937612),s=o(709291),l=o(401898),c=o(552275),u=o(478140),d=o(632163),p=o(672495),m=o(825464),g=o(61766),h=o(312455),y=o(595193),f=o(67473),x=o(293060),S=o(847957),v=o(785893);function b(e){const{onDelete:t,styles:o}=e,{disabled:r}=(0,h.i)(),a=Boolean(r),s=(0,i.qz)(void 0,g.Z),l=(0,n.useCallback)((()=>{if(!t)throw new Error("onDelete is not implemented for trigger");t(),s.setState({open:!1})}),[s,t]),c=(0,n.useMemo)((()=>t?(0,v.jsx)(C,{onDelete:l}):null),[t,l]),u=(0,n.useCallback)((t=>{const n=e.onClick?S.YG:S._S;return(0,v.jsx)(n,{...t,actionMenu:c,buttonPopupStore:s,disabled:a,icon:e.icon,onClick:e.onClick,styles:o,children:e.children})}),[e.onClick,e.icon,e.children,c,s,a,o]);return(0,v.jsx)(f.HC,{children:(0,v.jsx)(x.y,{disable:a,renderOrigin:u,title:e.tooltip,tooltipAlignment:m.v.Center,tooltipPlacement:m.u.Left})})}function C(e){const{onClose:t,onEdit:o,onDelete:n}=e,i=(0,y.F)(),m=[o?{action:()=>{null==t||t(),o()},key:"edit",render:e=>(0,v.jsx)(c.Z,{...e,icon:(0,r.R)({height:16,width:16}),title:(0,v.jsx)(s.FormattedMessage,{id:"automationBaseStepElement.moreActionsMenu.edit",defaultMessage:"Edit"})})}:void 0,n?{action:()=>{null==t||t(),n()},key:"delete",render:e=>(0,v.jsx)(c.Z,{...e,icon:(0,a.y)({height:16,width:16}),title:(0,v.jsx)(s.FormattedMessage,{id:"automationBaseStepElement.moreActionsMenu.delete",defaultMessage:"Delete"})})}:void 0].filter(l.$K);return(0,v.jsx)(u.Z,{...i,children:(0,v.jsx)(d.Z,{type:d.i.Vertical,sections:[{items:m,key:"items",render:e=>(0,v.jsx)(p.Z,{enableActionSheetTitle:!0,topBorder:!0,...e})}],initialFocus:0})})}},332713:(e,t,o)=>{o.d(t,{Z:()=>re});var n=o(667294),i=o(886628),r=o(401898),a=o(991738),s=o(443261),l=o.n(s),c=o(724405),u=o(603865),d=o(12396),p=o(605257),m=o(725651),g=o(747453),h=o(709291),y=o(547307),f=o(552275),x=o(268894),S=o(478140),v=o(632163),b=o(672495),C=o(311335),k=o(319385),M=o(312455),j=o(595193),T=o(753570),A=o(785893);const P=(0,h.defineMessages)({searchInputPlaceholder:{id:"automationEventTriggerMenu.searchInputPlaceholder.label",defaultMessage:"Search for trigger…"},pageAddedCopy:{id:"automationEventTriggerMenu.pageAdded.title",defaultMessage:"Page added"},pagePropertiesEditedCopy:{id:"automationEventTriggerMenu.anyPropertyEdited.title",defaultMessage:"Any property"}});function w(e){const{automationTriggerMenuStore:t,onClose:o}=e,{automationStore:a,collectionStore:s}=(0,M.P)(),w=(0,c.Fg)(),V=(0,h.useIntl)(),I=(0,T.i)(),F=(0,n.useMemo)((()=>({...I,closeMenu:o})),[I,o]),[Z,B]=n.useState(""),K=(0,i.VK)((()=>s.getSchema()),[s]),_=(0,i.VK)((()=>a.getTrigger()),[a]),R=(0,i.VK)((()=>("event"===(null==_?void 0:_.type)||"notification_event"===(null==_?void 0:_.type))&&_.event.pagesAdded),[_]),N=(0,i.VK)((()=>(0,u.XO)({collectionFormat:s.getFormat(),collectionSchema:K})),[s,K]),D=(0,C.EF)({collectionSchema:K,propertyIds:N,searchTerm:Z}),L=(0,c.yK)((e=>({propertyIcon:{width:16,height:16,color:e.mediumIconColor}})),[]),O=(0,j.F)({maxHeight:"50vh",width:266}),W=(0,A.jsx)(x.ZP,{focus:!0,style:{marginTop:12,marginBottom:6},value:Z,onChange:e=>{B(e.target.value)},placeholder:V.formatMessage(P.searchInputPlaceholder)}),E=R?void 0:function(e){const{intl:t,searchInput:o,styles:n,actions:i}=e,r=t.formatMessage(P.pageAddedCopy);if(!l().test(o,r))return;return{key:"page_added_section",items:[{key:"page_added",action(){i.addPageAddedTrigger(),i.closeMenu()},render:e=>(0,A.jsx)(f.Z,{...e,icon:(0,g.R)(n.propertyIcon),title:r})}],render:e=>(0,A.jsx)(b.Z,{...e})}}({intl:V,searchInput:Z,actions:F,styles:L}),H=(0,i.VK)((()=>function(e){const{automationTriggerValue:t,automationTriggerMenuStore:o,showTopBorder:n,properties:i,collectionSchema:a,theme:s,intl:c,searchInput:g,styles:x,actions:S}=e,v=c.formatMessage(P.pagePropertiesEditedCopy);let C=!1,M=[];"event"!==(null==t?void 0:t.type)&&"notification_event"!==(null==t?void 0:t.type)||(C="any"===t.event.pagePropertiesEdited.type,M="some"===t.event.pagePropertiesEdited.type?t.event.pagePropertiesEdited.some:[]);const j=[C||!l().test(g,v)?void 0:{key:"any_property_edited",action:async()=>{const e=await async function(e){const{hasSpecificPropertyChangedFilters:t}=e;if(!t)return!0;return await y.confirmUserAction({message:(0,A.jsx)(h.FormattedMessage,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.message",defaultMessage:"Replace other triggers?"}),description:(0,A.jsx)(h.FormattedMessage,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.description",defaultMessage:"Adding the 'Any property edited' trigger will replace all other property triggers."}),acceptLabel:(0,A.jsx)(h.FormattedMessage,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.acceptLabel",defaultMessage:"Replace"})})}({hasSpecificPropertyChangedFilters:M.length>0});e&&(S.addAnyPropertyEditedTrigger(),S.closeMenu())},render:e=>(0,A.jsx)(f.Z,{...e,icon:(0,m.R)(x.propertyIcon),title:v})},...i.map((e=>{if(!M.find((t=>t.property===e)))return function(e){const{automationTriggerMenuStore:t,propertyId:o,collectionSchema:n,theme:i,actions:r}=e,a=n[o];if(!a)return;let s=(0,u.bD)(a);"person"===a.type?s=k.default.checkGate({gateName:"automation_advanced_person_trigger_actions"}):"number"===a.type&&(s=k.default.checkGate({gateName:"automation_advanced_number_trigger_actions"}));return{key:o,action:()=>{s?t.pushSettingsItem({type:"propertyChangedFilter",property:o}):(r.addPropertyTrigger({property:o,filter:{operator:"changes_to_any"}}),r.closeMenu())},render:e=>(0,A.jsx)(f.Z,{...e,icon:(0,A.jsx)(d.ZP,{icon:a.icon,type:a.type,size:16,theme:i}),title:a.name,right:s?(0,p.o)({marginLeft:6,width:12,height:"auto"}):void 0})}}({propertyId:e,collectionSchema:a,theme:s,automationTriggerMenuStore:o,actions:S})})).filter(r.$K)].filter(r.$K);if(0===j.length)return;return{key:"page_properties_edited_section",items:j,render:e=>(0,A.jsx)(b.Z,{...e,topBorder:n,title:(0,A.jsx)(h.FormattedMessage,{id:"automationEventTriggerMenu.pagePropertiesEditedSection.title",defaultMessage:"Property edited"})})}}({automationTriggerValue:_,automationTriggerMenuStore:t,showTopBorder:Boolean(E),properties:D,collectionSchema:K,theme:w,searchInput:Z,intl:V,styles:L,actions:F})),[_,t,E,D,K,w,Z,V,L,F]),U=n.useMemo((()=>{const e=[E,H].filter(r.$K);return 0===e.length?[{key:"none",items:[{key:"none-item",action:()=>{},render:e=>(0,A.jsx)(f.Z,{...e,disabled:!0,disabledFeedback:!0,title:(0,A.jsx)(h.FormattedMessage,{id:"automations.eventTriggerMenu.noResultsItem",defaultMessage:"No results"})})}],render:e=>(0,A.jsx)(b.Z,{...e})}]:e}),[E,H]);return(0,A.jsx)(S.Z,{...O,header:W,children:(0,A.jsx)(v.Z,{type:v.i.Vertical,sections:U,initialFocus:0})})}var V=o(576205),I=o(625757);function F(e){const{propertyId:t,automationTriggerMenuStore:o,propertySchema:r,propertyChangedFilter:a,onClose:s}=e,{updatePropertyTrigger:l}=(0,T.i)(),c=(0,i.VK)((()=>"changes_to_any"===a.operator?[{type:"exact",value:!0},{type:"exact",value:!1}]:(0,V.XA)(a)&&(0,V.vR)(a)?Array.isArray(a.value)?a.value:[a.value]:[]),[a]),[u,d]=(0,n.useState)(c),p=(0,n.useMemo)((()=>1===u.length?{operator:"checkbox_is",value:u[0]}:{operator:"changes_to_any"}),[u]),m=(0,n.useMemo)((()=>2===u.length||1===u.length&&"partial"),[u]),g=(0,n.useCallback)((e=>{const t=Boolean(u.find((t=>t.value===e)));d(t?u.filter((t=>t.value!==e)):[...u,{type:"exact",value:e}])}),[u]),y=(0,n.useCallback)((()=>{l({anyOptionCheckState:m,propertyId:t,currentFilter:p}),s()}),[m,p,s,t,l]),x=Boolean(u.find((e=>!0===e.value))),S=Boolean(u.find((e=>!1===e.value)));return(0,A.jsx)(I.Z,{type:"default",automationTriggerActionMenuStore:o,onDone:y,onClose:s,sections:[{key:"select",render:e=>(0,A.jsx)(b.Z,{...e,topBorder:!0}),items:[{key:"unchecked",render:e=>(0,A.jsx)(f.Z,{...e,checkState:S,isTokenTitle:!0,title:(0,A.jsx)(h.FormattedMessage,{defaultMessage:"Unchecked",id:"automations.propertyTrigger.checkbox.unchecked"})}),action:()=>g(!1)},{key:"checked",render:e=>(0,A.jsx)(f.Z,{...e,checkState:x,isTokenTitle:!0,title:(0,A.jsx)(h.FormattedMessage,{defaultMessage:"Checked",id:"automations.propertyTrigger.checkbox.checked"})}),action:()=>g(!0)}]}],headerTitle:(0,A.jsx)(h.FormattedMessage,{id:"automations.propertyTrigger.checkbox.title",defaultMessage:"{propertyName} set to",values:{propertyName:r.name}})})}var Z=o(180951),B=o(272320),K=o(307931);function _(e){let{handleSelectOperator:t,selectedItem:o}=e;const n=(0,c.yK)((e=>({buttonStyle:{fontSize:12,height:20,paddingLeft:2,paddingRight:2}})),[]);return(0,A.jsx)(K.Z,{innerButtonStyle:n.buttonStyle,selectedTitle:(0,A.jsx)(h.FormattedMessage,{...o.text}),renderMenuSections:e=>[{key:"selectNumberOperator",render:e=>(0,A.jsx)(b.Z,{...e}),items:Object.values(N).map((o=>({key:o.value,action:()=>{t(o),e.close()},render:e=>(0,A.jsx)(f.Z,{...e,title:(0,A.jsx)(h.FormattedMessage,{...o.text})})})))}]})}const R=(0,h.defineMessages)({changesToAny:{id:"automations.propertyTrigger.numberField.changesToAnyOption",defaultMessage:"any"},numberEquals:{id:"automations.propertyTrigger.numberField.equalsOption",defaultMessage:"="},numberGreaterThanOrEqualTo:{id:"automations.propertyTrigger.numberField.greaterThanOrEqualTo",defaultMessage:"≥"},numberLessThanOrEqualTo:{id:"automations.propertyTrigger.numberField.lessThanOrEqualTo",defaultMessage:"≤"},isEmpty:{id:"automations.propertyTrigger.numberField.isEmpty",defaultMessage:"empty"},numberGreaterThan:{id:"automations.propertyTrigger.numberField.greaterThan",defaultMessage:">"},numberLessThan:{id:"automations.propertyTrigger.numberField.lessThan",defaultMessage:"<"},numberDoesNotEqual:{id:"automations.propertyTrigger.numberField.doesNotEqualOption",defaultMessage:"≠"}}),N={changes_to_any:{hasInput:!1,text:R.changesToAny,value:"changes_to_any"},number_equals:{hasInput:!0,text:R.numberEquals,value:"number_equals"},number_does_not_equal:{hasInput:!0,text:R.numberDoesNotEqual,value:"number_does_not_equal"},number_greater_than:{hasInput:!0,text:R.numberGreaterThan,value:"number_greater_than"},number_less_than:{hasInput:!0,text:R.numberLessThan,value:"number_less_than"},number_greater_than_or_equal_to:{hasInput:!0,text:R.numberGreaterThanOrEqualTo,value:"number_greater_than_or_equal_to"},number_less_than_or_equal_to:{hasInput:!0,text:R.numberLessThanOrEqualTo,value:"number_less_than_or_equal_to"},is_empty:{text:R.isEmpty,value:"is_empty",hasInput:!1}};function D(e){let{automationTriggerMenuStore:t,onClose:o,propertyChangedFilter:a,propertySchema:s,propertyId:l}=e;const c=(0,i.VK)((()=>{if("changes_to_any"!==a.operator&&(0,V.h6)(a)&&"is_empty"!==a.operator)return(0,V.vR)(a)?a.value.value:void 0}),[a]),[u,d]=(0,n.useState)(a.operator),[p,m]=(0,n.useState)(c),g=(0,n.useMemo)((()=>{if(p)return{type:"simple",value:(0,Z.eP)(p)}}),[p]),{updatePropertyTrigger:y}=(0,T.i)(),{automationContextStore:f}=(0,M.i)(),x=(0,i.VK)((()=>(null==f?void 0:f.getAllContextValues())??[]),[f]),S=(0,n.useCallback)((e=>{const t=(0,Z.VY)(null==e?void 0:e.value);m(t)}),[]),v=(0,n.useCallback)((e=>{d(e.value),N[e.value].hasInput||m(void 0)}),[]),b=(0,n.useCallback)((()=>{const e=(0,r.$K)(p)?{operator:u,value:{type:"exact",value:p}}:{operator:"is_empty"};let t="partial";"changes_to_any"===u?t=!0:"is_empty"===u&&(t=!1),y({anyOptionCheckState:t,propertyId:l,currentFilter:e,propertySchema:s}),o()}),[u,p,o,l,s,y]),C=(0,n.useMemo)((()=>N[u||"changes_to_any"]),[u]);return(0,A.jsx)(I.Z,{type:"default",automationTriggerActionMenuStore:t,onDone:b,onClose:o,headerTitle:(0,A.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr",gridGap:"4px",alignItems:"center"},children:[(0,A.jsx)(h.FormattedMessage,{...L.title,values:{propertyName:s.name}}),(0,A.jsx)(_,{selectedItem:C,handleSelectOperator:v})]}),sections:[{key:"numberInput",items:[],render:e=>C.hasInput&&(0,A.jsx)("div",{style:{marginTop:"2px"},children:(0,A.jsx)(B.Z,{currentSimpleFormulaValueTokens:[],formulaTypecheckContextValues:x,onChange:S,onClose:o,value:g})})}]})}const L=(0,h.defineMessages)({title:{id:"automations.propertyTrigger.numberField.title",defaultMessage:"{propertyName} set to"}});var O=o(800480),W=o(576218),E=o(559054),H=o(260458),U=o(669141),z=o(296994),$=o(675822);function G(e){var t,o,a;let{automationTriggerMenuStore:s,collectionStore:l,onClose:c,propertyChangedFilter:u,propertySchema:d,propertyId:p}=e;const m=(0,i.VK)((()=>{if("changes_to_any"!==u.operator)return(0,V.Gb)(u)&&"is_empty"!==u.operator&&(0,V.vR)(u)?(0,V.R8)(u):[]}),[u]),[g,y]=(0,n.useState)((()=>{if(m){const e=m.map((e=>{if("exact"===e.type)return e.value})).filter(r.$K);return{action:"replace",value:{type:"simple",value:(0,Z.C1)(e)}}}})),x=(0,O.O7)(),[S]=(0,E.r5)((async()=>{const e=await z.FF.searchActions.load();return(await e.searchVisibleSpaceUsers({environment:x,query:"",membersOnly:!1})).length}),[x],{debounce:$.vp}),v=(0,n.useRef)(),[C,k]=(0,n.useState)(!m),j=(0,i.VK)((()=>{var e;return function(e){const{formulaValue:t,allChecked:o,numTotalActors:n}=e;if(o)return!0;if(t&&t.length>0){return(0,W.A6)(t).length===n||"partial"}return!1}({propertySchema:d,formulaValue:null==g||null===(e=g.value)||void 0===e?void 0:e.value,allChecked:C,numTotalActors:S.value||0})}),[d,null==g||null===(t=g.value)||void 0===t?void 0:t.value,C,S.value]),P=(0,n.useMemo)((()=>{var e;return(0,W.A6)(null==g||null===(e=g.value)||void 0===e?void 0:e.value)}),[null==g||null===(o=g.value)||void 0===o?void 0:o.value]),{automationContextStore:w}=(0,M.i)(),F=(0,n.useMemo)((()=>({collectionStore:l,property:p,type:"collection"})),[l,p]),B=(0,i.VK)((()=>(null==w?void 0:w.getAllContextValues())??[]),[w]),{updatePropertyTrigger:K}=(0,T.i)(),_=(0,n.useCallback)((e=>{v.current=e,y({action:"replace",value:e})}),[]),R=null!=g&&g.value?(0,Z.DW)({textValue:null==g||null===(a=g.value)||void 0===a?void 0:a.value,propertySchema:d,blockCreatorPointer:void 0}):void 0,N=(0,n.useCallback)((()=>{const e=R&&0!==R.length?{operator:"person_contains",value:R.map((e=>({type:"exact",value:e})))}:{operator:"is_empty"};K({anyOptionCheckState:j,propertyId:p,currentFilter:e,propertySchema:d}),c()}),[R,j,c,p,d,K]);return w&&F?(0,A.jsx)(I.Z,{type:"default",automationTriggerActionMenuStore:s,onDone:N,onClose:c,headerTitle:(0,A.jsx)(h.FormattedMessage,{id:"automations.propertyTrigger.personCheckbox.title",defaultMessage:"{propertyName} set to",values:{propertyName:d.name}}),sections:[{key:"any",items:[{key:"any-option-item",action:()=>{k(!C)},render:e=>(0,A.jsx)(f.Z,{...e,icon:(0,A.jsx)(H.Z,{checked:j,size:14,onClick:e.onClick}),title:(0,A.jsx)(h.FormattedMessage,{id:"automationEventTriggerPropertyChangedFilterMenu.anyOption.title",defaultMessage:"Any option"})})}],render:e=>(0,A.jsx)(b.Z,{...e})},{key:"items",items:[],render:e=>(0,A.jsx)(A.Fragment,{children:!C&&(0,A.jsx)(U.Z,{currentSimpleFormulaValueTokens:P,formulaTypecheckContextValues:B,formulaValueContext:F,limit:void 0,onChange:_,onClose:c,showClearButton:!0,showInputMenuItem:!0,value:null==g?void 0:g.value})})}]}):null}var q=o(984619),Y=o(653965),Q=o(576852),X=o(122084),J=o(147082);function ee(e){const{propertyId:t,automationTriggerMenuStore:o,propertySchema:a,propertyChangedFilter:s,onClose:l}=e,{isMobile:c,isAndroid:u}=(0,O.Fy)(),d=(0,h.useIntl)(),{updatePropertyTrigger:p}=(0,T.i)(),m=(0,i.VK)((()=>{if("changes_to_any"===s.operator){return(a.options??[]).map((e=>({type:"exact",value:e.value})))}if(!(0,V.dx)(s)&&!(0,V.NU)(s))return[];if((0,V.vR)(s)){const e=(a.options??[]).map((e=>e.value));return(Array.isArray(s.value)?s.value:[s.value]).filter((t=>(0,r.$K)(t.value)&&e.includes(t.value)))}return[]}),[a,s]),[g,y]=n.useState(m),x=(0,i.VK)((()=>function(e){const{propertySchema:t,selectedOptions:o}=e;let n=!1,i=!0;const r=t.options??[];for(const a of r){const e=o.some((e=>e.value===a.value));n||=e,i&&=e}return!!i||!!n&&"partial"}({propertySchema:a,selectedOptions:g})),[a,g]),S=n.useMemo((()=>(a.options??[]).map((e=>({type:"exact",value:e.value})))),[a]),v=n.useMemo((()=>"multi_select"===a.type?{operator:"enum_contains",value:g}:"select"===a.type?{operator:"enum_is",value:g}:(0,r.t1)(a)),[a,g]),C=!0===x?[]:g.map((e=>{if(!e.value||!a.options)return;const t=(0,Z.i7)(a.options,e.value);return t?(0,A.jsx)(X.a,{format:c?q.lo.Large:q.lo.Small,isSingle:!1,value:t.value,color:t.color,showRemoveButton:!0,onClickRemove:()=>{const t=Y.zu(g,e);y(t)}},t.id):void 0})),[k,M]=n.useState(""),j=(0,Q.I4)({query:k,propertySchema:a,selectedValues:g,updateValue:e=>{M(""),y(e)},isMobile:c,styles:{}}),P=[{key:"search",items:[{key:"input",action:()=>{},render:e=>(0,A.jsx)(J.ZP,{...e,focusInitial:!0,onClick:void 0,focusAfterAnimation:!0,format:J.UR.FilterValue,tokens:C,placeholder:x?d.formatMessage({defaultMessage:"Any option",id:"automations.selectPropertyChangedFilter.inputPlaceholder.anyOption"}):d.formatMessage({defaultMessage:"Select one or more options…",id:"automations.selectPropertyChangedFilter.inputPlaceholder.searchPlaceholder"}),onRemoveLastToken:()=>{const e=g.slice(0,g.length-1);y(e)},onClearButtonClick:()=>{y([]),l()},value:k,onChange:e=>{M(e.target.value)},dontShowBorderBottom:u,showClearButton:!0})}],render:e=>(0,A.jsx)(b.Z,{...e})},{key:"any",items:[{key:"any-option-item",action:()=>{!0===x?y([]):!1===x||"partial"===x?y(S):(0,r.t1)(x),M("")},render:e=>(0,A.jsx)(f.Z,{...e,icon:(0,A.jsx)(H.Z,{checked:x,size:14,onClick:e.onClick}),title:(0,A.jsx)(h.FormattedMessage,{id:"automations.selectPropertyChangedFilter.anyOption.title",defaultMessage:"Any option"})})}],render:e=>(0,A.jsx)(b.Z,{...e,topBorder:!0})},j.length>0?{key:"items",items:j,render:e=>(0,A.jsx)(b.Z,{...e,topBorder:!0})}:void 0].filter(r.$K);return(0,A.jsx)(I.Z,{type:"default",automationTriggerActionMenuStore:o,onDone:()=>{p({anyOptionCheckState:x,propertyId:t,currentFilter:v}),l()},onClose:l,sections:P,headerTitle:(0,A.jsx)(h.FormattedMessage,{id:"automations.propertyChangedFilterHeader.select.title",defaultMessage:"{propertyName} set to",values:{propertyName:a.name}})})}var te=o(582584),oe=o(397004);function ne(e){const{propertyId:t,automationTriggerMenuStore:o,propertySchema:a,propertyChangedFilter:s,onClose:l}=e,{isMobile:c}=(0,O.Fy)(),{updatePropertyTrigger:u}=(0,T.i)(),d=(0,i.VK)((()=>{if("changes_to_any"===s.operator){return(a.groups??[]).map((e=>({type:"is_group",value:e.name})))}return(0,V.r2)(s)&&(0,V.vR)(s)?(0,V.wB)(s):[]}),[a,s]),[p,m]=n.useState(d),g=(0,i.VK)((()=>function(e){const{propertySchema:t,selectedStatusOptions:o}=e,n=t.groups??[],i=t.options??[],r=n.map((e=>(0,oe.IX)({group:e,options:i,filterValues:o}))),a=r.every((e=>!0===e.groupCheckState)),s=r.some((e=>!1!==e.groupCheckState));return!!a||!!s&&"partial"}({propertySchema:a,selectedStatusOptions:p})),[a,p]),y=n.useMemo((()=>(a.groups??[]).map((e=>({type:"is_group",value:e.name})))),[a]),x=(0,te.S)({propertySchema:a,statusFilterValues:p,updateValue:e=>{m(e)},isMobile:c,styles:{},visibleOptions:a.options??[]});return(0,A.jsx)(I.Z,{type:"default",automationTriggerActionMenuStore:o,onDone:()=>{u({anyOptionCheckState:g,propertyId:t,currentFilter:{operator:"status_is",value:p}}),l()},onClose:()=>{l()},sections:[{key:"any",items:[{key:"any-option-item",action:()=>{!0===g?m([]):!1===g||"partial"===g?m(y):(0,r.t1)(g)},render:e=>(0,A.jsx)(f.Z,{...e,icon:(0,A.jsx)(H.Z,{checked:g,size:14,onClick:e.onClick}),title:(0,A.jsx)(h.FormattedMessage,{id:"automationEventTriggerPropertyChangedFilterMenu.anyOption.title",defaultMessage:"Any option"})})}],render:e=>(0,A.jsx)(b.Z,{...e})},{key:"items",items:x,render:e=>(0,A.jsx)(b.Z,{...e,topBorder:!0})}],headerTitle:(0,A.jsx)(h.FormattedMessage,{id:"automations.propertyChangedFilterHeader.status.title",defaultMessage:"{propertyName} set to",values:{propertyName:a.name}})})}function ie(e){const{propertyId:t,automationTriggerMenuStore:o,onClose:n}=e,{automationStore:r,collectionStore:a}=(0,M.P)(),s=(0,i.VK)((()=>a.getSchema()),[a])[t],l=(0,i.VK)((()=>r.getTrigger()),[r]);let c=[];"event"!==(null==l?void 0:l.type)&&"notification_event"!==(null==l?void 0:l.type)||(c="some"===l.event.pagePropertiesEdited.type?l.event.pagePropertiesEdited.some:[]);const d=c.find((e=>e.property===t))??{property:t,filter:{operator:"changes_to_any"}};if(!s)return null;return(0,u.bD)(s)?"multi_select"===s.type||"select"===s.type?(0,A.jsx)(ee,{propertyId:t,automationTriggerMenuStore:o,propertySchema:s,propertyChangedFilter:d.filter,onClose:n}):"status"===s.type?(0,A.jsx)(ne,{propertyId:t,automationTriggerMenuStore:o,propertySchema:s,propertyChangedFilter:d.filter,onClose:n}):"checkbox"===s.type?(0,A.jsx)(F,{automationTriggerMenuStore:o,onClose:n,propertyChangedFilter:d.filter,propertyId:t,propertySchema:s}):"person"===s.type?(0,A.jsx)(G,{automationTriggerMenuStore:o,collectionStore:a,onClose:n,propertyChangedFilter:d.filter,propertyId:t,propertySchema:s}):"number"===s.type?(0,A.jsx)(D,{automationTriggerMenuStore:o,onClose:n,propertyChangedFilter:d.filter,propertyId:t,propertySchema:s}):null:null}function re(e){const{initialState:t,buttonPopupParent:o}=e,s=(0,i.VK)((()=>{const e=new a.Bh;return e.setState({insertionPoint:void 0,stack:[t]}),e}),[t]),l=(0,i.VK)((()=>s.getCurrentTab()),[s]),c=(0,n.useCallback)((()=>o.close()),[o]);return l?"eventTriggers"===l.type?(0,A.jsx)(w,{automationTriggerMenuStore:s,onClose:c}):"propertyChangedFilter"===l.type?(0,A.jsx)(ie,{propertyId:l.property,automationTriggerMenuStore:s,onClose:c}):(0,r.t1)(l):null}},275563:(e,t,o)=>{o.d(t,{Dl:()=>q,ew:()=>G,Zr:()=>Y});var n=o(667294),i=o(886628),r=o(312455),a=o(724405),s=o(747453),l=o(709291),c=o(137810),u=o(756812),d=o(753570),p=o(166315),m=o(785893);function g(){const{removeAnyPropertyEditedTrigger:e}=(0,d.i)(),t=(0,l.useIntl)(),o=(0,a.yK)((()=>({title:{fontWeight:c.Z.fontWeight.medium}})),[]),n=u.c5(t);return(0,m.jsx)(p.R,{icon:s.R,onDelete:e,tooltip:n,children:(0,m.jsx)("div",{style:o.title,children:n})})}var h=o(603865),y=o(576205),f=o(319385),x=o(231945),S=o(435294),v=o(332713);function b(e){const{renderOrigin:t,property:o}=e,n=(0,S.d)();return(0,m.jsx)(x.ZP,{popupType:n,renderOrigin:t,render:e=>(0,m.jsx)(v.Z,{initialState:{type:"propertyChangedFilter",property:o},buttonPopupParent:e})})}var C=o(720239),k=o(951230),M=o(61410);function j(e){let{propertySchema:t,onClick:o}=e;return(0,m.jsx)(M.n,{onClick:o,icon:e=>(0,m.jsx)(k.Y,{propertySchema:t,style:e}),tooltip:(0,m.jsx)(A,{propertyName:t.name}),children:(0,m.jsx)(T,{propertyName:t.name})})}function T(e){let{propertyName:t}=e;const o=(0,l.useIntl)(),n=(0,a.yK)((()=>({propertyName:{...c.Z.textOverflowStyle,fontWeight:c.Z.fontWeight.medium},wrap:{alignItems:"center",display:"flex",whiteSpace:"pre"}})),[]),i=u.Vf(o,{propertyName:(0,m.jsx)("span",{style:n.propertyName,children:t})});return(0,m.jsx)("span",{style:n.wrap,children:i})}function A(e){let{propertyName:t}=e;const o=(0,l.useIntl)();return(0,m.jsx)(m.Fragment,{children:u.Vf(o,{propertyName:t})})}function P(e){let{propertySchema:t,onClick:o}=e;return(0,m.jsx)(M.n,{onClick:o,icon:e=>(0,m.jsx)(k.Y,{propertySchema:t,style:e}),tooltip:(0,m.jsx)(V,{propertyName:t.name}),children:(0,m.jsx)(w,{propertyName:t.name})})}function w(e){let{propertyName:t}=e;const o=(0,l.useIntl)(),n=(0,a.yK)((()=>({propertyName:{...c.Z.textOverflowStyle,fontWeight:c.Z.fontWeight.medium},wrap:{alignItems:"center",display:"flex",whiteSpace:"pre"}})),[]),i=u.$G(o,{propertyName:(0,m.jsx)("span",{style:n.propertyName,children:t})});return(0,m.jsx)("span",{style:n.wrap,children:i})}function V(e){let{propertyName:t}=e;const o=(0,l.useIntl)();return(0,m.jsx)(m.Fragment,{children:u.$G(o,{propertyName:t})})}var I=o(993416);function F(e){const{filter:t,propertySchema:o,onClick:n}=e,{title:i,tooltipTitle:r,styles:a}=(0,I.Kk)({numberValue:t.value.value,operator:t.operator,propertySchema:o,messageType:"trigger"});return(0,m.jsx)(M.n,{onClick:n,tooltip:(0,m.jsx)("span",{children:r}),children:(0,m.jsx)("div",{style:a.content,children:i})})}var Z=o(599184),B=o(654497),K=o(401898),_=o(61766),R=o(629735),N=o(392688);function D(e){const{deletedPropertySchema:t}=e,{property:o}=(0,n.useContext)(G),{removePropertyTrigger:r}=(0,d.i)(),s=(0,a.yK)((e=>({content:{color:e.text.uiRedPrimary,fontWeight:c.Z.fontWeight.medium,whiteSpace:"normal"},icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.accentColors.red[700]}})),[]),l=(0,S.d)(),u=(0,i.qz)(void 0,_.Z),g=(0,n.useCallback)((()=>u.reset()),[u]),h=(0,n.useCallback)((()=>{r(o)}),[o,r]),y=(0,K.$K)(t)?(0,R.Ox)({propertySchema:t,styles:s}):(0,R.fX)(),f=(0,K.$K)(t)?(0,R.Si)({propertySchema:t}):(0,R.fX)();return(0,m.jsx)(x.ZP,{buttonPopupStore:u,popupType:l,render:()=>(0,m.jsx)(N._,{closeMenu:g,propertyId:o}),renderOrigin:e=>(0,m.jsx)(p.R,{...e,icon:B.t,onDelete:h,styles:s,tooltip:f,children:(0,m.jsx)("div",{style:s.content,children:y})})})}var L=o(476954),O=o(687181),W=o(23645),E=o(586034);function H(e){let{propertySchema:t}=e;const{property:o}=(0,n.useContext)(G),{removePropertyTrigger:r}=(0,d.i)(),s=(0,a.yK)((e=>({content:{color:e.text.uiRedPrimary,fontWeight:c.Z.fontWeight.medium,whiteSpace:"normal"},icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.accentColors.red[700]}})),[]),l=(0,S.d)(),u=(0,i.qz)(void 0,_.Z),g=(0,n.useCallback)((()=>u.reset()),[u]),h=(0,n.useCallback)((()=>{r(o)}),[o,r]),y=(0,W.JS)({propertySchema:t,styles:s}),f=(0,W.K1)({propertySchema:t});return(0,m.jsx)(x.ZP,{buttonPopupStore:u,popupType:l,render:()=>(0,m.jsx)(E.Iw,{closeMenu:g,propertyId:o}),renderOrigin:e=>(0,m.jsx)(p.R,{...e,icon:B.t,onDelete:h,styles:s,tooltip:f,children:(0,m.jsx)("div",{style:s.content,children:y})})})}function U(e){const{collectionStore:t}=(0,r.P)(),{property:o,filter:n}=e,a=(0,i.VK)((()=>f.default.checkGate({gateName:"automation_advanced_person_trigger_actions"})),[]),s=(0,i.VK)((()=>f.default.checkGate({gateName:"automation_advanced_number_trigger_actions"})),[]),[l,c]=(0,i.VK)((()=>{var e,n;return[null===(e=t.getSchema())||void 0===e?void 0:e[o],null===(n=t.getDeletedSchema())||void 0===n?void 0:n[o]]}),[t,o]);if(!l)return(0,m.jsx)(D,{deletedPropertySchema:c});if(!(0,h.$M)(l))return(0,m.jsx)(H,{propertySchema:l});const u=!a&&"person"===l.type,d=!s&&"number"===l.type;return!(0,h.bD)(l)||d||u?(0,m.jsx)(P,{propertySchema:l}):(0,m.jsx)($,{property:o,propertySchema:l,filter:n})}function z(e){const{filter:t,onClick:o,propertySchema:n}=e;return"is_empty"===t.operator?(0,m.jsx)(j,{...e,propertySchema:n}):"changes_to_any"!==t.operator&&(0,y.vR)(t)?"checkbox"===n.type&&(0,y.XA)(t)?(0,m.jsx)(C.Ij,{filter:t,onClick:o,propertySchema:n}):"status"===n.type&&(0,y.r2)(t)?(0,m.jsx)(O.V,{filter:t,onClick:o,propertySchema:n}):"select"===n.type&&(0,y.dx)(t)||"multi_select"===n.type&&(0,y.NU)(t)?(0,m.jsx)(L.v,{filter:t,onClick:o,propertySchema:n}):"person"===n.type&&(0,y.Gb)(t)?(0,m.jsx)(Z.u,{filter:t,onClick:o,propertySchema:n}):"number"===n.type&&(0,y.h6)(t)?(0,m.jsx)(F,{filter:t,onClick:o,propertySchema:n}):(0,m.jsx)(P,{onClick:o,propertySchema:n}):(0,m.jsx)(P,{onClick:o,propertySchema:n})}function $(e){const{filter:t,propertySchema:o,property:i}=e,r=(0,n.useCallback)((e=>(0,m.jsx)(z,{filter:t,onClick:e.onClick,propertySchema:o})),[t,o]);return(0,m.jsx)(b,{renderOrigin:r,property:i})}const G=(0,n.createContext)({pagePropertiesEdited:[],property:""});function q(){const{automationContextStore:e,collectionStore:t}=(0,r.i)(),o=(0,i.VK)((()=>null==e?void 0:e.context.automationStore),[e]),n=Y(o),a=(0,i.VK)((()=>{var e;if(!o||!o.isTriggerType("event")&&!o.isTriggerType("notification_event"))return;const t=null===(e=o.getEventConfiguration())||void 0===e?void 0:e.pagePropertiesEdited;return"none"===(null==t?void 0:t.type)?void 0:t}),[o]),s=(0,i.VK)((()=>null==t?void 0:t.getSchema()),[t]);return n&&a?"any"===a.type?(0,m.jsx)(g,{}):s?(0,m.jsx)(m.Fragment,{children:a.some.map((e=>{let{property:t,filter:o}=e;return(0,m.jsx)(G.Provider,{value:{property:t,pagePropertiesEdited:a.some},children:(0,m.jsx)(U,{property:t,filter:o})},t)}))}):null:null}function Y(e){return(0,i.VK)((()=>{if(!(null!=e&&e.isTriggerType("event")||null!=e&&e.isTriggerType("notification_event")))return!1;const t=e.getEventConfiguration();return Boolean("none"!==(null==t?void 0:t.pagePropertiesEdited.type))}),[e])}G.displayName="PropertyEditedTriggerContext"},720239:(e,t,o)=>{o.d(t,{Ij:()=>p,l4:()=>g});o(667294);var n=o(724405),i=o(765628),r=o(196711),a=o(709291),s=o(137810),l=o(620776),c=o(756812),u=o(61410),d=o(785893);function p(e){const t=(0,a.useIntl)(),{propertySchema:o,filter:n,onClick:i}=e;return(0,d.jsx)(u.n,{onClick:i,tooltip:g({filter:n,intl:t,propertySchema:o}),children:(0,d.jsx)(m,{propertySchema:o,filter:n})})}function m(e){let{propertySchema:t,filter:o}=e;const i=(0,a.useIntl)(),r=(0,n.yK)((()=>({propertyName:{...s.Z.textOverflowStyle,fontWeight:s.Z.fontWeight.medium},wrap:{alignItems:"center",display:"flex",whiteSpace:"pre"}})),[]),l=function(e){const{filter:t,intl:o,propertySchema:n,styles:i}=e,r=n.name,a=t.value,s={propertyName:(0,d.jsx)("span",{style:i.propertyName,children:r}),propertyValues:(0,d.jsx)(h,{checkboxValue:a.value??!1})};return(0,c.vz)(o,s)}({filter:o,intl:i,propertySchema:t,styles:r});return(0,d.jsx)("span",{style:r.wrap,children:l})}function g(e){const{filter:t,intl:o,propertySchema:n}=e,i={propertyName:n.name,propertyValues:!0===t.value.value?(0,d.jsx)(a.FormattedMessage,{...c.Bo.actionCheckboxPropertyChecked}):(0,d.jsx)(a.FormattedMessage,{...c.Bo.actionCheckboxPropertyUnchecked})};return(0,c.vz)(o,i)}function h(e){const{checkboxValue:t}=e,o=!0===t?(0,r.V)({width:12}):(0,i.z)({width:10}),n=!0===t?(0,d.jsx)(a.FormattedMessage,{...c.Bo.actionCheckboxPropertyChecked}):(0,d.jsx)(a.FormattedMessage,{...c.Bo.actionCheckboxPropertyUnchecked});return(0,d.jsx)(l.o,{icon:o,children:n})}},599184:(e,t,o)=>{o.d(t,{S:()=>p,u:()=>d});o(757658),o(667294);var n=o(886628),i=o(266897),r=o(576205),a=o(401898),s=o(312455),l=o(113732),c=o(61410),u=o(785893);function d(e){const{filter:t,propertySchema:o,onClick:i}=e,{automationContextStore:r}=(0,s.i)(),a=(0,n.VK)((()=>{if(r)return p(t,r)}),[r,t]),{title:d,tooltipTitle:m,styles:g}=(0,l.TY)({actorModels:a,propertySchema:o,messageType:"trigger"});return(0,u.jsx)(c.n,{onClick:i,tooltip:(0,u.jsx)("span",{children:m}),children:(0,u.jsx)("div",{style:g.content,children:d})})}function p(e,t){const o=null==t?void 0:t.context.automationStore;if(!(0,a.$K)(o))return[];return(0,r.R8)(e).reduce(((e,t)=>("exact"===t.type&&t.value&&e.push((0,i.Hl)({pointer:t.value,getRecordModel:o.getRecordModel})),e)),[])}},61410:(e,t,o)=>{o.d(t,{n:()=>d});var n=o(667294),i=o(886628),r=o(312455),a=o(753570),s=o(166315),l=o(951230),c=o(275563),u=o(785893);function d(e){const{property:t}=(0,n.useContext)(c.ew),{collectionStore:o}=(0,r.P)(),{removePropertyTrigger:d}=(0,a.i)(),p=(0,n.useCallback)((()=>{d(t)}),[t,d]),m=(0,i.VK)((()=>o.getSchema()),[o])[t],g=m?e=>(0,u.jsx)(l.Y,{propertySchema:m,style:e}):void 0;return(0,u.jsx)(s.R,{icon:g,onDelete:p,...e,children:e.children})}},476954:(e,t,o)=>{o.d(t,{v:()=>f,z:()=>S});o(667294);var n=o(724405),i=o(180951),r=o(984619),a=o(709291),s=o(401898),l=o(137810),c=o(122084),u=o(685567),d=o(365380),p=o(756812),m=o(337867),g=o(61410),h=o(785893);const y=5;function f(e){const t=(0,a.useIntl)(),{filter:o,propertySchema:n,onClick:i}=e,r={...l.Z.textOverflowStyle,fontWeight:l.Z.fontWeight.medium},c=o.value,u=n.name,m=(Array.isArray(c)?c:[c]).map((e=>e.value)).filter(s.$K),f=S({intl:t,isText:!0,limit:y,optionValues:m,propertySchema:n}),v=t.formatList(f,{style:"long",type:"disjunction"}),b=(0,p.XJ)(t,{propertyName:(0,h.jsx)("span",{style:r,children:u}),propertyValues:(0,d.H)(v)});return(0,h.jsx)(g.n,{tooltip:b,onClick:i,children:(0,h.jsx)(x,{filter:o,propertySchema:n})})}function x(e){const{filter:t,propertySchema:o}=e,i=(0,a.useIntl)(),r=t.value,c=o.name,u=(Array.isArray(r)?r:[r]).map((e=>e.value)).filter(s.$K),m=S({intl:i,limit:y,optionValues:u,propertySchema:o}),g=i.formatList(m,{style:"long",type:"disjunction"}),f=(0,n.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre"},propertyName:{...l.Z.textOverflowStyle,fontWeight:l.Z.fontWeight.semibold}})),[]),x=(0,p.XJ)(i,{propertyName:(0,h.jsx)("span",{style:f.propertyName,children:c}),propertyValues:(0,d.H)(g)});return(0,h.jsx)("div",{style:f.content,children:x})}function S(e){let{intl:t,isText:o,limit:n,optionValues:a,propertySchema:s,tokenFormat:l=r.lo.Medium}=e;const d=s.options??[],g=a.map((e=>{const n=(0,i.i7)(d,e);return n?o?n.value:(0,h.jsx)(c.a,{value:n.value,color:n.color,format:l,isSingle:!0,showRemoveButton:!1},n.id):o?(0,p.ST)(t):(0,h.jsx)(m.Z,{tokenFormat:l},`missing_option_value_${e}`)}));let y;if(void 0!==n&&g.length>n){const e=g.length-n,t=o?`+${e}`:(0,h.jsx)(u.Z,{format:r.lo.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,value:`+${e}`},"More tokens");y=[...g.slice(0,n),t]}else y=g;return y}},687181:(e,t,o)=>{o.d(t,{L:()=>b,V:()=>x});o(667294);var n=o(724405),i=o(576205),r=o(180951),a=o(984619),s=o(709291),l=o(401898),c=o(137810),u=o(122084),d=o(685567),p=o(365380),m=o(756812),g=o(337867),h=o(61410),y=o(785893);const f=5;function x(e){const t=(0,s.useIntl)(),{filter:o,limit:n=f,propertySchema:r,onClick:a}=e,c=r.name,u=(0,i.wB)(o),d=u.map((e=>"is_group"===e.type?e.value:void 0)).filter(l.$K),p=u.map((e=>"is_option"===e.type?e.value:void 0)).filter(l.$K),m=b({intl:t,groupValues:d,limit:n,optionValues:p,propertySchema:r}),g=b({intl:t,isText:!0,groupValues:d,limit:n,optionValues:p,propertySchema:r});return(0,y.jsx)(h.n,{onClick:a,tooltip:(0,y.jsx)(v,{propertyName:c,statusValues:g}),children:(0,y.jsx)(S,{propertyName:c,statusValues:m})})}function S(e){let{propertyName:t,statusValues:o}=e;const i=(0,s.useIntl)(),r=(0,n.yK)((()=>({propertyName:{...c.Z.textOverflowStyle,fontWeight:c.Z.fontWeight.semibold}})),[]),a=i.formatList(o,{style:"long",type:"disjunction"});return(0,y.jsx)(y.Fragment,{children:(0,m.VO)(i,{propertyName:(0,y.jsx)("span",{style:r.propertyName,children:t}),propertyValues:(0,p.H)(a)})})}function v(e){let{propertyName:t,statusValues:o}=e;const i=(0,s.useIntl)(),r=(0,n.yK)((()=>({propertyName:{...c.Z.textOverflowStyle,fontWeight:c.Z.fontWeight.semibold}})),[]),a=i.formatList(o,{style:"long",type:"disjunction"});return(0,y.jsx)(y.Fragment,{children:(0,m.VO)(i,{propertyName:(0,y.jsx)("span",{style:r.propertyName,children:t}),propertyValues:(0,p.H)(a)})})}function b(e){let{groupValues:t,intl:o,isText:n,limit:i,optionValues:s,propertySchema:c,tokenFormat:p=a.lo.Medium}=e;const h=c.groups||[],f=c.options||[],x=t.map((e=>{const t=h.find((t=>t.name===e));if(t)return n?t.name:(0,y.jsx)("span",{children:t.name},t.id)})).filter(l.$K),S=s.map((e=>{const t=(0,r.i7)(f,e);if(void 0===t)return n?(0,m.ST)(o):(0,y.jsx)(g.Z,{tokenFormat:p},`missing_option_value_${e}`);if(n)return t.value;const i=h.find((e=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return(0,y.jsx)(u.F,{format:p,isSingle:!0,value:t.value,color:t.color,groupColor:null==i?void 0:i.color,showRemoveButton:!1,showEllipsis:!0},t.id)})),v=[...x,...S];let b=[];if(void 0!==i&&v.length>i){const e=S.length-i,t=n?`+${e}`:(0,y.jsx)(d.Z,{format:a.lo.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,value:`+${e}`},"More tokens");b=[...S.slice(0,i),t]}else b=v;return b}},951230:(e,t,o)=>{o.d(t,{Y:()=>a});o(667294);var n=o(724405),i=o(12396),r=o(785893);function a(e){let{style:t,propertySchema:o}=e;const a=(0,n.Fg)();return(0,r.jsx)(i.ZP,{size:16,theme:a,icon:o.icon,style:t,type:o.type})}},365380:(e,t,o)=>{o.d(t,{H:()=>i});o(757658),o(667294);var n=o(785893);function i(e){if(!Array.isArray(e))return[e];const t=[];for(const o of e)if("string"==typeof o&&" "!==o[0]){const e=t.pop();t.push((0,n.jsxs)("div",{children:[e,o]}))}else t.push(o);return t}},756812:(e,t,o)=>{o.d(t,{$G:()=>j,Bo:()=>i,D6:()=>l,Ig:()=>x,Iu:()=>p,Mw:()=>h,Mz:()=>C,NZ:()=>S,Oq:()=>d,S0:()=>m,ST:()=>I,Sj:()=>f,VO:()=>V,Vf:()=>A,XJ:()=>w,aD:()=>b,c5:()=>k,hW:()=>r,ht:()=>c,nf:()=>M,oJ:()=>B,om:()=>g,r8:()=>F,rf:()=>y,s_:()=>P,vE:()=>v,vz:()=>T,wE:()=>u,x5:()=>Z,xf:()=>a,zU:()=>s});var n=o(180951);const i=(0,o(709291).defineMessages)({actionCheckboxPropertyChecked:{defaultMessage:"checked",id:"automations.action.checkboxProperty.checked"},actionCheckboxPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.checkboxProperty.single"},actionCheckboxPropertyUnchecked:{defaultMessage:"unchecked",id:"automations.action.checkboxProperty.unchecked"},actionDatePropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.dateProperty.clear"},actionDatePropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.dateProperty.single"},actionNumberPropertySet:{defaultMessage:"{propertyName} set to {propertyValues}",id:"automations.action.numberPropertySet.title"},actionPersonPropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.personProperty.clear"},actionPersonPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.personProperty.single"},actionPersonPropertySetMultiple:{defaultMessage:"Set {propertyName} to any of {propertyValues}",id:"automations.action.personProperty.multiple"},actionRelationPropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.relationProperty.clear"},actionRelationPropertySetMultiple:{defaultMessage:"Set {propertyName} to all of {propertyValues}",id:"automations.action.relationProperty.multiple"},actionRelationPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.relationProperty.single"},actionSelectPropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.selectProperty.clear"},actionSelectPropertySetMultiple:{defaultMessage:"Set {propertyName} to all of {propertyValues}",id:"automations.action.selectProperty.multiple"},actionSelectPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.selectProperty.single"},actionStatusPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.statusProperty.single"},actionTextPropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.textProperty.clear"},actionTextPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.textProperty.single"},actionDeletedProperty:{defaultMessage:"Edit a deleted property",id:"automations.action.deletedProperty"},triggerAnyPageAdded:{defaultMessage:"Page added",id:"automations.trigger.pageAdded.title"},triggerAnyPagePropertyEdit:{defaultMessage:"Any property edited",id:"automations.trigger.anyPagePropertyEdited.title"},triggerAnyPropertyEdit:{defaultMessage:"{propertyName} is edited",id:"automations.trigger.propertyChangesToAny.title"},triggerAnyPropertyClear:{defaultMessage:"{propertyName} is cleared",id:"automations.trigger.propertyCleared.title"},triggerButtonClicked:{defaultMessage:"<b>Button</b> is clicked",id:"automations.trigger.button.clicked"},triggerCheckboxPropertyChecked:{defaultMessage:"checked",id:"automations.trigger.checkboxProperty.checked"},triggerCheckboxPropertySet:{defaultMessage:"{propertyName} set to {propertyValues}",id:"automations.trigger.checkboxPropertySet.title"},triggerCheckboxPropertyUnchecked:{defaultMessage:"unchecked",id:"automations.trigger.checkboxProperty.unchecked"},triggerNumberPropertySet:{defaultMessage:"{propertyName} set to {propertyValues}",id:"automations.trigger.numberPropertySet.title"},triggerSelectPropertySet:{id:"automations.trigger.selectPropertySet.title",defaultMessage:"{propertyName} set to {propertyValues}"},triggerStatusPropertySet:{defaultMessage:"{propertyName} set to {propertyValues}",id:"automations.trigger.statusPropertySet.singleProperty"},triggerPersonPropertySetSingle:{defaultMessage:"{propertyName} set to {propertyValue}",id:"automations.trigger.personPropertySet.singleProperty"},triggerPersonPropertySetMultiple:{defaultMessage:"{propertyName} set to any of {propertyValues}",id:"automations.trigger.personPropertySet.multipleProperties"},triggerDeletedPropertyEdit:{defaultMessage:"Deleted property is edited",id:"automations.trigger.deletedPropertyEdited"},deletedPropertyOption:{defaultMessage:"Deleted option",id:"automations.values.deletedPropertyOption"},unknownValue:{defaultMessage:"Unknown value",id:"automations.values.unknownValue"},unknownPropertyTitle:{defaultMessage:"a property",id:"database.viewSettings.automationTab.unknownPropertyTitle"}});function r(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionCheckboxPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function a(e){const{propertyName:t}=e;return{...i.actionDatePropertyClear,values:{propertyName:t}}}function s(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionDatePropertySetSingle,values:{propertyName:t,propertyValue:o}}}function l(e){const{propertyName:t,propertyValues:o}=e;return{...i.actionNumberPropertySet,values:{propertyName:t,propertyValues:o}}}function c(e){const{propertyName:t}=e;return{...i.actionPersonPropertyClear,values:{propertyName:t}}}function u(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionPersonPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function d(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionPersonPropertySetMultiple,values:{propertyName:t,propertyValues:o}}}function p(e){const{propertyName:t}=e;return{...i.actionRelationPropertyClear,values:{propertyName:t}}}function m(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionRelationPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function g(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionRelationPropertySetMultiple,values:{propertyName:t,propertyValues:o}}}function h(e){const{propertyName:t}=e;return{...i.actionSelectPropertyClear,values:{propertyName:t}}}function y(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionSelectPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function f(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionSelectPropertySetMultiple,values:{propertyName:t,propertyValues:o}}}function x(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionStatusPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function S(e){const{propertyName:t}=e;return{...i.actionTextPropertyClear,values:{propertyName:t}}}function v(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionTextPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function b(e){return e.formatMessage(i.actionDeletedProperty)}function C(e){return e.formatMessage(i.triggerAnyPageAdded)}function k(e){return e.formatMessage(i.triggerAnyPagePropertyEdit)}function M(e){return e.formatMessage(i.triggerDeletedPropertyEdit)}function j(e,t){const{propertyName:o}=t;return e.formatMessage(i.triggerAnyPropertyEdit,{propertyName:o})}function T(e,t){return e.formatMessage(i.triggerCheckboxPropertySet,t)}function A(e,t){const{propertyName:o}=t;return e.formatMessage(i.triggerAnyPropertyClear,{propertyName:o})}function P(e){const{propertyName:t,propertyValues:o}=e;return{...i.triggerNumberPropertySet,values:{propertyName:t,propertyValues:o}}}function w(e,t){return e.formatMessage(i.triggerSelectPropertySet,t)}function V(e,t){return e.formatMessage(i.triggerStatusPropertySet,t)}function I(e){return e.formatMessage(i.deletedPropertyOption)}function F(e){const{propertyName:t,propertyValues:o}=e;return{...i.triggerPersonPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function Z(e){const{propertyName:t,propertyValues:o}=e;return{...i.triggerPersonPropertySetMultiple,values:{propertyName:t,propertyValues:o}}}function B(e){const{limit:t,optionValues:o,propertySchema:i}=e,r=i.options??[],a=r.length>0,s=o.map((e=>{const t=a?(0,n.i7)(r,e):void 0;return t?{type:"option",value:t}:{type:"deleted",value:e}}));let l=s;if(void 0!==t&&s.length>t){const e=s.length-t;l=[...s.slice(0,t),{type:"truncation",value:`+${e}`}]}return l}},891494:(e,t,o)=>{o.d(t,{X:()=>a});var n=o(886628),i=o(433929),r=o(168910);function a(e){const{automationStore:t,collectionStore:o}=e;return(0,n.VK)((()=>{if(!o||!t)return;const e=o.getSpaceShardedPointer();return new r.L({automationStore:t,parentPointer:e,type:"event",intl:i.default.getIntl(),parentRecordStore:o})}),[o,t])}},161927:(e,t,o)=>{o.d(t,{p:()=>l});var n=o(886628),i=o(940694),r=o(823290),a=o(849117),s=o(312455);function l(){const{automationContextStore:e}=(0,s.i)(),t=(0,n.VK)((()=>e?(0,a.uV)(e.context.automationStore,e.context.type):void 0),[e]);return(0,n.VK)((()=>{if(!t)return[];const{automation:e,automationActions:o}=t;let n=e.getTriggerType();"notification_event"===n&&(n="event");const a=r.Gl[n],s="default_bound"===a.max?r.xZ:a.max;if(o.length>=s)return[];return function(e){const t=e=>e?1:-1;return e.slice().sort(((e,o)=>t(o.hasSideEffects)-t(e.hasSideEffects)))}((0,i.P)("display").filter((e=>e.isAvailableForContext(t))))}),[t])}},753570:(e,t,o)=>{o.d(t,{i:()=>c});o(757658);var n=o(667294),i=o(102647),r=o(399036),a=o(210228),s=o(563474),l=o(312455);function c(){const{automationStore:e,collectionStore:t,maybePersistedTransactionActions:o}=(0,l.P)(),c=(0,s.D)(),d=(0,n.useMemo)((()=>({automation_id:e.id,collection_id:t.id})),[e.id,t.id]),p=(0,n.useCallback)((()=>{var t;const o=null===(t=e.getTrigger())||void 0===t?void 0:t.event.pagePropertiesEdited,n="some"===(null==o?void 0:o.type)&&o.some;return n||[]}),[e]),m=(0,n.useCallback)((t=>{o.createAndCommit({userAction:"automations.removePropertyTrigger",perform:o=>{a.applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagePropertiesEdited:0===t.length?{type:"none"}:{type:"some",some:t}}},transaction:o})}})}),[e,o]);return{addPropertyTrigger:(0,n.useCallback)((e=>{m([...p(),e]);const o=t.getSchema()[e.property];(0,i.nK)(c,{automation_trigger:{type:"property",condition:"some",property_types:null!=o&&o.type?[o.type]:[]},...d})}),[d,t,c,p,m]),updatePropertyTrigger:(0,n.useCallback)((e=>{const{anyOptionCheckState:o,propertyId:n,currentFilter:a,propertySchema:s}=e,l=p();m((()=>{switch(o){case"partial":return u(l,(e=>e.property===n),(e=>({...e,filter:a})),{property:n,filter:a});case!0:return u(l,(e=>e.property===n),(e=>({...e,filter:{operator:"changes_to_any"}})),{property:n,filter:{operator:"changes_to_any"}});case!1:return(0,r.Pr)(s)?u(l,(e=>e.property===n),(e=>({...e,filter:a})),{property:n,filter:a}):l.filter((e=>e.property!==n))}})());const g=t.getSchema()[n];(0,i.nK)(c,{automation_trigger:{type:"property",condition:"some",property_types:null!=g&&g.type?[g.type]:[]},...d})}),[d,t,c,p,m]),removePropertyTrigger:(0,n.useCallback)((e=>{m(p().filter((t=>t.property!==e)));const o=t.getSchema()[e];(0,i.Ey)(c,{automation_trigger:{type:"property",condition:"some",property_types:null!=o&&o.type?[o.type]:[]},...d})}),[d,t,c,p,m]),addPageAddedTrigger:(0,n.useCallback)((()=>{o.createAndCommit({userAction:"automations.addPageAddedTrigger",perform:t=>{a.applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagesAdded:!0}},transaction:t})}}),(0,i.nK)(c,{automation_trigger:{type:"page"},...d})}),[d,e,c,o]),removePageAddedTrigger:(0,n.useCallback)((()=>{o.createAndCommit({userAction:"automations.removePageAddedTrigger",perform:t=>{a.applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagesAdded:!1}},transaction:t})}}),(0,i.Ey)(c,{automation_trigger:{type:"page"},...d})}),[d,e,c,o]),addAnyPropertyEditedTrigger:(0,n.useCallback)((()=>{o.createAndCommit({userAction:"automations.addAnyPagePropertyEditedTrigger",perform:t=>{a.applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagePropertiesEdited:{type:"any"}}},transaction:t})}}),(0,i.nK)(c,{automation_trigger:{type:"property",condition:"any"},...d})}),[d,e,c,o]),removeAnyPropertyEditedTrigger:(0,n.useCallback)((()=>{o.createAndCommit({userAction:"automations.removeAnyPropertyEditedTrigger",perform:t=>{a.applyOperation({store:e,operation:{path:["trigger","event"],args:{pagePropertiesEdited:{type:"none"}},pointer:e.pointer,command:"update"},transaction:t})}}),(0,i.Ey)(c,{automation_trigger:{type:"property",condition:"any"},...d})}),[d,e,c,o])}}function u(e,t,o,n){let i=!1;const r=e.map((e=>t(e)?(i=!0,o(e)):e));return i||r.push(n),r}},154583:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(886628),i=o(959753),r=o(312455);function a(){const{automationContextStore:e}=(0,r.i)();return(0,n.VK)((()=>{const t=null==e?void 0:e.context.automationStore;return(null==t?void 0:t.getRecordModel)??i.om.constant(void 0)}),[null==e?void 0:e.context.automationStore])}},993416:(e,t,o)=>{o.d(t,{Kk:()=>d,MT:()=>p});o(667294);var n=o(886628),i=o(724405),r=o(709291),a=o(401898),s=o(137810),l=o(756812),c=o(785893);const u={number_equals:"",number_does_not_equal:"≠",number_greater_than:">",number_greater_than_or_equal_to:"≥",number_less_than:"<",number_less_than_or_equal_to:"≤"};function d(e){const{numberValue:t,operator:o,propertySchema:d,messageType:m}=e,g=(0,i.yK)((()=>({content:{alignItems:"center",display:"flex",flexWrap:"nowrap",whiteSpace:"pre"},propertyName:{...s.Z.textOverflowStyle,fontWeight:s.Z.fontWeight.semibold},propertyValue:{...s.Z.textOverflowStyle,paddingBlockStart:4}})),[]),h=(0,n.VK)((()=>function(e){const{numberValue:t,operator:o,propertySchema:n,styles:i,messageType:s}=e,d=(0,c.jsx)("span",{style:i.propertyName,children:n.name}),p=u[o],m=p?" ":"";let g;"action"===s?g=l.D6({propertyName:d,propertyValues:`${p}${m}${t}`}):"trigger"===s?g=l.s_({propertyName:d,propertyValues:`${p}${m}${t}`}):(0,a.t1)(s);return(0,c.jsx)(r.FormattedMessage,{...g})}({messageType:m,numberValue:t,operator:o,propertySchema:d,styles:g})),[m,t,o,d,g]);return{tooltipTitle:(0,n.VK)((()=>p({messageType:m,numberValue:t,operator:o,propertySchema:d})),[m,t,o,d]),title:h,styles:g}}function p(e){const{numberValue:t,operator:o,propertySchema:n,messageType:i}=e,s=n.name;let d;const p=u[o],m=p?" ":"";return"action"===i?d=l.D6({propertyName:s,propertyValues:`${p}${m}${t}`}):"trigger"===i?d=l.s_({propertyName:s,propertyValues:`${p}${m}${t}`}):(0,a.t1)(i),(0,c.jsx)(r.FormattedMessage,{...d})}},113732:(e,t,o)=>{o.d(t,{TY:()=>p,y3:()=>m});o(667294);var n=o(886628),i=o(724405),r=o(266897),a=o(709291),s=o(401898),l=o(137810),c=o(992864),u=o(756812),d=o(785893);function p(e){const{actorModels:t,propertySchema:o,messageType:r}=e,p=(0,a.useIntl)(),g=(0,i.yK)((()=>({content:{alignItems:"center",display:"flex",flexWrap:(t||[]).length>1?"wrap":"nowrap",whiteSpace:"pre"},propertyName:{...l.Z.textOverflowStyle,fontWeight:l.Z.fontWeight.semibold},propertyValue:{...l.Z.textOverflowStyle,paddingBlockStart:4},propertyValueList:{display:"flex",flexBasis:"100%",flexDirection:"column",listStyle:"none",margin:0,marginBlockStart:10,padding:0,rowGap:4}})),[t]),h=(0,n.VK)((()=>function(e){const{actors:t,propertySchema:o,styles:n,messageType:i}=e;if(!t)return null;const r=(0,d.jsx)("span",{style:n.propertyName,children:o.name}),l=function(e){const{actors:t,styles:o}=e;return 1===t.length?(0,d.jsx)("div",{style:o.propertyValue,children:(0,d.jsx)(c.ZP,{actor:t[0],showRemoveButton:!1,format:c.ZP.Format.Medium,isSingle:!1})}):(0,d.jsx)("ul",{style:o.propertyValueList,children:t.map(((e,t)=>(0,d.jsx)("li",{children:(0,d.jsx)("div",{style:o.propertyValue,children:(0,d.jsx)(c.ZP,{actor:e,showRemoveButton:!1,format:c.ZP.Format.Medium,isSingle:!1})},t)},t)))})}({actors:t,styles:n});let p;"action"===i?p=0===t.length?u.ht({propertyName:r}):1===t.length?u.wE({propertyName:r,propertyValue:l}):u.Oq({propertyName:r,propertyValue:l}):"trigger"===i?p=1===t.length?u.r8({propertyName:r,propertyValues:l}):u.x5({propertyName:r,propertyValues:l}):(0,s.t1)(i);return(0,d.jsx)(a.FormattedMessage,{...p})}({actors:t,propertySchema:o,styles:g,messageType:r})),[t,o,g,r]);return{tooltipTitle:(0,n.VK)((()=>m({actors:t,intl:p,propertySchema:o,messageType:r})),[t,p,o,r]),title:h,styles:g}}function m(e){const{actors:t,intl:o,propertySchema:n,messageType:i}=e;if(!t)return;const l=t.map((e=>(0,r.$4)(o,e))),c=n.name,p=o.formatList(l,{style:"long",type:"conjunction"});let m;return"action"===i?m=0===t.length?u.ht({propertyName:c}):1===t.length?u.wE({propertyName:c,propertyValue:p}):u.Oq({propertyName:c,propertyValue:p}):"trigger"===i?m=1===t.length?u.r8({propertyName:c,propertyValues:p}):u.x5({propertyName:c,propertyValues:p}):(0,s.t1)(i),(0,d.jsx)(a.FormattedMessage,{...m})}},373590:(e,t,o)=>{o.d(t,{Z:()=>c});o(667294);var n=o(800480),i=o(584169),r=o(225888),a=o(316354),s=o(694166),l=o(785893);const c=function(e){const{title:t,href:o,analyticsFrom:c}=e,u=(0,n.O7)();return(0,l.jsx)(a.Z,{href:o,onClick:()=>r.Fs(u,{from:c}),external:!0,children:(0,l.jsx)(s.Z,{icon:i.m,title:t,isGray:!0})})}},497372:(e,t,o)=>{o.d(t,{ZP:()=>F,j9:()=>w,nJ:()=>P});var n=o(667294),i=o(800480),r=o(886628),a=o(724405),s=o(80721),l=o(964275),c=o(612392),u=o(709291),d=o(137810),p=o(805149),m=o(164921),g=o(573063),h=o(436488),y=o(203386),f=o(478140),x=o(840721),S=o(566890),v=o(212534),b=o(460709),C=o(613273),k=o(925130),M=o(334017),j=o(658421),T=o(785893);const A=(0,u.defineMessages)({back:{defaultMessage:"Back",id:"collectionsSettingsMenu.back"}}),P=290,w=400;function V(e){let{children:t,title:o,settingsStackLength:n,handleClose:i,handleBackArrowClick:c,hideDesktopHeader:p}=e;const h=(0,r.VK)((()=>M.Z.state.isOpen),[]),y=(0,u.useIntl)(),f=(0,a.yK)((e=>({hiddenDesktopHeaderDiv:{height:6},nonHiddenDesktopHeaderDiv:h?{position:"relative"}:{display:"flex",alignItems:"center",padding:"14px 16px 6px 16px",height:42},arrowButon:h?{position:"absolute",right:14,top:-34}:{marginRight:8,marginLeft:-2,height:22},arrowIcon:{width:16,height:16},title:{flexGrow:1,fontWeight:d.Z.fontWeight.semibold,fontSize:14,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},closeButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:18,height:18,flexShrink:0},closeButtonHover:{background:e.buttonPressedBackground},closeIcon:{width:14,fill:e.mediumTextColor}})),[h]);return(0,T.jsxs)(T.Fragment,{children:[p&&(0,T.jsx)("div",{style:f.hiddenDesktopHeaderDiv}),!p&&(0,T.jsxs)("div",{style:f.nonHiddenDesktopHeaderDiv,children:[n>1&&(0,T.jsx)(g.Z,{icon:s.W,style:f.arrowButon,iconStyle:f.arrowIcon,onClick:c,ariaLabel:y.formatMessage(A.back)}),h?null:(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("span",{style:f.title,children:o}),(0,T.jsx)(m.Z,{onClick:i,style:f.closeButton,hoveredStyle:f.closeButtonHover,children:(0,l.D)(f.closeIcon)})]})]}),t]})}function I(e,t){let{children:o,footer:a,header:s,unconstrainedWidth:l,desktopWidth:u,title:d,collectionSettingsStore:m,fullHeight:A,hideDesktopHeader:w,menuScrollerStyle:I,handleBackArrowClick:F,handleClose:Z}=e;const B=(0,i.Fy)(),{currentTab:K,settingsStackLength:_,hideHeader:R}=(0,r.VK)((()=>{const e=m.state;return{currentTab:(0,j.n)(m),settingsStackLength:e.stack.length,hideHeader:e.hideSettingsHeader}}),[m]),N=(0,S.DK)(),D=(0,n.useCallback)((()=>{F?F():p.z$({collectionSettingsStore:m})}),[F,m]),L=(0,n.useCallback)((e=>{Z?Z(e):(0,v.ZP)({event:e,context:v.Af.CollectionSettingsClick,callback:()=>{p.E3({collectionSettingsStore:m})}})}),[Z,m]),O=(0,n.useCallback)((e=>{(0,C.jM)(e.target)||(0,C.al)(e.target)||M.Z.state.isOpen||"form_editor"===(null==N?void 0:N.getViewType())||L(e)}),[N,L]),{MenuArrowKeysProvider:W,context:E}=(0,k.ZP)();if(!K)return null;let H;if(B.isMobile)H={menuType:b.og.Modal,title:d,left:_>1&&(0,T.jsx)(g.Z,{icon:c.S,onClick:D}),right:(0,T.jsx)(x.DoneMenuText,{}),onClickRight:L,scrollerStyle:{...I},innerRef:t};else{const e=l||u?void 0:P;H={menuType:b.og.Popup,minWidth:P,width:u,maxHeight:A?"100%":"80vh",...e&&{maxWidth:e},onClickOutside:O,scrollerStyle:{flexGrow:0,...I},header:!R&&(0,T.jsx)(V,{settingsStackLength:_,handleClose:L,handleBackArrowClick:D,hideDesktopHeader:w,title:d,children:s}),paddingTop:R?6:0,paddingBottom:12,footer:a,innerRef:t}}const U=(0,T.jsxs)(T.Fragment,{children:[B.isMobile&&s,o,B.isMobile&&a]});return A?(0,T.jsx)(W,{value:E,children:(0,T.jsx)(y.Z,{debugName:"CollectionSettingsMenu",capture:!0,onUp:E.onKeyDown,onDown:E.onKeyDown,children:(0,T.jsx)(f.Z,{...H,children:U})})}):(0,T.jsx)(h.Z,{capture:!0,allowMobileAutoScroll:!0,allowEsc:!0,allowMenuList:!0,render:e=>(0,T.jsx)(W,{value:E,children:(0,T.jsx)(y.Z,{debugName:"CollectionSettingsMenu",capture:!0,onUp:E.onKeyDown,onDown:E.onKeyDown,children:(0,T.jsx)(f.Z,{...H,...e,children:U})})})})}const F=(0,n.forwardRef)(I)},332628:(e,t,o)=>{o.d(t,{S7:()=>V,ZP:()=>B,sW:()=>_});o(757658);var n=o(667294),i=o(800480),r=o(886628),a=o(724405),s=o(749085),l=o(356666),c=o(844495),u=o(606287),d=o(709291),p=o(926249),m=o(108406),g=o(73657),h=o(552275),y=o(268894),f=o(632163),x=o(511470),S=o(672495),v=o(526388),b=o(296994),C=o(823586),k=o(433929),M=o(675822),j=o(80444),T=o(229798),A=o(206258),P=o(131003),w=o(785893);let V=function(e){return e[e.Source=0]="Source",e[e.Relation=1]="Relation",e[e.Automation=2]="Automation",e}({});const I=(0,d.defineMessages)({linkedInputPlaceholder:{defaultMessage:"Link to a database…",id:"database.viewSettings.searchCollections.linkedInputPlaceholder"},linkedOrSourceInputPlaceholder:{defaultMessage:"Link or create a database…",id:"database.viewSettings.searchCollections.linkedOrSourceInputPlaceholder"},automationInputPlaceholder:{id:"automations.databasePicker.automationInputPlaceholder",defaultMessage:"Select a database…"}}),F=s.default.createClass("",{name:"InputStore"});function Z(e){let{collectionContextStore:t,selectedCollectionStore:o,context:s,parentStore:c,onAccept:p,requireEditPermissions:v,searchSessionId:b,inputStore:j}=e;const Z=(0,i.O7)(),B=(0,r.qz)(j,F),R=(0,r.qz)(void 0,T.Z),[N,D]=(0,n.useState)(5),L=(0,r.VK)((()=>B.state),[B]),O=(0,r.VK)((()=>null==t?void 0:t.getCollectionViewBlockSourceState()),[t]),W=(0,a.yK)((e=>({showMoreButton:{color:e.mediumTextColor,fill:e.mediumIconColor}})),[]),E="linked"===O||s===V.Relation?I.linkedInputPlaceholder:s===V.Source?I.linkedOrSourceInputPlaceholder:I.automationInputPlaceholder,H=(0,n.useCallback)((e=>{const{collectionStore:o,totalResults:n,clickedIndex:i}=e;t&&m.wd({environment:Z,collectionContextStore:t,action:"select_existing_collection"}),p(o),m.tW({environment:Z,eventName:"select_search_item",totalResults:n,clickedIndex:i,sessionId:b,source:s,queryLength:L.length})}),[t,s,Z,L,p,b]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(S.Z,{children:(0,w.jsx)(y.ZP,{focusInitial:!Z.device.isMobile||void 0,value:L,onChange:e=>{B.setState(e.target.value),D(e.target.value?20:5),R.setState({focus:{section:0,indexLocal:0,indexGlobal:0}})},placeholder:k.default.formatMessage(E),showClearButton:!0})}),(0,w.jsx)(C.Z,{request:{query:L,limit:N},performRequest:e=>_(e,c,Z,b,t,v),debounce:M.vp,render:(e,n,i)=>{if(!n)return(0,w.jsx)("div",{style:{paddingTop:Z.device.isMobile?17:7,paddingBottom:5},children:(0,w.jsx)(P.a,{})});const{results:r,showMore:a}=n,p=r.map((e=>{const n=A.NW.createChildStore(c,{table:u.vF,id:e});return{key:e,render:i=>{var r;return(0,w.jsx)(x.Z,{...i,checkState:o&&o.id===e,store:n,right:s===V.Relation&&(null==t||null===(r=t.collectionStore())||void 0===r?void 0:r.id)===e&&(0,w.jsx)(K,{})})},action:e=>{const{index:t}=e;H({collectionStore:n,totalResults:r.length,clickedIndex:t})}}}));if(a>0){const e={key:"showMore",render:e=>(0,w.jsx)(h.Z,{...e,buttonStyle:W.showMoreButton,icon:(0,l.o)({width:16,height:16}),title:(0,w.jsx)(d.FormattedMessage,{defaultMessage:"Show {showMore} more",id:"database.viewSettings.searchCollections.showMore.title",values:{showMore:Math.min(a,20)}})}),action:()=>{D(N+20)}};p.push(e)}return(0,w.jsxs)(w.Fragment,{children:[r.length>0&&(0,w.jsx)(f.Z,{type:f.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,w.jsx)(S.Z,{...e}),items:p}],store:R}),0===r.length&&(0,w.jsx)(g.Z,{caption:(0,w.jsx)(d.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.searchCollections.noResultsTitle"})})]})}})]})}const B=n.memo(Z,p.Z);function K(){return(0,w.jsx)(v.Z,{renderTooltip:()=>(0,w.jsx)(d.FormattedMessage,{defaultMessage:"This database",id:"database.viewSettigs.searchCollections.thisDatabase.tooltip"}),render:e=>(0,w.jsx)("div",{...e,children:(0,c.D)({width:14,height:14})})})}async function _(e,t,o,n,i,r){const{query:a,limit:s}=e,{currentSpaceStore:l}=j.default.state,c=null==i?void 0:i.collectionViewBlockStore(),u=await b.FF.searchActions.load(),d=await u.searchCollectionsWithRecents({environment:o,collectionViewBlockStore:c,parentStore:t,spaceStore:l,query:a,limit:s,requireEditPermissions:r,searchSessionId:n});return{results:d.results,showMore:Math.max(0,d.total-d.results.length)}}},131003:(e,t,o)=>{o.d(t,{a:()=>s});o(667294);var n=o(724405),i=o(653965),r=o(636596),a=o(785893);function s(){const e=(0,n.yK)((e=>({container:{height:253},shimmerContainer:{height:45,margin:"0 14px 0px 18px",display:"flex",alignItems:"center"},circleContainer:{display:"flex",alignItems:"center",justifyContent:"center",marginRight:5,marginTop:5,alignSelf:"flex-start"},circle:{width:16,height:16,borderRadius:12,backgroundColor:e.lightDividerColor},sourceContainer:{flex:"1 1 auto",marginTop:6,marginLeft:8,alignSelf:"flex-start"},title:{height:9,width:"40%",borderRadius:8,backgroundColor:e.lightDividerColor},location:{marginTop:9,height:9,width:"60%",borderRadius:8,backgroundColor:e.lightDividerColor},showMoreContainer:{margin:"-2px 14px 0px 18px",display:"flex",alignItems:"center"},showMore:{marginTop:3,height:9,width:"40%",borderRadius:8,backgroundColor:e.lightDividerColor}})),[]),t=i.DZ(5,(t=>(0,a.jsxs)("div",{style:e.shimmerContainer,children:[(0,a.jsx)("div",{style:e.circleContainer,children:(0,a.jsx)(r.Z,{style:e.circle})}),(0,a.jsxs)("div",{style:e.sourceContainer,children:[(0,a.jsx)(r.Z,{style:e.title}),(0,a.jsx)(r.Z,{style:e.location})]})]}))),o=(0,a.jsxs)("div",{style:e.showMoreContainer,children:[(0,a.jsx)("div",{style:e.circleContainer,children:(0,a.jsx)(r.Z,{style:e.circle})}),(0,a.jsx)("div",{style:e.sourceContainer,children:(0,a.jsx)(r.Z,{style:e.showMore})})]});return(0,a.jsxs)("div",{style:e.container,children:[t,o]})}},73657:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(667294),i=o(828992),r=o(785893);function a(e,t){return(0,r.jsx)(i.Z,{...e,ref:t,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}const s=(0,n.forwardRef)(a)},289845:(e,t,o)=>{o.d(t,{Z:()=>x});var n=o(667294),i=o(313991),r=o(720294),a=o(886628),s=o(724405),l=o(407057),c=o(253877),u=o(842875),d=o(136700),p=o(709291),m=o(531701),g=o(619584),h=o(541056),y=o(526388),f=o(785893);const x=function(e){const t=(0,p.useIntl)(),o=(0,s.Fg)(),x=(0,r.k)(),b=(0,n.useRef)(),C=(0,n.useCallback)((()=>{const t=e.value;if(!t)return;const o=c.KR(t,(0,u.r)());if(!o)return;const n=o.valueOf(),i=n-Date.now();i<0||i>g.A0||b.current&&b.current.timestamp===n||(b.current&&clearTimeout(b.current.timer),b.current={timestamp:n,timer:setTimeout(x,i)})}),[x,e.value]),k=(0,n.useCallback)((()=>{b.current&&(clearTimeout(b.current.timer),b.current=void 0)}),[]);(0,n.useEffect)((()=>{C()}),[C]),(0,n.useEffect)((()=>()=>{k()}),[k]);const{value:M,withComma:j}=e,T=(0,a.VK)((()=>M?(0,l.ZV)({value:M,date_format:e.dateFormat,time_format:e.timeFormat,userTimeZone:(0,u.r)(),allowRelativeDates:!0,intl:t,shortenDateAndRange:e.shortenDateAndRange,displayInUserTimezone:e.displayInUserTimezone,getToday:h.HL}):void 0),[t,e.dateFormat,e.displayInUserTimezone,e.shortenDateAndRange,e.timeFormat,M]);if(!M)return null;const A=c.NK(M,(0,u.r)(),i.SP);let P;if(M.reminder){const e=c.Nm(M,(0,u.r)());P=e?{color:o.errorText}:{color:m.ZP.blue}}const w=(0,f.jsxs)(f.Fragment,{children:[T,M.reminder&&(0,d.m)({display:"inline-block",width:"1em",marginLeft:6,marginRight:2,paddingBottom:4,verticalAlign:"middle"}),j?", ":null]});return e.disableTooltip?(0,f.jsx)("div",{style:{...e.style,...P},children:w}):(0,f.jsx)(y.Z,{renderTooltip:()=>(0,f.jsxs)(f.Fragment,{children:[e.tooltipHeader,(0,f.jsxs)("div",{style:v(o,e.tooltipHeader),children:[S(A.start),A.end?` → ${S(A.end)}`:""]})]}),render:t=>(0,f.jsx)("div",{style:{...e.style,...P},...t,children:w}),placement:e.tooltipPlacement})};function S(e){return(0,l.ZW)(e,"medium")}function v(e,t){return t?{color:e.mediumInvertedTextColor}:{}}},793289:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(667294),i=o(313991),r=o(296994),a=o(785893);const s=function(e){let{firstDayOfWeek:t,value:o,selectValue:s=!0,onChange:l,disabledDays:c}=e;const u=(0,n.useMemo)((()=>new Date(o)),[o]),[d,p]=(0,n.useState)(u),m=(0,n.useRef)(o);(0,n.useLayoutEffect)((()=>{m.current!==o&&(p(new Date(o)),m.current=o)}),[o]);const g=(0,n.useCallback)(((e,t,o)=>{l(e.getTime())}),[l]);return(0,a.jsx)(r.yG,{locale:i.SP,className:"notion-calendar-picker",numberOfMonths:1,weekStartsOn:t,modifiers:s?{value:u}:{},showOutsideDays:!0,fixedWeeks:!0,onDayClick:g,onMonthSelected:p,disabled:c,month:d})}},278948:(e,t,o)=>{o.d(t,{Z:()=>a});o(667294);var n=o(568785),i=o(828992),r=o(785893);const a=function(){return(0,r.jsx)(i.Z,{title:(0,r.jsx)(n.Z,{})})}},147082:(e,t,o)=>{o.d(t,{UR:()=>b,ZP:()=>k,go:()=>v});var n=o(667294),i=o(883355),r=o(800480),a=o(724405),s=o(853465),l=o(653965),c=o(460709),u=o(98742),d=o(434859),p=o(964113),m=o(164921),g=o(437601),h=o(374194),y=o(203386),f=o(953336),x=o(164369),S=o(785893);const v="20px";let b=function(e){return e[e.Select=0]="Select",e[e.Person=1]="Person",e[e.Relation=2]="Relation",e[e.FilterValue=3]="FilterValue",e[e.Share=4]="Share",e[e.Group=5]="Group",e}({});class C extends i.Z{constructor(){super(...arguments),this.inputRef=n.createRef(),this.storeTypes={store:p.Z},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleFocused=()=>{this.stores.store.setState({focused:!0})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBlurred=()=>{this.stores.store.setState({focused:!1})},this.handleContainerClick=()=>{var e,t,o;this.props.disabled||(null===(e=this.inputRef.current)||void 0===e||e.focusInput(),null===(t=(o=this.props).onClick)||void 0===t||t.call(o))}}UNSAFE_willMount(){(this.props.focus||this.props.focusInitial)&&this.stores.store.setState({focused:!0})}UNSAFE_willUpdate(){void 0!==this.props.focus&&this.stores.store.setState({focused:this.props.focus})}renderComponent(){const{disabled:e}=this.props;return(0,S.jsx)(y.Z,{debugName:"TokenInputMenuItem",capture:!e,onLeft:l.yR,onRight:l.yR,onSelectAll:l.yR,onRedo:l.yR,onUndo:l.yR,onToggleBold:l.yR,onToggleItalics:l.yR,onToggleCode:l.yR,onCut:l.yR,onCopy:l.yR,onPaste:l.yR,onKeypress:l.yR,children:(0,S.jsx)(y.Z,{debugName:"TokenInputMenuItem",capture:!e&&this.props.value.length>0,onDelete:l.yR,onBackspace:l.yR,children:(0,S.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"stretch",flex:1,minWidth:0,gap:this.props.message?4:void 0},children:[this.renderTokenInput(),this.props.message&&(0,S.jsx)(x.Z,{isSmall:!0,children:this.props.message})]})})})}renderTokenInput(){const{right:e,showClearButton:t}=this.props;return e||t?(0,S.jsxs)(f.Z,{type:d.Z.All,style:{...w(this.environment,this.theme,this.props.format,this.props.focus,this.props.dontShowBorderBottom,this.props.disabled,this.props.showBorder,this.context.menu),flexWrap:"nowrap",...this.props.style},onClick:this.handleContainerClick,children:[(0,S.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",flexGrow:1,minWidth:0,...this.props.inputAndTokenWrapRightStyle},children:[this.props.tokens,!this.props.hideInput&&this.renderInput()]}),(0,S.jsx)("div",{style:{flexShrink:0},children:(0,S.jsx)(P,{showClearButton:this.props.showClearButton,right:this.props.right,onClearButtonClick:this.props.onClearButtonClick,tokens:this.props.tokens,value:this.props.value})})]}):this.environment.device.isMobile?(0,S.jsxs)("div",{style:{...w(this.environment,this.theme,this.props.format,this.props.focus,this.props.dontShowBorderBottom,this.props.disabled,this.props.showBorder,this.context.menu),flexWrap:"nowrap",...this.props.style},onClick:this.handleContainerClick,children:[(0,S.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",flexGrow:1,minWidth:0,overflow:"hidden",marginRight:M(this.props.format)?6:0},children:[this.props.tokens,!this.props.hideInput&&this.renderInput()]}),(0,S.jsx)(g.Z,{show:this.stores.store.state.focused})]}):(0,S.jsxs)(f.Z,{type:d.Z.All,style:{...w(this.environment,this.theme,this.props.format,this.props.focus,this.props.dontShowBorderBottom,this.props.disabled,this.props.showBorder,this.context.menu),...this.props.style},onClick:this.handleContainerClick,children:[this.props.tokens,!this.props.hideInput&&this.renderInput()]})}renderInput(){const e=0===this.props.tokens.length;return(0,S.jsx)(h.Z,{disabled:this.props.disabled,format:h.B.Transparent,...(0,u.Z)({onKeyDown:e=>function(e,t,o,n){"Backspace"===e.key&&0===t.length&&o();n&&n(e)}(e,this.props.value,this.props.onRemoveLastToken,this.props.onKeyDown)},{onChange:this.props.onChange}),value:this.props.value,focus:this.props.focus,focusInitial:this.props.focusInitial,focusAfterAnimation:this.props.focusAfterAnimation,style:(t=this.props.format,o=this.environment,n=this.theme,i=this.props.inputFullWidth,r=this.props.inputDivStyle,{flexGrow:1,flexShrink:1,flexBasis:i?"100%":60,minWidth:60,width:"auto",lineHeight:v,...o.device.isMobile?{margin:"0 8px 8px 0"}:A(n)[t].inputDivDesktopStyle,...r}),inputStyle:this.props.inputStyle||{height:this.environment.device.isMobile?24:M(this.props.format)?20:18},size:1,ref:this.inputRef,type:this.props.type,placeholder:e?this.props.placeholder:"",onSubmit:e=>function(e,t,o,n){0===t.length&&o&&o();n&&n(e)}(e,this.props.value,this.props.onEmptySubmit,this.props.onSubmit),onFocus:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleFocused,onBlur:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBlurred,textarea:this.props.textarea,autoComplete:this.props.autoComplete});var t,o,n,i,r}}C.displayName="TokenInputMenuItem",C.contextTypes={...c.mw,...i.w};const k=C;function M(e){return e===b.Group}function j(e,t){return{display:"flex",flexWrap:"wrap",alignItems:"flex-start",background:t?"none":e.tokenInputMenuItemBackground,cursor:"text",overflow:"hidden"}}function T(e){return{display:"flex",flexWrap:"wrap",alignItems:"flex-start",flexShrink:0,minHeight:44,borderBottom:`1px solid ${e.regularDividerColor}`,fontSize:16,background:e.popoverBackground}}function A(e){const t={desktopWrapStyle:{padding:"8px 9px 1px",width:"100%",minHeight:34,fontSize:14},inputDivDesktopStyle:{margin:"0 6px 6px 0",borderTopLeftRadius:4,borderTopRightRadius:4},inputDivDesktopFocusStyle:{}};return{[b.Select]:t,[b.Person]:t,[b.Relation]:t,[b.Group]:t,[b.FilterValue]:{desktopWrapStyle:{padding:"6px 6px 1px",boxShadow:e.inputBoxShadow,background:e.inputBackground,margin:"6px 8px 2px 8px",minHeight:30,fontSize:12,borderRadius:4},inputDivDesktopStyle:{margin:"0 6px 4px 0"},inputDivDesktopFocusStyle:{boxShadow:"rgba(35, 131, 226, 0.57) 0px 0px 0px 1px inset, rgba(35, 131, 226, 0.35) 0px 0px 0px 2px"}},[b.Share]:{desktopWrapStyle:{padding:"8px 9px 1px",width:"100%",minHeight:34,fontSize:14},inputDivDesktopStyle:{margin:"0 0 0 2px",borderTopLeftRadius:4,borderTopRightRadius:4},inputDivDesktopFocusStyle:{}}}}function P(e){let{showClearButton:t,right:o,onClearButtonClick:n,tokens:i,value:l}=e;const c=(0,a.Fg)(),u=(0,r.O7)(),{isMobile:d}=u.device;return o?(0,S.jsx)(S.Fragment,{children:o}):t&&(i.length>0||l.length>0)?(0,S.jsx)(m.Z,{onClick:n,style:{flexShrink:0,flexGrow:0,borderRadius:d?24:20,marginTop:2},children:(0,s.X)({width:d?16:14,height:d?16:14,fill:c.lightIconColor})}):null}function w(e,t,o,n,i,r,a,s){const{WindowSizeStore:l}=e;return{...e.device.isMobile?{...T(t),paddingTop:14,paddingBottom:8,paddingLeft:(null==s?void 0:s.menuType)!==c.og.Popup?l.getSafePaddingLeftCSS(16):16,paddingRight:(null==s?void 0:s.menuType)!==c.og.Popup?l.getSafePaddingRightCSS(16):16,...i&&{borderBottom:"none"}}:{...j(t,r),...A(t)[o].desktopWrapStyle},...a&&{boxShadow:"rgba(15, 15, 15, 0.1) 0px 0px 0px 1px inset"},...a&&n&&{boxShadow:"rgba(35, 131, 226, 0.57) 0px 0px 0px 1px inset, rgba(35, 131, 226, 0.35) 0px 0px 0px 2px"},...!e.device.isMobile&&n&&A(t)[o].inputDivDesktopFocusStyle}}},672865:(e,t,o)=>{o.d(t,{D:()=>x});var n=o(667294),i=o(800480),r=o(724405),a=o(820852),s=o(137231),l=o(210228),c=o(843250),u=o(768657),d=o(249394),p=o(434859),m=o(924666),g=o(328385),h=o(953336),y=o(965187),f=o(785893);function x(e){const{value:t,disabled:o,onChange:x,multiline:S,maximumInputLines:v,placeholder:b,disableFormattingAndMentions:C,disableMobileActionBar:k,disableEmojiCommands:M,disableTemplateVariableMentions:j,code:T}=e,A=(0,i.O7)(),P=(0,r.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:4,padding:S?"6px 10px":"4px 8px",overflow:S&&v?"scroll":"hidden",..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},text:S?v?{minHeight:60,maxHeight:20*v}:{minHeight:60}:{whiteSpace:"pre"},placeholder:S?{minHeight:60}:{}})),[S,v,60,20]),w=(0,n.useCallback)((e=>{x({type:"simple",value:e})}),[x]),{store:V}=(0,u.Cl)({initialValue:null==t?void 0:t.value,onChange:w}),I=(0,n.useMemo)((()=>S?()=>{const e=m.default.state;"editing"===e.mode&&l.createAndCommit({userAction:"SimpleFormulaValueTextInput.handleEnter",environment:A,perform:t=>{s.hJ({environment:A,editorMode:"default",string:"\n",multiSelection:e.multiSelection,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})}})}:void 0),[A,S]);return T?(0,f.jsx)("div",{style:P.wrap,className:c.Wh_,children:(0,f.jsx)(g.Z,{disabled:o,store:V,language:a.PrismLanguages.jsx,blockStore:void 0,codeWrap:!1,isQuickFind:!1,parentSpaceId:"",style:{padding:0}})}):(0,f.jsx)(h.Z,{style:P.wrap,className:c.Wh_,type:p.Z.Y,children:(0,f.jsx)(y.Z,{placeholder:b,disabled:o,store:V,style:P.text,placeholderStyle:P.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:M,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:I,disableMobileActionBar:k,inPageFind:d.B3.none,...C?{disableMentions:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableFilters:!0}:{disabledMentionTypes:{templateVariable:j}}})})}},761586:(e,t,o)=>{o.d(t,{Z:()=>W});var n=o(667294),i=o(800480),r=o(886628),a=o(724405),s=o(576218),l=o(137810),c=o(140190),u=o(61766),d=o(231945),p=o(953437),m=o(672865),g=o(940470),h=o(296994),y=o(460709),f=o(277907),x=o(478140),S=o(840721),v=o(887986),b=o(785893);const C=(0,f.o3)(h.FF.formulas,((e,t)=>(0,b.jsx)(k,{...t,formulas:e})));function k(e){const{value:t,onChange:o,onClose:a,disabled:s,contextStore:l,formulas:c}=e,u=(0,i.Fy)(),d=(0,n.useCallback)((()=>{o({type:"simple",value:null==t?void 0:t.value}),a()}),[o,a,null==t?void 0:t.value]),p=(0,n.useCallback)((e=>{void 0!==e&&e[0][0].length?o({type:"formula",value:e}):o(void 0),a()}),[o,a]),m=(0,r.VK)((()=>l.context.parentRecordStore.getSpaceId()),[l.context.parentRecordStore]),h=(0,r.Kw)(l.compilationResultStore),f=(0,n.useMemo)((()=>c.createFormulaDataRequestHandler(l.context.parentRecordStore.getRecordModel,l.context.parentRecordStore.loadRecordModel)),[l.context.parentRecordStore.getRecordModel,l.context.parentRecordStore.loadRecordModel,c]),C=(0,r.VK)((()=>{if(g.x.isFail(h))return;return{valueTypes:h.value.valueTypes,handleDataRequest:f}}),[h,f],{useDeepEqual:!0});let k;return k=u.isMobile?{menuType:y.og.Modal,right:(0,b.jsx)(S.DoneMenuText,{}),onClickRight:parent.close}:{menuType:y.og.Popup,maxHeight:"50vh",width:600,height:320,disableHeaderBorder:!0},m&&C?(0,b.jsx)(x.Z,{...k,children:(0,b.jsx)(v.Z,{formulas:c,initialCode:null==t?void 0:t.value,typecheckContext:C,handleClose:p,handleBack:d,parentSpaceId:m,disabled:s,focus:!0,evaluationErrors:[],getRecordModel:l.context.parentRecordStore.getRecordModel})}):null}var M=o(76233),j=o(768657),T=o(249394),A=o(965187);function P(e){const{value:t,disabled:o,buttonPopupStore:i,onChange:r}=e,s=(0,a.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:4,padding:4}})),[]),l=(0,n.useCallback)((e=>{"="===(0,M.QaF)(e)&&(0,j.NY)()?(r({type:"formula",value:void 0}),i.setState({open:!0})):r({type:"simple",value:e})}),[r,i]),{store:c}=(0,j.Cl)({initialValue:null==t?void 0:t.value,onChange:l});return(0,b.jsx)("div",{style:s.wrap,children:(0,b.jsx)(A.Z,{disabled:o,store:c,pasteBehavior:"inline",disableSlashCommands:!0,disableEmojiCommands:!0,disableMentions:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableEquationInteraction:!0,inPageFind:T.B3.none})})}var w=o(908570),V=o(118466),I=o(313991),F=o(932426),Z=o(709291),B=o(401898),K=o(360682),_=o(214976),R=o(475311),N=o(230387);function D(e){const{value:t,type:o,currentSimpleFormulaValueTokens:n,contextStore:i,context:s,placeholder:l}=e,{collectionStore:c,property:u}=s,d=(0,a.yK)((()=>({tokenWrap:{display:"flex",alignItems:"center",flexGrow:1,overflow:"hidden",marginTop:6}})),[]),p=(0,R.M)(c,u),m=(0,r.VK)((()=>(0,j.NY)()),[]);if("formula"===(null==t?void 0:t.type)&&t.value&&m)return(0,b.jsx)(O,{...e});if("text"===o.type||"number"===o.type)return null;if("date"===o.type||"select"===o.type||"checkbox"===o.type){const e=n[0];return void 0===e?(0,b.jsx)(L,{placeholder:l}):(0,b.jsx)("div",{style:d.tokenWrap,children:(0,b.jsx)(w.K,{token:e,contextStore:i,disabled:!0,currentSimpleFormulaValueTokens:n,context:s})})}return"person_array"===o.type||"block_array"===o.type||"select_array"===o.type?0===n.length?(0,b.jsx)(L,{placeholder:l}):(0,b.jsx)("div",{style:d.tokenWrap,children:p(n,"first").map(((e,t)=>(0,b.jsx)(w.K,{token:e,contextStore:i,disabled:!0,currentSimpleFormulaValueTokens:n,context:s},t)))}):void(0,B.t1)(o)}function L(e){const{placeholder:t}=e,o=(0,a.yK)((e=>({placeholderText:{color:e.lightTextColor}})),[]);return(0,b.jsx)("div",{style:o.placeholderText,children:t?(0,b.jsx)(Z.FormattedMessage,{defaultMessage:"{placeholder}",values:{placeholder:t},id:"formulas.SimpleFormulaValuePicker.people.customPlaceholder"}):(0,b.jsx)(Z.FormattedMessage,{...N.s.personSelect})})}function O(e){const{value:t,contextStore:o}=e,s=(0,i.O7)(),c=(0,a.Fg)(),u=(0,a.yK)((e=>({wrap:{display:"flex",alignItems:"center",pointerEvents:"none",fontFamily:l.Z.getCompositeFontFamily(I.SP).githubMono,fontSize:12,flexGrow:1,...l.Z.textOverflowStyle},icon:{width:14,fill:e.mediumIconColor,marginRight:6}})),[]),d=(0,K.kw)(),p=(0,r.VK)((()=>s.KatexStore.getKatex()),[s]),m=(0,r.VK)((()=>o.context.parentRecordStore.getSpaceId()),[o.context.parentRecordStore]),h=(0,r.Kw)(o.compilationResultStore),y=g.x.isSuccess(h)?h.value.valueTypes:void 0,f=(0,n.useMemo)((()=>V.Z.withListenerIgnored((()=>(0,_.IY)({environment:s,textValue:null!=t&&t.value&&m?{value:t.value,spaceId:m}:void 0,parentStore:o.context.parentRecordStore,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disabled:!0,theme:c,emojiType:d,katex:p,parentBlockId:void 0,renderedPageBlockId:void 0,formulaValueTypes:y||[]})))),[t,m,s,o.context.parentRecordStore,d,p,c,y]);return(0,b.jsxs)("div",{style:u.wrap,children:[(0,F.D)(u.icon),f]})}function W(e){const{type:t,value:o,disabled:n,errorMessage:g}=e,h=(0,i.Fy)(),y=!o||"simple"===o.type,f=(0,r.VK)((()=>(0,s.A6)(null==o?void 0:o.value)),[o]),x=(0,a.yK)((e=>({button:{boxShadow:e.inputBoxShadow,flexGrow:1,flexShrink:1,fontWeight:l.Z.fontWeight.regular}})),[]),S=(0,r.qz)(void 0,u.Z);return"number"===t.type&&y?(0,b.jsx)(P,{...e,buttonPopupStore:S}):"text"===t.type?(0,b.jsx)(m.D,{...e}):(0,b.jsx)(d.ZP,{popupType:h.isMobile?p.kQ.SlideUp:p.kQ.Popup,alignmentToOrigin:d.vR.End,placementToOrigin:d.pO.Bottom,originGap:0,buttonPopupStore:S,disabled:n,renderOrigin:t=>(0,b.jsx)(c.S,{...t,disabled:n,isError:Boolean(g),hasActionRequired:!Boolean(f.length>0),tooltipMessage:g,style:x.button,children:(0,b.jsx)(D,{...e,currentSimpleFormulaValueTokens:f})}),render:t=>y?(0,b.jsx)(w.a,{...e,onClose:t.close,currentSimpleFormulaValueTokens:f,formulaValueContext:e.context}):(0,b.jsx)(C,{...e,onClose:t.close})})}},581538:(e,t,o)=>{o.d(t,{Z:()=>c});var n=o(667294),i=o(932426),r=o(709291),a=o(230387),s=o(407835),l=o(785893);function c(e){const{value:t,onChange:o}=e,c=(0,n.useCallback)((()=>{o({type:"formula",value:null==t?void 0:t.value})}),[t,o]);return(0,l.jsx)(s.Z,{icon:i.D,title:(0,l.jsx)(r.FormattedMessage,{...a.s.customFormula}),onClick:c})}},407835:(e,t,o)=>{o.d(t,{Z:()=>s});o(667294);var n=o(724405),i=o(605257),r=o(552275),a=o(785893);function s(e){const t=(0,n.yK)((e=>({icon:{width:14,fill:e.mediumIconColor},chevronRight:{width:12,fill:e.mediumIconColor}})),[]);return(0,a.jsx)(r.Z,{icon:e.icon(t.icon),title:e.title,focused:!1,right:(0,i.o)(t.chevronRight),onClick:e.onClick})}},908570:(e,t,o)=>{o.d(t,{a:()=>we,K:()=>k});var n=o(667294),i=o(800480),r=o(886628),a=o(399036),s=o(180951),l=o(984619),c=o(335102),u=o(576218),d=o(76233),p=o(940470),m=o(401898),g=o(337867),h=o(319616),y=o(260458),f=o(289845),x=o(125845),S=o(122084),v=o(721396),b=o(475311),C=o(785893);function k(e){const{token:t,contextStore:o,disabled:n,setCurrentTokens:k,currentSimpleFormulaValueTokens:M,context:j}=e,T=(0,i.Fy)(),A=(0,r.Kw)(o.compilationResultStore),P=(0,r.VK)((()=>(0,b._)(j)),[j]),w=(0,r.VK)((()=>j.collectionStore.getSchema()[j.property]),[j]);if("string"==typeof t){if(!w||!(0,a.t)(w))return null;const e=(0,s.i7)((null==w?void 0:w.options)??[],t);if(!e)return(0,C.jsx)(g.Z,{isSingle:!1,showRemoveButton:!n,onClickRemove:()=>{null==k||k((0,u.Ck)(M,t))}},`deleted_option_value_${t}`);const o={value:e.value,color:e.color,isSingle:!1,showRemoveButton:!n,format:T.isMobile?l.lo.Medium:l.lo.Small,onClickRemove:()=>{null==k||k((0,u.Ck)(M,t))}};if((0,a.gB)(w)){var V;const t=null===(V=w.groups)||void 0===V||null===(V=V.find((t=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)})))||void 0===V?void 0:V.color;return(0,C.jsx)(S.F,{...o,groupColor:t})}return(0,C.jsx)(S.a,{...o})}if("boolean"==typeof t)return(0,C.jsx)(y.Z,{checked:t,disabled:!0,size:16,checkSize:12,style:{marginBottom:6}},t.toString());if((0,d.IWo)(t))return(0,C.jsx)(h.Z,{handleRemoveToken:n?void 0:()=>{null==k||k((0,u.Ck)(M,t))},token:t});if((0,d.wjk)(t)){const e=(0,d.vmO)(t).id,o=p.x.isSuccess(A)?(0,c.vx)(A.value.valueTypes,e):void 0;return o?(0,C.jsx)(v.Fg,{value:o,format:l.lo.Small,isSingle:!1,shouldShrink:!0,showRemoveButton:!n,onClickRemove:()=>{null==k||k((0,u.Ck)(M,t))}}):null}if((0,d.fpG)(t)){const e=M[0],t=e&&(0,u.S3)(e)&&(0,d.fpG)(e)?(0,d.zyO)(e):void 0;return t?(0,C.jsx)(f.Z,{value:t,dateFormat:P.dateFormat,timeFormat:P.timeFormat,style:{marginBottom:6}}):null}if((0,d.STW)(t)){const e=(0,d.TOT)(t);return e?(0,C.jsx)(x.Z,{format:T.isMobile?l.lo.Medium:l.lo.Small,blockId:e,shouldWrap:!1,shouldShrink:!0,isSingle:!1,parentStore:o.context.parentRecordStore,showRemoveButton:!n,onClickRemove:()=>{null==k||k((0,u.Ck)(M,t))}},e):null}(0,m.t1)(t)}var M=o(319385),j=o(272320),T=o(669141),A=(o(757658),o(399319)),P=o(173110),w=o(158573),V=o(559054),I=o(709291),F=o(653965),Z=o(296994),B=o(768657),K=o(460709),_=o(277907),R=o(675822),N=o(229798),D=o(478140),L=o(632163),O=o(743765),W=o(840721),E=o(672495),H=o(278948),U=o(147082),z=o(230387),$=o(581538),G=(o(21703),o(724405)),q=o(266897),Y=o(421202),Q=o(519889),X=o(825464),J=o(206258),ee=o(552275),te=o(511470),oe=o(526388),ne=o(992864);const ie=(0,I.defineMessages)({maximumPeopleSelectedTooltip:{defaultMessage:"Maximum people selected",id:"valuePickerItem.maximumSelectedReached"}});function re(e){const{token:t,contextStore:o,args:n,checkState:g,checkType:h,context:f,onCheckboxClick:x,disabled:b}=e,k=(0,i.Fy)(),M=(0,r.VK)((()=>o.context.parentRecordStore.getSpaceId()),[o.context.parentRecordStore]),j=(0,r.VK)((()=>{if((0,u.S3)(t)&&(0,d.IWo)(t)){const e=(0,d.zEN)(t);if(e)return(0,q.Hl)({pointer:{table:Q.KJ,id:e},getRecordValue:o.context.parentRecordStore.getRecordValue})}}),[o.context.parentRecordStore,t]),T=(0,r.VK)((()=>f.collectionStore.getSchema()[f.property]),[f]),A=(0,r.VK)((()=>T&&(0,a.t)(T)?T.options??[]:[]),[T]),P=(0,r.VK)((()=>T&&(0,a.gB)(T)?T.groups??[]:[]),[T]),w=(0,r.Kw)(o.compilationResultStore),V=(0,G.yK)((e=>({disabledMenuItem:{cursor:"not-allowed",opacity:.4}})),[]),F=Boolean(T&&(0,a.gB)(T)),Z="single"===h?{checkState:g}:"multi"===h?{icon:(0,C.jsx)(y.Z,{style:b?V.disabledMenuItem:void 0,checked:g,size:14,onClick:x,disabled:b})}:{};if("string"==typeof t){if(F){const e=(0,s.i7)(A,t),o=P.find((t=>{var o;return e&&(null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id))}));return e?(0,C.jsx)(ee.Z,{...n,...Z,title:(0,C.jsx)(S.F,{format:k.isMobile?l.lo.Large:l.lo.Small,isSingle:!0,value:e.value,color:e.color,groupColor:null==o?void 0:o.color,shouldShrink:!0,showRemoveButton:!1},t),isTokenTitle:!0,disabled:b,style:b?V.disabledMenuItem:void 0,...n}):null}{const e=(0,s.i7)(A,t);return e?(0,C.jsx)(ee.Z,{...n,...Z,title:(0,C.jsx)(S.a,{value:e.value,color:e.color,showRemoveButton:!1,isSingle:!0,shouldShrink:!0,format:k.isMobile?l.lo.Large:l.lo.Small}),isTokenTitle:!0,disabled:b,style:b?V.disabledMenuItem:void 0,...n}):null}}if("boolean"==typeof t)return null;if((0,d.IWo)(t))return null!=j&&j.asActor&&j.table===Q.KJ?(0,C.jsx)(ee.Z,{...n,...Z,title:b?(0,C.jsx)(oe.Z,{renderTooltip:()=>(0,C.jsx)(I.FormattedMessage,{...ie.maximumPeopleSelectedTooltip}),placement:X.u.Right,render:e=>(0,C.jsx)("div",{style:{width:"100%"},...e,children:(0,C.jsx)(ne.vw,{isSingle:!0,shouldShrink:!0,format:k.isMobile?ne.vw.Format.Large:ne.vw.Format.Medium,userValue:j.asActor})})}):(0,C.jsx)(ne.vw,{isSingle:!0,shouldShrink:!0,format:k.isMobile?ne.vw.Format.Large:ne.vw.Format.Medium,userValue:j.asActor}),disabled:b,style:b?V.disabledMenuItem:void 0,isTokenTitle:!0}):null;if((0,d.wjk)(t)){const e=(0,d.vmO)(t).id,o=p.x.isSuccess(w)?(0,c.vx)(w.value.valueTypes,e):void 0;return o?(0,C.jsx)(ee.Z,{...Z,title:(0,C.jsx)(oe.Z,{renderTooltip:()=>b?(0,C.jsx)(I.FormattedMessage,{...ie.maximumPeopleSelectedTooltip}):(0,v.hj)(o),placement:X.u.Right,render:e=>(0,C.jsx)("div",{style:{display:"flex"},...e,children:(0,C.jsx)(v.Fg,{value:o,format:l.lo.Medium,isSingle:!0,shouldShrink:!0})})}),disabled:b,style:b?V.disabledMenuItem:void 0,...n}):null}if((0,d.fpG)(t))return null;if((0,d.STW)(t)){const e=(0,d.TOT)(t);if(!e)return null;if(!M)return null;const i=J.G.createChildStore(o.context.parentRecordStore,{table:Y.iU,id:e,spaceId:M});return(0,C.jsx)(te.Z,{store:i,checkState:g,hidePath:!0,...n})}(0,m.t1)(t)}function ae(e){const{currentSimpleFormulaValueTokens:t,value:o,contextStore:n,setCurrentTokens:i,action:r,context:a,checkType:s,onCheckboxClick:l,isDisabled:c}=e;if(o.kind!==P.yp.ContextValue)throw new Error("Not implemented yet.");const p=Boolean(t.find((e=>(0,u.S3)(e)&&(0,d.wjk)(e)&&(0,d.vmO)(e).id===o.id))),m=(0,d._QF)({id:o.id}),g=()=>{i("append"===r?p?(0,u.Ck)(t,m):[...t,m]:[m]),null==l||l()};return{key:o.id,render:e=>(0,C.jsx)(re,{disabled:c,token:m,contextStore:n,args:e,checkState:p,checkType:s,context:a,onCheckboxClick:g}),action:g}}function se(e){var t,o;const{currentSimpleFormulaValueTokens:s,menuProps:l,onClose:c,onChange:p,contextStore:m,formulaTypecheckContextValues:g,context:h,showClearButton:y,showInputMenuItem:f,type:x}=e,S=(0,i.Fy)(),v=(0,I.useIntl)(),M=(0,i.O7)(),[j,T]=(0,n.useState)(""),G=(0,r.qz)(void 0,N.Z),{collectionStore:q,property:Y}=h,Q=(0,b.M)(q,Y),X=Q(s,"first"),J=(0,r.VK)((()=>q.getSchema()[h.property]),[q,h.property]),ee=(0,r.VK)((()=>!(!J||!(0,a.en)(J))&&1===J.limit),[J]),te=(0,n.useMemo)((()=>{const e="relation"===(null==J?void 0:J.type)?(0,a.j0)(J):void 0;return g.filter((t=>(0,A.uy)(t.type,{type:"block",collection:e},!0)))}),[g,J]),oe=(0,_.XJ)(Z.FF.searchActions),[ne]=(0,V.r5)((async()=>{const e=j?(0,w.ZP)(j,te,(e=>e.kind===P.yp.ContextValue?e.name:"")):te;if("resolved"!==oe.status)return;const t=oe.value,{results:o}=await t.searchPagesInCollection({environment:M,query:j,collectionId:x.collection.id,limit:20,spaceId:x.collection.spaceId,excludeTemplates:!0,source:"simple_formula_value_page_search",includePublicPagesWithoutExplicitAccess:!0,boostRecentlyViewedPages:!1});return{valueResults:e,pageResults:o}}),[M,j,te,x,oe.status,oe.value],{debounce:R.vp}),ie=(0,n.useCallback)((()=>{T(""),G.setState({...G.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),[G]),se=(0,n.useCallback)((e=>{const t=Q(e,"last");p({type:"simple",value:(0,u.iC)(t)}),ie(),ee&&c()}),[Q,p,ie,ee,c]),le=(0,r.VK)((()=>(0,B.NY)()),[]),ce=F.oA(X.map(((e,t)=>(0,C.jsx)(k,{token:e,contextStore:m,disabled:!1,currentSimpleFormulaValueTokens:X,setCurrentTokens:se,context:h},t)))),ue=(0,C.jsx)(U.ZP,{focus:!S.isMobile||void 0,focusAfterAnimation:!0,format:U.UR.FilterValue,tokens:ce,placeholder:v.formatMessage(z.s.pageSearchPlaceholder),onRemoveLastToken:()=>{se(X.slice(0,X.length-1))},onClearButtonClick:()=>{se([])},value:j,onChange:e=>{T(e.target.value)},dontShowBorderBottom:S.isAndroid,showClearButton:y}),de=void 0!==(null==l?void 0:l.header)?l.header:(0,C.jsx)(E.Z,{style:{paddingBottom:0},title:v.formatMessage(z.s.genericMenuHeader)});let pe;pe=S.isMobile?{menuType:K.og.Modal,right:(0,C.jsx)(W.DoneMenuText,{}),onClickRight:c}:{menuType:K.og.Popup,maxHeight:"50vh",width:260,paddingTop:0,footer:le&&(0,C.jsx)(E.Z,{topBorder:!0,children:(0,C.jsx)($.Z,{...e})}),disableHeaderBorder:!0};const me={...pe,...l,header:S.isMobile?null:de},ge=ee?"single":"multi",he=[],ye=[...F.oA(((null===(t=ne.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>ae({currentSimpleFormulaValueTokens:X,value:e,setCurrentTokens:se,contextStore:m,action:"append",context:h,checkType:ge})))),...F.oA(((null===(o=ne.value)||void 0===o?void 0:o.pageResults)||[]).map((e=>{const t=Boolean(X.find((t=>(0,u.S3)(t)&&(0,d.STW)(t)&&(0,d.TOT)(t)===e))),o=(0,d.$0A)(e,x.collection.spaceId),n=()=>{se(t?(0,u.Ck)(X,o):[...X,o])};return{key:e,render:e=>(0,C.jsx)(re,{token:o,contextStore:m,args:e,checkState:t,checkType:ge,context:h,onCheckboxClick:n}),action:n}})))];if(f){const e=Boolean(de);he.push({key:"search-input",render:t=>(0,C.jsx)(E.Z,{...t,style:{...e&&{paddingTop:0}}}),items:[{action:()=>{},key:"input",render:()=>ue}]})}if(ye.length>0){const e=Boolean(de)||f;he.push({key:"values",render:t=>(0,C.jsx)(E.Z,{topBorder:e,...t}),items:ye})}return(0,C.jsxs)(D.Z,{...me,children:[ne.error&&(0,C.jsx)(E.Z,{children:(0,C.jsx)(O.Z,{title:(0,C.jsx)(I.FormattedMessage,{...z.s.somethingWentWrong})})}),0===he.length&&ne.value&&(0,C.jsx)(E.Z,{children:(0,C.jsx)(O.Z,{title:(0,C.jsx)(I.FormattedMessage,{...z.s.noResults})})}),!ne.value&&!ne.error&&(0,C.jsx)(E.Z,{children:(0,C.jsx)(H.Z,{})}),he.length>0&&(0,C.jsx)(L.Z,{type:L.i.Vertical,initialFocus:0,sections:he,store:G})]})}function le(e){const{context:t,contextStore:o,currentSimpleFormulaValueTokens:a,formulaTypecheckContextValues:s,menuProps:l,onChange:c,onClose:d}=e,p=(0,I.useIntl)(),m=(0,i.Fy)(),g=s.filter((e=>"checkbox"===e.type.type)),h=(0,n.useCallback)((e=>{c({type:"simple",value:void 0!==e[0]?(0,u.YD)(e[0]):void 0})}),[c]),y=(0,n.useCallback)((e=>{h(e),d()}),[h,d]),f=(0,r.VK)((()=>(0,B.NY)()),[]),x=F.oA(g.map((e=>ae({currentSimpleFormulaValueTokens:a,value:e,setCurrentTokens:y,contextStore:o,action:"replace",context:t,checkType:"single"})))),S=[],v=a.some((e=>!0===e)),b=[...x,...[{key:0,render:e=>(0,C.jsx)(ee.Z,{title:(0,C.jsx)(I.FormattedMessage,{...z.s.unchecked}),checkState:!v,...e}),action:()=>{y([!1])}},{key:1,render:e=>(0,C.jsx)(ee.Z,{title:(0,C.jsx)(I.FormattedMessage,{...z.s.checked}),checkState:v,...e}),action:()=>{y([!0])}}]],k=void 0!==(null==l?void 0:l.header)?l.header:(0,C.jsx)(E.Z,{style:{paddingBottom:0},title:p.formatMessage(z.s.genericMenuHeader)}),M=Boolean(k);let j;S.push({key:"checkbox",render:e=>(0,C.jsx)(E.Z,{...e,topBorder:M}),items:b}),j=m.isMobile?{menuType:K.og.Modal,right:(0,C.jsx)(W.DoneMenuText,{}),onClickRight:d}:{header:k,menuType:K.og.Popup,maxHeight:"50vh",width:260,footer:f&&(0,C.jsx)(E.Z,{topBorder:!0,children:(0,C.jsx)($.Z,{...e})}),disableHeaderBorder:!0};const T={...j,...l,header:m.isMobile?null:k};return(0,C.jsx)(D.Z,{...T,children:(0,C.jsx)(L.Z,{type:L.i.Vertical,initialFocus:0,sections:S})})}var ce=o(282447),ue=o(407835),de=o(640506),pe=o(612392),me=o(628020),ge=o(573063),he=o(489728);function ye(e){const{currentSimpleFormulaValueTokens:t,disabled:o,setInDatePicker:i,onClose:a,setCurrentTokens:s,context:l}=e,c=t[0],p=c&&(0,u.S3)(c)&&d.fpG(c)?d.zyO(c):void 0,m=(0,I.useIntl)(),g=(0,r.Kw)(me.AK),h=(0,n.useCallback)((()=>{i(!1)}),[i]),y=(0,n.useCallback)((e=>{e&&(0,de.U3)(e)?s([d.pZr(e)]):s([])}),[s]),f=(0,G.yK)((e=>({header:{display:"flex",alignItems:"center",fontSize:12,paddingInline:14,color:e.mediumTextColor,marginTop:8,fontWeight:500},iconWrap:{width:18,height:18,marginRight:4},icon:{width:12,height:12},title:{flex:"1 1 auto"}})),[]),x=(0,r.VK)((()=>(0,b._)(l)),[l]);return(0,C.jsx)(_.ev,{dependency:Z.FF.menus,children:e=>{let{DatePropertyMenu:t}=e;return(0,C.jsx)(t,{firstDayOfWeek:g,value:p,canConfigureCollection:!1,onChangeValue:y,dateFormat:x.dateFormat,timeFormat:x.timeFormat,onDismiss:a,disabled:o,shouldShowReminder:!1,header:(0,C.jsxs)("div",{style:f.header,children:[(0,C.jsx)(ge.Z,{ariaLabel:m.formatMessage(z.s.back),icon:pe.S,onClick:h,style:f.iconWrap,iconStyle:f.icon}),(0,C.jsx)("span",{style:f.title,children:(0,C.jsx)(I.FormattedMessage,{...z.s.pickADate})}),(0,C.jsx)(he.Z,{onClick:a,isBlue:!0,children:(0,C.jsx)(W.DoneMenuText,{})})]}),isTemplatePage:!1})}})}function fe(e){const{currentSimpleFormulaValueTokens:t,onClose:o,onChange:a,contextStore:s,formulaTypecheckContextValues:l,context:c,menuProps:d}=e,p=(0,I.useIntl)(),m=(0,i.Fy)(),[g,h]=(0,n.useState)(!1),y=l.filter((e=>"date"===e.type.type)),f=(0,n.useCallback)((e=>{a({type:"simple",value:void 0!==e[0]?(0,u.YD)(e[0]):void 0})}),[a]),x=(0,n.useCallback)((e=>{f(e),o()}),[f,o]),S=(0,n.useCallback)((()=>{h(!0)}),[]),v=(0,n.useCallback)((()=>{f([]),o()}),[f,o]),b=(0,r.VK)((()=>(0,B.NY)()),[]);if(g)return(0,C.jsx)(ye,{...e,setInDatePicker:h,setCurrentTokens:f,currentSimpleFormulaValueTokens:t});const k=void 0!==(null==d?void 0:d.header)?d.header:(0,C.jsx)(E.Z,{style:{paddingBottom:0},title:p.formatMessage(z.s.genericMenuHeader)}),M=F.oA(y.map((e=>ae({currentSimpleFormulaValueTokens:t,value:e,setCurrentTokens:x,contextStore:s,action:"replace",context:c,checkType:"single"})))),j=[];if(M.length>0){const e=Boolean(k);j.push({key:"values",render:t=>(0,C.jsx)(E.Z,{topBorder:e,...t}),items:M})}const T=(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(E.Z,{topBorder:!0,children:[(0,C.jsx)(ue.Z,{icon:ce.V,title:(0,C.jsx)(I.FormattedMessage,{...z.s.pickADate}),onClick:S}),b&&(0,C.jsx)($.Z,{...e})]}),t.length>0&&(0,C.jsx)(E.Z,{topBorder:!0,children:(0,C.jsx)(ee.Z,{title:(0,C.jsx)(I.FormattedMessage,{...z.s.clear}),focused:!1,onClick:v})})]});let A;A=m.isMobile?{menuType:K.og.Modal,right:(0,C.jsx)(W.DoneMenuText,{}),onClickRight:o,footer:T}:{menuType:K.og.Popup,maxHeight:"50vh",width:260,footer:T,disableHeaderBorder:!0};const P={...A,...d,header:m.isMobile?null:k};return(0,C.jsx)(D.Z,{...P,children:(0,C.jsx)(L.Z,{type:L.i.Vertical,initialFocus:0,sections:j})})}var xe=o(268894);function Se(e){const{context:t,contextStore:o,currentSimpleFormulaValueTokens:a,formulaTypecheckContextValues:s,menuProps:l,onChange:c,onClose:p,value:m}=e,g=(0,I.useIntl)(),h=(0,i.Fy)(),y=s.filter((e=>"number"===e.type.type)),f=(0,n.useCallback)((e=>{c({type:"simple",value:e})}),[c]),x=(0,n.useCallback)((e=>{f(e),p()}),[f,p]),S=(0,n.useCallback)((e=>{const t=e.target.value;let o;o=""===t?void 0:[[t]],f(o)}),[f]),v=(0,n.useCallback)((e=>{const t=F.U2(e,"event.target.value");let o;o="string"==typeof t&&""!==t?[[t]]:void 0,x(o)}),[x]),b=(0,n.useCallback)((e=>{const t=void 0!==e[0]?(0,u.YD)(e[0]):void 0;x(t)}),[x]),k=(0,r.VK)((()=>(0,B.NY)()),[]),M=F.oA(y.map((e=>ae({currentSimpleFormulaValueTokens:a,value:e,setCurrentTokens:b,contextStore:o,action:"replace",context:t,checkType:"single"})))),j=[],T=[{action:v,key:"input",render:e=>{const t=a[0],o="string"==typeof t?t:(0,d.QaF)(null==m?void 0:m.value);return(0,C.jsx)(xe.ZP,{...e,focus:!0,onChange:S,onClick:void 0,value:o})}}],A=[...T,...M],P=void 0!==(null==l?void 0:l.header)?l.header:(0,C.jsx)(E.Z,{style:{paddingBottom:0},title:g.formatMessage(z.s.genericMenuHeader)});let w;j.push({key:"textbox",render:e=>(0,C.jsx)(E.Z,{...e}),items:A}),w=h.isMobile?{menuType:K.og.Modal,right:(0,C.jsx)(W.DoneMenuText,{}),onClickRight:p}:{menuType:K.og.Popup,maxHeight:"50vh",width:260,footer:k&&(0,C.jsx)(E.Z,{topBorder:!0,children:(0,C.jsx)($.Z,{...e})}),disableHeaderBorder:!0};const V={...w,...l,header:h.isMobile?null:P};return(0,C.jsx)(D.Z,{...V,children:(0,C.jsx)(L.Z,{initialFocus:0,sections:j,type:L.i.Vertical})})}var ve=o(701302),be=o(531701);function Ce(e){var t,o;const{context:s,contextStore:l,currentSimpleFormulaValueTokens:c,formulaTypecheckContextValues:p,menuProps:m,onChange:g,onClose:h,showClearButton:y,showInputMenuItem:f,limit:x}=e,S=(0,i.Fy)(),v=(0,I.useIntl)(),M=(0,i.O7)(),{collectionStore:j,property:T}=s,[_,G]=(0,n.useState)(""),q=(0,r.qz)(void 0,N.Z),Y=(0,b.M)(j,T),Q=Y(c,"first"),X=(0,r.VK)((()=>{const e=j.getSchema()[s.property];return!(!e||!(0,a.en)(e))&&1===e.limit}),[j,s]),J=p.filter((e=>(0,A.uy)(e.type,{type:"person"}))),[ee]=(0,V.r5)((async()=>{const e=_?(0,w.ZP)(_,J,(e=>e.kind===P.yp.ContextValue?e.name:"")):J,t=await Z.FF.searchActions.load();return{valueResults:e,userResults:(await t.searchVisibleSpaceUsers({environment:M,query:_,membersOnly:!1})).map((e=>e.id)).slice(0,20)}}),[M,_,J],{debounce:R.vp}),te=(0,n.useCallback)((()=>{G(""),q.setState({...q.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),[q]),oe=(0,n.useCallback)((e=>{const t=Y(e,"last");g({type:"simple",value:(0,u.iC)(t)}),te()}),[g,te,Y]),ne=(0,r.VK)((()=>(0,B.NY)()),[]),ie=Boolean(x&&Q.length>=x),se=F.oA(Q.map(((e,t)=>(0,C.jsx)(k,{token:e,contextStore:l,disabled:!1,currentSimpleFormulaValueTokens:Q,setCurrentTokens:oe,context:s},t)))),le=new Set(F.oA(Q.map((e=>(0,u.S3)(e)&&(0,d.wjk)(e)&&(0,d.vmO)(e).id)))),ce=new Set(F.oA(Q.map((e=>(0,u.S3)(e)&&(0,d.IWo)(e)&&(0,d.zEN)(e))))),ue=(0,C.jsx)(U.ZP,{style:{maxHeight:6*parseInt(U.go,10)},focus:!S.isMobile||void 0,focusAfterAnimation:!0,format:U.UR.FilterValue,tokens:se,placeholder:v.formatMessage(z.s.personSearchPlaceholder),onRemoveLastToken:()=>{oe(Q.slice(0,Q.length-1))},onClearButtonClick:()=>{oe([])},value:_,onChange:e=>{G(e.target.value)},dontShowBorderBottom:S.isAndroid,showClearButton:y,disabled:ie}),de=void 0!==(null==m?void 0:m.header)?m.header:(0,C.jsx)(E.Z,{style:{paddingBottom:0},title:v.formatMessage(z.s.genericMenuHeader)});let pe;pe=S.isMobile?{menuType:K.og.Modal,right:(0,C.jsx)(W.DoneMenuText,{}),onClickRight:h}:{menuType:K.og.Popup,maxHeight:"50vh",width:260,footer:ne&&(0,C.jsx)(E.Z,{topBorder:!0,children:(0,C.jsx)($.Z,{...e})}),disableHeaderBorder:!0};const me={...pe,...m,header:(0,C.jsxs)("div",{style:{paddingBlockEnd:6,borderBlockEnd:`1px solid ${be.ZP.dividerColor}`},children:[!S.isMobile&&de," ",f&&ue]})},ge=[...F.oA(((null===(t=ee.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>{if(!(e.kind===P.yp.ContextValue&&le.has(e.id)))return ae({currentSimpleFormulaValueTokens:Q,value:e,setCurrentTokens:oe,contextStore:l,action:"append",context:s,checkType:"none",onCheckboxClick:()=>{X&&ve.default.afterNextFlush((()=>{h()}))},isDisabled:ie})}))),...F.oA(((null===(o=ee.value)||void 0===o?void 0:o.userResults)||[]).map((e=>{if(ce.has(e))return;const t=(0,d.tEo)(e),o=()=>{oe([...Q,t]),X&&ve.default.afterNextFlush((()=>{h()}))};return{key:e,render:e=>(0,C.jsx)(re,{disabled:ie,token:t,contextStore:l,args:e,checkState:!1,checkType:"none",context:s,onCheckboxClick:o}),action:o}})))],he=[];return ge.length>0&&he.push({key:"users",render:e=>(0,C.jsx)(E.Z,{...e}),items:ge}),(0,C.jsxs)(D.Z,{...me,children:[ee.error&&(0,C.jsx)(E.Z,{children:(0,C.jsx)(O.Z,{title:(0,C.jsx)(I.FormattedMessage,{...z.s.somethingWentWrong})})}),0===he.length&&ee.value&&(0,C.jsx)(E.Z,{children:(0,C.jsx)(O.Z,{title:(0,C.jsx)(I.FormattedMessage,{...z.s.noResults})})}),!ee.value&&!ee.error&&(0,C.jsx)(E.Z,{children:(0,C.jsx)(H.Z,{})}),he.length>0&&(0,C.jsx)(L.Z,{type:L.i.Vertical,initialFocus:0,sections:he,store:q})]})}function ke(e){const{context:t,contextStore:o,currentSimpleFormulaValueTokens:s,formulaTypecheckContextValues:l,isSingle:c,menuProps:d,onChange:p,onClose:g,showClearButton:h,showInputMenuItem:y,type:f}=e,x=(0,i.Fy)(),S=(0,I.useIntl)(),[v,b]=(0,n.useState)(""),M=(0,r.qz)(void 0,N.Z),j=J.NW.createChildStore(o.context.parentRecordStore,f.collection),T=(0,r.VK)((()=>j.getSchema()[f.property]),[j,f]),V=(0,r.VK)((()=>T&&(0,a.gB)(T)?T.groups??[]:[]),[T]),Z=(0,r.VK)((()=>T&&(0,a.t)(T)&&T.options||[]),[T]),_=l.filter((e=>(0,A.uy)(e.type,{type:"select",collection:f.collection,property:f.property}))),R=(0,r.VK)((()=>({valueResults:v?(0,w.ZP)(v,_,(e=>e.kind===P.yp.ContextValue?e.name:"")):_,selectResults:v?(0,w.ZP)(v,Z,(e=>e.value)):Z})),[v,_,Z]),H=(0,n.useCallback)((()=>{b(""),M.setState({...M.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),[M]),G=(0,n.useCallback)((e=>{p({type:"simple",value:c?(0,u.YD)(e[0]):(0,u.iC)(e)}),H()}),[p,H,c]),q=(0,r.VK)((()=>(0,B.NY)()),[]),Y=F.oA(s.map(((e,n)=>(0,C.jsx)(k,{token:e,contextStore:o,disabled:!1,currentSimpleFormulaValueTokens:s,setCurrentTokens:G,context:t},n)))),Q=void 0!==(null==d?void 0:d.header)?d.header:(0,C.jsx)(E.Z,{style:{paddingBottom:0},title:S.formatMessage(z.s.genericMenuHeader)}),X=(0,C.jsx)(U.ZP,{focus:!x.isMobile||void 0,focusAfterAnimation:!0,format:U.UR.FilterValue,tokens:Y,placeholder:S.formatMessage(z.s.searchPlaceHolder),onRemoveLastToken:()=>{G(s.slice(0,s.length-1))},onClearButtonClick:()=>{G([])},value:v,onChange:e=>{b(e.target.value)},dontShowBorderBottom:x.isAndroid,showClearButton:h}),ee=[];if(y){const e=Boolean(Q);ee.push({key:"search-input",render:t=>(0,C.jsx)(E.Z,{...t,style:{...e&&{paddingTop:0}}}),items:[{action:()=>{},key:"input",render:()=>X}]})}const te=Boolean(T&&(0,a.gB)(T)),oe={automationContextValues:R.valueResults??[],onClose:g,context:t,contextStore:o,currentSimpleFormulaValueTokens:s,isSingle:c,groupOptions:V,selectOptions:R.selectResults??[],setCurrentTokens:G},ne=te?function(e){const{automationContextValues:t,onClose:o,context:n,contextStore:i,currentSimpleFormulaValueTokens:r,isSingle:a,groupOptions:s,selectOptions:l,setCurrentTokens:c}=e,d=[],p=a?"single":"multi",g=F.oA(t.map((e=>ae({currentSimpleFormulaValueTokens:r,value:e,setCurrentTokens:c,contextStore:i,action:a?"replace":"append",context:n,checkType:p,onCheckboxClick:()=>{a&&ve.default.afterNextFlush((()=>{o()}))}}))));g.length>0&&d.push({key:"automation-variables",render:e=>(0,C.jsx)(E.Z,{title:(0,C.jsx)(I.FormattedMessage,{...z.s.valuesFromThisAutomation}),topBorder:!0,...e}),items:g});const h=new Map(l.map((e=>[e.id,e]))),y=s.map((e=>{const t=(e.optionIds??[]).map((e=>h.get(e))).filter(m.$K).map((e=>{const t=Boolean(r.find((t=>"string"==typeof t&&t===e.value))),s=()=>{c(a?t?[]:[e.value]:t?(0,u.Ck)(r,e.value):[...r,e.value]),a&&ve.default.afterNextFlush((()=>{o()}))},l={key:e.id,render:o=>(0,C.jsx)(re,{token:e.value,contextStore:i,args:o,checkState:t,checkType:p,context:n,onCheckboxClick:s}),action:s};return l})),s={key:e.id,items:t,render:t=>(0,C.jsx)(E.Z,{title:e.name,topBorder:!0,...t})};return s})).filter((e=>e.items.length>0));return d.push(...y),d}(oe):function(e){const{automationContextValues:t,onClose:o,context:n,contextStore:i,currentSimpleFormulaValueTokens:r,isSingle:a,selectOptions:s,setCurrentTokens:l}=e,c=[],d=a?"single":"multi",p=F.oA(t.map((e=>ae({currentSimpleFormulaValueTokens:r,value:e,setCurrentTokens:l,contextStore:i,action:a?"replace":"append",context:n,checkType:d,onCheckboxClick:()=>{a&&ve.default.afterNextFlush((()=>{o()}))}})))),m=F.oA(s.map((e=>{const t=Boolean(r.find((t=>"string"==typeof t&&t===e.value))),s=()=>{l(a?t?[]:[e.value]:t?(0,u.Ck)(r,e.value):[...r,e.value]),a&&ve.default.afterNextFlush((()=>{o()}))},c={key:e.id,render:o=>(0,C.jsx)(re,{token:e.value,contextStore:i,args:o,checkState:t,checkType:d,context:n,onCheckboxClick:s}),action:s};return c}))),g=[...p,...m];g.length>0&&c.push({key:"options",render:e=>(0,C.jsx)(E.Z,{topBorder:!0,...e}),items:g});return c}(oe);let ie;ee.push(...ne),ie=x.isMobile?{menuType:K.og.Modal,right:(0,C.jsx)(W.DoneMenuText,{}),onClickRight:g}:{menuType:K.og.Popup,maxHeight:"50vh",width:260,paddingTop:0,footer:q&&(0,C.jsx)(E.Z,{topBorder:!0,children:(0,C.jsx)($.Z,{...e})}),disableHeaderBorder:!0};const se={...ie,...d,header:x.isMobile?null:Q};return(0,C.jsxs)(D.Z,{...se,children:[0===ee.length&&(0,C.jsx)(E.Z,{children:(0,C.jsx)(O.Z,{title:(0,C.jsx)(I.FormattedMessage,{...z.s.noResults})})}),ee.length>0&&(0,C.jsx)(L.Z,{type:L.i.Vertical,initialFocus:0,sections:ee,store:M})]})}var Me=o(965187),je=o(843250),Te=o(249394),Ae=o(828992);function Pe(e){const{context:t,contextStore:o,currentSimpleFormulaValueTokens:a,formulaTypecheckContextValues:s,menuProps:l,onChange:c,onClose:d,value:p,disableEmojiCommands:m,disableFormattingAndMentions:g,disableMobileActionBar:h,disableTemplateVariableMentions:y}=e,f=(0,I.useIntl)(),{isMobile:x}=(0,i.Fy)(),S=(0,G.yK)((e=>({wrap:{background:e.inputBackground,borderRadius:4,boxShadow:e.inputBoxShadow,lineHeight:"24px",padding:1,marginBlock:x?12:0},text:{maxHeight:120,overflow:"auto",padding:"4px 10px"}})),[x]),v=(0,r.VK)((()=>(0,B.NY)()),[]),b=(0,n.useMemo)((()=>s.filter((e=>"text"===e.type.type))),[s]),k=(0,n.useCallback)((e=>{c({type:"simple",value:e})}),[c]),M=(0,n.useCallback)((e=>{k(e),d()}),[k,d]),j=(0,n.useCallback)((e=>{const t=void 0!==e[0]?(0,u.YD)(e[0]):void 0;M(t)}),[M]),{store:T}=(0,B.Cl)({initialValue:null==p?void 0:p.value,onChange:k}),A=F.oA(b.map((e=>ae({currentSimpleFormulaValueTokens:a,value:e,setCurrentTokens:j,contextStore:o,action:"replace",context:t,checkType:"single"})))),P=[],w=[{action:F.ZT,key:"input",render:e=>(0,C.jsx)(Ae.Z,{...e,title:(0,C.jsx)("div",{className:je.Wh_,style:S.wrap,children:(0,C.jsx)(Me.Z,{disableComment:!0,disabled:!1,disableEmbedMenu:!0,disableEmojiCommands:m,disableMobileActionBar:h,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableSlashCommands:!0,disableTemplateVariableMentions:y,...g?{disableDateMentions:!0,disableDateReminderMentions:!0,disableMentions:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0}:{},onEnter:d,pasteBehavior:"inline",store:T,style:S.text,inPageFind:Te.B3.none})})})}],V=[...A,...w],Z=void 0!==(null==l?void 0:l.header)?l.header:(0,C.jsx)(E.Z,{style:{paddingBottom:0},title:f.formatMessage(z.s.genericMenuHeader)});let _;P.push({key:"textbox",render:e=>(0,C.jsx)(E.Z,{...e}),items:V}),_=x?{menuType:K.og.Modal,right:(0,C.jsx)(W.DoneMenuText,{}),onClickRight:d}:{menuType:K.og.Popup,maxHeight:"50vh",width:260,footer:v&&(0,C.jsx)(E.Z,{topBorder:!0,children:(0,C.jsx)($.Z,{...e})}),disableHeaderBorder:!0};const R={..._,...l,header:x?null:Z};return(0,C.jsx)(D.Z,{...R,children:(0,C.jsx)(L.Z,{initialFocus:0,sections:P,type:L.i.Vertical})})}function we(e){const{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,formulaValueContext:n,limit:i,onChange:a,onClose:s,showClearButton:l,showInputMenuItem:c,type:u,value:d}=e,p=(0,r.VK)((()=>M.default.checkGate({gateName:"automation_advanced_person_trigger_actions"})),[]),g=(0,r.VK)((()=>M.default.checkGate({gateName:"automation_advanced_number_trigger_actions"})),[]);return"text"===u.type?(0,C.jsx)(Pe,{...e,type:u}):"number"===u.type?g?(0,C.jsx)(j.Z,{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:e.menuProps,onChange:a,onClose:s,showTitle:!0,value:d}):(0,C.jsx)(Se,{...e,type:u}):"checkbox"===u.type?(0,C.jsx)(le,{...e,type:u}):"date"===u.type?(0,C.jsx)(fe,{...e,type:u}):"person_array"===u.type?p?(0,C.jsx)(T.Z,{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,formulaValueContext:n,limit:i,menuProps:e.menuProps,onChange:a,onClose:s,showClearButton:l??!0,showInputMenuItem:c??!0,showFormulaValueItems:!0,value:d}):(0,C.jsx)(Ce,{...e,showClearButton:l??!0,showInputMenuItem:c??!0,type:u}):"block_array"===u.type?(0,C.jsx)(se,{...e,showClearButton:l??!0,showInputMenuItem:c??!0,type:u}):"select"===u.type?(0,C.jsx)(ke,{...e,showClearButton:l??!0,showInputMenuItem:c??!0,type:u,isSingle:!0}):"select_array"===u.type?(0,C.jsx)(ke,{...e,showClearButton:l??!0,showInputMenuItem:c??!0,type:u,isSingle:!1}):void(0,m.t1)(u)}},475311:(e,t,o)=>{o.d(t,{M:()=>l,_:()=>c});var n=o(667294),i=o(886628),r=o(399036),a=o(640506),s=o(401898);function l(e,t){const o=(0,i.VK)((()=>{const o=e.getSchema()[t];let n;return o&&(0,r.en)(o)&&(n=o.limit),n}),[e,t]);return(0,n.useCallback)(((e,t)=>(0,s.$K)(o)?"first"===t?e.slice(0,o):"last"===t?e.slice(-o):void(0,s.t1)(t):e),[o])}function c(e){var t;const o=null===(t=e.collectionStore.getSchema())||void 0===t?void 0:t[e.property];return o&&"date"===o.type?{dateFormat:o.date_format||a.sF,timeFormat:o.time_format||a.c_}:{dateFormat:a.sF,timeFormat:a.c_}}},246006:(e,t,o)=>{o.d(t,{Z:()=>y});o(667294);var n=o(886628),i=o(984619),r=o(335102),a=o(76233),s=o(709291),l=o(940470),c=o(825464),u=o(552275),d=o(526388),p=o(721396),m=o(556834),g=o(796192),h=o(785893);function y(e){let{annotation:t,automationContextStore:o,disabled:y,menuArgs:f}=e;const x=(0,n.VK)((()=>o.compilationResultStore.getState()),[o.compilationResultStore]),S=(0,g.L)(),v=(0,a.vmO)(t).id,b=l.x.isSuccess(x)?(0,r.vx)(x.value.valueTypes,v):void 0;return b?(0,h.jsx)(u.Z,{...f,title:(0,h.jsx)(d.Z,{renderTooltip:()=>y?(0,h.jsx)(s.FormattedMessage,{...m.f.maximumPeopleSelectedTooltip}):(0,p.hj)(b),placement:c.u.Right,render:e=>(0,h.jsx)("div",{style:{display:"flex"},...e,children:(0,h.jsx)(p.Fg,{value:b,format:i.lo.Medium,isSingle:!0,shouldShrink:!0})})}),disabled:y,style:y?S.disabledMenuItem:void 0}):null}},916846:(e,t,o)=>{o.d(t,{A:()=>a});o(21703);var n=o(173110),i=o(576218),r=o(76233);function a(e){const{action:t,currentSimpleFormulaValueTokens:o,onCheckboxClick:a,setCurrentTokens:s,value:l}=e;if(l.kind!==n.yp.ContextValue)throw new Error("Not implemented yet.");const c=Boolean(o.find((e=>(0,i.S3)(e)&&(0,r.wjk)(e)&&(0,r.vmO)(e).id===l.id))),u=(0,r._QF)({id:l.id});return{annotation:u,checkState:c,itemAction:()=>{s("append"===t?c?(0,i.Ck)(o,u):[...o,u]:[u]),null==a||a()}}}},556834:(e,t,o)=>{o.d(t,{f:()=>n});const n=(0,o(709291).defineMessages)({maximumPeopleSelectedTooltip:{defaultMessage:"Maximum people selected",id:"valuePickerItem.maximumSelectedReached"}})},272320:(e,t,o)=>{o.d(t,{Z:()=>j});o(757658);var n=o(667294),i=o(800480),r=o(531701),a=o(886628),s=o(173110),l=o(576218),c=o(76233),u=o(709291),d=o(653965),p=o(268894),m=o(230387),g=o(581538),h=o(768657),y=o(312455),f=o(785893);var x=o(460709),S=o(478140),v=o(632163),b=o(840721),C=o(672495),k=o(246006),M=o(916846);function j(e){const{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:j,onChange:T,onClose:A,showTitle:P,value:w}=e,V=(0,i.Fy)(),{footer:I,header:F,numberInput:Z,valueItems:B}=function(e){const{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,onChange:i,onClose:r,value:x}=e,S=(0,u.useIntl)(),{automationContextStore:v}=(0,y.i)(),b=o.filter((e=>"number"===e.type.type)),C=(0,a.VK)((()=>(0,h.NY)()),[]),k=(0,n.useCallback)((e=>{i({type:"simple",value:e})}),[i]),M=(0,n.useCallback)((e=>{k(e),r()}),[k,r]),j=(0,n.useCallback)((e=>{const t=e.target.value;let o;o=""===t?void 0:[[t]],k(o)}),[k]),T=(0,n.useCallback)((e=>{const t=void 0!==e[0]?(0,l.YD)(e[0]):void 0;M(t)}),[M]),A=d.oA(b.map((e=>{if(e.kind===s.yp.ContextValue&&v)return{action:"replace",automationContextStore:v,currentSimpleFormulaValueTokens:t,id:e.id||"",setCurrentTokens:T,value:e}}))),P=(0,n.useMemo)((()=>{const e=t[0],o="string"==typeof e?e:(0,c.QaF)(null==x?void 0:x.value);return(0,f.jsx)(p.ZP,{focus:!0,onChange:j,value:o})}),[t,j,null==x?void 0:x.value]),w=(0,f.jsx)(g.Z,{value:x,onChange:i});return{footer:C&&w,header:S.formatMessage(m.s.genericMenuHeader),numberInput:P,valueItems:A}}({formulaTypecheckContextValues:o,onChange:T,onClose:A,currentSimpleFormulaValueTokens:t,value:w})||{},K=(0,n.useMemo)((()=>B.map((e=>{const{annotation:t,itemAction:o}=(0,M.A)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:o=>(0,f.jsx)(k.Z,{annotation:t,automationContextStore:e.automationContextStore,disabled:!1,menuArgs:o}),action:o}}))),[B]),_=[],R=void 0!==(null==j?void 0:j.header)?j.header:(0,f.jsx)(C.Z,{style:{paddingBottom:0},title:F});let N;K.length>0&&_.push({key:"textbox",render:e=>(0,f.jsx)(C.Z,{...e}),items:K}),N=V.isMobile?{menuType:x.og.Modal,right:(0,f.jsx)(b.DoneMenuText,{}),onClickRight:A}:{menuType:x.og.Popup,maxHeight:"50vh",width:260,footer:I&&(0,f.jsx)(C.Z,{topBorder:!0,children:I}),disableHeaderBorder:!0};const D=(0,f.jsxs)("div",{style:{paddingBlockEnd:6,borderBlockEnd:`1px solid ${r.ZP.dividerColor}`},children:[!V.isMobile&&P&&R,Z]});return(0,f.jsx)(S.Z,{...N,header:D,children:(0,f.jsx)(v.Z,{initialFocus:0,sections:_,type:v.i.Vertical})})}},669141:(e,t,o)=>{o.d(t,{Z:()=>X});o(757658);var n=o(667294),i=o(800480),r=o(531701),a=o(701302),s=o(886628),l=o(399036),c=o(399319),u=o(173110),d=o(576218),p=o(158573),m=o(559054),g=o(959753),h=o(76233),y=o(709291),f=o(653965),x=o(475311),S=o(230387),v=o(581538),b=o(147082),C=o(296994),k=o(768657),M=o(675822),j=o(229798),T=o(312455),A=o(984619),P=o(335102),w=o(940470),V=o(721396),I=o(785893);function F(e){let{automationContextStore:t,handleRemoveToken:o,isDisabled:n,token:i}=e;const r=(0,s.VK)((()=>t.compilationResultStore.getState()),[t.compilationResultStore]),a=(0,h.vmO)(i).id,l=w.x.isSuccess(r)?(0,P.vx)(r.value.valueTypes,a):void 0;return l?(0,I.jsx)(V.Fg,{value:l,format:A.lo.Small,isSingle:!1,shouldShrink:!0,showRemoveButton:!n,onClickRemove:()=>o(i)}):null}var Z=o(319616);var B=o(460709),K=o(478140),_=o(632163),R=o(743765),N=o(840721),D=o(672495),L=o(278948),O=o(246006),W=o(916846),E=o(266897),H=o(519889),U=o(825464),z=o(552275),$=o(526388),G=o(992864),q=o(556834),Y=o(796192);function Q(e){let{annotation:t,disabled:o,getRecordModel:n,menuArgs:r}=e;const a=(0,i.Fy)(),l=(0,Y.L)(),c=(0,s.VK)((()=>{if((0,d.S3)(t)&&(0,h.IWo)(t)){const e=(0,h.zEN)(t);return e?(0,E.Hl)({pointer:{table:H.KJ,id:e},getRecordValue:n}):void 0}}),[t,n]);return null!=c&&c.asActor&&c.table===H.KJ?(0,I.jsx)(z.Z,{...r,title:o?(0,I.jsx)($.Z,{renderTooltip:()=>(0,I.jsx)(y.FormattedMessage,{...q.f.maximumPeopleSelectedTooltip}),placement:U.u.Right,render:e=>(0,I.jsx)("div",{style:{width:"100%"},...e,children:(0,I.jsx)(G.vw,{isSingle:!0,shouldShrink:!0,format:a.isMobile?G.vw.Format.Large:G.vw.Format.Medium,userValue:c.asActor})})}):(0,I.jsx)(G.vw,{isSingle:!0,shouldShrink:!0,format:a.isMobile?G.vw.Format.Large:G.vw.Format.Medium,userValue:c.asActor}),disabled:o,style:o?l.disabledMenuItem:void 0,isTokenTitle:!0}):null}function X(e){const{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,formulaValueContext:A,getRecordModel:P,limit:w,menuProps:V,onChange:E,onClose:H,showClearButton:U=!1,showInputMenuItem:z=!1,showFormulaValueItems:$=!1,value:G}=e,q=(0,i.Fy)(),{errorMessage:Y,footer:X,header:J,isLoading:ee,menuListStore:te,noResultsMessage:oe,searchInput:ne,userItems:ie,valueItems:re}=function(e){var t,o;const{formulaTypecheckContextValues:r,formulaValueContext:A,limit:P,onChange:w,onClose:V,showClearButton:B,unlimitedCurrentSimpleFormulaValueTokens:K,value:_}=e,R=(0,i.O7)(),N=(0,i.Fy)(),D=(0,y.useIntl)(),{automationContextStore:L}=(0,T.i)(),{collectionStore:O,property:W}=A,E=O.getRecordModel??g.om.constant(void 0),H=(0,x.M)(O,W),U=H(K,"first"),z=r.filter((e=>(0,c.uy)(e.type,{type:"person"}))),[$,G]=(0,n.useState)(""),q=(0,s.qz)(void 0,j.Z),Y=(0,s.VK)((()=>{if(O&&W){const e=O.getSchema()[W];if(e&&(0,l.en)(e))return 1===e.limit}return!1}),[O,W]),Q=(0,s.VK)((()=>(0,k.NY)()),[]),[X]=(0,m.r5)((async()=>{const e=$?(0,p.ZP)($,z,(e=>e.kind===u.yp.ContextValue?e.name:"")):z,t=await C.FF.searchActions.load(),o=await t.searchVisibleSpaceUsers({environment:R,query:$,membersOnly:!1}),n=(0,d.A6)(null==_?void 0:_.value).reduce(((e,t)=>(t&&(0,d.S3)(t)&&(0,h.IWo)(t)&&e.push(t[1]),e)),[]);let i=0,r=o[i];const a=[];for(;r&&a.length<20;)n.includes(r.id)||a.push(r.id),i+=1,r=o[i];return{valueResults:e,userResults:a}}),[R,$,z,_],{debounce:M.vp}),J=(0,n.useCallback)((()=>{G(""),q.setState({...q.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),[q]),ee=(0,n.useCallback)((e=>{const t=H(e,"last");w({type:"simple",value:(0,d.iC)(t)}),J()}),[w,J,H]),te=(0,n.useCallback)((()=>{ee(U.slice(0,U.length-1))}),[U,ee]),oe=(0,n.useCallback)((e=>{null==ee||ee((0,d.Ck)(U,e))}),[U,ee]);if(!A||!L)return;const ne=Boolean(P&&U.length>=P),ie=f.oA(U.map(((e,t)=>"string"==typeof e||"boolean"==typeof e?null:(0,h.IWo)(e)?(0,I.jsx)(Z.Z,{handleRemoveToken:oe,token:e},t):(0,h.wjk)(e)?(0,I.jsx)(F,{automationContextStore:L,handleRemoveToken:oe,isDisabled:ne,token:e},t):null))),re=new Set(f.oA(U.map((e=>(0,d.S3)(e)&&(0,h.wjk)(e)&&(0,h.vmO)(e).id)))),ae=new Set(f.oA(U.map((e=>(0,d.S3)(e)&&(0,h.IWo)(e)&&(0,h.zEN)(e))))),se=f.oA(((null===(t=X.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>{const t=e.kind===u.yp.ContextValue&&e.id||"";if(!t||!re.has(t))return{action:"append",automationContextStore:L,currentSimpleFormulaValueTokens:U,isDisabled:ne,id:t,getRecordModel:E,setCurrentTokens:ee,value:e}}))),le=f.oA(((null===(o=X.value)||void 0===o?void 0:o.userResults)||[]).map((e=>{if(ae.has(e))return;const t=(0,h.tEo)(e);return{action:()=>{ee([...U,t]),Y&&a.default.afterNextFlush((()=>{V()}))},annotation:t,getRecordModel:E,id:e,isDisabled:ne,userId:e}}))),ce=[...se,...le],ue=(0,I.jsx)(b.ZP,{style:{maxHeight:6*parseInt(b.go,10)},disabled:ne,dontShowBorderBottom:N.isAndroid,focus:!N.isMobile||void 0,focusAfterAnimation:!0,format:b.UR.FilterValue,onChange:e=>G(e.target.value),onClearButtonClick:()=>ee([]),onRemoveLastToken:te,placeholder:D.formatMessage(S.s.personSearchPlaceholder),showClearButton:B,tokens:ie,value:$}),de=(0,I.jsx)(v.Z,{value:_,onChange:w});return{errorMessage:X.error&&D.formatMessage(S.s.somethingWentWrong),footer:Q&&de,header:D.formatMessage(S.s.genericMenuHeader),isLoading:!X.value&&!X.error,menuListStore:q,noResultsMessage:0===ce.length&&X.value&&D.formatMessage(S.s.noResults),searchInput:ue,userItems:le,valueItems:se}}({formulaTypecheckContextValues:o,formulaValueContext:A,limit:w,onChange:E,onClose:H,showClearButton:U,unlimitedCurrentSimpleFormulaValueTokens:t,value:G})||{},ae=[...(0,n.useMemo)((()=>re&&$?re.map((e=>{const{annotation:t,itemAction:o}=(0,W.A)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:o=>(0,I.jsx)(O.Z,{annotation:t,automationContextStore:e.automationContextStore,disabled:e.isDisabled,menuArgs:o}),action:o}})):[]),[$,re]),...(0,n.useMemo)((()=>ie?ie.map((e=>({key:e.userId,render:t=>(0,I.jsx)(Q,{annotation:e.annotation,disabled:e.isDisabled,getRecordModel:P||e.getRecordModel,menuArgs:t}),action:e.action}))):[]),[P,ie])],se=[];let le;ae.length>0&&se.push({key:"users",render:e=>(0,I.jsx)(D.Z,{...e}),items:ae}),le=q.isMobile?{menuType:B.og.Modal,right:(0,I.jsx)(N.DoneMenuText,{}),onClickRight:H}:{menuType:B.og.Popup,maxHeight:"50vh",width:260,footer:X&&(0,I.jsx)(D.Z,{topBorder:!0,children:X}),disableHeaderBorder:!0};const ce=void 0!==(null==V?void 0:V.header)?V.header:(0,I.jsx)(D.Z,{style:{paddingBottom:0},title:J}),ue=(0,I.jsxs)("div",{style:{paddingBlockEnd:6,borderBlockEnd:`1px solid ${r.ZP.dividerColor}`},children:[!q.isMobile&&ce,z&&ne]});return(0,I.jsxs)(K.Z,{...le,header:ue,children:[Y&&(0,I.jsx)(D.Z,{children:(0,I.jsx)(R.Z,{title:Y})}),oe&&(0,I.jsx)(D.Z,{children:(0,I.jsx)(R.Z,{title:oe})}),ee&&(0,I.jsx)(D.Z,{children:(0,I.jsx)(L.Z,{})}),ae.length>0&&(0,I.jsx)(_.Z,{type:_.i.Vertical,initialFocus:0,sections:se,store:te})]})}},796192:(e,t,o)=>{o.d(t,{L:()=>i});var n=o(724405);function i(){return(0,n.yK)((e=>({disabledMenuItem:{cursor:"not-allowed",opacity:.4}})),[])}},230387:(e,t,o)=>{o.d(t,{s:()=>n});const n=(0,o(709291).defineMessages)({back:{defaultMessage:"Back",id:"formulas.SimpleFormulaValuePicker.back"},valuesFromThisAutomation:{defaultMessage:"From this automation",id:"formulas.SimpleFormulaValuePicker.valuesFromThisAutomation"},pickADate:{defaultMessage:"Pick a date",id:"formulas.SimpleFormulaValuePicker.pickADate"},clear:{defaultMessage:"Clear",id:"formulas.SimpleFormulaValuePicker.clear"},unchecked:{defaultMessage:"Unchecked",id:"formulas.SimpleFormulaValuePicker.checkbox.unchecked"},checked:{defaultMessage:"Checked",id:"formulas.SimpleFormulaValuePicker.checkbox.checked"},checkboxOptions:{defaultMessage:"Checkbox options",id:"formulas.SimpleFormulaValuePicker.checkbox.sectionHeader"},searchPlaceHolder:{defaultMessage:"Select one or more options…",id:"formulas.SimpleFormulaValuePicker.select.searchPlaceholder"},selectOptionsSectionHeader:{defaultMessage:"Select an option",id:"formulas.SimpleFormulaValuePicker.select.sectionHeader"},noResults:{defaultMessage:"No results",id:"formulas.simpleValuePicker.noResults"},pageSearchPlaceholder:{defaultMessage:"Search for one or more pages…",id:"formulas.SimpleFormulaValuePicker.pages.searchPlaceholder"},pages:{defaultMessage:"Pages",id:"formulas.SimpleFormulaValuePicker.pages.sectionHeader"},somethingWentWrong:{defaultMessage:"Something went wrong.",id:"formulas.simpleValuePicker.errorMessage"},personSelect:{defaultMessage:"Select...",id:"formulas.SimpleFormulaValuePicker.chooseAValue"},personSearchPlaceholder:{defaultMessage:"Search for one or more people…",id:"formulas.SimpleFormulaValuePicker.people.searchPlaceholder"},customFormula:{defaultMessage:"Custom formula",id:"formulas.SimpleFormulaValuePicker.customFormula"},peopleInWorkspace:{defaultMessage:"People",id:"formulas.SimpleFormulaValuePicker.people.sectionHeader"},genericMenuHeader:{defaultMessage:"Set property to",id:"formulas.SimpleFormulaValuePicker.genericMenuHeader"}})},186538:(e,t,o)=>{o.d(t,{ZP:()=>F,uV:()=>_});o(757658);var n=o(667294),i=o(800480),r=o(886628),a=o(724405),s=o(841892),l=o(977657),c=o(982114),u=o(536591),d=o(890199),p=o(435840),m=o(155159),g=o(709291),h=o(653965),y=o(940470),f=o(401898),x=o(454642),S=o(389475),v=o(612457),b=o(433929),C=o(18441),k=o(80444),M=o(530874),j=o(868016),T=o(552275),A=o(268894),P=o(568785),w=o(672495),V=o(785893);const I=(0,g.defineMessages)({channelSearchPlaceholder:{id:"notificationRuleSettings.selectChannelView.searchInput.placeholder",defaultMessage:"Search…"}});function F(e){const{currentNotificationChannel:t,onNotificationChannelSelect:o,onClose:c,onNewSlackAccountAdded:d,renderMenu:m,channelFilter:x}=e,F=(0,i.O7)(),{isMobile:K}=(0,i.Fy)(),R=(0,r.VK)((()=>M.Z.completeSlackAuthentications.state),[]),N=e.currentExternalAuthentication??h.Ps(R);n.useEffect((()=>{N&&_({environment:F,botId:N.id,spaceId:N.space_id})}),[F,N]);const[D,L]=n.useState(""),{loadedChannelsForAccount:O,isLoading:W}=(0,r.VK)((()=>{if(!N)return{loadedChannelsForAccount:[],isLoading:!1};const e=j.Z.getStateForBot(N.id);return{loadedChannelsForAccount:Object.values(e.channels),isLoading:e.fetching}}),[N]),E=(0,r.VK)((()=>M.Z.integrations.state.find((e=>e.id===l.nO))),[]),H=(0,r.VK)((()=>{var e;return null===(e=k.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),U=n.useCallback((e=>{N&&o(e,N),c()}),[o,N,c]),z=(0,a.yK)((e=>({icon:{marginLeft:8,width:12,height:12,color:e.lightTextColor},container:{backgroundColor:e.popoverBackground,marginTop:12,marginBottom:6},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,color:e.regularIconColor}})),[]),$=n.useCallback((e=>{const{channel:o}=e;return{key:o.id,render:e=>(0,V.jsx)(T.Z,{...e,icon:B({channel:o,styles:z.icon}),desktopIconStyle:{width:8},title:o.name,right:o.id===(null==t?void 0:t.id)&&(0,u.e)(z.icon)}),action:()=>{U(o)}}}),[U,z.icon,t]),{publicChannels:G,privateChannels:q,personalChannels:Y}=n.useMemo((()=>function(e,t){const o=[],n=[],i=[];for(const r of e)t&&!t(r)||("public"===r.type?o.push(r):"private"===r.type?n.push(r):"me"===r.type?i.push(r):(0,f.t1)(r.type));return{publicChannels:o,privateChannels:n,personalChannels:i}}(O,x)),[x,O]),Q=n.useCallback((()=>G.map((e=>({menuListItem:$({channel:e}),channelName:e.name})))),[G,$]),X=n.useCallback((()=>q.map((e=>({menuListItem:$({channel:e}),channelName:e.name})))),[q,$]),J=n.useCallback((()=>Y.map((e=>({menuListItem:$({channel:e}),channelName:e.name})))),[Y,$]),ee=n.useCallback((()=>Q().map((e=>{let{menuListItem:t,channelName:o}=e;if(Z({channelName:o,query:D}))return t})).filter(f.$K)),[Q,D]),te=n.useCallback((()=>X().map((e=>{let{menuListItem:t,channelName:o}=e;if(Z({channelName:o,query:D}))return t})).filter(f.$K)),[X,D]),oe=n.useCallback((()=>J().map((e=>{let{menuListItem:t,channelName:o}=e;if(Z({channelName:o,query:D}))return t})).filter(f.$K)),[J,D]),ne=n.useCallback((()=>{if(!N)return[];const e=[],t=ee(),o=te(),n=oe();return n.length>0&&e.push({key:"personal-channels",render:e=>(0,V.jsx)(w.Z,{...e,title:(0,C.jg)(N).organizationName}),items:n}),t.length>0&&e.push({key:"public-channels",render:e=>(0,V.jsx)(w.Z,{...e,topBorder:n.length>0,title:0===n.length&&(0,C.jg)(N).organizationName}),items:t}),o.length>0&&e.push({key:"private-channels",render:e=>(0,V.jsx)(w.Z,{...e,topBorder:t.length>0,title:0===n.length&&t.length>0&&(0,C.jg)(N).organizationName}),items:o}),e}),[ee,te,oe,N]);if(!N||!E)return null;const ie=[{key:"search-input-section",items:[{key:"search-input-item",action:()=>{},render:e=>(0,V.jsx)("div",{children:(0,V.jsx)(A.ZP,{...e,inputLeft:(0,V.jsx)(A.f_,{icon:p.R}),inputRight:(0,V.jsx)(v.Z,{show:W,showDelay:500,showHold:300,render:e=>e&&(0,V.jsx)(P.Z,{style:{marginRight:2}})}),showClearButton:!0,placeholder:b.default.formatMessage(I.channelSearchPlaceholder),focusInitial:!K,value:D,onChange:e=>{L(e.target.value)}})})}],render:e=>(0,V.jsx)(w.Z,{...e})},...ne()];return t||ie.push({key:"add-another-slack-account-section",items:[{key:"add-another-slack-account-item",action:async()=>{if(!H)return;const e=await S.hM({environment:F,integration:E,spaceId:H,from:"collection_view_settings"});y.x.isFail(e)||d()},render:e=>(0,V.jsx)(T.Z,{...e,icon:(0,V.jsx)("img",{src:s.Z.images.externalIntegrations.slackIconPng,style:{width:18,height:"auto"}}),title:(0,V.jsx)(g.FormattedMessage,{id:"notificationRuleSettings.selectChannelView.setupAnotherSlackAccount.label",defaultMessage:"Add another Slack account"})})}],render:e=>(0,V.jsx)(w.Z,{...e,topBorder:!0})}),(0,V.jsx)(V.Fragment,{children:m(ie)})}function Z(e){const{channelName:t,query:o}=e;return 0===o.length||t.toLocaleLowerCase().indexOf(o.trim().toLocaleLowerCase())>=0}function B(e){const{channel:t,styles:o}=e;return"private"===t.type?(0,d.b)(o):"me"===t.type?(0,c.p)(o):(0,m.J)(o)}const K=15e3;async function _(e){const{environment:t,botId:o,spaceId:n}=e,i=j.Z.getStateForBot(o);if(i.fetching||Date.now()-i.lastRefreshed<K)return;let r;for(j.Z.updateStateForBot(o,{fetching:!0,lastRefreshed:Date.now()});;){const e=await x.getExternalNotificationChannels(t,{botId:o,spaceId:n,cursor:r});if("success"!==e.type){console.error(e.error);break}{const t={};for(const o of e.data.channels)t[o.id]=o;if(j.Z.addChannelsForBot(o,t),r=e.data.cursor,!r)break}}j.Z.updateStateForBot(o,{fetching:!1})}},658812:(e,t,o)=>{o.d(t,{$K:()=>C,HF:()=>k,SC:()=>v,aO:()=>x,hL:()=>M,hY:()=>S,j3:()=>b});o(757658);var n=o(102647),i=o(471924),r=o(798963),a=o(709291),s=o(401898),l=o(547307),c=o(709953),u=o(210228),d=o(143627),p=o(730459),m=o(311335),g=o(741195),h=o(433929),y=o(206258);const f=(0,a.defineMessages)({automationDeleteConfirmationMessage:{id:"slackAutomations.remove.confirmation.message",defaultMessage:"Are you sure you want to delete {automationName}?"},automationDeleteAcceptLabel:{id:"slackAutomations.remove.confirmation.acceptLabel",defaultMessage:"Delete"},confirmDiscardChangesMessage:{id:"automations.confirmDiscardChanges.message",defaultMessage:"{hasName, select, true {Are you sure you want to discard {automationName}?} other {Are you sure you want to discard this automation?}}"},confirmDiscardChangesAccept:{defaultMessage:"Discard",id:"automations.confirmDiscardChanges.acceptLabel"}});function x(e){const{automationStore:t,collectionStore:o,environment:a,intl:l,from:m}=e;u.createAndCommit({environment:a,userAction:"collectionSettingsAutomationsActions.createDatabaseAutomation",perform:e=>{u.applyOperation({store:o,operation:{pointer:o.pointer,path:["format","automation_ids"],command:"listAfter",args:{id:t.id}},transaction:e});const n=y.Mz.createChildStore(o,t.pointer),s=t.getActionStores();for(const t of s){const o=t.getType();o&&d.addAutomationAction({actionId:t.id,actionType:o,automationStore:n,config:t.getConfig(),environment:a,intl:l,transaction:e})}c.ae({environment:a,inMemoryRecordCache:o.inMemoryRecordCache,table:r.cv,transaction:e,value:{action_ids:t.getActionIds(),alive:!0,id:t.id,parent_id:o.id,parent_table:o.table,properties:{name:t.getName()},space_id:o.getSpaceId(),status:"active",trigger:{id:i.Il(),event:t.getEventConfiguration()??{pagesAdded:!1,pagePropertiesEdited:{type:"none"},source:{pointer:o.getSpaceShardedPointer(),type:"collection"}},type:"event"}}})}});const g=t.getModel();if((0,s.$K)(g)){const e=(0,p.mc)(a),o=n.TY({automationModel:g,getRecordModel:t.getRecordModel}),i=m?{feature:{id:o.automation_id,from:m,type:"automation"}}:{};n.T0(e,{...o,...i})}}function S(e){const{automationStore:t,collectionStore:o,environment:i}=e;u.createAndCommit({environment:i,userAction:"collectionSettingsAutomationsActions.saveDatabaseAutomation",perform:e=>{const n=y.Mz.createChildStore(o,t.pointer),i=t.getName(),r=n.getKeyStore("properties");c.sW({store:r,data:{name:i},transaction:e});const a=t.getActionStores(),s=n.getTriggerStore();if(c.sW({store:s,data:{type:"event"},transaction:e}),(0,m.Xd)(n)&&(0,m.Xd)(t)){const o=n.getTriggerStore().getKeyStore("event");c.sW({store:o,data:t.getTriggerStore().getKeyStore("event").getValue(),transaction:e})}const l=[];for(const t of a){const o=t.getModel();if(!o)continue;const i=y.zq.createChildStore(n,t.pointer);c.sO({store:i,value:{alive:!0,config:o.getConfig(),id:o.id,parent_id:n.id,parent_table:n.table,space_id:n.getSpaceId(),type:o.type},transaction:e}),l.push(t.id)}c.sW({store:n,data:{action_ids:l},transaction:e})}});const r=t.getModel();if((0,s.$K)(r)){const e=(0,p.mc)(i),o=n.TY({automationModel:r,getRecordModel:t.getRecordModel});n.r4(e,o)}}async function v(e){const{intl:t,environment:o,collectionStore:n,existingAutomationStore:i,onDelete:r}=e,a=i.getNameWithDefault(t);(await l.confirmUserActionV2({message:t.formatMessage(f.automationDeleteConfirmationMessage,{automationName:a}),acceptLabel:t.formatMessage(f.automationDeleteAcceptLabel)})).accept&&(!function(e){const{environment:t,collectionStore:o,existingAutomationStore:n}=e;u.createAndCommit({environment:t,userAction:"collectionSettingsAutomationsActions.deleteAutomation",perform:e=>{const i=o.getFormatStore().getKeyStore("automation_ids"),r=y.Mz.createChildStore(o,n.pointer);u.applyOperation({store:i,operation:{pointer:i.pointer,path:i.path,command:"listRemove",args:{id:r.id}},transaction:e}),d.deleteAutomation({automationStore:r,environment:t,transaction:e})}})}({environment:o,collectionStore:n,existingAutomationStore:i}),null==r||r())}function b(e){const{automationStore:t,collectionStore:o,environment:n}=e;u.createAndCommit({environment:n,userAction:"collectionSettingsAutomationsActions.disableAutomation",perform:e=>{const i=y.Mz.createChildStore(o,t.pointer);d.disableAutomation({automationStore:i,environment:n,transaction:e})}})}function C(e){const{automationStore:t,collectionStore:o,environment:n}=e;u.createAndCommit({environment:n,userAction:"collectionSettingsAutomationsActions.enableAutomation",perform:e=>{const i=y.Mz.createChildStore(o,t.pointer);d.enableAutomation({automationStore:i,environment:n,transaction:e})}})}function k(e){const{automationStore:t,collectionStore:o,environment:n}=e,i=o.getFormatStore().getKeyStore("automation_ids"),a=(0,g.TS)({environment:n,table:r.cv,spaceId:t.getSpaceId()});u.createAndCommit({environment:n,userAction:"",perform:e=>{d.duplicateAutomation({environment:n,sourceAutomationStore:t,targetAutomationId:a,transaction:e}),u.applyOperation({store:i,operation:{pointer:i.pointer,path:i.path,command:"listAfter",args:{id:a}},transaction:e})}})}async function M(e){const{automationName:t,hasPendingChanges:o}=e;if(!o)return!0;return(await l.confirmUserActionV2({acceptLabel:h.default.formatMessage(f.confirmDiscardChangesAccept),message:h.default.formatMessage(f.confirmDiscardChangesMessage,{automationName:t,hasName:Boolean(t)})})).accept}},620776:(e,t,o)=>{o.d(t,{o:()=>s});o(667294);var n=o(724405),i=o(531701),r=o(137810),a=o(785893);function s(e){const{children:t,icon:o,shouldTruncateChildren:s}=e,l=(0,n.yK)((e=>{const t=(0,i.KR)(e,void 0);return{iconWrap:{flex:"0 0 auto"},textWrap:{...s?r.Z.textOverflowStyle:{},flex:"1 1 auto"},wrap:{backgroundColor:t.backgroundColor,borderRadius:12,color:t.textColor,display:"inline-flex",gap:4,minWidth:s?50:void 0,padding:"0 8px"}}}),[s]);return(0,a.jsxs)("span",{style:l.wrap,children:[o&&(0,a.jsx)("span",{"aria-hidden":"true",style:l.iconWrap,children:o}),(0,a.jsx)("span",{style:l.textWrap,children:t})]})}},932130:(e,t,o)=>{o.d(t,{oC:()=>Be,ZD:()=>Ke,sY:()=>Fe});o(757658);var n=o(667294),i=o(800480),r=o(886628),a=o(724405),s=o(53196),l=o(937612),c=o(798963),u=o(606287),d=o(213493),p=o(709291),m=o(401898),g=o(137810),h=o(805149),y=o(164964),f=o(210228),x=o(793174),S=o(576205),v=o(536591),b=o(654497),C=o(653965),k=o(694166),M=o(820616),j=o(668155),T=o(110906),A=o(73657),P=o(552275),w=o(231945),V=o(268894),I=o(478140),F=o(632163),Z=o(840721),B=o(731278),K=o(672495),_=o(526388),R=o(623879),N=o(311335),D=o(460709),L=o(637034),O=o(825464),W=o(61766),E=o(206258),H=o(435294),U=o(785893);function z(e){const{selectedSourcePointer:t,collectionContextStore:o,onSelect:s,disabled:l}=e,{isMobile:c}=(0,i.Fy)(),u=(0,p.useIntl)(),d=(0,i.O7)(),[g,h]=n.useState(""),y=(0,r.VK)((()=>o.collectionStore()),[o]),f=(0,r.VK)((()=>o.collectionViewBlockStore()),[o]),x=(0,r.VK)((()=>f&&y?f.getCollectionViewStores().filter((e=>{var t;const o=null===(t=e.getCollectionStore())||void 0===t?void 0:t.pointer;return(null==o?void 0:o.id)===y.id})):[]),[f,y]),S=(0,r.VK)((()=>{if(!y)return[];let e;t&&"collection_view"===t.table&&(e=E.Xr.createChildStore(y,t));return C.mN([...x,e].filter(m.$K),(e=>{let{id:t}=e;return t})).filter((e=>(0,T.D)(e,g)))}),[y,x,g,t]),z=(0,r.VK)((()=>{if(y&&(0,R.r_)({collectionStore:y,environment:d,intl:u,queryForFilter:g}))return function(e){const{collectionStore:t,environment:o,selectedSourcePointer:n,onSelect:i,isMobile:r,intl:a}=e,s=t.getIcon(),l=(0,L.vU)({environment:o,intl:a,store:t}),c=n&&"collection"===n.table&&n.id===t.id,u=t.getSpaceShardedPointer(),d={key:t.id,action:()=>{u&&i(u)},render:e=>(0,U.jsx)(P.Z,{...e,icon:s&&(0,U.jsx)(B.Z,{isEmptyPage:!1,size:r?18:16,disabled:!0,icon:s}),title:l,caption:(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.collection.caption",defaultMessage:"Any page in this database",values:{collectionName:l}}),right:c&&(0,v.e)({width:12,height:"auto"})})};return{key:"collection",items:[d],render:e=>(0,U.jsx)(K.Z,{...e,topBorder:!0})}}({collectionStore:y,environment:d,selectedSourcePointer:t,onSelect:s,isMobile:c,intl:u})}),[y,d,u,c,s,g,t]),q=(0,r.VK)((()=>y&&f&&x?function(e){const{blockStore:t,filteredCollectionViewStores:o,collectionStore:n,selectedSourcePointer:i,onSelect:r,intl:a}=e,s=n.getSchema(),l=o.map((e=>{const o=e.getSpaceShardedPointer();if(e.isDefined()&&o){const l=i&&"collection_view"===i.table&&i.id===o.id,c=(0,N.rU)({collectionViewStore:e,collectionSchema:s}),u=(0,m.$K)(c),d=e.getType(),g=e.getFormat().collection_view_icon,h=e.getName(),y=(o,n)=>(0,U.jsx)(P.Z,{...o,...n,icon:(0,U.jsx)(M.F,{color:"lightGray",viewType:d,viewIcon:g}),title:(0,U.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4},children:[(0,U.jsx)(j.Z,{collectionViewType:d,collectionViewName:h}),u&&l&&(0,b.t)({width:16,height:"auto"})]}),caption:(0,U.jsx)(G,{blockStore:t,collectionViewStore:e,intl:a,collectionSchema:s,referencesIncompatibleProperties:u}),right:l&&(0,v.e)({width:12,height:"auto"}),disabled:u,disabledFeedback:u});let f;if(u&&c){var n;const e=null===(n=s[c])||void 0===n?void 0:n.type,t=e?R.SO[e]:void 0,o=t?(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.specific",defaultMessage:"{propertyTypeName} properties are not supported",values:{propertyTypeName:t}}):(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.default",defaultMessage:"Some properties are not supported"});f=e=>(0,U.jsx)(_.Z,{placement:O.u.Right,renderTooltip:()=>o,render:t=>y(e,t)})}else f=y;return{key:e.id,action:()=>{r(o)},render:f}}}));return[...l].filter(m.$K)}({blockStore:f,collectionStore:y,filteredCollectionViewStores:S,selectedSourcePointer:t,onSelect:s,intl:u}):[]),[f,y,x,S,u,s,t]),Y=function(e){const{menuListItems:t}=e;if(0===t.length)return;return{key:"collection-views",items:t,render:e=>(0,U.jsx)(K.Z,{...e,topBorder:!0})}}({menuListItems:q}),Q={key:"search",items:[{key:"search_item",action:()=>{},render:()=>(0,U.jsx)(V.ZP,{value:g,focus:!0,style:ee.searchBar,textWrapperStyle:ee.searchText,onChange:e=>h(e.target.value),placeholder:u.formatMessage({defaultMessage:"Search for a view...",id:"collectionViewSelect.viewSearch.label"})})}],render:e=>(0,U.jsx)(K.Z,{...e})};let X;(0,m.$K)(z)||(0,m.$K)(Y)||(X={key:"no-results-section",items:[{key:"no-results-item",action:C.ZT,render:()=>(0,U.jsx)(A.Z,{caption:(0,U.jsx)(p.FormattedMessage,{defaultMessage:"No results",id:"collectionViewSelect.noResults.title"})})}],render:e=>(0,U.jsx)(K.Z,{...e,topBorder:!0})});const J=[Q,z,Y,X].filter(m.$K),ee=function(e){return(0,a.yK)((t=>({button:{marginTop:8},buttonPopup:{width:e?void 0:230},searchBar:{marginTop:8,marginBottom:8},searchText:{marginLeft:8,marginRight:8},buttonRight:{color:t.selectLightGray[500]},menuItemTextWrapper:{...e?{marginLeft:12}:{},minWidth:"auto"}})),[e])}(c),te=(0,r.qz)(void 0,W.Z),oe=(0,H.d)();if(!y)return null;const ne=(0,U.jsx)($,{pointer:t,collectionStore:y,intl:u});return(0,U.jsx)(w.ZP,{alignmentToOrigin:w.vR.End,placementToOrigin:w.pO.Bottom,popupType:oe,style:ee.buttonPopup,buttonPopupStore:te,render:e=>{let t;return t=c?{menuType:D.og.Modal,title:(0,U.jsx)(p.FormattedMessage,{id:"collectionSettings.editAutomationView.notifyForOption.title",defaultMessage:"For pages in"}),right:(0,U.jsx)(Z.DoneMenuText,{}),onClickRight:()=>{e.close()}}:{menuType:D.og.Popup,width:230,maxHeight:"50vh"},(0,U.jsx)(I.Z,{...t,children:(0,U.jsx)(F.Z,{type:F.i.Vertical,sections:J,initialFocus:0,onAccept:()=>{e.close()}})})},renderOrigin:e=>(0,U.jsx)(k.Z,{title:(0,U.jsx)(p.FormattedMessage,{id:"collectionSettings.editAutomationView.notifyForOption.title",defaultMessage:"For pages in"}),showChevron:!0,right:ne,rightStyle:{flexShrink:1},rotateChevron:te.state.open,disabled:l,textWrapperStyle:ee.menuItemTextWrapper,...e})})}function $(e){const{pointer:t,collectionStore:o,intl:n}=e,s=(0,i.O7)(),l=(0,a.yK)((e=>({warningIcon:{width:16,height:"auto",color:e.accentColors.orange[400]},titleContainer:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4,flex:"1 1 auto",minWidth:0},title:{...g.Z.textOverflowStyle},errorText:{color:e.errorText,fontWeight:g.Z.fontWeight.medium}})),[]),c=(0,r.VK)((()=>t?E.t1.createChildStore(o,t):void 0),[o,t]),d=(0,r.VK)((()=>c?(0,L.vU)({environment:s,intl:n,store:c}):(0,U.jsx)("span",{style:l.errorText,children:(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.source.missing",defaultMessage:"Select database"})})),[s,n,l.errorText,c]),h=(0,r.VK)((()=>{if(!c||c.table===u.vF)return!1;const e=o.getSchema();return(0,m.$K)((0,N.rU)({collectionViewStore:c,collectionSchema:e}))}),[o,c]);return(0,U.jsxs)("div",{style:l.titleContainer,children:[h&&(0,b.t)(l.warningIcon),(0,U.jsx)("span",{style:l.title,children:d})]})}function G(e){const{blockStore:t,collectionViewStore:o,intl:n,collectionSchema:a,referencesIncompatibleProperties:s}=e,l=(0,i.O7)(),c=(0,r.VK)((()=>!o.getAlive()),[o]),u=(0,r.VK)((()=>{const e=o.getParentBlockStore();if(e)return t.id!==e.id?(0,L.vU)({environment:l,intl:n,store:e}):void 0}),[t.id,o,n,l]),d=(0,r.VK)((()=>{const e=o.getQuery(a);return(0,S.OH)({propertyFilters:o.getPropertyFiltersStore().getValue()??[],combinatorFilter:null==e?void 0:e.filter,schema:a}).reduce(((e,t)=>{if((0,S.aN)(t))return e+1;return e+(t.filters??[]).length}),0)}),[a,o]);return s?(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.collectionView.unsupportedView",defaultMessage:"Not supported"}):c?(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.collectionView.deletedView",defaultMessage:"<emphasis>View not found.</emphasis>",values:{emphasis:e=>(0,U.jsx)("em",{children:e})}}):u?(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.collectionView.captionDifferentParent",defaultMessage:"<emphasis>View configured in {externalParentBlockName}</emphasis>",values:{emphasis:e=>(0,U.jsx)("em",{children:e}),externalParentBlockName:u}}):0===d?(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.collectionView.captionWithNoFilters",defaultMessage:"Any page in this view"}):(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.collectionView.captionWithFilters",defaultMessage:"{ruleCount, plural, one {{ruleCount} filter} other {{ruleCount} filters}}",values:{ruleCount:d}})}var q=o(409015),Y=o(891494),Q=o(312455);var X=o(74404),J=o(497372),ee=o(203386),te=o(158297),oe=o(741195),ne=o(563474),ie=o(484398),re=o(80444),ae=o(319385),se=o(658812),le=o(102647);var ce=o(613273);var ue=o(815145),de=o(665422),pe=o(16184),me=o(463306),ge=o(421202),he=o(321862),ye=o(489728),fe=o(942402),xe=o(730459),Se=o(849117),ve=o(367669),be=o(44041);const Ce=(0,p.defineMessages)({automationIncompatibleViewFilterAndOwner:{defaultMessage:"This automation may not work because the view has a non-supported filter",id:"AutomationHeaderView.incompatibleCollectionViewFilter.owner"},automationPublicAccess:{defaultMessage:"This automation is part of a public page",id:"AutomationHeaderView.automationPublicAccess"},automationUpgrade:{defaultMessage:"<anchor-upsell>Upgrade</anchor-upsell> to edit this automation or create your own",id:"AutomationHeaderView.automationUpgrade"},automationEditOnSite:{defaultMessage:"This automation can only be edited on notion.com",id:"AutomationHeaderView.automationEditOnSite"},automationSlackNoPermissions:{defaultMessage:"Ask {user} to edit this automation",id:"AutomationHeaderView.automationSlackNoPermissions"},automationSlackWithPermissions:{defaultMessage:"Ask {user} to edit this automation or <anchor-delete>delete</anchor-delete> it when necessary",id:"AutomationHeaderView.automationSlackWithPermissions"},automationMissingPermissionsNoPermissions:{defaultMessage:"You must have full access to target databases in this automation to edit it",id:"AutomationHeaderView.automationMissingPermissionsNoPermissions"},automationMissingPermissionsWithPermissions:{defaultMessage:"You must have full access to target databases in this automation to edit it or <anchor-delete>delete</anchor-delete> it when necessary",id:"AutomationHeaderView.automationMissingPermissionsWithPermissions"},automationGenericFullAccess:{defaultMessage:"You must have full access to this database to edit automations",id:"AutomationHeaderView.automationGenericFullAccess"},automationCollectionInTrashedPage:{defaultMessage:"This database is in the trash and cannot be edited.",id:"AutomationHeaderView.automationCollectionInTrash"},automationCollectionInTrashedPageViewDeletedPageButton:{defaultMessage:"View deleted page",id:"AutomationHeaderView.automationCollectionInTrashedPageViewDeletedPageButton"}});function ke(e){const{automationStore:t,automationPermissionScope:o,collectionStore:a,onDelete:s,referencesIncompatibleCollectionViewFilter:c}=e,u=(0,i.O7)(),d=(0,Y.X)({automationStore:t,collectionStore:a}),m=(0,r.VK)((()=>null==d?void 0:d.context.type),[d]),g=(0,r.VK)((()=>Boolean((0,ve.IJ)(u,t))),[t,u]),h=(0,r.VK)((()=>(0,Se.$5)(null==d?void 0:d.context)),[d]),y=(0,r.VK)((()=>(0,N.R4)(t)),[t]),f=(0,r.VK)((()=>{const e=(0,me.DW)(a.pointer,a.getRecordModel),t=(0,me.OJ)(e);if(!t||t.table!==ge.iU)return;const o=t.pointer;return E.G.createChildStore(a,o)}),[a]),x=(0,r.VK)((()=>ae.default.checkGate({gateName:"prevent_edits_trash"})),[]),S=(0,n.useCallback)((()=>{be.y(u,{from:"database_automation_settings_header_message",for:"plus"})}),[u]),v=Ae();if(x&&f)return(0,U.jsx)(Te,{icon:(0,U.jsx)("div",{style:v.lockedIconWrap,children:(0,l.y)(v.lockedIcon)}),children:(0,U.jsxs)("div",{children:[(0,U.jsx)("p",{style:v.paragraph,children:(0,U.jsx)(p.FormattedMessage,{...Ce.automationCollectionInTrashedPage})}),(0,U.jsx)(ye.Z,{onClick:()=>function(e,t){(function(e){(0,xe.K4)(e,"view_deleted_page_from_automation_edit_menu")})(t),he.r({environment:t,store:e,pageVisitSource:ue.tY.LinkInPage})}(f,u),style:v.restoreButton,isLightGray:!0,children:(0,U.jsx)(p.FormattedMessage,{...Ce.automationCollectionInTrashedPageViewDeletedPageButton})})]})});if(g)return(0,U.jsx)(Me,{icon:(0,U.jsx)("div",{style:v.lockedIconWrap,children:(0,pe.Q)(v.lockedIcon)}),children:(0,U.jsx)("p",{style:v.paragraph,children:(0,U.jsx)(p.FormattedMessage,{...Ce.automationPublicAccess})})});if("sufficient"!==h.editPermissionStatus&&"free_workspace"===h.reason)return(0,Se.Rr)({contextType:m,environment:u})?(0,U.jsx)(je,{icon:(0,U.jsx)("div",{style:v.boltIconWrap,children:(0,de.K)(v.boltIcon)}),children:(0,U.jsx)("p",{style:v.paragraph,children:(0,U.jsx)(p.FormattedMessage,{...Ce.automationUpgrade,values:{"anchor-upsell":e=>(0,U.jsx)(fe.Z,{onClick:S,style:v.link,children:e})}})})}):(0,U.jsx)(Me,{icon:(0,U.jsx)("div",{style:v.lockedIconWrap,children:(0,pe.Q)(v.lockedIcon)}),children:(0,U.jsx)("p",{style:v.paragraph,children:(0,U.jsx)(p.FormattedMessage,{...Ce.automationEditOnSite})})});if("sufficient"!==h.editPermissionStatus&&"missing_permissions"===h.reason&&h.actionId){const e=y[h.actionId];return(0,U.jsx)(Me,{icon:(0,U.jsx)("div",{style:v.lockedIconWrap,children:(0,pe.Q)(v.lockedIcon)}),children:(0,U.jsx)("p",{style:v.paragraph,children:(0,U.jsx)(p.FormattedMessage,{..."readonly"===o?Ce.automationSlackNoPermissions:Ce.automationSlackWithPermissions,values:{"anchor-delete":e=>(0,U.jsx)(fe.Z,{onClick:s,style:v.link,children:e}),user:e}})})})}return"insufficient"===h.editPermissionStatus||"unknown"===h.editPermissionStatus?(0,U.jsx)(Me,{icon:(0,U.jsx)("div",{style:v.lockedIconWrap,children:(0,pe.Q)(v.lockedIcon)}),children:(0,U.jsx)("p",{style:v.paragraph,children:(0,U.jsx)(p.FormattedMessage,{...Ce.automationGenericFullAccess})})}):c?(0,U.jsx)(Me,{icon:(0,U.jsx)("div",{style:v.lockedIconWrap,children:(0,b.t)(v.warningIcon)}),children:(0,U.jsx)(p.FormattedMessage,{...Ce.automationIncompatibleViewFilterAndOwner})}):null}function Me(e){const{children:t,icon:o}=e,n=Ae();return(0,U.jsx)("div",{style:n.wrapWrap,children:(0,U.jsxs)("div",{style:n.wrap,children:[o&&(0,U.jsx)("div",{style:n.iconWrap,children:o}),(0,U.jsx)("div",{style:n.messageWrap,children:t})]})})}function je(e){const{children:t,icon:o}=e,n=Ae();return(0,U.jsx)("div",{style:n.wrapWrap,children:(0,U.jsxs)("div",{style:n.upsellWrap,children:[o&&(0,U.jsx)("div",{style:n.iconWrap,children:o}),(0,U.jsx)("div",{style:n.messageWrap,children:t})]})})}function Te(e){const{children:t,icon:o}=e,n=Ae();return(0,U.jsx)("div",{style:n.wrapWrap,children:(0,U.jsxs)("div",{style:n.trashPageWrap,children:[o&&(0,U.jsx)("div",{style:n.iconWrap,children:o}),(0,U.jsx)("div",{style:n.messageWrap,children:t})]})})}function Ae(){const{isMobile:e}=(0,i.Fy)();return(0,a.yK)((t=>({boltIcon:{fill:t.icon.yellow,height:"100%",width:"100%"},boltIconWrap:{height:20,padding:2,width:20},icon:{},iconWrap:{flexGrow:0,flexShrink:0},lockedIcon:{fill:t.icon.secondary,height:"100%",width:"100%"},lockedIconWrap:{background:t.fill.lightGray,borderRadius:4,height:20,padding:2,width:20},link:{color:t.text.uiBluePrimary},messageWrap:{flexGrow:1},paragraph:{color:t.text.secondary,fontSize:e?14:12,margin:0},restoreButton:{fontSize:e?14:12,fontWeight:g.Z.fontWeight.medium},warningIcon:{color:t.accentColors.orange[400],height:"100%",width:"100%"},warningIconWrap:{height:20,padding:2,width:20},wrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:10},wrapWrap:{padding:e?12:"0 12px 12px 12px"},upsellWrap:{alignItems:"center",background:t.accentColors.yellow[50],border:`1px solid ${t.accentColors.yellow[100]}`,borderRadius:6,display:"flex",flexDirection:"row",gap:10,padding:8},trashPageWrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:10,background:t.accentColors.gray[30],padding:8,borderRadius:6},personBadgeQuestionMark:{fill:t.mediumIconColor,width:16,height:"auto"},personBadgeQuestionMarkWrap:{height:20,padding:2,width:20}})),[e])}var Pe=o(824006),we=o(475024);const Ve=(0,p.defineMessages)({automationEnabledLabel:{defaultMessage:"Active",id:"collectionSettings.editAutomationView.automationEnabledLabel"},automationPausedLabel:{defaultMessage:"Paused",id:"collectionSettings.editAutomationView.automationPausedLabel"},automationEnabledHiddenAriaLabel:{defaultMessage:"Automation is active.",id:"collectionSettings.editAutomationView.automationEnabledHiddenAriaLabel"},automationPausedHiddenAriaLabel:{defaultMessage:"Automation is paused.",id:"collectionSettings.editAutomationView.automationPausedHiddenAriaLabel"},automationDisabledTooltip:{defaultMessage:"Ask {user} to resume this automation.",id:"collectionSettings.editAutomationView.automationDisabledTooltip"}});function Ie(e){const{automationId:t,automationOwner:o,disabled:i,isAutomationPaused:r,onPause:s,onResume:l}=e,c=`toggle-${t}`,u=(0,n.useCallback)((()=>{r?null==l||l():null==s||s()}),[r,l,s]),d=(0,a.yK)((e=>({labelWrap:{color:i?e.text.tertiary:r?e.text.secondary:e.text.primary,flex:"1 1 auto",fontSize:14},sectionWrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:6,marginBlockEnd:12},toggleWrap:{flex:"0 0 auto",paddingBlockStart:2}})),[i,r]),m=r?Ve.automationPausedLabel:Ve.automationEnabledLabel,g=r?Ve.automationPausedHiddenAriaLabel:Ve.automationEnabledHiddenAriaLabel;return(0,U.jsxs)("section",{style:d.sectionWrap,children:[(0,U.jsx)("div",{style:d.toggleWrap,children:(0,U.jsx)(_.Z,{disableTooltip:!i||!r,renderTooltip:()=>(0,U.jsx)(p.FormattedMessage,{...Ve.automationDisabledTooltip,values:{user:o}}),render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(Pe.Z,{disabled:i,inputId:c,on:!r,onClick:u})})})}),(0,U.jsx)("div",{style:d.labelWrap,children:(0,U.jsxs)("label",{htmlFor:c,children:[(0,U.jsx)("span",{"aria-hidden":!0,children:(0,U.jsx)(p.FormattedMessage,{...m})}),(0,U.jsx)("span",{style:we.jy,children:(0,U.jsx)(p.FormattedMessage,{...g})})]})})]})}const Fe=(0,p.defineMessages)({createAutomationViewMenuTitle:{id:"collectionSettings.createStatusAutomationView.menuTitle",defaultMessage:"New automation"},editAutomationViewMenuTitle:{id:"collectionSettings.editStatusAutomationView.menuTitle",defaultMessage:"Edit automation"},addTriggerLabel:{defaultMessage:"Add trigger",id:"collectionSettings.editAutomationView.triggerSection.placeholder"},addTriggerAriaLabel:{id:"collectionSettings.editAutomationView.addTrigger.iconButton",defaultMessage:"Add trigger"},addActionLabel:{defaultMessage:"Add action",id:"AutomationActionSelectButton.actionSection.addAction"},addActionAriaLabel:{id:"collectionSettings.editAutomationView.addAction.iconButton",defaultMessage:"Add action"},deleteButton:{id:"collectionSettings.editAutomationView.deleteButton",defaultMessage:"Delete"},triggerTitle:{defaultMessage:"When any of these occur",id:"collectionSettings.editAutomationView.triggerSection.title"},actionTitle:{defaultMessage:"Do this",id:"collectionSettings.editAutomationView.actionSection.title"},automationEnabledLabel:{defaultMessage:"Active",id:"collectionSettings.editAutomationView.automationEnabledLabel"},automationPausedLabel:{defaultMessage:"Paused",id:"collectionSettings.editAutomationView.automationPausedLabel"},automationEnabledHiddenAriaLabel:{defaultMessage:"Automation is active.",id:"collectionSettings.editAutomationView.automationEnabledHiddenAriaLabel"},automationPausedHiddenAriaLabel:{defaultMessage:"Automation is paused.",id:"collectionSettings.editAutomationView.automationPausedHiddenAriaLabel"},automationDisabledTooltip:{defaultMessage:"Ask {user} to resume this automation.",id:"collectionSettings.editAutomationView.automationDisabledTooltip"}});function Ze(){}function Be(e){return(0,U.jsx)(_e,{...e})}function Ke(e){return(0,U.jsx)(_e,{...e})}function _e(e){const{collectionSettingsStore:t,collectionContextStore:o,fullHeight:a,...u}=e,d=(0,n.useMemo)((()=>u),[]),{mode:g}=d,f=(0,p.useIntl)(),S=(0,ne.D)(),v=(0,i.O7)(),{isMobile:b}=(0,i.Fy)(),[C,M]=(0,n.useState)([]),j="create"===g,T=(0,ie.$)("CollectionSettingsEditAutomationView",{cacheFallback:v.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0}),A=(0,r.VK)((()=>re.default.state.currentUserStore),[]),P=(0,r.VK)((()=>null==A?void 0:A.userId),[A]),w=(0,r.VK)((()=>null==A?void 0:A.getDisplayName(f)),[A,f]),V=(0,r.VK)((()=>o.collectionStore()),[o]),I=(0,r.VK)((()=>null==V?void 0:V.getSpaceId()),[V]),Z=(0,r.VK)((()=>null==V?void 0:V.id),[V]),B=(0,r.VK)((()=>"on"===ae.default.getEligibleGroup({experimentId:"feature_settings_experiment",defaultGroup:"control",disableExposureLogging:!0})),[]),_=(0,n.useMemo)((()=>"update"===d.mode?d.automationId:(0,oe.TS)({environment:v,table:c.cv,spaceId:I})),[d,v,I]),R=(0,r.VK)((()=>o.aliveAutomationCountStore.state),[o]),D=(0,r.VK)((()=>{if(I&&V&&P)return new E.Mz(v,{id:_,table:c.cv,spaceId:I})}),[_,V,P,v,I]),L=(0,r.VK)((()=>(null==D?void 0:D.getStatus())??"disabled"),[D]),O="active"===L,W=(0,r.VK)((()=>(0,s.XO)(f,w)),[w,f]),H=(0,r.VK)((()=>{if(!I||!V||!P)return;const e={id:_,table:c.cv,spaceId:I},t=T.getEntry({pointer:e,userId:P});return t?t.value.value:N.sA({automationId:_,automationName:W,collectionStore:V,userId:P})}),[W,_,V,P,I,T]),{maybePersistedAutomationStore:z,maybePersistedTransactionActions:$,hasUnpersistedChanges:G}=(0,X.$)({automationId:_,spaceId:I,defaultValue:j?H:void 0,persist:!1}),Q=(0,r.VK)((()=>{if(z&&N.Xd(z))return z}),[z]),ue=(0,r.VK)((()=>(null==Q?void 0:Q.getName())??""),[Q]),de=(0,r.VK)((()=>{var e;return(null==Q||null===(e=Q.getOwnerStore())||void 0===e?void 0:e.getDisplayName(f))??""}),[f,Q]),pe=(0,r.VK)((()=>((null==Q?void 0:Q.getActionStores())??[]).filter((e=>e.isDefined()))),[Q]),me=(0,r.VK)((()=>{const e=null==V?void 0:V.getParentBlockStore();if(!e)return!1;return ae.default.checkGate({gateName:"prevent_edits_trash"})&&e.pathIsDead()}),[V]),ge=function(e){const{actionStores:t,automationStore:o,collectionStore:n,loadingStatus:i,mode:a}=e;return(0,r.VK)((()=>"create"===a?"edit":"resolved"===i&&o&&t&&n?(0,N.i1)({automationStore:o,actionStores:t,collectionStore:n})?"edit":(0,N.qM)({automationStore:o,collectionStore:n})?"readonly_with_delete":"readonly":"readonly"),[a,i,o,t,n])}({automationStore:Q,actionStores:pe,collectionStore:V,loadingStatus:"resolved",mode:d.mode}),he=("readonly_with_delete"===ge||"edit"===ge&&!j)&&!me,ye="edit"===ge&&!me,fe=(0,Y.X)({automationStore:Q,collectionStore:V}),xe=(0,Y.X)({automationStore:D,collectionStore:V}),Se=(0,r.VK)((()=>!(!Q||!V)&&N.vM({automationStore:Q,collectionStore:V})),[Q,V]),ve=(0,r.VK)((()=>!!(V&&Q&&fe)&&N.qk({automationContextStore:fe,automationStore:Q,collectionStore:V})),[fe,Q,V]),be=(0,r.VK)((()=>!!(V&&D&&xe)&&N.qk({automationContextStore:xe,automationStore:D,collectionStore:V})),[V,xe,D]);!function(e){const{automationStore:t,collectionStoreId:o,eventTracker:i,source:a}=e,[s,l]=(0,n.useState)(!1),c=(0,r.VK)((()=>(null==t?void 0:t.getActionIds().length)??0),[t]),u=(0,r.VK)((()=>{if(!t||!(0,N.Xd)(t))return 0;const e=t.getTriggerStore().getKeyStore("event");let o=0;e.getKeyStore("pagesAdded").getValue()&&o++;const n=e.getKeyStore("pagePropertiesEdited").getValue();return"any"===(null==n?void 0:n.type)?o++:"some"===(null==n?void 0:n.type)&&(o+=n.some.length),o}),[t]);(0,n.useEffect)((()=>{i&&o&&!s&&t&&((0,le.nC)(i,{automation_id:t.id,automation_total_actions:c,automation_total_triggers:u,collection_id:o,source:a}),ae.default.logEvent("automation_configure_view","true"),l(!0))}),[i,o,s,c,u,null==t?void 0:t.id,t,a])}({automationStore:Q,collectionStoreId:Z,eventTracker:S,source:e.source});const Ce=(0,n.useCallback)((()=>{V&&Q&&G&&("create"===g?function(e){const{automationStore:t,collectionSettingsStore:o,collectionStore:n,environment:i,intl:r,from:a}=e;se.aO({automationStore:t,collectionStore:n,environment:i,intl:r,from:a}),y.oV({label:(0,U.jsx)(p.FormattedMessage,{id:"automations.editAutomationView.createdConfirmation",defaultMessage:"{automationName} created",values:{automationName:t.getName()}})}),h.z$({collectionSettingsStore:o})}({automationStore:Q,collectionSettingsStore:t,collectionStore:V,environment:v,intl:f,from:d.from}):"update"===g?function(e){const{automationStore:t,collectionSettingsStore:o,collectionStore:n,environment:i}=e;se.hY({automationStore:t,collectionStore:n,environment:i}),y.oV({label:(0,U.jsx)(p.FormattedMessage,{id:"automations.editAutomationView.updatedConfirmation",defaultMessage:"{automationName} updated",values:{automationName:t.getName()}})}),h.z$({collectionSettingsStore:o})}({automationStore:Q,collectionSettingsStore:t,collectionStore:V,environment:v}):(0,m.t1)(g))}),[Q,t,V,v,G,f,g,d]),Me=(0,n.useCallback)((()=>{Q&&V&&se.j3({automationStore:Q,collectionStore:V,environment:v})}),[V,v,Q]),je=(0,n.useCallback)((()=>{Q&&V&&se.$K({automationStore:Q,collectionStore:V,environment:v})}),[V,v,Q]),Te=(0,n.useCallback)((async()=>{Q&&V&&!j&&await se.SC({intl:f,environment:v,existingAutomationStore:Q,collectionStore:V,onDelete:()=>{1===R?h.wl({collectionSettingsStore:t,item:{type:"main"}}):h.z$({collectionSettingsStore:t})}})}),[R,Q,t,V,v,f,j]),Ae=(0,n.useCallback)((async()=>{if(await se.hL({automationName:ue,hasPendingChanges:G})){if(B)return void h.z$({collectionSettingsStore:t});0===R?h.wl({collectionSettingsStore:t,item:{type:"main"}}):h.z$({collectionSettingsStore:t})}}),[R,ue,t,G,B]),Pe=(0,n.useCallback)((async()=>{await se.hL({automationName:ue,hasPendingChanges:G})&&h.E3({collectionSettingsStore:t})}),[ue,t,G]);!function(e){const{hasPendingChanges:t,onClick:o}=e;(0,n.useEffect)((()=>{async function e(e){const n=e.target;if(t&&e.eventPhase===Event.CAPTURING_PHASE&&n instanceof Element){if((0,ce.jM)(n)||(0,ce.yT)(n))return;e.stopPropagation(),e.preventDefault(),await o()}}return window.addEventListener("click",e,{capture:!0}),()=>{window.removeEventListener("click",e,{capture:!0})}}),[t,o])}({hasPendingChanges:G,onClick:Pe});const we=(0,n.useCallback)((e=>{M((t=>[...t,e.id]))}),[]),Ve=De({showDeleteEnableDisableOptions:he}),Be=[],Ke=G&&ve;if(ye&&Be.push((0,U.jsx)(K.Z,{mobileStyle:Ve.automationCreateMobile,style:Ve.automationCreateDesktop,topBorder:!b,children:(0,U.jsx)(te.Z,{onClick:Ce,disabled:!Ke,style:Ve.automationCreateButton,children:j?(0,U.jsx)(p.FormattedMessage,{id:"collectionSettings.editAutomationView.createButton.label",defaultMessage:"Create"}):(0,U.jsx)(p.FormattedMessage,{id:"collectionSettings.editAutomationView.saveButton.label",defaultMessage:"Save"})})},"save")),he&&Be.push((0,U.jsx)(K.Z,{disableMobilePadding:!0,topBorder:b||0===Be.length,children:(0,U.jsx)(k.Z,{desktopIconStyle:Ve.automationOptionIconDesktop,icon:l.y,isRed:!0,onClick:Te,title:f.formatMessage(Fe.deleteButton)})},"delete")),!V||!Q)return null;const _e=j?f.formatMessage(Fe.createAutomationViewMenuTitle):f.formatMessage(Fe.editAutomationViewMenuTitle),Le=L&&de&&(0,U.jsx)(ke,{automationStore:Q,collectionStore:V,automationPermissionScope:ge,referencesIncompatibleCollectionViewFilter:Se,onDelete:Te});return(0,U.jsx)(ee.Z,{debugName:"CollectionSettingsEditAutomationView",capture:!0,onEsc:Pe,children:(0,U.jsx)(J.ZP,{title:_e,collectionSettingsStore:t,handleBackArrowClick:Ae,handleClose:Pe,footer:Be,fullHeight:a,menuScrollerStyle:Ve.menuScroller,children:(0,U.jsxs)(q.Z.Provider,{value:{automationContextStore:fe,automationStore:Q,collectionStore:V,disabled:!ye,editorPlacement:{type:"inline"},editorWidth:J.nJ,maybePersistedTransactionActions:$,onActionAdded:we,suppressActionErrors:C,currentDraggingActionId:void 0},children:[Le,(0,U.jsx)(F.Z,{type:F.i.Vertical,initialFocus:void 0,sections:[{key:"automation_top_input",items:[{key:"automation_name",action:()=>{},render:e=>(0,U.jsx)(Re,{...e,disabled:!ye})},{key:"automation_source",action:Ze,render:e=>(0,U.jsx)(Ne,{disabled:!ye,collectionContextStore:o,menuListItemProps:e})}],render:e=>(0,U.jsx)(K.Z,{...e,disableMobilePadding:Boolean(Le)})}]}),(0,U.jsxs)("div",{style:Ve.wrap,children:[be&&he&&(0,U.jsx)(Ie,{automationId:Q.id,automationOwner:de,isAutomationPaused:!O,onPause:Me,onResume:je}),(0,U.jsx)(x.IQ,{areActionsEditable:ye,areTriggersEditable:ye})]})]})})})}const Re=(0,n.forwardRef)((function(e,t){let{disabled:o,...i}=e;const{automationStore:a,maybePersistedTransactionActions:s}=(0,Q.i)(),l=De({showDeleteEnableDisableOptions:!1}),c=(0,r.VK)((()=>(null==a?void 0:a.getName())??""),[a]),u=(0,n.useCallback)((e=>{const t=e.target.value;s.createAndCommit({userAction:"Automation.updateName",perform:e=>{f.applyOperation({store:a,operation:{path:["properties"],pointer:a.pointer,command:"update",args:{name:t}},transaction:e})}})}),[a,s]);return(0,U.jsx)(V.ZP,{style:l.automationNameInput,...i,value:c??"Loading...",onChange:u,disabled:o,ref:t,textWrapperStyle:l.automationNameText})}));function Ne(e){const{automationStore:t,maybePersistedTransactionActions:o}=(0,Q.i)(),i=(0,r.VK)((()=>{if(t&&(0,N.Xd)(t)){const e=t.getTriggerStore().getKeyStore("event").getKeyStore("source").getValue();if(e&&"filter"!==e.type)return e.pointer}}),[t]),a=(0,n.useCallback)((e=>{const n=e.table===u.vF?{pointer:e,type:u.vF}:{pointer:e,type:d.np};o.createAndCommit({userAction:"Automation.updateSource",perform:e=>{f.applyOperation({store:t,operation:{path:["trigger","event"],pointer:t.pointer,command:"update",args:{source:n}},transaction:e})}})}),[t,o]);return(0,U.jsx)(z,{selectedSourcePointer:i,onSelect:a,...e})}function De(e){const{showDeleteEnableDisableOptions:t}=e,{isMobile:o}=(0,i.Fy)();return(0,a.yK)((e=>({automationSection:{display:"flex",flexDirection:"column",gap:4},automationSectionAdd:{marginLeft:"auto",flexGrow:0,flexShrink:0},automationSectionHeader:{alignItems:"center",display:"flex",flexDirection:"row"},automationSectionHeaderAction:{background:`linear-gradient(to right, ${e.stroke.regular} 50%, transparent 50%), linear-gradient(to right, ${e.stroke.regular} 50%, transparent 50%)`,backgroundPosition:"20px 0px, 20px bottom",backgroundRepeat:"no-repeat",backgroundSize:"2px 36px, 2px 6px",marginBlockEnd:-4,paddingBlock:"36px 4px",position:"relative"},automationSectionTitle:{color:e.lightTextColor,fontSize:o?14:12,lineHeight:1.3,position:"relative",fontWeight:g.Z.fontWeight.medium},automationCreateMobile:{boxShadow:"none",paddingBlock:"0 12px",paddingInline:12},automationCreateDesktop:{paddingBlock:t?"12px 0":12,paddingInline:12},automationCreateButton:{...o?{minHeight:45}:{},width:"100%"},automationNameInput:{marginBlockEnd:o?void 0:8},automationNameText:{marginInlineStart:12},automationOptionIconDesktop:{marginInlineStart:12},menuScroller:{...o?{}:{marginBlockStart:6}},wrap:{borderTop:`1px solid ${e.regularDividerColor}`,paddingBlockStart:15,paddingBlockEnd:12,paddingInline:12}})),[o,t])}},378310:(e,t,o)=>{o.r(t),o.d(t,{CollectionSettingsAutomationsView:()=>Mt,CollectionSettingsCreateAutomationView:()=>n.oC,CollectionSettingsEditAutomationView:()=>n.ZD});var n=o(932130),i=(o(757658),o(443261)),r=o.n(i),a=o(667294),s=o(800480),l=o(886628),c=o(724405),u=o(266897),d=o(603865),p=o(940694),m=o(102647),g=o(823290),h=o(576205),y=o(399036),f=o(180951),x=o(984619),S=o(576218),v=o(188607),b=o(591856),C=o(590792),k=o(665422),M=o(760019),j=o(584169),T=o(920669),A=o(725651),P=o(747453),w=o(324600),V=o(742283),I=o(363030),F=o(669196),Z=o(282447),B=o(648524),K=o(943393),_=o(932426),R=o(571500),N=o(745238),D=o(785893);const L=(0,N.IU)("typesLocation",{viewBox:"0 0 25 25",svg:(0,D.jsxs)("g",{children:[(0,D.jsx)("path",{d:"M12.105 24.21C18.7369 24.21 24.2121 18.7273 24.2121 12.105C24.2121 5.47312 18.7273 0 12.0954 0C5.47523 0 0 5.47312 0 12.105C0 18.7273 5.48484 24.21 12.105 24.21ZM12.105 21.8255C6.71085 21.8255 2.39412 17.4991 2.39412 12.105C2.39412 6.71085 6.70124 2.38452 12.0954 2.38452C17.4895 2.38452 21.8276 6.71085 21.8276 12.105C21.8276 17.4991 17.4991 21.8255 12.105 21.8255Z"}),(0,D.jsx)("path",{d:"M6.75703 16.5939C6.75703 17.4355 7.28742 17.9479 8.17266 17.9479H16.0416C16.9247 17.9479 17.4476 17.4355 17.4476 16.5939V12.0109L12.4683 7.82758C12.236 7.63047 11.9686 7.64008 11.7363 7.82758L6.75703 12.0013V16.5939ZM13.6692 16.7148H10.5429V12.9969C10.5429 12.7178 10.7283 12.5366 11.0128 12.5366H13.2014C13.4977 12.5366 13.6692 12.7178 13.6692 12.9969V16.7148ZM4.81055 11.2199C4.81055 11.5316 5.04469 11.8138 5.43211 11.8138C5.62593 11.8138 5.78554 11.7083 5.9271 11.5806L11.8111 6.65687C12.0145 6.47477 12.2093 6.49609 12.4052 6.65687L18.2775 11.5806C18.4383 11.7083 18.5883 11.8138 18.7725 11.8138C19.1194 11.8138 19.3941 11.5818 19.3941 11.2391C19.3941 11.0315 19.3228 10.873 19.1653 10.7336L13.0078 5.5661C12.4605 5.10508 11.7558 5.10508 11.2181 5.5661L5.03929 10.7357C4.89141 10.8751 4.81055 11.0507 4.81055 11.2199ZM15.8079 8.35282L17.4623 9.75391V6.88399C17.4623 6.62618 17.3004 6.44501 17.033 6.44501H16.249C15.9912 6.44501 15.8079 6.62618 15.8079 6.88399V8.35282Z"})]})});var O=o(372050),W=o(155159),E=o(526774),H=o(934093),U=o(492607),z=o(832623),$=o(753866),G=o(603729),q=o(800108),Y=o(983303),Q=o(656505),X=o(808938),J=o(394308),ee=o(600606),te=o(519889),oe=o(76233),ne=o(709291),ie=o(401898),re=o(137810),ae=o(765328),se=o(805149),le=o(280826),ce=o(67653),ue=o(334067),de=o(842767),pe=o(639864),me=o(280981),ge=o(823745),he=o(590073),ye=o(519656),fe=o(23645),xe=o(293060),Se=o(720239),ve=o(599184),be=o(476954),Ce=o(687181),ke=o(756812),Me=o(891494),je=o(993416),Te=o(113732),Ae=o(497372),Pe=o(694166),we=o(268894),Ve=o(316354),Ie=o(672495),Fe=o(462385),Ze=o(623879),Be=o(311335),Ke=o(367669),_e=o(637034),Re=o(563474),Ne=o(825464),De=o(80444),Le=o(319385),Oe=o(206258),We=o(658812),Ee=o(706740),He=o(337989),Ue=o(733907),ze=o(654497),$e=o(277744),Ge=o(12589);const qe=(0,N.IU)("boltSlash",{svg:(0,D.jsx)("path",{d:"M1.248 12.444c0 .38.293.663.703.663h5.517l-2.91 7.588c-.39 1.006.684 1.553 1.318.723l4.405-5.664-1.094-1.094-3.008 3.985.274.146 2.129-4.746-2.413-2.393H3.69l1.074-1.416-1.142-1.142-2.12 2.725c-.166.214-.253.41-.253.624zm4.716-6.368L7.058 7.17l3.008-3.984-.274-.147-2.128 4.746 2.392 2.393h2.5l-1.074 1.416 1.143 1.142 2.128-2.734c.166-.205.254-.4.254-.625 0-.371-.293-.654-.703-.654H8.787l2.91-7.598c.39-1.006-.684-1.553-1.319-.713zm8.995 12.735a.754.754 0 001.064 0 .754.754 0 000-1.065L1.287 3.01a.766.766 0 00-1.075 0 .773.773 0 000 1.064z"}),viewBox:"0 0 17 22"});var Ye=o(356666),Qe=o(388437),Xe=o(937612),Je=o(552275),et=o(231945),tt=o(573063),ot=o(478140),nt=o(632163),it=o(61766),rt=o(595193),at=o(435294);const st=(0,ne.defineMessages)({automationSummaryCardMoreButtonAriaLabel:{defaultMessage:"More",id:"automations.AutomationSummaryCard.MoreActionsButton.ariaLabel"},automationSummaryCardMoreMenuEditTitle:{defaultMessage:"Edit",id:"automations.AutomationSummaryCard.MoreActionsMenu.Edit.title"},automationSummaryCardMoreMenuDuplicateTitle:{defaultMessage:"Duplicate",id:"automations.AutomationSummaryCard.MoreActionsMenu.Duplicate.title"},automationSummaryCardMoreMenuPauseTitle:{defaultMessage:"Pause",id:"automations.AutomationSummaryCard.MoreActionsMenu.Pause.title"},automationSummaryCardMoreMenuResumeTitle:{defaultMessage:"Resume",id:"automations.AutomationSummaryCard.MoreActionsMenu.Resume.title"},automationSummaryCardMoreMenuDeleteTitle:{defaultMessage:"Delete",id:"automations.AutomationSummaryCard.MoreActionsMenu.Delete.title"}});function lt(e){const{focused:t,style:o,onEdit:n,onDelete:i,onDuplicate:r,onDisable:s,onEnable:u}=e,d=(0,ne.useIntl)(),p=(0,l.qz)(void 0,it.Z),m=(0,at.d)();(0,a.useEffect)((()=>{t||p.setState({open:!1})}),[t,p]);const g=(0,c.yK)((e=>({iconButton:{border:`1px solid ${e.regularDividerColor}`,height:26,width:26,...o},iconButtonIcon:{width:16}})),[o]);return(0,D.jsx)(D.Fragment,{children:(0,D.jsx)(et.ZP,{stopClickPropagation:!0,popupType:m,alignmentToOrigin:et.vR.Center,placementToOrigin:et.pO.Bottom,originGap:0,renderOrigin:e=>(0,D.jsx)(tt.Z,{ariaLabel:d.formatMessage(st.automationSummaryCardMoreButtonAriaLabel),icon:Ye.o,iconStyle:g.iconButtonIcon,style:g.iconButton,hasBackground:!0,...e}),render:e=>(0,D.jsx)(ct,{onClose:()=>e.close(),onEdit:n,onDelete:i,onDuplicate:r,onDisable:s,onEnable:u}),buttonPopupStore:p})})}function ct(e){const{onClose:t,onEdit:o,onDelete:n,onDuplicate:i,onDisable:r,onEnable:a}=e,s=(0,ne.useIntl)(),l=(0,rt.F)(),c=o?{action:()=>{t(),o()},key:"edit",render:e=>(0,D.jsx)(Je.Z,{...e,icon:(0,A.R)({height:16,width:16}),title:s.formatMessage(st.automationSummaryCardMoreMenuEditTitle)})}:void 0,u=i?{action:()=>{t(),i()},key:"duplicate",render:e=>(0,D.jsx)(Je.Z,{...e,icon:(0,Qe.a)({height:16,width:16}),title:s.formatMessage(st.automationSummaryCardMoreMenuDuplicateTitle)})}:void 0,d=r?{action:()=>{t(),r()},key:"disable",render:e=>(0,D.jsx)(Je.Z,{...e,icon:qe({height:16,width:16}),title:s.formatMessage(st.automationSummaryCardMoreMenuPauseTitle)})}:void 0,p=a?{action:()=>{t(),a()},key:"enable",render:e=>(0,D.jsx)(Je.Z,{...e,icon:(0,Ge.M)({height:16,width:16}),title:s.formatMessage(st.automationSummaryCardMoreMenuResumeTitle)})}:void 0,m=n?{action:()=>{t(),n()},key:"delete",render:e=>(0,D.jsx)(Je.Z,{...e,icon:(0,Xe.y)({height:16,width:16}),title:s.formatMessage(st.automationSummaryCardMoreMenuDeleteTitle),isRedOnHover:!0})}:void 0;return(0,D.jsx)(ot.Z,{...l,children:(0,D.jsx)(nt.Z,{type:nt.i.Vertical,sections:[{items:[c,u,d,p,m].filter(ie.$K),key:"items",render:e=>(0,D.jsx)(Ie.Z,{enableActionSheetTitle:!0,topBorder:!0,...e})}],initialFocus:0})})}var ut=o(164921),dt=o(992864),pt=o(475024);const mt=6;function gt(e){const{actions:t,caption:o,focused:n,hasWarning:i,maxIcons:r,onBlur:l,onClick:u,onDelete:d,onDisable:p,onDuplicate:m,onEdit:g,onEnable:h,onFocus:y,onMouseDown:f,onMouseEnter:x,onMouseLeave:S,title:v,triggers:b}=e,{isMobile:C}=(0,s.Fy)(),k=(0,a.useRef)(null),[M,j]=(0,Ee.Z)(),[T,A]=(0,He.Z)(),[P,w]=(0,a.useState)(!1),V=C||P||j||A,I=(0,c.yK)((e=>({wrap:{background:e.cardContentBackground,border:`1px solid ${e.regularDividerColor}`,borderRadius:8,display:"flex",flexDirection:"column",gap:15,padding:15,position:"relative"},moreButtonWrap:{display:V?"block":"none",position:"absolute",right:8,top:8},iconList:{display:"flex",flexWrap:"wrap",gap:5,listStyle:"none",margin:"0 30px 0 0",padding:0},body:{display:"flex",flexDirection:"column",gap:C?4:2},titleWrap:{...i?{alignItems:"center",display:"inline-flex",gap:4}:(0,pt.pd)(2),fontSize:C?16:14,fontWeight:re.Z.fontWeight.medium,lineHeight:"130%"},title:{...i?re.Z.textOverflowStyle:{}},warning:{color:e.accentColors.orange[400],height:"auto",width:C?16:14},caption:{...(0,pt.pd)(2),color:e.lightTextColor,fontSize:C?14:12,fontWeight:re.Z.fontWeight.regular,lineHeight:"130%",margin:0}})),[i,V,C]),F=(0,a.useCallback)((e=>{w(!0),x&&x(e)}),[x]),Z=(0,a.useCallback)((e=>{w(!1),S&&S(e)}),[S]);(0,a.useEffect)((()=>{n&&null!==k.current&&k.current.focus()}),[n]);const B=(0,$e.lq)(k,M,T),K=function(e){const{actionIcons:t,maxIcons:o,triggerIcons:n}=e,i=n.length,r=t.length,a=i>0&&r>0,s=Math.max(o,3),l=a?s-1:s;let c=Math.max(Math.floor(l/2),1),u=Math.max(Math.ceil(l/2),1);if(i<c&&r>u){u+=c-i,c=i}else if(r<u&&i>c){c+=u-r,u=r}const d=[];if(i>0)if(i>c)if(1===c)d.push({color:"gray",type:"truncate",value:i});else{const e=i-(c-1);d.push(...n.slice(0,c-1)),d.push({color:"gray",type:"truncate",value:e})}else d.push(...n);a&&d.push({type:"arrow"});if(r>0)if(r>u)if(1===u)d.push({color:"gray",type:"truncate",value:r});else{const e=r-(u-1);d.push(...t.slice(0,u-1)),d.push({color:"gray",type:"truncate",value:e})}else d.push(...t);return d}({actionIcons:t,maxIcons:bt(r),triggerIcons:b}),_=Boolean(d||p||h||m||g);return(0,D.jsxs)(ut.Z,{onBlur:l,onClick:u,onFocus:y,onMouseDown:f,onMouseEnter:F,onMouseLeave:Z,ref:B,style:I.wrap,children:[(0,D.jsxs)("header",{children:[_&&(0,D.jsx)("div",{style:I.moreButtonWrap,children:(0,D.jsx)(lt,{focused:V,onDelete:d,onDisable:p,onEnable:h,onDuplicate:m,onEdit:g})}),(0,D.jsx)("ul",{"aria-hidden":"true",style:I.iconList,children:K.map(((e,t)=>(0,D.jsx)("li",{children:(0,D.jsx)(ht,{icon:e})},t)))})]}),(0,D.jsxs)("div",{style:I.body,children:[(0,D.jsxs)("div",{style:I.titleWrap,children:[(0,D.jsx)("span",{style:I.title,children:v}),i&&(0,ze.t)(I.warning)]}),o&&(0,D.jsx)("p",{style:I.caption,children:o})]})]})}function ht(e){const{icon:t}=e;return"property"===t.type||"page"===t.type||"misc"===t.type?(0,D.jsx)(yt,{color:t.color,icon:t.icon}):"person"===t.type?(0,D.jsx)(vt,{actor:t.actor}):"app"===t.type?(0,D.jsx)(xt,{color:"default",icon:t.icon}):"arrow"===t.type?(0,D.jsx)(ft,{}):"truncate"===t.type?(0,D.jsx)(St,{color:t.color,value:t.value}):void(0,ie.t1)(t.type)}function yt(e){const{color:t,icon:o}=e,n=Ct(t);return(0,D.jsx)("div",{"aria-hidden":"true",style:n.iconWrap,children:o(n.icon)})}function ft(){const e=Ct("default");return(0,D.jsx)("div",{style:{...e.iconWrap,...e.iconArrowWrap},children:(0,Ue.n)({...e.icon,...e.iconArrow})})}function xt(e){const{icon:t}=e,o=Ct("default");return(0,D.jsx)("div",{"aria-hidden":"true",style:o.iconAppWrap,children:t(o.iconApp)})}function St(e){const{color:t,value:o}=e,n=Ct(t);return(0,D.jsxs)("div",{style:{...n.iconWrap,...n.truncateWrap},children:["+",o]})}function vt(e){const{actor:t}=e,o=Ct("default");return(0,D.jsx)("div",{"aria-hidden":"true",style:o.iconPersonWrap,children:(0,D.jsx)(dt.ZP,{actor:t,avatarSize:26,format:dt.ZP.Format.Inline,isSingle:!1,showRemoveButton:!1,style:{margin:0}})})}function bt(e){return void 0===e||e<0?mt:e}function Ct(e){const t="default"===e?"gray":e;return(0,c.yK)((e=>{const o="light"===e.mode?400:800,n="light"===e.mode?100:400;return{icon:{fill:e.accentColors[t][o],width:16},iconWrap:{background:e.accentColors[t][n],borderRadius:6,padding:6},iconApp:{width:14},iconAppWrap:{borderRadius:6,borderWidth:1,borderStyle:"solid",borderColor:e.accentColors.gray[n],padding:6},iconPerson:{display:"block",width:"100%"},iconPersonWrap:{alignItems:"center",display:"flex",height:28,justifyContent:"center",width:28},iconArrow:{fill:e.accentColors.gray[600]},iconArrowWrap:{background:void 0},truncateWrap:{alignItems:"center",background:e.accentColors.gray[n],color:e.accentColors[t][o],display:"inline-flex",fontSize:12,fontWeight:re.Z.fontWeight.semibold,height:28,justifyContent:"center",padding:3,width:28}}}),[t])}const kt=(0,ne.defineMessages)({automationTabTitle:{defaultMessage:"Automations",id:"database.viewSettings.automationTab.title"},automationTabFilterButton:{defaultMessage:"Filter",id:"database.viewSettings.automationTab.filterButton"},automationTabAddFilterButton:{defaultMessage:"Add filter",id:"database.viewSettings.automationTab.addFilterButton"},automationTabFilterMenuSearchInputPlaceholder:{defaultMessage:"Filter by…",id:"database.viewSettings.automationTab.filterMenuSearchInputPlaceholder"},automationTabFilterMenuNoResults:{defaultMessage:"No results",id:"database.viewSettings.automationTab.filterMenuNoResults"},automationNewAutomationTitle:{defaultMessage:"New automation",id:"database.viewSettings.automationTab.newAutomationTitle"},automationLearnAutomationTitle:{defaultMessage:"Learn about automations",id:"database.viewSettings.automationTab.learnAutomationTitle"},automationDisabledCaption:{defaultMessage:"Paused",id:"database.viewSettings.automationTab.disabledCaption"},automationEmptyViewEditorPublic:{defaultMessage:"Automatically set status, assignees, property values and more with automations",id:"database.viewSettings.automationTab.automationEmptyViewEditorPublic"},automationEmptyViewReadOnly:{defaultMessage:"You're a content viewer. Content viewers cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewReadOnly"},automationEmptyViewContentOnly:{defaultMessage:"You're a content editor. Content editors can edit pages, but cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewContentOnly"},automationSearchPlaceholder:{defaultMessage:"Search for an automation…",id:"database.viewSettings.automationTab.automationSearchPlaceholder"}});function Mt(e){const{collectionContextStore:t,collectionSettingsStore:o,fullHeight:n,tabSettings:i}=e,u=(0,ne.useIntl)(),d=(0,Re.D)(),{isMobile:h}=(0,s.Fy)(),[y,f]=(0,a.useState)(""),x=(0,l.VK)((()=>t.collectionStore()),[t]),S=(0,l.VK)((()=>t.collectionViewBlockStore()),[t]),v=(0,l.VK)((()=>x&&x.id),[x]),b=(0,l.VK)((()=>null==x?void 0:x.getSchema()),[x]),C=(0,l.VK)((()=>null==x?void 0:x.getFormat()),[x]),k=(0,l.VK)((()=>function(e){const{collectionStore:t,collectionViewBlockStore:o}=e;if(!t||!o)return[];const n=t.getAutomationStores(),i=[];for(const a of n){var r;const e=a.getModel();null!=e&&e.getAlive()&&((a.isTriggerType("event")||a.isTriggerType("notification_event"))&&(null!==(r=a.getProperties())&&void 0!==r&&r.is_assistant||i.push(a)))}return i}({collectionStore:x,collectionViewBlockStore:S})),[x,S]),M=(0,l.VK)((()=>function(e){const{automationStores:t,collectionSchema:o,intl:n}=e,i=new Map,a=[];for(const r of t){var s;if(!r.isDefined())continue;const e=[],t=r.getName();void 0!==t&&e.push(t);const c=null===(s=r.getOwnerStore())||void 0===s?void 0:s.getDisplayName(n);if(void 0!==c&&e.push(c),r.isTriggerType("event")||r.isTriggerType("notification_event")){const t=r.getEventConfiguration(),i=null==t?void 0:t.pagePropertiesEdited;if("some"===(null==i?void 0:i.type))for(const n of i.some){const t=null==o?void 0:o[n.property];t&&e.push(`${t.name} ${Ze.SO[t.type]}`)}const a=r.getActionStores();for(const r of a){const t=r.getType();if(t){const o=(0,p.z)(t);(0,g.Xp)(o)&&e.push(n.formatMessage(o.display.name))}if(r.isType("create_page")||r.isType("update_pages")){var l;const t=r.getConfig();null==t||null===(l=t.properties)||void 0===l||l.forEach((t=>{const n=null==o?void 0:o[t];n&&e.push(`${n.name} ${Ze.SO[n.type]}`)}))}}}const u=e.join(" ");i.set(r.id,u),a.push(u)}return function(e){const o=new Set(r().filter(e,a).map((e=>{let{original:t}=e;return t})));return t.filter((0,ie.AO)((e=>{if(!e.isTriggerType("event")&&!e.isTriggerType("notification_event"))return{false:e};const t=i.get(e.id);return t&&o.has(t)?{true:e}:{false:e}})))}}({automationStores:k,collectionSchema:b,intl:u})),[k,b,u]),T=(0,l.VK)((()=>M(y)),[M,y]),A=(0,l.VK)((()=>Be.Li({collectionStore:x})),[x]),w=(0,a.useCallback)((()=>{const e=ae.X(o);se.H4({collectionSettingsStore:o,item:{type:"automationCreateSettings",from:e}})}),[o]),V=(0,a.useCallback)((e=>f(e.target.value)),[]),I=(0,a.useCallback)((()=>{d&&v&&m.qu(d,{collection_id:v})}),[d,v]);(0,a.useEffect)((()=>{d&&v&&(m.d(d,{source:i.source,collection_id:v}),Le.default.logEvent("automation_list_view","true"))}),[d,v,i]);const[F,Z]=a.useState(!1),B=(0,l.VK)((()=>function(e){var t;const o=null===(t=De.default.state.currentUserStore)||void 0===t?void 0:t.pointer,n=[],i=[];for(const r of e){const e=r.getCreatedByPointer();o&&e&&ee.dr.isEqual(o,e)?n.push(r):i.push(r)}return n.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),i.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),{currentUserAutomations:n,otherUserAutomations:i}}(T)),[T]),K=(0,a.useMemo)((()=>{const{currentUserAutomations:e,otherUserAutomations:t}=B;return F?[...e,...t]:e.length>0?e:t}),[B,F]),_=T.length-K.length,R=!F&&_>0,N=K.length>0,L=!N&&!(""!==y),O=(0,c.yK)((e=>({buttonList:{display:"flex",flexDirection:"column",flexShrink:1,gap:12,overflow:"hidden auto",paddingBlockEnd:h?0:12,paddingBlockStart:h?12:0,paddingInline:12},emptyViewWrap:{paddingBlockEnd:42,paddingInline:12},menuScrollerStyle:{marginBlockStart:h?12:8},wrap:{display:"flex",flexDirection:"column"},showMoreButtonContainer:{marginLeft:12,marginBottom:12,marginRight:"auto"},showMoreButtonContent:{fontSize:12},noResultsTitle:{color:e.text.secondary,fontSize:12,margin:0}})),[h]);return x&&b&&C&&S?(0,D.jsx)(Ae.ZP,{...e,fullHeight:n,header:!L&&(0,D.jsx)(Ie.Z,{children:(0,D.jsx)(we.ZP,{focusInitial:!h,onChange:V,placeholder:u.formatMessage(kt.automationSearchPlaceholder),showClearButton:!0,value:y})}),footer:(0,D.jsxs)(Ie.Z,{topBorder:!0,children:[A&&(0,D.jsx)(Pe.Z,{icon:P.R,onClick:w,title:u.formatMessage(kt.automationNewAutomationTitle),isGray:!0}),(0,D.jsx)(Ve.Z,{href:"https://www.notion.so/help/database-automations",external:!0,onClick:I,children:(0,D.jsx)(Pe.Z,{icon:j.m,title:u.formatMessage(kt.automationLearnAutomationTitle),isGray:!0})})]}),menuScrollerStyle:O.menuScrollerStyle,title:N||y?u.formatMessage(kt.automationTabTitle):null,children:(0,D.jsx)("div",{style:O.wrap,children:L?(0,D.jsx)("div",{style:O.emptyViewWrap,children:(0,D.jsx)(jt,{collectionStore:x})}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{style:O.buttonList,children:K.length>0?K.map(((e,n)=>(0,D.jsx)(At,{collectionContextStore:t,collectionStore:x,collectionSettingsStore:o,focused:!1,schema:b,automationStore:e},e.id))):(0,D.jsx)("p",{style:O.noResultsTitle,children:(0,D.jsx)(ne.FormattedMessage,{defaultMessage:"No results",id:"collectionSettings.automationsView.noResults"})})}),R&&(0,D.jsx)(Fe.Z,{style:O.showMoreButtonContainer,onClick:e=>{e.stopPropagation(),Z(!0)},children:(0,D.jsx)("div",{style:O.showMoreButtonContent,children:(0,D.jsx)(ne.FormattedMessage,{id:"collectionSettings.automationsView.showMore",defaultMessage:"Show {number} more",values:{number:_}})})})]})})}):null}function jt(e){const{collectionStore:t}=e,o=(0,s.O7)(),n=(0,c.yK)((e=>({wrap:{alignItems:"center",display:"flex",flexDirection:"column",gap:7.5,justifyContent:"center",minHeight:250,textAlign:"center"},icon:{fill:e.icon.yellow,height:24,width:24},title:{fontSize:17,fontWeight:re.Z.fontWeight.medium,margin:0},copy:{color:e.text.secondary,fontSize:14,margin:0,lineHeight:1.5}})),[]),i=(0,l.VK)((()=>t.getRole()),[t]);let r;return r=(0,l.VK)((()=>Boolean((0,Ke.IJ)(o,t))),[t,o])||!i||"editor"===i?kt.automationEmptyViewEditorPublic:"reader"===i||"comment_only"===i?kt.automationEmptyViewReadOnly:"content_only_editor"===i||"read_and_write"===i?kt.automationEmptyViewContentOnly:kt.automationEmptyViewEditorPublic,(0,D.jsxs)("div",{style:n.wrap,children:[(0,D.jsx)("div",{"aria-hidden":!0,children:(0,k.K)(n.icon)}),(0,D.jsx)("p",{style:n.title,children:(0,D.jsx)(ne.FormattedMessage,{...kt.automationTabTitle})}),(0,D.jsx)("p",{style:n.copy,children:(0,D.jsx)(ne.FormattedMessage,{...r})})]})}const Tt={text:q.p,number:W.J,url:X.O,file:K.Z,date:Z.V,person:E.O,email:B.n,phone_number:H.u,checkbox:V.r,select:$.w,multi_select:O.A,status:G.T,relation:U.v,rollup:z.G,formula:_.D,created_time:I.I,created_by:F.H,title:Y.c,last_edited_time:I.I,last_edited_by:F.H,last_visited_time:I.I,button:G.T,auto_increment_id:R.A,location:L,verification:J.f,ai_summary:b.Y,ai_custom_prompt:T.y,ai_extract:O.A,ai_translate:v.Q,ai_keywords:M.F};function At(e){const{automationStore:t,collectionContextStore:o,collectionStore:n,collectionSettingsStore:i,focused:r,schema:c}=e,p=(0,ne.useIntl)(),m=(0,s.O7)(),g=(0,Me.X)({automationStore:t,collectionStore:n}),v=(0,l.VK)((()=>!!(n&&t&&g)&&Be.qk({automationContextStore:g,automationStore:t,collectionStore:n})),[g,t,n]),b=(0,l.VK)((()=>t.getActionStores()),[t]),k=(0,l.VK)((()=>t.getTriggerStore().getValue()),[t]),M=(0,l.VK)((()=>t.getNameWithDefault(p)),[p,t]),j=(0,l.VK)((()=>t.isActive()),[t]),T=(0,l.VK)((()=>o.aliveAutomationCountStore.state),[o]),V=(0,l.VK)((()=>Be.i1({actionStores:b,automationStore:t,collectionStore:n})),[b,t,n]),I=(0,l.VK)((()=>Be.qM({automationStore:t,collectionStore:n})),[t,n]),F=(0,a.useCallback)((async()=>{await We.SC({collectionStore:n,environment:m,existingAutomationStore:t,intl:p,onDelete:()=>{1===T&&se.wl({collectionSettingsStore:i,item:{type:"main"}})}})}),[p,m,n,i,t,T]),Z=(0,a.useCallback)((()=>{We.j3({automationStore:t,collectionStore:n,environment:m})}),[n,m,t]),B=(0,a.useCallback)((()=>{se.H4({collectionSettingsStore:i,item:{type:"automationEditSettings",automationId:t.id,source:"collection_settings_automation_view"}})}),[i,t]),K=(0,a.useCallback)((()=>{We.$K({automationStore:t,collectionStore:n,environment:m})}),[n,m,t]),_=(0,a.useCallback)((()=>{We.HF({automationStore:t,collectionStore:n,environment:m})}),[t,n,m]),R=(0,l.VK)((()=>k?function(e){const{schema:t,triggerConfig:o,collectionStore:n}=e;if("notification_event"!==o.type&&"event"!==o.type)return[];const i=[];o.event.pagesAdded&&i.push({color:"blue",icon:P.R,type:"page"});const r=o.event.pagePropertiesEdited;if("any"===r.type)i.push({color:"blue",icon:A.R,type:"misc"});else if("some"===r.type)for(const a of r.some){const e=t[a.property],o=a.filter;if(!e)continue;if(!d.Ym[e.type]){i.push({color:"gray",icon:Kt(e.type),type:"property"});continue}const r=y.gB(e),s=y.cu(e),l=y.KR(e),c=y.G$(e);if("changes_to_any"===o.operator)i.push({color:r||s?"gray":"blue",icon:Kt(e.type),type:"property"});else if(r&&!h.mv(o)&&h.r2(o)){const t=h.wB(o);if(t.length>1)i.push({color:"gray",icon:Kt(e.type),type:"property"});else if(1===t.length){const o=t[0];if("is_group"===o.type){const t=(e.groups??[]).find((e=>e.name===o.value));t&&i.push({color:t.color??"gray",icon:Kt(e.type),type:"property"})}else{const t=(e.options??[]).find((e=>e.value===o.value));t&&i.push({color:t.color??"gray",icon:Kt(e.type),type:"property"})}}}else if(s&&(h.dx(o)||h.NU(o))){const t=h.mv(o)?[]:h.dx(o)?h.mg(o):h.qC(o);if(1===t.length){const o=t[0],n=(e.options??[]).find((e=>e.value===o.value));n&&i.push({color:n.color??"gray",icon:Kt(e.type),type:"property"})}else(t.length>1||0===t.length)&&i.push({color:"gray",icon:Kt(e.type),type:"property"})}else if(l&&h.Gb(o)){const t=h.mv(o)?[]:h.R8(o);if(1===t.length){if(!h.mv(o)){const e=h.R8(o)[0];if("exact"===e.type&&e.value){const t=(0,u.Hl)({pointer:e.value,getRecordValue:n.getRecordValue});i.push({actor:t,type:"person"})}}}else(t.length>1||0===t.length)&&i.push({color:"gray",icon:Kt(e.type),type:"property"})}else c&&h.h6(o)&&i.push({color:"is_empty"===o.operator?"gray":"blue",icon:Kt(e.type),type:"property"})}return i}({schema:c,triggerConfig:k,collectionStore:n}):[]),[c,k,n]),N=(0,l.VK)((()=>function(e){const{actionStores:t,collectionStore:o,schema:n}=e,i=[];for(const c of t)if(c.isType("slack_notification"))i.push({icon:w.P,type:"app"});else if(c.isType("update_pages")){const e=c.getConfig(),t=(null==e?void 0:e.properties)??[];if(1===t.length){var r,a;const l=t[0],c=n[l],p=null==e||null===(r=e.values)||void 0===r?void 0:r[l];if(!c||!p)continue;if(!d.SF(c)){i.push({color:"gray",icon:Kt(c.type),type:"property"});continue}const m=(0,S.A6)(null===(a=p.value)||void 0===a?void 0:a.value);if(y.gB(c)){const e=(c.options||[]).find((e=>e.value===m[0]));e&&i.push({color:e.color??"gray",icon:Kt(c.type),type:"property"})}else if(y.cu(c))if(1===m.length){const e=(c.options||[]).find((e=>e.value===m[0]));e&&i.push({color:e.color??"gray",icon:Kt(c.type),type:"property"})}else m.length>1&&i.push({color:"gray",icon:Kt(c.type),type:"property"});else if(y.KR(c)){var s;const e=(0,f.DW)({textValue:null===(s=p.value)||void 0===s?void 0:s.value,propertySchema:c,blockCreatorPointer:void 0}).map((e=>(0,u.Hl)({pointer:e,getRecordValue:o.getRecordValue})));1===e.length?i.push({actor:e[0],type:"person"}):i.push({color:"gray",icon:Kt(c.type),type:"property"})}else i.push({color:"gray",icon:Kt(c.type),type:"property"})}else t.length>1&&i.push({color:"gray",icon:A.R,type:"misc"})}else if(c.isType("create_page")){var l;(null===(l=c.getConfig())||void 0===l?void 0:l.collection)&&i.push({color:"blue",icon:P.R,type:"page"})}else c.isType("send_in_app_notification")&&i.push({color:"blue",icon:C.t,type:"misc"});return i}({actionStores:b,collectionStore:n,schema:c})),[c,n,b]),L=(0,l.VK)((()=>j?g&&function(e){var t,o;const{environment:n,actionStores:i,automationContextStore:r,collectionStore:a,intl:s,schema:l,triggerConfig:c}=e;if(!c||"event"!==c.type&&"notification_event"!==c.type)return;const{event:p}=c,m=[];p.pagesAdded&&m.push(ke.Mz(s));if("none"===p.pagePropertiesEdited.type);else if("any"===p.pagePropertiesEdited.type)m.push(ke.c5(s));else if("some"===p.pagePropertiesEdited.type)for(const u of p.pagePropertiesEdited.some){const e=l[u.property];if(!e){m.push(ke.nf(s));continue}if(!d.Ym[e.type]){m.push((0,fe.K1)({propertySchema:e}));continue}const{filter:t}=u;if("changes_to_any"===t.operator)m.push(ke.$G(s,{propertyName:e.name}));else if(h.mv(t))m.push(ke.Vf(s,{propertyName:e.name}));else if(d.bD(e))if("status"===e.type){if(!h.r2(t)||!h.vR(t))continue;const o=h.wB(t),n=(0,Ce.L)({intl:s,groupValues:o.map((e=>"is_group"===e.type?e.value:void 0)).filter(ie.$K),isText:!0,optionValues:o.map((e=>"is_option"===e.type?e.value:void 0)).filter(ie.$K),propertySchema:e,tokenFormat:x.lo.Small}),i=s.formatList(n,{style:"long",type:"disjunction"});m.push(ke.VO(s,{propertyName:e.name,propertyValues:i}))}else if("select"===e.type||"multi_select"===e.type){if(h.mv(t)||!h.dx(t)&&!h.NU(t))continue;const o=Array.isArray(t.value)?t.value:[t.value],n=(0,be.z)({intl:s,isText:!0,optionValues:o.map((e=>e.value)).filter(ie.$K),propertySchema:e,tokenFormat:x.lo.Small}),i=s.formatList(n,{style:"long",type:"disjunction"});m.push(ke.XJ(s,{propertyName:e.name,propertyValues:i}))}else if("checkbox"===e.type){if(!h.XA(t))continue;m.push((0,Se.l4)({filter:t,propertySchema:e,intl:s}))}else if("person"===e.type){if(!h.Gb(t))continue;m.push((0,Te.y3)({actors:(0,ve.S)(t,r),propertySchema:e,intl:s,messageType:"trigger"}))}else if("number"===e.type){if(!h.h6(t))continue;m.push((0,je.MT)({messageType:"trigger",numberValue:t.value.value,operator:t.operator,propertySchema:e}))}else(0,ie.t1)(e)}const g=s.formatList(m,{style:"long",type:"disjunction"}),y=[];for(const h of i)if(h.isType("slack_notification"))y.push((0,D.jsx)(ne.FormattedMessage,{defaultMessage:"notify {channel}",id:"CollectionSettingsAutomationsView.summaryCard.slackAction",values:{channel:(0,D.jsx)(le.pZ,{actionStore:h})}}));else if(h.isType("update_pages")){const e=h.getConfig(),t=null==e?void 0:e.properties,o=null==e?void 0:e.values,i=null==e?void 0:e.target;if(!t||0===t.length||!i)continue;if("collection"===i.type)if((0,ee.qo)(i.collection,a.pointer))y.push((0,D.jsx)(ne.FormattedMessage,{defaultMessage:"edit pages in this collection",id:"automation.summaryCard.updatePages.sameCollection"}));else{const e=Oe.NW.createChildStore(a,i.collection),t=(0,_e.vU)({environment:n,intl:s,store:e});y.push((0,D.jsx)(ne.FormattedMessage,{defaultMessage:"edit pages in {collectionTitle}",id:"automation.summaryCard.updatePages.differentCollection",values:{collectionTitle:t}}))}else if("variable"===i.type){const e=t[0],n=l[e],i=null==o?void 0:o[e];if(!n){y.push(ke.aD(s));continue}if(!i)continue;if(d.SF(n))if("person"===n.type)y.push((0,D.jsx)(Pt,{collectionStore:a,propertyActionValue:i,propertySchema:n}));else if("status"===n.type){const e=(0,D.jsx)(wt,{propertyActionValue:i,propertySchema:n});e&&y.push(e)}else if("select"===n.type||"multi_select"===n.type)y.push((0,D.jsx)(Vt,{propertyActionValue:i,propertySchema:n}));else if("checkbox"===n.type)y.push((0,D.jsx)(It,{propertyActionValue:i,propertySchema:n}));else if("relation"===n.type)y.push((0,D.jsx)(Ft,{automationContextStore:r,collectionStore:a,propertyActionValue:i,propertySchema:n}));else if("date"===n.type){const t=(0,D.jsx)(Zt,{automationContextStore:r,collectionStore:a,propertyActionValue:i,propertyId:e,propertySchema:n});t&&y.push(t)}else"number"===n.type||"phone_number"===n.type||"text"===n.type||"title"===n.type||"email"===n.type||"url"===n.type?y.push((0,D.jsx)(Bt,{automationStore:r.context.automationStore,propertyActionValue:i,propertySchema:n})):(0,ie.t1)(n);else y.push((0,fe.K1)({propertySchema:n}))}}else if(h.isType("create_page")){var f;const e=null===(f=h.getConfig())||void 0===f?void 0:f.collection;if(!e)continue;e.id===a.pointer.id?y.push((0,D.jsx)(ne.FormattedMessage,{defaultMessage:"create a page in this database",id:"automation.summaryCard.createPageThisDatabase"})):y.push((0,D.jsx)(ne.FormattedMessage,{defaultMessage:"create a page in another database",id:"automation.summaryCard.createPageAnotherDatabase"}))}else if(h.isType("send_in_app_notification")){var S;const e=null===(S=h.getConfig())||void 0===S?void 0:S.target;if(!e)continue;const n=e.type;switch(n){case"formula":const i=(0,oe.lcG)(null===(t=e.value)||void 0===t?void 0:t.value),r=(0,oe.oOk)(null===(o=e.value)||void 0===o?void 0:o.value),l=e=>{const t=h.getSpaceId()??"";return{table:te.KJ,id:e,spaceId:t}},c=i.map((e=>l(e))),d=c.map((e=>(0,u.Hl)({getRecordModel:a.getRecordModel,pointer:e}))).filter(ie.$K).map((e=>(0,u.$4)(s,e)));y.push((0,D.jsx)(ne.FormattedMessage,{defaultMessage:"{numTargets, plural, one {send a notification to {singleTarget}} other {send a notification to {numTargets} people}}",values:{numTargets:c.length+r.length,singleTarget:c.length>0?d[0]:Ze.SO.created_by},id:"automation.summaryCard.sendNotificationUserTarget"}));break;case"property":if(!e.propertyId)break;let p;const m=a.getSchema()[e.propertyId];p=m?m.name??Ze.SO[m.type]:ke.Bo.unknownPropertyTitle.defaultMessage,y.push((0,D.jsx)(ne.FormattedMessage,{defaultMessage:"send a notification to {propertyDisplayName}",values:{propertyDisplayName:p},id:"automation.summaryCard.sendNotificationPropertyTarget"}));break;default:(0,ie.t1)(n)}}const v=s.formatList(y,{style:"long",type:"conjunction"});return s.formatMessage({defaultMessage:"When {triggers}, {actions}.",id:"automation.summaryCard.caption"},{actions:v,triggers:g})}({environment:m,actionStores:b,automationContextStore:g,collectionStore:n,intl:p,schema:c,triggerConfig:k}):p.formatMessage(kt.automationDisabledCaption)),[j,g,m,b,n,p,c,k]),O=(0,l.VK)((()=>{if(!t.isTriggerType("event")&&!t.isTriggerType("notification_event"))return!0;return!t.getTrigger()||Be.vM({automationStore:t,collectionStore:n})}),[t,n]),W=!j||O,E=(0,a.useCallback)((e=>(0,a.createElement)(gt,{...e,key:t.id,actions:N,caption:L,focused:r,hasWarning:W,onClick:B,onDelete:I?F:void 0,onDisable:j&&I&&v?Z:void 0,onDuplicate:V?_:void 0,onEdit:V?B:void 0,onEnable:!j&&I&&v?K:void 0,title:M,triggers:R})),[N,t.id,V,I,L,r,W,j,v,F,Z,_,B,K,M,R]);return(0,D.jsx)(xe.y,{caption:L,renderOrigin:E,title:M,tooltipAlignment:Ne.v.Start,tooltipPlacement:Ne.u.Bottom})}function Pt(e){const{collectionStore:t,propertyActionValue:o,propertySchema:n}=e,i=(0,ne.useIntl)(),r=(0,l.VK)((()=>(0,pe.U)({getRecordModel:t.getRecordModel,propertySchema:n,value:o.value})),[t.getRecordModel,o.value,n]),a=(0,l.VK)((()=>(0,Te.y3)({actors:r,intl:i,propertySchema:n,messageType:"action"})),[r,i,n]);return a||null}function wt(e){var t;const{propertyActionValue:o,propertySchema:n}=e,i=(0,S.A6)(null===(t=o.value)||void 0===t?void 0:t.value)[0],r=(0,ne.useIntl)(),a=(0,he.LQ)({intl:r,propertySchema:n,value:i});return a||null}function Vt(e){var t,o;const{propertyActionValue:n,propertySchema:i}=e,r=(0,ne.useIntl)(),a=null!==(t=n.value)&&void 0!==t&&t.value?(0,S.A6)(null===(o=n.value)||void 0===o?void 0:o.value):[],s=ke.oJ({limit:de.H,propertySchema:i,optionValues:a.map((e=>"string"==typeof e?e:void 0)).filter(ie.$K)});return(0,l.VK)((()=>(0,ge.I7)({intl:r,propertySchema:i,values:s})),[r,s,i])}function It(e){const{propertyActionValue:t,propertySchema:o}=e;return(0,ce.G7)({propertySchema:o,value:t.value})}function Ft(e){const{collectionStore:t,propertyActionValue:o,propertySchema:n,automationContextStore:i}=e,r=(0,ne.useIntl)(),a=(0,s.O7)(),c=o.value,u=(0,l.VK)((()=>i.getAllContextValues()),[i]);return(0,l.VK)((()=>(0,me.wr)({automationContextValues:u,collectionStore:t,environment:a,intl:r,propertySchema:n,value:c})),[u,t,a,r,n,c])}function Zt(e){const{automationContextStore:t,collectionStore:o,propertyActionValue:n,propertyId:i,propertySchema:r}=e,s=(0,ne.useIntl)(),c=n.value,u=(0,a.useMemo)((()=>({type:"collection",collectionStore:o,property:i})),[o,i]),d=(0,l.VK)((()=>(0,ue.kD)({automationContextStore:t,intl:s,propertySchema:r,value:c,valueContext:u})),[t,s,r,c,u]);return d||null}function Bt(e){const{automationStore:t,propertyActionValue:o,propertySchema:n}=e,i=(0,s.O7)(),r=(0,c.Fg)(),a=(0,l.VK)((()=>(0,ye.lG)({automationStore:t,environment:i,propertySchema:n,theme:r,value:o.value})),[t,i,o.value,n,r]);return a||null}function Kt(e){return(0,ie.$K)(e)?Tt[e]??Q.S:Q.S}},311335:(e,t,o)=>{o.d(t,{EF:()=>B,Li:()=>T,R4:()=>_,Xd:()=>k,cB:()=>Z,i1:()=>A,qM:()=>P,qk:()=>M,rU:()=>F,sA:()=>K,vM:()=>I,wB:()=>j});o(21703);var n=o(443261),i=o.n(n),r=o(603865),a=o(823290),s=o(576205),l=o(901274),c=o(335102),u=o(471924),d=o(186517),p=o(177420),m=o(606287),g=o(76233),h=o(653965),y=o(940470),f=o(401898),x=o(319385),S=o(206258),v=o(535057),b=o(623879),C=o(433929);function k(e){return e.isTriggerType("event")||e.isTriggerType("notification_event")}function M(e){const{automationContextStore:t,automationStore:o,collectionStore:n}=e,i=n.getSchema(),r=o.getKeyStore("properties").getKeyStore("name").getValue();if(null==r||!r.trim())return!1;const a=o.getTrigger(),s="event"===(null==a?void 0:a.type),l="notification_event"===(null==a?void 0:a.type);if(!s&&!l)return!1;const{pagesAdded:u,pagePropertiesEdited:d,source:p}=a.event;if(void 0===p)return!1;if("some"===d.type&&d.some.some((e=>w({collectionSchema:i,property:e.property})||V({collectionSchema:i,property:e.property,type:"trigger"}))))return!1;if(!u&&("none"===d.type||"some"===d.type&&0===d.some.length))return!1;const m=o.getActionStores().filter((e=>e.isDefined()));return 0!==m.length&&m.every((e=>function(e){const{actionStore:t,automationContextStore:o,collectionStore:n}=e,i=(null==o?void 0:o.getValidationErrorsForAction(t.id))||[];if(i.length>0)return!1;if(t.isType("slack_notification"))return(0,f.$K)(t.getConfigStore().getKeyStore("external_bot_id").getValue())&&(0,f.$K)(t.getConfigStore().getKeyStore("target").getValue());if(t.isType("update_pages")){const e=t.getConfigStore().getKeyStore("target").getValue(),i=t.getConfigStore().getKeyStore("properties").getValue()??[];if(!(0,f.$K)(e)||0===i.length)return!1;if("collection"===e.type){const t=S.NW.createChildStore(n,e.collection).getSchema();if(i.some((e=>w({property:e,collectionSchema:t})||V({collectionSchema:t,property:e,type:"action"}))))return!1}else if("variable"===e.type){const t=(0,c.MY)(e.id);if("global"===t.source&&"button_page"===t.global){const e=n.getSchema();if(i.some((t=>w({property:t,collectionSchema:e})||V({collectionSchema:e,property:t,type:"action"}))))return!1}else{const t=null==o?void 0:o.compilationResultStore.state;if(!t||y.x.isFail(t))return!1;const n=(0,c.vx)(t.value.valueTypes,e.id),r=n?j(n,o.context.parentRecordStore):void 0;if(!r)return!1;const a=r.getSchema();if(i.some((e=>w({property:e,collectionSchema:a})||V({collectionSchema:a,property:e,type:"action"}))))return!1}}else{if("page"===e.type)return!1;(0,f.t1)(e)}return!0}if(t.isType("create_page")){const e=t.getConfigStore().getKeyStore("collection").getValue();if(!(0,f.$K)(e))return!1;const o=S.NW.createChildStore(n,e).getSchema();return!(t.getConfigStore().getKeyStore("properties").getValue()??[]).some((e=>w({property:e,collectionSchema:o})||V({collectionSchema:o,property:e,type:"action"})))}if(t.isType("assistant"))return!0;if(t.isType("send_in_app_notification")){const e=t.getConfigStore(),o=e.getKeyStore("target").getValue(),n=e.getKeyStore("notification_message").getValue();if(!o||!n||(0,g.PgY)(n.value))return!1;switch(o.type){case"property":if(!o.propertyId||!o.collectionPointer)return!1;break;case"formula":if(!o.value||!o.value.value||h.xb(o.value.value))return!1}return!0}throw new Error(`isActionStoreComplete not implemented for ${t.getType()}`)}({actionStore:e,automationContextStore:t,collectionStore:n})))}function j(e,t){let o;return"block"===e.type.type&&e.type.collection?o=S.NW.createChildStore(t,e.type.collection):"array"===e.type.type&&"block"===e.type.of.type&&e.type.of.collection&&(o=S.NW.createChildStore(t,e.type.of.collection)),o}function T(e){const{collectionStore:t}=e;if(!t||R(t)||N(t))return!1;if((t.getFormat().automation_ids??[]).length>=a.ss&&!(0,v.sX)())return!1;const o=t.pointer,n=t.getSpaceId();return(0,l.IC)({targetTriggerType:"event",targetParentPointer:o,targetSpaceId:n}).every((e=>{let{pointer:o,minimumRequiredRole:n}=e;const i=t.getRecordRole(o);return!!i&&(0,d.yY)(i,n)}))}function A(e){const{automationStore:t,actionStores:o,collectionStore:n}=e,i=t.getParentStore();if(!i||R(i)||N(n))return!1;const r=t.getMinimumFieldsForPermissions();if(!r)return!1;if(!o.every((e=>e.isDefined())))return!1;const a=o.some((e=>!e.isType("slack_notification")));if(!(0,v.sX)()&&a)return!1;return(0,l.fz)({automationValue:r,actionValues:o.map((e=>({config:e.getConfig(),type:e.getType()})))}).every((e=>{let{pointer:o,minimumRequiredRole:n}=e;const i=t.getRecordRole(o);return!!i&&(0,d.yY)(i,n)}))}function P(e){const{automationStore:t,collectionStore:o}=e,n=t.getParentStore();if(!n||R(n)||N(o))return!1;const i=t.getMinimumFieldsForPermissions();if(!i)return!1;return(0,l.bM)(i).every((e=>{let{pointer:o,minimumRequiredRole:n}=e;const i=t.getRecordRole(o);return!!i&&(0,d.yY)(i,n)}))}function w(e){const{property:t,collectionSchema:o}=e;return!!o&&!o[t]}function V(e){const{collectionSchema:t,property:o,type:n}=e,i=null==t?void 0:t[o];return!i||("action"===n?!(0,r.SF)(i):!r.Ym[i.type])}function I(e){const{automationStore:t,collectionStore:o}=e;if(!t.isTriggerType("event")&&!t.isTriggerType("notification_event"))return!1;const n=t.getEventConfiguration();if(!n||void 0===n.source||n.source.type===m.vF||"filter"===n.source.type)return!1;const i=S.Xr.createChildStore(o,n.source.pointer);return function(e){const t=F(e);return(0,f.$K)(t)}({collectionSchema:o.getSchema(),collectionViewStore:i})}function F(e){var t;const{collectionViewStore:o,collectionSchema:n}=e,i=o.getPropertyFiltersStore().getValue()??[],a=null===(t=o.getQuery(n))||void 0===t?void 0:t.filter,l={operator:"and",filters:(0,s.OH)({propertyFilters:i,combinatorFilter:a,schema:n})},c=(0,s.SH)(l,(e=>{if((0,s.aN)(e)){const t=n[e.property];return!!t&&!(0,r.TX)(t)}return!1}));if(c)return(0,s.aN)(c)?c.property:(0,s.Mm)(c)?c.timestamp:void 0}function Z(e){if("collectionTypedView"===e.contextType)return!1;const t=e.collectionStore();return!!t&&(!(t.isSyncedCollection()&&!x.default.checkGate({gateName:"support_synced_database_automations"}))&&void 0===e.collectionViewModuleContextStore.state)}function B(e){const{collectionSchema:t,propertyIds:o,searchTerm:n}=e;if(!n)return o.slice(0);const r=new Map,a=o.map((e=>{const o=t[e],n=o?`${o.name} ${b.SO[o.type]}`:"";return r.set(e,n),n})),s=i().filter(n,a).map((e=>{let{original:t}=e;return t}));return o.filter((e=>s.includes(r.get(e)??"")))}function K(e){const{automationId:t,automationName:o,collectionStore:n,userId:i}=e;return function(e){const{actionIds:t,automationId:o,collectionStore:n,eventConfiguration:i,lastEditedTime:r,properties:a,userId:s}=e,l=Date.now();return{action_ids:t,alive:!0,created_by_id:s,created_by_table:"notion_user",created_time:l,id:o,last_edited_by_id:s,last_edited_by_table:"notion_user",last_edited_time:r??l,parent_id:n.id,parent_table:m.vF,properties:a??{},space_id:n.getSpaceId(),status:"active",trigger:{event:i,id:u.Il(),type:"event"},version:1}}({actionIds:[],automationId:t,collectionStore:n,eventConfiguration:{pagesAdded:!1,pagePropertiesEdited:{type:"none"},source:{pointer:n.getSpaceShardedPointer(),type:m.vF}},properties:{name:o},userId:i})}function _(e){const t=e.getActionStores().filter((0,f.AO)((e=>e.isType("slack_notification")?{true:e}:{false:e}))),o={};for(const n of t){const e=n.getConfig(),t=null==e?void 0:e.external_bot_id;if(!t)continue;const i=S.Qx.createChildStore(n,{id:t,spaceId:n.getSpaceId(),table:p.cZ}).getCreatedByStore();i&&(o[n.id]=i.getDisplayName(C.default.getIntl()))}return o}function R(e){if(!x.default.checkGate({gateName:"prevent_edits_trash"}))return!1;const t=e.getParentBlockStore();return!t||t.pathIsDead()}function N(e){const t=e.getParentBlockStore();return(null==t?void 0:t.isLocked())??!0}},18441:(e,t,o)=>{o.d(t,{P9:()=>l,YJ:()=>c,jc:()=>s,jg:()=>a});o(757658);var n=o(977657),i=o(959753),r=o(332161);function a(e){if(e.integration_id!==n.nO)throw"Cannot render account for integration.";const t=/(.+) - (.+)/.exec(e.account_name);if(!t)return{accountName:e.account_name};const[,o,i]=t;return{organizationName:o,accountName:i}}function s(e){return i.kk.fromValue(r.PJ,e).getSlackWorkspaceId()}function l(e,t){return t?e.filter((e=>{const o=s(e);return!!o&&t(o)})):e}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const o={};for(const n of e){const{accountName:e,organizationName:i}=a(n);u({query:t,accountName:e,organizationName:i})&&(o[e]||(o[e]=[]),o[e].push({externalAuthentication:n,workspaceName:i}))}return o}function u(e){const{accountName:t,organizationName:o,query:n}=e;if(0===n.length)return!0;const i=t.toLocaleLowerCase().indexOf(n.trim().toLocaleLowerCase())>=0,r=!!o&&o.toLocaleLowerCase().indexOf(n.trim().toLocaleLowerCase())>=0;return i||r}},558454:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(749085),i=o(292595);class r extends n.default{getInitialState(){return{open:!1}}}const a=new r;(0,i.exposeDebugValue)("AutomationModalStore",a);const s=a},991738:(e,t,o)=>{o.d(t,{Bh:()=>a,H0:()=>s});var n=o(749085),i=o(653965);class r extends n.default{getInitialState(){return{insertionPoint:void 0,stack:[]}}getCurrentTab(){return i.Z$(this.getState().stack)}getInsertionPoint(){return this.getState().insertionPoint}pushSettingsItem(e){this.update((t=>({...t,stack:[...t.stack,e]})))}popSettingsItem(){this.update((e=>({...e,stack:e.stack.slice(0,e.stack.length-1)})))}replaceSettingsItem(e){this.update((t=>{const o=[...t.stack.slice(0,t.stack.length-1),e];return{...t,stack:o}}))}setInsertionPoint(e){this.update((t=>({...t,insertionPoint:e})))}}class a extends r{}class s extends r{}},868016:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(749085),i=o(292595);class r extends n.default{getStateForBot(e){return this.state[e]??{channels:{},fetching:!1,lastRefreshed:0}}updateStateForBot(e,t){this.setState({...this.state,[e]:{...this.getStateForBot(e),...t}})}addChannelsForBot(e,t){const o=this.getStateForBot(e);this.setState({...this.state,[e]:{...o,channels:{...o.channels,...t}}})}}const a=new r;(0,i.exposeDebugValue)("ExternalNotificationChannelsStore",a);const s=a},54983:(e,t,o)=>{o.d(t,{Z:()=>r});var n=o(749085);class i extends n.default{getInitialState(){return{}}}const r=i},665955:(e,t,o)=>{o.d(t,{o:()=>r});o(667294);var n=o(745238),i=o(785893);const r=(0,n.IU)("addPage",{viewBox:"0 0 14 14",svg:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 0c3.861 0 7 3.139 7 7s-3.139 7-7 7-7-3.139-7-7 3.139-7 7-7zM3.561 5.295a1.027 1.027 0 1 0 2.054 0 1.027 1.027 0 0 0-2.054 0zm5.557 1.027a1.027 1.027 0 1 1 0-2.054 1.027 1.027 0 0 1 0 2.054zm1.211 2.816a.77.77 0 0 0-.124-1.087.786.786 0 0 0-1.098.107c-.273.407-1.16.958-2.254.958-1.093 0-1.981-.55-2.244-.945a.788.788 0 0 0-1.107-.135.786.786 0 0 0-.126 1.101c.55.734 1.81 1.542 3.477 1.542 1.668 0 2.848-.755 3.476-1.541z"})})},240745:(e,t,o)=>{o.d(t,{M:()=>r});o(667294);var n=o(745238),i=o(785893);const r=(0,n.IU)("arrowDown",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 1.57715C7.5625 1.57715 7.25488 1.88477 7.25488 2.33594V10.8262L7.30957 12.3027L5.50488 10.2861L3.95312 8.75488C3.82324 8.625 3.63184 8.53613 3.42676 8.53613C3.0166 8.53613 2.70898 8.85059 2.70898 9.26758C2.70898 9.46582 2.78418 9.64355 2.94141 9.80762L7.44629 14.3193C7.59668 14.4697 7.79492 14.5586 8 14.5586C8.20508 14.5586 8.40332 14.4697 8.55371 14.3193L13.0586 9.80762C13.2158 9.64355 13.291 9.46582 13.291 9.26758C13.291 8.85059 12.9902 8.53613 12.5801 8.53613C12.3682 8.53613 12.1836 8.625 12.0469 8.75488L10.4951 10.2861L8.69043 12.2959L8.74512 10.8262V2.33594C8.74512 1.88477 8.44434 1.57715 8 1.57715Z"})})},80721:(e,t,o)=>{o.d(t,{W:()=>r});o(667294);var n=o(745238),i=o(785893);const r=(0,n.IU)("arrowLeftThick",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M1.54004 8.05762C1.54004 8.2627 1.62891 8.46094 1.78613 8.61133L6.29102 13.1162C6.45508 13.2734 6.63965 13.3486 6.82422 13.3486C7.25488 13.3486 7.5625 13.041 7.5625 12.6309C7.5625 12.4189 7.48047 12.2344 7.34375 12.1045L5.8125 10.5527L3.78906 8.70703L5.38867 8.80273H13.7012C14.1455 8.80273 14.46 8.49512 14.46 8.05762C14.46 7.61328 14.1455 7.3125 13.7012 7.3125H5.38867L3.7959 7.4082L5.8125 5.5625L7.34375 4.01074C7.48047 3.87402 7.5625 3.68945 7.5625 3.47754C7.5625 3.06738 7.25488 2.7666 6.82422 2.7666C6.63965 2.7666 6.45508 2.83496 6.27734 3.00586L1.78613 7.50391C1.62891 7.64746 1.54004 7.85254 1.54004 8.05762Z"})})},908597:(e,t,o)=>{o.d(t,{Z:()=>r});o(667294);var n=o(745238),i=o(785893);const r=(0,n.IU)("arrowUp",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 14.5586C8.44434 14.5586 8.74512 14.251 8.74512 13.7998V5.30957L8.69043 3.83984L10.4951 5.84961L12.0469 7.38086C12.1836 7.51074 12.3682 7.59961 12.5801 7.59961C12.9902 7.59961 13.291 7.28516 13.291 6.86816C13.291 6.66992 13.2158 6.49219 13.0586 6.32812L8.55371 1.81641C8.40332 1.66602 8.20508 1.57715 8 1.57715C7.79492 1.57715 7.59668 1.66602 7.44629 1.81641L2.94141 6.32812C2.78418 6.49219 2.70898 6.66992 2.70898 6.86816C2.70898 7.28516 3.0166 7.59961 3.42676 7.59961C3.63184 7.59961 3.82324 7.51074 3.95312 7.38086L5.50488 5.84961L7.30957 3.83301L7.25488 5.30957V13.7998C7.25488 14.251 7.5625 14.5586 8 14.5586Z"})})},982114:(e,t,o)=>{o.d(t,{Q:()=>i,p:()=>r});o(667294);var n=o(745238);const i=(0,o(785893).jsx)("path",{d:"M.911 8.034c0 4.505 3.049 7.24 7.246 7.24 1.135 0 2.215-.158 2.885-.376.472-.15.622-.397.622-.65a.44.44 0 00-.451-.444 1.3 1.3 0 00-.321.048c-.834.205-1.552.341-2.516.341-3.74 0-6.29-2.255-6.29-6.118 0-3.698 2.407-6.275 6.03-6.275 3.206 0 5.886 1.975 5.886 5.523 0 2.072-.697 3.466-1.825 3.466-.752 0-1.176-.437-1.176-1.183V4.972c0-.37-.205-.595-.554-.595-.341 0-.553.226-.553.595v.779h-.062c-.349-.84-1.203-1.374-2.222-1.374-1.77 0-3.014 1.51-3.014 3.678 0 2.187 1.237 3.712 3.042 3.712 1.06 0 1.88-.575 2.276-1.545h.062c.13.963.943 1.551 2.023 1.551 1.907 0 3.09-1.873 3.09-4.498 0-3.971-2.92-6.548-6.96-6.548C3.886.727.912 3.632.912 8.034zm6.911 2.652c-1.223 0-2.003-1.018-2.003-2.638 0-1.593.786-2.611 2.01-2.611 1.258 0 2.05.998 2.05 2.584 0 1.62-.813 2.665-2.057 2.665z"}),r=(0,n.IU)("at",{viewBox:"0 0 16 16",svg:i})},665422:(e,t,o)=>{o.d(t,{K:()=>r});o(667294);var n=o(745238),i=o(785893);const r=(0,n.IU)("boltFilled",{svg:(0,i.jsx)("path",{d:"M0 12.117c0 .38.293.664.703.664h5.518l-2.91 7.91c-.381 1.006.664 1.543 1.318.723l8.877-11.094c.166-.205.254-.4.254-.625 0-.371-.293-.664-.703-.664H7.539l2.91-7.91C10.83.115 9.785-.422 9.131.408L.254 11.492c-.166.215-.254.41-.254.625z"}),viewBox:"0 0 14 22"})},213148:(e,t,o)=>{o.d(t,{U:()=>r});o(667294);var n=o(745238),i=o(785893);const r=(0,n.IU)("close",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.89795 13.3428C3.18799 13.6262 3.6626 13.6262 3.93945 13.3494L7.99341 9.29541L12.0474 13.3494C12.3308 13.6262 12.8054 13.6328 13.0889 13.3428C13.3723 13.0593 13.3723 12.5847 13.0955 12.3079L9.0415 8.24731L13.0955 4.19336C13.3723 3.9165 13.3789 3.4353 13.0889 3.15845C12.7988 2.875 12.3308 2.875 12.0474 3.15186L7.99341 7.20581L3.93945 3.15186C3.6626 2.875 3.1814 2.86841 2.89795 3.15186C2.6145 3.44189 2.62109 3.9231 2.89795 4.19336L6.9519 8.24731L2.89795 12.3079C2.62109 12.5781 2.6145 13.0659 2.89795 13.3428Z"})})},964275:(e,t,o)=>{o.d(t,{D:()=>r});o(667294);var n=o(745238),i=o(785893);const r=(0,n.IU)("closeSmall",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.732 11.052c-.303.308-.32.877.011 1.202.33.33.894.32 1.203.011L8 9.21l3.05 3.05c.32.325.872.32 1.197-.011a.857.857 0 00.01-1.197L9.21 8.002l3.05-3.056a.857.857 0 00-.01-1.197.857.857 0 00-1.198-.01L8 6.788 4.946 3.732c-.31-.303-.878-.32-1.203.01-.325.331-.314.895-.01 1.203l3.055 3.056-3.056 3.05z"})})},950780:(e,t,o)=>{o.d(t,{E:()=>r});o(667294);var n=o(745238),i=o(785893);const r=(0,n.IU)("editPropertyType",{viewBox:"0 0 16 16 ",svg:(0,i.jsx)("path",{d:"M11.5615 4.84473L12.2998 4.11328C12.6689 3.74414 12.6826 3.34082 12.3545 3.00586L12.0879 2.73926C11.7529 2.4043 11.3428 2.43848 10.9736 2.79395L10.2354 3.52539L11.5615 4.84473ZM3.22168 13.1641L10.9053 5.4873L9.59277 4.16797L1.90918 11.8516L1.23926 13.4512C1.16406 13.6562 1.37598 13.875 1.57422 13.7998L3.22168 13.1641ZM3.92578 13.8066H14.1045C14.4736 13.8066 14.7744 13.499 14.7744 13.1367C14.7744 12.7676 14.4736 12.4668 14.1045 12.4668H5.27246L3.92578 13.8066Z"})})},239132:(e,t,o)=>{o.d(t,{c:()=>r});o(667294);var n=o(745238),i=o(785893);const r=(0,n.IU)("eye",{viewBox:"0 0 32 32",svg:(0,i.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})},612392:(e,t,o)=>{o.d(t,{S:()=>r});o(667294);var n=o(745238),i=o(785893);const r=(0,n.IU)("historyBack",{viewBox:"0 0 14 14",svg:(0,i.jsx)("polygon",{points:"2.85893 7.74676 8.05608 12.9439 7 14 0.528042 7.52804 0 7 0.528042 6.47196 7 0 8.05608 1.05608 2.85893 6.25324 14 6.25324 14 7.74676"})})},701230:(e,t,o)=>{o.d(t,{H:()=>r});o(667294);var n=o(745238),i=o(785893);const r=(0,n.IU)("insertDown",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M9.55548 13.0343H14.2085C14.5315 13.0343 14.7951 13.2913 14.7951 13.6142C14.7951 13.9372 14.5315 14.1942 14.2085 14.1942H9.55548C9.23254 14.1942 8.9755 13.9372 8.9755 13.6142C8.9755 13.2913 9.23254 13.0343 9.55548 13.0343ZM1.21167 9.67959C1.21167 9.09961 1.52802 8.74371 2.0421 8.74371C2.55617 8.74371 2.87911 9.11279 2.87911 9.65982V10.7868C2.87911 10.945 2.96479 11.0373 3.12956 11.0373H4.70473V10.365C4.70473 9.818 5.26494 9.60709 5.68675 9.94322L7.56509 11.4525C7.84849 11.6766 7.84849 12.0786 7.56509 12.2961L5.68675 13.812C5.25176 14.1679 4.70473 13.9569 4.70473 13.3836V12.7047H2.93184C1.89051 12.7047 1.21167 12.0984 1.21167 11.057V9.67959ZM9.55548 9.58073H14.2085C14.5315 9.58073 14.7951 9.83777 14.7951 10.1607C14.7951 10.4837 14.5315 10.7407 14.2085 10.7407H9.55548C9.23254 10.7407 8.9755 10.4837 8.9755 10.1607C8.9755 9.83777 9.23254 9.58073 9.55548 9.58073ZM1.78506 6.12721H14.2085C14.5315 6.12721 14.7951 6.38425 14.7951 6.70719C14.7951 7.03014 14.5315 7.28717 14.2085 7.28717H1.78506C1.46211 7.28717 1.20508 7.03014 1.20508 6.70719C1.20508 6.38425 1.46211 6.12721 1.78506 6.12721ZM1.78506 2.68028H14.2085C14.5315 2.68028 14.7951 2.93073 14.7951 3.25367C14.7951 3.5832 14.5315 3.83365 14.2085 3.83365H1.78506C1.46211 3.83365 1.20508 3.5832 1.20508 3.25367C1.20508 2.93073 1.46211 2.68028 1.78506 2.68028Z"})})},241490:(e,t,o)=>{o.d(t,{F:()=>r});o(667294);var n=o(745238),i=o(785893);const r=(0,n.IU)("insertUp",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M9.55566 3.61987H14.2095C14.5325 3.61987 14.7961 3.36279 14.7961 3.03979C14.7961 2.7168 14.5325 2.45972 14.2095 2.45972H9.55566C9.23267 2.45972 8.97559 2.7168 8.97559 3.03979C8.97559 3.36279 9.23267 3.61987 9.55566 3.61987ZM1.21045 6.9751C1.21045 7.55518 1.52686 7.91113 2.04102 7.91113C2.55518 7.91113 2.87817 7.54199 2.87817 6.99487V5.86768C2.87817 5.70947 2.96387 5.61719 3.12866 5.61719H4.7041V6.28955C4.7041 6.83667 5.2644 7.04761 5.68628 6.71143L7.56494 5.2019C7.84839 4.97778 7.84839 4.57568 7.56494 4.35815L5.68628 2.84204C5.25122 2.48608 4.7041 2.69702 4.7041 3.27051V3.94946H2.93091C1.8894 3.94946 1.21045 4.55591 1.21045 5.59741V6.9751ZM9.55566 7.07397H14.2095C14.5325 7.07397 14.7961 6.81689 14.7961 6.4939C14.7961 6.1709 14.5325 5.91382 14.2095 5.91382H9.55566C9.23267 5.91382 8.97559 6.1709 8.97559 6.4939C8.97559 6.81689 9.23267 7.07397 9.55566 7.07397ZM1.78394 10.5281H14.2095C14.5325 10.5281 14.7961 10.271 14.7961 9.948C14.7961 9.625 14.5325 9.36792 14.2095 9.36792H1.78394C1.46094 9.36792 1.20386 9.625 1.20386 9.948C1.20386 10.271 1.46094 10.5281 1.78394 10.5281ZM1.78394 13.9756H14.2095C14.5325 13.9756 14.7961 13.7251 14.7961 13.4021C14.7961 13.0725 14.5325 12.822 14.2095 12.822H1.78394C1.46094 12.822 1.20386 13.0725 1.20386 13.4021C1.20386 13.7251 1.46094 13.9756 1.78394 13.9756Z"})})},38715:(e,t,o)=>{o.d(t,{N:()=>r});o(667294);var n=o(745238),i=o(785893);const r=(0,n.IU)("save",{viewBox:"0 0 16 16",svg:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("path",{d:"M7.99316 10.8877C7.8291 10.8877 7.67871 10.833 7.52148 10.6758L5.22461 8.46094C5.1084 8.34473 5.04004 8.22168 5.04004 8.05762C5.04004 7.74316 5.29297 7.51074 5.60059 7.51074C5.75781 7.51074 5.92188 7.5791 6.03125 7.70215L6.98828 8.7207L7.43262 9.22656L7.36426 8.20801V1.11914C7.36426 0.78418 7.65137 0.49707 7.99316 0.49707C8.3418 0.49707 8.62891 0.78418 8.62891 1.11914V8.20801L8.56055 9.21973L8.99805 8.7207L9.96191 7.70215C10.0713 7.5791 10.2285 7.51074 10.3857 7.51074C10.6934 7.51074 10.9463 7.74316 10.9463 8.05762C10.9463 8.22168 10.8848 8.34473 10.7686 8.46094L8.47168 10.6758C8.31445 10.833 8.16406 10.8877 7.99316 10.8877ZM4.0625 15.3174C2.58594 15.3174 1.82031 14.5586 1.82031 13.1025V6.36914C1.82031 4.91309 2.58594 4.1543 4.0625 4.1543H6.04492V5.49414H4.14453C3.50879 5.49414 3.16016 5.82227 3.16016 6.48535V12.9863C3.16016 13.6494 3.50879 13.9775 4.14453 13.9775H11.8486C12.4775 13.9775 12.833 13.6494 12.833 12.9863V6.48535C12.833 5.82227 12.4775 5.49414 11.8486 5.49414H9.94824V4.1543H11.9307C13.4072 4.1543 14.1729 4.91309 14.1729 6.36914V13.1025C14.1729 14.5586 13.4072 15.3174 11.9307 15.3174H4.0625Z"})})})},435840:(e,t,o)=>{o.d(t,{R:()=>r,T:()=>i});o(667294);var n=o(745238);const i=(0,o(785893).jsx)("path",{d:"M.281 6.438c0-.875.164-1.696.492-2.461a6.484 6.484 0 011.375-2.032A6.237 6.237 0 016.64.078 6.2 6.2 0 019.11.57c.77.328 1.447.787 2.03 1.375a6.374 6.374 0 011.368 2.032c.333.765.5 1.586.5 2.46 0 .688-.107 1.342-.32 1.961a6.28 6.28 0 01-.868 1.696l3.563 3.578c.11.104.19.226.242.367.057.14.086.29.086.445 0 .22-.05.417-.149.594a1.122 1.122 0 01-1 .57c-.156 0-.307-.028-.453-.086a1.058 1.058 0 01-.382-.25l-3.586-3.585c-.5.333-1.047.596-1.641.789a6.089 6.089 0 01-1.86.28 6.237 6.237 0 01-2.468-.491 6.4 6.4 0 01-2.024-1.367A6.509 6.509 0 01.773 8.913a6.256 6.256 0 01-.492-2.476zm1.664 0c0 .65.12 1.26.36 1.828a4.775 4.775 0 001.015 1.5c.433.427.933.763 1.5 1.007a4.548 4.548 0 001.82.368c.652 0 1.261-.123 1.829-.368a4.747 4.747 0 002.508-2.507 4.567 4.567 0 00.367-1.829c0-.645-.123-1.252-.367-1.82a4.776 4.776 0 00-1.016-1.5A4.578 4.578 0 008.469 2.11a4.567 4.567 0 00-1.828-.367c-.646 0-1.253.123-1.82.367a4.667 4.667 0 00-1.5 1.008c-.433.432-.772.932-1.016 1.5a4.633 4.633 0 00-.36 1.82z"}),r=(0,n.IU)("search",{viewBox:"0 0 16 16",svg:i})}}]);