"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[58586,43617],{924212:(e,t,n)=>{n.d(t,{Op:()=>A,Oq:()=>D});n(757658),n(667294);var s=n(541432),i=n(388437),o=n(931278),a=n(79310),r=n(937612),l=n(709291),d=n(838745),c=n(403297),u=n(742858),m=n(210228),p=n(552275),g=n(731278),f=n(672495),h=n(119037),y=n(628020),x=n(548779),S=n(966324),v=n(80444),b=n(175306),M=n(482763),j=n(129768),C=n(62967),w=n(342784),k=n(802295),I=n(212988),T=n(206471),Z=n(405337),P=n(785893);const F=(0,l.defineMessages)({unpinName:{id:"action.unpin.name",defaultMessage:"Remove from sidebar"},leaveName:{id:"action.leave.name",defaultMessage:"Leave"},duplicateToName:{id:"action.duplicateTo.name",defaultMessage:"Duplicate to"}}),_=(0,C.cN)({key:"remove pinned shared page",displayName:F.unpinName,analyticsName:F.unpinName.defaultMessage,svg:a.A,validators:[h.cWe,h.uqO,h.ffD(h.zME)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const{currentSpaceViewStore:s,currentUserSettingsStore:i}=v.default.state;s&&i&&(m.createAndCommit({userAction:"actionRegistry.removePinnedSharedPage",environment:n,perform:e=>{for(const o of t)S.unpinSharedPage({environment:n,transaction:e,spaceViewStore:s,userSettingsStore:i,store:o})}}),d.An(n,{type:"shared",from:"sidebar_dropdown_menu"}))}}),A=(0,C.cN)({key:"delete block without shortcuts",displayName:C.RE.deleteName,analyticsName:C.RE.deleteName.defaultMessage,svg:r.y,validators:[h.or([h.DFt,h.STD]),h.eot,h.ffD(h.sRS),h.ffD(h.P99(s.Ti.externalObjectInstancePage)),h.ffD(h.Q_M),h.vdd,h.ffD(h.uY7)],closeParentMenu:!0,action:async e=>{let{blocks:t,environment:n}=e;await u.Qw({environment:n,blocks:t,shouldCheckSuggestEdit:!1})}}),B=(0,C.cN)({key:"leave shared page",displayName:F.leaveName,analyticsName:F.leaveName.defaultMessage,svg:o.S,validators:[h.cWe,h.zl0],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;m.createAndCommit({userAction:"actionRegistry.leaveSharedPage",environment:n,perform:e=>{S.leaveBlocks({environment:n,blocks:t,transaction:e})}})}}),R=(0,C.MV)({key:"duplicate to workspace",displayName:F.duplicateToName,analyticsName:F.duplicateToName.defaultMessage,svg:i.a,validators:[h.DFt,h.nJQ,h.zzA,h.ffD(h.KEd),h.Jlb],subActions:e=>{let{blocks:t,environment:n}=e;const{currentUserRootStore:s}=v.default.state;if(!s)return[];const i=t[0],o=y.o(s),a=[];for(const r of o){const e=r.getSpaceStore();if(e){const t=(0,x.rn)(n,e),s=(0,x.Wd)(n,e);a.push({key:r.id,displayName:t||"",analyticsName:"Duplicate to workspace",searchName:t||"",closeParentMenu:!0,action:async()=>{await c.DK({environment:n,store:i,spaceStore:e,spaceViewStore:r,isPrivate:!0,context:"duplicate_to_another_space"})},render:(e,n)=>{let{environment:i}=n;return(0,P.jsx)(p.Z,{title:t,icon:(0,P.jsx)(g.Z,{icon:s,isEmptyPage:!1,title:t,size:i.device.isMobile?24:20,disabled:!0}),...e})}})}}return[(0,C.$J)({key:"duplicate-to",render:e=>(0,P.jsx)(f.Z,{...e}),actions:a})]}}),D=[w.ww,{key:"outliner organization actions",render:e=>(0,P.jsx)(f.Z,{...e}),actions:[b._p,b.zm,_,B]},{key:"outliner primary actions",render:e=>(0,P.jsx)(f.Z,{...e}),actions:[M.H,M.K,b.Dw,b.IK,j.o1,j.vh,j.fI,j.MI,R,T.$,k.A,A]},{key:"turn page into",render:e=>(0,P.jsx)(f.Z,{...e}),actions:[Z.NO,Z.LM,Z.BW]},{key:"outliner navigation",render:e=>(0,P.jsx)(f.Z,{...e}),actions:I.ej}]},405337:(e,t,n)=>{n.d(t,{NO:()=>A,LM:()=>F,BW:()=>R,bV:()=>O,R$:()=>L});n(667294);var s=n(762208),i=n(373039),o=n(355863),a=n(76233),r=n(709291),l=n(137810),d=n(547307),c=n(210228),u=n(512304),m=n(672495),p=n(724405),g=n(98742),f=n(825464),h=n(693405),y=n(974420),x=n(526388),S=n(785893);function v(e){let{menuListItemProps:t,title:n,caption:s,icon:i,disabled:o,tooltipText:a,showNewBadge:r}=e;const l=(0,p.yK)((()=>({menuItem:{WebkitBackfaceVisibility:"hidden"},caption:{whiteSpace:"pre-wrap"}})),[]);return(0,S.jsx)(x.Z,{placement:f.u.Bottom,disableTooltip:!a,renderTooltip:()=>a,render:e=>(0,S.jsx)(h.Z,{...(0,g.Z)(t,e),style:l.menuItem,title:n,caption:s,captionStyle:s?l.caption:void 0,svg:i,disabled:o,disabledFeedback:o,right:r&&(0,S.jsx)(y.Z,{})})})}var b=n(119037),M=n(195697),j=n(319385),C=n(21884),w=n(535057),k=n(973466),I=n(62967),T=n(811732);const Z=(0,r.defineMessages)({createTeamFromPageFullName:{id:"action.createTeamFromPage.fullName",defaultMessage:"Turn into teamspace"},createTeamFromPageCaption:{id:"action.createTeamFromPage.caption",defaultMessage:"Space for your team to customize permissions and collaborate"},createTeamFromPageName:{id:"action.createTeamFromPage.name",defaultMessage:"Teamspace"},turnPageIntoWikiCaption:{id:"action.turnPageIntoWiki.caption",defaultMessage:"Organize by owner, tags, verification, and more"},turnPageIntoWikiName:{id:"action.turnPageIntoWiki.name",defaultMessage:"Wiki"},undoTurnPageIntoWikiName:{id:"action.undoTurnPageIntoWiki.name",defaultMessage:"Undo wiki"},turnPageIntoWikiFullName:{id:"action.turnPageIntoWiki.fullName",defaultMessage:"Turn into wiki"}});function P(e,t){return(0,I.cN)({key:"turn page into team",displayName:t,analyticsName:Z.createTeamFromPageFullName.defaultMessage,svg:s.z,validators:e,closeParentMenu:!0,render:(e,n)=>{const s=function(e){const{blockStore:t,environment:n}=e;if(!n.currentUser.id)return;if(0===a.QaF(t.getTitleValue()).length)return(0,S.jsx)(r.FormattedMessage,{defaultMessage:"Cannot turn page without a title into a Teamspace",id:"sidebar.turnPageIntoTeamButton.missingTitleDisabledTooltip"});if("private"===(0,M.Pr)(t).accessLevel&&!(0,w.Rs)())return(0,S.jsx)(r.FormattedMessage,{defaultMessage:"Only Business Plans and above can turn a private page into a Teamspace",id:"sidebar.turnPageIntoTeamButton.privateTeamsOnlyOnBusinessPlansAndAboveDisabledTooltip"})}({environment:n.environment,blockStore:n.blocks[0]});return(0,S.jsx)(v,{menuListItemProps:e,title:(0,S.jsx)(r.FormattedMessage,{...t}),caption:(0,S.jsx)(r.FormattedMessage,{...Z.createTeamFromPageCaption}),disabled:Boolean(s),tooltipText:s,icon:i.K})},action:e=>{let{blocks:t,environment:n}=e;const s=t[0];k.VG({environment:n,page:s})}})}const F=P([b.xDy([b.jp9,b.ffD(b.KSG)])],Z.createTeamFromPageFullName),_=P([b.jp9],Z.createTeamFromPageName),A=(0,I.MV)({key:"turn into teamspace or wiki",displayName:T.s.turnIntoSection,analyticsName:T.s.turnIntoSection.defaultMessage,svg:s.z,validators:[b.jp9,b.KSG],subActions:()=>[(0,I.$J)({key:"turn into teamspace or wiki",render:e=>(0,S.jsx)(m.Z,{...e}),actions:[_,D]})],width:300});function B(e,t){return(0,I.cN)({key:"turn page into wiki",displayName:t,analyticsName:Z.turnPageIntoWikiFullName.defaultMessage,svg:s.z,validators:e,closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;"bottom_right"===j.default.getEligibleGroup({experimentId:"wiki_education_convert_modal",defaultGroup:"control"})?C.E.setState({showConvertTooltip:!1,forceShow:!0,pendingWikiBlockStore:n[0]}):c.createAndCommit({userAction:"actionRegistry.turnIntoAction.wiki",environment:t,perform:e=>{u.Y({environment:t,blocks:n,transaction:e,source:"page_menu"})}})},render:e=>(0,S.jsx)(v,{menuListItemProps:e,title:(0,S.jsx)(r.FormattedMessage,{...t}),disabled:!1,icon:s.z,tooltipText:(0,S.jsx)(r.FormattedMessage,{...Z.turnPageIntoWikiCaption})})})}const R=B([b.xDy([b.KSG,b.ffD(b.jp9)]),b.ffD(b.uY7)],Z.turnPageIntoWikiFullName),D=B([b.KSG],Z.turnPageIntoWikiName);const O=B([b.KSG,b.ffD(b.uY7)],Z.turnPageIntoWikiFullName),L=(0,I.cN)({key:"undo turn page into wiki",displayName:Z.undoTurnPageIntoWikiName,analyticsName:Z.undoTurnPageIntoWikiName.defaultMessage,svg:o.s,validators:[b.U7o,b.U_8,b.ffD(b.p1d),b.f7f,b.zzA,b.ffD(b.uY7)],closeParentMenu:!0,action:async e=>{let{environment:t,blocks:n}=e;await d.confirmUserAction({message:(0,S.jsx)("div",{style:{textAlign:"center"},children:(0,S.jsx)(r.FormattedMessage,{defaultMessage:"Are you sure you want to turn <bold>{pageName}</bold> back into a normal page?",id:"action.undoTurnIntoWiki.message",values:{pageName:a.QaF(n[0].getTitleValue()),bold:e=>(0,S.jsx)("span",{style:{fontWeight:l.Z.fontWeight.semibold},children:e})}})}),description:(0,S.jsx)("div",{style:{textAlign:"center"},children:(0,S.jsx)(r.FormattedMessage,{defaultMessage:"This will remove properties like owners and verification from your pages",id:"action.undoTurnIntoWiki.description"})})})&&c.createAndCommit({userAction:"actionRegistry.undoTurnIntoAction.wiki",environment:t,perform:e=>{u.Cq({environment:t,blocks:n,transaction:e,source:"page_menu"})}})}})},25777:(e,t,n)=>{n.d(t,{Ce:()=>a,IC:()=>c,Jv:()=>m,QF:()=>u,Yc:()=>i,az:()=>r,eO:()=>d,s4:()=>l,ti:()=>o});var s=n(730459);function i(e,t){s.K4(e,"workspace_creation_ability",t)}function o(e,t){s.K4(e,"workspace_creation_setting_updated",t)}function a(e,t){s.K4(e,"claimable_spaces_viewed",t)}function r(e,t){s.K4(e,"space_transfer_requested",t)}function l(e,t){s.K4(e,"space_transfer_completed",t)}function d(e,t){s.K4(e,"space_claim_upgrade_requested",t)}function c(e,t){s.K4(e,"space_claim_upgrade_completed",t)}function u(e,t){s.K4(e,"space_claim_deletion_started",t)}function m(e,t){s.K4(e,"space_claim_deletion_canceled",t)}},141311:(e,t,n)=>{n.d(t,{B3:()=>P,Np:()=>F,T_:()=>Z,XP:()=>k,bA:()=>T,h7:()=>_,w1:()=>w,y2:()=>I});n(757658);var s=n(371663),i=n(568626),o=n(471924),a=n(599405),r=n(23867),l=n(709291),d=n(218265),c=n(940663),u=n(95477),m=n(296994),p=n(691924),g=n(80444),f=n(922756),h=n(167940),y=n(757549),x=n(454642),S=n(547307),v=n(247839),b=n(400601),M=n(215356),j=n(210228);const C=(0,l.defineMessages)({authenticatingWithAsana:{id:"asanaActions.authenticatingWithAsana.loadingMessage",defaultMessage:"Authenticating with Asana…"},titleMessage:{id:"asanaActions.loginWithAsanaPopupModal.title",defaultMessage:"Asana login"}});async function w(e){const{environment:t,flowId:n}=e;await x.disconnectAsana(t,{});const s=(0,p.eC)(t);let i=(0,a.createAsanaPopupRedirect)(u.default.domainBaseUrl,{authType:s,userId:t.currentUser.id});if(i=s.redirectToAuth?i:await(0,p.HU)(t,i),t.device.isElectron)return f.Z.setState({...f.Z.state,isAccountLinkingInProgress:!0}),void v.openExternalUrl(i);const o=await M.M(t,{width:580,height:800,url:i,titleMessage:C.titleMessage});if(!o)return;const r=d.Qc(o);if(!r.query.code||!r.query.state)return;f.Z.setState({...f.Z.state,isAccountLinkingInProgress:!0});const l=await x.authWithAsana(t,{code:r.query.code,encryptedState:r.query.state}),c=await x.getAsanaWorkspacesNames(t,{});if("failed"===l.type)y.a1(t,{import_source:"asana",data:{import_type:"api",status:"failure",error:l.error},flowId:n}),console.error(l.error),S.showError(l);else if(y.a1(t,{import_source:"asana",data:{import_type:"api",status:"success"},flowId:n}),"success"===c.type){const{data:{account:e,workspaces:t}}=c;f.Z.setState({...f.Z.state,isAccountLinkingInProgress:!1,account:e,workspaces:t,currentTab:"selectData",isModalOpen:!0})}}async function k(e){const{environment:t}=e;f.Z.setState({...f.Z.state,isAccountDelinkingInProgress:!0});const n=await x.disconnectAsana(t,{});"failed"===n.type?(console.error(n.error),S.showError(n)):(y.qJ(t,{integration_name:"asana"}),"success"===n.type&&f.Z.setState({...f.Z.state,isAccountDelinkingInProgress:!1,account:void 0,workspaces:[]}))}async function I(e){const{selectedWorkspace:t,environment:n}=e;f.Z.setState({...f.Z.state,isLoadingProjects:!0});const s=await x.getTeamsAndProjectsInAsanaWorkspace(n,{workspaceId:t,size:5});"success"===s.type&&f.Z.setState({...f.Z.state,teamsAndProjects:s.data,isLoadingProjects:!1})}async function T(e){let{environment:t}=e;f.Z.setState({...f.Z.state,isLoadingAsanaWorkspaces:!0});const n=await x.getAsanaWorkspacesNames(t,{});var s;"success"===n.type&&f.Z.setState({...f.Z.state,account:n.data.account,workspaces:n.data.workspaces,selectedWorkspace:null===(s=n.data)||void 0===s||null===(s=s.workspaces[0])||void 0===s?void 0:s.gid,isLoadingAsanaWorkspaces:!1})}async function Z(e){let{environment:t,spaceStore:n,currentSpaceViewStore:a,teamsStores:l,flowId:d}=e;const{appTemplatesSetupActions:u,appConfigs:p}=await m.FF.AppTemplates.load(),S=f.Z.state.selectedWorkspace;if(!S)return;f.Z.setState({...f.Z.state,templateCreationInProgress:!0});const v={},M={};try{for(const e in f.Z.state.selectedProjectsAndTeamspaces){if(0===f.Z.state.selectedProjectsAndTeamspaces[e].projects.length)continue;let i;const o=f.Z.state.selectedProjectsAndTeamspaces[e],{notionTeamspaceId:r}=o;if(!r)continue;const d=l.find((e=>e.id===o.notionTeamspaceId));if(i=d||n,M[r])v[e]=M[r];else{const{serverCommitResult:n,performResult:o}=j.createAndCommit({environment:t,perform:e=>{const n={type:"preset",uri:s.T3};if("preset"===n.type&&!n.uri.startsWith("notion://wiki")){var o;const s=n.uri,r=null===(o=(0,c.iX)(p(),s))||void 0===o?void 0:o.uri;if(!r)return;const l=p().find((e=>e.uri===r));if(null==l?void 0:l.presets.find((e=>e.uri===s))){return u.initializeApp({environment:t,spaceViewStore:a,appParentStore:i,appUri:r,presetUri:s,transaction:e,from:"asana_import"})}return[]}},userAction:"importActions.importAsana"});v[e]=o,M[r]=o,await n}}}catch(A){return void f.Z.setState({...f.Z.state,templateCreationInProgress:!1,currentTab:"failure"})}const C=[],w=g.default.state.currentSpaceViewStore;if(!w)return;const k=b.Ym({environment:t,spaceStore:n,spaceViewStore:w,append:!0});await k.deferred.promise;const I=k.pageId;f.Z.setState({...f.Z.state,loggerPageId:I});const T=new Set,Z=[],P=[];for(const s in v){const e=f.Z.state.selectedProjectsAndTeamspaces[s],t=v[s];if(!(t&&e.notionTeamspaceId&&e.projects.length))continue;const i="string"==typeof e.projects?[]:e.projects;Z.push(...i),T.add(e.notionTeamspaceId),P.push(s),C.push({collectionViewBlocks:t.map((e=>({id:e.id,spaceId:(0,r.C)(n.id)}))),projectIds:i,asanaTeamId:s,notionTeamSpaceId:e.notionTeamspaceId,importAllProjects:"all"===e.projects,importOnlyIncompleteProjects:"in_complete"===e.projects})}const F=x.parallelAsanaImport(t,{importParams:C,spaceId:(0,r.C)(n.id),asanaWorkspaceId:S,importCompletedTasks:f.Z.state.importCompletedTasks,loggerPageId:I,flowId:d||o.Il()});f.Z.setState({...f.Z.state,templateCreationInProgress:!1,currentTab:"importingData",choosingWorkspacesCompleted:!0}),h.Z.reset();const _=f.Z.state.workspaces.find((e=>e.gid===S));_&&function(e,t,n){try{y.qy(e,{import_source:"asana",data:t,flowId:n})}catch(s){i.log({level:"error",from:"asanaV2Actions",type:"parallelAsanaImport",error:{miscDataString:JSON.stringify({error:s,message:"Errored in tracking import_source_input event."})}})}}(t,{workspaceName:_.name,teams:P,projects:Z,numberOfTeamspacesUsed:T.size,completedTasks:f.Z.state.importCompletedTasks,userId:t.currentUser.id,spaceId:(0,r.C)(n.id)},d);for await(const s of F){if(!f.Z.state.isModalOpen)break;if(s.error)return void f.Z.setState({...f.Z.state,currentTab:"failure"});"success"===s.taskStatus&&f.Z.setState({...f.Z.state,currentTab:"confirm",result:s.value.status,isComplete:!0})}}function P(e){var t;let{teamId:n,spaceId:s}=e;f.Z.setState({...f.Z.state,selectedProjectsAndTeamspaces:{...f.Z.state.selectedProjectsAndTeamspaces,[n]:{projects:(null===(t=f.Z.state.selectedProjectsAndTeamspaces[n])||void 0===t?void 0:t.projects)||[],notionTeamspaceId:s}}})}function F(){f.Z.setState({...f.Z.state,currentTab:"selectProperties"})}function _(){f.Z.setState({...f.Z.state,isModalOpen:!0})}},579257:(e,t,n)=>{n.d(t,{D2:()=>y,Do:()=>h,M0:()=>g,W4:()=>f,bA:()=>m,xv:()=>p});var s=n(401898),i=n(485680),o=n(398452),a=n(206258),r=n(452258),l=n(436610),d=n(106404),c=n(496802),u=n(210228);function m(e){const{originRect:t}=e;r.Z.reset(),o.Z.reset(),d.xv(),i.Z.setState({isOpen:!0,rect:t})}function p(){i.Z.setState({isOpen:!1})}function g(e){const{format:t,store:n,property:s,visibility:i,transaction:o}=e,a=t.property_visibility;a&&o&&c.FH({stores:[n],update:{property_visibility:Object.values(a||{}).map((e=>({property:e.property,visibility:s===e.property?i:e.visibility})))},transaction:o})}function f(e){const{store:t,pageSection:n,visibility:i,environment:o,format:r}=e,d=r.page_section_visibility;d&&(l.Mz(o,{section:n,visibility:i}),u.createAndCommit({userAction:"customizePageActions.updatePageSectionVisibility",environment:o,perform:e=>{c.FH({stores:t instanceof a.NW||t instanceof a.G?[t]:(0,s.t1)(t),update:{page_section_visibility:{...d,[n]:i}},transaction:e})}}))}function h(e){const{store:t,transaction:n,pageSectionFormats:i}=e;c.FH({stores:t instanceof a.NW||t instanceof a.G?[t]:(0,s.t1)(t),update:{collection_page_sections:i},transaction:n})}function y(e){const{store:t,properties:n,environment:i}=e;u.createAndCommit({userAction:"customizePageActions.updateCollectionPageProperties",environment:i,perform:e=>{c.FH({stores:t instanceof a.NW||t instanceof a.G?[t]:(0,s.t1)(t),update:{collection_page_properties:n},transaction:e})}})}},115944:(e,t,n)=>{n.d(t,{o:()=>m,q:()=>p});var s=n(886628),i=n(268056),o=n(489086),a=n(828685),r=n(80444),l=n(924666),d=n(210228),c=n(237181);function u(){const e=l.default.state;if("editing"===e.mode){const t=(0,i.QY)(e.multiSelection);if(t&&(0,o.wd)(t.selection)){const e=t.store,n=a.E.findEditableWithStore(e);if(n){return e.getValue()?void 0:n}}}}function m(){return(0,s.VK)(u,[])}function p(e){const{currentUserSettingsStore:t}=r.default.state;t&&d.createAndCommit({userAction:"educationTooltipsActions.completePressSlashTooltip",environment:e,perform:e=>{c.d2({userSettingsStore:t,transaction:e,data:{pressed_slash_tooltip:!0}})},userId:t.id})}},400601:(e,t,n)=>{n.d(t,{Ym:()=>z,A1:()=>H,am:()=>G,ro:()=>U,xG:()=>W,su:()=>q,Pv:()=>N});n(757658),n(21703);var s=n(313991),i=n(541432),o=n(407057),a=n(568626),r=n(159730),l=n(471924),d=n(334390),c=n(423512),u=n(421202),m=n(23867),p=n(709291),g=n(657347),f=n(653965),h=n(552629),y=n(937850),x=n(672340),S=n(833954),v=n(908989),b=n(319385);const M=1073741824;var j=n(433929),C=n(636214),w=n(78900),k=n(490365),I=n(682066),T=n(188923),Z=n(206258),P=n(757549),F=n(454642),_=n(547307),A=n(594419),B=n(792625),R=n(709953),D=n(328014),O=n(210228),L=n(353471);const V=(0,p.defineMessages)({uploadingOneFile:{id:"importActions.uploadingOneFile.loadingMessage",defaultMessage:"Uploading… ({percentComplete}%)"},uploadingMultipleFilesNotStarted:{id:"importActions.uploadingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Uploaded 0 of {totalNumberOfFiles}"},uploadingMultipleFilesInProgress:{id:"importActions.uploadingMultipleFilesInProgress.loadingMessage",defaultMessage:"Uploaded {numberOfUploadedFiles} of {totalNumberOfFiles}"},uploadingMultipleFilesComplete:{id:"importActions.uploadingMultipleFilesComplete.loadingMessage",defaultMessage:"Uploaded {totalNumberOfFiles} of {totalNumberOfFiles}"},importingOneFile:{id:"importActions.importingOneFile.loadingMessage",defaultMessage:"Importing…"},importingMultipleFilesNotStarted:{id:"importActions.importingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Imported 0 of {totalNumberOfFiles}"},importingMultipleFilesInProgress:{id:"importActions.importingMultipleFilesInProgress.loadingMessage",defaultMessage:"Imported {numberOfImportedFiles} of {totalNumberOfFiles}"},importingMultipleFilesComplete:{id:"importActions.importingMultipleFilesComplete.loadingMessage",defaultMessage:"Imported {totalNumberOfFiles} of {totalNumberOfFiles}"},importingFromTrelloMessage:{id:"importActions.importingFromTrello.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} board from Trello} other {Importing {importingCount} boards from Trello}}"},importingFromAsanaMessage:{id:"importActions.importingFromAsana.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} project from Asana} other {Importing {importingCount} projects from Asana}}"},importingFromEvernoteMessage:{id:"importActions.importingFromEvernote.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} notebook from Evernote} other {Importing {importingCount} notebooks from Evernote}}"},importingFromConfluenceViaAPIMessage:{id:"importActions.importingFromConfluenceViaAPI.loadingMessage",defaultMessage:"Importing confluence space: {confluenceSpaceKey}."},importFailed:{id:"importActions.importFailedError.message",defaultMessage:"Import failed."},fileImportFailedSizeTooLarge:{id:"importActions.fileImportFailedError.sizeTooLarge.message",defaultMessage:"Import failed: file exceeds 5MB."},fileImportFailedCustomSizeTooLarge:{id:"importActions.fileImportFailedError.customSizeTooLarge.message",defaultMessage:"Import file cannot exceed {maxSize}."},trelloImportFailed:{id:"importActions.trelloImportFailedError.message",defaultMessage:"Trello import failed."},asanaImportFailed:{id:"importActions.asanaImportFailedError.message",defaultMessage:"Asana import failed."},evernoteImportFailed:{id:"importActions.evernoteImportFailedError.message",defaultMessage:"Evernote import failed."},confluenceImportViaAPIFailed:{id:"importActions.confluenceImportViaAPIFailedError.message",defaultMessage:"Confluence space import failed."},importTitle:{id:"importActions.importTitle",defaultMessage:"Import {date}"},importTitleForGenericFileImporter:{id:"importActions.importTitleForGenericFileImporter",defaultMessage:"{fileName} Import {date}"},onlyDocxExtensionSupported:{id:"importErrors.onlyDocxExtensionSupported.message",defaultMessage:"Import failed: file type not supported."}}),E=1073741824;async function N(e){const{uploadType:t,allowMultiple:n}=e;return U(e,await L.y({multiple:n??!0,accept:d.by[t].join(",")}))}async function U(e,t){const{environment:n,pageStore:s,spaceStore:i,isTeamPage:o,spaceViewStore:d,uploadType:m,flowId:p}=e;let f;try{if(0===t.length)return;const a=1===t.length;if("confluence"===m){const s=(Number((0,x.$6)(n))||15)*E;if(t[0].size>s)throw P.a1(e.environment,{import_source:"confluence",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:t[0].size},flowId:p}),new r.nY("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:c.td(s,1)}}})}else if("genericImporter"===m){const s=(0,v.bk)(n)||15,i=s*E;if(t[0].size>i)throw P.a1(e.environment,{import_source:"file",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:t[0].size},flowId:p}),new r.p8("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:`${s} GB}`}}})}else if("pdf"===m){const n=Number(b.default.getEligibleGroup({experimentId:"special_case_pdf_file_size",defaultGroup:M.toString()})),s=n;for(const i of t)if(i.size>s)throw P.a1(e.environment,{import_source:"file",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:i.size},flowId:p}),new r.p8("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:`${n} GB}`}}})}const g=await new Promise(((e,s)=>{L.IL({environment:n,uploadType:m,files:t,bucket:"temporary",preventLimitFreeFileSize:!0,flowId:p,onBatchStart:()=>{B.j({message:a?V.uploadingOneFile:V.uploadingMultipleFilesNotStarted,interpolatedValues:{totalNumberOfFiles:t.length,percentComplete:0}})},onBatchProgress:e=>{let{uploadedFiles:n,progressPercent:s}=e;B.j({message:a?V.uploadingOneFile:V.uploadingMultipleFilesInProgress,interpolatedValues:{numberOfUploadedFiles:n,totalNumberOfFiles:t.length,percentComplete:s}})},onBatchComplete:n=>{B.j({message:a?V.uploadingOneFile:V.uploadingMultipleFilesComplete,interpolatedValues:{totalNumberOfFiles:t.length,percentComplete:100}}),e(n)},onBatchError:s})})),h=await K(n,i,d,m,(null==t?void 0:t.length)??0,null==t?void 0:t[0].name,s,o);f=h.createdPage;const y=h.importType,S=h.pageId,j=g.map(((e,n)=>({fileURL:e,fileName:t[n].name})));let C=0;B.j({message:a?V.importingOneFile:V.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:C,totalNumberOfFiles:t.length}});for(const{fileURL:e,fileName:s}of j){if("confluence"===m){P.a1(n,{import_source:"confluence",data:{import_type:"file",status:"success",fileSize:t[0].size},flowId:p});const o=z({environment:n,spaceStore:i,spaceViewStore:d});await o.deferred.promise;const a=o.pageId,r=F.parallelImportConfluenceExport(n,{fileURL:e,fileName:s,page:{id:S,spaceId:i.id},loggerPageId:a,flowId:p||l.Il()});for await(const e of r){if(e.error)throw e.error;e.value.isComplete||B.j(e.value.status)}}else if("AppendToBlock"===y){const t={fileURL:e,fileName:s,importType:y,block:{id:S,spaceId:i.id},flowId:p};P.qy(n,{import_source:"file",data:t,flowId:p});const{value:o}=await F.importFile(n,t).next();if(o.error)throw o.error}else if("ReplaceBlock"===y){const t={fileURL:e,fileName:s,importType:y,block:{id:S,spaceId:i.id},flowId:p};P.qy(n,{import_source:"file",data:t,flowId:p});const{value:o}=await F.importFile(n,t).next();if(o.error)throw o.error}C++,B.j({message:a?V.importingOneFile:V.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:C,totalNumberOfFiles:t.length}})}return B.x(),Z.G.createChildStore(i,{table:u.iU,id:S})}catch(C){var y;let e;a.log({level:"error",from:"importFiles",type:"importFilesFailure",error:(0,h.Ui)(C),data:{spaceId:i.id}}),B.x(),O.createAndCommit({userAction:"importActions.importFiles",environment:n,perform:e=>{f&&A.Od({parentStore:i.getPagesStore(),childToRemoveStore:f,transaction:e})}});let t=null,s=null;if(C instanceof r.hm&&C.clientData?(t=C.clientData,S.Em[C.clientData.type]&&"ImportFileSizeTooLargeError"===(0,g.t)(C).message?s=S.Em[C.clientData.type]:S.$5[C.clientData.type]&&"CsvImportError"===(0,g.t)(C).message?s=S.$5[C.clientData.type]:S.zP[C.clientData.type]?s=S.zP[C.clientData.type]:S.Uh[C.clientData.type]&&(s=S.Uh[C.clientData.type])):C instanceof r.nY&&"upload_file_size_exceeded"===(null===(y=C.body)||void 0===y||null===(y=y.clientData)||void 0===y?void 0:y.type)&&S.zP[C.body.clientData.type]&&(t=C.body.clientData,s=S.zP[t.type]),t&&s){const n="messageValues"in t?t.messageValues:void 0;e=j.default.formatMessage(s,n)}else e="ImportFileSizeTooLargeError"===(0,g.t)(C).message?j.default.formatMessage(V.fileImportFailedSizeTooLarge):j.default.formatMessage(V.importFailed);throw _.showErrorMessage(e),C}}async function K(e,t,n,i,a,r,l,d,c){var u;let m,p,g;if(T.default.isSidePeekOpen()&&null!==(u=T.default.peekTargetStore.state)&&void 0!==u&&u.isEmptyPage())p=T.default.peekTargetStore.state.id,g="ReplaceBlock";else if(l&&(l.isEmptyPage()||c))a>1||l.isInsideCollection()||c?(p=l.id,g="AppendToBlock"):(p=l.id,g="ReplaceBlock");else{const l={date:(0,o.Yx)(Date.now(),"medium",s.SP)};"genericImporter"===i&&(l.fileName=r?r.replace(".zip",""):"Universal File");const{performResult:c}=O.createAndCommit({userAction:"importActions.result",environment:e,perform:s=>{const o=j.default.formatMessage("genericImporter"===i?V.importTitleForGenericFileImporter:V.importTitle,l),r=D.KE({environment:e,spaceStore:t,spaceViewStore:n,isPrivate:!d,prepend:!d,title:o,transaction:s}),c=a>1?"AppendToBlock":"ReplaceBlock",u=y.UZ();return s.postSubmitCallbacks.push((e=>{e?u.reject(e):u.resolve()})),{deferred:u,createdPage:r,pageId:r.id,importType:c}}});m=c.createdPage,p=c.pageId,g=c.importType,await c.deferred.promise}return{createdPage:m,pageId:p,importType:g}}async function W(e){const{environment:t,fileId:n,token:s,spaceStore:i,spaceViewStore:o,pageStore:a,analyticsFrom:l}=e;let d;try{B.j({message:V.importingOneFile});const e="link_paste"===l,r=await K(t,i,o,"gdocs",1,void 0,a,void 0,e);d=r.createdPage;const c=r.importType,m=r.pageId,p={fileId:n,tokenId:s.id,importType:c,block:{id:m,spaceId:i.id}};P.qy(t,{import_source:"gDocs",data:p});const{value:g}=await F.importGoogleDoc(t,p).next();if(g.error)throw g.error;return B.x(),Z.G.createChildStore(i,{table:u.iU,id:m})}catch(c){O.createAndCommit({userAction:"importActions.importFiles",environment:t,perform:e=>{d&&A.Od({parentStore:i.getPagesStore(),childToRemoveStore:d,transaction:e})}});let e=j.default.formatMessage(V.importFailed);throw c instanceof r.hm&&c.clientData&&("only_docx_extension_supported"===c.clientData.type?e=j.default.formatMessage(V.onlyDocxExtensionSupported):"file_size_exceeded"===c.clientData.type&&(e=j.default.formatMessage(V.fileImportFailedCustomSizeTooLarge,{maxSize:c.clientData.messageValues.maxSize}))),_.showErrorMessage(e),B.x(),new Error((0,g.t)(c).message)}}function z(e){const{environment:t,spaceStore:n,spaceViewStore:i,append:a}=e,{performResult:r}=O.createAndCommit({userAction:"importActions.result",environment:t,perform:e=>{const r=j.default.formatMessage(V.importTitle,{date:(0,o.Yx)(Date.now(),"medium",s.SP)}),l=D.KE({environment:t,spaceStore:n,spaceViewStore:i,isPrivate:!0,prepend:!a,title:`${r} Logs`,transaction:e}),d=y.UZ();return e.postSubmitCallbacks.push((e=>{e?d.reject(e):d.resolve()})),{deferred:d,pageId:l.id}}});return r}async function q(e){const{environment:t,boards:n,spaceStore:s,spaceViewStore:i}=e;B.j({message:V.importingFromTrelloMessage,interpolatedValues:{importingCount:n.length}}),I.Z.setState({open:!1});const{performResult:{deferred:o,pages:a}}=O.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{const o=n.map((n=>D.KE({environment:t,spaceStore:s,spaceViewStore:i,isPrivate:!0,prepend:!0,loading:!0,title:n.name,transaction:e}))),a=y.UZ();return e.postSubmitCallbacks.push((e=>{e?a.reject(e):a.resolve()})),{deferred:a,pages:o}}});await o.promise;try{return await Promise.all(a.map((async(e,s)=>{const i=n[s],{value:o}=await F.importTrello(t,{boardId:i.id,block:{id:e.id,spaceId:(0,m.C)(e.pointer.spaceId)}}).next();if(o.error)throw o.error}))),B.x(),a[0]}catch(r){throw O.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{for(const t of a)A.Od({parentStore:s.getPagesStore(),childToRemoveStore:t,transaction:e})}}),_.showErrorMessage(j.default.formatMessage(V.trelloImportFailed)),B.x(),new Error((0,g.t)(r).message)}}async function G(e){const{environment:t,spaceStore:n,spaceViewStore:s,notebooks:o,userSettingsStore:a}=e;if(0===o.length)throw new Error("Expected at least one notebook");B.j({message:V.importingFromEvernoteMessage,interpolatedValues:{importingCount:o.length}}),k.Z.setState({open:!1});const r=await async function(e){const{environment:t,spaceStore:n,spaceViewStore:s,notebooks:o}=e,{serverCommitResult:a,performResult:{blockStores:r}}=O.createAndCommit({userAction:"importActions.createStacks",environment:t,perform:e=>{const a=f.jj(f.oA(o.map((e=>e.stack)))).sort().reverse(),r={};let l=e=>!0;return o.length>1&&a.length>0&&(a.forEach((a=>{const l=D.KE({environment:t,spaceStore:n,spaceViewStore:s,isPrivate:!0,prepend:!0,loading:!1,title:a,transaction:e}),d=l.getContentStore();o.filter((e=>e.stack===a)).forEach((n=>{const s=R.j4({environment:t,type:i.Ti.copyIndicator,inMemoryRecordCache:l.inMemoryRecordCache,transaction:e,spaceId:d.pointer.spaceId,useCrdt:l.useCrdt()});A.R3({parentStore:d,appendStore:s,transaction:e}),r[n.guid]=s}))})),l=e=>!Boolean(e.stack)),o.filter(l).reverse().forEach((i=>{const o=D.KE({environment:t,spaceStore:n,spaceViewStore:s,isPrivate:!0,prepend:!0,loading:!0,title:i.title,transaction:e});r[i.guid]=o})),{blockStores:r}}});return await a,r}({environment:t,spaceStore:n,spaceViewStore:s,notebooks:o}),l=r[o[0].guid];try{return await async function(e){const{environment:t,spaceStore:n,spaceViewStore:s,notebooks:i,waitForNotebookStore:o,notebookMapping:a,userSettingsStore:r}=e;let l;if(y.jl(i,$,(async e=>{await Promise.all(e.map((async e=>{const n=a[e.guid];if(!n)throw new Error(`Missing notebook page ${e.guid}`);const s=y.UZ();n===o&&(l=s),await async function(e){const{environment:t,notebookStore:n,notebook:s,firstCompleted:i}=e,o=F.importEvernote(t,{notebookId:s.guid,block:{id:n.id,spaceId:(0,m.C)(n.pointer.spaceId)},timestamp:Date.now(),parentTable:u.iU}),{value:a}=await o.next();a.error&&(console.error(a.error),O.createAndCommit({userAction:"importActions.importEvernoteNotebook",environment:t,perform:e=>{const t=n.getParentBlockStore();if(t){const s=t.getContentStore();A.Od({parentStore:s,childToRemoveStore:n,transaction:e})}}}),_.showErrorMessage(j.default.formatMessage(V.evernoteImportFailed)));i.resolve(void 0)}({environment:t,notebookStore:n,notebook:e,firstCompleted:s})})))})),!l)throw new Error("waitForNotebookFirstCompleted not defined.");const d=r.getSettings();null!=d&&d.created_evernote_getting_started||await C.FI({environment:t,type:"evernote",spaceStore:n,spaceViewStore:s,userSettingsStore:r});await l.promise}({environment:t,waitForNotebookStore:l,notebookMapping:r,notebooks:o,spaceStore:n,spaceViewStore:s,userSettingsStore:a}),B.x(),l}catch(d){throw B.x(),_.showErrorMessage(j.default.formatMessage(V.evernoteImportFailed)),d}}async function H(e){const{environment:t,spaceStore:n,spaceViewStore:i,space:r,flowId:l}=e;if(!t.currentUser.id)throw new Error("User does not exist.");B.j({message:V.importingFromConfluenceViaAPIMessage,interpolatedValues:{confluenceSpaceKey:r.name}}),w.Z.setState({open:!1});const d=(0,x.Pt)(t);let c;if(!d){const e=z({environment:t,spaceStore:n,spaceViewStore:i});await e.deferred.promise,c=e.pageId}let m,p,f;if((0,x.SL)(t)){const e=await F.createTeam(t,{spaceId:n.id,name:r.name,accessLevel:"closed"});if("failed"===e.type)throw new Error("Cannot create teamspace");m=e.data.teamId}if(!d){const{performResult:e}=O.createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,perform:e=>{const a=j.default.formatMessage(V.importTitle,{date:(0,o.Yx)(Date.now(),"medium",s.SP)}),r=D.KE({environment:t,spaceStore:n,spaceViewStore:i,isPrivate:!0,prepend:!0,title:a,transaction:e}),l=y.UZ();return e.postSubmitCallbacks.push((e=>{e?l.reject(e):l.resolve()})),{deferred:l,createdPage:r,pageId:r.id}}});await e.deferred.promise,p=e.createdPage,f=e.pageId}try{if(d){const e=F.parallelImportConfluenceViaApi(t,{userId:t.currentUser.id,confluenceSpaceKey:r.key,confluenceSpaceId:r.id,page:{spaceId:n.id},teamId:m});for await(const s of e){if(s.error)throw s.error;if(!s.value.isComplete&&(B.j(s.value.status),s.value.rootPageId)){const e=new Z.G(t,{table:u.iU,id:s.value.rootPageId,spaceId:n.id});p=e}}}else{if(!p||!f||!c)throw new Error("No root page");const e=F.parallelImportConfluenceViaApi(t,{userId:t.currentUser.id,confluenceSpaceKey:r.key,confluenceSpaceId:r.id,page:{id:f,spaceId:n.id},loggerPageId:c,flowId:l,teamId:m});for await(const t of e){if(t.error)throw t.error;t.value.isComplete||B.j(t.value.status)}}if(!p)throw new Error("No root page");return B.x(),p}catch(S){throw a.log({level:"error",from:"importConfluenceViaAPI",type:"importConfluenceViaAPIFailure",error:(0,h.Ui)(S),data:{spaceId:n.id}}),O.createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,perform:e=>{p&&A.Od({parentStore:n.getPagesStore(),childToRemoveStore:p,transaction:e})}}),_.showErrorMessage(j.default.formatMessage(V.confluenceImportViaAPIFailed)),B.x(),new Error((0,g.t)(S).message)}}const $=2},711985:(e,t,n)=>{n.d(t,{P:()=>u,j:()=>c});var s=n(133728),i=n(653965),o=n(626907),a=n(535057),r=n(891219),l=n(195209);const d=i.Ds((e=>{let{environment:t,flowId:n,subscriptionTier:s,origin:i}=e;r.UW(t,{invite_flow_id:n,subscription_tier:s,invite_origin:i})}),1e3);async function c(e){const{environment:t,event:n,flowId:i,inviteTargetsStore:r,inviteOrigin:c,onInputChanged:u}=e;null==u||u(),r.setState({...r.state,tokenQuery:n.target.value}),d({environment:t,flowId:i,subscriptionTier:(0,a.zt)(),origin:c});const m=n.target.value,{extractedEmails:p,invalidParts:g,newInputValue:f}=(0,s.nj)(m),h=[...await l.M5(t,p),...g.map((e=>({type:"invalidUser",value:{text:e}})))].filter((e=>!o.H({inviteTargetsStore:r,target:e}))),y=[...r.state.inviteTargets,...h];r.setState({...r.state,inviteTargets:y,tokenQuery:f})}function u(e){const{targetToRemove:t,inviteTargetsStore:n}=e;if(0===n.state.inviteTargets.length)return;const s=n.state.inviteTargets.filter((e=>e!==t));0===s.length?n.setState({...n.state,inviteTargets:[]}):n.setState({...n.state,inviteTargets:s})}},361397:(e,t,n)=>{n.d(t,{C8:()=>k,FM:()=>j,IO:()=>C,eL:()=>w,h7:()=>v,qF:()=>b,sC:()=>M});n(757658);var s=n(371663),i=n(568626),o=n(23867),a=n(709291),r=n(547307),l=n(940663),d=n(296994),c=n(433929),u=n(80444),m=n(167940),p=n(369122),g=n(757549),f=n(454642),h=n(400601),y=n(792625),x=n(210228);const S=(0,a.defineMessages)({successfullyConnected:{id:"mondayActions.successfullyConnected.message",defaultMessage:"Successfully connected monday.com instance."}});function v(){p.Z.setState({...p.Z.state,isModalOpen:!0})}async function b(e){const{environment:t,userEmail:n,APIToken:s,flowId:i,spaceId:o}=e;if(!t.currentUser.id||!n||!s)return r.showMessage({message:"Invalid details"}),void y.x();const a=await f.authenticateMondayUser(t,{userId:t.currentUser.id,spaceId:o,userEmail:n,APIToken:s});"failed"===a.type?(g.a1(t,{import_source:"monday.com",data:{import_type:"api",status:"failure",error:a.error},flowId:i}),console.error(a.error),r.showError(a)):(g.a1(t,{import_source:"monday.com",data:{import_type:"api",status:"success"},flowId:i}),p.Z.setState({...p.Z.state,account:n}),r.showMessage({message:c.default.formatMessage(S.successfullyConnected)})),y.x()}async function M(e){const{environment:t,spaceId:n}=e,s=await f.disconnectMonday(t,{spaceId:n});"failed"===s.type?r.showError(s):(g.qJ(t,{integration_name:"monday.com"}),"success"===s.type&&p.Z.setState({...p.Z.state,account:void 0,workspaces:[]}))}async function j(e){const{environment:t,spaceId:n}=e;p.Z.setState({...p.Z.state,isLoadingMondayWorkspaces:!0});const s=await f.getMondayWorkspaces(t,{spaceId:n});"success"===s.type&&p.Z.setState({...p.Z.state,workspaces:s.data.workspaces,isLoadingMondayWorkspaces:!1})}async function C(e){const{environment:t,spaceId:n,selectedWorkspace:s}=e;if(!n)return;p.Z.setState({...p.Z.state,isLoadingProjects:!0});const i=await f.getMondayFoldersAndBoards(t,{spaceId:n,selectedWorkspace:s});"success"===i.type&&p.Z.setState({...p.Z.state,mondayFoldersAndBoards:i.data.mondayFoldersAndBoards,isLoadingProjects:!1})}function w(e){var t;let{folderId:n,spaceId:s}=e;p.Z.setState({...p.Z.state,selectedProjectsAndTeamspaces:{...p.Z.state.selectedProjectsAndTeamspaces,[n]:{projects:(null===(t=p.Z.state.selectedProjectsAndTeamspaces[n])||void 0===t?void 0:t.projects)||[],notionTeamspaceId:s}}})}async function k(e){const{environment:t,spaceStore:n,currentSpaceViewStore:a,teamsStores:r,flowId:c}=e,{appTemplatesSetupActions:y,appConfigs:S}=await d.FF.AppTemplates.load(),v=p.Z.state.selectedWorkspace;if(!v)return;p.Z.setState({...p.Z.state,templateCreationInProgress:!0});const b={},M={},j=[],C=new Set;try{for(const e in p.Z.state.selectedProjectsAndTeamspaces){const i=p.Z.state.selectedProjectsAndTeamspaces[e].projects;if(0===i.length)continue;let o;j.push(...i.map((e=>e.mondayProjectId)));const d=p.Z.state.selectedProjectsAndTeamspaces[e],{notionTeamspaceId:c}=d;if(!c)continue;C.add(c);const u=r.find((e=>e.id===d.notionTeamspaceId));if(o=u||n,!b[c]){const{serverCommitResult:e,performResult:n}=x.createAndCommit({environment:t,perform:e=>{const n={type:"preset",uri:s.T3};if("preset"===n.type&&!n.uri.startsWith("notion://wiki")){var i;const s=n.uri,r=null===(i=(0,l.iX)(S(),s))||void 0===i?void 0:i.uri;if(!r)return;const d=S().find((e=>e.uri===r));if(null==d?void 0:d.presets.find((e=>e.uri===s))){return y.initializeApp({environment:t,spaceViewStore:a,appParentStore:o,appUri:r,presetUri:s,transaction:e,from:"monday_import"})}return[]}},userAction:"importActions.importMonday"});b[c]=n,await e}M.hasOwnProperty(c)?M[c]=[...M[c],{mondayFolderId:e,projects:i}]:M[c]=[{mondayFolderId:e,projects:i}]}}catch(P){return void p.Z.setState({...p.Z.state,templateCreationInProgress:!1,currentTab:"failure"})}const w=[],k=u.default.state.currentSpaceViewStore;if(!k)return;const I=h.Ym({environment:t,spaceStore:n,spaceViewStore:k,append:!0});await I.deferred.promise;const T=I.pageId;p.Z.setState({...p.Z.state,loggerPageId:T});for(const[s,i]of Object.entries(M)){const e=b[s];e&&w.push({collectionViewBlocks:e.map((e=>({id:e.id,spaceId:(0,o.C)(n.id)}))),notionTeamSpaceId:s,mondayProjectsAndFolders:i})}const Z=f.parallelMondayImport(t,{importParams:w,loggerPageId:T,spaceId:n.id,flowId:c});p.Z.setState({...p.Z.state,templateCreationInProgress:!1,currentTab:"importingData"}),m.Z.reset(),v&&function(e,t,n){try{g.qy(e,{import_source:"monday.com",data:t,flowId:n})}catch(s){i.log({level:"error",from:"mondayActions",type:"parallelMondayImport",error:{miscDataString:JSON.stringify({error:s,message:"Errored in tracking import_source_input event."})}})}}(t,{workspaceId:v,projects:j,numberOfTeamspacesUsed:C.size,userId:t.currentUser.id,spaceId:(0,o.C)(n.id)},c);for await(const s of Z){if(!p.Z.state.isModalOpen)break;if(s.error)return void p.Z.setState({...p.Z.state,currentTab:"failure"});"success"===s.taskStatus&&p.Z.setState({...p.Z.state,currentTab:"confirm",result:s.value.status,isComplete:!0})}}},800360:(e,t,n)=>{n.d(t,{l:()=>i,q:()=>o});var s=n(625399);function i(){s.Z.setState({open:!0,submitted:!1,error:void 0})}function o(){s.Z.setState({open:!1})}},937834:(e,t,n)=>{n.d(t,{FF:()=>f,U4:()=>h,gs:()=>y,jN:()=>g,xx:()=>S,zb:()=>x});n(667294);var s=n(23867),i=n(709291),o=n(137810),a=n(319385),r=n(146096),l=n(436610),d=n(454642),c=n(547307),u=n(792625),m=n(785893);const p=(0,i.defineMessages)({restoringPreviousVersion:{id:"historyModalActions.restoringPreviousVersion.loadingMessage",defaultMessage:"Restoring…"}});function g(e){const{environment:t,from:n,...s}=e;l.y(t,n),r.Z.setState({...s,open:!0,size:50})}function f(){const e=r.Z.state;e.open&&r.Z.setState({...e,size:e.size+20})}function h(){r.Z.setState({open:!1})}function y(e){const{environment:t,snapshot:n,nextFutureSnapshot:s}=e;l.qD(t,n);const i=r.Z.state;i.open&&r.Z.setState({...i,snapshot:n,nextFutureSnapshot:s,openSnapshotNearTimestamp:void 0})}function x(){const e=r.Z.state;e.open&&r.Z.setState({...e,snapshot:void 0,nextFutureSnapshot:void 0})}async function S(e){if(!r.Z.state.open)return;if(!r.Z.state.snapshot)return;const t="restore_collection",n=r.Z.state.pageHasCollection,g=a.default.checkGate({gateName:"snapshot_optional_collection_rollback_enabled"})&&n?[{key:t,text:(0,m.jsx)(i.FormattedMessage,{defaultMessage:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:(0,m.jsx)(i.FormattedMessage,{defaultMessage:"All database pages will be restored to the previous version, which may impact other users or database views.",id:"historyModal.confirmDialog.selectOption.collection.description"})}]:void 0,{accept:f,selectionResult:y}=await c.confirmUserActionV2({message:(0,m.jsx)("div",{style:{fontWeight:o.Z.fontWeight.semibold,fontSize:"medium"},children:(0,m.jsx)(i.FormattedMessage,{defaultMessage:"Restore to this version?",id:"historyModal.confirmDialog.description"})}),acceptLabel:(0,m.jsx)(i.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:g});if(!f)return;l.R9(e,r.Z.state.snapshot),u.j({message:p.restoringPreviousVersion});const x=await d.restoreSnapshot(e,{block:{id:r.Z.state.blockStore.id,spaceId:(0,s.C)(r.Z.state.blockStore.pointer.spaceId)},timestamp:r.Z.state.snapshot.timestamp,shouldRestoreCollection:(null==y?void 0:y[t])??!1}).next();x.value.error&&c.showErrorMessage(x.value.error.message),u.x(),h()}},523728:(e,t,n)=>{n.d(t,{O:()=>G});var s=n(313991),i=n(517755),o=n(522808),a=n(76233),r=n(709291),l=n(997466),d=n(531701),c=n(653965),u=n(137810),m=n(95477),p=n(433929),g=n(509339),f=n(990827),h=n(496802),y=n(210228),x=n(353471);const S=630,v=1200,b=(0,d.gh)({theme:"light"}),M=240,j="white",C=200,w=96,k=150,I=184,T=100,Z=145,P=23,F=347,_=24,A=100,B=100,R=100,D="black",O=96,L=68,V=b.text.tertiary,E=40,N=(0,r.defineMessages)({builtWithNotion:{id:"socialMediaPreview.builtWithNotion",defaultMessage:"Built with Notion"}}),U='"Apple Color Emoji","Segoe UI Emoji",NotoColorEmoji,"Noto Color Emoji","Segoe UI Symbol","Android Emoji",EmojiSymbols';function K(e){return new Promise(((t,n)=>{const s=new Image;s.onload=()=>t(s),s.onerror=n,s.src=e}))}function W(e,t){return`${u.Z.fontWeight.bold} ${t}px ${u.Z.getHeaderFontFamily({pageFont:e,locale:s.SP})}`}function z(e){const t=u.Z.fontWeight.medium,n=u.Z.getHeaderFontFamily({pageFont:e,locale:s.SP});return`${t} ${E}px ${n}`}function q(e){let{context:t,text:n,font:s,color:i,x:o,y:a}=e;t.font=s,t.textAlign="left",t.textBaseline="top",t.fillStyle=i,t.fillText(n,o,a)}async function G(e){var t;let{store:n,environment:s}=e;if(n.pathIsDead()||(0,f.Eo)(n))return;const r=a.QaF(n.getTitleValue())||"",d=null===(t=n.getIcon())||void 0===t?void 0:t.icon,u=function(e,t){var n;const s=null===(n=t.getCover())||void 0===n?void 0:n.cover;if(s)return i.EK({url:s,width:v,permissionRecord:t.pointer,stripGoogleIconQuery:!0,baseUrl:m.default.domainBaseUrl,fullyQualified:!1,userId:e.currentUser.id})}(s,n),E=n.getFormat(),G=new OffscreenCanvas(v,S),H=G.getContext("2d"),[$,Y]=function(e,t){const n=document.createElement("div");n.style.width="auto",n.style.position="absolute",n.style.whiteSpace="nowrap",n.style.font=W(t,O),n.style.top="110vh",n.innerText=e;const s=v-A-B,i=document.body;if(i.appendChild(n),n.clientWidth<s)return i.removeChild(n),[e,O];if(n.style.font=W(t,L),n.clientWidth<s)return i.removeChild(n),[e,L];let o=e;for(;n.clientWidth>s;)o=o.substring(0,o.length-1),n.innerText=`${o}…`;return i.removeChild(n),[`${o}…`,L]}(r,E.page_font),Q=W(E.page_font,Y),J=F+(d?P:0),X=J+_+Y;if(H){!function(e){e.fillStyle=j,e.fillRect(0,0,v,S)}(H),await async function(e){let{context:t,coverImageUrl:n,icon:s,coverPosition:i=.5}=e;if(n){const e=await K(n),s=e.width*(M/v),o=((0,c.hj)(i)?1-i:.5)*(e.height-s);t.drawImage(e,0,o,e.width,s,0,0,v,M)}else{const e=(0,g.O)({icon:s,theme:b}),n=e?(0,l.Fq)(e,.1):b.home.cards.coverPhoto.base;t.fillStyle=n,t.fillRect(0,0,v,M),t.fillStyle="rgb(0,0,0,1)"}}({context:H,coverImageUrl:u,icon:d,coverPosition:E.page_cover_position}),await async function(e){let{context:t,store:n,icon:s}=e;if(s)if((0,o.Z)(s))t.font=`${C}px ${U}`,t.textAlign="left",t.textBaseline="top",t.fillText(s,w,k);else{const e=i.EK({url:s,baseUrl:m.default.domainBaseUrl,fullyQualified:!0,permissionRecord:n.pointer,width:I,userId:void 0}),o=await K(e);t.drawImage(o,T,Z,I,I)}}({context:H,store:n,icon:d}),q({context:H,text:$,font:Q,color:D,x:A,y:J}),q({context:H,text:p.default.formatMessage(N.builtWithNotion),font:z(E.page_font),color:V,x:R,y:X});const e=await G.convertToBlob();!function(e){let{store:t,file:n,environment:s}=e;x.cT({environment:s,file:n,bucket:"secure",record:t.pointer,onComplete:e=>{y.createAndCommit({userAction:"SocialMediaPreviewImageUploadStore.updateSocialMediaPreviewImage",environment:s,perform:n=>{h.eO({store:t,url:e,transaction:n})}})},retryWhenOffline:!0})}({store:n,environment:s,file:new File([e],"SocialMediaPreviewImage.png",{type:"image/png"})})}}},785526:(e,t,n)=>{n.d(t,{i:()=>u});var s=n(126263),i=n(165958),o=n(421202),a=n(80444),r=n(319385),l=n(206258),d=n(535057),c=n(454642);async function u(e){const{environment:t,sudoModeStore:n,pageBlockId:u}=e,m=n.state.privatePageStore&&n.state.privatePageStore.id===u;if(t.device.isMobile||m||n.state.loading||n.state.error)return;if(!r.default.checkGate({gateName:"enable_get_private_page_info_endpoint"}))return;const{currentSpaceStore:p}=a.default.state,g=null==p?void 0:p.canAdmin();if(!(u&&g&&p&&(0,d.wP)()))return;n.setState({...n.state,loading:!0});const f=p.id,h=await c.getPrivatePageInfo(t,{id:u});if("failed"===h.type)return void n.setState({...n.state,loading:!1,error:h.error});const y=h.data,x=new s.Z({name:i.Gh});for(const s of y)switch(s.table){case"block":case"collection":case"team":x.setRecord({pointer:{spaceId:f,table:s.table,id:s.value.id},userId:t.currentUser.id},{role:"editor",value:s.value})}const S=new l.G(t,{table:o.iU,id:u},{inMemoryRecordCache:x});S.inMemoryRecordCache.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),n.setState({...n.state,privatePageStore:S,loading:!1,error:void 0})}},73966:(e,t,n)=>{n.d(t,{k2:()=>l,l6:()=>r,wk:()=>a});var s=n(842875),i=n(210228),o=n(237181);function a(e){const{environment:t,userSettingsStore:n}=e,i=n.getSettings(),o=null==i?void 0:i.time_zone,a=(0,s.r)();o!==a&&r({environment:t,userSettingsStore:n,timeZone:a})}function r(e){const{environment:t,userSettingsStore:n,timeZone:s}=e;i.createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,perform:e=>{o.d2({userSettingsStore:n,transaction:e,data:{time_zone:s}})},userId:n.id})}function l(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:s}=e;i.createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,perform:e=>{o.d2({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:s}})},userId:n.id})}},970515:(e,t,n)=>{n.d(t,{Q:()=>o});var s=n(401898),i=n(453365);function o(e){var t;const{environment:n,assistantFeatureGateStore:o,currentSpaceViewStore:a,currentSpaceStore:r}=e;if(!a||!r)return!1;const l=(null==r?void 0:r.canAdmin())??!1,d=(0,i.$_)(n,r.id),c=Boolean(null===(t=a.getSettings())||void 0===t?void 0:t.has_user_seen_leap_modal);return o.isWorkspaceLeapEligible()&&l&&!d&&!(0,s.$K)(r.getSettings().enable_ai_training)&&!c}},199726:(e,t,n)=>{n.d(t,{GS:()=>d,M5:()=>c,oj:()=>l});var s=n(79571),i=n(210228),o=n(237181),a=n(80444),r=n(279827);function l(e){const{environment:t,userSettingsStore:n}=e;i.createAndCommit({environment:t,userAction:"debuggingHelpers.markDummyModal",perform:e=>{o.d2({userSettingsStore:n,transaction:e,data:{seen_dummy_modal:!0}})}})}function d(e,t){if(r.default.getCalloutVisibility(t).isEligible){const e=(0,s.QN)(t);r.default.state.forcedCalloutsStore.delete(t),r.default.state.placementStores[e].delete(t)}}function c(e){const t=(0,s.QN)(e);"Modal"===t&&r.default.state.placementStores[t].clear(),r.default.state.placementStores[t].add(e),r.default.state.forcedCalloutsStore.add(e);a.default.state.inAppCalloutStore.updateCalloutStatus({calloutId:e,visible:!0})}},954690:(e,t,n)=>{n.d(t,{$:()=>p});var s=n(647425),i=n(454642),o=n(970515),a=n(215010),r=n(548779),l=n(319385),d=n(88893);const c=4;function u(e){const{requiredStores:{currentUserSettingsStore:t},minAccountAgeInDays:n,announcementDateInMs:s}=e,i=t.getSettings(),o=null==i?void 0:i.signup_time,r=function(e){const{currentUserSettingsStore:t,minAccountAgeInDays:n=c}=e,s=(0,a.e2)(t);return!(Number(s)>=n)}({currentUserSettingsStore:t,minAccountAgeInDays:n});return void 0!==i&&!r&&!(s&&o&&o>s)}function m(e){return"unsubscribed_admin"===e.state.type||"unsubscribed_member"===e.state.type}const p={dummy_modal:async(e,t)=>{var n;const{currentUserSettingsStore:s}=t;return Promise.resolve(!e.device.isMobile&&!e.device.isElectron&&l.default.checkGate({gateName:"can_see_callout_modal_test"})&&u({requiredStores:t})&&!(null!==(n=s.getSettings())&&void 0!==n&&n.seen_dummy_modal))},ai_slack_universal_qna_announcement:async(e,t)=>{const{currentSpaceStore:n,currentSpaceViewStore:o,mainEditorCurrentBlockStore:a,assistantFeatureGateStore:l}=t;if(e.device.isMobile)return!1;const d=o.getSettings();if(void 0===d||void 0!==d.slack_universal_qna_announcement_seen_at)return!1;const c=(n.getMemberCountFromPublicSpaceData()??1)>1;if(!(a.canRead()&&n.canAdmin()&&(0,r.j9)(n)&&(0,s.Mk)(n.getSubscriptionTier())&&c))return!1;if(!u({requiredStores:t,minAccountAgeInDays:8}))return!1;if(!l.canSeeSlackUniversalQnaAnnouncementModal()||!l.isAiEnabled())return!1;try{const t=await i.getConnectedAppsForUniversalQna(e,{spaceId:n.getSpaceId()});return"success"===t.type&&!t.data.connectedApps.includes("slack-admin")}catch{return!1}},ai_assistant_announcement:async(e,t)=>{const{currentUserSettingsStore:n,mainEditorCurrentBlockStore:s,assistantFeatureGateStore:i,currentSpaceStore:a,currentSpaceViewStore:r}=t,l=n.getSettings();if(!l)return!1;if(e.device.isMobile)return!1;const d=void 0!==(null==l?void 0:l.ai_assistant_onboarding_phase),c=Boolean(a.getSettings().enable_ai_training),m=(0,o.Q)({environment:e,assistantFeatureGateStore:i,currentSpaceStore:a,currentSpaceViewStore:r}),p=!d||m&&!c;return Promise.resolve(s.canRead()&&u({requiredStores:t,minAccountAgeInDays:8})&&p&&i.canSeeAssistantFeaturePromotionalModal())},charts_launch_modal:async(e,t)=>{const{currentUserSettingsStore:n,mainEditorCurrentBlockStore:s,experimentStore:i,currentSpaceStore:o}=t,a=n.getSettings();return Promise.resolve(!e.device.isMobile&&n.isReady()&&s.canRead()&&(0,r.j9)(o)&&void 0!==a&&u({requiredStores:t})&&void 0===a.charts_launch_modal_phase&&i.checkGate({gateName:"charts_mvp"})&&i.checkGate({gateName:"charts_beta_launch_modal"}))},sidebar_upgrade_nudge:async(e,t)=>{const{currentUserSettingsStore:n,subscriptionDataStore:s,currentSpaceStore:i}=t,o=n.getSettings();return Promise.resolve(!e.device.isMobile&&!(null!=o&&o.dismissed_sidebar_upgrade_nudge)&&m(s)&&1===d.su(s.state)&&!(0,r.Q9)(i))},persistent_upgrade_nudge:async(e,t)=>{const{subscriptionDataStore:n,experimentStore:s}=t,i="on"===s.getEligibleGroup({experimentId:"money_corner",defaultGroup:"control"});return Promise.resolve(m(n)&&i)},sites_launch_modal:async(e,t)=>Promise.resolve(!1),notion_calendar_launch_promo:(e,t)=>Promise.resolve(!1),ai_qna_alpha:(e,t)=>Promise.resolve(!1),startup_sidebar_footer:(e,t)=>Promise.resolve(!1)}},706210:(e,t,n)=>{n.d(t,{Ev:()=>r,YF:()=>l,bl:()=>a,gF:()=>i,lZ:()=>o});var s=n(730459);function i(e,t){s.K4(e,"callout_show",t)}function o(e,t){s.K4(e,"callout_click",t)}function a(e,t){s.K4(e,"callout_dismiss",t)}function r(e,t){s.K4(e,"callout_engagement",t)}function l(e,t){const{eligible_callouts:n}=t,i=Object.values(n).flatMap((e=>Array.from(e)));s.K4(e,"callout_coordinator_resolved",{eligible_callouts:i})}},65037:(e,t,n)=>{n.d(t,{Z:()=>O});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(427328),l=n(399747),d=n(524677),c=n(898104),u=n(436488),m=n(828451),p=n(550506),g=n(953437),f=n(953336),h=n(132662),y=n(95477),x=n(918514),S=n(434859),v=n(223196),b=n(80444),M=n(279827),j=n(319385),C=n(869454),w=n(992083),k=n(807339),I=n(706210),T=n(559054),Z=n(521273),P=n(288280),F=n(954690),_=n(79571);function A(e){const t=e,n=(0,o.VK)((()=>b.default.state.inAppCalloutStore.getCalloutVisibility(t)),[t]),s=(0,o.VK)((()=>M.default.getCalloutVisibility(e)),[e]);return(0,o.VK)((()=>function(e){const{calloutKey:t,oldSystemCalloutVisibility:n,newSystemCanShow:s}=e,{canShow:i,conflictingKey:o}=n,a=i||_.rx.includes(o)&&o!==t;return s&&a}({calloutKey:e,oldSystemCalloutVisibility:n,newSystemCanShow:s.isEligible})),[n,s,e])}function B(e){const t=(0,o.VK)((()=>j.default.isStatsigReady()),[]),n=(0,o.VK)((()=>j.default.checkGate({gateName:"use_new_callout_modal_placement"})),[]),s=function(e){const t=(0,i.O7)(),{currentUserSettingsStore:n,experimentStore:s,currentUserSettingsStoreState:a,mainEditorCurrentBlockStore:r,currentSpaceStore:l,assistantFeatureGateStore:d,currentSpaceViewStore:c,currentSpaceViewStoreState:u,subscriptionDataStore:m,statsigServiceStateIsReady:p}=(0,o.VK)((()=>{var e,t;return{currentUserSettingsStore:b.default.state.currentUserSettingsStore,experimentStore:j.default,assistantFeatureGateStore:Z.Z,mainEditorCurrentBlockStore:b.default.state.mainEditorCurrentBlockStore,currentSpaceStore:b.default.state.currentSpaceStore,currentUserSettingsStoreState:null===(e=b.default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettingsStore().getValue(),currentSpaceViewStore:b.default.state.currentSpaceViewStore,currentSpaceViewStoreState:null===(t=b.default.state.currentSpaceViewStore)||void 0===t?void 0:t.getSettings(),subscriptionDataStore:P.subscriptionDataStoreInstance,statsigServiceStateIsReady:k.C.state.ready}}),[]),[{value:g}]=(0,T.r5)((async()=>{if(!(n&&s&&a&&r&&l&&c&&u&&m&&p))return!1;const i=F.$[e],o=await i(t,{currentUserSettingsStore:n,experimentStore:s,mainEditorCurrentBlockStore:r,currentSpaceStore:l,assistantFeatureGateStore:d,currentSpaceViewStore:c,subscriptionDataStore:m});return M.default.isForced(e)||o}),[n,s,a,r,l,c,u,m,e,t,d,p]);return Boolean(g)}(e),a=A(e);return!!t&&(n?a:s)}var R=n(785893);function D(e){const{calloutKey:t,children:n,onShow:a,shouldShow:r}=e,l=t,d=(0,i.O7)(),c=(0,o.VK)((()=>j.default.checkGate({gateName:"use_new_callout_modal_placement"})),[]),u=(0,o.VK)((()=>b.default.state.inAppCalloutStore),[]),p=(0,o.VK)((()=>M.default.getCalloutVisibility(t)),[t]),g=(0,s.useMemo)((()=>()=>{null==a||a(),I.gF(d,{callout_key:t,placement_key:"Modal",is_forced:!!c&&p.isForced})}),[d,t,a,p.isForced,c]);return(0,s.useEffect)((()=>{if(c)if(p.isEligible){u.updateCalloutStatus({calloutId:l,visible:!0,validateCanShow:!0})&&g()}else u.updateCalloutStatus({calloutId:l,visible:!1})}),[r,g,l,p.isEligible,u,c]),c?r?(0,R.jsx)(R.Fragment,{children:n}):null:(0,R.jsx)(m.g,{calloutId:t,shouldShow:r,onShow:g,children:n})}function O(e){const{calloutKey:t,onModalShow:n,desktopRenderInner:m,desktopInnerStyle:M,desktopOnDismiss:T,phoneRenderInner:Z,phoneInnerStyle:P}=e,F=(0,i.O7)(),_=(0,i.Fy)(),A=(0,o.VK)((()=>(0,x.__)(F)),[F]),O=(0,o.VK)((()=>{const e=F.TabbedRouterStore;return(0,r.w_)(e.state)}),[F.TabbedRouterStore]),L=(0,o.VK)((()=>{var e;return"web"===O.type&&((null===(e=O.redirectedTo)||void 0===e?void 0:e.route)||O.route)}),[O]),V=(0,o.VK)((()=>{const e="notTransitioning"===b.default.state.spaceTransitionStatus&&b.default.state.initialized,t=j.default.state.isLoaded,n=k.C.isReadyWithUserAndSpaceId();if(!e||!t||!n)return!1;if(w.Z.state.open)return!1;const s=y.default.isAdminMode;return _.isPhone&&A?!s&&L&&"page"===L.name:!s}),[_.isPhone,A,L]),E=(0,o.VK)((()=>F.WindowSizeStore.isLandscape()),[F.WindowSizeStore]),N=(0,o.VK)((()=>F.WindowSizeStore.getSafePaddingTopCSS(l.g)),[F.WindowSizeStore]),U=(0,o.VK)((()=>{const e=C.Z.state.phase===C.i.hidden||C.Z.state.phase===C.i.willHide;let t=C.Z.estimatedNativeWebBottomOverlap();return _.isMobileBrowser&&(t+=32),e?F.WindowSizeStore.getSafePaddingBottomPx(t):t}),[_.isMobileBrowser,F.WindowSizeStore]),K=B(t),W=(0,s.useCallback)((()=>{null==n||n(),_.isPhone&&(d.ZH({debug:{userAction:"AnnouncementModal2.resolvedOnModalShow"},environment:F}),c.sD())}),[F,_.isPhone,n]),z=(0,a.yK)((e=>({popupStyle:{background:e.sidebarBackground,borderRadius:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},scrollerStyle:{background:e.sidebarBackground,width:E?"80%":"100%",height:E?void 0:"100%",display:"flex",flexDirection:"column",alignItems:"center",...P},modalStyle:{background:e.sidebarBackground,borderRadius:12,...M}})),[E,M,P]);return _.isPhone?V?(0,R.jsx)(D,{calloutKey:t,shouldShow:K,onShow:W,children:(0,R.jsx)(g.ZP,{open:K,forceFullScreenSlideUp:!0,hidesMobileNativeBottomBar:!0,preventBlockRenderQueueOnEnter:!0,popupType:v.k.SlideUp,onDismiss:()=>{I.bl(F,{callout_key:t,placement_key:"Modal",dismiss_type:"modal_background_clicked"})},onClosed:()=>{I.bl(F,{callout_key:t,placement_key:"Modal",dismiss_type:"modal_dismiss_clicked"})},style:z.popupStyle,render:()=>(0,R.jsxs)(f.Z,{type:E?S.Z.Y:S.Z.None,style:z.scrollerStyle,children:[(0,R.jsx)(h.Z,{size:E?200:N}),Z(),(0,R.jsx)(h.Z,{size:U})]})})}):null:V?(0,R.jsx)(D,{calloutKey:t,shouldShow:K,onShow:W,children:(0,R.jsx)(p.Z,{open:K,preventHideChildrenWhileOpening:!0,onDismiss:T,innerStyle:z.modalStyle,render:()=>(0,R.jsx)(u.Z,{capture:!0,allowEsc:!0,render:m})})}):null}},981663:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(137810),l=n(661519),d=n(164369),c=n(976940),u=n(80444),m=n(319385),p=n(199726),g=n(706210),f=n(65037),h=n(785893);const y="dummy_modal";const x=function(){const e=(0,i.O7)(),t=(0,a.yK)((e=>({container:{maxWidth:442},content:{padding:24,display:"flex",flexDirection:"column"},title:{fontWeight:r.Z.fontWeight.bold,fontSize:25,display:"flex",marginBottom:6},divider:{backgroundColor:e.tableLightDividerColor,opacity:.5},footer:{padding:"20px 24px",display:"flex",alignItems:"center",justifyContent:"space-between"}})),[]),n=(0,s.useCallback)((()=>{const{currentUserSettingsStore:t}=u.default.state;t&&(p.oj({environment:e,userSettingsStore:t}),p.GS(e,y))}),[e]),x=(0,s.useCallback)((()=>{n(),g.bl(e,{callout_key:y,placement_key:"Modal",dismiss_type:"modal_dismiss_clicked"})}),[n,e]),S=(0,s.useCallback)((()=>{n(),g.bl(e,{callout_key:y,placement_key:"Modal",dismiss_type:"modal_background_clicked"})}),[n,e]);return(0,o.VK)((()=>m.default.checkGate({gateName:"can_see_callout_modal_test"})),[])?(0,h.jsx)(f.Z,{calloutKey:y,desktopRenderInner:()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{style:t.content,children:[(0,h.jsx)("div",{style:t.title,children:"Hard coded title here"}),(0,h.jsx)(d.Z,{isSecondaryColor:!0,isMultiline:!0,children:"Hard coded UI label "}),(0,h.jsx)(c.U4,{onClick:x})]}),(0,h.jsx)(l.Z,{size:1,style:t.divider}),(0,h.jsx)("div",{style:t.footer,children:"Footer content"})]}),desktopInnerStyle:t.container,desktopOnDismiss:S,phoneRenderInner:()=>null}):null}},459827:(e,t,n)=>{n.d(t,{Q:()=>l});n(667294);var s=n(137810),i=n(623879),o=n(785893);const a={...s.Z.textOverflowStyle,position:"absolute",left:0,right:0,top:0,bottom:0},r={marginLeft:4,fontWeight:s.Z.fontWeight.semibold};function l(e){const{prefix:t,viewName:n,viewType:s}=e;return(0,o.jsxs)("div",{style:{position:"relative",width:"100%"},children:[" ",(0,o.jsxs)("div",{style:a,children:[t,s&&i.aW[s]({marginLeft:8,marginRight:2,width:"1em",display:"inline",verticalAlign:"bottom"}),(0,o.jsx)("span",{style:r,children:n})]})]})}},841464:(e,t,n)=>{n.d(t,{Z:()=>S});var s=n(667294),i=n(800480),o=n(336154),a=n(436610),r=n(296994),l=n(68204),d=n(635328),c=n(277907),u=n(95802),m=n(708949),p=n(319385),g=n(222294),f=n(186486),h=n(27724),y=n(138870),x=n(785893);function S(e){const t=(0,i.O7)(),{value:n}=(0,c.XJ)(r.FF.markdownLinkifyIt),{value:a}=(0,c.XJ)(r.FF.tinyMceMicrosoftWordPasteFilter),l=(0,s.useRef)(),d=(0,s.useRef)();(0,s.useEffect)((()=>{function e(e){e.clientX===l.current&&e.clientY===d.current||(l.current=e.clientX,d.current=e.clientY,g.Z.setKeyboardMode(!1))}return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]);const u=(0,s.useMemo)((()=>function(e,t,n){const s={};for(const i of o.L6)for(const o of i.shortcuts)s[o]=s=>b(o,s,e,t,n);return s}(n,a,t)),[t,n,a]);return(0,x.jsx)(y.Z,{debugName:e.debugName,priority:e.priority,enable:e.capture,shortcuts:u})}function v(){return!function(){const e=document.querySelector("#intercom-container");return!(!e||!e.contains(document.activeElement))}()&&!(m.Z.state.isActive&&!p.default.checkGate({gateName:"block_menu_shortcut_fix"}))}function b(e,t,n,s,i){if(!v())return;const r=h.default.state.stores,c=h.default.state.pivot||r[0],y=c&&u.C.getRectFromStore(c),x=o.L6.find((t=>!!t.shortcuts.some((t=>t===e))&&l.vG(t,{environment:i,blocks:r,originRect:y,publicEditMode:void 0})));if(x){"keydown"===t.type&&t.preventDefault&&t.preventDefault();const e=m.Z.state.isActive;x.action({environment:i,blocks:r,originRect:y,publicEditMode:void 0,lazyDependencies:{markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:s}},t);const o=r[0];let l,c,u,h;var S;if(o)l=o.getType(),c=l?(0,d._A)(l,o.getFormat()):void 0,u=null===(S=o.getCollectionViewCollectionStore())||void 0===S?void 0:S.id,h=o.getParentCollectionIdUpToTwoLevels();a.dh(i,{analyticsName:x.analyticsName,action_type:x.analyticsActionType,from:"keyboard_shortcut",block_id:null==o?void 0:o.id,block_type:l,is_toggleable:c,collection_id:u,parent_collection_id:h}),b={resetBlockMenuStore:e},g.Z.setKeyboardMode(!0),f.default.reset(),p.default.checkGate({gateName:"block_menu_shortcut_fix"})&&b.resetBlockMenuStore&&m.Z.reset()}var b}},230074:(e,t,n)=>{n.r(t),n.d(t,{AiAssistantIntroModal:()=>N});var s=n(667294),i=n(800480),o=n(184747),a=n(886628),r=n(724405),l=n(841892),d=n(726139),c=n(16184),u=n(725651),m=n(435840),p=n(745238),g=n(785893);const f=(0,p.IU)("speechBubble",{viewBox:"0 0 16 16",svg:(0,g.jsx)("path",{d:"M4.32 15.424c.39 0 .677-.192 1.149-.609l2.344-2.064h4.116c2.057 0 3.213-1.19 3.213-3.22V4.22c0-2.03-1.156-3.22-3.213-3.22H3.213C1.163 1 0 2.19 0 4.22V9.53c0 2.037 1.196 3.22 3.165 3.22h.28v1.675c0 .608.322.998.875.998zm.342-1.531v-1.949c0-.403-.178-.56-.56-.56H3.26c-1.285 0-1.9-.65-1.9-1.894V4.26c0-1.243.615-1.893 1.9-1.893h8.627c1.278 0 1.893.65 1.893 1.894v5.23c0 1.243-.615 1.893-1.893 1.893h-4.15c-.417 0-.622.068-.909.369l-2.167 2.14z"})});var h=n(709291),y=n(401898),x=n(137810),S=n(709953),v=n(608055),b=n(210228),M=n(244458),j=n(828344),C=n(148604),w=n(724199),k=n(970515),I=n(144500),T=n(199726),Z=n(65037),P=n(976940),F=n(80444),_=n(521273),A=n(428451),B=n(689024),R=n(897122),D=n(584076),O=n(449806),L=n(164369),V=n(942402);const E=(0,h.defineMessages)({shareDataTitle:{defaultMessage:"You’re in control of your data",id:"AiAssistantWelcomeModal.intro.titleShareData"},shareDataHeader:{defaultMessage:"By default, Notion does not train on your content",id:"AiAssistantWelcomeModal.intro.shareDataHeader"},shareDataDescription:{defaultMessage:"But, if you’d like to help improve our models and features, please opt-in below:",id:"AiAssistantWelcomeModal.intro.shareDataDescription"},welcomeTitle:{defaultMessage:"Meet the new Notion AI",id:"AiAssistantWelcomeModal.intro.title"},searchLabel:{defaultMessage:"<bold>Search and find</bold> anything in your Notion",id:"AiAssistantIntroModal.SearchAndFind"},createLabel:{defaultMessage:"<bold>Create and edit content</bold>, personalized to you",id:"AiAssistantIntroModal.personalizedWorkspace.caption"},chatLabel:{defaultMessage:"<bold>Chat and brainstorm</bold> any topic with GPT-4",id:"AiAssistantIntroModal.chatAboutAnything.caption"}});function N(){const e=(0,i.O7)(),t=(0,s.useCallback)((t=>{let{source:n}=t;const{currentUserSettingsStore:s}=F.default.state;s&&((0,j.trackAssistantIntroModalClose)(e,{source:n}),(0,M.setAssistantOnboardingPhase)(e,{phase:"tooltip",transactionUserAction:"AiAssistantIntroModal.dismissModal",userSettingsStore:s}),T.GS(e,"ai_assistant_announcement"))}),[e]);return(0,A.useSetLastExposedToQnaAtTimestamp)(),(0,g.jsx)(Z.Z,{calloutKey:"ai_assistant_announcement",desktopRenderInner:()=>(0,g.jsx)(z,{onDismiss:t}),phoneRenderInner:()=>null})}function U(e){const{icon:t,skillSectionType:n}=e,i=(0,r.yK)((e=>{const{color:t,background:s}=(0,I.getSkillSectionColor)(n,e);return{rowItemWrapper:{display:"flex",alignItems:"center",color:e.text.secondary},rowItemIconWrapper:{color:t,background:s,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:100},rowItemIcon:{height:30,width:30,padding:8},bold:{fontWeight:x.Z.fontWeight.semibold}}}),[n]),o=(0,s.useMemo)((()=>{const e={bold:e=>(0,g.jsx)("strong",{style:i.bold,children:e})};switch(n){case"search":return(0,g.jsx)(h.FormattedMessage,{...E.searchLabel,values:e});case"create":return(0,g.jsx)(h.FormattedMessage,{...E.createLabel,values:e});case"chat":return(0,g.jsx)(h.FormattedMessage,{...E.chatLabel,values:e});default:(0,y.t1)(n)}}),[n,i.bold]);return(0,g.jsxs)("div",{style:i.rowItemWrapper,children:[(0,g.jsx)("div",{style:i.rowItemIconWrapper,children:t(i.rowItemIcon)}),(0,g.jsx)(L.Z,{style:{paddingLeft:8},children:o})]})}function K(){const e=(0,r.yK)((e=>{const{color:t,background:n}=(0,I.getSkillSectionColor)("search",e);return{rowItemWrapper:{display:"flex",alignItems:"start",marginBottom:12},rowItemIconWrapper:{color:t,background:n,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:100,marginRight:8},rowItemIcon:{height:30,width:30,padding:8},sharedataTitle:{fontWeight:x.Z.fontWeight.medium,fontSize:14,marginBottom:4},textWrapper:{display:"flex",flexDirection:"column",maxWidth:"100%"}}}),[]);return(0,g.jsxs)("div",{style:e.rowItemWrapper,children:[(0,g.jsx)("div",{style:e.rowItemIconWrapper,children:(0,c.Q)(e.rowItemIcon)}),(0,g.jsxs)("div",{style:e.textWrapper,children:[(0,g.jsx)("div",{style:e.sharedataTitle,children:(0,g.jsx)(h.FormattedMessage,{...E.shareDataTitle})}),(0,g.jsx)(L.Z,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,g.jsx)(h.FormattedMessage,{...E.shareDataDescription})})]})]})}function W(){const e=(0,A.useNamedStyles)();return(0,r.yK)((t=>({...e,sparklesIcon:{fill:t.accentColors.translucentGray[800],width:14},contentWrapper:{paddingLeft:24,paddingRight:26,width:420},title:{fontSize:25,fontWeight:700,paddingBottom:22},body:{fontWeight:400,fontSize:14,color:t.v2.text.secondary},faceImg:{pointerEvents:"none",width:87,height:87,boxShadow:t.lightBoxShadow,borderRadius:100},imgWrap:{display:"flex",alignItems:"center",paddingTop:40,paddingBottom:30,paddingLeft:24},spacer:{marginTop:20,marginBottom:20},footer:{...e.footer,paddingTop:24,paddingBottom:24,marginTop:20},simpleFooter:{paddingBottom:24},helpTitle:{fontSize:14,fontWeight:600},consentButton:{fontWeight:600,height:"36px"},firstSelector:{fontWeight:400,border:"none"},lastSelector:{fontWeight:400,border:"none"}})),[e])}function z(e){const{onDismiss:t}=e,n=(0,i.O7)(),o=(0,h.useIntl)(),[r,d]=(0,s.useState)("welcome"),c=(0,a.VK)((()=>{const e=F.default.state.currentSpaceStore,t=F.default.state.currentSpaceViewStore;return!(!e||!t)&&(0,k.Q)({environment:n,assistantFeatureGateStore:_.Z,currentSpaceStore:e,currentSpaceViewStore:t})}),[n]),p=(0,s.useCallback)((()=>{c?d("leap"):((0,j.trackAssistantIntroModalTryNow)(n,{}),t({source:"tryNow"}),v.c4({environment:n,url:"/chat"}),(0,C.startTutorial)({environment:n,fromForAnalytics:"introModal",skipAnalytics:!1,intl:o}))}),[c,n,t,o]),y=(0,s.useCallback)((()=>{if(t({source:"closeButton"}),c){const e=F.default.state.currentSpaceViewStore;if(!e)return;b.createAndCommit({userAction:"AiAssistantIntroModal.updateLeapModalSeen",environment:n,perform:t=>{b.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),has_user_seen_leap_modal:!0}},transaction:t})}})}}),[t,c,n]),x=(0,s.useCallback)((()=>{w.assistantAnalyticsActions.trackLeapDismissed(n),y()}),[n,y]);(0,s.useEffect)((()=>{const e=Date.now();return()=>{const t=Date.now();(0,j.trackAssistantIntroModalRead)(n,{reading_time:t-e})}}),[]);const S=(0,s.useMemo)((()=>[{skillSectionType:"search",icon:m.R},{skillSectionType:"create",icon:u.R},{skillSectionType:"chat",icon:f}]),[]),M=W(),I=(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{style:M.title,children:(0,g.jsx)(h.FormattedMessage,{...E.welcomeTitle})}),(0,g.jsx)(B.jX,{direction:"column",gap:13,children:S.map((e=>(0,g.jsx)(U,{icon:e.icon,skillSectionType:e.skillSectionType},e.skillSectionType)))}),(0,g.jsxs)(B.jX,{align:"center",direction:"row",gap:"auto",style:M.footer,children:[(0,g.jsx)(H,{}),(0,g.jsx)(B.jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:(0,g.jsx)(R.h,{onClick:p,children:(0,g.jsx)(h.FormattedMessage,{defaultMessage:"Try it",id:"AssistantIntroMessage.intro.signup.nextMessage"})})})]})]});return(0,g.jsxs)("div",{children:[(0,g.jsx)(P.U4,{onDismiss:y}),(0,g.jsxs)(B.jX,{gap:0,children:[(0,g.jsx)("div",{style:M.imgWrap,children:(0,g.jsx)("img",{style:M.faceImg,src:l.Z.images.animatedAssistantFaceGif,alt:"Notion AI logo"})}),(0,g.jsx)("div",{style:M.contentWrapper,children:"leap"===r?(0,g.jsx)(q,{onDismiss:x}):I})]})]})}function q(e){const{onDismiss:t}=e,[n,a]=(0,s.useState)(),l=void 0===n,d=(0,i.O7)(),c=(0,s.useCallback)((e=>{a(e),w.assistantAnalyticsActions.trackLeapPreferenceSelect(d,{will_share:e})}),[d]),u=(0,s.useCallback)((e=>{const t=F.default.state.currentSpaceStore;t&&b.createAndCommit({userAction:"AiAssistantIntroModal.updateWorkspaceShouldTrain",environment:d,perform:n=>{S.sW({store:t,data:{settings:{...t.getSettings(),enable_ai_training:e}},transaction:n})}})}),[d]),m=(0,s.useCallback)((()=>{(0,y.$K)(n)&&(u(n),w.assistantAnalyticsActions.trackLeapSubmit(d,{will_share:n})),t()}),[d,t,n,u]);(0,o.Z)((()=>{w.assistantAnalyticsActions.trackLeapPresented(d)}));const p=W(),f=(0,r.yK)((()=>({...p,skip:{fontSize:14,padding:"0px 12px",height:36,display:"flex",alignItems:"center",cursor:l?"default":"pointer",opacity:l?.4:1}})),[l,p]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{style:f.title,children:(0,g.jsx)(h.FormattedMessage,{...E.shareDataTitle})}),(0,g.jsx)(K,{}),(0,g.jsxs)(B.jX,{direction:"column",children:[(0,g.jsx)(O.n,{style:f.firstSelector,label:(0,g.jsx)(h.FormattedMessage,{defaultMessage:"Share data to help improve Notion AI",id:"AiAssistantWelcomeModal.admin.shareData"}),onChange:()=>{},isSelected:!0===n,onClick:()=>c(!0),value:"share_data",selectType:"radio"}),(0,g.jsx)(O.n,{style:f.lastSelector,label:(0,g.jsx)(h.FormattedMessage,{defaultMessage:"Do not share data",id:"AiAssistantWelcomeModal.admin.doNotShareData"}),onChange:()=>{},selectType:"radio",isSelected:!1===n,onClick:()=>c(!1),value:"do_not_share_data"})]}),(0,g.jsxs)(B.jX,{align:"center",direction:"row",gap:"auto",style:f.footer,children:[(0,g.jsx)(G,{}),(0,g.jsx)(B.jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:(0,g.jsx)(R.h,{onClick:m,disabled:l,children:(0,g.jsx)(h.FormattedMessage,{defaultMessage:"Confirm",id:"AssistantIntroMessage.intro.signup.confirmMessage"})})})]})]})}function G(){const e=(0,r.Fg)(),t=(0,i.O7)(),n=(0,s.useCallback)((e=>{w.assistantAnalyticsActions.trackLeapLinkClick(t,{link:e})}),[t]);return(0,g.jsx)("div",{style:{color:e.mediumTextColor,fontSize:12,width:256},children:(0,g.jsx)("div",{children:(0,g.jsx)(h.FormattedMessage,{defaultMessage:"If you choose to share data, you are agreeing to these <terms>Terms</terms>. <learnmore>Learn more</learnmore>",id:"AiAssistantIntroModal.AdminAgreeToTerms",values:{terms:e=>(0,g.jsx)(V.Z,{onClick:()=>n("terms"),external:!0,href:"https://www.notion.so/notion/Notion-AI-Learning-and-Early-Access-Program-Terms-0c55d702d0154a788d9e70c4ee396399",children:e}),learnmore:e=>(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:"2px"},children:[(0,g.jsx)(V.Z,{onClick:()=>n("faq"),external:!0,href:"https://www.notion.so/help/notion-ai-leap-program-faqs",children:e}),(0,d.K)({width:14,height:14})]})})}})})})}function H(){const e=(0,A.useNamedStyles)(),t=(0,i.O7)(),n=(0,s.useCallback)((()=>{(0,j.trackLearnMoreAboutAssistantClicked)(t,{})}),[t]);return(0,g.jsx)("div",{style:e.learnMoreCopy,children:(0,g.jsxs)(D.Z,{onClick:n,style:e.learnMoreLink,innerStyle:e.learnMoreLinkInner,href:"https://notion.notion.site/Alpha-Notion-AI-Onboarding-Guide-3a48e38bbe9e49d7bd07824aa4178136?pvs=4",external:!0,children:[(0,g.jsx)(h.FormattedMessage,{defaultMessage:"Learn more",id:"AiAssistantIntroModal.LearnMoreAboutAssistantButton"}),(0,d.K)({width:14,height:14,marginTop:2,marginLeft:4})]})})}},428451:(e,t,n)=>{n.r(t),n.d(t,{AI_QNA_DEMO_VIDEO_URL:()=>R,AiQnaIntroVideo:()=>N,Footer:()=>$,LearnMoreLink:()=>Y,NotionAI:()=>Q,QnaTermsApplyLink:()=>G,default:()=>H,getAiQnaDemoVideoUrl:()=>D,useNamedStyles:()=>J,useSetLastExposedToQnaAtTimestamp:()=>K});var s=n(667294),i=n(313991),o=n(800480),a=n(886628),r=n(724405),l=n(389968),d=n(582356),c=n(11751),u=n(471924),m=n(709291),p=n(401898),g=n(137810),f=n(225888),h=n(454642),y=n(244458),x=n(828344),S=n(976940),v=n(215010),b=n(80444),M=n(521273),j=n(319385),C=n(167940),w=n(992083),k=n(366309),I=n(689024),T=n(690403),Z=n(897122),P=n(584076),F=n(489728),_=n(164369),A=n(706175),B=n(785893);const R={"en-US":"https://player.vimeo.com/video/881812861?h=55c8e40bb3"};function D(){return R["en-US"]}const O=!1,L=24,V=254,E=170;function N(e){const t=J(),{isSmall:n,disableAutoplay:s}=e;return(0,B.jsx)(A.Z,{src:D(),defaultTextTrack:A.W[i.SP]||"en",options:{muted:!0,autoplay:!s,loop:!1},style:n?t.smallVariantVideoStubPng:t.stubPng})}function U(e){const{currentUserSettingsStore:t}=b.default.state;t&&(0,y.setQnaOnboardingPhase)(e,{userSettingsStore:t,phase:"tooltip",transactionUserAction:"AiQnaIntroModal.debug.clickTryNow"})}function K(){const e=(0,s.useRef)(!1),t=(0,o.O7)();(0,a.VK)((()=>{const{currentUserSettingsStore:n}=b.default.state;if(!n||!n.isReady())return;if(!M.Z.showRemindersToUseQnA())return;const s=n.getSettingsStore().getKeyStore("last_exposed_to_ai_qna_at").getValue();(0,p.$K)(s)||e.current||(e.current=!0,(0,y.setLastExposedToQnaAtToCurrentTimestamp)(t,{userSettingsStore:n}))}),[t])}function W(e){const{onImport:t,onSkip:n}=e,i=J(),a=(0,r.Fg)(),c=(0,o.O7)();return(0,s.useEffect)((()=>{(0,x.trackQnaIntroModalShowImportRecommendation)(c)}),[c]),(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(S.U4,{}),(0,B.jsxs)(I.jX,{gap:30,children:[(0,B.jsx)(I.jX,{padding:"10px 22px 0px 28px",children:(0,d.l)({marginTop:20,marginBottom:-10,width:32,height:32,fill:a.lightIconColor})}),(0,B.jsxs)("div",{style:i.introCopyArea,children:[(0,B.jsx)("div",{style:i.introTitle,children:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Add content for Q&A",id:"AiQnaIntroModal.import.title"})}),(0,B.jsx)(_.Z,{isSecondaryColor:!0,isMultiline:!0,style:i.mainCopyText,children:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"AI answers questions from content in your Notion workspace. Get better responses by importing content from other tools.",id:"AiQnaIntroModal.import.caption"})}),(0,B.jsxs)("div",{style:i.importDisclaimerWrap,children:[(0,l.Y)(i.clockIcon),(0,B.jsx)(_.Z,{isSecondaryColor:!0,isSmall:!0,children:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Q&A may take up to 30 minutes to process new content",id:"AiQnaIntroModal.import.disclaimer"})})]})]}),(0,B.jsxs)($,{children:[(0,B.jsx)(Y,{shouldShowHelpCenterLink:!0}),(0,B.jsxs)(I.jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:[(0,B.jsx)(F.Z,{isGray:!0,onClick:n,children:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Skip",id:"AiQnaIntroModal.import.skipButtonLabel"})}),(0,B.jsx)(Z.h,{onClick:t,children:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Import",id:"AiQnaIntroModal.import.importButtonLabel"})})]})]})]})]})}function z(e){const{setShouldShowImportModal:t}=e,n=(0,o.O7)(),i=(0,a.VK)((()=>{const{currentSpaceStore:e}=b.default.state;return null==e?void 0:e.getSpaceId()}),[]);return(0,s.useEffect)((()=>{i?h.getQnaOnboardingData(n,{spaceId:i}).then((e=>{t("success"===e.type?e.data.isImportingDataRecommended:O)})).catch((e=>{console.error(e),t(O)})):t(O)}),[n,t,i]),null}function q(e){const{onContinue:t}=e,n=J(),i=(0,o.O7)();return(0,s.useEffect)((()=>{(0,x.trackQnaIntroModalOpen)(i)}),[i]),(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(S.U4,{}),(0,B.jsxs)(I.jX,{gap:30,children:[(0,B.jsx)(N,{}),(0,B.jsxs)("div",{style:n.introCopyArea,children:[(0,B.jsx)(Q,{}),(0,B.jsxs)("div",{style:n.introTitle,children:[(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Welcome to Q&A",id:"AiQnaIntroModal.intro.title"}),(0,B.jsx)(T.Z,{style:n.betaBadge,content:(0,B.jsx)(m.FormattedMessage,{id:"AiQnaIntroModal.intro.betaLabel",defaultMessage:"Beta"})})]}),(0,B.jsx)(_.Z,{isSecondaryColor:!0,isMultiline:!0,style:n.mainCopyText,children:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Get instant answers to your questions, using information from across your workspace.",id:"AiQnaIntroModal.intro.caption"})}),(0,B.jsx)("div",{style:{marginTop:10},children:(0,B.jsx)(Y,{shouldShowHelpCenterLink:!0})})]}),(0,B.jsxs)($,{children:[(0,B.jsx)(G,{}),(0,B.jsx)(I.jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:(0,B.jsx)(Z.h,{onClick:t,children:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Continue",id:"AiQnaIntroModal.intro.signup.nextMessage"})})})]})]})]})}function G(){const e=J(),t=(0,o.O7)();return(0,B.jsx)("div",{style:e.learnMoreCopy,children:(0,B.jsx)(P.Z,{onClick:()=>{f.IS(t,{from:"qna_intro_modal"})},style:e.learnMoreLink,innerStyle:e.learnMoreLinkInner,href:"https://notion.notion.site/39fa8d3593344f478917db8ff3dfc852",external:!0,children:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Q&A Beta terms apply",id:"AiQnaIntroModal.intro.termsApplyButton"})})})}const H=(0,m.injectIntl)((function(e){const[t,n]=(0,s.useState)(!1),i=(0,o.O7)(),l=(0,r.Fg)(),[d,c]=(0,s.useState)(O),[m,g]=(0,s.useState)("welcome"),[f,h]=(0,s.useState)(!1),I=(0,s.useCallback)((()=>{const{currentUserSettingsStore:e}=b.default.state;e&&((0,y.setQnaOnboardingPhase)(i,{userSettingsStore:e,phase:"tooltip",transactionUserAction:"AiQnaIntroModal.debug.clickCancel"}),(0,x.trackQnaIntroModalClose)(i,{modal_phase:m}))}),[i,m]),T=(0,s.useCallback)((()=>{(0,x.trackQnaIntroModalContinue)(i),d?g("importContent"):U(i)}),[i,d]),Z=(0,s.useCallback)((()=>{(0,x.trackQnaIntroModalSkipImportClick)(i),U(i)}),[i]),P=(0,s.useCallback)((()=>{(0,x.trackQnaIntroModalImportClick)(i),w.Z.setState({...w.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}),C.Z.setState({flowId:u.Il()}),h(!0)}),[i]),F=(0,a.VK)((()=>!w.Z.state.open),[]),_=(0,a.VK)((()=>{if(!j.default.isStatsigReady())return!1;const{currentUserSettingsStore:e,currentSpaceStore:t,mainEditorCurrentBlockStore:n}=b.default.state;if(!e||!e.isReady())return!1;const s=e.getSettings();return!!s&&(!!(t&&n&&n.canRead())&&(!i.device.isMobile&&(!f&&(!(Number((0,v.e2)(e))<=2)&&(!M.Z.canSeeAssistantFeaturePromotionalModal()&&(!(void 0!==s.ai_qna_intro_onboarding_phase||!M.Z.showAiQnaOnboardingModalForBetaLaunch())||void 0))))))}),[f,i]);return K(),(0,s.useEffect)((()=>{n(!!_)}),[_]),(0,s.useEffect)((()=>{f&&F&&(h(!1),U(i))}),[f,F,i]),(0,B.jsx)(S.gv.Provider,{value:I,children:(0,B.jsx)(k.default,{shouldShow:t,calloutId:"ai_qna_alpha",desktopRenderInner:()=>{switch(m){case"welcome":return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(z,{setShouldShowImportModal:c}),(0,B.jsx)(q,{onContinue:T})]});case"importContent":return(0,B.jsx)(W,{onImport:P,onSkip:Z});default:(0,p.t1)(m)}},desktopInnerStyle:{background:l.sidebarBackground,borderRadius:12,width:450},desktopOnDismiss:I,phoneRenderInner:()=>null})})}));function $(e){const{children:t}=e,n=J(),{isPhone:s}=(0,o.Fy)();return s?(0,B.jsx)(I.jX,{align:"center-right",gap:12,padding:L,style:n.footer,children:t}):(0,B.jsx)(I.jX,{align:"center",direction:"row",gap:"auto",padding:L,style:n.footer,children:t})}function Y(e){let{shouldShowHelpCenterLink:t}=e;const n=J(),s=(0,o.O7)();return(0,B.jsx)("div",{style:n.learnMoreCopy,children:(0,B.jsx)(P.Z,{onClick:()=>{f.Fs(s,{from:"qna_intro_modal"})},style:n.learnMoreLink,innerStyle:n.learnMoreLinkInner,href:t?"https://www.notion.so/help/qna":"https://www.notion.so/ai",external:!0,children:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Learn more about Q&A",id:"AiQnaIntroModal.intro.learnMoreUrl"})})})}function Q(){const e=J();return(0,B.jsxs)(I.jX,{direction:"row",children:[(0,c.t)(e.sparklesIcon),(0,B.jsx)(_.Z,{isSmall:!0,style:e.notionAiText,children:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Notion AI",id:"AiQnaIntroModal.intro.brandingHero"})})]})}function J(){return(0,r.yK)((e=>({betaBadge:{borderRadius:4,display:"inline-block",fontSize:11,fontWeight:500,padding:"1px 4px"},importDisclaimerWrap:{marginTop:10,display:"flex",alignItems:"center",gap:2},clockIcon:{width:14,height:14,color:e.mediumTextColor},footer:{borderTop:`1px solid ${e.tableLightDividerColor}`},introCopyArea:{paddingLeft:L,paddingRight:L},introTitle:{fontWeight:g.Z.fontWeight.bold,fontSize:25,display:"flex"},learnMoreCopy:{color:e.mediumTextColor,fontSize:12,textDecoration:"underline"},learnMoreLink:{width:"max-content",marginLeft:-4},learnMoreLinkInner:{display:"flex",alignItems:"center",paddingLeft:4,paddingRight:4},mainCopyText:{width:350},notionAiText:{marginTop:2,paddingLeft:4,color:e.accentColors.gray[900],fontWeight:g.Z.fontWeight.medium},sparklesIcon:{width:14},stubPng:{width:"100%",height:V},smallVariantVideoStubPng:{width:"100%",height:E}})),[])}},187493:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});n(667294);var s=n(800480),i=n(175306),o=n(460709),a=n(748019),r=n(478140),l=n(785893);const d=function(e){let{blockStore:t,onAccept:n}=e;const d={blocks:[t],environment:(0,s.O7)(),publicEditMode:void 0};return(0,l.jsx)(r.Z,{menuType:o.og.Popup,children:(0,l.jsx)(a.Z,{sections:i.Qi,context:d,onAccept:n})})}},366309:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});n(667294);var s=n(800480),i=n(886628),o=n(724405),a=n(427328),r=n(399747),l=n(524677),d=n(898104),c=n(95477),u=n(918514),m=n(434859),p=n(223196),g=n(80444),f=n(319385),h=n(869454),y=n(992083),x=n(807339),S=n(436488),v=n(828451),b=n(550506),M=n(953437),j=n(953336),C=n(132662),w=n(785893);function k(e){const t=(0,s.O7)(),n=(0,o.Fg)(),k=(0,s.Fy)(),I=(0,i.VK)((()=>(0,u.__)(t)),[t]),T=(0,i.VK)((()=>t.TabbedRouterStore),[t.TabbedRouterStore]),Z=(0,i.VK)((()=>(0,a.w_)(T.state)),[T]),P=(0,i.VK)((()=>{var e;return"web"===Z.type&&((null===(e=Z.redirectedTo)||void 0===e?void 0:e.route)||Z.route)}),[Z]),F=(0,i.VK)((()=>{const t="notTransitioning"===g.default.state.spaceTransitionStatus&&g.default.state.initialized,n=f.default.state.isLoaded,s=x.C.isReadyWithUserAndSpaceId();if(!t||!n||!s)return!1;if(y.Z.state.open)return!1;const i=c.default.isAdminMode;return k.isPhone&&I?e.shouldShow&&!i&&P&&"page"===P.name:e.shouldShow&&!c.default.isAdminMode}),[k.isPhone,I,e.shouldShow,P]),_=(0,i.VK)((()=>t.WindowSizeStore.isLandscape()),[t.WindowSizeStore]),A=(0,i.VK)((()=>t.WindowSizeStore.getSafePaddingTopCSS(r.g)),[t.WindowSizeStore]),B=(0,i.VK)((()=>{const e=h.Z.state.phase===h.i.hidden||h.Z.state.phase===h.i.willHide;let n=h.Z.estimatedNativeWebBottomOverlap();return k.isMobileBrowser&&(n+=32),e?t.WindowSizeStore.getSafePaddingBottomPx(n):n}),[k.isMobileBrowser,t.WindowSizeStore]);if(k.isPhone){function R(){var n;null===(n=e.onModalShow)||void 0===n||n.call(e),l.ZH({debug:{userAction:"AnnouncementModal.onShow"},environment:t}),d.sD()}return(0,w.jsx)(v.g,{calloutId:e.calloutId,shouldShow:F,onShow:R,children:(0,w.jsx)(M.ZP,{open:F,forceFullScreenSlideUp:!0,hidesMobileNativeBottomBar:!0,preventBlockRenderQueueOnEnter:!0,popupType:p.k.SlideUp,style:{background:n.sidebarBackground,borderRadius:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},render:()=>(0,w.jsxs)(j.Z,{type:_?m.Z.Y:m.Z.None,style:{background:n.sidebarBackground,width:_?"80%":"100%",height:_?void 0:"100%",display:"flex",flexDirection:"column",alignItems:"center",...e.phoneInnerStyle},children:[(0,w.jsx)(C.Z,{size:_?200:A}),e.phoneRenderInner(),(0,w.jsx)(C.Z,{size:B})]})})})}return(0,w.jsx)(v.g,{calloutId:e.calloutId,shouldShow:F,onShow:e.onModalShow,children:(0,w.jsx)(b.Z,{open:F,preventHideChildrenWhileOpening:!0,onDismiss:e.desktopOnDismiss,innerStyle:{background:n.sidebarBackground,borderRadius:12,...e.desktopInnerStyle},render:()=>(0,w.jsx)(S.Z,{capture:!0,allowEsc:!0,render:e.desktopRenderInner})})})}},262950:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Wc});var s=n(667294),i=n(800480),o=n(886628),a=n(247839),r=n(52989),l=n(133767),d=n(95477),c=n(296994),u=n(76233),m=n(653965),p=n(368425),g=n(304727),f=n(210228),h=n(478140),y=n(953437),x=n(460709),S=n(268056),v=n(731352),b=n(223196),M=n(924666),j=n(938530),C=n(269783),w=n(583469),k=n(785893);function I(){const e=(0,i.Fy)(),{open:t,filter:n,emojiTextStore:a,popupOpen:r,originRect:l}=(0,o.VK)((()=>{const e=C.Z.state,t=e.open;if(!t)return{open:t,popupOpen:!1};const n=function(e){return v.zK(e.textStore,e.oldTextValue,!0)}(e)||"",{textStore:s,showPopupWithEmptyFilter:i,selectionRect:o}=e;return{open:t,filter:n,emojiTextStore:s,popupOpen:n.length>0||!!i,originRect:o}}),[]),{textMode:d,prevChar:c,singleTextSelectionStore:m}=(0,o.VK)((()=>{var e;const t=M.default.state,{mode:n}=t;if("editing"!==n)return{mode:n};const{multiSelection:s}=t,i=u.eeV(s.start.store.getValue());return{textMode:n,prevChar:i?i[s.start.index-1]:void 0,singleTextSelectionStore:null===(e=(0,S.QY)(s))||void 0===e?void 0:e.store}}),[]);return(0,s.useEffect)((()=>{t&&("editing"!==d||!n&&":"!==c||m!==a||void 0===n||":"===n||n.startsWith(" "))&&g.xv()}),[a,n,t,c,m,d]),(0,k.jsx)(y.ZP,{popupType:e.isMobileNative&&!e.isTablet?b.k.SlideUp:b.k.Popup,open:r,originRect:l,placementToOrigin:y.ZP.Placement.Bottom,alignmentToOrigin:y.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:Z,render:()=>(0,k.jsx)(T,{open:t,filter:n||""}),keepFocus:!0})}function T(e){let{open:t,filter:n}=e;const o=(0,i.O7)(),a=(0,i.Fy)(),r=(0,s.useRef)(null),l=a.isMobileNative&&!a.isTablet?{menuType:x.og.ActionSheet}:{menuType:x.og.Popup,width:j.fG,maxHeight:j.VJ,onClickOutside:g.xv};const d=(0,s.useMemo)((()=>m.Ds((e=>{p.VJ(o,{searchQuery:e})}),500)),[o]);return t?(0,k.jsx)(h.Z,{innerRef:r,...l,children:(0,k.jsx)(w.ZP,{filter:n,onSubmit:e=>function(e,t){f.createAndCommit({userAction:"EmojiMenu.handleSubmit",environment:t,perform:n=>{g.RL({environment:t,emoji:e,transaction:n})}})}(e,o),onNoResults:function(){if(!t)return;if(!n||0===n.length)return;const e=n.charAt(n.length-1);e&&(/\s/g.test(e)?g.xv():d(n))},isCallout:!1,menuRef:r})}):null}function Z(){g.xv()}var P=n(639500),F=n(195697),_=n(535868);function A(){return(0,o.VK)((()=>_.Z.state.open),[],{debugName:"MessageStoreDebugPanelWrapper.isOpen"})?(0,k.jsx)(c.t2,{}):null}var B=n(559054),R=n(454642),D=n(401898),O=n(80444);function L(e){let{environment:t}=e;const{currentSpaceViewStore:n,currentSpaceStore:s,currentUserStore:i}=O.default.state,o=null==n?void 0:n.getUserId(),a=null==n?void 0:n.getSpaceId(),r={readyForHomePagesRequest:!1,spaceViewUserId:void 0,spaceViewId:void 0};return null!=n&&n.isDefined()&&n.getAlive()&&n.canRead()&&o&&a?function(){const{spaceTransitionStatus:e}=O.default.state;switch(e){case"notTransitioning":return!1;case"joiningOrCreatingSpace":case"switchingToOrLoadingSpace":return!0;default:(0,D.t1)(e)}}()||t.currentUser.id!==o||(null==i?void 0:i.id)!==o||(null==s?void 0:s.id)!==a?r:(0,F.QI)()?{readyForHomePagesRequest:!0,spaceViewId:n.id,spaceViewUserId:o}:r:r}const V=(0,m.Ds)(R.getUserHomePages,1e3,{leading:!0,trailing:!0}),E=function(){const e=(0,i.O7)(),t=(0,o.VK)((()=>L({environment:e})),[e]);return(0,B.r5)((async()=>{t.readyForHomePagesRequest&&await V(e,{spaceViewId:t.spaceViewId},t.spaceViewUserId)}),[e,t.readyForHomePagesRequest,t.spaceViewId,t.spaceViewUserId]),null};var N=n(614720),U=n(319385),K=n(994416),W=n(619671),z=n(813023),q=n(569784),G=n(144615),H=n(702688),$=n(228517),Y=n(869911);function Q(){const e=(0,i.O7)(),{currentSpaceStore:t}=(0,o.Kw)(O.default),n=e.currentUser.id,a=(0,o.VK)((()=>null==t?void 0:t.id),[t]);return(0,s.useEffect)((()=>{if(!a||!n)return;const t=H.ZP.addListener((0,G.pD)({userId:n,spaceId:a}),(async(t,s)=>{(function(e){var t;let{spaceId:n,userId:s,emitValue:i}=e;const o=null===(t=Y.Z.getUserJoinedTeamsState({userId:s,spaceId:n}))||void 0===t?void 0:t.lastEmitValue;if(o===i)return!1;if(void 0===o&&Y.Z.getHasFetched({userId:s,spaceId:n}))return!1;return!0})({spaceId:a,userId:n,emitValue:s})&&await $.m({environment:e,spaceId:a,userId:n,emitValue:s});const i=Y.Z.getUserJoinedTeamsState({userId:n,spaceId:a});i&&Y.Z.setUserJoinedTeamsState({userId:n,spaceId:a,state:{...i,lastEmitValue:s}})}),void 0,e);return function(){t&&H.ZP.removeListener(t,e)}}),[e,n,a]),null}var J=n(841464),X=n(724405),ee=n(964275),te=n(584169),ne=n(709291),se=n(137810),ie=n(988150),oe=n(898104),ae=n(214976),re=n(249394),le=n(918514),de=n(825464),ce=n(885305),ue=n(573063),me=n(526388),pe=n(965187);const ge=(0,ne.defineMessages)({learnTooltip:{defaultMessage:"Learn more about alt text",id:"altTextMenuPopup.helpButton.tooltip"}});function fe(){const e=(0,i.O7)(),{device:t}=e,n=(0,ne.useIntl)(),a=(0,X.yK)((e=>({wrapper:{padding:t.isMobile?16:12,display:"flex",flexDirection:"column",fontSize:t.isMobile?se.Z.fontSize.UIRegular.mobile:se.Z.fontSize.UIRegular.desktop,wordBreak:"break-word",maxHeight:t.isMobile?"35vh":"200px",overflowY:"auto"},closeButton:{borderRadius:"100%",width:22,height:22,float:"right",marginLeft:8},input:{marginTop:t.isMobile?16:12,padding:t.isMobile?"8px 12px":"4px 10px",width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.surface.page,cursor:"text",overflowX:"hidden"},helpText:{color:e.text.secondary,display:"inline"},helpButton:{marginLeft:2,display:"inline-flex",position:"absolute",transform:t.isMobile?void 0:"translateY(-1px)"}})),[t.isMobile]),{altTextStore:r,altText:l,canEdit:d}=(0,o.VK)((()=>{const e=ce.Z.state.blockStore;return{altTextStore:null==e?void 0:e.getPropertyStore("alt_text"),altText:e?(0,ae.Xh)(null==e?void 0:e.getPropertyValue("alt_text"),e):void 0,canEdit:(null==e?void 0:e.canEdit())&&!(null!=e&&e.isNavigableAncestorNonEditableState())}}),[]);return(0,s.useEffect)((()=>{r&&oe.NX({store:r})}),[r]),(0,k.jsx)(h.Z,{menuType:t.isMobile?x.og.ActionSheet:x.og.Popup,width:t.isMobile?"100vw":310,children:(0,k.jsxs)("div",{style:a.wrapper,children:[(0,k.jsxs)("div",{children:[(0,k.jsx)(ue.Z,{style:a.closeButton,hovered:!0,icon:ee.D,onClick:()=>ie.x(e),ariaLabel:n.formatMessage({id:"altTextMenuPopup.closeButton",defaultMessage:"Close"})}),d?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{style:a.helpText,children:(0,k.jsx)(ne.FormattedMessage,{id:"altTextMenuPopup.description",defaultMessage:"Add alt text to describe this image. This makes your page more accessible to people who are vision-impaired or blind"})}),(0,k.jsx)(me.Z,{renderTooltip:()=>n.formatMessage(ge.learnTooltip),render:e=>(0,k.jsx)(ue.Z,{ariaLabel:n.formatMessage(ge.learnTooltip),icon:te.m,external:!0,href:(0,le.UY)("guides.altText"),style:a.helpButton,isLightIconColor:!0,...e})})]}):l]}),d&&r&&(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(pe.Z,{store:r,disabled:!1,pasteBehavior:"plaintext",style:a.input,placeholderStyle:a.input,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableInsertText:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableMentions:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:()=>ie.x(e),onEsc:()=>ie.x(e),placeholder:n.formatMessage({id:"altTextMenuPopup.placeholder",defaultMessage:"Add alt text..."}),inPageFind:re.B3.none})})]})})}const he=function(){const e=(0,i.O7)(),{device:t}=e,n=(0,X.yK)((e=>({popup:{background:e.altTextPopupBackground,borderTopLeftRadius:t.isMobile?12:6,borderTopRightRadius:t.isMobile?12:6,left:t.isMobile?0:8}})),[t.isMobile]),{open:s,originRect:a}=(0,o.VK)((()=>{const{open:e}=ce.Z.state;return e?{open:e,originRect:ce.Z.state.originRect}:{open:e,originRect:void 0}}),[]);return(0,k.jsx)(y.ZP,{popupType:t.isMobile?b.k.SlideUp:b.k.Popup,open:s,originRect:a,originGap:8,placementToOrigin:de.u.Bottom,alignmentToOrigin:y.ZP.Alignment.End,onDismiss:()=>ie.x(e),render:()=>(0,k.jsx)(fe,{}),sameWidthAsOrigin:!1,style:n.popup})};var ye=n(554564),xe=n(492650),Se=n(628020),ve=n(224646),be=n(524229),Me=n(541432),je=n(155856),Ce=n(165598),we=n(277907),ke=n(434859),Ie=n(708928),Te=n(436488),Ze=n(203386),Pe=n(840721),Fe=n(903553),_e=n(66957);const Ae=[be.u.Open,be.u.Resolved];const Be=function(e){let{discussionIds:t,blockStore:n,recursivelyLoadAllDiscussions:s,tab:a}=e;const r=(0,i.O7)(),{resolved:l,unresolved:d}=(0,o.VK)((()=>{const e=Ce.al(n,{recursivelyLoadAllDiscussions:s,includePropertyDiscussions:!0}).filter((e=>!t||t.includes(e.id)||Ce.De(e))),{resolved:i,unresolved:o}=Ce.bB(e);return{resolved:i,unresolved:o}}),[t,n,s]),{device:c}=r;let u;return u=c.isMobile?{menuType:x.og.Modal,title:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Comments",id:"blockDiscussionMenu.mobileMenu.title"}),header:(0,k.jsx)(Le,{tab:a,resolved:l,unresolved:d}),right:(0,k.jsx)(Pe.DoneMenuText,{}),onClickRight:ye.LZ,whiteBackground:!0}:{menuType:x.og.Popup,header:(0,k.jsx)(Le,{tab:a,resolved:l,unresolved:d}),width:480,maxHeight:"50vh",onClickOutside:ye.LZ},(0,k.jsx)(je.Z,{capture:!0,preventType:ke.Z.All,children:(0,k.jsx)(Te.Z,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,k.jsx)(Ze.Z,{debugName:"BlockDiscussionMenu",capture:!0,onEsc:ye.LZ,onBackspace:Oe,onDelete:Oe,children:(0,k.jsx)(Fe.Z,{store:n,droppable:!0,render:()=>(0,k.jsx)(h.Z,{...u,children:(0,k.jsx)(Ee,{tab:a,blockStore:n,resolved:l,unresolved:d})})},n.id)})})})};function Re(e){let{message:t}=e;const n=(0,X.Fg)(),s=(0,i.O7)(),{device:o}=s;return(0,k.jsx)("div",{style:{textAlign:"center",padding:o.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:n.mediumTextColor},children:t})}function De(e){const t=be.Z.state;t.open&&be.Z.setState({...t,tab:Ae[e]})}function Oe(e){null==e||e.preventDefault(),ye.LZ()}function Le(e){let{tab:t,resolved:n,unresolved:s}=e;const o=(0,i.O7)(),{device:a}=o,r=s.length,l=n.length;return 0===l||0===r?null:(0,k.jsx)(_e.Z,{tabs:[(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Open ({numberOfOpenDiscussions})",id:"blockDiscussionMenu.openDiscussionsTab.title",values:{numberOfOpenDiscussions:r}},"openDiscussions"),(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Resolved ({numberOfResolvedDiscussions})",id:"blockDiscussionMenu.resolvedDiscussionsTab.title",values:{numberOfResolvedDiscussions:l}},"resolvedDiscussions")],selectedIndex:Ae.indexOf(t),onChange:De,style:{...a.isAndroid&&{borderBottom:"none"}}})}function Ve(e){const{value:t}=(0,we.XJ)(l.commentsDependency);return t?(0,k.jsx)(k.Fragment,{children:e.discussionStores.map(((n,s,i)=>(0,k.jsx)(l.LazyDiscussion,{store:n,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:0===s,isOnly:1===i.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:e.blockStore,onDismiss:ye.LZ},n.id)))}):null}function Ee(e){let{tab:t,blockStore:n,resolved:a,unresolved:r}=e;const d=(0,X.Fg)(),c=(0,i.O7)(),{device:u}=c,m=(0,o.VK)((()=>n.getType()),[n]),p=(0,o.VK)((()=>Ie.h(n)),[n]),{value:g}=(0,we.XJ)(l.commentsDependency);if(!g)return null;if(t===be.u.Open){if(r.length){const e=m&&(0,D.qg)(Me.p2,m);return u.isMobile&&e&&p?(0,k.jsxs)(s.Fragment,{children:[(0,k.jsx)("div",{style:{padding:"12px 16px",boxShadow:`0 1px 0 ${d.regularDividerColor}`,marginBottom:1},children:(0,k.jsx)(p,{store:n,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})}),(0,k.jsx)(Ve,{discussionStores:r,blockStore:n})]}):(0,k.jsx)(Ve,{discussionStores:r,blockStore:n})}return(0,k.jsx)(Re,{message:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"})})}return a.length?(0,k.jsx)(Ve,{discussionStores:a,blockStore:n}):(0,k.jsx)(Re,{message:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"})})}const Ne=function(){const e=(0,i.O7)(),{device:t}=e,n=(0,o.VK)((()=>be.Z.state.rect),[]),a=(0,o.VK)((()=>{var t;const n=be.Z.state.open&&void 0!==(null===(t=be.Z.state.blockStore)||void 0===t?void 0:t.getAssociatedCollectionStore())&&be.Z.state.blockStore.id!==(0,Se.zj)();return be.Z.state.open&&!(0,xe.az)(e,be.Z.state.blockStore)&&(n||!(0,ve.Sx)(e))}),[e]),r=(0,s.useCallback)((()=>{if(be.Z.state.open)return(0,k.jsx)(Be,{rect:be.Z.state.rect,tab:be.Z.state.tab,blockStore:be.Z.state.blockStore,discussionIds:be.Z.state.discussionIds,recursivelyLoadAllDiscussions:be.Z.state.recursivelyLoadAllDiscussions})}),[]);return(0,k.jsx)(y.ZP,{popupType:t.isMobile?b.k.SlideUp:b.k.Popup,open:a,originRect:n,placementToOrigin:y.ZP.Placement.Bottom,alignmentToOrigin:y.ZP.Alignment.Center,disableMouseCapture:!0,originGap:4,render:r,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:ye.LZ})};n(757658);var Ue=n(926249),Ke=n(179554),We=n(843250),ze=n(433929),qe=n(561207),Ge=n(27724),He=n(552275),$e=n(632163),Ye=n(672495);const Qe=(0,ne.defineMessages)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"}});const Je=function(){const e=(0,i.Fy)(),t=(0,o.VK)((()=>qe.Z.state),[]),n=(0,o.VK)((()=>Ge.default.state),[]);return(0,s.useEffect)((()=>{if(t.open){const{stores:e,phase:s}=n;(0,Ue.Z)(e,t.blocks)&&s===Ge.SelectionPhase.Selected||Ke.xv()}}),[t,n]),(0,k.jsx)(y.ZP,{popupType:e.isMobileNative&&!e.isTablet?b.k.SlideUp:b.k.Popup,open:t.open,originRect:t.open?t.rect:void 0,placementToOrigin:y.ZP.Placement.Bottom,alignmentToOrigin:y.ZP.Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:()=>(0,k.jsx)(et,{}),onDismiss:Xe})};function Xe(){Ke.xv()}function et(){const e=(0,i.O7)(),{device:t}=e,n=(0,o.VK)((()=>{const t=qe.Z.state;return t.open?function(e,t){const{blocks:n}=e,{currentSpaceStore:s}=O.default.state,i=[];if("blocks"===e.type){const{copiedStores:o,pageSource:a}=e;Ke.H8({currentSpaceId:null==s?void 0:s.id,blocks:n,copiedStores:o})&&i.push({name:ze.default.formatMessage(Qe.createTransclusion),action:async()=>{await Ke.ry({environment:t,blocks:n,copiedBlockIds:o.map((e=>e.id))})}}),Ke.wK({blocks:n})&&i.push({name:ze.default.formatMessage(Qe.linkToPage),action:async()=>Ke.Dq({environment:t,blocks:n,source:{type:"blocks",copiedStores:o,pageSource:a}})})}return"links"===e.type&&i.push({name:ze.default.formatMessage(Qe.linkToPage),action:async()=>Ke.Dq({environment:t,blocks:n,source:{type:"links",copiedLinks:e.copiedLinks}})}),[{key:"embed section",render:e=>(0,k.jsx)(Ye.Z,{...e}),items:[{key:"dismiss",render:e=>(0,k.jsx)(He.Z,{...e,title:ze.default.formatMessage(Qe.dismissItem)}),action:Xe},...i.map((e=>{let{name:t,action:n}=e;return{key:`embed ${t}`,render:e=>(0,k.jsx)(He.Z,{...e,title:t}),action:n}}))]}]}(t,e):null}),[e]);if(null===n)return null;let s;return s=t.isMobile?{menuType:x.og.ActionSheet}:{menuType:x.og.Popup,width:320,maxHeight:"40vh"},(0,k.jsx)(h.Z,{...s,className:We.srZ,children:(0,k.jsx)($e.Z,{type:$e.i.Vertical,sections:n,initialFocus:0})})}var tt=n(487143),nt=n(374194),st=n(164369);const it=function(){const e=(0,i.O7)(),{device:t}=e,{active:n,stringValue:s}=(0,o.VK)((()=>{const{active:e,stringValue:t}=tt.Z.state;return{active:e,stringValue:t}}),[]),a=window.innerWidth/2-150,r=window.innerHeight/2,l=t.isMobileNative?(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Tap to copy the link above",id:"clipboardInputRenderer.copyLink.mobile_message"}):(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"});return(0,k.jsx)(y.ZP,{popupType:t.isMobileNative?b.k.SlideUp:b.k.Popup,open:n,originRect:{top:r,left:a},onDismiss:ot,placementToOrigin:y.ZP.Placement.Bottom,alignmentToOrigin:y.ZP.Alignment.Start,originGap:0,render:()=>(0,k.jsx)(Ze.Z,{debugName:"ClipboardInputRenderer",capture:!0,onEnter:m.yR,onCommandEnter:m.yR,onCommandShiftEnter:m.yR,onCommandSlash:m.yR,onDelete:m.yR,onBackspace:m.yR,onEsc:m.yR,onLeft:m.yR,onRight:m.yR,onUntab:m.yR,onTab:m.yR,onSelectAll:m.yR,onRedo:m.yR,onUndo:m.yR,onToggleBold:m.yR,onToggleItalics:m.yR,onToggleStrike:m.yR,onToggleCode:m.yR,onCut:m.yR,onCopy:m.yR,onPaste:m.yR,onKeypress:m.yR,children:(0,k.jsxs)("div",{style:{padding:8,width:300},children:[(0,k.jsx)(nt.Z,{style:{width:"100%",fontSize:12},value:s,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),(0,k.jsx)(st.Z,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"},children:l})]})})})};function ot(){tt.Z.setState({...tt.Z.state,active:!1,stringValue:""})}var at=n(711977),rt=n(114131),lt=n(562397),dt=n(667946),ct=n(517755),ut=n(145953),mt=n(530615),pt=n(922145),gt=n(169151),ft=n(991049);const ht=new mt.G((()=>0));const yt=function(){return function(e){const t=(0,i.O7)();(0,s.useEffect)((()=>{if(!e)return;const n=H.ZP.addListener((0,G.h8)(e),(async(n,s)=>{if(!ft.Z.shouldRefetchCustomEmojis({currentSpaceId:e,emitValue:s}))return;const i=await R.getCustomEmojisForSpace(t,{spaceId:e});if("success"!==i.type)return;const{customEmojiPointers:o}=i.data,a=ut.PF.create(i.data.recordMap),r=new Set;for(const e of o){const n=a.getModel(e);if(!n)continue;r.add(n.getName());const s=(0,ct.EK)({url:n.url,baseUrl:d.default.domainBaseUrl,fullyQualified:!1,userId:t.currentUser.id,width:dt.X,permissionRecord:e});(new Image).src=s}ft.Z.setState({customEmojiPointers:o,customEmojiNames:r,lastEmitData:{value:s,spaceId:e}})}),void 0,t);return()=>{n&&H.ZP.removeListener(n,t)}}),[t,e])}((0,o.VK)((()=>{var e;return null===(e=(0,pt.J)())||void 0===e?void 0:e.id}),[])),function(e,t){const n=(0,i.O7)();(0,s.useEffect)((()=>{const s=ht.get(e)+1;ht.set(e,s);const i=()=>{};Object.defineProperty(i,"name",{configurable:!0,enumerable:!1,value:`useRetainRecordsInMemory(${e} ${s})`});for(const e of t)n.defaultRecordCache.inMemoryRecordCache.addListenerToRecord(e,i),gt.cancelEviction({pointer:e,userId:n.currentUser.id});return()=>{for(const e of t)n.defaultRecordCache.inMemoryRecordCache.removeListenerToRecord(e,i),gt.unsubscribeAfterDelay({environment:n,pointer:e,userId:n.currentUser.id})}}),[e,n,t])}("CustomEmojisForSpace",(0,o.VK)((()=>ft.Z.state.customEmojiPointers),[])),null};var xt=n(394302),St=n(519889),vt=n(709953),bt=n(164964),Mt=n(353471),jt=n(924990),Ct=n(741195),wt=n(598185),kt=n(453730),It=n(158297);const Tt=(0,ne.defineMessages)({nameInputPlaceholder:{defaultMessage:"Emoji name",id:"customEmojiUploadPopup.nameInput.placeholder"},nameInputDuplicateError:{defaultMessage:"Name already taken",id:"customEmojiUploadPopup.nameInput.duplicateError"},nameInputCharacterError:{defaultMessage:"Name can only contain lowercase letters, numbers, hyphens, or underscores",id:"customEmojiUploadPopup.nameInput.characterError"},nameInputLengthError:{defaultMessage:"Name must be less than 50 characters",id:"customEmojiUploadPopup.nameInput.lengthError"}});function Zt(){const e=(0,i.O7)(),t=(0,ne.useIntl)(),n=(0,X.yK)((e=>({wrapper:{padding:"16px 16px 12px 16px",display:"flex",flexDirection:"column",fontSize:se.Z.fontSize.UIRegular.desktop},button:{marginTop:12},helpText:{marginTop:8,color:e.text.secondary,display:"inline",fontSize:se.Z.fontSize.UISmall.desktop,textAlign:"center"},errorText:{marginTop:8,color:e.text.uiRedPrimary,display:"inline",fontSize:se.Z.fontSize.UISmall.desktop,textAlign:"center"}})),[]),[a,r]=(0,s.useState)(""),[l,d]=(0,s.useState)(""),c=(0,o.VK)((()=>{if(wt.Z.state.open)return wt.Z.state.uploadFileEventHandlers}),[]),u=(0,o.VK)((()=>(0,pt.J)()),[]),m=(0,o.VK)((()=>{var e;return(null===(e=ft.Z.getForSpace(u))||void 0===e?void 0:e.customEmojiNames)??new Set}),[u]),p=(0,o.VK)((()=>jt.Z.state.emojiByName),[]);if((0,s.useEffect)((()=>{(m.has(a)||p.hasOwnProperty(a))&&d(t.formatMessage(Tt.nameInputDuplicateError))}),[m,p,t,a]),!u)return(0,k.jsx)(k.Fragment,{});return(0,k.jsx)(h.Z,{menuType:x.og.Popup,width:280,children:(0,k.jsxs)("div",{style:n.wrapper,children:[(0,k.jsx)(nt.Z,{placeholder:t.formatMessage(Tt.nameInputPlaceholder),value:a,onChange:function(e){const n=e.target.value;if(r(n),0===n.length)return void d("");/^[\p{Ll}\p{Lo}_-]*$/u.test(n)?n.length>50?d(t.formatMessage(Tt.nameInputLengthError)):m.has(n)||p.hasOwnProperty(a)?d(t.formatMessage(Tt.nameInputDuplicateError)):d(""):d(t.formatMessage(Tt.nameInputCharacterError))},type:"text",autoFocus:!0,focus:!0}),(0,k.jsx)(It.Z,{style:n.button,onClick:()=>async function(e){const{environment:t,name:n,currentSpaceStore:s,uploadFileEventHandlers:i}=e,o=await Mt.y({multiple:!1,accept:"image/jpeg, image/png, image/gif"});if(!o.length)return;const a=(0,Ct.$x)({table:xt.p,environment:t,spaceId:s.getSpaceId()});let r;if(f.createAndCommit({userAction:"customEmojiActions.createCustomEmoji",environment:t,perform:e=>{r=vt.ae({environment:t,table:xt.p,inMemoryRecordCache:s.inMemoryRecordCache,transaction:e,value:{id:a.id,url:"",name:n,file_ids:[],space_id:s.getSpaceId(),created_by_id:t.currentUser.id,created_by_table:St.KJ,created_time:Date.now()}})}}),await kt.transactionQueue.awaitRecordTransaction(a),!r)return;Mt.cT({...i,environment:t,file:o[0],bucket:"secure",record:a,onComplete:e=>{f.createAndCommit({userAction:"customEmojiActions.setCustomEmojiUrl",environment:t,perform:t=>{f.applyOperation({store:r,operation:{pointer:a,path:["url"],command:"set",args:e},transaction:t}),bt.oV({label:(0,k.jsx)(ne.FormattedMessage,{id:"uploadCustomEmoji.success",defaultMessage:"{name} has been added to your workspace",values:{name:n}})})}}),null!=i&&i.onComplete&&i.onComplete(e)}}),wt.Z.reset()}({environment:e,name:a,currentSpaceStore:u,uploadFileEventHandlers:c}),disabled:Boolean(!a)||Boolean(l),children:(0,k.jsx)(ne.FormattedMessage,{id:"customEmojiUploadPopup.uploadButton.label",defaultMessage:"Upload an image"})}),Boolean(l)?(0,k.jsx)("div",{style:n.errorText,children:l}):(0,k.jsx)("div",{style:n.helpText,children:(0,k.jsx)(ne.FormattedMessage,{id:"customEmojiUploadPopup.helpText",defaultMessage:".jpeg, .png, or .gif"})})]})})}const Pt=function(){const{open:e,originRect:t}=(0,o.VK)((()=>wt.Z.state.open?{open:!0,originRect:wt.Z.state.originRect}:{open:!1,originRect:void 0}),[]);return(0,k.jsx)(y.ZP,{popupType:b.k.Popup,open:e,originRect:t,placementToOrigin:de.u.Bottom,alignmentToOrigin:y.ZP.Alignment.Start,onDismiss:()=>wt.Z.reset(),render:()=>(0,k.jsx)(Ze.Z,{debugName:"CustomEmojiUploadPopup",capture:!0,onUp:m.yR,onDown:m.yR,onLeft:m.yR,onRight:m.yR,children:(0,k.jsx)(Zt,{})}),sameWidthAsOrigin:!1})};var Ft=n(640506),_t=n(182798),At=n(467133),Bt=n(137231),Rt=n(328748);const Dt=function(){const e=(0,i.O7)(),{device:t}=e,n=(0,o.VK)((()=>Rt.Z.state),[]);return(0,k.jsx)(y.ZP,{popupType:t.isMobile?b.k.SlideUp:b.k.Popup,open:n.open,originRect:n.originRect,onDismiss:At.x,render:()=>(0,k.jsx)(Ot,{shouldShowReminder:!!n.open&&n.allowReminders})})};function Ot(e){let{shouldShowReminder:t}=e;const n=(0,i.O7)(),s=(0,o.VK)((()=>Lt()),[]);if(!s)return null;const a="default",{date_format:r,time_format:l,dateValue:d}=s;return(0,k.jsx)(we.ev,{dependency:c.FF.menus,children:e=>{let{DatePropertyMenu:s}=e;return(0,k.jsx)(s,{firstDayOfWeek:Se.AK.state,value:d,canConfigureCollection:!0,onChangeValue:e=>function(e,t,n){if(!e)return void function(e,t){const n=Lt();if(!n)return;const{textStore:s,textValue:i,tokenIndex:o}=n,a=u.VrM(i.slice(0,o)),r=u.VrM(i.slice(0,o+1));f.createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:e,perform:t=>{Bt.pe({environment:e,store:s,selection:{startIndex:a,endIndex:r},transaction:t})}})}(t);if(!Ft.U3(e))return;const s=Lt();if(!s)return;const{date_format:i,time_format:o}=s;Vt({date_format:i,time_format:o,...e},t,n)}(e,n,a),dateFormat:r,onChangeDateFormat:e=>function(e,t,n){const s=Lt();if(!s)return;const{dateValue:i,time_format:o}=s;Vt({date_format:e,time_format:o,...i},t,n)}(e,n,a),timeFormat:l,onChangeTimeFormat:e=>function(e,t,n){const s=Lt();if(!s)return;const{dateValue:i,date_format:o}=s;Vt({date_format:o,time_format:e,...i},t,n)}(e,n,a),onDismiss:At.x,disabled:!1,shouldShowReminder:t,isTemplatePage:!1})}})}function Lt(){const e=Rt.Z.state;if(e.open){const{textStore:t,tokenIndex:n}=e,s=t.getValue();if(s){const e=s[n];if(e){(0,_t.T)(u.km_(e),"Token should be a mention token");const i=u.hDy(e),o=u.K9C(i);if(o){const{date_format:a,time_format:r,...l}=u.zyO(o);return{textStore:t,textValue:s,tokenIndex:n,token:e,annotations:i,date_format:a,time_format:r,dateValue:l}}}}}}function Vt(e,t,n){const s=Lt();if(!s)return;const{textStore:i,textValue:o,tokenIndex:a,token:r,annotations:l}=s,d=l.map((t=>u.fpG(t)?["d",e]:t)),c=u.V3y(r[0],d),m=u.VrM(o.slice(0,a)),p=u.VrM(o.slice(0,a+1));f.createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:t,perform:e=>{Bt.pe({environment:t,store:i,selection:{startIndex:m,endIndex:p},transaction:e}),Bt.mM({environment:t,store:i,tokens:[c],index:m,transaction:e})}})}n(430541);var Et=n(150475),Nt=n(895538),Ut=n(599405),Kt=n(421202),Wt=n(619584),zt=n(288864),qt=n(489951),Gt=n(964233),Ht=n(206258),$t=n(568785),Yt=n(974420);const Qt=(0,ne.defineMessages)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},mixpanel:{defaultMessage:"Embed Mixpanel project",id:"embedMenu.action.mixpanel"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Map",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Create embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"},drawing:{defaultMessage:"Embed a drawing",id:"embedMenu.action.drawing"}}),Jt=(0,ne.defineMessages)({linkToPage:{defaultMessage:"Link to page",id:"embedMenu.actions.linkToPage.title"},mentionPage:{defaultMessage:"Mention page",id:"embedMenu.actions.mentionPage.title"},mentionBlock:{defaultMessage:"Mention block",id:"embedMenu.actions.mentionBlock.title"},createLinkedDatabase:{defaultMessage:"Create linked database",id:"embedMenu.actions.createLinkedDatabase.title"},createLinkedViewOfDatabase:{defaultMessage:"Create linked view of database",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Create bookmark",id:"embedMenu.actions.createBookmark.title"},createTransclusionItem:{defaultMessage:"Paste and sync",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"Dismiss",id:"embedMenu.actions.dismiss.title"},linkMention:{defaultMessage:"Paste as mention",id:"embedMenu.actions.linkMention.title"}}),Xt={image:ze.default.formatMessage(Qt.image),video:ze.default.formatMessage(Qt.video),tweet:ze.default.formatMessage(Qt.tweet),drive:ze.default.formatMessage(Qt.drive),gist:ze.default.formatMessage(Qt.gist),figma:ze.default.formatMessage(Qt.figma),invision:ze.default.formatMessage(Qt.invision),abstract:ze.default.formatMessage(Qt.abstract),framer:ze.default.formatMessage(Qt.framer),whimsical:ze.default.formatMessage(Qt.whimsical),mixpanel:ze.default.formatMessage(Qt.mixpanel),miro:ze.default.formatMessage(Qt.miro),sketch:ze.default.formatMessage(Qt.sketch),excalidraw:ze.default.formatMessage(Qt.excalidraw),replit:ze.default.formatMessage(Qt.replit),audio:ze.default.formatMessage(Qt.audio),maps:ze.default.formatMessage(Qt.maps),loom:ze.default.formatMessage(Qt.loom),typeform:ze.default.formatMessage(Qt.typeform),codepen:ze.default.formatMessage(Qt.codepen),pdf:ze.default.formatMessage(Qt.pdf),embed:ze.default.formatMessage(Qt.embed),hex:ze.default.formatMessage(Qt.hex),deepnote:ze.default.formatMessage(Qt.deepnote),drawing:ze.default.formatMessage(Qt.drawing)};const en=function(){const e=(0,i.O7)(),t=(0,i.Fy)(),n=(0,o.VK)((()=>Gt.Z.state),[]),a=(0,o.VK)((()=>M.default.state),[]);return(0,s.useEffect)((()=>{if(n.open&&"editing"===a.mode){const{multiSelection:e}=a;(0,S.qS)(e)&&e.start.store.id===n.textStore.id&&e.end.index===n.urlSelection.endIndex||qt.xv()}}),[n,a]),(0,k.jsx)(y.ZP,{popupType:t.isMobileNative&&!t.isTablet?b.k.SlideUp:b.k.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:y.ZP.Placement.Bottom,alignmentToOrigin:y.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:t.isMobile,keepFocus:t.isMobile,render:()=>n.loading?(0,k.jsx)($t.Z,{}):(0,k.jsx)(an,{}),onDismiss:()=>tn(e)})};function tn(e){const t=Gt.Z.state;if(!t.open)return;const{url:n}=t;zt.X0(e,{url:n,type:"close"}),qt.xv()}function nn(e,t){const n=Gt.Z.state;if(!n.open)return;const{url:s}=n;qt.RL({environment:t,type:e}),zt.X0(t,{url:s,type:e})}function sn(e,t){const{device:n}=t,{url:s,textStore:i}=e,{currentSpaceStore:o}=O.default.state,a=[],r=(0,Ut.parseRoute)({url:s,baseUrl:d.default.domainBaseUrl,publicDomainName:d.default.publicDomainName,isMobile:n.isMobile,protocol:d.default.protocol,currentUrl:window.location.href}),l=["youtube.com","youtu.be","instagram.com","twitter.com","x.com","facebook.com","linkedin.com","pinterest.com","tiktok.com","spotify.com","maps.google.com","drive.google.com","docs.google.com","slides.google.com","sheets.google.com","forms.google.com","indify.co","open.spotify.com","music.youtube.com","figma.com","amazon","wikipedia.org","medium.com","naver.com","canva.com","miro.com","reddit.com","calendly.com","forms.gle"];if("page"===r.name){const e=Ht.G.createChildStore(i,{table:Kt.iU,id:r.blockId}),t=r.scrollToBlockId?Ht.G.createChildStore(i,{table:Kt.iU,id:r.scrollToBlockId}):void 0;a.push({name:ze.default.formatMessage(Jt.createLinkedViewOfDatabase),validator:()=>!t&&e.isCollectionView()&&!qt.f_(i)&&(!e.isCollectionViewPageWithContent()||!function(e,t){const n=e.getCollectionViewStores(),s=m.sE(n,(e=>e.id===t&&"page"===e.getType()));return Boolean(s)}(e,r.collectionViewId))&&(null==o?void 0:o.id)===e.getSpaceId()&&on(e),type:Me.Ti.collectionView}),a.push({name:ze.default.formatMessage(void 0===t?Jt.mentionPage:Jt.mentionBlock),validator:()=>on(e),type:"mention-page"}),a.push({name:ze.default.formatMessage(Jt.createTransclusionItem),validator:()=>Boolean(t&&!t.isNavigableBlock()&&!qt.f_(i)&&!t.isNonEditableState()&&!t.isNavigableAncestorNonEditableState()&&t.canEdit()&&t.getSpaceId()===(null==o?void 0:o.id)&&on(e)),type:"create-transclusion"}),a.push({name:ze.default.formatMessage(Jt.linkToPage),validator:()=>!t&&!e.isCollectionView()&&!qt.f_(i)&&on(e),type:Me.Ti.page})}const c=Wt.XP(Xt);for(const d of c)"embed"!==d&&a.push({name:Xt[d],validator:Nt.Wb[d],type:d});a.push({name:ze.default.formatMessage(Jt.bookmarkMenuItem),validator:e=>!qt.f_(i)&&Nt.Cm(e),type:Me.Ti.bookmark}),a.push({name:Xt.embed,validator:e=>!qt.f_(i)&&Nt.Wb.embed(e),type:"embed"});const u=m.oA(a.map((e=>{let{name:n,validator:i,type:o}=e;if(i({url:s,baseUrl:d.default.domainBaseUrl,publicDomainName:d.default.publicDomainName})){return{key:`embed ${n}`,render:e=>(0,k.jsx)(He.Z,{...e,title:n}),action:()=>nn(o,t)}}}))),p={key:"link-mention",render:e=>(0,k.jsx)(He.Z,{...e,title:ze.default.formatMessage(Jt.linkMention),right:(0,k.jsx)(Yt.Z,{})}),action:()=>nn("link-mention",t)},g={key:"dismiss",render:e=>(0,k.jsx)(He.Z,{...e,title:ze.default.formatMessage(Jt.dismissItem)}),action:()=>tn(t)};if(0===u.length)return[];"page"===r.name?u.push(g):(!function(e,t){return t.some((t=>e.includes(t)))}(s,l)?u.unshift(g):("embed Create bookmark"!==u[0].key||u.reverse(),u.push(g)),U.default.checkGate({gateName:"enable_link_mentions"})&&u.splice(0,0,p));return[{key:"embed section",render:e=>(0,k.jsx)(Ye.Z,{...e}),items:u}]}function on(e){const t=e.getSystemBlockTypeStore().getValue();return!(0,Et.bv)(t)}function an(){const e=(0,i.O7)(),{device:t}=e,n=(0,o.VK)((()=>{const t=Gt.Z.state;return t.open?sn(t,e):null}),[e]),a=(0,o.VK)((()=>!!Gt.Z.state.loading),[]),r=(null==n?void 0:n.length)??0;if((0,s.useEffect)((()=>{a||0!==r||qt.xv()}),[r,a]),null===n)return null;let l;return l=t.isMobile?{menuType:x.og.ActionSheet}:{menuType:x.og.Popup,width:320,maxHeight:"40vh"},(0,k.jsx)(k.Fragment,{children:a?(0,k.jsx)($t.Z,{style:{marginLeft:3,marginRight:3}}):(0,k.jsx)(h.Z,{...l,className:We.srZ,children:(0,k.jsx)($e.Z,{type:$e.i.Vertical,sections:n,initialFocus:0})})})}var rn=n(61202),ln=n(978749);function dn(){const e=(0,i.O7)(),t=e.currentUser.id,n=(0,o.VK)((()=>{var e;return null===(e=O.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),a=(0,o.VK)((()=>(0,ln.W)({isPhone:e.device.isPhone,spaceStore:O.default.state.currentSpaceStore})),[e.device]);return(0,s.useEffect)((()=>{if(!n||!t||!a)return;const s=H.ZP.addListener((0,G.iX)({notionUserId:t,spaceId:n}),(0,H.Qk)(((t,n)=>{n&&"object"==typeof n&&-1===n.version||cn(e)})),void 0,e);return function(){s&&H.ZP.removeListener(s,e)}}),[e,t,n,a]),null}const cn=(0,m.Ds)((e=>{rn.pJ({environment:e})}),5e3,{leading:!0,trailing:!0});var un=n(701302),mn=n(643593),pn=n(37652),gn=n(733907),fn=n(745238);const hn=(0,fn.IU)("collapse",{viewBox:"0 0 16 16",svg:(0,k.jsx)("path",{d:"M2.477 7.51h3.787c.396 0 .701-.106.916-.32.214-.22.321-.525.321-.917V2.534a.723.723 0 00-.745-.745.731.731 0 00-.54.212.736.736 0 00-.205.533v.486l.15 2.146-1.6-1.682-1.968-1.982a.695.695 0 00-.52-.219.791.791 0 00-.574.219.736.736 0 00-.219.554.78.78 0 00.055.294.917.917 0 00.17.253L3.482 4.57l1.675 1.593-2.153-.143h-.526a.723.723 0 00-.746.745.723.723 0 00.746.745zm6.74 6.912a.71.71 0 00.526-.212.7.7 0 00.212-.526v-.554l-.143-2.14 1.6 1.682 2.002 2.016a.69.69 0 00.526.22c.224 0 .41-.074.561-.22a.725.725 0 00.226-.553.707.707 0 00-.062-.294.728.728 0 00-.164-.246l-2.01-2.017-1.688-1.586 2.16.144h.588a.736.736 0 00.533-.205.711.711 0 00.219-.534.72.72 0 00-.219-.54.723.723 0 00-.533-.211H9.702c-.392 0-.697.109-.916.328-.214.214-.321.517-.321.909v3.8a.7.7 0 00.212.527.746.746 0 00.54.212z"})});var yn=n(264330),xn=n(480342),Sn=n(747453),vn=n(870279),bn=n(151454),Mn=n(531701),jn=n(436610),Cn=n(954604),wn=n(742858),kn=n(524677),In=n(917504),Tn=n(330117),Zn=n(58202),Pn=n(138302),Fn=n(623063),_n=n(804827),An=n(489728);const Bn={background:"rgba(255, 255, 255, 0.055)"},Rn={padding:"6px 10px 6px 6px"},Dn={padding:"6px 6px 6px 10px"},On={display:"flex",borderRadius:4,background:Mn.ZP.blackWithAlpha(.65)},Ln=.5,Vn=.5,En=2,Nn=-.002,Un=-.004;function Kn(e){let{visible:t,isOpen:n,zoomScale:s,handleZoomIn:a,handleZoomOut:r,handleNext:l,handlePrevious:c,setZoomScale:m,disableZoomEditing:p,enableZoomEditing:g,resetHideControlsTimeout:f,clearHideControlsTimeout:h,isSaving:y,isEditingZoom:x,handleClose:S}=e;const v=(0,i.Fy)(),b=(0,i.O7)(),{blockStore:M,imageUrl:j}=(0,o.VK)((()=>({blockStore:Pn.Z.state.blockStore,imageUrl:Pn.Z.state.imageUrl})),[]);if(v.isMobile)return null;const C=()=>{if(!M||!Jn())return;Pn.Z.setState({...Pn.Z.state,isSaving:!0}),h();const e=null==M?void 0:M.getProperties();let t;if(t=j||u.QaF(null==e?void 0:e.source),!t)return;const n=u.QaF(null==e?void 0:e.caption);(0,mn.GN)(t,null==M?void 0:M.pointer,d.default.domainBaseUrl,b.currentUser.id,n).then((()=>{Pn.Z.setState({...Pn.Z.state,isSaving:!1}),jn.Lf(b,{type:"download",triggered_by:"click"}),f()}))};return(0,k.jsx)(Fn.Z,{isVisible:t,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},animationStyle:{opacity:1},render:()=>(0,k.jsxs)("div",{style:Xn(n),onClick:e=>{!function(e){e.stopPropagation()}(e),f(),p()},children:[(0,k.jsx)("div",{style:{...On,marginRight:10},children:(0,k.jsx)(zn,{handlePrevious:c,handleNext:l})}),(0,k.jsxs)("div",{style:On,children:[(0,k.jsx)(Wn,{zoomScale:s,handleZoomIn:a,handleZoomOut:r,setZoomScale:m,disableZoomEditing:p,enableZoomEditing:g,isEditingZoom:x}),(0,k.jsx)(os,{}),Jn()?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(qn,{onClick:C,loading:y}),(0,k.jsx)(os,{})]}):void 0,(0,k.jsx)(Gn,{onClick:S})]})]})})}function Wn(e){let{zoomScale:t,handleZoomIn:n,handleZoomOut:o,setZoomScale:a,disableZoomEditing:r,enableZoomEditing:l,isEditingZoom:d}=e;const c=(100*t).toFixed(0),u=(0,i.O7)(),m=(0,s.useCallback)((e=>{const t=e.target,n=parseInt(t.value);if(!isNaN(n)){const e=n/100;jn.Lf(u,{type:"set_zoom",new_zoom:e}),a(e)}r()}),[r,u,a]);return(0,k.jsxs)("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"},children:[(0,k.jsx)(me.Z,{renderTooltip:()=>(0,k.jsx)(is,{primaryText:(0,k.jsx)(ne.FormattedMessage,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out"}),secondaryText:"-"}),disableTooltip:t<=Vn,render:e=>(0,k.jsx)(An.Z,{...e,disabled:t<=Vn,style:{...ns(t<=Vn),...Dn},onClick:o,icon:e=>(0,xn.$)({...e,fill:es(),height:16,margin:0,width:16})})}),d?(0,k.jsx)(Hn,{initialValue:c,onSubmit:m,onCancel:r,primaryColor:es(),secondaryColor:ts()}):(0,k.jsx)(An.Z,{onClick:e=>{e.stopPropagation(),l()},style:{color:ts(),margin:0,width:46,padding:0,justifyContent:"center"},children:`${c}%`}),(0,k.jsx)(me.Z,{renderTooltip:()=>(0,k.jsx)(is,{primaryText:(0,k.jsx)(ne.FormattedMessage,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in"}),secondaryText:"+"}),disableTooltip:t>=En,render:e=>(0,k.jsx)(An.Z,{...e,disabled:t>=En,style:ns(t>=En),onClick:n,icon:e=>(0,Sn.R)({...e,fill:es(),height:16,margin:0,width:16})})})]})}function zn(e){let{handlePrevious:t,handleNext:n}=e;const s=(0,k.jsx)("div",{}),{blockStore:i,allImageBlocksOnPage:a}=(0,o.VK)((()=>{const{blockStore:e}=Pn.Z.state;return{blockStore:e,allImageBlocksOnPage:e?Yn():[]}}),[]);if(!i)return s;if(a.length<=1)return s;const r=a.findIndex((e=>e.id===(null==i?void 0:i.id)))??-1;if(-1===r)return s;const l=a.length;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(me.Z,{renderTooltip:()=>(0,k.jsx)(is,{primaryText:(0,k.jsx)(ne.FormattedMessage,{id:"fullScreenRenderer.previous",defaultMessage:"Back"}),secondaryText:(0,k.jsx)(ss,{imageIndex:r-1,totalImageCount:l})}),disableTooltip:0===r,render:e=>(0,k.jsx)(An.Z,{...e,disabled:r<=0,style:{...ns(r<=0),...Dn},hoveredStyle:Bn,onClick:()=>t(),icon:e=>(0,pn.V)({...e,fill:es(),height:16,margin:0,width:16})})}),(0,k.jsx)(me.Z,{renderTooltip:()=>(0,k.jsx)(is,{primaryText:(0,k.jsx)(ne.FormattedMessage,{id:"fullScreenRenderer.next",defaultMessage:"Next"}),secondaryText:(0,k.jsx)(ss,{imageIndex:r+1,totalImageCount:l})}),disableTooltip:r+1===l,render:e=>(0,k.jsx)(An.Z,{...e,disabled:r>=l-1,style:{...ns(r>=l-1),...Rn},hoveredStyle:Bn,onClick:()=>n(),icon:e=>(0,gn.n)({...e,fill:es(),height:16,margin:0,width:16})})})]})}function qn(e){let{onClick:t,loading:n}=e;return(0,k.jsx)(me.Z,{renderTooltip:()=>(0,k.jsx)(is,{primaryText:(0,k.jsx)(ne.FormattedMessage,{id:"fullScreenRenderer.download",defaultMessage:"Download"})}),render:e=>(0,k.jsx)(An.Z,{...e,disabled:n,onClick:t,style:ns(!1),hoveredStyle:Bn,children:n?(0,k.jsx)($t.Z,{style:{width:16}}):(0,yn.a)({fill:es(),width:16})})})}function Gn(e){let{onClick:t}=e;return(0,k.jsx)(me.Z,{renderTooltip:()=>(0,k.jsx)(is,{primaryText:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label"}),secondaryText:"esc"}),render:e=>(0,k.jsx)(An.Z,{...e,onClick:t,style:{...ns(!1),...Rn},hoveredStyle:Bn,icon:e=>hn({...e,fill:es(),height:16,margin:0,width:16})})})}function Hn(e){const[t,n]=(0,s.useState)(e.initialValue);return(0,k.jsx)(nt.Z,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:4,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;n(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:nt.B.Transparent,right:(0,k.jsx)("span",{style:{color:e.secondaryColor},children:"%"}),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}const $n=function(){const e=(0,i.O7)(),t=(0,s.useRef)(!1),n=(0,s.useRef)(),a=(0,s.useRef)(),[r,l]=(0,s.useState)(!1),[d,c]=(0,s.useState)(void 0),[u,p]=(0,s.useState)(!1),{isOpen:g,rendered:f,fullScreenNodeRect:h,fullscreenNodeAnimationComplete:y,contentAspectRatio:x,backgroundAnimationComplete:S,zoomScale:v,panOffset:b,skipAnimations:M,isSaving:j,blockStore:C,panStartPosition:w}=(0,o.VK)((()=>{var e;const{state:t}=Pn.Z;return{isOpen:t.isOpen,rendered:null===(e=t.renderFullScreenNode)||void 0===e?void 0:e.call(t),fullScreenNodeRect:t.fullScreenNodeRect,fullscreenNodeAnimationComplete:t.fullscreenNodeAnimationComplete,contentAspectRatio:t.contentAspectRatio,backgroundAnimationComplete:t.backgroundAnimationComplete,zoomScale:t.zoomScale,panOffset:t.panOffset,skipAnimations:t.skipAnimations,isSaving:Boolean(t.isSaving),blockStore:t.blockStore,panStartPosition:t.panStartPosition}}),[]),{edgePadding:I,backgroundOpacity:T}=(0,o.VK)((()=>{const t=e.WindowSizeStore.state.width;return{edgePadding:Cn.zp(t),backgroundOpacity:.8}}),[e.WindowSizeStore]);(0,Tn.Z)({capture:g,preventType:ke.Z.All});const Z=(0,s.useCallback)((()=>{n.current&&clearTimeout(n.current)}),[]),F=(0,s.useCallback)((()=>{p(!0),Z(),r||j||(n.current=setTimeout((()=>p(!1)),2e3))}),[Z,r,j]),_=(0,s.useCallback)((e=>{F();const t=Math.max(Math.min(e,En),Vn),n=t<=1?{x:0,y:0}:b;Pn.Z.setState({...Pn.Z.state,zoomScale:t,panOffset:n})}),[b,F]),A=(0,s.useCallback)((e=>{const t=cs(e,d);t&&(e.x!==t.x&&(w.x=w.x+(e.x-t.x)),e.y!==t.y&&(w.y=w.y+(e.y-t.y)),Pn.Z.setState({...Pn.Z.state,panOffset:t,panStartPosition:w}))}),[d,w]),B=(0,s.useCallback)((()=>{l(!1),Pn.Z.setState({...Pn.Z.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}),[]),R=(0,s.useCallback)((()=>{l(!0),Z()}),[Z]),D=(0,s.useCallback)((()=>{l(!1),F()}),[F]),O=(0,s.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Cn.xv(),jn.Lf(e,{type:"close",triggered_by:t?"keypress":"click"}),kn.ZH({debug:{userAction:"FullScreenRenderer.handleClose"},environment:e}),ds(),un.default.afterNextFlush((()=>{B()}))}),[e,B]),L=(0,s.useCallback)((e=>{(0,P.uG)(e)||O()}),[O]),V=(0,s.useCallback)((e=>{if(e.stopPropagation(),(0,P.uG)(e))return;let t,n;t=v<1?1:v<1.5?1.5:1,n=t<=1?{x:0,y:0}:cs({x:(window.innerWidth/2-e.clientX)/(t/(t-1)),y:(window.innerHeight/2-e.clientY)/(t/(t-1))},d)??b,Pn.Z.setState({...Pn.Z.state,zoomScale:t,panOffset:n}),F(),D()}),[d,D,b,F,v]),E=(0,s.useCallback)((function(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!C)return;const s=Yn();if(!s)return;const i=s.findIndex((e=>e.id===C.id));if(i+t<0||i+t>=s.length)return;jn.Lf(e,{type:t>0?"next":"previous",image_count:s.length,image_index:i+t,triggered_by:n?"keypress":"click"}),Pn.Z.setState({...Pn.Z.state,skipAnimations:!0}),a.current&&clearTimeout(a.current),a.current=setTimeout((()=>{Pn.Z.setState({...Pn.Z.state,skipAnimations:!1})}),250);const o=s[i+t];wn.dK({blocks:[o]}),B()}),[C,e,B]),N=(0,s.useCallback)((function(){E(-1,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}),[E]),U=(0,s.useCallback)((function(){E(1,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}),[E]),K=(0,s.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Math.ceil(2*(v-Ln))/2;v-n<.25&&(n-=Ln),jn.Lf(e,{type:"zoom_out",new_zoom:n,triggered_by:t?"keypress":"click"}),_(n)}),[e,_,v]),W=(0,s.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Math.floor(2*(v+Ln))/2;n-v<.25&&(n+=Ln),jn.Lf(e,{type:"zoom_in",new_zoom:n,triggered_by:t?"keypress":"click"}),_(n)}),[e,_,v]),z=(0,s.useCallback)((e=>{d&&1===e.buttons&&Qn()&&A({x:e.clientX/v-w.x,y:e.clientY/v-w.y})}),[d,w.x,w.y,A,v]),q=(0,s.useCallback)((e=>{switch(e.key){case"+":case"=":W(!0);break;case"-":case"_":K(!0)}}),[W,K]);(0,s.useEffect)((()=>{const e=e=>{_(v+e)},n=t=>{g&&(t.preventDefault(),t.ctrlKey?t.deltaY?e(t.deltaY*Un):t.deltaX&&e(t.deltaX*Un):t.metaKey?t.deltaY?e(t.deltaY*Nn):t.deltaX&&e(t.deltaX*Nn):Qn()&&A({x:b.x-t.deltaX,y:b.y-t.deltaY}))};return g&&(window.addEventListener("wheel",n,{passive:!1}),t.current=!0),()=>{window.removeEventListener("wheel",n),t.current=!1}}),[g,b.x,b.y,A,_,v]);const G=window.innerWidth,H=window.innerHeight-2*I;let $=G-2*I;const Y=x??(h?h.width/h.height:void 0);if(void 0===Y)return null;let Q=$/Y;if(Q>H){const e=Q/H;Q/=e,$/=e}const J={opacity:0},X={scale:v,opacity:1,translateX:b.x,translateY:b.y,width:"100%",height:"100%"};let ee;return ee=u?v>=1.5?"zoom-out":"zoom-in":"none",(0,k.jsx)(_n.Z,{open:g||!y||!S,children:(0,In.Z)((e=>(0,k.jsx)(Ze.Z,{debugName:"FullScreenRenderer",capture:g,onEsc:()=>{O(!0)},onEnter:m.yR,onSpace:()=>O(!0),onCommandEnter:()=>O(!0),onCommandShiftEnter:m.yR,onCommandSlash:m.yR,onUp:m.yR,onDown:m.yR,onDelete:m.yR,onBackspace:m.yR,onLeft:()=>N(!0),onRight:()=>U(!0),onUntab:m.yR,onTab:m.yR,onSelectAll:m.yR,onRedo:m.yR,onUndo:m.yR,onToggleBold:m.yR,onToggleItalics:m.yR,onToggleStrike:m.yR,onToggleCode:m.yR,onCut:m.yR,onCopy:m.yR,onPaste:m.yR,onKeypress:q,children:(0,k.jsxs)("div",{style:us({isOpen:g,showControls:u}),...e,onClick:L,onMouseMove:F,children:[(0,k.jsx)(Fn.Z,{isVisible:g,enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},animationStyle:{opacity:T},render:()=>(0,k.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:Mn.ZP.black}}),onAnimationEnd:as}),(0,k.jsx)(Fn.Z,{isVisible:g,enterAnimationStyle:J,exitAnimationStyle:J,animationStyle:X,skipAnimation:M,forceTransformStyle:!0,render:()=>(0,k.jsx)("div",{style:{display:"flex",cursor:ee,maxWidth:$,maxHeight:Q,justifyContent:"center"},ref:e=>{e&&!d&&c({width:e.clientWidth,height:e.clientHeight})},onClick:V,onMouseDown:ls,onMouseUp:ds,onMouseLeave:ds,onMouseMove:z,children:f}),onAnimationEnd:rs}),(0,k.jsx)(Kn,{visible:u,isOpen:g,zoomScale:v,handleZoomIn:W,handleZoomOut:K,handlePrevious:N,handleNext:U,setZoomScale:_,disableZoomEditing:D,enableZoomEditing:R,clearHideControlsTimeout:Z,resetHideControlsTimeout:F,isSaving:j,isEditingZoom:r,handleClose:O})]})})))})};function Yn(){const{blockStore:e}=Pn.Z.state;if(!e)return[];if(function(){const{blockStore:e}=Pn.Z.state;return(null==e?void 0:e.getParentTable())===vn.x_??!1}()){return e.getParentStore().getContentStores().filter((e=>"image"===e.getType())).filter((e=>Boolean(e.getProperties().source)))}const t=Ge.default.getCurrentRootStore();return Zn.R.getMembersByDOMOrder({filter:e=>"image"===e.renderedType&&Boolean(e.getBlockStore().findRecordStoreUIAncestor((e=>Boolean(t&&e===t))).ancestor)}).map((e=>e.getBlockStore())).filter((e=>Boolean(e.getProperties().source)))}function Qn(){const{zoomScale:e}=Pn.Z.state;return e>1}function Jn(){var e;const{blockStore:t,imageUrl:n}=Pn.Z.state;return t&&(n||(null===(e=t.getProperties())||void 0===e?void 0:e.source)&&u.QaF(t.getProperties().source))}function Xn(e){return{bottom:30,display:e?"flex":"none",fontSize:14,left:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}function es(){return Mn.ZP.white}function ts(){return Mn.ZP.whiteWithAlpha(.5)}function ns(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}function ss(e){let{imageIndex:t,totalImageCount:n}=e;return(0,k.jsx)(ne.FormattedMessage,{values:{currentIndex:t+1,totalCount:n},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label"})}function is(e){const{primaryText:t,secondaryText:n}=e;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("span",{style:{marginRight:n?4:void 0},children:t}),n?(0,k.jsx)("span",{style:{color:ts()},children:n}):void 0]})}function os(){return(0,k.jsx)("span",{style:{borderLeft:`1px solid ${Mn.ZP.whiteWithAlpha(.25)}`,height:"100%"}})}function as(){const{isOpen:e}=Pn.Z.state;e||Pn.Z.setState({...Pn.Z.state,backgroundAnimationComplete:!0})}function rs(){const{isOpen:e}=Pn.Z.state;e||Pn.Z.setState({...Pn.Z.state,fullscreenNodeAnimationComplete:!0})}function ls(e){const{panOffset:t,zoomScale:n}=Pn.Z.state;Pn.Z.setState({...Pn.Z.state,panStartPosition:{x:e.clientX/n-t.x,y:e.clientY/n-t.y},skipAnimations:!0})}function ds(){Pn.Z.setState({...Pn.Z.state,skipAnimations:!1})}function cs(e,t){if(!t)return;let n,s;n=t.width*En>window.innerWidth?(t.width*En-window.innerWidth)/(2*En):(window.innerWidth-t.width*En)/(2*En),s=t.height*En>window.innerHeight?(t.height*En-window.innerHeight)/(2*En):(window.innerHeight-t.height*En)/(2*En);return{x:Math.min(Math.max(e.x,-1*n),n),y:Math.min(Math.max(e.y,-1*s),s)}}function us(e){const{isOpen:t,showControls:n}=e;return{zIndex:bn.mJ,position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:n?void 0:"none"}}var ms=n(50116),ps=n(23867),gs=n(536280),fs=n(273959),hs=n(489086),ys=n(966949),xs=n(303702);const Ss=function(){const e=(0,i.O7)(),t=(0,s.useRef)(null),n=(0,s.useCallback)((n=>function(e,t,n){if(!ys.Z.isOpen())return;if(!n.current)return;const s=n.current.getSelection();if(!s)return;const i=ys.Z.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&s.startIndex===i&&s.endIndex===i&&(Ms(t),gs.Wj())}(n,e,t)),[e]),a=(0,s.useCallback)((n=>function(e,t,n){if(!n.current)return;const s=n.current.getSelection();if(!s)return;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===s.startIndex&&0===s.endIndex&&(Ms(t),gs.Wj(ys.P.Backward))}(n,e,t)),[e]),r=(0,s.useCallback)((()=>Ms(e)),[e]),l=(0,o.VK)((()=>ys.Z.state),[]),d=(0,o.VK)((()=>function(){if(!ys.Z.isOpen())return;return ys.Z.state.savedTextSelectionRect}()),[]),m=(0,o.VK)((()=>function(){var e;if("editing"!==M.default.state.mode&&!ys.Z.isOpen())return!0;const t=ys.Z.isOpen()?null===(e=(0,S.QY)(ys.Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,fs.J2)(t);if(e&&e.isNonEditableState())return!0}if(t&&t.table===vn.x_){const e=Ht.T5.createChildStore(t,{table:vn.x_,id:t.id,spaceId:(0,ps.C)(t.pointer.spaceId)}),n=e.isDefined(),{currentUserStore:s}=O.default.state;if(!n||!s)return!0;const i=e.getCreatedByTable(),o=e.getCreatedById();if(i!==St.KJ||s.id!==o)return!0}const n={[u.GKr.User]:u.GKr.User,[u.GKr.Page]:u.GKr.Page,[u.GKr.CustomEmoji]:u.GKr.CustomEmoji,[u.GKr.Comment]:u.GKr.Comment,[u.GKr.Bot]:u.GKr.Bot,[u.GKr.Date]:u.GKr.Date,[u.GKr.ExternalObjectInstance]:u.GKr.ExternalObjectInstance,[u.GKr.TemporaryPage]:u.GKr.TemporaryPage,[u.GKr.TemplateVariable]:u.GKr.TemplateVariable,[u.GKr.FormulaPageProperty]:u.GKr.FormulaPageProperty,[u.GKr.FormulaContextValue]:u.GKr.FormulaContextValue,[u.GKr.Group]:u.GKr.Group,[u.GKr.Citation]:u.GKr.Citation,[u.GKr.LinkMention]:u.GKr.LinkMention,[u.GKr.AssistantInstructionsCollection]:u.GKr.AssistantInstructionsCollection};for(const s of Object.values(n))if((0,hs.J6)(s))return!0;return!1}()),[]);if(!l.open)return null;const p=l.value,g=l.error;return(0,k.jsx)(we.ev,{dependency:c.FF.prismjs,children:e=>l.open?(0,k.jsx)(xs.Z,{Prism:e,ref:t,isOpen:!0,equationValue:p,error:g,displayMode:"inline",disabled:m,originRect:d,originGap:8,onDismiss:bs,onChange:vs,onSubmit:r,onLeft:a,onRight:n}):null})};function vs(e,t){ys.Z.isOpen()&&ys.Z.setState({...ys.Z.state,value:e,error:t})}function bs(){gs.Wj()}function Ms(e){f.createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:e,perform:t=>{gs.gt({environment:e,equationStore:ys.Z,transaction:t})}})}var js=n(973935),Cs=n(196313),ws=n(612457),ks=n(973744),Is=n(770726),Ts=n(348863);function Zs(e){switch(e){case Is.Z.Preview:return(0,k.jsx)(ne.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview"});case Is.Z.Mention:return(0,k.jsx)(ne.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention"});case Is.Z.Link:return(0,k.jsx)(ne.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link"});default:(0,D.t1)(e)}}const Ps=function(){const e=(0,i.O7)(),t=(0,s.useRef)(null),[n]=(0,o.AF)(Ts.Z),a=(0,s.useCallback)((t=>{if(n.open){var s;if(!t)Cs.pg({actionType:n.focusedIndex,environment:e,commentStore:null===(s=n.args.commentStore)||void 0===s?void 0:s.state,useTempStores:!1});Ts.Z.setState({open:!1})}}),[e,n]),r=(0,s.useCallback)((e=>{n.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&a(void 0)}),[a,n.open]),l=(0,s.useCallback)((e=>{const s=t.current;if(!n.open||!e.target||!s)return;const i=js.findDOMNode(s);i&&(i.contains(e.target)||a(void 0))}),[a,n.open]);(0,s.useEffect)((()=>((0,ks.lj)(window,"keydown",r),(0,ks.lj)(window,"mousedown",l),()=>{(0,ks.ZV)(window,"keydown",r),(0,ks.ZV)(window,"mousedown",l)})),[r,l]);const c=(0,s.useRef)(!1);function u(t){var s;n.open&&void 0!==t.indexGlobal&&(Ts.Z.setState({...n,focusedIndex:t.indexGlobal}),Cs.pg({actionType:t.indexGlobal,environment:e,commentStore:null===(s=n.args.commentStore)||void 0===s?void 0:s.state,useTempStores:!0}))}(0,o.VK)((()=>{var t,s;const i=(n.open&&(null===(t=n.args.commentStore)||void 0===t?void 0:t.state)&&(null===(s=n.args.commentStore.state)||void 0===s?void 0:s.isReady()))??!1;var o;i&&!c.current&&n.open&&Cs.pg({actionType:n.focusedIndex,environment:e,commentStore:null===(o=n.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!0});c.current=i}),[e,n]);const p=(0,o.VK)((()=>e.device.isMobileNative&&!e.device.isTablet),[e]),g=e.device.isMobile;return(0,k.jsx)(y.ZP,{popupType:p?b.k.SlideUp:b.k.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:y.ZP.Placement.Top,alignmentToOrigin:y.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:g,keepFocus:g,render:function(){var s;const{device:i}=e;if(!n.open)return;const o=function(t){const{url:n,args:s}=t,i=[];i.push({title:Zs(Is.Z.Preview),validator:()=>!0,type:Is.Z.Preview}),i.push({title:Zs(Is.Z.Mention),validator:()=>!0,type:Is.Z.Mention}),i.push({title:Zs(Is.Z.Link),validator:()=>!0,type:Is.Z.Link});return[{key:"menu section",render:e=>(0,k.jsx)(Ye.Z,{...e}),items:m.oA(i.map((t=>{let{title:i,validator:o,type:a}=t;if(o({url:n,baseUrl:d.default.domainBaseUrl,publicDomainName:d.default.publicDomainName})){return{key:`item ${a}`,render:t=>(0,k.jsx)(He.Z,{...t,title:i,onMouseEnter:n=>{var i;t.onMouseEnter(n),Cs.pg({actionType:a,environment:e,commentStore:null===(i=s.commentStore)||void 0===i?void 0:i.state,useTempStores:!0})}}),action:()=>{var t;return Cs.pg({actionType:a,environment:e,commentStore:null===(t=s.commentStore)||void 0===t?void 0:t.state,useTempStores:!1})}}}})))}]}(n);let a;return a=i.isMobile?{menuType:x.og.ActionSheet}:{menuType:x.og.Popup,width:320,maxHeight:"40vh"},null!==(s=n.args.commentStore)&&void 0!==s&&s.state&&n.args.commentStore.state.isReady()?(0,k.jsx)(h.Z,{...a,className:We.srZ,ref:t,children:(0,k.jsx)($e.Z,{type:$e.i.Vertical,sections:o,onKeyboardArrow:u,initialFocus:0,priority:1,disallowBackspace:!0})}):(0,k.jsx)(ws.Z,{show:!0,showDelay:500,showHold:0,render:()=>(0,k.jsx)(h.Z,{...a,className:We.srZ,ref:t,children:(0,k.jsx)(Ye.Z,{style:{display:"flex",justifyContent:"center"},children:(0,k.jsx)($t.Z,{})})})})},onDismiss:()=>a(void 0)})};var Fs=n(264572),_s=n(388295),As=n(245990),Bs=n(148709),Rs=n(40462),Ds=n(23210),Os=n(757549),Ls=n(454882),Vs=n(623178),Es=n(268894);function Ns(e){const{state:t,focusInitial:n,defaultValue:s,onBlur:o,onKeyDown:a,style:r}=e,l=(0,i.MO)(),d=(0,ne.useIntl)(),c=d.formatMessage({defaultMessage:"Paste link or search pages",id:"selectionLinkButton.search.createNewLinkPlaceholder"}),u=d.formatMessage({defaultMessage:"Edit link or search pages",id:"selectionLinkButton.search.editLinkPlaceholder"}),m=!l||!t.showCreateIn,p=l?void 0:!t.showCreateIn&&t.focusLinkInput,g=t.editingToken?u:c;return m?(0,k.jsx)(Es.ZP,{onFocus:Bs.FV,placeholder:g,value:s||t.url,onChange:Us,onBlur:o,onKeyDown:a,focus:p,focusInitial:n,focusAfterAnimation:!0,preventCaptureArrowShortcuts:!0,style:r}):null}function Us(e){const t=Vs.Z.state;t.open&&Vs.Z.setState({...t,url:e.target.value,focusLinkInput:!0})}function Ks(e){const{state:t,showPreview:n,store:s}=e,o=(0,i.MO)(),a=(0,Bs.Fs)(t),{editingToken:r,focusTitleInput:l}=t;return n&&s?(0,k.jsx)(Ls.B,{store:s,onClick:Bs.FV}):(0,k.jsx)(Ns,{state:t,onBlur:Bs.cX,onKeyDown:Ws,defaultValue:n?a:void 0,style:r?void 0:{marginTop:6},focusInitial:!Boolean(r)||o&&!l})}function Ws(e){"Escape"===e.key&&(e.stopPropagation(),(0,Bs.hy)())}function zs(e){const{title:t,focus:n,defaultTitle:o}=e,a=(0,i.O7)(),r=(0,i.MO)(),[l,d]=(0,s.useState)(),c=(0,s.useRef)(!1),u=(0,s.useMemo)((()=>({environment:a,defaultTitle:o,setPlaceholder:d,hasTitleChanged:c})),[o,a]);return(0,s.useEffect)((()=>{const e=c.current;return()=>{e&&Os.pZ(a)}}),[c,a]),(0,k.jsx)(Es.ZP,{focus:n,focusInitial:r,onFocus:Gs,onBlur:()=>Hs(u),onChange:e=>function(e,t){qs(e.target.value,t)}(e,u),onKeyDown:e=>function(e,t){"Enter"!==e.key&&"Escape"!==e.key||(e.stopPropagation(),Hs(t))}(e,u),value:l?"":t,placeholder:l,preventCaptureArrowShortcuts:!0,style:{paddingBottom:8}})}function qs(e,t){const n=Vs.Z.state;if(!n.open)return;const{editingToken:s,savedTextSelectionState:i}=n;if(!s)return;if(!e)return void Vs.Z.setState({...n,title:""});const{environment:o,setPlaceholder:a,hasTitleChanged:r}=t;f.createAndCommit({userAction:"LinkMenu.updateTitle",environment:o,perform:t=>{const l=As.iX({environment:o,title:e,transaction:t,editingToken:s,savedTextSelectionState:i});l&&Vs.Z.setState({...n,...l,title:e}),a(void 0),r.current=!0}})}function Gs(){(0,Bs.ZG)(!0)}function Hs(e){!function(e){const t=Vs.Z.state;if(!t.open)return;const{defaultTitle:n,setPlaceholder:s}=e;t.title||(qs(n,e),s(n))}(e),(0,Bs.ZG)(!1)}var $s=n(788632),Ys=n(118466),Qs=n(511470),Js=n(615447);var Xs=n(937612);function ei(e){const{state:t}=e,n=(0,s.useMemo)((()=>(0,Bs.uP)(t)),[t]),a=(0,s.useMemo)((()=>(0,Bs.dY)(n)),[n]),r=function(e){const{state:t,inputUrl:n,query:a,handleLinkSelection:r}=e,{url:l}=t,d=(0,i.O7)(),c=(0,i.MO)(),u=(0,o.VK)((()=>$s.Z.state.online),[]),m=!!l,p=(0,s.useMemo)((()=>{let e,s=!1;if(!n&&m)e=(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Type a complete URL to link",id:"selectionLinkButton.invalidUrl"}),s=!0;else{if(!n)return;if("notion"===n.type&&u)return;"web"===n.type?e=(0,k.jsx)(ne.FormattedMessage,{id:"selectionLinkButton.linkToWebPage",defaultMessage:"Link to web page"}):"notion"===n.type?e=(0,k.jsx)(ne.FormattedMessage,{id:"selectionLinkButton.linkToPage",defaultMessage:"Link to page"}):"other"===n.type?e=(0,k.jsx)(ne.FormattedMessage,{id:"selectionLinkButton.linkToURL",defaultMessage:"Link to URL"}):(0,D.t1)(n.type)}return{key:"link to url",action:()=>r(d,t,a,c),render:t=>(0,k.jsx)(He.Z,{...t,title:l,caption:e,icon:(0,Rs.o)({width:16,paddingTop:4}),disabled:s})}}),[t,a,d,c,u,n,r,m,l]);return p}({state:t,inputUrl:a,query:n,handleLinkSelection:ti}),l=function(e){const{state:t,inputUrl:n,query:a,additionalItem:r}=e,{editingToken:l}=t,d=function(e){const{state:t,inputUrl:n,query:a,handleLinkSelection:r,disableEmptyQueryResults:l}=e,{savedTextSelectionState:d}=t,u=(0,i.O7)(),p=(0,i.MO)(),[{online:g}]=(0,o.AF)($s.Z),f=(0,s.useMemo)((()=>{var e;const t=null===(e=(0,S.QY)(d.multiSelection))||void 0===e?void 0:e.store;if(t&&(0,Ce.OY)(t))return t}),[d]),h=(0,we.XJ)(c.FF.searchActions),[{value:y,status:x}]=(0,B.r5)((async()=>{if(!g||"resolved"!==h.status)return[];if(!a)return l?[]:Js.X4.state.map((e=>e.pageId));const e=h.value;return(await e.searchMentionablePages({nearBlock:f,environment:u,query:a,source:"mention_menu",limit:10})).map((e=>e.id))}),[a,f,u,g,l,h.status,h.value]),v=(0,s.useMemo)((()=>{if(n&&"notion"===n.type){const e=y?m.zu(y,n.notionPage.blockId):[];return[n,...e]}return y}),[y,n]);return(0,s.useMemo)((()=>{if(!v||0===v.length)return;if(n&&"web"===n.type&&n.url===a)return;const e=Ys.Z.withListenerIgnored(Se.RM);if(!e)return;const s=t.url?5:3,i=(0,k.jsx)(ne.FormattedMessage,{id:"selectionLinkButton.linkToPage.linkToBlock",defaultMessage:"Link to block"}),o=(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Link to page",id:"selectionLinkButton.linkToPageSection.title"});return{items:v.map(((n,s)=>{const o="object"==typeof n?n.notionPage.peekViewBlockId||n.notionPage.blockId:n,a=Ht.G.createChildStore(e,{table:Kt.iU,id:o});return{key:s,action:()=>{if("object"==typeof n){const e=(0,Fs.nR)({pageId:n.notionPage.blockId,peekViewBlockId:n.notionPage.peekViewBlockId,peekMode:n.notionPage.peekMode,discussionId:n.notionPage.discussionId,collectionViewId:n.notionPage.collectionViewId,scrollToBlockId:n.notionPage.scrollToBlockId});r(u,t,e,p)}else r(u,t,(0,Fs.nR)({pageId:o}),p)},render:e=>{const t="object"==typeof n&&n.notionPage.scrollToBlockId;return(0,k.jsx)(Qs.Z,{...e,store:a,caption:t?i:void 0,placeholder:(0,k.jsx)(ws.Z,{showHold:300,showDelay:300,show:"resolved"===x,render:e=>e?(0,k.jsx)(ne.FormattedMessage,{id:"selectionLinkButton.linkToPage.unknownBlock",defaultMessage:"Unknown block"}):(0,k.jsx)(ne.FormattedMessage,{id:"selectionLinkButton.linkToPage.loading",defaultMessage:"Loading..."})})})}}})).slice(0,s),title:v.some((e=>Boolean("object"==typeof e&&e.notionPage.scrollToBlockId)))?i:o}}),[v,t,u,p,a,n,x,r])}({state:t,inputUrl:n,query:a,handleLinkSelection:ti,disableEmptyQueryResults:!!l}),u=(0,s.useMemo)((()=>{if(d||r){return{key:"results",items:m.oA([...(null==d?void 0:d.items)||[],r]),render:e=>(0,k.jsx)(Ye.Z,{...e,title:l||a?void 0:(0,k.jsx)(ne.FormattedMessage,{id:"selectionLinkButton.recents.title",defaultMessage:"Recents"})})}}}),[d,r,l,a]);return u}({state:t,inputUrl:a,query:n,additionalItem:r}),p=(0,Bs.Fs)(t),g=p&&(0,Fs.A5)({url:p,baseUrl:d.default.domainBaseUrl,publicDomainName:d.default.publicDomainName}),f=(0,o.VK)((()=>{if(!g)return;const e=(0,Se.RM)();return e?Ht.G.createChildStore(e,{table:Kt.iU,id:g}):void 0}),[g]),h=function(e){const{state:t,url:n,isEmptyResults:i,pageStore:o}=e,a=(0,s.useMemo)((()=>{let e=(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Page or URL",id:"selectionLinkButton.currentInfo.pageOrUrl"});const s=!t.focusLinkInput&&i;let a;return o?a={key:"link to page",action:()=>{},render:()=>(0,k.jsx)(Ks,{state:t,showPreview:s,store:o})}:n?a={key:"link to web",action:()=>{},render:()=>(0,k.jsx)(Ks,{state:t,showPreview:!0})}:(e=void 0,a={key:"create link",action:()=>{},render:()=>(0,k.jsx)(Ks,{state:t,showPreview:s})}),{key:"page or url",render:t=>(0,k.jsx)(Ye.Z,{title:e,...t}),items:[a]}}),[t,n,i,o]);return a}({state:t,url:p,isEmptyResults:!Boolean(l),pageStore:f}),y=function(e){const{state:t,url:n,pageStore:i}=e,{editingToken:a,title:r,focusTitleInput:l}=t,d=(0,o.VK)((()=>i?u.QaF(i.getTitleValue()):void 0),[i]),c=(0,s.useMemo)((()=>{if(a)return{key:"link title",render:e=>(0,k.jsx)(Ye.Z,{title:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Link title",id:"selectionLinkButton.currentInfo.linkTitle"}),...e}),items:[{key:"update title",action:()=>{},render:()=>(0,k.jsx)(zs,{title:r,defaultTitle:d??n,focus:l})}]}}),[a,r,l,n,d]);return c}({state:t,url:p,pageStore:f}),x=function(e){const{state:t}=e,n=function(e){const{state:t}=e,n=(0,i.O7)();return(0,s.useMemo)((()=>{if(t.editingToken)return{key:"unlink",action:()=>{As.PP(n);const e=(0,Bs.Fs)(t);Os.oS(n,{type:"remove_link",url:e})},render:e=>(0,k.jsx)(He.Z,{...e,title:(0,k.jsx)(ne.FormattedMessage,{id:"selectionLinkButton.removeLink",defaultMessage:"Remove link"}),icon:(0,Xs.y)({width:16})})}}),[t,n])}({state:t}),o=(0,s.useMemo)((()=>{const e=m.oA([n]);if(0!==e.length)return{key:"link actions",render:e=>(0,k.jsx)(Ye.Z,{topBorder:!0,...e}),items:e}}),[n]);return o}({state:t});let v,b;return l?(b=1,v=m.oA([h,l])):(b=void 0,v=m.oA([h,y,x])),{initialFocus:b,sections:v}}function ti(e,t,n,s){const i=(0,Ds.D)(n);if(!i)return;const{editingToken:o,savedTextSelectionState:a,title:r}=t;f.createAndCommit({userAction:"LinkMenu.handleLinkSelection",environment:e,perform:n=>{const l=As.gp({environment:e,transaction:n,url:i,title:r,editingToken:o,savedTextSelectionState:a});l?(Os.oS(e,{type:"edit_link",url:i}),Vs.Z.setState({...t,...l,url:"",focusLinkInput:!1,focusTitleInput:Boolean(s)})):(Os.oS(e,{type:"create_link",url:i}),Vs.Z.reset())}})}var ni=n(51253),si=n(897630),ii=n(301743),oi=n(256940);function ai(){const e=(0,o.VK)((()=>Vs.Z.state),[]),t=(0,i.Fy)(),n=(0,o.VK)(F.bq,[]),a=(0,o.VK)((()=>{if(!e.open)return!1;if(e.focusLinkInput||e.focusTitleInput)return!1;const t=M.default.state;if("editing"!==t.mode)return!0;const n=(0,S.QY)(t.multiSelection);if(!n)return!0;const{store:s,selection:i}=n;return(0,hs.wd)(i)?!u.oP(s.getValue(),i.startIndex,i.endIndex,u.GKr.Link):!(0,S._v)(t.multiSelection,e.savedTextSelectionState.multiSelection)}),[e]);return(0,s.useEffect)((()=>{a&&As.F5()}),[a]),(0,k.jsx)(y.ZP,{popupType:t.isMobile?t.isTablet?b.k.Popup:b.k.SlideUp:b.k.Popup,style:{width:mi(n)},keepFocus:t.isPhone,open:e.open,originRect:e.open?e.selectionRect:void 0,placementToOrigin:y.ZP.Placement.Bottom,alignmentToOrigin:y.ZP.Alignment.Center,originGap:8,disableContentScroll:!0,onDismiss:As.F5,render:()=>e.open?(0,k.jsx)(ri,{state:e}):void 0,preventBlockRenderQueueOnEnter:!t.isMobile})}function ri(e){const{state:t}=e,n=(0,i.MO)(),[o,a]=(0,s.useState)(!0);(0,s.useEffect)((()=>a(!1)),[]);const r=(0,s.useRef)(null);(0,s.useEffect)((()=>(r.current=document.createElement("input"),r.current.style.position="fixed",r.current.style.top="-9999px",r.current.style.left="-9999px",document.body.appendChild(r.current),()=>{r.current&&document.body.removeChild(r.current)})),[]);const l=n&&!t.focusLinkInput&&!t.focusTitleInput;(0,s.useEffect)((()=>{l&&un.default.afterNextFlush((()=>{r.current&&r.current.focus()}))}),[l]);const d=(0,s.useCallback)((()=>{un.default.afterNextFlush((()=>{r.current&&document.activeElement===r.current&&r.current.blur()}))}),[]);if(t.showCreateIn&&!n)return(0,k.jsx)(di,{state:t});let c;return c=n?{menuType:x.og.Modal,title:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Link",id:"selectionLinkButton.mobile.title"}),right:(0,k.jsx)(Pe.CancelMenuText,{}),onClickRight:As.F5,footer:(0,k.jsx)(y.ZP,{popupType:b.k.SlideUp,open:t.showCreateIn||!1,render:()=>(0,k.jsx)(di,{state:t})})}:{menuType:x.og.Popup},(0,k.jsxs)(ii.Z,{debugName:"LinkMenu",capture:t.open&&(o||t.focusLinkInput||t.focusTitleInput),allowEsc:!0,children:[(0,k.jsx)(h.Z,{...c,children:(0,k.jsx)(oi.Z,{capture:l,ignoreBlockSelection:!0,restoreSelection:!0,onClearSelection:d,render:()=>(0,k.jsx)(li,{state:t,useMenuList:ei})})}),(0,k.jsx)(Ze.Z,{debugName:"LinkMenu",capture:!0,onCommandSlash:Bs.FV})]})}function li(e){const{state:t,useMenuList:n}=e,{initialFocus:s,sections:i}=n({state:t});return(0,k.jsx)($e.Z,{type:$e.i.Vertical,initialFocus:s,sections:i})}function di(e){var t;const{state:n}=e,a=(0,i.O7)(),r=(0,s.useCallback)((async e=>{var t;if(!si.M_(a))return;const s=null===(t=(0,S.QY)(n.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store;if(!s)return;const{performResult:{createInState:i}}=await f.createAndCommitAsync({environment:a,userAction:"LinkMenu.LinkCreateInMenu",waitForServerCommit:!0,perform:async t=>{const i=_s.f8({environment:a,transaction:t,titleText:n.url||"",createInValue:e,recordStoreParentStore:s}),[o]=i.createdPages;return o&&(As.gp({environment:a,url:(0,Fs.nR)({pageId:o.id}),transaction:t,editingToken:n.editingToken,savedTextSelectionState:n.savedTextSelectionState}),Vs.Z.reset()),await i.moveToStorePromise,{createInState:i}}});await _s.c_({analyticsFrom:"link_menu",createInState:i})}),[n,a]),l=null===(t=(0,S.QY)(n.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store,d=l&&"block"===l.table?l.id:void 0,c=(0,o.VK)(F.bq,[]);return(0,k.jsx)(ni.ZP,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:r,captureSelection:!1,restoreSelection:!1,parentBlockId:d,onAutocompleteQueryChange:ci,autocompleteQuery:n.createInQuery||"",desktopWidth:mi(c),onCancel:ui})}function ci(e){const t=Vs.Z.state;t.open&&Vs.Z.setState({...t,createInQuery:e})}function ui(){const e=Vs.Z.state;e.open&&Vs.Z.setState({...e,showCreateIn:!1,createInQuery:""})}function mi(e){return e?400:330}var pi=n(627153),gi=n(689813),fi=n(791390);const hi=function(){const e=(0,i.O7)(),{device:t}=e,n=(0,o.VK)((()=>fi.Z.state),[]);return(0,k.jsx)(y.ZP,{popupType:t.isMobile?b.k.SlideUp:b.k.Popup,open:n.isActive,originRect:n.isActive?n.originRect:void 0,originGap:n.isActive?n.originGap:void 0,placementToOrigin:y.ZP.Placement.Bottom,alignmentToOrigin:y.ZP.Alignment.Center,preventScaleTransition:!0,onDismiss:yi,render:()=>{if(n.isActive)return(0,k.jsx)(Ze.Z,{debugName:"MediaMenu",capture:!0,onUp:m.yR,onDown:m.yR,children:(0,k.jsx)(gi.ZP,{...n,onCancel:yi})})}})};function yi(){pi.Z()}var xi=n(883355),Si=n(567060),vi=n(972402),bi=n(483089),Mi=n(513394),ji=n(863334),Ci=n(655899),wi=n(319111),ki=n(672087),Ii=n(749085);class Ti extends Ii.default{getInitialState(){return{userId:"",userEmail:"",displayName:""}}}const Zi=Ti;function Pi(e,t){const n=t.state;return n?wi.Z.state.open&&"@"===wi.Z.state.insertionType&&e.device.isAndroid&&n.startsWith("@")?n.slice(1).trim():wi.Z.state.open&&"[["===wi.Z.state.insertionType&&n.endsWith("]]")?n.slice(0,-2).trim():n.trim():""}function Fi(e){if(e.usePopupOnMobile)return!1;const{device:t}=e.environment;return t.isMobileNative&&!t.isTablet}var _i=n(458912),Ai=n(781918),Bi=n(374510);function Ri(e){const{environment:t,query:n,mentionMenuState:s,analyticsFrom:i}=e;let o,a=Date.now();return s.open&&(a=s.openTime,o=s.flowId),()=>{if(wi.Z.state.open){const e=Date.now(),{numServerRequests:s}=Bi.Z.state,r=wi.Z.state.sessionId,l=wi.Z.state.showMentionAndShare;_i.ew(t,{timeToAbandonInMs:e-a,analyticsFrom:i,queryLength:n.length,flowId:o,searchSessionId:r,searchSessionFlowNumber:s,stage:l?"share":"user_selection"})}s.open&&s.showInvite&&Ai.Zv(t,{origin:wi.Z.getInviteOrigin(),invite_flow_id:s.flowId}),Si.xv()}}function Di(){return(0,F.bq)()?400:330}function Oi(e){let{ignoreSelectionAreaStore:t,filterStore:n}=e;const s=(0,i.O7)(),a=(0,o.VK)((()=>wi.Z.state),[]),r=(0,o.VK)((()=>Di()),[]);if(!a.open)return null;const l="block"===a.textStore.table?a.textStore.id:void 0;return(0,k.jsx)(ni.ZP,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:e=>{Si.Br({environment:s,titleText:Pi(s,n),ignoreSelectionAreaStore:t,createInValue:e,menuListItemAction:void 0})},captureSelection:!0,restoreSelection:!0,parentBlockId:l,onAutocompleteQueryChange:Li,ignoreSelectionAreaStore:t,autocompleteQuery:a.createInQuery,desktopWidth:r,onCancel:Vi})}function Li(e){wi.Z.updateOpenState({createInQuery:e})}function Vi(){wi.Z.updateOpenState({showCreateIn:!1,createInQuery:""})}var Ei=n(400135);function Ni(e){let{ignoreSelectionAreaStore:t,inviteTargetsStore:n,personPropertyInviteStore:a,filterStore:r}=e;const l=(0,i.O7)(),d=(0,s.useCallback)((()=>Ui(l,n,a)),[l,n,a]),c=(0,o.VK)((()=>Se.np()),[]),p=(0,o.VK)((()=>wi.Z.getInviteOrigin()),[]);return c?(0,k.jsx)(oi.Z,{store:t,capture:!0,ignoreBlockSelection:!1,restoreSelection:!0,render:()=>(0,k.jsx)(Ei.Z,{inviteOrigin:p,store:c,onInviteCompleteFn:e=>{if(!e.success)return Ui(l,n,a),null;const{invitedUsers:t,requestedUsers:s}=e,i=m.zo(Object.values(t),Object.values(s));i.length?f.createAndCommit({userAction:"MentionMenu.inviteMenu",environment:l,perform:e=>{Si.RL({environment:l,editorMode:"default",annotations:i.map((e=>(0,u.tEo)(e))),transaction:e,menuListItemAction:void 0,query:Pi(l,r),mentionType:"user"})}}):Ui(l,n,a)},handleBackButtonClick:d,inviteTargetsStore:n,personPropertyInviteStore:a})}):null}function Ui(e,t,n){const s=wi.Z.state;s.open&&(Ai.Zv(e,{origin:wi.Z.getInviteOrigin(),invite_flow_id:s.flowId}),t.setState({tokenQuery:"",inviteTargets:[]}),n.setState({...n.state,emailMessage:""}),wi.Z.updateOpenState({showInvite:!1}))}var Ki=n(747612),Wi=n(982114),zi=n(915157),qi=n(891219),Gi=n(476464),Hi=n(869454);const $i="ShowMentionInvite";function Yi(e){return`${$i}-${e}`}function Qi(e){const t=(0,i.O7)(),n=(0,o.VK)((()=>Se.np()),[]),{mentionMenuCurrentMentionStore:s,ignoreSelectionAreaStore:a,menuPopupType:r}=e,l=(0,o.VK)((()=>s.getState().userId),[s]),d=(0,o.VK)((()=>s.getState().displayName),[s]),c=(0,o.VK)((()=>s.getState().userEmail),[s]);return n?(0,k.jsx)(oi.Z,{store:a,capture:!0,ignoreBlockSelection:!1,restoreSelection:!0,render:()=>{const e={key:"invite buttons",render:e=>(0,k.jsx)(Ye.Z,{...e}),items:[{key:"MentionMenu.MentionWithoutSharing",render:e=>(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(He.Z,{title:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Mention without sharing",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharing"}),caption:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Mention {userDisplayName} without sharing this document",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharingCaption",values:{userDisplayName:d}}),icon:(0,Wi.p)({width:18}),...e})}),action:()=>{f.createAndCommit({userAction:"MentionMenu.menuItem",environment:t,perform:e=>{Si.RL({environment:t,editorMode:"default",annotations:[(0,u.tEo)(l)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_without_share"})}}),zi.Z.set({userId:t.currentUser.id,key:Yi(n.id),value:!0})}},{key:"MentionMenu.MentionAndShare",render:e=>(0,k.jsx)(He.Z,{title:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Mention and share",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShare"}),caption:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Grant {userDisplayName} full access",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShareCaption",values:{userDisplayName:d}}),icon:(0,Ki.C)({width:18}),...e}),action:()=>{f.createAndCommit({userAction:"MentionMenu.menuItem",environment:t,perform:e=>{Si.RL({environment:t,editorMode:"default",annotations:[(0,u.tEo)(l)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_and_share"})}}),f.createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission",environment:t,perform:e=>{Gi.l3({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"editor",user_id:l}],pagePermissionChangeLocation:"mention_share_menu"})}}),qi.jB(t,{role:"editor",is_space:!1,invite_targets:[{type:"existingUser",value:{id:l,version:0,email:c}}],is_onboarding:!1,invite_origin:"mention_share_menu",permission_items:[{type:"user_permission",role:"editor",user_id:l}],invite_message_length:0}),bt.d4({item:{label:(0,k.jsx)(ne.FormattedMessage,{id:"mentionMenu.mentionShareMenu.mentionAndShare.snackbarMessage",defaultMessage:"Successfully granted {user} full access",values:{user:d}})},undoFunc:()=>f.createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission.undoShare",environment:t,perform:e=>{Gi.l3({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"none",user_id:l}],pagePermissionChangeLocation:"mention_share_menu"})}})})}}]},s=r===x.og.ActionSheet?{menuType:x.og.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${Hi.Z.mobileNativeBottomPadding(t)}px)`}:{menuType:x.og.Popup};return(0,k.jsx)(k.Fragment,{children:(0,k.jsxs)(h.Z,{...s,children:[(0,k.jsx)(Ze.Z,{debugName:"MentionMenu",capture:wi.Z.state.open}),(0,k.jsx)($e.Z,{type:$e.i.Vertical,initialFocus:0,sections:[e]})]})})}}):null}var Ji=n(743765),Xi=n(526056),eo=n(435840),to=n(606746),no=n(744805);function so(e){const{theme:t}=e;return"+"===e.insertionType?(0,k.jsx)(io,{theme:t}):(0,k.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,k.jsx)(lo,{svg:eo.T,viewBox:eo.R.__iconViewBox,theme:t})})}function io(e){let{theme:t}=e;return(0,k.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,k.jsx)(lo,{svg:Sn.s,viewBox:Sn.R.__iconViewBox,theme:t})})}function oo(e){let{theme:t}=e;return(0,k.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,k.jsx)(lo,{svg:Xi.T,viewBox:Xi.f.__iconViewBox,theme:t})})}function ao(e){let{theme:t}=e;return(0,k.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,k.jsx)(lo,{svg:Wi.Q,viewBox:Wi.p.__iconViewBox,theme:t})})}function ro(e){const{pageStore:t,theme:n,isSafariOrIOS:s,emojiType:i,currentUserId:o}=e;return(0,no.tp)({pageModel:t.getModel(),pageRole:t.getRole(),showEmojiInline:!0,emojiType:i,baseUrl:d.default.domainBaseUrl,getRecordModel:t.getRecordModel,isClient:!0,isSafariOrIOS:s,currentUserId:o,theme:n,emojiData:jt.Z.state})}function lo(e){const{svg:t,viewBox:n,theme:i}=e,o=(0,s.useMemo)((()=>{const e=to.Z.renderToString((0,k.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:n,children:t}));return`url("${`data:image/svg+xml,${encodeURIComponent(e)}`}")`}),[t,n]);return(0,k.jsx)("div",{style:{width:"100%",height:"100%",backgroundColor:i.mediumIconColor,WebkitMaskImage:o,maskImage:o,WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat"}})}var co=n(266897),uo=n(815145),mo=n(841892),po=n(407057),go=n(484795),fo=n(133728),ho=n(842875),yo=n(509999),xo=n(356666),So=n(307928),vo=n(275754),bo=n(360682),Mo=n(98742),jo=n(367669),Co=n(481570);const wo={...se.Z.textOverflowStyle,fontWeight:se.Z.fontWeight.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function ko(e){const{pageTitle:t}=e;return t?(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"New “{filterText}” page in…",id:"createPageMenuItem.title.withPageName",values:{filterText:(0,k.jsx)("span",{style:wo,children:t})}}):(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Add new page in…",id:"createPageMenuItem.title.withoutPageName"})}function Io(e){const{pageTitle:t}=e;return t?(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"New “{filterText}” sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:(0,k.jsx)("span",{style:wo,children:t})}}):(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}var To=n(585215),Zo=n(760442),Po=n(197680);const Fo=(0,ne.defineMessages)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"},addPage:{defaultMessage:"Type to add or link page…",id:"mentionMenu.addPage.prompt2"}}),_o=(0,ne.defineMessages)({noPageResults:{defaultMessage:"No page results",id:"mentionMenu.noPageSearchResults.title"},groupMentionCaption:{defaultMessage:"{numMembersInGroup, plural, one {{numMembersInGroup} member} other {{numMembersInGroup} members}}",id:"mentionMenu.group.caption"}});function Ao(e){const{query:t,ignoreSelectionAreaStore:n,inviteTargetsStore:s,personPropertyInviteStore:a,mentionMenuCurrentMentionStore:r,result:l,setTemporaryInputData:d}=e,c=(0,i.O7)(),u=(0,ne.useIntl)(),m=(0,X.Fg)(),p=(0,o.VK)((()=>wi.Z.state),[]),g=(0,o.VK)((()=>wi.Z.state.pageRequestStore.state),[]),f=(0,o.VK)((()=>p.open&&p.insertionType),[p]),h=(0,o.VK)((()=>Se.np()),[]),y=(0,o.VK)((()=>Se.RF()),[]),x={sections:[],nextSectionShouldHaveTopBorder:()=>x.sections.length>0,addSection(e){e&&this.sections.push(e)}};"+"===f&&x.addSection(Bo({topBorder:x.nextSectionShouldHaveTopBorder(),environment:c,intl:u,query:t,theme:m,ignoreSelectionAreaStore:n,mentionMenuState:p,setTemporaryInputData:d}));const S=function(e){const t=(0,o.VK)((()=>wi.Z.state),[]);let n;n=t.open&&t.sectionOrder?t.sectionOrder:function(e){const{result:t,environment:n,intl:s,theme:i,query:o,setTemporaryInputData:a}=e,{userResults:r}=t,l=Uo({result:t,category:"user",intl:s,environment:n,theme:i,query:o,setTemporaryInputData:a});if(""===o)return!0;if(r.length>0||l.length>0)return!0;if((0,fo.BZ)(o))return!0;return!1}(e)?["date","user","page","group","heading"]:["date","page","group","heading","user"];return(0,Wt.jj)([...n,...wi.K])}({result:l,intl:u,theme:m,environment:c,query:t,setTemporaryInputData:d});for(const i of S){const e=x.nextSectionShouldHaveTopBorder();"date"===i?x.addSection(Ro({result:l,topBorder:e,environment:c,intl:u,theme:m,query:t,mentionMenuState:p,setTemporaryInputData:d})):"user"===i?x.addSection(Do({result:l,topBorder:e,environment:c,query:t,inviteTargetsStore:s,personPropertyInviteStore:a,mentionMenuCurrentMentionStore:r,intl:u,theme:m,mentionMenuState:p,pageStore:h,setTemporaryInputData:d})):"page"===i?x.addSection(Oo({result:l,intl:u,theme:m,topBorder:e,environment:c,query:t,mentionMenuState:p,pageRequestStoreState:g,rootStore:y,setTemporaryInputData:d})):"group"===i?x.addSection(Vo({result:l,topBorder:e,intl:u,theme:m,environment:c,query:t,mentionMenuState:p,setTemporaryInputData:d})):"heading"===i?x.addSection(Eo({result:l,topBorder:e,environment:c,query:t,intl:u,theme:m,mentionMenuState:p,setTemporaryInputData:d})):"bot"===i||(0,D.t1)(i)}return("@"===f&&t||"[["===f)&&x.addSection(Bo({topBorder:x.nextSectionShouldHaveTopBorder(),environment:c,intl:u,ignoreSelectionAreaStore:n,mentionMenuState:p,theme:m,query:t,setTemporaryInputData:d})),x.sections}function Bo(e){const{topBorder:t,environment:n,intl:s,theme:i,query:o,ignoreSelectionAreaStore:a,mentionMenuState:r,setTemporaryInputData:l}=e;if(!r.mentionTypes.createPage)return;if(!r.open)return;const d=o,c="@"===r.insertionType?(0,k.jsx)(ne.FormattedMessage,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;return{key:"create page",render:e=>(0,k.jsx)(Ye.Z,{title:c,isTitleUppercase:!0,...e,topBorder:t}),items:[{key:"add new subpage",action:async e=>{const t=_s.gt(r.textStore);t&&await Si.Br({environment:n,ignoreSelectionAreaStore:a,titleText:o,createInValue:t.createInValue,onPageCreated:e=>{e&&""===u.QaF(e.getTitleValue())&&vo._c({environment:n,store:e,pageVisitSource:uo.tY.Create})},menuListItemAction:e})},render:e=>{e.focused&&l({title:0===d.length?s.formatMessage(Fo.addPage):"",icon:(0,k.jsx)(io,{theme:i}),allowTabCompletion:!1});const t=t=>(0,k.jsx)(He.Z,{...(0,Mo.Z)(t||{},e),icon:(0,Sn.R)({width:16}),title:(0,k.jsx)(Io,{pageTitle:d})});return n.device.isMobile?t():(0,k.jsx)(me.Z,{renderTooltip:()=>(0,k.jsx)(Zo.Z,{imageURL:mo.Z.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,k.jsx)(ne.FormattedMessage,{...ni.sY.createSubpage})}),placement:de.u.Right,delayThreshold:0,render:e=>t(e)})}},{key:"open create in menu",action:Lo,render:e=>{e.focused&&l({title:0===d.length?s.formatMessage(Fo.addPage):"",icon:(0,k.jsx)(io,{theme:i}),allowTabCompletion:!1});const t=(0,k.jsx)(ko,{pageTitle:d}),o=n=>(0,k.jsx)(He.Z,{...(0,Mo.Z)(n||{},e),icon:(0,yo.J)({width:16}),title:t});return n.device.isMobile?o():(0,k.jsx)(me.Z,{renderTooltip:()=>(0,k.jsx)(Zo.Z,{imageURL:mo.Z.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:(0,k.jsx)(ne.FormattedMessage,{...ni.sY.newPageIn})}),placement:de.u.Right,delayThreshold:0,render:e=>o(e)})}}]}}function Ro(e){const{result:t,topBorder:n,query:s,intl:i,theme:o,environment:a,mentionMenuState:r,setTemporaryInputData:l}=e,{dateResults:d}=t,c=Uo({result:t,category:"date",intl:i,environment:a,theme:o,query:s,setTemporaryInputData:l});if(0===d.length&&0===c.length)return;const u=d.map((e=>{let{label:t,value:n}=e;return{key:t,render:e=>{if(e.focused&&l({title:t,icon:(0,k.jsx)(ao,{theme:o}),allowTabCompletion:!0}),go.UL(t,i)){const s=(0,po.ZV)({value:n(),userTimeZone:(0,ho.r)(),intl:i,allowRelativeDates:!1});return(0,k.jsx)(He.Z,{...e,title:t,caption:s,inline:!0})}return(0,k.jsx)(He.Z,{...e,title:t})},action:e=>{f.createAndCommit({userAction:"MentionMenu.menuItem",environment:a,perform:t=>{const i=n();Si.RL({environment:a,editorMode:"default",annotations:[["d",{...i,date_format:"relative"}]],transaction:t,menuListItemAction:e,query:s,mentionType:i.reminder?"reminder":"date"})}})}}}));return Ko("date",{key:"date results",render:e=>(0,k.jsx)(Ye.Z,{...e,title:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),topBorder:n,isTitleUppercase:!0}),items:c.concat(u)},a,r,o)}function Do(e){const{result:t,topBorder:n,environment:s,query:i,inviteTargetsStore:o,personPropertyInviteStore:a,mentionMenuCurrentMentionStore:r,theme:l,mentionMenuState:d,pageStore:c,intl:p,setTemporaryInputData:g}=e,h=!!c&&zi.Z.get({userId:s.currentUser.id,key:Yi(c.id)}),y=d.mentionTypes.inviteUserToPage&&!h,{userResults:x}=t,S=Uo({result:t,category:"user",intl:p,environment:s,theme:l,query:i,setTemporaryInputData:g}),v=x.find((e=>e.email===i)),b=!v&&d.mentionTypes.inviteUserToWorkspace;if(!b&&0===x.length&&0===S.length)return;const M=m.oA(x.map((e=>({key:e.id,render:t=>(t.focused&&g({title:(0,So.Nz)(p,e),icon:(0,k.jsx)(ao,{theme:l}),allowTabCompletion:!0}),(0,k.jsx)(Po.Z,{...t,actor:(0,co.dp)(e),useEmailAsTooltip:!0})),action:t=>{const n=(0,jo.rc)(e.id);y&&"none"===n?(r.reset(),r.setState({userId:e.id,userEmail:e.email,displayName:(0,co.dp)(e).getDisplayName(p)}),wi.Z.updateOpenState({showMentionAndShare:!0})):f.createAndCommit({userAction:"MentionMenu.menuItem",environment:s,perform:n=>{Si.RL({environment:s,editorMode:"default",annotations:[(0,u.tEo)(e.id)],transaction:n,menuListItemAction:t,query:i,mentionType:"user"})}})}})))).concat(b?[{key:"__invite",action:()=>function(e,t,n,s){const i=wi.Z.state;t.reset(),n.reset(),i.open&&(t.setState({...t.state,tokenQuery:s}),n.setState({...n.state,flowId:i.flowId}),Ai.P0(e,{origin:wi.Z.getInviteOrigin(),invite_flow_id:i.flowId}),wi.Z.updateOpenState({showInvite:!0}))}(s,o,a,i),render:e=>(e.focused&&g({title:"",icon:(0,k.jsx)(ao,{theme:l}),allowTabCompletion:!1}),(0,k.jsx)(He.Z,{...e,icon:(0,Ki.C)({width:20}),title:i.length>0?(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Invite ”{query}”…",id:"mentionMenu.peopleSection.invitePrompt",values:{query:i}}):(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Invite…",id:"mentionMenu.peopleSection.invitePrompt.empty"})}))}]:[]);return Ko("user",{key:"user results",render:e=>(0,k.jsx)(Ye.Z,{...e,title:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"People",id:"mentionMenu.peopleSection.title"}),topBorder:n,isTitleUppercase:!0}),items:S.concat(M)},s,d,l)}function Oo(e){const{result:t,topBorder:n,environment:s,query:i,theme:o,intl:a,mentionMenuState:r,pageRequestStoreState:l,rootStore:d,setTemporaryInputData:c}=e,{pageResults:u}=t,{device:p}=s,g=p.isSafari||p.isIOS,h=s.currentUser.id,y=l.result,x=y&&y[0]?y[0].serverEventProperties:void 0,S=(0,k.jsxs)(k.Fragment,{children:[0!==u.length||l.loading?(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Link to page",id:"mentionMenu.pagesSection.title2"}):(0,k.jsx)(ne.FormattedMessage,{..._o.noPageResults}),(0,k.jsx)(No,{show:l.loading})]});return 0===u.length?{key:"no page results",render:e=>(0,k.jsx)(Ye.Z,{...e,title:S,topBorder:n,isTitleUppercase:!0}),items:[]}:Ko("page",{key:"page results",render:e=>(0,k.jsx)(Ye.Z,{...e,title:S,topBorder:n,isTitleUppercase:!0}),items:m.oA(u.map((e=>{if(!d)return;const t=Ht.G.createChildStore(d,{table:Kt.iU,id:e});return{key:e,render:e=>{if(e.focused){const e=t.getModel();if(e){const n=e.getRenderTitle({getRecordModel:t.getRecordModel,userTimeZone:(0,ho.r)(),intl:a});c({title:n||"",icon:(0,k.jsx)(ro,{pageStore:t,theme:o,isSafariOrIOS:g,emojiType:(0,bo.e_)(s),currentUserId:h}),allowTabCompletion:!0})}}return(0,k.jsx)(Qs.Z,{...e,store:t})},action:t=>{f.createAndCommit({userAction:"MentionMenu.getPageResultsMenuSection",environment:s,perform:n=>{Si.RL({environment:s,editorMode:"default",annotations:[["p",e]],transaction:n,menuListItemAction:t,query:i,serverEventProperties:x,mentionType:"page",resultId:e})}})}}})))},s,r,o)}function Lo(){wi.Z.updateOpenState({showCreateIn:!0})}function Vo(e){const{result:t,topBorder:n,intl:s,environment:i,query:o,theme:a,mentionMenuState:r,setTemporaryInputData:l}=e,{groupResults:d}=t;if(0===d.length)return;return Ko("group",{key:"group results",render:e=>(0,k.jsx)(Ye.Z,{...e,title:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Groups",id:"mentionMenu.groupSection.title"}),topBorder:n,isTitleUppercase:!0}),items:m.oA(d.map((e=>{var t;const n=s.formatMessage(_o.groupMentionCaption,{numMembersInGroup:(null===(t=e.user_ids)||void 0===t?void 0:t.length)||0});return{key:e.id,render:t=>(t.focused&&l({title:e.name||"",icon:(0,k.jsx)(ao,{theme:a}),allowTabCompletion:!0}),(0,k.jsx)(To.l,{menuListItemProps:{...t,caption:n},group:e})),action:t=>{var n;const s=null===(n=O.default.state.currentSpaceStore)||void 0===n?void 0:n.id;s&&f.createAndCommit({userAction:"MentionMenu.groupMention",environment:i,perform:n=>{Si.RL({environment:i,editorMode:"default",annotations:[u.XIB(e.id,s)],transaction:n,menuListItemAction:t,query:o,mentionType:"group"})}})}}})))},i,r,a)}function Eo(e){const{result:t,topBorder:n,environment:s,query:i,intl:o,theme:a,mentionMenuState:r,setTemporaryInputData:l}=e,{headingResults:d}=t;if(0===d.length)return;const c=(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Link to heading",id:"mentionMenu.headerSection.title"})});return Ko("heading",{key:"heading results",render:e=>(0,k.jsx)(Ye.Z,{...e,title:c,topBorder:n,isTitleUppercase:!0}),items:m.oA(d.map((e=>{const t=Se.RM();if(!t)return;const n=Ht.G.createChildStore(t,{table:Kt.iU,id:e});return{key:e,render:e=>{if(e.focused){const e=n.getModel();if(e){const t=e.getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:(0,ho.r)(),intl:o});l({title:t||"",icon:(0,k.jsx)(oo,{theme:a}),allowTabCompletion:!0})}}return(0,k.jsx)(Co.Z,{...e,store:n})},action:t=>{f.createAndCommit({userAction:"MentionMenu.getHeaderResultsMenuSection",environment:s,perform:n=>{Si.RL({environment:s,editorMode:"default",annotations:[["p",e]],transaction:n,menuListItemAction:t,query:i,mentionType:"heading"})}})}}})))},s,r,a)}function No(e){let{show:t}=e;return(0,k.jsx)(ws.Z,{show:t,showDelay:500,showHold:300,render:e=>(0,k.jsx)($t.Z,{style:{textAlign:"center",visibility:e?"visible":"hidden",display:"inline",marginLeft:8}})})}function Uo(e){const{result:t,category:n,intl:s,environment:i,query:o,theme:a,setTemporaryInputData:r}=e,{templateVariableResults:l}=t;return l.filter((e=>u.i6A(e,n))).map((e=>({key:e,render:t=>{const n=u.U$y(e,s),i=u.Z08(e,s);return t.focused&&r({title:n,icon:(0,k.jsx)(ao,{theme:a}),allowTabCompletion:!0}),(0,k.jsx)(He.Z,{...t,title:n,caption:i,inline:!0})},action:t=>{f.createAndCommit({userAction:"MentionMenu.menuItem",environment:i,perform:n=>{Si.RL({environment:i,editorMode:"default",annotations:[u.WBu({type:e})],transaction:n,menuListItemAction:t,query:o,mentionType:"templateVariable"})}})}})))}function Ko(e,t,n,s,i){if(!s.open)return t;if(s.expandSection&&s.expandSection===e)return t;const{items:o}=t,a=n.device.isPhone||"heading"===e?3:5;if(o.length<=a)return t;const r=[...o.slice(0,a),{key:"show more",render:e=>(0,k.jsx)(He.Z,{...e,icon:(0,xo.o)({width:16,fill:i.mediumTextColor}),title:(0,k.jsx)("span",{style:{color:i.mediumTextColor},children:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:o.length-a}})})}),action:()=>{wi.Z.updateOpenState({expandSection:e})}}];return{...t,items:r}}var Wo=n(494804),zo=n(492338),qo=n(585031),Go=n(823586),Ho=n(318245),$o=n(675822),Yo=n(525286),Qo=n(596820),Jo=n(184166),Xo=n(188923),ea=n(253877),ta=n(158573),na=n(897638);const sa=(0,ne.defineMessages)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminder:{defaultMessage:"Remind tomorrow 9am",id:"mentionMenu.date.autocomplete.reminder"},reminder:{defaultMessage:"Remind {dateTime}",id:"mentionMenu.date.remindAtDateTime"},noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title"}});function ia(e,t,n,s,i,o){const a=wi.Z.state,r=a.userRequestStore.state.result||[],l=a.pageRequestStore.state.result||[],d=function(e,t){const n=wi.Z.state;if(!n.open)return[];const s=n.mentionTypes.reminder,i=n.mentionTypes.date?function(e,t,n){if(0===e.length)return m.oA([{label:n.formatMessage(sa.autocompleteToday),value:()=>ea.Lg((0,ho.r)())},t?void 0:{label:n.formatMessage(sa.autocompleteNextTuesday),value:()=>{const e=ea.Uu((0,ho.r)()),t=e.set({weekday:2,hour:15}),n=t<=e?t.plus({week:2}):t.plus({week:1});return{type:"datetime",start_date:n.toFormat(ea.Iq),start_time:n.toFormat(Ft.jK),time_zone:(0,ho.r)()}}},t?{label:n.formatMessage(sa.autocompleteReminder),value:()=>({type:"datetime",start_date:ea.Ro((0,ho.r)()).start_date,start_time:"09:00",reminder:{unit:"day",value:0,time:Ft.HZ,defaultTimeZone:(0,ho.r)()},time_zone:(0,ho.r)()})}:void 0]);const s=e.normalize("NFKD"),i=t?go.St(s,n):go.cg(s,n);if(i){let e=(0,po.ZV)({value:i,date_format:"relative",userTimeZone:(0,ho.r)(),intl:n,allowRelativeDates:!0});return i.reminder&&(e=n.formatMessage(sa.reminder,{dateTime:e})),[{label:e,value:()=>i}]}return[]}(e,s,t).slice(0,6):[];return i}(i,n),c=function(e,t,n){const s=Se.RM();if(!s)return[];const i=e.toLowerCase();return m.oA(n.map((e=>{const n=Ht.G.createChildStore(s,{table:Kt.iU,id:e}),o=n.getModel();if(!o)return;const a=o.getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:(0,ho.r)(),intl:t});return a&&a.toLowerCase().includes(i)?e:void 0})))}(i,n,o),p=function(e,t){const n=wi.Z.state;if(!n.open)return[];if(!n.mentionTypes.templateVariable)return[];return u.XVI(e,t)}(i,n),g=a.mentionTypes.group?function(e){var t;const n=wi.Z.state;if(!n.open)return[];const s=(null===(t=O.default.state.currentSpaceStore)||void 0===t?void 0:t.getPermissionGroups())||[];return(0,ta.ZP)(e,s,(e=>e.name||""),{normalizeFuzzyScore:!0})}(i):[];let f=l;const{result:h}=s.state;if(h&&!h.error){const e=h.value.results,t=Se.RM();f=t?na.oO({localResults:e,serverResults:l.map(((e,n)=>({...e,serverEventProperties:void 0,originalPosition:n,store:Ht.G.createChildStore(t,{table:Kt.iU,id:e.id})})))})||[]:e}let y;y=i?f.map((e=>e.id)):Js.X4.state.map((e=>e.pageId));const x=a.userRequestStore.state.ready&&a.pageRequestStore.state.ready;return x&&Ho.default.measure(e,{environment:t}),{headingResults:c,userResults:r,groupResults:g,pageResults:y,dateResults:d,templateVariableResults:p,ready:x}}function oa(e){const{query:t,renderResults:n,filterStore:s}=e,a=(0,o.qz)(void 0,ki.Z),r=(0,o.qz)(void 0,ki.Z),l=(0,i.O7)(),d=(0,ne.useIntl)(),{userRequestStore:u,pageRequestStore:m}=(0,o.VK)((()=>wi.Z.state),[]),p=Ho.default.mark("rum.mention_menu_ready"),g={field:"relevance"},f=(0,o.VK)((()=>{if(!U.default.checkGate({gateName:"mention_menu_page_headings"}))return[];const e=function(){const e=Se.RM();if(!e)return;const{mainEditorCurrentBlockStore:t}=O.default.state;if(e===t)return t;if(Xo.default.peekTargetStore.state===e)return Xo.default.peekTargetStore.state}();if(!e)return[];const t=U.default.checkGate({gateName:"toc_nested_headings"});return qo.Q(e.id,e.getRecordModel,t)}),[]),h=(0,o.VK)((()=>Pi(l,s)),[l,s]);return(0,k.jsx)(Go.Z,{requestStore:u,request:t,debounce:$o.E5,performRequest:e=>async function(e,t,n){const s=wi.Z.state;if(!s.open)return;const i=s.mentionTypes.user?await async function(e,t,n){if($s.Z.state.online){const s=await c.FF.searchActions.load();return await s.searchVisibleSpaceUsers({environment:t,query:e,membersOnly:!1,minFuzzyScore:25,placeSelfFirst:s.isPersonalPronoun(e,n)})}return[]}(e,t,n):[];return""===e?i.slice(0,2):i.slice(0,20)}(e,l,d.locale),render:e=>(0,k.jsx)(Go.Z,{requestStore:m,request:t,performRequest:e=>async function(e,t){const n=wi.Z.state;if(n.pageRequestStore.update((e=>({...e,loading:!0,ready:!1,result:void 0}))),!n.open||!e)return[];Bi.Z.update((e=>({...e,numServerRequests:e.numServerRequests+1})));const s=(0,Wo.A7)({searchSessionId:wi.Z.state.sessionId,searchSessionFlowNumber:Bi.Z.state.numServerRequests}),i=n.mentionTypes.page?await async function(e,t){if(!$s.Z.state.online)return[];const n=wi.Z.state,{numServerRequests:s}=Bi.Z.state,i=n.open&&(0,Ce.OY)(n.textStore)&&n.textStore,o=await c.FF.searchActions.load();return await o.searchMentionablePages({nearBlock:i||void 0,environment:t,query:e,source:"mention_menu",limit:20,searchSessionId:n.sessionId,searchSessionFlowNumber:s})}(e,t):[],o=(0,Wo.A7)({searchSessionId:wi.Z.state.sessionId,searchSessionFlowNumber:Bi.Z.state.numServerRequests});if(s!==o)return[];return i}(e,l),debounce:$o.vp,render:e=>(0,k.jsx)(Go.Z,{requestStore:a,request:O.default.state.currentSpaceStore&&O.default.state.currentSpaceStore.id,performRequest:()=>async function(e){const{currentSpaceStore:t,currentSpaceViewStore:n}=O.default.state;if(!t)return;if("on"===U.default.getEligibleGroup({experimentId:"use_global_local_search_cache"}))return Jo.Z.state.localSearchableBlocksCache;return(0,Qo.S)({environment:e,currentSpaceStore:t,currentSpaceViewStore:n,excludeCurrentPage:!0})}(l),render:e=>(0,k.jsx)(Go.Z,{requestStore:r,debounce:$o.E5,request:{query:{text:t,filters:zo.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,requireEditPermissions:void 0}),sort:g},limit:5},performRequest:e=>async function(e,t,n,s){const i=n.state.result;if(!i)return;const o=Se.RM();if(!o)return;if(!s)return;return Bi.Z.update((e=>({...e,numLocalRequests:e.numLocalRequests+1}))),Promise.resolve((0,Yo.Y)({query:e,localCachedPages:i,parentStore:o,isOnline:$s.Z.state.online,environment:t,shouldLimitLocalResultsWhenOnline:!1,applyScoreThresholdWhenOnline:!0,canUseLtr:!1}))}(e,l,a,h),render:e=>n(ia(p,l,d,r,t,f))})})})})}class aa extends Ii.default{getInitialState(){}}const ra=new aa,la=(0,ne.defineMessages)({noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title"}});function da(e){const{query:t,ignoreSelectionAreaStore:n,inviteTargetsStore:s,personPropertyInviteStore:i,mentionMenuCurrentMentionStore:o,filterStore:a}=e;return(0,k.jsx)(oa,{query:t,filterStore:a,renderResults:e=>(0,k.jsx)(ca,{result:e,query:t,ignoreSelectionAreaStore:n,inviteTargetsStore:s,personPropertyInviteStore:i,mentionMenuCurrentMentionStore:o})})}function ca(e){let{result:t,query:n,ignoreSelectionAreaStore:a,inviteTargetsStore:r,personPropertyInviteStore:l,mentionMenuCurrentMentionStore:d}=e;const c=(0,ne.useIntl)(),u=(0,i.O7)(),m=(0,o.VK)((()=>wi.Z.state),[]),p=(0,o.VK)((()=>$s.Z.state.online),[]),g=Boolean(m.open&&m.usePopupOnMobile),y=(0,s.useCallback)((e=>{if(!m.open)return;if(!e)return void m.temporaryInputData.setState(void 0);const{device:t}=u,{title:s,icon:i,allowTabCompletion:o}=e,a=n||"",r=s.toLowerCase().startsWith(a)?s.slice(a.length):"";ra.setState(o?r:void 0);const l=t.isFirefox?void 0:i;m.temporaryInputData.setState({prefix:m.insertionType,suffix:"[["===m.insertionType&&a.endsWith("]]")?"]]":"",completion:r,prefixIcon:l})}),[u,n,m]),v=Ao({result:t,ignoreSelectionAreaStore:a,query:n,inviteTargetsStore:r,personPropertyInviteStore:l,mentionMenuCurrentMentionStore:d,setTemporaryInputData:y}),b=(0,o.VK)((()=>Hi.Z.mobileNativeBottomPadding(u)),[u]),j=(0,X.Fg)();let C,w;if(p){const e=m.mentionTypes.user,t=m.mentionTypes.page,n=m.mentionTypes.date;let s="";const i=Fo;e&&t&&n?s=c.formatMessage(i.mentionAll):e&&t?s=c.formatMessage(i.mentionPersonPage):e&&n?s=c.formatMessage(i.mentionPersonDate):t&&n?s=c.formatMessage(i.mentionPageDate):e?s=c.formatMessage(i.mentionPerson):n?s=c.formatMessage(i.mentionDate):t&&m&&(s=m.open&&"+"===m.insertionType?c.formatMessage(Fo.addPage):c.formatMessage(i.mentionPage)),y({title:s,icon:(0,k.jsx)(so,{theme:j,insertionType:m.open?m.insertionType:"+"}),allowTabCompletion:!1}),C=void 0}else C=(0,k.jsx)(Ji.Z,{title:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Please go online to mention a person or page.",id:"mentionMenu.offlineMessage"})});0===v.length&&(w=(0,k.jsx)(Ye.Z,{children:(0,k.jsx)(Ji.Z,{title:(0,k.jsx)(ne.FormattedMessage,{...la.noResults})})}));const{device:I}=u,T=(0,o.VK)((()=>Di()),[]),Z=function(e,t){return Ri({environment:e,query:t,mentionMenuState:(0,o.VK)((()=>wi.Z.state),[]),analyticsFrom:(0,o.VK)((()=>wi.Z.getMentionMenuContext()),[])})}(u,n);let P;P=Fi({environment:u,usePopupOnMobile:g})?{menuType:x.og.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${b}px)`}:{menuType:x.og.Popup,width:T,maxHeight:I.isMobile?"30vh":"40vh",onClickOutside:Z};const F=(0,s.useCallback)((e=>{!function(e){const{event:t,environment:n}=e,s=ra.state;if(t.preventDefault(),!s)return;const i=M.default.state;if("editing"!==i.mode)return;const o=(0,S.QY)(i.multiSelection);if(!o)return;const a=wi.Z.state;if(!a.open||a.textStore!==o.store)return;f.createAndCommit({userAction:"MentionMenu.handleTab",environment:n,perform:e=>{Bt.hJ({environment:n,editorMode:"default",transaction:e,string:s,store:o.store,selection:o.selection,disableMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0})}})}({event:e,environment:u})}),[u]);return(0,k.jsxs)(h.Z,{...P,header:C,children:[(0,k.jsx)(Ze.Z,{debugName:"MentionMenu",capture:m.open,onBackspace:e=>ma(n)?function(e,t,n,s){ma(n)&&e.preventDefault();s()}(e,0,n,Z):void 0,onTab:F}),(0,k.jsx)($e.Z,{type:$e.i.Vertical,initialFocus:ua(u,n),sections:v,onEmptyEnter:Z,resetInitialFocusOnSectionChange:!0}),w]})}function ua(e,t){if(""!==t)return 0}function ma(e){return""===e}class pa extends xi.Z{constructor(){super(...arguments),this.storeTypes={ignoreSelectionAreaStore:ji.Z,localPageMentionRequestStore:ki.Z,inviteTargetsStore:Ci.ZP,personPropertyInviteStore:Mi.Z,mentionMenuCurrentMentionStore:Zi},this.inputSelectionsStore=this.createComputedStore((()=>{const e=wi.Z.state;if(e.open)return v.O2(e.textStore,e.oldTextValue,e.isEmptyPageTitle?"":e.insertionType)})),this.filterStore=this.createComputedStore((()=>{const e=this.inputSelectionsStore.state,t=wi.Z.state;if(e&&t.open)return v.ug(t.textStore,e)})),this.popupOpenStore=this.createComputedStore((()=>{const e=wi.Z.state;return!!e.open&&("+"!==e.insertionType||""!==Pi(this.environment,this.filterStore))}))}UNSAFE_willMountOrUpdate(){const e=wi.Z.state,t=this.filterStore.state;if(e.open){var n;const s=M.default.state,i="editing"===s.mode?(0,S.QY)(s.multiSelection):void 0,o=(null==i?void 0:i.store)===e.textStore,a=this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,r=a&&"editing"===a.mode&&(null===(n=(0,S.QY)(a.multiSelection))||void 0===n?void 0:n.store)===e.textStore;if(!o&&!r)return void Si.xv();const l=o&&(null==i?void 0:i.selection),d=this.inputSelectionsStore.state;if(d&&l&&(l.startIndex<d.filter.startIndex||l.endIndex>d.filter.endIndex))return void Si.xv();const c=this.filterStore.state&&this.filterStore.state[0];if("+"===e.insertionType&&c&&!c.match(bi.Ff))return void Si.xv();if(void 0===t&&!e.isEmptyPageTitle)return void Si.xv()}}renderComponent(){const{device:e}=this.environment,t=wi.Z.state,n=vi.Z.find((e=>e.props.capture)),s=this.popupOpenStore.state;let i;if(n&&e.isMobile){var o;const e=null===(o=n.stores.store.state.node)||void 0===o?void 0:o.getBoundingClientRect();e&&(i={height:`calc(100vh - ${e.height}px)`})}const a=t.open&&t.showCreateIn,r=t.open&&t.showInvite,l=t.open&&t.showMentionAndShare,d=Boolean(t.open&&t.usePopupOnMobile),c=Fi({environment:this.environment,usePopupOnMobile:d}),u=c?b.k.SlideUp:b.k.Popup,m=Pi(this.environment,this.filterStore);return(0,k.jsx)(y.ZP,{popupType:u,open:s,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:i,placementToOrigin:y.ZP.Placement.Bottom,alignmentToOrigin:y.ZP.Alignment.Start,originGap:8,disableMouseCapture:!r,disableContentScroll:!0,onDismiss:Ri({environment:this.environment,query:m,mentionMenuState:wi.Z.state,analyticsFrom:wi.Z.getMentionMenuContext()}),disableDarkOverlayBackground:e.isMobile,keepFocus:!0,render:()=>e.isMobile?(0,k.jsxs)(k.Fragment,{children:[!l&&(0,k.jsx)(da,{query:m,filterStore:this.filterStore,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,inviteTargetsStore:this.stores.inviteTargetsStore,personPropertyInviteStore:this.stores.personPropertyInviteStore,mentionMenuCurrentMentionStore:this.stores.mentionMenuCurrentMentionStore}),(0,k.jsx)(y.ZP,{popupType:b.k.SlideUp,render:()=>(0,k.jsx)(Oi,{ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,filterStore:this.filterStore}),open:a,keepFocus:!0}),(0,k.jsx)(y.ZP,{popupType:b.k.SlideUp,render:()=>(0,k.jsx)(Ni,{ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,inviteTargetsStore:this.stores.inviteTargetsStore,personPropertyInviteStore:this.stores.personPropertyInviteStore,filterStore:this.filterStore}),open:r,keepFocus:!0}),(0,k.jsx)(y.ZP,{popupType:u,render:()=>(0,k.jsx)(Qi,{mentionMenuCurrentMentionStore:this.stores.mentionMenuCurrentMentionStore,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,menuPopupType:c?x.og.ActionSheet:x.og.Popup}),open:l,keepFocus:!0,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:i,placementToOrigin:y.ZP.Placement.Bottom,alignmentToOrigin:y.ZP.Alignment.Start,originGap:8,isFullWidthOnMobile:!0})]}):a?(0,k.jsx)(Oi,{ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,filterStore:this.filterStore}):r?(0,k.jsx)(Ni,{ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,inviteTargetsStore:this.stores.inviteTargetsStore,personPropertyInviteStore:this.stores.personPropertyInviteStore,filterStore:this.filterStore}):l?(0,k.jsx)(Qi,{mentionMenuCurrentMentionStore:this.stores.mentionMenuCurrentMentionStore,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,menuPopupType:x.og.Popup}):(0,k.jsx)(da,{query:m,filterStore:this.filterStore,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,inviteTargetsStore:this.stores.inviteTargetsStore,personPropertyInviteStore:this.stores.personPropertyInviteStore,mentionMenuCurrentMentionStore:this.stores.mentionMenuCurrentMentionStore})})}}pa.displayName="MentionMenu";const ga=(0,ne.injectIntl)(pa);var fa=n(42239);const ha=function(){const e=(0,i.O7)(),t=(0,s.useRef)(void 0);return(0,s.useEffect)((()=>{const n=t=>{t.preventDefault(),function(e,t){const n=fa.f$(t,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0});n&&kn.ZH({debug:{userAction:"NativeDragHandler.startDrag"},environment:t})}(t,e),s(t)},s=m.P2((n=>{t.current&&window.clearTimeout(t.current),t.current=window.setTimeout(xa,function(e){const{device:t}=e;return t.isLinux?2e3:200}(e),e),fa.td(e,{currentX:n.clientX,currentY:n.clientY})}),ya),i=t=>{!function(e,t){e.preventDefault();const n=Array.from(e.dataTransfer.files);n.length>0&&fa._4({environment:t,files:n,analyticsFrom:"native_drag"})}(t,e)};return window.addEventListener("dragover",n),window.addEventListener("drop",i),()=>{window.removeEventListener("dragover",n),window.removeEventListener("drop",i)}}),[e]),null},ya=62.5;function xa(e){fa.cQ(e)}var Sa=n(340902),va=n(865311),ba=n(519719),Ma=n(608055),ja=n(150770),Ca=n(819034),wa=n(112252);class ka extends xi.Z{constructor(){super(...arguments),this.lastEmitValue=-1,this.lastSentBadgeNumber=void 0,this.lastSentCurrentSpaceBadgeNumber=void 0,this.handleNotificationEmit=async(e,t)=>{if(t===this.lastEmitValue)return;if(this.lastEmitValue=t,!function(e){if(0===Ca.Z.state.results.length)return!0;if(!document.hasFocus())return!0;if(!e.includes("unreadCount"))return!0;return!1}(String(t)))return;const n=(0,ja.tO)(this.environment),s=await R.getUserNotifications(this.environment,{size:1e3,isInboxV2:n});if("failed"===s.type)return;const{results:i}=s.data;Ca.Z.setState({results:i}),this.syncInitialBadgeNumber();const o=m.G0.apply(null,i.map((e=>e.unreceived.notificationIds)));for(const a of o)Za(a,this.props.rootStore,this.props.intl,this.environment)},this.handleNotificationEmitThrottled=m.P2(this.handleNotificationEmit,1e3),this.handleNotificationEmitWhenActive=(e,t)=>{wa.Z.whenActive((()=>{this.handleNotificationEmitThrottled(e,t)}))},this.listenerReference=void 0,this.updateBadgeNumbers=()=>{const{mobileNative:e}=this.environment,{allSpaces:t,currentSpace:n}=Ta();e&&(t===this.lastSentBadgeNumber&&n===this.lastSentCurrentSpaceBadgeNumber||e.setBadgeNumber(t,n),this.lastSentCurrentSpaceBadgeNumber=n),t!==this.lastSentBadgeNumber&&(t>0?a.setBadge(`${t}`):a.setBadge("")),this.lastSentBadgeNumber=t},this.syncInitialBadgeNumber=m.IH(this.updateBadgeNumbers)}UNSAFE_willMount(){this.startMessageListeners(),Ca.Z.addListener(this.updateBadgeNumbers),this.environment.mobileNative&&O.default.addListener(this.updateBadgeNumbers)}didUpdate(e){e.rootStore.userId!==this.props.rootStore.userId&&(this.stopMessageListeners(),this.startMessageListeners(),this.handleNotificationEmit("initializeListener",-1))}willUnmount(){this.stopMessageListeners(),Ca.Z.removeListener(this.updateBadgeNumbers),this.environment.mobileNative&&O.default.removeListener(this.updateBadgeNumbers)}startMessageListeners(){const{currentUserStore:e}=O.default.state;if(e){const t=(0,G.Lp)(e.id);this.listenerReference=H.ZP.addListener(t,this.handleNotificationEmitWhenActive,void 0,this.environment)}}stopMessageListeners(){this.listenerReference&&H.ZP.removeListener(this.listenerReference,this.environment)}}ka.displayName="NotificationListener";const Ia=(0,ne.injectIntl)(ka);function Ta(){return{allSpaces:Ca.Z.getTotalUnreadMentionsCount(),currentSpace:Ca.Z.getUnreadCountForCurrentSpace().mentions}}async function Za(e,t,n,s){const i=(0,Ht.Kv)(t,{table:va.uX,id:e});await i.load();const o=i.getValue();if(!o)return;const r=(0,Ce.No)(i,o.activity_id,o.space_id);await r.load();const l=r.getModel(),{currentUserStore:u,currentSpaceViewStore:m}=O.default.state;if(u&&m&&l&&!l.invalid&&!Sa.BX(l,u.id)&&await a.isMainTabOrWindow()&&"undefined"!=typeof Notification){if(await m.load(),!m.isDefined())return;if(!l.isMentionType())return;if(!m.getNotifyDesktop())return;if(!s.device.isDesktop)return;const e=(0,(await c.FF.desktop.load()).Notification)({activity:l,getRecordValue:i.getRecordValue,userTimeZone:(0,ho.r)(),intl:n,pageVisitSource:uo.tY.PushNotification});if(!e)return;const{subject:t,body:o}=e,a=new Notification(t,{body:o,silent:!0}),u=Sa.Fb(l.type),p={medium:"desktop_push",type:u,badge_number:Ta().allSpaces,notification_id:i.id,activity_id:r.id},g=e=>ba.b2({environment:s,args:p,action:e});g("sent"),a.addEventListener("show",(()=>g("shown"))),a.addEventListener("close",(()=>g("closed"))),a.addEventListener("click",(()=>{const e=Sa.hY({activity:l,getRecordModel:i.getRecordModel,baseUrl:d.default.domainBaseUrl,pageVisitSource:uo.tY.PushNotification}),t=(0,uo.k6)(e,[u,"desktop_push"],uo.tY.PushNotification);Ma.c4({environment:s,url:t}),g("clicked")}))}}var Pa=n(783105),Fa=n(389224),_a=n(58261);const Aa=function(){const e=(0,i.O7)(),t=(0,o.VK)((()=>{const e=M.default.state;if("editing"!==e.mode)return null;const t=(0,S.QY)(e.multiSelection);if(!t)return null;const{store:n,selection:s}=t;if(s.endIndex!==s.startIndex+1)return null;const i=n.getValue(),o=u.b1T(i,s.startIndex);if(!o||!u.eOb(o))return null;const[a]=u.jDe([o]);return{pageId:a,store:n}}),[]),n=(0,s.useCallback)((()=>(0,k.jsx)(Ba,{pageMentionTokenStoreState:t})),[t]);if(e.device.isMobile)return null;const a=Fa.getSelectionRect();return(0,k.jsx)(me.Z,{render:()=>{},renderTooltip:n,originRect:a,forceVisibleState:Boolean(t&&a),placement:de.u.Bottom})};function Ba(e){let{pageMentionTokenStoreState:t}=e;const n=(0,X.Fg)(),o=(0,i.O7)(),a=(0,s.useCallback)((e=>function(e,t,n){if(!n)return;const{pageId:s,store:i}=n;if(!s)return;e.preventDefault();const o=Ht.G.createChildStore(i,{table:Kt.iU,id:s});vo._c({store:o,environment:t,visitType:Pa.vu.Link,openInNew:"tab",pageVisitSource:uo.tY.MentionInPage})}(e,o,t)),[o,t]),r=(0,s.useCallback)((e=>function(e,t,n){if(!n)return;const{pageId:s,store:i}=n;if(!s)return;e.preventDefault&&e.preventDefault();const o=Ht.G.createChildStore(i,{table:Kt.iU,id:s});vo._c({store:o,environment:t,visitType:Pa.vu.Link,pageVisitSource:uo.tY.MentionInPage})}(e,o,t)),[o,t]);return(0,k.jsx)(Ze.Z,{debugName:"PageMentionOverlay",capture:!0,onEnter:r,onCommandEnter:a,children:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),(0,k.jsx)("div",{children:(0,k.jsx)(_a.Z,{onlyShowFirst:!0,name:"enter",style:{color:n.mediumInvertedTextColor}})})]})})}var Ra=n(443008),Da=n(264951);function Oa(){const e=(0,ne.useIntl)(),t=(0,X.Fg)(),n=(0,i.O7)(),{device:a}=n,r=(0,o.VK)((()=>Da.Z.state.blockStore),[]),l=(0,o.VK)((()=>null==r?void 0:r.getTitleStore()),[r]),d=(0,o.VK)((()=>(null==r?void 0:r.canEdit())??!1),[r]);if((0,s.useEffect)((()=>{const{blockStore:e}=Da.Z.state;if(!e)return;const t=e.getTitleStore();t&&oe.mT({environment:n,store:t,canSelectAllBlocks:!1})}),[n]),!r||!l)return null;let c;return c=a.isMobile?{menuType:x.og.ActionSheet}:{menuType:x.og.Popup,width:380},(0,k.jsx)(h.Z,{...c,children:(0,k.jsx)("div",{style:Va(t),children:(0,k.jsx)(pe.Z,{store:l,disabled:!d,onEsc:()=>Ra.x(n),onEnter:()=>Ra.x(n),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:e.formatMessage({defaultMessage:"Untitled",id:"renameFileMenuPopup.input.placeholder"}),style:Ea(t),pasteBehavior:"inline",inPageFind:re.B3.none})})})}const La=function(){const e=(0,i.O7)(),{device:t}=e,{blockStore:n,originRect:s}=(0,o.VK)((()=>{const{blockStore:e,originRect:t}=Da.Z.state;return{blockStore:e,originRect:t}}),[]);return(0,k.jsx)(y.ZP,{popupType:t.isMobile?b.k.SlideUp:b.k.Popup,open:Boolean(n),originRect:s,placementToOrigin:y.ZP.Placement.Bottom,alignmentToOrigin:y.ZP.Alignment.Center,originGap:4,onDismiss:()=>Ra.x(e),render:()=>(0,k.jsx)(Oa,{})})};function Va(e){return{display:"flex",alignItems:"center",color:e.regularTextColor,fontSize:"13px",padding:"4px 8px"}}function Ea(e){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}}var Na=n(552771),Ua=n(682187),Ka=n(731278);function Wa(e){const t=(0,ne.useIntl)(),n=(0,i.O7)(),{device:a}=n,r=(0,o.VK)((()=>Ua.Z.state.clonedBlockStore),[]),l=(0,o.VK)((()=>null==r?void 0:r.getTitleStore()),[r]),d=(0,o.VK)((()=>(null==r?void 0:r.canEdit())??!1),[r]),c=(0,o.VK)((()=>{var e;if(r)return null===(e=r.getModel())||void 0===e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:r.getRecordModel,userTimeZone:(0,ho.r)(),intl:t})}),[r,t]);(0,s.useEffect)((()=>{if(!r)return;const e=r.getTitleStore();e&&oe.mT({environment:n,store:e,canSelectAllBlocks:!1})}),[r,n]);const u=(0,X.yK)((e=>({wrapper:{display:"flex",alignItems:"center",color:e.regularTextColor,fontSize:"13px",padding:"4px 8px"},input:{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}})),[]);if(!r||!l)return null;const{renderDelete:m}=e;let p;return p=a.isMobile?{menuType:x.og.ActionSheet}:{menuType:x.og.Popup,width:380},(0,k.jsx)(h.Z,{...p,children:(0,k.jsxs)("div",{style:u.wrapper,children:[(0,k.jsx)(Ha,{blockStore:r}),(0,k.jsx)(pe.Z,{store:l,disabled:!d,onEsc:()=>Na.x(n),onEnter:()=>Na.x(n),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,placeholder:c,style:u.input,pasteBehavior:"inline",inPageFind:re.B3.none}),m&&d&&(0,k.jsx)(qa,{})]})})}const za=function(){const e=(0,i.O7)(),{device:t}=e,{clonedBlockStore:n,originRect:s}=(0,o.VK)((()=>{const{clonedBlockStore:e,originRect:t}=Ua.Z.state;return{clonedBlockStore:e,originRect:t}}),[]);return(0,k.jsx)(y.ZP,{popupType:t.isMobile?b.k.SlideUp:b.k.Popup,open:Boolean(n),originRect:s,placementToOrigin:y.ZP.Placement.Bottom,alignmentToOrigin:y.ZP.Alignment.Center,originGap:4,onDismiss:()=>Na.x(e),render:()=>(0,k.jsx)(Ga,{})})};function qa(){const e=(0,i.O7)();return(0,k.jsx)(ue.Z,{ariaLabel:"Delete",icon:e=>(0,Xs.y)({height:20,width:20,...e}),style:{marginLeft:6},hasBackground:!0,isDarkIconColor:!0,showShadow:!0,onClick:async()=>{const{originalBlockStore:t}=Ua.Z.state;t&&await wn.Qw({environment:e,blocks:[t],shouldCheckSuggestEdit:!0}),Na.x(e)}})}function Ga(){const e=(0,o.VK)((()=>Ua.Z.state.renderDelete),[]);return(0,k.jsx)(Wa,{renderDelete:Boolean(e)})}function Ha(e){let{blockStore:t}=e;const n=(0,X.Fg)(),s=(0,i.O7)(),a={width:28,height:28,marginRight:6,flexShrink:0,flexGrow:0,boxShadow:`inset 0 0 0 1px ${n.darkDividerColor}`},r=(0,o.VK)((()=>t.canEdit()),[t]),l=(0,o.VK)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.table}),[t]),d=(0,o.VK)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.id}),[t]),c=(0,o.VK)((()=>t.getIcon()),[t]),u=(0,o.VK)((()=>t.isEmptyPage()),[t]),m=(0,o.VK)((()=>t.getType()),[t]);return r?(0,k.jsx)(Ka.Z,{disabled:!1,bucket:"secure",store:t,icon:c,isEmptyPage:u,size:18,style:a,iconLoggingData:{recordTable:l,source:"breadcrumb",block_type:m,collection_id:"collection"===l?d:void 0},onChange:e=>function(e,t){const{clonedBlockStore:n}=Ua.Z.state;if(n){const s=n.getIconStore();s&&f.createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:t,perform:t=>{vt.sO({store:s,value:e,transaction:t})}})}}(e,s)}):(0,k.jsx)(Ka.Z,{disabled:!0,icon:c,isEmptyPage:u,size:18,style:a})}var $a=n(797511),Ya=n(180951);const Qa=(0,fn.IU)("bold",{viewBox:"0 0 16 16",svg:(0,k.jsx)("g",{children:(0,k.jsx)("path",{d:"M5.067 13.014c-.772 0-1.223-.451-1.223-1.238V4.36c0-.786.45-1.237 1.223-1.237h3.5c1.949 0 3.131.943 3.131 2.488 0 1.1-.793 1.97-1.948 2.12v.061c1.401.068 2.4 1.046 2.4 2.386 0 1.716-1.347 2.837-3.466 2.837H5.067zm1.238-5.81h1.34c1.025 0 1.633-.459 1.633-1.225 0-.738-.553-1.168-1.483-1.168h-1.49v2.392zm0 4.142h1.6c1.148 0 1.742-.472 1.742-1.347 0-.854-.642-1.32-1.804-1.32H6.305v2.667z"})})});var Ja=n(542853),Xa=n(709107),er=n(269634);const tr=(0,fn.IU)("italic",{viewBox:"0 0 16 16",svg:(0,k.jsx)("g",{children:(0,k.jsx)("path",{d:"M5.02 13.014c-.397 0-.67-.24-.67-.63 0-.382.266-.614.663-.614H6.42l1.593-7.404H6.612c-.396 0-.67-.239-.67-.629 0-.383.267-.615.663-.615h4.382c.397 0 .663.232.663.615 0 .39-.273.63-.67.63H9.586l-1.6 7.403h1.409c.396 0 .663.232.663.615 0 .39-.274.629-.67.629H5.02z"})})});var nr=n(727714);const sr=(0,fn.IU)("strikethrough",{viewBox:"0 0 16 16",svg:(0,k.jsx)("g",{children:(0,k.jsx)("path",{d:"M7.973 13.191a5.695 5.695 0 01-1.75-.253 3.694 3.694 0 01-1.306-.71 2.376 2.376 0 01-.71-1.101 1.514 1.514 0 01-.062-.424c0-.205.061-.369.184-.492a.71.71 0 01.513-.185c.155 0 .28.034.376.103a.92.92 0 01.273.328c.128.296.31.554.547.772.237.215.52.379.848.493.328.114.69.17 1.087.17.45 0 .847-.066 1.19-.198.345-.136.614-.321.806-.553.196-.237.294-.506.294-.807 0-.383-.15-.688-.451-.916-.301-.232-.796-.43-1.484-.595L7.043 8.53c-.939-.21-1.636-.528-2.092-.957-.451-.433-.677-.998-.677-1.695 0-.574.158-1.082.472-1.524.32-.443.757-.787 1.313-1.033.556-.25 1.191-.376 1.907-.376.601 0 1.148.09 1.64.267.497.173.91.415 1.238.725.328.31.547.67.656 1.08a.82.82 0 01.034.177c.01.055.014.11.014.164a.625.625 0 01-.185.472c-.123.119-.29.178-.499.178-.287 0-.506-.132-.656-.397a2.244 2.244 0 00-.506-.745 1.98 1.98 0 00-.752-.458 2.897 2.897 0 00-.984-.157c-.406 0-.766.064-1.08.191a1.742 1.742 0 00-.745.527 1.233 1.233 0 00-.267.78c0 .36.148.648.444.867.301.214.784.399 1.45.554l1.169.267c1.016.227 1.756.553 2.221.977.47.42.704.998.704 1.736 0 .611-.162 1.147-.485 1.607-.32.456-.77.809-1.354 1.06-.578.25-1.262.375-2.05.375zM2.552 8.386a.363.363 0 01-.267-.11.378.378 0 01-.11-.266c0-.1.037-.187.11-.26a.352.352 0 01.267-.116h10.89c.104 0 .193.039.266.116.073.073.11.16.11.26s-.037.189-.11.266a.363.363 0 01-.267.11H2.551z"})})}),ir=(0,fn.IU)("underline",{viewBox:"0 0 16 16",svg:(0,k.jsx)("g",{children:(0,k.jsx)("path",{d:"M8 13.191c-.843 0-1.572-.152-2.188-.458a3.46 3.46 0 01-1.421-1.292c-.333-.551-.5-1.191-.5-1.92V3.724c0-.242.071-.431.213-.568.14-.141.33-.212.567-.212.246 0 .44.071.58.212.147.137.22.326.22.568v5.653c0 .488.098.914.294 1.278.2.36.49.64.868.841.378.2.834.3 1.367.3.798 0 1.417-.22 1.86-.662.446-.442.67-1.028.67-1.757V3.724c0-.242.07-.431.211-.568.142-.141.33-.212.568-.212.246 0 .44.071.58.212.147.137.22.326.22.568V9.52c0 .729-.167 1.369-.5 1.92-.332.552-.809.982-1.428 1.292-.616.306-1.342.458-2.181.458zm-3.623 2.174a.487.487 0 01-.349-.136.464.464 0 01-.136-.342c0-.137.045-.25.136-.342a.487.487 0 01.349-.137h7.24c.14 0 .257.046.348.137a.453.453 0 01.143.342c0 .136-.048.25-.143.341a.472.472 0 01-.349.137H4.377z"})})});var or=n(606287),ar=n(380503),rr=n(646564),lr=n(811732),dr=n(756863),cr=n(492022),ur=n(352823);function mr(e){const{clientSkill:t}=e,n=(0,ne.useIntl)(),s=(0,o.VK)((()=>n.formatMessage(t.displayName)),[t,n]);return(0,k.jsx)(k.Fragment,{children:s})}var pr=n(183583),gr=n(144500),fr=n(740350),hr=n(164921),yr=n(18821);function xr(e){const t=(0,i.O7)(),{isMobile:n}=(0,i.Fy)(),o=(0,s.useRef)(null),a=(0,X.yK)((e=>({shortcut:{color:e.mediumInvertedTextColor}})),[]),r=()=>{const n=M.default.state;"empty"!==n.mode&&yr.Bf({environment:t,blockStore:e.blockStore,multiSelection:n.multiSelection})};return(0,k.jsx)(me.Z,{renderTooltip:()=>(0,k.jsxs)(s.Fragment,{children:[(0,k.jsx)("div",{children:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"React to selected text",id:"inlineReactionButton.tooltip"})}),(0,k.jsx)("div",{children:(0,k.jsx)(_a.Z,{style:a.shortcut,name:"react"})})]}),render:t=>(0,k.jsxs)(hr.Z,{ref:o,style:{display:"flex",alignItems:"center",padding:e.iconOnly?6:"0 10px",whiteSpace:"nowrap",...e.style},disabled:e.disabled,disabledFeedback:e.disabled,onClick:r,...t,children:[(0,fr.V)({width:n?18:16,height:n?18:16,marginTop:n?0:1,marginRight:e.iconOnly?0:4}),!n&&!e.iconOnly&&(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"React",id:"inlineReactionButton.reactLabel"})]})})}xr.displayName="InlineReactionButton";const Sr=xr;var vr=n(849117),br=n(319124),Mr=n(840959),jr=n(787078),Cr=n(745162),wr=n(450627),kr=n(785957),Ir=n(635328),Tr=n(116746),Zr=n(415723),Pr=n(521273),Fr=n(990827),_r=n(400807),Ar=n(845214),Br=n(417903),Rr=n(304548),Dr=n(542057),Or=n(249557),Lr=n(904935),Vr=n(599757),Er=n(13966),Nr=n(748019),Ur=n(231945),Kr=n(764131),Wr=n(982945),zr=n(743590),qr=n(850799);function Gr(e){const t=(0,i.O7)(),{isMobile:n}=(0,i.Fy)(),a=(0,o.VK)((()=>"suggest"===_r.Z.getMode(e.blockStore)),[e.blockStore]),r=()=>{qr.t({environment:t,blockStore:e.blockStore,mode:a?"default":"suggest",location:"rich_text_menu"})},l=(0,X.yK)((t=>({button:{display:"flex",alignItems:"center",padding:e.iconOnly?6:"0 10px",whiteSpace:"nowrap",color:a?t.blueColor:t.text.secondary,...e.style},icon:{width:n?18:16,height:n?18:16,marginTop:n?0:1,marginRight:e.iconOnly?0:4}})),[n,a,e.iconOnly,e.style]);return(0,k.jsx)(me.Z,{renderTooltip:()=>(0,k.jsxs)(s.Fragment,{children:[(0,k.jsx)("div",{children:a?(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Turn off suggesting",id:"inlineSuggestButton.tooltipDisable"}):(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Suggest edits",id:"inlineSuggestButton.tooltipEnable"})}),(0,k.jsx)("div",{})]}),render:t=>(0,k.jsxs)(hr.Z,{style:l.button,disabled:e.disabled,disabledFeedback:e.disabled,onClick:r,...t,children:[(0,zr.I)(l.icon),!n&&!e.iconOnly&&(a?(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Suggesting",id:"inlineSuggestButton.suggestingLabel"}):(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Suggest",id:"inlineSuggestButton.suggestLabel"}))]})})}var Hr=n(40464),$r=n(432404),Yr=n(273383);const Qr={[Me.Ti.code]:new Set(["showCode","showCompletions"]),[Me.Ti.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[Me.Ti.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"])},Jr={[Me.Ti.factory]:!0},Xr=36,el=60;const tl=function(){const e=(0,$a.l)(),t=(0,i.O7)(),n=(0,i.Fy)(),a=(0,o.VK)((()=>Or.Z.state),[]),{isActive:r,blockTarget:l,isAnimatingClosed:d}=a,c=(0,o.VK)((()=>{const t=l,n=M.default.state;if(!r||"empty"===n.mode)return;const{multiSelection:s}=n,i=(0,Cr.L5)(s),o=i.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()})),a=(0,S.qS)(s),d=M.default.isEditingComment(),c=M.default.isEditingCaption(),u=t&&t.getParentTable()===or.vF,m=a&&t&&s.start.store===t.getCollectionViewSourceDescriptionStore(),p=kr.Tx(),g=e&&e.publicEditModeStore.state,f=!(0,jo.YF)(g)&&(s.start.store.canEdit()&&s.end.store.canEdit()),h=U.default.checkGate({gateName:"human_suggested_edits"}),y=h&&t&&"suggest"===_r.Z.getMode(t),x=U.default.checkGate({gateName:"block_reactions"}),v=o.some(((e,t)=>{const n=i[t].store.table===vn.x_&&!i[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n})),b=f&&!v,j=t&&t.getType(),C=j&&Qr[j],w=null==t?void 0:t.isType("button"),k=(0,vr.td)(s.start.store)||(0,vr.td)(s.end.store),I=U.default.checkGate({gateName:"collections_inline_text_property_comment"});let T=!1;const Z=W.Z.state.isOpen?W.Z.state:z.Z.state.isOpen?z.Z.state:void 0;if(Z){const e=Z.store.getParentStore();if((null==e?void 0:e.table)===or.vF){const t=e.getSchema(),n=Z.property,s=(0,Ya.Qm)({schema:t,property:n});"text"!==(null==s?void 0:s.type)||s.ai_inference||(T=!0)}}const P={isSingleStoreSelection:a,showTurnInto:Boolean(a&&!d&&!u&&!m&&!c&&t&&b&&!w&&!y),showBold:Boolean(b),showItalic:Boolean(b),showStrikethrough:Boolean(b),showUnderline:Boolean(b),showCode:Boolean(b),showLink:Boolean(a&&b),showHighlight:Boolean(b),showDiscuss:Boolean(!d&&t&&(I&&T||!u)&&!m&&!k),showReact:Boolean(x&&!d&&t&&!u&&!m&&!k),showSuggest:Boolean(h&&!d&&t&&!u&&!m&&!k&&!p&&!v),showEquation:Boolean(a&&b&&!y),showActionButton:Boolean(a&&!d&&!c&&t&&!u),targetBlockStore:t,isComment:d,showCompletions:Boolean((0,br.GD)(g)&&b&&!d&&!c&&t&&!u&&!m&&!w&&!k&&!y)};if(C&&C.size>0)for(const e of C)P[e]=!1;return P}),[l,r,e]),[u,p]=(0,s.useState)(c);(0,s.useEffect)((()=>{c&&p(c)}),[c]);const g=(0,o.VK)((()=>t.WindowSizeStore.state.height),[t.WindowSizeStore]),f=(0,o.VK)((()=>c&&c.showDiscuss&&!c.showBold),[c]),h=(0,s.useCallback)((()=>{if(Vs.Z.state.open||Lr.Z.state.open)return;if(Vr.n.state)return dr.w();const e=M.default.state;if("empty"===e.mode)return dr.w();const s=(0,Cr.L5)(e.multiSelection);if(0===s.length)return dr.w();if(!s.every((e=>{let{store:t}=e;return t.table===Kt.iU||t.table===vn.x_||t.table===or.vF})))return dr.w();if(!t.currentUser.isLoggedIn()||!s.every((e=>{let{store:t}=e;return t.canComment()})))return;const i=Fa.get();if(Se.JE())return dr.w();if(s.some((e=>{let{editable:t}=e;return t.props.disableStyleAnnotations})))return dr.w();const o=s.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()}));if(U.default.checkGate({gateName:"prevent_edits_trash"})&&o.some((e=>e&&e.pathIsDead())))return dr.w();if(o.some((e=>e&&(0,Fr.Eo)(e))))return dr.w();if(o.some(((e,t)=>{const n=s[t].store.canComment(),i=s[t].store.table===vn.x_&&s[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n||i})))return dr.w();const r=s.some((e=>{let{store:t}=e;const n=t.getRecordStoreAtRootPath();if(!(n instanceof Ht.G))return!1;const s=n.getValue();return!!s&&Jr[s.type]}));if(r)return dr.w();const l=i?Fa.getRect(i):void 0;if(l&&!Zr.kK(l,(0,jr.Z)()))return dr.w();if(Ua.Z.isActive()||Da.Z.isActive()||ys.Z.isOpen()||r||Tr.Z.isPeekDismissableState()||!i||!function(){const e=Fa.get();return!!e&&!e.collapsed&&"empty"!==M.default.state.mode&&!(0,S.iG)(M.default.state.multiSelection)}()||Ar.Z.state.open)return dr.w();let d=0,c=0;if(l){d=l.left;const e=25,t=l.top-Xr-e,s=ar.R6(n.isElectronMac),i=g-Xr-e;c=Math.min(Math.max(t,s),i)}0===Math.abs(Or.Z.state.top-c)&&Math.abs(Or.Z.state.left-d)<10&&(c=Or.Z.state.top,d=Or.Z.state.left),Or.Z.setState({...a,isActive:!0,isAnimatingClosed:!1,top:c,left:d,blockTarget:Ge.default.state.stores[0]})}),[t.currentUser,g,n.isElectronMac,a]),y=(0,s.useMemo)((()=>m.P2(h,200,{leading:!1})),[h]);(0,s.useEffect)((()=>(Ge.default.addListener(y),M.default.addListener(y),Br.Z.addListener(h),Dr.Z.addListener(h),Rr.Z.addListener(h),Tr.Z.addListener(h),()=>{M.default.removeListener(y),Ge.default.removeListener(y),Br.Z.removeListener(h),Dr.Z.removeListener(h),Rr.Z.removeListener(h),Tr.Z.removeListener(h)})),[h,y]);const x=(0,o.VK)((()=>function(e){const t=null==e?void 0:e.getParentStore();if((null==t?void 0:t.table)===Kt.iU)return!!t&&(0,wr.Wt)(t);return!1}(l)),[l]),v=(0,s.useCallback)((()=>{a.isActive||Or.Z.setState({...a,isAnimatingClosed:!1}),p(c)}),[a,c]);return(0,k.jsx)(_n.Z,{open:r||d,children:(0,k.jsx)(nl,{handleAnimationEnd:v,isActive:r,isExternallyImportedAndSyncedCollectionPageBlockTarget:x,lastRenderState:u,richTextMenuStoreState:a,canOnlyDiscuss:f})})};function nl(e){let{handleAnimationEnd:t,isActive:n,isExternallyImportedAndSyncedCollectionPageBlockTarget:s,lastRenderState:i,richTextMenuStoreState:o,canOnlyDiscuss:a}=e;return(0,k.jsx)(Fn.Z,{isVisible:n&&!s,enterAnimationStyle:{opacity:0,scale:.98},animationStyle:{opacity:1,scale:1},exitAnimationStyle:{opacity:0,scale:.98},render:()=>function(e){let{lastRenderState:t,richTextMenuStoreState:n,canOnlyDiscuss:s}=e;const{top:i,left:o}=n,a=Math.max(s?o:o-el,0),r=s?"12px 0":12;return(0,k.jsxs)("div",{className:We.Qcf,style:{pointerEvents:"none",position:"absolute",top:i,left:0,display:"flex",width:"100%"},children:[(0,k.jsx)("div",{style:{flexShrink:1,width:a,minWidth:24}}),(0,In.Z)((e=>(0,k.jsx)("div",{style:{pointerEvents:"none",padding:r},...e,children:t&&(0,k.jsx)(yl,{renderState:t})}))),(0,k.jsx)("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}})]})}({lastRenderState:i,richTextMenuStoreState:o,canOnlyDiscuss:a}),onAnimationEnd:t,animationConfig:{durationMS:120}})}function sl(e){let{theme:t,styles:n}=e;return(0,k.jsx)("div",{style:{height:24,width:1,borderRight:`1px solid ${t.regularDividerColor}`,margin:"auto 6px",...n}})}function il(e){let{blockStore:t}=e;const n=(0,X.Fg)(),s=(0,i.O7)(),a=(0,ne.useIntl)();let r=(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const l=(0,o.VK)((()=>t.getType()),[t]);if(l){const e=Mr.Hc[l];r=e&&e.displayName||r}return(0,k.jsx)(Ur.ZP,{popupType:Ur.Z4.Popup,buttonPopupStore:Lr.Z,originGap:4,renderOrigin:e=>(0,k.jsx)(me.Z,{renderTooltip:()=>a.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:t=>(0,k.jsxs)(hr.Z,{style:{display:"flex",alignItems:"center",paddingLeft:7,paddingRight:6,whiteSpace:"nowrap",color:n.text.secondary,borderRadius:6},...(0,Mo.Z)(e,t),children:[r,(0,Ja.i)({width:10,marginLeft:4,fill:n.lightIconColor})]})}),render:()=>(0,k.jsx)(h.Z,{menuType:x.og.Popup,children:(0,k.jsx)(Nr.Z,{context:{blocks:[t],environment:s,publicEditMode:void 0},sections:[lr.g],onAccept:e=>{const n=t.getType(),i=t.getFormat();dr.w(),jn.dh(s,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"rich_text_menu",block_id:t.id,block_type:n,is_toggleable:n?(0,Ir._A)(n,i):void 0,parent_collection_id:t.getParentCollectionIdUpToTwoLevels()})}})}),onClick:()=>{jn.mt(s,{action:"turn_into"})}})}function ol(){const e=(0,X.Fg)();return(0,k.jsx)(Hr.Z,{type:"b",tooltipLabel:(0,k.jsxs)(s.Fragment,{children:[(0,k.jsx)("div",{children:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})}),(0,k.jsx)("div",{children:(0,k.jsx)(_a.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleBold"})})]}),children:Qa({width:16,height:16})})}function al(){const e=(0,X.Fg)();return(0,k.jsx)(Hr.Z,{type:"i",tooltipLabel:(0,k.jsxs)(s.Fragment,{children:[(0,k.jsx)("div",{children:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})}),(0,k.jsx)("div",{children:(0,k.jsx)(_a.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleItalics"})})]}),children:tr({width:16,height:16})})}function rl(){const e=(0,X.Fg)();return(0,k.jsx)(Hr.Z,{type:"s",tooltipLabel:(0,k.jsxs)(s.Fragment,{children:[(0,k.jsx)("div",{children:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})}),(0,k.jsx)("div",{children:(0,k.jsx)(_a.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleStrike"})})]}),children:sr({width:16,height:16})})}function ll(){const e=(0,X.Fg)();return(0,k.jsx)(Hr.Z,{type:"_",tooltipLabel:(0,k.jsxs)(s.Fragment,{children:[(0,k.jsx)("div",{children:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})}),(0,k.jsx)("div",{children:(0,k.jsx)(_a.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleUnderline"})})]}),children:ir({width:16,height:16})})}function dl(){const e=(0,X.Fg)();return(0,k.jsx)(Hr.Z,{type:"c",tooltipLabel:(0,k.jsxs)(s.Fragment,{children:[(0,k.jsx)("div",{children:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})}),(0,k.jsx)("div",{children:(0,k.jsx)(_a.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleCode"})})]}),children:(0,Xa.z)({width:16,height:16})})}function cl(e){let{}=e;const t=(0,X.Fg)();return(0,k.jsx)(Yr.Z,{children:(0,k.jsxs)("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[(0,nr.N)({width:16,height:16,color:t.text.secondary}),(0,Ja.i)({width:10,fill:t.lightIconColor})]})})}function ul(e){let{intl:t}=e;const n=(0,X.Fg)(),a=(0,i.O7)(),r=(0,o.VK)((()=>O.default.state.mainEditorCurrentBlockStore),[]),l=(0,o.VK)((()=>Pr.Z.isEntryPointsEnabled()),[]),d=(0,o.VK)((()=>Pr.Z.showAssistantNotionAiCopy()?(0,k.jsx)(ne.FormattedMessage,{id:"richTextMenu.notionAI.label",defaultMessage:"Ask AI"}):(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Ask AI",id:"richTextMenu.assistButton.label"})),[]),[c,u]=(0,s.useState)();(0,s.useEffect)((()=>{if(!l||!r)return;const e=(0,pr.filterAndRankAssistantSurfaceActionsForContext)((0,pr.clientSkillToAssistantSurfaceAction)((0,gr.getAllClientSkills)({currentPageRecordPointer:void 0})),{type:"entrypoint",entrypoint:"richTextMenu",pageStore:r,selectionState:Ge.default.state,textSelectionState:M.default.state,isMobile:a.device.isMobile});e.length&&u(e[0])}),[l,a.device,r]);const m=(0,o.VK)((()=>Pr.Z.isXMLAssistantEnabled()),[]),p=(0,o.VK)((()=>Pr.Z.shouldShowAssistantFace()),[]);return(0,k.jsxs)(k.Fragment,{children:[c&&(0,k.jsxs)(hr.Z,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",borderRadius:6},onClick:()=>{(0,rr.vi)({environment:a,clientSkillWithParameterValues:(0,gr.dangerouslyCreateClientSkillWithParameterValues)(c),from:"rich_text_menu"}),jn.mt(a,{action:"completions"})},children:[c.icon({width:16,height:16,marginRight:6,fill:(0,gr.getSkillSectionColor)((0,gr.skillSectionTypeGivenSkillCategory)(c.category),n).color}),(0,k.jsx)("span",{style:{fontWeight:500},children:(0,k.jsx)(mr,{clientSkill:c})})]}),(0,k.jsx)(me.Z,{renderTooltip:()=>(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{children:m?t.formatMessage({defaultMessage:"Make edits, find answers, and more",id:"richTextMenu.assist.assistantTooltip"}):t.formatMessage({defaultMessage:"Ask AI to help edit, review, or generate text.",id:"richTextMenu.assist.tooltip"})}),(0,k.jsx)("div",{children:(0,k.jsx)(_a.Z,{style:{color:n.mediumInvertedTextColor},name:"commandJ"})})]}),render:e=>(0,k.jsxs)(hr.Z,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",borderRadius:6,height:28},...e,onClick:()=>{(0,cr.toggleInitialPrompt)({from:"rich_text_menu",environment:a}),jn.mt(a,{action:"completions"})},children:[(0,k.jsx)(ur.h,{}),(0,k.jsx)("span",{style:{fontWeight:500,...p?{}:{color:Mn.FN.light.purple[400]}},children:d})]})})]})}function ml(){const e=(0,i.O7)();return(0,k.jsx)($r.Z,{onClick:()=>{jn.mt(e,{action:"e"}),dr.w()},children:(0,er.G)({width:16,height:16})})}function pl(e){let{targetBlockStore:t,iconOnly:n}=e;const s=(0,X.Fg)();return(0,k.jsx)(Wr.Z,{style:{borderRadius:6,color:s.text.secondary,fill:s.text.secondary,height:28},iconOnly:n,blockStore:t})}function gl(e){let{targetBlockStore:t,iconOnly:n}=e;const s=(0,X.Fg)();return(0,k.jsx)(Sr,{style:{borderRadius:6,color:s.text.secondary,fill:s.text.secondary,height:28},iconOnly:n,blockStore:t})}function fl(e){let{targetBlockStore:t,iconOnly:n}=e;return(0,k.jsx)(Gr,{style:{borderRadius:6,height:28},iconOnly:n,blockStore:t})}function hl(e){let{targetBlockStore:t}=e;const n=(0,X.Fg)(),s=(0,i.O7)();return(0,k.jsx)(Er.Z,{store:t,style:{borderRadius:6,padding:6,width:28,height:28},iconStyle:{fill:n.text.secondary},fadeIn:!1,onClick:()=>{jn.mt(s,{action:"more"})}})}function yl(e){let{renderState:t}=e;const n=(0,ne.useIntl)(),s=(0,X.Fg)(),i=(0,o.VK)((()=>Or.Z.state.isActive),[]),a=t.showDiscuss||t.showReact||t.showSuggest,r=t.showBold||t.showItalic||t.showUnderline||t.showStrikethrough||t.showCode||t.showEquation||t.showHighlight,l=r;return(0,k.jsxs)("div",{style:{display:"inline-flex",alignItems:"stretch",height:Xr,background:s.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:8,boxShadow:s.aiBarShadow,pointerEvents:i?"auto":"none",padding:"4px"},onMouseDown:e=>e.preventDefault(),children:[t.showCompletions&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ul,{intl:n}),(0,k.jsx)(sl,{theme:s})]}),t.showTurnInto&&t.targetBlockStore&&(0,k.jsx)(il,{blockStore:t.targetBlockStore}),t.showLink&&(0,k.jsx)(cl,{}),a&&t.targetBlockStore&&(0,k.jsxs)(k.Fragment,{children:[t.showDiscuss&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(pl,{targetBlockStore:t.targetBlockStore,iconOnly:l}),!l&&(t.showReact||t.showSuggest)&&(0,k.jsx)(sl,{theme:s})]}),t.showReact&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(gl,{targetBlockStore:t.targetBlockStore,iconOnly:l}),!l&&t.showSuggest&&(0,k.jsx)(sl,{theme:s})]}),t.showSuggest&&(0,k.jsx)(fl,{targetBlockStore:t.targetBlockStore,iconOnly:l}),r&&(0,k.jsx)(sl,{theme:s})]}),r&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[t.showBold&&(0,k.jsx)(ol,{}),t.showItalic&&(0,k.jsx)(al,{}),t.showUnderline&&(0,k.jsx)(ll,{}),t.showStrikethrough&&(0,k.jsx)(rl,{}),t.showCode&&(0,k.jsx)(dl,{}),t.showEquation&&(0,k.jsx)(ml,{})]}),t.showHighlight&&(0,k.jsx)(Kr.Z,{blockStore:t.targetBlockStore})]}),t.showActionButton&&t.targetBlockStore&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(sl,{theme:s}),(0,k.jsx)(hl,{targetBlockStore:t.targetBlockStore})]})]})}n(21703);var xl=n(514248),Sl=n(114714),vl=n(429369),bl=n(940663),Ml=n(110906),jl=n(119037),Cl=n(279954),wl=n(155367),kl=n(312211),Il=n(650628);const Tl=200,Zl=30,Pl=125,Fl=25;var _l=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}(_l||{});function Al(e){return e.type===_l.Selectable?{type:wl.Dl.Selectable,store:e.target.props.store,direction:e.direction}:{type:wl.Dl.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function Bl(e){const{target:t,device:n,direction:s,points:i}=e;return s===wl.vh.Onto||!n.isPhone||t.props.dropzoneShouldNeverUseOrigin?i.mousePoint:{x:i.originPoint.x,y:i.mousePoint.y}}function Rl(e){return e instanceof Cl.Z?{type:_l.Selectable,target:e}:{type:_l.DropTarget,target:e}}function Dl(e){if(!(e&&e instanceof Cl.Z))return!1;let t=e;const n=wl.ZP.state;if(!n.isDragging)return!1;const{draggedStores:s}=n;for(;t;){if(s.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function Ol(e){const{dropzoneMustBeWithinHorizontalBound:t,device:n}=e;return t?0:n.isPhone?9999:0}function Ll(e){switch(e.direction){case wl.vh.Onto:return function(e){const{device:t,isNativeDrag:n,rect:s,target:i,points:o,priority:a,canAcceptDrop:r}=e,l=wl.vh.Onto,d=Bl({device:t,target:i,direction:l,points:o});if((n?i.props.canNativeDropOnto:i.props.canDropOnto)&&El(d,s)&&!Dl(i)&&r(i,l))return{...Rl(i),direction:l,left:s.left,top:s.top,width:s.width,height:s.height,priority:a}}(e);case wl.vh.Left:return function(e){const{device:t,isNativeDrag:n,rect:s,target:i,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=wl.vh.Left,c=Bl({device:t,target:i,direction:d,points:o});if((n?i.props.canNativeDropLeft:i.props.canDropLeft)&&s&&c.y>=s.top&&c.y<=s.bottom&&Math.abs(c.x-s.left)<=Tl&&(r||!Dl(i))&&l(i,d))return{...Rl(i),direction:d,left:s.left,top:s.top,width:0,height:s.height,priority:a}}(e);case wl.vh.Right:return function(e){const{device:t,isNativeDrag:n,rect:s,target:i,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=wl.vh.Right,c=Bl({device:t,target:i,direction:d,points:o});if((n?i.props.canNativeDropRight:i.props.canDropRight)&&s&&c.y>=s.top&&c.y<=s.bottom&&Math.abs(c.x-s.right)<=Tl&&(r||!Dl(i))&&l(i,d))return{...Rl(i),direction:d,left:s.right,top:s.top,width:0,height:s.height,priority:a}}(e);case wl.vh.Above:return function(e){const{device:t,isNativeDrag:n,rect:s,target:i,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=Ol({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=wl.vh.Above,u=Bl({device:t,target:i,direction:c,points:o});if((n?i.props.canNativeDropAbove:i.props.canDropAbove)&&s&&u.x>=s.left-Zl-d&&u.x<=s.right+d&&(r||!Dl(i))&&Math.abs(u.y-s.top)<=Pl&&(s.height<=2*Fl||u.y<=s.top+Fl)&&l(i,c))return{...Rl(i),direction:c,left:s.left,top:s.top,width:s.width,height:0,priority:a}}(e);case wl.vh.Below:return function(e){const{device:t,isNativeDrag:n,rect:s,target:i,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=Ol({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=i.props.isLastItem?Number.MAX_SAFE_INTEGER:Pl,u=wl.vh.Below,m=Bl({device:t,target:i,direction:u,points:o});if((n?i.props.canNativeDropBelow:i.props.canDropBelow)&&s&&m.x>=s.left-Zl-d&&m.x<=s.right+d&&Math.abs(m.y-s.bottom)<=c&&(s.height<=2*Fl||m.y>=s.bottom-Fl)&&(r||!Dl(i))&&l(i,wl.vh.Below))return{...Rl(i),direction:wl.vh.Below,left:s.left,top:s.bottom,width:s.width,height:0,priority:a}}(e)}}function Vl(e){const{device:t,rect:n,target:s,points:i,optionKeyDown:o}=e;return El(Bl({device:t,target:s,direction:wl.vh.Onto,points:i}),n)&&Dl(s)&&!o}function El(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}var Nl=n(928314),Ul=n(175770),Kl=n(35026),Wl=n(117031),zl=n(827406),ql=n(681844),Gl=n(316339),Hl=n(95802),$l=n(891681),Yl=n(186486);class Ql extends xi.Z{constructor(){super(...arguments),this.isUpdatingDragState=!1,this.didTouchEnd=!1,this.lastMouseInfo=void 0,this.handleWindowMouseMove=e=>{const t=Yl.default.state;if(!e||t.isOpen&&t.menuIsOpen||(this.lastMouseInfo={target:e.target,x:e.clientX,y:e.clientY}),this.didTouchEnd)return void(this.didTouchEnd=!1);const{isDragging:n}=wl.ZP.state;if(n)this.updateDragState();else{if(!this.lastMouseInfo)return;td(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}},this.handleDragBlockStoreChange=()=>{this.isUpdatingDragState||this.handleWindowMouseMoveThrottled(void 0)},this.handleWindowMouseMoveThrottled=m.P2((e=>Ys.Z.withListenerIgnored((()=>this.handleWindowMouseMove(e)))),60),this.handleSelectionChange=()=>{const{isDragging:e}=wl.ZP.state;un.default.afterNextFlush((()=>{this.lastMouseInfo&&!e&&td(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}))},this.handleSelectionChangeThrottled=m.P2(this.handleSelectionChange,60),this.handleWindowKeyEvent=()=>{const{isDragging:e}=wl.ZP.state;e&&this.updateDragState()},this.handleWindowTouchEnd=()=>{this.didTouchEnd=!0},this.memoizedCanDragCache=new WeakMap,this.memoizedCanDrag=e=>{const t=this.memoizedCanDragCache.get(e);if(this.memoizedCanDragCache.has(e))return t;const n=(0,jl.OOI)({environment:this.environment,blocks:e,publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state});return this.memoizedCanDragCache.set(e,n),n}}didMount(){super.didMount();const{device:e}=this.environment;ks.lj(window,"mousemove",this.handleWindowMouseMoveThrottled),Ge.default.addListener(this.handleSelectionChangeThrottled),e.isIOS&&ks.lj(window,"touchend",this.handleWindowTouchEnd),ks.lj(window,"keydown",this.handleWindowKeyEvent),ks.lj(window,"keyup",this.handleWindowKeyEvent),wl.ZP.addListener(this.handleDragBlockStoreChange),ks.lj(window,"scroll",id,!0),ks.lj(window,"resize",od),Se.kw.addListener(ad),kn.Jy()}willUnmount(){super.willUnmount();const{device:e}=this.environment;ks.ZV(window,"mousemove",this.handleWindowMouseMoveThrottled),Ge.default.removeListener(this.handleSelectionChangeThrottled),e.isIOS&&ks.ZV(window,"touchend",this.handleWindowTouchEnd),ks.ZV(window,"keydown",this.handleWindowKeyEvent),ks.ZV(window,"keyup",this.handleWindowKeyEvent),wl.ZP.removeListener(this.handleDragBlockStoreChange),ks.ZV(window,"scroll",id,!0),ks.ZV(window,"resize",od),Se.kw.removeListener(ad)}updateDragState(){if(this.isUpdatingDragState)throw new Error("Assertion failure, updateDragState() called when this.isUpdatingDragState === true!");this.isUpdatingDragState=!0;try{this.updateDragStateInner()}finally{this.isUpdatingDragState=!1}}updateDragStateInner(){const e=wl.ZP.state;if(!e.isDragging)return;const{draggedStores:t,currentX:n,currentY:s,offsetX:i,offsetY:o,isNativeDrag:a}=e,r={x:n,y:s},l={x:n-i,y:s-o},d=this.findNearbyDropZones({mousePoint:r,originPoint:l},t[0],a);if(d.ontoDropZone)wl.ZP.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)wl.ZP.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],n=m.Gb(d.horizontalDropZones);if(t.type===wl.Dl.Selectable){const s=Hl.C.findSelectableFromStore(t.store);if(s){const i=s.getContextClosestSelectable();let o;return i&&i.props.store!==t.store&&i.props.shouldShowParentHalo&&(o=i.props.store),void wl.ZP.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:o})}}else{if(zl.Z.findDropTargetFromKey(t.key))return void wl.ZP.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:void 0})}}wl.ZP.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}findNearbyDropZones(e,t,n){const{device:s}=this.environment,i=Nl.yA(),o=function(){const{selectableRectMap:e}=Il.Z.state,{dropTargetRectMap:t}=kl.Z.state,n=new Map;return e.forEach(((e,t)=>{n.set(t,e)})),t.forEach(((e,t)=>{n.set(t,e)})),n}(),a=o.keys();let r=a.next();const l=Hl.C.findSelectableFromStore(t),d=l?l.getContextSelectableContainer():void 0;let c=[];for(;!r.done;){const t=r.value;r=a.next();const l=o.get(t),u=t.getContextSelectableContainer();if(s.isPhone&&u!==d)continue;if(!u||u.getProps().disable)continue;const p=ed(u),g={device:this.environment.device,isNativeDrag:n,rect:l,target:t,points:e,priority:p,optionKeyDown:i.option,canAcceptDrop:(e,t)=>this.selectableCanAcceptDrop(e,t,i.option)};if(Vl(g))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};c.push(...m.oA([Ll({...g,direction:wl.vh.Onto}),Ll({...g,direction:wl.vh.Left}),Ll({...g,direction:wl.vh.Right}),Ll({...g,direction:wl.vh.Above}),Ll({...g,direction:wl.vh.Below})]))}c=function(e){const t=sd(m.UT(e,sd));return e.filter((e=>sd(e)===t))}(c);const u=c.filter((e=>e.direction===wl.vh.Above||e.direction===wl.vh.Below)),p=m.F(u,(t=>Math.abs(t.top-nd(t,e,this.environment).y)));let g=u.filter((e=>{let{top:t}=e;return Math.abs(t-(p?p.top:0))<=2}));if(g.length>1){g=g.filter((t=>{const n=nd(t,e,this.environment).x,s=Ol({device:this.environment.device});return n>=t.left-s&&n<=t.left+t.width+s})),g=m.MR(g,(e=>{let{left:t}=e;return t}));let t=0;for(;t<g.length-1;t++){const n=g[t+1],s=nd(n,e,this.environment).x;if(n.left>s)break}g=g.slice(0,t+1),g.reverse()}const f=g.map(Al);let h;const y=c.filter((e=>e.direction===wl.vh.Onto)),x=m.F(y,(e=>e.height));if(x){u.some((t=>{const n=nd(t,e,this.environment).y;return Math.abs(t.top-n)<7}))||(h=Al(x))}let S;const v=c.filter((e=>e.direction===wl.vh.Left||e.direction===wl.vh.Right));let b=m.F(v,(t=>{const n=nd(t,e,this.environment).x;return Math.abs(t.left-n)}));if(b){const e=b,t=v.filter((t=>Math.abs(t.left-e.left)<20));t.length>0&&(b=m.F(t,(e=>e.left)))}if(b){const e=b;u.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(S=Al(b))}return{ontoDropZone:h,verticalDropZone:S,horizontalDropZones:f}}selectableCanAcceptDrop(e,t,n){if(W.Z.state.isOpen&&!Xo.default.state.open)return!1;if(z.Z.state.isOpen)return!1;const s=wl.ZP.state,i=s.isDragging?s.draggedStores:[],o=!!s.isDragging&&s.isNativeDrag;let a,r,l,d=!1,c=!1;i.find((e=>{const t=ql.Z.findOutlinerItemFromStore(e);return!!t&&(a=t,r=t.type,d=t.isTopLevelItem,!0)}));const u=e instanceof Cl.Z?ql.Z.findOutlinerItemFromStore(e.props.store):void 0,m=null==u?void 0:u.parentStore;var p;u&&(l=u.type,c=u.isTopLevelItem||"team"===(null===(p=u.parentStore)||void 0===p?void 0:p.table));if(function(e){var t;const{draggingOutlinerItem:n,selectableOutlinerItemParent:s,direction:i}=e;if(n&&"team"===n.type&&n.isTopLevelItem&&(null===(t=n.parentStore)||void 0===t?void 0:t.pointer.table)===vl.e0){const e=n.parentStore;if(!(n.store.getParentId()===e.pointer.id||s&&s.pointer.id===e.pointer.id&&i!==wl.vh.Onto))return!0}return!1}({draggingOutlinerItem:a,selectableOutlinerItemParent:m,direction:t}))return!1;if(!(e instanceof Cl.Z))return e.props.canAcceptDrop({direction:t,draggingStores:i,isNativeDrag:o});const g=e.props.store;if(g.pathIsDead()&&U.default.checkGate({gateName:"prevent_edits_trash"}))return!1;if((0,Fr.Eo)(g))return!1;const f=(0,Ml.fm)(g);if(f&&f.isInTrashStore.state&&U.default.checkGate({gateName:"prevent_edits_trash"}))return!1;const h=g.getAssociatedCollectionStore();if(t===wl.vh.Onto&&h){const e=h.id,t=(0,Ml.fm)(g),n=null==t?void 0:t.collectionViewBlockStore(),s=null==t?void 0:t.collectionViewStore();if(n&&s&&"page"!==s.getType()){if(i.find((s=>{const i=s.getAssociatedCollectionStore(),o=(0,Ml.fm)(s);return Boolean(s instanceof Ht.G&&i&&i.id===e)||Boolean(o===t&&g.id!==n.id)})))return!1}}if(t!==wl.vh.Onto){const e=(0,Ml.fm)(g);if("collectionTypedView"===(null==e?void 0:e.contextType)&&e.databaseType){if(!i.find((t=>{const n=(0,Ml.fm)(t);return(null==n?void 0:n.databaseType)===e.databaseType})))return!1}}if(e.props.groupsPointer){var y;const t=null===(y=g.getCollectionViewCollectionStore())||void 0===y?void 0:y.getSchema();if(Boolean(e.props.groupsPointer.find((e=>!(0,xl.WL)(e,(null==h?void 0:h.getSchema())??t))))){if(i.find((t=>{var n;const s=Hl.C.findSelectableFromStore(t);return(null==s||null===(n=s.props)||void 0===n?void 0:n.groupsPointer)&&e.props.groupsPointer&&!(0,Sl.HH)(s.props.groupsPointer,e.props.groupsPointer)})))return!1}}if((0,Ul.ru)({targets:i,destination:g,direction:t,draggingOutlinerType:r}))return!1;if(n&&i.find((e=>e.isTypedCollectionViewBlock()||(0,bl.h7)(e))))return!1;if(u&&t!==wl.vh.Onto&&!c&&!(0,jl.MaU)({environment:this.environment,blocks:[u.store],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(l&&o)return!1;if("bookmarks"===r&&d&&("bookmarks"!==l||!c||t===wl.vh.Onto))return!1;if("bookmarks"===l&&c&&t!==wl.vh.Onto&&("bookmarks"!==r||!d))return!1;if(a&&a.isTopLevelItem&&"team"===a.type&&a.parentStore&&a.parentStore.table===vl.e0){const e=a.parentStore,t=Ht.zX.createChildStore(e,{...e.pointer,table:vl.e0});if(t&&!(0,Kl.si)({teamStore:t,environment:this.environment}))return!1}if(u&&u.isTopLevelItem&&"team"===u.type&&u.parentStore&&u.parentStore.table===vl.e0){const e=u.parentStore,t=Ht.zX.createChildStore(e,{...e.pointer,table:vl.e0});if(t&&!(0,Kl.si)({teamStore:t,environment:this.environment}))return!1}const{currentSpaceViewStore:x}=O.default.state,S=l?Kl.TM[l]:void 0;if(x&&u&&a&&S&&u.isTopLevelItem&&t!==wl.vh.Onto&&a.type!==l){const{sortOption:e}=(0,Kl.S4)({spaceViewStore:x,type:S});if("lastEdited"===e)return!1}if("shared"===l&&c&&t!==wl.vh.Onto&&("shared"!==r||!d))return!1;if(l&&c&&t!==wl.vh.Onto){if(i.find((e=>{const t=e.getType();return Boolean(!t||!Me.Z7[t])})))return!1}const{device:v}=this.environment;if(l&&v.isMobile&&t===wl.vh.Onto&&c)return!1;if(!U.default.checkGate({gateName:"charts_next"})){if(i.find((e=>Boolean(e instanceof Ht.G&&e.isInlineCollectionView())))&&(t===wl.vh.Left||t===wl.vh.Right))return!1}if(i.some((e=>Boolean(Wl.Z.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(Wl.Z.findCollectionTemplatePickerItemFromStore(g)))return!1;if(t===wl.vh.Onto&&g&&!(0,jl.J5S)({environment:this.environment,blocks:[g],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(!this.memoizedCanDrag(i))return!1;if(i.some((e=>e.isTransclusionType()))){if(g.findRecordStoreUIAncestor((e=>{if(e===g)return!1;const t=e.isTable("block")&&e.isPath([])&&e.getValue();return Boolean(t&&(0,Me.nq)(t.type))})).ancestor)return!1}return!0}}Ql.displayName="SelectableOrDropTargetListener";const Jl=Ql;function Xl(){const e=Yl.default.state;e.isOpen&&!e.menuIsOpen&&Yl.default.reset()}function ed(e){return(Ge.default.state.droppableContainerStack||[]).indexOf(e)}function td(e,t,n){const s=Yl.default.state;if(!s.isOpen||!s.menuIsOpen){const i=function(e,t,n){if($l.Z.state.isResizing||wl.ZP.state.isDragging||q.default.state.isActive||Se.kw.state)return;const{selectableRectMap:s}=Il.Z.state,i=Gl.Z.getMembersByDOMOrder({filter:t=>{const n=t.getNode();return Boolean(n&&n.contains(e))}})[0];if(!i)return;const o=s.keys();let a=o.next();const r=[];for(;!a.done;){const e=a.value,l=s.get(e),d=150;(e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===i&&l&&n>=l.top&&n<=l.bottom&&t>=l.left-d&&t<=l.right&&r.push(e),a=o.next()}const l=m.MR(r,(e=>{const t=s.get(e);return t?-t.left:1/0})),d=l.find((e=>{const t=e.getNode();return!t||!l.find((n=>{if(n!==e){const e=n.getNode();return Boolean(e&&t.contains(e))}return!1}))}));return d?{selectable:d,container:i}:void 0}(e,t,n);i?s.isOpen&&i.selectable.props.store===s.currentStore||Yl.default.setState({isOpen:!0,currentStore:i.selectable.props.store,container:i.container,menuIsOpen:!1}):Yl.default.reset()}}function nd(e,t,n){return Bl({device:n.device,target:e.target,points:t})}function sd(e){return(null==e?void 0:e.priority)??0}function id(){kn.Ch(),Xl()}function od(){kn.Ch(),Xl()}function ad(){const e=Yl.default.state,t=Se.kw.state;e.isOpen&&!e.menuIsOpen&&t&&Yl.default.reset()}var rd=n(212534),ld=n(849427),dd=n(966324),cd=n(938676);const ud=5,md=18,pd=.38;const gd=function(){const e=(0,i.O7)(),t=(0,s.useRef)(void 0),n=(0,s.useRef)(void 0),a=(0,s.useRef)(1/0),r=(0,s.useRef)(void 0),l=(0,o.VK)((()=>e.WindowSizeStore.state.width),[e]);return(0,s.useEffect)((()=>{l<dd.OnlyOneSidebarVisibleWidthThreshold&&(0,ve.Sx)(e)&&(0,ve.in)(e)&&dd.setExpand({environment:e,isExpanded:!1,from:"sidebar_listener"})}),[e,l]),(0,s.useEffect)((()=>{const s=s=>{!function(e){let{e:t,environment:n,timerRef:s,cachedPageViewRectRef:i,previousMousePositionRef:o,mouseSpeedRef:a}=e;(0,rd.ZP)({event:t,context:rd.Af.SidebarMouseMove,callback:()=>{if(hd(i),void 0!==o.current&&(a.current=Math.sqrt(Math.pow(t.clientX-o.current.x,2)+Math.pow(t.clientY-o.current.y,2))),function(e){let{x:t,y:n,timerRef:s,previousMousePositionRef:i}=e;i.current={x:t,y:n},clearTimeout(s.current),s.current=setTimeout((()=>{i.current=void 0}),100)}({x:t.clientX,y:t.clientY,timerRef:s,previousMousePositionRef:o}),i.current){const e=cd.sidebarOpenStore.state,s=t.clientX,o=i.current.left,r=Math.max(o*pd,md,cd.sidebarMousePeekXStore.state);s<r&&!Xo.default.isCenterPeekOpen()&&a.current<ud&&0!==a.current&&!e&&dd.open({fromElectron:!1}),s>(0,ve.qG)(n)&&s>r&&e&&dd.close()}}})}({e:s,environment:e,timerRef:r,cachedPageViewRectRef:t,previousMousePositionRef:n,mouseSpeedRef:a})};return window.addEventListener("mousemove",s),window.addEventListener("mouseout",fd),()=>{window.removeEventListener("mousemove",s),window.removeEventListener("mouseout",fd)}}),[e]),(0,k.jsx)(k.Fragment,{})};function fd(e){e.toElement||e.relatedTarget||dd.close()}const hd=m.P2((function(e){const t=function(){const{mainEditorCurrentBlockStore:e}=O.default.state,t=ld.Z.find((t=>t.props.store===e));if(t){const e=t.getContentWrapEl();if(e)return e}}();e.current=t?t.getBoundingClientRect():document.body.getBoundingClientRect()}),500);var yd=n(868012),xd=n(313991),Sd=n(606906),vd=n(376994),bd=n(65965),Md=n(647425),jd=n(937834),Cd=n(983420),wd=n(352533),kd=n(99340),Id=n(146096),Td=n(44041),Zd=n(891694),Pd=n(88893),Fd=n(535057),_d=n(288280),Ad=n(684787),Bd=n(550506),Rd=n(863296),Dd=n(776798),Od=n(953336),Ld=n(483182),Vd=n(246247),Ed=n(126263),Nd=n(399036),Ud=n(516691),Kd=n(600606),Wd=n(213493),zd=n(937850),qd=n(307032),Gd=n(466213),Hd=n(282136),$d=n(531192);const Yd=function(e){const t=(0,i.O7)(),n=(0,X.yK)((e=>({spinnerWrapper:{padding:32,display:"flex",alignItems:"center",justifyContent:"center"},scroller:{background:e.contentBackground,zIndex:1,flexGrow:1}})),[]),o=(0,s.useCallback)((e=>{jd.U4(),Ma.c4({environment:t,url:e})}),[t]),a=e.blockStore.id,r=e.timestamp,l={request:{block:{id:a,spaceId:(0,ps.C)(e.blockStore.pointer.spaceId)},timestamp:r},performRequest:n=>async function(e,t,n){const{timestamp:s}=e,i=e.block.id,o=await R.getSnapshotContents(n,e);if("failed"===o.type)throw o.error;const a=ut.PF.create(o.data.contentMap),r=n.currentUser.id,l=new Ed.Z({name:"PageSnapshotPreview"});for(const{pointer:u,model:m}of a)m&&l.setModelAndRole({pointer:u,userId:r},m,"reader");l.snapshotData={blockId:i,timestamp:s};const d=new Map,c=e=>{const n=l.getRecord({pointer:e,userId:r}),s=(0,Ud.dn)(e);n||!(0,qd.e)(e.id)||d.has(s)||d.set(s,(0,Ht.Kv)(t,e))},p=[];for(const{model:f}of a)if(f)if(f.table===Kt.iU){const e=f,t=e.getProperties(),n=Kd.dr.uniq(m.xH(Object.keys(t).map((e=>t[e])).map(u.cCA)));for(const d of n)c(d);const s=Kd.dr.uniq(m.xH(Object.keys(t).map((e=>t[e])).map(Ya.rq)));for(const d of s)c(d);const i=e.isNavigableBlock()?[]:e.getContentIds()||[];for(const d of i)c({table:Kt.iU,id:d});const o=e.getCollectionPointer();o&&(c(o),p.push(o.id));const a=m.jj(m.xH(Object.keys(t).map((e=>t[e])).map(u.lcG)));for(const d of a)c({table:St.KJ,id:d});const r=f.getCreatedByPointer();r&&c(r);const l=f.getLastEditedByPointer();l&&c(l)}else if(f.table===Wd.np){var g;const e=null===(g=f.getFormat())||void 0===g?void 0:g.collection_pointer;e&&c(e)}else if(f.table===vn.x_){const e=f.getCreatedByPointer();e&&c(e)}return await Qd({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:r}),p.forEach((e=>{var t,n;const s=null===(t=l.getRecord({pointer:{table:or.vF,id:e},userId:r}))||void 0===t?void 0:t.value;s&&s.schema&&Object.keys(s.schema).forEach((e=>{var t;const n=null===(t=s.schema)||void 0===t?void 0:t[e],i=n&&(0,Nd.p_)(n)?(0,Nd.F0)(n):void 0;i&&c({table:or.vF,id:i})})),null!=s&&null!==(n=s.format)&&void 0!==n&&n.layout_pointer&&!l.getRecord({pointer:s.format.layout_pointer,userId:r})&&(console.warn(`Layout ${s.format.layout_pointer.id} is not in snapshot, disabling it.`),delete s.format.layout_pointer)})),await Qd({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:r}),{blockStore:new Ht.G(n,{table:Kt.iU,id:i},{inMemoryRecordCache:l}),timestamp:s}}(n,e.blockStore,t),render:(e,s,i)=>(0,k.jsx)(ws.Z,{show:!i||!s,showDelay:400,showHold:400,render:i=>i?(0,k.jsx)("div",{style:n.spinnerWrapper,children:(0,k.jsx)($t.Z,{})}):e?(0,k.jsx)("div",{style:{padding:32},children:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})}):s?(0,k.jsx)(Fe.Z,{store:s.blockStore,isDefaultContainer:!0,droppable:!0,render:e=>{let{selectableEvents:i}=e;return(0,k.jsx)(Od.Z,{style:n.scroller,type:(0,Se.Zy)({environment:t,store:s.blockStore}),...i,children:(0,k.jsx)($d.ZP,{store:s.blockStore,disabled:!0,context:Hd.S.InPageSnapShot,paddingBottom:$d.ZP.paddingBottom(t)})})}},s.timestamp):void 0})};return(0,k.jsx)(Gd.LF,{value:o,children:(0,k.jsx)(Go.Z,{...l})})};async function Qd(e){const{relatedStoresMap:t,inMemoryRecordCache:n,currentUserId:s}=e,i=Array.from(t.values());await(0,zd.Lc)(i,25,(async e=>{await e.load();const t=e.getValue();t&&n.setRecord({pointer:e.pointer,userId:s},{role:"reader",value:t})}))}var Jd=n(505595);const Xd={display:"flex",justifyContent:"center",padding:32};const ec=(0,ne.injectIntl)((function(){const e=(0,ne.useIntl)(),t=(0,i.O7)(),{device:n}=t,s=(0,o.VK)((()=>Id.Z.state),[]);return n.isMobile?(0,k.jsx)(y.ZP,{ariaLabel:rc(e),popupType:b.k.SlideUp,open:s.open,render:()=>(0,k.jsx)(Sc,{}),onDismiss:jd.U4}):(0,k.jsx)(Bd.Z,{ariaLabel:rc(e),open:s.open,innerStyle:{height:`${Jd._Y}vh`,width:`${Jd.rp}vw`,overflow:"hidden",display:"flex"},onDismiss:jd.U4,render:()=>(0,k.jsx)(Sc,{}),className:We.Nn$})})),tc=(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"});function nc(){return bd.sb.filter((e=>"personal"!==e.tier))}function sc(e){const t=nc(),n=t.findIndex((t=>t.tier===e));if(!(n<=0))return t[n-1]}function ic(e){var t;if(d.default.isAdminMode)return;const{nextFutureSnapshot:n}=e;if(!n)return;const s=(i=n,(Date.now()-parseInt(i.timestamp))/Wt.A0);var i;if((0,Fd.Aw)()&&s<=bd.hy.plus.days)return;const o=function(e){return nc().filter((t=>t.days>e)).map((e=>e.tier))}(s);if((0,Fd.p4)(o))return;const a=o[0]??"enterprise";return(0,Md.QM)(a)?void 0:{tier:a,message:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Please upgrade to the {upsellTier} Plan to access versions older than {snapshotLimitDays} days.",id:"historyModal.upsell.message",values:{upsellTier:(0,Sd.Z)((0,Md.eR)(a)?"plus":a),snapshotLimitDays:(null===(t=sc(a))||void 0===t?void 0:t.days)??Math.floor(s)}})}}function oc(){return(0,k.jsx)(Vd.Z,{href:(0,le.UY)("guides.pageHistory"),analyticsFrom:"page_history"})}function ac(e,t){const{device:n}=t;return!n.isMobile||"personal"===e&&(0,wd.S$)({environment:t})}function rc(e){return e.formatMessage({id:"historyModal.ariaLabel",defaultMessage:"Page History"})}function lc(e){const{device:t}=e;return t.isMobile?24:20}function dc(e){let{menuState:t}=e;const n=(0,i.O7)(),a=(0,o.VK)((()=>t.blockStore.getIcon()),[t.blockStore]),r=(0,o.VK)((()=>t.blockStore.isEmptyPage()),[t.blockStore]);return t.snapshot?(0,k.jsxs)(s.Fragment,{children:[(0,k.jsxs)("div",{style:{display:"flex",alignItems:"center",flexShrink:0,height:45,fontSize:14,paddingLeft:14},children:[a&&(0,k.jsx)(Ka.Z,{disabled:!0,icon:a,isEmptyPage:r,size:lc(n),style:{marginRight:6}}),(0,k.jsx)(Dd.Z,{store:t.blockStore})]}),(0,k.jsx)(Yd,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp})]}):null}function cc(e,t){const{device:n}=e;return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,...n.isMobile?{position:"relative",zIndex:1,background:t.popoverBackground,boxShadow:`\n                        0 -1px 0 ${t.regularDividerColor},\n                        0 1px 0 ${t.regularDividerColor}\n                    `}:{height:"100%"}}}function uc(){const e=(0,X.Fg)();return(0,vd.w)({width:64,height:"auto",fill:e.lightIconColor,marginBottom:12})}function mc(e,t){Td.y(t,{from:"history_modal",for:e})}function pc(e){let{message:t,showUpgradeButtonForTier:n}=e;const s=(0,X.Fg)(),a=(0,i.O7)(),{device:r}=a,l=(0,o.VK)((()=>Pd.GJ(_d.subscriptionDataStoreInstance.state)),[]);let d=ac(n,a);return d&&(0,wd.S$)({environment:a})&&"personal"===n&&!l&&(d=!1),(0,k.jsxs)("div",{style:cc(a,s),children:[ac(n,a)&&(0,k.jsx)(uc,{}),(0,k.jsx)("div",{style:{...!r.isMobile&&{maxWidth:340}},children:t}),d&&n&&(0,k.jsx)(It.Z,{isLarge:!0,onClick:()=>mc(n,a),style:{marginTop:16},children:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Upgrade",id:"historyModal.upgradeForHistoryButton.label"})})]})}function gc(e){const t=(0,i.O7)(),n=(0,ne.useIntl)(),{device:a}=t,{menuState:r,loadingMore:l}=e,d=(0,o.VK)((()=>m.oA(e.snapshotValues.map(((s,i)=>{const o=i>0?e.snapshotValues[i-1]:void 0,l=ic({snapshot:s,nextFutureSnapshot:o}),d=!l;return{key:s.id,action:()=>{jd.gs({environment:t,snapshot:s,nextFutureSnapshot:o})},render:e=>{const i=s.authors||[],o=n.formatList(m.oA(i.map((e=>(0,Cd.nc)({parentStore:r.blockStore,pointer:e}).getDisplayName(n)))),{type:"conjunction",style:"narrow"}),c=(0,k.jsx)("div",{style:{...se.Z.textOverflowStyle},children:o}),u=Boolean(r.snapshot&&r.snapshot.id===s.id),p=parseInt(s.timestamp),g=p>Date.now()-6*Wt.A0?(0,po.$b)(p,xd.SP,n):(0,po.Yx)(p,"medium",xd.SP),f=(0,po.Yx)(p,"medium_with_time",xd.SP);return d?(0,k.jsx)(me.Z,{render:t=>(0,k.jsx)(He.Z,{...(0,Mo.Z)(e,t),title:g,focused:!a.isMobile&&u,caption:c}),renderTooltip:()=>(0,k.jsxs)("div",{style:{maxWidth:270,whiteSpace:"normal"},children:[(0,k.jsx)("div",{children:f}),(0,k.jsx)("div",{children:o})]})},e.key):(0,k.jsx)(me.Z,{render:n=>(0,k.jsx)(He.Z,{...(0,Mo.Z)(n,e),title:(0,k.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,k.jsx)("div",{style:{...a.isMobile&&{display:"flex",flex:1},...se.Z.textOverflowStyle},children:g}),(0,k.jsx)(Zd.Z,{subscriptionTier:l.tier,analyticsName:"history_modal",desktopStyle:{marginLeft:8},onClick:()=>mc(l.tier,t)})]}),focused:!a.isMobile&&u,caption:c}),renderTooltip:()=>(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Upgrade to view this snapshot.",id:"historyModal.snapshotsMenuList.upgrade.tooltip"}),disableTooltip:!Md.QM},e.key)}}})))),[e.snapshotValues,a.isMobile,t,n,r.blockStore,r.snapshot]),c=r.snapshot&&r.snapshot.id,u=d.findIndex((e=>c===e.key)),p=[{key:"snapshots",render:e=>(0,k.jsx)(Ye.Z,{...e}),items:d}];return(0,k.jsxs)(s.Fragment,{children:[(0,k.jsx)($e.Z,{type:$e.i.Vertical,initialFocus:u,sections:p}),(0,k.jsx)(Ad.Z,{loading:l,fetchSize:r.size,resultSize:e.snapshotValues.length,onLoadMore:jd.FF}),(0,k.jsx)(ws.Z,{show:l,showDelay:300,showHold:100,render:e=>e&&(0,k.jsx)("div",{style:Xd,children:(0,k.jsx)($t.Z,{})})})]})}function fc(e){let{menuState:t}=e;const n=(0,i.O7)();return(0,k.jsx)(y.ZP,{popupType:b.k.SlideUp,open:Boolean(t.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!t.snapshot)return null;const e=ic({snapshot:t.snapshot,nextFutureSnapshot:t.nextFutureSnapshot}),s=!e,i=s?(0,k.jsx)(Yd,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp}):(0,k.jsx)(pc,{message:e.message,showUpgradeButtonForTier:e.tier});return(0,k.jsx)(h.Z,{menuType:x.og.Modal,title:(0,po.$b)(parseInt(t.snapshot.timestamp),xd.SP,ze.default.getIntl()),right:(0,k.jsx)(Pe.DoneMenuText,{}),onClickRight:jd.zb,leftDisabled:!s,left:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>jd.xx(n),whiteBackground:s,forceFullScreenSlideUp:!0,children:i})}})}function hc(e){const t=(0,X.Fg)(),n=(0,i.O7)(),{menuState:s}=e,a=(0,kd.cR)(s.blockStore),r=(0,kd.xb)(s.blockStore),l=(0,o.VK)((()=>Boolean(s.snapshot&&!a&&!r&&!ic({snapshot:s.snapshot,nextFutureSnapshot:s.nextFutureSnapshot})&&function(e,t){return(0,jl.k5s)({environment:t,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0})}(s,n))),[n,s,a,r]);return(0,k.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexShrink:0,width:Jd.mD},children:[(0,k.jsx)(Od.Z,{type:ke.Z.Y,style:{flex:1},children:(0,k.jsx)(gc,{...e})}),(0,k.jsxs)("div",{style:{display:"flex",padding:14,borderTop:`\n                        1px solid ${t.regularDividerColor}\n                    `},children:[(0,k.jsx)(me.Z,{disableTooltip:l,renderTooltip:()=>r?(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Resolve pending edits to restore snapshots.",id:"historyModal.desktopModal.sidebar.resolvePendingEdits.tooltip"}):a?(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Restore page from trash to restore snapshots.",id:"historyModal.desktopModal.sidebar.restorePageFromTrashMessage.tooltip"}):(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:e=>(0,k.jsx)(It.Z,{isLarge:!0,onClick:()=>jd.xx(n),disabled:!l,...e,children:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Restore version",id:"historyModal.desktopModal.restoreButton.label"})})}),(0,k.jsx)(Rd.Z,{isLarge:!0,style:{marginLeft:12},onClick:jd.U4,children:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Cancel",id:"historyModal.desktopModal.cancelButton.label"})})]}),(0,k.jsx)(Ye.Z,{topBorder:!0,disableDesktopPadding:!0,children:(0,k.jsx)(Ld.Z,{title:(0,k.jsx)(ne.FormattedMessage,{id:"historyModal.desktopModal.learnMoreButton.label",defaultMessage:"Learn about page history"}),href:(0,le.UY)("guides.pageHistory"),analyticsFrom:"page_history"})})]})}function yc(e){let t,n;return e.loadingMore||0!==e.snapshotValues.length||(t=(0,k.jsx)(pc,{message:tc,showUpgradeButtonForTier:!1})),n=e.error?(0,k.jsx)("div",{style:Xd,children:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})}):e.initialLoading?(0,k.jsx)("div",{style:Xd,children:(0,k.jsx)($t.Z,{})}):(0,k.jsxs)(s.Fragment,{children:[(0,k.jsx)(Od.Z,{type:ke.Z.Y,children:(0,k.jsx)(gc,{...e})}),(0,k.jsx)(fc,{menuState:e.menuState})]}),(0,k.jsx)(h.Z,{menuType:x.og.Modal,title:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:(0,k.jsx)(oc,{}),right:(0,k.jsx)(Pe.DoneMenuText,{}),onClickRight:jd.U4,header:t,children:n})}function xc(e){const t=(0,X.Fg)(),n=(0,o.VK)((()=>e.menuState.snapshot?ic({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot}):null),[e.menuState.nextFutureSnapshot,e.menuState.snapshot]);let i;return i=e.error?(0,k.jsx)("div",{style:Xd,children:(0,k.jsx)(ne.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"})}):e.initialLoading?(0,k.jsx)("div",{style:Xd,children:(0,k.jsx)($t.Z,{})}):n?(0,k.jsx)(pc,{message:n.message,showUpgradeButtonForTier:n.tier}):e.loadingMore||0!==e.snapshotValues.length?(0,k.jsx)(dc,{menuState:e.menuState}):(0,k.jsx)(pc,{message:tc,showUpgradeButtonForTier:!1}),(0,k.jsxs)(s.Fragment,{children:[(0,k.jsx)("div",{style:{display:"flex",flexDirection:"column",width:`calc(100% - ${Jd.mD}px)`,boxShadow:`1px 0 0 ${t.regularDividerColor}`},children:i}),(0,k.jsx)(hc,{...e})]})}function Sc(){const e=(0,i.O7)(),{device:t}=e,n=(0,o.VK)((()=>Id.Z.state),[]);if(!n.open)return null;const s={request:{block:{id:n.blockStore.id,spaceId:(0,ps.C)(n.blockStore.pointer.spaceId)},size:n.size},performRequest:t=>async function(e,t,n){const{device:s}=n,i=await R.getSnapshotsList(n,e);if("failed"===i.type)throw i.error;const{snapshots:o}=i.data;if(t.pageHasCollection=o.some((e=>{var t;const n="collection"===e.parent_table,s=null===(t=e.collection_ids)||void 0===t?void 0:t.length;return n||s&&0!==s})),t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),s=o.findIndex((t=>parseInt(t.timestamp)<e));0===o.length||(0===s?jd.gs({environment:n,snapshot:o[s],nextFutureSnapshot:void 0}):s>0?jd.gs({environment:n,snapshot:o[s-1],nextFutureSnapshot:s>1?o[s-2]:void 0}):o.length<t.size?jd.gs({environment:n,snapshot:o[o.length-1],nextFutureSnapshot:o.length>1?o[o.length-2]:void 0}):jd.FF())}else Boolean(t.snapshot)||s.isMobile||Id.Z.setState({...t,snapshot:o[0],nextFutureSnapshot:void 0});return i.data}(t,n,e),render:(e,s,i)=>(0,k.jsx)(ws.Z,{show:Boolean(!s||s.snapshots.length>=n.size&&n.openSnapshotNearTimestamp),showDelay:400,showHold:100,render:o=>t.isMobile?(0,k.jsx)(yc,{snapshotValues:s?s.snapshots:[],menuState:n,error:e,initialLoading:o,loadingMore:!i}):(0,k.jsx)(xc,{snapshotValues:s?s.snapshots:[],menuState:n,error:e,initialLoading:o,loadingMore:!i})})};return(0,k.jsx)(Go.Z,{...s})}var vc=n(30397);const bc=function(){const e=(0,i.O7)(),{currentSpaceStore:t,currentUserStore:n}=(0,o.Kw)(O.default),[,a,r]=(0,o.AF)(vc.Z),l=null==n?void 0:n.id;return(0,s.useEffect)((()=>{if(!t||!l)return;const n=H.ZP.addListener((0,G.je)(t.id),(async(n,s)=>{if(!r.shouldRefetchTeamsInSpace({currentUserId:l,currentSpaceId:t.id,emitValue:s}))return;const i=await(0,F.qX)({environment:e,spaceStore:t,includeArchived:!1,currentUserId:l});a({teams:i,lastEmitData:{spaceId:t.id,userId:l,value:s}})}),void 0,e);return function(){n&&H.ZP.removeListener(n,e)}}),[t,l,e,a,r]),null};var Mc=n(213148),jc=n(389475),Cc=n(237181),wc=n(304926),kc=n(1634),Ic=n(751077),Tc=n(942402);const Zc=function(){const e=(0,X.Fg)(),t=(0,i.O7)(),n=(0,o.VK)((()=>kc.Z.state),[]),s=(0,o.VK)((()=>wc.Z.state),[]);if(!n.open)return null;const a=n.integration.info.icon;return a?(0,k.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:e.popoverBackground,borderRadius:4,boxShadow:e.lightBoxShadow,position:"absolute",bottom:65+s,right:16+s,width:240,zIndex:bn.hT,clipPath:"inset(-10px -10px -10px -10px)"},children:[(0,k.jsx)(Ic.Z,{type:"image_url",imageURL:a,size:38,style:{marginBottom:6}}),(0,k.jsx)("div",{style:{color:e.regularTextColor,fontSize:14,fontWeight:se.Z.fontWeight.semibold,marginBottom:6,textAlign:"center"},children:(0,k.jsx)(ne.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:n.integration.name}})}),(0,k.jsxs)("div",{style:{color:e.mediumTextColor,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,k.jsx)(ne.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live."}),(0,k.jsx)(Tc.Z,{href:(0,le.UY)("guides.unfurling"),external:!0,children:(0,k.jsx)(ne.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"})})]}),(0,k.jsx)(It.Z,{onClick:()=>async function(e){const t=kc.Z.state,{currentSpaceStore:n}=O.default.state;if(!t.open||!n)return;await jc.hM({environment:e,integration:t.integration,spaceId:n.id,unfurlUrl:t.unfurlUrl,externalObjectInstanceBlockId:t.externalObjectInstanceBlockId,from:"external_object_instance_inline_popup"}),Pc(t.integration.id,e),kc.Z.reset()}(t),style:{width:"100%"},children:(0,k.jsx)(ne.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})}),(0,k.jsx)(ue.Z,{icon:Mc.U,onClick:()=>function(e){const t=kc.Z.state;t.open&&Pc(t.integration.id,e);kc.Z.reset()}(t),style:{position:"absolute",top:6,right:6}})]}):null};function Pc(e,t){const{currentUserSettingsStore:n}=O.default.state;n&&f.createAndCommit({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:t,perform:t=>{Cc.GK({transaction:t,userSettingsStore:n,integrationId:e})}})}var Fc=n(977657),_c=n(544876),Ac=n(798165),Bc=n(325775),Rc=n(121039),Dc=n(992083),Oc=n(880064);const Lc=function(){const e=(0,o.qz)(Oc.Z),t=(0,i.O7)(),n=(0,s.createRef)(),a=(0,i.Fy)(),r=(0,ne.useIntl)(),[l,d,c,u]=(0,o.VK)((()=>[e.state.open,e.state.open?e.state.allOptionTypes:[],e.state.open?e.state.renderRect:void 0,e.state.open?e.state.integration:void 0]),[e]);return(0,s.useEffect)((()=>{const e=e=>{l&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&Kc(t)},s=e=>{if(!l||!e.target||!n.current)return;const s=n.current;s&&!s===e.target&&Kc(t)};return(0,ks.lj)(window,"keydown",e),(0,ks.lj)(window,"mousedown",s),()=>{(0,ks.ZV)(window,"keydown",e),(0,ks.ZV)(window,"mousedown",s)}}),[l,n,t]),(0,k.jsx)(y.ZP,{popupType:a.isMobileNative&&!a.isTablet?b.k.SlideUp:b.k.Popup,open:Boolean(l&&c),originRect:l?c:void 0,placementToOrigin:y.ZP.Placement.Top,alignmentToOrigin:y.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:a.isMobile,keepFocus:a.isMobile,render:()=>{if(!l)return;const e={key:"embed section",render:e=>(0,k.jsx)(Ye.Z,{...e}),items:d.map((e=>({key:e,render:n=>(0,k.jsx)(He.Z,{...n,title:(0,k.jsx)(Vc,{optionType:e,integration:u}),onMouseEnter:s=>{n.onMouseEnter(s),Ec(e,r,t)}}),action:()=>Nc(e,t)})))};let s;return s=a.isMobile?{menuType:x.og.ActionSheet}:{menuType:x.og.Popup,width:320,maxHeight:"40vh",onClickOutside:()=>Kc(t)},(0,k.jsx)(h.Z,{...s,className:We.b_f,ref:n,children:(0,k.jsx)($e.Z,{type:$e.i.Vertical,sections:[e],initialFocus:0,onKeyboardArrow:e=>function(e,t,n){const s=Oc.Z.state;if(!s.open||void 0===e.indexGlobal)return;const i=s.allOptionTypes[e.indexGlobal];if(!i)return;Ec(i,t,n)}(e,r,t),priority:1,disallowBackspace:!0})})},onDismiss:Kc})};function Vc(e){let{optionType:t,integration:n}=e;return"preview"===t?(0,k.jsx)(ne.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview"}):"mention"===t?(0,k.jsx)(ne.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention"}):"link"===t?(0,k.jsx)(ne.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link"}):"drive"===t?(0,k.jsx)(ne.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsDrive.title",defaultMessage:"Paste as embed"}):"collection"===t?(0,k.jsx)(ne.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Paste as database"}):"import"===t?(null==n?void 0:n.id)===Fc.mC?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ne.FormattedMessage,{id:"unfurlingMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,k.jsx)(Yt.Z,{style:{display:"inline"}})]}):(0,k.jsx)(ne.FormattedMessage,{id:"unfurlingMenu.actions.import.title",defaultMessage:"Import from {integration}",values:{integration:null==n?void 0:n.name}}):void(0,D.t1)(t)}function Ec(e,t,n){f.createAndCommit({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:n,canUndo:!1,perform:s=>{rn.hJ({environment:n,type:Uc(e),useTemporaryRecordCache:!0,transaction:s,intl:t})}})}function Nc(e,t){var n,s;let i;const o=Oc.Z.state,a=Dc.Z.state;if(o.open&&(i=o.integration.name),Os.kM(t,{unfurl_option_type:e||"default",integration:i||"default"}),"import"===e&&a&&o.open){let e;switch(o.integration.id){case Fc.Aw:e="asana";break;case Fc.f3:const t=(0,_c.Tf)({url:o.url,integration:o.integration});if(t){const e=t.find((e=>"title"===e.id)),n=null==e?void 0:e.values[0];Bc.Z.setState({...Bc.Z.state,selectedFileId:n})}e="gdocs";break;case Fc.mC:const i=O.default.state.mainEditorCurrentBlockStore,a=i&&(null===(n=(0,Ac.VP)(i))||void 0===n?void 0:n.id),r=/\/projects\/(\w+)\//,l=null===(s=o.url.match(r))||void 0===s?void 0:s[1];Rc.Z.setState({...Rc.Z.state,teamSpaceId:a,projectKeys:l?[l]:[]}),e="jira"}Dc.Z.setState({...a,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:e,openedFrom:"link_paste"})}f.createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,perform:n=>{rn.xv({environment:t,setType:e?Uc(e):void 0,transaction:n})}})}function Uc(e){return"import"===e?"link":e}function Kc(e){Nc(void 0,e)}const Wc=function(){const e=(0,i.Fy)(),t=(0,i.O7)(),{isMobile:n,isElectron:d}=e;(0,s.useEffect)((()=>{if(n){function e(e){e.preventDefault()}return document.addEventListener("gesturestart",e),()=>{document.removeEventListener("gesturestart",e)}}}),[n]);const{currentSpaceStore:u,teamsEnabled:m}=(0,o.VK)((()=>({currentSpaceStore:O.default.state.currentSpaceStore,teamsEnabled:(0,F.bq)()})),[]),p=(0,o.VK)((()=>U.default.checkGate({gateName:"custom_emojis"})),[]);(0,s.useEffect)((()=>{function e(){K.Z.setState({open:!0})}function t(){K.Z.setState({open:!1})}return a.inPageSearch.started.addListener(e),a.inPageSearch.stopped.addListener(t),()=>{a.inPageSearch.started.removeListener(e),a.inPageSearch.stopped.removeListener(t)}}),[]),(0,s.useEffect)((()=>{function e(e){e.preventDefault()}return window.addEventListener("dragstart",e),()=>{window.removeEventListener("dragstart",e)}}),[]),(0,s.useEffect)((()=>{function e(e){q.default.state.isActive&&(e.preventDefault(),r.MZ({environment:t,currentX:q.default.state.currentX,currentY:q.default.state.currentY,toggle:e.shiftKey}))}function n(e){q.default.state.isActive&&(e.preventDefault(),r.MZ({environment:t,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))}function s(e){q.default.state.isActive&&((0,P.N9)(e)||e.preventDefault(),r.qw(t))}return window.addEventListener("keydown",e),window.addEventListener("keyup",e),window.addEventListener("mousemove",n),window.addEventListener("mouseup",s),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",e),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",s)}}),[t]);const g=t.currentUser.isLoggedIn();return(0,k.jsxs)(s.Fragment,{children:[(0,k.jsx)(Ne,{}),(0,k.jsx)(l.LazyNewDiscussionMenu,{}),(0,k.jsx)(l.LazyReplyDiscussionMenu,{}),(0,k.jsx)(A,{}),(0,k.jsx)(J.Z,{priority:-1,capture:!0,debugName:"AppComponents"}),(0,k.jsx)(Jl,{}),g&&!n&&(0,k.jsx)(gd,{}),g&&false,g&&u&&(0,k.jsx)(Ia,{rootStore:u}),g&&(0,k.jsx)(bc,{}),g&&m&&(0,k.jsx)(Q,{}),g&&(0,k.jsx)(dn,{}),g&&(0,k.jsx)(E,{}),(0,k.jsx)(lt.Z,{}),(0,k.jsx)(ha,{}),(0,k.jsx)(c.i4,{}),(0,k.jsx)(za,{}),(0,k.jsx)(La,{}),(0,k.jsx)($n,{}),(0,k.jsx)(it,{}),!n&&(0,k.jsx)(tl,{}),(0,k.jsx)(Ss,{}),(0,k.jsx)(Aa,{}),(0,k.jsx)(hi,{}),(0,k.jsx)(at.Z,{store:W.Z}),(0,k.jsx)(at.Z,{store:z.Z}),(0,k.jsx)(ga,{}),(0,k.jsx)(c.KS,{}),(0,k.jsx)(I,{}),(0,k.jsx)(en,{}),(0,k.jsx)(N.Qi,{}),(0,k.jsx)(Lc,{}),(0,k.jsx)(Ps,{}),(0,k.jsx)(Zc,{}),(0,k.jsx)(Je,{}),(0,k.jsx)(yd.Z,{}),(0,k.jsx)(ai,{}),d&&(0,k.jsx)(c.$C,{}),(0,k.jsx)(Dt,{}),(0,k.jsx)(rt.Z,{}),g&&(0,k.jsx)(ec,{}),(0,k.jsx)(ms.s6,{}),(0,k.jsx)(he,{}),p&&(0,k.jsx)(yt,{}),p&&(0,k.jsx)(Pt,{})]})}},3403:(e,t,n)=>{n.d(t,{Z:()=>l});var s=n(667294),i=n(724405),o=n(134232),a=n(568785),r=n(785893);function l(e){let{loadingMessage:t}=e;const n=(0,i.Fg)(),l=(0,o.Z)(!0,400);return(0,r.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:l&&(0,r.jsxs)(s.Fragment,{children:[(0,r.jsx)(a.Z,{}),t&&(0,r.jsx)("div",{style:{marginLeft:8,color:n.text.secondary},children:t})]})})}},513713:(e,t,n)=>{n.d(t,{B:()=>S,Z:()=>v});n(667294);var s=n(313991),i=n(800480),o=n(886628),a=n(724405),r=n(266897),l=n(407057),d=n(709291),c=n(983420),u=n(433929),m=n(825464),p=n(824039),g=n(828992),f=n(672495),h=n(526388),y=n(164369),x=n(785893);function S(e){const t=e.getCreatedByPointer(),n=e.getCreatedTime(),i=e.getLastEditedByPointer(),o=e.getLastEditedTime(),a=u.default.getIntl();if(t&&n&&o&&i){const r=(0,c.ue)({parentStore:e,pointer:t}),d=(0,l.$b)(n,s.SP,a),u=(0,c.ue)({parentStore:e,pointer:i}),m=(0,l.$b)(o,s.SP,a);if(!u)return;return{createdBy:r,createdTime:d,lastEditedBy:u,lastEditedTime:m}}}const v=function(e){let{isPageMoreButton:t,hideTopBorder:n,store:s}=e;const l=(0,o.VK)((()=>S(s)),[s]),{device:c}=(0,i.O7)(),v=(0,o.VK)((()=>c.isPhone),[c]),b=u.default.getIntl(),M=(0,a.yK)((()=>({menuItem:{paddingTop:v?8:n?0:6,paddingBottom:v?8:16}})),[n,v]);return(0,x.jsx)(f.Z,{topBorder:!t&&!n,style:{paddingTop:t?0:8,paddingBottom:t?0:8},children:(0,x.jsx)(g.Z,{style:l?void 0:M.menuItem,shouldWrapTitle:!0,title:l?(0,x.jsx)(h.Z,{placement:m.u.Right,render:e=>(0,x.jsxs)("div",{...e,children:[(0,x.jsx)(y.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:c.isPhone,isMultiline:!0,style:{marginBottom:4},children:(0,x.jsx)(d.FormattedMessage,{id:"blockAuthorInfo.label",defaultMessage:"Last edited by {author}",values:{author:l.lastEditedBy.asActor?(0,r.$4)(b,l.lastEditedBy):void 0}})}),(0,x.jsx)(y.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:c.isPhone,children:l.lastEditedTime})]}),renderTooltip:()=>(0,x.jsx)(p.Z,{store:s,compactFormat:!0})}):void 0,loading:!l})})}},299662:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Pe});n(667294);var s=n(800480),i=n(886628),o=n(429369),a=n(709291),r=n(653965),l=n(401898),d=n(175306),c=n(672495),u=n(135067),m=n(785893);const p=[{key:"block in comment menu primary",render:e=>(0,m.jsx)(c.Z,{...e}),actions:[u.G,d.yN,d.TH]}];var g=n(924212),f=n(482763);const h=[{key:"page mention context menu primary",render:e=>(0,m.jsx)(c.Z,{isTitleUppercase:!1,...e}),actions:[...n(212988).ej,f.K,f.H]}];var y=n(436610),x=n(106404),S=n(628020),v=n(368585),b=n(460709),M=n(918514),j=n(635328),C=n(394841),w=n(240745),k=n(37652),I=n(733907),T=n(908597),Z=n(680988),P=n(853465),F=n(388437),_=n(377734),A=n(173599),B=n(937612),R=n(531701),D=n(62967),O=n(496802),L=n(210228),V=n(541216),E=n(119037),N=n(880025),U=n(433929),K=n(598794);const W=(0,a.defineMessages)({simpleTableHeaderColumn:{id:"action.rowHeader.title",defaultMessage:"Header column"},simpleTableHeaderRow:{id:"action.columnHeader.title",defaultMessage:"Header row"},simpleTableInsertColumnLeft:{id:"action.insertColumnLeft.title",defaultMessage:"Insert Left"},simpleTableInsertColumnRight:{id:"action.insertColumnRight.title",defaultMessage:"Insert Right"},simpleTableClearContents:{id:"action.clearContents.title",defaultMessage:"Clear Contents"},simpleTableInsertRowAbove:{id:"action.insertRowAbove.title",defaultMessage:"Insert Above"},simpleTableInsertRowBelow:{id:"action.insertRowBelow.title",defaultMessage:"Insert Below"},textColorSection:{id:"action.section.textColor",defaultMessage:"Text Color"},backgroundColorSection:{id:"action.section.backgroundColor",defaultMessage:"Background Color"}}),z=(0,D.N$)({key:"simple table header column",displayName:W.simpleTableHeaderColumn,label:U.default.formatMessage(W.simpleTableHeaderColumn),svg:_.s,validators:[E.J5S,E.ffD(E.b47),E.W5_,E.p4X],isEnabled:e=>Boolean(e.getFormat().table_block_row_header),action:(e,t,n)=>O.FH({stores:[t],update:{table_block_row_header:!t.getFormat().table_block_row_header},transaction:n})}),q=(0,D.N$)({key:"simple table header row",displayName:W.simpleTableHeaderRow,label:U.default.formatMessage(W.simpleTableHeaderRow),svg:A.f,validators:[E.J5S,E.ffD(E.b47),E.W5_,E.zOn],isEnabled:e=>Boolean(e.getFormat().table_block_column_header),action:(e,t,n)=>O.FH({stores:[t],update:{table_block_column_header:!t.getFormat().table_block_column_header},transaction:n})}),G=(0,D.cN)({key:"insert column left",displayName:W.simpleTableInsertColumnLeft,analyticsName:W.simpleTableInsertColumnLeft.defaultMessage,svg:k.V,validators:[E.J5S,E.ffD(E.OPg),E.W5_,E.z22],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.insertColumnLeft",environment:t,perform:e=>{K.insertColumnLeft({environment:t,transaction:e})}})}}),H=(0,D.cN)({key:"insert column right",displayName:W.simpleTableInsertColumnRight,analyticsName:W.simpleTableInsertColumnRight.defaultMessage,svg:I.n,validators:[E.J5S,E.ffD(E.OPg),E.W5_,E.z22],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.insertColumnRight",environment:t,perform:e=>{K.insertColumnRight({environment:t,transaction:e})}})}}),$=(0,D.cs)({key:"duplicate columns",displayName:D.RE.duplicateName,analyticsName:D.RE.duplicateName.defaultMessage,svg:F.a,validators:[E.J5S,E.ffD(E.OPg),E.W5_,E.z22],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.duplicateColumns",environment:t,perform:e=>{K.duplicateColumns({transaction:e})}})}}),Y=(0,D.cs)({key:"delete columns",displayName:D.RE.deleteName,analyticsName:D.RE.deleteName.defaultMessage,svg:B.y,validators:[E.J5S,E.ffD(E.OPg),E.W5_,E.OTA,E.z22],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.deleteColumns",environment:t,perform:e=>{K.deleteColumns({environment:t,transaction:e})}})}}),Q=(0,D.cN)({key:"clear column contents",displayName:W.simpleTableClearContents,analyticsName:W.simpleTableClearContents.defaultMessage,svg:P.X,validators:[E.J5S,E.ffD(E.OPg),E.W5_,E.z22],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.clearColumnContents",environment:t,perform:e=>{K.clearSelectionContents({environment:t,transaction:e})}}),K.clearSelection()}}),J=(0,D.cN)({key:"insert row above",displayName:W.simpleTableInsertRowAbove,analyticsName:W.simpleTableInsertRowAbove.defaultMessage,svg:T.Z,validators:[E.J5S,E.ffD(E.OPg),E.W5_,E.EJd],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.insertRowAbove",environment:t,perform:e=>{K.insertRowAbove({environment:t,transaction:e})}})}}),X=(0,D.cN)({key:"insert row below",displayName:W.simpleTableInsertRowBelow,analyticsName:W.simpleTableInsertRowBelow.defaultMessage,svg:w.M,validators:[E.J5S,E.ffD(E.OPg),E.W5_,E.EJd],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.insertRowBelow",environment:t,perform:e=>{K.insertRowBelow({environment:t,transaction:e})}})}}),ee=(0,D.cs)({key:"duplicate rows",displayName:D.RE.duplicateName,analyticsName:D.RE.duplicateName.defaultMessage,svg:F.a,validators:[E.J5S,E.ffD(E.OPg),E.W5_,E.EJd],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.duplicateRows",environment:t,perform:e=>{K.duplicateRows({environment:t,transaction:e})}})}}),te=(0,D.cs)({key:"delete rows",displayName:D.RE.deleteName,analyticsName:D.RE.deleteName.defaultMessage,svg:B.y,validators:[E.J5S,E.ffD(E.OPg),E.W5_,E.W3A,E.EJd],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.deleteRows",environment:t,perform:e=>{K.deleteRows({environment:t,transaction:e})}})}}),ne=(0,D.cN)({key:"clear row contents",displayName:W.simpleTableClearContents,analyticsName:W.simpleTableClearContents.defaultMessage,svg:P.X,validators:[E.J5S,E.ffD(E.OPg),E.W5_,E.EJd],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.clearRowContents",environment:t,perform:e=>{K.clearSelectionContents({environment:t,transaction:e})}}),K.clearSelection()}}),se=[E.J5S,E.ffD(E.OPg),E.W5_,E.z22],ie=[E.J5S,E.ffD(E.OPg),E.W5_,E.EJd];function oe(e,t,n,s){const i=s||(0,N.qf)(e),o=(0,D.cN)({key:`color ${n||e}`,displayName:i,analyticsName:i.defaultMessage,fuzzySearchKeywords:(0,D.CJ)(e),validators:"column"===t?se:ie,action:t=>{let{blocks:n,environment:s}=t;L.createAndCommit({userAction:"actionRegistry.createSimpleTableColorAction",environment:s,perform:t=>{K.setColor(s,e,t)}})},closeParentMenu:!0,render:t=>(0,m.jsx)(V.Z,{...t,color:e,overrideDisplayName:o.displayName}),nativeImageReference:t=>{let{environment:s}=t;return(0,D.q7)(s,e,n)}});return o}const ae=(0,D.$J)({key:"simple table column background color actions",title:D.RE.backgroundSection,overrideSearchTitle:D.RE.backgroundSectionKeywords,render:e=>(0,m.jsx)(c.Z,{...e}),actions:[oe("default","column","default background",N.mF.backgroundColorDefault),...R._K.map((e=>oe(e,"column")))]}),re=(0,D.$J)({key:"simple table column text color actions",title:D.RE.colorSection,overrideSearchTitle:D.RE.colorSection,render:e=>(0,m.jsx)(c.Z,{...e}),actions:[...R.CY.map((e=>oe(e,"column")))]}),le=(0,D.$J)({key:"simple table row background color actions",title:D.RE.backgroundSection,overrideSearchTitle:D.RE.backgroundSectionKeywords,render:e=>(0,m.jsx)(c.Z,{...e}),actions:[oe("default","row","default background",N.mF.backgroundColorDefault),...R._K.map((e=>oe(e,"row")))]}),de=(0,D.$J)({key:"simple table row text color actions",title:D.RE.colorSection,overrideSearchTitle:D.RE.colorSection,render:e=>(0,m.jsx)(c.Z,{...e}),actions:[...R.CY.map((e=>oe(e,"row")))]}),ce=(0,D.MV)({key:"set column color",displayName:D.RE.colorName,analyticsName:D.RE.colorName.defaultMessage,svg:Z.U,validators:se,subActions:()=>[{key:0,title:U.default.formatMessage(W.textColorSection),render:e=>(0,m.jsx)(c.Z,{...e}),actions:re.actions},{key:1,title:U.default.formatMessage(W.backgroundColorSection),render:e=>(0,m.jsx)(c.Z,{...e}),actions:ae.actions}]}),ue=(0,D.MV)({key:"set row color",displayName:D.RE.colorName,analyticsName:D.RE.colorName.defaultMessage,svg:Z.U,validators:ie,subActions:()=>[{key:0,title:U.default.formatMessage(W.textColorSection),render:e=>(0,m.jsx)(c.Z,{...e}),actions:de.actions},{key:1,title:U.default.formatMessage(W.backgroundColorSection),render:e=>(0,m.jsx)(c.Z,{...e}),actions:le.actions}]}),me=[(0,D.$J)({key:"column section",render:e=>(0,m.jsx)(c.Z,{...e}),actions:[z,ce,G,H,$,Q,Y]}),(0,D.$J)({key:"row section",render:e=>(0,m.jsx)(c.Z,{...e}),actions:[q,ue,J,X,ee,ne,te]})];var pe=n(223196),ge=n(80444),fe=n(708949),he=n(206258),ye=n(27724),xe=n(513713),Se=n(980209),ve=n(748019),be=n(256940),Me=n(268894),je=n(203386),Ce=n(478140),we=n(840721),ke=n(953437),Ie=n(483182);function Te(){const e=(0,i.VK)((()=>fe.Z.state),[]);return(0,m.jsx)(be.Z,{capture:e.isActive,ignoreBlockSelection:!1,restoreSelection:!0,render:()=>(0,m.jsx)(Ze,{})})}function Ze(){const e=(0,s.Fy)(),t=(0,i.VK)((()=>fe.Z.state),[]);return(0,m.jsx)(ke.ZP,{popupType:e.isPhone?pe.k.SlideUp:pe.k.Popup,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:Ae,placementToOrigin:ke.ZP.Placement.Bottom,alignmentToOrigin:ke.ZP.Alignment.Start,originGap:0,preventScaleTransition:!0,render:()=>(0,m.jsx)(De,{}),preventBlockRenderQueueOnEnter:e.isMobile})}const Pe=(0,a.injectIntl)((function(){const e=(0,s.Fy)();return e.isMobileNative&&e.isIOS&&e.isPhone?(0,m.jsx)(Te,{}):(0,m.jsx)(Ze,{})}));function Fe(){const[e,t]=(0,i.VK)((()=>{const e=fe.Z.state;if(!e.isActive)return[!1,!1];const t=e.stores[0];return[!0,(0,S.qG)(t.id)]}),[]);return e?t?(0,m.jsx)(c.Z,{topBorder:!0,children:(0,m.jsx)(Ie.Z,{title:(0,m.jsx)(a.FormattedMessage,{defaultMessage:"Learn about tasks",id:"myTasks.helpTooltip.title"}),href:C.su,analyticsFrom:"block_menu"})}):(0,m.jsx)(c.Z,{topBorder:!0,children:(0,m.jsx)(Ie.Z,{title:(0,m.jsx)(a.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,M.UY)("guides.database"),analyticsFrom:"block_menu"})}):null}function _e(){const e=(0,s.O7)(),t=(0,i.VK)((()=>fe.Z.state),[]),n=(0,i.VK)((()=>e.currentUser.isLoggedIn()),[e]),o=(0,i.VK)((()=>t.isActive&&1===t.stores.length&&(0,S.qG)(t.stores[0].id)),[t]);return n?!t.isActive||t.stores.length>1||o?null:(0,m.jsx)(xe.Z,{store:t.stores[0],isPageMoreButton:!1}):null}function Ae(){x.xv()}function Be(e){fe.Z.state.isActive&&fe.Z.setState({...fe.Z.state,inputValue:e.target.value})}function Re(){const e=(0,a.useIntl)(),t=(0,s.MO)(),n=(0,i.VK)((()=>fe.Z.state),[]);if(!n.isActive||t)return null;const{inputValue:o}=n;return(0,m.jsx)(c.Z,{isInput:!0,children:(0,m.jsx)(Me.ZP,{value:o,onChange:Be,focus:!0,focusAfterAnimation:!0,placeholder:e.formatMessage({defaultMessage:"Search actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0})})}function De(){var e;const t=(0,s.O7)(),n=(0,s.MO)(),c=(0,i.VK)((()=>fe.Z.state),[]),u=null===(e=c.stores)||void 0===e?void 0:e[0],f=(0,i.VK)((()=>null==u?void 0:u.isCollectionView()),[u]),S=(0,i.VK)((()=>c.isActive?function(e){switch(e){case"default":return d.Qi;case"simple_table":return me;case"page_mention":return h;case"sidebar_outliner":return g.Oq;case"comment_media":return p;case"block_in_collection_timeline_view":return d.KC;case"block_in_collection":return d.p0;default:(0,l.t1)(e)}}(null==c?void 0:c.actionSectionGroupKey):[]),[c]);if(!c.isActive||!u)return null;const{originBlockRect:M,inputValue:C,publicEditMode:w}=c||{},k={environment:t,blocks:c.stores,originRect:M,publicEditMode:w},I=c.showInput&&(0,m.jsx)(Re,{});let T;return T=n?{menuType:b.og.Modal,title:(0,m.jsx)(a.FormattedMessage,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:(0,m.jsx)(we.DoneMenuText,{}),onClickRight:Ae,header:I}:{menuType:b.og.Popup,width:265,header:I},(0,m.jsx)(je.Z,{debugName:"BlockMenu",capture:!0,onBackspace:r.yR,children:(0,m.jsxs)(Ce.Z,{...T,children:[(0,m.jsx)(ve.Z,{filter:C,context:k,sections:S,onAccept:e=>function(e,t){const n=fe.Z.state;if(!n.isActive)return;const{stores:s}=ye.default.state,{analyticsFrom:i,collectionContextStore:a}=n,r=s[0];if(r){const n=r.getParentTable(),s=r.getType();if(s&&n){let l;if(n===o.e0){const e=r.getParentId(),{currentSpaceStore:t}=ge.default.getState();t&&void 0!==e&&(l=he.zX.createChildStore(t,{table:o.e0,id:e}))}const d=(0,v.Pn)(a)||{};y.dh(t,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:i,block_id:r.id,block_type:s,parentTeamStore:l,is_toggleable:(0,j._A)(s,r.getFormat()),parent_collection_id:r.getParentCollectionIdUpToTwoLevels(),...d})}}e.closeParentMenu&&x.xv()}(e,t),initialFocus:C?0:void 0}),!C&&(0,m.jsx)(_e,{}),!C&&(0,m.jsx)(Se.Z,{store:u}),!C&&f&&(0,m.jsx)(Fe,{})]})})}},980209:(e,t,n)=>{n.d(t,{Z:()=>x});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(186517),l=n(709291),d=n(137810),c=n(547307),u=n(476464),m=n(18878),p=n(119037),g=n(798165),f=n(164921),h=n(164369),y=n(785893);const x=function(e){let{store:t}=e;const n=(0,a.Fg)(),x=(0,i.O7)(),S=(0,s.useMemo)((()=>({environment:x,blocks:[t],publicEditMode:void 0})),[x,t]),v=(0,o.VK)((()=>p.xDy([p.Xa0,p.ffD(p.J5S)])(S)),[S]),b=(0,o.VK)((()=>p.xDy([p.c2G,p.ffD(p.zzA)])(S)),[S]);if(v){const{device:e}=x;return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)("div",{style:{backgroundColor:n.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${n.regularDividerColor}`,marginTop:e.isMobile?28:1},children:(0,y.jsxs)(f.Z,{disabled:!b,style:{padding:12},onClick:()=>async function(e,t){const n=e.getPermissionItems(),s=g.Om(e),i=s?r.Wo(g.fJ(s)):[],o={type:"restore",permissionChanges:r.Xr(n,i)};await c.confirmUserAction({message:(0,m.mX)(o),acceptLabel:(0,m.nH)(o),cancelLabel:(0,y.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,y.jsx)(m.mo,{openState:o})})&&u.hs({environment:t,store:e})}(t,x),children:[(0,y.jsx)(h.Z,{isMultiline:!0,isSmall:!0,children:(0,y.jsx)(l.FormattedMessage,{id:"blockMenuRestrictedMessage.label",defaultMessage:"You don’t have permission to edit this block because it is restricted."})}),b&&(0,y.jsx)(h.Z,{style:{marginTop:6,fontWeight:d.Z.fontWeight.semibold},children:(0,y.jsx)(l.FormattedMessage,{id:"blockMenuRestrictedMessage.adminRestoreAction.label",defaultMessage:"Restore permissions"})})]})})})}return null}},781870:(e,t,n)=>{n.d(t,{Z:()=>c});n(667294);var s=n(800480),i=n(724405),o=n(584169),a=n(225888),r=n(573063),l=n(316354),d=n(785893);const c=function(e){const t=(0,s.O7)(),n=(0,i.Fg)();return(0,d.jsx)(l.Z,{href:e.href,external:!0,onClick:()=>a.Fs(t,{from:e.helpButtonContext}),children:(0,d.jsx)(r.Z,{icon:o.m,style:{height:24,width:24,marginRight:-6,fill:n.mediumIconColor}})})}},752500:(e,t,n)=>{n.r(t),n.d(t,{CollectionTypedDatabaseMigrationModal:()=>ae});var s=n(667294),i=n(886628),o=n(724405),a=n(371663),r=n(709291),l=n(296994),d=n(152489),c=n(841892),u=n(745238),m=n(785893);const p=(0,u.IU)("drawing",{viewBox:"0 0 12 12",svg:(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("path",{d:"M2.606 9.98a6.714 6.714 0 01-1.162-1.538A6.54 6.54 0 01.8 6.752a5.933 5.933 0 01-.132-1.698c.042-.557.17-1.081.38-1.573.216-.494.512-.932.89-1.313a4.043 4.043 0 011.347-.898A4.761 4.761 0 014.887.928a5.48 5.48 0 011.68.185c.56.15 1.09.381 1.591.694l-.845.83a4.757 4.757 0 00-1.152-.435 4.372 4.372 0 00-1.23-.127c-.41.013-.804.093-1.182.24-.374.146-.71.367-1.006.664a3.09 3.09 0 00-.796 1.352 4.196 4.196 0 00-.117 1.646c.068.576.236 1.14.503 1.694.27.553.63 1.055 1.08 1.504.276.28.564.516.863.708a6 6 0 00.884.469c.287.123.552.22.796.288.247.071.456.127.625.166a.784.784 0 01.4.215c.092.1.136.23.132.39-.006.186-.078.322-.215.41-.136.091-.314.12-.532.088a6.388 6.388 0 01-.698-.151 7.184 7.184 0 01-1.997-.903 6.64 6.64 0 01-1.065-.875zm1.968-1.523L5.8 7.988a3.6 3.6 0 00.874.635c.329.17.669.282 1.02.337.352.055.694.039 1.026-.049a2.03 2.03 0 00.903-.542 1.85 1.85 0 00.537-1.035 2.906 2.906 0 00-.083-1.294 4.542 4.542 0 00-.64-1.348l.826-.82c.341.475.599.962.771 1.46.176.495.27.978.283 1.45.013.472-.055.913-.205 1.323a2.913 2.913 0 01-.678 1.075c-.3.3-.647.52-1.04.664-.391.14-.804.208-1.24.205-.434 0-.867-.064-1.3-.19a5.255 5.255 0 01-1.24-.547 4.715 4.715 0 01-1.04-.855zM5.6 7.48l-1.177.445c-.085.032-.165.014-.24-.054a.21.21 0 01-.053-.244l.459-1.162 4.443-4.439 1.011 1.011L5.6 7.48zm4.819-4.814l-1.01-1.01.468-.47a.716.716 0 01.44-.21.481.481 0 01.414.142l.176.171a.551.551 0 01.171.45.703.703 0 01-.205.453l-.454.474z"})})});var g=n(781570),f=n(137810),h=n(433929),y=n(713484),x=n(244731),S=n(751077),v=n(132662),b=n(164369);const M=(0,r.defineMessages)({dummyTask1:{id:"MyTasksWidgetPreview.dummyTask1",defaultMessage:"Set up sync with Lisa"},dummyTask2:{id:"MyTasksWidgetPreview.dummyTask2",defaultMessage:"Review design docs"},dummyTask3:{id:"MyTasksWidgetPreview.dummyTask3",defaultMessage:"Create color palette"},dummyTask4:{id:"MyTasksWidgetPreview.dummyTask4",defaultMessage:"Book flight to New York"},dummyTask5:{id:"MyTasksWidgetPreview.dummyTask5",defaultMessage:"Fix broken links"},dummyTask6:{id:"MyTasksWidgetPreview.dummyTask6",defaultMessage:"Upgrade database"},Blocked:{id:"MyTasksWidgetPreview.blockedStatus",defaultMessage:"Blocked"},"In Progress":{id:"MyTasksWidgetPreview.inProgressStatus",defaultMessage:"In Progress"},"Not Started":{id:"MyTasksWidgetPreview.notStartedStatus",defaultMessage:"Not Started"},locationIndicator:{id:"MyTasksWidgetPreview.locationIndicator",defaultMessage:"In"}}),j=[{icon:"📅",taskName:h.default.formatMessage(M.dummyTask1),status:"Blocked",teamspace:"Eng",location:(0,g.T)({width:13,fill:"#448361"})},{icon:"📚",taskName:h.default.formatMessage(M.dummyTask2),status:"In Progress",teamspace:"Design",location:p({width:13,fill:"#CB912F"})},{icon:"🎨",taskName:h.default.formatMessage(M.dummyTask3),status:"In Progress",teamspace:"Design",location:p({width:13,fill:"#CB912F"})},{icon:"🛫",taskName:h.default.formatMessage(M.dummyTask4),status:"Not Started",teamspace:"Eng",location:(0,g.T)({width:13,fill:"#448361"})},{icon:"🚧",taskName:h.default.formatMessage(M.dummyTask5),status:"Not Started",teamspace:"Design",location:p({width:13,fill:"#CB912F"})},{icon:"👩‍💻",taskName:h.default.formatMessage(M.dummyTask6),status:"Not Started",teamspace:"Eng",location:(0,g.T)({width:13,fill:"#448361"})}],C={Blocked:"red","In Progress":"blue","Not Started":"gray"};function w(){const e=T();return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(y.Z,{title:(0,m.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Title",defaultMessage:"My tasks"}),tooltip:void 0,icon:(0,m.jsx)("div",{style:{paddingLeft:4},children:(0,m.jsx)(S.Z,{type:"app_package_asset",size:18,icon:c.Z.images.appPackages.taskDbIconSvg})}),children:(0,m.jsx)("div",{style:e.dummyAssignedToMe,children:(0,m.jsx)(k,{})})})})}function k(){const e=j.map(((e,t)=>(0,m.jsx)(I,{row:e},t)));return(0,m.jsx)("div",{style:{display:"flex",marginTop:4,paddingRight:16,flexDirection:"column"},children:e})}function I(e){let{row:t}=e;const n=T();return(0,m.jsxs)("div",{style:n.eachTask,children:[(0,m.jsxs)("div",{style:n.taskName,children:[(0,m.jsx)("span",{style:n.taskIcon,children:t.icon}),(0,m.jsx)(b.Z,{style:n.taskTitle,children:t.taskName})]}),(0,m.jsx)("div",{style:n.taskStatus,children:(0,m.jsx)(x.J,{type:"status",value:h.default.formatMessage(M[t.status]),color:C[t.status],groupColor:void 0})}),(0,m.jsx)(v.Z,{size:8}),(0,m.jsxs)("div",{style:n.location,children:[(0,m.jsx)("span",{style:n.locationIndicator,children:h.default.formatMessage(M.locationIndicator)}),(0,m.jsx)("div",{style:{...n.locationIcon,..."Design"===t.teamspace?{...n.designTeamspace}:{...n.engTeamspace}},children:t.location})]})]})}function T(){return(0,o.yK)((e=>({dummyAssignedToMe:{width:"60%",maxHeight:270,minHeight:90,paddingBottom:10},eachTask:{display:"flex",alignItems:"center",padding:4},taskName:{width:220,display:"flex",...f.Z.textOverflowStyle},taskIcon:{fontSize:14,marginRight:8},taskTitle:{color:e.regularTextColor,fontSize:14,fontWeight:500},taskStatus:{display:"flex",width:130},location:{display:"flex",alignItems:"center"},locationIndicator:{color:e.mediumTextColor,marginRight:4,maxWidth:48,...f.Z.textOverflowStyle},locationIcon:{display:"flex",justifyContent:"center",fontSize:14,height:18,width:18,borderRadius:4},designTeamspace:{backgroundColor:"light"===e.mode?"#FBF3DB":"#5c3b23"},engTeamspace:{backgroundColor:"light"===e.mode?"#E5F2E2":"#243d30"}})),[])}var Z=n(800480),P=n(815145),F=n(172111),_=n(12396),A=n(542853),B=n(747453),R=n(531701),D=n(108406),O=n(164964),L=n(210228),V=n(691851),E=n(416536),N=n(940663),U=n(51592),K=n(721214),W=n(460709),z=n(394841),q=n(960709),G=n(801310),H=n(552275),$=n(231945),Y=n(478140),Q=n(632163),J=n(685740),X=n(158297),ee=n(672495),te=n(474523);function ne(e){const t=(0,Z.O7)(),n=(0,r.useIntl)(),l=(0,Z.MO)(),c=(0,i.VK)((()=>l&&t.device.isMobileNative),[t.device.isMobileNative,l]),u=function(e){return(0,o.yK)((t=>({formTitle:{display:"inline-flex"},emojiTitle:{fontSize:36,marginRight:8},perPropertyInstruction:{color:t.mediumTextColor,fontSize:e?14:12,marginBottom:8},requiredPropertyError:{color:R.ZP.red,fontSize:e?14:12,marginRight:e?8:6},propertyMappingInstructions:{marginTop:6,marginBottom:24,fontSize:e?16:14,fontWeight:e?500:400},propertyMappingDropdown:{display:"flex",alignItems:"center"},chevronDownIconEnabled:{width:e?14:10,fill:t.lightIconColor},propertyMappingTitle:{fontSize:e?16:14,color:t.lightTextColor},propertyMappingMenu:{borderRadius:4,border:`1px solid ${t.tableDividerColor}`,boxShadow:"none"},propertyConversionCallout:{display:"flex",alignItems:"center",marginLeft:4,marginTop:3,color:t.lightTextColor},a:{color:"white",cursor:"pointer"},propertyIcon:{fill:t.darkTextColor},buttons:{marginBlockStart:e?"auto":void 0},submitMigrationButton:{display:"flex",height:e?36:32,fontSize:e?16:14},learnMore:{display:"flex",justifyContent:"center",marginTop:8,marginLeft:0,width:"100%"},learnMoreButton:{display:"inline-flex",justifyContent:"center",width:"100%",height:26},closeButton:{width:"100%",height:36,marginTop:8,display:"inline-flex",justifyContent:"center",fontSize:16,color:t.lightTextColor}})),[e])}(l),p=(0,o.Fg)(),{databaseType:g,collectionContextStore:f}=e,[h,y]=(0,s.useState)(!1),x=(0,i.VK)((()=>{var e;return null===(e=f.collectionStore())||void 0===e?void 0:e.getSchema()}),[f]),S=(0,i.VK)((()=>N.ck((0,E.appConfigs)(),g)),[g]),M=(0,i.VK)((()=>{if(x&&S)return N.Au(S,x)}),[S,x]),j=(0,i.VK)((()=>{const e={};return Object.keys(S||{}).filter((e=>void 0!==(null==S?void 0:S[e])&&e.startsWith("notion://"))).forEach((t=>{e[t]=void 0})),Object.entries(M||{}).forEach((t=>{let[n,s]=t;e[n]=s})),e}),[S,M]),[C,w]=(0,s.useState)(j),k=(0,s.useMemo)((()=>Object.entries(C).some((e=>{let[t,n]=e;if(t===a.Es.Status){const e=null==x?void 0:x[n||""];if("checkbox"===(null==e?void 0:e.type)||"select"===(null==e?void 0:e.type))return!0}}))),[x,C]),I=(0,s.useCallback)(((e,t)=>{const n=t.type;return N.fm(e,t,x??{}).map((e=>{let[t,s]=e;return{key:t,title:null==s?void 0:s.name,icon:(0,m.jsx)(_.ZP,{size:16,style:u.propertyIcon,theme:p,icon:null==s?void 0:s.icon,type:(null==s?void 0:s.type)||n})}}))}),[p,u.propertyIcon,x]),T=(0,s.useCallback)((e=>{const t=null==S?void 0:S[e],s={width:16,height:16,marginRight:10};if(!t)return null;const i=[...I(e,t),{key:F.bK,title:n.formatMessage(se.createNew),icon:(0,B.R)({width:s.width,fill:u.propertyIcon.fill}),type:void 0}],o=C[e],d=null==x?void 0:x[o||""],c=!o&&h,p=e===a.Es.Status;let g=null;return o===F.bK?g=(0,B.R)(s):d&&(g=_.wG[null==d?void 0:d.type](s)),(0,m.jsx)($.ZP,{popupType:l?$.Z4.SlideUp:$.Z4.Popup,renderOrigin:t=>(0,m.jsxs)("div",{style:{marginBottom:24},children:[(0,m.jsx)(b.Z,{isMultiline:!0,style:u.perPropertyInstruction,children:(0,m.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.PerPropertyInstructions",defaultMessage:"Pick the property that represents {propertyDescription}",values:{propertyDescription:n.formatMessage(ie[e])}})}),(0,m.jsx)(H.Z,{focused:!1,right:(0,m.jsxs)("div",{style:u.propertyMappingDropdown,children:[c?(0,m.jsx)("span",{style:u.requiredPropertyError,children:(0,m.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.RequiredPropertyError",defaultMessage:"Required"})}):void 0,(0,A.i)({...u.chevronDownIconEnabled,...c?{fill:R.ZP.red}:{}})]}),rightStyle:{marginRight:l?14:8},title:(0,m.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[g,o===F.bK?n.formatMessage(se.createNew):d?d.name:n.formatMessage(se.select)]}),titleStyle:o?{display:"flex",alignItems:"center"}:u.propertyMappingTitle,itemMarginLeft:8,style:{...u.propertyMappingMenu,...c?{borderColor:R.ZP.red}:{}},buttonStyle:{margin:0,width:"100%"},...t}),p&&k&&(0,m.jsx)(b.Z,{isSmall:!0,isMultiline:!0,children:(0,m.jsx)("div",{style:u.propertyConversionCallout,children:(0,m.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CheckboxSelectMappingInfo",defaultMessage:"This property will be converted to a Status property type."})})})]}),placementToOrigin:q.Iw.Bottom,alignmentToOrigin:q.lU.Start,render:t=>{const n=[{key:"propertyOptions",render:e=>(0,m.jsx)(ee.Z,{...e,topBorder:0!==e.index}),items:i.map((n=>{const s={key:n.key,render:t=>(0,m.jsx)(H.Z,{...t,icon:n.icon,title:n.title,checkState:C[e]===n.key}),action:()=>{w({...C,[e]:n.key}),y(!1),t.close()}};return s}))}],s=l?{menuType:W.og.ActionSheet}:{menuType:W.og.Popup,width:250};return(0,m.jsx)(Y.Z,{...s,children:(0,m.jsx)(Q.Z,{type:Q.i.Vertical,initialFocus:void 0,sections:n})})}},e)}),[S,I,n,u,C,x,h,k,l]),ne=(0,s.useCallback)((()=>{var e,s;const i=f.collectionStore(),o=f.collectionViewBlockStore();if(!i||!o)return;const l=(0,z.J2)("main"),p=null==l||null===(e=l.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:null==l?void 0:l.getRecordModel,pageVisitSource:P.tY.TypedDBConversionToast}),h=(0,z.J2)("myTasks"),x=null==h||null===(s=h.getModel())||void 0===s?void 0:s.getRenderUrl({getRecordModel:null==h?void 0:h.getRecordModel,pageVisitSource:P.tY.TypedDBConversionToast});!function(e){return!Object.values(e).includes(void 0)}(C)?y(!0):L.createAndCommit({userAction:"CollectionTypedDatabaseMigrationModal.migrateDatabase",environment:t,perform:e=>{V.vD({environment:t,collectionViewBlockStore:o,collectionStore:i,databaseType:g,propertyMapping:{...C},typedPropertySchemas:{...S},transaction:e}),d.Z.setState({isModalOpen:!1,collectionContextStore:void 0}),g===a.iS&&(K.y.locallyMutatedTasksDatabase=!0),D.g2({environment:t,database_type:g,property_mapping:C,collectionContextStore:f});const s=c?(0,m.jsx)(r.FormattedMessage,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>My tasks</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage.nativePhone",values:{singularType:(0,U.sN)(g),databaseName:i.getName()||n.formatMessage(se.defaultCollectionName),span:e=>(0,m.jsx)("span",{children:e}),a:e=>(0,m.jsx)("a",{style:u.a,href:x,children:e})}}):(0,m.jsx)(r.FormattedMessage,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>Home</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage",values:{singularType:(0,U.sN)(g),databaseName:i.getName()||n.formatMessage(se.defaultCollectionName),span:e=>(0,m.jsx)("span",{children:e}),a:e=>(0,m.jsx)("a",{style:u.a,href:p,children:e})}});O.d4({item:{label:s,durationMs:G.JY},undoFunc:()=>{L.createAndCommit({environment:t,userAction:"CollectionTypedDatabaseMigrationModal.TypedDBConversionToast.Undo",perform:e=>{V.RQ({environment:t,collectionContextStore:f,transaction:e})}})}})}})}),[f,C,t,g,S,c,n,u.a]);return(0,m.jsxs)("div",{style:e.containerStyle,children:[(0,m.jsxs)("div",{style:u.formTitle,children:[l?(0,m.jsx)("span",{style:u.emojiTitle,children:"📋"}):null,(0,m.jsx)(b.Z,{style:u.propertyMappingInstructions,isMultiline:!0,children:(0,m.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Title",defaultMessage:"Task databases require status, assignee, and due date properties."})})]}),l?(0,m.jsx)(v.Z,{size:16}):null,Object.entries(j).map((e=>{let[t,n]=e;return T(t)})),(0,m.jsxs)("div",{style:u.buttons,children:[(0,m.jsx)(X.Z,{style:u.submitMigrationButton,onClick:ne,children:(0,m.jsx)(r.FormattedMessage,{defaultMessage:"Turn into {type} database",id:"CollectionTypedDatabaseMigrationModal.ConfirmMigration.Title",values:{type:(0,U.sN)(g)}})}),l?(0,m.jsx)(J.Z,{style:u.closeButton,onClick:()=>d.Z.reset(),children:(0,m.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.Close",defaultMessage:"Close"})}):(0,m.jsx)(te.Z,{title:(0,m.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.Info",defaultMessage:"Learn about {type} databases",values:{type:(0,U.sN)(g)}}),analyticsFrom:"set_database_type",href:z.su,style:u.learnMore,buttonStyle:u.learnMoreButton})]})]})}const se=(0,r.defineMessages)({createNew:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CreateNew",defaultMessage:"Create new"},select:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Select",defaultMessage:"Select..."},defaultCollectionName:{id:"CollectionTypedDatabaseMigrationModal.PropertyMappingToastSuccess.DefaultCollectionName",defaultMessage:"This database"},taskStatus:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskStatus",defaultMessage:"status"},taskAssignee:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskAssignee",defaultMessage:"assignee"},taskDueDate:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskDueDate",defaultMessage:"due date"}}),ie={[a.Es.Status]:se.taskStatus,[a.Es.Assign]:se.taskAssignee,[a.Es.DueDate]:se.taskDueDate},oe=32;function ae(){const e=ce(),t=(0,i.VK)((()=>d.Z.state),[]),n=t.isModalOpen;return n?(0,m.jsx)(l.Jq,{shouldShow:n,calloutId:"tasks_migration_modal",desktopOnDismiss:()=>d.Z.reset(),desktopInnerStyle:e.desktopInner,desktopRenderInner:()=>(0,m.jsx)(le,{collectionContextStore:t.collectionContextStore}),phoneInnerStyle:e.phoneInner,phoneRenderInner:()=>(0,m.jsx)(de,{collectionContextStore:t.collectionContextStore})}):null}const re=450;function le(e){const t=ce();return(0,m.jsxs)("div",{style:{display:"flex",flexDirection:"column",position:"relative"},children:[(0,m.jsxs)("div",{style:t.title,children:[(0,m.jsx)("span",{style:t.emojiTitle,children:"📋"}),(0,m.jsx)(b.Z,{isMultiline:!0,style:t.previewTitle,children:(0,m.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Description",defaultMessage:"See all your tasks across multiple databases in your personal Home."})})]}),(0,m.jsx)(v.Z,{size:36}),(0,m.jsx)(w,{}),(0,m.jsx)(ne,{collectionContextStore:e.collectionContextStore,databaseType:a.iS,containerStyle:t.form})]})}function de(e){const t=ce();return(0,m.jsx)(ne,{collectionContextStore:e.collectionContextStore,databaseType:a.iS,containerStyle:t.phoneForm})}function ce(){return(0,o.yK)((e=>({desktopInner:{width:768,height:re,padding:oe},phoneInner:{width:"100%",height:"100%"},title:{display:"flex",maxWidth:"60%",alignItems:"center"},emojiTitle:{fontSize:36,marginRight:16},previewTitle:{color:e.regularTextColor,width:350,fontSize:17,fontWeight:500},form:{width:"45%",height:re,background:e.sidebarBackground,position:"absolute",top:-oe,right:-oe,padding:oe,zIndex:1,borderLeft:`1px solid ${e.tableDividerColor}`,overflowY:"auto"},phoneForm:{display:"flex",flexDirection:"column",width:"100%",height:"100%",padding:oe}})),[])}},785324:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(841892),l=n(686658),d=n(709291),c=n(137810),u=n(619584),m=n(950950),p=n(436867),g=n(45293),f=n(110182),h=n(489728),y=n(158297),x=n(292660),S=n(629551),v=n(785893);function b(){const e=(0,a.yK)(C,[]),t=(0,i.O7)();return(0,v.jsx)(y.Z,{isLarge:!0,style:e.acceptAllButton,onClick:()=>{m.a9(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),g.Z.setState({open:!1}),m.qo()},children:(0,v.jsx)(d.FormattedMessage,{...l.ze.acceptAllButtonLabel})})}function M(){const e=(0,a.yK)(C,[]),t=(0,i.O7)();return(0,v.jsx)(h.Z,{isLarge:!0,isGray:!0,style:e.moreOptionsButton,onClick:()=>{m.a9(t,{necessary:!0,preference:!1,performance:!1,targeting:!1}),g.Z.setState({open:!1}),m.qo()},children:(0,v.jsx)(d.FormattedMessage,{...l.ze.rejectAllButtonLabel})})}function j(){const e=(0,a.yK)(C,[]);return(0,v.jsx)(f.Z,{hasDismissButton:!0,onDismiss:()=>{g.Z.setState({open:!1})},renderOrigin:t=>(0,v.jsx)(h.Z,{...t,isLarge:!0,isGray:!0,style:e.moreOptionsButton,children:(0,v.jsx)(d.FormattedMessage,{...l.ze.moreOptionsButtonLabel})})})}function C(e){return{modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:e.regularTextColor,fontWeight:c.Z.fontWeight.semibold,fontSize:18},description:{color:e.mediumTextColor,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}}}const w=(0,d.injectIntl)((function(){const e=(0,i.O7)().currentUser.id;(0,s.useEffect)((()=>{if(!e)return;(0,p._)(e);const t=window.setInterval((()=>{(0,p._)(e)}),u.A0);return()=>{window.clearInterval(t)}}),[e]);const t=(0,o.VK)((()=>g.Z.state.open),[]),n=(0,a.yK)(C,[]);return(0,v.jsx)(x.Z,{onDismiss:()=>{},render:()=>(0,v.jsx)("div",{style:n.modal,children:(0,v.jsxs)(S.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,v.jsx)("img",{style:n.image,src:r.Z.images.feedbackThankYouPng}),(0,v.jsx)("div",{style:n.title,children:(0,v.jsx)(d.FormattedMessage,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences"})}),(0,v.jsx)("div",{style:n.description,children:(0,l.Fd)(m.Tz,"banner")}),(0,v.jsx)(b,{}),(0,v.jsx)(M,{}),(0,v.jsx)(j,{})]})}),isOpen:t})}))},642607:(e,t,n)=>{n.r(t),n.d(t,{default:()=>pe});var s=n(667294),i=n(800480),o=n(886628),a=n(579257),r=n(111599),l=n(223196),d=n(80444),c=n(485680),u=n(188923),m=n(953437),p=n(724405),g=n(815145),f=n(406695),h=n(295519),y=n(509999),x=n(890199),S=n(405829),v=n(492607),b=n(537888),M=n(709291),j=n(653965),C=n(137810),w=n(436610),k=n(496802),I=n(210228),T=n(502005),Z=n(459827),P=n(484210),F=n(460709),_=n(918514),A=n(592547),B=n(206258),R=n(781870),D=n(279131),O=n(584076),L=n(478140),V=n(828992),E=n(840721),N=n(489728),U=n(731278),K=n(776798),W=n(672495),z=n(749085),q=n(61766),G=n(43700),H=n(69872),$=n(785893);const Y=z.default.createClass(!1,{name:"HoveredStore"});const Q=function(e){let{schema:t,property:n,format:s,showAsSectionMenu:l,handlePageSectionClick:d,visibility:c,locked:u,store:m}=e;const p=(0,i.O7)(),g=(0,o.qz)(void 0,q.Z),f=(0,o.qz)(void 0,Y),h=(0,o.VK)((()=>f.state),[f]),y=t[n];if(!y)return null;const x=function(e,t){if("hide_if_empty"===t)return r.kq({propertySchema:e})?"hide_if_empty":"show";return t}(y,c);return(0,$.jsx)(H.Z,{onMouseEnter:()=>f.setState(!0),onMouseLeave:()=>f.setState(!1),focused:h,showDragHandle:!p.device.isMobile,showExtensionArrow:!1,propertySchema:y,format:H.L.Name,dontShrinkRight:!0,ignoreLocalHoverState:!0,locked:u,onClick:()=>{u||g.setState({open:!g.state.open})},right:l&&d?(0,$.jsx)(G.Z,{buttonPopupStore:g,visibility:x,visibilityLevels:["show","hide","hide_if_empty","inline","minimal"],locked:u,onSelect:e=>d(e,n,s),onClose:()=>f.setState(!1),type:"relation_property",propertySchema:y,showAsMenu:!0}):(0,$.jsx)(G.Z,{buttonPopupStore:g,visibility:x,locked:u,onSelect:e=>function(e,t,n,s,i){I.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:i,perform:i=>{a.M0({property:t,visibility:e,format:n,store:s,transaction:i})}})}(e,n,s,m,p),onClose:()=>f.setState(!1),type:"property",propertySchema:y})},n)};const J=function(e){let{store:t,type:n,locked:s}=e;const r=(0,i.O7)(),l=(0,M.useIntl)(),d=(0,o.qz)(void 0,A.Z),{device:c}=r,u=(0,o.VK)((()=>"page"===n?t.isExternalObjectInstancePageBlockStore():t.isSyncedCollection()),[t,n]);let m;m=c.isMobile?{menuType:F.og.Modal,right:(0,$.jsx)(E.DoneMenuText,{}),onClickRight:a.xv,title:l.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:F.og.Popup,minWidth:400};const p=(0,o.VK)((()=>te(t,ee({store:t,type:n}))),[t,n]),g=(0,o.VK)((()=>d.state.justUnlocked),[d]);return(0,$.jsxs)(L.Z,{...m,header:(0,$.jsx)(se,{store:t,type:n}),children:[(s||g)&&(0,$.jsx)(me,{lockStore:d}),(0,$.jsx)(le,{store:t,locked:s,type:n,lockStore:d,format:p,isSyncedCollection:u}),(0,$.jsx)(re,{type:n,locked:s,store:t,format:p})]})};function X(e){return{propertyVisibility:e.property_visibility,pageSectionVisibility:e.page_section_visibility}}function ee(e){let{type:t,store:n}=e;return n.getSchema()}function te(e,t){const n=e.getFormat();if(!t)return{};return(0,h.i)(n,t,void 0,f.j5.Collection)}function ne(e){let{type:t,store:n}=e;if("collection"!==t)return[];return te(n,ee({type:t,store:n})).collection_page_sections||[]}function se(e){let{store:t,type:n}=e;const s=(0,i.O7)(),r=(0,o.VK)((()=>t&&t.getIcon()),[t]),l=(0,o.VK)((()=>"collection"===n?t.getParentBlockStore():void 0),[t,n]),d=(0,o.VK)((()=>{if(l)return(0,P.ZP)({store:l,fullyQualified:!1,pageVisitSource:g.tY.Breadcrumb})}),[l]);if(s.device.isMobile)return null;if(t){const e=r&&(0,$.jsx)(U.Z,{icon:r,isEmptyPage:!1,size:14,disabled:!0,style:{display:"inline-flex",marginRight:2}}),n=(0,$.jsx)(K.Z,{store:t,style:{display:"inline"}}),s=l?(0,$.jsx)(Z.Q,{prefix:(0,$.jsx)(M.FormattedMessage,{id:"customizePageMenu.header.allPages.label",defaultMessage:"Customize all pages in"}),viewName:l?(0,$.jsx)($.Fragment,{children:(0,$.jsxs)(O.Z,{onClick:a.xv,href:d,inline:!0,children:[e,n]})}):(0,$.jsxs)($.Fragment,{children:[e,n]})}):(0,$.jsx)(M.FormattedMessage,{id:"customizePageMenu.header.singlePage.label",defaultMessage:"Customize this page view"});return(0,$.jsx)(V.Z,{style:T.oq,title:s,right:(0,$.jsx)(R.Z,{helpButtonContext:"customize_page_menu",href:(0,_.UY)("guides.customizePageView")})})}return null}function ie(e,t,n,s){if(s){const i=e.map((e=>s.find((t=>t.section===e))));s&&I.createAndCommit({userAction:"CustomizePageMenu.handleDraggableDropSections",environment:n,perform:e=>{a.Do({environment:n,pageSectionFormats:i,store:t,transaction:e})}})}}function oe(e){var t;let{schema:n,property:s,format:l,locked:d}=e;const c=(0,p.Fg)(),u=(0,i.O7)(),m=(0,o.VK)((()=>(0,r.ab)(void 0,s)),[s]);return(0,$.jsx)("div",{style:{display:"inline-flex",width:"100%"},children:(0,$.jsx)(V.Z,{title:null===(t=n[s])||void 0===t?void 0:t.name,icon:(0,v.v)({height:14,width:14,color:c.mediumIconColor,fill:c.mediumIconColor,fontWeight:C.Z.fontWeight.medium}),disabled:d,showDragHandle:!u.device.isMobile,right:(0,$.jsx)(G.Z,{visibility:m,visibilityLevels:["section_hide","inline","minimal"],locked:d,onSelect:e=>{!function(e,t,n,s,i){const o=r.$0();if(!o)return!1;let l=s.collection_page_sections?j.Xh(s.collection_page_sections):[];if(!n[t])return;const d=l.findIndex((e=>e.section===t));-1!==d?l[d]={section:t,visibility:e}:l=[...l,{section:t,visibility:e}];const c="inline"===e||"minimal"===e?"section":"show";l&&(I.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:i,perform:e=>{a.Do({environment:i,pageSectionFormats:l,store:o,transaction:e}),a.M0({property:t,visibility:c,store:o,format:s,transaction:e})}}),w.K1(i,{from:"page_properties",mode:"inline"===e?"page_section":"minimal"===e?"minimal_page_section":"property"}))}(e,s,n,l,u)},type:"page",showAsMenu:!0})})})}function ae(e){let{keys:t,visibilityMap:n,format:s,onDrop:l,locked:d,store:c,type:u}=e;const m=(0,i.O7)(),p=(0,o.VK)((()=>ee({store:c,type:u})),[c,u]);return c instanceof B.NW?(0,$.jsx)(D.ZP,{direction:"vertical",keys:t,renderKey:e=>{var t;const i=null===(t=p[e])||void 0===t?void 0:t.type;if("collection"===u)return"relation"===i?(0,$.jsx)(Q,{schema:p,visibility:n[e],property:e,format:s,store:c,locked:d,showAsSectionMenu:!0,handlePageSectionClick:(e,t,n)=>function(e,t,n,s){const i=r.$0();if(!i)return;let o=n.collection_page_sections?j.Xh(n.collection_page_sections):[];if("inline"===e||"minimal"===e){const r=o.findIndex((e=>e.section===t));-1!==r?o[r]={section:t,visibility:e}:o=[...o,{section:t,visibility:e}];const l="inline"===e||"minimal"===e?"section":"show";o&&(I.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPageSectionClick",environment:s,perform:e=>{a.Do({environment:s,pageSectionFormats:o,store:i,transaction:e}),a.M0({property:t,visibility:l,store:i,format:n,transaction:e})}}),w.K1(s,{from:"page_properties",mode:"minimal"===e?"minimal_page_section":"page_section"}))}else{const o=f.AX.find((t=>t===e));if(!o)return;I.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPropertyClick",environment:s,perform:e=>{a.M0({property:t,visibility:o,store:i,format:n,transaction:e})}}),w.K1(s,{from:"page_properties",mode:"property"})}}(e,t,n,m)}):(0,$.jsx)(Q,{schema:p,visibility:n[e],property:e,format:s,store:c,locked:d})},onDrop:l}):null}function re(e){let{format:t,type:n,locked:s,store:r}=e;const l=(0,i.O7)(),d=(0,o.VK)((()=>ee({store:r,type:n})),[r,n]),c=(0,o.VK)((()=>ne({store:r,type:n}).filter((e=>"inline"===e.visibility||"minimal"===e.visibility)).map((e=>e.section))),[r,n]),u=(0,o.VK)((()=>function(e){let{type:t,store:n}=e;return"collection"!==t?[]:te(n,ee({type:t,store:n})).collection_page_properties||[]}({store:r,type:n})),[r,n]);if(!d||"page"===n)return null;const m=X(t);if(!m)return null;const{propertyVisibility:p}=m;if(!p)return null;const g=p.reduce(((e,t)=>(e[t.property]=t.visibility,e)),{}),f=j.e5(u.map((e=>e.property)),c);return(0,$.jsx)(W.Z,{style:{opacity:s?.5:1},title:(0,$.jsx)(M.FormattedMessage,{id:"customizePageMenu.propertiesSection.header",defaultMessage:"Properties"}),children:(0,$.jsx)(ae,{keys:f,visibilityMap:g,format:t,onDrop:e=>function(e,t,n,s){if(s){const i=e.map((e=>s.find((t=>t.property===e))));a.D2({environment:n,properties:i,store:t})}}(e,r,l,u),store:r,type:n,locked:s})})}function le(e){let{format:t,isSyncedCollection:n,store:s,locked:a,type:l,lockStore:d}=e;const c=(0,i.O7)(),u=(0,o.qz)(d,A.Z),m=(0,o.VK)((()=>ee({store:s,type:l})),[s,l]),p=(0,o.VK)((()=>ne({store:s,type:l})),[s,l]),g=(0,o.VK)((()=>!a&&!u.state.justUnlocked),[a,u]),f=X(t),{pageSectionVisibility:h}=f,y=(0,o.VK)((()=>(0,r.ab)(h,"margin_comments")),[h]);if(!m||!s)return null;if(!f)return null;if(!h)return null;const x=p.map((e=>e.section)),S={topLevelDiscussions:!n,backLinks:!0,pageComments:!n};return(0,$.jsx)($.Fragment,{children:(0,$.jsx)(W.Z,{style:{opacity:a?.5:1},title:(0,$.jsx)(M.FormattedMessage,{id:"customizePageMenu.sectionsSection.header",defaultMessage:"Sections"}),topBorder:g,children:(0,$.jsxs)("div",{style:{marginLeft:8},children:[x.length>0&&(0,$.jsxs)(W.Z,{style:{opacity:a?.5:1,width:"100%",paddingBottom:0,paddingTop:0},children:[(0,$.jsx)(D.ZP,{direction:"vertical",keys:x,renderKey:e=>{if("collection"===l&&"inline"===(0,r.ab)(void 0,e))return(0,$.jsx)(oe,{locked:a,schema:m,property:e,format:t})},onDrop:e=>ie(e,s,c,p)}),(0,$.jsx)(D.ZP,{direction:"vertical",keys:x,renderKey:e=>{if("collection"===l&&"minimal"===(0,r.ab)(void 0,e))return(0,$.jsx)(oe,{locked:a,schema:m,property:e,format:t})},onDrop:e=>ie(e,s,c,p)})]}),S.topLevelDiscussions&&(0,$.jsx)(de,{pageVisibility:h.comments,locked:a,store:s,format:t}),S.backLinks&&(0,$.jsx)(ce,{pageVisibility:h.backlinks,locked:a,store:s,format:t}),S.pageComments&&(0,$.jsx)(ue,{pageVisibility:y,locked:a,store:s,format:t})]})})})}function de(e){let{pageVisibility:t,locked:n,store:s,format:o}=e;const r=(0,i.O7)();return(0,$.jsx)(V.Z,{title:(0,$.jsx)(M.FormattedMessage,{id:"customizePageMenu.pageSections.topLevelPageDiscussionsTitle",defaultMessage:"Top-level page discussions"}),icon:(0,S.s)({height:16,width:16}),right:(0,$.jsx)(G.Z,{visibility:t,visibilityLevels:["section_show","section_hide"],locked:n,onSelect:e=>{a.W4({environment:r,pageSection:"comments",visibility:e,store:s,format:o})},type:"page"})})}function ce(e){let{pageVisibility:t,locked:n,store:s,format:o}=e;const r=(0,i.O7)();return(0,$.jsx)(V.Z,{title:(0,$.jsx)(M.FormattedMessage,{id:"customizePageMenu.pageSections.backlinksTitle",defaultMessage:"Backlinks"}),icon:(0,y.J)({height:16,width:16,transform:"rotate(180deg)"}),right:(0,$.jsx)(G.Z,{visibility:t,locked:n,visibilityLevels:["section_show","section_hide","section_collapsed"],onSelect:e=>{a.W4({environment:r,pageSection:"backlinks",visibility:e,store:s,format:o})},type:"page"})})}function ue(e){let{pageVisibility:t,locked:n,store:s,format:o}=e;const r=(0,i.O7)();return(0,$.jsx)(V.Z,{title:(0,$.jsx)(M.FormattedMessage,{id:"customizePageMenu.pageSections.pageCommentsTitle",defaultMessage:"Page comments"}),icon:(0,S.s)({height:16,width:16}),right:(0,$.jsx)(G.Z,{visibility:t,visibilityLevels:["inline","minimal"],locked:n,onSelect:e=>{a.W4({environment:r,pageSection:"margin_comments",visibility:e,store:s,format:o})},type:"page"})})}function me(e){let{lockStore:t}=e;const n=(0,p.Fg)(),a=(0,i.O7)(),l=(0,s.useCallback)((()=>function(e,t){const n=r.$0();if(!n)return!1;const s=n.getParentBlockStore();s&&(I.createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:e,perform:t=>{k.Wq({environment:e,store:s,isLocked:!r.p1(),transaction:t})}}),t.setState({justUnlocked:!t.state.justUnlocked}))}(a,t)),[a,t]),d=(0,o.VK)((()=>t.state.justUnlocked),[t]);return(0,$.jsxs)("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:`1px solid ${n.regularDividerColor}`,borderBottom:`1px solid ${n.regularDividerColor}`,background:n.sidebarBackground,color:n.mediumTextColor,paddingTop:6,paddingBottom:6},children:[(0,$.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",paddingRight:6},children:d?(0,b.U)({height:12,width:12,fill:n.mediumIconColor}):(0,x.b)({height:12,width:12,fill:n.mediumIconColor})}),d?(0,$.jsx)(M.FormattedMessage,{id:"customizePageMenu.unlocked.header",defaultMessage:"Settings unlocked on parent database."}):(0,$.jsx)(M.FormattedMessage,{id:"customizePageMenu.locked.header",defaultMessage:"Settings locked on parent database."}),(0,$.jsx)(N.Z,{style:{fontSize:12,color:n.mediumTextColor,fontWeight:C.Z.fontWeight.semibold,marginLeft:2,paddingLeft:4,paddingRight:4,height:20},onClick:l,children:d?(0,$.jsx)(M.FormattedMessage,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):(0,$.jsx)(M.FormattedMessage,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock"})})]})}const pe=function(){const e=(0,i.O7)(),{device:t}=e,n=(0,o.VK)((()=>c.Z.state),[]);return(0,$.jsx)(m.ZP,{popupType:t.isMobile?l.k.SlideUp:l.k.Popup,alignmentToOrigin:m.ZP.Alignment.Center,open:n.isOpen,render:()=>(0,$.jsx)(ge,{}),originRect:n.isOpen?n.rect:void 0,onDismiss:()=>a.xv()})};function ge(){const e=(0,o.VK)((()=>c.Z.state),[]),t=(0,o.VK)((()=>r.$0()),[]),n=(0,o.VK)((()=>u.default.state.open&&u.default.state.targetStore||d.default.state.mainEditorCurrentBlockStore),[]),s=(0,o.VK)((()=>r.p1()),[]);return e.isOpen?t?(0,$.jsx)(J,{store:t,type:"collection",locked:s}):n?(0,$.jsx)(J,{store:n,type:"page",locked:!1}):null:null}},43700:(e,t,n)=>{n.d(t,{P:()=>h,Z:()=>f});n(667294);var s=n(800480),i=n(886628),o=n(724405),a=n(542853),r=n(709291),l=n(61766),d=n(960709),c=n(231945),u=n(489728),m=n(106318),p=n(785893);const g=(0,r.defineMessages)({hideSimpleLabel:{id:"customizePageMenuVisibilitySelect.hideSimple.label",defaultMessage:"Hide"},hideLabel:{id:"customizePageMenuVisibilitySelect.hide.label",defaultMessage:"Always hide"},hidePageLabel:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"},showLabel:{id:"customizePageMenuVisibilitySelect.show.label",defaultMessage:"Always show"},showPageLabel:{id:"customizePageMenuVisibilitySelect.expanded.label",defaultMessage:"Expanded"},hideIfEmptyLabel:{id:"customizePageMenuVisibilitySelect.hideIfEmpty.label",defaultMessage:"Hide when empty"},collapsedLabel:{id:"customizePageMenuVisibilitySelect.collapsed.label",defaultMessage:"Show in popover"},defaultLabel:{id:"customizePageMenuVisibilitySelect.default.label",defaultMessage:"Default"},minimalLabel:{id:"customizePageMenuVisibilitySelect.minimal.label",defaultMessage:"Minimal"},sectionLabel:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"},propertyLabel:{id:"customizePageMenuVisibilitySelect.property.label",defaultMessage:"As property"}});const f=function(e){const t=(0,o.Fg)(),n=(0,s.O7)(),r=(0,i.qz)(e.buttonPopupStore,l.Z),{device:g}=n,{locked:f,visibility:y,showAsMenu:x,onClose:S}=e;return(0,p.jsx)(c.ZP,{popupType:g.isMobile?c.Z4.SlideUp:c.Z4.Popup,buttonPopupStore:r,renderOrigin:e=>(0,p.jsxs)(u.Z,{style:{color:t.mediumTextColor,paddingRight:0,height:n.device.isMobile?32:22},disabled:f,...e,children:[h(y,x),(0,a.i)({width:10,marginLeft:4,marginRight:4,fill:t.lightIconColor})]}),placementToOrigin:d.Iw.Bottom,onClose:S,render:t=>(0,p.jsx)(m.Z,{...e,onClose:t.close})})};function h(e,t){switch(e){case"hide":return(0,p.jsx)(r.FormattedMessage,{...g.hideLabel});case"show":return(0,p.jsx)(r.FormattedMessage,{...g.showLabel});case"hide_if_empty":return(0,p.jsx)(r.FormattedMessage,{...g.hideIfEmptyLabel});case"section_hide":return t?(0,p.jsx)(r.FormattedMessage,{...g.propertyLabel}):(0,p.jsx)(r.FormattedMessage,{...g.hidePageLabel});case"section_show":return(0,p.jsx)(r.FormattedMessage,{...g.showPageLabel});case"section_collapsed":return(0,p.jsx)(r.FormattedMessage,{...g.collapsedLabel});case"inline":return t?(0,p.jsx)(r.FormattedMessage,{...g.sectionLabel}):(0,p.jsx)(r.FormattedMessage,{...g.defaultLabel});case"minimal":return(0,p.jsx)(r.FormattedMessage,{...g.minimalLabel})}}},106318:(e,t,n)=>{n.d(t,{Z:()=>f});n(667294);var s=n(800480),i=n(406695),o=n(536591),a=n(709291),r=n(111599),l=n(460709),d=n(552275),c=n(478140),u=n(632163),m=n(672495),p=n(43700),g=n(785893);const f=function(e){let{type:t,visibilityLevels:n,showAsMenu:o,visibility:d,onSelect:p,onClose:f,propertySchema:x}=e;const S=(0,s.O7)(),{device:v}=S,b=[{key:"visibilityLevels",render:e=>(0,g.jsx)(m.Z,{...e,topBorder:0!==e.index}),items:"page"===t||"relation_property"===t?h(t,n).map((e=>y(e,o,d,t,p,f,S))):i.AX.filter((e=>"property"!==t||"hide_if_empty"!==e||r.kq({propertySchema:x}))).map((e=>y(e,o,d,t,p,f,S)))}];let M;return M=v.isMobile?{menuType:l.og.Modal,title:(0,g.jsx)(a.FormattedMessage,{id:"customizePageMenuVisibilitySelect.mobile.title",defaultMessage:"Select visibility"}),right:(0,g.jsx)(a.FormattedMessage,{id:"customizePageMenuVisibilitySelect.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:()=>f&&f()}:{menuType:l.og.Popup,width:"auto",maxWidth:360},(0,g.jsx)(c.Z,{...M,children:(0,g.jsx)(u.Z,{type:u.i.Vertical,initialFocus:void 0,sections:b})})};function h(e,t){return"page"!==e&&"relation_property"!==e?[]:t||i.Sn}function y(e,t,n,s,i,a,r){const{device:l}=r;return{key:e,render:s=>(0,g.jsx)(d.Z,{...s,textWrapperStyle:{marginRight:0},title:(0,g.jsx)("div",{style:{display:"flex",alignItems:"center",width:150},children:(0,g.jsx)("div",{children:(0,p.P)(e,t)})}),right:n===e?(0,g.jsx)("div",{style:{width:l.isMobile?16:14},children:(0,o.e)()}):void 0}),action:()=>{if("page"===s){i(e)}if("relation_property"===s){i(e)}else if("property"===s){i(e)}a&&a()}}}},581070:(e,t,n)=>{n.r(t),n.d(t,{default:()=>J});var s=n(730120),i=n(667294),o=n(883355),a=n(313991),r=n(800480),l=n(41797),d=n(709291),c=n(640506);const u=(0,d.defineMessages)({none:{defaultMessage:"None",id:"dateFormatHelpers.reminderMenuItems.none"},onTheDay:{defaultMessage:"On day of event {formattedTimeText}",id:"dateFormatHelpers.reminderMenuItems.onTheDayOfEvent"},hoursBefore:{defaultMessage:"{numberOfHours, plural, one {{numberOfHours} hour before} other {{numberOfHours} hours before}}",id:"dateFormatHelpers.reminderMenuItems.hoursBefore"},minutesBefore:{defaultMessage:"{numberOfMinutes, plural, one {{numberOfMinutes} minute before} other {{numberOfMinutes} minutes before}}",id:"dateFormatHelpers.reminderMenuItems.minutesBefore"},yearsBefore:{defaultMessage:"{numberOfYears, plural, one {{numberOfYears} year before {formattedTimeText}} other {{numberOfYears} years before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.yearsBefore"},daysBefore:{defaultMessage:"{numberOfDays, plural, one {{numberOfDays} day before {formattedTimeText}} other {{numberOfDays} days before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.daysBefore"},monthsBefore:{defaultMessage:"{numberOfMonths, plural, one {{numberOfMonths} month before {formattedTimeText}} other {{numberOfMonths} months before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.monthsBefore"},weeksBefore:{defaultMessage:"{numberOfWeeks, plural, one {{numberOfWeeks} week before {formattedTimeText}} other {{numberOfWeeks} weeks before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.weeksBefore"},atTimeOf:{defaultMessage:"At time of event",id:"dateFormatHelpers.reminderMenuItems.atTimeOfEvent"}});function m(e){const{reminder:t,shouldShowTime:n,intl:s,formatTime:i}=e;if(!t)return s.formatMessage(u.none);if(c.vJ(t)){const{unit:e,value:o,time:a}=t,r=i({start_time:a,time_format:"LT",humanReadable:!0,intl:s}),l=n?`(${r})`:"";return 0===o?s.formatMessage(u.onTheDay,{formattedTimeText:l}):"day"===e?s.formatMessage(u.daysBefore,{formattedTimeText:l,numberOfDays:o}):"year"===e?s.formatMessage(u.yearsBefore,{formattedTimeText:l,numberOfYears:o}):"month"===e?s.formatMessage(u.monthsBefore,{formattedTimeText:l,numberOfMonths:o}):s.formatMessage(u.weeksBefore,{formattedTimeText:l,numberOfWeeks:o})}{const{unit:e,value:n}=t;return 0===n?s.formatMessage(u.atTimeOf):"hour"===e?s.formatMessage(u.hoursBefore,{numberOfHours:n}):s.formatMessage(u.minutesBefore,{numberOfMinutes:n})}}var p=n(407057),g=n(253877),f=n(484795),h=n(842875),y=n(111843),x=n(136700),S=n(916001),v=n(76233),b=n(531701),M=n(653965),j=n(401898),C=n(619584),w=n(436610),k=n(296994),I=n(460709),T=n(918514),Z=n(825464),P=n(876150),F=n(69582),_=n(552275),A=n(231945),B=n(437601),R=n(288359),D=n(301743),O=n(374194),L=n(478140),V=n(632163),E=n(672495),N=n(814871),U=n(824006),K=n(526388),W=n(164369),z=n(483182),q=n(246247),G=n(62069),H=n(785893);const $={backgroundColor:b.ZP.blueWithAlpha(.15)};class Y extends o.Z{constructor(){super(...arguments),this.storeTypes={store:P.ZP},this.handleWindowKeyDown=e=>{"Escape"===e.key&&this.maybePreEmptivelyBlurInput()},this.handleWindowMouseDown=e=>{e.target instanceof HTMLInputElement&&e.target===document.activeElement||this.maybePreEmptivelyBlurInput()},this.handleChangeReminder=e=>{const t=this.getDateValue();var n,s;if(e){if(c.vJ(e)){var i,o;null===(i=(o=this.props).onChangeValue)||void 0===i||i.call(o,{...t,reminder:{...e,defaultTimeZone:(0,h.r)()}})}else if("datetime"===t.type||"datetimerange"===t.type){var a,r;null===(a=(r=this.props).onChangeValue)||void 0===a||a.call(r,{...t,reminder:e})}}else null===(n=(s=this.props).onChangeValue)||void 0===n||n.call(s,{...t,reminder:e});w.IM(this.environment,{date:t,reminder:e})},this.handleInputChange=e=>{const{device:t}=this.environment,{store:n}=this.stores;n.setState({...n.state,inputTemporaryValue:{...n.state.inputTemporaryValue,[n.state.focus]:e.target.value||""}}),t.isAndroid&&this.handleInputBlur()},this.handleStartDateInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startDate;if(!t)return;const n=ae(t,this.props.intl,this.props.dateFormat,this.environment,this.props.locale);if(!n)return P.pd.InvalidDate;const s={...this.getDateValue(),start_date:n},i=g.XI(s);if(!i)return P.pd.InvalidRange;xe({newDate:s,currentMonth:i.start,resetField:P.Hv.StartDate},this.stores.store,this.props.onChangeValue)},this.handleStartTimeInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startTime;if(!t)return;const n=oe(t,this.props.timeFormat,this.props.intl);if(!n)return P.pd.InvalidTime;const s=this.getDateValue();if(c.qg(s)){const{newDate:e,currentMonth:t}=g.vz({previous:s,updatedStartTime:n});xe({newDate:e,currentMonth:t,resetField:P.Hv.StartTime},this.stores.store,this.props.onChangeValue),ye(P.Hv.EndDate,this.stores.store),ye(P.Hv.EndTime,this.stores.store)}else{const e={...s,start_time:n};xe({newDate:e,currentMonth:g.XI(e).start,resetField:P.Hv.StartTime},this.stores.store,this.props.onChangeValue)}},this.handleEndDateInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endDate;if(!t)return;const n=ae(t,this.props.intl,this.props.dateFormat,this.environment,this.props.locale);if(!n)return P.pd.InvalidDate;const s={...this.getDateValue(),end_date:n},i=g.XI(s);if(!i)return P.pd.InvalidRange;xe({newDate:s,currentMonth:i.end,resetField:P.Hv.EndDate},this.stores.store,this.props.onChangeValue)},this.handleEndTimeInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endTime;if(!t)return;const n=oe(t,this.props.timeFormat,this.props.intl);if(!n)return P.pd.InvalidTime;const s={...this.getDateValue(),end_time:n},i=g.XI(s);if(!i)return P.pd.InvalidRange;xe({newDate:s,currentMonth:i.end,resetField:P.Hv.EndTime},this.stores.store,this.props.onChangeValue)},this.handleInputBlur=e=>{const{focus:t}=this.stores.store.state;let n;t===P.Hv.StartDate?n=this.handleStartDateInputChange():t===P.Hv.StartTime?n=this.handleStartTimeInputChange():t===P.Hv.EndDate?n=this.handleEndDateInputChange():t===P.Hv.EndTime&&(n=this.handleEndTimeInputChange()),n?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[t]:n}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})},this.handleInputSubmit=()=>{const{focus:e}=this.stores.store.state;let t;e===P.Hv.StartDate?t=this.handleStartDateInputChange():e===P.Hv.StartTime?t=this.handleStartTimeInputChange():e===P.Hv.EndDate?t=this.handleEndDateInputChange():e===P.Hv.EndTime&&(t=this.handleEndTimeInputChange()),t?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[e]:t}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})},this.handleDayPickerDayClick=(e,t,n)=>{if(this.props.disabled)return;let i=M.Xh(this.getDateValue());const{focus:o}=this.stores.store.state,a=s.ou.fromJSDate(e).setLocale(c.ah).toFormat(g.Iq);if(!n.shiftKey||"date"!==i.type&&"datetime"!==i.type)if("daterange"===i.type||"datetimerange"===i.type){var r,l;o===P.Hv.StartDate||o===P.Hv.StartTime?i={...i,start_date:a}:o!==P.Hv.EndDate&&o!==P.Hv.EndTime||(i={...i,end_date:a});const e=g.NK(i,(0,h.r)());if(e.end&&e.end<e.start){if("datetimerange"===i.type){const{start_date:e,start_time:t,end_date:n,end_time:s}=i;i={...i,start_date:n,start_time:s,end_date:e,end_time:t}}else{const{start_date:e,end_date:t}=i;i={...i,start_date:t,end_date:e}}this.stores.store.setState({...this.stores.store.state,focus:o===P.Hv.StartDate||o===P.Hv.StartTime?P.Hv.EndDate:P.Hv.StartDate})}null===(r=(l=this.props).onChangeValue)||void 0===r||r.call(l,i),ye(o,this.stores.store);const t=o===P.Hv.StartDate||o===P.Hv.StartTime?P.Hv.EndDate:P.Hv.StartDate;this.stores.store.setState({...this.stores.store.state,focus:t})}else{var d,u;const e={...i,start_date:a};null===(d=(u=this.props).onChangeValue)||void 0===d||d.call(u,e),ye(o,this.stores.store)}else he({dateValue:i,endDate:a},this.stores.store,this.props.onChangeValue)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDayPickerMonthChange=e=>function(e,t){t.setState({...t.state,currentMonth:s.ou.fromJSDate(e)})}(e,this.stores.store),this.handleEndDateControlChange=()=>{const e=this.getDateValue();if("datetimerange"===e.type){var t,n;const s={type:"datetime",start_date:e.start_date,start_time:e.start_time,time_zone:e.time_zone,reminder:e.reminder};null===(t=(n=this.props).onChangeValue)||void 0===t||t.call(n,s)}else if("daterange"===e.type){var s,i;const t={type:"date",start_date:e.start_date,reminder:e.reminder};null===(s=(i=this.props).onChangeValue)||void 0===s||s.call(i,t)}else he({dateValue:e},this.stores.store,this.props.onChangeValue)},this.handleAllDayChange=()=>{const e=this.getDateValue();if("date"===e.type){var t,n;const s={type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,h.r)(),reminder:e.reminder&&c.AE(e.reminder)};null===(t=(n=this.props).onChangeValue)||void 0===t||t.call(n,s)}else if("daterange"===e.type){var s,i;const t={type:"datetimerange",start_date:e.start_date,start_time:"00:00",end_date:e.end_date,end_time:"00:00",time_zone:(0,h.r)(),reminder:e.reminder&&c.AE(e.reminder)};null===(s=(i=this.props).onChangeValue)||void 0===s||s.call(i,t)}else if("datetime"===e.type){var o,a;const t={type:"date",start_date:e.start_date,reminder:e.reminder&&c.wg(e.reminder,(0,h.r)())};null===(o=(a=this.props).onChangeValue)||void 0===o||o.call(a,t)}else{var r,l;const t={type:"daterange",start_date:e.start_date,end_date:e.end_date,reminder:e.reminder&&c.wg(e.reminder,(0,h.r)())};null===(r=(l=this.props).onChangeValue)||void 0===r||r.call(l,t)}},this.handleTimeZoneChange=e=>{const t=this.getDateValue();if("datetime"===t.type||"datetimerange"===t.type){var n,s;const i={...t,time_zone:e};null===(n=(s=this.props).onChangeValue)||void 0===n||n.call(s,i)}},this.handleStartInputDateFocus=()=>{const e=this.getDateValue(),t=g.NK(e,(0,h.r)());this.stores.store.setState({...this.stores.store.state,focus:P.Hv.StartDate,inputIsFocused:!0,currentMonth:t.start})},this.handleStartInputTimeFocus=()=>{const e=this.getDateValue(),t=g.NK(e,(0,h.r)());this.stores.store.setState({...this.stores.store.state,focus:P.Hv.StartTime,inputIsFocused:!0,currentMonth:t.start})},this.handleEndInputDateFocus=()=>{const e=this.getDateValue(),t=g.NK(e,(0,h.r)());t.end&&this.stores.store.setState({...this.stores.store.state,focus:P.Hv.EndDate,inputIsFocused:!0,currentMonth:t.end})},this.handleEndInputTimeFocus=()=>{const e=this.getDateValue(),t=g.NK(e,(0,h.r)());t.end&&this.stores.store.setState({...this.stores.store.state,focus:P.Hv.EndTime,inputIsFocused:!0,currentMonth:t.end})}}UNSAFE_willMount(e){super.UNSAFE_willMount(e),this.openTimeFormat=g.Lg((0,h.r)()),window.addEventListener("mousedown",this.handleWindowMouseDown),window.addEventListener("keydown",this.handleWindowKeyDown,!0)}willUnmount(){super.willUnmount(),window.removeEventListener("mousedown",this.handleWindowMouseDown),window.removeEventListener("keydown",this.handleWindowKeyDown,!0)}maybePreEmptivelyBlurInput(){const{inputIsFocused:e}=this.stores.store.state;e&&this.handleInputBlur()}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,{disabled:n,canConfigureCollection:s,shouldShowReminder:i,header:o,isTemplatePage:a}=this.props,{inputIsFocused:r}=this.stores.store.state,l=this.getDateValue(),c="datetime"===l.type||"datetimerange"===l.type,u="daterange"===l.type||"datetimerange"===l.type,m=(0,H.jsxs)("div",{style:{paddingTop:e.isMobile?16:8,paddingBottom:e.isMobile?16:8,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(16):14,paddingRight:e.isMobile?t.getSafePaddingRightCSS(16):14,display:c?"block":"flex",...e.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:e.isMobile?this.theme.popoverBackground:void 0},children:[this.renderStartInput(),u&&(0,H.jsx)("div",{style:{width:12,height:8}}),this.renderEndInput(),this.renderTimeZone()]});let p;return p=e.isMobile?{menuType:I.og.Modal,title:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Date",id:"LuxonDatePropertyMenu.mobileDate.title"}),right:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),left:i?(0,H.jsx)(re,{}):void 0,onClickRight:this.props.onDismiss,header:m}:{menuType:I.og.Popup,maxHeight:"none",width:270,header:o},(0,H.jsx)(D.Z,{debugName:"DatePropertyMenu",capture:r,allowEsc:!0,children:(0,H.jsx)(D.Z,{debugName:"DatePropertyMenu",capture:!0,allowUndo:!0,allowEsc:!0,children:(0,H.jsxs)(L.Z,{...p,children:[(0,H.jsx)(B.Z,{show:r}),a&&(0,H.jsx)(Q,{onChangeValue:this.props.onChangeValue}),(0,H.jsxs)(E.Z,{topBorder:!0,children:[!e.isMobile&&m,(0,H.jsx)("div",{style:{padding:e.isMobile?"16px 14px 16px":"4px 0 4px",textAlign:"center",...e.isMobile&&{borderBottom:`1px solid ${this.theme.regularDividerColor}`,background:this.theme.popoverBackground}},children:this.renderCalendar()})]}),!n&&this.renderControls(),!n&&s&&(0,H.jsx)(E.Z,{topBorder:!0,children:this.renderFormatPopup()}),!n&&(0,H.jsx)(E.Z,{topBorder:!0,children:(0,H.jsx)(fe,{onChangeValue:this.props.onChangeValue})}),!n&&!e.isMobile&&i&&(0,H.jsx)(E.Z,{topBorder:!0,children:(0,H.jsx)(re,{})})]})})})}renderStartInput(){const{device:e}=this.environment,{disabled:t}=this.props,{focus:n,inputTemporaryValue:s,error:i}=this.stores.store.state,o=this.getDateValue(),a=g.NK(o,(0,h.r)(),te(this.props.locale,this.props.intl)),r=Boolean(i.startDate||i.startTime),l="datetime"===o.type||"datetimerange"===o.type,d="daterange"===o.type||"datetimerange"===o.type,u=n===P.Hv.StartDate||n===P.Hv.StartTime,m=(0,C.z4)(s.startDate)?a.start.toFormat(ie(this.props.dateFormat,this.props.intl,this.props.locale)):s.startDate,p=(0,C.z4)(s.startTime)?a.start.toFormat(ne(this.props.timeFormat,!1)):s.startTime,f=(0,C.z4)(s.startDate)?a.start.toFormat(g.Iq):s.startDate,y=(0,C.z4)(s.startTime)?a.start.toFormat(c.jK):s.startTime;return(0,H.jsxs)("div",{style:{...r?me(this.theme):u&&d?pe(this.theme):ue(this.theme),fontSize:e.isMobile?16:14},children:[(0,H.jsx)(K.Z,{renderTooltip:()=>se(i.startDate,this.props.intl),originGap:12,forceVisibleState:Boolean(i.startDate),placement:Z.u.Left,render:()=>e.isMobile?(0,H.jsx)(O.Z,{type:"date",format:O.B.Transparent,value:f,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1}):(0,H.jsx)(O.Z,{selectAll:!0,format:O.B.Transparent,value:m,focusInitial:n===P.Hv.StartDate,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1})}),l&&de(this.theme),l&&(0,H.jsx)(K.Z,{renderTooltip:()=>se(i.startTime,this.props.intl),originGap:12,forceVisibleState:Boolean(i.startTime),placement:Z.u.Right,render:()=>e.isMobile?(0,H.jsx)(O.Z,{type:"time",format:O.B.Transparent,value:y,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):(0,H.jsx)(O.Z,{format:O.B.Transparent,value:p,focusInitial:n===P.Hv.StartTime,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})})]})}renderEndInput(){const{device:e}=this.environment,{disabled:t}=this.props,n=this.getDateValue(),s=g.NK(n,(0,h.r)(),te(this.props.locale,this.props.intl)),i="datetime"===n.type||"datetimerange"===n.type;if(s.end){const{focus:n,error:o,inputTemporaryValue:a}=this.stores.store.state,r=Boolean(o.endDate||o.endTime),l=n===P.Hv.EndDate||n===P.Hv.EndTime,d=(0,C.z4)(a.endDate)?s.end.toFormat(ie(this.props.dateFormat,this.props.intl,this.props.locale)):a.endDate,u=(0,C.z4)(a.endTime)?s.end.toFormat(ne(this.props.timeFormat,!1)):a.endTime,m=(0,C.z4)(a.endDate)?s.end.toFormat(g.Iq):a.endDate,p=(0,C.z4)(a.endTime)?s.end.toFormat(c.jK):a.endTime,f=this.getDateRangeBounds(),h=f&&f.earliestValidEnd;return(0,H.jsxs)("div",{style:{...r?me(this.theme):l?pe(this.theme):ue(this.theme),fontSize:e.isMobile?16:14},children:[(0,H.jsx)(K.Z,{renderTooltip:()=>se(o.endDate,this.props.intl),originGap:12,forceVisibleState:Boolean(o.endDate),placement:Z.u.Left,render:()=>e.isMobile?(0,H.jsx)(O.Z,{type:"date",format:O.B.Transparent,value:m,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t,inputElementAttributes:{min:h}}):(0,H.jsx)(O.Z,{format:O.B.Transparent,value:d,focusInitial:n===P.Hv.EndDate,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}),i&&de(this.theme),i&&(0,H.jsx)(K.Z,{renderTooltip:()=>se(o.endTime,this.props.intl),originGap:12,forceVisibleState:Boolean(o.endTime),placement:Z.u.Right,render:()=>e.isMobile?(0,H.jsx)(O.Z,{type:"time",format:O.B.Transparent,value:p,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):(0,H.jsx)(O.Z,{format:O.B.Transparent,value:u,focusInitial:n===P.Hv.EndTime,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})})]})}}renderTimeZone(){const{device:e}=this.environment,{intl:t}=this.props,n=this.getDateValue();if(("datetime"===n.type||"datetimerange"===n.type)&&n.time_zone!==(0,h.r)())return(0,H.jsx)(W.Z,{isSmall:!0,isMobile:e.isMobile,style:{marginTop:8},children:(0,l.E)(t)[n.time_zone]})}renderCalendar(){const{firstDayOfWeek:e}=this.props,t=this.getDateValueForceCurrentTimeZone(),n=g.NK(t,(0,h.r)()),s=this.stores.store.state.currentMonth||n.start,{focus:i}=this.stores.store.state;if(n.end){const t=n.start.toJSDate(),o=n.end.toJSDate(),r=i===P.Hv.StartDate||i===P.Hv.StartTime;return(0,H.jsx)(k.yG,{className:"notion-date-property-menu notranslate",weekStartsOn:e,numberOfMonths:1,defaultMonth:s.toJSDate(),month:s.toJSDate(),locale:a.SP,modifiers:{range:{from:t,to:o},...r?{end:o,start:t}:{start:t,end:o}},modifiersStyles:{range:$,start:r?X():ee(),end:r?ee():X()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,onMonthSelected:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDayPickerMonthChange})}{const t=n.start.toJSDate();return(0,H.jsx)(k.yG,{className:"notion-date-property-menu notranslate",numberOfMonths:1,weekStartsOn:e,defaultMonth:s.toJSDate(),month:s.toJSDate(),locale:a.SP,selected:[t],modifiers:{start:t},modifiersStyles:{start:X()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,onMonthSelected:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDayPickerMonthChange})}}renderControls(){const{device:e}=this.environment,{shouldShowReminder:t}=this.props;return e.isMobile?(0,H.jsxs)(E.Z,{topBorder:!0,children:[t&&this.renderReminderControl(),this.renderEndDateControl(),this.renderAllDayControl()]}):(0,H.jsxs)(i.Fragment,{children:[t&&(0,H.jsx)(E.Z,{topBorder:!0,children:this.renderReminderControl()}),(0,H.jsxs)(E.Z,{topBorder:!0,children:[this.renderEndDateControl(),this.renderAllDayControl()]})]})}renderEndDateControl(){const e=this.getDateValue();return(0,H.jsx)(_.Z,{focused:!1,onClick:this.handleEndDateControlChange,title:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"End date",id:"LuxonDatePropertyMenu.menuItem.endDate.label"}),right:(0,H.jsx)(U.Z,{on:"daterange"===e.type||"datetimerange"===e.type,onClick:this.handleEndDateControlChange})})}renderAllDayControl(){const e=this.getDateValue();return(0,H.jsx)(_.Z,{focused:!1,onClick:this.handleAllDayChange,title:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Include time",id:"LuxonDatePropertyMenu.menuItem.includeTime.label"}),right:(0,H.jsx)(U.Z,{on:"date"!==e.type&&"daterange"!==e.type,onClick:this.handleAllDayChange})})}renderReminderControl(){const{device:e}=this.environment,{intl:t}=this.props,n=this.getDateValue();return(0,H.jsx)(A.ZP,{popupType:e.isMobile?A.Z4.SlideUp:A.Z4.Popup,placementToOrigin:A.pO.Right,renderOrigin:s=>(0,H.jsx)(R.Z,{...s,icon:(0,x.m)({width:14}),title:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:e.isMobile,right:m({reminder:n.reminder,intl:t,formatTime:p.mr})}),render:s=>{let i;i=e.isMobile?{menuType:I.og.Modal,title:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.mobileRemindModal.title"}),right:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneReminderButton.label"}),onClickRight:s.close}:{menuType:I.og.Popup,width:250};const o=("date"===n.type||"daterange"===n.type?c.PI:c.dG).map((e=>{const n=m({reminder:e,shouldShowTime:!0,intl:t,formatTime:p.mr});return{key:n,action:t=>{this.handleChangeReminder(e),s.close()},render:(e,t)=>(0,H.jsx)(_.Z,{...e,title:n})}}));return(0,H.jsx)(L.Z,{...i,children:(0,H.jsx)(V.Z,{type:V.i.Vertical,sections:[{key:"reminder section",render:e=>(0,H.jsx)(E.Z,{...e}),items:o}],initialFocus:void 0})})}})}renderFormatPopup(){const{device:e}=this.environment;return(0,H.jsx)(A.ZP,{popupType:e.isMobile?A.Z4.SlideUp:A.Z4.Popup,placementToOrigin:A.pO.Right,renderOrigin:t=>(0,H.jsx)(_.Z,{...t,icon:(0,S.r)({width:14}),title:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Date format & timezone",id:"LuxonDatePropertyMenu.menuItem.formatAndTimezone.label"}),focused:!1,showExtensionArrow:e.isMobile}),render:t=>{let n;return n=e.isMobile?{menuType:I.og.Modal,title:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.mobileDateFormatModal.title"}),right:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),onClickRight:t.close}:{menuType:I.og.Popup,width:250},(0,H.jsx)(L.Z,{...n,children:(0,H.jsxs)(E.Z,{children:[(0,H.jsx)(ge,{dateFormat:this.props.dateFormat,onChangeDateFormat:this.props.onChangeDateFormat}),!y.S.includes(a.SP)&&this.renderTimeFormatControl(),this.renderTimeZoneControl()]})})}})}renderTimeFormatControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,n=ne(this.props.timeFormat,!0),{intl:s}=this.props,i=function(e){const t=ne(e,!0),n=le();for(const s in n)if(n[s]===t)return s;return"12h"}(this.props.timeFormat),o={menuTitle:s.formatMessage({defaultMessage:"Time format",id:"LuxonDatePropertyMenu.timeFormatMenu.title"}),items:c.L7,getKey:e=>e,selectedItem:i,onSelect:e=>function(e,t){const n=le()[e];null==t||t(n)}(e,this.props.onChangeTimeFormat),renderItem:e=>(0,H.jsx)(_.Z,{...e,title:s.formatMessage(c.Fi[e.value])}),disabled:t,renderOrigin:e=>(0,H.jsx)(R.Z,{focused:!1,title:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.menuItem.timeFormat.label"}),disabled:t,right:!t&&(n?s.formatMessage(c.Fi[i]):(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.timeFormatMenu.emptyButton.label"})),...e})};return(0,H.jsx)(N.Z,{...o})}renderTimeZoneControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,n=this.getTimeZone();return(0,H.jsx)(G.Z,{disabled:t,renderOrigin:e=>(0,H.jsx)(R.Z,{...e,focused:!1,title:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Timezone",id:"datePropertyMenu.menuItem.time.label"}),disabled:t,right:!t&&g.er(n)}),onSelect:e=>this.handleTimeZoneChange(e)})}getDateValue(){const{value:e}=this.props;return e&&!M.i2(e)?e:this.openTimeFormat}getDateRangeBounds(){const e=this.getDateValue();if(c.h(e)||c.qg(e)){const t=g.NK(e,(0,h.r)());return{earliestValidEnd:t.start.toFormat(g.Iq),latestValidStart:t.end.toFormat(g.Iq)}}}getDateValueForceCurrentTimeZone(){const{value:e}=this.props;return e&&!M.i2(e)?"datetime"===e.type||"datetimerange"===e.type?{...e,time_zone:(0,h.r)()}:e:this.openTimeFormat}getTimeZone(){const e=this.getDateValue();return"datetime"===e.type||"datetimerange"===e.type?e.time_zone:(0,h.r)()}}function Q(e){const{onChangeValue:t}=e,n=(0,d.useIntl)();return(0,H.jsx)(E.Z,{title:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Shortcuts",id:"DatePropertyMenu.menuItem.shortcuts.label"}),children:["now","today"].map((e=>(0,H.jsx)(_.Z,{title:(0,H.jsx)(F.w,{templateVariableType:e}),caption:v.Z08(e,n),inline:!0,onClick:()=>{null==t||t(e)},focused:!1},`relative-date-shortcut-${e}`)))})}Y.displayName="DatePropertyMenu";const J=(0,d.injectIntl)(Y);function X(){return{backgroundColor:b.ZP.blue,color:b.ZP.white}}function ee(){return{backgroundColor:b.ZP.blueWithAlpha(.43)}}function te(e,t){return e||t.locale}function ne(e,t){return e&&(e!==c.n3||t)?c._F(e):c.Sc}function se(e,t){switch(e){case P.pd.InvalidDate:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case P.pd.InvalidRange:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case P.pd.InvalidTime:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"});default:return}}function ie(e,t,n){return void 0===e||"relative"===e||"ll"===e?c.oq(te(n,t)):c.jG(e)}function oe(e,t,n){return(0,f.$v)(e,ne(t,!1),n)}function ae(e,t,n,s,i){return s.device.isMobile?(0,f.f_)(e,g.Iq,t):(0,f.f_)(e,ie(n,t,i),t)}function re(){const e=(0,r.O7)(),{device:t}=e;return t.isMobile?(0,H.jsx)(q.Z,{href:(0,T.UY)("guides.reminders"),analyticsFrom:"date_selector"}):(0,H.jsx)(z.Z,{title:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Learn about reminders",id:"LuxonDatePropertyMenu.learnMore.helpButton.label"}),href:(0,T.UY)("guides.reminders"),analyticsFrom:"date_selector"})}function le(){return(0,y.E)(a.SP).time}function de(e){return(0,H.jsx)("div",{style:{height:14,width:1,background:e.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}})}function ce(e){return{display:"flex",alignItems:"center",borderRadius:4,height:28,lineHeight:1.2,background:e.inputBackground,paddingLeft:8,paddingRight:8,flexBasis:"50%"}}function ue(e){return{...ce(e),boxShadow:e.inputBoxShadow,flexGrow:1}}function me(e){return{...ce(e),boxShadow:`inset 0 0 0 2px ${b.ZP.red}`,background:b.ZP.redWithAlpha(.15),flexGrow:1}}function pe(e){return{...ce(e),boxShadow:`inset 0 0 0 2px ${b.ZP.blue}`,background:b.ZP.blueWithAlpha(.15),flexGrow:1}}function ge(e){let{dateFormat:t,onChangeDateFormat:n}=e;const s=(0,d.useIntl)(),i=t||c.sF,o={menuTitle:s.formatMessage({defaultMessage:"Date format",id:"LuxonDatePropertyMenu.dateFormatDropdownButton.label"}),items:c.Zy,getKey:e=>e,selectedItem:i,onSelect:e=>function(e,t){null==t||t(e)}(e,n),renderItem:e=>(0,H.jsx)(_.Z,{...e,title:s.formatMessage(c.fy[e.value])}),renderOrigin:e=>(0,H.jsx)(R.Z,{focused:!1,title:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.menuItem.format.label"}),right:i?s.formatMessage(c.fy[i]):(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.formatMenu.emptyButton.label"}),...e})};return(0,H.jsx)(N.Z,{...o})}function fe(e){let{onChangeValue:t}=e;return(0,H.jsx)(_.Z,{focused:!1,onClick:()=>function(e){null==e||e(void 0)}(t),title:(0,H.jsx)(d.FormattedMessage,{defaultMessage:"Clear",id:"LuxonDatePropertyMenu.clearButton.label"})})}function he(e,t,n){const{dateValue:s,endDate:i,endTime:o}=e;if("datetime"===s.type){const e={type:"datetimerange",start_date:s.start_date,start_time:s.start_time,end_date:i||s.start_date,end_time:o||s.start_time,time_zone:s.time_zone,reminder:s.reminder};null==n||n(e),t.setState({...t.state,focus:P.Hv.EndDate})}else if("date"===s.type){const e={type:"daterange",start_date:s.start_date,end_date:i||s.start_date,reminder:s.reminder};null==n||n(e),t.setState({...t.state,focus:P.Hv.EndDate})}else(0,j.t1)(s)}function ye(e,t){const{state:n}=t;t.setState({...n,error:{...n.error,[n.focus]:void 0},inputTemporaryValue:{...n.inputTemporaryValue,[n.focus]:void 0}})}function xe(e,t,n){const{newDate:s,currentMonth:i,resetField:o}=e;null==n||n(s),t.setState({...t.state,currentMonth:i}),ye(0,t)}},786249:(e,t,n)=>{n.d(t,{zq:()=>G,ZP:()=>J,UV:()=>Q,f4:()=>Y});n(757658);var s=n(667294),i=n(724405),o=n(356666),a=n(844495),r=n(937612),l=n(709291),d=n(401898),c=n(547307),u=n(740394),m=n(552275),p=n(158297),g=n(53695),f=n(164369),h=n(800480),y=n(886628),x=n(143169),S=n(454642),v=n(730459),b=n(833954),M=n(52507),j=n(550506),C=n(313991),w=n(137810),k=n(374194),I=n(568785),T=n(785893);const Z=(0,l.defineMessages)({samlConfigSubtitle:{id:"verifyDomainModal.addNewDomain.samlConfig.subtitle",defaultMessage:"Users with a verified domain can log in {br}using SAML SSO."},integrationSubtitle:{id:"verifyDomainModal.addNewDomain.integration.subtitle",defaultMessage:"Link preview integrations must verify {br}domains before they are published."}});const P=function(e){let{handleAddNewDomain:t,loading:n,verificationType:o}=e;const[a,r]=(0,s.useState)(""),c=!Boolean(a),u=(0,s.useCallback)((e=>{r(e.target.value)}),[]),m=(0,i.yK)((()=>({title:{fontFamily:w.Z.getCompositeFontFamily(C.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:w.Z.getCompositeFontFamily(C.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"},input:{marginTop:22,marginBottom:14},button:{width:"100%",opacity:c?.5:1}})),[c]);let g;switch(o){case"integration":g=Z.integrationSubtitle;break;case"saml_config":g=Z.samlConfigSubtitle;break;default:(0,d.t1)(o)}return(0,T.jsxs)(s.Fragment,{children:[(0,T.jsx)(f.Z,{style:m.title,children:(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.addNewDomain.title",defaultMessage:"Add new domain"})}),(0,T.jsx)(f.Z,{style:m.subtitle,isMultiline:!0,children:(0,T.jsx)(l.FormattedMessage,{...g,values:{br:(0,T.jsx)("br",{})}})}),(0,T.jsx)(k.Z,{value:a,style:m.input,placeholder:"notion.so",onChange:u}),(0,T.jsx)(p.Z,{onClick:()=>t(a),style:m.button,isLarge:!0,disabled:c,children:n?(0,T.jsx)(I.Z,{}):(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.addNewDomain.next",defaultMessage:"Next"})})]})};var F=n(863296);const _=function(e){let{domain:t,isExpired:n,onClose:o}=e;const a=(0,i.yK)((e=>({title:{fontFamily:w.Z.getCompositeFontFamily(C.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:w.Z.getCompositeFontFamily(C.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center",marginBottom:22}})),[]);return(0,T.jsxs)(s.Fragment,{children:[(0,T.jsx)(f.Z,{style:a.title,isMultiline:!0,children:(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.invalidDomain.title",defaultMessage:"Unable to verify {domain}",values:{domain:t}})}),(0,T.jsx)(f.Z,{style:a.subtitle,isMultiline:!0,children:n?(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.invalidDomain.expired",defaultMessage:"The code for this domain's verification has expired."}):(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.invalidDomain.invalid",defaultMessage:"You are unable to verify this domain because it has already been verified by another workspace."})}),(0,T.jsx)(F.Z,{onClick:o,style:{width:"100%"},children:(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.invalidDomain.okay",defaultMessage:"Okay"})})]})},A=(0,l.defineMessages)({samlConfigSubtitle:{id:"verifyDomainModal.verifiedDomain.samlConfig.subtitle",defaultMessage:"Users are able to use this email domain to{br}log in using SAML SSO."},integrationSubtitle:{id:"verifyDomainModal.verifiedDomain.integration.subtitle",defaultMessage:"This integration can unfurl URLs containing this domain."}});const B=function(e){let{domain:t,onClose:n,verificationType:o}=e;const a=(0,i.yK)((()=>({title:{fontFamily:w.Z.getCompositeFontFamily(C.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:w.Z.getCompositeFontFamily(C.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center",marginBottom:22}})),[]);let r;switch(o){case"saml_config":r=A.samlConfigSubtitle;break;case"integration":r=A.integrationSubtitle;break;default:(0,d.t1)(o)}return(0,T.jsxs)(s.Fragment,{children:[(0,T.jsx)(f.Z,{style:a.title,isMultiline:!0,children:(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifiedDomain.title",defaultMessage:"Successfully verified {domain}",values:{domain:t}})}),(0,T.jsx)(f.Z,{style:a.subtitle,isMultiline:!0,children:(0,T.jsx)(l.FormattedMessage,{...r,values:{br:(0,T.jsx)("br",{})}})}),(0,T.jsx)(F.Z,{onClick:n,style:{width:"100%"},children:(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifiedDomain.okay",defaultMessage:"Okay"})})]})};var R=n(875553),D=n(619584),O=n(800893),L=n(816402),V=n(164921);const E=function(e){let{handleVerifyDomain:t,domainVerification:n,loading:o}=e;const a=(0,h.O7)(),r=n.expiresAt-Date.now()<2*D.U6,d=(0,i.yK)((e=>({title:{fontFamily:w.Z.getCompositeFontFamily(C.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:w.Z.getCompositeFontFamily(C.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"},list:{paddingInlineStart:22,margin:"24px 0"},listItem:{fontFamily:w.Z.getCompositeFontFamily(C.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",marginBottom:12},expiresSoonText:{color:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500]},copyButton:{borderRadius:4,padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,fontFamily:w.Z.getCompositeFontFamily(C.SP).sans,fontSize:12,fontWeight:500,lineHeight:"14px"},copyIcon:{width:16,height:16,marginRight:4,fill:e.mediumIconColor},code:{width:"100%",color:e.mediumTextColor,fontFamily:w.Z.getCompositeFontFamily(C.SP).mono,fontSize:14,fontWeight:400,lineHeight:"18px"},codeContainer:{display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`,height:32,paddingLeft:12,paddingRight:12,borderRadius:4,marginTop:4,marginBottom:8}})),[]);return(0,T.jsxs)(s.Fragment,{children:[(0,T.jsx)(f.Z,{style:d.title,children:(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.title",defaultMessage:"Verify your domain"})}),(0,T.jsx)(f.Z,{style:d.subtitle,children:(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.subtitle",defaultMessage:"Follow these steps to finalize verification."})}),(0,T.jsx)(f.Z,{isSmall:!0,style:{marginTop:22},children:(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verificationCodeLabel",defaultMessage:"Verification code"})}),(0,T.jsxs)("div",{style:d.codeContainer,children:[(0,T.jsx)(f.Z,{style:d.code,children:`notion-domain-verification=${n.verificationCode}`}),(0,T.jsxs)(V.Z,{onClick:function(){O.RD({environment:a,stringValue:`notion-domain-verification=${n.verificationCode}`,copiedMessage:O.tq.copiedLinkToClipboard})},style:d.copyButton,children:[(0,R.U)(d.copyIcon),(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.copy",defaultMessage:"Copy"})]})]}),(0,T.jsx)(f.Z,{style:r?d.expiresSoonText:void 0,isSmall:!0,children:(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verificationCodeExpiresAt",defaultMessage:"Expires on {timeLeft}",values:{timeLeft:(0,L.gs)(n.expiresAt)}})}),(0,T.jsxs)("ol",{style:d.list,children:[(0,T.jsx)("li",{style:d.listItem,children:(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsDNS",defaultMessage:"Navigate to the DNS record section of your domain host."})}),(0,T.jsx)("li",{style:d.listItem,children:(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsTXT",defaultMessage:"Create a new TXT record and paste in the code above as the value."})}),(0,T.jsx)("li",{style:d.listItem,children:(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsHangTight",defaultMessage:"Typically, this change takes only minutes to occur, however, there are cases where it may take up to 72 hours for the DNS record to propagate."})}),(0,T.jsx)("li",{style:d.listItem,children:(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsVerify",defaultMessage:'Click "Verify" to notify Notion to check your DNS record.'})})]}),(0,T.jsx)(F.Z,{style:{width:"100%"},onClick:()=>t(n),disabled:o,children:o?(0,T.jsx)(I.Z,{}):(0,T.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verify",defaultMessage:"Verify"})})]})};const N=function(e){const t=(0,h.O7)(),n=(0,l.useIntl)(),o=(0,i.Fg)(),[a,r]=(0,y.AF)(e.store,M.Z),{verificationType:u,verificationTargetId:m,refreshDomains:p}=e,g=(0,s.useCallback)((()=>{r((e=>({...e,loading:!1,modalOpen:!1})))}),[r]),f=(0,s.useCallback)((async e=>{r((e=>({...e,loading:!0})));const s="integration"===u?{type:u,integrationId:m,domain:e}:{type:u,spaceId:m,domain:e},i=await S.createDomainVerificationCode(t,s);if("success"===i.type){p(),v.K4(t,"domain_verification_domain_added",{type:u});const e=i.data.domainVerification,n=(0,x.Hs)(e);r((e=>({...e,domainVerification:n,loading:!1})))}else c.showErrorMessage((0,b.wf)(n,i)),r((e=>({...e,loading:!1})))}),[t,r,m,p,u,n]),C=(0,s.useCallback)((async e=>{r((e=>({...e,loading:!0})));const s=await S.verifyDomain(t,{verificationId:e.id});if(v.K4(t,"domain_verification_verification_attempted",{type:u}),"success"===s.type){p(),v.K4(t,"domain_verification_domain_verified",{type:u});const n={type:"verified",domain:e.domain};r((e=>({...e,domainVerification:n,loading:!1})))}else c.showErrorMessage((0,b.wf)(n,s)),r((e=>({...e,loading:!1})))}),[t,n,r,p,u]),w=(0,s.useCallback)((()=>{if(!a.domainVerification)return(0,T.jsx)(P,{handleAddNewDomain:f,loading:a.loading,verificationType:u});switch(a.domainVerification.type){case"invalid":return(0,T.jsx)(_,{domain:a.domainVerification.domain,isExpired:Date.now()>a.domainVerification.expiresAt,onClose:g});case"unverified":return(0,T.jsx)(E,{handleVerifyDomain:C,domainVerification:a.domainVerification,loading:a.loading});case"verified":return(0,T.jsx)(B,{domain:a.domainVerification.domain,onClose:g,verificationType:u});default:(0,d.t1)(a.domainVerification)}}),[a.domainVerification,a.loading,C,f,g,u]);return(0,T.jsx)(j.Z,{open:a.modalOpen,preventHideChildrenWhileOpening:!0,onDismiss:g,render:()=>(0,T.jsx)("div",{style:{background:o.popoverBackground,width:410,padding:24,borderRadius:4},children:w()})})};var U=n(705478);const K=[{id:"domain",headerTitle:(0,T.jsx)(l.FormattedMessage,{id:"domainVerificationTable.table.header.domain",defaultMessage:"Domain"}),renderCell:e=>(0,T.jsx)(f.Z,{children:e.domain}),widthData:{width:100},sortable:!1},{id:"status",headerTitle:(0,T.jsx)(l.FormattedMessage,{id:"domainVerificationTable.table.header.status",defaultMessage:"Status"}),renderCell:e=>(0,T.jsx)(G,{status:e.status}),widthData:{width:100},sortable:!1},{id:"actions",headerTitle:null,renderCell:e=>(0,T.jsx)(H,{onShowDetails:e.onShowDetails,onRemove:e.onRemove}),widthData:{width:20},sortable:!1}],W=(0,l.defineMessages)({verifiedSAMLWarning:{defaultMessage:"Deleting this domain will prevent others with this email from logging in using SAML SSO.",id:"domainVerificationInput.securitySAMLSettings.emailDomainsSection.removeDomain.description"},verifiedIntegrationsWarning:{defaultMessage:"Deleting this domain will prevent integrations from unfurling urls that contain this domain.",id:"domainVerificationInput.myIntegrations.emailDomainsSection.removeDomain.description"},unverifiedDomainWarning:{defaultMessage:"Deleting this domain will restart its verification process. A new verification code will be generated for this domain in the next verification attempt.",id:"domainVerificationInput.securitySAMLSettings.emailDomainsSection.removeDomain.pending.description"}}),z={fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},q={fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"};function G(e){let{status:t}=e;const n=(0,i.yK)((e=>{const n={[U.YF.Success]:e.statusTokenBackground.green,[U.YF.Pending]:e.statusTokenBackground.yellow,[U.YF.Failure]:e.statusTokenBackground.red},s={[U.YF.Success]:e.statusTokenIndicator.green,[U.YF.Pending]:e.statusTokenIndicator.yellow,[U.YF.Failure]:e.statusTokenIndicator.red},i={[U.YF.Success]:e.statusTokenText.green,[U.YF.Pending]:e.statusTokenText.yellow,[U.YF.Failure]:e.statusTokenText.red};return{container:{background:n[t],color:i[t],display:"flex",justifyContent:"center",alignItems:"center",gap:6,borderRadius:18,height:20,paddingLeft:7,paddingRight:9},dot:{background:s[t],width:10,height:10,borderRadius:"100%"}}}),[t]);return(0,T.jsxs)("div",{style:n.container,children:[(0,T.jsx)("div",{style:n.dot}),$(t)]})}function H(e){let{onShowDetails:t,onRemove:n}=e;const s=(0,i.yK)((e=>({primaryIcon:{width:14,height:14,color:e.mediumIconColor,fill:"currentColor"},menuItem:{width:250},menuIcon:{width:14,height:14,color:e.regularIconColor,fill:"currentColor"}})),[]),d=[];return t&&d.push({key:"details",action:()=>t(),render:e=>(0,T.jsx)(m.Z,{...e,style:s.menuItem,focused:!1,icon:(0,a.D)(s.menuIcon),title:(0,T.jsx)(l.FormattedMessage,{defaultMessage:"View details",id:"securitySAMLSettings.emailDomainsSection.details"}),caption:(0,T.jsx)(l.FormattedMessage,{defaultMessage:"See more information about the state of this domain verification record.",id:"securitySAMLSettings.emailDomainsSection.detailsCaption"}),shouldWrapCaption:!0})}),n&&d.push({key:"remove",action:()=>n(),render:e=>(0,T.jsx)(m.Z,{...e,style:s.menuItem,focused:!1,icon:(0,r.y)(s.menuIcon),title:(0,T.jsx)(l.FormattedMessage,{defaultMessage:"Remove domain",id:"securitySAMLSettings.emailDomainsSection.remove"}),caption:(0,T.jsx)(l.FormattedMessage,{defaultMessage:"Delete this domain verification record.",id:"securitySAMLSettings.emailDomainsSection.removeCaption"}),shouldWrapCaption:!0})}),0===d.length?null:(0,T.jsx)(g.Nz,{hideDropdownIcon:!0,title:(0,o.o)(s.primaryIcon),items:d})}function $(e){switch(e){case U.YF.Success:return(0,T.jsx)(l.FormattedMessage,{defaultMessage:"Verified",id:"domainVerificationInput.emailDomainsSection.statusToken.verified"});case U.YF.Pending:return(0,T.jsx)(l.FormattedMessage,{defaultMessage:"Pending",id:"domainVerificationInput.emailDomainsSection.statusToken.pending"});case U.YF.Failure:return(0,T.jsx)(l.FormattedMessage,{defaultMessage:"Failed",id:"domainVerificationInput.emailDomainsSection.statusToken.failed"});default:(0,d.t1)(e)}}function Y(e){return{domain:e,status:U.YF.Success,data:{type:"verified",domain:e}}}function Q(e){return Date.now()>e.expiresAt||Boolean(e.invalidatedAt)?{domain:e.domain,status:U.YF.Failure,data:{type:"invalid",id:e.id,domain:e.domain,verificationCode:e.verificationCode,createdAt:e.createdAt,expiresAt:e.expiresAt,invalidatedAt:e.invalidatedAt}}:{domain:e.domain,status:U.YF.Pending,data:{type:"unverified",id:e.id,domain:e.domain,verificationCode:e.verificationCode,createdAt:e.createdAt,expiresAt:e.expiresAt,invalidatedAt:e.invalidatedAt}}}const J=function(e){const{disabled:t,domains:n,domainVerificationStore:o,verificationType:a,verificationTargetId:r,refreshDomains:m,onRemoveDomain:g,onClickAddDomain:h,renderOverrideAddDomainButton:y}=e,x=(0,i.yK)((e=>(0,u.b)({columnRenderInfo:K,theme:e,containerMarginTop:0})),[]);function S(){t||(h&&h(),o.setState({domainVerification:void 0,loading:!1,modalOpen:!0}))}const v=n.map((e=>{let{domain:n,status:s,data:i}=e;return{id:"verified"===i.type?n:i.id,isClickable:!1,domain:n,status:s,onShowDetails:t?void 0:()=>function(e){t||o.setState({domainVerification:e,loading:!1,modalOpen:!0})}(i),onRemove:t?void 0:()=>async function(e,t){let n;if(t===U.YF.Failure)return void g(e);t===U.YF.Pending?n=W.unverifiedDomainWarning:t===U.YF.Success?n="saml_config"===a?W.verifiedSAMLWarning:W.verifiedIntegrationsWarning:(0,d.t1)(t),await c.confirmUserAction({message:(0,T.jsx)("div",{style:z,children:(0,T.jsx)(l.FormattedMessage,{defaultMessage:"Are you sure you want to delete this domain?",id:"domainVerificationInput.emailDomainsSection.removeDomain.message"})}),description:(0,T.jsx)("div",{style:q,children:(0,T.jsx)(l.FormattedMessage,{...n})}),acceptLabel:(0,T.jsx)(l.FormattedMessage,{id:"domainVerificationInput.emailDomainsSection.removeDomain.accept",defaultMessage:"Delete domain"}),cancelLabel:(0,T.jsx)(l.FormattedMessage,{id:"domainVerificationInput.emailDomainsSection.removeDomain.cancel",defaultMessage:"Cancel"})})&&g(e)}(i,s)}}));return(0,T.jsxs)(s.Fragment,{children:[y?y(S):(0,T.jsx)(p.Z,{isLarge:!0,disabled:t,onClick:S,style:{margin:"4px 0px 16px",width:"fit-content"},children:(0,T.jsx)(l.FormattedMessage,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain"})}),(0,T.jsx)(u.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:K,rows:v,styles:x,renderNoRowsComponent:()=>(0,T.jsx)(f.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,T.jsx)(l.FormattedMessage,{id:"securitySAMLSettings.emailDomainsSection.emptyTable",defaultMessage:"No domains configured."})})}),(0,T.jsx)(N,{store:o,verificationTargetId:r,verificationType:a,refreshDomains:m})]})}},901176:(e,t,n)=>{n.r(t),n.d(t,{default:()=>$});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(841892),l=n(643593),d=n(423512),c=n(23867),u=n(815047),m=n(709291),p=n(653965),g=n(461652),f=n(612457),h=n(319385);var y=n(460709),x=n(98742),S=n(205691),v=n(825464),b=n(61766),M=n(788632),j=n(771071),C=n(44041),w=n(854669),k=n(552275),I=n(301743),T=n(374194),Z=n(478140),P=n(632163),F=n(489728),_=n(158297),A=n(672495),B=n(307931),R=n(824006),D=n(287968),O=n(164369),L=n(292660),V=n(306202),E=n(760442),N=n(785893);const U=["pdf","html","markdown"],K=["currentView","all"],W=1;function z(e){return e>.1&&e<2}const q=["everything","no_files"],G=(0,m.defineMessages)({dialogLabel:{id:"exportModal.dialogLabel",defaultMessage:"Export"}});function H(e){let{value:t,onChange:n}=e;const i=(0,m.useIntl)(),o=s.useCallback((e=>{const t=e.target.value,s=(0,d._g)(t)||(0,S.m)(t,i);let o;"object"==typeof s?o="percent"===s.format?s.value:s.value/100:"number"==typeof s&&(o=s/100),void 0!==o&&n(o)}),[n,i]),[a,r]=s.useState(!1),l=s.useMemo((()=>(0,d.uf)(Math.round(100*t),"number",i)),[t,i]);return(0,N.jsx)(I.Z,{debugName:"ExportModal",capture:a,children:(0,N.jsx)(T.Z,{value:l,onChange:o,onFocus:()=>r(!0),onBlur:()=>r(!1),style:{width:60},inputStyle:{textAlign:"right"}})})}const $=function(){const e=(0,m.useIntl)(),t=(0,o.qz)(void 0,b.Z),n=(0,o.qz)(void 0,b.Z),i=(0,o.qz)(void 0,b.Z),a=(0,o.qz)(void 0,b.Z),r=(0,s.useCallback)((()=>(0,N.jsx)(fe,{includeContentsPopupStore:a,exportTypePopupStore:i,pdfFormatPopupStore:n,collectionViewExportTypePopupStore:t})),[a,i,n,t]),l=(0,o.VK)((()=>j.ZP.state.open),[]);return(0,N.jsx)(L.Z,{ariaLabel:e.formatMessage(G.dialogLabel),onDismiss:ie,render:r,isOpen:l})};function Y(e){switch(e){case"pdf":return(0,N.jsx)(m.FormattedMessage,{id:"exportModal.exportFormatButton.pdf.label",defaultMessage:"PDF"});case"markdown":return(0,N.jsx)(m.FormattedMessage,{id:"exportModal.exportFormatButton.markdownAndCSV.label",defaultMessage:"Markdown & CSV"});case"html":return(0,N.jsx)(m.FormattedMessage,{id:"exportModal.exportFormatButton.html.label",defaultMessage:"HTML"})}}function Q(e){switch(e){case"everything":return(0,N.jsx)(m.FormattedMessage,{id:"exportModal.includeContentTypes.everything.label",defaultMessage:"Everything"});case"no_files":return(0,N.jsx)(m.FormattedMessage,{id:"exportModal.includeContentTypes.no_files.label",defaultMessage:"No files or images"})}}function J(e){switch(e){case"all":return h.default.checkGate({gateName:"export_collections_v1"})?(0,N.jsx)(m.FormattedMessage,{id:"exportModal.includeDatabases.all.label.defaultView",defaultMessage:"Default View"}):(0,N.jsx)(m.FormattedMessage,{id:"exportModal.includeDatabases.all.label.everything",defaultMessage:"Everything"});case"currentView":return(0,N.jsx)(m.FormattedMessage,{id:"exportModal.includeDatabases.currentView.label",defaultMessage:"Current view"})}}function X(e){switch(e){case"Letter":return(0,N.jsx)(m.FormattedMessage,{id:"exportModal.pageFormatButton.letter.label",defaultMessage:"Letter"});case"A3":return(0,N.jsx)(m.FormattedMessage,{id:"exportModal.pageFormatButton.a3.label",defaultMessage:"A3"});case"A4":return(0,N.jsx)(m.FormattedMessage,{id:"exportModal.pageFormatButton.a4.label",defaultMessage:"A4"});case"Legal":return(0,N.jsx)(m.FormattedMessage,{id:"exportModal.pageFormatButton.legal.label",defaultMessage:"Legal"});case"Tabloid":return(0,N.jsx)(m.FormattedMessage,{id:"exportModal.pageFormatButton.tabloid.label",defaultMessage:"Tabloid"})}}function ee(){const e=j.ZP.state;return e.open&&(0,j.Sw)(e)?void 0===e.exportOptions.scale?W:e.exportOptions.scale:W}function te(){return z(ee())}function ne(e){return{width:320,padding:24,fontSize:14,color:e.mediumTextColor}}function se(){const e=(0,a.Fg)();return(0,N.jsx)("div",{style:ne(e),children:(0,N.jsx)(m.FormattedMessage,{defaultMessage:"Please go online to export.",id:"exportModal.offlineMessage.description"})})}function ie(){g.Qr()}function oe(e){const t=j.ZP.state;if(t.open){if((0,j.Sw)(t)&&!g.y1(e))return void C.y(e,{from:"export_modal",for:"enterprise"});g.BO(e,{...t,recursive:!t.recursive})}}function ae(e){if(!te())return;const t=j.ZP.state;t.open&&(g.Qr(),t.root.table===u.bx?g.AW(e,{spaceId:t.root.id,exportOptions:t.exportOptions,shouldExportComments:t.shouldExportComments}):g.ZO(e,{block:{id:t.root.id,spaceId:(0,c.C)(t.root.spaceId)},recursive:t.recursive,exportOptions:t.exportOptions,shouldExportComments:t.shouldExportComments}))}function re(e,t,n,s){const i=j.ZP.state,o=i.open&&"pdf"===e&&"space"===i.root.table&&!g.y1(s)&&"business";return{key:e,action:()=>{t.close(),o?C.y(s,{from:"export_modal",for:o}):function(e,t,n){const s=j.ZP.state;if(!s.open)return;const{exportOptions:i}=s;if(e===i.exportType)return;let o;o="pdf"===e?{...i,exportType:"pdf",pdfFormat:g.GI(t)}:{...i,exportType:e},g.BO(n,{...s,exportOptions:o})}(e,n,s)},render:t=>{let{onClick:n,key:s,...i}=t;return(0,N.jsx)(w.Z,{requireUpgradeToTier:o,analyticsName:"export_modal",onClick:n,render:(t,n)=>(0,N.jsx)(k.Z,{...(0,x.Z)(i,t),title:Y(e),right:n}),renderUpgradeTooltip:()=>(0,N.jsx)(E.Z,{imageURL:r.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,N.jsx)(m.FormattedMessage,{defaultMessage:"Upgrade to export the workspace as PDFs",id:"exportModal.workspacePdfUpgradeTooltip.title"}),caption:(0,N.jsx)(m.FormattedMessage,{defaultMessage:"Creates a zip file containing all pages in the workspace as PDF files.",id:"exportModal.workspacePdfUpgradeTooltip.caption"})}),tooltipPlacement:v.u.Left,upgradeButtonDesktopStyle:{marginTop:2}},s)}}}function le(e,t,n){return{key:e,action:()=>{t.close(),function(e,t){const n=j.ZP.state;n.open&&g.BO(t,{...n,exportOptions:{...n.exportOptions,includeContents:e}})}(e,n)},render:t=>(0,N.jsx)(k.Z,{...t,title:Q(e)})}}function de(e,t,n){return{key:e,action:()=>{t.close(),function(e,t){const n=j.ZP.state;n.open&&g.BO(t,{...n,exportOptions:{...n.exportOptions,collectionViewExportType:e}})}(e,n)},render:t=>(0,N.jsx)(k.Z,{...t,title:J(e)})}}function ce(e,t,n){return{key:e,action:()=>{t.close(),function(e,t){const n=j.ZP.state;n.open&&(0,j.Sw)(n)&&g.BO(t,{...n,exportOptions:{...n.exportOptions,pdfFormat:e}})}(e,n)},render:t=>(0,N.jsx)(k.Z,{...t,title:X(e)})}}function ue(){const e=(0,a.Fg)(),t=(0,i.O7)(),n=(0,o.VK)((()=>ee()),[]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",height:32},children:[(0,N.jsx)(O.Z,{style:{color:e.lightTextColor},children:(0,N.jsx)(m.FormattedMessage,{id:"exportModal.pageScale.description",defaultMessage:"Scale percent"})}),(0,N.jsx)(H,{value:n,onChange:e=>function(e,t){const n=j.ZP.state;n.open&&(0,j.Sw)(n)&&g.BO(t,{...n,exportOptions:{...n.exportOptions,scale:e}})}(e,t)})]}),!z(n)&&(0,N.jsx)(f.Z,{show:!0,showDelay:500,showHold:100,render:t=>t&&(0,N.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:32,padding:"4px 0"},children:(0,N.jsx)(O.Z,{isSmall:!0,isMultiline:!0,style:{color:e.errorText},children:(0,N.jsx)(m.FormattedMessage,{id:"exportModal.pageScale.invalidScaleError",defaultMessage:"Scale percent must be a number between 10 and 200"})})})})]})}function me(e){let{modalState:t,includeContentsPopupStore:n,exportTypePopupStore:s,pdfFormatPopupStore:d,collectionViewExportTypePopupStore:c}=e;const u=(0,a.Fg)(),p=(0,i.O7)(),f=(0,o.qz)(c,b.Z),h=(0,o.qz)(d,b.Z),y=(0,o.qz)(s,b.Z),x=(0,o.qz)(n,b.Z),{device:S,currentUser:M}=p,C=(0,o.VK)((()=>(0,j.Sw)(t)&&!g.y1(p)&&"business"),[t,p]),k=p.device.isWindows,I=(0,o.VK)((()=>te()),[]),T=(0,o.VK)((()=>J(t.exportOptions.collectionViewExportType||"currentView")),[t]);return(0,N.jsxs)("div",{style:{width:320,padding:24,fontSize:14},children:[(0,N.jsx)(B.Z,{isMenuItem:S.isMobile,buttonPopupStore:y,label:(0,N.jsx)(m.FormattedMessage,{id:"exportModal.exportFormat.description",defaultMessage:"Export format"}),selectedTitle:Y(t.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>(0,N.jsx)(A.Z,{...e}),items:U.map((t=>re(t,e,M.id,p)))}]}),t.exportOptions.collectionViewExportType&&(0,N.jsx)(B.Z,{isMenuItem:S.isMobile,buttonPopupStore:f,label:(0,N.jsx)(m.FormattedMessage,{id:"exportModal.includeDatabases.description",defaultMessage:"Include databases"}),selectedTitle:T,renderMenuSections:e=>[{key:"exportCollection",render:e=>(0,N.jsx)(A.Z,{...e}),items:K.map((t=>de(t,e,p)))}]}),(0,N.jsx)(B.Z,{isMenuItem:S.isMobile,buttonPopupStore:x,label:(0,N.jsx)(m.FormattedMessage,{id:"exportModal.includeContents.description",defaultMessage:"Include content"}),selectedTitle:Q(t.exportOptions.includeContents||"everything"),renderMenuSections:e=>[{key:"includeContents",render:e=>(0,N.jsx)(A.Z,{...e}),items:q.map((t=>le(t,e,p)))}]}),(0,j.Sw)(t)&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(B.Z,{isMenuItem:S.isMobile,buttonPopupStore:h,label:(0,N.jsx)(m.FormattedMessage,{id:"exportModal.pageFormat.description",defaultMessage:"Page format"}),selectedTitle:X(t.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>(0,N.jsx)(A.Z,{...e}),items:l.lJ.map((t=>ce(t,e,p)))},{key:"otherPaperFormats",render:e=>(0,N.jsx)(A.Z,{topBorder:!0,...e}),items:l.bY.map((t=>ce(t,e,p)))}]}),(0,N.jsx)(ue,{})]}),"space"!==t.root.table&&(0,N.jsx)(w.Z,{requireUpgradeToTier:C,analyticsName:"export_modal",onClick:()=>oe(p),render:(e,n)=>(0,N.jsxs)("div",{...e,style:{display:"flex",alignItems:"center",height:32},children:[(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",marginRight:"auto",color:u.lightTextColor,fontSize:14},children:[(0,N.jsx)(m.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",n&&(0,N.jsx)("div",{style:{marginLeft:8},children:n})]}),(0,N.jsx)(R.Z,{on:t.recursive,disabled:Boolean(C)})]}),renderUpgradeTooltip:()=>(0,N.jsx)(E.Z,{imageURL:r.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,N.jsx)(m.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:(0,N.jsx)(m.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:v.u.Left,upgradeButtonDesktopStyle:{marginTop:2}}),(0,N.jsx)(D.Z,{title:(0,N.jsx)(m.FormattedMessage,{id:"exportModal.flattenExportFiletree.description",defaultMessage:"Create folders for subpages"}),subtitle:"",style:{color:u.lightTextColor,fontSize:14,display:"flex",alignItems:"center",marginRight:"auto",height:32},on:void 0===t.exportOptions.flattenExportFiletree?!k:!t.exportOptions.flattenExportFiletree,disabled:!t.recursive,onChange:()=>function(e){const t=j.ZP.state;t.open&&g.BO(e,{...t,exportOptions:{...t.exportOptions,flattenExportFiletree:!t.exportOptions.flattenExportFiletree}})}(p)}),"html"===t.exportOptions.exportType?(0,N.jsx)(D.Z,{title:(0,N.jsx)(m.FormattedMessage,{id:"exportModal.shouldExportComments.description",defaultMessage:"Export comments"}),subtitle:"",style:{color:u.lightTextColor,fontSize:14,display:"flex",alignItems:"center",marginRight:"auto",height:32},on:t.shouldExportComments,onChange:()=>function(e){const t=j.ZP.state;t.open&&g.BO(e,{...t,shouldExportComments:!t.shouldExportComments})}(p)}):null,(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:16},children:[(0,N.jsx)(F.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:ie,children:(0,N.jsx)(m.FormattedMessage,{defaultMessage:"Cancel",id:"exportModal.cancelButton.label"})}),(0,N.jsx)(_.Z,{onClick:()=>ae(p),disabled:!I,children:(0,N.jsx)(m.FormattedMessage,{defaultMessage:"Export",id:"exportModal.exportButton.label"})})]})]})}function pe(e,t,n,s){const{currentUser:i,device:o}=t;return p.oA([{key:"export type",render:s=>{let{ref:a,...r}=s;return(0,N.jsx)(B.Z,{...r,isMenuItem:o.isMobile,buttonPopupStore:n,label:(0,N.jsx)(m.FormattedMessage,{defaultMessage:"Export format",id:"exportModal.exportFormat.description"}),selectedTitle:Y(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>(0,N.jsx)(A.Z,{...e}),items:U.map((n=>re(n,e,i.id,t)))}]})},action:()=>{n.setState({open:!0})}},(0,j.Sw)(e)&&{key:"pdf format",render:n=>{let{ref:i,...a}=n;return(0,N.jsx)(B.Z,{...a,isMenuItem:o.isMobile,buttonPopupStore:s,label:(0,N.jsx)(m.FormattedMessage,{defaultMessage:"Page format",id:"exportModal.pageFormat.description"}),selectedTitle:X(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>(0,N.jsx)(A.Z,{...e}),items:l.lJ.map((n=>ce(n,e,t)))},{key:"otherPaperFormats",render:e=>(0,N.jsx)(A.Z,{topBorder:!0,...e}),items:l.bY.map((n=>ce(n,e,t)))}]})},action:()=>{s.setState({open:!0})}},"space"!==e.root.table&&{key:"recursive",render:n=>{let{onClick:s,key:i,...o}=n;const a=(0,j.Sw)(e)&&!g.y1(t)&&"business";return(0,N.jsx)(w.Z,{requireUpgradeToTier:a,analyticsName:"export_modal",onClick:s,render:(t,n)=>{const s=(0,x.Z)(o,t);return(0,N.jsx)(k.Z,{...s,title:(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,N.jsx)(m.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",n&&(0,N.jsx)("div",{style:{marginLeft:8},children:n})]}),right:(0,N.jsx)(R.Z,{...s,on:e.recursive,disabled:Boolean(a)})})},renderUpgradeTooltip:()=>(0,N.jsx)(E.Z,{imageURL:r.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,N.jsx)(m.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:(0,N.jsx)(m.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:v.u.Left,upgradeButtonDesktopStyle:{marginTop:2}},i)},action:()=>oe(t)}])}function ge(e){let{modalState:t,exportTypePopupStore:n,pdfFormatPopupStore:s}=e;const o=(0,i.O7)(),a={menuType:y.og.Modal,title:(0,N.jsx)(m.FormattedMessage,{id:"exportModal.title",defaultMessage:"Export"}),right:(0,N.jsx)(m.FormattedMessage,{id:"exportModal.closeButton.label",defaultMessage:"Close"}),onClickRight:ie};return(0,N.jsx)(Z.Z,{...a,children:(0,N.jsx)(P.Z,{type:P.i.Vertical,initialFocus:void 0,sections:[{key:"exportOptions",render:e=>(0,N.jsx)(A.Z,{...e}),items:pe(t,o,n,s)},{key:"actions",render:e=>{let{children:t,...n}=e;return(0,N.jsx)(A.Z,{isSubmitButton:!0,...n,children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...n}=e;return(0,N.jsx)(V.Z,{...n,onClick:t||(()=>ae(o)),disabled:!te(),title:(0,N.jsx)(m.FormattedMessage,{id:"exportModal.exportButton.label",defaultMessage:"Export"})})},action:()=>ae(o)}]}]})})}function fe(e){let{includeContentsPopupStore:t,exportTypePopupStore:n,pdfFormatPopupStore:s,collectionViewExportTypePopupStore:a}=e;const r=(0,i.O7)(),{device:l}=r,d=(0,o.VK)((()=>M.Z.state.online),[]),c=(0,o.VK)((()=>j.ZP.state),[]);return d?c.open&&l.isMobile?(0,N.jsx)(ge,{exportTypePopupStore:n,pdfFormatPopupStore:s,modalState:c}):c.open?(0,N.jsx)(me,{includeContentsPopupStore:t,exportTypePopupStore:n,pdfFormatPopupStore:s,collectionViewExportTypePopupStore:a,modalState:c}):null:(0,N.jsx)(se,{})}},122301:(e,t,n)=>{n.d(t,{Z:()=>le});var s=n(667294),i=n(973935),o=n(883355),a=n(800480),r=n(886628),l=n(709291),d=n(653965),c=n(547307),u=n(627153),m=n(353471),p=n(433929),g=n(460709),f=n(319385),h=n(583279),y=n(713401),x=n(279131),S=n(301743),v=n(478140),b=n(840721),M=n(672495),j=(n(757658),n(724405)),C=n(895538),w=n(643593),k=n(350066),I=n(288864),T=n(99813),Z=n(954604),P=n(95477),F=n(749085);class _ extends F.default{getInitialState(){return{open:!1}}}const A=_;var B=n(224736),R=n(552275),D=n(231945),O=n(374194),L=n(632163),V=n(953437),E=n(81865),N=n(785893);function U(e){const{disabled:t,store:n,name:i,url:o,onChange:l,onDelete:d}=e,c=C.SR({url:e.url}),u=(0,s.useRef)(null),m=(0,a.O7)(),{device:p}=m,g=(0,r.qz)(void 0,A),f=(0,r.VK)((()=>g.state),[g]),h=(0,s.useCallback)((e=>{if(!f.open)return;g.setState({...f,inputValue:e});const t=w.rF({title:e,source:o});l({url:o,name:t})}),[g,f,l,o]),y=(0,s.useCallback)((()=>{g.setState({open:!0,inputValue:i})}),[g,i]),x=(0,s.useCallback)((()=>{g.setState({open:!1})}),[g]),S=(0,s.useCallback)((()=>{d(o)}),[d,o]),v=(0,s.useCallback)((()=>{I.Uk(m,{url:o,fileName:i,from:"FilePropertyMenuItem"}),T.ji(m,{url:o,download:!0,downloadName:i,permissionRecord:n.pointer})}),[m,i,n.pointer,o]),b=(0,s.useCallback)((()=>{T.Wl(m,{url:o,type:"file",from:"view_original",downloadName:i,permissionRecord:n.pointer})}),[m,i,n.pointer,o]),M=(0,s.useCallback)((()=>{if(!u.current)return;const e=u.current.getBoundingClientRect(),t=e.width/e.height;Z.ui({environment:m,renderFullScreenNode:()=>(0,N.jsx)(E.Z,{url:o,isAuthenticated:!0,permissionRecord:n.pointer,width:window.innerWidth,render:(e,t)=>(0,N.jsx)("img",{src:t,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",margin:0,alignSelf:"center",width:"100%"}})}),fullScreenNodeRect:e,contentAspectRatio:t,blockStore:n,imageUrl:o})}),[m,n,o]),P=(0,s.useCallback)((()=>{if(f.open)return(0,N.jsx)(z,{url:e.url,inputValue:f.inputValue,isOpen:f.open,handleFileRename:h,handleCloseRenamePopover:x})}),[f,x,h,e.url]),F=(0,j.yK)((()=>({imageInner:{display:"block",maxWidth:"100%",maxHeight:180,cursor:"zoom-in"},imageInnerWrapper:{flex:"auto",overflow:"hidden"}})),[]),_=(0,N.jsx)(K,{fileIsImage:c,fileUrl:o,disabled:t,handleOpenFullscreenPreviewOfFile:M,handleDownloadFile:v,handleViewOriginalFile:b,handleOpenRenamePopover:y,handleDeleteFile:S});return c?(()=>{const n=(0,N.jsx)(E.Z,{url:o,isAuthenticated:!0,permissionRecord:e.store.pointer,width:300,render:(e,t)=>(0,N.jsx)("div",{style:F.imageInnerWrapper,children:(0,N.jsx)("img",{src:t,style:F.imageInner,onClick:M,ref:u})})}),s={paddingTop:p.isMobile?12:8,paddingBottom:p.isMobile?12:8,alignItems:"flex-start"};return(0,N.jsx)(R.Z,{focused:!1,showDragHandle:!t&&!p.isMobile,style:s,title:n,right:_,dontShrinkRight:!0})})():(()=>{const t=(0,N.jsx)(R.Z,{focused:!1,showDragHandle:!e.disabled&&!p.isMobile,onClick:b,title:i,icon:(0,N.jsx)("div",{style:{width:p.isMobile?16:14},children:(0,k.R)()}),right:_,dontShrinkRight:!0});return(0,N.jsx)(V.ZP,{open:f.open,popupType:p.isMobile?D.Z4.SlideUp:D.Z4.Popup,origin:t,render:P,onDismiss:x})})()}function K(e){const{disabled:t,fileIsImage:n,fileUrl:i,handleOpenFullscreenPreviewOfFile:o,handleDownloadFile:r,handleViewOriginalFile:l,handleOpenRenamePopover:d,handleDeleteFile:c}=e,u=(0,a.O7)(),{isMobile:m}=u.device,p=(0,s.useCallback)((e=>(0,N.jsx)(B.Z,{isMobile:m,...e})),[m]),g=(0,s.useCallback)((e=>(0,N.jsx)(W,{fileIsImage:n,fileUrl:i,disabled:t,parent:e,handleOpenFullscreenPreviewOfFile:o,handleDownloadFile:r,handleViewOriginalFile:l,handleOpenRenamePopover:d,handleDeleteFile:c})),[n,i,t,o,r,l,d,c]);return(0,N.jsx)(D.ZP,{popupType:m?D.Z4.SlideUp:D.Z4.Popup,renderOrigin:p,render:g})}function W(e){const{parent:t,disabled:n,fileUrl:i,fileIsImage:o,handleOpenFullscreenPreviewOfFile:r,handleDownloadFile:d,handleViewOriginalFile:c,handleOpenRenamePopover:u,handleDeleteFile:m}=e,p=(0,a.O7)(),{isMobile:f,isNative:h}=p.device,y=(0,s.useMemo)((()=>{const e=[];o&&e.push({key:"fullscreen",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(l.FormattedMessage,{defaultMessage:"Full screen",id:"database.actionMenu.fileProperty.fullscreen.title"})}),action:r});return(w.E$(i,[P.default.secureFileS3.url,P.default.secureFileS3V2.url])||h)&&e.push({key:"download",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(l.FormattedMessage,{defaultMessage:"Download",id:"database.actionMenu.fileProperty.download.title"})}),action:d}),e.push({key:"original",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(l.FormattedMessage,{defaultMessage:"View original",id:"database.actionMenu.fileProperty.viewOriginal.title"})}),action:()=>c()}),n||o||e.push({key:"rename",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(l.FormattedMessage,{defaultMessage:"Rename",id:"database.actionMenu.fileProperty.rename.title"})}),action:u}),n||e.push({key:"delete",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(l.FormattedMessage,{defaultMessage:"Delete",id:"database.actionMenu.fileProperty.delete.title"})}),action:m}),e}),[n,o,i,m,r,u,c,d,h]),x=(0,s.useMemo)((()=>[{key:"section",render:e=>(0,N.jsx)(M.Z,{...e}),items:y}]),[y]),S=f?{menuType:g.og.ActionSheet}:{menuType:g.og.Popup,width:200};return(0,N.jsx)(v.Z,{...S,children:(0,N.jsx)(L.Z,{type:L.i.Vertical,initialFocus:0,onAccept:t.close,sections:x})})}function z(e){const{url:t,handleFileRename:n,handleCloseRenamePopover:i,isOpen:o,inputValue:r}=e,l=(0,a.O7)(),{device:d}=l,c=(0,s.useCallback)((e=>{const t=e.target.value;n(t)}),[n]),u=(0,j.yK)((e=>({renameInputWrapper:{display:"flex",alignItems:"center",color:e.regularTextColor,fontSize:"13px",padding:"4px 8px"},renameInput:{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}})),[]),m=d.isMobile?{menuType:g.og.ActionSheet}:{menuType:g.og.Popup,width:380};return o?(0,N.jsx)(v.Z,{...m,children:(0,N.jsx)("div",{style:u.renameInputWrapper,children:(0,N.jsx)(O.Z,{style:u.renameInput,value:r,placeholder:w.w2(t),onChange:c,onSubmit:i,focusInitial:!0,selectAll:!0})})}):null}const q={flex:"auto",overflow:"hidden"},G={display:"block",maxWidth:"100%",maxHeight:180,cursor:"zoom-in"};class H extends o.Z{constructor(){super(...arguments),this.storeTypes={filePropertyMenuItemStore:A},this.imageNode=null,this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderRenameMenu=()=>(0,N.jsx)(te,{url:this.props.url,onChange:this.props.onChange,filePropertyMenuItemStore:this.stores.filePropertyMenuItemStore}),this.handleFullScreen=()=>{if(!this.imageNode)return;const e=this.imageNode.getBoundingClientRect(),t=e.width/e.height;Z.ui({environment:this.environment,renderFullScreenNode:()=>(0,N.jsx)(E.Z,{url:this.props.url,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:window.innerWidth,render:(e,t)=>(0,N.jsx)("img",{src:t,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",margin:0,alignSelf:"center",width:"100%"}})}),fullScreenNodeRect:e,contentAspectRatio:t,blockStore:this.props.store,imageUrl:this.props.url})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleRename=()=>{return e=this.props.name,void this.stores.filePropertyMenuItemStore.setState({open:!0,inputValue:e});var e},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCloseRename=()=>X(this.stores.filePropertyMenuItemStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleRenameInputChange=e=>ee(e,this.props.url,this.props.onChange,this.stores.filePropertyMenuItemStore)}renderComponent(){const{url:e}=this.props;return C.SR({url:e})?this.renderImage(e):this.renderFile()}renderImage(e){const{device:t}=this.environment,{disabled:n}=this.props;return(0,N.jsx)(R.Z,{focused:!1,showDragHandle:!n&&!t.isMobile,style:{paddingTop:t.isMobile?12:8,paddingBottom:t.isMobile?12:8,alignItems:"flex-start"},title:(0,N.jsx)(E.Z,{url:e,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:300,render:(e,t)=>(0,N.jsx)("div",{style:q,children:(0,N.jsx)("img",{src:t,style:G,onClick:this.handleFullScreen,ref:e=>this.imageNode=e})})}),right:this.renderActionMenu(!0),dontShrinkRight:!0})}renderFile(){const{device:e}=this.environment,{disabled:t}=this.props,{name:n}=this.props;return(0,N.jsx)(V.GI,{open:this.stores.filePropertyMenuItemStore.state.open,popupType:e.isMobile?D.Z4.SlideUp:D.Z4.Popup,origin:(0,N.jsx)(R.Z,{focused:!1,showDragHandle:!t&&!e.isMobile,onClick:()=>J(this.props.url,this.props.name,this.props.store,this.environment),title:n,icon:(0,N.jsx)("div",{style:{width:e.isMobile?16:14},children:(0,k.R)()}),right:this.renderActionMenu(!1),dontShrinkRight:!0}),render:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderRenameMenu,onDismiss:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCloseRename})}getActionMenuItems(e){const{device:t}=this.environment,{url:n,disabled:s}=this.props,i=[];return e&&i.push({key:"fullscreen",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(l.FormattedMessage,{defaultMessage:"Full screen",id:"database.actionMenu.fileProperty.fullscreen.title"})}),action:this.handleFullScreen}),(w.E$(n,[P.default.secureFileS3.url,P.default.secureFileS3V2.url])||t.isNative)&&i.push({key:"download",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(l.FormattedMessage,{defaultMessage:"Download",id:"database.actionMenu.fileProperty.download.title"})}),action:()=>function(e,t,n,s){I.Uk(s,{url:e,fileName:t,from:"FilePropertyMenuItem"}),T.ji(s,{url:e,download:!0,downloadName:t,permissionRecord:n.pointer})}(this.props.url,this.props.name,this.props.store,this.environment)}),i.push({key:"original",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(l.FormattedMessage,{defaultMessage:"View original",id:"database.actionMenu.fileProperty.viewOriginal.title"})}),action:()=>J(this.props.url,this.props.name,this.props.store,this.environment)}),s||e||i.push({key:"rename",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(l.FormattedMessage,{defaultMessage:"Rename",id:"database.actionMenu.fileProperty.rename.title"})}),action:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleRename}),s||i.push({key:"delete",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(l.FormattedMessage,{defaultMessage:"Delete",id:"database.actionMenu.fileProperty.delete.title"})}),action:()=>function(e,t){e(t)}(this.props.onDelete,this.props.url)}),i}renderActionMenu(e){const{device:t}=this.environment;return(0,N.jsx)(D.ZP,{popupType:t.isMobile?D.Z4.SlideUp:D.Z4.Popup,renderOrigin:e=>(0,N.jsx)(B.Z,{isMobile:t.isMobile,...e}),render:n=>{let s;return s=t.isMobile?{menuType:g.og.ActionSheet}:{menuType:g.og.Popup,width:200},(0,N.jsx)(v.Z,{...s,children:(0,N.jsx)(L.Z,{type:L.i.Vertical,initialFocus:0,onAccept:n.close,sections:[{key:"section",render:e=>(0,N.jsx)(M.Z,{...e}),items:this.getActionMenuItems(e)}]})})}})}}H.displayName="FilePropertyMenuItem";const $=function(e){const t=(0,r.VK)((()=>f.default.checkGate({gateName:"file_property_menu_item_func_component"})),[])?U:H;return(0,N.jsx)(t,{...e})};function Y(e){return{display:"flex",alignItems:"center",color:e.regularTextColor,fontSize:"13px",padding:"4px 8px"}}function Q(e){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}}function J(e,t,n,s){T.Wl(s,{url:e,type:"file",from:"view_original",downloadName:t,permissionRecord:n.pointer})}function X(e){e.setState({open:!1})}function ee(e,t,n,s){const i=s.state;if(!i.open)return;const o=e.target.value;s.setState({...i,inputValue:o});n({url:t,name:w.rF({title:o,source:t})})}function te(e){let{url:t,onChange:n,filePropertyMenuItemStore:i}=e;const o=(0,j.Fg)(),l=(0,a.O7)(),d=(0,s.useCallback)((()=>X(i)),[i]),c=(0,s.useCallback)((e=>ee(e,t,n,i)),[t,n,i]),{device:u}=l,m=(0,r.VK)((()=>i.state),[i]);if(!m.open)return null;let p;return p=u.isMobile?{menuType:g.og.ActionSheet}:{menuType:g.og.Popup,width:380},(0,N.jsx)(v.Z,{...p,children:(0,N.jsx)("div",{style:Y(o),children:(0,N.jsx)(O.Z,{style:Q(o),value:m.inputValue,placeholder:w.w2(t),onChange:c,onSubmit:d,focusInitial:!0,selectAll:!0})})})}var ne=n(568785),se=n(828992),ie=n(532854);const oe=function(e){return(0,N.jsx)(se.Z,{title:(0,N.jsxs)("div",{style:{display:"flex"},children:[(0,N.jsx)(ne.Z,{style:{marginTop:1,marginRight:6}}),(0,N.jsx)(ie.Z,{percentage:e.progressPercent})]})})};function ae(e){const{store:t,uploadFiles:n,value:i,disabled:o,onChange:d,onDismiss:f}=e,x=de(i),j=(0,a.O7)(),C=(0,s.useRef)(),w=(0,s.useRef)(null),k=(0,r.qz)(void 0,h.Z),{isLoading:I,progressPercent:T}=(0,r.VK)((()=>k.state),[k]),Z=(0,s.useCallback)((e=>{k.setState({isLoading:!0,progressPercent:0}),C.current=e}),[k]),P=(0,s.useCallback)((e=>{const{progressPercent:t}=e;k.setState({...k.state,progressPercent:t})}),[k]),F=(0,s.useCallback)((e=>{if(!C.current)return;const t=C.current.map(((t,n)=>{const s=e[n];return{name:t.name||s,url:s}}));d({value:[...t,...i]}),k.reset()}),[k,d,i]),_=(0,s.useCallback)((()=>{k.reset(),c.showErrorMessage((0,N.jsx)(l.FormattedMessage,{id:"filePropertyMenu.uploadFileFailedError.message",defaultMessage:"Upload failed."}))}),[k]),A=(0,s.useCallback)((e=>{u.Z(),k.setState({isLoading:!0,progressPercent:0}),C.current=[e]}),[k]),B=(0,s.useCallback)((e=>{if(!C.current)return;const t=C.current[0];if(!t)return;const n={name:t.name||e,url:e};d({value:[...i,n]}),k.reset(),u.Z()}),[k,d,i]),R=(0,s.useCallback)((e=>{const t={name:e,url:e};d({value:[...i,t]}),k.reset(),u.Z()}),[k,d,i]),D=(0,s.useCallback)((()=>{const e=w.current;if(!(e&&e instanceof Element))return;const n=p.default.getIntl();u.$(j,{originRect:e.getBoundingClientRect(),originGap:3,isSmallWidth:!0,showArrow:!0,title:n.formatMessage({id:"filePropertyMenu.header",defaultMessage:"File"}),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:!1,videoUpload:!1,onUpload:e=>{m.cT({environment:j,file:e,bucket:"secure",record:t.pointer,onStart:A,onProgress:P,onComplete:B,onError:_})}},{type:"embed",onChange:R}]})}),[j,R,B,A,_,P,t.pointer]),O=(0,s.useCallback)((()=>{D()}),[D]),L=()=>{u.Z()};(0,s.useEffect)((()=>((()=>{const{device:e}=j;n?m.IL({environment:j,files:n,bucket:"secure",record:t.pointer,onBatchStart:Z,onBatchProgress:P,onBatchComplete:F,onBatchError:_}):de(i)&&!e.isMobile&&D()})(),L)),[]);const V=j.device.isMobile?{menuType:g.og.Modal,title:(0,N.jsx)(l.FormattedMessage,{defaultMessage:"File property",id:"database.fileProperty.mobileMenu.title"}),right:(0,N.jsx)(b.DoneMenuText,{}),onClickRight:f}:{menuType:g.og.Popup};return(0,N.jsx)(S.Z,{debugName:"FilePropertyMenu",capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,N.jsxs)(v.Z,{...V,children:[(0,N.jsx)(pe,{value:i,disabled:o,store:t,onChange:d}),(0,N.jsxs)(M.Z,{topBorder:!x&&!o,desktopStyle:{...x&&{paddingTop:3,paddingBottom:3}},children:[I&&(0,N.jsx)(oe,{progressPercent:T}),!I&&!o&&(0,N.jsx)(y.Z,{focused:!1,onClick:O,title:(0,N.jsx)(l.FormattedMessage,{id:"database.fileProperty.focusedLabel",defaultMessage:"Add a file or image"}),ref:w})]})]})})}class re extends o.Z{constructor(){super(...arguments),this.uploadingFiles=void 0,this.storeTypes={fileUploadStore:h.Z},this.handleAddFileMount=e=>{e&&(this.addFileButton=e)},this.handleAddFileClick=()=>{this.showMediaPicker()},this.handleMediaPickerUploadStart=e=>{u.Z(),this.stores.fileUploadStore.setState({isLoading:!0,progressPercent:0}),this.uploadingFiles=[e]},this.handleMediaPickerUploadComplete=e=>{const{value:t,onChange:n}=this.props;if(!this.uploadingFiles)return;const s=this.uploadingFiles[0];if(!s)return;n({value:[...t,{name:s.name||e,url:e}]}),this.stores.fileUploadStore.reset(),u.Z()},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMediaPickerEmbedComplete=e=>function(e,t,n,s){const i={name:e,url:e};n({value:[...t,i]}),s.reset(),u.Z()}(e,this.props.value,this.props.onChange,this.stores.fileUploadStore),this.handleUploadFilesStart=e=>{this.stores.fileUploadStore.setState({isLoading:!0,progressPercent:0}),this.uploadingFiles=e},this.handleUploadFilesComplete=e=>{const{value:t,onChange:n}=this.props;if(!this.uploadingFiles)return;n({value:[...this.uploadingFiles.map(((t,n)=>{const s=e[n];return{name:t.name||s,url:s}})),...t]}),this.stores.fileUploadStore.reset()},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUploadProgress=e=>function(e,t){const{progressPercent:n}=e;t.setState({...t.state,progressPercent:n})}(e,this.stores.fileUploadStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUploadError=()=>(this.stores.fileUploadStore.reset(),void c.showErrorMessage((0,N.jsx)(l.FormattedMessage,{id:"filePropertyMenu.uploadFileFailedError.message",defaultMessage:"Upload failed."})))}didMount(){const{device:e}=this.environment,{uploadFiles:t,store:n}=this.props;t?m.IL({environment:this.environment,files:t,bucket:"secure",record:n.pointer,onBatchStart:this.handleUploadFilesStart,onBatchProgress:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUploadProgress,onBatchComplete:this.handleUploadFilesComplete,onBatchError:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUploadError}):de(this.props.value)&&!e.isMobile&&this.showMediaPicker()}willUnmount(){u.Z()}renderComponent(){const{device:e}=this.environment,{disabled:t}=this.props,n=de(this.props.value),{isLoading:s,progressPercent:i}=this.stores.fileUploadStore.state;let o;return o=e.isMobile?{menuType:g.og.Modal,title:(0,N.jsx)(l.FormattedMessage,{defaultMessage:"File property",id:"database.fileProperty.mobileMenu.title"}),right:(0,N.jsx)(b.DoneMenuText,{}),onClickRight:this.props.onDismiss}:{menuType:g.og.Popup},(0,N.jsx)(S.Z,{debugName:"FilePropertyMenu",capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,N.jsxs)(v.Z,{...o,children:[(0,N.jsx)(pe,{value:this.props.value,disabled:this.props.disabled,store:this.props.store,onChange:this.props.onChange}),(0,N.jsxs)(M.Z,{topBorder:!n&&!t,desktopStyle:{...n&&{paddingTop:3,paddingBottom:3}},children:[s&&(0,N.jsx)(oe,{progressPercent:i}),!s&&!t&&(0,N.jsx)(y.Z,{focused:!1,onClick:this.handleAddFileClick,title:(0,N.jsx)(l.FormattedMessage,{id:"database.fileProperty.focusedLabel",defaultMessage:"Add a file or image"}),ref:this.handleAddFileMount})]})]})})}showMediaPicker(){const{store:e}=this.props,t=i.findDOMNode(this.addFileButton);if(!t)return;if(!(t instanceof Element))return;const n=p.default.getIntl();u.$(this.environment,{originRect:t.getBoundingClientRect(),originGap:3,isSmallWidth:!0,showArrow:!0,title:n.formatMessage({id:"filePropertyMenu.header",defaultMessage:"File"}),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:!1,videoUpload:!1,onUpload:t=>{m.cT({environment:this.environment,file:t,bucket:"secure",record:e.pointer,onStart:this.handleMediaPickerUploadStart,onProgress:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUploadProgress,onComplete:this.handleMediaPickerUploadComplete,onError:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUploadError})}},{type:"embed",onChange:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMediaPickerEmbedComplete}]})}}re.displayName="FilePropertyMenuClass";const le=function(e){const t=(0,r.VK)((()=>f.default.checkGate({gateName:"file_property_menu_functional_component"})),[])?ae:re;return(0,N.jsx)(t,{...e})};function de(e){return 0===e.length}function ce(e,t,n){n({value:t.map((t=>t.url===e.url?{name:e.name,url:e.url}:t))})}function ue(e,t,n){n({value:t.filter((t=>t.url!==e))})}function me(e){let{url:t,value:n,disabled:s,store:i,onChange:o}=e;const r=(0,a.O7)(),{device:l}=r,d=n.find((e=>e.url===t));if(d){const e=d.url,t=d.name;return l.isMobile?(0,N.jsx)(M.Z,{children:(0,N.jsx)($,{store:i,name:t,url:e,onDelete:e=>ue(e,n,o),onChange:e=>ce(e,n,o),disabled:s})}):(0,N.jsx)($,{store:i,name:t,url:e,onDelete:e=>ue(e,n,o),onChange:e=>ce(e,n,o),disabled:s})}return null}function pe(e){let{value:t,disabled:n,store:i,onChange:o}=e;const r=(0,a.O7)(),{device:l}=r,c=d.oA(t.map((e=>e.url)));return 0===c.length?null:l.isMobile||n?(0,N.jsx)(s.Fragment,{children:c.map((e=>(0,N.jsx)(me,{url:e,value:t,disabled:n,store:i,onChange:o},e)))}):(0,N.jsx)(M.Z,{children:(0,N.jsx)(x.ZP,{direction:"vertical",keys:c,renderKey:e=>(0,N.jsx)(me,{url:e,value:t,disabled:n,store:i,onChange:o}),onDrop:e=>function(e,t,n){t({value:d.MR(n,(t=>{const n=t.url;return n?e.indexOf(n):1/0}))})}(e,o,t)})})}},682767:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j,getSpaceViewMenuItems:()=>C});n(757658),n(667294);var s=n(800480),i=n(886628),o=n(709291),a=n(403297),r=n(497977),l=n(476795),d=n(653965);var c=n(460709),u=n(548779),m=n(223196),p=n(80444),g=n(189256),f=n(552275),h=n(478140),y=n(632163),x=n(840721),S=n(953437),v=n(731278),b=n(672495),M=n(785893);const j=function(){const e=(0,s.O7)(),{device:t}=e,n=(0,i.VK)((()=>g.Z.state),[]);return(0,M.jsx)(S.ZP,{popupType:t.isMobile?m.k.SlideUp:m.k.Popup,open:n.open,render:()=>(0,M.jsx)(w,{}),originGap:8,onDismiss:a.sC,originRect:n.originRect,enableRounding:!0})};function C(e,t){const{device:n}=e,{currentUserRootStore:s}=p.default.state;if(!s)return[];const{editableStores:i}=function(e){const t=d.mN(e.getSpaceViewStores(),(e=>e.getSpaceId())),n=t.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())})),s=n.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())&&t.canEdit()}));return{total:t.length,loaded:n.length,editable:s.length,editableStores:s}}(s),o=[];for(const a of i){const s=a.getSpaceStore();if(null!=s&&s.isReady()&&s.canEdit()){const i=(0,u.rn)(e,s),r=(0,u.Wd)(e,s);o.push({key:a.id,action:async()=>{await l.JI({environment:e,blockStore:t,spaceStore:s,spaceViewStore:a})},render:e=>(0,M.jsx)(f.Z,{title:i,icon:(0,M.jsx)(v.Z,{icon:r,isEmptyPage:!1,title:i,size:n.isMobile?24:20,disabled:!0}),...e})})}}return o}function w(){const e=(0,s.O7)(),{device:t}=e,n=(0,i.VK)((()=>g.Z.state),[]),l=(0,i.VK)((()=>p.default.state.currentUserRootStore),[]),d=(0,i.VK)((()=>n.store?C(e,n.store):[]),[e,n]);if(!n.open||!l)return null;const u=[{key:"spaces",render:e=>(0,M.jsx)(b.Z,{title:t.isMobile?void 0:(0,M.jsx)(o.FormattedMessage,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.chooseWorkspace.menuItem.title"}),isTitleUppercase:!0,...e}),items:d},{key:"logout",render:e=>(0,M.jsx)(b.Z,{...e,topBorder:!0}),items:[{key:"logout",action:()=>r.logout(e),render:e=>(0,M.jsx)(k,{...e})}]}];let m;return m=t.isMobile?{menuType:c.og.Modal,title:(0,M.jsx)(o.FormattedMessage,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.choooseWorkspaceMobileMenu.title"}),right:(0,M.jsx)(x.CancelMenuText,{}),onClickRight:a.sC}:{menuType:c.og.Popup},(0,M.jsx)(h.Z,{...m,children:(0,M.jsx)(y.Z,{type:y.i.Vertical,sections:u,initialFocus:1})})}function k(e){const t=(0,i.VK)((()=>{const{currentUserStore:e}=p.default.state;return(null==e?void 0:e.getEmail())||""}),[]);return(0,M.jsx)(f.Z,{caption:(0,M.jsx)(o.FormattedMessage,{defaultMessage:"Log out ({email})",id:"duplicatePagePopup.buttonMenuItem.logoutButton.label",values:{email:t}}),...e})}},623801:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var s=n(667294),i=n(800480),o=n(886628),a=n(76233),r=n(653965),l=n(523728),d=n(319385),c=n(924666);function u(e){const{store:t}=e;return function(e){const t=(0,i.O7)(),[n,u]=(0,s.useState)("uninitialized"),[m,p,g,f,h]=(0,o.VK)((()=>{var t,n;return e.pathIsDead()||"on"!==d.default.getEligibleGroup({experimentId:"dynamic_social_preview_image",defaultGroup:"unassigned"})?[!1]:[e.isReady(),a.QaF(e.getTitleValue()),null===(t=e.getIcon())||void 0===t?void 0:t.icon,null===(n=e.getCover())||void 0===n?void 0:n.cover,e.getFormat().page_font]}),[e]);(0,s.useEffect)((()=>{"storeReady"===n?u("generateImage"):m&&u("storeReady")}),[m,p,g,f,h]);const y=(0,s.useMemo)((()=>(0,r.Ds)((()=>{u("storeReady"),l.O({environment:t,store:e})}),5e3)),[t,e]);(0,o.VK)((()=>{"generateImage"===n&&(c.default.state,y())}),[n,y])}(t),null}},679027:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(841892),l=n(709291),d=n(137810),c=n(91376),u=n(417311),m=n(107844),p=n(550506),g=n(158297),f=n(462385),h=n(785893);function y(){const e=(0,i.Fy)(),t=(0,o.VK)((()=>m.Z.state.open),[]),n=()=>{m.Z.state.open&&m.Z.state.onDecline&&m.Z.state.onDecline(),m.Z.setState({open:!1})},y=()=>{m.Z.state.open&&m.Z.state.onConfirm(),m.Z.setState({open:!1})},x=()=>{n(),c.r$({currentTab:"connected_apps"})},S=(0,a.yK)((e=>({wrap:{padding:"24px 36px 24px",minWidth:300,maxWidth:400},modalHeaderWrap:{textAlign:"center",marginTop:8,marginBottom:18,justifyContent:"space-between"},modalMessage:{fontSize:16,lineHeight:1.5,fontWeight:d.Z.fontWeight.medium,marginTop:15,marginBottom:20,color:e.mediumTextColor}})),[]);return(0,h.jsx)(p.Z,{open:t,innerStyle:S.wrap,preventHideChildrenWhileOpening:!0,render:()=>(0,h.jsx)(s.Fragment,{children:(0,h.jsxs)("div",{style:S.modalHeaderWrap,children:[(0,h.jsx)("img",{src:r.Z.images.googleDriveLogoPng,style:{width:50,display:"inline-block"}}),(0,h.jsx)("div",{style:S.modalMessage,children:(0,h.jsx)(l.FormattedMessage,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})}),e.isMobileNative?(0,h.jsx)("div",{style:S.modalMessage,children:(0,h.jsx)(l.FormattedMessage,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})}):(0,h.jsx)(g.Z,{isLarge:!0,onClick:y,children:(0,h.jsx)(l.FormattedMessage,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"})}),!e.isMobile&&(0,h.jsx)("div",{style:{display:"block",marginTop:u.Z.vertical.tiny},children:(0,h.jsx)(f.Z,{underlined:!0,onClick:x,children:(0,h.jsx)(l.FormattedMessage,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"})})})]})}),onDismiss:n})}},225228:(e,t,n)=>{n.r(t),n.d(t,{ImportIntoNewPageModal:()=>m,default:()=>p});n(667294);var s=n(886628);const i=(0,n(745238).CZ)("importIntoNewFile",{default:{loader:()=>n.e(73465).then(n.bind(n,873465)),size:20},small:{loader:()=>n.e(193).then(n.bind(n,193)),size:16},mini:{loader:()=>n.e(80928).then(n.bind(n,580928)),size:14},large:{loader:()=>n.e(53882).then(n.bind(n,453882)),size:24}});var o=n(709291),a=n(770681),r=n(992083),l=n(382914),d=n(699884),c=n(785893);function u(){a.Z.setState({open:!1})}function m(){const e=(0,s.VK)((()=>a.Z.state),[]);return(0,c.jsx)(d.c,{isOpen:e.open,onDismiss:u,onClosed:u,areaConstraint:{width:{type:"fixed",length:300}},render:()=>(0,c.jsx)(l.sR,{header:(0,c.jsx)(l.vI,{iconAndTitle:(0,c.jsx)(l.kC,{iconGroup:i,title:(0,c.jsx)(o.FormattedMessage,{defaultMessage:"Import into new page?",id:"importIntoNewPageModal.title"})}),description:(0,c.jsx)(o.FormattedMessage,{id:"importIntoNewPageModal.description",defaultMessage:"Since this page already has content, we’ll need to create a new page for you and import contents there."})}),footer:(0,c.jsx)(l.a6,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:(0,c.jsx)(o.FormattedMessage,{defaultMessage:"Yes, continue",id:"importIntoNewPageModal.importButton"}),onClick:()=>{r.Z.setState({open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"collection"}),u()}}],secondaryButtons:[{buttonType:"secondary",label:"Cancel",onClick:u}]})})})}const p=m},990185:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var s=n(667294),i=n(800480),o=n(886628),a=n(815145),r=n(584169),l=n(709291),d=n(137810),c=n(225888),u=n(275754),m=n(918514),p=n(80444),g=n(749085);class f extends g.default{getInitialState(){return{open:!1}}}const h=new f;var y=n(316354),x=n(550506),S=n(489728),v=n(273917),b=n(785893);const M={fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:d.Z.fontWeight.bold,marginRight:"auto"},j={display:"flex",alignItems:"center",marginTop:8,marginBottom:18},C={padding:"24px 36px 24px",minWidth:300};const w=function(){const e=(0,o.VK)((()=>h.state),[]);return(0,b.jsx)(x.Z,{open:e.open,innerStyle:C,preventHideChildrenWhileOpening:!0,render:()=>(0,b.jsxs)(s.Fragment,{children:[(0,b.jsxs)("div",{style:j,children:[(0,b.jsx)("div",{style:M,children:(0,b.jsx)(l.FormattedMessage,{id:"importModal.importButton.label",defaultMessage:"Import"})}),(0,b.jsx)(k,{})]}),(0,b.jsx)("div",{children:(0,b.jsx)(T,{modalState:e})})]}),onDismiss:I})};function k(){const e=(0,i.O7)();return(0,b.jsx)(y.Z,{href:(0,m.UY)("guides.import"),onClick:()=>c.Fs(e,{from:"import"}),external:!0,children:(0,b.jsx)(S.Z,{isSmall:!0,icon:r.m,isGray:!0,children:(0,b.jsx)(l.FormattedMessage,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})})})}function I(){h.setState({open:!1})}function T(e){let{modalState:t}=e;const n=(0,i.O7)(),{mainEditorCurrentBlockStore:s,currentSpaceStore:r,currentSpaceViewStore:l,currentUserSettingsStore:d}=(0,o.VK)((()=>{const{mainEditorCurrentBlockStore:e,currentSpaceStore:t,currentSpaceViewStore:n,currentUserSettingsStore:s}=p.default.state;return{mainEditorCurrentBlockStore:e,currentSpaceStore:t,currentSpaceViewStore:n,currentUserSettingsStore:s}}),[]);return s&&r&&l&&d?(0,b.jsx)(v.Z,{pageStore:t.open&&t.pageStore?t.pageStore:s,spaceStore:r,spaceViewStore:l,userSettingsStore:d,analyticsFrom:"modal",onComplete:e=>function(e,t){h.setState({open:!1}),u._c({environment:t,store:e,pageVisitSource:a.tY.Import})}(e,n),readOnlyCreditButton:!1}):null}},273917:(e,t,n)=>{n.d(t,{Z:()=>Ut});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(841892),l=n(356666),d=n(584169),c=n(582356),u=n(745238),m=n(785893);const p=(0,u.IU)("importCSV",{viewBox:"0 0 32 32",svg:(0,m.jsx)("polygon",{points:"21.0286 9.14285 10.7429 9.14285 10.7429 10.8571 16.3143 16 10.7429 21.1429 10.7429 22.8571 21.0286 22.8571 21.0286 20.2857 15.0286 20.2857 19.3143 16 15.0286 11.7143 21.0286 11.7143"})}),g=(0,u.IU)("importHTML",{viewBox:"0 0 32 32",svg:(0,m.jsx)("path",{d:"M13.088,21.472 L7.93605,16.32 L13.088,11.168 L11.52,9.59999 L4.80005,16.32 L11.52,23.04 L13.088,21.472 Z M18.912,21.472 L24.0641,16.32 L18.912,11.168 L20.48,9.59999 L27.2,16.32 L20.48,23.04 L18.912,21.472 Z"})}),f=(0,u.IU)("importText",{viewBox:"0 0 32 32",svg:(0,m.jsx)("path",{d:"M6.3999,22.4 L19.1999,22.4 L19.1999,20.2667 L6.3999,20.2667 L6.3999,22.4 Z M6.3999,9.59999 L6.3999,11.7333 L25.5999,11.7333 L25.5999,9.59999 L6.3999,9.59999 Z M6.3999,17.0667 L25.5999,17.0667 L25.5999,14.9333 L6.3999,14.9333 L6.3999,17.0667 Z"})});var h=n(471924),y=n(334390),x=n(709291),S=n(100952),v=n(757549),b=n(141311),M=n(547307),j=n(749085);class C extends j.default{getInitialState(){return{}}}const w=new C;var k=n(454642),I=n(792625);async function T(e){const{environment:t,spaceId:n,requestStore:s}=e;if(!t.currentUser.id)return M.showMessage({message:"Invalid details"}),void I.x();w.setState({...w.state,[n]:{...w.state[n],showLoader:!0}});const i=await k.getConfluenceSpaces(t,{spaceId:n});if(await(null==s?void 0:s.refresh()),w.setState({...w.state,[n]:{...w.state[n],showLoader:!1}}),"failed"!==i.type)return w.setState({...w.state,[n]:{...w.state[n],spacesResult:i.data}}),i.data;console.error(i.error),M.showError(i),I.x()}var Z=n(383805),P=n(400601),F=n(361397),_=n(752192),A=n(823586),B=n(672340),R=n(908989),D=n(328415),O=n(922756),L=n(325775),V=n(369122);async function E(e){const t=await k.getTrelloAccount(e,{});return"success"===t.type?t.data:(console.error(t.error),{})}async function N(e){return Promise.resolve({areAccountsFetched:L.Z.state.areAccountsFetched,accountsResponse:L.Z.state.accountsResponse,isGoogleDocImporterEnabled:(0,D.I2)(),selectedFileId:L.Z.state.selectedFileId})}async function U(e){O.Z.setState({...O.Z.state,isFetchingAsanaAccount:!0});const t=await k.getAsanaAccount(e,{});if("success"===t.type){const{account:e}=t.data;return O.Z.setState({...O.Z.state,account:e,isFetchingAsanaAccount:!1}),e?t.data:{}}return console.error(t.error),O.Z.setState({...O.Z.state,isFetchingAsanaAccount:!1}),{}}async function K(e){try{const t=await k.getEvernoteAccount(e,{});if("success"===t.type){const{userInfo:e}=t.data;return{userInfo:e}}return console.error(t.error),{userInfo:void 0}}catch(t){return console.error(t),{userInfo:void 0}}}var W=n(292283),z=n(460709),q=n(556335),G=n(105749),H=n(918514),$=n(548779),Y=n(825464),Q=n(788632),J=n(78900),X=n(490365),ee=n(167940),te=n(682066),ne=n(121039),se=n(672087),ie=n(992083),oe=n(981676),ae=n(531701),re=n(80444),le=n(61766);const de=new le.Z;var ce=n(693405),ue=n(231945),me=n(573063),pe=n(316354),ge=n(568785),fe=n(478140),he=n(632163),ye=n(953437),xe=n(672495),Se=n(526388),ve=n(164369),be=n(137810),Me=n(915560),je=n(164921),Ce=n(974420);const we={fontSize:16,fontWeight:be.Z.fontWeight.medium},ke=28,Ie={flexShrink:0,width:ke,height:ke,borderRadius:4,marginRight:10,background:ae.O9.white};const Te=function(e){let{title:t,actionButton:n,onClick:s,tooltipEvents:i,icon:o,logo:r,caption:l,shouldWrapCaption:d,showNewBadge:c,showBetaBadge:u}=e;const p=(0,a.Fg)();return(0,m.jsxs)(je.Z,{...i,onClick:s,style:Ze(p),children:[(0,m.jsx)(_e,{icon:o,logo:r}),(0,m.jsxs)("div",{style:{minWidth:0,width:"100%"},children:[(0,m.jsxs)("div",{style:{display:"flex"},children:[(0,m.jsx)("div",{style:we,children:t}),c&&(0,m.jsx)(Ce.Z,{}),u&&(0,m.jsx)(Me.Z,{}),(0,m.jsx)("div",{style:{marginLeft:"auto"},children:n})]}),(0,m.jsx)(Ae,{caption:l,shouldWrapCaption:d})]})]})};function Ze(e){return{display:"flex",alignItems:"center",padding:10,paddingRight:8,borderRadius:4,marginBottom:12,cursor:"pointer",boxShadow:e.lightBoxShadow,transition:"background 200ms ease-out",background:e.importOptionsButtonBackground}}function Pe(e){return{display:"flex",alignItems:"center",justifyContent:"center",width:ke,height:ke,borderRadius:4,marginRight:8,color:e.mediumTextColor,background:e.importOptionsIconWrapBackground}}function Fe(e,t){return{fontSize:12,color:e.mediumTextColor,wordBreak:"keep-all",...!t&&{...be.Z.textOverflowStyle}}}function _e(e){let{icon:t,logo:n}=e;const s=(0,a.Fg)();return n?(0,m.jsx)("img",{style:Ie,src:n}):t?(0,m.jsx)("div",{style:Pe(s),children:t({flexShrink:0,width:ke,height:ke})}):null}function Ae(e){let{caption:t,shouldWrapCaption:n}=e;const s=(0,a.Fg)();return t?(0,m.jsx)("div",{style:Fe(s,n),children:t}):null}const Be={whiteSpace:"pre-wrap"};function Re(e,t){return(0,m.jsx)(Se.Z,{renderTooltip:()=>(0,m.jsx)(ve.Z,{style:{color:ae.ZP.white},isSmall:!0,children:(0,m.jsx)(x.FormattedMessage,{id:"AsanaImportOption.helpButton.tooltip",defaultMessage:"Learn about how to import"})}),render:n=>(0,m.jsx)(pe.Z,{...n,external:!0,href:e,style:{marginLeft:"auto"},children:(0,m.jsx)(me.Z,{icon:d.m,ariaLabel:t.formatMessage({id:"AsanaImportOption.helpButton.ariaLabel",defaultMessage:"Learn about how to asana import help icon"})})})})}const De=function(){const e=(0,o.VK)((()=>O.Z.state),[]),{account:t,isLoadingAsanaWorkspaces:n,isAccountDelinkingInProgress:a,isAccountLinkingInProgress:d}=e,c=(0,i.O7)(),u=(0,x.useIntl)(),{device:p}=c,g=(0,o.VK)((()=>ee.Z.state),[]),f=g.flowId||h.Il();(0,s.useEffect)((()=>{g.flowId||ee.Z.setState({flowId:f})}),[f,g]);const y={title:u.formatMessage({id:"asanaImportOption.asanaButton.title",defaultMessage:"Asana"}),logo:r.Z.images.import.asanaPng,caption:d?u.formatMessage({id:"asanaImportOption.asanaButton.accountLinkingInProgress",defaultMessage:"Authenticating..."}):a?u.formatMessage({id:"asanaImportOption.asanaButton.accountDelinkingInProgress",defaultMessage:"Removing account..."}):t,actionButton:t?(S=[{name:u.formatMessage({id:"asanaImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),captionText:u.formatMessage({id:"asanaImportOption.connectAnotherAccount.captionText",defaultMessage:"Ensure you are logged into the new Asana account in your browser"}),action:()=>b.w1({environment:c,flowId:f}).catch((()=>{}))},{name:u.formatMessage({id:"asanaImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>b.XP({environment:c})}],(0,m.jsx)(ue.ZP,{popupType:ye.kQ.Popup,renderOrigin:e=>n?(0,m.jsx)(ge.Z,{}):(0,m.jsx)(me.Z,{ariaLabel:u.formatMessage({id:"asanaImportOption.asanaButton.ariaLabel",defaultMessage:"Import from Asana button"}),icon:l.o,...e}),render:e=>{const t={key:"section",render:e=>(0,m.jsx)(xe.Z,{...e}),items:S.map((t=>{let{name:n,captionText:s,action:i}=t;return{key:n,render:e=>(0,m.jsx)(ce.Z,{...e,title:n,caption:s,captionStyle:s?Be:void 0}),action:()=>{i(),e.close()}}}))};return(0,m.jsx)(fe.Z,{menuType:z.og.Popup,width:200,children:(0,m.jsx)(he.Z,{type:he.i.Vertical,initialFocus:void 0,sections:[t]})})}})):Re((0,H.UY)("guides.importAsana"),u),onClick:()=>{}};var S;return(0,m.jsx)(ue.ZP,{onClick:async()=>{var e;O.Z.resetImport(),n||d||a||(t?(v.ay(c,{import_source:"asana",from:"settings_modal",userId:c.currentUser.id,spaceId:null===(e=re.default.state.currentSpaceStore)||void 0===e?void 0:e.id,flowId:f}),await b.bA({environment:c}),b.h7()):b.w1({environment:c,flowId:f}).catch((()=>{})))},popupType:p.isMobile?ue.Z4.SlideUp:ue.Z4.Popup,buttonPopupStore:de,renderOrigin:e=>{let{onClick:t}=e;return(0,m.jsx)(Te,{...y,onClick:t})},render:()=>null})};var Oe=n(536591),Le=n(542853),Ve=n(844495),Ee=n(422711),Ne=n(552275),Ue=n(661519),Ke=n(301743),We=n(374194),ze=n(550506),qe=n(863296),Ge=n(489728),He=n(158297),$e=n(474523),Ye=n(184747),Qe=n(158573);class Je extends j.default{getInitialState(){return{searchQuery:"",selection:new Set}}}const Xe=Je;var et=n(268894),tt=n(743765),nt=n(629551);const st=function(e){let{searchInputPlaceholder:t,sections:n,noSearchResultsPlaceholder:s,handleClickImportConfluenceWorkspace:i,onComplete:a}=e;const r=(0,o.qz)(void 0,Xe);return(0,Ye.Z)((()=>{const e=r.state.selection,[t]=n;if(t){const[n]=t.items;n&&e.add(n.key)}r.emit()})),(0,m.jsx)(fe.Z,{menuType:z.og.Popup,header:(0,m.jsx)(it,{searchInputPlaceholder:t,store:r}),width:280,maxHeight:350,children:(0,m.jsx)(ot,{sections:n,noSearchResultsPlaceholder:s,handleClickImportConfluenceWorkspace:i,onComplete:a,store:r})})};function it(e){let{searchInputPlaceholder:t,store:n}=e;const s=(0,o.qz)(n,Xe),i=(0,o.VK)((()=>s.state.searchQuery),[s]);return(0,m.jsx)(xe.Z,{isInput:!0,desktopStyle:{paddingBottom:2},children:(0,m.jsx)(et.ZP,{focus:!0,focusAfterAnimation:!0,value:i,onChange:e=>{s.setState({...s.state,searchQuery:e.target.value})},placeholder:t})})}function ot(e){let{sections:t,noSearchResultsPlaceholder:n,handleClickImportConfluenceWorkspace:s,onComplete:i,store:a}=e;const r=(0,o.qz)(a,Xe),l=(0,o.VK)((()=>r.state.searchQuery),[r]),d=t.map((e=>{const t=(0,Qe.ZP)(l,e.items,(t=>`${t.key} ${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===d.length)return(0,m.jsx)(xe.Z,{children:(0,m.jsx)(tt.Z,{title:n})});const c=d.map((e=>{const n=e.items.map((e=>e.name)),o={};return n.forEach((e=>{o[e]=o[e]?o[e]+1:1})),{key:e.name,render:n=>(0,m.jsx)(xe.Z,{...n,title:t.length>1?e.name:void 0}),items:e.items.map((e=>({key:e.key,render:t=>(0,m.jsx)(Ne.Z,{...t,title:(0,m.jsxs)(nt.gq,{gap:2,alignItems:"center",children:[e.name,o[e.name]>1&&(0,m.jsx)(Se.Z,{placement:Y.u.Right,renderTooltip:()=>e.key,render:t=>(0,m.jsx)(me.Z,{ariaLabel:`Associated space key is ${e.key}`,disableBackground:!0,icon:Ve.D,...t})})]}),right:void 0!==e.count&&(0,m.jsx)(ve.Z,{isSmall:!0,children:e.count})}),action:()=>{s(e.key,e.name),function(e,t){t(e)}(e,i)}})))}}));return(0,m.jsx)(he.Z,{type:he.i.Vertical,initialFocus:void 0,sections:c})}const at={whiteSpace:"pre-wrap"};function rt(e){const{key:t,value:n,spaceId:s}=e;w.setState({...w.state,[s]:{...w.state[s],[t]:n}})}function lt(e){var t;const{onSelectOption:n,options:s,currentOption:i}=e,o=null===(t=s.find((e=>{let{key:t}=e;return t===i})))||void 0===t?void 0:t.label,r=(0,a.yK)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,m.jsx)(ue.ZP,{popupType:ue.Z4.Popup,placementToOrigin:ue.pO.Left,renderOrigin:e=>(0,m.jsxs)(Ge.Z,{...e,isLarge:!0,style:{opacity:1},disabled:!1,children:[o,(0,Le.i)(r.icon)]}),render:e=>{const t={menuType:z.og.Popup,width:250,left:50},i=[{key:"settings-item-section",render:e=>(0,m.jsx)(xe.Z,{...e}),items:s.map((t=>{let{key:s,label:i}=t;return{key:s,action:()=>{n(s),e.close()},render:e=>(0,m.jsx)(Ne.Z,{...e,title:i,shouldWrapCaption:!0,right:o===i?(0,m.jsx)("div",{style:{width:14},children:(0,Oe.e)()}):void 0})}}))}];return(0,m.jsx)(fe.Z,{...t,children:(0,m.jsx)(he.Z,{type:he.i.Vertical,sections:i,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}async function dt(e){await async function(e){const{environment:t,requestStore:n,userEmail:s,site:i,access_token:o,instance:a,spaceId:r,username:l,password:d,flowId:c}=e;if(!t.currentUser.id)return M.showMessage({message:"Invalid details"}),void I.x();const u=await k.authenticateConfluenceUser(t,{userEmail:s,site:i,access_token:o,instance:a,userId:t.currentUser.id,spaceId:r,username:l,password:d});await n.refresh(),"failed"===u.type?(v.a1(t,{import_source:"confluence",data:{import_type:"api",status:"failure",error:u.error},flowId:c}),console.error(u.error),M.showError(u)):(v.a1(t,{import_source:"confluence",data:{import_type:"api",status:"success"},flowId:c}),M.showMessage({message:"Successfully connected confluence instance."}),await T({environment:t,requestStore:n,spaceId:r})),I.x()}(e)}function ct(e){let{environment:t,title:n,email:s,accountType:i,site:r,APIToken:l,personalAccessToken:d,confluenceVersion:c,username:u,password:p,hidePopup:g,spaceId:f,flowId:h,requestStore:y}=e;const S=(0,o.VK)((()=>w.getState()),[]),v=(0,a.yK)((e=>({title:{fontWeight:be.Z.fontWeight.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"},helpText:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor}})),[]);return(0,m.jsx)(Ke.Z,{debugName:"ConfluenceImportOption",capture:!0,children:(0,m.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"},children:[(0,m.jsxs)("div",{style:{overflowY:"scroll"},children:[(0,m.jsxs)("div",{style:{marginBottom:24},children:[(0,m.jsx)("div",{style:v.title,children:n}),(0,m.jsx)($e.Z,{title:(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Confluence"}),href:"https://www.notion.so/help/import-from-confluence",analyticsFrom:"import",style:{marginTop:8}})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row"},children:[(0,m.jsx)("label",{htmlFor:"accountType",style:{...v.inputLabels},children:i}),(0,m.jsx)(lt,{onSelectOption:e=>{rt({key:"instanceValue",value:e,spaceId:f})},options:[{key:"Cloud",label:(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownCloudOption.label",defaultMessage:"Cloud"})},{key:"Server",label:(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownServerOption.label",defaultMessage:"Server/On-Premise"})}],currentOption:S[f].instanceValue??"Cloud"})]}),(0,m.jsx)(Ue.Z,{size:12,isHidden:!0}),(0,m.jsx)("div",{children:"Server"===S[f].instanceValue?(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row",alignItems:"center"},children:[(0,m.jsx)("label",{htmlFor:"confluenceVersion",style:{...v.inputLabels},children:c}),(0,m.jsx)(lt,{onSelectOption:e=>{rt({key:"confluenceAuthenticationTypeValue",value:e,spaceId:f})},options:[{key:"OAuth2.0",label:(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.confluenceVersionDropdownNewVersionOption.label",defaultMessage:"7.9 or later"})},{key:"Basic",label:(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.confluenceVersionDropdownOlderVersionOption.label",defaultMessage:"Prior to 7.9"})}],currentOption:S[f].confluenceAuthenticationTypeValue??"OAuth2.0"})]}),(0,m.jsx)(Ue.Z,{size:12,isHidden:!0})]}):void 0}),(0,m.jsx)("label",{htmlFor:"email",style:{...v.inputLabels},children:s}),(0,m.jsx)(We.Z,{id:"email",value:S[f].emailValue,autoComplete:"off",autoCapitalize:"off",onChange:e=>{rt({key:"emailValue",value:e.target.value,spaceId:f})},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),(0,m.jsx)(Ue.Z,{size:12,isHidden:!0}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"site",style:{...v.inputLabels},children:r}),(0,m.jsx)(We.Z,{id:"site",value:S[f].siteValue,onChange:e=>rt({key:"siteValue",value:e.target.value,spaceId:f}),showClearButton:!0,placeholder:"Cloud"===S[f].instanceValue?"https://confluence.atlassian.net":"https://domain.com",inputElementAttributes:{minLength:4}}),(0,m.jsx)(Ue.Z,{size:12,isHidden:!0}),"Cloud"===S[f].instanceValue?(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"APIToken",style:{...v.inputLabels},children:l}),(0,m.jsx)(We.Z,{id:"AccessToken",type:"password",value:S[f].tokenValue,onChange:e=>{rt({key:"tokenValue",value:e.target.value,spaceId:f})},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})]}):(0,m.jsx)("div",{children:(0,m.jsx)("div",{children:"Basic"===S[f].confluenceAuthenticationTypeValue?(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"username",style:{...v.inputLabels},children:u}),(0,m.jsx)(We.Z,{id:"username",value:S[f].usernameValue,onChange:e=>{rt({key:"usernameValue",value:e.target.value,spaceId:f})},showClearButton:!0,placeholder:"confluenceUser",inputElementAttributes:{minLength:1}}),(0,m.jsx)(Ue.Z,{size:12,isHidden:!0}),(0,m.jsx)("label",{htmlFor:"password",style:{...v.inputLabels},children:p}),(0,m.jsx)(We.Z,{type:"password",id:"password",value:S[f].passwordValue,onChange:e=>{rt({key:"passwordValue",value:e.target.value,spaceId:f})},showClearButton:!0,placeholder:"P@S$w0rd",inputElementAttributes:{minLength:1}})]}):(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"AccessToken",style:{fontSize:"14px",fontWeight:"400"},children:d}),(0,m.jsx)(We.Z,{id:"AccessToken",type:"password",value:S[f].tokenValue,onChange:e=>{rt({key:"tokenValue",value:e.target.value,spaceId:f})},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABCi7h",inputElementAttributes:{minLength:4}})]})})})]})]})]}),(0,m.jsxs)("div",{style:{flexGrow:0,flexShrink:0},children:[(0,m.jsx)(Ue.Z,{size:24}),(0,m.jsx)(He.Z,{isLarge:!0,onClick:async()=>{const e=S[f].instanceValue??"Cloud",n=S[f].confluenceAuthenticationTypeValue??"OAuth2.0";await dt({environment:t,userEmail:S[f].emailValue,site:"/"===S[f].siteValue[S[f].siteValue.length-1]?S[f].siteValue.slice(0,-1):S[f].siteValue,access_token:"Server"===e&&"Basic"===n?void 0:S[f].tokenValue,instance:S[f].instanceValue??"Cloud",username:"Basic"===n?S[f].usernameValue:void 0,password:"Basic"===n?S[f].passwordValue:void 0,spaceId:f,flowId:h,requestStore:y}),g()},children:(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,m.jsx)(qe.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{g()},children:(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}const ut=(0,x.injectIntl)((function(e){var t,n;const s=(0,o.VK)((()=>w.getState()),[]),{spaceStore:a,flowId:l}=e,d=[{name:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi",defaultMessage:"Import via API"}),captionText:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi.message",defaultMessage:"Recommended for the best import experience"}),action:()=>{e.handleApiImportClick("confluence",l),rt({key:"open",value:!0,spaceId:a.id})}},{name:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file"}),captionText:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile.message",defaultMessage:"Best for importing partial workspace content"}),action:()=>e.handleFileUploadClick("confluence",l)}],c=(0,i.O7)(),{device:u}=c,{confluenceResult:p,onComplete:g,intl:f,requestStore:y,spaceViewStore:S}=e,{account:b}=p,M={spacesResult:void 0,showLoader:!1},{showLoader:j}=s[a.id]||M;function C(e,t){v.qy(c,{import_source:"confluence",data:{spaceKey:e,spaceName:t},flowId:l})}function k(e){return(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{style:{fontSize:"12px",color:"rgba(55, 53, 47, 0.65)",paddingLeft:"12px"},children:(0,m.jsx)(x.FormattedMessage,{id:"confluenceImportOption.search.title",defaultMessage:"Select a space to import"})}),(0,m.jsx)(st,{searchInputPlaceholder:f.formatMessage({id:"confluenceImportOption.search.placeholder",defaultMessage:"Search for a Space"}),noSearchResultsPlaceholder:f.formatMessage({id:"confluenceImportOption.search.noResultsPlaceholder",defaultMessage:"No Spaces"}),sections:[e],onComplete:async e=>{await async function(e){const{environment:t,onComplete:n,selectedSpace:s,spaceStore:i,spaceViewStore:o,flowId:a}=e,r=await P.A1({environment:t,spaceStore:i,spaceViewStore:o,space:s,flowId:a||h.Il()});n(r)}({environment:c,onComplete:g,selectedSpace:e,spaceStore:a,spaceViewStore:S,flowId:l})},handleClickImportConfluenceWorkspace:C})]})}const I={title:"Confluence",logo:r.Z.images.import.confluencePng,caption:b,actionButton:b&&j?(0,m.jsx)(ge.Z,{}):b&&e.renderItemActionsButton([{name:f.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file"}),action:()=>e.handleFileUploadClick("confluence",l)},{name:f.formatMessage({id:"confluenceImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another instance"}),action:()=>{e.handleApiImportClick("confluence",l),rt({key:"open",value:!0,spaceId:a.id})}},{name:f.formatMessage({id:"confluenceImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e){const{environment:t,spaceId:n,requestStore:s}=e;w.setState({...w.state,[n]:{...w.state[n],showLoader:!1}}),await Ee.DP(t,s,n)}({environment:c,spaceId:a.id,requestStore:y})}]),onClick:()=>{}},Z=(null===(t=s[a.id])||void 0===t||null===(t=t.spacesResult)||void 0===t?void 0:t.spaces)||[],F={key:"default",name:f.formatMessage({id:"confluenceImportOption.spacesProperty.defaultName",defaultMessage:"Spaces"}),items:Z.map((e=>({id:e.id,key:e.key,name:e.name})))},_={key:"section",render:e=>(0,m.jsx)(xe.Z,{...e}),items:d.map((e=>{let{name:t,captionText:n,action:s}=e;const i={key:t,render:e=>(0,m.jsx)(ce.Z,{...e,title:t,caption:n,captionStyle:n?at:void 0}),action:s};return i}))};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(ue.ZP,{popupType:u.isMobile?ue.Z4.SlideUp:ue.Z4.Popup,onClick:()=>{b&&T({environment:c,requestStore:y,spaceId:a.id}).catch((()=>{}))},buttonPopupStore:J.Z,render:e=>b?function(e){return j?(0,m.jsx)(m.Fragment,{}):k(e)}(F):(0,m.jsx)(fe.Z,{menuType:z.og.Popup,width:200,children:(0,m.jsx)(he.Z,{onAccept:e.close,type:he.i.Vertical,initialFocus:void 0,sections:[_]})}),renderOrigin:e=>{let{onClick:t}=e;return(0,m.jsx)(Te,{...I,onClick:t})}}),(0,m.jsx)(ze.Z,{open:null===(n=s[a.id])||void 0===n?void 0:n.open,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{rt({key:"open",value:!1,spaceId:a.id})},render:()=>(0,m.jsx)(ct,{hidePopup:()=>{rt({key:"open",value:!1,spaceId:a.id})},environment:c,title:(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:(0,m.jsxs)(nt.gq,{style:{alignItems:"center",gap:2},children:[(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.emailMessage",defaultMessage:"Email"}),(0,m.jsx)(Se.Z,{placement:Y.u.Right,renderTooltip:()=>(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.emailHelpText",defaultMessage:"Email address of the Confluence user importing the data"}),render:e=>(0,m.jsx)(me.Z,{ariaLabel:"Email help text button",disableBackground:!0,icon:Ve.D,...e})})]}),accountType:(0,m.jsxs)(nt.gq,{style:{alignItems:"center",gap:2},children:[(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.instanceMessage",defaultMessage:"Confluence instance"}),(0,m.jsx)(Se.Z,{style:{width:300,whiteSpace:"normal"},placement:Y.u.Right,renderTooltip:()=>(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.instanceHelperText",defaultMessage:"On Confluence, click 'Help', the (?) next to your profile, then click on 'About Confluence' this will tell you if it is a Server, Cloud or Data Center"}),render:e=>(0,m.jsx)(me.Z,{ariaLabel:"Confluence instance type help text button",disableBackground:!0,icon:Ve.D,...e})})]}),site:(0,m.jsxs)(nt.gq,{style:{alignItems:"center",gap:2},children:[(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.siteMessage",defaultMessage:"Site"}),(0,m.jsx)(Se.Z,{style:{width:300,whiteSpace:"normal"},placement:Y.u.Right,renderTooltip:()=>(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.siteHelperText",defaultMessage:"The base URL that is used to access Confluence. If you are running on a non-standard port, please provide the input in host:port format"}),render:e=>(0,m.jsx)(me.Z,{ariaLabel:"Confluence site help text button",disableBackground:!0,icon:Ve.D,...e})})]}),APIToken:(0,m.jsxs)(nt.gq,{style:{alignItems:"center",gap:2},children:[(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,m.jsx)(Se.Z,{placement:Y.u.Right,renderTooltip:()=>(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluenceAccessToken.captions",defaultMessage:"Click to learn how to get access token from Confluence cloud"}),render:e=>(0,m.jsx)(me.Z,{ariaLabel:"Confluence access token help text button",onClick:()=>{window.open("https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account","_blank")},icon:Ve.D,...e})})]}),personalAccessToken:(0,m.jsxs)(nt.gq,{style:{alignItems:"center",gap:2},children:[(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.personalAccessTokenMessage",defaultMessage:"Personal Access Token"}),(0,m.jsx)(Se.Z,{placement:Y.u.Right,style:{width:300,whiteSpace:"normal"},renderTooltip:()=>(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluencePAT.caption",defaultMessage:"Click to learn how to get personal authentication token from Confluence server"}),render:e=>(0,m.jsx)(me.Z,{ariaLabel:"Confluence personal access token help text button",onClick:()=>{window.open("https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.html","_blank")},icon:Ve.D,...e})})]}),confluenceVersion:(0,m.jsxs)(nt.gq,{style:{alignItems:"center",gap:2},children:[(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.confluenceVersion",defaultMessage:"Confluence version"}),(0,m.jsx)(Se.Z,{style:{width:300,whiteSpace:"normal"},placement:Y.u.Right,renderTooltip:()=>(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluenceVersion.captions",defaultMessage:"Click to learn how to know the version of Confluence you are running"}),render:e=>(0,m.jsx)(me.Z,{ariaLabel:"Confluence version help text button",onClick:()=>{window.open("https://confluence.atlassian.com/confkb/how-do-i-know-what-version-of-confluence-is-running-179441565.html","_blank")},icon:Ve.D,...e})})]}),username:(0,m.jsxs)(nt.gq,{style:{alignItems:"center",gap:2},children:[(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.username",defaultMessage:"Username"}),(0,m.jsx)(Se.Z,{placement:Y.u.Right,renderTooltip:()=>(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.usernameHelpText",defaultMessage:"Username of the Confluence user importing the data"}),render:e=>(0,m.jsx)(me.Z,{ariaLabel:"Confluence user's username help text button",disableBackground:!0,icon:Ve.D,...e})})]}),password:(0,m.jsxs)(nt.gq,{style:{alignItems:"center",gap:2},children:[(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.password",defaultMessage:"Password"}),(0,m.jsx)(Se.Z,{placement:Y.u.Right,renderTooltip:()=>(0,m.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.passwordHelpText",defaultMessage:"Password of the Confluence user importing the data"}),render:e=>(0,m.jsx)(me.Z,{ariaLabel:"Confluence user's password help text button",disableBackground:!0,icon:Ve.D,...e})})]}),spaceId:a.id,flowId:l,requestStore:y})})]})}));var mt=n(559054),pt=n(23867),gt=n(653965),ft=n(412714),ht=n(753833),yt=(n(757658),n(260458)),xt=n(828992),St=n(462385);const vt=function(e){const{style:t}=(0,a.yK)((t=>({style:{display:"inline-block",textAlign:"center",color:e.disabled?t.lightTextColor:t.mediumTextColor,userSelect:"none",WebkitUserSelect:"none",width:8}})),[e]);return(0,m.jsx)("div",{style:t,children:"·"})};const bt=function(e){let{analyticsName:t,sections:n,searchInputPlaceholder:s,onComplete:i,noSearchResultsPlaceholder:a}=e;const r=(0,o.qz)(void 0,Xe);return(0,Ye.Z)((()=>{const e=r.state.selection,[t]=n;if(t){const[n]=t.items;n&&e.add(n.key)}r.emit()})),(0,m.jsx)(fe.Z,{menuType:z.og.Popup,header:(0,m.jsx)(Mt,{analyticsName:t,sections:n,searchInputPlaceholder:s,store:r}),footer:(0,m.jsx)(jt,{sections:n,onComplete:i,store:r}),width:280,maxHeight:350,children:(0,m.jsx)(Ct,{sections:n,noSearchResultsPlaceholder:a,analyticsName:t,store:r})})};function Mt(e){let{analyticsName:t,sections:n,searchInputPlaceholder:a,store:r}=e;const l=(0,i.O7)(),d=(0,s.useCallback)((()=>function(e,t,n){const{selection:s}=n.state;s.clear(),n.emit(),v.FI(e,{integration_name:t})}(l,t,r)),[l,t,r]),c=(0,s.useCallback)((()=>function(e,t,n,s){const{selection:i}=s.state;for(const o of t)for(const e of o.items)i.add(e.key);s.emit(),v.Vf(e,{integration_name:n})}(l,n,t,r)),[l,n,t,r]),u=(0,o.VK)((()=>r.state.searchQuery),[r]),p=Boolean(u);return(0,m.jsxs)(xe.Z,{isInput:!0,desktopStyle:{paddingBottom:2},children:[(0,m.jsx)(et.ZP,{focus:!0,focusAfterAnimation:!0,value:u,onChange:e=>{r.setState({...r.state,searchQuery:e.target.value})},placeholder:a}),(0,m.jsx)(xt.Z,{isTokenTitle:!0,style:{marginTop:2},title:(0,m.jsxs)("div",{style:{marginLeft:-3},children:[(0,m.jsx)(St.Z,{onClick:c,disabled:p,disabledFeedback:!0,children:(0,m.jsx)(x.FormattedMessage,{id:"importPopup.selectAll",defaultMessage:"Select all"})}),(0,m.jsx)(vt,{disabled:p}),(0,m.jsx)(St.Z,{onClick:d,disabled:p,disabledFeedback:!0,children:(0,m.jsx)(x.FormattedMessage,{id:"importPopup.deselectAll",defaultMessage:"Deselect all"})})]})})]})}function jt(e){let{sections:t,onComplete:n,store:i}=e;const a=(0,s.useCallback)((()=>function(e,t,n){const{selection:s}=n.state,i=gt.xH(e.map((e=>e.items))),o=[];s.forEach((e=>{const t=i.find((t=>t.key===e));t&&o.push(t)})),t(o)}(t,n,i)),[t,n,i]),r=0===(0,o.VK)((()=>i.state.selection.size),[i]);return(0,m.jsx)(xe.Z,{topBorder:!0,desktopStyle:{paddingTop:8,paddingBottom:8},children:(0,m.jsx)(xt.Z,{title:(0,m.jsx)(He.Z,{disabled:r,onClick:a,children:(0,m.jsx)(x.FormattedMessage,{id:"integrationImportPopup.importButton.label",defaultMessage:"Import"})})})})}function Ct(e){let{sections:t,noSearchResultsPlaceholder:n,analyticsName:s,store:a}=e;const r=(0,i.O7)(),{searchQuery:l,selection:d}=(0,o.VK)((()=>{const{searchQuery:e,selection:t}=a.state;return{searchQuery:e,selection:t}}),[a]),c=t.map((e=>{const t=(0,Qe.ZP)(l,e.items,(t=>`${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===c.length)return(0,m.jsx)(xe.Z,{children:(0,m.jsx)(tt.Z,{title:n})});const u=c.map((e=>({key:e.name,render:n=>(0,m.jsx)(xe.Z,{...n,title:t.length>1?e.name:void 0}),items:e.items.map((e=>{const t=()=>function(e,t,n,s){const{selection:i}=s.state;i.has(e.key)?(i.delete(e.key),v.Z3(t,{integration_name:n})):(i.add(e.key),v.Gl(t,{integration_name:n})),s.emit()}(e,r,s,a);return{key:e.key,render:n=>(0,m.jsx)(Ne.Z,{...n,title:e.name,icon:(0,m.jsx)(yt.Z,{checked:d.has(e.key),size:16,onClick:t}),right:void 0!==e.count&&(0,m.jsx)(ve.Z,{isSmall:!0,children:e.count})}),action:t}}))})));return(0,m.jsx)(he.Z,{type:he.i.Vertical,initialFocus:void 0,sections:u})}const wt=function(e){let{requestStore:t,analyticsFrom:n,evernoteResult:a,renderItemActionsButton:l,defaultActionButton:d,spaceStore:c,spaceViewStore:u,userSettingsStore:p,onComplete:g}=e;const f=(0,i.O7)(),h=(0,x.useIntl)(),y=(0,o.VK)((()=>ht.Z.getState()),[]),S=(0,s.useCallback)((()=>async function(e,t,n,s){var i;const{isFetchingNotebooks:o}=s;o&&await Z.B({environment:e,requestStore:t});const a=ee.Z.getOrCreateFlowId();v.ay(e,{import_source:"evernote",from:n,flowId:a,userId:e.currentUser.id,spaceId:null===(i=re.default.state.currentSpaceStore)||void 0===i?void 0:i.id})}(f,t,n,y)),[f,t,n,y]),{device:b}=f,{userInfo:M}=a,{notebooksResponse:j,showLoader:C}=y,w=(null==j?void 0:j.notebooks)||[],T=gt.vM(w,(e=>e.stack||""));(0,mt.r5)((async()=>{y.linkingAccount||(await t.refresh(),I.x())}),[y.linkingAccount,t]);const F=Object.keys(T).map((e=>{const t=e||"Top-Level";return{key:t,name:t,items:(T[e]||[]).map((e=>({key:e.guid,name:e.title,count:e.noteCount})))}})),_={title:"Evernote",logo:r.Z.images.import.evernotePng,shouldWrapCaption:!M,caption:M?M.name||M.username||M.email:void 0,actionButton:M&&C?(0,m.jsx)(ge.Z,{}):M?l([{name:h.formatMessage({id:"evernoteImportOption.actionsMenu.learnMore",defaultMessage:"Learn more"}),action:()=>function(e){ft.D({environment:e,url:(0,H.UY)("guides.importEvernote")})}(f)},{name:h.formatMessage({id:"evernoteImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>X.Z.setState({open:!0})},{name:h.formatMessage({id:"evernoteImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>kt(t,f)},{name:h.formatMessage({id:"evernoteImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e,t){await k.disconnectEvernote(t,{}),ht.Z.setState({notebooksResponse:{notebooks:[]},isFetchingNotebooks:!0,showLoader:!1}),await e.refresh(),v.qJ(t,{integration_name:"evernote"})}(t,f)}]):d,onClick:()=>{}};return(0,m.jsx)(ue.ZP,{popupType:b.isMobile?ue.Z4.SlideUp:ue.Z4.Popup,buttonPopupStore:X.Z,onClick:S,render:()=>C?(0,m.jsx)(m.Fragment,{}):(0,m.jsx)(bt,{searchInputPlaceholder:h.formatMessage({id:"evernoteImportOption.search.placeholder",defaultMessage:"Search for a notebook…"}),noSearchResultsPlaceholder:h.formatMessage({id:"evernoteImportOption.search.noResultsPlaceholder",defaultMessage:"No notebooks"}),analyticsName:"evernote",sections:F,onComplete:e=>async function(e,t,n,s,i,o,a){const{notebooks:r}=e,l=r.filter((e=>Boolean(t.find((t=>t.key===e.guid)))));v.G7(a,{integration_name:"evernote",count:t.length});const d=await P.am({environment:a,spaceStore:n,spaceViewStore:s,userSettingsStore:i,notebooks:l});v.qy(a,{import_source:"evernote",data:{notebooks:l.map((e=>e.guid)),userId:a.currentUser.id,spaceId:(0,pt.C)(n.id)},flowId:ee.Z.getOrCreateFlowId()}),o(d)}(j,e,c,u,p,g,f)}),renderOrigin:e=>{let{onClick:n}=e;return(0,m.jsx)(Te,{..._,onClick:M?n:()=>kt(t,f)})}})};async function kt(e,t){await Z.e({environment:t,requestStore:e})}var It=n(191584),Tt=n(689813);const Zt=new le.Z;const Pt=function(e){let{requestStore:t,renderItemActionsButton:n,spaceStore:a,spaceViewStore:l,pageStore:d,analyticsFrom:c,onComplete:u}=e;const p=(0,i.O7)(),g=(0,x.useIntl)(),{loading:f,areAccountsFetched:h,accountsResponse:y,selectedFileId:S}=(0,o.VK)((()=>{const{loading:e,areAccountsFetched:t,accountsResponse:n,selectedFileId:s}=L.Z.state;return{loading:e,areAccountsFetched:t,accountsResponse:n,selectedFileId:s}}),[]),b=(0,o.VK)((()=>Zt.state.open),[]),{device:M}=p,j=y.accounts,C=(0,s.useCallback)((async()=>{await _t({environment:p,requestStore:t,areAccountsFetched:h,analyticsFrom:c,googleDriveResponse:y,pageStore:d,spaceStore:a,spaceViewStore:l,onComplete:u,selectedFileId:S})}),[p,t,h,c,d,u,l,a,y,S]),w={title:"Google Docs",logo:r.Z.images.import.googleDocsPng,showNewBadge:!0,actionButton:j&&j.length>0&&n([{name:g.formatMessage({id:"googleDocImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>async function(e){const{requestStore:t,spaceStore:n,spaceViewStore:s,environment:i,analyticsFrom:o,pageStore:a,onComplete:r}=e,l=await It.qN(i);l?(v.a1(i,{import_source:"gDocs",data:{import_type:"api",status:"success"}}),await t.refresh(),ie.Z.setState({...ie.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}),await _t({environment:i,requestStore:t,areAccountsFetched:!1,analyticsFrom:o,googleDriveResponse:void 0,spaceStore:n,spaceViewStore:s,onComplete:r,pageStore:a})):v.a1(i,{import_source:"gDocs",data:{import_type:"api",status:"failure"}})}({environment:p,requestStore:t,analyticsFrom:c,pageStore:d,spaceStore:a,spaceViewStore:l,onComplete:u})},{name:g.formatMessage({id:"googleDocImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove All Accounts"}),action:()=>async function(e,t,n){if(!n||0===n.length)return;n.forEach((async e=>{await k.disconnectDrive(t,{googleUserId:e.accountId})})),L.Z.setState({...L.Z.state,accountsResponse:{accounts:[]},loading:!1}),await e.refresh()}(t,p,j)}]),onClick:()=>{}},I={type:"drive",title:(0,m.jsx)(x.FormattedMessage,{defaultMessage:"Browse Google Drive",id:"googleDriveBlock.mediaPicker.googleDriveTab.title"}),onSelect:async e=>await Ft({account:e,onComplete:u,requestStore:t,spaceStore:a,spaceViewStore:l,analyticsFrom:c,pageStore:d,environment:p,selectedFileId:S})};return(0,m.jsx)(ue.ZP,{open:b,popupType:M.isMobile?ue.Z4.SlideUp:ue.Z4.Popup,buttonPopupStore:Zt,onClick:C,onClose:()=>{L.Z.setState({...L.Z.state,selectedFileId:void 0})},render:()=>f?(0,m.jsx)(m.Fragment,{}):(0,m.jsx)(Tt.v3,{tab:I,accounts:j,type:Tt.s5.Docs}),renderOrigin:e=>{let{onClick:t}=e;return(0,m.jsx)(Te,{...w,onClick:t})}})};async function Ft(e){const{account:t,requestStore:n,spaceStore:s,spaceViewStore:i,environment:o,analyticsFrom:a,pageStore:r,onComplete:l,selectedFileId:d}=e;t&&t.token||await async function(e){const{requestStore:t,spaceStore:n,spaceViewStore:s,environment:i,analyticsFrom:o,pageStore:a,onComplete:r,selectedFileId:l}=e;await It.qN(i),await t.refresh(),await _t({environment:i,requestStore:t,areAccountsFetched:!1,analyticsFrom:o,googleDriveResponse:void 0,spaceStore:n,spaceViewStore:s,onComplete:r,pageStore:a,selectedFileId:l})}({environment:o,requestStore:n,analyticsFrom:a,spaceStore:s,spaceViewStore:i,onComplete:l,pageStore:r,selectedFileId:d}),t&&t.token&&(d?await At({fileId:d,token:t.token,environment:o,spaceStore:s,spaceViewStore:i,analyticsFrom:a,onComplete:l,pageStore:r}):await(0,D.vE)({environment:o,accessToken:t.token.accessToken,viewType:"documents",from:"import_google_doc",callback:async e=>{await At({fileId:e,token:t.token,environment:o,spaceStore:s,spaceViewStore:i,analyticsFrom:a,onComplete:l,pageStore:r})}}),Zt.setState({...Zt.state,open:!1}))}async function _t(e){var t;const{requestStore:n,spaceStore:s,spaceViewStore:i,environment:o,analyticsFrom:a,pageStore:r,onComplete:l,googleDriveResponse:d,areAccountsFetched:c,selectedFileId:u}=e;let m=d;c||(L.Z.setState({...L.Z.state,loading:!0}),m=await It.vQ(o),m&&m.accounts&&L.Z.setState({...L.Z.state,accountsResponse:m,areAccountsFetched:!0,loading:!1})),v.ay(o,{import_source:"gdocs",from:a,userId:o.currentUser.id,spaceId:null===(t=re.default.state.currentSpaceStore)||void 0===t?void 0:t.id});const p=m&&1===m.accounts.length?m.accounts[0]:void 0;return p?await Ft({account:p,onComplete:l,requestStore:n,spaceStore:s,spaceViewStore:i,analyticsFrom:a,pageStore:r,environment:o,selectedFileId:u}):(Zt.setState({...Zt.state,open:!0}),await n.refresh()),m}async function At(e){const{fileId:t,token:n,environment:s,spaceStore:i,spaceViewStore:o,analyticsFrom:a,onComplete:r,pageStore:l}=e;l&&(L.Z.setState({...L.Z.state,loading:!0}),await P.xG({environment:s,fileId:t,token:n,spaceStore:i,spaceViewStore:o,pageStore:l,analyticsFrom:a}).then((e=>{e&&(S.W(s,{from:"import",type:"page",new_page_id:e.id,creating_block_id:e.id,parent_collection_id:e.getParentCollectionIdUpToTwoLevels()}),r(e))})).catch((()=>{})),L.Z.setState({...L.Z.state,loading:!1,selectedFileId:void 0}))}const Bt=function(e){var t;const n=(0,i.O7)(),{device:s}=n,{jiraResult:a,flowId:l,spaceStore:d,requestStore:c}=e,u=null==a||null===(t=a.account)||void 0===t?void 0:t[0],p=(0,x.useIntl)(),g=(0,o.VK)((()=>(0,$.lQ)(d)),[d]),f=[{name:p.formatMessage({id:"jiraImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another instance"}),action:()=>{ne.Z.setState({...ne.Z.state,open:!0,type:"auth",flowId:l||h.Il()})}}];u&&f.push({name:p.formatMessage({id:"jiraImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e){const{environment:t,spaceId:n,requestStore:s,accountId:i}=e;await Ee.M(t,s,n,i)}({environment:n,spaceId:d.id,requestStore:c,accountId:null==u?void 0:u.id})});const y={title:"Jira",logo:r.Z.images.externalIntegrations.jiraIconPng,onClick:()=>{},caption:null==u?void 0:u.site,actionButton:g&&u?e.renderItemActionsButton(f):null};return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(ue.ZP,{renderOrigin:e=>{let{onClick:t}=e;return(0,m.jsx)(Te,{...y,onClick:()=>{if(v.ay(n,{import_source:"jira",from:"settings_modal",import_type:"api",userId:n.currentUser.id,spaceId:d.id,flowId:l}),g||u){if(ne.Z.setState({...ne.Z.state,open:!0,type:u?"teamspace-selection":"auth",flowId:l||h.Il(),site:null==u?void 0:u.site,spaceId:d.id,botId:null==u?void 0:u.id}),u){const e=ie.Z.getInitialState();ie.Z.setState(e)}}else M.showErrorMessage((0,m.jsx)(x.FormattedMessage,{id:"jiraImportOption.errorMessages.onlyAdminCanConnect",defaultMessage:"Only workspace owners can connect this integration"}))}})},popupType:s.isMobile?ue.Z4.SlideUp:ue.Z4.Popup,render:()=>(0,m.jsx)(m.Fragment,{})})})},Rt={whiteSpace:"pre-wrap"};function Dt(e){const t=(0,o.VK)((()=>V.Z.state),[]),{environment:n,spaceStore:s,flowId:i}=e;return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(ze.Z,{open:t.showAuthPopup,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{V.Z.setState({...V.Z.state,showAuthPopup:!1})},render:()=>(0,m.jsx)(Ot,{hidePopup:()=>{V.Z.setState({...V.Z.state,showAuthPopup:!1})},environment:n,title:(0,m.jsx)(x.FormattedMessage,{id:"mondayAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:(0,m.jsxs)(nt.gq,{style:{alignItems:"center",gap:2},children:[(0,m.jsx)(x.FormattedMessage,{id:"mondayAuthentication.emailMessage",defaultMessage:"Email"}),(0,m.jsx)(Se.Z,{placement:Y.u.Right,renderTooltip:()=>(0,m.jsx)(x.FormattedMessage,{id:"mondayAuthentication.emailHelpText",defaultMessage:"Email address of the Monday.com user importing the data"}),render:e=>(0,m.jsx)(me.Z,{...e,ariaLabel:"Email help text button",disableBackground:!0,icon:Ve.D})})]}),APIToken:(0,m.jsxs)(nt.gq,{style:{alignItems:"center",gap:2},children:[(0,m.jsx)(x.FormattedMessage,{id:"mondayAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,m.jsx)(Se.Z,{placement:Y.u.Right,renderTooltip:()=>(0,m.jsx)(x.FormattedMessage,{id:"mondayAuthentication.stepsToGetMondayAPIToken.captions",defaultMessage:"Click to learn how to get API token from Monday.com"}),render:e=>(0,m.jsx)(me.Z,{...e,ariaLabel:"Monday.com API token help text button",onClick:()=>{window.open("https://developer.monday.com/api-reference/docs/authentication#accessing-api-tokens","_blank")},icon:Ve.D})})]}),flowId:i,spaceStore:s})})})}function Ot(e){let{environment:t,title:n,email:s,APIToken:i,hidePopup:r,flowId:l,spaceStore:d}=e;const c=(0,o.VK)((()=>V.Z.state),[]),u=(0,a.yK)((e=>({title:{fontWeight:be.Z.fontWeight.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"},helpText:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor}})),[]);return(0,m.jsx)(Ke.Z,{debugName:"MondayImportOption",capture:!0,children:(0,m.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"},children:[(0,m.jsxs)("div",{style:{overflowY:"scroll"},children:[(0,m.jsxs)("div",{style:{marginBottom:24},children:[(0,m.jsx)("div",{style:u.title,children:n}),(0,m.jsx)($e.Z,{title:(0,m.jsx)(x.FormattedMessage,{id:"mondayAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Monday.com"}),href:"https://www.notion.so/help/monday",analyticsFrom:"import",style:{marginTop:8}})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"email",style:{...u.inputLabels},children:s}),(0,m.jsx)(We.Z,{id:"email",value:c.email,autoComplete:"off",autoCapitalize:"off",onChange:e=>{V.Z.setState({...V.Z.state,email:e.target.value})},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),(0,m.jsx)(Ue.Z,{size:12,isHidden:!0}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"APIToken",style:{...u.inputLabels},children:i}),(0,m.jsx)(We.Z,{id:"AccessToken",type:"password",value:c.APIToken,onChange:e=>{V.Z.setState({...V.Z.state,APIToken:e.target.value})},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})]})]})]}),(0,m.jsxs)("div",{style:{flexGrow:0,flexShrink:0},children:[(0,m.jsx)(Ue.Z,{size:24}),(0,m.jsx)(He.Z,{isLarge:!0,onClick:async()=>{await F.qF({environment:t,userEmail:c.email,APIToken:c.APIToken,flowId:l,spaceId:d.id}),r()},children:(0,m.jsx)(x.FormattedMessage,{id:"mondayAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,m.jsx)(qe.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{r()},children:(0,m.jsx)(x.FormattedMessage,{id:"mondayAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}const Lt=function(e){const t=(0,o.VK)((()=>V.Z.state),[]),n=(0,o.VK)((()=>ee.Z.state),[]),{account:a,isLoadingMondayWorkspaces:d}=t,{spaceStore:c}=e,u=(0,i.O7)(),p=(0,x.useIntl)(),{device:g}=u,f=n.flowId||h.Il();(0,s.useEffect)((()=>{n.flowId||ee.Z.setState({flowId:f})}),[f,n]);const y={title:p.formatMessage({id:"mondayImportOption.mondayButton.title",defaultMessage:"Monday.com"}),logo:r.Z.images.import.mondayPng,caption:a,actionButton:a?(S=[{name:p.formatMessage({id:"mondayImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>{V.Z.setState({...V.Z.state,showAuthPopup:!0})}},{name:p.formatMessage({id:"mondayImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>F.sC({environment:u,spaceId:c.id})}],(0,m.jsx)(ue.ZP,{popupType:ye.kQ.Popup,renderOrigin:e=>d?(0,m.jsx)(ge.Z,{}):(0,m.jsx)(me.Z,{ariaLabel:p.formatMessage({id:"mondayImportOption.mondayButton.ariaLabel",defaultMessage:"Import from Monday.com button"}),icon:l.o,...e}),render:e=>{const t=S.map((t=>{let{name:n,captionText:s,action:i}=t;const o={key:n,render:e=>(0,m.jsx)(ce.Z,{...e,title:n,caption:s,captionStyle:s?Rt:void 0}),action:()=>{i(),e.close()}};return o})),n={key:"section",render:e=>(0,m.jsx)(xe.Z,{...e}),items:t};return(0,m.jsx)(fe.Z,{menuType:z.og.Popup,width:200,children:(0,m.jsx)(he.Z,{type:he.i.Vertical,initialFocus:void 0,sections:[n]})})}})):void 0,onClick:()=>{}};var S;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(ue.ZP,{onClick:async()=>{V.Z.resetImport(),a?(v.ay(u,{import_source:"monday.com",from:e.analyticsFrom,userId:u.currentUser.id,spaceId:c.id,flowId:f}),await F.FM({environment:u,spaceId:c.id}),F.h7()):V.Z.setState({...V.Z.state,showAuthPopup:!0})},popupType:g.isMobile?ue.Z4.SlideUp:ue.Z4.Popup,buttonPopupStore:de,renderOrigin:e=>{let{onClick:t}=e;return(0,m.jsx)(Te,{...y,onClick:t})},render:()=>null}),(0,m.jsx)(Dt,{environment:u,spaceStore:c,flowId:f})]})};const Vt=function(e){let{requestStore:t,analyticsFrom:n,trelloResult:a,renderItemActionsButton:l,spaceStore:d,spaceViewStore:c,onComplete:u}=e;const p=(0,i.O7)(),g=(0,x.useIntl)(),{boardsResponse:f,showLoader:h,isFetchingBoards:y}=(0,o.VK)((()=>{const{boardsResponse:e,showLoader:t,isFetchingBoards:n}=oe.Z.state;return{boardsResponse:e,showLoader:t,isFetchingBoards:n}}),[]),S=(0,s.useCallback)((()=>async function(e,t,n,s){s&&await _.u(e,t);v.ay(e,{import_source:"trello",from:n})}(p,t,n,y)),[p,t,n,y]),{device:b}=p,{account:M}=a,j=f.boards,C={key:"default",name:g.formatMessage({id:"trelloImportOption.boardProperty.defaultName",defaultMessage:"Boards"}),items:j.map((e=>({key:e.id,name:e.name})))},w={title:"Trello",logo:r.Z.images.import.trelloPng,actionButton:M&&h?(0,m.jsx)(ge.Z,{}):M&&l([{name:g.formatMessage({id:"trelloImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>te.Z.setState({open:!0})},{name:g.formatMessage({id:"trelloImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>Et(t,p)},{name:g.formatMessage({id:"trelloImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e,t){await k.disconnectTrello(t,{}),oe.Z.setState({boardsResponse:{boards:[]},isFetchingBoards:!0,showLoader:!1}),await e.refresh(),v.qJ(t,{integration_name:"trello"})}(t,p)}]),onClick:()=>{}};return(0,m.jsx)(ue.ZP,{popupType:b.isMobile?ue.Z4.SlideUp:ue.Z4.Popup,buttonPopupStore:te.Z,onClick:S,render:()=>h?(0,m.jsx)(m.Fragment,{}):(0,m.jsx)(bt,{searchInputPlaceholder:g.formatMessage({id:"trelloImportOption.search.placeholder",defaultMessage:"Search for a board…"}),noSearchResultsPlaceholder:g.formatMessage({id:"trelloImportOption.search.noResultsPlaceholder",defaultMessage:"No boards found."}),analyticsName:"trello",sections:[C],onComplete:e=>async function(e,t,n,s,i,o){const{boards:a}=e,r=a.filter((e=>Boolean(t.find((t=>t.key===e.id)))));v.G7(o,{integration_name:"trello",count:t.length});const l=await P.su({environment:o,spaceStore:n,spaceViewStore:s,boards:r});i(l)}(f,e,d,c,u,p)}),renderOrigin:e=>{let{onClick:n}=e;return(0,m.jsx)(Te,{...w,onClick:M?n:()=>Et(t,p)})}})};async function Et(e,t){await _.M({environment:t,requestStore:e})}const Nt={display:"flex",alignItems:"center",justifyContent:"center",width:752,minHeight:240};const Ut=function(e){let{analyticsFrom:t,spaceStore:n,onComplete:s,spaceViewStore:r,userSettingsStore:l,pageStore:d}=e;const c=(0,i.O7)(),u=(0,a.Fg)(),p=(0,o.qz)(void 0,se.Z),g=(0,o.qz)(void 0,se.Z),f=(0,o.qz)(void 0,se.Z),M=(0,o.qz)(void 0,se.Z),j=(0,o.qz)(void 0,se.Z),C=(0,o.qz)(void 0,se.Z),k=(0,o.qz)(void 0,se.Z),I=(0,o.VK)((()=>Q.Z.state.online),[]),A=(0,o.VK)((()=>ie.Z.getState()),[]),B=(0,o.VK)((()=>zt()),[]);return I?(0,m.jsx)($t,{spaceStore:n,trelloRequestStore:C,asanaRequestStore:j,evernoteRequestStore:M,confluenceRequestStore:f,mondayRequestStore:g,jiraRequestStore:p,googleDocRequestStore:k,renderChildren:e=>{if(e){const{defaultSubtab:i}=A;return function(e){let{defaultSubtab:t,environment:n,pageStore:s,spaceStore:i,spaceViewStore:o,trelloRequestStore:a,evernoteRequestStore:r,confluenceRequestStore:l,googleDocRequestStore:d,result:c,onComplete:u,analyticsFrom:m,flowId:p}=e;if(!t)return;if(!y.UP.includes(t)||"gdocs"===t&&c.googleDocResult.isGoogleDocImporterEnabled)switch(t){case"trello":!function(e,t,n){const s=n.account;s?_.u(e,t).then((()=>{te.Z.setState({open:!0})})).catch((()=>{oe.Z.setState({...oe.Z.state,isFetchingBoards:!1,showLoader:!1})})):_.M({environment:e,requestStore:t}).then((()=>{})).catch((()=>{}))}(n,a,c.trelloResult);break;case"evernote":!function(e,t,n){const{userInfo:s}=n;s?Z.B({environment:e,requestStore:t}).then((()=>{X.Z.setState({open:!0})})).catch((()=>{})):Z.e({environment:e,requestStore:t}).then((()=>{})).catch((()=>{}))}(n,r,c.evernoteResult);break;case"monday":!function(e,t,n){t.user?F.FM({environment:e,spaceId:n}).then((()=>{V.Z.setState({...V.Z.state,currentTab:"selectData",isModalOpen:!0})})).catch((()=>{})):V.Z.setState({...V.Z.state,showAuthPopup:!0})}(n,c.mondayResult,i.id);break;case"confluenceApi":!function(e,t,n,s){const{account:i}=t;ie.Z.setState({...ie.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}),i?T({environment:e,requestStore:s,spaceId:n}).then((()=>{J.Z.setState({open:!0})})).catch((()=>{w.setState({...w.state,[n]:{...w.state[n],showLoader:!1}})})):w.setState({...w.state,[n]:{...w.state[n],open:!0}})}(n,c.confluenceResult,i.id,l);break;case"asana":!function(e,t){const{account:n}=t;n?b.bA({environment:e}).then((()=>{O.Z.setState({...O.Z.state,isModalOpen:!0})})).catch((()=>{O.Z.setState({...O.Z.state,isAccountLinkingInProgress:!1,isModalOpen:!1})})):b.w1({environment:e,flowId:h.Il()}).then((()=>{})).catch((()=>{}))}(n,c.asanaResult);break;case"jira":!function(e){const{account:t}=e;if(!t)return;const n=ne.Z.getState();ne.Z.setState({...n,type:t.length?"teamspace-selection":"auth",open:!0}),ie.Z.setState(ie.Z.getInitialState())}(c.jiraResult);break;case"gdocs":!function(e){const{requestStore:t,spaceStore:n,spaceViewStore:s,environment:i,analyticsFrom:o,pageStore:a,onComplete:r,areAccountsFetched:l,googleDriveResponse:d,selectedFileId:c}=e;_t({environment:i,requestStore:t,areAccountsFetched:l,analyticsFrom:o,googleDriveResponse:d,pageStore:a,spaceStore:n,spaceViewStore:s,selectedFileId:c,onComplete:r}).then((()=>{})).catch((()=>{}))}({environment:n,requestStore:d,analyticsFrom:m,pageStore:s,onComplete:u,spaceStore:i,spaceViewStore:o,areAccountsFetched:c.googleDocResult.areAccountsFetched,googleDriveResponse:c.googleDocResult.accountsResponse,selectedFileId:c.googleDocResult.selectedFileId})}else!function(e){let{environment:t,pageStore:n,spaceStore:s,spaceViewStore:i,uploadType:o,onComplete:a}=e;if(!n)return;P.Pv({environment:t,pageStore:n,spaceStore:s,spaceViewStore:i,uploadType:o,flowId:h.Il()}).then((e=>{e&&(S.W(t,{from:"import",type:"page",new_page_id:e.id,creating_block_id:e.id,parent_collection_id:e.getParentCollectionIdUpToTwoLevels()}),a(e))})).catch((()=>{}))}({pageStore:s,spaceStore:i,spaceViewStore:o,environment:n,uploadType:t,onComplete:u});v.ay(n,{import_source:t,from:m,flowId:p,userId:n.currentUser.id,spaceId:i.id})}({defaultSubtab:i,pageStore:d,spaceStore:n,spaceViewStore:r,trelloRequestStore:C,evernoteRequestStore:M,confluenceRequestStore:f,googleDocRequestStore:k,result:e,environment:c,onComplete:s,analyticsFrom:t,flowId:B}),ie.Z.setState({...ie.Z.state,defaultSubtab:void 0}),(0,m.jsx)("div",{style:Nt,children:(0,m.jsx)(en,{analyticsFrom:t,onComplete:s,spaceStore:n,spaceViewStore:r,userSettingsStore:l,pageStore:d,trelloRequestStore:C,evernoteRequestStore:M,confluenceRequestStore:f,jiraRequestStore:p,googleDocRequestStore:k,result:e})})}return(0,m.jsx)("div",{style:"onboarding"===t?{}:Nt,children:(0,m.jsx)(ge.Z,{})})}}):(0,m.jsx)("div",{style:{...Nt,fontSize:14,color:u.mediumTextColor},children:(0,m.jsx)(x.FormattedMessage,{id:"importOptions.offlineErrorMessage",defaultMessage:"Please go online to import."})})};function Kt(e){let{url:t,helpButtonMessage:n,helpMessageWidth:s,disableBackground:i}=e;return(0,m.jsx)(Se.Z,{renderTooltip:()=>n??(0,m.jsx)(x.FormattedMessage,{id:"importOptions.helpButton.tooltip",defaultMessage:"Learn about how to import"}),style:{width:s??170},textWrap:!0,render:e=>(0,m.jsx)(pe.Z,{external:!0,href:t,style:{marginLeft:"auto"},...e,children:(0,m.jsx)(me.Z,{icon:d.m,disableBackground:i??!1})})})}function Wt(e){let{actions:t}=e;return(0,m.jsx)(ue.ZP,{popupType:ye.kQ.Popup,renderOrigin:e=>(0,m.jsx)(me.Z,{icon:l.o,...e}),render:e=>{const n={key:"section",render:e=>(0,m.jsx)(xe.Z,{...e}),items:t.map((t=>{let{name:n,action:s}=t;return{key:n,render:e=>(0,m.jsx)(Ne.Z,{...e,title:n}),action:()=>{s(),e.close()}}}))};return(0,m.jsx)(fe.Z,{menuType:z.og.Popup,width:200,children:(0,m.jsx)(he.Z,{type:he.i.Vertical,initialFocus:void 0,sections:[n]})})}})}function zt(){return ee.Z.state.flowId||h.Il()}async function qt(e,t,n,s,i,o,a,r){v.ay(o,{import_source:e,from:t,import_type:"file",flowId:r});const l=await P.Pv({environment:o,pageStore:a,spaceStore:n,spaceViewStore:s,uploadType:e,flowId:r});l&&(S.W(o,{from:"import",type:"page",new_page_id:l.id,creating_block_id:l.id,parent_collection_id:l.getParentCollectionIdUpToTwoLevels()}),i(l))}function Gt(e){let{flowId:t,analyticsFrom:n,spaceStore:s,spaceViewStore:o,onComplete:a,pageStore:l}=e;const d=(0,i.O7)();return(0,m.jsx)(Te,{title:"Confluence",logo:r.Z.images.import.confluencePng,onClick:()=>qt("confluence",n,s,o,a,d,l,t),actionButton:(0,m.jsx)(Kt,{url:(0,H.UY)("guides.importConfluence")})})}function Ht(e){let{analyticsFrom:t,spaceStore:n,spaceViewStore:s,onComplete:o,pageStore:a}=e;const r=(0,i.O7)();return(0,m.jsx)(Se.Z,{placement:Y.u.Bottom,render:e=>(0,m.jsx)(Te,{tooltipEvents:e,title:"CSV",icon:p,onClick:()=>qt("csv",t,n,s,o,r,a)}),renderTooltip:()=>(0,m.jsx)(x.FormattedMessage,{id:"importOptions.csvImport.tooltip",defaultMessage:"Ensure first row in the CSV is the header"})})}function $t(e){let{renderChildren:t,spaceStore:n,trelloRequestStore:s,asanaRequestStore:o,evernoteRequestStore:a,confluenceRequestStore:r,mondayRequestStore:l,jiraRequestStore:d,googleDocRequestStore:c}=e;const u=(0,i.O7)();return(0,m.jsx)(A.Z,{request:u,performRequest:E,requestStore:s,render:(e,s)=>(0,m.jsx)(A.Z,{request:u,performRequest:U,requestStore:o,render:(e,i)=>(0,m.jsx)(A.Z,{request:u,performRequest:K,requestStore:a,render:(e,o)=>(0,m.jsx)(A.Z,{request:u,performRequest:()=>async function(e,t){const n=await k.getConfluenceAccount(e,{spaceId:t});return"success"===n.type?n.data:(console.error(n.error),{})}(u,n.id),requestStore:r,render:(e,a)=>(0,m.jsx)(A.Z,{request:u,performRequest:()=>async function(e,t){V.Z.setState({...V.Z.state,isFetchingMondayAccount:!0});const n=await k.getMondayUser(e,{spaceId:t});var s,i;return"success"===n.type?null!==(s=n.data.user)&&void 0!==s&&s.email?(V.Z.setState({...V.Z.state,isFetchingMondayAccount:!1,account:null===(i=n.data.user)||void 0===i?void 0:i.email}),n.data):{user:void 0}:(V.Z.setState({...V.Z.state,isFetchingMondayAccount:!1}),console.error(n.error),{user:void 0})}(u,n.id),requestStore:l,render:(e,r)=>(0,m.jsx)(A.Z,{request:u,performRequest:()=>async function(e,t){const n=await k.getJiraAccount(e,{spaceId:t});return"success"===n.type?n.data:(console.error(n.error),{})}(u,n.id),requestStore:d,render:(e,n)=>(0,m.jsx)(A.Z,{request:u,performRequest:N,requestStore:c,render:(e,l)=>t(s&&i&&o&&a&&r&&n&&l?{trelloResult:s,asanaResult:i,evernoteResult:o,confluenceResult:a,mondayResult:r,jiraResult:n,googleDocResult:l}:void 0)})})})})})})})}function Yt(e){let{analyticsFrom:t,onComplete:n,spaceStore:s,spaceViewStore:i,userSettingsStore:o,googleDocRequestStore:a,pageStore:r}=e;return(0,m.jsx)(Pt,{renderItemActionsButton:e=>(0,m.jsx)(Wt,{actions:e}),onComplete:n,requestStore:a,spaceStore:s,spaceViewStore:i,userSettingsStore:o,pageStore:r,analyticsFrom:t})}function Qt(e){let{trelloResult:t,analyticsFrom:n,onComplete:s,spaceStore:i,spaceViewStore:o,userSettingsStore:a,trelloRequestStore:r}=e;return(0,m.jsx)(Vt,{trelloResult:t,analyticsFrom:n,renderItemActionsButton:e=>(0,m.jsx)(Wt,{actions:e}),onComplete:s,requestStore:r,spaceStore:i,spaceViewStore:o,userSettingsStore:a})}function Jt(e){let{confluenceResult:t,flowId:n,analyticsFrom:s,onComplete:o,spaceStore:a,spaceViewStore:r,userSettingsStore:l,pageStore:d,confluenceRequestStore:c}=e;const u=(0,i.O7)();return(0,m.jsx)(ut,{confluenceResult:t,analyticsFrom:s,flowId:n,renderItemActionsButton:e=>(0,m.jsx)(Wt,{actions:e}),onComplete:o,spaceStore:a,requestStore:c,spaceViewStore:r,userSettingsStore:l,handleFileUploadClick:(e,t)=>qt(e,s,a,r,o,u,d,t),handleApiImportClick:(e,t)=>function(e,t,n,s,i,o){T({environment:i,requestStore:t,spaceId:n.id}).catch((()=>{})),v.ay(i,{import_source:e,from:s,import_type:"api",flowId:o})}(e,c,a,s,u,t)})}function Xt(e){let{evernoteResult:t,onComplete:n,spaceStore:s,spaceViewStore:i,userSettingsStore:o,evernoteRequestStore:a}=e;return(0,m.jsx)(wt,{evernoteResult:t,analyticsFrom:"onboarding",renderItemActionsButton:e=>(0,m.jsx)(Wt,{actions:e}),defaultActionButton:(0,m.jsx)(Kt,{url:(0,H.UY)("guides.importEvernote")}),onComplete:n,requestStore:a,spaceStore:s,spaceViewStore:i,userSettingsStore:o})}function en(e){let{result:t,analyticsFrom:n,onComplete:s,spaceStore:a,spaceViewStore:l,userSettingsStore:d,pageStore:u,trelloRequestStore:p,evernoteRequestStore:h,confluenceRequestStore:y,jiraRequestStore:S,googleDocRequestStore:v}=e;const b=(0,i.O7)(),M=(0,o.VK)((()=>zt()),[]),j=(0,o.VK)((()=>(0,B.Tc)(b)),[b]),C=(0,o.VK)((()=>(0,q.d)()),[]),w=(0,o.VK)((()=>(0,R.tt)()),[]),k=(0,o.VK)((()=>(0,R.RT)()),[]),I=(0,o.VK)((()=>(0,W.K6)()),[]),T=(0,o.VK)((()=>(0,$.lQ)(a)),[a]),Z=(0,o.VK)((()=>(0,W.Eg)()),[])&&!T,P=(0,o.VK)((()=>(0,G.n)()),[]),F=(0,o.VK)((()=>(0,D.I2)()),[]);return(0,m.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"},children:[(0,m.jsx)(De,{}),j?(0,m.jsx)(Jt,{analyticsFrom:n,onComplete:s,spaceStore:a,spaceViewStore:l,userSettingsStore:d,pageStore:u,confluenceRequestStore:y,confluenceResult:t.confluenceResult,flowId:M}):(0,m.jsx)(Gt,{analyticsFrom:n,spaceStore:a,spaceViewStore:l,onComplete:s,pageStore:u,flowId:M}),F?(0,m.jsx)(Yt,{onComplete:s,spaceStore:a,spaceViewStore:l,userSettingsStore:d,googleDocRequestStore:v,pageStore:u,analyticsFrom:n}):(0,m.jsx)(Te,{title:"Google Docs",logo:r.Z.images.import.googleDocsPng,actionButton:(0,m.jsx)(Kt,{url:(0,H.UY)("guides.importGoogleDocs")}),onClick:()=>qt("gdocs",n,a,l,s,b,u)}),P&&(0,m.jsx)(Te,{title:"PDF",showBetaBadge:!0,logo:r.Z.images.import.pdfSvg,onClick:()=>qt("pdf",n,a,l,s,b,u)}),(0,m.jsx)(Ht,{analyticsFrom:n,spaceStore:a,spaceViewStore:l,onComplete:s,pageStore:u}),(0,m.jsx)(Te,{title:(0,m.jsx)(x.FormattedMessage,{id:"importOptions.textMarkdown.title",defaultMessage:"Text & Markdown"}),icon:f,onClick:()=>qt("markdown",n,a,l,s,b,u)}),(0,m.jsx)(Te,{title:"HTML",icon:g,onClick:()=>qt("html",n,a,l,s,b,u)}),(0,m.jsx)(Te,{title:"Word",logo:r.Z.images.import.wordPng,onClick:()=>qt("docx",n,a,l,s,b,u)}),(0,m.jsx)(Te,{title:"Dropbox Paper",logo:r.Z.images.import.dropboxPaperPng,actionButton:(0,m.jsx)(Kt,{url:(0,H.UY)("guides.importDropboxPaper")}),onClick:()=>qt("dropbox",n,a,l,s,b,u)}),(0,m.jsx)(Qt,{analyticsFrom:n,onComplete:s,spaceStore:a,spaceViewStore:l,userSettingsStore:d,trelloRequestStore:p,trelloResult:t.trelloResult}),(0,m.jsx)(Xt,{onComplete:s,spaceStore:a,spaceViewStore:l,userSettingsStore:d,evernoteRequestStore:h,evernoteResult:t.evernoteResult}),C&&(0,m.jsx)(Lt,{spaceStore:a,analyticsFrom:n,flowId:M}),(0,m.jsx)(Te,{title:"Quip",logo:r.Z.images.import.quipPng,actionButton:(0,m.jsx)(Kt,{url:(0,H.UY)("guides.importQuip")}),onClick:()=>qt("quip",n,a,l,s,b,u)}),(0,m.jsx)(Te,{title:"Workflowy",logo:r.Z.images.import.workflowyPng,actionButton:(0,m.jsx)(Kt,{url:(0,H.UY)("guides.importWorkflowy")}),onClick:()=>qt("workflowy",n,a,l,s,b,u)}),w&&!k&&(0,m.jsx)(Te,{title:(0,m.jsx)(x.FormattedMessage,{id:"importOptions.genericImporter.title",defaultMessage:"Universal import"}),icon:c.l,onClick:()=>qt("genericImporter",n,a,l,s,b,u,M),actionButton:(0,m.jsx)(Kt,{url:"",helpButtonMessage:(0,m.jsx)(x.FormattedMessage,{id:"importOptions.universalImport.tooltip",defaultMessage:"Import any ZIP file that contains text, Markdown, CSV, HTML, and other files"}),helpMessageWidth:240,disableBackground:!0})}),I&&!Z&&(0,m.jsx)(Bt,{flowId:M,spaceStore:a,requestStore:S,jiraResult:t.jiraResult,renderItemActionsButton:e=>(0,m.jsx)(Wt,{actions:e})})]})}},974584:(e,t,n)=>{n.r(t),n.d(t,{TeamItem:()=>xe,default:()=>de});n(757658);var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(815145),l=n(841892),d=n(559054),c=n(732566),u=n(882855),m=n(605257),p=n(964275),g=n(460651),f=n(375071),h=n(471924),y=n(630845),x=n(709291),S=n(531701),v=n(401898),b=n(137810),M=n(757549),j=n(454642),C=n(547307),w=n(391367),k=n(608055),I=n(484210),T=n(292283),Z=n(460709),P=n(798165),F=n(575546),_=n(80444),A=n(121039),B=n(206258),R=n(672087),D=n(88893),O=n(109867),L=n(274016),V=n(231945),E=n(661519),N=n(301743),U=n(374194),K=n(489728),W=n(942402),z=n(629551),q=n(785893);function G(e){const{email:t,site:n,APIToken:s,instanceType:i,hideInstanceType:r,formValues:{email:l,site:d,token:c},onChange:u,invalidFields:m}=e,p=(0,o.VK)((()=>A.Z.state),[]),g=(0,a.yK)((e=>({inputLabels:{fontSize:b.Z.fontSize.UISmall.desktop,fontWeight:b.Z.fontWeight.semibold,font:"SF Pro",lineHeight:b.Z.lineHeight.UISmall.desktop,color:e.lightTextColor},dropdown:{padding:"0px, 6px, 0px, 6px",borderRadius:4,gap:4,width:68,height:24},placeHolder:{font:"SF Pro",fontWeight:b.Z.fontWeight.regular,fontSize:b.Z.fontSize.UIRegular.desktop,lineHeight:b.Z.lineHeight.UISmall.desktop},captionText:{font:"SF Pro",fontWeight:b.Z.fontWeight.regular,lineHeight:b.Z.lineHeight.UISmall.desktop,fontSize:b.Z.fontSize.UISmall.desktop,color:e.lightTextColor},inputBox:{width:"100%",height:28,padding:4,gap:4,radius:"default"},invalidInput:{boxShadow:e.outlineRedInputBoxShadow}})),[]);return(0,q.jsx)(N.Z,{debugName:"AtlassianAPIAuthContentPopup",capture:!0,children:(0,q.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",width:"100%"},children:(0,q.jsx)("div",{style:{overflowY:"scroll"},children:(0,q.jsxs)("div",{style:{padding:2},children:[!r&&(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{htmlFor:"instanceType",style:{...g.inputLabels},children:i}),(0,q.jsx)(H,{options:[{key:"Cloud",label:(0,q.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownCloudOption.label",defaultMessage:"Cloud"})}],currentOption:"Cloud"})]}),(0,q.jsx)(E.Z,{size:14,isHidden:!0}),(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{htmlFor:"email",style:g.inputLabels,children:t}),(0,q.jsx)(E.Z,{size:8,isHidden:!0}),(0,q.jsx)(U.Z,{id:"email",value:l,autoComplete:"off",autoCapitalize:"off",onChange:e=>{u("email",e.target.value)},showClearButton:!0,placeholder:"notion@acmelabs.com",inputElementAttributes:{minLength:4},style:{...g.inputBox,...m.includes("email")&&g.invalidInput}})]}),(0,q.jsx)(E.Z,{size:14,isHidden:!0}),(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{htmlFor:"site",style:g.inputLabels,children:n}),(0,q.jsx)(E.Z,{size:8,isHidden:!0}),(0,q.jsx)(U.Z,{id:"site",value:d,onChange:e=>u("site",e.target.value),showClearButton:!0,placeholder:"https://jira.atlassian.net",inputElementAttributes:{minLength:4},style:{...g.inputBox,...m.includes("site")&&g.invalidInput}}),(0,q.jsx)(E.Z,{size:8,isHidden:!0}),(0,q.jsx)("div",{style:{...g.captionText},children:(0,q.jsx)(x.FormattedMessage,{id:"AtlassianApiTokenAuthentication.stepsToGetAPIToken.helpTextForSiteInput",defaultMessage:"If you’re using Jira on a non-standard port, please include the port number in the URL, such as https://acme.atlassian.net:43"})})]}),(0,q.jsx)(E.Z,{size:14,isHidden:!0}),(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{htmlFor:"APIToken",style:g.inputLabels,children:s}),(0,q.jsx)(E.Z,{size:8,isHidden:!0}),(0,q.jsx)(U.Z,{id:"AccessToken",type:"password",value:c,onChange:e=>{u("token",e.target.value)},showClearButton:!0,placeholder:"Paste your token here",inputElementAttributes:{minLength:4},style:{...g.inputBox,...(p.adminTokenError||m.includes("token"))&&g.invalidInput}}),(0,q.jsx)(E.Z,{size:8,isHidden:!0}),(0,q.jsx)("div",{style:{...g.captionText},children:(0,q.jsx)(x.FormattedMessage,{id:"AtlassianApiTokenAuthentication.stepsToGetAPIToken.helpTextForApiTokenInput",defaultMessage:"<admintokenmessage>Must be an admin token.</admintokenmessage> Learn how to <createapitokenhelpdoc>create an API token</createapitokenhelpdoc>",values:{createapitokenhelpdoc:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,q.jsx)(W.Z,{external:!0,href:"https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account",onClick:()=>{},children:t})},admintokenmessage:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,q.jsx)("span",{style:{...g.captionText,...p.adminTokenError&&{color:"#D44C47"}},children:t})}}})})]})]})})})})}function H(e){var t;const{options:n,currentOption:s}=e,i=null===(t=n.find((e=>{let{key:t}=e;return t===s})))||void 0===t?void 0:t.label,o=(0,a.yK)((e=>({icon:{marginLeft:4,fill:e.lightIconColor,width:16,height:16,padding:"0.5px, 0px, 0px, 0px",gap:10,fontSize:b.Z.fontSize.UISmall.desktop},dropdownLabel:{font:"SF Pro",fontSize:b.Z.fontSize.UIRegular.desktop,fontWeight:b.Z.fontWeight.regular,lineHeight:b.Z.lineHeight.UISmall.desktop}})),[]);return(0,q.jsx)(V.ZP,{popupType:V.Z4.Popup,placementToOrigin:V.pO.Left,renderOrigin:e=>(0,q.jsx)(K.Z,{...e,isLarge:!0,style:o.dropdownLabel,disabled:!1,hoveredStyle:{background:"rgba(0, 0, 0, 0)"},children:i}),render:()=>(0,q.jsx)(q.Fragment,{})})}const $=function(e){return(0,q.jsx)(G,{email:(0,q.jsx)(z.gq,{style:{alignItems:"center",gap:2},children:(0,q.jsx)(x.FormattedMessage,{id:"AtlassianApiTokenAuthentication.emailMessage",defaultMessage:"Jira admin's email"})}),site:(0,q.jsx)(z.gq,{style:{alignItems:"center",gap:2},children:(0,q.jsx)(x.FormattedMessage,{id:"AtlassianApiTokenAuthentication.siteMessage",defaultMessage:"Jira site url"})}),APIToken:(0,q.jsx)(z.gq,{style:{alignItems:"center",gap:2},children:(0,q.jsx)(x.FormattedMessage,{id:"AtlassianApiTokenAuthentication.apiTokenMessage",defaultMessage:"API token"})}),instanceType:(0,q.jsx)(z.gq,{style:{alignItems:"center",gap:2},children:(0,q.jsx)(x.FormattedMessage,{id:"AtlassianApiTokenAuthentication.instanceType",defaultMessage:"Jira instance type"})}),...e})};var Y=n(690403),Q=n(164921),J=n(552275),X=n(436488),ee=n(256940),te=n(268894),ne=n(568785),se=n(478140),ie=n(632163),oe=n(550506),ae=n(158297),re=n(672495),le=n(164369);function de(){const e=(0,o.VK)((()=>A.Z.state),[]),t=(0,i.O7)(),{open:n,type:s}=e,a=()=>{const e=A.Z.getInitialState();A.Z.setState(e)},r=(0,o.qz)(void 0,R.Z),l=(0,o.VK)((()=>_.default.state),[]).currentSpaceStore,d=e.flowId||h.Il();return s&&l?(0,q.jsx)(oe.Z,{open:n,innerStyle:{width:500,height:"calc(100vh - 100px)",overflow:"scroll",borderRadius:5,maxHeight:675,padding:6},render:()=>(0,q.jsx)(X.Z,{capture:!0,allowEsc:!0,render:()=>(0,q.jsx)(ee.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>(0,q.jsx)(ce,{type:s,handleModalClose:a,environment:t,requestStore:r,spaceStore:l,flowId:d})})}),onDismiss:a}):null}function ce(e){const{type:t,environment:n,requestStore:s,spaceStore:i}=e,o=e.flowId||h.Il(),r=(0,a.yK)((e=>({wrapper:{padding:"20px 14px 0px 14px",height:"100%",display:"flex",flexDirection:"column"}})),[]);return(0,q.jsx)("div",{style:r.wrapper,children:(()=>{switch(t){case"teamspace-selection":return(0,q.jsx)(me,{handleModalClose:e.handleModalClose,flowId:o});case"auth":return(0,q.jsx)(fe,{handleModalClose:e.handleModalClose,environment:n,requestStore:s,spaceStore:i,flowId:o});default:return(0,q.jsx)(q.Fragment,{})}})()})}function ue(e){const t=(0,a.yK)((e=>({spinner:{width:"100%",height:"100%",backgroundColor:e.modalUnderlayBackground,position:"absolute",top:0,left:0}})),[]);return(0,q.jsx)(q.Fragment,{children:e.loading&&(0,q.jsx)("div",{style:t.spinner,children:(0,q.jsx)(ne.Z,{style:{position:"absolute",top:"50%",left:"50%"}})})})}function me(e){let{handleModalClose:t,flowId:n}=e;const c=(0,i.O7)(),p=(0,x.useIntl)(),[g,h]=s.useState(),[y,T]=s.useState(),[Z,R]=s.useState(!1),[D,V]=s.useState([]),[E,N]=s.useState(),[U,W]=s.useState(""),G=(0,o.VK)((()=>{var e;return null===(e=_.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),H=(0,o.VK)((()=>_.default.state.mainEditorCurrentBlockStore),[]),$=(0,o.VK)((()=>{if(!H)return;return(0,P.VP)(H)}),[H]),Y=(0,o.VK)((()=>_.default.state.currentSpaceViewStore),[]),X=(0,o.VK)((()=>(null==Y?void 0:Y.getTeamsStores().filter((e=>e.canAddOrRemoveTopLevelPages())))||[]),[Y]),ee=(0,o.VK)((()=>A.Z.state),[]),[{value:ne}]=(0,d.r5)((async()=>{if(G)return await j.getExternalSyncedCollectionInTeams(c,{spaceId:G})}),[c,G]),[{value:se}]=(0,d.r5)((async()=>{if(G)return await j.getJiraSitesForWorkspace(c,{spaceId:G})}),[c,G]);(0,s.useEffect)((()=>{var e;if("success"===(null==se?void 0:se.type)&&null!==(e=se.data)&&void 0!==e&&null!==(e=e.data)&&void 0!==e&&e.connections){const e=se.data.data.connections.map((e=>{let{metainfo:t,bot_id:n}=e;return{site:t.siteUrl,botId:n}})).filter(v.$K);V(e),1===e.length&&N(e[0])}}),[se]),(0,s.useEffect)((()=>{const{teamSpaceId:e}=ee;if(e){const t=X.find((t=>t.id===e));t&&(R(!0),h(t.id))}}),[ee,X]);const oe=(0,o.VK)((()=>{if("success"===(null==ne?void 0:ne.type)&&ne.data&&E){const e=ne.data.map((e=>{const t=X.find((t=>t.id===e.teamId));if(e.site===E.site&&t)return{...e,teamStore:t}})).filter(v.$K);return e.length||R(!0),e}return[]}),[ne,E,X]),de=(0,o.VK)((()=>X.filter((e=>{var t;return null===(t=e.getName())||void 0===t?void 0:t.toLowerCase().includes(U.toLowerCase())}))),[X,U]),ce=(0,a.yK)((e=>({card:{flexGrow:1,borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:e.stroke.deemphasized,overflow:"auto",margin:"8px 0px 18px",maxHeight:180},wrapper:{padding:"20px 14px 0px 14px",height:"100%",display:"flex",flexDirection:"column"},teamsListTitle:{fontSize:12,fontWeight:b.Z.fontWeight.medium,color:e.mediumTextColor,marginBottom:8},teamsListSubTitle:{fontSize:14,color:e.mediumTextColor,fontWeight:b.Z.fontWeight.regular},teamBody:{padding:"0px 6px",margin:"24px 0px",height:"--webkit-fill-available",flexGrow:1},buttonFocussedStyles:{backgroundColor:S.ZP.blueWithAlpha(.07)},createNewTeamspaceWrapper:{height:28,paddingTop:4,paddingBottom:4,marginLeft:4,marginRight:4},createNewTeamspaceButton:{width:"100%",paddingLeft:6,paddingRight:6},plusIconForCreateNewTeamspace:{color:e.mediumIconColor,width:22,height:22,padding:"1px 0px 0px 4px"},createNewTeamspaceLabel:{fontSize:b.Z.fontSize.UIRegular.desktop,fontWeight:b.Z.fontWeight.regular,color:e.mediumTextColor,lineHeight:b.Z.lineHeight.UIRegular.desktop,padding:"10px 10px 10px 8px"}})),[]),me=e=>{h(e.id),T(null)},pe=e=>{if(e){const t=(0,I.ZP)({store:e,preferPublicLink:!1,pageVisitSource:r.tY.Import});A.Z.setState({...A.Z.state,loading:!1,defaultExternalCollectionSetting:"external_list_projects",teamSpaceId:""}),k.Li({environment:c,url:t})}else{C.showDialog({showCancel:!1,keepFocus:!1,message:(0,q.jsx)(x.FormattedMessage,{defaultMessage:"Error occurred while creating project page. Please try again.",id:"action.jiraSyncImportFailed.message"}),items:[{label:(0,q.jsx)(x.FormattedMessage,{defaultMessage:"Ok",id:"action.jiraSyncImportFailed.okLabel"}),color:"blue",onAccept(){}}]});const e=A.Z.getInitialState();A.Z.setState({...e})}},fe=(0,s.useCallback)((e=>{h(e)}),[]),Se=de.map((e=>{const t=g===e.id;return{key:e.id,render:n=>(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(xe,{teamStore:e,onAccept:me,focused:t,showCurrentTeamSpaceBadge:(null==$?void 0:$.id)===e.id},e.id)}),action:()=>{}}})),ve=oe.map((e=>{const t=`${e.projectId}`,n=e.teamStore,s=(null==y?void 0:y.pageId)===e.projectId;return{key:t,render:()=>(0,q.jsx)(J.Z,{buttonStyle:{marginBottom:6,...s&&ce.buttonFocussedStyles},onClick:()=>{return t={pageId:e.projectId,teamStore:n},T(t),void h(null);var t},icon:(0,q.jsx)("img",{src:l.Z.images.appPackages.jiraProjectIconSvg,style:{width:18,height:18}}),title:(0,q.jsx)(x.FormattedMessage,{id:"jiraSyncTeamSelectionModal.teamsList.syncCount",defaultMessage:"{projects} projects, {tasks} issues",values:{projects:e.projectsCount,tasks:e.tasksCount}}),focused:s,caption:(0,q.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"center",marginTop:6},children:[(0,q.jsx)(x.FormattedMessage,{defaultMessage:"in",id:"jiraSyncTeamSelectionModal.teamsList.teamspace.prefix"}),(0,q.jsx)(L.p,{store:n,size:20,disabled:!0}),(0,q.jsx)(F.o,{teamStore:n})]})}),action:()=>{}}})).filter(v.$K),be=oe.length>0&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(le.Z,{isSecondaryColor:!0,style:ce.teamsListTitle,children:(0,q.jsx)(x.FormattedMessage,{id:"jiraSyncTeamSelectionModal.existingSync.title",defaultMessage:"Edit existing Jira sync"})}),(0,q.jsx)(le.Z,{isSecondaryColor:!0,style:ce.teamsListSubTitle,children:(0,q.jsx)(x.FormattedMessage,{id:"jiraSyncTeamSelectionModal.existingSync.subtitle",defaultMessage:"Add or remove projects to an existing Jira sync"})}),(0,q.jsx)("div",{style:ce.card,children:(0,q.jsx)(ie.Z,{type:ie.i.Vertical,initialFocus:0,sections:[{key:"existingSyncs",render:e=>(0,q.jsx)(re.Z,{topBorder:!1,...e}),items:ve}]})})]}),Me=Z||1===D.length&&0===oe.length,je=(0,q.jsxs)(q.Fragment,{children:[oe.length?(0,q.jsxs)(Q.Z,{onClick:()=>R(!Z),style:{...ce.teamsListTitle,display:"flex",alignItems:"center",gap:6},children:[(0,q.jsx)(x.FormattedMessage,{id:"jiraSyncTeamSelectionModal.createNewSync.title",defaultMessage:"or create a new sync"}),Z?(0,u.E)({height:8,width:12}):(0,m.o)({height:16,width:12})]}):E&&(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(le.Z,{style:ce.teamsListTitle,children:(0,q.jsx)(x.FormattedMessage,{id:"jiraSyncTeamSelectionModal.addNewSync.title",defaultMessage:"Add a new sync"})})}),Me&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(te.ZP,{focusInitial:!1,value:U,showClearButton:!0,onChange:e=>W(e.target.value),placeholder:p.formatMessage({id:"jiraSyncTeamSelectionModal.searchPlaceholder",defaultMessage:"Search for a teamspace"}),itemMarginLeft:0,itemMarginRight:0}),(0,q.jsxs)("div",{style:{...ce.card,maxHeight:320},children:[(0,q.jsx)("div",{style:ce.createNewTeamspaceWrapper,children:(0,q.jsx)(z.gq,{alignItems:"center",children:(0,q.jsxs)(K.Z,{onClick:()=>{O.lo("jira_importer",{onClose:e=>fe(e)})},style:ce.createNewTeamspaceButton,children:[(0,f.f)(ce.plusIconForCreateNewTeamspace),(0,q.jsx)(le.Z,{style:ce.createNewTeamspaceLabel,children:(0,q.jsx)(x.FormattedMessage,{id:"jiraSyncTeamSelectionModal.createNewTeamspace",defaultMessage:"Create new teamspace"})})]})})}),(0,q.jsx)(ie.Z,{type:ie.i.Vertical,initialFocus:0,sections:[{key:"teamspaces",render:e=>(0,q.jsx)(re.Z,{topBorder:!1,...e}),items:Se}]})]})]})]});return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(he,{handleModalClose:t}),(0,q.jsx)("div",{style:{flexGrow:1,overflow:"scroll"},className:"hide-scrollbar",children:(0,q.jsxs)("div",{style:{padding:2},children:[(0,q.jsx)("div",{style:ce.teamsListTitle,children:(0,q.jsx)(x.FormattedMessage,{id:"jiraSyncTeamSelectionModal.site.title",defaultMessage:"Jira site"})}),(0,q.jsx)(ge,{connections:D,onChange:e=>{N(e)},selectedConnection:E}),be,je]})}),(0,q.jsx)(ye,{children:(0,q.jsx)(ae.Z,{onClick:()=>{if(g)(async e=>{if(!E)return;A.Z.setState({...A.Z.state,loading:!0,site:E.site,botId:E.botId});const t=await w.Pf({environment:c,selectedTeamspaceId:e,siteUrl:E.site,botId:E.botId});pe(t)})(g),M.oJ(c,{import_source:"jira",userId:c.currentUser.id,spaceId:G,flowId:n,teamSpaceId:g,site:null==E?void 0:E.site,botId:null==E?void 0:E.botId,type:"new"});else if(y){const{pageId:e,teamStore:t}=y,s=B.G.createChildStore(t,{id:e,table:"block",spaceId:G});M.oJ(c,{import_source:"jira",userId:c.currentUser.id,spaceId:G,flowId:n,teamSpaceId:t.id,site:null==E?void 0:E.site,botId:null==E?void 0:E.botId,type:"existing"}),s&&pe(s)}},disabled:!(E&&(Boolean(y)||Boolean(g))),children:y?(0,q.jsx)(x.FormattedMessage,{id:"jiraSyncTeamSelectionModal.footer.addToExistingTeam",defaultMessage:"Edit sync"}):(0,q.jsx)(x.FormattedMessage,{id:"jiraSyncTeamSelectionModal.footer.addToNewTeam",defaultMessage:"Add sync"})})}),(0,q.jsx)(ue,{loading:ee.loading})]})}function pe(e){var t;const n=null==e?void 0:e.split("/");return(null==n||null===(t=n[2])||void 0===t||null===(t=t.split("."))||void 0===t?void 0:t[0])||""}function ge(e){const{connections:t,selectedConnection:n,onChange:s}=e,{isMobile:o}=(0,i.Fy)(),r=(0,a.yK)((e=>({card:{flexGrow:1,borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:e.stroke.deemphasized,overflow:"auto",marginBottom:18,display:"flex",gap:8,paddingTop:4,paddingBottom:4},integrationIcon:{width:20,height:20,marginTop:4},chooseSiteButton:{display:"flex",marginTop:6,marginBottom:6,marginLeft:"-8px",gap:6,alignItems:"center",width:"fit-content"}})),[]);return(0,q.jsx)(V.ZP,{popupType:o?V.Z4.SlideUp:V.Z4.Popup,placementToOrigin:V.pO.Bottom,alignmentToOrigin:V.vR.Start,renderOrigin:e=>n?(0,q.jsx)("div",{style:r.card,children:(0,q.jsx)(J.Z,{...e,title:(0,q.jsx)(le.Z,{style:{fontWeight:b.Z.fontWeight.regular,textTransform:"capitalize"},children:pe(n.site)}),caption:(0,q.jsx)(le.Z,{isSecondaryColor:!0,style:{fontWeight:b.Z.fontWeight.regular},children:n.site}),icon:(0,q.jsx)("img",{style:r.integrationIcon,src:l.Z.images.externalIntegrations.jiraPng}),right:(0,u.E)({height:8,width:12}),shouldWrapCaption:!0,focused:!1})}):(0,q.jsxs)(K.Z,{...e,isLarge:!0,style:r.chooseSiteButton,disabled:!1,children:[(0,q.jsx)(x.FormattedMessage,{id:"jiraSyncTeamSelectionModal.site.change",defaultMessage:"Choose Jira site"}),(0,u.E)({height:8,width:12})]}),render:e=>{const n=[{key:"sites",render:e=>(0,q.jsx)(re.Z,{...e}),items:t.map((e=>({key:e.site,action:()=>{s(e)},render:t=>(0,q.jsx)(J.Z,{...t,title:(0,q.jsx)(le.Z,{style:{fontWeight:b.Z.fontWeight.regular,textTransform:"capitalize"},children:pe(e.site)}),caption:(0,q.jsx)(le.Z,{isSecondaryColor:!0,style:{fontWeight:b.Z.fontWeight.regular},children:e.site}),shouldWrapCaption:!0,focused:!1})})))}];let i;return i=o?{menuType:Z.og.Modal,title:"site",right:(0,q.jsx)(x.FormattedMessage,{defaultMessage:"Done",id:"settingItem.buttonPopup.done.label"}),onClickRight:e.close}:{menuType:Z.og.Popup,width:270},(0,q.jsx)(se.Z,{...i,children:(0,q.jsx)(ie.Z,{type:ie.i.Vertical,sections:n,initialFocus:void 0,onAccept:e.close})})}})}function fe(e){let{environment:t,requestStore:n,spaceStore:i,handleModalClose:a,flowId:r}=e;const l=(0,o.VK)((()=>A.Z.state),[]),[d,c]=(0,s.useState)([]),[u,m]=s.useState({site:"",email:"",token:""}),p=async()=>{const{email:e,site:s,token:o}=u,a=null==i?void 0:i.id,l=function(e){const{email:t,site:n,token:s}=e,i=[];(0,T.D1)(n)||i.push("site");t&&y.B(t,"email")||i.push("email");s||i.push("token");return i}({email:e,site:s,token:o});c(l),a&&!l.length&&await w.G2({environment:t,requestStore:n,userEmail:e,site:`https://${(0,T.D1)(s)}`,apiToken:o,spaceId:a,flowId:r})};return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(he,{handleModalClose:a}),(0,q.jsx)($,{formValues:u,onChange:(e,t)=>{m({...u,[e]:t}),c((t=>t.filter((t=>t!==e))))},invalidFields:d,hideInstanceType:!0}),(0,q.jsx)(ye,{children:(0,q.jsx)(ae.Z,{onClick:async()=>{await p()},children:(0,q.jsx)(x.FormattedMessage,{id:"jiraSyncAuthModal.footer.chooseSyncLocation",defaultMessage:"Next"})})}),(0,q.jsx)(ue,{loading:l.loading})]})}function he(e){let{handleModalClose:t}=e;const n=(0,a.yK)((e=>({header:{fontWeight:b.Z.fontWeight.medium,fontSize:17,textAlign:"center",marginTop:8},description:{fontWeight:b.Z.fontWeight.regular,color:e.mediumTextColor,fontSize:14,maxHeight:72,textAlign:"center",padding:"0px 68px",marginBottom:24},icon:{height:40,width:40},iconGroup:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gridColumnGap:9,marginBottom:9},arrowRight:{width:20,height:20,opacity:.4,fontWeight:"bold",padding:3},notionLogo:{height:40,width:40,color:e.regularIconColor},closeButton:{position:"absolute",top:14,right:14,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:14,fill:e.mediumTextColor}})),[]);return(0,q.jsxs)("div",{children:[(0,q.jsx)(Q.Z,{onClick:t,style:n.closeButton,hoveredStyle:n.closeButtonHover,children:(0,p.D)(n.closeButtonIcon)}),(0,q.jsxs)("div",{style:n.iconGroup,children:[(0,q.jsx)("img",{style:n.icon,src:l.Z.images.externalIntegrations.jiraPng,alt:"Jira Icon"}),(0,c.k)(n.arrowRight),(0,g.h)(n.notionLogo)]}),(0,q.jsx)("div",{style:n.header,children:(0,q.jsx)(x.FormattedMessage,{id:"jiraSyncTeamSelectionModal.header.label",defaultMessage:"Sync Jira projects and issues"})}),(0,q.jsx)("div",{style:n.description,children:(0,q.jsx)(x.FormattedMessage,{id:"jiraSyncTeamSelectionModal.description.label",defaultMessage:"Sync Jira information to a Notion database and view the latest updates"})})]})}function ye(e){const t=(0,a.yK)((e=>({footer:{display:"flex",justifyContent:"flex-end",marginTop:6,marginBottom:10}})),[]);return(0,q.jsx)("div",{style:t.footer,children:e.children})}const xe=s.forwardRef((function(e,t){const{teamStore:n,onAccept:s,focused:i,showCurrentTeamSpaceBadge:r}=e,l=(0,a.yK)((e=>({caption:{color:e.lightTextColor}})),[]),d=(0,o.VK)((()=>n.getNumberOfMembersOrZero((0,D.Io)())),[n]);return(0,q.jsx)(J.Z,{focused:i,ref:t,onClick:e=>s(n),buttonStyle:{marginBottom:6},icon:(0,q.jsx)(L.p,{store:n,size:20,disabled:!0}),title:(0,q.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,q.jsx)(F.o,{teamStore:n}),r&&(0,q.jsx)("div",{children:(0,q.jsx)(Y.Z,{content:(0,q.jsx)(x.FormattedMessage,{id:"teamItem.currentTeamSpace.caption",defaultMessage:"Current teamspace"})})})]}),caption:(0,q.jsx)("div",{style:l.caption,children:(0,q.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfMembers, plural, one {{numberOfMembers} member} other {{numberOfMembers} members}}",id:"teamPickerButton.teamItem.teamMemberCount",values:{numberOfMembers:d}})})})}))},326991:(e,t,n)=>{n.d(t,{Z:()=>k});n(667294);var s=n(800480),i=n(886628),o=n(724405),a=n(542853),r=n(40462),l=n(957222),d=n(709291),c=n(372933),u=n(614549),m=n(547307),p=n(843250),g=n(460709),f=n(61766),h=n(319385),y=n(960709),x=n(552275),S=n(231945),v=n(478140),b=n(632163),M=n(174136),j=n(489728),C=n(672495),w=n(785893);const k=function(e){let{currentLocale:t,pickerLabel:n,confirm:l,onChange:x,origin:k,showGlobeIcon:Z}=e;const P=(0,o.Fg)(),F=(0,s.O7)(),_=(0,d.useIntl)(),A=(0,i.qz)(void 0,f.Z),{device:B}=F,R=(0,i.VK)((()=>"ja-JP"===t&&h.default.checkGate({gateName:"japan_full_launch"})),[t]),D=(0,i.VK)((()=>h.default.checkGate({gateName:"polyglot"})),[]);return B.isMobile?null:(0,w.jsx)(S.ZP,{onClick:()=>{u.xU(F,{origin:k})},popupType:S.Z4.Popup,buttonPopupStore:A,renderOrigin:e=>(0,w.jsxs)(j.Z,{style:{marginLeft:-8,paddingLeft:8,paddingRight:8,display:"flex",alignItems:"center",...Z&&{color:P.icon.secondary}},...e,children:[Z&&(0,r.o)({width:16,height:16,fill:P.icon.secondary,marginRight:4}),n||I(t,_).label,(0,c.ay)(t)&&!R&&(0,w.jsx)(M.Z,{desktopStyle:{marginLeft:4},children:(0,w.jsx)(d.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"})}),(0,a.i)({width:10,marginLeft:4,fill:Z?P.icon.secondary:P.lightIconColor})]}),placementToOrigin:y.Iw.Bottom,alignmentToOrigin:y.lU.Start,render:e=>{let n;n=D?[...c.tp,...c.is]:[...c.tp];const s=[{key:"languages",render:e=>(0,w.jsx)(C.Z,{...e,topBorder:0!==e.index}),items:n.map((n=>{const s={key:n,render:e=>function(e,t,n,s){const{label:i,caption:o}=I(e,s);return(0,w.jsx)(T,{label:i,caption:o,focused:t,props:n,locale:e})}(n,e.focused,e,_),action:()=>{!function(e,t,n,s,i){t!==e&&function(e,t,n,s){const{label:i}=I(e,t);if(n){const t=()=>{s(e)};m.showDialog({showCancel:!0,keepFocus:!1,message:(0,w.jsx)(d.FormattedMessage,{id:"languagePicker.changeLanguage.confirmationMessage",defaultMessage:"Are you sure you want to update the language to {language}?",values:{language:i}}),items:[{label:(0,w.jsx)(d.FormattedMessage,{id:"languagePicker.changeLanguage.updateButton.label",defaultMessage:"Update"}),color:"red",onAccept:t}]})}else s(e)}(e,n,s,i)}(n,t,_,l,x),e.close()}};return s}))}],i={menuType:g.og.Popup,width:240};return(0,w.jsx)(v.Z,{className:p.hKO,...i,children:(0,w.jsx)(b.Z,{type:b.i.Vertical,initialFocus:void 0,sections:s})})}})};function I(e,t){return(0,l.t)(t)[e]}function T(e){const{locale:t}=e,n=(0,o.Fg)(),s=(0,i.VK)((()=>"ja-JP"===t&&h.default.checkGate({gateName:"japan_full_launch"})),[t]);return(0,w.jsx)(x.Z,{...e.props,title:(0,w.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,w.jsx)("div",{style:{...e.style,marginRight:0},children:e.label})}),caption:e.caption&&(0,w.jsx)("span",{style:{color:n.mediumTextColor},children:e.caption}),shouldWrapCaption:!0,right:(0,c.ay)(e.locale)&&!s&&(0,w.jsx)(M.Z,{children:(0,w.jsx)(d.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"})})})}},499472:(e,t,n)=>{n.d(t,{Z:()=>h,d:()=>f});n(667294);var s=n(800480),i=n(886628),o=n(554153),a=n(709291),r=n(614549),l=n(454642),d=n(547307),c=n(247839),u=n(453730),m=n(164369),p=n(326991),g=n(785893);async function f(e){let{locale:t,environment:n,origin:s}=e;r.A0(n,{locale:t,origin:s});const i=await l.setLocale(n,{locale:t});"success"===i.type?(o.Z.set("preferredLocale",t),await u.transactionQueue.drain(),n.device.isElectron?c.refreshAll({includeFocusedWindow:!0}):window.location.reload(!0)):d.showError(i)}const h=function(e){const t=(0,s.O7)(),{device:n,WindowSizeStore:o}=t,r=(0,i.VK)((()=>o.state.paddingLeftCSS),[o]),l=(0,i.VK)((()=>o.state.paddingRightCSS),[o]);return(0,g.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:n.isMobile?r:0,paddingRight:n.isMobile?l:0},children:(0,g.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"},children:[(0,g.jsxs)("div",{style:{flex:1},children:[(0,g.jsx)(m.Z,{children:(0,g.jsx)(a.FormattedMessage,{id:"languageRegionSettings.language.label",defaultMessage:"Language"})}),(0,g.jsx)(m.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"},children:(0,g.jsx)(a.FormattedMessage,{id:"languageSettings.languageSwitcher.subtitle",defaultMessage:"Change the language used in the user interface."})})]}),(0,g.jsx)(p.Z,{confirm:!0,onChange:e=>f({locale:e,environment:t,origin:"languageSettings"}),currentLocale:e.locale,origin:"languageSettings"})]})})}},374661:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Z});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(966673),l=n(188145),d=n(964275),c=n(599405),u=n(89101),m=n(709291),p=n(137810),g=n(929845),f=n(454642),h=n(608055),y=n(321969),x=n(825464),S=n(80444),v=n(945946),b=n(260458),M=n(573063),j=n(316354),C=n(953437),w=n(158297),k=n(462385),I=n(164369),T=n(785893);function Z(){const e=(0,i.O7)(),t=(0,m.useIntl)(),[n,Z]=(0,s.useState)(!0),{isDesktopBrowser:P,os:F}=(0,i.Fy)(),_=(0,o.VK)((()=>e.RouterStore.state.route.name in c.desktopDeepLinkingRoutes),[e]),A=(0,o.VK)((()=>S.default.state.inAppCalloutStore),[]),B=(0,o.VK)((()=>A.getCalloutVisibility("desktop_preference_popup").canShow),[A]),R=e.currentUser.isLoggedIn(),D=(0,o.VK)((()=>v.Z.state),[]),[O,L]=(0,s.useState)(!1),V=(0,o.VK)((()=>v.Z.canPersistToLocalStorage()),[]),E=!O&&R&&void 0===D&&P&&("mac"===F||"windows"===F)&&_&&V&&B,[N,U]=(0,s.useState)(!1),K=E&&N,W=(0,s.useRef)(!1);(0,s.useEffect)((()=>{E&&!W.current&&(async function(e,t){const n=await f.getDesktopAppRegistration(e,{os:t});return"data"in n&&n.data.isRegistered}(e,F).then((e=>{U(e)})),W.current=!0)}),[E,U,e,F]);const z=(0,r.D9)(K);(0,s.useEffect)((()=>{K&&!z&&(g.wW(e),A.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!0,validateCanShow:!0}))}),[K,z,e,A]);const q=(0,a.yK)((()=>({origin:{position:"fixed",left:"50%",top:"100%"},container:{bottom:20,padding:"8px 12px 12px",minWidth:300},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},headerText:{fontSize:14,fontWeight:p.Z.fontWeight.medium},appDownloadButton:{fontSize:14,marginLeft:-5},appDownloadIcon:{width:14,height:14,marginRight:6},actions:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},alwaysOpenLinks:{display:"flex",alignItems:"center"},alwaysOpenLinksLabel:{marginLeft:6},alwaysOpenLinksButton:{paddingLeft:12,paddingRight:12,height:34,marginLeft:12}})),[]);return(0,T.jsx)(C.ZP,{popupType:C.kQ.Popup,placementToOrigin:x.u.Bottom,origin:(0,T.jsx)("div",{style:q.origin}),disableMouseCapture:!0,open:K,style:q.container,render:()=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{style:q.header,children:[(0,T.jsx)(I.Z,{style:q.headerText,children:(0,T.jsx)(m.FormattedMessage,{id:"openInDesktopAppPopup.header",defaultMessage:"Open in Notion's desktop app?"})}),(0,T.jsx)(M.Z,{ariaLabel:t.formatMessage({id:"openInDesktopAppPopup.closeButton",defaultMessage:"Dismiss"}),icon:d.D,onClick:()=>{v.Z.setState("never"),L(!0),g.Zy(e)}})]}),(0,T.jsx)(j.Z,{href:u.AR.desktop,external:!0,onClick:()=>{g.iD(e)},children:(0,T.jsxs)(k.Z,{style:q.appDownloadButton,children:[(0,l.E)(q.appDownloadIcon),(0,T.jsx)("span",{children:(0,T.jsx)(m.FormattedMessage,{id:"openInDesktopAppPopup.appDownloadButton",defaultMessage:"Don't have the app? Download"})})]})}),(0,T.jsxs)("div",{style:q.actions,children:[(0,T.jsxs)("div",{style:q.alwaysOpenLinks,children:[(0,T.jsx)(b.Z,{checked:n,size:16,onClick:()=>{Z(!n)}}),(0,T.jsx)(I.Z,{isInline:!0,style:q.alwaysOpenLinksLabel,children:(0,T.jsx)(m.FormattedMessage,{id:"openInDesktopAppPopup.alwaysOpenLinksLabel",defaultMessage:"Always open in app",values:{strongtext:e=>(0,T.jsx)("strong",{children:e})}})})]}),(0,T.jsx)(w.Z,{style:q.alwaysOpenLinksButton,onClick:()=>{v.Z.setState(n?"always":"never"),L(!0),h.RX({url:(0,y.W)(window.location.href),environment:e}),g.LC(e,{always_open_in_app:n})},children:(0,T.jsx)(m.FormattedMessage,{id:"openInDesktopAppPopup.openInAppButton",defaultMessage:"Open in app",values:{strongtext:e=>(0,T.jsx)("strong",{children:e})}})})]})]}),onClosed:()=>{A.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!1})}})}},668995:(e,t,n)=>{n.r(t),n.d(t,{OutlinerDropdownMenuButton:()=>N,useSortActions:()=>W});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(222109),l=n(356666),d=n(698519),c=n(155159),u=n(269246),m=n(249902),p=n(709291),g=n(62967),f=n(838745),h=n(709953),y=n(210228),x=n(165452),S=n(304708),v=n(460709),b=n(35026),M=n(240745),j=n(908597),C=n(745238),w=n(785893);const k=(0,C.IU)("move",{viewBox:"0 0 16 16",svg:(0,w.jsx)("path",{d:"M1.37891 8.5C1.22266 8.35938 1.14844 8.19531 1.15625 8.00781C1.16406 7.81641 1.24219 7.6543 1.39062 7.52148L3.26562 5.79883C3.41406 5.66602 3.56445 5.60547 3.7168 5.61719C3.86914 5.62891 3.99609 5.69336 4.09766 5.81055C4.20312 5.92773 4.25586 6.07422 4.25586 6.25V7.39258H7.37891V4.25781H6.23633C6.05664 4.25781 5.9082 4.20703 5.79102 4.10547C5.67773 4 5.61523 3.87109 5.60352 3.71875C5.5918 3.56641 5.65234 3.41602 5.78516 3.26758L7.50781 1.39844C7.64453 1.24219 7.80664 1.16211 7.99414 1.1582C8.18164 1.15039 8.3457 1.22656 8.48633 1.38672L10.209 3.26172C10.3457 3.41016 10.4082 3.5625 10.3965 3.71875C10.3887 3.87109 10.3262 4 10.209 4.10547C10.0918 4.20703 9.94141 4.25781 9.75781 4.25781H8.62695V7.39258H11.7441V6.25C11.7441 6.07422 11.7949 5.92773 11.8965 5.81055C12.002 5.69336 12.1309 5.62891 12.2832 5.61719C12.4355 5.60547 12.5879 5.66602 12.7402 5.79883L14.6152 7.52148C14.7676 7.66211 14.8438 7.82617 14.8438 8.01367C14.8438 8.20117 14.7676 8.36523 14.6152 8.50586L12.7402 10.2227C12.5918 10.3594 12.4395 10.4238 12.2832 10.416C12.1309 10.4043 12.002 10.3398 11.8965 10.2227C11.7949 10.1055 11.7441 9.95508 11.7441 9.77148V8.64062H8.62695V11.7695H9.75781C9.94141 11.7695 10.0918 11.8223 10.209 11.9277C10.3262 12.0293 10.3887 12.1562 10.3965 12.3086C10.4082 12.4648 10.3457 12.6172 10.209 12.7656L8.49219 14.6406C8.35156 14.7969 8.1875 14.875 8 14.875C7.8125 14.875 7.64844 14.7969 7.50781 14.6406L5.78516 12.7598C5.65234 12.6152 5.5918 12.4648 5.60352 12.3086C5.61523 12.1562 5.67773 12.0293 5.79102 11.9277C5.9082 11.8223 6.05664 11.7695 6.23633 11.7695H7.37891V8.64062H4.25586V9.77148C4.25586 9.95508 4.20312 10.1055 4.09766 10.2227C3.99609 10.3398 3.86914 10.4043 3.7168 10.416C3.56445 10.4238 3.41211 10.3594 3.25977 10.2227L1.37891 8.5Z"})});var I=n(693405),T=n(672495),Z=n(566418),P=n(80444),F=n(156386);const _=(0,p.defineMessages)({move:{id:"useMoveSidebarAction.title.moveSection",defaultMessage:"Move section"},moveUp:{id:"useMoveSidebarAction.option.moveUp",defaultMessage:"Move up"},moveDown:{id:"useMoveSidebarAction.option.moveDown",defaultMessage:"Move down"}});function A(e){let{type:t,onClose:n}=e;const s=function(e){const{sidebarSection:t,onSelect:n}=e,s=(0,o.VK)((()=>P.default.state.currentSpaceViewStore),[]),i=(0,p.useIntl)(),a=(0,F.f)(),r=(0,Z.Q)();if(!s)return[];const l=(0,F.D)({sidebarOrder:a,sidebarState:r}),d=l.indexOf(t),c=0===d,u=d===l.length-1;return["moveUp","moveDown"].map((e=>{const o=_[e];return(0,g.cN)({key:e,displayName:void 0,analyticsName:o.defaultMessage,validators:[],closeParentMenu:!0,action:i=>{let{environment:o}=i;const r=function(e){let{sidebarSection:t,selectedMoveOption:n,sidebarOrder:s,visibleSidebarOrder:i}=e;const o=[...s],a=s.indexOf(t),r=i.indexOf(t);if("moveUp"===n&&r>0){const e=i[r-1];o[s.indexOf(e)]=t,o[a]=e}if("moveDown"===n&&r<i.length-1){const e=i[r+1];o[s.indexOf(e)]=t,o[a]=e}return o}({sidebarSection:t,selectedMoveOption:e,sidebarOrder:a,visibleSidebarOrder:l});y.createAndCommit({userAction:`useMoveSidebarAction.${e}`,environment:o,perform:e=>{h.sW({store:s,data:{sidebar_order:r},transaction:e})}}),f.mv(o,{section:t,previous_order:a,new_order:r,from:"outliner_section_menu"}),n()},render:t=>{const n="moveUp"===e&&c||"moveDown"===e&&u,s="moveUp"===e?j.Z:M.M;return(0,w.jsx)(I.Z,{...t,disabled:n,disabledFeedback:n,title:i.formatMessage(o),svg:s})}})}))}({sidebarSection:t,onSelect:n}),i=(0,Z.Q)(),a=(null==i?void 0:i.shownSidebarSectionCount)??0;return(0,g.MV)({key:"move",displayName:_.move,analyticsName:_.move.defaultMessage,validators:[()=>a>1],svg:k,subActions:()=>[(0,g.$J)({key:"move",render:e=>(0,w.jsx)(T.Z,{...e}),actions:s})]})}var B=n(319385),R=n(869254),D=n(748019),O=n(164921),L=n(231945),V=n(478140);const E=(0,p.defineMessages)({manual:{id:"outlinerDropdownMenuButton.sort.manual",defaultMessage:"Manual"},lastEdited:{id:"outlinerDropdownMenuButton.sort.lastEdited",defaultMessage:"Last edited"}});function N(e){const{type:t,spaceViewStore:n}=e,o=(0,i.O7)(),r=(0,a.yK)((e=>({button:{display:"flex",alignItems:"center",justifyContent:"center",height:20,width:20,borderRadius:4},icon:{fill:e.mediumIconColor,height:14,width:14}})),[]),d=(0,s.useCallback)((()=>{R.Z.setState({open:!0}),f.Mk(o,{outliner_type:b.iE[t]})}),[o,t]),c=(0,s.useCallback)((()=>{R.Z.setState({open:!1})}),[]);return(0,w.jsx)(L.ZP,{popupType:L.Z4.Popup,alignmentToOrigin:L.vR.Start,renderOrigin:e=>(0,w.jsx)(O.Z,{style:r.button,...e,children:(0,l.o)(r.icon)}),onClick:d,onClose:c,render:e=>(0,w.jsx)(K,{type:t,spaceViewStore:n,onClose:()=>{e.close()}}),originGap:2})}const U=(0,p.defineMessages)({sort:{id:"outlinerDropdownMenu.sort",defaultMessage:"Sort"},truncationLimit:{id:"outlinerDropdownMenu.truncationLimit",defaultMessage:"Show"}});function K(e){const{type:t,spaceViewStore:n,onClose:s}=e,l=(0,i.O7)(),x=(0,p.useIntl)(),M=(0,a.yK)((e=>({rightText:{fontSize:12,color:e.text.secondary}})),[]),j=(0,o.VK)((()=>(0,S.mq)(l)),[l]),C=(0,o.VK)((()=>(0,b.S4)({spaceViewStore:n,type:t})),[n,t]),k=C.sortOption,Z=C.truncationLimit,P="shared"===t&&j||"private"===t||"teamspaces"===t,F="private"===t||"shared"===t&&j,_=W({type:t,onSelect:s,spaceViewStore:n,outlinerLocation:"sidebar"}),B=function(e){const{type:t,spaceViewStore:n,onSelect:s}=e,r=(0,i.O7)(),l=(0,a.yK)((()=>({icon:{width:16,height:16},right:{width:16}})),[]),c=(0,o.VK)((()=>(0,b.S4)({type:t,spaceViewStore:n}).truncationLimit),[t,n]);return u.Wy.map((e=>(0,g.cN)({key:e.toString(),displayName:void 0,analyticsName:e.toString(),validators:[],closeParentMenu:!0,action:()=>{y.createAndCommit({userAction:"OutlinerDropdownMenuButton.setTruncationLimit",environment:r,perform:s=>{const i=n.getSettingsStore().getKeyStore("sidebar_section_menu").getKeyStore("truncationLimit").getKeyStore(t);h.sO({transaction:s,store:i,value:e})}}),m.j({name:"update_sidebar_section_option",args:{option:"show",type:t}}),f.hH(r,{outliner_type:b.iE[t],option:e}),s()},render:t=>(0,w.jsx)(I.Z,{...t,title:(0,w.jsx)(z,{limit:e,withItems:!0}),right:c===e&&(0,d.k)(l.icon),rightStyle:l.right})})))}({type:t,onSelect:s,spaceViewStore:n}),R=A({type:t,onClose:s}),O=[(0,g.MV)({key:"sort",displayName:U.sort,analyticsName:U.sort.defaultMessage,validators:[()=>F],svg:r.T,right:x.formatMessage(E[k]),rightStyle:M.rightText,subActions:()=>[(0,g.$J)({key:"sort",render:e=>(0,w.jsx)(T.Z,{...e}),actions:_})]}),(0,g.MV)({key:"truncationLimit",displayName:U.truncationLimit,analyticsName:U.truncationLimit.defaultMessage,validators:[()=>P],svg:c.J,right:(0,w.jsx)(z,{limit:Z}),rightStyle:M.rightText,subActions:()=>[(0,g.$J)({key:"truncationLimit",render:e=>(0,w.jsx)(T.Z,{...e}),actions:B})]}),R],L=[(0,g.$J)({key:"all",render:e=>(0,w.jsx)(T.Z,{...e}),actions:O})];return(0,w.jsx)(V.Z,{menuType:v.og.Popup,minWidth:220,children:(0,w.jsx)(D.Z,{context:{blocks:[],environment:l,publicEditMode:void 0},sections:L,initialFocus:void 0})})}function W(e){const{type:t,spaceViewStore:n,onSelect:s,outlinerLocation:r}=e,l=(0,i.O7)(),c=(0,p.useIntl)(),{currentSpaceStore:u}=(0,o.VK)((()=>P.default.state),[]),S=l.currentUser.id,v=(0,o.VK)((()=>B.default.checkGate({gateName:"sidebar_add_new_pages_to_bottom"})),[]),M=(0,o.VK)((()=>(0,b.S4)({type:t,spaceViewStore:n}).sortOption),[t,n]),j=(0,a.yK)((()=>({icon:{width:16,height:16},right:{width:16}})),[]);return["manual","lastEdited"].map((e=>{const i=E[e];return(0,g.cN)({key:e,displayName:void 0,analyticsName:i.defaultMessage,validators:[],closeParentMenu:!0,action:async()=>{y.createAndCommit({userAction:"OutlinerDropdownMenuButton.setSortOption",environment:l,perform:s=>{const i=n.getSettingsStore().getKeyStore("sidebar_section_menu").getKeyStore("sortOption").getKeyStore(t);h.sO({transaction:s,store:i,value:e})}}),"manual"===e&&"shared"===t&&!v&&S&&u&&await x.l({environment:l,spaceId:u.id,userId:S}),m.j({name:"update_sidebar_section_option",args:{option:"sort",type:t}}),f.NQ(l,{outliner_type:b.iE[t],outliner_location:r,option:e}),s()},render:t=>(0,w.jsx)(I.Z,{...t,title:c.formatMessage(i),right:M===e&&(0,d.k)(j.icon),rightStyle:j.right})})}))}function z(e){const{limit:t,withItems:n}=e;return t===u.Ng?(0,w.jsx)(p.FormattedMessage,{id:"outlinerDropdownMenuButton.truncationLimit.noTruncation",defaultMessage:"All"}):n?(0,w.jsx)(p.FormattedMessage,{id:"outlinerDropdownMenuButton.truncationLimit",defaultMessage:"{limit} items",values:{limit:t}}):(0,w.jsx)("span",{children:t})}},13904:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(841892),l=n(709291),d=n(401898),c=n(91536),u=n(75472),m=n(165598),p=n(401903),g=n(897630),f=n(44041),h=n(535057),y=n(288280),x=n(231945),S=n(709019),v=n(953437),b=n(158297),M=n(526388),j=n(340400),C=n(295691),w=n(584169),k=n(296994),I=n(460709),T=n(918514),Z=n(229798),P=n(751077),F=n(316354),_=n(478140),A=n(632163),B=n(489728),R=n(672495),D=n(785893);function O(e){const{onInviteClick:t,onInviteComplete:n}=e,i=(0,o.qz)(void 0,Z.Z),d=(0,a.yK)((e=>({InviteDropdownMenu:{background:e.cardContentBackground,width:265,borderRadius:8},slackTitle:{display:"flex",fontSize:14,color:e.text.primary},integrationIcon:{marginRight:8},slackButtonContainer:{padding:"0 6px",alignItems:"center"},slackButton:{height:28,borderRadius:4,border:void 0,width:"100%"},helpIcon:{width:16,height:16,fill:e.icon.secondary},helpSection:{color:e.text.secondary,fontSize:12,padding:"0 8px",width:"100%"}})),[]),c=(0,s.useMemo)((()=>(0,D.jsxs)("div",{style:d.slackTitle,children:[(0,D.jsx)(P.Z,{type:"image_url",imageURL:r.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:d.integrationIcon}),(0,D.jsx)(l.FormattedMessage,{defaultMessage:"Slack",id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.slackButtonLabel"})]})),[d]),u={key:"all_import_sections",render:e=>(0,D.jsx)(R.Z,{...e,title:(0,D.jsx)(l.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.title",defaultMessage:"Import from"})}),items:[{key:"slack_imports",render:e=>(0,D.jsx)(k._k,{inviteOrigin:"space_setting_slack_dropdown",canEditPermission:!0,onInviteClick:t,onInviteComplete:n,slackButtonLabel:c,slackButtonStyle:d.slackButton,slackButtonContainerStyle:d.slackButtonContainer}),action:()=>{}}]},m={key:"help_section",render:e=>(0,D.jsx)(R.Z,{...e,topBorder:!0}),items:[{key:"help_section",render:e=>p,action:()=>{}}]},p=(0,D.jsx)(F.Z,{style:{display:"flex",padding:"0 4px"},className:"notion-print-ignore",href:(0,T.UY)("guides.publicAPI"),external:!0,children:(0,D.jsx)(B.Z,{icon:w.m,iconStyle:d.helpIcon,style:d.helpSection,children:(0,D.jsx)(l.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.learnMore",defaultMessage:"Learn more"})})});return(0,D.jsx)(_.Z,{menuType:I.og.Popup,children:(0,D.jsx)(A.Z,{type:A.i.Vertical,store:i,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,sections:[u,m],style:d.InviteDropdownMenu})})}var L=n(760442);function V(e){const{store:t,origin:n}=e,a=(0,i.O7)();(0,s.useEffect)((()=>{g.bi(a)}),[a]);const c=(0,o.qz)(e.permissionsInviteStore,p.Z),f=(0,o.VK)((()=>c.state.modalOpen),[c]),x=(0,o.VK)((()=>Boolean(t.canEditMembership())),[t]),v=(0,o.VK)((()=>x&&(0,m.Mm)(t)&&(0,d.$K)(y.subscriptionDataStoreInstance.state)&&!h.Mk()),[x,t]),b=(0,o.VK)((()=>function(e){let{store:t,canEditMembership:n,showUpgrade:s}=e;if(!n&&(0,m.Mm)(t))return(0,D.jsx)(l.FormattedMessage,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."});if(!n)return(0,D.jsx)(l.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."});if(s)return(0,D.jsx)(L.Z,{imageURL:r.Z.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,D.jsx)(l.FormattedMessage,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:(0,D.jsx)(l.FormattedMessage,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})});return null}({store:t,canEditMembership:x,showUpgrade:v})),[x,v,t]),C=(0,s.useCallback)((()=>async function(e,t,n,s){const i=await(0,u.Aw)({environment:e,permissionsInviteStoreState:n.state,from:s??((0,m.Mm)(t)?"space_share_modal":"page_share_modal")});i||n.reset()}(a,t,c,e.analyticsFrom)),[a,t,c,e.analyticsFrom]),w=(0,s.useCallback)((()=>(0,D.jsx)(j.Z,{...e,permissionsInviteStore:c})),[c,e]);return(0,m.Mm)(t)?(0,D.jsx)(S.Z,{open:f,onDismiss:C,renderContent:w,origin:(0,D.jsx)(M.Z,{renderTooltip:()=>b,disableTooltip:x,render:t=>(0,D.jsx)(E,{permissionsInviteStore:c,tooltipEvents:t,actionEnabled:x,showUpgrade:v,buttonInner:n,...e,...t})})}):(0,D.jsx)(S.Z,{open:f,onDismiss:C,renderContent:w,origin:null})}function E(e){let{tooltipEvents:t,showUpgrade:n,actionEnabled:o,store:r,isSubscribed:d,enableInviteDropdown:m,onInviteClick:p,upgradeButtonName:g,onUpgradeButtonClick:h,shouldGrow:y,buttonStyle:S,permissionsInviteStore:M,buttonInner:j}=e;const w=(0,i.O7)(),k=(0,a.yK)((()=>({button:{flex:y?1:0,...S}})),[S,y]),I=(0,s.useCallback)((()=>function(e,t,n,s){(0,u.z5)({environment:e,permissionsInviteStore:s,store:t,renderInShareModal:!1,isSubscribed:n}),c.L7(e,{type:"invite"})}(w,r,d,M)),[w,r,d,M]),T=(0,s.useCallback)((()=>n?function(e,t,n){f.y(t,{from:e,for:"plus"}),n&&n(),c.L7(t,{type:"upgrade"})}(g,w,h):I()),[w,I,h,n,g]);return j?(0,D.jsx)("div",{onClick:I,children:j}):m?(0,D.jsx)(x.ZP,{popupType:v.kQ.Popup,alignmentToOrigin:x.vR.End,placementToOrigin:x.pO.Bottom,render:()=>(0,D.jsx)(O,{onInviteClick:p}),originGap:12,renderOrigin:e=>(0,D.jsx)(C.Z,{onClick:T,disabled:!o&&!n,style:k.button,title:(0,D.jsx)(l.FormattedMessage,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"}),dropdownEvents:e,color:"blue",...t})}):(0,D.jsx)(b.Z,{isLarge:!0,onClick:T,disabled:!o&&!n,style:k.button,...t,children:(0,D.jsx)(l.FormattedMessage,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"})})}const N=s.memo(V)},735229:(e,t,n)=>{n.d(t,{Z:()=>K});n(757658);var s=n(667294),i=n(800480),o=n(886628),a=n(266897),r=n(519889),l=n(76233),d=n(709291),c=n(653965),u=n(401898),m=n(296994),p=n(823586),g=n(460709),f=n(724405),h=n(133728),y=n(747612),x=n(10020),S=n(781918),v=n(949068),b=n(552275),M=n(231945),j=n(396525),C=n(743765),w=n(672495),k=n(80444),I=n(319385),T=n(655899),Z=n(535057),P=n(222508),F=n(513394),_=n(400135),A=n(785893);function B(e){const t=(0,o.qz)(void 0,T.ZP),n=(0,o.qz)(void 0,F.Z),{store:a,inputValue:l,intl:c,propertySchemaLimit:u,isLoading:m,handlePersonPropertyMenuChange:p}=e,g=(0,i.O7)(),B=(0,f.yK)((e=>({moreBarTitleStyle:{color:e.text.secondary,fontSize:11},inviteIconStyle:{width:20,height:20,fill:e.icon.primary},rightIconStyle:{width:20,height:20,fill:e.icon.secondary},desktopTitleStyle:{color:e.text.secondary,fontSize:11},messageBodyStyle:{color:e.text.tertiary,paddingLeft:2},messageTitleStyle:{color:e.text.tertiary},inviteBodyStyle:{color:e.text.primary}})),[]),{isMobile:R}=(0,i.Fy)(),D=(0,o.VK)((()=>{var e;return null===(e=k.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),O=(0,o.VK)((()=>n.state.flowId),[n]),{email:L,isEmail:V,inviteButtonTitle:E}=(0,s.useMemo)((()=>{const e=(0,h.H3)(l),t=(0,h.oH)(e),n=c.formatMessage({id:"invite.person_property.button.invite_people",defaultMessage:"Invite people"}),s=c.formatMessage({id:"invite.person_property.button.invite_email",defaultMessage:"Invite ”{email}”"},{email:e});return{email:e,isEmail:t,inviteButtonTitle:t?s:n}}),[l,c]),N=(0,s.useCallback)((()=>{V&&L&&P.Co({email:L,inviteTargetsStore:t}),S.P0(g,{origin:"person_property_invite",invite_flow_id:O})}),[V,O,L,g,t]),U=(0,s.useCallback)((()=>{S.Zv(g,{origin:"person_property_invite",invite_flow_id:O})}),[O,g]);return(0,o.VK)((()=>{const e=function(e){const{canAddPermissions:t,isMobile:n}=e,s="enterprise"===e.subscriptionTier;if(n||s||!t)return!1;return"on"===I.default.getEligibleGroup({experimentId:"acq_person_property_invite_v1",defaultGroup:"control"})}({canAddPermissions:a.canEditMembership(),isMobile:R,subscriptionTier:(0,Z.zt)()});return e&&S.x8(g,{origin:"person_property_invite",invite_flow_id:O}),e}),[a,O,R,g])?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(w.Z,{title:(0,A.jsx)(d.FormattedMessage,{defaultMessage:"People",id:"database.personPropertyValue.selectPerson.noSearchResults.resultsTitle"}),desktopTitleStyle:B.desktopTitleStyle,loading:m,desktopStyle:{paddingBottom:4},children:(0,A.jsx)(C.Z,{title:(0,A.jsx)("span",{style:B.messageBodyStyle,children:(0,A.jsx)(d.FormattedMessage,{defaultMessage:"No matches in {spaceName}",id:"database.personPropertyMenu.noSearchResults.messageWithSpaceName",values:{spaceName:D}})}),titleStyle:B.messageTitleStyle})}),(0,A.jsx)(w.Z,{title:(0,A.jsx)(d.FormattedMessage,{defaultMessage:"More",id:"database.personPropertyValue.selectPerson.noSearchResults.suggestionTitle"}),desktopTitleStyle:B.moreBarTitleStyle,topBorder:!0,desktopStyle:{marginTop:0,paddingTop:10},children:(0,A.jsx)(j.Z,{focused:!1,stopClickPropagation:!0,popupType:M.Z4.Popup,renderOrigin:e=>(0,A.jsx)(b.Z,{...e,focused:!1,icon:(0,y.C)(B.inviteIconStyle),title:E,right:(0,x.C)(B.rightIconStyle),textWrapperStyle:B.inviteBodyStyle}),onClick:N,onClose:U,borderRadius:8,render:e=>(0,A.jsx)(_.Z,{inviteOrigin:"person_property_invite",store:a,handleBackButtonClick:()=>e.close(),inviteTargetsStore:t,personPropertyInviteStore:n,onInviteCompleteFn:t=>{e.close();const n=(t.success?Object.values(t.invitedUsers):[]).map((e=>({table:r.KJ,id:e})));p(n)}})})})]}):(0,A.jsx)(w.Z,{title:(0,v.$)(u),loading:m,children:(0,A.jsx)(C.Z,{title:(0,A.jsx)(d.FormattedMessage,{defaultMessage:"No results",id:"database.personPropertyMenu.noSearchResults.message"})})})}var R=n(69582),D=n(478140),O=n(632163),L=n(840721),V=n(992864),E=n(147082),N=n(197680);const U=(0,d.defineMessages)({searchForPerson:{defaultMessage:"Search for a person…",id:"database.personPropertyValue.searchPlaceholder"}});const K=function(e){const t=(0,i.O7)(),n=(0,i.Fy)(),f=(0,d.useIntl)(),{disabled:h,value:y,valueIsUnpersistedDefaultValue:x,onChange:S,propertySchema:M,parentStore:j,onDismiss:k,isTemplatePage:I,insertChar:T}=e,[Z,P]=(0,s.useState)((()=>T||"")),F=(0,s.useCallback)((e=>{1===M.limit&&e.length>0?S({type:"personPropertyMenuUpdateReplacePerson",newValue:e[0]}):S(x?{type:"personPropertyMenuUpdateAddPerson",newValues:[...y,...e]}:{type:"personPropertyMenuUpdateAddPerson",newValues:e}),P("")}),[S,M.limit,y,x]),{tokens:_,selectedTemplateAnnotationVariables:K}=(0,o.VK)((()=>{const e=[];return{tokens:y.map((t=>{if((0,l.D4X)(t))return e.push(t),(0,A.jsx)(R.w,{templateVariableType:t,showRemoveButton:!h,onRemove:()=>{S({type:"personPropertyMenuUpdateRemovePerson",removedValue:t})},style:{margin:"0px 6px 6px 0px"}},t);if((0,a.Wk)(t)){const e=(0,a.Hl)({pointer:t,getRecordValue:j.getRecordValue});return(0,A.jsx)(V.ZP,{actor:e,format:n.isMobile?V.ZP.Format.Large:V.ZP.Format.Medium,showRemoveButton:!h,onClickRemove:()=>{S({type:"personPropertyMenuUpdateRemovePerson",removedValue:t})},shouldShrink:!0,isSingle:!1},t.id)}(0,u.t1)(t)})),selectedTemplateAnnotationVariables:e}}),[n.isMobile,h,S,j.getRecordValue,y]),W=l.s8k.filter((e=>!K.includes(e))),z={request:{query:Z,actors:c.hX(y,a.Wk)},performRequest:async e=>{let{query:n,actors:s}=e;const i=await m.FF.searchActions.load(),{users:o}=await i.searchSpaceActors({environment:t,query:n,membersOnly:!1});return{users:o.filter((e=>!s.some((t=>t.id===e.id)))).slice(0,20)}},render:(e,t,n)=>{if(e)return(0,A.jsx)(w.Z,{title:(0,v.$)(M.limit),loading:!n,children:(0,A.jsx)(C.Z,{title:(0,A.jsx)(d.FormattedMessage,{defaultMessage:"Something went wrong.",id:"database.personPropertyMenu.searchErrorMessage"})})});if(t&&0===t.users.length)return(0,A.jsx)(B,{store:j,inputValue:Z,intl:f,propertySchemaLimit:M.limit,isLoading:!n,handlePersonPropertyMenuChange:e=>{F(e)}});const s=c.oA((t&&t.users||[]).map((e=>{const t={key:e.id,render:t=>(0,A.jsx)(N.Z,{...t,actor:(0,a.dp)(e)}),action:()=>{F([{table:r.KJ,id:e.id}])}};return t}))),i=c.oA([s.length>0?{key:"person section",render:e=>(0,A.jsx)(w.Z,{...e,title:(0,v.$)(M.limit),loading:!n}),items:s}:void 0]);return(0,A.jsx)(O.Z,{type:O.i.Vertical,initialFocus:Z.length>0?0:void 0,sections:i})}},q=(0,A.jsx)(E.ZP,{focus:!n.isMobile||void 0,focusAfterAnimation:!0,format:E.UR.Person,tokens:_,placeholder:f.formatMessage(U.searchForPerson),hideInput:h,onRemoveLastToken:()=>{S({type:"personPropertyMenuUpdateRemovePerson",removedValue:y[y.length-1]})},value:Z,onChange:e=>P(e.target.value),dontShowBorderBottom:n.isAndroid});let G;return G=n.isMobile?{menuType:g.og.Modal,title:M.name,right:(0,A.jsx)(L.DoneMenuText,{}),onClickRight:k,header:q}:{menuType:g.og.Popup,header:q,tokenInputHeader:!0,maxHeight:333},h?(0,A.jsx)(D.Z,{...G}):(0,A.jsxs)(D.Z,{...G,children:[I&&(0,A.jsx)(w.Z,{title:(0,A.jsx)(d.FormattedMessage,{defaultMessage:"Shortcuts",id:"PersonPropertyMenu.menuItem.shortcuts.label"}),children:W.length>0?(0,A.jsx)(s.Fragment,{children:W.map((e=>(0,A.jsx)(b.Z,{focused:!1,title:(0,A.jsx)(R.w,{templateVariableType:e}),caption:(0,l.Z08)(e,f),inline:!0,onClick:()=>{F([e])}},`relative-person-shortcut-${e}`)))}):(0,A.jsx)(C.Z,{title:(0,A.jsx)(d.FormattedMessage,{id:"database.personPropertyMenu.noShorcuts.message",defaultMessage:"No shortcuts"})})}),(0,A.jsx)(p.Z,{...z})]})}},486326:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ie});var s=n(667294),i=n(800480),o=n(886628),a=n(815145),r=n(686658),l=n(715769),d=n(388437),c=n(443876),u=n(727714),m=n(745238),p=n(785893);const g=(0,m.IU)("loginArrow",{viewBox:"0 0 16 12",svg:(0,p.jsx)("path",{d:"M8.65 11.116a.615.615 0 00.444-.184l4.546-4.54a.66.66 0 00.205-.39v4.526c0 .349.253.588.608.588.356 0 .615-.239.615-.588V1.361a.59.59 0 00-.615-.608.585.585 0 00-.608.608v4.512a.698.698 0 00-.205-.396L9.094.944a.623.623 0 00-.445-.191.58.58 0 00-.594.588c0 .164.054.328.164.437L9.75 3.33l2.242 2.05-1.456-.054h-9.01c-.355 0-.601.253-.601.609 0 .355.246.615.601.615h9.01L12 6.495 9.75 8.54l-1.531 1.559a.616.616 0 00-.164.43c0 .342.26.588.594.588z"})});var f=n(460651),h=n(725651),y=n(418442),x=n(405829),S=n(89101),v=n(709291),b=n(632441),M=n(800893),j=n(403297),C=n(885958),w=n(569915),k=n(29974),I=n(110182),T=n(693405),Z=n(672495),P=n(119037),F=n(484210),_=n(433929),A=n(80444),B=n(482763),R=n(62967);const D=(0,m.IU)("reportPage",{viewBox:"0 0 13 14",svg:(0,p.jsx)("path",{d:"M.832 13.846c.349 0 .636-.28.636-.636V9.47a4.696 4.696 0 011.634-.273c2.488 0 4.156 1.244 6.562 1.244 1.053 0 1.538-.13 2.065-.376.492-.218.779-.622.779-1.25v-6.81c0-.45-.349-.73-.814-.73-.39 0-1.005.26-2.098.26C7.216 1.534 5.515.29 3.033.29 2.001.29 1.53.42.976.666.49.892.189 1.247.189 1.869V13.21c0 .349.294.636.643.636zm8.805-4.703c-2.215 0-3.931-1.238-6.508-1.238-.663 0-1.265.075-1.627.212v-6.07c.123-.198.629-.465 1.552-.465 2.33 0 4.047 1.244 6.514 1.244.657 0 1.21-.075 1.627-.191v6.05c-.116.198-.635.458-1.558.458z",fill:"#ED6A5F"})});var O=n(531701),L=n(800360);const V=(0,v.defineMessages)({reportPageName:{id:"action.reportPage.name",defaultMessage:"Report page"}}),E=(0,R.cN)({key:"action report page",displayName:V.reportPageName,analyticsName:V.reportPageName.defaultMessage,validators:[P.Ggh,P.iKo,P.Id2],closeParentMenu:!0,render:e=>(0,p.jsx)(T.Z,{...e,style:{color:O.ZP.red},svg:D,title:(0,p.jsx)(v.FormattedMessage,{...V.reportPageName})}),action:e=>{let{blocks:t,environment:n}=e;L.l()}}),N=(0,v.defineMessages)({signUpOrLogInName:{id:"action.signUpOrlogIn.name",defaultMessage:"Sign up or log in"},shareLinkName:{id:"action.shareLink.name",defaultMessage:"Share link"},editPageName:{id:"action.editPage.name",defaultMessage:"Edit"},commentPageName:{id:"action.commentPage.name",defaultMessage:"Comment"},duplicatePageName:{id:"action.duplicatePage.name",defaultMessage:"Duplicate page"},backtoNotionName:{id:"action.backtoNotion.name",defaultMessage:"Back to Notion"}}),U=(0,R.cN)({key:"log in",displayName:N.signUpOrLogInName,analyticsName:N.signUpOrLogInName.defaultMessage,svg:g,validators:[P.ffD(P.jlf)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;b.RK(t),await w.yF(t,{utmContent:"sign_up_or_log_in",nextRoute:S._j.login})}}),K=(0,R.cN)({key:"ios share link",displayName:N.shareLinkName,analyticsName:N.shareLinkName.defaultMessage,svg:c.s,validators:[P.U7o,P.Fxc,P.gnQ],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const s=t[0],i=s.getNavigableBlockStore();if(i){const e=(0,F.ZP)({store:i,scrollToBlockId:i.id===s.id?void 0:s.id,fullyQualified:!0,pageVisitSource:a.tY.NativeShareLink});n.mobileNative&&n.mobileNative.share(e)}}}),W=(0,R.cN)({key:"android share link",displayName:N.shareLinkName,analyticsName:N.shareLinkName.defaultMessage,svg:l.Q,validators:[P.U7o,P.Fxc,P.DtP],closeParentMenu:K.closeParentMenu,action:K.action}),z=(0,R.cs)({key:"copy link",displayName:R.RE.copyLinkName,analyticsName:R.RE.copyLinkName.defaultMessage,svg:u.N,shortcuts:["copyLinkToBlock"],validators:[P.jlf,P.U7o,P.ffD(P.Fxc),P.ffD(P.DFt)],closeParentMenu:!0,action:(e,t)=>{M.Hs({...e,event:t})}}),q=(0,R.cN)({key:"edit page",displayName:N.editPageName,analyticsName:N.editPageName.defaultMessage,svg:h.R,validators:[P.U7o,P.DFt,P.Zk8,P.ffD(P.eMw),P.or([P.tqC,P.TRi])],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;C.qc(t,n[0].id)}}),G=(0,R.cN)({key:"comment page",displayName:N.commentPageName,analyticsName:N.commentPageName.defaultMessage,svg:x.s,validators:[P.U7o,P.DFt,P.RFc,P.ffD(P.jlf),P.or([P.tqC,P.TRi])],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;C.TX(t,n[0].id)}}),H=(0,R.cN)({key:"fork page",displayName:N.duplicatePageName,analyticsName:N.duplicatePageName.defaultMessage,svg:d.a,validators:[P.U7o,P.tqC,P.DFt,P.S4z],closeParentMenu:!0,action:e=>{let{blocks:t,originRect:n,environment:s}=e;j.S({environment:s,store:t[0],originRect:n})}}),$=(0,R.cN)({key:"back to my content",displayName:N.backtoNotionName,analyticsName:N.backtoNotionName.defaultMessage,svg:f.h,validators:[P.jlf,P.tqC],closeParentMenu:!0,action:(e,t)=>{let{environment:n}=e;const{currentUserRootStore:s,currentUserSettingsStore:i}=A.default.state;s&&i&&k.L5({environment:n,userRootStore:s,userSettingsStore:i,pageVisitSource:a.tY.SwitchSpace})}}),Y=(0,R.cN)({key:"cookie settings",displayName:r.ze.cookieSettingsLabel,analyticsName:r.ze.cookieSettingsLabel.defaultMessage,validators:[P.ffD(P.tYA)],closeParentMenu:!1,render:e=>(0,p.jsx)(I.Z,{hasDismissButton:!1,renderOrigin:t=>{const{onClick:n,...s}=e;return(0,p.jsx)(T.Z,{...s,...t,title:_.default.formatMessage(r.ze.cookieSettingsLabel),svg:y.H})}}),action:()=>{}}),Q=[(0,R.$J)({key:"page",render:e=>(0,p.jsx)(Z.Z,{...e}),actions:[q,G,H,z,B.K,K,W]}),(0,R.$J)({key:"user",render:e=>(0,p.jsx)(Z.Z,{...e}),actions:[$,U]}),(0,R.$J)({key:"report page actions",render:e=>(0,p.jsx)(Z.Z,{...e}),actions:[E,Y]})];var J=n(436610),X=n(460709),ee=n(635328),te=n(896026),ne=n(748019),se=n(478140);const ie=function(e){let{blockStore:t,onDismiss:n}=e;const a=(0,i.O7)(),{device:r}=a,l=(0,o.VK)((()=>te.Z.getMode(a,t)),[a,t]),d={environment:a,blocks:[t],publicEditMode:l};let c;c=r.isMobile?{menuType:X.og.ActionSheet}:{menuType:X.og.Popup,width:210,maxHeight:"80vh"};const u=(0,s.useCallback)((e=>{const{mainEditorCurrentBlockStore:t}=A.default.state;if(t){const n=t.getType();var s;if(n)J.dh(a,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"public_topbar_more_menu",block_id:t.id,block_type:n,is_toggleable:(0,ee._A)(n,t.getFormat()),collection_id:null===(s=t.getCollectionViewCollectionStore())||void 0===s?void 0:s.id,parent_collection_id:t.getParentCollectionIdUpToTwoLevels()})}e.closeParentMenu&&n()}),[a,n]),m=Q;return(0,p.jsx)(se.Z,{...c,children:(0,p.jsx)(ne.Z,{sections:m,onAccept:u,context:d})})}},55880:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});n(667294);var s=n(800480),i=n(886628),o=n(724405),a=n(745238),r=n(785893);const l=(0,a.IU)("thanksShield",{viewBox:"0 0 27 32",svg:(0,r.jsx)("path",{d:"M13.5 31.672c.281 0 .672-.125 1.031-.328 8.75-5.063 11.64-6.969 11.64-12.344V7.125c0-1.672-.624-2.219-2.062-2.797-2.218-.89-7.14-2.719-9.375-3.484-.406-.14-.828-.235-1.234-.235-.422 0-.844.11-1.25.235-2.219.719-7.156 2.61-9.375 3.484C1.437 4.891.812 5.453.812 7.125V19c0 5.375 2.922 7.234 11.641 12.344.36.203.75.328 1.047.328zm0-2.14c-.266 0-.547-.126-.922-.36-7.25-4.5-9.844-5.797-9.844-10.547V7.485c0-.782.141-1.063.735-1.298 2.078-.828 7.187-2.656 9.281-3.468.281-.125.547-.188.75-.188.188 0 .438.078.75.188 2.078.812 7.156 2.703 9.266 3.469.593.218.734.515.734 1.296v11.141c0 4.75-2.625 6.016-9.844 10.547-.375.234-.656.36-.906.36zm-1.688-6.75c.391 0 .72-.188.954-.548l7.593-11.859c.141-.234.282-.5.282-.75 0-.531-.485-.906-.985-.906-.312 0-.61.203-.843.547L11.75 20.437 8.156 16c-.281-.375-.562-.484-.89-.484a.944.944 0 00-.938.953c0 .265.11.531.281.765l4.188 5c.297.391.61.547 1.015.547z",fill:"#636363"})});var d=n(709291);const c=(0,d.defineMessages)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"}});var u=n(531701),m=n(137810),p=n(454642),g=n(547307),f=n(800360),h=n(628020),y=n(433929),x=n(460709),S=n(918514),v=n(788632),b=n(625399),M=n(436488),j=n(374194),C=n(478140),w=n(828992),k=n(632163),I=n(617293),T=n(863296),Z=n(672495),P=n(292660),F=n(474523),_=n(306202);const A={fontSize:16,marginBottom:12,fontWeight:m.Z.fontWeight.medium},B=(0,d.defineMessages)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Add additional information (optional)"},dialogLabel:{id:"reportPage.dialogLabel",defaultMessage:"Report page"}});const R=function(){const e=(0,i.VK)((()=>b.Z.state.open),[]);return(0,r.jsx)(P.Z,{ariaLabel:y.default.formatMessage(B.dialogLabel),onDismiss:U,render:()=>(0,r.jsx)(z,{}),isOpen:e})};function D(){const{state:e}=b.Z;if(e.open){const{reason:t}=e;return void 0!==t}return!1}function O(e){let{modalState:t}=e;const{reason:n}=t;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I.Z,{title:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===n,onClick:()=>b.Z.setState({...t,reason:"phishing_or_spam"}),name:"report-page-modal"},"phishing_or_spam"),(0,r.jsx)(I.Z,{title:y.default.formatMessage(c.inappropriate_content),isSelected:"inappropriate_content"===n,onClick:()=>b.Z.setState({...t,reason:"inappropriate_content"}),name:"report-page-modal"},"inappropriate_content"),(0,r.jsx)(I.Z,{title:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===n,onClick:()=>b.Z.setState({...t,reason:"other_content_policy_violation"}),name:"report-page-modal"},"other_content_policy_violation")]})}async function L(e){const t=b.Z.getState();if(!t.open)return;const{additionalInformation:n,reason:s}=t,i=(0,h.Fv)();if(!s||null==i||!i.id)return void g.showErrorMessage((0,r.jsx)(d.FormattedMessage,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const o=await p.reportPage(e,{reason:s,page:i,additionalInformation:n});"failed"===o.type?g.showError(o):(b.Z.setState({open:!1}),g.showMessage({message:(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[l({width:40}),(0,r.jsx)("div",{style:{paddingTop:12,paddingBottom:8,fontSize:"large",textAlign:"center"},children:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."})})]})})}))}function V(e){return{width:360,padding:24,fontSize:14,color:e.mediumTextColor}}function E(e,t){const{device:n}=e;return{width:"100%",background:t.popoverBackground,display:"block",padding:n.isMobile?16:"10px 12px",height:n.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:n.isMobile?16:14}}function N(){const e=(0,o.Fg)();return(0,r.jsx)("div",{style:V(e),children:(0,r.jsx)(d.FormattedMessage,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"})})}function U(){f.q()}function K(e){let{modalState:t}=e;const n=(0,o.Fg)(),i=(0,s.O7)();if(!t.open)return null;const{reason:a}=t,l={menuType:x.og.Modal,title:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:U};return(0,r.jsx)(C.Z,{...l,children:(0,r.jsx)(k.Z,{type:k.i.Vertical,initialFocus:void 0,sections:[{key:"help",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(Z.Z,{...n,children:t})},items:[{key:"help",render:()=>(0,r.jsx)(w.Z,{title:(0,r.jsx)(F.Z,{title:(0,r.jsx)(d.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,S.UY)("contentPolicy"),analyticsFrom:"report_page"}),right:(0,r.jsx)(r.Fragment,{}),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(Z.Z,{...n,children:t})},items:[{key:"options",render:()=>(0,r.jsx)(O,{modalState:t}),action:()=>{}},{key:"additionalInfo",render:()=>a&&(0,r.jsx)(j.Z,{textarea:!0,style:E(i,n),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:y.default.formatMessage(B.additionalInformationPlaceholder),onChange:e=>{b.Z.setState({...t,additionalInformation:e.target.value})}}),action:()=>{}}]},{key:"actions",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(Z.Z,{isSubmitButton:!0,...n,children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...n}=e;return(0,r.jsx)(_.Z,{...n,disabled:!D(),title:(0,r.jsx)("div",{style:{color:u.ZP.red},children:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})}),onClick:t||L})},action:()=>L(i)}]}]},"main list")})}function W(e){let{modalState:t}=e;const n=(0,o.Fg)(),i=(0,s.O7)();if(!t.open)return null;const{reason:a}=t;return(0,r.jsx)(M.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>(0,r.jsxs)("div",{style:{width:360,padding:24,fontSize:14},children:[(0,r.jsx)("div",{style:A,children:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})}),(0,r.jsx)("div",{style:{paddingBottom:12},children:(0,r.jsx)(F.Z,{title:(0,r.jsx)(d.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,S.UY)("contentPolicy"),analyticsFrom:"report_page"})}),(0,r.jsx)("div",{children:(0,r.jsx)(O,{modalState:t})}),a&&(0,r.jsx)(j.Z,{textarea:!0,style:E(i,n),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:y.default.formatMessage(B.additionalInformationPlaceholder),onChange:e=>{b.Z.setState({...t,additionalInformation:e.target.value})}}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,r.jsx)(T.Z,{isLarge:!0,onClick:U,style:{marginRight:12},children:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})}),(0,r.jsx)(T.Z,{isRed:!0,isLarge:!0,onClick:()=>L(i),disabled:!D(),disabledFeedback:!0,children:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})})]})]})})}function z(){const e=(0,s.O7)(),{device:t}=e,n=(0,i.VK)((()=>v.Z.state.online),[]),o=(0,i.VK)((()=>b.Z.state),[]);return n?o.open?t.isMobile?(0,r.jsx)(K,{modalState:o}):(0,r.jsx)(W,{modalState:o}):null:(0,r.jsx)(N,{})}},118168:(e,t,n)=>{n.d(t,{Z:()=>d});n(667294);var s=n(724405),i=n(825464),o=n(164921),a=n(526388),r=n(785893);function l(e){const{isFirst:t,isLast:n,isSelected:l,item:d,itemStyle:c,innerStyle:u,children:m,colors:p,onClick:g}=e,{isDisabled:f,tooltip:h}=d,y=(0,s.yK)((e=>{const s=(null==p?void 0:p.selectedOutline)??e.blueColor,i=(null==p?void 0:p.unselectedOutline)??e.accentColors.gray[100];return{SegmentedItem:{alignItems:"center",background:l?null==p?void 0:p.selectedBackground:void 0,borderBottomLeftRadius:t?3:0,borderBottomRightRadius:n?3:0,borderColor:l?s:i,borderStyle:"solid",borderTopLeftRadius:t?3:0,borderTopRightRadius:n?3:0,borderWidth:1,cursor:f?void 0:"pointer",display:"flex",flexBasis:"50%",marginLeft:t?0:-1,padding:0,userSelect:"none",zIndex:l?10:0,...c},Inner:{borderBottomLeftRadius:t?2:0,borderBottomRightRadius:n?2:0,borderColor:l?s:"transparent",borderStyle:"solid",borderTopLeftRadius:t?2:0,borderTopRightRadius:n?2:0,borderWidth:1,display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",padding:"12px 20px",textAlign:"center",width:"100%",...u}}}),[null==p?void 0:p.selectedBackground,null==p?void 0:p.selectedOutline,null==p?void 0:p.unselectedOutline,t,n,l,f,c,u]),x=()=>{g&&g(d.key)};return(0,r.jsx)(a.Z,{render:e=>(0,r.jsx)(o.Z,{ariaLabel:d.ariaLabel,"aria-pressed":l,onClick:x,style:y.SegmentedItem,disabled:f,...e,children:(0,r.jsx)("div",{style:y.Inner,children:m})}),renderTooltip:()=>(0,r.jsx)("div",{children:h}),disableTooltip:l||void 0===h,placement:i.u.Bottom})}function d(e){const{items:t=[],itemStyle:n,innerStyle:i,value:o,onChange:a,colors:d}=e,c=(0,s.yK)((e=>({SegmentedButton:{background:e.cardContentBackground,display:"flex",width:"100%"}})),[]);return 0===t.length?null:(0,r.jsx)("div",{style:c.SegmentedButton,children:t.map(((e,s)=>(0,r.jsx)(l,{isFirst:0===s,isLast:s===t.length-1,isSelected:e.key===o,item:e,itemStyle:n,innerStyle:i,colors:d,onClick:a,children:e.render()},e.key)))})}},317293:(e,t,n)=>{n.d(t,{Z:()=>V});n(757658);var s=n(443261),i=n.n(s),o=n(667294),a=n(883355),r=n(800480),l=n(886628),d=n(399036),c=n(180951),u=n(984619),m=n(471924),p=n(606287),g=n(709291),f=n(653965),h=n(215828),y=n(401898),x=n(436610),S=n(110906),v=n(566890),b=n(368585),M=n(460709),j=n(229798),C=n(749085);class w extends C.default{getInitialState(){return{inputValue:"",openPropertyActionMenu:void 0}}}const k=w;var I=n(552275),T=n(279131),Z=n(478140),P=n(632163),F=n(743765),_=n(840721),A=n(672495),B=n(593896),R=n(122084),D=n(147082),O=n(785893);class L extends a.Z{constructor(){super(...arguments),this.storeTypes={store:k,menuListStore:j.Z},this.createSelectColorRef={current:void 0}}UNSAFE_willMount(e){if(q(this.props.schema,this.props.property,this.createSelectColorRef),e.insertChar){const t=e.insertChar;this.stores.store.setState({...this.stores.store.state,inputValue:t})}}renderComponent(){const{device:e}=this.environment,{disabled:t,canConfigureCollection:n,autofillExplanation:s,bulkAutofillButton:o}=this.props,a=this.props.schema[this.props.property];if(!a)return;if(!d.cu(a))return;const r=a.options||[],l=this.renderCurrentTokens(r),c=function(e,t,n){const s=t.map((e=>e.value));let o;if(e){o=i().filter(e,s).map((e=>e.original));!t.find((t=>t.value===e))&&e.trim().length>0&&n&&o.push(e.trim().replace(/,/g,""))}else o=s;return o}(this.stores.store.state.inputValue,r,this.props.canConfigureCollection),u=a.select_ai_inference,m=0===c.length,p=(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(D.ZP,{focus:e.isMobile?void 0:!this.stores.store.state.openPropertyActionMenu,focusAfterAnimation:!0,format:D.UR.Select,tokens:l,placeholder:null!=u&&u.auto_update_on_edit?this.props.intl.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder.aiAutoUpdate",defaultMessage:"Empty"}):this.props.intl.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder",defaultMessage:"Search for an option..."}),onRemoveLastToken:()=>{G({type:"removeToken",removedToken:this.props.value[this.props.value.length-1]},this.environment,this.props.collectionId,this.props.allowMultiple,this.props.property,this.props.schema,this.props.onChange,this.props.analyticsFrom,this.stores.store,this.createSelectColorRef,this.context.collectionContextStore)},value:this.stores.store.state.inputValue,disabled:t,hideInput:!1,onChange:e=>this.stores.store.setState({...this.stores.store.state,inputValue:e.target.value}),dontShowBorderBottom:e.isAndroid}),s]});let g;return g=e.isMobile?{menuType:M.og.Modal,title:a.name,right:(0,O.jsx)(_.DoneMenuText,{}),onClickRight:this.props.onDismiss,header:p,footer:o}:{menuType:M.og.Popup,header:p,tokenInputHeader:!0,footer:o},t?(0,O.jsx)(Z.Z,{...g}):(0,O.jsx)(Z.Z,{...g,children:m?(0,O.jsx)(A.Z,{title:n?(0,O.jsx)(U,{}):(0,O.jsx)(E,{}),children:e.isMobileNative&&(0,O.jsx)(F.Z,{title:(0,O.jsx)(E,{})})}):(0,O.jsx)(P.Z,{type:P.i.Vertical,initialFocus:this.stores.store.state.inputValue.length>0?0:void 0,sections:[{key:1,render:e=>(0,O.jsx)(W,{collectionId:this.props.collectionId,property:this.props.property,schema:this.props.schema,onChange:this.props.onChange,canConfigureCollection:this.props.canConfigureCollection,menuListStore:this.stores.menuListStore,args:e,tokens:c}),items:H(c,r,this.environment,this.props.schema,this.props.property,this.props.canConfigureCollection,this.props.analyticsFrom,this.props.collectionId,this.props.value,this.props.onChange,this.props.allowMultiple,this.stores.store,this.createSelectColorRef,this.context.collectionContextStore)}],onAccept:(e,t,n)=>{this.props.onAccept(n)},store:this.stores.menuListStore})})}renderCurrentTokens(e){const{disabled:t}=this.props,{device:n}=this.environment;return f.oA(this.props.value.map((s=>{const i=(0,c.i7)(e,s);if(i)return(0,O.jsx)(R.a,{value:i.value,color:i.color,showRemoveButton:!t,isSingle:!1,format:n.isMobile?u.lo.Large:u.lo.Medium,shouldShrink:!0,onClickRemove:()=>{G({type:"removeToken",removedToken:s},this.environment,this.props.collectionId,this.props.allowMultiple,this.props.property,this.props.schema,this.props.onChange,this.props.analyticsFrom,this.stores.store,this.createSelectColorRef,this.context.collectionContextStore)},showEllipsis:!0},i.id)})))}}L.displayName="SelectPropertyMenu",L.contextTypes={...a.w,...v.xm};const V=(0,g.injectIntl)(L);function E(){return(0,O.jsx)(g.FormattedMessage,{id:"database.selectPropertyEditMenu.noResults",defaultMessage:"No options found"})}function N(){return(0,O.jsx)(g.FormattedMessage,{id:"database.selectPropertyEditMenu.selectOnlyPrompt",defaultMessage:"Select an option"})}function U(){return(0,O.jsx)(g.FormattedMessage,{id:"database.selectPropertyEditMenu.selectOrCreatePrompt",defaultMessage:"Select an option or create one"})}function K(e){let{props:t,newOption:n,token:s}=e;const i=(0,r.O7)(),{device:o}=i;return(0,O.jsx)(I.Z,{...t,title:(0,O.jsxs)("div",{style:{display:"flex",minWidth:0},children:[(0,O.jsx)("div",{style:{marginRight:6,lineHeight:1.3},children:(0,O.jsx)(g.FormattedMessage,{id:"database.selectPropertyEditMenu.createLabel",defaultMessage:"Create"})}),(0,O.jsx)(R.a,{value:n.value,color:n.color,showRemoveButton:!1,isSingle:!0,format:o.isMobile?u.lo.Large:u.lo.Medium,showEllipsis:!0})]}),isTokenTitle:!0})}function W(e){let{args:t,tokens:n,collectionId:s,property:i,schema:a,onChange:r,canConfigureCollection:l,menuListStore:c}=e;const u=(0,o.useCallback)((e=>function(e,t,n,s,i,o){const a=(0,S.YL)({newOptions:e,collectionId:t,property:n,schema:s});if(a){const e=s[n];e&&d.cu(e)&&"manual"!==(e.auto_sort_options||"manual")&&a.push({pointer:{table:p.vF,id:t},command:"update",path:["schema",n],args:{auto_sort_options:"manual"}}),i({type:"selectPropertyMenuUpdateSchema",schemaOperations:a})}o.reset()}(e,s,i,a,r,c)),[s,i,a,r,c]);return l?(0,O.jsx)(A.Z,{...t,title:(0,O.jsx)(U,{}),children:(0,O.jsx)(T.ZP,{direction:"vertical",keys:n,renderKey:e=>t.children[n.indexOf(e)],onDrop:u})}):(0,O.jsx)(A.Z,{...t,title:(0,O.jsx)(N,{}),children:t.children})}const z=o.forwardRef((function(e,t){let{props:n,option:s,schema:i,property:a,canConfigureCollection:c,analyticsFrom:u,collectionId:m,value:p,onChange:g,store:h}=e;const y=(0,r.Fy)(),x=(0,o.useCallback)((e=>function(e,t){t.setState({...t.state,openPropertyActionMenu:e})}(e,h)),[h]),S=(0,o.useCallback)((()=>function(e){e.setState({...e.state,openPropertyActionMenu:void 0})}(h)),[h]),v=(0,l.VK)((()=>h.state.openPropertyActionMenu===s.value),[h,s]),b=i[a];return b&&d.cu(b)?(0,O.jsx)(B.Z,{...n,ref:t,option:s,showDragHandle:c&&!y.isMobile,locked:!c,property:a,analyticsFrom:u,collectionId:m,onChange:e=>function(e,t,n,s,i){const o=n[t];if(!o)return;if(!d.cu(o))return;const a=o.options||[],r=[...a],l=s.filter((e=>{const t=a.find((t=>t.value===e));return!t||r.some((e=>e.id===t.id))}));let c;c=f.Xy(l,s)?{type:"selectPropertyMenuUpdateSchema",schemaOperations:e}:{type:"selectPropertyMenuUpdateReplaceOptions",options:l,schemaOperations:e},i(c)}(e,a,i,p,g),actionMenuOpen:v,propertySchema:b,onCloseActionMenu:S,onOpenActionMenu:x}):null}));function q(e,t,n){const s=e[t];if(!s)return;if(!d.cu(s))return;const i=s.options||[],o=(0,d.TL)(i);n.current=o}function G(e,t,n,s,i,o,a,r,l,c,u){l.setState({...l.state,inputValue:""});const g=o[i];if(!g)return;if(!d.cu(g))return;const f=g.options||[];let h;if("removeToken"===e.type)h={type:"selectPropertyMenuUpdateRemoveOption",removeOption:e.removedToken};else if("addTokens"===e.type){let a;s?(a=e.newTokens,h={type:"selectPropertyMenuUpdateAddOptions",addOptions:a}):(a=e.newTokens.length>0?[e.newTokens[e.newTokens.length-1]]:[],h={type:"selectPropertyMenuUpdateReplaceOptions",options:a});const l=a.find((e=>!f.find((t=>t.value===e))));if(l){const e={id:m.Il(),value:l,color:c.current};let s;s="alphabetical"===g.auto_sort_options||"reverse_alphabetical"===g.auto_sort_options?[(0,S.Ch)({collectionId:n,property:i,propertySchema:g,newOption:e,isAscending:"alphabetical"===g.auto_sort_options})]:[{pointer:{table:p.vF,id:n},command:"keyedObjectListAfter",path:["schema",i,"options"],args:{value:e}}],h.schemaOperations=s,q(o,i,c),x.$q(t,{...(0,b.Pn)(u),property_type:g.type,action:"select_add_option",from:r})}}else(0,y.t1)(e);a(h)}function H(e,t,n,s,i,o,a,r,l,d,c,u,m,p){return e.map((e=>{const g=t.find((t=>t.value===e));return{key:e,render:t=>{if(g)return(0,O.jsx)(z,{schema:s,property:i,canConfigureCollection:o,analyticsFrom:a,collectionId:r,value:l,onChange:d,store:u,props:t,option:g});{const n={id:(0,h.ZP)(),value:e,color:m.current};return(0,O.jsx)(K,{props:t,newOption:n,token:e})}},action:()=>{l.includes(e)||G({type:"addTokens",newTokens:[e]},n,r,c,i,s,d,a,u,m,p)}}}))}},915595:(e,t,n)=>{n.d(t,{Z:()=>A});n(757658);var s=n(443261),i=n.n(s),o=n(667294),a=n(800480),r=n(399036),l=n(180951),d=n(984619),c=n(471924),u=n(606287),m=n(709291),p=n(653965),g=n(215828),f=n(401898),h=n(436610),y=n(110906),x=n(566890),S=n(368585),v=n(460709),b=n(229798),M=n(552275),j=n(279131),C=n(478140),w=n(632163),k=n(743765),I=n(840721),T=n(672495),Z=n(593896),P=n(122084),F=n(147082),_=n(785893);function A(e){const{allowMultiple:t,analyticsFrom:n,autofillExplanation:s,bulkAutofillButton:g,canConfigureCollection:M,collectionId:j,disabled:Z,insertChar:A,onAccept:R,onChange:O,onDismiss:V,property:U,schema:K,value:W}=e,z=(0,a.O7)(),{device:q}=z,G=(0,m.useIntl)(),H=(0,o.useRef)(void 0),$=(0,x.Y$)(),Y=(0,o.useMemo)((()=>new b.Z),[]),[Q,J]=(0,o.useState)(""),[X,ee]=(0,o.useState)(void 0);(0,o.useEffect)((()=>{E(K,U,H),A&&J(A)}),[]);const te=(0,o.useCallback)((e=>function(e){const{change:t,allowMultiple:n,analyticsFrom:s,collectionContextStore:i,collectionId:o,createSelectColorRef:a,environment:l,onChange:d,property:m,schema:p,setInputValue:g}=e;g("");const x=p[m];if(!x)return;if(!r.cu(x))return;const v=x.options||[];let b;if("removeToken"===t.type)b={type:"selectPropertyMenuUpdateRemoveOption",removeOption:t.removedToken};else if("addTokens"===t.type){let e;n?(e=t.newTokens,b={type:"selectPropertyMenuUpdateAddOptions",addOptions:e}):(e=t.newTokens.length>0?[t.newTokens[t.newTokens.length-1]]:[],b={type:"selectPropertyMenuUpdateReplaceOptions",options:e});const r=e.find((e=>!v.find((t=>t.value===e))));if(r){const e={id:c.Il(),value:r,color:a.current};let t;t="alphabetical"===x.auto_sort_options||"reverse_alphabetical"===x.auto_sort_options?[(0,y.Ch)({collectionId:o,property:m,propertySchema:x,newOption:e,isAscending:"alphabetical"===x.auto_sort_options})]:[{pointer:{table:u.vF,id:o},command:"keyedObjectListAfter",path:["schema",m,"options"],args:{value:e}}],b.schemaOperations=t,E(p,m,a),h.$q(l,{...(0,S.Pn)(i),property_type:x.type,action:"select_add_option",from:s})}}else(0,f.t1)(t);d(b)}({allowMultiple:t,analyticsFrom:n,collectionContextStore:$,collectionId:j,createSelectColorRef:H,environment:z,onChange:O,property:U,schema:K,setInputValue:J,...e})),[t,n,$,j,z,O,U,K]),ne=(0,o.useCallback)((e=>p.oA(W.map((t=>{const n=(0,l.i7)(e,t);if(n)return(0,_.jsx)(P.a,{value:n.value,color:n.color,showRemoveButton:!Z,isSingle:!1,format:q.isMobile?d.lo.Large:d.lo.Medium,shouldShrink:!0,onClickRemove:()=>{te({change:{type:"removeToken",removedToken:t}})},showEllipsis:!0},n.id)})))),[q.isMobile,Z,te,W]),se=(0,o.useCallback)((e=>{ee(e)}),[]),ie=K[U];if(!ie)return null;if(!r.cu(ie))return null;const oe=ie.options||[],ae=function(e,t,n){const s=t.map((e=>e.value));let o;if(e){o=i().filter(e,s).map((e=>e.original));!t.find((t=>t.value===e))&&e.trim().length>0&&n&&o.push(e.trim().replace(/,/g,""))}else o=s;return o}(Q,oe,M),re=ne(oe),le=ie.select_ai_inference,de=0===ae.length,ce=(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(F.ZP,{focus:q.isMobile?void 0:!X,focusAfterAnimation:!0,format:F.UR.Select,tokens:re,placeholder:null!=le&&le.auto_update_on_edit?G.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder.aiAutoUpdate",defaultMessage:"Empty"}):G.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder",defaultMessage:"Search for an option..."}),onRemoveLastToken:()=>{te({change:{type:"removeToken",removedToken:W[W.length-1]}})},value:Q,disabled:Z,hideInput:!1,onChange:e=>J(e.target.value),dontShowBorderBottom:q.isAndroid}),s]});let ue;return ue=q.isMobile?{menuType:v.og.Modal,title:ie.name,right:(0,_.jsx)(I.DoneMenuText,{}),onClickRight:V,header:ce,footer:g}:{menuType:v.og.Popup,header:ce,tokenInputHeader:!0,footer:g},Z?(0,_.jsx)(C.Z,{...ue}):(0,_.jsx)(C.Z,{...ue,children:de?(0,_.jsx)(T.Z,{title:M?(0,_.jsx)(D,{}):(0,_.jsx)(B,{}),children:q.isMobileNative&&(0,_.jsx)(k.Z,{title:(0,_.jsx)(B,{})})}):(0,_.jsx)(w.Z,{type:w.i.Vertical,initialFocus:Q.length>0?0:void 0,sections:[{key:1,render:e=>(0,_.jsx)(L,{collectionId:j,property:U,schema:K,onChange:O,canConfigureCollection:M,menuListStore:Y,args:e,tokens:ae}),items:N({analyticsFrom:n,canConfigureCollection:M,collectionId:j,createSelectColorRef:H,handleOnTokenInputChange:te,handleSetOpenPropertyActionMenu:se,onChange:O,openPropertyActionMenu:X,options:oe,property:U,schema:K,tokens:ae,value:W})}],onAccept:(e,t,n)=>{R(n)},store:Y})})}function B(){return(0,_.jsx)(m.FormattedMessage,{id:"database.selectPropertyEditMenu.noResults",defaultMessage:"No options found"})}function R(){return(0,_.jsx)(m.FormattedMessage,{id:"database.selectPropertyEditMenu.selectOnlyPrompt",defaultMessage:"Select an option"})}function D(){return(0,_.jsx)(m.FormattedMessage,{id:"database.selectPropertyEditMenu.selectOrCreatePrompt",defaultMessage:"Select an option or create one"})}function O(e){let{props:t,newOption:n,token:s}=e;const i=(0,a.O7)(),{device:o}=i;return(0,_.jsx)(M.Z,{...t,title:(0,_.jsxs)("div",{style:{display:"flex",minWidth:0},children:[(0,_.jsx)("div",{style:{marginRight:6,lineHeight:1.3},children:(0,_.jsx)(m.FormattedMessage,{id:"database.selectPropertyEditMenu.createLabel",defaultMessage:"Create"})}),(0,_.jsx)(P.a,{value:n.value,color:n.color,showRemoveButton:!1,isSingle:!0,format:o.isMobile?d.lo.Large:d.lo.Medium,showEllipsis:!0})]}),isTokenTitle:!0})}function L(e){let{args:t,tokens:n,collectionId:s,property:i,schema:a,onChange:l,canConfigureCollection:d,menuListStore:c}=e;const m=(0,o.useCallback)((e=>function(e,t,n,s,i,o){const a=(0,y.YL)({newOptions:e,collectionId:t,property:n,schema:s});if(a){const e=s[n];e&&r.cu(e)&&"manual"!==(e.auto_sort_options||"manual")&&a.push({pointer:{table:u.vF,id:t},command:"update",path:["schema",n],args:{auto_sort_options:"manual"}}),i({type:"selectPropertyMenuUpdateSchema",schemaOperations:a})}o.reset()}(e,s,i,a,l,c)),[s,i,a,l,c]);return d?(0,_.jsx)(T.Z,{...t,title:(0,_.jsx)(D,{}),children:(0,_.jsx)(j.ZP,{direction:"vertical",keys:n,renderKey:e=>t.children[n.indexOf(e)],onDrop:m})}):(0,_.jsx)(T.Z,{...t,title:(0,_.jsx)(R,{}),children:t.children})}function V(e){let{analyticsFrom:t,canConfigureCollection:n,collectionId:s,handleSetOpenPropertyActionMenu:i,onChange:l,openPropertyActionMenu:d,option:c,property:u,props:m,schema:g,value:f}=e;const h=(0,a.Fy)(),y=(0,o.useMemo)((()=>c.value===d),[d,c.value]),x=g[u];return x&&r.cu(x)?(0,_.jsx)(Z.Z,{...m,option:c,showDragHandle:n&&!h.isMobile,locked:!n,property:u,analyticsFrom:t,collectionId:s,onChange:e=>function(e,t,n,s,i){const o=n[t];if(!o)return;if(!r.cu(o))return;const a=o.options||[],l=[...a];let d;const c=s.filter((e=>{const t=a.find((t=>t.value===e));return!t||l.some((e=>e.id===t.id))}));d=p.Xy(c,s)?{type:"selectPropertyMenuUpdateSchema",schemaOperations:e}:{type:"selectPropertyMenuUpdateReplaceOptions",options:c,schemaOperations:e};i(d)}(e,u,g,f,l),actionMenuOpen:y,propertySchema:x,onCloseActionMenu:i,onOpenActionMenu:i}):null}function E(e,t,n){const s=e[t];if(!s)return;if(!r.cu(s))return;const i=s.options||[],o=(0,r.TL)(i);n.current=o}function N(e){const{analyticsFrom:t,canConfigureCollection:n,collectionId:s,createSelectColorRef:i,handleOnTokenInputChange:o,handleSetOpenPropertyActionMenu:a,onChange:r,openPropertyActionMenu:l,options:d,property:c,schema:u,tokens:m,value:p}=e;return m.map((e=>{const m=d.find((t=>t.value===e));return{key:e,render:o=>{if(m)return(0,_.jsx)(V,{analyticsFrom:t,canConfigureCollection:n,collectionId:s,handleSetOpenPropertyActionMenu:a,onChange:r,openPropertyActionMenu:l,option:m,property:c,props:o,schema:u,value:p});{const t={id:(0,g.ZP)(),value:e,color:i.current};return(0,_.jsx)(O,{props:o,newOption:t,token:e})}},action:()=>{p.includes(e)||o({change:{type:"addTokens",newTokens:[e]}})}}}))}},593896:(e,t,n)=>{n.d(t,{Z:()=>b});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(984619),l=n(653965),d=n(492658),c=n(243224),u=n(212534),m=n(98742),p=n(825464),g=n(224736),f=n(552275),h=n(203386),y=n(526388),x=n(873456),S=n(122084),v=n(785893);const b=s.forwardRef((function(e,t){var n;const{locked:u,option:g,actionMenuOpen:x,property:b,collectionId:j,analyticsFrom:C,onChange:w,onCloseActionMenu:k,focused:I,propertySchema:T,onOpenActionMenu:Z}=e,P=(0,a.Fg)(),F=(0,i.O7)(),_=(0,o.qz)(void 0,d.Z),A=(0,s.useRef)(x);return(0,s.useEffect)((()=>{x!==A.current&&_.setState({..._.state,inputValue:g.value}),A.current=x}),[x,g.value,_]),(0,v.jsx)(h.Z,{debugName:"SelectPropertyMenuItem",capture:x,onEnter:l.yR,children:(0,v.jsx)(y.Z,{renderTooltip:e=>(0,v.jsxs)("div",{...e,style:c.F6,children:[(0,v.jsx)("div",{children:g.value}),(0,v.jsx)("div",{style:{color:P.mediumInvertedTextColor},children:g.description})]}),placement:p.u.Left,disableTooltip:!(null!==(n=g.description)&&void 0!==n&&n.length),render:n=>(0,v.jsx)(f.Z,{...(0,m.Z)(n,e),ref:t,title:(0,v.jsx)(S.a,{format:F.device.isMobile?r.lo.Large:r.lo.Medium,value:g.value,color:g.color,hideTooltip:!0,showRemoveButton:!1,isSingle:!0,showEllipsis:!0}),desktopTitleStyle:{marginRight:6},isTokenTitle:!0,right:!u&&(0,v.jsx)(M,{property:b,collectionId:j,analyticsFrom:C,onChange:w,onCloseActionMenu:k,actionMenuOpen:x,focused:I,option:g,propertySchema:T,onOpenActionMenu:Z})})})})}));function M(e){let{property:t,collectionId:n,analyticsFrom:s,onChange:o,onCloseActionMenu:a,actionMenuOpen:r,focused:l,option:d,propertySchema:c,onOpenActionMenu:m}=e;const p=(0,i.O7)(),{device:f}=p;return(0,v.jsx)(x.Z,{open:r,origin:(0,v.jsx)(g.Z,{onClick:e=>function(e,t,n){(0,u.ZP)({event:e,context:u.Af.MenuListClick,callback:()=>t(n.value)})}(e,m,d),isMobile:f.isMobile,style:{opacity:l||f.isMobile?1:0}}),option:d,propertySchema:c,property:t,collectionId:n,analyticsFrom:s,onChange:o,onClose:a})}},177376:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});var s=n(667294),i=n(800480),o=n(886628),a=n(709291),r=n(175306),l=n(436610),d=n(110906),c=n(368585),u=n(460709),m=n(450627),p=n(918514),g=n(635328),f=n(99340),h=n(305971),y=n(27724),x=n(513713),S=n(980209),v=n(748019),b=n(268894),M=n(478140),j=n(672495),C=n(483182),w=n(785893);const k=(0,a.defineMessages)({filterActions:{defaultMessage:"Search actions…",id:"selectableHoverMenu.filterActions.placeholder"}});function I(e){const{hasEditorPermissions:t,isWorkspaceAdmin:n,store:a,onDismiss:p,containerRef:b,query:j,setQuery:C}=e,k=(0,i.O7)(),I=(0,i.MO)(),P=(0,o.VK)((()=>{var e;return{environment:k,blocks:y.default.state.stores.length?y.default.state.stores:[a],originRect:null===(e=b.current)||void 0===e?void 0:e.getBoundingClientRect(),publicEditMode:void 0}}),[k,a,b]),F=(0,o.VK)((()=>a.isNavigableAncestorNonEditableState()),[a]),_=(0,o.VK)((()=>(0,m.Ow)(a)),[a]),[A,B]=(0,s.useState)(void 0),R=(0,s.useCallback)((e=>{const t=y.default.state.stores[0];if(t){const n=t.getType();if(n){const s=(0,d.fm)(t),i=(0,c.Pn)(s)||{};l.dh(k,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"selection_menu",block_id:t.id,block_type:n,is_toggleable:(0,g._A)(n,t.getFormat()),parent_collection_id:t.getParentCollectionIdUpToTwoLevels(),...i})}}e.closeParentMenu&&p()}),[k,p]),D=(0,o.VK)((()=>a.isCollectionView()),[a]),O=(0,f.cR)(a),L=!I&&t&&!F&&!_&&!O&&(0,w.jsx)(T,{filter:j,setQuery:C,comboboxAriaProps:A});let V;V=I?{menuType:u.og.ActionSheet,header:L}:{menuType:u.og.Popup,width:265,header:L};const E=(0,o.VK)((()=>void 0!==a.getAssociatedCollectionStore()),[a]),N=(0,h.E)("db_comments");return(0,w.jsxs)(M.Z,{...V,children:[(0,w.jsx)(v.Z,{filter:j,initialFocus:j?0:void 0,sections:N&&E?r.p0:r.Qi,context:P,onAccept:R,setComboboxAriaProps:B}),!j&&(t||n)&&(0,w.jsx)(x.Z,{store:a,isPageMoreButton:!1,hideTopBorder:!1}),!j&&(0,w.jsx)(S.Z,{store:a}),!j&&D&&(0,w.jsx)(Z,{})]})}function T(e){const{filter:t,setQuery:n,comboboxAriaProps:s}=e,o=(0,i.Fy)(),r=(0,a.useIntl)();return(0,w.jsx)(j.Z,{isInput:!0,children:(0,w.jsx)(b.ZP,{value:t,onChange:e=>n(e.target.value),focus:!o.isMobile||void 0,focusAfterAnimation:!0,placeholder:r.formatMessage(k.filterActions),preventCaptureDeleteWhenEmpty:!0,preventCaptureClipboardShortcuts:!0,...s})})}function Z(){return(0,w.jsx)(j.Z,{topBorder:!0,children:(0,w.jsx)(C.Z,{title:(0,w.jsx)(a.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.hoverBlockMenu.collectionHelpButton"}),href:(0,p.UY)("guides.database"),analyticsFrom:"selectable_hover_menu"})})}},230761:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});n(667294);var s=n(800480),i=n(724405),o=n(550506),a=n(586993),r=n(785893);function l(e){const t=(0,s.Fy)(),n=(0,i.yK)((e=>({modal:{width:t.isMobile?"auto":890,height:t.isMobile?"auto":606,borderRadius:8}})),[t.isMobile]);return(0,r.jsx)(o.Z,{open:e.modalOpened,innerStyle:n.modal,onDismiss:e.onModalClose,render:()=>(0,r.jsx)("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"},children:(0,r.jsx)(a.Z,{location:"sidebar-modal"})})})}},142353:(e,t,n)=>{n.r(t),n.d(t,{MembersTabTitle:()=>yn,PeopleRow:()=>fn,SettingToggle:()=>xn,SidebarTeamModal:()=>hn});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(709291),l=n(653965),d=n(401898),c=n(137810),u=n(117224),m=n(843250),p=n(195697),g=n(455838),f=n(434859),h=n(80444),y=n(206258),x=n(44041),S=n(886232),v=n(243488),b=(n(757658),n(745238)),M=n(785893);const j=(0,b.IU)("leaveArrow",{viewBox:"0 0 16 12",svg:(0,M.jsx)("path",{d:"M8.65 11.116a.615.615 0 00.444-.184l4.546-4.54a.66.66 0 00.205-.39v4.526c0 .349.253.588.608.588.356 0 .615-.239.615-.588V1.361a.59.59 0 00-.615-.608.585.585 0 00-.608.608v4.512a.698.698 0 00-.205-.396L9.094.944a.623.623 0 00-.445-.191.58.58 0 00-.594.588c0 .164.054.328.164.437L9.75 3.33l2.242 2.05-1.456-.054h-9.01c-.355 0-.601.253-.601.609 0 .355.246.615.601.615h9.01L12 6.495 9.75 8.54l-1.531 1.559a.616.616 0 00-.164.43c0 .342.26.588.594.588z"})});var C=n(531701),w=n(164964),k=n(210228),I=n(436488),T=n(374194),Z=n(158297),P=n(526388),F=n(164369),_=n(433929),A=n(178122),B=n(825464),R=n(109867),D=n(373365),O=n(256187);function L(e){return!(0,O.q)(e)}var V=n(897082),E=n(564552),N=n(208787),U=n(880068),K=n(274016),W=n(680993),z=n(548779),q=n(960701);const G=(0,r.defineMessages)({editor:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsFull",defaultMessage:"Teamspace members have full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsEdit",defaultMessage:"Teamspace members can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsComment",defaultMessage:"Teamspace members can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsView",defaultMessage:"Teamspace members can view"}}),H=(0,r.defineMessages)({editor:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsFull",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} has full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsEdit",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsComment",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsView",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can view"},none:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsNone",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} does not have access"}});function $(e){let{teamStore:t}=e;const n=(0,a.yK)((()=>({listItem:{padding:0,margin:0},spacer:{height:20,width:"100%"},accessLevelButton:{border:"none"}})),[]),[s,i]=(0,o.AF)(g.Z),l=g.a.Members,d=(0,o.VK)((()=>t.getTeamAccessLevel()),[t]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{style:n.spacer}),(0,M.jsx)(W.Ph,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.permissions",defaultMessage:"Permissions"}),rows:[(0,M.jsx)(q._,{currentAccessLevel:d,teamStore:t,disabledWithRightChevron:!0,style:n.accessLevelButton},"visibility"),(0,M.jsx)(Y,{teamStore:t},"permissions")],onClick:()=>{s.open&&i({...s,tab:l})},itemStyle:n.listItem})]})}function Y(e){let{teamStore:t}=e;const n=(0,o.VK)((()=>h.default.state.currentSpaceStore),[]),s=(0,i.O7)(),r=(0,a.yK)((e=>({label:{color:e.regularTextColor,whiteSpace:"normal"},row:{display:"inline-flex",alignItems:"center",marginTop:12,marginBottom:12,paddingRight:15,paddingLeft:15},icon:{marginRight:15}})),[]),l=(0,o.VK)((()=>t.getTeamPermission()),[t]),d=(0,o.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),{spaceIcon:c,spaceName:u}=(0,o.VK)((()=>{if(!n)return{spaceIcon:void 0,spaceName:void 0};const e=(0,z.rn)(s,n);return{spaceIcon:(0,M.jsx)(K.p,{disabled:!0,store:n,size:20,style:r.icon}),spaceName:e}}),[n,s,r.icon]),m=(0,o.VK)((()=>(0,M.jsx)(K.p,{disabled:!0,store:t,size:20,style:r.icon})),[t,r.icon]),p=(null==l?void 0:l.role)??"none",g=!(p===d.role),f=g?m:c,y=_.default.formatMessage(H[d.role],{showTeam:g,spaceName:u}),x=_.default.formatMessage(G[p]);return(0,M.jsxs)("div",{style:r.row,children:[f,(0,M.jsxs)(F.Z,{isSmall:!0,style:r.label,children:[g&&(0,M.jsxs)(M.Fragment,{children:[x,(0,M.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),y]})]})}var Q=n(552867),J=n(489728),X=n(554985),ee=n(177150),te=n(891694),ne=n(411628),se=n(542853),ie=n(772141),oe=(n(159730),n(186517));const ae=["none","reader","comment_only","read_and_write","editor"],re=["reader","comment_only","read_and_write"],le=["reader","comment_only","read_and_write","editor"],de=["editor"];function ce(e){const t=function(e){var t,n;let{teamId:s,permissions:i}=e;const o=(null===(t=i.find((e=>(0,ie.Ir)(e))))||void 0===t?void 0:t.role)??"none",a=(null===(n=i.find((e=>(0,ie.zU)(e)&&e.team_id===s)))||void 0===n?void 0:n.role)??o,r=i.find((e=>(0,ie.bm)(e)));return{spacePermission:{type:"space_permission",role:o},teamMemberPermission:{type:"explicit_team_permission",team_id:s,role:a},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:s,role:"editor"},...r&&{teamGuestPermission:{type:"explicit_team_guest_permission",team_id:s,role:r.role}}}}({teamId:e.id,permissions:e.permissions??[]}),{spacePermission:n,teamMemberPermission:s}=t,i={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},o={spacePermission:me({roles:ae,currentRole:s.role}),teamGuestPermission:re,teamMemberPermission:ue({roles:le,currentRole:n.role}),teamOwnerPermission:de},{visibility:a,space_member_join_access:r}=e.settings;return"team_members"===a&&(i.space_member_join_access=["invite_only"],o.spacePermission=["none"]),"self_join"===r&&(i.visibility=["space_members"],i.invite_access=["team_members"],o.spacePermission=o.spacePermission.filter((e=>"none"!==e))),e.is_default&&(o.teamMemberPermission=[s.role],o.spacePermission=[s.role]),{settingsOptions:i,permissionItemRoleOptions:o,currentTeamPermissionItems:t}}function ue(e){let{roles:t,currentRole:n}=e;return t.filter((e=>(0,oe.IF)(e,n)))}function me(e){let{roles:t,currentRole:n}=e;return t.filter((e=>(0,oe.SL)(e,n)))}var pe=n(552275),ge=n(231945),fe=n(478140),he=n(632163),ye=n(672495),xe=n(824006),Se=n(304708),ve=n(460709),be=n(98742);function Me(e){let{teamStore:t}=e;const{teamSettings:n,isInviteToggleVisible:s}=(0,o.VK)((()=>({teamSettings:t.getSettingsStore().getValue(),isInviteToggleVisible:(0,Se.s$)()})),[t]),i=(0,o.VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return ce({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t]);if(!n||!i)return null;const a=[(0,M.jsx)(Ce,{teamStore:t,hasMultiInviteAccessOptions:1===i.settingsOptions.invite_access.length,inviteAccess:n.invite_access},"invite"),(0,M.jsx)(je,{teamStore:t,disablePageEdits:n.disable_team_page_edits},"editSidebar")];return s&&a.push((0,M.jsx)(we,{teamStore:t},"toggleInviteLink")),(0,M.jsx)(W.Ph,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsSecurity.teamspaceSettingsTitle",defaultMessage:"Teamspace Security"}),rows:a,hideDividers:!0})}function je(e){const{teamStore:t,disablePageEdits:n}=e,a=(0,i.O7)(),l=L(t),d=(0,o.VK)((()=>{var e;return(null===(e=t.getTeamPermission())||void 0===e?void 0:e.role)??"none"}),[t]),c=(0,s.useCallback)((e=>{k.createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:a,perform:n=>{R.$x({environment:a,store:t,update:{disable_team_page_edits:e},transaction:n})}})}),[a,t]),u=(0,ie.J5)(d),m=[{option:!0,label:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>c(!0)}];return u&&m.push({option:!1,label:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>c(!1)}),(0,M.jsx)(ke,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar"}),caption:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages"}),disabled:l||!u,currentOption:!u||Boolean(n),allOptions:m,optionTooltip:u?void 0:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar"})})}function Ce(e){const{teamStore:t,hasMultiInviteAccessOptions:n,inviteAccess:o}=e,a=(0,O.q)(t),l=(0,i.O7)(),d=(0,s.useCallback)((e=>{k.createAndCommit({userAction:"team.setInviteAccess",environment:l,perform:n=>{R.$x({environment:l,store:t,update:{invite_access:e},transaction:n})}})}),[l,t]),c=!a||n;return(0,M.jsx)(ke,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite teamspace members"}),disabled:c,optionTooltip:c&&a&&(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members"}),currentOption:o,allOptions:[{option:"team_members",label:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>d("team_members")},{option:"team_owners",label:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>d("team_owners")}]})}function we(e){const{teamStore:t}=e,n=(0,i.O7)(),s=(0,o.VK)((()=>p.U2(t)),[t]),l=L(t),d=(0,a.yK)((()=>({container:{display:"flex",justifyContent:"space-between"},subtitle:{marginBottom:5},switcher:{marginTop:5}})),[]);return(0,M.jsxs)("div",{style:d.container,children:[(0,M.jsxs)("div",{children:[(0,M.jsx)(F.Z,{children:(0,M.jsx)(r.FormattedMessage,{id:"TeamsecuritySection.inviteLink.label",defaultMessage:"Invite Link"})}),(0,M.jsx)(F.Z,{isSmall:!0,style:d.subtitle,children:(0,M.jsx)(r.FormattedMessage,{id:"TeamsecuritySection.inviteLink.description",defaultMessage:"Only users who can invite members can see the invite link"})})]}),(0,M.jsx)("div",{style:d.switcher,children:(0,M.jsx)(xe.Z,{disabled:l,on:!s,onClick:()=>{k.createAndCommit({userAction:"team.setInviteAccess",environment:n,perform:e=>{R.$x({environment:n,store:t,update:{disable_invite_link:!s},transaction:e})}})}})})]})}function ke(e){const{title:t,caption:n,currentOption:s,allOptions:o,disabled:r,optionTooltip:l}=e,d=(0,i.Fy)(),c=(0,a.yK)((e=>({root:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1},divider:{marginTop:14,marginBottom:14},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},buttonStyle:{fontSize:12.5,color:e.mediumTextColor},tooltipWidth:{width:300}})),[]),u=o.find((e=>e.option===s));return u?(0,M.jsxs)("div",{style:c.root,children:[(0,M.jsxs)("div",{style:c.title,children:[t,n&&(0,M.jsx)(F.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:1,width:"95%",marginBottom:5},children:n})]}),(0,M.jsx)(P.Z,{style:c.tooltipWidth,placement:B.u.Top,alignment:B.v.Start,textWrap:!0,disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,M.jsx)(ge.ZP,{...e,disablePopup:r,popupType:d.isMobile?ge.Z4.SlideUp:ge.Z4.Popup,alignmentToOrigin:ge.vR.End,renderOrigin:t=>(0,M.jsxs)(J.Z,{style:c.buttonStyle,disabled:r,...(0,be.Z)(e,t),children:[u.label,!r&&(0,se.i)(c.chevron)]}),render:e=>{let t;t=d.isMobile?{menuType:ve.og.ActionSheet}:{menuType:ve.og.Popup,minWidth:150};const n=[{key:"options",render:e=>(0,M.jsx)(ye.Z,{...e}),items:o.map((t=>{const n={key:t.option.toString(),render:e=>(0,M.jsx)(pe.Z,{...e,title:t.label,caption:t.caption,checkState:s===t.option}),action:()=>{t.action(),e.close()}};return n}))}];return(0,M.jsx)(fe.Z,{...t,children:(0,M.jsx)(he.Z,{type:he.i.Vertical,initialFocus:void 0,sections:n})})}})})]}):null}function Ie(e){let{teamStore:t}=e;const{currentSpaceStore:n}=(0,o.Kw)(h.default),s=(0,i.O7)(),a=(0,ne.z)(),l="enterprise",{organizationOverrides:d}=(0,X.u)({spaceId:null==n?void 0:n.id}),c=s.currentUser.id,u=(0,o.VK)((()=>({disable_public_access:{spaceIsDisabled:(null==n?void 0:n.getDisablePublicAccess())??!1,teamIsDisabled:t.getDisablePublicAccess(),isControlledByOrganization:Boolean(d.disable_public_access)},disable_export:{spaceIsDisabled:(null==n?void 0:n.getDisableExport())??!1,teamIsDisabled:t.getDisableExport(),isControlledByOrganization:Boolean(d.disable_export)},disable_guests:{spaceIsDisabled:(null==n?void 0:n.getDisableGuests())??!1,teamIsDisabled:t.getDisableGuests(),isControlledByOrganization:Boolean(d.disable_guests)},disable_team_page_edits:{spaceIsDisabled:void 0,teamIsDisabled:t.getDisableTeamPageEdits(),isControlledByOrganization:!1}})),[n,t,d]),m=(0,O.q)(t),p=(0,o.VK)((()=>(null==n?void 0:n.canAdmin())??!1),[n]);if(!n)return null;if(!c)return null;const g=e=>a||u[e].teamIsDisabled,f=e=>{if(!g(e))return!1;if(!m)return!1;if(u[e].isControlledByOrganization)return!1;const t=(e=>u[e].spaceIsDisabled&&u[e].teamIsDisabled)(e);return!t||p},y=e=>!g(e)&&p,x=e=>{const{teamIsDisabled:n,spaceIsDisabled:i}=u[e],o=!n;R.d({environment:s,store:t,settingName:e,newTeamSettingValue:Fe(o),spaceSettingValue:void 0===i?void 0:Fe(i)})},S=e=>{if((e=>u[e].spaceIsDisabled)(e))return(e=>u[e].teamIsDisabled)(e)?(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:e=>(0,M.jsx)("span",{style:{textDecoration:"underline"},children:e})}}):(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.overridesWorkspaceSettings",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:e=>(0,M.jsx)("span",{style:{textDecoration:"underline"},children:e})}})},v=(0,M.jsx)(te.Z,{subscriptionTier:l,analyticsName:"team_security_settings",desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),b=(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.setting.enterpriseGateToggleTooltip",defaultMessage:"Upgrade to Enterprise Plan to change security settings"}),j=[(0,M.jsx)(xn,{upsellTier:l,on:u.disable_public_access.teamIsDisabled,disabled:!f("disable_public_access"),onChange:()=>x("disable_public_access"),shouldTriggerUpsell:y("disable_public_access"),secondCaption:S("disable_public_access"),title:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.setting.shareTitle",defaultMessage:"Disable public page sharing"}),!g("disable_public_access")&&v]}),tooltip:!g("disable_public_access")&&b,isLocked:u.disable_public_access.isControlledByOrganization,lockedTooltip:(0,ee.g)()}),(0,M.jsx)(xn,{upsellTier:l,on:u.disable_guests.teamIsDisabled,disabled:!f("disable_guests"),onChange:()=>x("disable_guests"),shouldTriggerUpsell:y("disable_guests"),secondCaption:S("disable_guests"),title:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests"}),!g("disable_guests")&&v]}),tooltip:!g("disable_guests")&&b,isLocked:u.disable_guests.isControlledByOrganization,lockedTooltip:(0,ee.g)()}),(0,M.jsx)(xn,{upsellTier:l,on:u.disable_export.teamIsDisabled,disabled:!f("disable_export"),onChange:()=>x("disable_export"),shouldTriggerUpsell:y("disable_export"),secondCaption:S("disable_export"),title:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export"}),!g("disable_export")&&v]}),tooltip:!g("disable_export")&&b,isLocked:u.disable_export.isControlledByOrganization,lockedTooltip:(0,ee.g)()})];return(0,M.jsx)(Te,{teamStore:t,toggles:j})}function Te(e){let{teamStore:t,toggles:n}=e;const s=(0,a.yK)((e=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},spacer:{height:20,width:"100%"}})),[]),i=(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsSecurity.pageSettingsTitle",defaultMessage:"Page Security"});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Me,{teamStore:t}),(0,M.jsx)("div",{style:s.spacer}),(0,M.jsx)(W.Ph,{title:i,rows:n,hideDividers:!0}),(0,M.jsx)(U.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",containerStyle:s.learnMoreLinkContainer,message:(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security"})})]})}function Ze(e){const t=(0,i.O7)();return(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(J.Z,{style:e.style,icon:e=>(0,Q.H)({...e,margin:"2px 17px 2px 2px",width:16,height:16}),onClick:()=>(e=>{let{teamStore:n,teamName:s}=e;return R.YH({environment:t,teamStore:n,teamName:s,from:"sidebar_team_modal"})})({teamName:e.teamName,teamStore:e.teamStore}),children:(0,M.jsxs)("div",{children:[(0,M.jsx)(F.Z,{children:(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})}),(0,M.jsx)(F.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."})})]})})})}function Pe(e){const t=(0,i.O7)(),n=(0,a.yK)((()=>({archiveLabel:{color:C.ZP.red}})),[]);return(0,M.jsx)(J.Z,{style:e.style,isRed:!0,icon:e=>(0,Q.H)({...e,margin:"2px 17px 2px 2px",width:16,height:16}),disabled:e.disabled,disabledFeedback:e.disabled,onClick:()=>e.disabled?void 0:async function(e){let{teamStore:t,environment:n}=e;await R.aQ({environment:n,teamStore:t,from:"sidebar_team_modal"})}({environment:t,teamStore:e.teamStore}),...e.tooltipEvents,children:(0,M.jsxs)("div",{children:[(0,M.jsx)(F.Z,{style:n.archiveLabel,children:(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"})}),(0,M.jsx)(F.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamDescription",defaultMessage:"Removes teamspace from the sidebar for all members"})})]})})}function Fe(e){return e?"disable":"allow"}const _e=(0,r.defineMessages)({noDescription:{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description"}});function Ae(e){let{teamStore:t}=e;const n=(0,i.O7)(),l=(0,o.VK)((()=>h.default.state.currentSpaceStore),[]),d=L(t),[c,u]=(0,s.useState)(void 0),[m,p]=(0,s.useState)(void 0),g=(0,a.yK)((()=>({container:{maxWidth:"none",marginLeft:4},nameAndIconWrap:{display:"flex",alignItems:"center",marginBottom:0,marginTop:4},icon:{marginRight:7},name:{height:20,background:"none",boxShadow:"none",padding:"0 8px"},description:{minHeight:20,background:"none",boxShadow:"none",padding:"0 8px",margin:"0 -8px"},updateButton:{marginTop:14},learnMoreLinkContainer:{marginTop:15,marginBottom:15}})),[20]),[f,y]=(0,o.VK)((()=>[t.getName(),t.getDescription()]),[t]);if(void 0===f)return null;const x=f||"",S=y??"",v=S.length>0,b=null==c?void 0:c.trim(),j=null==m?void 0:m.trim(),C=""===b||(void 0===m||j===S.trim())&&(void 0===c||b===x.trim()),I=(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.iconAndName.title",defaultMessage:"Icon and name"}),T=(0,M.jsxs)("div",{style:g.nameAndIconWrap,children:[(0,M.jsx)(K.p,{disabled:d,store:t,style:g.icon,size:20,onChange:e=>{k.createAndCommit({userAction:"TeamSettingsGeneral.updateIcon",environment:n,perform:n=>{R.fs({store:t,update:{icon:e},transaction:n})}})}}),d?(0,M.jsx)(F.Z,{children:x}):(0,M.jsx)(Be,{value:c??x,style:g.name,onBlur:e=>{u(e)},onChange:e=>{u(e)},disabled:d,placeholder:"Acme Labs"})]}),P=(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description"}),B=_.default.formatMessage(_e.noDescription),D=d?(0,M.jsx)(F.Z,{isMultiline:!0,isSecondaryColor:!v,children:v?S:B}):(0,M.jsx)(Be,{value:void 0===m?S:m,onBlur:e=>{p(e)},onChange:e=>{p(e)},disabled:d,textarea:!0,autosize:!0,placeholder:B,style:g.description}),O=[(0,M.jsxs)(s.Fragment,{children:[(0,M.jsx)(F.Z,{isSmall:!0,children:I}),T]},"name"),(0,M.jsxs)(s.Fragment,{children:[(0,M.jsx)(F.Z,{isSmall:!0,children:P}),D]},"description")];return(0,M.jsxs)("div",{style:g.container,children:[(0,M.jsx)(W.Ph,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.details",defaultMessage:"Details"}),rows:O}),!d&&(0,M.jsx)(Z.Z,{style:g.updateButton,disabled:C,isLarge:!0,onClick:async()=>{if(C)return;if(b&&b!==x.trim()){if(!(await(0,A.Xg)({environment:n,spaceStore:l,teamName:b})))return}const{performResult:e,serverCommitResult:s}=k.createAndCommit({userAction:"TeamSettingsGeneral.updateNameAndDescription",environment:n,perform:e=>{R.fs({store:t,update:{name:b??x,description:j??S},transaction:e})}});try{await Promise.all([e,s])}catch(i){return}w.oV({label:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsGeneral.settingsChanged",defaultMessage:"Updated teamspace details"})})},children:(0,M.jsx)(r.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})}),(0,M.jsx)("br",{}),(0,M.jsx)($,{teamStore:t}),(0,M.jsx)(Re,{teamStore:t}),(0,M.jsx)(U.Z,{helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_team_settings_general",containerStyle:g.learnMoreLinkContainer})]})}function Be(e){const{value:t,style:n,onBlur:i,onChange:o,placeholder:a,disabled:r}=e,[l,d]=(0,s.useState)(!1),c=(0,s.useRef)(null);return(0,M.jsx)(I.Z,{capture:l,render:s=>(0,M.jsx)(T.Z,{textarea:e.textarea,autosize:e.autosize,ref:c,onFocus:e=>{d(!0)},onBlur:e=>{d(!1),i(e.target.value)},onChange:e=>{d(!1),o&&o(e.target.value)},onSubmit:e=>{e.target.blur()},placeholder:a,disabled:r,value:t,style:n,...s})})}function Re(e){let{teamStore:t}=e;const n=(0,a.yK)((()=>({buttonStyle:{alignItems:"center",height:"auto",width:"100%",paddingTop:W.MQ,paddingBottom:W.MQ,paddingLeft:W.oM,paddingRight:W.oM}})),[]),[s,i]=(0,o.VK)((()=>[t.getName(),t.isArchived()]),[t]),l=(0,O.q)(t),d=(0,E.e)(t),c=(0,V.y)(t.id),u=(0,D.n)(),m=c&&!u;if(void 0===s||!d)return null;const p=[],g=(0,M.jsx)(N.Z,{buttonInternals:(0,M.jsx)(De,{isTeamOwner:l}),teamStore:t,placement:B.u.Bottom,alignment:B.v.Start,from:"sidebar_team_modal",style:n.buttonStyle,icon:e=>j({...e,margin:"2px 17px 2px 2px",width:16,height:16}),isRed:!l});if(p.push(g),l)if(i)p.push((0,M.jsx)(Ze,{teamStore:t,teamName:s,style:n.buttonStyle}));else{const e=(0,M.jsx)(P.Z,{disableTooltip:!m,placement:B.u.Bottom,alignment:B.v.Start,renderTooltip:()=>(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.cannotArchive",defaultMessage:"Cannot archive this teamspace because it is the only default teamspace in this workspace."}),render:e=>(0,M.jsx)(Pe,{disabled:m,teamStore:t,tooltipEvents:e,style:n.buttonStyle})});p.push(e)}return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{style:{height:20,width:"100%"}}),(0,M.jsx)(W.Ph,{title:(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.title",defaultMessage:"Danger zone"}),rows:p,itemStyle:{padding:0,margin:0}})]})}function De(e){let{isTeamOwner:t}=e;const n=(0,a.yK)((()=>({label:{color:t?"inherit":C.ZP.red}})),[t]);return(0,M.jsxs)("div",{children:[(0,M.jsx)(F.Z,{style:n.label,children:(0,M.jsx)(r.FormattedMessage,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"})}),(0,M.jsx)(F.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,M.jsx)(r.FormattedMessage,{id:"teamBrowser.teamCard.button.leaveTeamDescription",defaultMessage:"Removes teamspace from your sidebar"})})]})}var Oe=n(435840),Le=n(296994),Ve=n(733052),Ee=n(382740),Ne=n(638078);function Ue(e){let{teamStore:t}=e;const n=(0,a.yK)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:e.modalBackground,zIndex:10,paddingBottom:8},input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12,width:"45%",maxWidth:260,marginRight:2},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),s=(0,r.useIntl)(),[i,l]=(0,o.AF)(g.Z),[d,c,u]=(0,o.AF)(void 0,Ve.Z),m=(0,Ee.e)(t),f=(0,o.VK)((()=>(0,Se.s$)()&&!p.U2(t)),[t]);return(0,M.jsxs)("div",{style:n.container,children:[(0,M.jsxs)("div",{children:[(0,M.jsx)(Le.Bq,{store:t,permissionsInviteStore:u,origin:(0,M.jsx)(P.Z,{placement:B.u.Left,alignment:B.v.Start,textWrap:!0,renderTooltip:()=>m?(0,M.jsx)("div",{style:{width:"max-content",maxWidth:150},children:(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups"})}):(0,M.jsx)("div",{style:{width:220},children:(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace"})}),render:e=>(0,M.jsx)(Z.Z,{disabled:!m,isLarge:!0,onClick:()=>{c({...d,modalOpen:!0})},...e,children:(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"})})})}),f&&(0,M.jsx)(Ne.u,{store:t,isSmall:!0})]}),(0,M.jsx)(T.Z,{placeholder:s.formatMessage({id:"teamPermissionsInviteWithModal.filterGroupsAndMembersInput.placeholder",defaultMessage:"Search for members or groups…"}),style:n.input,value:i.memberFilterQuery,onChange:e=>{l({...i,memberFilterQuery:e.target.value,limitMembers:!0})},left:(0,Oe.R)(n.searchIcon),showClearButton:!0,format:T.B.Small})]})}var Ke=n(158573),We=n(559054),ze=n(462385),qe=n(277907),Ge=n(88893),He=n(815047),$e=n(307928),Ye=n(886125),Qe=n(312793),Je=n(731278),Xe=n(45653),et=n(125735),tt=n(883165),nt=(n(21703),n(536591)),st=n(547307),it=n(661519),ot=n(61766),at=n(960709),rt=n(429369),lt=n(364684),dt=n(207567),ct=n(367669);function ut(e){const{teamStore:t,memberInfo:n,permissionItem:l,memberName:d,style:c,onMenuItemClicked:u,isPermissionOverridden:m}=e,p=(0,i.O7)(),g=(0,r.useIntl)(),f=(0,a.Fg)(),y=(0,s.useMemo)((()=>new ot.Z),[]),x=(0,a.yK)((e=>({header:{display:"flex",flexDirection:"column",backgroundColor:e.sidebarSecondaryBackground,fontSize:12,color:e.mediumTextColor,alignItems:"flex-start",paddingTop:10,paddingLeft:12,paddingRight:12,paddingBottom:10},overrideTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",height:28},overrideLabel:{paddingLeft:8,color:e.mediumTextColor}})),[]),S=(0,o.VK)((()=>t.getTeamPermission()),[t]),v=(0,o.VK)((()=>{if(null==t||!t.isDefined())return;const e=g.formatMessage({id:"teamMemberPermissionRoleSelect.member.permissionitem.description",defaultMessage:"You can't give less access than the teamspace default. Lower teamspace members‘ access to enable this option."}),n=(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionItem.defaultTag",defaultMessage:"default"});function s(n){return(0,oe.bk)({teamValue:{id:t.id,permissions:t.getPermissionItems()},permissionRole:n})?{isDisabled:!0,disabledMessage:e}:void 0}return["editor","read_and_write","comment_only","reader"].map((e=>({role:e,disabledInfo:s(e),tag:(null==S?void 0:S.role)===e?n:void 0})))}),[S,g,t]);const b=(0,o.VK)((()=>h.default.state.currentSpaceStore),[]),j=(0,o.VK)((()=>!("enterprise"===(null==b?void 0:b.getSubscriptionTier()))&&!m),[b,m]),C=(0,M.jsxs)("div",{style:x.overrideTitle,children:[(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.permissionsOverride",defaultMessage:"Custom permissions"}),j?(0,M.jsx)(te.Z,{subscriptionTier:"enterprise",analyticsName:"team_member_permission_override",desktopStyle:{marginLeft:8,marginRight:12}}):(0,M.jsx)(dt.ZP,{role:"owner"===n.type?"none":l.role,table:rt.e0,type:"user"===n.entity_type?"user_permission":"group_permission",upgradeButtonName:"user"===n.entity_type?"user_permission_item":"group_permission_item",buttonStyle:{marginRight:0,fontSize:12,color:f.mediumTextColor,visibility:m?void 0:"hidden"},availableRoleItems:v,header:(0,M.jsx)(F.Z,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:600,marginLeft:16,marginTop:8},children:(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionOverride.menuHeader",defaultMessage:"Select custom role"})}),onChange:e=>{"none"!==e&&(!function(e){st.showDialog({message:(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.message",defaultMessage:"Are you sure you want to change {name}'s role to {role}?",values:{name:d,role:(0,ct.r_)(e).toLowerCase()}}),description:(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.description",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),showCancel:!0,keepFocus:!1,handleCancel:st.dismissDialog,items:[{label:(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:async()=>{const{serverCommitResult:s}=k.createAndCommit({userAction:"TeamMemberPermissionRoleSelect.handleRoleSelect",environment:p,perform:s=>{R.jg({memberInfo:n,teamStore:t,transaction:s,environment:p,permissionRole:e})}});await s,t.isDefault()&&(t.getMembershipDefinedOnTeam().some((e=>(0,lt.ah)(e,n)))||await R.Uj({environment:p,teamStore:t,teamMemberInfos:[n],isSettingDefaultTeam:!0,createNewTeamFlowId:void 0}))}}]})}(e),u&&u())},buttonPopupStore:y,placementToOrigin:at.Iw.Right,alignmentToOrigin:at.lU.End})]});return(0,M.jsx)(P.Z,{placement:B.u.Left,textWrap:!0,renderTooltip:()=>(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip",defaultMessage:"Set a custom permission level for all pages in this teamspace"}),render:e=>(0,M.jsx)(pe.Z,{...e,focused:!1,style:c,textWrapperStyle:{marginRight:0},disabled:j,onClick:()=>y.setState({open:!0}),title:C,icon:m?(0,M.jsx)("div",{style:{marginTop:8},children:(0,nt.e)({width:14})}):void 0})})}function mt(e){let{teamStore:t,memberInfo:n,permissionItem:s,memberName:a,isPermissionOverridden:l,disabled:c}=e;const u=(0,o.qz)(void 0,ot.Z),[m,g]=(0,o.AF)(u),f=(0,i.O7)(),y=(0,o.VK)((()=>h.default.state.currentSpaceStore),[]),x=(0,o.VK)((()=>h.default.state.currentUserStore),[]),S=(0,o.VK)((()=>{const e=null==x?void 0:x.userId;return"user"===n.entity_type&&n.user_id===e}),[null==x?void 0:x.userId,n]),v=()=>g({...m,open:!1}),b=async e=>{v();const s="owner"===e?(0,M.jsx)(r.FormattedMessage,{defaultMessage:"owner",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelOwner"}):(0,M.jsx)(r.FormattedMessage,{defaultMessage:"member",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelMember"});if("team_level_guest"!==n.type||"owner"!==e&&"member"!==e)if("owner"===e){if("user"===n.entity_type){const{serverCommitResult:e}=k.createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:f,perform:e=>{R.W8({environment:f,userId:n.user_id,teamStore:t,transaction:e})}});await e}}else S?st.showDialog({message:(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.removeSelfTeamOwner.confirmation.message",defaultMessage:"Are you sure you want to remove yourself as a teamspace owner? You'll no longer be able to edit teamspace settings and permissions."}),showCancel:!0,keepFocus:!1,handleCancel:st.dismissDialog,items:[{label:(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:j}]}):await j();else{const i=(0,p.Mf)(n.user_id).length;st.showDialog({message:(0,M.jsx)(M.Fragment,{children:i>1?(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmationWithOtherTeamspaces.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member, and they will become a member in {numberOfOtherTeams, plural, one {{numberOfOtherTeams} other teamspace} other {{numberOfOtherTeams} other teamspaces}}.",values:{memberOrOwner:s,numberOfOtherTeams:i-1}}):(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member.",values:{memberOrOwner:s}})}),showCancel:!0,keepFocus:!1,handleCancel:st.dismissDialog,items:[{label:(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.accept",defaultMessage:"Add to workspace"}),color:"blue",onAccept:async()=>{if(y){const{serverCommitResult:s}=k.createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:f,perform:s=>{R.Ce({environment:f,userId:n.user_id,teamStore:t,transaction:s,spaceStore:y,newTeamRole:e})}});await s}}}]})}},j=async()=>{if("owner"===n.type&&"user"===n.entity_type){const{serverCommitResult:e}=k.createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:f,perform:e=>{R.mX({userId:n.user_id,teamStore:t,transaction:e,environment:f})}});await e}else if("member"===n.type){const{serverCommitResult:e}=k.createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:f,perform:e=>{R.X0({environment:f,memberInfo:n,teamStore:t,transaction:e})}});await e}},C=async()=>{const{entity_type:e}=n;switch(v(),e){case"group":const s=(0,z.TC)({spaceStore:y,groupId:n.group_id});if(!s)throw new Error("Permission group not found in space.");R.mN({environment:f,teamStore:t,group:s});break;case"user":await R.WO({environment:f,teamStore:t,currentSpaceStore:y,userId:n.user_id,from:"team_settings_member_table"});break;default:(0,d.t1)(e)}};return(0,M.jsx)(ge.ZP,{buttonPopupStore:u,placementToOrigin:at.Iw.Bottom,renderOrigin:e=>(0,M.jsx)(gt,{buttonPopupEvents:e,isPermissionOverridden:l,permissionItem:s,memberInfo:n,disabled:c}),render:()=>(0,M.jsx)(pt,{teamStore:t,isPermissionOverridden:l,memberInfo:n,permissionItem:s,memberName:a,onMenuItemClicked:b,onRemoveClicked:C,onSubMenuItemClicked:v}),popupType:ge.Z4.Popup})}function pt(e){let{teamStore:t,isPermissionOverridden:n,memberInfo:s,permissionItem:i,memberName:d,onRemoveClicked:u,onMenuItemClicked:g,onSubMenuItemClicked:f}=e;const y=(0,o.VK)((()=>{const{currentSpaceStore:e}=h.default.state;return!Boolean(null==e?void 0:e.getSettingsStore().getKeyStore("disable_team_guests").getValue())&&(0,Se.F$)()}),[]),x=(0,o.VK)((()=>t.isDefault()),[t]),S=(0,o.VK)((()=>(0,p.Hu)({membership:t.getKeyStore("membership").getValue()})),[t]),v=(0,o.VK)((()=>1===t.getOwnerUserIds().length),[t]),b=(0,a.yK)((e=>{const t={paddingTop:5,paddingBottom:5},n={...t,width:280,alignItems:"flex-start"};return{actionMenu:{marginTop:-4},removeButton:{...t,color:e.errorText},menuItem:n,indentedMenuItem:{...n,paddingLeft:20},overrideLabel:{paddingLeft:10,color:e.mediumTextColor,fontSize:12,fontWeight:c.Z.fontWeight.regular}}}),[]),j=(e,t)=>{const s=("owner"===e||"team_level_guest"===e)&&"group"===t.entity_type,o="member"===e&&"owner"===t.type&&v,a="team_level_guest"===e&&("owner"===t.type||"member"===t.type),l=s||o||a;return{key:e,action:()=>g(e),render:d=>{const c=!n&&t.type===e;return(0,M.jsx)(P.Z,{disableTooltip:!l,placement:B.u.Right,textWrap:!0,renderTooltip:()=>s?"owner"===e?(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableOwnerForGroupsTooltip",defaultMessage:"Groups can't be teamspace owners"}):(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableTeamGuestForGroupsTooltip",defaultMessage:"Groups can't be teamspace guests"}):o?(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableWithOnlyOneOwnerTooltip",defaultMessage:"Add another teamspace owner to downgrade yourself to member"}):a?(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableDowngradeToGuestTooltip",defaultMessage:"To change this user to a teamspace guest, first remove them from the workspace."}):void 0,render:t=>(0,M.jsx)("span",{...t,children:(0,M.jsx)(pe.Z,{...d,style:c?b.menuItem:b.indentedMenuItem,disabled:l,disabledFeedback:l,title:(0,M.jsx)(ft,{isPermissionOverridden:n,type:e,permissionItem:i}),caption:yt(e),shouldWrapCaption:!0,icon:c?(0,nt.e)({width:14}):void 0})})})}}},C=x&&"user"===s.entity_type,w="group"!==s.entity_type,k="group"!==s.entity_type&&y,I=[{key:"teamRoles",items:l.oA([w?j("owner",s):void 0,j("member",s),k?j("team_level_guest",s):void 0,xt({onRemoveClicked:u,styles:b,isMemberInDefaultTeam:C}),..."owner"===s.type||S?[]:[{key:"divider",action:()=>{},render:()=>(0,M.jsx)(it.Z,{size:10})},{key:"permissions_override",action:()=>{},render:e=>(0,M.jsx)("span",{...e,children:(0,M.jsx)(ut,{teamStore:t,memberInfo:s,permissionItem:i,memberName:d,onMenuItemClicked:f,isPermissionOverridden:n,style:n?b.menuItem:b.indentedMenuItem})})}]]),render:e=>(0,M.jsx)(ye.Z,{...e,topBorder:0!==e.index})}];return(0,M.jsx)(fe.Z,{className:m.a6i,menuType:ve.og.Popup,children:(0,M.jsx)(he.Z,{type:he.i.Vertical,initialFocus:void 0,sections:I})})}function gt(e){let{buttonPopupEvents:t,disabled:n,isPermissionOverridden:s,permissionItem:i,memberInfo:o}=e;const l=(0,a.yK)((e=>({label:{color:e.regularTextColor,fontSize:12.5,fontWeight:c.Z.fontWeight.regular},overrideLabel:{color:e.mediumTextColor,fontSize:12,fontWeight:c.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),u=function(e,t,n){if(t&&n)return function(e){switch(e){case"none":return(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.none",defaultMessage:"No access"});case"reader":return(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.reader",defaultMessage:"Can view"});case"comment_only":return(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.comment_only",defaultMessage:"Can comment"});case"content_only_editor":return(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.content_only_editor",defaultMessage:"Can edit content"});case"membership_admin":case"read_and_write":return(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.read_and_write",defaultMessage:"Can edit"});case"editor":return(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.editor",defaultMessage:"Full access"});default:(0,d.t1)(e)}}(n);return ht(e)}(o.type,s,i.role);return(0,M.jsxs)(J.Z,{disabled:n,...t,children:[s&&(0,M.jsxs)("span",{style:l.overrideLabel,children:[(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.custom",defaultMessage:"Custom"}),(0,M.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),(0,M.jsx)("span",{style:l.label,children:u}),!n&&(0,se.i)(l.chevron)]})}function ft(e){let{isPermissionOverridden:t,permissionItem:n,type:s}=e;const i=ht(s);return(0,M.jsx)("div",{children:(0,M.jsx)("span",{children:i})})}function ht(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,M.jsx)(r.FormattedMessage,{...p.q9[e].label});case"none":return;default:(0,d.t1)(e)}}function yt(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,M.jsx)(r.FormattedMessage,{...p.q9[e].caption});case"none":return;default:(0,d.t1)(e)}}function xt(e){let{styles:t,onRemoveClicked:n,isMemberInDefaultTeam:s}=e;const i=s?(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.remove.disabledTooltip.cannotRemoveFromDefault",defaultMessage:"Members cannot be removed from a default teamspace."}):void 0;return{key:"remove",action:n,render:e=>(0,M.jsx)(P.Z,{disableTooltip:!i,placement:B.u.Right,textWrap:!1,renderTooltip:()=>i,render:n=>(0,M.jsx)("span",{...n,children:(0,M.jsx)(pe.Z,{...e,style:{...t.removeButton,...t.indentedMenuItem},disabled:Boolean(i),disabledFeedback:!0,title:(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.remove",defaultMessage:"Remove"})})})})}}var St=n(30765);function vt(e){const{icon:t,label:n,name:s,tag:i,style:o}=e,r=(0,a.yK)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",gap:10,...o},labelContainer:{display:"flex",flexDirection:"column",...c.Z.textOverflowStyle,marginLeft:5},name:{minWidth:30},nameContainer:{display:"flex",flexDirection:"row",alignItems:"center"}})),[o]);return(0,M.jsxs)("div",{style:r.container,children:[t,(0,M.jsxs)("div",{style:r.labelContainer,children:[(0,M.jsxs)("div",{style:r.nameContainer,children:[(0,M.jsx)(St.s,{style:r.name,children:s}),i]}),n&&(0,M.jsx)(F.Z,{isSmall:!0,isSecondaryColor:!1,isMultiline:!0,children:(0,M.jsx)(St.s,{children:n})})]})]})}function bt(e){const{iconComponent:t,label:n,name:s,permissionRoleSelectComponent:i,tag:o,tooltip:r,style:l}=e,d=(0,a.yK)((e=>({permissionRow:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:36,justifyContent:"space-between",alignItems:"center",...l}})),[l]);return(0,M.jsxs)("div",{style:d.permissionRow,children:[(0,M.jsx)(vt,{icon:t,name:s,tag:o,label:n,style:{minWidth:200,marginRight:6}}),(0,M.jsx)(P.Z,{textWrap:!0,style:{width:210},disableTooltip:!r,placement:B.u.Left,renderTooltip:()=>r,render:e=>(0,M.jsx)("span",{...e,children:i})})]})}function Mt(e){const{type:t,store:n,permissionItem:s,memberInfo:l}=e,c=(0,o.VK)((()=>h.default.state.currentSpaceStore),[]),u=(0,r.useIntl)(),m=(0,o.VK)((()=>{var e;switch(t){case"group":return"none";case"user":const n=l.user_id;return(null===(e=(0,tt._P)(c,n))||void 0===e?void 0:e.getMembershipTypeAsRoleOrNone())??"none";default:(0,d.t1)(t)}}),[t,l,c]),g=(0,O.q)(n),f=(0,o.VK)((()=>{const{currentSpaceStore:e}=h.default.state;return null==e?void 0:e.canEditMembership()}),[]),y=(0,i.O7)(),x=(0,o.VK)((()=>{const e=y.currentUser.id,t=n.getSettingsStore().getValue();return!!(null!=c&&c.isDefined()&&n.isDefined()&&t&&e)&&(0,p.W9)({teamStore:n,spaceStore:c,userId:e})}),[y.currentUser.id,c,n]),S=(0,o.VK)((()=>{const e=n.getPermissionItems()||[];switch(l.entity_type){case"group":return!!e.find((e=>(0,ie.hV)(e)&&e.group_id===l.group_id));case"user":return!!e.find((e=>(0,ie.jg)(e)&&e.user_id===l.user_id));default:return!1}}),[l,n]),{name:v,label:b,icon:j}=(0,o.VK)((()=>{switch(t){case"group":return Ct({permissionGroup:e.permissionGroup,spaceId:null==c?void 0:c.id});case"user":return function(e){let{intl:t,userStore:n}=e;return{name:(0,$e.Nz)(t,null==n?void 0:n.getModel()),label:null==n?void 0:n.getEmail(),icon:(0,M.jsx)(Xe.Z,{avatarShouldShowShadow:!0,userStore:n,size:32})}}({intl:u,userStore:e.userStore});default:(0,d.t1)(t)}}),[t,e,u,null==c?void 0:c.id]),C=(0,M.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,M.jsx)(mt,{teamStore:n,memberInfo:l,memberName:v,permissionItem:s,isPermissionOverridden:S,disabled:!g&&!x||"team_level_guest"===l.type&&!f})}),w=(0,a.yK)((e=>({row:{minHeight:52},pill:{marginLeft:6,height:17}})),[]);return(0,M.jsx)(bt,{style:w.row,tag:(0,ie.Bc)(m)?(0,M.jsx)(Ye.Z,{desktopStyle:w.pill,mobileStyle:w.pill,role:jt(m)}):"group"===t?(0,M.jsx)("div",{style:w.pill,children:j}):void 0,permissionRoleSelectComponent:C,iconComponent:"group"===t?(0,M.jsx)(Qe.Z,{size:32}):j,name:v,label:b})}function jt(e){switch(e){case"editor":return"admin";case"membership_admin":return"membership_admin";default:(0,d.t1)(e)}}function Ct(e){let{spaceId:t,permissionGroup:n}=e;const{name:s,user_ids:i,icon:o}=n,a=(null==i?void 0:i.length)??0;return{name:s??(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionSettings.unknownGroup",defaultMessage:"Unknown Group"}),label:(0,M.jsx)(P.Z,{placement:B.u.Bottom,alignment:B.v.Start,disableTooltip:0===a,renderTooltip:()=>(0,M.jsx)(et.Y,{group:n,limit:10,noMembersMessage:void 0}),render:e=>(0,M.jsxs)("div",{...e,children:[(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionSettings.group",defaultMessage:"Group"})," • ",(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionSettings.numberOfMembers",defaultMessage:"{groupSize, plural, one {{groupSize} member} other {{groupSize} members}}",values:{groupSize:a}})]})}),icon:o&&(0,M.jsx)(Je.Z,{bucket:"public",disabled:!0,onChange:()=>{},isEmptyPage:!1,title:s,size:18,icon:o&&t?{icon:o,pointer:{table:He.bx,id:t}}:void 0})}}var wt=n(747453),kt=n(897630);function It(e){let{teamStore:t,...n}=e;const l=(0,i.O7)(),d=(0,o.VK)((()=>{var e;return null===(e=h.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),c=(0,r.useIntl)(),u=(0,a.yK)((()=>({container:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center"},pill:{marginLeft:6,height:17}})),[]),m=(0,s.useCallback)((e=>{w.oV({label:(0,M.jsx)(r.FormattedMessage,{id:"SpecificTeamMemberToAddRow.team_invite_failure",defaultMessage:"Failed to add {userOrGroupName}",values:{userOrGroupName:e}})})}),[]),p=(0,s.useCallback)((async(e,n)=>{await R.Uj({environment:l,teamMemberInfos:[e],teamStore:t,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})?await kt.bi(l):m(n)}),[l,m,t]),g=(0,s.useCallback)(((e,t)=>p({type:"member",entity_type:"user",user_id:e.id},t)),[p]),f=(0,s.useCallback)(((e,t)=>p({type:"member",entity_type:"group",group_id:e.id},t)),[p]);if("memberToAdd"in n){const{memberToAdd:e}=n,t=(0,$e.Nz)(c,e);return(0,M.jsxs)("div",{style:u.container,children:[(0,M.jsx)(vt,{icon:(0,M.jsx)(Xe.Z,{userValue:e,size:32}),name:t,label:e.email}),Tt((()=>{g(e,t)}))]})}{if(!d)return(0,M.jsx)(M.Fragment,{});const{groupToAdd:e}=n,t=Ct({spaceId:d,permissionGroup:e});return(0,M.jsxs)("div",{style:u.container,children:[(0,M.jsx)(vt,{icon:(0,M.jsx)(Qe.Z,{size:32}),name:t.name,label:t.label,tag:(0,M.jsx)("div",{style:u.pill,children:t.icon})}),Tt((()=>{f(e,t.name)}))]})}}function Tt(e){return(0,M.jsx)(J.Z,{isBlue:!0,onClick:e,icon:wt.R,children:(0,M.jsx)(r.FormattedMessage,{id:"SpecificTeamMemberToAddRow.addMemberButton.text",defaultMessage:"Add"})})}var Zt=n(240745),Pt=n(908597);function Ft(e){let{sortType:t,onChangeSortType:n}=e;const s=(0,a.yK)((e=>({container:{width:"100%",display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${e.regularDividerColor}`}})),[]),i=e=>e===t.column?t.sortedAscending?"ascending":"descending":"none",o=e=>{const s=e===t.column&&!t.sortedAscending;n({column:e,sortedAscending:s})};return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("div",{style:s.container,children:[(0,M.jsx)(_t,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamPermissionsListHeader.nameColumn",defaultMessage:"Name"}),sortedType:i("name"),onClick:()=>o("name")}),(0,M.jsx)(_t,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamPermissionsListHeader.roleColumn",defaultMessage:"Role"}),sortedType:i("role"),onClick:()=>o("role")})]})})}function _t(e){let{sortedType:t,title:n,onClick:s}=e;const i=(0,a.yK)((e=>({button:{color:e.mediumTextColor,fontSize:12,padding:0},buttonHover:{background:"unset"},sortIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor}})),[]);return(0,M.jsxs)(J.Z,{style:i.button,hoveredStyle:i.buttonHover,onClick:s,children:["ascending"===t&&(0,Pt.Z)(i.sortIcon),"descending"===t&&(0,Zt.M)(i.sortIcon),n]})}function At(e){var t;let{store:n}=e;const l=(0,i.O7)(),u=(0,a.yK)((e=>({container:{display:"block",overflow:"hidden"},membersHeader:{marginBottom:8},noResult:{fontSize:c.Z.fontSize.UIRegular.desktop,color:e.mediumTextColor,marginTop:8},showMore:{marginBottom:24,width:"max-content"}})),[]),m=(0,r.useIntl)(),[f,y]=(0,s.useState)({column:"role",sortedAscending:!1}),[x]=(0,o.AF)(g.Z),S=(0,Ee.e)(n),v=(0,o.VK)((()=>n.getMemberInfoUsingSpaceMembers((0,Ge.Io)())??[]),[n]),b=(0,o.VK)((()=>h.default.state.currentSpaceStore),[]),j=(0,o.VK)((()=>h.default.state.currentUserStore),[]),{permissionRowInfos:C,numNotShown:w}=(0,o.VK)((()=>{const e=function(e){let{permissionRowInfos:t,memberFilterQuery:n,intl:s}=e;if(""===n)return t;return(0,Ke.ZP)(n,t,(e=>{const{type:t}=e;switch(t){case"group":return e.permissionGroup.name??"";case"user":const{userStore:n}=e;return n.getSearchName(s);default:(0,d.t1)(t)}}))}({permissionRowInfos:(0,p.tu)({currentUserStore:j,currentSpaceStore:b,teamStore:n,members:v}),memberFilterQuery:x.memberFilterQuery,intl:m}),t=function(e){let{permissionRowInfos:t,sortType:n,intl:s}=e;const{column:i,sortedAscending:o}=n,a={permissionRowInfos:t,sortedAscending:o};if("role"===i)return function(e){let{permissionRowInfos:t,sortedAscending:n}=e;const s=["owner","member","team_level_guest"],i=["group","user"];return[...t].sort(((e,t)=>{const n=e.memberInfo.entity_type,s=t.memberInfo.entity_type;return i.indexOf(n)-i.indexOf(s)})).sort(((e,t)=>{const i=e.memberInfo.type,o=t.memberInfo.type,a=s.indexOf(i)-s.indexOf(o);return n?-a:a}))}(a);if("name"===i)return function(e){let{permissionRowInfos:t,sortedAscending:n,intl:s}=e;return[...t].sort(((e,t)=>{const i=Bt(e,s)??"",o=Bt(t,s)??"";if(i===o)return 0;const a=i<o?-1:1;return n?-a:a}))}({...a,intl:s});(0,d.t1)(i)}({permissionRowInfos:e,sortType:f,intl:m}),s=x.limitMembers?t.slice(0,50):t;return{permissionRowInfos:s,numNotShown:e.length-s.length}}),[b,j,v,n,f,x.memberFilterQuery,x.limitMembers,m]),k=(0,qe.XJ)(Le.FF.searchActions),[I]=(0,We.r5)((async()=>{var e;if(!S||null===(e=x.memberFilterQuery)||void 0===e||!e.trim().length||"resolved"!==k.status)return[];const t=k.value,n=(await t.searchVisibleSpaceUsers({environment:l,query:x.memberFilterQuery,membersOnly:!0})).map((e=>({type:"user",value:e}))),s=t.searchSpaceGroups({query:x.memberFilterQuery,intl:m}).map((e=>({type:"group",value:e}))),i=new Set(C.map(Dt));return[...n,...s].filter((e=>!i.has(e.value.id))).slice(0,5)}),[S,x.memberFilterQuery,l,m,C,k.status,k.value]),T=Boolean(null===(t=x.memberFilterQuery)||void 0===t?void 0:t.trim().length),Z=C.length>0,P="resolved"===I.status?I.value:[];return(0,M.jsxs)("div",{style:u.container,children:[(0,M.jsx)(Rt,{title:T?(0,M.jsx)(r.FormattedMessage,{id:"TeamPermissionsList.search.inThisTeam",defaultMessage:"In this teamspace"}):(0,M.jsx)(Ft,{sortType:f,onChangeSortType:y}),rows:C,renderRow:e=>(0,M.jsx)(Mt,{store:n,...e})}),w>0&&(0,M.jsx)(ze.Z,{style:u.showMore,onClick:()=>{g.Z.setState({...x,limitMembers:!1})},children:(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Show {numNotShown} more",id:"teamPermissionSettings.member.showMore",values:{numNotShown:w}})}),P.length>0&&(0,M.jsx)(Rt,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamPermissionsList.search.notInTeam",defaultMessage:"Not in teamspace"}),rows:P,renderRow:e=>"user"===e.type?(0,M.jsx)(It,{teamStore:n,memberToAdd:e.value}):(0,M.jsx)(It,{teamStore:n,groupToAdd:e.value})}),!Z&&0===P.length&&(0,M.jsx)("div",{style:u.noResult,children:(0,M.jsx)(r.FormattedMessage,{id:"TeamPermissionsList.search.zeroState",defaultMessage:"No members or groups found"})})]})}function Bt(e,t){const{type:n}=e;if("user"===n){const{userStore:n}=e;return n.getDisplayName(t)}if("group"===n){const{permissionGroup:t}=e;return t.name}(0,d.t1)(n)}function Rt(e){let{rows:t,renderRow:n,title:i}=e;const o=(0,a.yK)((e=>({membersList:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",width:"100%",marginBottom:12},memberDivider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[]);return t.length?(0,M.jsxs)(M.Fragment,{children:[i&&(0,M.jsx)(F.Z,{isSmall:!0,children:i}),(0,M.jsx)("div",{style:o.membersList,children:t.map(((e,t)=>(0,M.jsxs)(s.Fragment,{children:[t>0&&(0,M.jsx)("div",{style:o.memberDivider}),n(e)]},t)))})]}):null}function Dt(e){switch(e.type){case"user":return e.memberInfo.user_id;case"group":return e.memberInfo.group_id;default:(0,d.t1)(e)}}function Ot(e){let{teamStore:t}=e;const n=(0,a.yK)((()=>({content:{display:"grid",gridAutoFlow:"row",rowGap:6}})),[]);return(0,M.jsxs)("div",{style:n.content,children:[(0,M.jsx)(Ue,{teamStore:t}),(0,M.jsx)(At,{store:t})]})}var Lt=n(379362);function Vt(e){const{teamStore:t}=e,n=(0,i.O7)(),s=(0,r.useIntl)(),{teamGuestPermissionItem:l,teamPermissions:d}=(0,o.VK)((()=>({teamGuestPermissionItem:t.getTeamGuestsPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),c=L(t),u=(0,o.VK)((()=>[{role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:s.formatMessage({id:"teamPermissionsSettings.teamspace.guest.disabledPermissionitem.description",defaultMessage:"Teamspace guests can't have full access."})}},{role:"read_and_write",disabledInfo:void 0},{role:"comment_only",disabledInfo:void 0},{role:"reader",disabledInfo:void 0}]),[s]),m=(0,a.yK)((e=>({button:{fontSize:12.5,marginRight:0,color:e.mediumTextColor}})),[]),p=l&&(0,M.jsx)(dt.ZP,{role:l.role,table:rt.e0,type:"explicit_team_guest_permission",upgradeButtonName:"team_permission_item",disabled:c,buttonStyle:m.button,availableRoleItems:u,onChange:async e=>{if(d.filter((t=>((0,ie.jg)(t)||(0,ie.hV)(t))&&(0,oe.xO)(e,t.role))).length>0){if(!(await(0,A.Bt)()))return}k.createAndCommit({userAction:"TeamGuestsPermissionRow.permissionComponent",environment:n,perform:s=>{R.$J({environment:n,teamStore:t,newRole:e,transaction:s,permissionsToClear:[]})}})}}),g=(0,o.VK)((()=>t.getName()),[t]),f=(0,o.VK)((()=>t.getIcon()),[t]),h=f&&Lt.V2(f.icon)?Lt.mk(f.icon):"gray",y=f?{...f,icon:`/icons/user-circle_${h}.svg`}:void 0,x=(0,M.jsx)(K.p,{disabled:!0,store:t,size:W.Kt,icon:y});return p?(0,M.jsx)(bt,{permissionRoleSelectComponent:p,iconComponent:x,name:Et(g)}):null}function Et(e){return e?(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessWithoutTeamspaceName"})}function Nt(e){const{teamStore:t}=e,n=(0,i.O7)(),s=(0,a.Fg)(),l=(0,r.useIntl)(),{teamPermissionItem:d,teamPermissions:c}=(0,o.VK)((()=>({teamPermissionItem:t.getTeamPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),u=L(t),m=(0,o.VK)((()=>{var e;const n=null===(e=t.getPermissionItems())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),s=l.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members"});function i(e){return n&&e!==n.role&&(0,oe.nl)(e,n.role)===n.role&&!t.isDefault()?{isDisabled:!0,disabledMessage:s}:void 0}return[{role:"editor",disabledInfo:i("editor")},{role:"read_and_write",disabledInfo:i("read_and_write")},{role:"comment_only",disabledInfo:i("comment_only")},{role:"reader",disabledInfo:i("reader")}]}),[l,t]),p=d&&(0,M.jsx)(dt.ZP,{role:d.role,table:rt.e0,type:(0,ie.zU)(d)?"explicit_team_permission":"team_permission",upgradeButtonName:"team_permission_item",disabled:u,buttonStyle:{fontSize:12.5,marginRight:0,color:s.mediumTextColor},availableRoleItems:m,onChange:async e=>{const s=c.filter((t=>((0,ie.jg)(t)||(0,ie.hV)(t))&&(0,oe.xO)(e,t.role)));if(s.length>0){if(!(await(0,A.Bt)()))return}k.createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:n,perform:i=>{R.xI({environment:n,teamStore:t,newRole:e,transaction:i,permissionsToClear:s})}})}}),{teamName:g}=(0,o.VK)((()=>({teamName:t.getName()})),[t]),f=(0,M.jsx)(K.p,{disabled:!0,store:t,size:W.Kt});return(0,M.jsx)(bt,{permissionRoleSelectComponent:p,iconComponent:f,name:Ut(g)})}function Ut(e){return e?(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName"})}var Kt=n(519889),Wt=n(279414);function zt(e){const{teamStore:t,teamOwnerIds:n}=e,s=(0,a.Fg)(),i=(0,o.VK)((()=>t.getName()),[t]),l=(0,o.VK)((()=>t.getTeamOwnerPermission()),[t]),d=(0,o.VK)((()=>h.default.state.currentUserStore),[]),c=(0,o.VK)((()=>d?n.map((e=>y.U6.createChildStore(d,{table:Kt.KJ,id:e}))):[]),[d,n]);return(0,M.jsx)(bt,{tooltip:(0,M.jsx)(r.FormattedMessage,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default"}),permissionRoleSelectComponent:(0,M.jsx)(dt.ZP,{role:"editor",table:rt.e0,type:l&&(0,ie.LW)(l)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:s.mediumTextColor,marginRight:0},availableRoleItems:[]}),iconComponent:(0,M.jsx)(Wt.n,{teamStore:t,ownerStores:c,isSmall:!0}),name:qt(i)})}function qt(e){return e?(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName",values:{teamName:e}}):(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName"})}var Gt=n(16184),Ht=n(476464);function $t(e){const{teamStore:t}=e,n=(0,i.O7)(),s=(0,o.VK)((()=>h.default.state.currentSpaceStore),[]),{iconComponent:a,spaceName:r}=(0,o.VK)((()=>{if(!s)return{iconComponent:void 0,spaceName:void 0};const e=(0,z.rn)(n,s);return{iconComponent:(0,M.jsx)(K.p,{disabled:!0,store:s,size:W.Kt}),spaceName:e}}),[s,n]);return(0,M.jsx)(bt,{permissionRoleSelectComponent:(0,M.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:(0,M.jsx)(Qt,{teamStore:t})}),iconComponent:a,name:Yt(r)})}function Yt(e){return e?(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}):(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function Qt(e){const{teamStore:t}=e,n=(0,i.O7)(),s=(0,a.Fg)(),d=(0,o.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),c=L(t),u=(0,o.VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return ce({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t],{useDeepEqual:!0});if(!u)return null;const m=u.permissionItemRoleOptions.spacePermission;if(1===m.length&&"none"===m[0])return(0,M.jsx)(P.Z,{renderTooltip:()=>(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:170},...e,children:[(0,Gt.Q)({width:14,height:14,fill:s.timelineRed,marginRight:4}),(0,M.jsx)("div",{style:{fontSize:12.5,color:s.timelineRed,marginRight:8},children:(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",defaultMessage:"No access • Invite only"})})]})});{const e=l.MR(m,(e=>-ie.xm[e])).map((e=>({role:e})));return(0,M.jsx)(dt.ZP,{role:d.role,table:rt.e0,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:c||1===m.length,buttonStyle:{fontSize:12.5,marginRight:0,color:s.mediumTextColor},availableRoleItems:e,onChange:e=>{const s={...d,role:e};k.createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:n,perform:e=>{Ht.$G({environment:n,store:t,permissionItems:[s],transaction:e})}})}})}}function Jt(e){let{teamStore:t}=e;const n=(0,o.VK)((()=>t.isDefault()),[t]),s=(0,o.VK)((()=>t.getOwnerUserIds()),[t]),i=(0,o.VK)((()=>{const e=h.default.state.currentSpaceStore;if(!e)return!1;return!(null==e?void 0:e.getDisableTeamGuests())&&(!n&&(0,Se.F$)())}),[n]),r=(0,a.yK)((()=>({container:{marginLeft:15,marginRight:7,paddingBottom:4,paddingTop:4}})),[]);return(0,M.jsxs)("div",{style:r.container,children:[(0,M.jsx)(zt,{teamStore:t,teamOwnerIds:s},"0"),(0,M.jsx)(Nt,{teamStore:t},"1"),i&&(0,M.jsx)(Vt,{teamStore:t},"2"),!n&&(0,M.jsx)($t,{teamStore:t},"3")]})}var Xt=n(14465);function en(e){let{teamStore:t}=e;const n=(0,a.yK)((()=>({spacer:{width:"100%",height:20},heading:{marginBottom:10}})),[]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(tn,{teamStore:t}),(0,M.jsx)("div",{style:n.spacer}),(0,M.jsx)(Xt.z,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsMembers.memberSettings.membersTitle",defaultMessage:"Members"}),style:n.heading}),(0,M.jsx)(Ot,{teamStore:t})]})}function tn(e){let{teamStore:t}=e;const n=(0,i.O7)(),l=(0,o.VK)((()=>t.getName()),[t]),d=(0,a.yK)((()=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},teamSettingsListItems:{padding:0,margin:0},accessButton:{border:"none"}})),[]),c=(0,s.useCallback)(((e,s)=>{R.Ju({environment:n,accessLevel:e,isDefault:s,store:t,teamName:l,from:"sidebar_team_modal"})}),[n,t,l]),u=(0,o.VK)((()=>t.getTeamAccessLevel()),[t]),m=[(0,M.jsx)(q._,{teamStore:t,currentAccessLevel:u,onChange:c,style:d.accessButton},"visibility"),(0,M.jsx)(Jt,{teamStore:t},"permissions")];return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(W.Ph,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsMembers.memberSettings.permissionsTitle",defaultMessage:"Permissions"}),rows:m,itemStyle:d.teamSettingsListItems}),(0,M.jsx)(U.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_permissions",message:(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsPermissions.learnMore",defaultMessage:"Learn about teamspace permissions"}),containerStyle:d.learnMoreLinkContainer})]})}var nn=n(22487),sn=n(203386),on=n(550506),an=n(776798),rn=n(953336),ln=n(729302),dn=n(13490),cn=n(66957),un=n(174136);function mn(e){return(0,M.jsx)(un.Z,{...e,children:(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned"})})}function pn(e){const{teamStore:t}=e,n=(0,o.VK)((()=>g.Z.state.tab),[]);if(void 0===n)return null;switch(n){case g.a.General:return(0,M.jsx)(Ae,{teamStore:t});case g.a.Members:return(0,M.jsx)(en,{teamStore:t});case g.a.Security:return(0,M.jsx)(Ie,{teamStore:t});default:(0,d.t1)(n)}}function gn(e){const{userId:t,currentSpaceStore:n}=e,{userStore:s,isDefined:i}=(0,o.VK)((()=>{const e=y.U6.createChildStore(n,{table:"notion_user",id:t,spaceId:n.id});return{userStore:e,isDefined:e.isDefined()}}),[n,t]);return i?(0,M.jsx)(ln.Z,{avatarShouldShowShadow:!0,userStore:s,style:{paddingRight:6,minHeight:34,lineHeight:1.2,fontSize:14,width:"100%"},avatarSize:24}):null}function fn(e){const{userIds:t,label:n,hasMarginTop:s}=e,i=(0,o.VK)((()=>h.default.state.currentSpaceStore),[]);return i?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(dn.Z,{hasMarginTop:s,children:n}),t.map((e=>(0,M.jsx)(gn,{userId:e,currentSpaceStore:i},e)))]}):null}function hn(){const e=(0,i.O7)(),t=(0,o.VK)((()=>h.default.state.currentSpaceStore),[]),n=(0,o.VK)((()=>h.default.state.currentSpaceViewStore),[]),s=(0,i.Fy)(),y=(0,a.yK)((e=>({modal:{width:s.isMobile?"auto":630,height:s.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5,overflow:"auto"},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column",paddingTop:20},header:{display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,margin:"0px 36px"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,margin:"0px 36px 20px"},scroller:{flexGrow:1},contentWrap:{margin:"0px 36px"},lockIcon:{width:16,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},icon:{marginRight:8,fontWeight:c.Z.fontWeight.medium},unownedPill:{marginLeft:6,height:17},unownedPillInner:{display:"flex",height:"100%",alignItems:"center",color:e.regularTextColor,fontWeight:c.Z.fontWeight.regular,textTransform:"unset",fontSize:11}})),[s.isMobile]),{open:x,tab:b,teamStore:j}=(0,o.VK)((()=>{const{open:e,tab:t}=g.Z.state;return{open:e,tab:t,teamStore:g.Z.getTeamStore()}}),[]),C=(0,o.VK)((()=>null==j?void 0:j.getSettings()),[j]),w=(0,O.q)(j);if(!t||!n||!j)return null;const k=[g.a.General,g.a.Members,g.a.Security];return(0,M.jsx)(on.Z,{open:x,innerStyle:y.modal,onDismiss:()=>{g.Z.reset()},render:()=>x?(0,M.jsx)("div",{className:m.rIj,style:{height:"100%"},children:(0,M.jsx)("div",{style:y.modalWrap,children:(0,M.jsx)(sn.Z,{debugName:"SidebarTeamModal",capture:!0,onBackspace:l.yR,onLeft:l.yR,onRight:l.yR,onSelectAll:l.yR,onRedo:l.yR,onUndo:l.yR,onCut:l.yR,onCopy:l.yR,onPaste:l.yR,onKeypress:l.yR,onDelete:l.yR,onTab:l.yR,children:(0,M.jsxs)("div",{style:y.innerWrap,children:[(0,M.jsxs)("div",{style:y.header,children:[(0,M.jsx)(K.p,{disabled:!0,store:j,size:24,style:y.icon}),(0,M.jsx)(an.Z,{store:j,style:{fontSize:16,fontWeight:c.Z.fontWeight.semibold}}),(0,p.C2)(C)&&(0,M.jsx)(v.Z,{iconStyle:y.lockIcon}),(0,p.Hu)({membership:j.getRawMembership()})&&(0,M.jsx)("div",{style:{gap:5,display:"flex"},children:(0,M.jsx)(mn,{desktopStyle:y.unownedPill,mobileStyle:y.unownedPill,innerStyle:y.unownedPillInner})}),(0,M.jsx)("div",{style:{flexGrow:1}}),(0,M.jsx)(S.M,{teamStore:j,onLeavingTeam:()=>g.Z.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})]}),(0,M.jsx)(cn.Z,{tabs:k.map((e=>function(e,t){switch(e){case g.a.General:return(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General"});case g.a.Members:return(0,M.jsx)(yn,{teamStore:t});case g.a.Security:return(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security"});default:(0,d.t1)(e)}}(e,j))),selectedIndex:(0,d.$K)(b)?k.indexOf(b):1,onChange:t=>{x&&(u.rF(e,{store:j,tab_old_value:b??g.a.General,tab_new_value:k[t]}),g.Z.update((e=>e.open?{...e,tab:k[t]}:e)))},tabStyle:{marginLeft:-8},style:y.tabBar,tabTitleStyle:{marginLeft:8,marginRight:8}}),(0,M.jsx)(rn.Z,{type:f.Z.Y,style:y.scroller,children:(0,M.jsx)("div",{style:y.contentWrap,children:(0,M.jsx)(pn,{currentSpaceStore:t,teamStore:j,userIsTeamOwner:w})})})]})})})}):null})}function yn(e){let{teamStore:t}=e;const n=(0,nn.K)(t),s=(0,a.Fg)();return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members"}),(0,M.jsx)("span",{children:" "}),(0,M.jsx)("div",{style:{color:s.lightTextColor},children:n})]})}function xn(e){let{title:t,caption:n,secondCaption:s,on:o,disabled:r,tooltip:l,style:d,onChange:c,shouldTriggerUpsell:u,upsellTier:m,isLocked:p,lockedTooltip:g}=e;const f=(0,i.O7)(),h=(0,a.yK)((()=>({root:{display:"flex",alignItems:"center",width:"100%",marginTop:0,marginBottom:0,cursor:u?"pointer":void 0,...d},title:{fontSize:14,marginRight:8,flexGrow:1},switcherWrap:{marginTop:5,marginRight:18}})),[d,u]);return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("div",{style:h.root,onClick:()=>{if(u)return x.y(f,{from:"team_security_settings",for:m,dontOpenPlansOnCancel:!0})},children:[(0,M.jsxs)("div",{style:h.title,children:[t,n&&(0,M.jsx)(F.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"},children:n}),s&&(0,M.jsx)(F.Z,{isSmall:!0,children:s})]}),(0,M.jsx)("div",{style:h.switcherWrap,children:(0,M.jsx)(P.Z,{disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,M.jsx)("div",{...e,children:(0,M.jsx)(xe.Z,{on:o,disabled:r,onClick:c,isLocked:p,lockedTooltip:g})})})})]})})}},100636:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Z});var s=n(667294),i=n(313991),o=n(800480),a=n(886628),r=n(646225),l=n(436610),d=n(115944),c=n(384084),u=n(210228),m=n(68204),p=n(764286),g=n(460709),f=n(268056),h=n(731352),y=n(635328),x=n(905162),S=n(223196),v=n(80444),b=n(27724),M=n(410743),j=n(924666),C=n(587244),w=n(748019),k=n(478140),I=n(953437),T=n(785893);const Z=function(){const e=(0,o.Fy)(),t=(0,o.O7)(),n=(0,a.VK)((()=>M.Z.state),[]),i=(0,a.VK)((()=>n.open?j.default.state:void 0),[n]),r=A({slashMenuState:n,environment:t});return(0,s.useEffect)((()=>{if(n.open&&i){var e;if("editing"!==i.mode)return;const s=P(n),o=(0,m.sG)({sections:r,context:{blocks:b.default.state.stores,environment:t,publicEditMode:void 0},query:s||""});let a=0,l=n;s&&(0===o.length?a=s.length-n.lettersAtLastResult:(l={...n,lettersAtLastResult:(null==s?void 0:s.length)??0,filter:s},M.Z.setState(l)));const{currentUserSettingsStore:u}=v.default.state;!u||null!==(e=u.getSettings())&&void 0!==e&&e.pressed_slash_tooltip||!(0,p.u)(t)||d.q(t);const{multiSelection:g}=i;(0,f.qS)(g)&&g.start.store===l.textStore&&!h.Ye(s,!0,o.length,a,l.textStore)||c.xv()}})),(0,T.jsx)(I.ZP,{popupType:e.isMobileNative&&!e.isTablet?S.k.SlideUp:S.k.Popup,open:n.open&&!(0,x.Y)("supportsNativeMobileDynamicActionBar"),originRect:n.open?n.selectionRect:void 0,placementToOrigin:I.ZP.Placement.Bottom,alignmentToOrigin:I.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,preventBlockRenderQueueOnEnter:!0,onDismiss:_,render:()=>(0,T.jsx)(B,{})})};function P(e){return h.zK(e.textStore,e.oldTextValue,(0,x.Y)("supportsNativeMobileDynamicActionBar")||!e.isAddMenu)}function F(){const e=M.Z.state;return e.open?e.filter.length:0}function _(){c.xv()}function A(e){const{slashMenuState:t,environment:n}=e,i=(0,s.useMemo)((()=>(0,r.PU)(n)),[n]);return(0,a.VK)((()=>t.open?t.isAddMenu?i.state.insertActions:i.state.slashActions:[]),[t,i])}function B(){const e=(0,o.O7)(),t=(0,o.Fy)(),n=(0,a.VK)((()=>M.Z.state),[]),s=A({slashMenuState:n,environment:e}),r=(0,a.VK)((()=>n.open?P(n):void 0),[n]),d=(0,a.VK)((()=>b.default.state.stores),[]);if(!n.open)return null;let m;return m=t.isMobileNative&&!t.isTablet?{menuType:g.og.ActionSheet}:{menuType:g.og.Popup,width:"fr-FR"===i.SP?375:324,maxHeight:"40vh",onClickOutside:c.xv},(0,T.jsx)(C.N,{step:"create_page_beyond_text",showSidebarOverlays:!1,children:(0,T.jsx)(k.Z,{...m,children:(0,T.jsx)(w.Z,{sections:s,onAccept:(t,n,s,i)=>function(e,t,n,s,i){const o=b.default.state.stores[0];if(o){const t=o.getType(),n=o.getFormat();l.dh(s,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"slash_menu",block_id:o.id,block_type:t,is_toggleable:t?(0,y._A)(t,n):void 0,slash_menu_filter_length:F(),slash_menu_section:i,parent_collection_id:o.getParentCollectionIdUpToTwoLevels()})}u.createAndCommit({userAction:"SlashMenu.handleAccept",environment:s,perform:e=>{c.RL({environment:s,transaction:e})}})}(t,0,0,e,i),context:{environment:e,blocks:d,originRect:n.selectionRect,publicEditMode:void 0},filter:r,initialFocus:0,onEmptyEnter:_,useLimit:!0})})})}},868012:(e,t,n)=>{n.d(t,{Z:()=>g});var s=n(667294),i=n(724405),o=n(14577),a=n(584169),r=n(151454),l=n(779683),d=n(801310),c=n(584076),u=n(804827),m=n(785893);function p(){const[e,t]=(0,s.useReducer)(((e,t)=>{switch(t.type){case"push":return[...e.map((e=>({...e,isAnimatingOut:!0}))),{item:t.item,isAnimatingOut:!1}];case"delete":return e.filter((e=>e.item.key!==t.key));case"clear":return e.map((e=>({...e,isAnimatingOut:!0})));default:return e}}),[]);return(0,s.useEffect)((()=>{const e=new o.Z((()=>d.ZP.state.currentItem),{debugName:"currentItemStore"});let n=null;function s(){const s=e.state;s&&n!==s.key?(t({type:"push",item:s}),n=s.key):s||t({type:"clear"})}return e.addListener(s),()=>{e.removeListener(s)}}),[]),(0,m.jsx)(u.Z,{open:e.length>0,zIndex:201,children:e.map((e=>(0,s.createElement)(f,{...e,key:e.item.key,dispatch:t})))})}const g=s.memo(p),f=s.memo((function(e){let{dispatch:t,isAnimatingOut:n,item:o}=e;const d=(0,i.Fg)(),u=(0,l.k)(),p=(0,s.useCallback)((()=>{t({type:"delete",key:o.key})}),[t,o.key]),g=(0,s.useRef)(n);(0,s.useEffect)((()=>{if(!g.current&&n){const e=setTimeout(p,270);return()=>{p(),clearTimeout(e)}}g.current=n}),[n,p]);const f=o.position??"bottom",h="top"===f?{top:24}:{bottom:u};return(0,m.jsx)("div",{style:{...h,position:"fixed",left:0,width:"100%",display:"flex",zIndex:r.E,padding:4,pointerEvents:"none"},children:(0,m.jsxs)("div",{"aria-live":"polite",style:{background:d.tooltipBackground,color:d.regularInvertedTextColor,borderRadius:8,padding:"11px 16px",boxShadow:d.largeBoxShadow,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center",pointerEvents:"auto",...o.style,animationName:`snackbar-slide-in-${f}`,animationDuration:"270ms",animationTimingFunction:"ease",transitionProperty:"transform, opacity",transitionDuration:"270ms",transitionTimingFunction:"ease",transform:n?"scale(0.95)":"scale(1)",opacity:n?0:1},onTransitionEnd:n?p:void 0,children:[o.label,o.helpUrl&&(0,m.jsx)(c.Z,{href:o.helpUrl,external:!0,style:{marginLeft:8,width:16,height:16,color:d.regularInvertedTextColor},children:(0,a.m)({fill:d.mediumInvertedTextColor})}),(0,m.jsx)("div",{style:{marginLeft:4,marginRight:-4},children:o.right})]})})}))},40858:(e,t,n)=>{n.r(t),n.d(t,{default:()=>mS});n(21703);var s=n(667294),i=n(800480),o=n(184747),a=n(886628),r=n(724405),l=n(16184),d=n(745238),c=n(785893);const u=(0,d.IU)("magnifyingGlass",{viewBox:"0 0 16 16",svg:(0,c.jsx)("path",{d:"M1.321 6.28c0 .751.142 1.458.424 2.118a5.52 5.52 0 001.176 1.737 5.51 5.51 0 001.736 1.175 5.326 5.326 0 002.12.424c.592 0 1.157-.09 1.695-.273a5.639 5.639 0 001.476-.752l3.364 3.37a.8.8 0 00.266.171c.1.041.205.062.315.062a.766.766 0 00.683-.397.83.83 0 00.041-.718.715.715 0 00-.164-.253L11.11 9.581c.351-.456.625-.964.82-1.524.201-.56.301-1.153.301-1.778 0-.752-.14-1.456-.423-2.112a5.497 5.497 0 00-2.92-2.919A5.284 5.284 0 006.777.824c-.752 0-1.458.141-2.119.424a5.52 5.52 0 00-2.912 2.919 5.284 5.284 0 00-.424 2.112zm1.17 0A4.204 4.204 0 013.74 3.25a4.286 4.286 0 011.367-.923 4.179 4.179 0 011.668-.335 4.13 4.13 0 011.662.335 4.19 4.19 0 011.367.923c.392.392.7.848.922 1.367a4.13 4.13 0 01.335 1.661c0 .593-.111 1.149-.335 1.668a4.357 4.357 0 01-2.29 2.283 4.13 4.13 0 01-1.66.335 4.179 4.179 0 01-1.669-.335 4.357 4.357 0 01-2.29-2.283A4.254 4.254 0 012.49 6.28zM6.79 9.15c.114 0 .187-.066.219-.198.068-.369.137-.683.205-.943.068-.26.153-.474.253-.643.1-.173.23-.314.39-.424a2.01 2.01 0 01.628-.26 8.31 8.31 0 01.964-.184c.137-.018.205-.091.205-.219 0-.127-.068-.205-.205-.232a8.214 8.214 0 01-.97-.178 2.217 2.217 0 01-.643-.266 1.355 1.355 0 01-.403-.417 2.49 2.49 0 01-.246-.643 10.063 10.063 0 01-.178-.93c-.023-.136-.096-.205-.219-.205s-.2.066-.232.198c-.073.374-.144.69-.212.95A2.49 2.49 0 016.1 5.2c-.1.169-.233.308-.397.417a2.14 2.14 0 01-.622.26c-.255.064-.574.12-.957.17-.141.028-.212.106-.212.233 0 .123.07.196.212.22.479.05.864.12 1.155.211.292.087.518.216.677.39.164.173.287.41.37.71.086.297.163.675.232 1.135.009.06.034.11.075.15a.228.228 0 00.157.055z"})});var m=n(471924),p=n(803791),g=n(647425),f=n(709291),h=n(653965),y=n(137810),x=n(948298),S=n(407512),v=n(757549),b=n(614549),M=n(547307),j=n(91376),C=n(412714),w=n(29974),k=n(171119),I=n(454642);async function T(e,t){const n=await I.getEmailDomainSettings(e,{});"success"===n.type&&t.setState({...t.state,emailDomainSettings:n.data});try{const n=await(0,k.pu)(e);t.setState({...t.state,accountSettings:{...n,error:void 0}})}catch(s){t.setState({...t.state,accountSettings:{...t.state.accountSettings,error:s}})}}var Z=n(310259),P=n(210228),F=n(237181),_=n(253877),A=n(159730),B=n(980085),R=n(177420),D=n(519889),O=n(296994),L=n(833954),V=n(433929),E=n(922326),N=n(749085);class U extends N.default{getInitialState(){return{spaceId:void 0,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set}}isUserOrBotRemoved(e){return Boolean(e&&(this.state.removedUserIds.has(e)||this.state.removedBotIds.has(e)))}}const K=new U;class W extends N.default{getInitialState(){return{cachedResponses:{}}}getCursor(e,t,n){if(n<=1||this.state.spaceId!==e)return;const s=(0,E.r)(t);if(this.state.filterStr!==s)return;const i=this.state.cachedResponses[n-1];return"success"===i.status?null==i?void 0:i.nextCursor:void 0}startLoading(e,t){this.updateResultHelper(e,t,{status:"loading"})}updateLoadedResult(e,t,n){this.updateResultHelper(e,t,{...n,status:"success",loadedAt:Date.now()})}updateError(e,t){this.updateResultHelper(e,t,{status:"error"})}updateResultHelper(e,t,n){const s=(0,E.r)(t);1!==t.pageNum&&this.state.spaceId===e&&this.state.filterStr===s?this.setState({spaceId:e,filterStr:s,cachedResponses:{...this.state.cachedResponses,[t.pageNum]:{...n}}}):this.setState({spaceId:e,filterStr:s,cachedResponses:{[t.pageNum||1]:{...n}}})}}const z=new W,q=(0,f.defineMessages)({loadCurrentAuditLogError:{id:"auditlog.error.loadCurrentAuditLogError",defaultMessage:"Failed to load audit logs"}});async function G(e){const{environment:t,spaceId:n}=e,s=await I.getHistoricalAuditLogUsers(t,{spaceId:n});return"success"!==s.type?[]:s.data.results}async function H(e){const{environment:t,spaceId:n}=e;if(K.getState().spaceId!==n&&K.reset(),!n)return;const s=await O.FF.searchActions.load(),[i,o]=await Promise.all([s.searchSpaceActorIds({environment:t,membersOnly:!1}),G({environment:t,spaceId:n})]),a={spaceId:n,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set};i.userIds.forEach((e=>{a.allUserIds.add(e)})),i.botIds.forEach((e=>{a.allBotIds.add(e)})),o.forEach((e=>{var t;(t=e.actorId)!==R._H.id&&t!==D.s$.id&&t!==D.el.id||a.allUserIds.has(e.actorId)?e.actorType!==D.KJ||a.allUserIds.has(e.actorId)?e.actorType!==R.cZ||a.allBotIds.has(e.actorId)||(a.allBotIds.add(e.actorId),a.removedBotIds.add(e.actorId)):(a.allUserIds.add(e.actorId),a.removedUserIds.add(e.actorId)):a.allUserIds.add(e.actorId)})),K.setState(a)}var $=n(723399),Y=n(569651),Q=n(423096),J=n(608319),X=n(444763),ee=n(883355),te=n(266897),ne=n(222686),se=n(174136),ie=n(197680),oe=n(206258),ae=n(227617);class re extends N.default{getInitialState(){return{tempSelections:new Set([])}}setTempSelections(e){this.setState({tempSelections:new Set(e)})}}class le extends ee.Z{constructor(){super(...arguments),this.storeTypes={localStore:re},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderResultMenuItem=(e,t)=>(0,c.jsx)(ue,{item:e,props:t,auditLogHistoricalUserStore:this.props.auditLogHistoricalUserStore,parentStore:this.props.parentStore,localStore:this.stores.localStore})}didMount(){me(this.props.selectedActors,this.stores.localStore)}renderComponent(){const{selectedActors:e,intl:t}=this.props,{localStore:n}=this.stores,s=(0,c.jsx)(f.FormattedMessage,{id:"auditlogActorFilter.title",defaultMessage:"User"});return(0,c.jsx)(J.Z,{mode:J.z.Pill,title:s,icon:ne.f,iconStyles:{marginRight:2},items:Array.from(n.state.tempSelections),hasItemsSelected:(null==e?void 0:e.length)>0,onChange:e=>{n.setTempSelections(e)},renderFooter:!0,allowApplyBatchSelection:!0,keepInputOnItemConfirm:!0,onMenuDismiss:e=>{"applyButton"!==e?me(this.props.selectedActors,this.stores.localStore):function(e,t){const n=Array.from(t.state.tempSelections).map(ae.Ij).filter((e=>Boolean(e)));e(n)}(this.props.onChange,this.stores.localStore)},labelText:{title:s,tokenInputPlaceholder:t.formatMessage({defaultMessage:"Search user...",id:"auditlogActorFilter.searchActor.placeholder"}),resultSectionTitle:t.formatMessage({defaultMessage:"Select users",id:"auditlogActorFilter.searchActor.resultsTitle"}),componentDebugName:"SearchActorFilter"},performRequest:e=>async function(e,t,n,s){let{query:i,current:o}=e;const{allUserIds:a,allBotIds:r}=t.getState(),l=100,d=await O.FF.searchActions.load(),c=await d.searchActorsById({environment:s,query:i,userIds:[...a],botIds:[...r]}),u=[...c.users.map((e=>`notion_user:${e.id}`)),...c.bots.map((e=>`bot:${e.id}`))];if(i.length>0)return u.slice(0,l);const m=n.map(ae.eW),p=new Set(m),g=u.filter((e=>!p.has(e)));return[...m,...g].slice(0,Math.max(m.length,l))}(e,this.props.auditLogHistoricalUserStore,this.props.selectedActors,this.environment),renderResultMenuItem:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderResultMenuItem,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}}le.displayName="AuditLogActorFilter";const de=(0,f.injectIntl)(le);function ce(e,t){const n=(0,ae.Ij)(e);return n?"notion_user"===n.actorType?(0,te.m3)(function(e,t){return oe.U6.createChildStore(t,{table:D.KJ,id:e}).getValue()}(n.actorId,t)):(0,te.ON)(function(e,t){return(0,oe.Kv)(t,{table:R.cZ,id:e}).getValue()}(n.actorId,t)):(0,te.m3)(void 0)}function ue(e){let{item:t,props:n,auditLogHistoricalUserStore:s,parentStore:i,localStore:o}=e;const r=(0,f.useIntl)(),l=(0,a.qz)(o,re),d=(0,a.VK)((()=>ce(t,i)),[t,i]),u=(0,a.VK)((()=>l.state.tempSelections),[l]),m=(0,a.VK)((()=>{var e;return s.isUserOrBotRemoved(null===(e=d.asActor)||void 0===e?void 0:e.id)}),[d,s]);return(0,c.jsx)(ie.Z,{...n,actor:d,useEmailAsTooltip:!0,checkState:u.has(t),userTitle:(0,c.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,te.$4)(r,d),m&&(0,c.jsx)(se.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"auditlogActorFilter.removed_user",defaultMessage:"Removed"})})]})})}function me(e,t){const n=e.map(ae.eW);t.setTempSelections(n)}var pe=n(78931);const ge=(0,f.injectIntl)((function(e){const{spaceStore:t}=e,[n,s]=(0,a.AF)(E.Z),[i,o,r]=(0,a.AF)(K),l=(0,a.qz)(void 0,X.X),d=(0,a.qz)(void 0,X.X);return(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:4},children:[(0,c.jsx)(Q.Z,{mode:J.z.Pill,focused:!1,title:(0,c.jsx)(f.FormattedMessage,{id:"auditlogDateFilter.title",defaultMessage:"Date"}),icon:Y.C,value:n.timeRange,showButtons:"footer",onChange:e=>{s({...n,timeRange:e,pageNum:1})}}),(0,c.jsx)(de,{parentStore:t,auditLogHistoricalUserStore:r,selectedActors:n.actors,onChange:e=>{s({...n,actors:e,pageNum:1})}}),(0,c.jsx)(pe.Z,{lastSelectionStore:l,componentStore:d,onChange:e=>{s({...n,actions:e,pageNum:1})}})]})}));var fe=n(723189);function he(){return(0,c.jsx)(fe.Z,{large:!0,style:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:y.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("div",{style:{gap:8,display:"flex"},children:(0,c.jsx)(f.FormattedMessage,{id:"auditlog.title",defaultMessage:"Audit log"})})})}var ye=n(881549),xe=n(228971),Se=n(875553),ve=n(800893),be=n(740394),Me=n(164921),je=n(526388),Ce=n(164369),we=n(304708),ke=n(825464),Ie=n(319385),Te=n(621752);function Ze(e){const{auditLogEntry:t,spaceStore:n,id:i}=e,o=(0,f.useIntl)(),l=(0,a.VK)((()=>{if(t.actor.actorType===D.KJ){const e=oe.U6.createChildStore(n,{id:t.actor.actorId,table:D.KJ});if(e.isDefined()&&!e.getIsDeleted())return{actorStore:e};if(t.actor.email)return{avatar:{name:t.actor.name,email:t.actor.email}}}else if(t.actor.actorType===R.cZ){const e=oe.Qx.createChildStore(n,{id:t.actor.actorId,table:R.cZ});return e.isDefined()?{actorStore:e}:{avatar:{name:t.actor.name,email:t.actor.actorId}}}return{actorStore:void 0}}),[n,t]),d=(0,a.VK)((()=>{var e,t;if(l)return(null===(e=l.actorStore)||void 0===e?void 0:e.getDisplayName(o))??(null===(t=l.avatar)||void 0===t?void 0:t.name)}),[l,o]),u=(0,a.VK)((()=>{var e,t;if(l)return(null===(e=l.actorStore)||void 0===e?void 0:e.getDetail())??(null===(t=l.avatar)||void 0===t?void 0:t.email)}),[l]),m=(0,s.useMemo)((()=>{var e;if(t.actor.actorType===D.KJ)return(0,Te.K)(null===(e=t.actor.meta)||void 0===e?void 0:e.spaceRole)}),[t]),p=(0,r.yK)((()=>({container:{display:"block",width:"100%",paddingBlock:6}})),[]),g=(0,s.createRef)();return(0,c.jsx)(je.Z,{disableTooltip:Pe(g.current),renderTooltip:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{children:d}),(0,c.jsx)("div",{children:u})]}),placement:ke.u.Bottom,render:e=>(0,c.jsx)("div",{...e,style:p.container,children:(0,c.jsx)(Te.Z,{id:i,...l,spaceRole:m})})})}function Pe(e){return!!e&&(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}var Fe=n(119044),_e=n(433581),Ae=n(858015);const Be={id:"actor",headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"auditlog.logTable.userColumn.header",defaultMessage:"User"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`;return(0,c.jsx)(Ze,{spaceStore:e.spaceStore,auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:30},sortable:!1},Re={id:"event",headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"auditlog.logTable.eventColumn.header",defaultMessage:"Event"}),renderCell:e=>{const t=`event-${e.auditLogEntry.actionName}-${e.id}`;return(0,c.jsx)(_e.p,{auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:40},sortable:!1},De={id:"dateTimeAndMenu",headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"auditlog.logTable.dateColumn.header",defaultMessage:"Date"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`,n=`event-${e.auditLogEntry.actionName}-${e.id}`,s=`datetime-${e.auditLogEntry.actionName}-${e.id}`;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Fe.t,{auditLogEntry:e.auditLogEntry,id:s}),(0,c.jsx)(Ve,{auditLogEntry:e.auditLogEntry,ids:{actorColumnId:t,eventColumnId:n,dateTimeColumnId:s}})]})},widthData:{width:25},sortable:!0},Oe=[Be,Re,De];function Le(){return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40vh",flexDirection:"column"},children:[(0,c.jsx)("div",{children:(0,c.jsx)(Ce.Z,{isSecondaryColor:!0,style:{fontWeight:500},children:(0,c.jsx)(f.FormattedMessage,{id:"auditlog.logTable.noResults",defaultMessage:"No results"})})}),(0,c.jsx)(Ce.Z,{isSecondaryColor:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"auditlog.logTable.noResultsHelpText",defaultMessage:"Try different filters. Logs may take some time to show up."})})]})}function Ve(e){const{auditLogEntry:t,ids:n}=e,s=(0,a.VK)((()=>(0,we.F$)()),[]),o=(0,a.VK)((()=>Ie.default.checkGate({gateName:"audit_log_event_name_column"})?xe.pz:xe.C9),[]),l=(0,f.useIntl)(),d=(0,i.O7)(),u=(0,r.Fg)(),m=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%"},button:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4}})),[]);return(0,c.jsx)(je.Z,{delayThreshold:80,placement:ke.u.Bottom,render:e=>(0,c.jsx)("div",{style:m.container,...e,children:(0,c.jsx)(Me.Z,{style:m.button,onClick:()=>{var e;ve.RD({environment:d,stringValue:(0,xe.eA)({auditLogEntry:t,intl:l,getAuditLogEventText:(e=n.eventColumnId,t=>{var n;return null===(n=document.getElementById(e))||void 0===n?void 0:n.textContent}),isTeamGuestsEnabled:s,csvColumnNames:o}),copiedMessage:ve.tq.copiedToClipboard})},children:(0,Se.U)({width:16,height:16,fill:u.mediumIconColor})})}),renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"AuditLogSettings.copyAuditLogEvent",defaultMessage:"Copy row"})})}const Ee=(0,f.injectIntl)((function(e){const{searchResponse:t,spaceStore:n}=e,[i,o]=(0,a.AF)(E.Z),l=t.results||[],d=t.hasMoreResults,u=Boolean(l.length),m=e=>{const t={...i,pageNum:e};o(t)},p=(0,r.yK)((e=>(0,be.b)({columnRenderInfo:Oe,theme:e,containerMarginTop:0})),[]),g=l.map(((e,t)=>({id:t.toString(),auditLogEntry:e,spaceStore:n,isClickable:!1}))),h=(0,s.useCallback)((()=>{const e=i.sortOrder===B.NQ.CreatedOldest?B.NQ.CreatedNewest:B.NQ.CreatedOldest;o({...i,sortOrder:e,pageNum:1})}),[i,o]),y=(0,s.useMemo)((()=>({column:De,sortAscending:i.sortOrder===B.NQ.CreatedOldest})),[i]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(be.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Oe,rows:g,sortState:y,onSortStateChanged:h,renderNoRowsComponent:Le,styles:p}),u?(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10},children:[(0,c.jsx)(Ae.v,{onClick:()=>{m(i.pageNum-1)},disabled:1===i.pageNum,children:(0,c.jsx)(f.FormattedMessage,{id:"auditlog.logTable.previousPage",defaultMessage:"Previous"})}),(0,c.jsx)(Ae.v,{disabled:!d,onClick:()=>{m(i.pageNum+1)},children:(0,c.jsx)(f.FormattedMessage,{id:"auditlog.logTable.nextPage",defaultMessage:"Next"})})]}):null]})}));const Ne=(0,f.injectIntl)((function(e){const{spaceStore:t}=e,n=(0,i.O7)(),o=null==t?void 0:t.id,[r]=(0,a.AF)(z),[l]=(0,a.AF)(E.Z),d=(0,E.r)(l)!==r.filterStr?void 0:r.cachedResponses[l.pageNum];return(0,s.useEffect)((()=>{o&&async function(e){var t,n;const{environment:s,spaceId:i}=e,o=E.Z.getState();z.startLoading(i,o);const{sortOrder:a,pageSize:r,pageNum:l}=o,d={spaceId:i,limit:r,cursor:z.getCursor(i,o,l),filters:{timeRange:{starting:o.timeRange.starting?_.OQ.toUnixMs(o.timeRange.starting):void 0,ending:o.timeRange.ending?_.OQ.toUnixMs(o.timeRange.ending):void 0},...(null===(t=o.actors)||void 0===t?void 0:t.length)>0?{actors:o.actors}:void 0,...(null===(n=o.actions)||void 0===n?void 0:n.length)>0?{actions:o.actions}:void 0},sort:a||B.NQ.CreatedNewest},c=await I.searchAuditLog(s,d);if("success"!==c.type)if(z.updateError(i,o),(0,A.Jx)(c.body)){const e=(0,L.wf)(V.default.getIntl(),c);M.showErrorMessage(e)}else M.showErrorMessage(V.default.formatMessage(q.loadCurrentAuditLogError));else z.updateLoadedResult(i,o,c.data)}({environment:n,spaceId:o})}),[n,o,l]),(0,s.useEffect)((()=>{H({environment:n,spaceId:o})}),[n,o]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(he,{}),(0,c.jsxs)("div",{style:{justifyContent:"space-between",display:"flex",paddingTop:12,paddingBottom:12},children:[(0,c.jsx)(ge,{spaceStore:t}),(0,c.jsx)($.Z,{parentStore:t})]}),"loading"===(null==d?void 0:d.status)&&(0,c.jsx)(ye.Z,{}),"success"===(null==d?void 0:d.status)&&(0,c.jsx)(Ee,{searchResponse:d,spaceStore:t})]})}));var Ue=n(628020),Ke=n(843250),We=n(908989),ze=n(918514),qe=n(195697),Ge=n(80444),He=n(167940);class $e extends N.default{getInitialState(){return{status:"unconfigured",emailDomains:[],domainVerifications:[],spaces:[],createAccount:!1,useMetadataUrl:!0}}}const Ye=$e;var Qe=n(653680);class Je extends N.default{getInitialState(){return{displaySummary:!0,openDropdown:!1,query:""}}}const Xe=new Je;var et=n(124026);class tt extends N.default{getInitialState(){return{name:"",domain:"",domainState:"current-space",emailDomains:[],publicHomePage:void 0}}getValueForSpace(e){const t=e.getPublicContentDomain(),n=e.getPublicHomePage();if(e.isDefined())return{name:e.getName()||"",domain:t||"",emailDomains:e.getEmailDomains(),domainState:"current-space",publicHomePage:n}}}const nt=tt;class st extends N.default{getInitialState(){return{emailDomains:[],spaceCreation:"admins_only",settings:{}}}async updateValueForSpace(e){const{environment:t,spaceId:n,store:s}=e,i=await I.getEmailDomainsForSpace(t,{spaceId:n});if("failed"===i.type)return void M.showError(i);const{data:o}=i,a=Object.keys(o);return 0!==a.length?s.setState({emailDomains:a,spaceCreation:o[a[0]].spaceCreationEnum,settings:o[a[0]].settings}):s.setState(this.getInitialState()),s.state}}const it=st;class ot extends N.default{getInitialState(){return{uploadingProfilePhoto:!1,givenName:"",familyName:"",name:"",startDayOfWeek:(0,_.aN)(),accountSettings:{hasPassword:!1,canConfigurePassword:!1,isSamlEnforced:!1,mfaStatus:"loading",numMfaSettings:0,regenerateBackupCodes:!1,error:void 0}}}getValueForUser(e,t,n){if(e.isDefined()){const s=e.getFullName(n),i=e.getProfilePhoto(),o=t.getSettings();return{...this.state,uploadingProfilePhoto:!1,profilePhoto:i,name:s||"",startDayOfWeek:void 0===(null==o?void 0:o.start_day_of_week)?(0,_.aN)():null==o?void 0:o.start_day_of_week}}}}const at=ot;var rt=n(992083),lt=n(598905),dt=n(185703),ct=n(897630),ut=n(965991),mt=n(11751),pt=n(286572),gt=n(689024),ft=n(81254),ht=n(707124),yt=n(863296),xt=n(44041),St=n(681886),vt=n(170060),bt=n(535057),Mt=n(739284);function jt(e){let{currentSettingsTab:t}=e;const n=(0,i.O7)(),o=(0,r.yK)((e=>({aiIcon:{width:16,height:16,color:e.icon.purple},buttonStyle:{display:"flex",padding:"0px 12px 0px 10px",justifyContent:"center",alignItems:"center",gap:6,borderRadius:6,border:`1px solid ${e.stroke.regular}`}})),[]),l=(0,St.n_)()&&!["plans","billing"].includes(t),d=(0,Mt.P)(),u=(0,a.VK)((()=>!!d&&(0,vt.fD)(n)),[n,d]),m=s.useMemo((()=>u?(pt.zq(n,{from:"timed_trial_settings_sidebar"}),{onClick:()=>{xt.y(n,{from:"timed_trial_settings_sidebar",for:"plus",isTrial:!0})},text:(0,c.jsx)(f.FormattedMessage,{id:"timedTrialPopup.button",defaultMessage:"Try Plus for Free"}),icon:(0,c.jsx)(ft.x,{iconGroup:ut.$,colorName:"uiBluePrimary",variantName:"default"})}):l?{onClick:()=>{xt.y(n,{from:"ai_upsell_settings",for:(0,bt.zt)(),addOnFeature:"ai"})},text:(0,c.jsx)(f.FormattedMessage,{id:"AddOnUpsellNudge.title",defaultMessage:"Get unlimited AI"}),icon:(0,mt.t)(o.aiIcon)}:void 0),[n,l,u,o]);return m?(0,c.jsx)(gt.jX,{direction:"column",padding:16,align:"center-left",children:(0,c.jsxs)(yt.Z,{onClick:m.onClick,style:o.buttonStyle,children:[m.icon,(0,c.jsx)(ht.q,{styleName:"UIRegular-14px/Medium",children:m.text})]})}):null}var Ct=n(643421),wt=n(953336),kt=n(427386),It=n(193108),Tt=n(582356),Zt=n(747409),Pt=n(418442),Ft=n(115967),_t=n(401436),At=n(636312);const Bt=(0,d.IU)("settingsIntegration",{viewBox:"0 0 20 20",svg:(0,c.jsx)("path",{d:"M4.633 9.42h3.154c1.093 0 1.632-.532 1.632-1.656V4.655C9.42 3.532 8.88 3 7.787 3H4.633C3.532 3 3 3.532 3 4.655v3.109c0 1.124.532 1.655 1.633 1.655zm7.58 0h3.162C16.468 9.42 17 8.887 17 7.763V4.655C17 3.532 16.468 3 15.374 3h-3.16c-1.094 0-1.633.532-1.633 1.655v3.109c0 1.124.539 1.655 1.633 1.655zm-7.58-1.251c-.262 0-.382-.135-.382-.405V4.648c0-.27.12-.405.382-.405h3.146c.262 0 .39.135.39.405v3.116c0 .27-.128.405-.39.405H4.633zm7.588 0c-.262 0-.39-.135-.39-.405V4.648c0-.27.128-.405.39-.405h3.146c.262 0 .39.135.39.405v3.116c0 .27-.128.405-.39.405h-3.146zM4.633 17h3.154c1.093 0 1.632-.532 1.632-1.655v-3.109c0-1.124-.539-1.655-1.632-1.655H4.633C3.532 10.58 3 11.112 3 12.236v3.109C3 16.468 3.532 17 4.633 17zm7.58 0h3.162C16.468 17 17 16.468 17 15.345v-3.109c0-1.124-.532-1.655-1.626-1.655h-3.16c-1.094 0-1.633.531-1.633 1.655v3.109c0 1.123.539 1.655 1.633 1.655zm-7.58-1.25c-.262 0-.382-.128-.382-.398v-3.116c0-.277.12-.405.382-.405h3.146c.262 0 .39.128.39.405v3.116c0 .27-.128.397-.39.397H4.633zm7.588 0c-.262 0-.39-.128-.39-.398v-3.116c0-.277.128-.405.39-.405h3.146c.262 0 .39.128.39.405v3.116c0 .27-.128.397-.39.397h-3.146z"})}),Rt=(0,d.IU)("settingsLanguage",{viewBox:"0 0 20 20",svg:(0,c.jsx)("path",{d:"M10 18.3281C14.3594 18.3281 17.9688 14.7109 17.9688 10.3594C17.9688 6 14.3516 2.39062 9.99219 2.39062C5.64062 2.39062 2.03125 6 2.03125 10.3594C2.03125 14.7109 5.64844 18.3281 10 18.3281ZM5.32812 5.29688C6.10938 4.57031 7.0625 4.02344 8.10938 3.71875C7.57031 4.26562 7.10938 5.03906 6.76562 5.99219C6.21094 5.8125 5.72656 5.57812 5.32812 5.29688ZM11.8984 3.72656C12.9375 4.03125 13.8828 4.57812 14.6719 5.30469C14.2734 5.58594 13.7891 5.8125 13.2344 5.99219C12.8906 5.04688 12.4297 4.27344 11.8984 3.72656ZM7.77344 6.25C8.21094 5.05469 8.82031 4.19531 9.49219 3.89844V6.42969C8.875 6.40625 8.30469 6.34375 7.77344 6.25ZM10.5156 3.89844C11.1797 4.19531 11.7891 5.05469 12.2266 6.25C11.6953 6.34375 11.125 6.40625 10.5156 6.42969V3.89844ZM3.10938 9.84375C3.21875 8.42188 3.77344 7.10156 4.63281 6.03906C5.11719 6.40625 5.74219 6.71094 6.46875 6.94531C6.24219 7.82031 6.10156 8.79688 6.0625 9.84375H3.10938ZM13.9375 9.84375C13.8984 8.79688 13.7578 7.82031 13.5312 6.94531C14.2578 6.71094 14.8828 6.40625 15.3594 6.04688C16.2266 7.10156 16.7812 8.42188 16.8906 9.84375H13.9375ZM10.5156 9.84375V7.45312C11.2188 7.42969 11.8906 7.34375 12.5234 7.21094C12.7266 8.01562 12.8516 8.90625 12.8906 9.84375H10.5156ZM7.10938 9.84375C7.14844 8.90625 7.28125 8.01562 7.47656 7.21094C8.10938 7.34375 8.78125 7.42969 9.49219 7.45312V9.84375H7.10938ZM3.10938 10.8672H6.0625C6.10156 11.9375 6.24219 12.9219 6.46875 13.8047C5.75 14.0391 5.13281 14.3438 4.65625 14.7031C3.78125 13.6328 3.21875 12.3047 3.10938 10.8672ZM7.10938 10.8672H9.49219V13.3047C8.78906 13.3281 8.11719 13.4141 7.49219 13.5391C7.28125 12.7266 7.14062 11.8203 7.10938 10.8672ZM10.5156 13.3047V10.8672H12.8906C12.8594 11.8203 12.7188 12.7266 12.5078 13.5391C11.8906 13.4141 11.2109 13.3281 10.5156 13.3047ZM13.5312 13.8047C13.7578 12.9219 13.8984 11.9375 13.9375 10.8672H16.8906C16.7812 12.3047 16.2188 13.6328 15.3438 14.7031C14.8672 14.3438 14.25 14.0391 13.5312 13.8047ZM10.5156 14.3281C11.1172 14.3516 11.6875 14.4062 12.2109 14.5078C11.7734 15.6719 11.1719 16.5312 10.5156 16.8281V14.3281ZM7.78906 14.5078C8.3125 14.4062 8.88281 14.3516 9.49219 14.3281V16.8281C8.82812 16.5312 8.22656 15.6719 7.78906 14.5078ZM13.2266 14.7578C13.7734 14.9375 14.25 15.1641 14.6484 15.4375C13.8672 16.1484 12.9375 16.6875 11.9062 16.9922C12.4297 16.4531 12.8828 15.6875 13.2266 14.7578ZM5.35156 15.4375C5.75 15.1641 6.22656 14.9375 6.77344 14.7578C7.11719 15.6875 7.57031 16.4531 8.10156 16.9922C7.07031 16.6875 6.13281 16.1484 5.35156 15.4375Z"})});var Dt=n(605108);const Ot=(0,d.IU)("settingsNotifications",{viewBox:"3 1 17 17",svg:(0,c.jsx)("path",{d:"M5.36914 13.7627C5.36914 13.0381 6.03906 12.416 6.6543 11.8145C7.13965 11.3428 7.24902 10.3994 7.33789 9.46289C7.42676 6.87207 8.17871 5.14258 9.96289 4.49316C10.2227 3.59082 10.9814 2.90039 12 2.90039C13.0186 2.90039 13.7773 3.59082 14.0371 4.49316C15.8213 5.14258 16.5732 6.87207 16.6621 9.46289C16.751 10.3994 16.8672 11.3428 17.3457 11.8145C17.9678 12.416 18.6309 13.0381 18.6309 13.7627C18.6309 14.3369 18.2002 14.7266 17.4893 14.7266H14.6797C14.6182 16.0391 13.5518 17.2285 12 17.2285C10.4482 17.2285 9.38184 16.0322 9.32031 14.7266H6.51074C5.80664 14.7266 5.36914 14.3369 5.36914 13.7627ZM7.00293 13.4756H16.9834V13.3936C16.8125 13.1953 16.4297 12.833 16.0879 12.4434C15.623 11.9033 15.3975 10.9258 15.3291 9.62695C15.2539 6.85156 14.3994 5.92871 13.2988 5.62793C13.1279 5.58691 13.0322 5.50488 13.0186 5.32031C12.9912 4.62305 12.6016 4.1582 12 4.1582C11.3984 4.1582 11.0156 4.62305 10.9814 5.32031C10.9678 5.50488 10.8721 5.58691 10.708 5.62793C9.60059 5.92871 8.75293 6.85156 8.6709 9.62695C8.60254 10.9258 8.38379 11.9033 7.91211 12.4434C7.57715 12.833 7.18066 13.1953 7.00293 13.3936V13.4756ZM10.6123 14.7266C10.667 15.5811 11.2275 16.1348 12 16.1348C12.7793 16.1348 13.3398 15.5811 13.3877 14.7266H10.6123Z"})});var Lt=n(64530),Vt=n(505517),Et=n(262397);const Nt=(0,d.IU)("settingsSubscription",{viewBox:"0 0 20 20",svg:(0,c.jsx)("path",{d:"M9 18.6191C13.9043 18.6191 17.9648 14.5498 17.9648 9.6543C17.9648 4.75 13.8955 0.689453 8.99121 0.689453C4.0957 0.689453 0.0351562 4.75 0.0351562 9.6543C0.0351562 14.5498 4.10449 18.6191 9 18.6191ZM9 17.125C4.85156 17.125 1.53809 13.8027 1.53809 9.6543C1.53809 5.50586 4.84277 2.18359 8.99121 2.18359C13.1396 2.18359 16.4619 5.50586 16.4707 9.6543C16.4795 13.8027 13.1484 17.125 9 17.125ZM5.07129 10.0586C5.07129 12.2559 6.82031 14.0225 8.99121 14.0225C11.1621 14.0225 12.9111 12.2559 12.9111 10.085C12.9111 9.75977 12.6299 9.49609 12.3047 9.49609C11.9795 9.49609 11.6982 9.75977 11.6982 10.085C11.6982 11.5967 10.4941 12.8096 8.99121 12.8096C7.48828 12.8096 6.28418 11.5967 6.28418 10.085C6.28418 8.58203 7.48828 7.38672 8.99121 7.38672C9.10547 7.38672 9.22852 7.38672 9.31641 7.4043L8.45508 8.24805C8.34961 8.35352 8.28809 8.49414 8.28809 8.65234C8.28809 8.95996 8.53418 9.20605 8.8418 9.20605C8.99121 9.20605 9.13184 9.13574 9.22852 9.03906L10.9336 7.33398C11.1533 7.13184 11.1357 6.73633 10.9336 6.52539L9.24609 4.80273C9.14941 4.69727 9 4.62695 8.8418 4.62695C8.52539 4.62695 8.28809 4.88184 8.28809 5.18945C8.28809 5.34766 8.34961 5.48828 8.44629 5.59375L9.07031 6.22656C9 6.21777 8.90332 6.20898 8.82422 6.20898C6.84668 6.20898 5.07129 7.90527 5.07129 10.0586Z"})});var Ut=n(172263),Kt=n(373039),Wt=n(953877),zt=n(646783),qt=n(669196),Gt=n(88893),Ht=n(288280),$t=n(974420),Yt=n(39849),Qt=n(559054),Jt=n(125829),Xt=n(619584),en=n(28092);function tn(e){let{spaceStore:t,requestType:n}=e;const s=nn({spaceStore:t}),o=(0,i.O7)(),[{value:r=[]}]=(0,Qt.r5)((async()=>{if(!s)return;const e=await I.getAccessRequests(o,{parentTable:"space",parentId:t.id,size:100,status:"pending"});if("failed"===e.type)throw e.error;const n=e.data.accessRequestIds;return x.Vy(o,t,n)}),[t,o,s]),l=(0,a.VK)((()=>r.filter((e=>"pending"===e.accessRequest.status))),[r]),d=(0,en.E)({spaceStore:t,requests:l}),c=(0,a.VK)((()=>(0,h.$R)(l,d??[]).filter((e=>{const[t,s]=e;return"member"===n&&"space_membership_request"===s||"guest"===n&&"guest_invite_request"===s})).map((e=>{let[t]=e;return t}))),[n,d,l]);return(0,h.oA)(c)}function nn(e){let{spaceStore:t}=e;return(0,a.VK)((()=>t.canEditMembership()&&(0,we.p1)()),[t])}function sn(e){let{requestType:t,spaceStore:n}=e;const s=tn({spaceStore:n,requestType:t});return(0,a.VK)((()=>{const{currentSpaceViewStore:e}=Ge.default.state;if(e)return s.filter((n=>{const s=function(e){var t,n;let{requestType:s,currentSpaceViewStore:i}=e;const o=Date.now()-10*Xt._I,a="member"===s?null===(t=i.getSettings())||void 0===t?void 0:t.last_opened_member_request_tab:null===(n=i.getSettings())||void 0===n?void 0:n.last_opened_guest_request_tab;return a??o}({requestType:t,currentSpaceViewStore:e});return s<n.accessRequest.created_time})).length}),[t,s])}function on(e){let{requestType:t,spaceStore:n}=e;const o=(0,i.O7)(),a=nn({spaceStore:n});(0,s.useEffect)((()=>{const{currentSpaceViewStore:e}=Ge.default.state;e&&a&&"member"!==t&&P.createAndCommit({userAction:"SpaceSettingsRequests.updateLastOpened",environment:o,perform:t=>{P.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings","last_opened_guest_request_tab"],command:"set",args:Date.now()},transaction:t})}})}),[t,o,a]),(0,s.useEffect)((()=>()=>{const{currentSpaceViewStore:e}=Ge.default.state;e&&a&&"guest"!==t&&P.createAndCommit({userAction:"SpaceSettingsRequests.updateLastOpened",environment:o,perform:t=>{P.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings","last_opened_member_request_tab"],command:"set",args:Date.now()},transaction:t})}})}),[t,o,a])}function an(){const e=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]);return e?(0,c.jsx)(rn,{spaceStore:e}):null}function rn(e){let{spaceStore:t}=e;const n=(sn({spaceStore:t,requestType:"guest"})??0)+(sn({spaceStore:t,requestType:"member"})??0),s=(0,r.yK)((e=>({container:{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",right:6,top:6},badge:{top:-3,right:-5}})),[]);return 0===n?null:(0,c.jsx)("div",{style:s.container,children:(0,c.jsx)(Yt.Z,{count:n,style:s.badge,color:Yt.N.Red})})}const ln=(0,f.defineMessages)({accountTab:{id:"spaceSettingsSidebar.accountTab.title",defaultMessage:"My account"},settingsTab:{id:"spaceSettingsSidebar.settingsTab.title",defaultMessage:"Settings"},teamsTab:{id:"spaceSettingsSidebar.teamsTab.title",defaultMessage:"Teamspaces"},peopleTab:{id:"spaceSettingsSidebar.peopleTab.title",defaultMessage:"People"},membersTab:{id:"spaceSettingsSidebar.membersTab.title",defaultMessage:"Members"},plansTab:{id:"spaceSettingsSidebar.plansTab.title",defaultMessage:"Plans"},explorePlansTab:{id:"spaceSettingsSidebar.explorePlansTab.title",defaultMessage:"Explore plans"},upgradeTab:{id:"spaceSettingsSidebar.upgradeTab.title",defaultMessage:"Upgrade"},upgradePlanTab:{id:"spaceSettingsSidebar.upgradePlanTab.title",defaultMessage:"Upgrade plan"},billingTab:{id:"spaceSettingsSidebar.billingTab.title",defaultMessage:"Billing"},subscriptionTab:{id:"spaceSettingsSidebar.subscriptionTab.title",defaultMessage:"Subscription"},connectedAppsTab:{id:"spaceSettingsSidebar.connectedAppsTab.title",defaultMessage:"My connected apps"},userConnectionsTab:{id:"spaceSettingsSidebar.userConnectionsTab.title",defaultMessage:"My connections"},securityTab:{id:"spaceSettingsSidebar.securityTab.title",defaultMessage:"Security"},securityAndDataTab:{id:"spaceSettingsSidebar.securityAndDataTab.title",defaultMessage:"Security & data"},identityProvisioningTab:{id:"spaceSettingsSidebar.identity&ProvisioningTab.title",defaultMessage:"Identity & provisioning"},sitesTab:{id:"spaceSettingsSidebar.sites.title",defaultMessage:"Sites"},adminContentSearchTab:{id:"spaceSettingsSidebar.adminContentSearch.title",defaultMessage:"Content search"},languageAndRegionTab:{id:"spaceSettingsSidebar.languageAndRegionTab.title",defaultMessage:"Language & region"},integrationsTab:{id:"spaceSettingsSidebar.integrationsTab.title",defaultMessage:"Integrations"},spaceConnectionsTab:{id:"spaceSettingsSidebar.spaceConnectionsTab.title",defaultMessage:"Connections"},experimentsTab:{id:"spaceSettingsSidebar.experimentsTab.title",defaultMessage:"Experiments"},auditLogTab:{id:"spaceSettingsSidebar.auditLogTab.title",defaultMessage:"Audit log"},notificationsAndSettings:{id:"spaceSettingsSidebar.notificationsAndSettings.title",defaultMessage:"My notifications & settings"},mySettings:{id:"spaceSettingsSidebar.mySettings.title",defaultMessage:"My settings"},myNotifications:{id:"spaceSettingsSidebar.myNotifications.title",defaultMessage:"My notifications"},debugZoneTab:{id:"spaceSettingsSidebar.debugZoneTab.title",defaultMessage:"Debug Zone"},analyticsTab:{id:"spaceSettingsSidebar.analyticsTab.title",defaultMessage:"Analytics"},importTab:{id:"spaceSettingsSidebar.importsTab.title",defaultMessage:"Import"}}),dn={width:20,height:20},cn={profile:e=>(0,qt.H)(dn),notifications_and_settings:()=>(0,Lt.y)(dn),user_settings:()=>(0,Lt.y)(dn),notifications:()=>Ot(dn),connected_apps:()=>(0,_t.g)(dn),language_and_region:()=>Rt(dn),settings:()=>(0,Pt.H)(dn),teams:()=>(0,Kt.K)(dn),members:()=>(0,Dt.n)(dn),plans:()=>{const e=Ht.subscriptionDataStoreInstance.state;return e&&Gt.YK(e)?(0,Vt.q)(dn):(0,Ut._)(dn)},billing:()=>(0,Ft.J)(dn),subscription:()=>Nt(dn),security:()=>(0,Et.I)(dn),identity_provisioning:()=>(0,At.o)(dn),admin_content_search:()=>(0,It.p)(dn),integrations:()=>Bt(dn),experiments:()=>(0,mt.t)(dn),audit_log:()=>(0,Zt.N)(dn),debug_zone:()=>(0,zt.w)(dn),analytics:()=>u(dn),imports:()=>(0,Tt.l)(dn),sites:()=>(0,Wt.u)(dn)},un={profile:()=>`${V.default.formatMessage(ln.accountTab)}`,notifications_and_settings:()=>V.default.formatMessage(ln.notificationsAndSettings),user_settings:()=>V.default.formatMessage(ln.mySettings),notifications:()=>V.default.formatMessage(ln.myNotifications),connected_apps:()=>V.default.formatMessage(ln.userConnectionsTab),language_and_region:()=>V.default.formatMessage(ln.languageAndRegionTab),settings:()=>V.default.formatMessage(ln.settingsTab),teams:()=>V.default.formatMessage(ln.teamsTab),members:e=>(0,we.F$)()||(0,we.wE)(e)?V.default.formatMessage(ln.peopleTab):V.default.formatMessage(ln.membersTab),plans:()=>function(){const e=Ht.subscriptionDataStoreInstance.state;if(Gt.YK(e))return(0,vt.Lv)()?V.default.formatMessage(ln.explorePlansTab):V.default.formatMessage(ln.plansTab);return(0,vt.wP)()?V.default.formatMessage(ln.upgradePlanTab):V.default.formatMessage(ln.upgradeTab)}(),billing:()=>V.default.formatMessage(ln.billingTab),subscription:()=>V.default.formatMessage(ln.subscriptionTab),security:()=>{const e=Ie.default.checkGate({gateName:"cdrr_workspace_settings"})&&bt.wP()||Ie.default.checkGate({gateName:"cdrr_deletion_enabled"})?ln.securityAndDataTab:ln.securityTab;return V.default.formatMessage(e)},identity_provisioning:()=>V.default.formatMessage(ln.identityProvisioningTab),admin_content_search:()=>V.default.formatMessage(ln.adminContentSearchTab),integrations:()=>V.default.formatMessage(ln.spaceConnectionsTab),experiments:()=>V.default.formatMessage(ln.experimentsTab),audit_log:()=>V.default.formatMessage(ln.auditLogTab),debug_zone:()=>V.default.formatMessage(ln.debugZoneTab),analytics:()=>V.default.formatMessage(ln.analyticsTab),imports:()=>V.default.formatMessage(ln.importTab),sites:()=>V.default.formatMessage(ln.sitesTab)},mn={profile:()=>null,notifications_and_settings:()=>null,user_settings:()=>null,notifications:()=>null,connected_apps:()=>null,language_and_region:()=>null,settings:()=>null,teams:()=>null,members:e=>(0,we.wE)(e)&&(0,c.jsx)(an,{}),plans:()=>null,billing:()=>null,subscription:()=>null,security:()=>bt.wP()&&Ie.default.checkGate({gateName:"cdrr_workspace_settings"})||Ie.default.checkGate({gateName:"cdrr_deletion_enabled"})?(0,c.jsx)($t.Z,{}):null,identity_provisioning:()=>null,sites:()=>null,admin_content_search:()=>null,integrations:()=>null,experiments:()=>null,audit_log:()=>null,debug_zone:()=>null,analytics:()=>null,imports:()=>null};var pn=n(489728);const gn=(0,f.defineMessages)({apply_credit:{id:"spaceSubscriptionBilling.applyCreditButton.label",defaultMessage:"Apply credit"},update:{id:"spaceSubscriptionBilling.updateButton.label",defaultMessage:"Update"},add:{id:"spaceSubscriptionBilling.addButton.label",defaultMessage:"Add"},apply:{id:"spaceSubscriptionBilling.apply.label",defaultMessage:"Apply"}});const fn=(0,f.injectIntl)((function(e){const t=(0,r.Fg)(),n={marginLeft:18,marginRight:-4,fontWeight:y.Z.fontWeight.medium},{title:s,caption:i,buttonArgs:o}=e,a=(0,c.jsx)(f.FormattedMessage,{...gn[o.buttonPurpose]});return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:14},children:[(0,c.jsx)("div",{style:{marginRight:"auto"},children:s}),(0,c.jsx)("div",{style:{color:t.mediumTextColor},children:i}),(0,c.jsx)("div",{style:{minWidth:110,display:"flex",justifyContent:"flex-end"},children:o.showButton&&(0,c.jsx)(pn.Z,{isBlue:!0,onClick:o.onClick,style:n,children:a})})]})}));var hn=n(434859),yn=n(788632),xn=n(93349);const Sn={workspaceBalance:(0,c.jsx)(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.workspaceSubscriptionBalance.title",defaultMessage:"Workspace balance"}),applyCoupon:(0,c.jsx)(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.applyCoupon.title",defaultMessage:"Apply coupon"}),discount:(0,c.jsx)(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.discount.title",defaultMessage:"Discount"})};var vn=n(31796),bn=n(727533);const Mn={height:"100%",padding:"36px 60px"},jn={display:"flex",flexDirection:"column",height:"100%"};const Cn=function(e){let{data:t,spaceStore:n}=e;const s=(0,i.O7)(),r=(0,a.qz)(void 0,xn.Z),l=(0,f.useIntl)(),d=(0,a.VK)((()=>yn.Z.state),[]),u=(0,a.VK)((()=>r.state),[r]);return(0,o.Z)((()=>{ct.bi(s),ct.zb(s,r)})),d.online?(0,c.jsx)("div",{style:jn,children:(0,c.jsxs)(wt.Z,{style:Mn,type:hn.Z.Y,children:[(0,c.jsx)(fe.Z,{large:!0,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{...ln.billingTab})}),(0,c.jsx)(wn,{data:t}),(0,c.jsx)(kn,{}),(0,c.jsx)(vn.V,{spaceStore:n,events:u.billingEvents,upcomingInvoiceData:void 0})]})}):(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(Ce.Z,{isSmall:!0,style:{textAlign:"center"},children:l.formatMessage(Ct.s.offline)})})};function wn(e){var t;let{data:n}=e;const s=null===(t=n.customerData)||void 0===t?void 0:t.stripe.currencyCode;if(!s)return null;const i=-Math.min(0,n.accountBalance);return(0,c.jsx)(fn,{title:Sn.workspaceBalance,caption:(0,c.jsx)("div",{children:(0,c.jsx)(bn.W,{cost:{amount:i,currencyCode:s},trailingZeroDisplay:"stripIfInteger"})}),buttonArgs:{showButton:!1,buttonPurpose:"apply_credit",onClick:h.ZT}})}function kn(){return(0,c.jsx)("div",{style:{flex:"none",marginTop:30}})}var In=n(665543),Tn=n(105220),Zn=n(401898),Pn=n(883165),Fn=n(560396);class _n extends N.default{getInitialState(){return{loadingState:"uninitialized"}}}const An=new _n;async function Bn(e){let{environment:t,messageStoreEmitValue:n}=e;if(!function(e){const t=An.state;if("loading"===t.loadingState)return!1;if(("uninitialized"===t.loadingState?void 0:t.messageStoreEmitValue)===e)return!1;return!0}(n))return!1;const{currentSpaceStore:s,currentUserStore:i}=Ge.default.state;if(!s||!i)return!1;"uninitialized"===An.state.loadingState&&An.setState({loadingState:"loading"});const o=await async function(e){let{environment:t,currentSpaceStore:n,currentUserStore:s}=e;const i=n.getModel(),o=s.id,a=(0,Pn.VK)(n,o).getModel();if(void 0===i||void 0===a)return;if((0,Tn.RI)({space:i,spaceUser:a})){return await(0,qe.sj)({environment:t,spaceStore:n,includeArchived:!0,currentUserId:o,minRoleOnTeamStores:"reader"})}return await(0,qe.qX)({environment:t,spaceStore:n,includeArchived:!0,currentUserId:s.id})}({environment:t,currentSpaceStore:s,currentUserStore:i});if(!(0,Zn.$K)(o))return An.setState({loadingState:"uninitialized"}),!1;const{archivedTeams:a,unarchivedTeams:r}=(0,qe.tV)(o);return An.setState({loadingState:"loaded",archivedTeamIds:a.map((e=>e.id)),unarchivedTeamIds:r.map((e=>e.id)),messageStoreEmitValue:n}),!0}var Rn=n(62944),Dn=n(815047),On=n(76463),Ln=n(798688),Vn=n(61202),En=n(823586),Nn=n(548779),Un=n(672087),Kn=(n(757658),n(509999)),Wn=n(180920),zn=n(474181),qn=n(590965),Gn=n(994826),Hn=n(709953),$n=n(177150),Yn=n(372371),Qn=n(474021),Jn=n(517549),Xn=n(530874),es=n(820454),ts=n(622616),ns=n(333493),ss=n(747453),is=n(531701),os=n(223196),as=n(977657),rs=n(509844),ls=n(307032),ds=n(95477),cs=n(460709),us=n(675822),ms=n(552275),ps=n(478140),gs=n(828992),fs=n(632163),hs=n(731278),ys=n(672495),xs=n(278948);function Ss(e){const{query:t}=e,n=(0,i.O7)(),o=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),r=(0,a.VK)((()=>null==o?void 0:o.getBotSettingsStore().getValue()),[o]),l="approved_or_built_by_notion"===(null==r?void 0:r.integration_restrictions),d=(0,a.VK)((()=>null!=r&&r.integration_approval_statuses?Object.keys(r.integration_approval_statuses):[]),[r]),u=(0,a.VK)((()=>Object.keys(as.u2).map((e=>{const t=null==o?void 0:o.getRecordModel({id:e,table:rs.K2});if("published"===(null==t?void 0:t.status))return e})).filter(Zn.$K)),[o]),m=(0,s.useMemo)((()=>u.some((e=>e===as.f3))),[u]),p=(0,a.VK)((()=>u.filter((e=>!d.includes(e))).slice(0,5)),[d,u]);return(0,c.jsx)(ps.Z,{menuType:cs.og.Popup,width:255,header:Ms(t,p,l),children:(0,c.jsx)(En.Z,{request:t,performRequest:e=>async function(e){const{query:t,integrationType:n,environment:s,spaceId:i,approvedIntegrationIds:o,popularIntegrationIds:a,autoApproveBuiltByNotion:r}=e;if(!yn.Z.state.online||!i)return[];if((0,ls.e)(t)||(0,ls.qn)(t))return[t];if(""===t&&!r)return a;const l=await I.searchIntegrations(s,{query:t,type:n,spaceId:i});if("success"===l.type){const e=l.data.integrationIds.filter((e=>!o.includes(e))),t="production";if(!r){return e.sort(((e,n)=>(0,as.BP)({integrationId:e,env:t})===(0,as.BP)({integrationId:n,env:t})?0:(0,as.BP)({integrationId:e,env:t})?-1:1)).slice(0,5)}return e.filter((e=>!(0,as.BP)({integrationId:e,env:t}))).slice(0,5)}if("failed"===l.type)throw l.error;return(0,Zn.t1)(l)}({query:e,environment:n,spaceId:null==o?void 0:o.id,approvedIntegrationIds:d,popularIntegrationIds:p,autoApproveBuiltByNotion:l}),debounce:us.vp,render:(s,i,a)=>{if(!i||!a)return(0,c.jsx)(ys.Z,{children:(0,c.jsx)(xs.Z,{})});const l=zn.ns.filter((e=>t&&e.name.toLowerCase().includes(t.toLowerCase())&&!d.includes(e.id)&&(e.id!==zn._o||!m))),u=[];if(0===i.length&&0===l.length)u.push({key:"no_results",render:()=>(0,c.jsx)(Ce.Z,{isSmall:!0,style:{marginLeft:8},children:(0,c.jsx)(f.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})}),action:()=>{}});else{const t=i.map((t=>{var s;const i={table:rs.K2,id:t};if(!o)return;const a=oe.y2.createChildStore(o,i),l=null===(s=a.getInfo())||void 0===s?void 0:s.icon;return{key:`${t}`,render:e=>{var t;return(0,c.jsx)(ms.Z,{...e,title:(0,c.jsx)(Ce.Z,{style:{fontWeight:y.Z.fontWeight.semibold},children:a.getName()}),icon:l&&(0,c.jsx)(hs.Z,{disabled:!0,icon:{pointer:i,icon:l},isEmptyPage:!1,size:20}),style:l?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:(0,c.jsx)(js,{tagline:null===(t=a.getInfo())||void 0===t?void 0:t.tagline,isNotionIntegration:(0,as.BP)({integrationId:a.id,env:"production"})}),className:"notranslate"})},action:()=>{e.closeDropdown(),bs({environment:n,currentSpaceStore:o,botSettings:r,integrationId:t})}}})).filter(Zn.$K),s=l.map((t=>({key:`${t.id}`,render:e=>(0,c.jsx)(ms.Z,{...e,title:(0,c.jsx)(Ce.Z,{style:{fontWeight:y.Z.fontWeight.semibold},children:t.name}),icon:(0,c.jsx)("img",{src:t.info.icon,style:{height:20}}),caption:t.info.tagline,style:{paddingBottom:12},shouldWrapCaption:!0,className:"notranslate"}),action:()=>{e.closeDropdown(),bs({environment:n,currentSpaceStore:o,botSettings:r,integrationId:t.id})}}))).filter(Zn.$K);u.push(...t,...s)}return(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,c.jsx)(ys.Z,{...e}),items:u}]})}})})}function vs(e){const{query:t}=e,n=(0,i.O7)(),s=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]);return s?(0,c.jsx)(ps.Z,{menuType:cs.og.Popup,width:255,header:Ms(t,[],!1),children:(0,c.jsx)(En.Z,{request:t,performRequest:e=>async function(e){const{query:t,environment:n,spaceId:s}=e;if(!yn.Z.state.online||!s)return[];if((0,ls.e)(t)||(0,ls.qn)(t))return[t];const i=await I.searchIntegrations(n,{query:t,type:"compliance",spaceId:s});if("success"===i.type)return i.data.integrationIds;if("failed"===i.type)throw i.error;return(0,Zn.t1)(i)}({query:e,environment:n,spaceId:null==s?void 0:s.id}),debounce:us.vp,render:(t,n,i)=>{if(!n||!i)return(0,c.jsx)(ys.Z,{children:(0,c.jsx)(xs.Z,{})});const o=[];if(0===n.length)o.push({key:"no_results",render:()=>(0,c.jsx)(Ce.Z,{isSmall:!0,style:{marginLeft:8},children:(0,c.jsx)(f.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})}),action:()=>{}});else{const t=Yn.Z.state.loaded&&Xn.Z.state.loaded?Yn.Z.state.webhookSubscriptions.map((e=>{var t;return null===(t=Xn.Z.getBotsAsRecordMap().getValue({table:R.cZ,id:e.bot_id}))||void 0===t?void 0:t.integration_id})):[],i=n.map((n=>{var i;const o=oe.y2.createChildStore(s,{id:n,table:rs.K2});if(t.includes(n))return;const a={table:rs.K2,id:n},r=oe.y2.createChildStore(s,a),l=null===(i=r.getInfo())||void 0===i?void 0:i.icon,d=(0,Gn.I$)(r.id);return{key:`${n}`,render:e=>(0,c.jsx)(ms.Z,{...e,title:(0,c.jsxs)("div",{style:{display:"flex",float:"left",alignItems:"center"},children:[(0,c.jsx)(Ce.Z,{style:{fontWeight:y.Z.fontWeight.semibold},children:r.getName()}),(null==d?void 0:d.type)&&(0,c.jsx)("div",{style:{marginLeft:4},children:(0,c.jsx)(se.Z,{children:d.type})})]}),icon:l&&(0,c.jsx)(hs.Z,{disabled:!0,icon:{pointer:a,icon:l},isEmptyPage:!1,size:20}),style:null!=d&&d.icon?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:(0,c.jsx)(js,{tagline:null!=d&&d.tagline?V.default.formatMessage(null==d?void 0:d.tagline):"A SIEM or DLP partner",isNotionIntegration:!1})}),action:()=>{var t;e.closeDropdown();o.getModel()&&(null!=d&&null!==(t=d.oauth)&&void 0!==t&&t.accountInfoPropertyNames||"dlp"===(null==d?void 0:d.type))?Jn.Z.setState({open:!0,integrationId:r.id}):Qn.Z.setState({open:!0,integrationId:r.id})}}})).filter(Zn.$K);o.push(...i)}return(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,c.jsx)(ys.Z,{...e}),items:o}]})}})}):null}function bs(e){const{environment:t,currentSpaceStore:n,botSettings:s,integrationId:i}=e;if(n&&!(0,Gn.z6)(i)){const e={...null==s?void 0:s.integration_approval_statuses,[i]:{type:"integration",status:"approved"}};P.createAndCommit({userAction:"AdminIntegrationSettingsSearchResults.handleIntegrationSelection",environment:t,perform:t=>{Hn.sW({store:n,data:{bot_settings:{...s,integration_approval_statuses:e}},transaction:t})}})}}function Ms(e,t,n){return!e&&!n&&t.length>0&&(0,c.jsx)(gs.Z,{title:(0,c.jsx)(Ce.Z,{isSmall:!0,style:{marginTop:4,fontWeight:y.Z.fontWeight.medium},children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Popular integrations",id:"adminIntegrationSettings.search.title.popularIntegrations"})})})}function js(e){const{tagline:t,isNotionIntegration:n}=e,s=(0,r.Fg)(),i=n?{}:{maxHeight:52,overflow:"auto"};return t?(0,c.jsxs)("div",{style:i,children:[t,n&&(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:8},children:[(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Developed by Notion",id:"adminIntegrationSettings.search.subtitle.notionBuilt"}),(0,Wn.X)({marginLeft:3,width:12,height:12,fill:s.invoiceGreen})]})]}):null}var Cs=n(374194),ws=n(953437);const ks=(0,f.defineMessages)({searchInputPlaceholder:{id:"adminConnectionsSettings.search.input.placeholder",defaultMessage:"Add by name or integration ID"},complianceIntegrationSearchInputPlaceholder:{id:"adminConnectionsSettings.search.input.complianceIntegrationPlaceholder",defaultMessage:"Add by name"}});function Is(){const e=(0,i.MO)(),t=(0,r.Fg)(),[n,o]=(0,s.useState)(!0),[a,l]=(0,s.useState)(!1),[d,u]=(0,s.useState)(""),m=s.createRef();return n?(0,c.jsx)(Me.Z,{style:{display:"flex",alignItems:"center",height:28,fontWeight:y.Z.fontWeight.medium,fontSize:y.Z.fontSize.UIRegular.desktop,color:is.ZP.blue,padding:"0px 6px"},onClick:()=>{o(!1)},children:(0,c.jsx)(f.FormattedMessage,{id:"adminConnectionsSettings.search.button.label",defaultMessage:"{plusIcon} Add approved connection",values:{plusIcon:(0,ss.R)({fill:is.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})}):(0,c.jsx)(ws.ZP,{alignmentToOrigin:ws.ZP.Alignment.Start,keepFocus:e,onDismiss:()=>{var e;null===(e=m.current)||void 0===e||e.handleBlur(),o(!0),l(!1)},origin:(0,c.jsx)(Cs.Z,{type:"text",style:{width:255},left:(0,ss.R)({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),ref:m,value:d,onFocus:()=>{l(!0)},placeholder:V.default.formatMessage(ks.searchInputPlaceholder),onChange:e=>u(e.target.value)}),open:a,popupType:os.k.Popup,style:{width:255},render:()=>(0,c.jsx)(Ss,{query:d,closeDropdown:()=>l(!1)})})}function Ts(){const e=(0,i.MO)(),t=(0,r.Fg)(),[n,o]=(0,s.useState)(!0),[a,l]=(0,s.useState)(!1),[d,u]=(0,s.useState)(""),m=s.createRef();return n?(0,c.jsx)(pn.Z,{isBlue:!0,style:{display:"flex",alignItems:"center",height:28,fontWeight:y.Z.fontWeight.medium,fontSize:y.Z.fontSize.UIRegular.desktop,color:is.ZP.blue,padding:"0px 6px"},onClick:()=>{var e;o(!1),null===(e=m.current)||void 0===e||e.focusInput()},children:(0,c.jsx)(f.FormattedMessage,{id:"adminConnectionsSettingsAddComplianceMenu.search.button.label",defaultMessage:"{plusIcon} Add connection",values:{plusIcon:(0,ss.R)({fill:is.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})}):(0,c.jsx)(ws.ZP,{alignmentToOrigin:ws.ZP.Alignment.Start,keepFocus:e,onDismiss:()=>{var e;null===(e=m.current)||void 0===e||e.handleBlur(),o(!0),l(!1)},origin:(0,c.jsx)(Cs.Z,{type:"text",style:{width:255},left:(0,ss.R)({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),focus:!0,ref:m,value:d,onFocus:()=>{l(!0)},placeholder:V.default.formatMessage(ks.complianceIntegrationSearchInputPlaceholder),onChange:e=>u(e.target.value)}),open:a,popupType:os.k.Popup,style:{width:255},render:()=>(0,c.jsx)(vs,{query:d,closeDropdown:()=>{o(!0),l(!1)}})})}var Zs=n(287446),Ps=n(994512),Fs=n(770578),_s=n(411066),As=n(661519),Bs=n(158297),Rs=n(942402),Ds=n(555422),Os=n(66957);const Ls=["member_connections","workspace_connections"];function Vs(e){const t=(0,i.O7)(),{isMobile:n}=t.device,{guestBotIds:o,organizationOverrides:l}=e,d=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),u=(0,a.VK)((()=>Yn.Z.webhookSubscriptions.state.reduce(((e,t)=>{const n=t.getBotId();return n&&(e[n]=t.id),e}),{})),[]),m=(0,a.VK)((()=>Ie.default.checkGate({gateName:"webhooks_beta"})||Ie.default.checkGate({gateName:"e_discovery"})),[]),p=(0,a.VK)((()=>d?(0,h.jj)([...o,...Xn.Z.bots.state.map((e=>e.id))]).map((e=>{const t=oe.Qx.createChildStore(d,{table:R.cZ,id:e,spaceId:d.id});return t.getAlive()?t:void 0})).filter(Zn.$K):[]),[d,o]),g=(0,a.VK)((()=>function(e){return e.reduce(((e,t)=>{const n=t.getIntegrationId();if(!n)return e;return(0,Gn.EY)(n)?(n in e.compliance||(e.compliance[n]=[]),e.compliance[n].push(t.id)):(n in e.nonCompliance||(e.nonCompliance[n]=[]),e.nonCompliance[n].push(t.id)),e}),{compliance:{},nonCompliance:{}})}(p)),[p]),x=(0,a.VK)((()=>function(e){return e.filter((e=>!e.getIntegrationId())).map((e=>e.id))}(p)),[p]),S=(0,a.VK)((()=>function(e,t){if(!t)return{};return e.reduce(((e,n)=>{const s=es.U.createChildStore(t,{table:D.KJ,id:n.getCreatedById()}),i=n.getIntegrationId();return i?e[i]=i in e?[...e[i],s]:[s]:e[n.id]=[s],e}),{})}(p,d)),[p,d]),v=(0,a.VK)((()=>null==d?void 0:d.getBotSettingsStore().getValue()),[d]),b=(0,a.VK)((()=>Object.keys(g.nonCompliance).length+x.length),[g.nonCompliance,x]),M=(0,a.VK)((()=>Object.values(g.compliance).flat().length),[g.compliance]),j=(0,a.VK)((()=>null!=v&&v.integration_approval_statuses?Object.keys(v.integration_approval_statuses).length+x.length:x.length),[v,x]),w={member_connections:(0,c.jsx)(f.FormattedMessage,{id:"admin.connections.tabs.member_connections",defaultMessage:"Member{numberOfIntegrations}",values:{numberOfIntegrations:0!==b&&(0,c.jsx)(Ce.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:b+zn.T2.length})}}),workspace_connections:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(f.FormattedMessage,{id:"admin.connections.tabs.workspace_connections",defaultMessage:"Workspace{numberOfIntegrations}",values:{numberOfIntegrations:0!==M&&(0,c.jsx)(Ce.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:M})}}),(0,c.jsx)($t.Z,{})]})},k=Ls.map((e=>w[e])),I=(0,a.VK)((()=>"integrations"===rt.Z.state.currentTab?rt.Z.state.defaultSubtab:void 0),[]),T=(0,a.VK)((()=>Yn.Z.integrations.state),[]),[Z,P]=(0,s.useState)(I||"member_connections"),F=(0,a.VK)((()=>(0,bt.wP)()),[]),_=Boolean(l.integration_restrictions),A=(0,r.yK)((e=>({connectedSection:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"relative"},connectedSectionDescription:{fontSize:14,marginRight:8,color:e.lightTextColor,fontWeight:400,marginBottom:12},addMenu:{position:"absolute",right:0,top:0},discoverSectionUpsell:{backgroundColor:e.accentColors.uiBlue[100],padding:16,borderRadius:4},discoverSectionHeader:{display:"flex",justifyContent:"space-between",marginBottom:8},discoverSectionTitle:{fontSize:16,fontWeight:510},discoverSectionButtons:{display:"flex"},learnMoreButton:{padding:"0px 8px",borderRadius:4,display:"flex",alignItems:"center",color:e.blueColor},upgradeButton:{marginLeft:12,padding:"0px 14px"},alias:{marginLeft:6,width:"0.9em",height:"0.9em",padding:1,border:"1px solid",borderRadius:2}})),[]),B={member_connections:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Es,{isIntegrationRestrictionsControlledByOrganization:_}),(null==v?void 0:v.integration_restrictions)&&(0,c.jsx)("div",{style:{marginTop:"19px"},children:(0,c.jsx)(Ns,{isIntegrationRestrictionsControlledByOrganization:_})}),(0,c.jsx)(As.Z,{size:n?32:18,isHidden:!n}),Boolean(null==v?void 0:v.integration_restrictions)?(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:19},children:[(0,c.jsx)(Ce.Z,{style:{fontWeight:y.Z.fontWeight.medium,display:"flex",alignItems:"center",height:28},children:(0,c.jsx)(f.FormattedMessage,{id:"adminConnectionsSettings.table.allowIntegrations.title",defaultMessage:"Approved connections{numberOfIntegrations}",values:{numberOfIntegrations:0!==j&&(0,c.jsx)(Ce.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:j})}})}),(0,c.jsx)(Is,{})]}):(0,c.jsx)(Ce.Z,{style:{fontWeight:y.Z.fontWeight.medium,display:"flex",height:28,alignItems:"center",marginBottom:"19px"},children:(0,c.jsx)(f.FormattedMessage,{id:"adminConnectionsSettings.table.default.title",defaultMessage:"All connections{numberOfIntegrations}",values:{numberOfIntegrations:0!==b&&(0,c.jsx)(Ce.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:b+zn.T2.length})}})}),(0,c.jsx)(Zs.ZP,{integrationIdToBotIds:g.nonCompliance,internalIntegrationIds:x,integrationIdToUsers:S}),(0,c.jsx)("div",{style:{marginTop:16,marginBottom:32,display:"grid",gridTemplateColumns:"1fr",gap:4},children:(0,c.jsx)(Fs.Z,{})})]}),workspace_connections:()=>{const e=Object.keys(g.compliance),n=e.length>0,s=function(e){const{allIntegrations:t,connectedIntegrationIds:n,isEnterprise:s}=e,i=[];for(const o of t)if(!n.includes(o.id)){const e=(0,Gn.I$)(o.id);if(!e)continue;i.push({id:o.id,appName:o.name,account:void 0,caption:o.getInfo().tagline,logo:o.getInfo().icon,shouldHideInDiscover:!1,shouldShowNewBadge:!1,shouldHideConnectAccount:!0,shouldShowUpsell:!s,integrationTypes:[e.type],capabilities:(0,c.jsx)(c.Fragment,{}),canSelectPageAccess:!1,onConnect:()=>{var t;null!=e&&null!==(t=e.oauth)&&void 0!==t&&t.accountInfoPropertyNames||"dlp"===(null==e?void 0:e.type)||"ediscovery"===(null==e?void 0:e.type)?Jn.Z.setState({open:!0,integrationId:o.id}):Qn.Z.setState({open:!0,integrationId:o.id})},onDisconnect:()=>{}})}return i}({allIntegrations:T,connectedIntegrationIds:e,isEnterprise:F}),i=s.length>0;return(0,c.jsx)(c.Fragment,{children:m?(0,c.jsxs)(c.Fragment,{children:[n&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{style:A.connectedSectionDescription,children:(0,c.jsx)(f.FormattedMessage,{id:"admin.connections.tab.workspace_connections.description",defaultMessage:"These integrations connect your workspace to external apps, or improve security and compliance. Only workspace owners can install them"})}),(0,c.jsxs)("div",{style:A.connectedSection,children:[(0,c.jsx)("div",{style:A.addMenu,children:(0,c.jsx)(Ts,{})}),(0,c.jsx)(Zs.cP,{botIdToWebhookSubscriptionId:u,complianceIntegrationsIdToBotIds:g.compliance})]})]}),i&&(0,c.jsx)("div",{style:{...F?{}:A.discoverSectionUpsell,marginTop:n?32:void 0},children:(0,c.jsx)(Ps.Z,{apps:s,numberOfConnectedApps:e.length,numberOfDisplayRows:2,title:(0,c.jsxs)("div",{style:A.discoverSectionHeader,children:[(0,c.jsx)("div",{style:A.discoverSectionTitle,children:F?(0,c.jsx)(f.FormattedMessage,{id:"connectionsSettings.discoverNewConnectionsSection.title",defaultMessage:"Discover new connections"}):(0,c.jsx)(f.FormattedMessage,{id:"connectionsSettings.discoverNewConnectionsSection.titleUpsell",defaultMessage:"Upgrade to Enterprise to use these connections"})}),!F&&(0,c.jsxs)("div",{style:A.discoverSectionButtons,children:[(0,c.jsxs)(_s.Z,{onClick:()=>{C.D({environment:t,url:"https://www.notion.so/integrations/collections/security-and-compliance"})},style:A.learnMoreButton,children:[(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Learn more",id:"connectionsSettings.discoverNewConnectionsSection.learnMore"}),(0,Kn.J)(A.alias)]}),(0,c.jsx)(Bs.Z,{style:A.upgradeButton,onClick:async()=>{d&&(ts.Zz({environment:t,spaceId:d.id}),await ns.Z.waitUntilReady()),xt.y(t,{from:"workspace_connections",for:"enterprise",dontOpenPlansOnCancel:!0})},children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Upgrade",id:"connectionsSettings.discoverNewConnectionsSection.upgrade"})})]})]})})})]}):null})}},O=e=>B[e];return m?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Os.Z,{tabs:k,selectedIndex:Ls.findIndex((e=>e===Z)),onChange:e=>(e=>{P(Ls[e])})(e),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),O(Z)()]}):O("member_connections")()}function Es(e){let{isIntegrationRestrictionsControlledByOrganization:t}=e;const n=(0,i.O7)(),s=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),{isMobile:o}=n.device,r=(0,a.VK)((()=>(0,bt.wP)()),[]),l=(0,a.VK)((()=>null==s?void 0:s.getBotSettingsStore().getValue()),[s]);return(0,c.jsx)(Ds.Z,{isMobile:o,isLocked:t,lockedTooltip:(0,$n.g)(),title:(0,c.jsx)(f.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.title",defaultMessage:"Restrict members from adding connections"}),caption:(0,qn.CJ)(l)?(0,c.jsx)(f.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.allowList.workspaceOwner.caption",defaultMessage:"Workspace members can only install connections pre-approved by workspace owners."}):(0,c.jsx)(f.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.off.caption",defaultMessage:"Workspace members can install any new connection."}),upsellOptions:{shouldUpsell:!r,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"dropdown",currentOption:(0,qn.CJ)(l)?"allow_list":"any_integrations",options:[{key:"any_integrations",label:(0,c.jsx)(f.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.off.title",defaultMessage:"No restrictions"}),caption:(0,c.jsx)(f.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.off.caption",defaultMessage:"Workspace members can install any connection."})},{key:"allow_list",label:(0,c.jsx)(f.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.allowList.title",defaultMessage:"Only from approved list"}),caption:(0,c.jsx)(f.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.allowList.caption",defaultMessage:"Workspace members can only install connections pre-approved by a workspace owner."})}],onSelectOption:e=>{t||function(e){const{environment:t,currentSpaceStore:n,botSettings:s,setting:i}=e;if(n){if("allow_list"===i&&(0,qn.CJ)(s))return;const e="allow_list"===i?"approved_only":void 0;P.createAndCommit({userAction:"AdminIntegrationSettings.handleIntegrationRestrictionSelect",environment:t,perform:t=>{Hn.sW({store:n,data:{bot_settings:{...s,integration_restrictions:e}},transaction:t})}})}}({environment:n,currentSpaceStore:s,botSettings:l,setting:e})},info:[{key:"learn_more",label:(0,c.jsx)(f.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.info.title",defaultMessage:"Workspace owners can always install and approve new connections."})}]})}function Ns(e){let{isIntegrationRestrictionsControlledByOrganization:t}=e;const n=(0,i.O7)(),s=(0,r.Fg)(),o=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),{isMobile:l}=n.device,d=(0,a.VK)((()=>(0,bt.wP)()),[]),u=(0,a.VK)((()=>null==o?void 0:o.getBotSettingsStore().getValue()),[o]);return(0,c.jsx)(Ds.Z,{isMobile:l,title:(0,c.jsx)(f.FormattedMessage,{id:"adminConnectionsSettings.autoApproveBuiltByNotion.title",defaultMessage:"Auto-approve <builtbynotion>Built by Notion</builtbynotion> connections",values:{builtbynotion:e=>(0,c.jsxs)("span",{style:{color:s.invoiceGreen,marginRight:4,marginLeft:4},children:[(0,Wn.X)({width:14,display:"inline",verticalAlign:"bottom",marginRight:2}),e]})}}),caption:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Toggle this on to approve all workspace members to install connections <helpcenterlink>built by Notion</helpcenterlink>.",id:"adminConnectionsSettings.autoApproveBuiltByNotion.caption",values:{helpcenterlink:e=>(0,c.jsx)(Rs.Z,{href:(0,ze.UY)("guides.enterpriseIntegrationSettings"),children:e})}}),upsellOptions:{shouldUpsell:!d,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"toggle",isOn:"approved_or_built_by_notion"===(null==u?void 0:u.integration_restrictions),onToggle:()=>{t||function(e){const{environment:t,currentSpaceStore:n,botSettings:s}=e;if(n){const e="approved_or_built_by_notion"===(null==s?void 0:s.integration_restrictions)?"approved_only":"approved_or_built_by_notion";P.createAndCommit({userAction:"AdminIntegrationSettings.handleAutoApproveBuiltByNotionToggle",environment:t,perform:t=>{Hn.sW({store:n,data:{bot_settings:{...s,integration_restrictions:e}},transaction:t})}})}}({environment:n,currentSpaceStore:o,botSettings:u})},isLocked:t,lockedTooltip:(0,$n.g)()})}var Us=n(825777);const Ks=function(e){let{spaceStore:t,userStore:n,organizationOverrides:o}=e;const r=(0,i.O7)(),l=(0,a.qz)(void 0,Un.Z),{device:d}=r,u=(0,a.VK)((()=>(0,Nn.Fn)(r)),[r]);return(0,s.useEffect)((()=>{u||j.r$({currentTab:"members"})}),[u]),u?(0,c.jsxs)(kt.ZP,{children:[(0,c.jsx)(fe.Z,{large:!d.isMobile||void 0,divider:d.isMobile?void 0:"full",style:{paddingBottom:12},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceConnectionsSettings.title",defaultMessage:"Connections"})}),(0,c.jsx)(zs,{spaceStore:t,userStore:n,requestStore:l,organizationOverrides:o})]}):null};function Ws(e){let{error:t,result:n,ready:s,organizationOverrides:i}=e;return(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[])?(0,c.jsxs)(Us.Z,{loaded:s,spinnerSize:16,showSpinnerTimeout:600,children:[t&&(0,c.jsx)("div",{children:(0,c.jsx)(f.FormattedMessage,{id:"spaceIntegrationSettings.error",defaultMessage:"Something went wrong…"})}),n&&(0,c.jsx)(Vs,{...n,organizationOverrides:i})]}):null}function zs(e){let{spaceStore:t,userStore:n,requestStore:s,organizationOverrides:o}=e;const r=(0,i.O7)(),l=(0,a.qz)(s,Un.Z);return(0,c.jsx)(En.Z,{requestStore:l,request:{spaceId:t.id,userId:n.id},performRequest:e=>async function(e,t){let{spaceId:n}=e;return{guestBotIds:(await Promise.all([On.Yw({environment:t,table:Dn.bx,id:n,type:"guest"}),On.Yw({environment:t,table:Dn.bx,id:n,type:"external"}),Vn.pJ({environment:t}),Ln.v({environment:t})]))[0].botIds}}(e,r),render:(e,t,n)=>(0,c.jsx)(Ws,{error:e,result:t,ready:n,organizationOverrides:o})})}var qs=n(436488),Gs=n(256940),Hs=n(550506),$s=n(45653),Ys=n(79603),Qs=n(25777),Js=n(657347),Xs=n(602013);const ei=10,ti=[50,100,200,500,1e3],ni=50;function si(e){let{spaceStore:t,samlConfigStore:n,memberCountFilter:o,isPrimarySpace:r}=e;const l=(0,i.O7)(),d=(0,a.VK)((()=>n.state.emailDomains),[n]),[c,u]=(0,s.useState)({spaces:[],nextEarliestCreatedAt:Date.now(),numPagesLoaded:0,hasNextPage:!1,loading:!1,error:void 0}),m=(0,a.VK)((()=>(0,bt.wP)()),[]),p=(0,s.useCallback)((async e=>{if(m&&0!==d.length&&r&&c.nextEarliestCreatedAt&&!c.loading&&!(e&&c.numPagesLoaded>0||c.error)){u((e=>({...e,loading:!0})));try{const{spaces:e,earliestCreatedAt:n,hasMoreSpaces:s}=await(0,Xs.XD)({fn:async()=>await async function(e,t,n,s,i){const o=await I.getSpacesCreatedByUserWithDomains(e,{spaceId:t,emailDomains:n,spacesLimit:ei,memberCountFilter:i,spaceCreatedTimeUpperBound:s});if("failed"===o.type)throw o.error;return{spaces:o.data.results.map((e=>({id:e.id,name:e.spaceName,icon:e.spaceIcon,createdAt:e.spaceCreatedTime,memberCount:e.memberCount,subscriptionTier:e.subscriptionTier,creatorEmailDomain:e.spaceCreatedByDomain,creator:e.spaceCreator,admins:e.admins,spaceRequest:e.spaceRequest,isDelinquent:e.isDelinquent,isPendingBilling:e.isPendingBilling,isActorInSpace:e.isActorInSpace}))),earliestCreatedAt:o.data.hasMoreSpaces?o.data.earliestCreatedAt:void 0,hasMoreSpaces:o.data.hasMoreSpaces}}(l,t.id,d,c.nextEarliestCreatedAt?c.nextEarliestCreatedAt-1:Date.now(),o),handleError:(e,t)=>t?{status:"throw",error:e}:{status:"retry"},retryAttemptsMS:ti,retryAttemptRandomOffsetMS:ni,initialInput:void 0});u((t=>{const i=[...t.spaces],o=new Set(t.spaces.map((e=>e.id)));for(const n of e)o.has(n.id)||i.push(n);return{spaces:i,nextEarliestCreatedAt:n,numPagesLoaded:t.numPagesLoaded+1,hasNextPage:s,loading:!1,error:void 0}}))}catch(n){const e=(0,Js.t)(n);u((t=>({...t,loading:!1,error:e})))}}}),[l,m,o,r,t,d,c.nextEarliestCreatedAt,c.numPagesLoaded,c.loading,c.error]);const g=(0,s.useCallback)((async()=>{await p(!1)}),[p]),f=(0,s.useCallback)((async()=>{await p(!0)}),[p]),h=(0,s.useCallback)((async()=>{u({spaces:[],nextEarliestCreatedAt:Date.now(),numPagesLoaded:0,hasNextPage:!1,loading:!1,error:void 0}),await p(!0)}),[p]);return{claimableSpaces:c.spaces,loading:c.loading,error:c.error,hasNextPage:c.hasNextPage,loadFirstPage:f,loadNextPage:g,resetFirstPage:h,setSpaceRequest:function(e,t){u((n=>{const s=n.spaces.map((n=>n.id===e?{...n,spaceRequest:t}:n));return{...n,spaces:s}}))},removeClaimableSpace:function(e){u((t=>{const n=t.spaces.filter((t=>t.id!==e));return{...t,spaces:n}}))}}}async function ii(e){const{environment:t,spaceId:n,store:s}=e;if(!(0,bt.Rs)())return s.reset(),{};const i=await I.getSamlConfigForSpace(t,{spaceId:n});if("failed"===i.type)M.showError(i);else if(i.data&&i.data.samlConfig){const e={...i.data.samlConfig,useMetadataUrl:!Boolean(i.data.samlConfig.idpMetadata)};return s.setState(e),i.data}return s.reset(),{}}const oi={SettingsPage:"settings-page",WorkspacesPage:"workspaces-page",ManagedUsersPage:"managed-users-page"};let ai=function(e){return e[e.Single=0]="Single",e[e.Multi=1]="Multi",e}({});const ri=(0,s.createContext)(null);function li(e){let{spaceStore:t,samlConfigStore:n,domainSettingsStore:o,children:r}=e;const l=(0,i.O7)(),[d,u]=(0,s.useState)(oi.SettingsPage),[m,p]=(0,s.useState)(ai.Single),f=(0,a.VK)((()=>n.state.emailDomains),[n]),h=(0,a.VK)((()=>Boolean(n.state.id)&&n.state.id===t.id),[n,t]),{loading:y,error:x,loaded:S}=function(e){let{spaceStore:t,samlConfigStore:n,domainSettingsStore:s}=e;const o=(0,i.O7)(),[{status:a,error:r}]=(0,Qt.r5)((async()=>{const e=await ii({environment:o,spaceId:t.id,store:n});return(0,A.Zw)(e)?e:e.samlConfig?{samlResponse:e,domainResponse:await s.updateValueForSpace({environment:o,spaceId:t.id,store:s})}:{samlResponse:e,domainResponse:void 0}}),[o,n,t,s]);return{loading:"pending"===a,loaded:"resolved"===a,error:r}}({spaceStore:t,samlConfigStore:n,domainSettingsStore:o}),{loading:v,error:b,claimableSpaces:M,setSpaceRequest:j,removeClaimableSpace:C,hasNextPage:w,loadNextPage:k,loadFirstPage:T,resetFirstPage:Z}=si({spaceStore:t,samlConfigStore:n,isPrimarySpace:h,memberCountFilter:"single"}),{loading:P,error:F,claimableSpaces:_,setSpaceRequest:B,removeClaimableSpace:R,hasNextPage:D,loadNextPage:O,loadFirstPage:L,resetFirstPage:V}=si({spaceStore:t,samlConfigStore:n,isPrimarySpace:h,memberCountFilter:"multi"}),E=M.length+_.length>0,[N,U,K,W,z,q,G,H]=m===ai.Single?[v,b,M,j,C,w,k,T,Z]:[P,F,_,B,R,D,O,L,V],{loading:$,error:Y,domainVerifications:Q}=function(e){let{spaceStore:t}=e;const n=(0,i.O7)(),[o,a]=(0,s.useState)([]),[{status:r,error:l}]=(0,Qt.r5)((async()=>{if(!(0,g.Rs)(t.getSubscriptionTier()))return void a([]);const e=await I.getDomainVerificationCodesForSpace(n,{spaceId:t.id,verifiedOnly:!0});"success"===e.type?a(e.data.domainVerifications):a([])}),[n,t]);return{loading:"pending"===r,domainVerifications:"resolved"===r?o:[],error:l}}({spaceStore:t,emailDomains:f});(0,s.useEffect)((()=>{T(),L()}),[K,T,L]);const J={page:d,navigateTo:function(e){u(e),0===M.length&&_.length>0&&p(ai.Multi),"workspaces-page"===e&&Qs.Ce(l,{verifiedDomains:f,tab:m===ai.Single?"single":"multi"})},loadingSaml:y,loadingSpaces:N,loadingVerifications:$,errorSaml:x,errorClaimableSpaces:U,errorVerifications:Y,loadedSaml:S,domainVerifications:Q,hasBrowsableSpaces:E,claimableSpaces:K,setSpaceRequest:W,removeClaimableSpace:z,resetInitialClaimableSpaces:H,hasMoreClaimableSpaces:q,loadMoreClaimableSpaces:G,tab:m,setSelectedTab:function(e){p(e),"workspaces-page"===d&&Qs.Ce(l,{verifiedDomains:f,tab:e===ai.Single?"single":"multi"})},verifiedDomains:f};return(0,c.jsx)(ri.Provider,{value:J,children:r})}var di=n(584169),ci=n(166994),ui=n(573063),mi=n(519981),pi=n(931278),gi=n(725651),fi=n(829851),hi=n(2356),yi=n(937612),xi=n(97608),Si=n(781918),vi=n(164964);const bi={managedUsers:[],filters:{query:"",multiFactorStatus:void 0,workspaceId:void 0},numPagesLoaded:0,hasNextPage:!0,paginationToken:void 0,loading:!1,error:void 0};function Mi(e){let{spaceStore:t,samlConfigStore:n,userStatus:o}=e;const r=(0,i.O7)(),[l,d]=(0,s.useState)(bi),c=(0,s.useRef)(l.filters),u=(0,a.VK)((()=>Boolean(n.state.id)&&n.state.id===t.id),[n,t]),m=(0,a.VK)((()=>n.state.emailDomains),[n]),p=(0,s.useCallback)((async e=>{if(0===m.length)return;if(!u)return;let n=l.loading,s=l.error,i=l.hasNextPage,a=l.paginationToken;if(e.restartSearch&&(d((e=>({...bi,filters:e.filters}))),n=bi.loading,s=bi.error,i=bi.hasNextPage,a=bi.paginationToken),i&&!n&&!s){d((e=>({...e,loading:!0}))),c.current=l.filters;try{var p;const e=await I.getManagedUsers(r,{spaceId:t.id,emailDomains:m,query:l.filters.query,multiFactorStatus:l.filters.multiFactorStatus,workspaceId:l.filters.workspaceId,paginationToken:a,userStatus:o});if(Si.HH(r,{filters:{multiFactorStatus:l.filters.multiFactorStatus,workspaceId:l.filters.workspaceId},query_length:(null===(p=l.filters.query)||void 0===p?void 0:p.length)??0,current_page:a,user_status:o}),"failed"===e.type)throw e.error;const n=e.data.nextPaginationToken,s=e.data.results;d((e=>{const t=[...e.managedUsers],i=new Set(e.managedUsers.map((e=>e.userId)));for(const n of s)i.has(n.userId)||t.push(n);return{...e,managedUsers:t,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:n,hasNextPage:Boolean(n)}}))}catch(g){const e=(0,Js.t)(g);d((t=>({...t,loading:!1,error:e})))}}}),[r,t,m,u,l.loading,l.error,l.hasNextPage,l.paginationToken,l.filters,o]);(0,s.useEffect)((()=>{h.Xy(c.current,l.filters)||p({restartSearch:!0})}),[l.filters,p]);const g=(0,s.useCallback)((()=>p({restartSearch:!1})),[p]),f=(0,s.useCallback)((e=>{d((t=>({...t,filters:{...t.filters,...e}})))}),[]),y=(0,s.useCallback)(((e,t)=>{d((n=>({...n,managedUsers:n.managedUsers.map((n=>n.userId===e?{...n,workspaces:n.workspaces.filter((e=>e.id!==t))}:n))})))}),[]),x=(0,s.useCallback)((e=>{d((t=>({...t,managedUsers:[...t.managedUsers,e]})))}),[]),S=(0,s.useCallback)((e=>{d((t=>({...t,managedUsers:t.managedUsers.filter((t=>t.userId!==e))})))}),[]);return{managedUsers:l.managedUsers,filters:l.filters,loading:l.loading,error:l.error,removeWorkspaceFromUser:y,addUserToManagedUsers:x,removeUserFromManagedUsers:S,setFilters:f,hasNextPage:l.hasNextPage,loadNextPage:g}}let ji=function(e){return e[e.NotSuspended=0]="NotSuspended",e[e.Suspended=1]="Suspended",e}({});function Ci(e){switch(e){case ji.Suspended:return"suspended";case ji.NotSuspended:return"notSuspended";default:(0,Zn.t1)(e)}}var wi=n(844495),ki=n(271291),Ii=n(53695),Ti=n(155255),Zi=n(58720),Pi=n(252498),Fi=n(582162),_i=function(e){return e.ManagedUser="managed-user",e.Loading="loading",e}(_i||{});const Ai={marginLeft:4,height:14,width:14,opacity:.5},Bi=[{id:"user",headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.user",defaultMessage:"Users"}),renderCell:e=>e.type===_i.ManagedUser?(0,c.jsx)(Fi.S,{userId:e.managedUser.userId}):(0,c.jsx)(Fi.L,{}),widthData:{width:70},sortable:!1},{id:"access",headerTitle:(0,c.jsx)("span",{style:{paddingInline:8},children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.access",defaultMessage:"Workspaces"})}),renderCell:e=>e.type===_i.ManagedUser?(0,c.jsx)(Zi.m,{workspaceSummaries:e.managedUser.workspaces}):(0,c.jsx)(Ii.z6,{}),widthData:{width:60},sortable:!1},{id:"lastActive",headerTitle:(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},children:[(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive",defaultMessage:"Last active"}),(0,c.jsx)(je.Z,{render:e=>(0,c.jsx)("div",{...e,children:(0,wi.D)(Ai)}),renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive.tooltip",defaultMessage:"This may be delayed by several hours."})})]}),renderCell:e=>e.type===_i.ManagedUser?(0,c.jsx)(Ti.B,{lastActiveAt:e.managedUser.lastActiveAt,containerStyle:{opacity:.5}}):(0,c.jsx)(ki.I,{}),widthData:{width:60},sortable:!1},{id:"menu",headerTitle:null,renderCell:e=>e.type===_i.ManagedUser?(0,c.jsx)(Pi.G,{managedUser:e.managedUser,managedUserActionSections:e.managedUserActionSections}):null,widthData:{width:15},sortable:!1,hasClickableContents:!0}],Ri=[{id:"1",isClickable:!1,type:_i.Loading},{id:"2",isClickable:!1,type:_i.Loading},{id:"3",isClickable:!1,type:_i.Loading}];function Di(e){let{managedUsers:t,loadMoreManagedUsers:n,onEditDetails:s,loading:i,managedUserActionSections:o}=e;const a=t.map((e=>({id:e.userId,type:_i.ManagedUser,managedUser:e,isClickable:!0,managedUserActionSections:o}))),l=(0,r.yK)((e=>(0,be.b)({columnRenderInfo:Bi,theme:e,containerMarginTop:0})),[]);const d=i?[...a,...Ri]:a;return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(be.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Bi,rows:d,onRowClick:function(e){e.type===_i.ManagedUser&&s(e.managedUser)},renderNoRowsComponent:()=>(0,c.jsx)(Oi,{loading:i}),styles:l,onLoadMore:n})})}function Oi(e){const t=(0,r.yK)((()=>({text:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]);return(0,c.jsx)(Ce.Z,{isSmall:!0,style:t.text,children:!e.loading&&(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.empty",defaultMessage:"No users found."})})}var Li=n(233602),Vi=n(218261),Ei=n(728608);const Ni=(0,f.defineMessages)({placeholder:{id:"identityProvisioningSettings.managedUsers.searchInput.placeholder",defaultMessage:"Search name, email, or user ID"}});function Ui(e){let{spaceStore:t,samlConfigStore:n}=e;const{navigateTo:o}=(0,s.useContext)(ri),l=(0,i.O7)(),d=(0,f.useIntl)(),u=(0,r.yK)((e=>({link:{fontSize:14,fontWeight:400,color:e.mediumTextColor,textDecoration:"none"},title:{marginTop:21,fontWeight:y.Z.fontWeight.semibold,fontSize:17,display:"flex",justifyContent:"flex-start",alignItems:"center"},byline:{fontSize:14,fontWeight:y.Z.fontWeight.regular,color:e.mediumTextColor,paddingBottom:20},count:{marginLeft:4,opacity:.5,fontWeight:400},tabBarMenu:{margin:"12px 0 0",boxShadow:"none"},filters:{display:"flex",justifyContent:"flex-start",alignItems:"center",width:"100%",margin:"0 auto 12px"}})),[]),m=(0,a.VK)((()=>n.state.spaces),[n]),{managedUsers:p,filters:g,loadNextPage:h,setFilters:x,removeWorkspaceFromUser:S,loading:v,selectedTab:b,setSelectedTab:j,onOpenDetailsModal:w,onCloseDetailsModal:k,selectedUser:T,managedUserActionSections:Z}=function(e){let{spaceStore:t,samlConfigStore:n}=e;const o=(0,i.O7)(),r=(0,f.useIntl)(),[l,d]=(0,s.useState)(),[u,m]=(0,s.useState)(ji.NotSuspended),p=(0,a.VK)((()=>o.currentUser.id),[o]),g=(0,s.useCallback)(((e,t)=>{Si.JX(o,{user_status:Ci(u),from:t}),d(e.userId)}),[o,u]),h=Mi({userStatus:"notSuspended",spaceStore:t,samlConfigStore:n}),y=Mi({userStatus:"suspended",spaceStore:t,samlConfigStore:n});let x;x=u===ji.NotSuspended?h:y;const S=(0,s.useCallback)((async e=>{Si.rZ(o);const{accept:n}=await M.confirmUserActionV2({message:(0,c.jsx)(Ce.Z,{style:M.dialogStyles.title,children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Suspend this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.title"})}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Yes",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.acceptLabel"}),description:(0,c.jsx)(Ce.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"This user will not be able to log into Notion and their Notion integrations will stop working. They can be unsuspended at any time from the Managed Users dashboard.",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.description"})})});if(!n)return;const s=await I.updateUserSuspension(o,{userId:e.userId,spaceId:t.id,suspend:!0});Si.rv(o,{suspended_user_id:e.userId}),"failed"===s.type&&M.showErrorMessage((0,L.wf)(V.default.getIntl(),s)),y.addUserToManagedUsers(e),h.removeUserFromManagedUsers(e.userId)}),[o,t.id,y,h]),v=(0,s.useCallback)((async e=>{Si.NF(o);const{accept:n}=await M.confirmUserActionV2({message:(0,c.jsx)(Ce.Z,{style:M.dialogStyles.title,children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Log out this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.title"})}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Log out user",id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.acceptLabel"}),description:(0,c.jsx)(Ce.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.description",defaultMessage:"You are about to log out this user from their current session. They will need to re-authenticate to log back into Notion."})})});if(!n)return;const s=await I.logoutManagedUsers(o,{spaceId:t.id,target:{type:xi.J.User,userId:e.userId}});if(Si._m(o),"failed"===s.type)return M.showErrorMessage((0,L.wf)(V.default.getIntl(),s)),void vi.oV({label:(0,c.jsx)(f.FormattedMessage,{id:"managedUsers.toastMessage.logout.failed",defaultMessage:"Failed to logged out user"})});vi.oV({label:(0,c.jsx)(f.FormattedMessage,{id:"managedUsers.toastMessage.logout.success",defaultMessage:"Successfully logged out user"})})}),[o,t.id]),b=(0,s.useCallback)((async e=>{Si.Zm(o);const{accept:n}=await M.confirmUserActionV2({message:(0,c.jsx)(Ce.Z,{style:M.dialogStyles.title,children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Reset password for this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.title"})}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.acceptLabel",defaultMessage:"Reset passwords for user"}),description:(0,c.jsx)(Ce.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.description",defaultMessage:"You are about to reset the password for this user. This will also remove any 2-step verification settings they might have and they will be logged out of of their current session.{br}{br}This user will need to re-authenticate via their email the next time they attempt to log back into Notion, and they will be prompted to set a new password upon logging in.",values:{br:(0,c.jsx)("br",{})}})})});if(!n)return;const s=await I.resetPasswordsForManagedUsers(o,{spaceId:t.id,target:{type:xi.J.User,userId:e.userId}});if(Si.vC(o),"failed"===s.type)return M.showErrorMessage((0,L.wf)(r,s)),void vi.oV({label:(0,c.jsx)(f.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.fail",defaultMessage:"Failed to reset password for user"})});vi.oV({label:(0,c.jsx)(f.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.success",defaultMessage:"Successfully reset password for user"})})}),[o,r,t.id]),j=(0,s.useCallback)((async e=>{const n=await I.updateUserSuspension(o,{userId:e.userId,spaceId:t.id,suspend:!1});Si.Ci(o),"failed"===n.type&&M.deprecatedShowErrorMessage(n.error.message),y.removeUserFromManagedUsers(e.userId),h.addUserToManagedUsers(e)}),[o,t.id,y,h]),C=(0,s.useCallback)((async e=>{Si.P1(o,{user_status:Ci(u)});const{accept:n}=await M.confirmUserActionV2({message:(0,c.jsx)(Ce.Z,{style:M.dialogStyles.title,children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Delete this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.title"})}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Yes",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.acceptLabel"}),description:(0,c.jsx)(Ce.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"This action cannot be undone. This will permanently delete the user's entire account. All private workspaces will be deleted, and they will be removed from all shared workspaces.",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.description"})})});if(!n)return;const s=await I.deleteManagedUser(o,{userId:e.userId,spaceId:t.id});Si.j7(o,{user_status:Ci(u)}),"failed"===s.type&&M.deprecatedShowErrorMessage(s.error.message),y.removeUserFromManagedUsers(e.userId),h.removeUserFromManagedUsers(e.userId)}),[o,u,t.id,y,h]),w=(0,s.useMemo)((()=>x.managedUsers.find((e=>{let{userId:t}=e;return t===l}))),[l,x.managedUsers]),k=(0,s.useMemo)((()=>{let e;const t={onClick:e=>g(e,"dropdown_menu"),icon:gi.R,title:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.userDetails",defaultMessage:"Edit details"})},n={onClick:e=>C(e),icon:yi.y,title:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser",defaultMessage:"Delete user"}),isDestructive:!0};switch(u){case ji.NotSuspended:e=[[t,{onClick:v,icon:pi.S,title:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.logout",defaultMessage:"Log out"})},{onClick:b,icon:fi.z,title:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.passwordReset",defaultMessage:"Reset password"})}],[{onClick:S,icon:mi.V,title:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser",defaultMessage:"Suspend user"}),getDisabledState:e=>e.userId===p},n]];break;case ji.Suspended:e=[[t],[{onClick:e=>j(e),icon:hi.u,title:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.unSuspendUser",defaultMessage:"Reactivate user"})},n]];break;default:(0,Zn.t1)(u)}return e.filter((e=>e.length>0))}),[g,p,u,C,S,j,v,b]);return{...x,selectedTab:u,setSelectedTab:m,selectedUser:w,managedUserActionSections:k,onOpenDetailsModal:g,onCloseDetailsModal:function(){d(void 0)}}}({spaceStore:t,samlConfigStore:n}),P=(0,s.useCallback)((e=>w(e,"row_click")),[w]);return(0,c.jsxs)(kt.ZP,{children:[(0,c.jsx)(Rs.Z,{style:u.link,onClick:()=>o(oi.SettingsPage),children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.breadcrumb",defaultMessage:"← Identity & Provisioning"})}),(0,c.jsxs)(fe.Z,{large:!0,style:u.title,children:[(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.title",defaultMessage:"User management"}),(0,c.jsx)(ui.Z,{icon:di.m,ariaLabel:d.formatMessage({defaultMessage:"Managed users settings help button",id:"identityProvisioningSettings.managedUsers.helpButton.label"}),onClick:()=>C.D({environment:l,url:(0,ze.UY)("guides.managedUsers")})})]}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:u.byline,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.byline",defaultMessage:"Manage and view users that are using your verified domains"})}),(0,c.jsx)(Os.Z,{tabs:[(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.table.notSuspendedTab.title",defaultMessage:"Active"},"notSuspended.title"),(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.table.suspendedTab.title",defaultMessage:"Suspended"},"suspended")],selectedIndex:b,onChange:e=>j(e),style:u.tabBarMenu}),(0,c.jsx)(ci.O,{mode:ci.p.Button,query:g.query,setQueryFilter:e=>{x({query:e})},placeholderText:V.default.formatMessage(Ni.placeholder)}),(0,c.jsxs)("div",{style:u.filters,children:[(0,c.jsx)(Ei.O,{selectedSpaceId:g.workspaceId,setSelectedSpaceId:e=>{x({workspaceId:e})},spaceData:m}),(0,c.jsx)(Li.V,{selectedMfaMethod:g.multiFactorStatus,setSelectedMfaMethod:e=>{x({multiFactorStatus:e})}})]}),(0,c.jsx)(Di,{managedUsers:p,loading:v,loadMoreManagedUsers:h,onEditDetails:P,managedUserActionSections:Z},b),(0,c.jsx)(Vi.W,{spaceStore:t,managedUser:T,onClose:k,removeWorkspaceFromUser:S})]})}function Ki(e){let{environment:t,samlConfigStore:n}=e;const s=n.state.emailDomains.length>0,i=(0,bt.zt)();return s||("business"===i||"enterprise"===i)}var Wi=n(281236),zi=n(568785),qi=n(460322),Gi=n(517781),Hi=n(461149),$i=n(312066),Yi=n(608055),Qi=n(474523);function Ji(e){let{isPrimary:t,leftIcon:n,rightIcon:s,onClick:i,content:o,style:a}=e;const l=(0,r.yK)((e=>({container:{display:"flex",width:"100%",padding:8,justifyContent:"flex-start",alignItems:"center",borderRadius:8,background:e.v2.surface.washDesktop,...a},iconContainer:{display:"flex",width:20,height:20,paddingTop:1,flexDirection:"column",alignItems:"center",justifyContent:"center",gap:10},title:{display:"flex",fontSize:14,fontWeight:500,color:t?e.v2.text.primary:e.v2.text.secondary,paddingLeft:6,paddingRight:2,height:18,cursor:i?"pointer":"default",width:"100%"},ctaIconContainer:{display:"flex",width:16,height:16,paddingTop:1,flexDirection:"column",alignItems:"center",gap:10,paddingLeft:2,paddingRight:0,cursor:i?"pointer":"default"}})),[i,t,a]);return(0,c.jsxs)("div",{style:l.container,children:[n&&(0,c.jsx)("div",{style:l.iconContainer,onClick:i,children:n}),(0,c.jsx)("div",{style:l.title,onClick:i,children:o}),s&&(0,c.jsx)("div",{style:l.ctaIconContainer,onClick:i,children:s})]})}function Xi(e){let{organizationId:t,content:n}=e;const s=(0,i.O7)(),o=to();return(0,c.jsx)(Ji,{isPrimary:!0,style:o.bannerContainer,leftIcon:(0,Gi._)(o.icon),content:(0,c.jsxs)("div",{style:o.container,children:[n,(0,c.jsxs)(yt.Z,{style:o.button,onClick:()=>{Yi.c4({environment:s,openInNew:"tab",makeTabActive:!0,url:(0,Hi.a5)({organizationId:t,tabRoute:$i.A4})})},children:[(0,c.jsx)(f.FormattedMessage,{id:"workspaceSettingsModal.organizationsBanner.orgSettingsButton",defaultMessage:"Organization settings"}),(0,qi.y)(o.iconArrow)]})]})})}function eo(e){let{content:t,tooltipContent:n}=e;const s=to();return(0,c.jsx)(Ji,{isPrimary:!0,style:s.bannerContainer,leftIcon:(0,l.Q)(s.icon),content:(0,c.jsxs)("div",{style:s.container,children:[t,(0,c.jsx)(je.Z,{placement:ke.u.Bottom,alignment:ke.v.End,render:e=>(0,c.jsx)(Qi.Z,{...e,analyticsFrom:"organization_settings_migration_banner"}),renderTooltip:()=>n})]})})}function to(){return(0,r.yK)((e=>({bannerContainer:{paddingInline:12,paddingBlock:16,marginBlock:12},container:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},icon:{height:16,width:16,fill:e.v2.icon.secondary},button:{background:e.buttonBackground,display:"flex",alignItems:"center",justifyContent:"center",gap:4},iconArrow:{height:14,width:14,fill:e.v2.icon.secondary,transform:"rotate(90deg)",marginTop:4}})),[])}var no=n(858698);async function so(e){let{onRequest:t,onSuccess:n}=e;const s=await t();switch(s.type){case"success":n&&await n(s);break;case"failed":M.showErrorMessage((0,L.wf)(V.default.getIntl(),s));break;default:(0,Zn.t1)(s)}}function io(e){let{spaceStore:t,samlConfigStore:n,domainSettingsStore:o}=e;const r=(0,i.O7)(),l=(0,a.VK)((()=>n.state.emailDomains),[n]),d=(0,a.VK)((()=>"disabled"!==n.state.status&&"unconfigured"!==n.state.status),[n]),c=(0,a.VK)((()=>Ki({environment:r,samlConfigStore:n})),[n,r]),u=(0,a.VK)((()=>c&&(!n.state.id||n.state.id===t.id)),[c,n,t]),m=(0,a.VK)((()=>o.state.emailDomains.length>0&&(0,bt.wP)()),[o]),p=(0,a.VK)((()=>l.length>0),[l]),g=(0,s.useCallback)((async()=>{if(n.state.emailDomains.length>0)return so({onRequest:()=>I.updateWorkspaceCreationForEmailDomains(r,{emailDomains:n.state.emailDomains,workspaceCreationEnum:o.state.spaceCreation,spaceId:t.id}),onSuccess:()=>{o.setState({...o.state,emailDomains:n.state.emailDomains})}})}),[r,t,o,n]),f=(0,s.useCallback)((async()=>{if(n.state.emailDomains.length>0)return so({onRequest:()=>I.updateEmailDomainSettings(r,{emailDomains:n.state.emailDomains,spaceId:t.id,preventProfileEdits:o.state.settings.prevent_profile_edits,preventMembersJoiningExternalWorkspace:o.state.settings.prevent_members_joining_external_workspace,customSessionDuration:(0,no.K)(o.state.settings.custom_session_duration),preventGrantingSupportAccess:o.state.settings.prevent_granting_support_access}),onSuccess:()=>{o.setState({...o.state,emailDomains:n.state.emailDomains})}})}),[r,t,o,n]),h=(0,a.VK)((()=>c&&(0,bt.wP)()),[c]);return{verifiedDomains:l,isSamlStatusEnabled:d,isSamlAvailable:c,isSamlEditable:u,isDomainSettingsAvailable:m,isClaimSpacesAvailable:h,canSaveWorkspaceCreationSetting:p,saveWorkspaceCreationSetting:g,saveEmailDomainSettings:f}}var oo=n(980422),ao=n(891694);function ro(e){let{title:t,byline:n,targetTier:o}=e;const a=(0,i.O7)(),r=(0,s.useCallback)((()=>xt.y(a,{from:"space_saml",for:o})),[a,o]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(fe.Z,{smallMarginBottom:!0,style:{fontWeight:y.Z.fontWeight.regular,display:"flex",alignItems:"center"},children:[(0,c.jsx)("span",{style:{marginRight:8},children:t}),(0,c.jsx)(ao.Z,{subscriptionTier:o,analyticsName:"space_saml",onClick:r})]}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,children:n})]})}const lo={browseWorkspaces:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Browse workspaces",id:"identityAndProvisioning.claimWorkspaces.button"}),noWorkspaces:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"No workspaces",id:"identityAndProvisioning.claimWorkspaces.buttonEmpty"}),loadingError:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Error loading workspaces.",id:"identityAndProvisioning.claimWorkspaces.errorByline"})};function co(e){let{promptUpgrade:t}=e;const{navigateTo:n,loadingSpaces:i,hasBrowsableSpaces:o,errorClaimableSpaces:a}=(0,s.useContext)(ri),l=Boolean(a),d=!o||i,u=!o&&!i,m=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.title",defaultMessage:"Claim workspaces"}),p=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.message",defaultMessage:"Claim workspaces created by users with a verified domain or require owners to use an external domain."}),g=(0,r.yK)((e=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:d?.5:1,minWidth:160},settingErrorByline:{color:e.errorText,marginTop:8,fontSize:13}})),[d]);if(t)return(0,c.jsx)(ro,{title:m,byline:p,targetTier:"enterprise"});let h;return h=i?(0,c.jsx)(zi.Z,{}):o?lo.browseWorkspaces:lo.noWorkspaces,(0,c.jsx)("div",{style:g.settingContainer,children:(0,c.jsx)(oo.N,{title:m,byline:p,settingItem:(0,c.jsxs)("div",{style:g.buttonAndErrorContainer,children:[(0,c.jsx)(je.Z,{placement:ke.u.Top,alignment:ke.v.End,render:e=>(0,c.jsx)(yt.Z,{disabled:d,isLarge:!0,style:g.button,onClick:()=>n(oi.WorkspacesPage),...e,children:h}),disableTooltip:!u,renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.tooltip",defaultMessage:"There are no available workspaces to claim"})}),l?(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:g.settingErrorByline,children:lo.loadingError}):null]})})})}var uo=n(52507),mo=n(786249);function po(e){let{spaceStore:t,samlConfigStore:n,promptUpgrade:o,disabled:l,saveWorkspaceCreationSetting:d}=e;const u=(0,i.O7)(),m=(0,a.qz)(void 0,uo.Z),p=(0,r.yK)((()=>({flex:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",margin:"18px 0px"},button:{position:"relative",marginLeft:"auto",marginRight:0,opacity:l?.5:1},plusIcon:{width:14,height:14,fill:"inherit",marginRight:"6px"}})),[l]),g=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.title",defaultMessage:"Verified domains"}),h=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.byline",defaultMessage:"Verify ownership of an email domain to access advanced security features including single-sign on."}),x=[...(0,a.VK)((()=>n.state.emailDomains.map(mo.f4)),[n]),...(0,a.VK)((()=>n.state.domainVerifications.filter((e=>!n.state.emailDomains.includes(e.domain))).sort(((e,t)=>e.createdAt-t.createdAt)).map(mo.UV)),[n])],S=(0,s.useCallback)((async()=>{await ii({environment:u,spaceId:t.id,store:n})}),[u,t,n]),{resetInitialClaimableSpaces:v}=(0,s.useContext)(ri),b=(0,s.useCallback)((async e=>{switch(e.type){case"verified":return so({onRequest:()=>I.setSamlConfig(u,{spaceId:t.id,removedEmailDomains:[e.domain]}),onSuccess:async()=>{await S(),v()}});case"unverified":case"invalid":return so({onRequest:()=>I.deleteDomainVerificationCode(u,{id:e.id}),onSuccess:()=>S()})}}),[u,t,S,v]),M=(0,s.useCallback)((()=>so({onRequest:()=>I.setSamlConfig(u,{spaceId:t.id}),onSuccess:()=>S()})),[u,S,t]),j=(0,s.useCallback)((async()=>{await S(),await d()}),[d,S]);return o?(0,c.jsx)(ro,{title:g,byline:h,targetTier:"business"}):(0,c.jsx)(mo.ZP,{disabled:l,domains:x,onRemoveDomain:b,domainVerificationStore:m,verificationType:"saml_config",verificationTargetId:t.id,refreshDomains:j,onClickAddDomain:M,renderOverrideAddDomainButton:e=>(0,c.jsxs)("div",{style:p.flex,children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(fe.Z,{smallMarginBottom:!0,style:{fontWeight:y.Z.fontWeight.medium},children:g}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginBottom:4},children:h})]}),(0,c.jsx)("div",{children:(0,c.jsx)(pn.Z,{isBlue:!0,style:p.button,icon:e=>(0,ss.R)({...e,...p.plusIcon}),disabled:l,onClick:e,children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain"})})})]})})}function go(e){let{domainSettingsStore:t,samlConfigStore:n,disabled:o,promptUpgrade:l,verifiedDomains:d,tooltip:u,saveWorkspaceCreationSetting:m}=e;const p=(0,i.O7)(),g=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),h=(0,a.VK)((()=>{const e=n.state.id;if(!e)return;return new oe.H2(p,{table:Dn.bx,id:e}).getName()}),[p,n]),y=(0,s.useCallback)((async e=>{t.setState({...t.state,spaceCreation:e}),await m(),Qs.ti(p,{workspace_creation:e})}),[t,m,p]),x=(0,a.VK)((()=>d.length>0?t.state.spaceCreation:"admins_only"),[t,d]),S=(0,c.jsx)(f.FormattedMessage,{id:"domainSettings.workspaceCreation.title",defaultMessage:"Workspace creation"}),v=(0,c.jsx)(f.FormattedMessage,{id:"domainSettings.workspaceCreation.byline",defaultMessage:"Customize who can create new workspaces."}),b=(0,c.jsx)(f.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.titleWithSpaceName",defaultMessage:"{primaryWorkspaceName} workspace owners",values:{primaryWorkspaceName:h}}),M=(0,c.jsx)(f.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.title",defaultMessage:"Only workspace owners"});return l?(0,c.jsx)("div",{style:g.settingContainer,children:(0,c.jsx)(ro,{title:S,byline:v,targetTier:"enterprise"})}):(0,c.jsx)(je.Z,{placement:ke.u.Top,alignment:ke.v.End,render:e=>(0,c.jsx)("div",{...e,style:g.settingContainer,children:(0,c.jsx)(Ds.Z,{isMobile:p.device.isMobile,disabled:o,title:S,caption:v,type:"dropdown",currentOption:x,options:[{key:"unrestricted",label:(0,c.jsx)(f.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.title",defaultMessage:"Anyone"}),caption:(0,c.jsx)(f.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.caption",defaultMessage:"Any user can create new workspaces."})},{key:"admins_only",label:h?b:M,caption:(0,c.jsx)(f.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.captionWithSpaceName",defaultMessage:"Only workspace owners of this workspace can create new workspaces."})}],onSelectOption:y})}),disableTooltip:!u,renderTooltip:()=>u})}function fo(e){let{spaceStore:t,samlConfigStore:n,domainSettingsStore:s,isCurrentSpaceEnterprise:i}=e;const{verifiedDomains:o,isSamlAvailable:a,saveWorkspaceCreationSetting:r,isSamlEditable:l,isDomainSettingsAvailable:d,canSaveWorkspaceCreationSetting:u,isClaimSpacesAvailable:m}=io({spaceStore:t,samlConfigStore:n,domainSettingsStore:s}),p=d&&l;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(po,{disabled:!l,promptUpgrade:!a,spaceStore:t,samlConfigStore:n,saveWorkspaceCreationSetting:r}),(0,c.jsx)(go,{disabled:!p||!u,promptUpgrade:!i,verifiedDomains:o,samlConfigStore:n,domainSettingsStore:s,tooltip:0===o.length?(0,c.jsx)(f.FormattedMessage,{id:"domainSettings.workspaceCreation.disabledTooltip",defaultMessage:"There must be at least one verified domain to configure the workspace creation setting."}):void 0,saveWorkspaceCreationSetting:r}),(0,c.jsx)(co,{promptUpgrade:!m})]})}var ho=n(419639),yo=n(816402);function xo(e){let{domainSettingsStore:t,saveEmailDomainSettings:n,promptUpgrade:o,disabled:l}=e;const d=(0,i.O7)(),u=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),m=(0,s.useMemo)((()=>Object.entries(ho.nb).map((e=>{let[t,n]=e;return{key:t,label:(0,c.jsx)(Ce.Z,{children:(0,yo.hH)(0,n)})}}))),[]),p=(0,a.VK)((()=>(0,no.K)(t.state.settings.custom_session_duration)??ho.gl),[t]),g=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.customSessionDuration.title",defaultMessage:"Session duration"}),h=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.customSessionDuration.message",defaultMessage:"Control how long your managed users can be logged in for before they must re-authenticate."});return o?(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(ro,{title:g,byline:h,targetTier:"enterprise"})}):(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(Ds.Z,{isMobile:d.device.isMobile,disabled:l,title:g,caption:h,type:"dropdown",currentOption:p,options:m,onSelectOption:async function(e){const s=t.state.settings.custom_session_duration??ho.nb[ho.gl],i=ho.nb[e];if(void 0===i)return;Si.LO(d,{custom_session_duration_ms:s});const{accept:o}=await M.confirmUserActionV2({message:(0,c.jsx)(Ce.Z,{style:M.dialogStyles.title,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.message",defaultMessage:"Confirm change"})}),description:(0,c.jsxs)(Ce.Z,{isMultiline:!0,isSecondaryColor:!0,children:[(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.description",defaultMessage:"You are about to change the session duration for all of your managed users from <b>{oldDuration}</b> to <b>{newDuration}.</b>",values:{oldDuration:(0,yo.hH)(0,s),newDuration:(0,yo.hH)(0,i),b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,c.jsx)("b",{children:t})}}}),(0,c.jsx)("br",{}),(0,c.jsx)("br",{}),(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.secondDescription",defaultMessage:"This may log some users out of their current session, including you. The affected users will need to re-authenticate to log back into Notion."})]}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.acceptLabel",defaultMessage:"Confirm change"}),cancelLabel:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.cancelLabel",defaultMessage:"Cancel"})});o&&(t.setState({...t.state,settings:{...t.state.settings,custom_session_duration:i}}),Si.l0(d,{new_session_duration_ms:i}),await n())}})})}function So(e){let{spaceId:t,domainSettingsStore:n,promptUpgrade:s,verifiedDomains:o,disabled:a}=e;const l=o.length>0,d=(0,i.O7)(),u=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!a&&l?1:.5}})),[a,l]),m=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.forcePasswordReset.title",defaultMessage:"Reset passwords for all users"}),p=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.forcePasswordReset.message",defaultMessage:"Force reset the passwords for all managed users and require them to create a new one the next time they log in."});async function g(){Si.Jo(d,{email_domains:o});const{accept:e}=await M.confirmUserActionV2({message:(0,c.jsx)(Ce.Z,{style:M.dialogStyles.title,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.message",defaultMessage:"Reset passwords for your managed users?"})}),description:(0,c.jsx)(Ce.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.description",defaultMessage:"You are about to reset the passwords for of your managed users, including you. This will also remove any 2-step verification settings they might have and they will be logged out of of their current session.{br}{br}The affected users will need to re-authenticate via their email the next time they attempt to log back into Notion, and they will be prompted to set a new password upon logging in.",values:{br:(0,c.jsx)("br",{})}})}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.acceptLabel",defaultMessage:"Reset passwords for all managed users"}),cancelLabel:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.cancelLabel",defaultMessage:"Cancel"})});if(!e)return;const s=n.state.emailDomains;await I.resetPasswordsForManagedUsers(d,{spaceId:t,target:{type:xi.J.Domains,emailDomains:s}}),vi.oV({label:(0,c.jsx)(f.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.all.success",defaultMessage:"Successfully reset passwords for all managed users"})}),Si.aT(d,{email_domains:s})}return s?(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(ro,{title:m,byline:p,targetTier:"enterprise"})}):(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(oo.N,{title:m,byline:p,settingItem:(0,c.jsx)("div",{style:u.buttonAndErrorContainer,children:(0,c.jsx)(je.Z,{placement:ke.u.Top,alignment:ke.v.End,render:e=>(0,c.jsx)(pn.Z,{isRed:!0,disabled:a||!l,style:u.button,onClick:g,...e,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.logoutButton",defaultMessage:"Reset passwords for all users"})}),disableTooltip:l,renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}function vo(e){let{spaceId:t,domainSettingsStore:n,promptUpgrade:s,verifiedDomains:o,disabled:a}=e;const l=o.length>0,d=(0,i.O7)(),u=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!a&&l?1:.5}})),[a,l]),m=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.logoutAllUsers.title",defaultMessage:"Log out all users"}),p=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.logoutAllUsers.message",defaultMessage:"Force log out all managed users and require them to re-authenticate."});async function g(){Si.KF(d,{email_domains:o});const{accept:e}=await M.confirmUserActionV2({message:(0,c.jsx)(Ce.Z,{style:M.dialogStyles.title,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.message",defaultMessage:"Log out all of your managed users?"})}),description:(0,c.jsx)(Ce.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.description",defaultMessage:"You are about to log all of your managed users out of their current session, including you. The affected users will need to re-authenticate to log back into Notion."})}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.acceptLabel",defaultMessage:"Log out all managed users"}),cancelLabel:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.cancelLabel",defaultMessage:"Cancel"})});if(!e)return;const s=n.state.emailDomains;await I.logoutManagedUsers(d,{spaceId:t,target:{type:xi.J.Domains,emailDomains:s}}),vi.oV({label:(0,c.jsx)(f.FormattedMessage,{id:"managedUsers.toastMessage.logout.all.success",defaultMessage:"Successfully logged out all managed users"})}),Si._6(d,{email_domains:s})}return s?(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(ro,{title:m,byline:p,targetTier:"enterprise"})}):(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(oo.N,{title:m,byline:p,settingItem:(0,c.jsx)("div",{style:u.buttonAndErrorContainer,children:(0,c.jsx)(je.Z,{placement:ke.u.Top,alignment:ke.v.End,render:e=>(0,c.jsx)(pn.Z,{isRed:!0,disabled:a||!l,style:u.button,onClick:g,...e,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.logoutButton",defaultMessage:"Log out all users"})}),disableTooltip:l,renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}function bo(e){let{promptUpgrade:t,hasVerifiedDomains:n,disabled:o}=e;const{navigateTo:a}=(0,s.useContext)(ri),l=(0,i.O7)(),d=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.title",defaultMessage:"Managed users dashboard"}),u=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.message",defaultMessage:"Manage and view users that are using your verified domains"}),m=(0,r.yK)((e=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!o&&n?1:.5}})),[n,o]);return t?(0,c.jsx)("div",{style:m.settingContainer,children:(0,c.jsx)(ro,{title:d,byline:u,targetTier:"enterprise"})}):(0,c.jsx)("div",{style:m.settingContainer,children:(0,c.jsx)(oo.N,{title:d,byline:u,settingItem:(0,c.jsx)("div",{style:m.buttonAndErrorContainer,children:(0,c.jsx)(je.Z,{placement:ke.u.Top,alignment:ke.v.End,render:e=>(0,c.jsx)(yt.Z,{disabled:o||!n,isLarge:!0,style:m.button,onClick:()=>{Si.pC(l),a(oi.ManagedUsersPage)},...e,children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"View dashboard",id:"identityAndProvisioning.managedUsers.button"})}),disableTooltip:n,renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}var Mo=n(964392);function jo(e){let{domainSettingsStore:t,saveEmailDomainSettings:n,promptUpgrade:s,verifiedDomains:o,disabled:l}=e;const d=(0,i.O7)(),u=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),m=o.length>0,p=(0,a.VK)((()=>Boolean(t.state.settings.prevent_granting_support_access)),[t]),g=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.title",defaultMessage:"Prevent managed users from granting support access"}),h=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.message",defaultMessage:"Control if managed users can enable support access on their accounts."});return s?(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(ro,{title:g,byline:h,targetTier:"enterprise"})}):(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(Mo.w,{title:(0,c.jsx)("div",{style:u.settingsTitle,children:g}),byline:h,isOn:p,onToggle:async function(){const e=Boolean(!t.state.settings.prevent_granting_support_access);t.setState({...t.state,settings:{...t.state.settings,prevent_granting_support_access:e}}),Si.Dn(d,{new_value:e}),await n()},disabled:l||!m})})}function Co(e){let{domainSettingsStore:t,saveEmailDomainSettings:n,promptUpgrade:s,disabled:o}=e;const l=(0,i.O7)(),d=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),u=(0,a.VK)((()=>Boolean(t.state.settings.prevent_members_joining_external_workspace)),[t]),m=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.title",defaultMessage:"External workspace access"}),p=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.message",defaultMessage:"Control if managed users are able to join workspaces that aren't owned by your organization."});if(s)return(0,c.jsx)("div",{style:d.settingContainer,children:(0,c.jsx)(ro,{title:m,byline:p,targetTier:"enterprise"})});const g=u?"on":"off";return(0,c.jsx)("div",{style:d.settingContainer,children:(0,c.jsx)(Ds.Z,{isMobile:l.device.isMobile,disabled:o,title:m,caption:p,type:"dropdown",currentOption:g,options:[{key:"on",label:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.titleGeneric",defaultMessage:"Only workspace owners"}),caption:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.caption",defaultMessage:"Only workspace owners of your connected workspaces can join external workspaces."})},{key:"off",label:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.disabled.titleWithSpaceName",defaultMessage:"Anyone"}),caption:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.disabled.caption",defaultMessage:"All users can join any workspace."})}],onSelectOption:async function(){const e=Boolean(!t.state.settings.prevent_members_joining_external_workspace);t.setState({...t.state,settings:{...t.state.settings,prevent_members_joining_external_workspace:e}}),Si.T4(l,{new_value:e}),await n()}})})}function wo(e){let{domainSettingsStore:t,saveEmailDomainSettings:n,promptUpgrade:s,hasVerifiedDomains:o,disabled:l}=e;const d=(0,i.O7)(),u=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),m=(0,a.VK)((()=>Boolean(t.state.settings.prevent_profile_edits)),[t]),p=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventProfileEdits.title",defaultMessage:"Allow managed users to change profile information"}),g=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventProfileEdits.message",defaultMessage:"Control if managed users can change their preferred name, email address, and profile photo."});return s?(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(ro,{title:p,byline:g,targetTier:"enterprise"})}):(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(Mo.w,{title:(0,c.jsx)("div",{style:u.settingsTitle,children:p}),byline:g,isOn:!m,onToggle:async function(){const e=Boolean(!t.state.settings.prevent_profile_edits);t.setState({...t.state,settings:{...t.state.settings,prevent_profile_edits:e}}),Si.Dn(d,{new_value:e}),await n()},disabled:l||!o})})}function ko(e){let{spaceStore:t,samlConfigStore:n,domainSettingsStore:s}=e;const{verifiedDomains:i,isDomainSettingsAvailable:o,isSamlEditable:l,saveEmailDomainSettings:d}=io({spaceStore:t,samlConfigStore:n,domainSettingsStore:s}),u=(0,r.yK)((e=>({byline:{fontSize:14,fontWeight:y.Z.fontWeight.regular,color:e.mediumTextColor},helpButton:{marginTop:18,marginBottom:16}})),[]),m=o&&l,p=(0,a.VK)((()=>t.id),[t]),g=(0,a.VK)((()=>(0,bt.wP)()),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{children:(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:u.byline,children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.byline",defaultMessage:"These settings apply to all users with a verified domain, even if they are not a member of this workspace."})})}),(0,c.jsx)(Qi.Z,{title:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.helpButton",defaultMessage:"Learn about managed users"}),href:(0,ze.UY)("guides.managedUsers"),style:u.helpButton,analyticsFrom:"managed_users_section"}),(0,c.jsx)(bo,{promptUpgrade:!g,hasVerifiedDomains:i.length>0,disabled:!m}),(0,c.jsx)(wo,{promptUpgrade:!g,hasVerifiedDomains:i.length>0,domainSettingsStore:s,saveEmailDomainSettings:d,disabled:!m}),(0,c.jsx)(Co,{promptUpgrade:!g,domainSettingsStore:s,saveEmailDomainSettings:d,disabled:!m}),(0,c.jsx)(jo,{promptUpgrade:!g,verifiedDomains:i,domainSettingsStore:s,saveEmailDomainSettings:d,disabled:!m}),(0,c.jsx)(xo,{promptUpgrade:!g,domainSettingsStore:s,saveEmailDomainSettings:d,disabled:!m}),(0,c.jsx)(vo,{spaceId:p,promptUpgrade:!g,domainSettingsStore:s,verifiedDomains:i,disabled:!m}),(0,c.jsx)(So,{spaceId:p,promptUpgrade:!g,domainSettingsStore:s,verifiedDomains:i,disabled:!m})]})}function Io(e){let{spaceStore:t,samlConfigStore:n}=e;const o=(0,i.O7)();return{updateSamlIdpUrl:(0,s.useCallback)((async e=>{let s=!1;return await so({onRequest:()=>I.setSamlConfig(o,{spaceId:t.id,idpMetadataUrl:e}),onSuccess:()=>{s=!0,n.setState({...n.state,useMetadataUrl:!0,idpMetadataUrl:e,idpMetadata:void 0})}}),s}),[n,t,o]),updateSamlIdpXml:(0,s.useCallback)((async e=>{let s=!1;return await so({onRequest:()=>I.setSamlConfig(o,{spaceId:t.id,idpMetadata:e}),onSuccess:()=>{s=!0,n.setState({...n.state,useMetadataUrl:!1,idpMetadataUrl:void 0,idpMetadata:e})}}),s}),[n,t,o]),updateStatus:(0,s.useCallback)((e=>so({onRequest:()=>I.setSamlConfig(o,{spaceId:t.id,status:e}),onSuccess:()=>{n.setState({...n.state,status:e})}})),[n,t,o]),updateCreateAccount:(0,s.useCallback)((e=>so({onRequest:()=>I.setSamlConfig(o,{spaceId:t.id,createAccount:e}),onSuccess:()=>{n.setState({...n.state,createAccount:e})}})),[n,t,o])}}function To(e){let{spaceStore:t,samlConfigStore:n,disabled:s}=e;const{updateCreateAccount:o}=Io({samlConfigStore:n,spaceStore:t}),l=(0,i.O7)(),d=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),u=(0,a.VK)((()=>n.state.createAccount),[n]);return(0,c.jsx)("div",{style:d.settingContainer,children:(0,c.jsx)(Mo.w,{title:(0,c.jsxs)("div",{style:d.settingsTitle,children:[(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.createAccount.title",defaultMessage:"Automatic account creation"}),(0,c.jsx)(ui.Z,{icon:di.m,onClick:()=>C.D({environment:l,url:(0,ze.UY)("guides.samlJIT")})})]}),byline:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.createAccount.byline",defaultMessage:"Automatically create Notion accounts for new users who log in via SAML SSO."}),isOn:u,onToggle:async function(){await o(!n.state.createAccount)},disabled:s})})}function Zo(e){let{spaceStore:t,samlConfigStore:n,promptUpgrade:s,disabled:o}=e;const l=(0,i.O7)(),{updateStatus:d}=Io({samlConfigStore:n,spaceStore:t}),u=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),m=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.accountAuth.title",defaultMessage:"Login method"}),p=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.accountAuth.byline",defaultMessage:"Customize how users access workspaces that have SAML SSO enabled. Workspace owners can always log in with a password."}),g=(0,a.VK)((()=>"enforced"===n.state.status?"enforced":"not_enforced"),[n]);return s?(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(ro,{title:m,byline:p,targetTier:"business"})}):(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(Ds.Z,{isMobile:l.device.isMobile,disabled:o,title:m,caption:p,type:"dropdown",currentOption:g,options:[{key:"enforced",label:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.enforced",defaultMessage:"Only SAML SSO"})},{key:"not_enforced",label:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.notEnforced",defaultMessage:"Any method"})}],onSelectOption:async function(){"enforced"===n.state.status?await d("configured"):await d("enforced")}})})}var Po=n(313991),Fo=n(654497),_o=n(405228),Ao=n(346978);function Bo(e){let{isOpen:t,...n}=e;const s=(0,a.VK)((()=>({active:n.samlConfigStore.state.useMetadataUrl?"url":"xml",url:n.samlConfigStore.state.idpMetadataUrl||"",xml:n.samlConfigStore.state.idpMetadata||""})),[n.samlConfigStore]);return(0,c.jsx)(Hs.Z,{open:t,onDismiss:n.onClose,render:()=>(0,c.jsx)(Ro,{...n,initialConfiguration:s})})}function Ro(e){let{onSaveChanges:t,initialConfiguration:n,samlConfigStore:o,spaceStore:l,onClose:d}=e;const[u,m]=(0,s.useState)(n),p=(0,i.O7)(),g=(0,r.yK)((e=>({container:{background:e.popoverBackground,width:450,padding:24,borderRadius:4,transition:"all 500ms ease"},title:{fontFamily:y.Z.getCompositeFontFamily(Po.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:y.Z.getCompositeFontFamily(Po.SP).sans,fontSize:14,fontWeight:500,lineHeight:"19px",margin:"20px 0 0"},copyButton:{borderRadius:4,padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,fontFamily:y.Z.getCompositeFontFamily(Po.SP).sans,fontSize:12,fontWeight:500,lineHeight:"14px"},copyIcon:{width:16,height:16,marginRight:4,fill:e.mediumIconColor},url:{width:"100%",color:e.mediumTextColor,fontFamily:y.Z.getCompositeFontFamily(Po.SP).sans,fontSize:14,fontWeight:400,lineHeight:"18px"},readonlyInput:{display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`,height:32,paddingLeft:12,paddingRight:12,borderRadius:4},divider:{margin:"20px auto 20px"},radioContainer:{display:"flex",justifyContent:"space-evenly",flexDirection:"column",height:60},radioOption:{display:"flex",alignItems:"center"},caption:{margin:"4px 0 8px"},centeredCaption:{margin:"4px 24px 8px",textAlign:"center"},buttonContainer:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginTop:24},buttonSpacing:{marginRight:8},feedback:{color:"dark"===e.mode?e.accentColors.orange[500]:e.accentColors.orange[400],display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px",height:20}})),[]),h=(0,s.useMemo)((()=>Oo(u)),[u]),x=(0,a.VK)((()=>"unconfigured"===o.state.status),[o]),S=(0,a.VK)((()=>(0,_o.v9)(l.id,ds.default.domainBaseUrl)),[l]),v=(0,s.useCallback)((()=>{ve.RD({environment:p,stringValue:S,copiedMessage:ve.tq.copiedLinkToClipboard})}),[p,S]),b=(0,s.useCallback)((()=>{m((e=>({...e,active:"url"})))}),[]),M=(0,s.useCallback)((()=>{m((e=>({...e,active:"xml"})))}),[]),j=(0,r.yK)((e=>({input:{transition:"all 200ms ease-in-out",boxShadow:"none",margin:"12px 0",width:"100%",background:e.popoverBackground,border:`1px solid ${e.outlineButtonBorder}`}})),[]),C=(0,s.useMemo)((()=>"url"===u.active?{placeholder:"https://...",value:u.url,onChange:e=>{const t=e.target.value;m((e=>({...e,url:t})))},style:{height:32,...j.input}}:{placeholder:'<md:EntityDescriptor entityID="...',value:u.xml,onChange:e=>{const t=e.target.value;m((e=>({...e,xml:t})))},textarea:!0,style:{height:118,...j.input},inputStyle:{width:"100%",height:"100%"}}),[u,j]),w=(0,s.useCallback)((()=>{t(u)}),[t,u]);return(0,c.jsxs)("div",{style:g.container,children:[(0,c.jsx)(Ce.Z,{style:g.title,children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.title",defaultMessage:"SAML SSO Configuration"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,style:g.centeredCaption,isMultiline:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.byline",defaultMessage:"Configure SAML SSO for your Notion workspace with your Identity Provider (IDP). <guidelink>Learn more</guidelink>.",values:{guidelink:e=>(0,c.jsx)(Rs.Z,{href:(0,ze.UY)("guides.samlSettings"),external:!0,children:e})}})}),(0,c.jsx)(Ce.Z,{style:g.subtitle,children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsTitle",defaultMessage:"Assertion Consumer Service (ACS) URL"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,style:g.caption,isMultiline:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsByline",defaultMessage:"Enter this in your IDP's SAML configuration."})}),(0,c.jsxs)("div",{style:g.readonlyInput,children:[(0,c.jsx)(Ce.Z,{style:g.url,children:S}),(0,c.jsxs)(Me.Z,{onClick:v,style:g.copyButton,children:[(0,Se.U)(g.copyIcon),(0,c.jsx)(f.FormattedMessage,{id:"verifyDomainModal.editSamlConfig.copy",defaultMessage:"Copy"})]})]}),(0,c.jsx)(Ce.Z,{style:g.subtitle,children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpTitle",defaultMessage:"Identity Provider Details"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,style:g.caption,children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrlByline",defaultMessage:"Enter the value provided by your IDP."})}),(0,c.jsxs)("div",{style:g.radioContainer,children:[(0,c.jsxs)(pn.Z,{style:g.radioOption,onClick:b,children:[(0,c.jsx)(Ao.Z,{isSelected:"url"===u.active}),(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrl",defaultMessage:"Identity Provider URL"})})]}),(0,c.jsxs)(pn.Z,{style:g.radioOption,onClick:M,children:[(0,c.jsx)(Ao.Z,{isSelected:"xml"===u.active}),(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpXml",defaultMessage:"Identity Provider Metadata XML"})})]})]}),(0,c.jsx)(Cs.Z,{...C}),(0,c.jsx)("div",{style:g.feedback,children:(0,c.jsx)(Do,{validation:h})}),(0,c.jsxs)("div",{style:g.buttonContainer,children:[(0,c.jsx)(yt.Z,{isLarge:!0,style:g.buttonSpacing,onClick:d,children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.cancel",defaultMessage:"Cancel"})}),(0,c.jsx)(Bs.Z,{isLarge:!0,disabled:"invalid"===h.type,onClick:w,children:x?(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.enableSaml",defaultMessage:"Enable SAML"}):(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.saveChanges",defaultMessage:"Save changes"})})]})]})}function Do(e){let t,{validation:n}=e;if("valid"===n.type)return null;switch(n.reason){case"empty":t=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.empty",defaultMessage:"You cannot leave this field blank"});break;case"signed_request":t=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.signed_request",defaultMessage:"Requests cannot be signed"})}return(0,c.jsxs)(c.Fragment,{children:[(0,Fo.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,c.jsx)("span",{children:t})]})}function Oo(e){return"url"===e.active?(0,_o.jY)(e.url):"xml"===e.active?(0,_o.a7)(e.xml):void(0,Zn.t1)(e.active)}function Lo(e){let{spaceStore:t,samlConfigStore:n,domainSettingsStore:i,isSamlStatusEnabled:o,promptUpgrade:a,disabled:l}=e;const[d,u]=(0,s.useState)({isOpened:!1,enableSamlOnSave:!1}),{updateStatus:m,updateSamlIdpUrl:p,updateSamlIdpXml:g}=Io({samlConfigStore:n,spaceStore:t}),{verifiedDomains:h}=io({spaceStore:t,samlConfigStore:n,domainSettingsStore:i}),x=(0,r.yK)((()=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",cursor:l?"default":"pointer"},settingTitle:{fontWeight:y.Z.fontWeight.medium},settingByline:{marginBottom:4},configButton:{marginTop:14}})),[l]),S=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.samlToggle.title",defaultMessage:"Enable SAML SSO"}),v=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.samlToggle.byline",defaultMessage:"Workspace members can log in with SAML SSO if their email address uses a verified domain."});return a?(0,c.jsx)(ro,{title:S,byline:v,targetTier:"business"}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Mo.w,{title:S,byline:v,isOn:o,disabled:l,tooltipForDisabled:0===h.length?(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.samlToggle.disabledTooltipNoVerifiedDomains",defaultMessage:"Verify a domain to enable SAML."}):void 0,onToggle:function(){if(l)return;const{useMetadataUrl:e,idpMetadata:t,idpMetadataUrl:s}=n.state,i=e&&s||!e&&t;switch(n.state.status){case"disabled":i?m("configured"):u({isOpened:!0,enableSamlOnSave:!0});break;case"unconfigured":u({isOpened:!0,enableSamlOnSave:!0});break;case"configured":case"enforced":m("disabled")}}}),(0,c.jsx)(yt.Z,{disabled:l,disabledFeedback:l,isLarge:!0,style:x.configButton,onClick:function(){l||u({isOpened:!0,enableSamlOnSave:!1})},children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.samlToggle.configure",defaultMessage:"Edit SAML SSO configuration"})}),(0,c.jsx)(Bo,{isOpen:d.isOpened,onClose:()=>u({isOpened:!1,enableSamlOnSave:!1}),onSaveChanges:async function(e){if("invalid"===Oo(e).type)return;let t=!1;switch(e.active){case"url":t=await p(e.url);break;case"xml":t=await g(e.xml)}t&&(d.enableSamlOnSave&&await m("configured"),u({isOpened:!1,enableSamlOnSave:!1}))},spaceStore:t,samlConfigStore:n})]})}var Vo=n(139634),Eo=n(407057);const No={id:"name",headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name",defaultMessage:"Name"}),renderCell:e=>(0,c.jsx)(Go,{space:e.space,isCurrentSpace:e.isCurrentSpace}),widthData:{width:50},sortable:!0},Uo={id:"memberCount",headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.memberCount",defaultMessage:"Members"}),renderCell:e=>(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.members",defaultMessage:"{count} members",values:{count:e.space.memberCount}})}),widthData:{width:20},sortable:!0},Ko={id:"createdAt",headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.plan",defaultMessage:"Created at"}),renderCell:e=>{const t=e.space.createdTime;return(0,c.jsx)(Ce.Z,{children:t&&(0,Eo.Yx)(t,"medium",Po.SP)})},widthData:{width:20},sortable:!0},Wo=[No,Uo,Ko];function zo(e){let{spaceStore:t,spaces:n}=e;const[i,o]=(0,s.useState)({column:No,sortAscending:!1}),l=(0,a.VK)((()=>n.map((e=>({id:e.id,isClickable:!1,isCurrentSpace:t.id===e.id,space:e})))),[n,t]),d=(0,r.yK)((e=>(0,be.b)({columnRenderInfo:Wo,theme:e,containerMarginTop:12})),[]);return(0,c.jsx)(be.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Wo,rows:qo(l,i),sortState:i,onSortStateChanged:o,renderNoRowsComponent:()=>(0,c.jsx)(Ce.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.empty",defaultMessage:"No linked workspaces."})}),styles:d})}function qo(e,t){let{column:n,sortAscending:s}=t,i=[];switch(n.id){case"name":i=h.MR(e,(e=>e.space.name));break;case"createdAt":i=h.MR(e,(e=>e.space.createdTime));break;case"memberCount":i=h.MR(e,(e=>e.space.memberCount))}return s?i:i.reverse()}function Go(e){const t=(0,r.yK)((()=>({container:{display:"flex",justifyContent:"center",alignItems:"center",gap:4}})),[]);return(0,c.jsxs)(Ce.Z,{style:t.container,children:[e.space.name,e.isCurrentSpace?(0,c.jsx)(se.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name.currentBadge",defaultMessage:"Current"})}):null]})}function Ho(e){let{spaceStore:t,spaces:n}=e;const o=(0,i.O7)(),a=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),l=(0,s.useCallback)((()=>{Vo.j({environment:o,from:"saml_settings",prepopulatedContent:`Request to add or remove a workspace for SAML Single Sign-on on workspace ${t.id}.`})}),[t,o]);return(0,c.jsxs)("div",{style:a.settingContainer,children:[(0,c.jsx)(oo.N,{title:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.title",defaultMessage:"Linked workspaces"}),byline:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.message",defaultMessage:"This SAML SSO configuration applies to the following other workspaces. <contactlink>Contact support</contactlink> to add or remove a workspace.",values:{contactlink:e=>(0,c.jsx)(Rs.Z,{onClick:l,children:e})}}),settingItem:null}),(0,c.jsx)(zo,{spaceStore:t,spaces:n})]})}function $o(e){let{spaceStore:t,samlConfigStore:n,domainSettingsStore:s}=e;const{verifiedDomains:i,isSamlAvailable:o,isSamlEditable:r,isSamlStatusEnabled:l}=io({spaceStore:t,samlConfigStore:n,domainSettingsStore:s}),d=!r||!o||!l,u=(0,a.VK)((()=>n.state.spaces),[n]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Qi.Z,{title:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.samlToggle.learnMore",defaultMessage:"Learn about SAML SSO"}),href:(0,ze.UY)("guides.samlSettings"),style:{marginTop:18,marginBottom:16},analyticsFrom:"saml_settings"}),(0,c.jsx)(Lo,{disabled:!r||0===i.length,promptUpgrade:!o,isSamlStatusEnabled:l,spaceStore:t,samlConfigStore:n,domainSettingsStore:s}),(0,c.jsx)(Zo,{disabled:d,promptUpgrade:!o,spaceStore:t,samlConfigStore:n}),(0,c.jsx)(To,{disabled:d,spaceStore:t,samlConfigStore:n}),(0,c.jsx)(Ho,{spaceStore:t,spaces:u})]})}const Yo=(0,f.defineMessages)({failedCreatingNewScimToken:{id:"scimTokenSettings.error.failedCreatingNewScimToken",defaultMessage:"Failed to create a new SCIM token, please try again later."}});function Qo(e){const[t,n]=(0,s.useState)(!1),o=(0,i.O7)();const a=!t&&"Able"===e.tokenCreationAbility,r=t||"Able"!==e.tokenCreationAbility,l=(0,c.jsx)(pn.Z,{isBlue:a,isLightGray:r,disabled:r,style:{position:"relative",marginLeft:"auto",marginRight:0},icon:e=>(0,ss.R)({...e,width:14,height:14,fill:"inherit",marginRight:"6px"}),onClick:async function(){n(!0);try{const t=await async function(e){let{environment:t,spaceStore:n,userStore:s}=e;const{botStore:i,transactionPromise:o}=On.lz({environment:t,spaceStore:n,name:"SCIM",userId:s.id,spaceRole:"editor",type:"scim"});return await o,i.id}({...e,environment:o});e.onNewScimToken(t)}catch(t){M.showErrorMessage(V.default.formatMessage(Yo.failedCreatingNewScimToken))}n(!1)},children:(0,c.jsx)(f.FormattedMessage,{id:"scimTokenSettings.NewSCIMTokenButton.title",defaultMessage:"Add token"})});let d;switch(e.tokenCreationAbility){case"Able":return l;case"Undefined":d=(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Not able to create a new SCIM token right now. Please try again later.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.undefined"});break;case"SpaceHasExistingToken":d=(0,c.jsx)(f.FormattedMessage,{defaultMessage:"To create a new SCIM token, please revoke the existing token.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.spaceHasLegacyToken"});break;case"UserHasExistingToken":d=(0,c.jsx)(f.FormattedMessage,{defaultMessage:"You already have a registered SCIM token. To create a new one, please revoke the token created by you.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.userHasExistingToken"});break;default:(0,Zn.t1)(e.tokenCreationAbility)}return(0,c.jsx)(je.Z,{textWrap:!1,renderTooltip:()=>d,placement:ke.u.Right,render:e=>(0,c.jsx)("div",{...e,style:{paddingLeft:"4px"},children:l})})}var Jo=n(715070),Xo=n(959753),ea=n(307928);function ta(e){let{userId:t,currentSpaceStore:n}=e;return oe.U6.createChildStore(n,{table:D.KJ,id:t})}var na=n(231945),sa=n(462385),ia=n(717290);const oa={container:{display:"flex",alignItems:"center",fontSize:y.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},userName:{flexShrink:1,...y.Z.textOverflowStyle}};function aa(e,t){const n=Xo.kk.fromValue(R.cZ,e);return n.getCreatedByTable()===D.KJ&&n.getCreatedById()===t}const ra={buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,height:20,width:20,marginRight:1},menuItemButton:{minWidth:200}};function la(e){let{onRevokeToken:t}=e;const n=(0,r.Fg)();return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(je.Z,{textWrap:!1,renderTooltip:()=>(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Revoke this token.",id:"revokeTokenButton.tooltip"})}),placement:ke.u.Right,render:e=>(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,placementToOrigin:na.pO.Right,renderOrigin:t=>(0,c.jsx)(Me.Z,{className:Ke.TAd,style:ra.buttonStyle,mobileFeedback:!1,...e,...t,children:(0,yi.y)({fill:n.mediumIconColor,width:12,height:12})}),onClick:()=>{M.confirmUserAction({message:(0,c.jsx)(f.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.message",defaultMessage:"Are you sure you want to revoke this token?"}),description:(0,c.jsx)(f.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.description",defaultMessage:"Existing SCIM configurations that use this token will no longer work once the token is revoked, and you'll have to provide them with a new token."}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.acceptButton.label",defaultMessage:"Revoke token"}),cancelLabel:(0,c.jsx)(f.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.cancelButton.label",defaultMessage:"Cancel"})}).then((e=>e&&t()))},render:e=>(e.close(),(0,c.jsx)(c.Fragment,{}))})})})}function da(){const e=(0,r.Fg)();return(0,c.jsx)(je.Z,{textWrap:!1,renderTooltip:()=>(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Outdated token. Revoke this token and generate a new one to view its contents.",id:"manageScimTokenTable.OutdatedWarningIcon.tooltip"})}),placement:ke.u.Right,render:t=>(0,c.jsx)("div",{...t,style:{paddingLeft:"4px"},children:(0,Fo.t)({fill:(0,is.fi)("orange",e).fill,width:12,height:12})})})}function ca(e){let{clipboardTextFn:t}=e;const n=(0,i.O7)();const s=(0,r.Fg)(),o={height:25,background:s.whiteButtonBackground,color:s.regularTextColor,fontWeight:y.Z.fontWeight.regular,padding:"4px 6px",fontSize:11.5};return(0,c.jsxs)(sa.Z,{onClick:async function(){const e=await t();void 0!==e&&ve.RD({environment:n,stringValue:e,copiedMessage:ve.tq.copiedTokenToClipboard,showCopyModal:!!n.device.isSafari||void 0})},style:o,children:[(0,Se.U)({height:16,width:16,paddingRight:4}),(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Copy",id:"codeBlock.copyToClipboard.button"})]})}const ua="•••••••••••";function ma(){return(0,c.jsx)(je.Z,{textWrap:!1,renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{defaultMessage:"This token can only be viewed by its creator.",id:"manageScimTokenTable.renderTokenThatCannotBeViewed.tooltip"}),placement:ke.u.Right,render:e=>(0,c.jsx)("div",{...e,children:ua})})}function pa(e){let{row:t}=e;const n=(0,i.O7)();return t.legacy?(0,c.jsxs)(c.Fragment,{children:[ua,(0,c.jsx)(da,{})]}):t.ownedByCurrentUser?(0,c.jsxs)(c.Fragment,{children:[ua,(0,c.jsx)(ca,{clipboardTextFn:()=>On.VG({environment:n,botId:t.id})})]}):(0,c.jsx)(ma,{})}const ga={id:"token",headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"manageScimTokenTable.columnTitle.token",defaultMessage:"Token"}),renderCell:e=>(0,c.jsx)(pa,{row:e}),widthData:{width:40},sortable:!1,hasClickableContents:!0};function fa(){const e=oa;return(0,c.jsx)(je.Z,{textWrap:!1,renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{defaultMessage:"This token was created by a user who is no longer an admin in the workspace.",id:"scimTableLegacyUserCell.tooltip"}),placement:ke.u.Right,render:t=>(0,c.jsx)("div",{...t,children:(0,c.jsxs)("div",{style:e.container,children:[(0,c.jsx)($s.Z,{style:e.userAvatar,avatarShouldShowShadow:!0,size:20}),(0,c.jsx)("div",{style:e.userName,children:(0,c.jsx)("i",{children:"Deactivated user"})})]})})})}const ha={id:"addedBy",headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"manageScimTokenTable.columnTitle.addedBy",defaultMessage:"Added by"}),renderCell:e=>{if(e.legacy)return(0,c.jsx)(fa,{});{const t=e.ownedByCurrentUser?(0,c.jsx)(Ce.Z,{isSecondaryColor:!0,style:{marginLeft:4,textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{id:"manageSCIMTokenTable.colums.addedBy.selfIndicator",defaultMessage:"(you)"})}):(0,c.jsx)(c.Fragment,{});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ia.G,{isClickable:!1,userStores:[e.ownerUserStore]}),t]})}},widthData:{width:40},sortable:!1,hasClickableContents:!1},ya={id:"created",headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"manageScimTokenTable.columnTitle.created",defaultMessage:"Created"}),renderCell:e=>(0,c.jsx)(ki.T,{includeTime:!0,dateTs:e.createdAt}),widthData:{width:40},sortable:!0,hasClickableContents:!1},xa=[ga,ha,ya,{id:"revokeToken",headerTitle:void 0,renderCell:e=>(0,c.jsx)(la,{onRevokeToken:()=>{e.onRevokeToken()}}),widthData:{width:10},sortable:!1,hasClickableContents:!0}];function Sa(e,t){let{column:n,sortAscending:s}=t;const i=null==n?void 0:n.id;let o=e=>e.id;switch(i){case"name":o=e=>e.name;break;case"created":o=e=>e.createdAt;break;case"token":case"addedBy":case"revokeToken":case void 0:break;default:(0,Zn.t1)(i)}const a=h.MR(e,o);return s||a.reverse(),a}function va(e){let{botStores:t,onRevokeToken:n}=e;const i=(0,a.VK)((()=>Ge.default.state.currentUserStore),[]),o=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),l=(0,f.useIntl)(),d=(0,a.VK)((()=>{if(!o)return[];const e=null==i?void 0:i.id;return h.oA(t.map((t=>{const s=t.getModel();if(!s||!(0,Jo.xe)(s))return;const i={id:s.id,isClickable:!1,createdAt:s.getCreatedAt(),userLocale:l.locale,name:s.getName(),onRevokeToken:()=>{n(s.id)}},a=function(e){const t=Xo.kk.fromValue(R.cZ,e);return"notion_user"===t.getCreatedByTable()&&t.getCreatedById()===D.s$.id}(s);return a?{...i,legacy:a}:{...i,legacy:a,ownedByCurrentUser:aa(s,e),ownerUserStore:"notion_user"===s.getCreatedByTable()?ta({userId:s.getCreatedById(),currentSpaceStore:o}):void 0}})))}),[t,o,i,l.locale,n]),[u,m]=(0,s.useState)({column:ya,sortAscending:!1}),p=(0,r.yK)((e=>(0,be.b)({columnRenderInfo:xa,theme:e,containerMarginTop:0})),[]);return(0,c.jsx)(be.D,{columnRenderInfo:xa,rows:Sa(d,u),sortState:u,onSortStateChanged:m,onRowClick:()=>(0,c.jsx)(c.Fragment,{}),renderNoRowsComponent:()=>(0,c.jsx)(Ce.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{id:"manageSCIMTokenTable.noTokensFound.message",defaultMessage:"No active SCIM tokens."})}),styles:p})}async function ba(e){let{environment:t,spaceId:n}=e;return(await On.Yw({environment:t,table:Dn.bx,id:n,type:"scim"})).botIds}const Ma=function(e){let{botIds:t,setBotIds:n,spaceStore:o}=e;const a=(0,i.O7)(),r=o.id;if((0,s.useEffect)((()=>{void 0===t&&ba({environment:a,spaceId:r}).then(n)}),[t,a,n,r]),t){const e=t.map((e=>oe.t1.createChildStore(o,{table:R.cZ,id:e,spaceId:r})));return(0,c.jsx)(va,{botStores:e,onRevokeToken:e=>{On.P0({environment:a,botId:e,onSuccess:()=>{ba({environment:a,spaceId:r}).then(n)}})}})}return(0,c.jsx)(zi.Z,{})};function ja(e){let{userStore:t,spaceStore:n,promptUpgrade:o}=e;const[r,l]=(0,s.useState)(void 0),d=(0,i.O7)(),u=(0,a.VK)((()=>function(e){let{botIds:t,spaceStore:n,environment:s}=e;if(void 0===t)return"Undefined";const i=t.map((e=>oe.t1.createChildStore(n,{table:R.cZ,id:e,spaceId:n.id}))).filter((e=>e.isDefined()));if(i.some((e=>e.getCreatedByTable()===D.KJ&&e.getCreatedById()===D.s$.id)))return"SpaceHasExistingToken";const o=i.some((e=>e.getCreatedByTable()===D.KJ&&e.getCreatedById()===s.currentUser.id));if(o)return"UserHasExistingToken";return"Able"}({botIds:r,spaceStore:n,environment:d})),[r,d,n]),m=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.scim.title",defaultMessage:"SCIM tokens"}),p=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.scim.byline",defaultMessage:"Generate a token to configure SCIM."});return o?(0,c.jsx)(ro,{title:m,byline:p,targetTier:"enterprise"}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(oo.N,{title:m,byline:p,settingItem:(0,c.jsx)(Qo,{onNewScimToken:e=>l((t=>[...t??[],e])),spaceStore:n,userStore:t,tokenCreationAbility:u})}),(0,c.jsx)(Qi.Z,{title:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.helpButton.label",defaultMessage:"Learn about SCIM"}),style:{marginTop:18,marginBottom:24},href:(0,ze.UY)("guides.scim"),analyticsFrom:"scim_settings"}),(0,c.jsx)(Ma,{spaceStore:n,userStore:t,botIds:r,setBotIds:l})]})}function Ca(e){let{spaceStore:t}=e;const n=(0,i.O7)(),s=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),o=(0,a.VK)((()=>Boolean(t.getSettings().are_scim_invite_emails_suppressed)),[t]),l=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.scim.suppressScimInviteEmails.title",defaultMessage:"Suppress invite emails from SCIM provisioning"}),d=(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.scim.suppressScimInviteEmails.message",defaultMessage:"Control if users will receive invite emails when provisioned by SCIM to workspaces and groups."});return(0,c.jsx)("div",{style:s.settingContainer,children:(0,c.jsx)(Mo.w,{title:(0,c.jsx)("div",{style:s.settingsTitle,children:l}),byline:d,isOn:o,onToggle:()=>function(e){let{environment:t,areScimInviteEmailsSuppressed:n,spaceStore:s}=e;P.createAndCommit({userAction:"ScimSection.SuppressScimInviteEmailsSetting",environment:t,perform:e=>{P.applyOperation({store:s,operation:{pointer:s.pointer,path:["settings","are_scim_invite_emails_suppressed"],command:"set",args:n},transaction:e})}})}({environment:n,spaceStore:t,areScimInviteEmailsSuppressed:!o})})})}function wa(e){let{userStore:t,spaceStore:n}=e;const s=(0,a.VK)((()=>(0,bt.wP)()),[]),i=(0,a.VK)((()=>Ie.default.checkGate({gateName:"scim_suppress_email"})),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ja,{promptUpgrade:!s,userStore:t,spaceStore:n}),s&&i?(0,c.jsx)(Ca,{spaceStore:n}):null]})}function ka(e){let{primarySpaceName:t}=e;const n=(0,r.yK)((e=>({container:{background:e.accentColors.blue[100],padding:"18px 24px",borderRadius:4,margin:"0 0 24px"}})),[]);return(0,c.jsxs)("div",{style:n.container,children:[(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableTitle",defaultMessage:"The primary workspace is <bold>{primaryWorkspaceName}</bold>.",values:{primaryWorkspaceName:t,bold:e=>(0,c.jsx)("span",{style:{fontWeight:y.Z.fontWeight.semibold},children:e})}})}),(0,c.jsx)("br",{}),(0,c.jsx)(Ce.Z,{isMultiline:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableMessage",defaultMessage:"The domain management settings and SAML SSO configuration are being managed by the workspace <bold>{primaryWorkspaceName}</bold>. Please navigate there or contact an admin of that workspace to edit the verified domains or SSO configuration.",values:{primaryWorkspaceName:t,bold:e=>(0,c.jsx)("span",{style:{fontWeight:y.Z.fontWeight.semibold},children:e})}})})]})}var Ia=n(386990);function Ta(e){let{userStore:t,spaceStore:n,samlConfigStore:o,domainSettingsStore:l,organizationInfo:d,isOrganizationOwner:u}=e;const m=(0,i.O7)(),p=(0,a.VK)((()=>yn.Z.state.online),[]),{loadingSaml:g,loadedSaml:h,errorSaml:y}=(0,s.useContext)(ri),x=void 0!==d,S=(0,a.VK)((()=>o.state.spaces.length),[o]),v=(0,a.VK)((()=>function(e){let{environment:t,samlConfigStore:n,spaceStore:s}=e;const i=Ki({environment:t,samlConfigStore:n}),o=!n.state.id||n.state.id===s.id;return i&&o}({environment:m,samlConfigStore:o,spaceStore:n})),[m,o,n]),b=(0,a.VK)((()=>o.state.id?Wi.Z.getData(m,{spaceId:o.state.id}):void 0),[m,o]),j=(0,r.yK)((e=>({header:{marginTop:36},byline:{color:e.mediumInvertedTextColor}})),[]),C=(0,a.VK)((()=>(0,bt.wP)()),[]);return(0,s.useEffect)((()=>{p&&!g&&y&&M.deprecatedShowErrorMessage(y.message)}),[y,g,p]),p?g?(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(zi.Z,{style:{margin:"0 auto"}})}):y?null:h?x?(0,c.jsxs)(kt.ZP,{children:[(0,c.jsx)(fe.Z,{large:!0,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.domainAndUserManagement.title",defaultMessage:"Domain & managed accounts"})}),u?(0,c.jsx)(Xi,{organizationId:d.id,content:(0,c.jsx)(f.FormattedMessage,{id:"workspaceSettingsModal.organizationsBanner.owner.title",defaultMessage:"Manage your domains and accounts for all {count, plural, one {{count} {organizationName} workspace} other {{count} {organizationName} workspaces}}",values:{count:S,organizationName:d.name}})}):(0,c.jsx)(eo,{content:(0,c.jsx)(f.FormattedMessage,{id:"workspaceSettingsModal.organizationsBanner.member.title",defaultMessage:"These settings can only be managed by organization owners"}),tooltipContent:(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(f.FormattedMessage,{id:"workspaceSettingsModal.organizationsBanner.member.tooltip",defaultMessage:"Verifying domains and managing accounts can only be done by organization owners{br}<byline>Organization owners can manage all workspaces in {organizationName}</byline>",values:{br:(0,c.jsx)("br",{}),organizationName:d.name,byline:e=>(0,c.jsx)("span",{style:j.byline,children:e})}})})}),!v&&b?(0,c.jsx)(ka,{primarySpaceName:b.name}):null,(0,c.jsx)(fe.Z,{large:!0,divider:"full",style:j.header,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.saml.title",defaultMessage:"SAML Single sign-on (SSO)"})}),(0,c.jsx)($o,{spaceStore:n,samlConfigStore:o,domainSettingsStore:l}),(0,c.jsx)(fe.Z,{large:!0,divider:"full",style:j.header,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.scim.title",defaultMessage:"SCIM provisioning"})}),(0,c.jsx)(wa,{userStore:t,spaceStore:n}),(0,c.jsx)(fe.Z,{large:!0,divider:"full",style:j.header,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.setupInfo.title",defaultMessage:"Setup information"})}),(0,c.jsx)(Ia.H,{spaceStore:n,isEnterprise:C})]}):(0,c.jsxs)(kt.ZP,{children:[!v&&b?(0,c.jsx)(ka,{primarySpaceName:b.name}):null,(0,c.jsx)(fe.Z,{large:!0,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.domain.title",defaultMessage:"Domain management"})}),(0,c.jsx)(fo,{spaceStore:n,samlConfigStore:o,domainSettingsStore:l,isCurrentSpaceEnterprise:C}),(0,c.jsx)(fe.Z,{large:!0,divider:"full",style:j.header,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.userManagement.title",defaultMessage:"User management"})}),(0,c.jsx)(ko,{spaceStore:n,samlConfigStore:o,domainSettingsStore:l}),(0,c.jsx)(fe.Z,{large:!0,divider:"full",style:j.header,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.saml.title",defaultMessage:"SAML Single sign-on (SSO)"})}),(0,c.jsx)($o,{spaceStore:n,samlConfigStore:o,domainSettingsStore:l}),(0,c.jsx)(fe.Z,{large:!0,divider:"full",style:j.header,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.scim.title",defaultMessage:"SCIM provisioning"})}),(0,c.jsx)(wa,{userStore:t,spaceStore:n}),(0,c.jsx)(fe.Z,{large:!0,divider:"full",style:j.header,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.setupInfo.title",defaultMessage:"Setup information"})}),(0,c.jsx)(Ia.H,{spaceStore:n,isEnterprise:C})]}):null:(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Please go online to manage identity and provisioning settings.",id:"identityProvisioningSettings.offline.message"})})})}function Za(e,t){return(void 0===e||!(0,qn.XR)(e))&&(!(void 0===e||!(0,qn.TZ)(e)||0!==t)||1===t)}var Pa=n(292595),Fa=n(192165);const _a=(0,d.IU)("arrowUpCircled",{viewBox:"0 0 16 16",svg:(0,c.jsx)("path",{d:"M7.993 15.126c.966 0 1.875-.185 2.728-.554a7.218 7.218 0 003.787-3.78 6.788 6.788 0 00.553-2.728c0-.966-.184-1.875-.553-2.727a7.136 7.136 0 00-1.531-2.25 7.219 7.219 0 00-2.256-1.53 6.805 6.805 0 00-2.735-.554c-.966 0-1.875.185-2.727.554a7.241 7.241 0 00-3.774 3.78 6.788 6.788 0 00-.553 2.727c0 .967.184 1.876.553 2.728.37.852.878 1.604 1.525 2.256a7.124 7.124 0 002.256 1.524 6.77 6.77 0 002.727.554zm0-1.395a5.598 5.598 0 01-4.013-1.654 5.735 5.735 0 01-1.21-1.804 5.567 5.567 0 01-.437-2.209c0-.783.146-1.517.438-2.2a5.715 5.715 0 011.21-1.812 5.6 5.6 0 011.797-1.217 5.599 5.599 0 012.208-.438c.789 0 1.525.146 2.208.438a5.66 5.66 0 013.029 3.028 5.55 5.55 0 01.437 2.201c0 .789-.146 1.525-.437 2.209a5.68 5.68 0 01-1.217 1.804 5.68 5.68 0 01-1.805 1.217 5.567 5.567 0 01-2.208.437zM8 11.51a.597.597 0 00.43-.164.584.584 0 00.172-.431V7.688L8.547 6.28l.622.78.759.793a.53.53 0 00.417.177c.16 0 .291-.052.396-.157a.518.518 0 00.164-.39.595.595 0 00-.164-.417L8.485 4.783A.664.664 0 008 4.558c-.173 0-.333.075-.479.225L5.26 7.066a.593.593 0 00-.157.417.538.538 0 00.554.547.557.557 0 00.416-.177l.766-.8.615-.766-.055 1.401v3.227c0 .173.057.317.171.43.114.11.258.165.431.165z"})});var Aa=n(461652),Ba=n(99622),Ra=n(327242),Da=n(154561),Oa=n(973420);function La(){return(0,c.jsx)(je.Z,{renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingWorkspaceClaim.Explanation",defaultMessage:"Workspace claim request is being processed."}),render:e=>(0,c.jsx)(Ce.Z,{...e,children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingClaim",defaultMessage:"Pending"})})})}function Va(e){let{admin:t}=e;const n=(0,f.useIntl)();return(0,c.jsx)(je.Z,{renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingWorkspaceTransferExplanation",defaultMessage:"Waiting for {name} to transfer the workspace to an external account.",values:{name:(0,ea.Nz)(n,t)}}),render:e=>(0,c.jsx)(Ce.Z,{...e,children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingTransfer",defaultMessage:"Pending"})})})}var Ea=n(356666),Na=n(61766),Ua=n(693405);let Ka=function(e){return e.Single="single",e.Multi="multi",e}({});function Wa(e){const{space:t,mode:n}=e,s=(0,a.qz)(void 0,Na.Z),i=(0,r.yK)((()=>({container:{minWidth:325}})),[]);return n===Ka.Single?(0,c.jsx)(qa,{action:e.action,space:t}):(0,c.jsx)(na.ZP,{popupType:ws.kQ.Popup,style:i.container,buttonPopupStore:s,renderOrigin:e=>(0,c.jsx)(ui.Z,{icon:Ea.o,...e}),render:()=>(0,c.jsx)(za,{space:t,actions:e.actions,popupStore:s})})}function za(e){let{space:t,actions:n,popupStore:s}=e;const i={key:"workspace-actions",render:e=>(0,c.jsx)(ys.Z,{...e}),items:n.map((e=>{const n=!!e.getDisabledState&&e.getDisabledState(t),s=e.getTooltip?e.getTooltip(t):null;return{key:e.id,render:t=>(0,c.jsx)(je.Z,{render:s=>(0,c.jsx)(Ua.Z,{...t,...s,shouldWrapCaption:!0,svg:t=>e.getIcon(t),title:e.name,caption:e.caption,style:{paddingTop:8,paddingBottom:8,opacity:n?.5:1},disabled:n}),renderTooltip:()=>s,disableTooltip:!Boolean(s),placement:ke.u.Left}),action:()=>e.onAction(t)}}))};return(0,c.jsx)(ps.Z,{menuType:cs.og.Popup,children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:void 0,sections:[i],onAccept:()=>{s.setState({open:!1})}})})}function qa(e){const{action:t,space:n}=e,i=(0,r.yK)((e=>({button:{paddingLeft:5,paddingRight:5}})),[]),o=s.useCallback((()=>{t.onAction(n)}),[t,n]);return(0,c.jsx)(pn.Z,{isSmall:!0,style:i.button,onClick:o,children:t.name})}var Ga=n(733941);function Ha(e){let{id:t,name:n,icon:s,subscriptionTier:i,memberCount:o,highlightIconContainer:a}=e;const l=(0,f.useIntl)(),d=s?{pointer:{table:Dn.bx,id:t,spaceId:t},icon:s}:void 0,u=(0,r.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:"8px 0",width:"100%"},summaryContainer:{width:"calc(100% - 38px)"},iconContainer:{height:38,width:38,flexGrow:0,flexShrink:0,flexBasis:38,marginRight:12,display:"flex",justifyContent:"center",alignItems:"center",background:a?e.selectLightGray[50]:void 0,borderRadius:6},name:{fontSize:14,fontWeight:500},byline:{fontSize:12,opacity:.5}})),[a]);return(0,c.jsxs)("div",{style:u.container,children:[(0,c.jsx)("div",{style:u.iconContainer,children:(0,c.jsx)(hs.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:32,title:n,isLarge:!0,emojiSize:28,isRaw:!1})}),(0,c.jsxs)("div",{style:u.summaryContainer,children:[(0,c.jsx)(Ce.Z,{style:u.name,showTooltipWhenTruncated:!0,children:n}),(0,c.jsx)(Ce.Z,{style:u.byline,children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.summaryByline",defaultMessage:"{subscriptionTier} · {memberCount, plural, one {{memberCount} member} other {{memberCount} members}}",values:{subscriptionTier:$a(i,l),memberCount:o}})})]})]})}function $a(e,t){switch(e){case"personal_free":case"team_free":case"free":return t.formatMessage(Ga.a.free);case"personal":return t.formatMessage(Ga.a.personal);case"plus":return t.formatMessage(Ga.a.plusPlan);case"business":return t.formatMessage(Ga.a.business);default:(0,Zn.t1)(e)}}var Ya=n(903556);function Qa(e){let{users:t,deletedUserEmailDomain:n}=e;const s=(0,a.qz)(void 0,Na.Z),i=(0,r.yK)((()=>({container:{minWidth:275}})),[]);return(0,c.jsx)(na.ZP,{popupType:ws.kQ.Popup,style:i.container,buttonPopupStore:s,renderOrigin:e=>(0,c.jsx)(er,{users:t,deletedUserEmailDomain:n,...e}),render:()=>(0,c.jsx)(Ja,{users:t,popupStore:s})})}function Ja(e){let{users:t,popupStore:n}=e;const s=(0,i.O7)(),o={key:"workspace-users-menu",render:e=>(0,c.jsx)(ys.Z,{...e}),items:t.map((e=>({key:e.id,render:t=>(0,c.jsx)(Xa,{user:e,...t}),action:()=>C.D({environment:s,url:`mailto:${e.email}`})})))};return(0,c.jsx)(ps.Z,{menuType:cs.og.Popup,children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:0,sections:[o],onAccept:()=>{n.setState({open:!1})}})})}function Xa(e){let{user:t,...n}=e;const s=(0,f.useIntl)(),i=(0,r.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:"auto",paddingTop:8,paddingBottom:8,margin:"0 6px"},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center"},copyContainer:{display:"flex",justifyContent:"center",alignItems:"center",marginLeft:"auto",opacity:.5},nameContainer:{marginLeft:8,marginRight:8},name:{fontSize:14,lineHeight:1.2,maxWidth:300},email:{fontSize:12,lineHeight:1.2,opacity:.5,maxWidth:300}})),[]);return(0,c.jsxs)(pn.Z,{style:i.container,...n,children:[(0,c.jsx)("div",{style:i.avatarContainer,children:(0,c.jsx)($s.Z,{userValue:t,size:24})}),(0,c.jsxs)("div",{style:i.nameContainer,children:[(0,c.jsx)(Ce.Z,{style:i.name,children:(0,ea.Nz)(s,t)}),(0,c.jsx)(Ce.Z,{style:i.email,children:t.email})]}),(0,c.jsx)("div",{style:i.copyContainer,children:(0,Ya.Z)({height:18,width:18})})]})}function er(e){let{users:t,deletedUserEmailDomain:n,...s}=e;const i=(0,f.useIntl)(),o=(0,r.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",marginLeft:"-8px",maxWidth:"100%"},empty:{fontSize:14,maxWidth:150,opacity:.5},name:{fontSize:14,maxWidth:150},plusMore:{opacity:.5,display:"inline"}})),[]);return 0===t.length?(0,c.jsx)(je.Z,{render:e=>(0,c.jsx)(pn.Z,{style:o.container,disabled:!0,...s,...e,children:(0,c.jsx)(Ce.Z,{style:o.empty,children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.empty",defaultMessage:"Deleted user"})})}),disableTooltip:!n,renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.emptyTooltip",defaultMessage:"Deleted user from {domain}",values:{domain:`@${n}`}})}):(0,c.jsx)(pn.Z,{style:o.container,...s,children:(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.name",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser} <gray>+{remainingCount}</gray>} other {{firstUser} <gray>+{remainingCount}</gray>}}",values:{firstUser:(0,ea.Nz)(i,t[0]),remainingCount:t.length-1,gray:e=>(0,c.jsx)(Ce.Z,{style:o.plusMore,children:e})}})})})}const tr=[{id:"spaces",headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.name",defaultMessage:"Workspaces"}),renderCell:e=>(0,c.jsx)(Ha,{id:e.space.id,name:e.space.name,icon:e.space.icon,subscriptionTier:e.space.subscriptionTier,memberCount:e.space.memberCount}),widthData:{width:60},sortable:!1},{id:"admins",headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.admins",defaultMessage:"Workspace owners"}),renderCell:e=>(0,c.jsx)(Qa,{users:e.space.admins}),widthData:{width:40},sortable:!1},{id:"createdBy",headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdBy",defaultMessage:"Created by"}),renderCell:e=>e.space.creator?(0,c.jsx)(Qa,{users:[e.space.creator]}):(0,c.jsx)(Qa,{users:[],deletedUserEmailDomain:e.space.creatorEmailDomain}),widthData:{width:40},sortable:!1},{id:"createdAt",headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdAt",defaultMessage:"Created date"}),renderCell:e=>(0,c.jsx)(Ce.Z,{style:{opacity:.5},children:(0,yo.gs)(e.space.createdAt)}),widthData:{width:30},sortable:!1},{id:"action",headerTitle:null,renderCell:e=>{if((0,qn.DI)(e.space.spaceRequest))return(0,c.jsx)(Va,{admin:e.space.admins[0]});if((0,qn.XR)(e.space.spaceRequest))return(0,c.jsx)(La,{});if((0,qn.TZ)(e.space.spaceRequest)){const t=e.actions.find((e=>"recover-space"===e.id));return t&&(0,c.jsx)(Wa,{space:e.space,action:t,mode:Ka.Single})}return e.actions.length>0?(0,c.jsx)(Wa,{space:e.space,actions:e.actions.filter((e=>"recover-space"!==e.id)),mode:Ka.Multi}):null},widthData:{width:15},sortable:!1}];function nr(e){let{claimableSpaces:t,spaceActions:n,loadMoreClaimableSpaces:s,loading:i}=e;const o=t.map((e=>({id:e.id,isClickable:!1,space:e,actions:n}))),a=(0,r.yK)((e=>(0,be.b)({columnRenderInfo:tr,theme:e,containerMarginTop:0})),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(be.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:tr,rows:o,renderNoRowsComponent:()=>(0,c.jsx)(Ce.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:!i&&(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.empty",defaultMessage:"No claimable workspaces."})}),styles:a,getStyleForRow:function(e){if((0,qn.DI)(e.space.spaceRequest)||(0,qn.XR)(e.space.spaceRequest)||(0,qn.TZ)(e.space.spaceRequest))return{opacity:.5}},onLoadMore:s}),i&&(0,c.jsx)(zi.Z,{style:{margin:"24px auto 24px"}})]})}var sr=n(133728),ir=n(964275),or=n(636329),ar=n(698519),rr=n(316354);const lr=(0,f.defineMessages)({emailPlaceholder:{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.placeholder",defaultMessage:"it@example.com"}});function dr(e){let{onDismiss:t,spaceQueuedForTransfer:n,currentSpaceId:o}=e;const[a,l]=(0,s.useState)(),[d,u]=(0,s.useState)(!1),{setSpaceRequest:m}=(0,s.useContext)(ri),p=(0,i.O7)(),g=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:e.mediumIconColor,height:24,width:24},title:{fontWeight:y.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:y.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},dividerContainer:{marginTop:20},dividerInner:{borderBottomColor:e.regularDividerColor},contactEmailContainer:{position:"relative",width:"100%",minHeight:56,marginTop:13},contactEmailTitle:{fontWeight:y.Z.fontWeight.medium,fontSize:14,marginBottom:8,letterSpacing:-.15,display:"inline-flex",alignItems:"center"},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},primaryButton:{width:"100%",marginTop:32},buttonCaption:{color:e.mediumTextColor,marginTop:8,textAlign:"center",fontSize:12},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:y.Z.fontWeight.medium,color:e.lightTextColor},buttonCaptionError:{color:e.errorText,marginTop:8,fontSize:13}})),[]),h=Boolean(n);return(0,c.jsx)(Hs.Z,{open:h,innerStyle:g.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:g.closeIconContainer,children:(0,c.jsx)(pn.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,ir.D)(g.closeIcon)})}),(0,c.jsx)("div",{children:(0,or._)(g.modalIcon)}),(0,c.jsxs)(Ce.Z,{style:g.title,children:[(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.selfServe.title",defaultMessage:"Require account change"}),(0,c.jsx)(rr.Z,{href:(0,ze.UY)("guides.domainManagement"),children:(0,c.jsx)(ui.Z,{icon:di.m})})]}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:g.description,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.byline",defaultMessage:"You’re about to require the Workspace Owner of 1 workspace to use an external Notion accounts. They will be unable to use the workspace until the change is made."})}),(0,c.jsxs)("div",{style:g.workspaceContainer,children:[n?(0,c.jsx)(Ha,{id:n.id,name:n.name,icon:n.icon,subscriptionTier:n.subscriptionTier,memberCount:n.memberCount}):null,(0,c.jsx)("div",{style:g.checkContainer,children:(0,ar.k)(g.check)})]}),(0,c.jsx)(As.Z,{size:"100%",innerStyle:g.dividerInner,style:g.dividerContainer}),(0,c.jsxs)("div",{style:g.contactEmailContainer,children:[(0,c.jsxs)(Ce.Z,{style:g.contactEmailTitle,children:[(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.title",defaultMessage:"Send request from"}),(0,c.jsx)(je.Z,{renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingExplanation",defaultMessage:"The Workspace Owner can contact this email for inquiries"}),render:e=>(0,c.jsx)("span",{...e,children:(0,di.m)(g.helpIcon)})})]}),(0,c.jsx)(Cs.Z,{value:a,placeholder:V.default.formatMessage(lr.emailPlaceholder),onChange:e=>{u(!1),l(e.target.value)}}),d&&(0,c.jsx)(Ce.Z,{isSmall:!0,style:g.buttonCaptionError,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.error",defaultMessage:"Invalid email address"})})]}),(0,c.jsx)(Bs.Z,{isLarge:!0,style:g.primaryButton,onClick:async()=>{const e=(0,sr.H3)(a);var s;if((0,sr.oH)(e)){if(n&&e){const i=await I.initiateWorkspaceTransfer(p,{requestingSpaceId:o,targetSpaceId:n.id,contactEmail:e});if("failed"===i.type)M.showErrorMessage((0,L.wf)(V.default.getIntl(),i));else{const o=i.data.workspaceTransfer;m(n.id,o),Qs.az(p,{contactEmail:e,currentOwners:n.admins.map((e=>e.id)),targetSpaceId:n.id,verifiedDomain:n.creatorEmailDomain,subscriptionTier:n.subscriptionTier}),t(),s=n.name,vi.oV({label:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.toast",defaultMessage:"Account change successfully requested for “{spaceName}“",values:{spaceName:s}})})}}}else u(!0)},children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.confirm",defaultMessage:"Confirm change"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:g.buttonCaption,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.buttonCaption",defaultMessage:"This cannot be undone"})}),(0,c.jsx)(pn.Z,{style:g.secondaryButton,onClick:t,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.cancel",defaultMessage:"Cancel"})})]})})}function cr(e){let{onDismiss:t,spaceQueuedForClaiming:n,requestingSpaceId:o}=e;const a=(0,i.O7)(),{setSpaceRequest:l}=(0,s.useContext)(ri),d=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},title:{fontWeight:y.Z.fontWeight.medium,fontSize:16,marginBottom:8,display:"inline-flex",alignItems:"center",justifyContent:"center"},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},description:{fontWeight:y.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:y.Z.fontWeight.medium,color:e.lightTextColor},buttonCaption:{color:e.mediumTextColor,marginTop:8,textAlign:"center",fontSize:12}})),[]),u=Boolean(n),m=async()=>{if(!n)return;const e=await I.requestClaimAndUpgrade(a,{requestingSpaceId:o,targetSpaceId:n.id});var s;"failed"===e.type?M.showError(e):(Qs.eO(a,{currentOwners:n.admins.map((e=>e.id)),targetSpaceId:n.id,verifiedDomain:n.creatorEmailDomain,memberCount:n.memberCount}),l(n.id,e.data.spaceRequest),s=n.name,vi.oV({label:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.toast",defaultMessage:"Workspace claim successfully requested for “{spaceName}“",values:{spaceName:s}})})),t()};return(0,c.jsx)(Hs.Z,{open:u,innerStyle:d.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:d.closeIconContainer,children:(0,c.jsx)(pn.Z,{isSmall:!0,onClick:t,children:(0,ir.D)(d.closeIcon)})}),(0,c.jsxs)(Ce.Z,{style:d.title,children:[(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.title",defaultMessage:"Request workspace claim"}),(0,c.jsx)(rr.Z,{href:(0,ze.UY)("guides.domainManagement"),children:(0,c.jsx)(ui.Z,{icon:di.m})})]}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:d.description,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.byline",defaultMessage:"You’re about to take ownership of {currentWorkspaceName} and upgrade it to an Enterprise plan. You’ll become the Workspace owner and the existing owners will be downgraded to members.",values:{currentWorkspaceName:n?n.name:"the workspace below"}})}),(0,c.jsxs)("div",{style:d.workspaceContainer,children:[n?(0,c.jsx)(Ha,{id:n.id,name:n.name,icon:n.icon,subscriptionTier:n.subscriptionTier,memberCount:n.memberCount}):null,(0,c.jsx)("div",{style:d.checkContainer,children:(0,ar.k)(d.check)})]}),(0,c.jsx)(Bs.Z,{isLarge:!0,style:d.primaryButton,onClick:m,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.sendRequest",defaultMessage:"Send request"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:d.buttonCaption,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.buttonCaption",defaultMessage:"This request may take a few days to process. For more information, contact your <accountmanageremail>Account Management team</accountmanageremail>.",values:{accountmanageremail:e=>(0,c.jsx)(Rs.Z,{href:"mailto:am@makenotion.com",children:e})}})}),(0,c.jsx)(pn.Z,{style:d.secondaryButton,onClick:t,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.cancel",defaultMessage:"Cancel"})})]})})}function ur(e){let{onDismiss:t,spaceQueuedForClaiming:n}=e;const s=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:e.mediumIconColor,height:24,width:24},title:{fontWeight:y.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},description:{fontWeight:y.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:y.Z.fontWeight.medium,color:e.lightTextColor}})),[]),i=Boolean(n);return(0,c.jsx)(Hs.Z,{open:i,innerStyle:s.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:s.closeIconContainer,children:(0,c.jsx)(pn.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,ir.D)(s.closeIcon)})}),(0,c.jsx)("div",{children:_a(s.modalIcon)}),(0,c.jsxs)(Ce.Z,{style:s.title,children:[(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.title",defaultMessage:"Claim workspace"}),(0,c.jsx)(rr.Z,{href:(0,ze.UY)("guides.domainManagement"),children:(0,c.jsx)(ui.Z,{icon:di.m})})]}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:s.description,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.byline",defaultMessage:"You’re about to take ownership of {currentWorkspaceName} and upgrade it to an Enterprise plan. You’ll become the Workspace owner and the existing owners will be downgraded to members.",values:{currentWorkspaceName:n?n.name:"the workspace below"}})}),(0,c.jsxs)("div",{style:s.workspaceContainer,children:[n?(0,c.jsx)(Ha,{id:n.id,name:n.name,icon:n.icon,subscriptionTier:n.subscriptionTier,memberCount:n.memberCount}):null,(0,c.jsx)("div",{style:s.checkContainer,children:(0,ar.k)(s.check)})]}),(0,c.jsx)(Bs.Z,{isLarge:!0,style:s.primaryButton,onClick:()=>{n&&ct.Xb(n)},children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.reviewAndPay",defaultMessage:"Review and pay"})}),(0,c.jsx)(pn.Z,{style:s.secondaryButton,onClick:t,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.cancel",defaultMessage:"Cancel"})})]})})}var mr=n(997466),pr=n(260458);const gr=(0,f.defineMessages)({emailPlaceholder:{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.placeholder",defaultMessage:"it@example.com"}});function fr(e){let{onDismiss:t,spaceQueuedForDeletion:n,currentSpaceId:o}=e;const[a,l]=(0,s.useState)({email:void 0,didError:!1}),[d,u]=(0,s.useState)(!1),[m,p]=(0,s.useState)(!1),{setSpaceRequest:g}=(0,s.useContext)(ri),h=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500],height:24,width:24},title:{fontWeight:y.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:y.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},checkboxContainer:{display:"inline-flex",marginTop:8,alignItems:"center"},checkbox:{color:"dark"===e.mode?e.accentColors.gray[400]:e.accentColors.gray[200],marginRight:8},primaryButton:{width:"100%",marginTop:32,background:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500],justifyContent:"center",fontWeight:y.Z.fontWeight.medium,color:is.ZP.white},primaryButtonHovered:{background:"dark"===e.mode?(0,mr._j)(e.accentColors.red[700],.3):(0,mr._j)(e.accentColors.red[500],.3)},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:y.Z.fontWeight.medium,color:e.lightTextColor},checkboxCaption:{color:e.mediumTextColor,textAlign:"center",fontSize:12},dividerContainer:{marginTop:18},divider:{borderBottomColor:e.regularDividerColor}})),[]),x=(0,i.O7)(),S=(0,s.useCallback)((()=>{l({email:void 0,didError:!1}),u(!1),p(!1),t()}),[t]),v=(0,s.useCallback)((e=>{l({didError:!1,email:e.target.value})}),[]),b=(0,s.useCallback)((()=>u((e=>!e))),[]),j=(0,s.useCallback)((async()=>{const e=(0,sr.H3)(a.email);if(!(0,sr.oH)(e))return void l({...a,didError:!0});if(!n)return;p(!0);const t=await I.deleteSpaceForDomain(x,{requestingSpaceId:o,targetSpaceId:n.id,contactEmail:e});if("failed"===t.type)p(!1),M.showErrorMessage((0,L.wf)(V.default.getIntl(),t));else{const i=t.data.spaceDeletion;g(n.id,i),Qs.QF(x,{contactEmail:e,currentOwners:n.admins.map((e=>e.id)),targetSpaceId:n.id,verifiedDomain:n.creatorEmailDomain,targetSubscriptionTier:n.subscriptionTier}),S(),s=n.name,vi.oV({label:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.toast",defaultMessage:"Successfully deleted “{spaceName}“",values:{spaceName:s}})})}var s}),[S,a,o,x,g,n]),C=Boolean(n);return(0,c.jsx)(Hs.Z,{open:C,innerStyle:h.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:S,render:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:h.closeIconContainer,children:(0,c.jsx)(pn.Z,{isSmall:!0,onClick:S,ignoreLocalHoverState:!0,children:(0,ir.D)(h.closeIcon)})}),(0,c.jsx)("div",{children:(0,yi.y)(h.modalIcon)}),(0,c.jsxs)(Ce.Z,{style:h.title,children:[(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.title",defaultMessage:"Delete workspace"}),(0,c.jsx)(rr.Z,{href:(0,ze.UY)("guides.domainManagement"),children:(0,c.jsx)(ui.Z,{icon:di.m})})]}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:h.description,children:n?(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.byline",defaultMessage:"You’re about to permanently delete {currentWorkspaceName} and all of its contents. The workspace owner will be notified.",values:{currentWorkspaceName:n.name}}):void 0}),(0,c.jsxs)("div",{style:h.workspaceContainer,children:[n?(0,c.jsx)(Ha,{id:n.id,name:n.name,icon:n.icon,subscriptionTier:n.subscriptionTier,memberCount:n.memberCount}):void 0,(0,c.jsx)("div",{style:h.checkContainer,children:(0,ar.k)(h.check)})]}),(0,c.jsx)(As.Z,{size:0,style:h.dividerContainer,innerStyle:h.divider}),(0,c.jsx)(hr,{value:a.email,placeholder:V.default.formatMessage(gr.emailPlaceholder),onChange:v,labelMessage:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.title",defaultMessage:"Contact email"}),helpMessage:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.deleteWorkspaces.deletionModal.tooltipExplanation",defaultMessage:"The Workspace Owner of the deleted workspace can contact this email for inquiries"}),errorMessage:a.didError?(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.error",defaultMessage:"Invalid email address"}):void 0}),(0,c.jsx)(pn.Z,{disabled:!d||!a.email||m,disabledFeedback:!0,isLarge:!0,style:h.primaryButton,hoveredStyle:h.primaryButtonHovered,onClick:j,children:m?(0,c.jsx)(zi.Z,{}):(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.deleteButton",defaultMessage:"Delete workspace"})}),(0,c.jsxs)("div",{style:h.checkboxContainer,children:[(0,c.jsx)(pr.Z,{style:h.checkbox,size:14,checked:d,onClick:b}),(0,c.jsx)(Ce.Z,{isSmall:!0,style:h.checkboxCaption,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.checkboxLabel",defaultMessage:"I'm sure I want to delete this workspace"})})]}),(0,c.jsx)(pn.Z,{style:h.secondaryButton,onClick:S,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.cancel",defaultMessage:"Cancel"})})]})})}function hr(e){const t=(0,r.yK)((e=>({emailInputTitle:{fontWeight:y.Z.fontWeight.medium,fontSize:14,marginBottom:8,letterSpacing:-.15,display:"inline-flex",alignItems:"center"},emailContainer:{position:"relative",width:"100%",minHeight:56,marginTop:13},inputCaptionError:{color:e.errorText,marginTop:8,fontSize:13},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16}})),[]);return(0,c.jsxs)("div",{style:t.emailContainer,children:[(0,c.jsxs)(Ce.Z,{style:t.emailInputTitle,children:[e.labelMessage,e.helpMessage&&(0,c.jsx)(je.Z,{renderTooltip:()=>e.helpMessage,render:e=>(0,c.jsx)("span",{...e,children:(0,di.m)(t.helpIcon)})})]}),(0,c.jsx)(Cs.Z,{value:e.value,placeholder:e.placeholder,onChange:e.onChange}),e.errorMessage&&(0,c.jsx)(Ce.Z,{isSmall:!0,style:t.inputCaptionError,children:e.errorMessage})]})}function yr(e){let{onDismiss:t,onAccept:n,spaceQueued:s,descriptionMessage:i,divider:o,modalIcon:a,title:l,acceptMessage:d,isLoading:u}=e;const m=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{height:24,width:24,fill:e.mediumIconColor},title:{fontWeight:y.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:y.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32,justifyContent:"center",fontWeight:y.Z.fontWeight.medium},secondaryButton:{margin:"8px auto 0",width:"100%",justifyContent:"center",fontWeight:y.Z.fontWeight.medium,color:e.lightTextColor},dividerContainer:{marginTop:18},divider:{borderBottomColor:e.regularDividerColor}})),[]),p=Boolean(s);return(0,c.jsx)(Hs.Z,{open:p,innerStyle:m.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:m.closeIconContainer,children:(0,c.jsx)(pn.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,ir.D)(m.closeIcon)})}),a&&(0,c.jsx)("div",{children:a(m.modalIcon)}),(0,c.jsxs)(Ce.Z,{style:m.title,children:[l,(0,c.jsx)(rr.Z,{href:(0,ze.UY)("guides.domainManagement"),children:(0,c.jsx)(ui.Z,{icon:di.m})})]}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:m.description,children:i}),(0,c.jsxs)("div",{style:m.workspaceContainer,children:[s?(0,c.jsx)(Ha,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):void 0,(0,c.jsx)("div",{style:m.checkContainer,children:(0,ar.k)(m.check)})]}),o&&(0,c.jsx)(As.Z,{size:0,style:m.dividerContainer,innerStyle:m.divider}),(0,c.jsx)(Bs.Z,{isLarge:!0,style:m.primaryButton,onClick:n,disabled:u,children:u?(0,c.jsx)(zi.Z,{}):d}),(0,c.jsx)(pn.Z,{style:m.secondaryButton,onClick:t,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimableSpaceConfirmationModal.cancel",defaultMessage:"Cancel"})})]})})}function xr(e){let{onDismiss:t,spaceQueuedForRecovery:n,currentSpaceId:o}=e;const{setSpaceRequest:a}=(0,s.useContext)(ri),r=(0,i.O7)(),[l,d]=(0,s.useState)(!1),u=(0,s.useCallback)((()=>{d(!1),t()}),[t]),m=(0,s.useCallback)((async()=>{if(!o||!n)return;d(!0);const e=await I.cancelSpaceDeletionForDomain(r,{requestingSpaceId:o,targetSpaceId:n.id});if("failed"===e.type)return d(!1),void M.showErrorMessage((0,L.wf)(V.default.getIntl(),e));var t;a(n.id,void 0),Qs.Jv(r,{targetSpaceId:n.id,verifiedDomain:n.creatorEmailDomain}),u(),t=n.name,vi.oV({label:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.table.recoverSpace.toast",defaultMessage:"Successfully recovered “{spaceName}“",values:{spaceName:t}})})}),[a,o,r,n,u]);return(0,c.jsx)(yr,{onDismiss:u,onAccept:m,spaceQueued:n,modalIcon:hi.u,title:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.title",defaultMessage:"Recover workspace"}),descriptionMessage:n?(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.byline",defaultMessage:"Restore workspace content and the workspace owner's access.",values:{currentWorkspaceName:n.name}}):void 0,acceptMessage:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.deleteButton",defaultMessage:"Recover"}),isLoading:l,divider:!1})}let Sr=!1;function vr(e){let{spaceStore:t,subscriptionDataStore:n}=e;const{claimableSpaces:o,domainVerifications:l,loadingSpaces:d,errorClaimableSpaces:u,errorVerifications:m,navigateTo:p,removeClaimableSpace:h,loadMoreClaimableSpaces:x,tab:S,setSelectedTab:v,verifiedDomains:b}=(0,s.useContext)(ri),j=(0,i.O7)(),C=(0,a.VK)((()=>!Ra.Z.state.open&&Boolean(Ra.Z.state.succeeded)),[]),[w,k]=(0,s.useState)(),[I,T]=(0,s.useState)(),[Z,P]=(0,s.useState)(),[F,_]=(0,s.useState)(),A=(0,Ba.q)(Ht.subscriptionDataStoreInstance);function B(){k(void 0),T(void 0),P(void 0),_(void 0)}(0,s.useEffect)((()=>{C&&w&&(h(w.id),k(void 0),Ra.Z.reset())}),[C,w,h,k]);const R="verifying"===(0,Da.r)(n),D=(0,r.yK)((e=>({link:{fontSize:14,fontWeight:400,color:e.mediumTextColor,textDecoration:"none"},title:{marginTop:21,fontWeight:y.Z.fontWeight.semibold,fontSize:17},byline:{fontSize:14,fontWeight:y.Z.fontWeight.regular,color:e.mediumTextColor,marginRight:"auto",paddingRight:20},count:{marginLeft:4,opacity:.5,fontWeight:400},tabBarMenu:{margin:"12px 0 0",boxShadow:"none"}})),[]);if((0,s.useEffect)((()=>{u?M.deprecatedShowErrorMessage(u.message):m&&M.deprecatedShowErrorMessage(m.message)}),[u,m]),u)return null;if(m)return null;const O=o.filter((e=>Za(e.spaceRequest,e.memberCount))),L=o.filter((e=>!Za(e.spaceRequest,e.memberCount))),V=[{id:"external-transfer",getIcon:e=>(0,Fa.Z)({...e,height:14,width:14}),name:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransfer",defaultMessage:"Require account change"}),caption:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransferCaption",defaultMessage:"Owner will be prompted to change workspace ownership to a personal account."}),onAction:e=>T(e)},{id:"space-deletion",getIcon:e=>(0,yi.y)({...e,height:14,width:14}),name:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace",defaultMessage:"Delete workspace"}),caption:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpaceCaption",defaultMessage:"Owner will lose access to the workspace immediately."}),onAction:e=>P(e),getDisabledState:e=>{const{isEligible:t}=br(l,e.creatorEmailDomain);return!t||e.isDelinquent||e.isPendingBilling||!(0,g.QM)(e.subscriptionTier)},getTooltip:e=>{const t=br(l,e.creatorEmailDomain);return t.isEligible?!(0,g.QM)(e.subscriptionTier)||e.isDelinquent||e.isPendingBilling?(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace.ineligibleTooltip",defaultMessage:"The workspace is ineligible for deletion."}):void 0:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace.disabledTooltip",defaultMessage:"You're in the 14-day notification period after verifying a domain.{br} This feature will be enabled in {numDays, plural, one {{numDays} day} other {{numDays} days}}.",values:{numDays:t.daysUntilEligible,br:(0,c.jsx)("br",{})}})}},{id:"recover-space",getIcon:()=>{},name:(0,c.jsx)(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.actions.recoverSpace",defaultMessage:"Recover"}),caption:void 0,onAction:e=>_(e)}],E=[{id:"claim-and-upgrade",getIcon:e=>_a({...e,height:14,width:14}),name:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgrade",defaultMessage:"Claim and upgrade"}),caption:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgradeCaption",defaultMessage:"Take ownership of the workspace and upgrade it to an Enterprise plan"}),onAction:e=>k(e),getDisabledState:e=>{const{isEligible:t}=br(l,e.creatorEmailDomain);return R||!t||e.isDelinquent||e.isPendingBilling},getTooltip:e=>{const t=br(l,e.creatorEmailDomain);return e.isDelinquent||e.isPendingBilling?(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimSpace.ineligibleTooltip",defaultMessage:"The workspace is ineligible for claiming."}):t.isEligible?void 0:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.disabledTooltip",defaultMessage:"You're in the 14-day notification period after verifying a domain.{br} This feature will be enabled in {numDays, plural, one {{numDays} day} other {{numDays} days}}.",values:{numDays:t.daysUntilEligible,br:(0,c.jsx)("br",{})}})}}];return(0,c.jsxs)(kt.ZP,{children:[(0,c.jsx)(Rs.Z,{style:D.link,onClick:()=>p(oi.SettingsPage),children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.breadcrumb",defaultMessage:"← Identity & Provisioning"})}),(0,c.jsx)(fe.Z,{large:!0,style:D.title,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.title",defaultMessage:"Manage workspaces"})}),(0,c.jsxs)(Oa.X2,{children:[(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:D.byline,children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.byline",defaultMessage:"Claim verified-domain workspaces to your Enterprise plan or require Owners to use an external domain."})}),(0,c.jsx)(yt.Z,{isLarge:!0,onClick:()=>{Aa.g({environment:j,data:{spaceId:t.id,emailDomains:b}})},children:(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.exportClaimableWorkspaces.button",defaultMessage:"Export to CSV"})})]}),(0,c.jsx)(Os.Z,{tabs:[(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.singleSpaces",defaultMessage:"Single-member"},"single"),(0,c.jsx)(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.multiSpaces",defaultMessage:"Multi-member"},"multi")],selectedIndex:S,onChange:e=>v(e),style:D.tabBarMenu}),(0,c.jsx)(dr,{onDismiss:B,spaceQueuedForTransfer:I,currentSpaceId:t.id}),S===ai.Single?(0,c.jsx)(nr,{claimableSpaces:O,spaceActions:V,loadMoreClaimableSpaces:x,loading:d},"single"):(0,c.jsx)(nr,{claimableSpaces:L,spaceActions:E,loadMoreClaimableSpaces:x,loading:d},"multi"),A?(0,c.jsx)(cr,{onDismiss:B,spaceQueuedForClaiming:w,requestingSpaceId:t.id}):(0,c.jsx)(ur,{onDismiss:B,spaceQueuedForClaiming:w}),(0,c.jsx)(fr,{onDismiss:B,spaceQueuedForDeletion:Z,currentSpaceId:t.id}),(0,c.jsx)(xr,{onDismiss:B,spaceQueuedForRecovery:F,currentSpaceId:t.id})]})}function br(e,t){if(Sr)return{isEligible:!0};const n=e.find((e=>{let{domain:n}=e;return t===n}));if(!n||!n.verified_at)return{isEligible:!0};const s=(Date.now()-n.verified_at)/Xt.A0;return s>=14?{isEligible:!0}:{isEligible:!1,daysUntilEligible:Math.ceil(14-s)}}function Mr(e){let{userStore:t,spaceStore:n,samlConfigStore:i,domainSettingsStore:o,organizationInfo:a,isOrganizationOwner:r}=e;const{page:l}=(0,s.useContext)(ri);switch(l){case oi.SettingsPage:return(0,c.jsx)(Ta,{userStore:t,spaceStore:n,samlConfigStore:i,domainSettingsStore:o,organizationInfo:a,isOrganizationOwner:r});case oi.WorkspacesPage:return(0,c.jsx)(vr,{spaceStore:n,subscriptionDataStore:Ht.subscriptionDataStoreInstance});case oi.ManagedUsersPage:return(0,c.jsx)(Ui,{spaceStore:n,samlConfigStore:i})}}["local","development","staging"].includes("production")&&(0,Pa.exposeDebugValue)("bypassDomainVerificationWaitingPeriod",(function(){Sr=!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}));const jr=function(e){let{userStore:t,spaceStore:n,samlConfigStore:s,domainSettingsStore:i,organizationInfo:o,isOrganizationOwner:a}=e;return(0,c.jsx)(li,{spaceStore:n,samlConfigStore:s,domainSettingsStore:i,children:(0,c.jsx)(Mr,{userStore:t,spaceStore:n,samlConfigStore:s,domainSettingsStore:i,organizationInfo:o,isOrganizationOwner:a})})};var Cr=n(815145),wr=n(984619),kr=n(240745),Ir=n(275754),Tr=n(292283),Zr=n(922756),Pr=n(753833),Fr=n(490365),_r=n(841892),Ar=n(401800),Br=n(793282),Rr=n(750063),Dr=n(421202),Or=n(141311),Lr=n(30397),Vr=n(733907),Er=n(91315),Nr=n(500091),Ur=n(274016),Kr=n(629551),Wr=n(940235);const zr=function(){const e=(0,a.VK)((()=>Zr.Z.state),[]);return e.result?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ce.Z,{isMultiline:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.confirm.subtitle",defaultMessage:"The following data has been successfully imported."})}),(0,c.jsx)("div",{style:{marginTop:32},children:e.result.map((e=>(0,c.jsx)(qr,{importStatus:e},e.asanaTeamId)))})]}):(0,c.jsx)(c.Fragment,{})};function qr(e){let{importStatus:t}=e;const n=(0,r.Fg)(),[i,o]=(0,s.useState)(!1),d=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),u=(0,a.VK)((()=>Zr.Z.state.teamsAndProjects),[]),m=(0,a.VK)((()=>Ge.default.state.currentSpaceViewStore),[]),p=(0,a.VK)((()=>{if(!m)return;const e=m.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,c.jsx)(Ur.p,{disabled:!0,store:e})})));return d?(e||[]).concat({id:m.id,name:"Private",icon:(0,c.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:is.FN.light.gray[75]},children:(0,l.Q)({color:n.mediumIconColor,width:12.5,height:12.5})})}):e}),[m,d,n]),{notionTeamspaceName:g,notionTeamspaceIcon:h}=(0,s.useMemo)((()=>{const e=null==p?void 0:p.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[p,t]),y=(0,s.useMemo)((()=>{const e=u.find((e=>e.gid===t.asanaTeamId));return null==e?void 0:e.name}),[u,t]);return(0,c.jsxs)(Kr.gq,{style:{marginTop:16},children:[(0,c.jsx)(ui.Z,{ariaLabel:"collapse toggle",icon:Nr.L,onClick:()=>o((e=>!e)),style:{transform:i?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:4},iconStyle:{width:8,height:8}}),(0,c.jsx)(Wr.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,c.jsx)(Kr.gq,{alignItems:"center",gap:2,children:(0,c.jsx)(Ce.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis"},children:y})}),style:{width:300}},{key:"importedInto",header:(0,c.jsxs)(Kr.gq,{gap:4,children:[(0,c.jsxs)(Kr.gq,{style:{alignItems:"center",gap:4},children:[(0,c.jsx)(Ce.Z,{isSmall:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.importedInto",defaultMessage:"Imported into"})}),(0,Vr.n)({width:12})]}),(0,c.jsxs)(Kr.gq,{style:{alignItems:"center",gap:4},children:[h,g]})]}),style:{width:300}}],rows:function(e){let{collapsed:n}=e;return n?[]:t.numberOfTasksPerProject.map((e=>({key:e.projectId,columns:[(0,c.jsxs)(Kr.gq,{gap:8,alignItems:"center",children:[(0,Er.r)({width:12,color:is.FN.dark.green[600]}),(0,c.jsx)(Ce.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300},children:e.name})]},e.projectId),(0,c.jsxs)(Ce.Z,{isSmall:!0,children:[e.numberOfTasks,(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]})))}({collapsed:i})})]})}var Gr=n(286793),Hr=n(492607);const $r=function(){const e=(0,a.VK)((()=>Zr.Z.state),[]);if(!e.result)return(0,c.jsx)(c.Fragment,{});const t=e.result;let n=0;return t.forEach((e=>{n+=e.numberOfProjects})),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:2},children:[(0,c.jsx)(Ce.Z,{isMultiline:!0,style:{font:"SF Pro",fontWeight:y.Z.fontWeight.semibold,fontSize:y.Z.fontSize.UIRegular.mobile,paddingTop:8},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.importComplete.subtitle",defaultMessage:"Imported {projectCount} projects into Notion",values:{projectCount:n}})}),(0,c.jsx)("div",{style:{marginTop:20},children:e.result.map((e=>(0,c.jsx)(Yr,{importStatus:e},e.asanaTeamId)))})]})};function Yr(e){let{importStatus:t}=e;const n=(0,r.Fg)(),i=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),o=(0,a.VK)((()=>Zr.Z.state.teamsAndProjects),[]),d=(0,a.VK)((()=>Ge.default.state.currentSpaceViewStore),[]),u=(0,a.VK)((()=>{if(!d)return;const e=d.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,c.jsx)(Ur.p,{disabled:!0,store:e})})));return i?(e||[]).concat({id:d.id,name:"Private",icon:(0,c.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:is.FN.light.gray[75]},children:(0,l.Q)({color:n.mediumIconColor,width:12.5,height:12.5})})}):e}),[d,i,n]),{notionTeamspaceName:m,notionTeamspaceIcon:p}=(0,s.useMemo)((()=>{const e=null==u?void 0:u.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[u,t]),g=(0,s.useMemo)((()=>{const e=o.find((e=>e.gid===t.asanaTeamId));return null==e?void 0:e.name}),[o,t]);return(0,c.jsx)(Kr.gq,{style:{marginTop:16},children:(0,c.jsx)(Wr.Z,{tableStyle:{borderTop:0,gap:10},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,c.jsx)(Kr.gq,{children:(0,c.jsx)(Kr.gq,{alignItems:"center",gap:2,children:(0,c.jsx)(Ce.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis",font:"SF Pro",fontWeight:y.Z.fontWeight.regular,fontSize:y.Z.fontSize.UIRegular.desktop},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.importComplete.importFrom",defaultMessage:"From {asanaTeamName} in Asana",values:{asanaTeamName:g}})})})}),style:{width:300}},{key:"seperator",header:(0,c.jsx)(Kr.gq,{style:{alignItems:"center",gap:4},children:(0,c.jsx)(Ce.Z,{isMultiline:!0,style:{fontWeight:y.Z.fontWeight.regular,font:"SF Pro",fontSize:y.Z.fontSize.UIRegular.desktop,color:"rgba(172, 171, 169, 1)"},children:"→"})}),style:{width:13,height:18,paddingRight:20}},{key:"importedInto",header:(0,c.jsxs)(Kr.gq,{style:{alignItems:"center",gap:4},children:[p,(0,c.jsx)(Ce.Z,{style:{font:"SF Pro",fontWeight:y.Z.fontWeight.medium,fontSize:y.Z.fontSize.UIRegular.desktop},children:m}),(0,c.jsx)(Ce.Z,{style:{fontWeight:y.Z.fontWeight.regular,fontSize:y.Z.fontSize.UIRegular.desktop,font:"SF Pro Text",color:"rgba(172, 171, 169, 1)"},children:"/"}),(0,c.jsx)(c.Fragment,{children:(0,Gr.D)({width:"16px",height:"16px",color:n.mediumIconColor})}),(0,c.jsx)(Ce.Z,{style:{font:"SF Pro",fontWeight:y.Z.fontWeight.medium,fontSize:y.Z.fontSize.UIRegular.desktop},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.importComplete.projectLabel",defaultMessage:"Projects"})})]}),style:{width:300}}],rows:t.numberOfTasksPerProject.map((e=>({key:e.projectId,columns:[(0,c.jsxs)(Kr.gq,{gap:8,alignItems:"start",flexDirection:"column",children:[(0,c.jsx)(Ce.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300,fontWeight:y.Z.fontWeight.medium,font:"SF Pro",fontSize:y.Z.fontSize.UIRegular.desktop},children:e.name}),(0,c.jsxs)(Ce.Z,{isSmall:!0,children:[e.numberOfTasks,(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.importConfir,.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]},e.projectId),(0,c.jsx)(Kr.gq,{},`${e.projectId}-seperator`),(0,c.jsx)(Kr.gq,{children:(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",gap:4,paddingBottom:6},children:[(0,Gr.D)({width:20,height:20,color:n.mediumIconColor}),(0,c.jsx)(Rs.Z,{href:e.notionProjectId?(0,Ar.Z)({pageId:e.notionProjectId,pageModel:(0,Br.lA)({table:Dr.iU,id:e.notionProjectId}),baseUrl:ds.default.domainBaseUrl,pageVisitSource:Cr.tY.Import}):void 0,style:{wordWrap:"break-word",fontWeight:y.Z.fontWeight.medium,font:"SF Pro",fontSize:y.Z.fontSize.UIRegular.desktop,textDecorationLine:"underline",textDecorationColor:"rgba(227, 226, 224, 1)"},disableHover:!0,children:e.name})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,Hr.v)({width:14,height:14,color:n.mediumIconColor}),(0,c.jsxs)(Rs.Z,{href:e.notionProjectId?(0,Ar.Z)({pageId:e.notionProjectId,pageModel:(0,Br.lA)({table:Dr.iU,id:e.notionProjectId}),baseUrl:ds.default.domainBaseUrl,pageVisitSource:Cr.tY.Import}):void 0,style:{color:"rgba(120, 119, 116, 1)",font:"SF Pro",fontSize:y.Z.fontSize.UISmall.desktop,fontWeight:y.Z.fontWeight.regular},disableUnderline:!0,disableHover:!0,children:[e.numberOfTasks,(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.importConfir,.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]})]})},`${e.projectId}-notionProjects`)]})))})})}var Qr=n(536591),Jr=n(542853),Xr=n(375071),el=n(109867),tl=n(293963);const nl=function(){const e=(0,i.O7)(),t=(0,f.useIntl)(),n=(0,a.VK)((()=>Zr.Z.getState()),[]),{isLoadingProjects:o,workspaces:r,selectedWorkspace:l,teamsAndProjects:d}=n;return(0,s.useEffect)((()=>{l&&Or.y2({selectedWorkspace:l,environment:e}).catch((()=>{}))}),[l,e]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ce.Z,{isSmall:!0,style:{paddingTop:4,paddingBottom:4},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.workspaceChoiceHelperText",defaultMessage:"Only one workspace can be imported at a time."})}),(0,c.jsx)(il,{onSelectOption:e=>{Zr.Z.setState({...n,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:r.map((e=>({key:e.gid,label:e.name}))),currentOption:l,placeHolder:t.formatMessage({id:"asanaImporter.selectData.selectWorkspacePlaceholder",defaultMessage:"Select a workspace"})}),l?(0,c.jsx)(Ce.Z,{style:{fontWeight:y.Z.fontWeight.semibold,marginTop:18},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.selectProjects",defaultMessage:"Select projects"})}):(0,c.jsx)(c.Fragment,{}),o?(0,c.jsxs)(Kr.gq,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,c.jsx)(zi.Z,{style:{fontSize:12}}),(0,c.jsx)(Ce.Z,{isSmall:!0,style:{color:is.FN.light.gray[400]},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):d.filter((e=>0!==e.projects.length)).map((e=>(0,c.jsx)(sl,{team:e,selectedWorkspace:l},`${e.gid}-table`)))]})};function sl(e){var t;let{team:n,selectedWorkspace:o}=e;const d=(0,i.O7)(),u=(0,f.useIntl)(),m=(0,r.Fg)(),[p,g]=(0,s.useState)(!1),[h,x]=(0,s.useState)(!1),[S,v]=(0,s.useState)(),b=(0,a.VK)((()=>Zr.Z.getState()),[]),{importCompletedTasks:M,loadMoreClicks:j,selectedProjectsAndTeamspaces:C}=b,w=(0,a.VK)((()=>Ge.default.state.currentSpaceViewStore),[]),k=(0,a.VK)((()=>{const e=null==w?void 0:w.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,c.jsx)(Ur.p,{disabled:!0,store:e})})))}),[w]);(0,s.useEffect)((()=>{if(!k||!w)return;if(!C[n.gid]){v("private"),Or.B3({teamId:n.gid,spaceId:null==w?void 0:w.id});for(const s of k){var e,t;if((null===(e=s.name)||void 0===e?void 0:e.toLowerCase())===(null===(t=n.name)||void 0===t?void 0:t.toLowerCase())){v(s.id),Or.B3({teamId:n.gid,spaceId:s.id});break}}}}),[k,n,w,C]);const T=(0,s.useCallback)((e=>{Or.B3({teamId:n.gid,spaceId:e}),v(e)}),[n.gid]),Z=(0,s.useCallback)((e=>{if("create"===e)return void el.lo("asana_importer",{onClose:T});let t;if("private"===e){if(null==w||!w.id)return;t=w.id}else t=e;Or.B3({teamId:n.gid,spaceId:t}),v(e)}),[null==w?void 0:w.id,n.gid,T]),P=[{key:"private",searchTerm:"private",label:(0,c.jsxs)(Kr.gq,{alignItems:"center",style:{gap:8},children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:is.FN.light.gray[75]},children:(0,l.Q)({color:m.mediumIconColor,width:12.5,height:12.5})}),(0,c.jsx)(Ce.Z,{style:{fontWeight:y.Z.fontWeight.regular},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.privateSpaceTitle",defaultMessage:"Private"})})]})}];return k&&P.push(...k.map((e=>({key:e.id,searchTerm:e.name,label:(0,c.jsxs)(Kr.gq,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]})})))),P.push({key:"create",searchTerm:"New teamspace",label:(0,c.jsxs)(Kr.gq,{alignItems:"center",style:{gap:4},children:[(0,Xr.f)({color:m.mediumIconColor,width:16,height:16}),(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.newTeamspace",defaultMessage:"New teamspace"})})]})}),(0,c.jsxs)(Kr.gq,{style:{marginLeft:-18},children:[(0,c.jsx)(ui.Z,{ariaLabel:"collapse toggle",icon:Nr.L,onClick:()=>g((e=>!e)),style:{transform:p?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}}),(0,c.jsx)(Wr.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,c.jsxs)(Kr.gq,{alignItems:"center",gap:2,children:[(0,c.jsx)(ol,{onSelectOption:e=>{var t;Zr.Z.setState({...b,selectedProjectsAndTeamspaces:{...C,[n.gid]:{notionTeamspaceId:null===(t=C[n.gid])||void 0===t?void 0:t.notionTeamspaceId,projects:e}}})},options:[{key:"in_complete",label:"Exclude completed projects"},{key:"all",label:"Select all projects"}],currentOption:(e=>{const t=null===(e=C[n.gid])||void 0===e?void 0:e.projects;return"string"==typeof t?t:null!=t&&t.length?"specific":void 0})()}),(0,c.jsx)(Ce.Z,{style:{width:280,textOverflow:"ellipsis"},children:n.name})]}),style:{width:300}},{key:"importInto",header:(0,c.jsxs)(Kr.gq,{style:{alignItems:"center"},children:[(0,c.jsx)("div",{children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.importInto",defaultMessage:"Import into"})}),(0,c.jsx)("div",{style:{marginRight:16,marginLeft:8},children:(0,Vr.n)({width:12})}),(0,c.jsxs)(Kr.gq,{style:{alignItems:"center",gap:8},children:[(0,c.jsx)("img",{src:_r.Z.emails.notionLogoBlackSmallPng,height:18}),(0,c.jsx)(il,{options:P,onSelectOption:Z,currentOption:null===(t=P.find((e=>e.key===S)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:u.formatMessage({id:"asanaImport.importsTab.selectData.selectATeamspace",defaultMessage:"Select a teamspace"})})]})]}),style:{width:"50%"}}],rows:function(e){let{collapsed:t}=e;if(t)return[];const s=n.projects.map((e=>({key:e.gid,columns:[(0,c.jsxs)(Kr.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,c.jsx)(pr.Z,{style:{marginRight:2},onClick:()=>{const t={...C[n.gid]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:s,projects:i}=t;let o;o="all"===i||"in_complete"===i?[]:i.includes(e.gid)?i.filter((t=>t!==e.gid)):i.concat(e.gid),Zr.Z.setState({...b,selectedProjectsAndTeamspaces:{...C,[n.gid]:{notionTeamspaceId:s,projects:o}}})},checked:(()=>{const t={...C[n.gid]||{projects:[],notionTeamspaceId:void 0}};return"all"===t.projects||"in_complete"===t.projects&&!1===e.completed||t.projects.includes(e.gid)})(),size:14,checkSize:8}),(0,c.jsx)(tl.z,{color:e.color,size:6}),(0,c.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:e.completed?(0,c.jsxs)(Ce.Z,{isMultiline:!0,style:{color:m.lightTextColor},children:[e.name,(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.completedHelperText",defaultMessage:" (Completed)"})]}):(0,c.jsx)(Ce.Z,{isMultiline:!0,children:e.name})})]},`${e.gid}-container`),(0,c.jsxs)(Ce.Z,{isSmall:!0,children:[M?e.task_counts.num_tasks:e.task_counts.num_incomplete_tasks,(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks"})]},`${n.gid}-tasks-count`)]})));return n.nextPage&&s.push({key:"loadMore",columns:[(0,c.jsx)(_s.Z,{disabled:h,style:{marginLeft:20,color:is.FN.light.gray[400]},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},onClick:async()=>{if(!o)return;x(!0);const e=await I.getTeamsAndProjectsInAsanaWorkspace(d,{workspaceId:o,teamId:n.gid,size:5,nextPage:n.nextPage}),{teamsAndProjects:t}={...b},s=t.find((e=>e.gid===n.gid));if(s){if("success"===e.type){const i=e.data.find((e=>e.gid===n.gid));if(!i)return;s.projects.push(...i.projects),s.nextPage=i.nextPage,Zr.Z.setState({...b,teamsAndProjects:t,loadMoreClicks:j+1})}x(!1)}},children:h?(0,c.jsxs)(Kr.gq,{alignItems:"center",gap:8,children:[(0,c.jsx)(zi.Z,{style:{fontSize:12}}),(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadingMoreProjects",defaultMessage:"Loading more projects..."})]}):(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadMoreProjects",defaultMessage:"Load more projects..."})},`${n.gid}-loadmore`)]}),s}({collapsed:p})})]})}function il(e){var t;const{onSelectOption:n,options:i,currentOption:o,placeHolder:a,narrow:l,allowSearch:d}=e,u=(0,f.useIntl)(),[m,p]=(0,s.useState)(""),g=null===(t=i.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,h=(0,r.yK)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,placementToOrigin:na.pO.Bottom,renderOrigin:e=>(0,c.jsxs)(pn.Z,{...e,style:{paddingTop:l?2:8,paddingBottom:l?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:250,border:`1px solid ${is.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,background:o?void 0:is.FN.light.gray[50],color:o?void 0:is.FN.light.gray[300]},disabled:!1,children:[(0,c.jsx)(Ce.Z,{style:{textOverflow:"ellipsis"},children:g||a}),(0,Jr.i)(h.icon)]}),render:e=>{const t={menuType:cs.og.Popup,width:250,left:50},s=[{key:"asanaImport.dropdown.menuList",render:e=>(0,c.jsx)(ys.Z,{...e}),items:(m.trim()?i.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(m.toLowerCase())})):i).map((t=>{let{key:s,label:i}=t;return{key:s,action:()=>{n(s),e.close()},render:e=>(0,c.jsx)(ms.Z,{...e,title:i,shouldWrapCaption:!0,right:g===i?(0,c.jsx)("div",{style:{width:14},children:(0,Qr.e)()}):void 0})}}))}];return(0,c.jsxs)(c.Fragment,{children:[d?(0,c.jsx)("input",{style:{width:"100%",borderRadius:0,backgroundColor:is.FN.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${is.FN.light.gray[100]}`,justifyContent:"space-between",background:is.FN.light.gray[50],fontSize:y.Z.fontSize.UIRegular.desktop,textOverflow:"ellipses"},placeholder:u.formatMessage({id:"asanaImport.importsTab.selectData.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"}),onChange:e=>p(e.target.value),value:m}):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)(ps.Z,{...t,children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,sections:s,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})]})}})}function ol(e){var t;const{onSelectOption:n,options:i,currentOption:o}=e,a=null===(t=i.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,r=(0,s.useMemo)((()=>void 0!==o&&"specific"!==o&&("all"===o||"partial")),[o]);return(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,placementToOrigin:na.pO.Bottom,alignmentToOrigin:na.vR.Start,renderOrigin:e=>(0,c.jsx)(pn.Z,{...e,style:{padding:0,margin:0,marginRight:4,height:14},hoveredStyle:{},children:(0,c.jsx)(pr.Z,{checked:r,disabled:!0,size:14,checkSize:8})}),render:e=>{const t={menuType:cs.og.Popup,width:250,left:50},s=[{key:"asanaImport.checkboxDropdown.menuList",render:e=>(0,c.jsx)(ys.Z,{...e}),items:i.map((t=>{let{key:s,label:i}=t;return{key:s,action:()=>{n(s),e.close()},render:e=>(0,c.jsx)(ms.Z,{...e,title:i,shouldWrapCaption:!0,right:a===i?(0,c.jsx)("div",{style:{width:14},children:(0,Qr.e)()}):void 0})}}))}];return(0,c.jsx)(ps.Z,{...t,children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,sections:s,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}var al=n(824006),rl=n(443261),ll=n.n(rl),dl=n(449953),cl=n(23124),ul=n(268894),ml=n(605210);const pl=(0,f.defineMessages)({selectWorkspace:{id:"asanaImporter.chooseWorkspace.chooseWorkspacePlaceholder",defaultMessage:"Choose a workspace"},selectProjectHeading:{id:"asanaImport.importsTab.chooseWorkspace.selectProjects",defaultMessage:"Choose projects to import"},mapTeamspacesDescription:{id:"asanaImport.importsTab.chooseWorkspace.tabDescription",defaultMessage:"You can give each Asana team a Notion teamspace to collaborate in. Each teamspace has a Projects database, where your imported projects will live."},loadingProjectsPlaceholder:{id:"asanaImport.importsTab.chooseWorkspace.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."},chooseTeamspaceOption:{id:"asanaImport.importsTab.chooseWorkspace.selectTeamspace",defaultMessage:"Choose a teamspace"},filterTeams:{id:"asanaImport.importsTab.chooseWorkspace.filterTeams",defaultMessage:"Filter teamspaces..."},filterWorkspaces:{id:"asanaImport.importsTab.chooseWorkspace.searchAsanaWorkspaces",defaultMessage:"Filter workspaces..."},newTeamspaceLabel:{id:"asanaImport.importsTab.chooseWorkspace.newTeamspace",defaultMessage:"New teamspace"},privateSpaceLabel:{id:"asanaImport.importsTab.chooseWorkspace.privateSpaceTitle",defaultMessage:"Private"},completedProjectLabel:{id:"asanaImport.importsTab.chooseWorkspace.completedHelperText",defaultMessage:" (Completed)"}});function gl(e){let{asanaTeam:t}=e;const n=xl(),i=(0,f.useIntl)(),o=(0,a.VK)((()=>Zr.Z.getState()),[]),r=(0,a.VK)((()=>{var e;const t=null===(e=Ge.default.state.currentSpaceViewStore)||void 0===e||null===(e=e.getTeamsStores())||void 0===e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,c.jsx)(Ur.p,{disabled:!0,store:e})}))),s=[{key:"private",searchTerm:["private"],icon:(0,l.Q)(n.lockedIcon),name:i.formatMessage(pl.privateSpaceLabel)}];return t&&s.push(...t.map((e=>{var t;return{key:e.id,searchTerm:(null===(t=e.name)||void 0===t?void 0:t.split(" "))||void 0,icon:e.icon,name:e.name}}))),s.push({key:"create",searchTerm:["New"],icon:(0,Xr.f)(n.plusIcon),name:i.formatMessage(pl.newTeamspaceLabel)}),s}),[i,n.lockedIcon,n.plusIcon]),{importCompletedTasks:d,selectedProjectsAndTeamspaces:u}=o,m=(0,s.useMemo)((()=>u[t.gid]||{projects:[],notionTeamspaceId:void 0}),[u,t.gid]),[p,g]=(0,s.useState)("private"),h=(0,a.VK)((()=>Ge.default.state.currentSpaceViewStore),[]),y=(0,s.useCallback)((e=>{if("create"===e)return void el.lo("asana_importer",{onClose:e=>{Or.B3({teamId:t.gid,spaceId:e}),g(e)}});let n;if("private"===e){if(null==h||!h.id)return;n=h.id}else n=e;Or.B3({teamId:t.gid,spaceId:n}),g(e)}),[null==h?void 0:h.id,t.gid]);(0,s.useEffect)((()=>{var e;const n=null===(e=function(e,t){if(!t)return;const n=ll().filter(t,e.map((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.join(" ")})));return n&&n.length?e[n[0].index]:void 0}(r,t.name))||void 0===e?void 0:e.key;y(n||r[1].key)}),[t.name,r,y]);const x=(0,s.useCallback)((e=>{const n={...u[t.gid]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:s,projects:i}=n;let a=i;"all"===a&&(a=t.projects.map((e=>e.gid))),"in_complete"===a&&(a=t.projects.filter((e=>!e.completed)).map((e=>e.gid))),a=a.includes(e.gid)?a.filter((t=>t!==e.gid)):a.concat(e.gid),Zr.Z.setState({...o,selectedProjectsAndTeamspaces:{...u,[t.gid]:{notionTeamspaceId:s,projects:a}}})}),[t.gid,t.projects,o,u]),S=(0,s.useMemo)((()=>{const{projects:e}=m;return"all"===e||("in_complete"===e?"partial":0!==e.length&&(e.length===t.projects.length||"partial"))}),[m,t.projects]),v=(0,s.useCallback)((()=>{var e;let n="in_complete";n="all"===m.projects?[]:"in_complete"===m.projects?"all":0===m.projects.length?t.projects.every((e=>e.completed))||t.projects.every((e=>!e.completed))?"all":"in_complete":m.projects.length===t.projects.length?[]:"all",Zr.Z.setState({...o,selectedProjectsAndTeamspaces:{...u,[t.gid]:{notionTeamspaceId:null===(e=u[t.gid])||void 0===e?void 0:e.notionTeamspaceId,projects:n}}})}),[m.projects,t.projects,t.gid,o,u]),b=(0,s.useMemo)((()=>{const e=o.importCompletedTasks;let n=t.projects;return"in_complete"===m.projects?n=n.filter((e=>!e.completed)):"all"!==m.projects&&m.projects.length!==n.length&&(n=n.filter((e=>m.projects.includes(e.gid)))),{projects:n.length,tasks:n.reduce(((t,n)=>t+(e?n.task_counts.num_tasks:n.task_counts.num_incomplete_tasks)),0)}}),[m.projects,t.projects,o.importCompletedTasks]),[M,j]=(0,s.useState)(!1);return(0,c.jsx)("div",{style:n.asanaTeamSectionContainer,children:(0,c.jsxs)(cl.rj,{gap:8,children:[(0,c.jsx)(cl.r8,{row:1,col:1,children:(0,c.jsx)(fl,{team:t,importCompletedTasks:d,collapsed:M,onToggle:()=>j((e=>!e)),checked:e=>"all"===m.projects||"in_complete"===m.projects&&!1===e.completed||m.projects.includes(e.gid),onSelectProject:x,onSelectGroup:v,groupCheckState:S})}),(0,c.jsx)(cl.r8,{row:1,col:2,children:(0,c.jsx)(hl,{onSelectOption:y,options:r,currentOption:p,style:M?"compact":"full",children:(0,c.jsx)(Ce.Z,{style:{fontSize:"14px",paddingLeft:M?"8px":0},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.totalProjectsAndTasks",defaultMessage:"Import {nProjects} projects, {nTasks} tasks to",values:{nProjects:b.projects,nTasks:b.tasks}})})})})]})})}function fl(e){let{team:t,collapsed:n,onToggle:s,importCompletedTasks:i,onSelectProject:o,onSelectGroup:a,groupCheckState:r,checked:l}=e;const d=xl(),u=(0,f.useIntl)();return(0,c.jsxs)("div",{style:d.teamAndProjectsCollapse,children:[(0,c.jsxs)(pn.Z,{onClick:s,style:{width:"100%",gap:6},icon:e=>(0,c.jsx)(ml.Z,{style:e,isSidebar:!1,open:!n,fill:!1,onClick:s,icon:"chevron"}),children:[(0,c.jsx)(pr.Z,{onClick:a,checked:r,size:14,checkSize:8}),(0,c.jsx)("div",{style:{lineHeight:"20px",fontSize:"14px"},children:t.name})]}),!n&&t.projects.map((e=>(0,c.jsxs)(Kr.gq,{style:d.asanaProjectRow,alignItems:"center",gap:6,children:[(0,c.jsx)(pr.Z,{style:{marginRight:1},onClick:()=>o(e),checked:l(e),size:14,checkSize:8}),(0,c.jsx)(tl.z,{color:e.color,size:14,style:{borderRadius:"15%"}}),(0,c.jsxs)(Ce.Z,{style:{...e.completed?d.projectNameCompleted:{},maxWidth:220},children:[e.name,e.completed&&u.formatMessage(pl.completedProjectLabel)]}),(0,c.jsxs)(Ce.Z,{isSmall:!0,style:{color:is.FN.light.gray[400]},children:[i?e.task_counts.num_tasks:e.task_counts.num_incomplete_tasks,(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.tasksHelperText",defaultMessage:" tasks"})]})]},e.gid)))]})}function hl(e){let{onSelectOption:t,options:n,currentOption:s,children:i,style:o}=e;const a=(0,f.useIntl)(),r=xl();return(0,c.jsxs)(Kr.gq,{flexDirection:"compact"===o?"row":"column",alignItems:"center",justifyContent:"center",style:r.teamSpaceContainer,children:[i,(0,c.jsx)(yl,{onSelectOption:t,options:n,iconOnly:"compact"===o,currentOption:s,placeHolder:a.formatMessage(pl.chooseTeamspaceOption),searchThreshold:5,iconStyles:r.menuChevonDownIcon,menuProps:{maxWidth:300,maxHeight:400,left:50}})]})}function yl(e){const{onSelectOption:t,options:n,currentOption:i,placeHolder:o,buttonStyles:a,initialFocus:r,menuProps:l,iconOnly:d,iconStyles:u,searchThreshold:m}=e,p=(0,f.useIntl)(),[g,h]=(0,s.useState)(""),y=n.find((e=>{let{key:t}=e;return t===i}));function x(e){return(0,c.jsxs)(Kr.gq,{alignItems:"center",style:{gap:4},children:[e.icon,(0,c.jsx)(Ce.Z,{children:e.name})]})}return(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,placementToOrigin:na.pO.Bottom,renderOrigin:e=>(0,c.jsxs)(pn.Z,{disabled:1===n.length,...e,style:{color:i?void 0:is.FN.light.gray[300],...a},children:[(0,c.jsx)(Ce.Z,{style:{textOverflow:"ellipsis",fontSize:"14px",font:"SF Pro Text",color:i?void 0:"#ACABA9",lineHeight:"19.6px"},children:(d?null==y?void 0:y.icon:y&&x(y))??o}),(0,Jr.i)(u)]}),render:e=>{const s=(0,c.jsx)(ul.ZP,{style:{width:"100%",paddingTop:8,paddingBottom:2},placeholder:p.formatMessage(pl.filterWorkspaces),onChange:e=>h(e.target.value),value:g}),o={menuType:cs.og.Popup,width:376,left:50,header:(0,Zn.$K)(m)&&n.length>m?s:void 0,...l},a=n.map((n=>{let{key:s,name:o,icon:a,searchTerm:r}=n;return{key:s,keywords:r??[],action:()=>{t(s),e.close()},render:e=>(0,c.jsx)(ms.Z,{...e,title:x({name:o,icon:a}),shouldWrapCaption:!0,right:i===s?(0,c.jsx)("div",{style:{width:14},children:(0,Qr.e)()}):void 0})}}));return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(ps.Z,{...o,children:(0,c.jsx)(dl.f,{type:fs.i.Vertical,filterQuery:g,sections:[{key:"asanaImport.dropdown.menuList",render:e=>(0,c.jsx)(ys.Z,{...e}),items:a}],initialFocus:r,style:{position:"relative",alignItems:"flex-end"}})})})}})}function xl(){return(0,r.yK)((e=>({workspaceSelectorButton:{paddingTop:8,paddingBottom:8,paddingLeft:8,paddingRight:8,opacity:1,width:376,border:`1px solid ${is.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8},projectNameCompleted:{color:e.lightTextColor},menuChevonDownIcon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor},plusIcon:{color:e.mediumIconColor,width:16,height:16},lockedIcon:{color:e.mediumIconColor,width:12.5,height:12.5},asanaTeamSectionContainer:{marginBottom:20},asanaProjectRow:{marginTop:8,marginLeft:40},teamAndProjectsCollapse:{paddingTop:4,paddingBottom:4},teamSpaceContainer:{height:"100%",border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,padding:2,gap:8},teamSpaceLabel:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:is.FN.light.gray[75]}})),[])}const Sl=function(){const e=(0,i.O7)(),t=(0,f.useIntl)(),n=xl(),o=(0,a.VK)((()=>Zr.Z.getState()),[]),{isLoadingProjects:r,selectedWorkspace:l,teamsAndProjects:d,workspaces:u}=o,m=(0,s.useMemo)((()=>d.map((e=>({...e,projects:e.projects.sort((e=>e.completed?1:-1))})))),[d]);return(0,s.useEffect)((()=>{l&&Or.y2({selectedWorkspace:l,environment:e}).catch((()=>{}))}),[l,e]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("img",{src:_r.Z.images.import.asanaPng,width:16,height:16}),(0,c.jsx)(yl,{searchThreshold:5,onSelectOption:e=>{Zr.Z.setState({...o,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:u.map((e=>({key:e.gid,name:e.name,searchTerm:e.name.split(" ")}))),currentOption:l,placeHolder:t.formatMessage(pl.selectWorkspace),buttonStyles:n.workspaceSelectorButton,iconStyles:n.menuChevonDownIcon})]}),l?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ce.Z,{style:{font:"SF Pro",fontWeight:"590",fontSize:"17px",marginTop:"12px",lineHeight:"22px"},children:(0,c.jsx)(f.FormattedMessage,{...pl.selectProjectHeading})}),(0,c.jsx)(Ce.Z,{style:{font:"SF Pro",fontWeight:y.Z.fontWeight.regular,fontSize:y.Z.fontSize.UIRegular.desktop,lineHeight:"19.6px",whiteSpace:"normal",wordWrap:"break-word",paddingTop:4,paddingBottom:20},children:(0,c.jsx)(f.FormattedMessage,{...pl.mapTeamspacesDescription})})]}):(0,c.jsx)(c.Fragment,{}),r?(0,c.jsxs)(Kr.gq,{style:{gap:8,marginTop:16,alignItems:"center"},children:[(0,c.jsx)(zi.Z,{style:{fontSize:12}}),(0,c.jsx)(Ce.Z,{isSmall:!0,style:{color:is.FN.light.gray[400]},children:(0,c.jsx)(f.FormattedMessage,{...pl.loadingProjectsPlaceholder})})]}):m.filter((e=>0!==e.projects.length)).map((e=>(0,c.jsx)(gl,{asanaTeam:e},`${e.gid}-table`)))]})},vl=(0,f.defineMessages)({selectProperties:{id:"asanaImport.selectProperties.subtitleForSelectPropertiesTab",defaultMessage:"By default, all Asana task properties will be imported. You can customize this for each teamspace below"}});const bl=function(){(0,i.O7)();const e=(0,r.yK)((e=>({teamSpaceLabel:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4},header:{font:"SF Pro",fontWeight:y.Z.fontWeight.regular,fontSize:y.Z.fontSize.UIRegular.desktop,lineHeight:"19.6px",whiteSpace:"normal",wordWrap:"break-word",paddingTop:4,paddingBottom:20}})),[]),t=(0,a.VK)((()=>{var e;const t=null===(e=Ge.default.state.currentSpaceViewStore)||void 0===e?void 0:e.getTeamsStores();return Object.values(Zr.Z.state.selectedProjectsAndTeamspaces).map((e=>{const n=null==t?void 0:t.find((t=>t.id===e.notionTeamspaceId));return{teamSpaceId:e.notionTeamspaceId,name:null==n?void 0:n.getName(),icon:(0,c.jsx)(Ur.p,{disabled:!0,store:n})}}))}),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ce.Z,{style:e.header,children:(0,c.jsx)(f.FormattedMessage,{...vl.selectProperties})}),(0,c.jsx)(Os.Z,{style:{padding:0},tabs:t.map((e=>(0,c.jsxs)(Kr.gq,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]},e.name))),selectedIndex:0,onChange:()=>{}})]})};var Ml=n(853465),jl=n(664878);const Cl=function(e){var t;const n=(0,r.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},closeIconStyle:{width:16,height:16,fill:e.redBadgeBackground},lightText:{color:e.lightTextColor}})),[]);return(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},children:[(0,c.jsxs)(Kr.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:[(0,c.jsx)("img",{style:{width:32,height:32,marginRight:8},src:e.assetSrc}),(0,jl.h)(n.iconStyle),(0,jl.h)(n.iconStyle),(0,jl.h)(n.iconStyle),(0,Ml.X)(n.closeIconStyle),(0,jl.h)(n.iconStyle),(0,jl.h)(n.iconStyle),(0,jl.h)(n.iconStyle),(0,c.jsx)("img",{style:{width:32,height:32,marginLeft:8},src:_r.Z.images.notionLogoPng})]}),(0,c.jsx)(Ce.Z,{style:n.lightText,children:e.failedMessage}),(0,c.jsx)(Ce.Z,{style:n.lightText,children:(0,c.jsx)(f.FormattedMessage,{id:"import.importingData.failed.viewLoggerPage",defaultMessage:"Please try again or read the {link} to troubleshoot.",values:{link:(0,c.jsx)("a",{style:{color:is.ZP.black,cursor:"pointer"},href:`/${null===(t=e.loggerPageId)||void 0===t?void 0:t.replaceAll("-","")}`,children:(0,c.jsx)(f.FormattedMessage,{id:"import.importingData.failed.linkText",defaultMessage:"import logs"})})}})})]})};const wl=function(e){const{dotCount:t=6,speed:n=800}=e,[i,o]=(0,s.useState)(1),a=(0,r.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor,opacity:.5},iconStyleBold:{width:6,height:6,fill:e.lightIconColor}})),[]);return(0,s.useEffect)((()=>{const e=setInterval((()=>o((e=>e<t?e+1:1))),n);return()=>clearInterval(e)}),[t,n]),(0,c.jsx)(Kr.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:Array.from({length:t},((e,t)=>t+1)).map((e=>(0,c.jsx)("div",{children:(0,jl.h)(i===e?a.iconStyleBold:a.iconStyle)},e)))})};const kl=function(e){const t=(0,r.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},iconStyleBold:{width:8,height:8,fill:e.mediumIconColor},lightText:{color:e.lightTextColor}})),[]);return(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},children:[(0,c.jsxs)(Kr.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:[(0,c.jsx)("img",{style:{width:32,height:32,marginRight:8},src:e.assetSrc}),(0,c.jsx)(wl,{}),(0,c.jsx)("img",{style:{width:32,height:32,marginLeft:8},src:_r.Z.images.notionLogoPng})]}),(0,c.jsx)(Kr.gq,{children:(0,c.jsx)(Ce.Z,{style:t.lightText,children:(0,c.jsx)(f.FormattedMessage,{id:"import.importingData.feelFreeToLeave",defaultMessage:"Data is being imported. Feel free to leave this window."})})}),(0,c.jsx)(Kr.gq,{children:(0,c.jsx)(Ce.Z,{style:t.lightText,children:(0,c.jsx)(f.FormattedMessage,{id:"import.importingData.sendEmail",defaultMessage:"We will send you an email when the import is complete or if any problems occur."})})})]})},Il=(0,f.defineMessages)({failed:{defaultMessage:"Some problems occurred while importing data from your Asana workspace.",id:"Asanaimport.importingData.failed.problemsOccured"}});function Tl(e){switch(e){case"selectData":return(0,c.jsx)(Ce.Z,{style:{paddingBottom:8,fontSize:18,fontWeight:y.Z.fontWeight.semibold,width:"100%"},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.tabTitle",defaultMessage:"Select Asana workspace"})});case"chooseWorkspace":return(0,c.jsx)(Ce.Z,{style:{font:"SF Pro",fontWeight:"590",fontSize:"17px",marginTop:"12px",lineHeight:"22px"},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.tabTitle",defaultMessage:"Choose Asana workspace"})});case"selectProperties":return(0,c.jsx)(Ce.Z,{style:{font:"SF Pro",fontWeight:"590",fontSize:"17px",marginTop:"12px",lineHeight:"22px"},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.selectProperties.tabTitle",defaultMessage:"Select properties"})});default:return(0,c.jsx)(c.Fragment,{})}}function Zl(e){const t="chooseWorkspace",n=(0,r.yK)((e=>({stepIndicator:{font:"SF Pro",alignItems:"center",fontWeight:510,fontSize:y.Z.fontSize.UIRegular.desktop,lineHeight:"18px"},stepIndicatorContainer:{display:"flex",height:32,padding:6,gap:"8px",borderRadius:4,justifyContent:"center",alignItems:"center"},verificationCheck:{width:16,height:16,padding:"0.5px, 0px, 0px, 0px",gap:"10px",color:is.ZP.lightIconColor}})),[]),s=(0,a.VK)((()=>Zr.Z.getState()),[]),{choosingWorkspacesCompleted:i}=s;return(0,c.jsxs)("div",{style:{paddingBottom:20,display:"flex",gap:"12px",padding:"12px",alignItems:"center",alignContent:"center",paddingLeft:0},children:[(0,c.jsxs)("div",{style:{...n.stepIndicatorContainer,width:i?191:165,background:e===t?"rgba(0, 0, 0, 0.05)":void 0},children:[i?(0,Rr.X)(n.verificationCheck):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)(Ce.Z,{style:{...n.stepIndicator,color:i?is.ZP.lightTextColor:e===t?is.ZP.regularTextColor:is.ZP.mediumTextColor},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.stepIndicator.chooseWorkspaceTab",defaultMessage:"Choose what to import"})})]}),(0,c.jsxs)("div",{style:{...n.stepIndicatorContainer,width:"selectProperties"===e?83:57,background:"importingData"===e?"rgba(0, 0, 0, 0.05)":void 0},children:["confirm"===e?(0,Rr.X)(n.verificationCheck):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)(Ce.Z,{style:{...n.stepIndicator,color:"confirm"===e?is.ZP.lightTextColor:"importingData"===e?is.ZP.regularTextColor:is.ZP.mediumTextColor},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.stepIndicator.selectPropertiesTab",defaultMessage:"Customize"})})]}),(0,c.jsxs)("div",{style:{...n.stepIndicatorContainer,width:"confirm"===e?83:57,background:"importingData"===e?"rgba(0, 0, 0, 0.05)":void 0},children:["confirm"===e?(0,Rr.X)(n.verificationCheck):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)(Ce.Z,{style:{...n.stepIndicator,color:"confirm"===e?is.ZP.lightTextColor:"importingData"===e?is.ZP.regularTextColor:is.ZP.mediumTextColor},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.importsTab.stepIndicator.importTab",defaultMessage:"Import"})})]})]})}function Pl(){return(0,c.jsx)(Qi.Z,{buttonStyle:{height:28},title:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.confirm.helpCenter",defaultMessage:"Learn more about importing from Asana"}),href:(0,ze.UY)("guides.importAsana"),analyticsFrom:"import"})}const Fl=function(e){let{tab:t,fetchActiveImportTasks:n}=e;const o=V.default.getIntl(),l=(0,i.O7)(),d=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),u=(0,a.VK)((()=>Ge.default.state.currentSpaceViewStore),[]),p=(0,a.VK)((()=>Lr.Z.state.teams),[]),g=(0,a.VK)((()=>Zr.Z.state),[]),h=(0,a.VK)((()=>Ie.default.checkGate({gateName:"improved_asana_importer_screens"})),[]),x=(0,a.VK)((()=>He.Z.state),[]).flowId||m.Il(),{importCompletedTasks:S,loggerPageId:v,selectedProjectsAndTeamspaces:b,selectedWorkspace:M,templateCreationInProgress:j,result:C,workspaces:w}=g,k=(0,s.useCallback)((()=>Object.values(b).some((e=>0!==e.projects.length))),[b]),I=(0,r.yK)((e=>({closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor},helpCenterButtonStytles:{display:"flex",alignItems:"baseline",justifyContent:"center",alignContent:"center",fontSize:y.Z.fontSize.UIRegular.desktop,padding:"6px, 0px, 0px, 0px",borderRadius:4,color:e.mediumTextColor,marginTop:2,width:298,height:28,gap:"4px",lineHeight:"18px"},externalLinkIcon:{width:"16px",height:"16px",padding:"0.5px, 0px, 0px, 0px",gap:"8px"}})),[]);let T=t;return h&&("selectData"===t?T="chooseWorkspace":"confirm"===t&&(T="importComplete")),(0,c.jsxs)(kt.ZP,{controlRow:(e=>"selectData"===e?(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,c.jsx)(yt.Z,{style:{border:0},disabled:!w.length,onClick:()=>{n(),Zr.Z.resetImport()},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.selectData.backButtonText",defaultMessage:"Back"})}),(0,c.jsxs)(Kr.gq,{alignItems:"center",gap:8,children:[M?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(al.Z,{on:S,onClick:()=>Zr.Z.setState({...g,importCompletedTasks:!S})}),(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.selectData.importCompletedTasks",defaultMessage:"Import completed tasks"})})]}):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)("div",{style:{gap:2},children:(0,c.jsx)(Bs.Z,{style:{marginLeft:16},disabled:!k()||j,onClick:()=>{d&&u&&Or.T_({environment:l,currentSpaceViewStore:u,spaceStore:d,teamsStores:p,flowId:x}).catch((()=>{}))},children:j?(0,c.jsxs)(Kr.gq,{alignItems:"center",gap:2,children:[(0,c.jsx)(zi.Z,{isWhite:!0}),(0,c.jsx)(f.FormattedMessage,{id:"importsTab.selectData.creatingTemplates",defaultMessage:"Creating templates"})]}):(0,c.jsx)(f.FormattedMessage,{id:"importsTab.selectData.nextButtonText",defaultMessage:"Next"})})})]})]}):"chooseWorkspace"===e?(0,c.jsxs)(Kr.gq,{justifyContent:"space-between",alignItems:"center",children:[(0,c.jsx)(Pl,{}),(0,c.jsxs)(Kr.gq,{alignItems:"center",gap:8,children:[M?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(al.Z,{on:S,onClick:()=>Zr.Z.setState({...g,importCompletedTasks:!S})}),(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.chooseWorkspace.importCompletedTasks",defaultMessage:"Import completed tasks"})})]}):(0,c.jsx)(c.Fragment,{}),(0,c.jsxs)("div",{style:{gap:2},children:[(0,c.jsx)(yt.Z,{style:{border:0},disabled:!w.length,onClick:()=>{n(),Zr.Z.resetImport()},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.chooseWorkspace.backButtonText",defaultMessage:"Back"})}),(0,c.jsx)(Bs.Z,{style:{marginLeft:16},disabled:!k()||j,onClick:Or.Np,children:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.chooseWorkspace.nextButtonText",defaultMessage:"Next"})})]})]})]}):"selectProperties"===e?(0,c.jsxs)(Kr.gq,{justifyContent:"space-between",alignItems:"center",children:[(0,c.jsx)(Pl,{}),(0,c.jsxs)(Kr.gq,{alignItems:"center",gap:8,children:[(0,c.jsx)(yt.Z,{style:{border:0},disabled:!w.length,onClick:()=>{Zr.Z.setState({...g,currentTab:"chooseWorkspace"})},children:(0,c.jsx)(f.FormattedMessage,{id:"asanaImport.selectProperties.backButtonText",defaultMessage:"Back"})}),(0,c.jsx)(Bs.Z,{style:{marginLeft:16},disabled:!k()||j,onClick:()=>{d&&u&&Or.T_({environment:l,currentSpaceViewStore:u,spaceStore:d,teamsStores:p,flowId:x}).catch((()=>{}))},children:j?(0,c.jsxs)(Kr.gq,{alignItems:"center",gap:2,children:[(0,c.jsx)(zi.Z,{isWhite:!0}),(0,c.jsx)(f.FormattedMessage,{id:"importsTab.selectProperties.creatingTemplates",defaultMessage:"Creating templates"})]}):(0,c.jsx)(f.FormattedMessage,{id:"importsTab.selectProperties.nextButtonText",defaultMessage:"Next"})})]})]}):"importingData"===e?(0,c.jsxs)("div",{style:{display:"flex",justifyContent:h?"space-between":"right"},children:[h?(0,c.jsx)(Pl,{}):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)(yt.Z,{disabled:!w.length,onClick:()=>{n(),Zr.Z.resetImport()},children:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})]}):"confirm"===e?(0,c.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,c.jsx)(Bs.Z,{onClick:()=>{v&&Yi.c4({url:(0,Ar.Z)({pageId:v,pageModel:(0,Br.lA)({table:Dr.iU,id:v}),baseUrl:ds.default.domainBaseUrl,pageVisitSource:Cr.tY.Import}),environment:l}),Zr.Z.resetImport(),rt.Z.reset()},children:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.confirm.doneText",defaultMessage:"Done"})})}):"failure"===e?(0,c.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,c.jsx)(yt.Z,{disabled:!w.length,onClick:()=>{n(),Zr.Z.resetImport()},children:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):"importComplete"===e?(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",height:48,paddingTop:35,paddingBottom:28,border:"1px, 0px, 0px, 0px"},children:[(0,c.jsx)(Pl,{}),(0,c.jsx)(Bs.Z,{style:{width:"181px",height:"32px",padding:"0px, 0px, 0px, 8px",borderRadius:"4px",gap:"4px"},onClick:()=>{if(null!=C&&C.length&&v){const e=C.find((e=>void 0!==e.projectCollectionPageId));Yi.c4({url:(0,Ar.Z)({pageId:(null==e?void 0:e.projectCollectionPageId)||v,pageModel:(0,Br.lA)({table:Dr.iU,id:(null==e?void 0:e.projectCollectionPageId)||v}),baseUrl:ds.default.domainBaseUrl,pageVisitSource:Cr.tY.Import}),environment:l})}Zr.Z.resetImport(),rt.Z.reset()},children:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.confirm.viewImportedProjects",defaultMessage:"View imported projects"})})]}):void 0)(T),controlRowPaddingTopBottom:"confirm"===t&&h?0:h?10:20,removeBoxShadow:"confirm"===t&&h,contentPaddingLeftRight:h?25:void 0,controlRowPaddingLeftRight:h?15:void 0,getPaddingTopBottom:h?()=>2:void 0,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[h?Zl(T):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)("div",{style:{position:"absolute",top:12,right:12},children:(0,c.jsx)(_s.Z,{onClick:()=>{n(),Zr.Z.resetImport()},style:I.closeButton,hoveredStyle:I.closeButtonHover,children:(0,ir.D)(I.closeButtonIcon)})})]}),Tl(T),(e=>"selectData"===e?(0,c.jsx)(nl,{}):"importingData"===e?(0,c.jsx)(kl,{assetSrc:_r.Z.images.import.asanaPng}):"confirm"===e?(0,c.jsx)(zr,{}):"failure"===e?(0,c.jsx)(Cl,{assetSrc:_r.Z.images.import.asanaPng,loggerPageId:v,failedMessage:o.formatMessage(Il.failed)}):"chooseWorkspace"===e?(0,c.jsx)(Sl,{}):"selectProperties"===e?(0,c.jsx)(bl,{}):"importComplete"===e?(0,c.jsx)($r,{}):void 0)(T)]})};const _l=function(e){let{fetchActiveImportTasks:t}=e;const n=(0,a.VK)((()=>Zr.Z.state),[]),{isModalOpen:i}=n,o=(0,s.useCallback)((()=>{Zr.Z.resetImport()}),[]),r=(0,s.useCallback)((()=>{const{currentTab:e}=n;return(0,c.jsx)(Fl,{fetchActiveImportTasks:t,tab:e})}),[n,t]);return(0,c.jsx)(Hs.Z,{open:i,innerStyle:{width:800,height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:675},render:()=>(0,c.jsx)(qs.Z,{capture:!0,allowEsc:!0,render:()=>(0,c.jsx)(Gs.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>r()})}),onDismiss:o})};var Al=n(273917),Bl=n(369122),Rl=n(361397);const Dl=function(){const e=(0,a.VK)((()=>Bl.Z.state),[]);return e.result?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ce.Z,{isMultiline:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"mondayImport.importsTab.confirm.subtitle",defaultMessage:"The following data has been successfully imported."})}),(0,c.jsx)("div",{style:{marginTop:32},children:e.result.map((e=>(0,c.jsx)(Ol,{importStatus:e},e.mondayFolderId)))})]}):(0,c.jsx)(c.Fragment,{})};function Ol(e){let{importStatus:t}=e;const n=(0,r.Fg)(),[i,o]=(0,s.useState)(!1),d=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),u=(0,a.VK)((()=>Bl.Z.state.mondayFoldersAndBoards),[]),m=(0,a.VK)((()=>Ge.default.state.currentSpaceViewStore),[]),p=(0,a.VK)((()=>{if(!m)return;const e=m.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,c.jsx)(Ur.p,{disabled:!0,store:e})})));return d?(e||[]).concat({id:m.id,name:"Private",icon:(0,c.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:is.FN.light.gray[75]},children:(0,l.Q)({color:n.mediumIconColor,width:12.5,height:12.5})})}):e}),[m,d,n]),{notionTeamspaceName:g,notionTeamspaceIcon:h}=(0,s.useMemo)((()=>{const e=null==p?void 0:p.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[p,t]),y=(0,s.useMemo)((()=>{const e=u.find((e=>e.folderId===t.mondayFolderId));return null==e?void 0:e.folderName}),[u,t]);return(0,c.jsxs)(Kr.gq,{style:{marginTop:16},children:[(0,c.jsx)(ui.Z,{ariaLabel:"collapse toggle",icon:Nr.L,onClick:()=>o((e=>!e)),style:{transform:i?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:4},iconStyle:{width:8,height:8}}),(0,c.jsx)(Wr.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,c.jsx)(Kr.gq,{alignItems:"center",gap:2,children:(0,c.jsx)(Ce.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis"},children:y})}),style:{width:300}},{key:"importedInto",header:(0,c.jsxs)(Kr.gq,{gap:4,children:[(0,c.jsxs)(Kr.gq,{style:{alignItems:"center",gap:4},children:[(0,c.jsx)(Ce.Z,{isSmall:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"mondayImport.importsTab.selectData.importedInto",defaultMessage:"Imported into"})}),(0,Vr.n)({width:12})]}),(0,c.jsxs)(Kr.gq,{style:{alignItems:"center",gap:4},children:[h,g]})]}),style:{width:300}}],rows:function(e){let{collapsed:n}=e;return n?[]:t.projects.map((e=>({key:e.projectId,columns:[(0,c.jsxs)(Kr.gq,{gap:8,alignItems:"center",children:[(0,Er.r)({width:12,color:is.FN.dark.green[600]}),(0,c.jsx)(Ce.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300},children:e.name})]},e.projectId)]})))}({collapsed:i})})]})}const Ll=function(){const e=(0,i.O7)(),t=(0,f.useIntl)(),n=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),o=(0,a.VK)((()=>Bl.Z.getState()),[]),{workspaces:r,selectedWorkspace:l,mondayFoldersAndBoards:d}=o;return(0,s.useEffect)((()=>{l&&Rl.IO({environment:e,spaceId:null==n?void 0:n.id,selectedWorkspace:l}).catch((()=>{}))}),[l,e,null==n?void 0:n.id]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ce.Z,{isSmall:!0,style:{paddingTop:4,paddingBottom:4},children:(0,c.jsx)(f.FormattedMessage,{id:"mondayImport.importsTab.selectData.workspaceChoiceHelperText",defaultMessage:"Only one workspace can be imported at a time."})}),(0,c.jsx)(El,{onSelectOption:e=>{Bl.Z.setState({...o,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:r.map((e=>({key:e.id,label:e.name}))),currentOption:o.selectedWorkspace,placeHolder:t.formatMessage({id:"mondayImporter.selectData.selectWorkspacePlaceholder",defaultMessage:"Select a workspace"})}),o.selectedWorkspace?(0,c.jsx)(Ce.Z,{style:{fontWeight:y.Z.fontWeight.semibold,marginTop:18},children:(0,c.jsx)(f.FormattedMessage,{id:"mondayImport.importsTab.selectData.selectProjects",defaultMessage:"Select projects"})}):(0,c.jsx)(c.Fragment,{}),o.isLoadingProjects?(0,c.jsxs)(Kr.gq,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,c.jsx)(zi.Z,{style:{fontSize:12}}),(0,c.jsx)(Ce.Z,{isSmall:!0,style:{color:is.FN.light.gray[400]},children:(0,c.jsx)(f.FormattedMessage,{id:"mondayImport.importsTab.selectData.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):d.map((e=>(0,c.jsx)(Vl,{mondayFolderAndBoards:e},`${e.folderId}-table`)))]})};function Vl(e){let{mondayFolderAndBoards:t}=e;const n=(0,f.useIntl)(),i=(0,r.Fg)(),[o,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(),p=(0,a.VK)((()=>Bl.Z.getState()),[]),g=(0,a.VK)((()=>Ge.default.state.currentSpaceViewStore),[]),h=(0,a.VK)((()=>{const e=null==g?void 0:g.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,c.jsx)(Ur.p,{disabled:!0,store:e})})))}),[g]);(0,s.useEffect)((()=>{if(!h||!g)return;if(!p.selectedProjectsAndTeamspaces[t.folderId]){m("private"),Rl.eL({folderId:t.folderId,spaceId:null==g?void 0:g.id});for(const s of h){var e,n;if((null===(e=s.name)||void 0===e?void 0:e.toLowerCase())===(null===(n=t.folderName)||void 0===n?void 0:n.toLowerCase())){m(s.id),Rl.eL({folderId:t.folderId,spaceId:s.id});break}}}}),[h,t,g,p.selectedProjectsAndTeamspaces]);const x=(0,s.useCallback)((e=>{Rl.eL({folderId:t.folderId,spaceId:e}),m(e)}),[t.folderId]),S=(0,s.useCallback)((e=>{if("create"===e)return void el.lo("monday_importer",{onClose:x});let n;if("private"===e){if(null==g||!g.id)return;n=g.id}else n=e;Rl.eL({folderId:t.folderId,spaceId:n}),m(e)}),[null==g?void 0:g.id,t.folderId,x]),v=[{key:"private",searchTerm:"private",label:(0,c.jsxs)(Kr.gq,{alignItems:"center",style:{gap:8},children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:is.FN.light.gray[75]},children:(0,l.Q)({color:i.mediumIconColor,width:12.5,height:12.5})}),(0,c.jsx)(Ce.Z,{style:{fontWeight:y.Z.fontWeight.regular},children:(0,c.jsx)(f.FormattedMessage,{id:"mondayImport.importsTab.selectData.privateSpaceTitle",defaultMessage:"Private"})})]})}];function b(e){let{collapsed:n}=e;if(n)return[];const s=t.projects.map((e=>({key:e.id,columns:[(0,c.jsxs)(Kr.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,c.jsx)(pr.Z,{style:{marginRight:2},onClick:()=>{const n={...p.selectedProjectsAndTeamspaces[t.folderId]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:s,projects:i}=n;let o;o=i.find((t=>t.mondayProjectId===e.id))?i.filter((t=>t.mondayProjectId!==e.id)):i.concat({name:e.name,mondayProjectId:e.id,mondayBoardId:e.boardId,collectionType:"projects"}),Bl.Z.setState({...p,selectedProjectsAndTeamspaces:{...p.selectedProjectsAndTeamspaces,[t.folderId]:{notionTeamspaceId:s,projects:o}}})},checked:{...p.selectedProjectsAndTeamspaces[t.folderId]||{projects:[],notionTeamspaceId:void 0}}.projects.some((t=>t.mondayProjectId===e.id)),size:14,checkSize:8}),(0,c.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:(0,c.jsx)(Ce.Z,{isMultiline:!0,children:e.name})})]},`${e.id}-container`)]}))),i=t.taskBoards.map((e=>({key:e.id,columns:[(0,c.jsxs)(Kr.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,c.jsx)(pr.Z,{style:{marginRight:2},onClick:()=>{const n={...p.selectedProjectsAndTeamspaces[t.folderId]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:s,projects:i}=n;let o;o=i.find((t=>t.mondayProjectId===e.id))?i.filter((t=>t.mondayProjectId!==e.id)):i.concat({name:e.name,mondayProjectId:e.id,collectionType:"tasks"}),Bl.Z.setState({...p,selectedProjectsAndTeamspaces:{...p.selectedProjectsAndTeamspaces,[t.folderId]:{notionTeamspaceId:s,projects:o}}})},checked:{...p.selectedProjectsAndTeamspaces[t.folderId]||{projects:[],notionTeamspaceId:void 0}}.projects.some((t=>t.mondayProjectId===e.id)),size:14,checkSize:8}),(0,c.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:(0,c.jsx)(Ce.Z,{isMultiline:!0,children:e.name})})]},`${e.id}-container`)]})));return[...s,...i]}h&&v.push(...h.map((e=>({key:e.id,searchTerm:e.name,label:(0,c.jsxs)(Kr.gq,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]})})))),v.push({key:"create",searchTerm:"New teamspace",label:(0,c.jsxs)(Kr.gq,{alignItems:"center",style:{gap:4},children:[(0,Xr.f)({color:i.mediumIconColor,width:16,height:16}),(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"mondayImport.importsTab.selectData.newTeamspace",defaultMessage:"New teamspace"})})]})});const M=!(t.projects.length||t.taskBoards.length);return(0,c.jsx)(je.Z,{disableTooltip:!M,renderTooltip:()=>(0,c.jsx)(Ce.Z,{style:{color:is.ZP.white},isSmall:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"mondayImport.importsTab.selectData.tooltipForDisabledFolder",defaultMessage:"This folder has no boards with Item type Projects or Tasks. Other types are not supported."})}),render:e=>{var s;return(0,c.jsx)("div",{...e,children:(0,c.jsxs)(Kr.gq,{style:M?{color:i.mediumTextColor,fill:i.mediumIconColor,opacity:.4,marginLeft:-18}:{marginLeft:-18},children:[(0,c.jsx)(ui.Z,{ariaLabel:"collapse toggle",icon:Nr.L,disabled:M,onClick:()=>d((e=>!e)),style:{transform:o?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}}),(0,c.jsx)(Wr.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,c.jsxs)(Kr.gq,{alignItems:"center",gap:2,children:[(0,c.jsx)(pr.Z,{style:{marginRight:4,height:14},disabled:M,checked:(()=>{const e={...p.selectedProjectsAndTeamspaces[t.folderId]||{projects:[],notionTeamspaceId:void 0,isEntireFolderSelected:void 0}};return Boolean(e.isEntireFolderSelected)})(),size:14,checkSize:8,onClick:()=>{const e={...p.selectedProjectsAndTeamspaces[t.folderId]||{projects:[],notionTeamspaceId:void 0,isEntireFolderSelected:void 0}},{notionTeamspaceId:n,isEntireFolderSelected:s}=e;let i,o;if(s)i=[],o=!1;else{i=[...t.projects.map((e=>({name:e.name,mondayProjectId:e.id,mondayBoardId:e.boardId,collectionType:"projects"}))),...t.taskBoards.map((e=>({name:e.name,mondayProjectId:e.id,collectionType:"tasks"})))],o=!0}Bl.Z.setState({...p,selectedProjectsAndTeamspaces:{...p.selectedProjectsAndTeamspaces,[t.folderId]:{notionTeamspaceId:n,projects:i,isEntireFolderSelected:o}}})}}),(0,c.jsx)(Ce.Z,{style:{width:280,textOverflow:"ellipsis"},children:t.folderName})]}),style:{width:300}},{key:"importInto",header:(0,c.jsxs)(Kr.gq,{style:{alignItems:"center"},children:[(0,c.jsx)("div",{children:(0,c.jsx)(f.FormattedMessage,{id:"mondayImport.importsTab.selectData.importInto",defaultMessage:"Import into"})}),(0,c.jsx)("div",{style:{marginRight:16,marginLeft:8},children:(0,Vr.n)({width:12})}),(0,c.jsxs)(Kr.gq,{style:{alignItems:"center",gap:8},children:[(0,c.jsx)("img",{src:_r.Z.emails.notionLogoBlackSmallPng,height:18}),(0,c.jsx)(El,{options:v,onSelectOption:S,currentOption:null===(s=v.find((e=>e.key===u)))||void 0===s?void 0:s.key,narrow:!0,allowSearch:!0,placeHolder:n.formatMessage({id:"mondayImport.importsTab.selectData.selectATeamspace",defaultMessage:"Select a teamspace"}),shouldBeDisabled:M})]})]}),style:{width:"50%"}}],rows:b({collapsed:o})})]})})}})}function El(e){var t;const{onSelectOption:n,options:i,currentOption:o,placeHolder:a,narrow:l,allowSearch:d,shouldBeDisabled:u}=e,m=(0,f.useIntl)(),[p,g]=(0,s.useState)(""),h=null===(t=i.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,x=(0,r.yK)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,placementToOrigin:na.pO.Bottom,disabled:u,renderOrigin:e=>(0,c.jsxs)(pn.Z,{...e,style:{paddingTop:l?2:8,paddingBottom:l?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:250,border:`1px solid ${is.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,background:o?void 0:is.FN.light.gray[50],color:o?void 0:is.FN.light.gray[300]},disabled:!1,children:[(0,c.jsx)(Ce.Z,{style:{textOverflow:"ellipsis"},children:h||a}),(0,Jr.i)(x.icon)]}),render:e=>{const t={menuType:cs.og.Popup,width:250,left:50},s=[{key:"mondayImport.dropdown.menuList",render:e=>(0,c.jsx)(ys.Z,{...e}),items:(p.trim()?i.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(p.toLowerCase())})):i).map((t=>{let{key:s,label:i}=t;return{key:s,action:()=>{n(s),e.close()},render:e=>(0,c.jsx)(ms.Z,{...e,title:i,shouldWrapCaption:!0,right:h===i?(0,c.jsx)("div",{style:{width:14},children:(0,Qr.e)()}):void 0})}}))}];return(0,c.jsxs)(c.Fragment,{children:[d?(0,c.jsx)("input",{style:{width:"100%",borderRadius:0,backgroundColor:is.FN.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${is.FN.light.gray[100]}`,justifyContent:"space-between",background:is.FN.light.gray[50],fontSize:y.Z.fontSize.UIRegular.desktop,textOverflow:"ellipses"},placeholder:m.formatMessage({id:"mondayImport.importsTab.selectData.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"}),onChange:e=>g(e.target.value),value:p}):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)(ps.Z,{...t,children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,sections:s,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})]})}})}const Nl=(0,f.defineMessages)({failed:{defaultMessage:"Some problems occurred while importing data from your Monday workspace.",id:"Mondayimport.importingData.failed.problemsOccured"}});function Ul(e){return"selectData"===e?(0,c.jsx)(Ce.Z,{style:{fontWeight:y.Z.fontWeight.semibold},children:(0,c.jsx)(f.FormattedMessage,{id:"MondayImport.importsTab.selectData.tabTitle",defaultMessage:"Select Monday.com workspace"})}):(0,c.jsx)(c.Fragment,{})}const Kl=function(e){let{tab:t,fetchActiveImportTasks:n}=e;const o=V.default.getIntl(),l=(0,i.O7)(),d=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),u=(0,a.VK)((()=>Ge.default.state.currentSpaceViewStore),[]),p=(0,a.VK)((()=>Lr.Z.state.teams),[]),g=(0,a.VK)((()=>Bl.Z.state),[]),h=(0,a.VK)((()=>He.Z.state),[]).flowId||m.Il(),{workspaces:x}=g,S=(0,s.useCallback)((()=>Object.values(g.selectedProjectsAndTeamspaces).some((e=>0!==e.projects.length))),[g.selectedProjectsAndTeamspaces]),v=(0,r.yK)((e=>({closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor}})),[]);return(0,c.jsxs)(kt.ZP,{controlRow:(e=>"selectData"===e?(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)(yt.Z,{style:{border:0},disabled:!x.length,onClick:()=>{n(),Bl.Z.resetImport()},children:(0,c.jsx)(f.FormattedMessage,{id:"mondayImport.selectData.backButtonText",defaultMessage:"Back"})}),(0,c.jsx)(Kr.gq,{alignItems:"center",gap:8,children:(0,c.jsx)(Bs.Z,{style:{marginLeft:16},disabled:!S()||g.templateCreationInProgress,onClick:()=>{d&&u&&Rl.C8({environment:l,spaceStore:d,currentSpaceViewStore:u,teamsStores:p,flowId:h}).catch((()=>{}))},children:g.templateCreationInProgress?(0,c.jsxs)(Kr.gq,{alignItems:"center",gap:2,children:[(0,c.jsx)(zi.Z,{isWhite:!0}),(0,c.jsx)(f.FormattedMessage,{id:"importsTab.selectData.creatingTemplates",defaultMessage:"Creating templates"})]}):(0,c.jsx)(f.FormattedMessage,{id:"importsTab.selectData.nextButtonText",defaultMessage:"Next"})})})]}):"importingData"===e?(0,c.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,c.jsx)(yt.Z,{disabled:!x.length,onClick:()=>{n(),Bl.Z.resetImport()},children:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):"confirm"===e?(0,c.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,c.jsx)(Bs.Z,{onClick:()=>{var e;if(null!==(e=g.result)&&void 0!==e&&e.length&&g.loggerPageId){const e=g.result.find((e=>void 0!==e.projectCollectionPageId));Yi.c4({url:(0,Ar.Z)({pageId:(null==e?void 0:e.projectCollectionPageId)||g.loggerPageId,pageModel:(0,Br.lA)({table:Dr.iU,id:(null==e?void 0:e.projectCollectionPageId)||g.loggerPageId}),baseUrl:ds.default.domainBaseUrl,pageVisitSource:Cr.tY.Import}),environment:l})}Bl.Z.resetImport(),rt.Z.reset()},children:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.confirm.doneText",defaultMessage:"Done"})})}):"failure"===e?(0,c.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,c.jsx)(yt.Z,{disabled:!x.length,onClick:()=>{n(),Bl.Z.resetImport()},children:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):void 0)(t),controlRowPaddingTopBottom:20,children:[(0,c.jsx)("div",{style:{position:"absolute",top:12,right:12},children:(0,c.jsx)(_s.Z,{onClick:()=>{n(),Bl.Z.resetImport()},style:v.closeButton,hoveredStyle:v.closeButtonHover,children:(0,ir.D)(v.closeButtonIcon)})}),(0,c.jsx)(Ce.Z,{style:{paddingBottom:8,fontSize:18,fontWeight:y.Z.fontWeight.medium,width:"100%"},children:Ul(t)}),(e=>"selectData"===e?(0,c.jsx)(Ll,{}):"importingData"===e?(0,c.jsx)(kl,{assetSrc:_r.Z.images.import.mondayPng}):"confirm"===e?(0,c.jsx)(Dl,{}):"failure"===e?(0,c.jsx)(Cl,{assetSrc:_r.Z.images.import.mondayPng,loggerPageId:g.loggerPageId,failedMessage:o.formatMessage(Nl.failed)}):void 0)(t)]})};const Wl=function(e){let{fetchActiveImportTasks:t}=e;const n=(0,a.VK)((()=>Bl.Z.state),[]),i=(0,s.useCallback)((()=>{Bl.Z.resetImport()}),[]),o=(0,s.useCallback)((()=>{const{currentTab:e}=n;return(0,c.jsx)(Kl,{fetchActiveImportTasks:t,tab:e})}),[t,n]);return(0,c.jsx)(Hs.Z,{open:n.isModalOpen,innerStyle:{width:800,height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:675},render:()=>(0,c.jsx)(qs.Z,{capture:!0,allowEsc:!0,render:()=>(0,c.jsx)(Gs.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>o()})}),onDismiss:i})};var zl=n(685567),ql=n(443876),Gl=n(100952),Hl=n(400601);class $l extends N.default{getInitialState(){return{isDragOverActive:!1}}}const Yl=new $l,Ql=(0,f.defineMessages)({invalidFileFormat:{id:"zipImportOptions.invalidFile",defaultMessage:"Unsupported file format, Please drag and drop a ZIP file"}});const Jl=function(e){const t=(0,i.O7)(),n=(0,a.VK)((()=>Yl.state.isDragOverActive),[]),s=(0,r.yK)((e=>({buttonStyle:{display:"flex",alignItems:"center",paddingLeft:12,paddingRight:12,paddingTop:2,paddingBottom:2,borderColor:e.outlineButtonBorder,border:1,borderWidth:1,borderRadius:4,height:32,gap:4,background:e.importOptionsButtonBackground},titleStyle:{fontSize:14,fontWeight:"medium",font:"SF Pro",color:e.v2.text.primary,width:183,height:18},divTitleStyle:{color:e.v2.text.secondary,display:"flex",background:n?e.fill.gray:e.fill.lightGray,width:"100%",padding:"16px",justifyContent:"center",alignItems:"center",gap:12,borderRadius:8,border:n?"2px solid":"none",borderColor:n?e.stroke.uiBlueDeemphasized:e.fill.lightGray},divStyle:{display:"flex",alignItems:"center",marginTop:10,minWidth:0,width:"100%",gap:10},UiLabelStyle:{color:e.v2.text.secondary,font:"SF Pro",fontWeight:400,fontSize:14}})),[n]),o=e=>{Yl.setState({...Yl.state,isDragOverActive:e})};return(0,c.jsx)("div",{onDrop:n=>{n.preventDefault(),o(!1);const s=n.dataTransfer.files[0];(async function(e,t,n,s){var i;if(1!==t.length)return;if("zip"!==(null===(i=t[0].name.split(".").pop())||void 0===i?void 0:i.toLowerCase())){const e=V.default.formatMessage(Ql.invalidFileFormat);throw M.showErrorMessage(e),new A.p8("Invalid file format, please upload it as a zip file")}const{mainEditorCurrentBlockStore:o,currentSpaceStore:a,currentSpaceViewStore:r}=Ge.default.state;if(!a||!r||!o)return;const l=Xl();v.ay(e,{import_source:"genericImporter",from:s,import_type:"file",flowId:l});const d=await Hl.ro({environment:e,pageStore:o,spaceStore:a,spaceViewStore:r,uploadType:"genericImporter",flowId:Xl()},t);d&&(Gl.W(e,{from:"import",type:"page",new_page_id:d.id,creating_block_id:d.id,parent_collection_id:d.getParentCollectionIdUpToTwoLevels()}),n(d))})(t,[s],e.onComplete,e.analyticsFrom).then((()=>{})).catch((()=>{}))},onDragOver:e=>{e.preventDefault(),e.stopPropagation(),o(!0)},onDragLeave:e=>{e.preventDefault(),o(!1)},style:s.divStyle,children:(0,c.jsxs)("div",{style:s.divTitleStyle,children:[(0,c.jsx)(td,{icon:ql.s}),(0,c.jsx)(Ce.Z,{isSecondaryColor:!0,style:s.UiLabelStyle,children:(0,c.jsx)(f.FormattedMessage,{id:"zipImport.dragAndDrop",defaultMessage:"Drag and drop your ZIP files here, or"})}),(0,c.jsx)(_s.Z,{onClick:()=>async function(e,t,n,s){const i=Ge.default.state,{mainEditorCurrentBlockStore:o,currentSpaceStore:a,currentSpaceViewStore:r}=i;if(!a||!r||!o)return;const l=Xl();v.ay(e,{import_source:"genericImporter",from:s,import_type:"file",flowId:l});const d=await Hl.Pv({environment:e,pageStore:o,spaceStore:a,spaceViewStore:r,uploadType:t,flowId:l,allowMultiple:!1});d&&(Gl.W(e,{from:"import",type:"page",new_page_id:d.id,creating_block_id:d.id,parent_collection_id:d.getParentCollectionIdUpToTwoLevels()}),n(d))}(t,"genericImporter",e.onComplete,e.analyticsFrom),style:s.buttonStyle,children:(0,c.jsx)("div",{style:{minWidth:0,width:"100%"},children:(0,c.jsx)("div",{style:{display:"flex"},children:(0,c.jsx)("div",{style:s.titleStyle,children:(0,c.jsx)(f.FormattedMessage,{id:"zipImport.uploadFile",defaultMessage:"Upload from your computer"})})})})})]})})};function Xl(){return He.Z.state.flowId||m.Il()}const ed=20;function td(e){let{icon:t}=e;return(0,c.jsx)("div",{children:t({flexShrink:0,width:ed,height:ed,gap:10})})}const nd=function(e){const t=(0,a.VK)((()=>Ge.default.state),[]),n=(0,a.VK)((()=>rt.Z.state),[]),o=(0,a.VK)((()=>Zr.Z.state),[]),l=(0,a.VK)((()=>Pr.Z.state),[]),{currentSpaceStore:d,mainEditorCurrentBlockStore:u,currentSpaceViewStore:m,currentUserSettingsStore:p}=t,g=(0,i.O7)(),{device:x}=(0,i.O7)(),S=(0,a.VK)((()=>"dark"===g.ThemeStore.state.mode),[g]),[v,b]=(0,s.useState)([]),M=(0,a.VK)((()=>(0,Tr.K6)()),[]),j=(0,s.useCallback)((async()=>{if(null==d||!d.id)return;const e=await I.getActiveImportTasks(g,{spaceId:d.id});"success"===e.type&&b(e.data)}),[d,g]);(0,s.useEffect)((()=>{j().catch((()=>{}));const e=setInterval(j,6e4);return()=>clearInterval(e)}),[d,g,j]),(0,s.useEffect)((()=>{let e;const t=async s=>{const i=await I.getAsanaWorkspacesNames(g,{});if(s+=1,"success"===i.type)if(null!=i&&i.data.account){var o;Zr.Z.setState({...Zr.Z.state,account:i.data.account,workspaces:i.data.workspaces,isLoadingAsanaWorkspaces:!1,isAccountLinkingInProgress:!1,currentTab:"selectData",selectedWorkspace:(null===(o=i.data)||void 0===o||null===(o=o.workspaces[0])||void 0===o?void 0:o.gid)||void 0,isModalOpen:!0})}else{if(s>n)return;e=setTimeout((()=>t(s)),2e3)}},n=180;if(o.isAccountLinkingInProgress){t(0).catch((()=>{}))}return()=>{clearTimeout(e)}}),[o.isAccountLinkingInProgress,g]),(0,Qt.r5)((async()=>{let e;const t=async s=>{var i;const o=await I.getEvernoteAccount(g,{});if(s+=1,"success"===o.type)if(null!=o&&o.data&&null!==(i=o.data)&&void 0!==i&&i.userInfo){Pr.Z.setState({...Pr.Z.state,isFetchingNotebooks:!0,showLoader:!0,linkingAccount:!1});const e=await I.getEvernoteNotebooks(g,{});"success"===e.type&&Pr.Z.setState({...Pr.Z.state,notebooksResponse:e.data,isFetchingNotebooks:!1,showLoader:!1}),Fr.Z.setState({open:!0})}else{if(s>n)return;e=setTimeout((async()=>await t(s)),2e3)}},n=180;if(l.linkingAccount){const e=0;await t(e).catch((()=>{}))}return()=>{clearTimeout(e)}}),[l.linkingAccount,g]);const C=(0,r.yK)((e=>({activeImportAndSyncTitle:{fontSize:y.Z.fontSize.UIRegular.mobile,fontWeight:y.Z.fontWeight.medium,lineHeight:y.Z.lineHeight.UIRegular.mobile},arrowDownIcon:{width:11,height:12,gap:10,radius:3,fill:"#ACABA9"},activeImportsStatusTimeDiv:{display:"flex",alignItems:"center",flexDirection:"row",gap:4}})),[]),w=M?(0,c.jsx)(f.FormattedMessage,{id:"importsTab.activeImportsAndSyncs.title",defaultMessage:"Active imports & syncs"}):(0,c.jsx)(f.FormattedMessage,{id:"importsTab.activeImports.title",defaultMessage:"Active Imports"}),k=e=>{Ir._c({environment:g,store:e,pageVisitSource:Cr.tY.Import}),rt.Z.reset()};return d&&m&&m&&p?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(fe.Z,{large:!x.isMobile||void 0,divider:x.isMobile?void 0:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.title",defaultMessage:"Import data"})}),(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.subtitle",defaultMessage:"Import data from other apps and files into Notion"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,children:e.genericImporterEnabled&&!e.zipImporterEnabled?(0,c.jsx)(f.FormattedMessage,{id:"importsTab.unsupportedImportsHelperTextForUniversalImport",defaultMessage:"If the app you’re using isn’t listed below, try the <boldtext>Universal import</boldtext> ",values:{boldtext:e=>(0,c.jsx)("span",{style:{fontWeight:600},children:e})}}):(0,c.jsx)(f.FormattedMessage,{id:"importsTab.unsupportedImportsHelperText",defaultMessage:"If your data is located somewhere we don't support yet, you can try importing it via CSV file."})}),(0,c.jsxs)("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"},children:[(0,c.jsx)(Al.Z,{pageStore:u,spaceStore:d,spaceViewStore:m,userSettingsStore:p,analyticsFrom:n.openedFrom??"modal",onComplete:k,readOnlyCreditButton:!1}),(0,c.jsx)(_l,{fetchActiveImportTasks:j}),(0,c.jsx)(Wl,{fetchActiveImportTasks:j})]}),e.zipImporterEnabled?(0,c.jsxs)("div",{style:{marginTop:32,width:"752px",gap:10},children:[(0,c.jsx)(Ce.Z,{isSecondaryColor:!0,isMultiline:!0,style:{font:"SF Pro",fontWeight:400,fontSize:14,height:40},children:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.zipImport.title",defaultMessage:"Don’t see the app you use? Import a ZIP file, and Notion will convert DOCX, CSV, Text, Markdown, HTML and EPUB files into Notion pages."})}),(0,c.jsx)(Jl,{onComplete:k,analyticsFrom:n.openedFrom??"modal"})]}):(0,c.jsx)(c.Fragment,{}),(null==v?void 0:v.length)>0?(0,c.jsxs)("div",{style:{marginTop:32},children:[(0,c.jsx)(Ce.Z,{isMultiline:!0,style:C.activeImportAndSyncTitle,children:w}),(0,c.jsx)(Wr.Z,{tableStyle:{borderTop:0},columns:[{key:"importTime",header:(0,c.jsxs)("div",{style:C.activeImportsStatusTimeDiv,children:[(0,c.jsx)(f.FormattedMessage,{id:"importsTab.activeImports.importTime",defaultMessage:"Time"}),(0,kr.M)(C.arrowDownIcon)]})},{key:"importFrom",header:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.activeImports.importFrom",defaultMessage:"From"})},{key:"importStatus",header:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.activeImports.importStatus",defaultMessage:"Status"})}],rows:v.map((e=>({key:`table-${e.taskId}`,columns:[e.startedAt?`${(0,Eo.Yx)(e.startedAt,"long",V.default.getIntl().locale)} ${(0,Eo.Yx)(e.startedAt,"time",V.default.getIntl().locale)}`:"",(0,h.kC)(e.source),(0,c.jsx)(zl.Z,{isRound:!0,showRemoveButton:!1,value:(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"activeImports.status.inProgress",defaultMessage:"In progress"})}),backgroundColor:S?is.FN.dark.blue[200]:is.FN.light.blue[200],showColoredDot:"blue",format:wr.lo.Small,isSingle:!0},`progress-${e.taskId}`)]})))}),v.length?(0,c.jsx)(c.Fragment,{}):(0,c.jsx)(Ce.Z,{isSmall:!0,style:{marginTop:16},children:(0,c.jsx)(f.FormattedMessage,{id:"importsTab.activeImportsTable.noActiveImports",defaultMessage:"There are no ongoing imports associated with your account."})})]}):(0,c.jsx)(c.Fragment,{})]}):(0,c.jsx)(c.Fragment,{})};var sd=n(924211),id=n(192245),od=n(499472),ad=n(423512);const rd="US";function ld(e){var t;return(null==e||null===(t=e.getSettingsStore())||void 0===t||null===(t=t.getKeyStore("regional_format_settings"))||void 0===t?void 0:t.getKeyStore("region").getValue())||rd}function dd(e,t){var n;const s=null==e||null===(n=e.getKeyStore("settings"))||void 0===n||null===(n=n.getKeyStore("regional_format_settings"))||void 0===n?void 0:n.getValue();return"full_date"===t?null!=s&&s.use_default_region_settings?cd(ld(e)):(null==s?void 0:s.full_date)||cd(ld(e)):"short_date"===t?null!=s&&s.use_default_region_settings?{type:"short"}:(null==s?void 0:s.short_date)||{type:"short"}:"number"===t?null!=s&&s.use_default_region_settings?"number":(null==s?void 0:s.number)||"number":"week_start_on"===t?null!=s&&s.use_default_region_settings?"sunday":(null==s?void 0:s.week_start_on)||"sunday":(0,Zn.t1)(t)}function cd(e){return"JP"===e?{type:"short"}:{type:"long"}}const ud={full_date:(0,f.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,f.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,f.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,f.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})},md=(0,f.defineMessages)({full_date:{defaultMessage:"Full date",id:"regionalFormatSettings.defaultSetting.fullDate"},short_date:{defaultMessage:"Short date",id:"regionalFormatSettings.defaultSetting.shortDate"},number:{defaultMessage:"Numbers",id:"regionalFormatSettings.defaultSetting.numbers"},week_start_on:{defaultMessage:"Week starts",id:"regionalFormatSettings.defaultSetting.weekStart"}});function pd(e,t){if("full_date"===t){return ud[t][dd(e,t).type]}if("short_date"===t){return ud[t][dd(e,t).type]}if("number"===t){return ud[t][dd(e,t)]}if("week_start_on"===t){return ud[t][dd(e,t)]}return(0,Zn.t1)(t)}function gd(e,t){return(0,ad.uf)(1234567,e,t)}const fd=(0,f.defineMessages)({sunday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.sunday",defaultMessage:"Sunday"},monday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.monday",defaultMessage:"Monday"}});function hd(e,t){const n=e.type;return"short"===n||"long"===n||"medium"===n?(0,Eo.Yx)(Date.now(),n,(0,sd.E2)(t)):"iso"===n?(0,Eo.$6)(Date.now()):(0,Eo.Yx)(Date.now(),"long",(0,sd.E2)(t))}function yd(e,t){const n=e.type;return"iso"===n?(0,Eo.$6)(Date.now()):"short"===n?(0,Eo.Yx)(Date.now(),n,(0,sd.E2)(t)):(0,Eo.Yx)(Date.now(),"short",(0,sd.E2)(t))}var xd=n(960709),Sd=n(842782);const vd={full_date:(0,f.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,f.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,f.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,f.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})};function bd(e){const[,,t]=(0,a.AF)(void 0,Na.Z),n=(0,r.Fg)(),[s,i]=(0,a.VK)((()=>[e.userSettingsStore.isDefined(),pd(e.userSettingsStore,e.option)]),[e.option,e.userSettingsStore]);return s?(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,buttonPopupStore:t,renderOrigin:e=>(0,c.jsxs)(pn.Z,{...e,children:[V.default.formatMessage(i),(0,Jr.i)({width:10,marginLeft:4,fill:n.lightIconColor})]}),placementToOrigin:xd.Iw.Bottom,alignmentToOrigin:xd.lU.Start,render:t=>"week_start_on"===e.option||"number"===e.option?(0,c.jsx)(Md,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):"full_date"===e.option||"short_date"===e.option?(0,c.jsx)(jd,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):(0,Zn.t1)(e.option)}):(0,c.jsx)(zi.Z,{})}function Md(e){const t=(0,i.O7)(),n=(0,f.useIntl)();return(0,c.jsx)(ps.Z,{menuType:cs.og.Popup,width:216,children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>(0,c.jsx)(ys.Z,{...e,topBorder:0!==e.index}),items:(0,Zn.Yd)(vd[e.option]).map((s=>({key:s,render:t=>{const i="number"===e.option?gd(s,n):void 0;return(0,c.jsx)(ms.Z,{...t,title:V.default.formatMessage(vd[e.option][s]),caption:i})},action:()=>{P.createAndCommit({userAction:"CustomRegionalFormatSettings.SimpleFormatPicker",environment:t,perform:t=>{F.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...e.userSettingsStore.getRegionalFormatSettings(),use_default_region_settings:!1,region:ld(e.userSettingsStore),[e.option]:s}},transaction:t})}}),e.onAccept()}})))}]})})}function jd(e){const t=(0,i.O7)(),[n,o]=(0,s.useState)((()=>{})),a=(0,f.useIntl)(),r=(0,Zn.Yd)(vd[e.option]),l=s=>{const i="custom"===s?{type:s,format:n}:{type:s};P.createAndCommit({userAction:"CustomRegionalFormatSettings.onAction",environment:t,perform:t=>{F.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...e.userSettingsStore.getRegionalFormatSettings(),use_default_region_settings:!1,region:ld(e.userSettingsStore),[e.option]:i}},transaction:t})}}),e.onAccept()};return(0,c.jsx)(ps.Z,{menuType:cs.og.Popup,width:216,children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>(0,c.jsx)(ys.Z,{...e,topBorder:0!==e.index}),items:r.map((t=>({key:t,render:s=>{if("custom"===t)return(0,c.jsx)(Sd.Z,{...s,renderOrigin:n=>(0,c.jsx)(ms.Z,{...n,title:V.default.formatMessage(vd[e.option][t])}),onFocus:()=>{},renderExtension:()=>(0,c.jsx)(Cd,{customFormat:n,onChange:e=>{o(e)},onAccept:()=>{l(t)}}),title:V.default.formatMessage(vd[e.option][t])});{const n="full_date"===e.option?hd({type:t},a):yd({type:t},a);return(0,c.jsx)(ms.Z,{...s,title:V.default.formatMessage(vd[e.option][t]),caption:n})}},action:()=>{l(t)}})))}]})})}function Cd(e){const t=(0,r.yK)((e=>({container:{},label:{color:e.mediumTextColor,fontWeight:y.Z.fontWeight.semibold,paddingTop:6,paddingBottom:6,paddingLeft:14,paddingRight:14},actionButton:{marginTop:6}})),[]);return(0,c.jsxs)("div",{style:t.container,children:[(0,c.jsx)("div",{children:(0,c.jsx)(Ce.Z,{isSmall:!0,style:t.label,children:(0,c.jsx)(f.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.title",defaultMessage:"Custom format"})})}),(0,c.jsx)(ul.ZP,{focus:!0,value:e.customFormat||"",onChange:t=>{e.onChange(t.target.value)}}),(0,c.jsx)(ms.Z,{style:t.actionButton,focused:!1,onClick:e.onAccept,title:(0,c.jsx)(f.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.applyChanges",defaultMessage:"Apply changes"})})]})}function wd(e){const t=(0,r.yK)((()=>({container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]),n=(0,a.VK)((()=>e.userSettingsStore.isReady()),[e.userSettingsStore]),s=(0,a.VK)((()=>e.userSettingsStore.shouldUseDefaultRegionalFormatting()),[e.userSettingsStore]),o=(0,i.O7)();return n?(0,c.jsxs)("div",{style:t.container,children:[(0,c.jsxs)("div",{style:t.controlRow,children:[(0,c.jsxs)("div",{style:t.label,children:[(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"regionalFormatSettings.label.title",defaultMessage:"Use regional defaults"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle,children:(0,c.jsx)(f.FormattedMessage,{id:"regionalFormatSettings.label.subtitle",defaultMessage:"Automatically apply standard formats of your region"})})]}),(0,c.jsx)(al.Z,{on:s,onClick:()=>{P.createAndCommit({userAction:"RegionalFormatSettings.RegionalFormatSettings",environment:o,perform:t=>{const n=s?{use_default_region_settings:!1,full_date:void 0,short_date:void 0,time:void 0,number:void 0,week_start_on:void 0}:{use_default_region_settings:!0};F.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{region:ld(e.userSettingsStore),...n}},transaction:t})}})}})]}),(0,c.jsx)("div",{children:s?(0,c.jsx)(kd,{userSettingsStore:e.userSettingsStore}):(0,c.jsx)(Pd,{userSettingsStore:e.userSettingsStore})})]}):(0,c.jsx)(zi.Z,{})}function kd(e){const t=(0,r.yK)((()=>({container:{marginTop:12}})),[]);return(0,c.jsx)("div",{style:t.container,children:Zd.map((t=>(0,c.jsx)(Id,{userSettingsStore:e.userSettingsStore,option:t},t)))})}function Id(e){const t=(0,r.yK)((e=>({container:{display:"flex"},option:{color:e.lightTextColor,fontSize:y.Z.fontSize.UIRegular.desktop,width:100},example:{color:e.mediumTextColor,fontSize:y.Z.fontSize.UIRegular.desktop}})),[]),n=(0,f.useIntl)(),[s,i]=(0,a.VK)((()=>[e.userSettingsStore.isDefined(),Td(e.userSettingsStore,n,e.option)]),[n,e.option,e.userSettingsStore]);return s?(0,c.jsxs)("div",{style:t.container,children:[(0,c.jsx)("div",{style:t.option,children:V.default.formatMessage(md[e.option])}),(0,c.jsx)("div",{style:t.example,children:i})]}):(0,c.jsx)(zi.Z,{})}function Td(e,t,n){if("full_date"===n){return hd(dd(e,n),t)}if("short_date"===n){return yd(dd(e,n),t)}if("number"===n){return gd(dd(e,n),t)}if("week_start_on"===n){return function(e){return"sunday"===e?V.default.formatMessage(fd.sunday):"monday"===e?V.default.formatMessage(fd.monday):(0,Zn.t1)(e)}(dd(e,n))}return(0,Zn.t1)(n)}const Zd=["full_date","short_date","number","week_start_on"];function Pd(e){return(0,c.jsx)("div",{children:Zd.map((t=>(0,c.jsx)(Fd,{userSettingsStore:e.userSettingsStore,option:t},t)))})}function Fd(e){const t=(0,f.useIntl)(),[n,s,i]=(0,a.VK)((()=>[e.userSettingsStore.isDefined(),ld(e.userSettingsStore),Td(e.userSettingsStore,t,e.option)]),[t,e.option,e.userSettingsStore]),o=(0,r.yK)(_d,[]);return n?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(As.Z,{size:24}),(0,c.jsx)("div",{style:o.container,children:(0,c.jsxs)("div",{style:o.controlRow,children:[(0,c.jsxs)("div",{style:o.label,children:[(0,c.jsx)(Ce.Z,{children:V.default.formatMessage(md[e.option])}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:o.subtitle,children:i})]}),(0,c.jsx)(bd,{userSettingsStore:e.userSettingsStore,region:s,option:e.option})]})})]}):(0,c.jsx)(zi.Z,{})}function _d(){return{container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}}}var Ad=n(780994),Bd=n(158573);function Rd(e){const t=(0,r.yK)((()=>({container:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]);return(0,c.jsxs)("div",{style:t.container,children:[(0,c.jsxs)("div",{style:t.label,children:[(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"regionSettings.region.label",defaultMessage:"Region"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle,children:(0,c.jsx)(f.FormattedMessage,{id:"regionSettings.region.subtitle",defaultMessage:"Affects the default formats for dates, numbers, and currencies"})})]}),(0,c.jsx)(Dd,{userSettingsStore:e.userSettingsStore,onChange:e.onChange,pickerLabel:e.pickerLabel})]})}function Dd(e){const t=(0,r.Fg)(),[,,n]=(0,a.AF)(void 0,Na.Z),i=(0,a.VK)((()=>ld(e.userSettingsStore)),[e.userSettingsStore]),[o,l]=s.useState("");return(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,buttonPopupStore:n,renderOrigin:n=>(0,c.jsxs)(pn.Z,{...n,children:[e.userSettingsStore?i:e.pickerLabel,(0,Jr.i)({width:10,marginLeft:4,fill:t.lightIconColor})]}),placementToOrigin:xd.Iw.Bottom,alignmentToOrigin:xd.lU.Start,render:t=>(0,c.jsx)(ps.Z,{menuType:cs.og.Popup,width:216,header:(0,c.jsx)(Ld,{value:o,onChange:e=>l(e)}),children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:void 0,sections:[{key:"regions",render:e=>(0,c.jsx)(ys.Z,{...e,topBorder:0!==e.index}),items:(0,Bd.ZP)(o,Ad.hW,(e=>e.name)).map((n=>({key:n.countryCode,render:e=>(0,c.jsx)(ms.Z,{...e,title:n.name}),action:()=>{e.onChange(n.countryCode),t.close(),l("")}})))}]})})})}const Od=(0,f.defineMessages)({regionSearchPlaceholder:{defaultMessage:"Search for a region...",id:"settings.regionSettings.regionSearch"}});function Ld(e){return(0,c.jsx)(ys.Z,{isInput:!0,children:(0,c.jsx)(ul.ZP,{value:e.value,onChange:t=>{e.onChange(t.target.value)},focus:!0,placeholder:V.default.formatMessage(Od.regionSearchPlaceholder),focusAfterAnimation:!0})})}var Vd=n(200758),Ed=n(568626),Nd=n(377058),Ud=n(552629);const Kd=function(e){const[t,n]=s.useState([]),[o,l]=s.useState([]),d=(0,i.O7)(),u=(0,a.qz)(void 0,Na.Z),m=(0,r.yK)((e=>({span:{color:e.mediumTextColor},plainButton:{paddingLeft:8,paddingRight:8,marginLeft:-8},icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);function p(e){return o.some((t=>t.code===e.code))}(0,s.useEffect)((()=>{const e=d.SpellCheckStore;e&&!(0,Vd.x)(e)&&(e.getAvailableLanguages().then(n).catch((e=>{Ed.log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getAvailableLanguages",error:(0,Ud.Ui)(e)})})),e.getLanguages().then(l).catch((e=>{Ed.log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getLanguages",error:(0,Ud.Ui)(e)})})))}),[d]),(0,s.useEffect)((()=>{const e=d.SpellCheckStore;if(!e||(0,Vd.x)(e))return;const t=o.map((e=>{let{code:t}=e;return t}));e.setLanguages(t)}),[o,d.SpellCheckStore]);const g=o.length>0?o.slice(0,3).map((e=>{let{name:t}=e;return t})).join(", ")+(o.length>3?"…":""):(0,c.jsx)(f.FormattedMessage,{id:"languageRegionSettings.spellchecker.picker.label",defaultMessage:"Select languages"});return(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,buttonPopupStore:u,renderOrigin:e=>(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(pn.Z,{style:m.plainButton,...e,children:[g,(0,Jr.i)(m.icon)]})}),placementToOrigin:xd.Iw.Bottom,alignmentToOrigin:xd.lU.Start,render:e=>{const n=[{key:"spellcheckerlanguages",render:e=>(0,c.jsx)(ys.Z,{...e,topBorder:0!==e.index}),items:t.map((e=>{const t={key:e.code,render:t=>function(e){const t=e.language.name||e.language.code;return(0,c.jsx)(ms.Z,{...e.props,title:(0,c.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,c.jsx)("div",{style:{marginRight:0},children:t})}),shouldWrapCaption:!0,right:p(e.language)?(0,Nd.$)({width:12,height:12}):void 0})}({language:e,props:t}),action:()=>{p(e)?l(o.filter((t=>t.code!==e.code))):l([...o,e])}};return t}))}],s={menuType:cs.og.Popup,width:240};return(0,c.jsx)(ps.Z,{className:Ke.hKO,...s,children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:void 0,sections:n})})}})};const Wd=function(e){const t=(0,i.O7)();return t.device.isElectron&&t.device.isWindows&&!(0,Vd.x)(t.SpellCheckStore)?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(As.Z,{size:24,isHidden:!0}),(0,c.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto"},children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"languageRegionSettings.spellchecker.label",defaultMessage:"Spellchecker languages"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"},children:(0,c.jsx)(f.FormattedMessage,{id:"languageSettings.spellcheckerSwitcher.subtitle",defaultMessage:"Change the languages used by the spellchecker."})})]}),(0,c.jsx)(Kd,{})]})})]}):null};const zd=function(){return(0,a.VK)((()=>yn.Z.state.online),[])?(0,c.jsx)(Gd,{}):(0,c.jsx)(qd,{})};function qd(){return(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(Ce.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Please go online to manage your language and region.",id:"languageSettings.offline.message"})})})}function Gd(){const e=(0,a.VK)((()=>Ge.default.state.currentUserSettingsStore),[]),t=(0,a.VK)((()=>{var t;return(null==e||null===(t=e.getSettings())||void 0===t?void 0:t.preferred_locale)||sd.al}),[e]),n=(0,a.VK)((()=>"on"===Ie.default.getGroup("aloha")),[]);return e?(0,c.jsxs)(kt.ZP,{children:[(0,c.jsx)(fe.Z,{large:!0,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"languageSettings.languageSection.title",defaultMessage:"Language & region"})}),(0,c.jsx)(od.Z,{locale:t,userSettingsStore:e}),(0,c.jsx)(Wd,{}),(0,c.jsx)(As.Z,{size:24}),n?(0,c.jsxs)("div",{style:{marginTop:12},children:[(0,c.jsx)(Rd,{locale:t,userSettingsStore:e,onChange:e=>{}}),(0,c.jsx)(As.Z,{size:24}),(0,c.jsx)(fe.Z,{large:!0,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"languageSettings.formatsSection.title",defaultMessage:"Formats"})}),(0,c.jsx)(wd,{locale:t,userSettingsStore:e}),(0,c.jsx)(As.Z,{size:24})]}):(0,c.jsx)(id.Z,{})]}):null}var Hd=n(215311),$d=n(128187),Yd=n(421291),Qd=n(451124),Jd=n(597876);function Xd(){const{isElectron:e,isElectronMac:t,isMobile:n,desktopAppId:s}=(0,i.Fy)(),o=(0,i.O7)(),r=(0,a.VK)((()=>yn.Z.state.online),[]),l=(0,a.VK)((()=>(0,$d.oI)()),[]),d=(0,a.VK)((()=>{const i=(0,$d.kC)();return function(e){const{isMobile:t,isElectron:n,isElectronMac:s,desktopAppId:i,slackFeatureGateChecks:{showSlackNotificationSetting:o,showNotionActivityNotificationsToSlackSetting:a}}=e,r=!t&&n,l=r&&s&&Boolean(i);return[{key:"notify_mobile",renderSettingsItem:()=>(0,c.jsx)(Yd.A,{target:"notify_mobile"})},r?{key:"notify_desktop",renderSettingsItem:()=>(0,c.jsx)(Yd.A,{target:"notify_desktop"})}:void 0,l?{key:"desktop_badge",renderSettingsItem:()=>(0,c.jsx)(Yd.A,{target:"desktop_badge"})}:void 0,o&&!a?{key:"notify_slack",renderSettingsItem:()=>(0,c.jsx)(Jd.O,{target:"notify_slack"})}:void 0].filter(Zn.$K)}({isMobile:n,isElectron:e,isElectronMac:t,desktopAppId:s,slackFeatureGateChecks:{showSlackNotificationSetting:i,showNotionActivityNotificationsToSlackSetting:l}})}),[n,e,t,s,l]),u=(0,a.VK)((()=>{var e;const t=(0,$d.kC)();return function(e){const{isSlackNotificationSettingEnabled:t,showSlackNotificationSetting:n,showNotionActivityNotificationsToSlackSetting:s}=e;if(!n||!s)return[];return[{key:"notify_slack",renderSettingsItem:()=>(0,c.jsx)(Jd.O,{target:"notify_slack"})},t?{key:"notify_slack_all_activity",renderSettingsItem:()=>(0,c.jsx)(Jd.O,{target:"notify_slack_all_activity"})}:void 0,t?{key:"notify_slack_mention",renderSettingsItem:()=>(0,c.jsx)(Jd.O,{target:"notify_slack_mention"})}:void 0].filter(Zn.$K)}({isSlackNotificationSettingEnabled:Boolean(null===(e=Ge.default.state.currentSpaceViewStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.notify_slack),showSlackNotificationSetting:t,showNotionActivityNotificationsToSlackSetting:l})}),[l]),m=(0,a.VK)((()=>{var e;return function(e){const{showNotifyEmailAlwaysSetting:t}=e;return[{key:"notify_email",renderSettingsItem:()=>(0,c.jsx)(Yd.A,{target:"notify_email"})},t?{key:"notify_email_always",renderSettingsItem:()=>(0,c.jsx)(Yd.A,{target:"notify_email_always"})}:void 0,{key:"notify_email_digest",renderSettingsItem:()=>(0,c.jsx)(Yd.A,{target:"notify_email_digest"})},{key:"marketing_emails",renderSettingsItem:()=>(0,c.jsx)(Yd.A,{target:"marketing_emails"})}].filter(Zn.$K)}({showNotifyEmailAlwaysSetting:(null===(e=Ge.default.state.currentSpaceViewStore)||void 0===e?void 0:e.getNotifyEmail())||!1})}),[]),p=(0,a.VK)((()=>o.WindowSizeStore.state.paddingBottomCSS),[o.WindowSizeStore]);return r?(0,c.jsxs)(kt.ZP,{disableScroller:n,children:[(0,c.jsx)(fe.Z,{large:!n,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"notificationSettings.notificationsSection.title",defaultMessage:"My notifications"})}),(0,c.jsx)(Qd.O,{items:d}),(0,c.jsx)(As.Z,{size:48,isHidden:!0}),l?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(fe.Z,{large:!n,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"notificationSettings.slackNotificationsSection.title",defaultMessage:"Slack notifications"})}),(0,c.jsx)(Qd.O,{items:u}),(0,c.jsx)(As.Z,{size:48,isHidden:!0})]}):void 0,(0,c.jsx)(fe.Z,{large:!n,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"notificationSettings.emailNotificationsSection.title",defaultMessage:"Email notifications"})}),(0,c.jsx)(Qd.O,{items:m}),(0,c.jsx)(As.Z,{size:48,isHidden:!0}),(0,c.jsx)("div",{style:{marginTop:4,marginBottom:n?p:void 0},children:(0,c.jsx)(Qi.Z,{title:(0,c.jsx)(f.FormattedMessage,{id:"myNotificationSettings.helpButton.caption",defaultMessage:"Learn about notifications"}),href:(0,ze.UY)("guides.notificationSettings"),analyticsFrom:"notifications_settings"})})]}):(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(Ce.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Please go online to manage your notification settings.",id:"myNotificationsSettings.goOnline.prompt"})})})}var ec=n(305851),tc=n(78730),nc=n(598481),sc=n(730120),ic=n(729850),oc=n(875849),ac=n(378168),rc=n(699884),lc=n(195688);const dc=(0,f.defineMessages)({deleteFromTrashLayoutTitle:{defaultMessage:"Auto-delete from Trash",id:"updateRetentionWindowModal.layoutTitle.deleteFromTrash."},deleteFromTrashTitle:{defaultMessage:"Auto-delete from Trash",id:"updateRetentionWindowModal.title.deleteFromTrash"},deleteFromTrashDescription:{defaultMessage:"Customize how long pages stay in Trash before being automatically deleted",id:"updateRetentionWindowModal.description.deleteFromTrash"},deleteFromTrashDefaultOptionTitle:{defaultMessage:"30 days, then delete from Trash",id:"updateRetentionWindowModal.defaultOption.title.deleteFromTrash"},deleteFromTrashDefaultOptionDescription:{defaultMessage:"Pages deleted from Trash are retained for an additional period of time. Retained pages can be restored by workspace owners",id:"updateRetentionWindowModal.defaultOption.description.deleteFromTrash"},deleteFromTrashImmediateEffect:{defaultMessage:"Changing this setting will lead to pages being deleted from Trash immediately. Please type your workspace name to continue",id:"updateRetentionWindowModal.immediateEffect.deleteFromTrash"},purgeLayoutTitle:{defaultMessage:"Retaining deleted pages",id:"updateRetentionWindowModal.layoutTitle.purge"},purgeTitle:{defaultMessage:"Retaining deleted pages",id:"updateRetentionWindowModal.title.purge"},purgeDescription:{defaultMessage:"Pages deleted from Trash are retained for a period of time. Workspace owners can still view and restore them, but members and guests cannot",id:"updateRetentionWindowModal.description.purge"},purgeDefaultOptionTitle:{defaultMessage:"30 days, then permanently delete",id:"updateRetentionWindowModal.defaultOption.title.purge"},purgeDefaultOptionDescription:{defaultMessage:"Pages are removed from Notion's servers and cannot be restored",id:"updateRetentionWindowModal.defaultOption.description.purge"},purgeImmediateEffect:{defaultMessage:"Changing this setting will lead to data loss. Please type your workspace name to continue ",id:"updateRetentionWindowModal.immediateEffect.purge"}});var cc=n(236656);const uc=(0,f.defineMessages)({days:{defaultMessage:"days",id:"customRetentionWindow.relativeDates.days"},years:{defaultMessage:"years",id:"customRetentionWindow.relativeDates.years"}}),mc=(0,f.defineMessages)({inputPlaceholder:{defaultMessage:"...",id:"customRetentionWindow.timeNum.inputPlaceholder"}}),pc=(0,Zn.Yd)(cc.tL).map((e=>({key:e,label:(0,c.jsx)(Ce.Z,{children:V.default.formatMessage(uc[e])})})));function gc(e){const{isDropdownEnabled:t,timeNumString:n,timeUnit:s,setTimeNumString:i,setTimeUnit:o}=e,a=(0,f.useIntl)(),l=(0,r.yK)((e=>({dropdownRow:{display:"flex"},input:{width:70,marginRight:4,marginLeft:6},dropdown:{marginTop:0,marginBottom:0,marginRight:4,borderRadius:4,border:`1px solid ${e.lightDividerColor}`}})),[]);return(0,c.jsxs)("span",{style:l.dropdownRow,children:[(0,c.jsx)(Cs.Z,{style:l.input,value:n,onChange:e=>i(e.target.value),placeholder:a.formatMessage(mc.inputPlaceholder),disabled:!t}),(0,c.jsx)(Ds.L,{buttonStyle:l.dropdown,disabled:!t,type:"dropdown",currentOption:s,options:pc,onSelectOption:e=>t&&o(e),isMobile:!1})]})}const fc=(0,f.defineMessages)({invalidNumber:{defaultMessage:"Please enter a valid number",id:"updateRetentionWindow.error.invalidNumber"},outOfRangeTrash:{defaultMessage:"Pages can't be in Trash for longer than 10 years",id:"updateRetentionWindow.error.outOfRangeTrash"},outOfRangeRetained:{defaultMessage:"Pages can't be retained for longer than 10 years",id:"updateRetentionWindow.error.outOfRangeRetained"}});function hc(e){let{isSelected:t,retentionType:n,hasChosenRetentionWindow:i,currentRetentionWindowInSeconds:o,errorMessage:a,onNextRetentionWindowInSecondsChange:l,onClick:d,setErrorMessage:u,style:m}=e;const p=(0,f.useIntl)(),g=(0,r.yK)((e=>({rowStyles:{display:"flex",fontSize:14,background:t?e.lightBlueBannerBackground:"inherit",...m,alignItems:"flex-start",flexFlow:"column"},centeredRow:{display:"flex",flexFlow:"row",alignItems:"center"},dropdownRow:{marginTop:6},dropdown:{marginTop:0,marginBottom:0,marginRight:4,borderRadius:4,border:`1px solid ${e.lightDividerColor}`},errorMessageStyle:{marginTop:8,width:"100%",display:"flex",paddingLeft:28,color:e.errorText,fontWeight:y.Z.fontWeight.regular}})),[m,t]),[h,x]=(0,s.useState)((0,cc.ln)(o)),[S,v]=(0,s.useState)(`${(0,cc.yR)(o,h)}`),b=Number(S)*cc.tL[h],M=!i&&t;return(0,s.useEffect)((()=>{l(b)}),[l,b]),(0,s.useEffect)((()=>{if(t){if(void 0===S)return void u(p.formatMessage(fc.invalidNumber));const e=parseInt(S);if(isNaN(e)||e.toString()!==S)return void u(p.formatMessage(fc.invalidNumber));const t=cc.tL[h]*e;if(t>cc.GL||t<cc.Of){const e="delete_from_trash"===n?fc.outOfRangeTrash:fc.outOfRangeRetained;return void u(p.formatMessage(e))}u(void 0)}}),[S,h,t,u,p,n]),(0,c.jsxs)(pn.Z,{style:g.rowStyles,onClick:d,children:[(0,c.jsxs)("div",{style:g.centeredRow,children:[(0,c.jsx)(Ao.Z,{isSelected:t}),(0,c.jsx)(Ce.Z,{style:g.centeredRow,children:"delete_from_trash"===n?(0,c.jsx)(f.FormattedMessage,{defaultMessage:"<dropdownpicker></dropdownpicker>, then delete from trash",id:"updateRetentionWindowModal.custom.deleteFromTrash",values:{dropdownpicker:e=>(0,c.jsx)(gc,{isDropdownEnabled:M,timeNumString:S,timeUnit:h,setTimeNumString:v,setTimeUnit:x})}}):(0,c.jsx)(f.FormattedMessage,{defaultMessage:"<dropdownpicker></dropdownpicker>, then permanently delete",id:"updateRetentionWindowModal.custom.permanentlyDelete",values:{dropdownpicker:e=>(0,c.jsx)(gc,{isDropdownEnabled:M,timeNumString:S,timeUnit:h,setTimeNumString:v,setTimeUnit:x})}})})]}),a?(0,c.jsx)(Ce.Z,{style:g.errorMessageStyle,children:a}):null]})}const yc=(0,f.defineMessages)({invalidWorkspaceName:{id:"updateRetentionWindow.error.invalidWorkspaceName",defaultMessage:"Must type in workspace name correctly"}});function xc(e){let{isOpen:t,closeModal:n,currentRetentionWindowInSeconds:o,spaceStore:l,retentionType:d,onSaveRetentionWindow:u}=e;const m=(0,i.O7)(),p=(0,r.yK)((e=>({contentStyle:{display:"flex",flexFlow:"column",alignItems:"center",paddingTop:24,paddingLeft:15,paddingRight:15},headerStyle:{display:"flex",flexFlow:"column",alignItems:"center",marginBottom:16},headerTitleStyle:{fontWeight:y.Z.fontWeight.semibold,fontSize:17,marginBottom:8},headerDescriptionStyle:{width:"100%",textAlign:"center",fontSize:14},defaultOptionStyle:{display:"flex",flexFlow:"column",paddingLeft:8},defaultOptionTitleStyle:{fontSize:13,fontWeight:y.Z.fontWeight.medium},defaultOptionDescriptionStyle:{width:350,fontSize:12,whiteSpace:"normal",lineHeight:"16px",fontWeight:y.Z.fontWeight.regular},iconStyle:{color:e.lightIconColor,width:36,marginBottom:12},saveButtonStyles:{width:"100%",marginBottom:4,marginTop:16},errorMessageStyle:{marginTop:4,color:e.errorText},cancelButtonStyles:{width:"100%",paddingTop:5,paddingBottom:5,display:"flex",justifyContent:"center",marginBottom:16,borderRadius:4},optionStyle:{width:"100%",height:void 0,marginBottom:4,paddingTop:8,paddingBottom:8,fontWeight:y.Z.fontWeight.medium,display:"flex",flexFlow:"row"},confirmationContainerStyle:{marginTop:16,width:"100%",paddingTop:14,paddingBottom:14,padingLeft:14,paddingRight:14,backgroundColor:e.accentColors.red[100],display:"flex",flexFlow:"column",alignItems:"center",borderRadius:4},confirmationDescription:{color:e.accentColors.red[800],fontSize:14,paddingBottom:6},confirmationContentStyle:{width:"90%"}})),[]),g=(0,a.VK)((()=>l.getName()),[l]),h=(0,a.VK)((()=>Ie.default.checkGate({gateName:"cdrr_deletion_enabled"})),[]),[x,S]=(0,s.useState)(void 0),[v,M]=(0,s.useState)(void 0===o),[j,C]=(0,s.useState)(o),w=v?void 0:j,[k,I]=(0,s.useState)(!1),[T,Z]=(0,s.useState)(""),P=w===o||(0,Zn.$K)(x),F=T!==g,_=(0,s.useCallback)((()=>{x||(b.Ym(m,{type:d,value:w}),u(w),Z(""),I(!1),n())}),[m,d,u,w,x,n]),A=(0,s.useCallback)((()=>{k?T===g?_():S(V.default.formatMessage(yc.invalidWorkspaceName)):!function(e){let{nextRetentionWindowValue:t,currentRetentionWindowValue:n,retentionType:s}=e;const i=Sc(n,s),o=Sc(t,s);if(o<i)return!0;return!1}({nextRetentionWindowValue:w,retentionType:d,currentRetentionWindowValue:o})?_():I(!0)}),[k,T,g,w,d,o,_]),B=(0,s.useCallback)((()=>{k||v||(I(!1),M(!0),S(void 0))}),[k,v,I,M,S]),R=(0,s.useCallback)((()=>{k||v&&(I(!1),M(!1))}),[k,v,I,M]),D=function(e){return(0,s.useMemo)((()=>"delete_from_trash"===e?{layoutTitle:dc.deleteFromTrashLayoutTitle,title:dc.deleteFromTrashTitle,description:dc.deleteFromTrashDescription,defaultOptionTitle:dc.deleteFromTrashDefaultOptionTitle,defaultOptionDescription:dc.deleteFromTrashDefaultOptionDescription,immediateEffect:dc.deleteFromTrashImmediateEffect}:"purge"===e?{layoutTitle:dc.purgeLayoutTitle,title:dc.purgeTitle,description:dc.purgeDescription,defaultOptionTitle:dc.purgeDefaultOptionTitle,defaultOptionDescription:dc.purgeDefaultOptionDescription,immediateEffect:dc.purgeImmediateEffect}:void(0,Zn.t1)(e)),[e])}(d);return(0,c.jsx)(rc.c,{isOpen:t,onDismiss:n,areaConstraint:{width:{type:"max",length:460}},render:e=>{let{displayMode:t}=e;return(0,c.jsx)(lc.a,{displayMode:t,title:(0,c.jsx)(f.FormattedMessage,{...D.layoutTitle}),children:(0,c.jsxs)("div",{style:p.contentStyle,children:[(0,c.jsxs)("div",{style:p.headerStyle,children:[(0,c.jsx)("div",{children:(0,yi.y)(p.iconStyle)}),(0,c.jsx)(Ce.Z,{style:p.headerTitleStyle,children:(0,c.jsx)(f.FormattedMessage,{...D.title})}),(0,c.jsx)(Ce.Z,{style:p.headerDescriptionStyle,isSecondaryColor:!0,isMultiline:!0,children:(0,c.jsx)(f.FormattedMessage,{...D.description})})]}),(0,c.jsxs)(pn.Z,{style:p.optionStyle,onClick:B,children:[(0,c.jsx)(Ao.Z,{isSelected:v}),(0,c.jsxs)("div",{style:p.defaultOptionStyle,children:[(0,c.jsx)(Ce.Z,{style:p.defaultOptionTitleStyle,children:(0,c.jsx)(f.FormattedMessage,{...D.defaultOptionTitle})}),(0,c.jsx)(Ce.Z,{isSecondaryColor:!0,isMultiline:!0,style:p.defaultOptionDescriptionStyle,children:(0,c.jsx)(f.FormattedMessage,{...D.defaultOptionDescription})})]})]}),(0,c.jsx)(hc,{style:p.optionStyle,isSelected:!v,retentionType:d,hasChosenRetentionWindow:k,currentRetentionWindowInSeconds:o,errorMessage:x,onClick:R,onNextRetentionWindowInSecondsChange:C,setErrorMessage:S}),k?(0,c.jsxs)("div",{style:p.confirmationContainerStyle,children:[(0,c.jsx)(Ce.Z,{isMultiline:!0,style:{...p.confirmationContentStyle,...p.confirmationDescription},children:(0,c.jsx)(f.FormattedMessage,{...D.immediateEffect})}),(0,c.jsx)(Cs.Z,{style:p.confirmationContentStyle,value:T,placeholder:g,onChange:e=>Z(e.target.value)})]}):null,(0,c.jsx)(Bs.Z,{onClick:h?A:_,disabled:k?F:P,style:p.saveButtonStyles,isLarge:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"updateRetentionWindowModal.save",defaultMessage:"Save"})}),(0,c.jsx)(_s.Z,{onClick:n,style:p.cancelButtonStyles,children:(0,c.jsx)(Ce.Z,{isSecondaryColor:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"updateRetentionWindowModal.cancel",defaultMessage:"Cancel"})})})]})})}})}function Sc(e,t){return e||("delete_from_trash"===t?ac.A7:ac.vF)}function vc(e){const{spaceStore:t}=e,n=(0,i.O7)(),o=(0,f.useIntl)(),d=(0,r.yK)((e=>({genericSetting:{width:"100%",paddingTop:24},settingItem:{display:"flex",alignItems:"center"},currentSettingLabel:{fontWeight:y.Z.fontWeight.medium},changeButtonStyle:{fontSize:12,marginLeft:8},lockIconStyle:{color:e.lightTextColor,width:20,marginLeft:4}})),[]),u=(0,a.VK)((()=>!Ie.default.checkGate({gateName:"cdrr_deletion_enabled"})),[]),m=(0,a.VK)((()=>(0,bt.wP)()),[]),[p,g]=s.useState({isOpen:!1,retentionType:"delete_from_trash"}),{saveDeleteFromTrashDelay:h,savePurgeDelay:x}=function(e){let{environment:t,spaceStore:n}=e;return{saveDeleteFromTrashDelay:(0,s.useCallback)((e=>{P.createAndCommit({userAction:"securitySettingsActions.saveDataRetentionSettings",environment:t,perform:t=>{P.applyOperation({store:n,operation:{pointer:n.pointer,path:["settings"],command:"update",args:{delete_from_trash_delay_seconds:e??null}},transaction:t})}})}),[n,t]),savePurgeDelay:(0,s.useCallback)((e=>{P.createAndCommit({userAction:"securitySettingsActions.saveDataRetentionSettings",environment:t,perform:t=>{P.applyOperation({store:n,operation:{pointer:n.pointer,path:["settings"],command:"update",args:{purge_delay_seconds:e??null}},transaction:t})}})}),[n,t])}}({environment:n,spaceStore:t}),{currentDeleteFromTrashDelayInSeconds:S,currentPurgeDelayInSeconds:v}=(0,a.VK)((()=>({currentDeleteFromTrashDelayInSeconds:t.getSettings().delete_from_trash_delay_seconds,currentPurgeDelayInSeconds:t.getSettings().purge_delay_seconds})),[t]);return(0,c.jsxs)("div",{children:[p.isOpen&&(0,c.jsx)(xc,{isOpen:p.isOpen,closeModal:()=>g({...p,isOpen:!1}),spaceStore:t,currentRetentionWindowInSeconds:p.currentRetentionWindowInSeconds,retentionType:p.retentionType,onSaveRetentionWindow:"delete_from_trash"===p.retentionType?h:x}),(0,c.jsx)(bc,{isDataRetentionAvailableOnTier:m,isDeletionDisabled:u}),(0,c.jsx)(oo.N,{style:d.genericSetting,title:(0,c.jsx)(f.FormattedMessage,{id:"securitySettings.dataRetention.deleteFromTrash.title",defaultMessage:"Delete pages moved to Trash after"}),byline:(0,c.jsx)(f.FormattedMessage,{id:"securitySettings.dataRetention.deletedFromTrash.byline",defaultMessage:"Anyone with edit or full access will be able to restore or manually delete pages in Trash"}),settingItem:(0,c.jsxs)("div",{style:d.settingItem,children:[(0,c.jsx)(Ce.Z,{style:d.currentSettingLabel,children:(0,c.jsx)(f.FormattedMessage,{id:"securitySettings.dataRetention.deleteFromTrash.currentSetting",defaultMessage:"{duration} then delete",values:{duration:(0,cc.uP)(S,o)}})}),m?(0,c.jsx)(yt.Z,{disabled:!1,style:d.changeButtonStyle,onClick:()=>g({isOpen:!0,retentionType:"delete_from_trash",currentRetentionWindowInSeconds:S}),children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Change",id:"securitySettings.dataRetention.deleteFromTrash.button"})}):(0,c.jsx)("div",{children:(0,l.Q)(d.lockIconStyle)})]})}),(0,c.jsx)(oo.N,{style:d.genericSetting,title:(0,c.jsx)(f.FormattedMessage,{id:"securitySettings.dataRetention.purge.title",defaultMessage:"After pages are deleted from Trash, retain them for"}),byline:(0,c.jsx)(f.FormattedMessage,{id:"securitySettings.dataRetention.purge.byline",defaultMessage:"During the retention period, only workspace owners can view or restore the page from Content search. After the retention period, the page will be permanently deleted from Notion's servers"}),settingItem:(0,c.jsxs)("div",{style:d.settingItem,children:[(0,c.jsx)(Ce.Z,{style:d.currentSettingLabel,children:(0,c.jsx)(f.FormattedMessage,{id:"securitySettings.dataRetention.purge.currentSetting",defaultMessage:"{duration}",values:{duration:(0,cc.uP)(v,o)}})}),m?(0,c.jsx)(yt.Z,{disabled:!1,style:d.changeButtonStyle,onClick:()=>g({isOpen:!0,retentionType:"purge",currentRetentionWindowInSeconds:v}),children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Change",id:"securitySettings.dataRetention.purge.button"})}):(0,c.jsx)("div",{children:(0,l.Q)(d.lockIconStyle)})]})})]})}function bc(e){const{isDataRetentionAvailableOnTier:t,isDeletionDisabled:n}=e,s=(0,r.yK)((e=>({bannerStyle:{borderRadius:4,padding:15,width:"100%",backgroundColor:e.lightBlueBannerBackground,flexFlow:t?"column":"row",display:"flex"},bannerLabelStyle:{marginBottom:8},bannerImage:{width:75,display:"flex",alignItems:"center",paddingRight:15},bannerTitleBold:{fontWeight:y.Z.fontWeight.bold},b:{fontWeight:y.Z.fontWeight.medium},helpIcon:{fill:"inherit"}})),[t]),o=(0,i.O7)();return t?(0,c.jsxs)("div",{style:s.bannerStyle,children:[(0,c.jsx)(Ce.Z,{style:s.bannerLabelStyle,children:(0,c.jsx)(f.FormattedMessage,{id:"securitySettings.dataRetention.disclaimer.title",defaultMessage:"How page deletion and retention works in Notion"})}),(0,c.jsx)(Ce.Z,{style:s.bannerLabelStyle,isMultiline:!0,isSmall:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"securitySettings.dataRetention.disclaimer.description",defaultMessage:"A page can be moved to Trash by anyone with edit or full access. From there, the page can be restored or deleted. Workspace owners can customize whether pages in Trash are automatically deleted after a period of time, and how long deleted pages are retained on Notion's servers."})}),n?(0,c.jsx)(Ce.Z,{style:s.bannerLabelStyle,isMultiline:!0,isSmall:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"securitySettings.dataRetention.disclaimer.juneWarning",defaultMessage:"<b>The settings below will go into effect on {localizedDate}</b>",values:{localizedDate:ic.l.toLocaleString(sc.ou.DATE_FULL),b:e=>(0,c.jsx)("b",{style:s.b,children:e})}})}):null," ",(0,c.jsx)(Qi.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Learn more about data retention in Notion",id:"securitySettings.dataRetention.learnMore"}),iconStyle:s.helpIcon,href:(0,ze.UY)("guides.customDataRetentionRules"),analyticsFrom:"security_settings"})]}):(0,c.jsxs)("div",{style:s.bannerStyle,children:[(0,c.jsx)("div",{style:s.bannerImage,children:(0,c.jsx)(oc.q,{product:"enterprise"})}),(0,c.jsxs)("div",{children:[(0,c.jsx)(Ce.Z,{style:{...s.bannerLabelStyle,...s.bannerTitleBold},children:(0,c.jsx)(f.FormattedMessage,{id:"securitySettings.dataRetention.upsell.title",defaultMessage:"Upgrade to the Enterprise plan to customize your workspace’s data retention policy"})}),(0,c.jsx)(Ce.Z,{style:s.bannerLabelStyle,isMultiline:!0,isSecondaryColor:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"securitySettings.dataRetention.upsell.description",defaultMessage:"Workspaces on the Enterprise plan also get SAML SSO, custom guest limits, audit logging, and other advanced security controls"})}),(0,c.jsx)(Bs.Z,{onClick:()=>{(0,xt.y)(o,{from:"space_settings_cdrr_settings",for:"enterprise"})},isLarge:!0,children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Upgrade to Enterprise",id:"securitySettings.upgradeButton.text"})})]})]})}var Mc=n(64404),jc=n(601564),Cc=function(e){return e[e.Keep=0]="Keep",e[e.Remove=1]="Remove",e}(Cc||{});function wc(e){return(0,c.jsx)(Hs.Z,{open:e.isOpen,onDismiss:e.onDismiss,render:()=>(0,c.jsx)(kc,{...e})})}function kc(e){const{onDismiss:t,onSave:n,guestCount:i}=e,[o,a]=(0,s.useState)(Cc.Keep),l=(0,r.yK)((e=>({container:{width:350,padding:30,borderRadius:5,height:400,alignItems:"center"},title:{fontFamily:y.Z.getCompositeFontFamily(Po.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:y.Z.getCompositeFontFamily(Po.SP).sans,fontSize:14,fontWeight:300,lineHeight:"19px",margin:10,textAlign:"center"},radioContainer:{display:"flex",flexDirection:"column"},button:{justifyContent:"space-between",marginTop:10,height:70,borderRadius:5},buttonText:{display:"flex",flexDirection:"column"},optionSubtitle:{whiteSpace:"break-spaces"},actionButtonsContainer:{display:"flex",flexDirection:"column",marginTop:20},cancelButton:{justifyContent:"center",margin:"8px auto 0"}})),[]),d=(0,s.useCallback)((()=>{const e=o===Cc.Keep;n(e)}),[n,o]);return(0,c.jsxs)("div",{style:l.container,children:[(0,c.jsx)(Ce.Z,{style:l.title,children:(0,c.jsx)(f.FormattedMessage,{id:"disableGuestsConfig.title",defaultMessage:"Disable inviting guests?"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,style:l.subtitle,isMultiline:!0,children:(0,Zn.$K)(i)?(0,c.jsx)(f.FormattedMessage,{id:"disableGuestsConfig.description",defaultMessage:"Your workspace currently has {guestCount, plural, one {1 guest} other {{guestCount} guests}}. You can choose to:",values:{guestCount:i}}):(0,c.jsx)(f.FormattedMessage,{id:"disableGuestsConfig.description.noGuestCount",defaultMessage:"You are turning off guests in this workspace. You can choose to:"})}),(0,c.jsxs)("div",{style:l.radioContainer,children:[(0,c.jsxs)(yt.Z,{isLarge:!0,onClick:()=>a(Cc.Keep),style:l.button,children:[(0,c.jsx)(Ao.Z,{isSelected:o===Cc.Keep}),(0,c.jsxs)("div",{style:l.buttonText,children:[(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"disableGuestsConfig.keepExistingGuests.title",defaultMessage:"Keep existing guests"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:l.optionSubtitle,children:(0,c.jsx)(f.FormattedMessage,{id:"disableGuestsConfig.keepExistingGuests.description",defaultMessage:"Guests will still be able to access the pages they've been invited to"})})]})]}),(0,c.jsxs)(yt.Z,{isLarge:!0,onClick:()=>a(Cc.Remove),style:l.button,children:[(0,c.jsx)(Ao.Z,{isSelected:o===Cc.Remove}),(0,c.jsxs)("div",{style:l.buttonText,children:[(0,c.jsx)(Ce.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"disableGuestsConfig.removeExistingGuests.title",defaultMessage:"Remove existing guests"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:l.optionSubtitle,children:(0,c.jsx)(f.FormattedMessage,{id:"disableGuestsConfig.removeExistingGuests.description",defaultMessage:"All guests will be removed from your workspace"})})]})]})]}),(0,c.jsxs)("div",{style:l.actionButtonsContainer,children:[(0,c.jsx)(Bs.Z,{isLarge:!0,onClick:d,children:(0,c.jsx)(f.FormattedMessage,{id:"disableGuestsModal.saveChanges",defaultMessage:"Disable inviting guests"})}),(0,c.jsx)(pn.Z,{onClick:t,style:l.cancelButton,children:(0,c.jsx)(f.FormattedMessage,{id:"disableGuestsModal.cancel",defaultMessage:"Cancel"})})]})]})}var Ic=n(364768);const Tc={security:(0,c.jsx)(f.FormattedMessage,{id:"securityTabs.security.title",defaultMessage:"Security"}),data_retention:(0,c.jsx)(f.FormattedMessage,{id:"securityTabs.dataRetention.title",defaultMessage:"Data retention"})},Zc=(0,Zn.Yd)(Tc),Pc=Zc.map((e=>Tc[e])),Fc=.5;const _c=function(e){let{securitySettingsStore:t,spaceStore:n,organizationOverrides:o}=e;const l=(0,i.O7)(),d=(0,r.yK)((()=>({tabMenu:{marginBottom:24}})),[]),u=(0,a.VK)((()=>yn.Z.state.online),[]),m=(0,a.VK)((()=>(0,bt.wP)()&&Ie.default.checkGate({gateName:"cdrr_workspace_settings"})||Ie.default.checkGate({gateName:"cdrr_deletion_enabled"})),[]),p=(0,a.VK)((()=>rt.Z.getState().defaultSubtab),[]),[g,h]=(0,s.useState)((()=>p&&Zc.includes(p)?Zc.indexOf(p):0)),y=(0,s.useCallback)((e=>{b.kA(l,{tab:Zc[e]}),h(e)}),[h,l]);return u?(0,c.jsx)(kt.ZP,{children:(0,c.jsxs)("div",{children:[m?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(fe.Z,{large:!0,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"securitySettings.securityAndData.title",defaultMessage:"Security & data"})}),(0,c.jsx)(Os.Z,{tabs:Pc,selectedIndex:g,onChange:y,style:d.tabMenu})]}):null,0!==g&&m?(0,c.jsx)(vc,{spaceStore:n}):(0,c.jsx)($c,{securitySettingsStore:t,spaceStore:n,organizationOverrides:o})]})}):(0,c.jsx)(Ac,{})};function Ac(){return(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Please go online to manage security settings.",id:"securitySAMLSettings.offline.message"})})})}function Bc(e,t,n,s){ec.y(s,{spaceStore:n,securitySettingsStore:t,fields:e})}function Rc(e){return{fontWeight:y.Z.fontWeight.medium,fontSize:18,borderBottom:`1px solid ${e.regularDividerColor}`,paddingBottom:6,marginBottom:12,display:"flex",alignItems:"center"}}function Dc(){const e=(0,r.Fg)(),t=(0,i.O7)(),n=(0,a.VK)((()=>(0,nc.J)({environment:t})),[t]),s=(0,a.VK)((()=>(0,bt.Rs)()),[]);return n?null:(0,c.jsxs)("div",{style:{border:`1px solid ${e.regularDividerColor}`,borderRadius:4,padding:16,marginTop:void 0,marginBottom:24},children:[!s&&(0,c.jsx)(jc.Z,{subscriptionTier:"business",from:"space_saml",upgradeMessage:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.upsell.button.business",defaultMessage:"Upgrade to Business"}),title:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.upsell.title.business",defaultMessage:"Upgrade for SAML SSO & more admin tools"}),caption:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.upsell.caption.business",defaultMessage:"The Business Plan includes single sign-on to manage employee access at scale, private teamspaces to collaborate on sensitive docs, and more."}),learnMoreRoute:"guides.securitySettings",style:{marginBottom:"20px"}}),(0,c.jsx)(jc.Z,{subscriptionTier:"enterprise",from:"space_saml",upgradeMessage:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.upsell.button.enterprise",defaultMessage:"Upgrade to Enterprise"}),title:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.upsell.title.enterprise",defaultMessage:"Upgrade for SCIM, advanced security & more"}),caption:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.upsell.caption.enterprise",defaultMessage:"The Enterprise Plan allows you to automatically provision users and groups, and gain more visibility and controls across the workspace."}),learnMoreRoute:"guides.securitySettings"})]})}function Oc(e,t){const{subscriptionTier:n="enterprise"}=t||{};xt.y(e,{from:"space_saml",for:n})}function Lc(e,t,n,s){const{name:i,isToggleEnabled:o,showUpgradeIfDisabled:a}=e;if(!o)return a?Oc(s):void 0;Bc({[i]:!t.state[i]},t,n,s)}function Vc(e){let{style:t,subscriptionTier:n="enterprise"}=e;const s=(0,i.O7)();return(0,c.jsx)(ao.Z,{subscriptionTier:n,analyticsName:"space_saml",onClick:()=>Oc(s,{subscriptionTier:n}),desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3,...t}})}function Ec(e){let{requestTogglesAvailableForTier:t,spaceStore:n,securitySettingsStore:s,organizationOverrides:o}=e;const r=(0,i.O7)(),l=(0,a.VK)((()=>(0,tc.U)(n,r)),[n,r]),d=(0,a.VK)((()=>(0,we.Or)()),[]),u=(0,a.VK)((()=>t&&!Boolean(s.state.disableMembershipRequests)),[t,s]),m=(0,a.VK)((()=>t&&!Boolean(s.state.disableExternalMembershipRequests)),[t,s]),p=(0,a.VK)((()=>t&&!Boolean(s.state.disableGuestMembershipRequests)),[t,s]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ic.dy,{environment:r,toggleOn:u,onClick:()=>Lc({name:"disableMembershipRequests",isToggleEnabled:t,showUpgradeIfDisabled:!1},s,n,r),isReadOnly:!1,upsellOrigin:"space_saml",style:{marginBottom:24},shouldShowUpsell:!t,isControlledByOrganization:Boolean(o.disable_membership_requests)}),d&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(Ic.ms,{environment:r,toggleOn:m,onClick:()=>Lc({name:"disableExternalMembershipRequests",isToggleEnabled:t,showUpgradeIfDisabled:!1},s,n,r),isReadOnly:!1,upsellOrigin:"space_saml",style:{marginBottom:24},shouldShowUpsell:!t,isControlledByOrganization:Boolean(o.disable_external_membership_requests)})}),l&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(Ic.Xr,{environment:r,toggleOn:p,onClick:()=>Lc({name:"disableGuestMembershipRequests",isToggleEnabled:t,showUpgradeIfDisabled:!1},s,n,r),isReadOnly:!1,upsellOrigin:"space_saml",style:{marginBottom:24},shouldShowUpsell:!t,isControlledByOrganization:Boolean(o.disable_guest_membership_requests)})})]})}function Nc(e){let{toggleAvailableForTier:t,guestCount:n,securitySettingsStore:s,spaceStore:o,publicAccessRequestsExpEnabled:r,isControlledByOrganization:l}=e;const d=(0,i.O7)(),u=(0,a.VK)((()=>s.state),[s]),m=(0,a.VK)((()=>!t||r&&!s.state.disablePublicAccessRequests),[t,s,r]),p=(0,a.VK)((()=>t?m||l?()=>{}:()=>async function(e,t,n){const s=e.state.disableGuests,i=e.state.enableGuestInviteRequests;if(s)Bc({disableGuests:!s,...i&&{enableGuestInviteRequests:!i}},e,t,n);else{if(Ie.default.checkGate({gateName:"show_keep_existing_guests_modal"}))return void e.setState({...e.state,disableGuestsModalOpen:!0});if(!(await M.confirmUserAction({message:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.message",defaultMessage:"Are you sure? All guests in this workspace will be removed."}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return;Bc({disableGuests:!s},e,t,n)}}(s,o,d):()=>Oc(d)),[d,t,s,o,m,l]);return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.guestsSection.disableGuests.label",defaultMessage:"Disable members inviting guests to pages"}),!t&&(0,c.jsx)(Vc,{}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.guestsSection.disableGuests.caption",defaultMessage:"Your workspace currently has <gueststablink> {guestCount, plural, one {1 guest} other {{guestCount} guests}}</gueststablink>",values:{gueststablink:e=>(0,c.jsx)(Rs.Z,{onClick:()=>{Si.jk(d,{source_tab:rt.Z.state.currentTab,destination_tab:"members",destination_subtab:Mc.Q.Guests}),rt.Z.setState({...rt.Z.state,currentTab:"members",defaultSubtab:Mc.Q.Guests})},children:e}),guestCount:n}})})]}),(0,c.jsx)("div",{onClick:p,style:{marginTop:5,opacity:m?Fc:void 0},children:(0,c.jsx)(al.Z,{on:u.disableGuests,disabled:m,isLocked:l,lockedTooltip:(0,$n.g)()})})]}),(0,c.jsx)(As.Z,{size:24,style:{opacity:0}}),(0,c.jsx)(wc,{isOpen:Boolean(u.disableGuestsModalOpen),onDismiss:()=>{s.setState({...s.state,disableGuestsModalOpen:!1})},onSave:e=>{Bc({disableGuests:!0,keepExistingGuests:e},s,o,d),s.setState({...s.state,disableGuestsModalOpen:!1})},guestCount:n})]})}function Uc(e){let{toggleAvailableForTier:t,securitySettingsStore:n,spaceStore:s,publicAccessRequestsExpEnabled:o,isControlledByOrganization:r}=e;const l=(0,i.O7)(),d=(0,a.VK)((()=>!t||!n.state.disableGuests||o&&!n.state.disablePublicAccessRequests),[n,t,o]),u=(0,a.VK)((()=>t&&d?()=>{}:()=>{r||Lc({name:"enableGuestInviteRequests",isToggleEnabled:t,showUpgradeIfDisabled:!0},n,s,l)}),[l,t,n,s,d,r]),m=(0,a.VK)((()=>(0,we.p1)()),[]),p=(0,a.VK)((()=>!t||n.state.disableGuests),[n,t]);return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.label",defaultMessage:"Allow members to request adding guests"}),t&&(0,c.jsx)(Qi.Z,{style:{marginLeft:0},href:(0,ze.UY)("guides.guestRequests"),analyticsFrom:"space_saml"}),!t&&(0,c.jsx)(Vc,{style:{marginTop:0}})]}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.caption",defaultMessage:"{hasRequestTab, select, true {Requests must be approved by a workspace owner. You can view all requests <requeststablink>here</requeststablink>} other {Requests must be approved by a workspace owner}}",values:{hasRequestTab:m,requeststablink:e=>(0,c.jsx)(Rs.Z,{onClick:()=>{Si.jk(l,{source_tab:rt.Z.state.currentTab,destination_tab:"members",destination_subtab:Mc.Q.Requests}),rt.Z.setState({...rt.Z.state,currentTab:"members",defaultSubtab:Mc.Q.Requests})},children:e})}})})]}),(0,c.jsx)(je.Z,{render:e=>(0,c.jsx)("div",{onClick:u,style:{marginTop:5,opacity:d?Fc:void 0},...e,children:(0,c.jsx)(al.Z,{on:n.state.enableGuestInviteRequests,disabled:d,isLocked:r,lockedTooltip:(0,$n.g)()})}),renderTooltip:()=>(0,c.jsx)("div",{style:{},children:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.disabled.label",defaultMessage:"Disable inviting guests to use this feature"})}),disableTooltip:p,placement:ke.u.Top})]}),(0,c.jsx)(As.Z,{size:24,style:{opacity:0}})]})}function Kc(e){let{disableGuestsAvailableForTier:t,enableGuestInviteRequestAvailableForTier:n,enableExternalAccessRequestSettingForTier:s,securitySettingsStore:i,spaceStore:o,organizationOverrides:r}=e;const l=(0,a.VK)((()=>Ht.subscriptionDataStoreInstance.state),[]),d=(0,a.VK)((()=>(0,we.p1)()),[]),u=(0,a.VK)((()=>Ie.default.checkGate({gateName:"allow_public_page_access_request",disableExposureLogging:!0})),[]);if(!l)return(0,c.jsx)(zi.Z,{});const m=Gt.CM(l).filter(qn.FN).filter((e=>!e.isTeamGuest&&e.isPageGuest)).length;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(fe.Z,{large:!0,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.guestsSection.title",defaultMessage:"Inviting members & guests"})}),(0,c.jsx)(Hc,{spaceStore:o,securitySettingsStore:i,toggleAvailableForTier:s,publicAccessRequestsExpEnabled:u}),(0,c.jsx)(Nc,{securitySettingsStore:i,spaceStore:o,toggleAvailableForTier:t,guestCount:m,publicAccessRequestsExpEnabled:u,isControlledByOrganization:Boolean(r.disable_guests)}),(0,c.jsx)(Uc,{securitySettingsStore:i,spaceStore:o,toggleAvailableForTier:n,publicAccessRequestsExpEnabled:u,isControlledByOrganization:Boolean(r.enable_guest_invite_requests)}),(0,c.jsx)(Ec,{spaceStore:o,securitySettingsStore:i,requestTogglesAvailableForTier:d,organizationOverrides:r})]})}function Wc(e){let{enable:t,featureUpsellButton:n,securitySettingsStore:s,spaceStore:o,isControlledByOrganization:r}=e;const l=(0,i.O7)(),d=(0,a.VK)((()=>s.state.disablePublicAccess),[s]);return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:t?()=>{r||async function(e,t,n){const s=e.state.disablePublicAccess;if(!s&&!(await M.confirmUserAction({message:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.message",defaultMessage:"Are you sure? This will remove access for anyone who is not a member or guest of the workspace from all pages in this workspace."}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return;Bc({disablePublicAccess:!s},e,t,n)}(s,o,l)}:()=>Oc(l),children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.label",defaultMessage:"Disable public page sharing"}),!t&&n,(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.caption",defaultMessage:"Disable the Share to web option in the Share menu on every page in this workspace."})})]}),(0,c.jsx)("div",{style:{marginTop:5,opacity:t?void 0:Fc},children:(0,c.jsx)(al.Z,{on:d,disabled:!t,isLocked:r,lockedTooltip:(0,$n.g)()})})]}),(0,c.jsx)(As.Z,{size:24,style:{opacity:0}})]})}function zc(e){let{enable:t,featureUpsellButton:n,securitySettingsStore:s,spaceStore:o}=e;const r=(0,i.O7)(),l=(0,a.VK)((()=>s.state.disableSpacePageEdits),[s]);return(0,a.VK)((()=>(0,qe.bq)()),[])?null:(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>Lc({name:"disableSpacePageEdits",isToggleEnabled:t,showUpgradeIfDisabled:!0},s,o,r),children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.label",defaultMessage:"Prevent members from editing the Workspace section"}),!t&&n,(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"},children:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.caption",defaultMessage:"Disable the ability for members to create, move, reorder, and delete top-level Workspace pages."})})]}),(0,c.jsx)("div",{style:{marginTop:5,opacity:t?void 0:Fc},children:(0,c.jsx)(al.Z,{on:l,disabled:!t})})]}),(0,c.jsx)(As.Z,{size:24,style:{opacity:0}})]})}function qc(e){let{enable:t,spaceStore:n,securitySettingsStore:s,featureUpsellButton:o,isControlledByOrganization:r}=e;const l=(0,i.O7)(),d=(0,a.VK)((()=>s.state.disableMoveToSpace),[s]);return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>{r||Lc({name:"disableMoveToSpace",isToggleEnabled:t,showUpgradeIfDisabled:!0},s,n,l)},children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.label",defaultMessage:"Disable duplicating pages to other workspaces"}),!t&&o,(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.caption",defaultMessage:"Prevent anyone from duplicating pages to other workspaces via the Move To or Duplicate To actions."})})]}),(0,c.jsx)("div",{style:{marginTop:5,opacity:t?void 0:Fc},children:(0,c.jsx)(al.Z,{on:d,disabled:!t,isLocked:r,lockedTooltip:(0,$n.g)()})})]}),(0,c.jsx)(As.Z,{size:24,style:{opacity:0}})]})}function Gc(e){let{enable:t,securitySettingsStore:n,spaceStore:s,featureUpsellButton:o,isControlledByOrganization:r}=e;const l=(0,i.O7)(),d=(0,a.VK)((()=>n.state.disableExport),[n]);return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>{r||Lc({name:"disableExport",isToggleEnabled:t,showUpgradeIfDisabled:!0},n,s,l)},children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.label",defaultMessage:"Disable export"}),!t&&o,(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.caption",defaultMessage:"Prevent anyone from exporting as Markdown, CSV, or PDF."})})]}),(0,c.jsx)("div",{style:{marginTop:5,opacity:t?void 0:Fc},children:(0,c.jsx)(al.Z,{on:d,disabled:!t||r,isLocked:r,lockedTooltip:(0,$n.g)()})})]}),(0,c.jsx)(As.Z,{size:24,style:{opacity:0}})]})}function Hc(e){let{securitySettingsStore:t,spaceStore:n,publicAccessRequestsExpEnabled:s,toggleAvailableForTier:o,isControlledByOrganization:r}=e;const l=(0,i.O7)(),d=(0,a.VK)((()=>t.state.disablePublicAccessRequests),[t]),u=(0,a.VK)((()=>{if(!o)return()=>Oc(l,{subscriptionTier:"plus"});const e=!t.state.disablePublicAccessRequests,s=!e;return()=>{r||Bc({disablePublicAccessRequests:e,...s&&{disableGuests:!1,enableGuestInviteRequests:!1}},t,n,l)}}),[l,n,t,o,r]);return s?(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:u,children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disablePublicAccessRequests.label",defaultMessage:"Allow page access requests from non-members"}),!o&&(0,c.jsx)(Vc,{subscriptionTier:"plus"}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disablePublicAccessRequests.caption",defaultMessage:"This allows anyone with the link to a page to request access. Workspace members can always request access."})})]}),(0,c.jsx)("div",{style:{marginTop:5,opacity:o?void 0:Fc},children:(0,c.jsx)(al.Z,{on:!d,disabled:!o,isLocked:r,lockedTooltip:(0,$n.g)()})})]}),(0,c.jsx)(As.Z,{size:24,style:{opacity:0}})]}):null}function $c(e){let{securitySettingsStore:t,spaceStore:n,organizationOverrides:o}=e;const l=(0,r.Fg)(),d=(0,i.O7)(),u=(0,a.VK)((()=>(0,nc.J)({environment:d})),[d]),m=(0,a.VK)((()=>t.state),[t]),p=(0,a.VK)((()=>Ie.default.checkGate({gateName:"cdrr_deletion_enabled"})),[]),g=(0,a.VK)((()=>(0,bt.wP)()),[]),h=(0,a.VK)((()=>(0,bt.mq)()),[]),y=(0,c.jsx)(Vc,{});return u?(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)(fe.Z,{large:!0,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.generalSection.title",defaultMessage:"General"})}),(0,c.jsx)(Wc,{enable:!0,spaceStore:n,securitySettingsStore:t,featureUpsellButton:y,isControlledByOrganization:Boolean(o.disable_public_access)}),(0,c.jsx)(zc,{enable:!0,spaceStore:n,securitySettingsStore:t,featureUpsellButton:y}),(0,c.jsx)(qc,{enable:!0,spaceStore:n,securitySettingsStore:t,featureUpsellButton:y,isControlledByOrganization:Boolean(o.disable_move_to_space)}),(0,c.jsx)(Gc,{enable:!0,spaceStore:n,securitySettingsStore:t,featureUpsellButton:y,isControlledByOrganization:Boolean(o.disable_export)}),(0,c.jsx)(Kc,{securitySettingsStore:t,spaceStore:n,disableGuestsAvailableForTier:!0,enableGuestInviteRequestAvailableForTier:g,enableExternalAccessRequestSettingForTier:h,organizationOverrides:o}),(0,c.jsx)("div",{style:{height:36}})]}):(0,c.jsxs)(s.Fragment,{children:[p?null:(0,c.jsx)(Dc,{}),(0,c.jsx)("div",{style:Rc(l),children:(0,c.jsx)("span",{style:{marginRight:8},children:(0,c.jsx)(f.FormattedMessage,{id:"securitySAMLSettings.generalSection.title",defaultMessage:"General"})})}),(0,c.jsx)(Wc,{enable:m.disablePublicAccess,spaceStore:n,securitySettingsStore:t,featureUpsellButton:y,isControlledByOrganization:Boolean(o.disable_public_access)}),(0,c.jsx)(zc,{enable:m.disableSpacePageEdits,spaceStore:n,securitySettingsStore:t,featureUpsellButton:y}),(0,c.jsx)(qc,{enable:m.disableMoveToSpace,spaceStore:n,securitySettingsStore:t,featureUpsellButton:y,isControlledByOrganization:Boolean(o.disable_move_to_space)}),(0,c.jsx)(Gc,{enable:m.disableExport,spaceStore:n,securitySettingsStore:t,featureUpsellButton:y,isControlledByOrganization:Boolean(o.disable_export)}),(0,c.jsx)(Kc,{securitySettingsStore:t,spaceStore:n,disableGuestsAvailableForTier:m.disableGuests,enableGuestInviteRequestAvailableForTier:m.enableGuestInviteRequests,enableExternalAccessRequestSettingForTier:h,organizationOverrides:o}),(0,c.jsx)("div",{style:{height:32}})]})}var Yc=n(554985),Qc=n(858047);const Jc={whiteSpace:"normal",paddingTop:5,paddingBottom:5,height:"auto"};function Xc(e){const t=(0,i.O7)(),{onView:n}=e;return(0,s.useEffect)((()=>{n(t)}),[t,n]),(0,c.jsxs)("div",{children:[(0,c.jsx)(As.Z,{size:0}),(0,c.jsx)(Qc.N,{icon:e.icon,title:e.title,description:e.descriptionMessage,onDismiss:e.onDismiss,primaryAction:{text:e.buttonText,onClick:t=>(e.onDismiss(),e.onClick(t))},secondaryAction:{icon:e=>(0,di.m)(e),text:(0,c.jsx)(f.FormattedMessage,{id:"settingsPrompt.learnMore.button",defaultMessage:"Learn more"}),onClick:e.onClickLearnMore},customPrimaryButtonStyles:Jc})]})}const eu=function(e){const t=(0,r.yK)((t=>({style:{display:"flex",height:"100%",flexDirection:e.isReversed?"row-reverse":"row"},sidebarStyle:{height:"100%",background:t.cardSidebarBackground,flexGrow:0,flexShrink:0,width:240,overflowY:"auto"},childrenStyle:{flexGrow:1,position:"relative",zIndex:1,height:"100%"}})),[e]);return(0,c.jsxs)("div",{style:t.style,onMouseDown:e.onMouseDown,onClick:e.onClick,onDoubleClick:e.onDoubleClick,onContextMenu:e.onContextMenu,children:[(0,c.jsx)("div",{style:t.sidebarStyle,children:e.sidebar}),(0,c.jsx)("div",{style:t.childrenStyle,children:e.children})]})};var tu=n(124697),nu=n(783726),su=n(93502),iu=n(831303),ou=n(835238),au=n(242485),ru=n(589426),lu=n(588149),du=n(365552);const cu={[et.x.Overview]:(0,c.jsx)(f.FormattedMessage,{id:"workspaceAnalyticsTabs.overview.title",defaultMessage:"Overview"}),[et.x.Users]:(0,c.jsx)(f.FormattedMessage,{id:"workspaceAnalyticsTabs.members.title",defaultMessage:"Members"}),[et.x.Content]:(0,c.jsx)(f.FormattedMessage,{id:"workspaceAnalyticsTabs.content.title",defaultMessage:"Content"}),[et.x.Search]:(0,c.jsx)(f.FormattedMessage,{id:"workspaceAnalyticsTabs.search.title",defaultMessage:"Search"})};function uu(e){const{currentTab:t,spaceAnalyticsStoreState:n,onUserTabFilterChange:s,spaceStore:i}=e;switch(t){case et.x.Content:return(0,c.jsx)(ou.Z,{spaceStore:i,contentEngagement:e.contentEngagementData});case et.x.Users:return(0,c.jsx)(du.Z,{spaceStore:i,usersTabData:n.usersTabData,onUserTabFilterChange:s,userEngagement:e.userEngagementData});case et.x.Overview:return(0,c.jsx)(ru.Z,{contentEngagement:e.contentEngagementData,userEngagement:e.userEngagementData,spaceStore:i,onUserTabFilterChange:s});case et.x.Search:return(0,c.jsx)(lu.Z,{spaceStore:i});default:(0,Zn.t1)(t)}}const mu=function(e){let{spaceStore:t}=e;const n=(0,r.yK)((e=>({headingStyle:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:y.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"},title:{display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},tabsStyle:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14}})),[]),o=(0,i.O7)(),l=(0,a.VK)((()=>{var e;return null===(e=Ge.default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),d=(0,su.U)({spaceId:t.id}),u=(0,iu.i)({spaceStore:t,userId:l}),[m,p]=(0,a.AF)(et.Z),g=(0,a.VK)((()=>Boolean(null==t?void 0:t.getSettings().disable_page_analytics)),[t]),h=(0,a.VK)((()=>null==t?void 0:t.getName()),[t]),x=(0,s.useCallback)((async e=>{await nu.Pr({environment:o,spaceStore:t,currentTab:m.currentTab,currentSpaceId:m.currentSpaceId,usersTabData:m.usersTabData,setState:p,graphFilter:e.graphFilter,tableFilter:e.tableFilter})}),[o,t,m,p]),S=(0,s.useCallback)((e=>{tu.nK(o,{tab:e}),p({...m,currentTab:e})}),[p,m,o]),v=(0,a.VK)((()=>{const e=[];return function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(et.x.Overview),function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(et.x.Users),e.push(et.x.Content),function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(et.x.Search),e}),[t]),b=(0,a.VK)((()=>v.length>1),[v]),M=m.currentTab||v[0];(0,s.useEffect)((()=>{!async function(){const e=t.id;e&&et.Z.shouldRefreshState(e)&&(M===et.x.Users?await x({graphFilter:"last_90_days",tableFilter:"last_90_days"}):M===et.x.Content||M===et.x.Overview||M===et.x.Search||(0,Zn.t1)(M))}()}));const j=(0,s.useCallback)((()=>{C.D({environment:o,url:(0,ze.UY)("guides.workspaceAnalytics")})}),[o]),w=v.map((e=>cu[e])),k=g?(0,c.jsx)(au.y,{type:"disabled",spaceName:h}):(0,c.jsxs)(c.Fragment,{children:[b&&(0,c.jsx)(Os.Z,{tabs:w,selectedIndex:v.indexOf(M),onChange:e=>{S(v[e])},style:n.tabsStyle}),uu({currentTab:M,spaceAnalyticsStoreState:m,onUserTabFilterChange:x,spaceStore:t,contentEngagementData:d,userEngagementData:u})]});return(0,c.jsxs)(kt.ZP,{children:[(0,c.jsxs)(fe.Z,{large:!0,style:n.headingStyle,children:[(0,c.jsxs)("div",{style:n.title,children:[(0,c.jsx)(f.FormattedMessage,{id:"settings.workspaceAnalytics.title",defaultMessage:"Workspace analytics"}),(0,c.jsx)(je.Z,{placement:ke.u.Right,render:e=>(0,c.jsx)(Qi.Z,{...e,href:(0,ze.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:n.helpInfo}),renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"settings.workspaceAnalytics.dataDisclaimerTooltip",defaultMessage:"Data available from the start date of your Enterprise Plan"})})]}),(0,c.jsx)(yt.Z,{isSmall:!0,onClick:j,icon:di.m,children:(0,c.jsx)(f.FormattedMessage,{id:"workspaceAnalytics.title.helpButton",defaultMessage:"Learn more"})})]}),(0,kt.Um)(),k]})};var pu=n(305971),gu=n(181886),fu=n(372933),hu=n(436610),yu=n(986080);function xu(e){var t;return!(null===(t=Ge.default.state.currentSpaceStore)||void 0===t||!t.canAdmin())&&(0,Gt.qb)(e,"enterprise")}var Su=n(730459),vu=n(521273),bu=n(893586),Mu=n(500896),ju=n(71487),Cu=n(693943),wu=n(957187),ku=n(168028),Iu=n(756684);function Tu(e){let{currentProduct:t,isOpen:n,onClose:o,onConfirmDelete:a}=e;const r=(0,i.O7)(),l=(0,Cu.K_)(Ht.subscriptionDataStoreInstance),d=null==l?void 0:l.customerId,u="free",[p,g]=s.useState("survey"),[h,y]=s.useState({reasons:[],reasonOther:void 0,reasonOtherTools:void 0}),[x]=s.useState(m.Il()),[S,v]=s.useState(void 0);(0,s.useEffect)((()=>pt.j(r,{name:"churn_survey",args:{churnType:t,reasons:h.reasons,reasonOther:h.reasonOther,reasonOtherTools:h.reasonOtherTools,stage:p,churnSurveyId:x}})),[r,p,h,x,t]);const b=s.useCallback((()=>{pt.j(r,{name:"churn_survey_close",args:{churnSurveyId:x}}),o()}),[x,r,o]),M=s.useCallback((()=>{b(),a()}),[b,a]);return(0,c.jsx)(Iu.r,{step:p,isOpen:n,onClose:b,children:(()=>{switch(p){case"survey":return(0,c.jsx)(ku.tt,{options:Zu(),description:(0,c.jsx)(f.FormattedMessage,{id:"deletePaidWorkspaceFlow.surveyStep.description",defaultMessage:"Let us know why you’re deleting your workspace"}),onSubmit:async e=>{if(pt.j(r,{name:"churn_survey_submitted",args:{newProduct:u,churnType:t,reasons:e.reasons,reasonOther:e.customTextByReason.other??void 0,reasonOtherTools:e.customTextByReason.switching??void 0,stage:p,churnSurveyId:x}}),y((t=>({...t,reasons:e.reasons,reasonOther:e.customTextByReason.other??void 0,reasonOtherTools:e.customTextByReason.switching??void 0}))),d){const e=await ju.yY(r,{customerId:d,newPlan:t,offerType:"downgrade_flow"});if(e)return v(e),void g("offer")}M()}});case"offer":return S?(0,c.jsx)(ku.oR,{currentProduct:t,coupon:S,newProduct:u,secondaryButtonMessage:(0,c.jsx)(f.FormattedMessage,{id:"churnSurvey.offer.continueDeletingWorkspace.title",defaultMessage:"Continue deleting workspace"}),onSubmit:async e=>{e?(pt.j(r,{name:"offer_accepted",args:{coupon:S}}),d&&(0,Mu.$v)(S)&&(await ju.AG(r,{customerId:d,newPlan:t,coupon:S,offerType:"downgrade_flow"}),vi.oV({label:(0,c.jsx)(f.FormattedMessage,{id:"applyCoupon.success",defaultMessage:"Coupon successfully applied"})})),b()):M()}}):void M()}})()})}function Zu(){return[...(0,h.TV)([wu.f.consolidatingWorkspaces,wu.f.missingFeatures,wu.f.notUsingEnough,wu.f.switching,wu.f.tooExpensive,wu.f.tooDifficult]),wu.f.other]}var Pu=n(613630);const Fu=function(e){let{handleExportClick:t}=e;const n=(0,a.VK)((()=>Ge.default.state),[]),{currentSpaceStore:o}=n,r=(0,a.VK)((()=>Pu.Z.state),[]),l=(0,i.O7)();return(0,s.useEffect)((()=>{Aa.zh({environment:l,spaceId:null==o?void 0:o.id})}),[null==o?void 0:o.id,l]),(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)(fe.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.title",defaultMessage:"Export content"})}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,c.jsx)(yt.Z,{disabled:!!r.count,isLarge:!0,onClick:t,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportButton.label",defaultMessage:"Export all workspace content"})}),r.count?(0,c.jsxs)(Kr.gq,{gap:4,children:[(0,c.jsx)(zi.Z,{}),(0,c.jsx)(Ce.Z,{isSmall:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportInProgress",defaultMessage:"Export in progress"})})]}):(0,c.jsx)(c.Fragment,{})]}),(0,c.jsx)("div",{style:{height:12}}),(0,c.jsx)(Qi.Z,{title:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.helpButton.caption",defaultMessage:"Learn about exporting workspaces."}),href:(0,ze.UY)("guides.exportWorkspace"),analyticsFrom:"space_settings"}),(0,kt.Um)()]})};var _u=n(244071),Au=n(612457);const Bu=(0,f.defineMessages)({workspaceDomainInputPlaceholder:{id:"spaceBasicSettingsDomain.domainSection.workspaceDomainInput.placeholder",defaultMessage:"Your domain"},copyDomainTooltip:{id:"spaceBasicSettingsDomain.workspaceDomain.tooltip",defaultMessage:"Click to copy link"}});function Ru(e,t){const n=t=>(0,c.jsx)(je.Z,{delayThreshold:0,renderTooltip:()=>V.default.formatMessage(Bu.copyDomainTooltip),render:n=>(0,c.jsx)(Rs.Z,{onClick:()=>{ve.RD({environment:e,stringValue:t,copiedMessage:ve.tq.copiedLinkToClipboard})},...n,children:t})});return(0,c.jsxs)("div",{style:{paddingTop:8},children:[(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.viewPublicPage.caption",defaultMessage:"Pages shared to web will be under {linkText}.",values:{linkText:n(`${t}.${ds.default.publicDomainName}`)}}),(0,c.jsx)("div",{style:{paddingTop:6}}),(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.joinWorkspace.caption",defaultMessage:"Anyone with an allowed email domain can join this workspace via {linkText}.",values:{linkText:n(`${window.location.host}/${t}`)}})]})}function Du(){const e=(0,r.Fg)();return(0,c.jsxs)("div",{style:{color:e.invoiceGreen,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,Er.r)({height:16,width:16,margin:"0 4px 0 8px",color:e.invoiceGreen}),(0,c.jsx)("span",{children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Available",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.available"})})]})}function Ou(){return(0,c.jsxs)("div",{style:{color:is.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,Fo.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,c.jsx)("span",{children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Used",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.used"})})]})}function Lu(){return(0,c.jsxs)("div",{style:{color:is.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,Fo.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,c.jsx)("span",{children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Not allowed",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.notAllowed"})})]})}const Vu=function(e){const[t,n]=(0,a.AF)(e.spaceBasicSettingsStore),{domain:o,domainState:l}=t,d=(0,i.O7)(),u=(0,r.Fg)(),[m,p]=(0,s.useState)(!0),g=s.createRef();return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(fe.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.domainSection.title",defaultMessage:"Domain"})}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)("div",{style:{background:u.inputBackground,borderRadius:4,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex"},children:(0,c.jsx)(Cs.Z,{type:"text",style:{background:"none",boxShadow:"none",padding:"4px 6px",width:255},ref:g,value:o,placeholder:V.default.formatMessage(Bu.workspaceDomainInputPlaceholder),readOnly:!e.canAdminSpaceStore,onChange:e.handleSpaceUrlChange,onFocus:e=>{p(!1),e.target.select()}})}),m&&e.domainIsAutogenerated&&(0,c.jsx)("div",{style:{color:is.ZP.blue,fontSize:y.Z.fontSize.UIRegular.desktop,fontWeight:500,textAlign:"right",padding:"4px 6px",whiteSpace:"nowrap"},onClick:()=>{var e;null===(e=g.current)||void 0===e||e.focusInput(),p(!1),n({...t,domain:""})},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.changeDomain.cta.text",defaultMessage:"Set your own"})}),o&&"available"===l&&(0,c.jsx)(Du,{}),"inuse"===l&&(0,c.jsx)(Ou,{}),"disallowed"===l&&(0,c.jsx)(Lu,{}),"loading"===l&&(0,c.jsx)(Au.Z,{show:!0,showDelay:500,showHold:300,render:()=>(0,c.jsx)(zi.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})})]}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:Ru(d,o)})]})};var Eu=n(435840);const Nu=function(e){const t=(0,f.useIntl)(),n=(0,r.Fg)(),s=(0,i.O7)(),o=(0,a.VK)((()=>(0,Gt.M9)(s)),[s]),l=!Boolean(o),[d,u]=(0,a.AF)(Xe);return(0,c.jsx)("div",{onClick:()=>{o&&xt.y(s,{from:"public_domain_home_page",for:o})},children:(0,c.jsx)(Cs.Z,{type:"text",ref:e.textInputRef,style:{background:n.inputBackground,borderRadius:4,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex",padding:"4px 6px"},value:d.query,onChange:e=>{u({...d,query:e.target.value})},onFocus:()=>{l&&u({...d,openDropdown:!0})},disabled:!l,left:(0,Eu.R)({fill:n.mediumIconColor,width:16,height:16,marginRight:8,marginLeft:8,flexGrow:0,flexShrink:0}),placeholder:t.formatMessage({defaultMessage:"Select a page shared to web",id:"spaceBasicSettings.PublicHomePageSection.input.placeholder"})})})};var Uu=n(115100),Ku=n(511470);function Wu(){return(0,c.jsx)(Au.Z,{show:!0,showDelay:500,showHold:300,render:()=>(0,c.jsx)(zi.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})})}const zu=function(e){const t=(0,i.O7)(),[n,s]=(0,a.AF)(e.spaceBasicSettingsStore,nt),[o,r]=(0,a.AF)(Xe),{query:l}=o,[{value:d,status:u}]=(0,Qt.r5)((()=>Uu.a2(l,t)),[l,t]),m=(0,a.VK)((()=>(0,Ue.RM)()),[]);return l||d&&0!==d.length?(0,c.jsx)("div",{style:{marginTop:2,marginBottom:2},children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,sections:[{key:"recent public pages section",render:e=>(0,c.jsx)(ys.Z,{...e}),items:"idle"===u||"pending"===u?[{key:"loading spinner",render:Wu,action:()=>{}}]:m&&d&&0!==d.length?[...d.map((e=>{const t=oe.G.createChildStore(m,{table:Dr.iU,id:e.id});return{key:`${e.id} page`,render:e=>(0,c.jsx)(Ku.Z,{store:t,...e}),action:()=>{s({...n,publicHomePage:e.id}),r({...o,openDropdown:!1,displaySummary:!0})}}}))]:[{key:"no results",render:()=>(0,c.jsx)(Ce.Z,{isSmall:!0,style:{marginLeft:8},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel.noResults",defaultMessage:"No results"})}),action:()=>{}}]}],initialFocus:void 0})}):null};var qu=n(776798);const Gu=function(e){const[t,n]=(0,a.AF)(e.spaceBasicSettingsStore,nt),[s,i]=(0,a.AF)(Xe),[o,r]=(0,a.VK)((()=>{const e=(0,Ue.RM)();if(!e||!t.publicHomePage)return[];const n=oe.G.createChildStore(e,{table:Dr.iU,id:t.publicHomePage});return[n,n.getIcon()]}),[t]);return o?(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)("div",{style:{display:"flex",paddingRight:8,alignItems:"center"},children:[r&&(0,c.jsx)(hs.Z,{icon:r,isEmptyPage:!1,size:18,disabled:!0,style:{display:"inline-flex",marginRight:2,verticalAlign:"text-top"}}),(0,c.jsx)(qu.Z,{store:o,style:{display:"inline",whiteSpace:"normal",marginRight:Boolean(r)?3:0,wordBreak:"break-word"}})]}),(0,c.jsx)(yt.Z,{onClick:()=>{i({...s,displaySummary:!1}),n({...t,publicHomePage:void 0})},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel",defaultMessage:"Clear"})})]}):null};const Hu=function(e){const t=(0,i.O7)(),n=(0,i.MO)(),o=s.createRef(),[r,l]=(0,a.AF)(Xe),[d]=(0,a.AF)(e.spaceBasicSettingsStore),{openDropdown:u,displaySummary:m}=r,{publicHomePage:p,domain:g}=d,h=`${g}.${ds.default.publicDomainName}`,y=(0,a.VK)((()=>(0,Gt.M9)(t)),[t]),x=!Boolean(y);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(fe.Z,{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)("span",{style:{marginRight:8},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.title",defaultMessage:"Public home page"})}),y&&(0,c.jsx)(ao.Z,{subscriptionTier:y,analyticsName:"public_domain_home_page",desktopStyle:{marginTop:-1}})]}),x&&p&&m?(0,c.jsx)(Gu,{spaceBasicSettingsStore:e.spaceBasicSettingsStore}):(0,c.jsx)(ws.ZP,{alignmentToOrigin:ws.ZP.Alignment.Start,keepFocus:n,onDismiss:()=>{var e;null===(e=o.current)||void 0===e||e.handleBlur(),l({...r,openDropdown:!1,displaySummary:!0})},origin:(0,c.jsx)(Nu,{textInputRef:o}),open:u,popupType:os.k.Popup,style:{width:250},render:()=>(0,c.jsx)(ps.Z,{menuType:cs.og.Popup,width:250,children:(0,c.jsx)(zu,{spaceBasicSettingsStore:e.spaceBasicSettingsStore})})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption",defaultMessage:"Access your public home page via {linkText}.",values:{linkText:(0,c.jsx)(je.Z,{delayThreshold:0,renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption.tooltip",defaultMessage:"Click to copy link"}),render:e=>(0,c.jsx)(Rs.Z,{onClick:()=>{ve.RD({environment:t,stringValue:h,copiedMessage:ve.tq.copiedLinkToClipboard})},...e,children:h})})}})})]})};var $u=n(100719);function Yu(){return(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.nameInput.caption",defaultMessage:"You can use your organization or company name. Keep it simple."})}const Qu=(0,f.defineMessages)({nameInputPlaceholder:{id:"spaceBasicSettings.nameInput.placeholder",defaultMessage:"e.g. company name"},workspaceDomainInputPlaceholder:{id:"spaceBasicSettings.domainSection.workspaceDomainInput.placeholder",defaultMessage:"URL"},allowedEmailDomainsInputPlaceholder:{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.placeholder",defaultMessage:"Type an email domain…"},copyDomainTooltip:{id:"spaceBasicSettings.workspaceDomain.tooltip",defaultMessage:"Click to copy link"},turnOffAiWhenSubscribedToAiWarning:{id:"spaceBasicSettings.aiFeature.turnOffAiWhenSubscribedToAiWarning",defaultMessage:"Your current plan includes Notion AI. You can turn off access to AI, but you will continue to be billed for it."},turnOffAiWhenSubscribedToAccept:{id:"spaceBasicSettings.aiFeature.turnOffAiWhenSubscribedToAccept",defaultMessage:"Turn off AI"}});class Ju extends ee.Z{constructor(){super(...arguments),this.storeTypes={spaceBasicSettingsStore:nt,securitySettingsStore:Qe.Z,tokenQueryStore:N.default.createClass("",{name:"tokenQueryStore"})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleSpaceNameChange=e=>function(e,t){t.setState({...t.state,name:e.target.value})}(e,this.stores.spaceBasicSettingsStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCheckDomainAvailability=e=>function(e,t,n,s){w._u({environment:t,spaceStore:n,domain:e}).then((e=>{if("success"!==e.type)s.setState({...s.state,domainState:"loading"});else{const t=e.data.domain===s.state.domain;s.setState({...s.state,domainState:t?e.data.domainState:s.state.domainState})}}))}(e,this.environment,this.props.spaceStore,this.stores.spaceBasicSettingsStore),this.checkSpaceDomainAvailabilityDebounced=h.Ds(this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCheckDomainAvailability,250),this.handleSpaceUrlChange=e=>{const t=(0,Nn.$U)(e.target.value);this.checkSpaceDomainAvailabilityDebounced(t),this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domain:t}),this.forceUpdate()},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleConfirm=()=>um(this.environment,this.props.spaceStore,this.stores.spaceBasicSettingsStore,this.stores.securitySettingsStore)}UNSAFE_willMount(e){super.UNSAFE_willMount(e);const{spaceStore:t}=this.props,{spaceBasicSettingsStore:n,securitySettingsStore:s}=this.stores,i=n.getValueForSpace(t),o=s.getValueForSpace(t);i&&n.setState(i),o&&s.setState(o)}renderComponent(){return yn.Z.state.online?this.renderSettings():(0,c.jsx)(em,{})}renderSettings(){var e;const{spaceStore:t}=this.props,{spaceBasicSettingsStore:n}=this.stores,{name:i}=n.state,o=Ht.subscriptionDataStoreInstance.state,{device:a}=this.environment;if(!o)return;const r=t.canAdmin(),l=(0,Nn.Cx)(t),d=Gt.Io(),u=Gt.qF(this.environment),m=r&&!t.getDisableExport(),p=r,g=(0,bt.zt)(),h="subscribed_admin"===o.type&&("enterprise"===g||"business"===g),y=t.getSettings().disable_page_analytics,x=Wi.Z.getData(this.environment,{spaceId:t.id}),S=(null===(e=Ht.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[],v=am({spaceStore:t,currentAddOns:S}),b=!we.Aq(),j=Boolean(this.props.organizationOverrides.disable_page_analytics);return(0,c.jsxs)(kt.ZP,{controlRow:r&&(0,c.jsx)(mm,{spaceStore:this.props.spaceStore,spaceBasicSettingsStore:this.stores.spaceBasicSettingsStore,securitySettingsStore:this.stores.securitySettingsStore}),controlRowPaddingTopBottom:14,children:[r&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(sm,{}),(0,c.jsx)(fe.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.title",defaultMessage:"Name"})}),(0,c.jsx)(Cs.Z,{value:i,placeholder:V.default.formatMessage(Qu.nameInputPlaceholder),readOnly:!r,onChange:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleSpaceNameChange}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:(0,c.jsx)(Yu,{})}),(0,kt.Um)(),(0,c.jsx)(fe.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.title",defaultMessage:"Icon"})}),(0,c.jsx)("div",{style:{width:72,height:72,border:`1px solid ${this.theme.regularDividerColor}`,borderRadius:6,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,c.jsx)(hs.Z,{bucket:"public",disabled:!1,icon:(0,Nn.Wd)(this.environment,t),isEmptyPage:!1,title:i,size:64,iconLoggingData:{recordTable:t.table,source:"workspace_settings"},onChange:e=>function(e,t,n){P.createAndCommit({userAction:"SpaceBasicSettings.handleRecordIconChange",environment:n,perform:n=>{Hn.sO({store:t.getIconStore(),value:e,transaction:n})}})}(e,this.props.spaceStore,this.environment)})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.caption",defaultMessage:"Upload an image or pick an emoji. It will show up in your sidebar and notifications."})}),(0,kt.Um)()]}),xu(this.environment)||v?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(nm,{}),xu(this.environment)?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(rm,{securitySettingsStore:this.props.securitySettingsStore,spaceStore:this.props.spaceStore,isControlledByOrganization:Boolean(this.props.organizationOverrides.enable_ai_feature)}),(0,kt.Um)()]}):null,v?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(lm,{securitySettingsStore:this.props.securitySettingsStore,spaceStore:this.props.spaceStore}),(0,kt.Um)()]}):null]}):null,(0,c.jsx)(tm,{}),l&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.guestLimitedAccessMessage",defaultMessage:"You are currently a guest in this workspace. Ask an admin to add you as a member in order to see other pages."})}),(0,kt.Um)()]}),b&&r&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Vu,{canAdminSpaceStore:r,domainIsAutogenerated:null==x?void 0:x.domainIsAutogenerated,spaceStore:t,spaceBasicSettingsStore:n,handleSpaceUrlChange:this.handleSpaceUrlChange}),(0,kt.Um)()]}),r&&u&&(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)(fe.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.title",defaultMessage:"Allowed email domains"})}),(0,c.jsx)(dm,{spaceStore:this.props.spaceStore,spaceBasicSettingsStore:this.stores.spaceBasicSettingsStore,tokenQueryStore:this.stores.tokenQueryStore}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.caption",defaultMessage:"Anyone with email addresses at these domains can automatically join your workspace."})}),(0,kt.Um)()]}),b&&r&&(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)(Hu,{spaceBasicSettingsStore:n}),(0,kt.Um)()]}),m&&(0,c.jsx)(Fu,{handleExportClick:()=>function(e){const{currentSpaceStore:t}=Ge.default.state;t&&Aa.q$({environment:e,root:{table:"space",id:t.id,spaceId:t.id},isCollectionViewExportTypeSupported:!0})}(this.environment)}),p&&(0,c.jsxs)(s.Fragment,{children:[(0,c.jsxs)(fe.Z,{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)("span",{style:{marginRight:8},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.title",defaultMessage:"Export members"})}),!h&&(0,c.jsx)(ao.Z,{subscriptionTier:"business",analyticsName:"space_export_members",desktopStyle:{marginTop:-1}})]}),(0,c.jsx)("div",{style:{display:"flex"},children:(0,c.jsx)(yt.Z,{isLarge:!0,disabled:!h,onClick:()=>function(e,t){const{currentSpaceStore:n}=Ge.default.state,s=Ht.subscriptionDataStoreInstance.state;n&&s&&"subscribed_admin"===s.type&&Aa.$G(t,{spaceStore:n,subscriptionData:s,intl:e})}(this.props.intl,this.environment),disabledFeedback:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.exportAsCSVButton.label",defaultMessage:"Export members as CSV"})})}),(0,c.jsx)("div",{style:{height:12}}),(0,c.jsx)(Qi.Z,{title:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.helpButton.caption",defaultMessage:"Learn about exporting members."}),href:(0,ze.UY)("guides.exportMembers"),analyticsFrom:"space_settings"}),(0,kt.Um)()]}),r&&(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)(fe.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.analytics.title",defaultMessage:"Analytics"})}),(0,c.jsxs)("div",{style:{display:"flex",gap:12,flexDirection:"column"},children:[(0,c.jsx)(Ds.Z,{isMobile:a.isMobile,title:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.title",defaultMessage:"Save and display page view analytics"}),caption:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.description",defaultMessage:"People with edit or full access will be able to see how many views a page has. If this is turned off, page views will not be stored for all pages in {workspaceName}.",values:{workspaceName:i}}),type:"toggle",isOn:!y,isLocked:j,lockedTooltip:(0,$n.g)(),onToggle:()=>{if(j)return;const e=!y;P.createAndCommit({userAction:"SpaceBasicSettings.analyticsSettings.onSelectOption",environment:this.environment,perform:n=>{Hn.sW({store:t,data:{settings:{...t.getSettings(),disable_page_analytics:e}},transaction:n})}}),Su.K4(this.environment,e?"page_analytics_workspace_opt_out":"page_analytics_workspace_opt_in")}}),(0,c.jsx)(Qi.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Learn about workspace analytics.",id:"spaceBasicSettings.workspaceAnalytics.helpButton.caption"}),href:(0,ze.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq"})]}),(0,kt.Um)()]}),(0,c.jsx)(fe.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.title",defaultMessage:"Danger zone"})}),(0,c.jsxs)("div",{style:{display:"flex"},children:[(d.length>1||l)&&(0,c.jsx)(yt.Z,{isLarge:!0,onClick:()=>function(e,t){const{currentUserSettingsStore:n}=Ge.default.state;n&&M.showDialog({message:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.prompt",defaultMessage:"Are you sure you want to leave this workspace?"}),showCancel:!0,keepFocus:!0,items:[{label:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.leaveButton.label",defaultMessage:"Leave"}),color:"red",onAccept:async()=>{await w.bf({environment:t,spaceId:e.id,userSettingsStore:n})&&(Si.z0(t),rt.Z.setState({...rt.Z.state,open:!1}))}}]})}(this.props.spaceStore,this.environment),style:{marginRight:r?12:void 0},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.leaveWorkspaceButton.label",defaultMessage:"Leave workspace"})}),r&&(0,c.jsx)(cm,{spaceStore:this.props.spaceStore})]}),r&&(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)("div",{style:{height:12}}),(0,c.jsx)(Qi.Z,{title:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceHelpButton.caption",defaultMessage:"Learn about deleting workspaces."}),href:(0,ze.UY)("guides.deleteWorkspace"),analyticsFrom:"space_settings"})]})]})}}Ju.displayName="SpaceBasicSettings";const Xu=(0,f.injectIntl)(Ju);function em(){return(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(Ce.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.offlineMessage",defaultMessage:"Please go online to manage settings."})})})}function tm(){return(0,c.jsx)(fe.Z,{large:!0,divider:"full",style:{paddingTop:12},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.public.subtitle",defaultMessage:"Public settings"})})}function nm(){return(0,c.jsx)(fe.Z,{large:!0,divider:"full",style:{paddingTop:12},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.feature.subtitle",defaultMessage:"Feature settings"})})}function sm(){return(0,c.jsx)(fe.Z,{large:!0,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.title",defaultMessage:"Workspace settings"})})}async function im(e,t,n){const{currentUserSettingsStore:s}=Ge.default.state;if(!s)return;const i=(0,Nn.rn)(n,e)||t.formatMessage({defaultMessage:"Untitled workspace",id:"spaceBasicSettings.deleteWorkspace.untitledWorkspace.placeholder"}),o=(0,fu.xf)(Po.SP)?(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.prompt",defaultMessage:"This action cannot be undone. This will permanently delete the workspace, including all pages and files. Please type the name of the workspace to confirm."}):(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(_u.Z,{translations:{es:"Esta acción no se puede deshacer. Esto eliminará permanentemente el espacio de trabajo, incluidas todas las páginas y archivos. Por favor escriba el nombre del espacio de trabajo para confirmar.",ru:"Это действие не может быть отменено. Это навсегда удалит рабочее пространство, включая все страницы и файлы. Пожалуйста, введите название рабочей области для подтверждения.",zh:"此操作无法撤消。 这将永久删除工作区，包括所有页面和文件。 请输入要确认的工作空间的名称。",de:"Diese Aktion kann nicht rückgängig gemacht werden. Dadurch wird der Arbeitsbereich einschließlich aller Seiten und Dateien dauerhaft gelöscht. Bitte geben Sie den Namen des Arbeitsbereichs zur Bestätigung ein.",fr:"Cette action ne peut pas être annulée. Cela supprimera définitivement l'espace de travail, y compris toutes les pages et tous les fichiers. Veuillez saisir le nom de l'espace de travail pour confirmer.",ja:"この操作を元に戻すことはできません。 これにより、すべてのページとファイルを含むワークスペースが完全に削除されます。 確認するワークスペースの名前を入力してください。",it:"Questa azione non può essere annullata. Questo eliminerà definitivamente l'area di lavoro, incluse tutte le pagine e i file. Digita il nome dell'area di lavoro per confermare.",pt:"Essa ação não pode ser desfeita. Isso excluirá permanentemente o espaço de trabalho, incluindo todas as páginas e arquivos. Por favor, digite o nome do espaço de trabalho para confirmar.",nl:"Deze actie kan niet ongedaan gemaakt worden. Hiermee wordt de werkruimte permanent verwijderd, inclusief alle pagina's en bestanden. Typ de naam van de werkruimte om te bevestigen.",pl:"Tego działania nie można cofnąć. Spowoduje to trwałe usunięcie obszaru roboczego, w tym wszystkich stron i plików. Wpisz nazwę obszaru roboczego, aby potwierdzić.",sv:"Den här åtgärden kan inte ångras. Detta tar bort arbetsytan permanent, inklusive alla sidor och filer. Vänligen skriv in arbetsplatsens namn för att bekräfta.",uk:"Цю дію не можна скасувати. Це дозволить остаточно видалити робочу область, включаючи всі сторінки та файли. Введіть назву робочої області для підтвердження.",no:"Denne handlingen kan ikke fortrykkes. Dette vil permanent slette arbeidsområdet, inkludert alle sider og filer. Vennligst skriv navnet på arbeidsområdet for å bekrefte.",tr:"Bu işlem geri alınamaz. Bu, tüm sayfaları ve dosyaları içeren çalışma alanını kalıcı olarak siler. Lütfen onaylamak için çalışma alanının adını yazın.",cs:"Tuto akci nelze vrátit zpět. Tím se trvale odstraní pracovní prostor včetně všech stránek a souborů. Zadejte prosím název pracovního prostoru, který chcete potvrdit.",vi:"Hành động này không thể được hoàn tác. Điều này sẽ xóa vĩnh viễn không gian làm việc, bao gồm tất cả các trang và tệp. Vui lòng nhập tên của không gian làm việc để xác nhận.",da:"Denne handling kan ikke fortrydes. Dette vil permanent slette arbejdsområdet, inklusive alle sider og filer. Indtast navnet på arbejdsområdet for at bekræfte.",hu:"Ez a művelet nem visszavonható. Ez véglegesen törli a munkaterületet, beleértve az összes oldalt és fájlt. Kérjük, írja be a munkaterület nevét a megerősítéshez.",ar:"لا يمكن التراجع عن هذا الإجراء. سيؤدي ذلك إلى حذف مساحة العمل كليا ، بما يشمل جميع الصفحات والملفات. يرجى كتابة اسم مساحة العمل للتأكيد.",th:"การกระทำนี้ไม่สามารถยกเลิกได้ นี่จะเป็นการลบพื้นที่ทำงานอย่างถาวรรวมถึงหน้าและไฟล์ทั้งหมด โปรดพิมพ์ชื่อของพื้นที่ทำงานเพื่อยืนยัน",he:"לא ניתן לבטל פעולה זו. פעולה זו תמחק לצמיתות את סביבת העבודה, כולל כל הדפים והקבצים. הקלד את שם מרחב העבודה כדי לאשר.",fi:"Tätä toimintoa ei voi peruuttaa. Tämä poistaa työtilan pysyvästi, mukaan lukien kaikki sivut ja tiedostot. Vahvista kirjoittamalla työtilan nimi.",id:"Tindakan ini tidak bisa dibatalkan. Ini akan secara permanen menghapus ruang kerja, termasuk semua halaman dan file. Silakan ketik nama ruang kerja untuk mengonfirmasi."}})});await yu.b({title:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.title",defaultMessage:"Delete this entire workspace permanently?"}),message:(0,c.jsx)("div",{children:(0,c.jsx)("div",{children:o})}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.deleteWorkspaceButton.label",defaultMessage:"Permanently delete workspace"}),requiredInputValue:i})&&(w.Ns({environment:n,spaceId:e.id,userSettingsStore:s}),Si.BP(n),rt.Z.setState({...rt.Z.state,open:!1}))}function om(){rt.Z.setState({...rt.Z.state,open:!1}),Xe.setState(Xe.getInitialState())}function am(e){var t;const{spaceStore:n,currentAddOns:s}=e,i=n.canAdmin(),o=p.de(s);return i&&o&&vu.Z.isWorkspaceLeapEligible()||(null===(t=n.getModel())||void 0===t?void 0:t.isAiLeapEnabledOnSpace())}function rm(e){let{securitySettingsStore:t,spaceStore:n,isControlledByOrganization:s}=e;const i=(0,a.VK)((()=>(0,Nn.CV)(n)),[n]),o=(0,a.VK)((()=>!i&&Boolean(null==t?void 0:t.state.enableAiFeature)),[i,t]);return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(je.Z,{placement:ke.u.Bottom,alignment:ke.v.Start,textWrap:!0,style:{maxWidth:240},disableTooltip:!i,renderTooltip:()=>i?(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.aiFeature.hipaaTooltip",defaultMessage:"Notion AI is not currently available for HIPAA compliant workspaces."}):void 0,render:e=>(0,c.jsx)("div",{children:(0,c.jsxs)("div",{...e,style:{display:"flex",alignItems:"center",cursor:i?"not-allowed":"pointer"},onClick:()=>{s||async function(e,t){var n;const s=(null===(n=Ht.subscriptionDataStoreInstance.state)||void 0===n?void 0:n.addOns)??[],i=p.de(s),o=!t.state.enableAiFeature;if(!o&&i&&!(await M.confirmUserActionV2({message:V.default.formatMessage(Qu.turnOffAiWhenSubscribedToAiWarning),acceptLabel:V.default.formatMessage(Qu.turnOffAiWhenSubscribedToAccept)})).accept)return;t&&!e&&t.setState({...t.state,enableAiFeature:o})}(i,t)},children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.aiFeature.label",defaultMessage:"Notion AI"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.aiFeature.ga.caption",defaultMessage:"Enable to provide AI-powered functionality for all members of your workspace.{br}By enabling Notion AI, you are agreeing to the <inlinelink>Notion AI Supplementary Terms</inlinelink>",values:{br:(0,c.jsx)("br",{}),inlinelink:e=>(0,c.jsx)(Rs.Z,{href:"https://notion.notion.site/fa9034c8b5a04818a6baf3eac2adddbb",external:!0,onClick:e=>e.stopPropagation(),children:e})}})})]}),(0,c.jsx)("div",{style:{marginTop:5},children:(0,c.jsx)(al.Z,{on:o,disabled:i,isLocked:s,lockedTooltip:(0,$n.g)()})})]})})})})}function lm(e){let{securitySettingsStore:t,spaceStore:n}=e;const s=(0,a.VK)((()=>Boolean(t.state.enableAiTraining)),[t]);return(0,c.jsx)("div",{children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},onClick:()=>{!function(e){var t;const{securitySettingsStore:n,spaceStore:s}=e,i=(null===(t=Ht.subscriptionDataStoreInstance.state)||void 0===t?void 0:t.addOns)??[],o=!n.state.enableAiTraining;am({spaceStore:s,currentAddOns:i})&&n.setState({...n.state,enableAiTraining:o})}({spaceStore:n,securitySettingsStore:t})},children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.aiLeap.label",defaultMessage:"Share data to improve Notion AI"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.aiLeap.description",defaultMessage:"Help improve Notion’s AI models by allowing data from across this workspace to be shared with Notion.{br}By enabling AI LEAP (Learning and Early Access Program) you are agreeing to the <inlinelink>Notion AI LEAP Supplementary Terms</inlinelink>. <learnmore>Learn more</learnmore>.",values:{br:(0,c.jsx)("br",{}),learnmore:e=>(0,c.jsx)(Rs.Z,{href:"https://www.notion.so/help/notion-ai-leap-program-faqs",external:!0,onClick:e=>e.stopPropagation(),children:e}),inlinelink:e=>(0,c.jsx)(Rs.Z,{href:"https://notion.notion.site/0c55d702d0154a788d9e70c4ee396399",external:!0,onClick:e=>e.stopPropagation(),children:e})}})})]}),(0,c.jsx)("div",{style:{marginTop:5},children:(0,c.jsx)(al.Z,{on:s})})]})})}function dm(e){let{spaceStore:t,spaceBasicSettingsStore:n,tokenQueryStore:s}=e;const o=(0,i.O7)(),r=(0,f.useIntl)(),{device:l}=o,d=(0,a.VK)((()=>n.state.emailDomains),[n]),u=(0,a.VK)((()=>t.canAdmin()),[t]),m=(0,a.VK)((()=>Ht.subscriptionDataStoreInstance.state),[]),p=(0,a.VK)((()=>s.state),[s]);return(0,c.jsx)(ws.ZP,{popupType:l.isMobile?os.k.SlideUp:os.k.Popup,sameWidthAsOrigin:!0,open:p.length>0,origin:(0,c.jsx)($u.Z,{placeholder:r.formatMessage(Qu.allowedEmailDomainsInputPlaceholder),value:p,onChange:e=>s.setState(e.target.value),readOnly:!u,onRemoveLastToken:()=>{const e=d.slice(0,d.length-1);n.setState({...n.state,emailDomains:e})},tokens:d.map((e=>(0,c.jsx)(zl.Z,{showRemoveButton:!0,isSingle:!1,format:wr.lo.Medium,onClickRemove:()=>{const t=d.filter((t=>t!==e));n.setState({...n.state,emailDomains:t})},value:e},e)))}),render:()=>{const e=p.trim(),i=(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholder",defaultMessage:"Type an email domain…"}),o=(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholderNoResults",defaultMessage:"Type an email domain of a member of this workspace…"}),a=m?Gt.hn(m).map((e=>{if(("unsubscribed_admin"===m.type||"unsubscribed_member"===m.type||"subscribed_admin"===m.type)&&m.joinedMemberIds.includes(e.userId)){const n=oe.U6.createChildStore(t,{table:D.KJ,id:e.userId}).getEmail();return n&&(0,sr.Gd)(n)}})).filter(((e,t,n)=>Boolean(e&&t===n.indexOf(e)&&!d.includes(e)))):[],r=(0,Bd.ZP)(e,a,(e=>e)).map(((e,t)=>({key:t,render:t=>(0,c.jsx)(ms.Z,{...t,title:e}),action:()=>{const t=[...d,e];n.setState({...n.state,emailDomains:t}),s.setState("")}})));let u;return u=l.isMobile?{menuType:cs.og.ActionSheet}:{menuType:cs.og.Popup,width:"100%"},(0,c.jsx)(ps.Z,{...u,children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:r.length>0?0:void 0,sections:[{key:0,render:e=>(0,c.jsx)(ys.Z,{...e,disableDesktopPadding:!0,title:r.length>0?i:o}),items:r}]})})},onDismiss:()=>{s.setState("")}})}function cm(e){let{spaceStore:t}=e;const n=(0,i.O7)(),o=(0,f.useIntl)(),[r,l]=s.useState(!1),d=(0,a.VK)((()=>(0,bt.zt)()),[]);return(0,c.jsxs)(c.Fragment,{children:[r?(0,c.jsx)(Tu,{currentProduct:(0,gu.KE)(d),isOpen:r,onClose:()=>l(!1),onConfirmDelete:async()=>await im(t,o,n)}):null,(0,c.jsx)(yt.Z,{isLarge:!0,isRed:!0,onClick:async()=>await async function(e){const{environment:t,spaceStore:n,intl:s,showDowngradeModal:i}=e,o=Ht.subscriptionDataStoreInstance.state,a=Gt.XX(o);if(hu.YO(t),a)return void i();await im(n,s,t)}({environment:n,spaceStore:t,intl:o,showDowngradeModal:()=>l(!0)}),children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceButton.label",defaultMessage:"Delete entire workspace"})})]})}async function um(e,t,n,s){await w.Y5({environment:e,spaceId:t.id,domain:n.state.domain})&&(await w.OF({environment:e,spaceStore:t,spaceBasicSettingsStore:n,securitySettingsStore:s}),Xe.setState(Xe.getInitialState()),rt.Z.setState({...rt.Z.state,open:!1}),bu.Z.resetData(e,{spaceId:t.id}))}function mm(e){let{spaceStore:t,spaceBasicSettingsStore:n,securitySettingsStore:o}=e;const r=(0,i.O7)(),l=(0,s.useCallback)((()=>um(r,t,n,o)),[r,t,n,o]),d=(0,a.VK)((()=>!function(e){const{domain:t,domainState:n}=e.state;return!!t&&("available"===n||"current-space"===n)}(n)),[n]);return(0,c.jsxs)("div",{style:{display:"flex"},children:[(0,c.jsx)(Bs.Z,{isLarge:!0,onClick:l,disabled:d,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.updateButton.label",defaultMessage:"Update"})}),(0,c.jsx)(yt.Z,{isLarge:!0,style:{marginLeft:12},onClick:om,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.cancelButton.label",defaultMessage:"Cancel"})})]})}function pm(){return(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.nameInput.caption",defaultMessage:"You can use your organization or company name. Keep it simple."})}const gm=(0,f.defineMessages)({nameInputPlaceholder:{id:"spaceBasicSettings.nameInput.placeholder",defaultMessage:"e.g. company name"},workspaceDomainInputPlaceholder:{id:"spaceBasicSettings.domainSection.workspaceDomainInput.placeholder",defaultMessage:"URL"},allowedEmailDomainsInputPlaceholder:{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.placeholder",defaultMessage:"Type an email domain…"},copyDomainTooltip:{id:"spaceBasicSettings.workspaceDomain.tooltip",defaultMessage:"Click to copy link"},turnOffAiWhenSubscribedToAiWarning:{id:"spaceBasicSettings.aiFeature.turnOffAiWhenSubscribedToAiWarning",defaultMessage:"Your current plan includes Notion AI. You can turn off access to AI, but you will continue to be billed for it."},turnOffAiWhenSubscribedToAccept:{id:"spaceBasicSettings.aiFeature.turnOffAiWhenSubscribedToAccept",defaultMessage:"Turn off AI"}});function fm(e){const{spaceStore:t,organizationOverrides:n}=e,l=(0,i.O7)(),d=(0,a.VK)((()=>!yn.Z.state.online),[]),u=(0,a.VK)((()=>t.canAdmin()),[t]),m=(0,a.qz)(e.spaceBasicSettingsStore,nt),p=(0,a.qz)(e.securitySettingsStore,Qe.Z),g=(0,a.VK)((()=>(0,Nn.Cx)(t)),[t]);(0,o.Z)((()=>{const e=m.getValueForSpace(t),n=p.getValueForSpace(t);e&&m.setState(e),n&&p.setState(n)}));const y=(0,a.VK)((()=>xu(l)),[l]),x=(0,a.VK)((()=>{var e;const n=(null===(e=Ht.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return Im({spaceStore:t,currentAddOns:n})}),[t]),S=(0,a.VK)((()=>!we.Aq()),[]),v=(0,a.VK)((()=>Wi.Z.getData(l,{spaceId:t.id})),[l,t]),b=(0,a.VK)((()=>Gt.qF(l)),[l]),j=(0,a.VK)((()=>u&&!t.getDisableExport()),[u,t]),C=(0,a.VK)((()=>Gt.Io()),[]),k=(0,s.useMemo)((()=>(0,h.Ds)((e=>{!function(e,t,n,s){w._u({environment:t,spaceStore:n,domain:e}).then((e=>{if("success"!==e.type)s.setState({...s.state,domainState:"loading"});else{const t=e.data.domain===s.state.domain;s.setState({...s.state,domainState:t?e.data.domainState:s.state.domainState})}}))}(e,l,t,m)}),250)),[l,m,t]),I=(0,s.useCallback)((e=>{const t=(0,Nn.$U)(e.target.value);k(t),m.setState({...m.state,domain:t})}),[k,m]),T=(0,r.yK)((()=>({dangerZoneContainer:{display:"flex"},leaveButton:{marginRight:u?12:void 0},gap:{height:12}})),[u]);return d?(0,c.jsx)(bm,{}):(0,c.jsxs)(kt.ZP,{controlRow:u&&(0,c.jsx)(_m,{spaceStore:t,spaceBasicSettingsStore:m,securitySettingsStore:p}),controlRowPaddingTopBottom:14,children:[u&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Cm,{}),(0,c.jsx)(hm,{spaceStore:t,spaceBasicSettingsStore:m}),(0,kt.Um)(),(0,c.jsx)(ym,{spaceStore:t,spaceBasicSettingsStore:m}),(0,kt.Um)()]}),(y||x)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(jm,{}),y&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Tm,{securitySettingsStore:p,spaceStore:t,isControlledByOrganization:Boolean(n.enable_ai_feature)}),(0,kt.Um)()]}),x&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Zm,{securitySettingsStore:p,spaceStore:t}),(0,kt.Um)()]})]}),(0,c.jsx)(Mm,{}),g&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.guestLimitedAccessMessage",defaultMessage:"You are currently a guest in this workspace. Ask an admin to add you as a member in order to see other pages."})}),(0,kt.Um)()]}),S&&u&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Vu,{canAdminSpaceStore:u,domainIsAutogenerated:null==v?void 0:v.domainIsAutogenerated,spaceStore:t,spaceBasicSettingsStore:m,handleSpaceUrlChange:I}),(0,kt.Um)()]}),u&&b&&(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)(fe.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.title",defaultMessage:"Allowed email domains"})}),(0,c.jsx)(Pm,{spaceStore:t,spaceBasicSettingsStore:m}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.caption",defaultMessage:"Anyone with email addresses at these domains can automatically join your workspace."})}),(0,kt.Um)()]}),S&&u&&(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)(Hu,{spaceBasicSettingsStore:m}),(0,kt.Um)()]}),j&&(0,c.jsx)(Fu,{handleExportClick:()=>function(e){const{currentSpaceStore:t}=Ge.default.state;t&&Aa.q$({environment:e,root:{table:"space",id:t.id,spaceId:t.id},isCollectionViewExportTypeSupported:!0})}(l)}),u&&(0,c.jsx)(Sm,{}),u&&(0,c.jsx)(xm,{spaceStore:t,spaceBasicSettingsStore:m,organizationOverrides:n}),(0,c.jsx)(fe.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.title",defaultMessage:"Danger zone"})}),(0,c.jsxs)("div",{style:T.dangerZoneContainer,children:[(C.length>1||g)&&(0,c.jsx)(yt.Z,{isLarge:!0,onClick:()=>function(e,t){const{currentUserSettingsStore:n}=Ge.default.state;n&&M.showDialog({message:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.prompt",defaultMessage:"Are you sure you want to leave this workspace?"}),showCancel:!0,keepFocus:!0,items:[{label:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.leaveButton.label",defaultMessage:"Leave"}),color:"red",onAccept:async()=>{await w.bf({environment:t,spaceId:e.id,userSettingsStore:n})&&(Si.z0(t),rt.Z.setState({...rt.Z.state,open:!1}))}}]})}(t,l),style:T.leaveButton,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.leaveWorkspaceButton.label",defaultMessage:"Leave workspace"})}),u&&(0,c.jsx)(Fm,{spaceStore:e.spaceStore})]}),u&&(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)("div",{style:T.gap}),(0,c.jsx)(Qi.Z,{title:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceHelpButton.caption",defaultMessage:"Learn about deleting workspaces."}),href:(0,ze.UY)("guides.deleteWorkspace"),analyticsFrom:"space_settings"})]})]})}function hm(e){let{spaceStore:t,spaceBasicSettingsStore:n}=e;const i=(0,a.VK)((()=>n.state.name),[n]),o=(0,s.useCallback)((e=>{n.setState({...n.state,name:e.target.value})}),[n]),l=(0,r.yK)((()=>({label:{marginTop:4}})),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(fe.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.title",defaultMessage:"Name"})}),(0,c.jsx)(Cs.Z,{value:i,placeholder:V.default.formatMessage(gm.nameInputPlaceholder),readOnly:!1,onChange:o}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:l.label,children:(0,c.jsx)(pm,{})})]})}function ym(e){let{spaceStore:t,spaceBasicSettingsStore:n}=e;const o=(0,i.O7)(),l=(0,a.VK)((()=>(0,Nn.Wd)(o,t)),[o,t]),d=(0,a.VK)((()=>n.state.name),[n]),u=(0,a.VK)((()=>({recordTable:t.table,source:"workspace_settings"})),[t]),m=(0,s.useCallback)((e=>{P.createAndCommit({userAction:"SpaceBasicSettings.handleRecordIconChange",environment:o,perform:n=>{Hn.sO({store:t.getIconStore(),value:e,transaction:n})}})}),[o,t]),p=(0,r.yK)((e=>({iconContainer:{width:72,height:72,border:`1px solid ${e.regularDividerColor}`,borderRadius:6,display:"flex",justifyContent:"center",alignItems:"center"},label:{marginTop:8}})),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(fe.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.title",defaultMessage:"Icon"})}),(0,c.jsx)("div",{style:p.iconContainer,children:(0,c.jsx)(hs.Z,{bucket:"public",disabled:!1,icon:l,isEmptyPage:!1,title:d,size:64,iconLoggingData:u,onChange:m})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:p.label,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.caption",defaultMessage:"Upload an image or pick an emoji. It will show up in your sidebar and notifications."})})]})}function xm(e){let{spaceStore:t,spaceBasicSettingsStore:n,organizationOverrides:o}=e;const l=(0,i.O7)(),{isMobile:d}=l.device,u=(0,a.VK)((()=>t.getSettings().disable_page_analytics),[t]),m=Boolean(o.disable_page_analytics),p=(0,a.VK)((()=>n.state.name),[n]),g=(0,s.useCallback)((()=>{if(m)return;const e=!u;P.createAndCommit({userAction:"SpaceBasicSettings.analyticsSettings.onSelectOption",environment:l,perform:n=>{Hn.sW({store:t,data:{settings:{...t.getSettings(),disable_page_analytics:e}},transaction:n})}}),Su.K4(l,e?"page_analytics_workspace_opt_out":"page_analytics_workspace_opt_in")}),[u,l,m,t]),h=(0,r.yK)((()=>({toggleContainer:{display:"flex",gap:12,flexDirection:"column"}})),[]);return(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)(fe.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.analytics.title",defaultMessage:"Analytics"})}),(0,c.jsxs)("div",{style:h.toggleContainer,children:[(0,c.jsx)(Ds.Z,{isMobile:d,title:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.title",defaultMessage:"Save and display page view analytics"}),caption:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.description",defaultMessage:"People with edit or full access will be able to see how many views a page has. If this is turned off, page views will not be stored for all pages in {workspaceName}.",values:{workspaceName:p}}),type:"toggle",isOn:!u,isLocked:m,lockedTooltip:(0,$n.g)(),onToggle:g}),(0,c.jsx)(Qi.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Learn about workspace analytics.",id:"spaceBasicSettings.workspaceAnalytics.helpButton.caption"}),href:(0,ze.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq"})]}),(0,kt.Um)()]})}function Sm(){const e=(0,i.O7)(),t=(0,f.useIntl)(),n=(0,a.VK)((()=>{const e=Ht.subscriptionDataStoreInstance.state,t=(0,bt.zt)();return!!e&&("subscribed_admin"===e.type&&("enterprise"===t||"business"===t))}),[]),o=(0,s.useCallback)((()=>{!function(e,t){const{currentSpaceStore:n}=Ge.default.state,s=Ht.subscriptionDataStoreInstance.state;n&&s&&"subscribed_admin"===s.type&&Aa.$G(t,{spaceStore:n,subscriptionData:s,intl:e})}(t,e)}),[e,t]),l=(0,r.yK)((()=>({header:{display:"flex",alignItems:"center"},title:{marginRight:8},desktop:{marginTop:-1},button:{display:"flex"},gap:{height:12}})),[]);return(0,c.jsxs)(s.Fragment,{children:[(0,c.jsxs)(fe.Z,{style:l.header,children:[(0,c.jsx)("span",{style:l.title,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.title",defaultMessage:"Export members"})}),!n&&(0,c.jsx)(ao.Z,{subscriptionTier:"business",analyticsName:"space_export_members",desktopStyle:l.desktop})]}),(0,c.jsx)("div",{style:l.button,children:(0,c.jsx)(yt.Z,{isLarge:!0,disabled:!n,onClick:o,disabledFeedback:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.exportAsCSVButton.label",defaultMessage:"Export members as CSV"})})}),(0,c.jsx)("div",{style:l.gap}),(0,c.jsx)(Qi.Z,{title:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.helpButton.caption",defaultMessage:"Learn about exporting members."}),href:(0,ze.UY)("guides.exportMembers"),analyticsFrom:"space_settings"}),(0,kt.Um)()]})}const vm=s.memo(fm);function bm(){return(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(Ce.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.offlineMessage",defaultMessage:"Please go online to manage settings."})})})}function Mm(){return(0,c.jsx)(fe.Z,{large:!0,divider:"full",style:{paddingTop:12},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.public.subtitle",defaultMessage:"Public settings"})})}function jm(){return(0,c.jsx)(fe.Z,{large:!0,divider:"full",style:{paddingTop:12},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.feature.subtitle",defaultMessage:"Feature settings"})})}function Cm(){return(0,c.jsx)(fe.Z,{large:!0,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.title",defaultMessage:"Workspace settings"})})}async function wm(e,t,n){const{currentUserSettingsStore:s}=Ge.default.state;if(!s)return;const i=(0,Nn.rn)(n,e)||t.formatMessage({defaultMessage:"Untitled workspace",id:"spaceBasicSettings.deleteWorkspace.untitledWorkspace.placeholder"}),o=(0,fu.xf)(Po.SP)?(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.prompt",defaultMessage:"This action cannot be undone. This will permanently delete the workspace, including all pages and files. Please type the name of the workspace to confirm."}):(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(_u.Z,{translations:{es:"Esta acción no se puede deshacer. Esto eliminará permanentemente el espacio de trabajo, incluidas todas las páginas y archivos. Por favor escriba el nombre del espacio de trabajo para confirmar.",ru:"Это действие не может быть отменено. Это навсегда удалит рабочее пространство, включая все страницы и файлы. Пожалуйста, введите название рабочей области для подтверждения.",zh:"此操作无法撤消。 这将永久删除工作区，包括所有页面和文件。 请输入要确认的工作空间的名称。",de:"Diese Aktion kann nicht rückgängig gemacht werden. Dadurch wird der Arbeitsbereich einschließlich aller Seiten und Dateien dauerhaft gelöscht. Bitte geben Sie den Namen des Arbeitsbereichs zur Bestätigung ein.",fr:"Cette action ne peut pas être annulée. Cela supprimera définitivement l'espace de travail, y compris toutes les pages et tous les fichiers. Veuillez saisir le nom de l'espace de travail pour confirmer.",ja:"この操作を元に戻すことはできません。 これにより、すべてのページとファイルを含むワークスペースが完全に削除されます。 確認するワークスペースの名前を入力してください。",it:"Questa azione non può essere annullata. Questo eliminerà definitivamente l'area di lavoro, incluse tutte le pagine e i file. Digita il nome dell'area di lavoro per confermare.",pt:"Essa ação não pode ser desfeita. Isso excluirá permanentemente o espaço de trabalho, incluindo todas as páginas e arquivos. Por favor, digite o nome do espaço de trabalho para confirmar.",nl:"Deze actie kan niet ongedaan gemaakt worden. Hiermee wordt de werkruimte permanent verwijderd, inclusief alle pagina's en bestanden. Typ de naam van de werkruimte om te bevestigen.",pl:"Tego działania nie można cofnąć. Spowoduje to trwałe usunięcie obszaru roboczego, w tym wszystkich stron i plików. Wpisz nazwę obszaru roboczego, aby potwierdzić.",sv:"Den här åtgärden kan inte ångras. Detta tar bort arbetsytan permanent, inklusive alla sidor och filer. Vänligen skriv in arbetsplatsens namn för att bekräfta.",uk:"Цю дію не можна скасувати. Це дозволить остаточно видалити робочу область, включаючи всі сторінки та файли. Введіть назву робочої області для підтвердження.",no:"Denne handlingen kan ikke fortrykkes. Dette vil permanent slette arbeidsområdet, inkludert alle sider og filer. Vennligst skriv navnet på arbeidsområdet for å bekrefte.",tr:"Bu işlem geri alınamaz. Bu, tüm sayfaları ve dosyaları içeren çalışma alanını kalıcı olarak siler. Lütfen onaylamak için çalışma alanının adını yazın.",cs:"Tuto akci nelze vrátit zpět. Tím se trvale odstraní pracovní prostor včetně všech stránek a souborů. Zadejte prosím název pracovního prostoru, který chcete potvrdit.",vi:"Hành động này không thể được hoàn tác. Điều này sẽ xóa vĩnh viễn không gian làm việc, bao gồm tất cả các trang và tệp. Vui lòng nhập tên của không gian làm việc để xác nhận.",da:"Denne handling kan ikke fortrydes. Dette vil permanent slette arbejdsområdet, inklusive alle sider og filer. Indtast navnet på arbejdsområdet for at bekræfte.",hu:"Ez a művelet nem visszavonható. Ez véglegesen törli a munkaterületet, beleértve az összes oldalt és fájlt. Kérjük, írja be a munkaterület nevét a megerősítéshez.",ar:"لا يمكن التراجع عن هذا الإجراء. سيؤدي ذلك إلى حذف مساحة العمل كليا ، بما يشمل جميع الصفحات والملفات. يرجى كتابة اسم مساحة العمل للتأكيد.",th:"การกระทำนี้ไม่สามารถยกเลิกได้ นี่จะเป็นการลบพื้นที่ทำงานอย่างถาวรรวมถึงหน้าและไฟล์ทั้งหมด โปรดพิมพ์ชื่อของพื้นที่ทำงานเพื่อยืนยัน",he:"לא ניתן לבטל פעולה זו. פעולה זו תמחק לצמיתות את סביבת העבודה, כולל כל הדפים והקבצים. הקלד את שם מרחב העבודה כדי לאשר.",fi:"Tätä toimintoa ei voi peruuttaa. Tämä poistaa työtilan pysyvästi, mukaan lukien kaikki sivut ja tiedostot. Vahvista kirjoittamalla työtilan nimi.",id:"Tindakan ini tidak bisa dibatalkan. Ini akan secara permanen menghapus ruang kerja, termasuk semua halaman dan file. Silakan ketik nama ruang kerja untuk mengonfirmasi."}})});await yu.b({title:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.title",defaultMessage:"Delete this entire workspace permanently?"}),message:(0,c.jsx)("div",{children:(0,c.jsx)("div",{children:o})}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.deleteWorkspaceButton.label",defaultMessage:"Permanently delete workspace"}),requiredInputValue:i})&&(w.Ns({environment:n,spaceId:e.id,userSettingsStore:s}),Si.BP(n),rt.Z.setState({...rt.Z.state,open:!1}))}function km(){rt.Z.setState({...rt.Z.state,open:!1}),Xe.setState(Xe.getInitialState())}function Im(e){var t;const{spaceStore:n,currentAddOns:s}=e,i=n.canAdmin(),o=p.de(s);return i&&o&&vu.Z.isWorkspaceLeapEligible()||(null===(t=n.getModel())||void 0===t?void 0:t.isAiLeapEnabledOnSpace())}function Tm(e){let{securitySettingsStore:t,spaceStore:n,isControlledByOrganization:s}=e;const i=(0,a.VK)((()=>(0,Nn.CV)(n)),[n]),o=(0,a.VK)((()=>!i&&Boolean(null==t?void 0:t.state.enableAiFeature)),[i,t]);return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(je.Z,{placement:ke.u.Bottom,alignment:ke.v.Start,textWrap:!0,style:{maxWidth:240},disableTooltip:!i,renderTooltip:()=>i?(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.aiFeature.hipaaTooltip",defaultMessage:"Notion AI is not currently available for HIPAA compliant workspaces."}):void 0,render:e=>(0,c.jsx)("div",{children:(0,c.jsxs)("div",{...e,style:{display:"flex",alignItems:"center",cursor:i?"not-allowed":"pointer"},onClick:()=>{s||async function(e,t){var n;const s=(null===(n=Ht.subscriptionDataStoreInstance.state)||void 0===n?void 0:n.addOns)??[],i=p.de(s),o=!t.state.enableAiFeature;if(!o&&i&&!(await M.confirmUserActionV2({message:V.default.formatMessage(gm.turnOffAiWhenSubscribedToAiWarning),acceptLabel:V.default.formatMessage(gm.turnOffAiWhenSubscribedToAccept)})).accept)return;t&&!e&&t.setState({...t.state,enableAiFeature:o})}(i,t)},children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.aiFeature.label",defaultMessage:"Notion AI"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.aiFeature.ga.caption",defaultMessage:"Enable to provide AI-powered functionality for all members of your workspace.{br}By enabling Notion AI, you are agreeing to the <inlinelink>Notion AI Supplementary Terms</inlinelink>",values:{br:(0,c.jsx)("br",{}),inlinelink:e=>(0,c.jsx)(Rs.Z,{href:"https://notion.notion.site/fa9034c8b5a04818a6baf3eac2adddbb",external:!0,onClick:e=>e.stopPropagation(),children:e})}})})]}),(0,c.jsx)("div",{style:{marginTop:5},children:(0,c.jsx)(al.Z,{on:o,disabled:i,isLocked:s,lockedTooltip:(0,$n.g)()})})]})})})})}function Zm(e){let{securitySettingsStore:t,spaceStore:n}=e;const s=(0,a.VK)((()=>Boolean(t.state.enableAiTraining)),[t]);return(0,c.jsx)("div",{children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},onClick:()=>{!function(e){var t;const{securitySettingsStore:n,spaceStore:s}=e,i=(null===(t=Ht.subscriptionDataStoreInstance.state)||void 0===t?void 0:t.addOns)??[],o=!n.state.enableAiTraining;Im({spaceStore:s,currentAddOns:i})&&n.setState({...n.state,enableAiTraining:o})}({spaceStore:n,securitySettingsStore:t})},children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.aiLeap.label",defaultMessage:"Share data to improve Notion AI"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.aiLeap.description",defaultMessage:"Help improve Notion’s AI models by allowing data from across this workspace to be shared with Notion.{br}By enabling AI LEAP (Learning and Early Access Program) you are agreeing to the <inlinelink>Notion AI LEAP Supplementary Terms</inlinelink>. <learnmore>Learn more</learnmore>.",values:{br:(0,c.jsx)("br",{}),learnmore:e=>(0,c.jsx)(Rs.Z,{href:"https://www.notion.so/help/notion-ai-leap-program-faqs",external:!0,onClick:e=>e.stopPropagation(),children:e}),inlinelink:e=>(0,c.jsx)(Rs.Z,{href:"https://notion.notion.site/0c55d702d0154a788d9e70c4ee396399",external:!0,onClick:e=>e.stopPropagation(),children:e})}})})]}),(0,c.jsx)("div",{style:{marginTop:5},children:(0,c.jsx)(al.Z,{on:s})})]})})}function Pm(e){let{spaceStore:t,spaceBasicSettingsStore:n}=e;const o=(0,i.O7)(),r=(0,f.useIntl)(),{device:l}=o,[d,u]=(0,s.useState)(""),m=(0,a.VK)((()=>n.state.emailDomains),[n]),p=(0,a.VK)((()=>t.canAdmin()),[t]),g=(0,a.VK)((()=>Ht.subscriptionDataStoreInstance.state),[]),h=(0,s.useCallback)((e=>{u(e.target.value)}),[]);return(0,c.jsx)(ws.ZP,{popupType:l.isMobile?os.k.SlideUp:os.k.Popup,sameWidthAsOrigin:!0,open:d.length>0,origin:(0,c.jsx)($u.Z,{placeholder:r.formatMessage(gm.allowedEmailDomainsInputPlaceholder),value:d,onChange:h,readOnly:!p,onRemoveLastToken:()=>{const e=m.slice(0,m.length-1);n.setState({...n.state,emailDomains:e})},tokens:m.map((e=>(0,c.jsx)(zl.Z,{showRemoveButton:!0,isSingle:!1,format:wr.lo.Medium,onClickRemove:()=>{const t=m.filter((t=>t!==e));n.setState({...n.state,emailDomains:t})},value:e},e)))}),render:()=>{const e=d.trim(),s=(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholder",defaultMessage:"Type an email domain…"}),i=(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholderNoResults",defaultMessage:"Type an email domain of a member of this workspace…"}),o=g?Gt.hn(g).map((e=>{if(("unsubscribed_admin"===g.type||"unsubscribed_member"===g.type||"subscribed_admin"===g.type)&&g.joinedMemberIds.includes(e.userId)){const n=oe.U6.createChildStore(t,{table:D.KJ,id:e.userId}).getEmail();return n&&(0,sr.Gd)(n)}})).filter(((e,t,n)=>Boolean(e&&t===n.indexOf(e)&&!m.includes(e)))):[],a=(0,Bd.ZP)(e,o,(e=>e)).map(((e,t)=>({key:t,render:t=>(0,c.jsx)(ms.Z,{...t,title:e}),action:()=>{const t=[...m,e];n.setState({...n.state,emailDomains:t}),u("")}})));let r;return r=l.isMobile?{menuType:cs.og.ActionSheet}:{menuType:cs.og.Popup,width:"100%"},(0,c.jsx)(ps.Z,{...r,children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:a.length>0?0:void 0,sections:[{key:0,render:e=>(0,c.jsx)(ys.Z,{...e,disableDesktopPadding:!0,title:a.length>0?s:i}),items:a}]})})},onDismiss:()=>{u("")}})}function Fm(e){let{spaceStore:t}=e;const n=(0,i.O7)(),o=(0,f.useIntl)(),[r,l]=s.useState(!1),d=(0,a.VK)((()=>(0,bt.zt)()),[]);return(0,c.jsxs)(c.Fragment,{children:[r?(0,c.jsx)(Tu,{currentProduct:(0,gu.KE)(d),isOpen:r,onClose:()=>l(!1),onConfirmDelete:async()=>await wm(t,o,n)}):null,(0,c.jsx)(yt.Z,{isLarge:!0,isRed:!0,onClick:async()=>await async function(e){const{environment:t,spaceStore:n,intl:s,showDowngradeModal:i}=e,o=Ht.subscriptionDataStoreInstance.state,a=Gt.XX(o);if(hu.YO(t),a)return void i();await wm(n,s,t)}({environment:n,spaceStore:t,intl:o,showDowngradeModal:()=>l(!0)}),children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceButton.label",defaultMessage:"Delete entire workspace"})})]})}function _m(e){let{spaceStore:t,spaceBasicSettingsStore:n,securitySettingsStore:o}=e;const r=(0,i.O7)(),l=(0,s.useCallback)((()=>async function(e,t,n,s){await w.Y5({environment:e,spaceId:t.id,domain:n.state.domain})&&(await w.OF({environment:e,spaceStore:t,spaceBasicSettingsStore:n,securitySettingsStore:s}),Xe.setState(Xe.getInitialState()),rt.Z.setState({...rt.Z.state,open:!1}),bu.Z.resetData(e,{spaceId:t.id}))}(r,t,n,o)),[r,t,n,o]),d=(0,a.VK)((()=>!function(e){const{domain:t,domainState:n}=e.state;return!!t&&("available"===n||"current-space"===n)}(n)),[n]);return(0,c.jsxs)("div",{style:{display:"flex"},children:[(0,c.jsx)(Bs.Z,{isLarge:!0,onClick:l,disabled:d,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.updateButton.label",defaultMessage:"Update"})}),(0,c.jsx)(yt.Z,{isLarge:!0,style:{marginLeft:12},onClick:km,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.cancelButton.label",defaultMessage:"Cancel"})})]})}function Am(e){return(0,pu.E)("functional_space_basic_settings")?(0,c.jsx)(vm,{...e}):(0,c.jsx)(Xu,{...e})}const Bm=s.memo(Am);var Rm=n(368840),Dm=n(353471),Om=n(397832),Lm=n(690403),Vm=n(365252),Em=n(778873);let Nm=function(e){return e.Password="Password",e.CurrentEmail="TemporaryPasscode",e}({});class Um extends N.default{getInitialState(){return{open:!1,authorized:!1,authorizationType:void 0}}}const Km=Um;var Wm=n(483785);const zm={modal:{width:460,padding:32,borderRadius:4,fontSize:14},loadingSpinner:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},paragraph:{marginTop:12,marginBottom:14},error:{color:is.ZP.red,fontSize:12,marginTop:4,marginLeft:8},bold:{fontWeight:y.Z.fontWeight.bold},input:{padding:"4px 8px"},button:{marginTop:14,width:"100%"},educationPlanWarning:{display:"flex",marginTop:14,paddingTop:14},claimedEmailDomainWarning:{marginTop:14,marginBottom:14}},qm=(0,f.defineMessages)({dialogLabel:{id:"profileSettings.accountSecuritySection.emailSetting.dialogLabel",defaultMessage:"Change email"}});const Gm=function(e){let{userValue:t,hasEducationPlan:n,areProfileEditsDisabled:o}=e;const r=(0,i.O7)(),l=(0,f.useIntl)(),d=(0,a.qz)(void 0,Km),u=(0,s.useCallback)((()=>(0,c.jsx)(pp,{userValue:t,hasEducationPlan:n,emailChangeStore:d})),[t,n,d]),m=(0,s.useCallback)((()=>ep(r,n,d)),[r,n,d]),p=(0,a.VK)((()=>d.state.open),[d]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ds.Z,{type:"custom",isMobile:!1,title:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.accountSecuritySection.emailSetting.label",defaultMessage:"Email"}),caption:t&&t.email,customButton:(0,c.jsx)(sp,{userValue:t,areProfileEditsDisabled:o,emailChangeStore:d})}),(0,c.jsx)(Hs.Z,{ariaLabel:l.formatMessage(qm.dialogLabel),open:p,onDismiss:m,render:u})]})};function Hm(e){let{userValue:t}=e;return t?(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.currentEmail",defaultMessage:"Your current email is {currentEmail}.",values:{currentEmail:(0,c.jsx)("span",{style:zm.bold,children:t&&t.email})}}):null}function $m(e){let{state:t}=e;return(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:zm.claimedEmailDomainWarning,children:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.claimedEmailDomainWarning",defaultMessage:"The email domain {newEmailDomain} has been claimed by an organization. If you continue with changing this email address, any workspaces created by this account can be managed by the organization. See <domainclaimlink>this page</domainclaimlink> for more info.",values:{newEmailDomain:(0,sr.Gd)(t.newEmail)??t.newEmail,domainclaimlink:e=>(0,c.jsx)(Rs.Z,{href:(0,ze.UY)("guides.domainManagement"),external:!0,children:e})}})})}function Ym(e){return{modal:{background:e.contentBackground},educationPlanWarning:{color:e.lightTextColor,borderTop:`1px solid ${e.regularDividerColor}`}}}function Qm(e){let{hasEducationPlan:t}=e;const n=(0,r.Fg)(),s=(0,i.O7)();return t?(0,c.jsxs)("div",{style:{...zm.educationPlanWarning,...Ym(n).educationPlanWarning},children:[(0,di.m)({width:14,marginTop:4,marginRight:6,fill:n.lightIconColor})," ",(0,c.jsx)("div",{children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Changing your email may downgrade your workspace on a Free Education Plan to the basic Free Plan. You won't lose any data, but you'll need to upgrade to re-access paid features. Have questions about this? <sendmessagelink>Message support</sendmessagelink>.",id:"emailChangeSettings.downgradeEducationPlan.warning.message",values:{sendmessagelink:e=>(0,c.jsx)(Rs.Z,{onClick:()=>function(e){Vo.j({environment:e,from:"change_email_student"})}(s),children:e})}})})]}):null}function Jm(e,t,n){if(e)return e.email;n.setState({open:n.state.open,authorized:!1,authorizationType:void 0,error:t.formatMessage({id:"profileSettings.changeEmailModal.errorNoUserValue",defaultMessage:"User value is undefined."})})}async function Xm(e,t,n){if(!n.state.authorized)return;const s=(0,sr.Gd)(n.state.newEmail);n.setState({...n.state,loading:!0});const[i,o]=await Promise.all([await I.sendEmailVerification(e,{email:n.state.newEmail}),s?await I.getVerifiedEmailDomain(e,{emailDomain:s}):void 0]);if("success"===i.type){const e=(0,Zn.$K)(o)&&"failed"===o.type?(0,L.wf)(t,o):void 0;n.setState({...n.state,newEmailPasscodeSent:!0,newEmailPasscode:"",error:e,loading:!1,newEmailContainsVerifiedDomain:(0,Zn.$K)(o)&&"success"===o.type&&void 0!==o.data.id})}else n.setState({...n.state,loading:!1,error:(0,L.wf)(t,i)})}async function ep(e,t,n){n.reset(),t&&await ct.bi(e)}async function tp(e,t,n,s){if(!s.state.authorized)if(s.state.authorizationType===Nm.Password){if(!Jm(t,n,s))return;s.setState({...s.state,loading:!0});const i=await I.authVerifyPassword(e,{password:s.state.password});if("failed"===i.type)return void s.setState({...s.state,loading:!1,error:(0,L.wf)(n,i)});s.setState({...s.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0,loading:!1})}else s.state.authorizationType===Nm.CurrentEmail&&s.setState({...s.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0,loading:!1})}async function np(e,t,n,s){if(!s.state.authorized)return;const i=s.state.authorizationType===Nm.Password?{type:"Password",password:s.state.password,newEmail:s.state.newEmail,newEmailPasscode:s.state.newEmailPasscode}:{type:"CurrentEmail",currentEmailPasscode:s.state.currentEmailPasscode,newEmail:s.state.newEmail,newEmailPasscode:s.state.newEmailPasscode};s.setState({...s.state,loading:!0});const o=await I.changeEmail(e,i);if("success"===o.type)hu.tx(e,{new_email:s.state.newEmail,error:void 0}),s.setState({...s.state,loading:!1}),await ep(e,t,s);else{const t=(0,L.wf)(n,o);hu.tx(e,{new_email:s.state.newEmail,error:t}),s.setState({...s.state,loading:!1,error:t})}}function sp(e){let{userValue:t,areProfileEditsDisabled:n,emailChangeStore:i}=e;const o=(0,s.useCallback)((()=>{i.setState({open:!0,authorized:!1,authorizationType:void 0})}),[i]),a=(0,c.jsx)(yt.Z,{isLarge:!0,onClick:n?()=>{}:o,disabled:n,disabledFeedback:n,children:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.accountSecuritySection.emailSetting.changeEmailButton.label",defaultMessage:"Change email"})});return n?(0,c.jsx)(je.Z,{renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:t?(0,sr.Gd)(t.email):""}}),placement:ke.u.Bottom,alignment:ke.v.Center,render:e=>(0,c.jsx)("div",{...e,children:a})}):a}function ip(e){let{state:t,userValue:n,emailChangeStore:o}=e;const a=(0,i.O7)(),r=(0,f.useIntl)(),l=(0,s.useCallback)((()=>tp(a,n,r,o)),[a,n,r,o]),d=(0,s.useCallback)((()=>{o.setState({open:!0,authorized:!1,authorizationType:Nm.Password,password:""})}),[o]),u=(0,s.useCallback)((e=>function(e,t){t.setState({open:!0,authorized:!1,authorizationType:Nm.Password,password:e.currentTarget.value,error:void 0})}(e,o)),[o]);return n?(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)("p",{style:{margin:0},children:(0,c.jsx)(Hm,{userValue:n})}),(0,c.jsx)("p",{style:zm.paragraph,children:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.enterPasswordInstructions",defaultMessage:"Please enter your password."})}),(0,c.jsx)(Cs.Z,{style:{display:"none"},type:"text",value:n.email,autoComplete:"username",disabled:!0}),(0,c.jsx)(Cs.Z,{type:"password",disabled:t.authorized,value:t.password,onChange:u,showClearButton:!0,onClearButtonClick:d,onSubmit:l,placeholder:r.formatMessage({id:"profileSettings.changeEmailModal.passwordInput.label",defaultMessage:"Password"}),style:zm.input,focusInitial:!0,autoComplete:"current-password"}),!t.authorized&&t.error&&(0,c.jsx)("div",{style:zm.error,children:t.error}),!t.authorized&&(0,c.jsx)(Bs.Z,{isLarge:!0,style:zm.button,onClick:l,disabled:t.loading,children:t.loading?(0,c.jsx)(zi.Z,{}):(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue"})})]}):null}function op(e){let{userValue:t,emailChangeStore:n}=e;const o=(0,i.O7)(),r=(0,f.useIntl)(),l=(0,s.useCallback)((()=>async function(e,t,n,s){if(!t)return;s.setState({...s.state,loading:!0});const i=await I.sendEmailVerification(e,{email:t.email});"success"===i.type?s.setState({...s.state,currentEmailPasscodeSent:!0,currentEmailPasscode:"",error:void 0,loading:!1}):s.setState({...s.state,currentEmailPasscodeSent:!0,loading:!1,error:(0,L.wf)(n,i)})}(o,t,r,n)),[o,t,r,n]),d=(0,a.VK)((()=>n.state.loading),[n]);return(0,c.jsx)(Bs.Z,{isLarge:!0,onClick:l,disabled:d,children:d?(0,c.jsx)(zi.Z,{}):(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.sendCurrentEmailVerificationCode.label",defaultMessage:"Send verification code"})})}function ap(e){let{state:t,userValue:n,emailChangeStore:o}=e;const a=(0,i.O7)(),r=(0,f.useIntl)(),l=(0,s.useCallback)((()=>tp(a,n,r,o)),[a,n,r,o]),d=(0,s.useCallback)((e=>function(e,t){t.setState({...t.state,currentEmailPasscode:e.currentTarget.value,error:void 0})}(e,o)),[o]);return(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)(Cs.Z,{value:t.currentEmailPasscode,onChange:d,onSubmit:l,placeholder:r.formatMessage({id:"profileSettings.changeEmailModal.enterCurrentEmailVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:zm.input}),!t.authorized&&(0,c.jsx)(Bs.Z,{isLarge:!0,style:zm.button,onClick:l,disabled:t.loading,children:t.loading?(0,c.jsx)(zi.Z,{}):(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue"})})]})}function rp(e){let{emailChangeStore:t}=e;const n=(0,i.O7)(),o=(0,f.useIntl)(),r=(0,s.useCallback)((()=>{var e;(e=t).setState({...e.state,newEmail:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0})}),[t]),l=(0,s.useCallback)((()=>Xm(n,o,t)),[n,o,t]),d=(0,s.useCallback)((e=>function(e,t){t.setState({...t.state,newEmail:e.currentTarget.value,error:void 0})}(e,t)),[t]),u=(0,a.VK)((()=>t.state),[t]);return u.authorized?(0,c.jsx)(Cs.Z,{value:u.newEmail,onChange:d,onSubmit:l,showClearButton:!0,onClearButtonClick:r,placeholder:o.formatMessage({id:"profileSettings.changeEmailModal.newEmailInput.placeholder",defaultMessage:"Enter new email"}),style:zm.input,focusInitial:!0}):null}function lp(e){let{state:t,emailChangeStore:n}=e;const o=(0,i.O7)(),a=(0,f.useIntl)(),r=(0,s.useCallback)((()=>Xm(o,a,n)),[o,a,n]);return(0,c.jsxs)(s.Fragment,{children:[t.error&&(0,c.jsx)("div",{style:zm.error,children:t.error}),(0,c.jsx)(Bs.Z,{isLarge:!0,style:zm.button,onClick:r,disabled:t.loading,children:t.loading?(0,c.jsx)(zi.Z,{}):(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeButton.label",defaultMessage:"Send verification code"})})]})}function dp(e){let{state:t,userValue:n,emailChangeStore:i}=e;return(0,c.jsxs)(s.Fragment,{children:[(0,c.jsxs)("p",{style:{...zm.paragraph,marginTop:0},children:[(0,c.jsx)(Hm,{userValue:n})," ",t.currentEmailPasscodeSent?(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.sentVerificationCodeToCurrentEmail",defaultMessage:"We've sent a temporary verification code to this email."}):(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeToCurrentEmail",defaultMessage:"We'll send a temporary verification code to this email."})]}),t.currentEmailPasscodeSent?(0,c.jsx)(ap,{userValue:n,emailChangeStore:i,state:t}):(0,c.jsx)(op,{userValue:n,emailChangeStore:i})]})}function cp(e,t,n,s,i){if(!i.state.authorized)return()=>{};if(i.state.newEmailContainsVerifiedDomain&&(0,sr.Gd)(i.state.newEmail)!==(0,sr.Gd)((null==t?void 0:t.email)||"")){const t=i.state.newEmail;return async()=>{const o=await function(e){return M.confirmUserAction({message:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.title",defaultMessage:"Are you sure you want to change your email?"}),description:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.description",defaultMessage:"If you continue changing this email address to this domain, any workspaces created by this account can be managed by the organization.",values:{verifiedDomain:(0,sr.Gd)(e)}}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.acceptButton.label",defaultMessage:"Change email"}),cancelLabel:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.cancelButton.label",defaultMessage:"Go back"})})}(t);o&&await np(e,n,s,i)}}return()=>np(e,n,s,i)}function up(e){let{state:t,userValue:n,hasEducationPlan:o,store:r}=e;const l=(0,i.O7)(),d=(0,f.useIntl)(),u=(0,s.useCallback)((e=>function(e,t){t.setState({...t.state,newEmailPasscode:e.currentTarget.value,error:void 0})}(e,r)),[r]),m=(0,a.VK)((()=>cp(l,n,o,d,r)),[l,n,o,d,r]);return(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)("p",{style:zm.paragraph,children:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.verificationCodeSentMessage",defaultMessage:"We just sent you a temporary verification code to {newEmail}.",values:{newEmail:(0,c.jsx)("span",{style:zm.bold,children:t.newEmail})}})}),(0,c.jsx)(Cs.Z,{value:t.newEmailPasscode,onChange:u,onSubmit:m,placeholder:d.formatMessage({id:"profileSettings.changeEmailModal.enterVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:zm.input}),t.error&&(0,c.jsx)("div",{style:zm.error,children:t.error}),(0,c.jsx)(Bs.Z,{isLarge:!0,style:zm.button,onClick:m,disabled:t.loading,children:t.loading?(0,c.jsx)(zi.Z,{}):(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.changeEmailButton.label",defaultMessage:"Change email"})})]})}function mp(e){let{state:t,userValue:n,hasEducationPlan:i,emailChangeStore:o}=e;const r=(0,a.VK)((()=>o.state),[o]);if(!r.authorized)return null;const{newEmail:l,newEmailContainsVerifiedDomain:d,newEmailPasscodeSent:u}=r;return(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)("p",{style:zm.paragraph,children:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.changeEmailModal.newEmailInstructions",defaultMessage:"Please enter a new email and we will send you a verification code."})}),(0,c.jsx)("div",{children:(0,c.jsx)(rp,{emailChangeStore:o})}),d&&(0,sr.Gd)(l)!==(0,sr.Gd)((null==n?void 0:n.email)||"")&&(0,c.jsx)($m,{state:t}),u?(0,c.jsx)(up,{userValue:n,hasEducationPlan:i,store:o,state:t}):(0,c.jsx)(lp,{emailChangeStore:o,state:t}),(0,c.jsx)(Qm,{hasEducationPlan:i})]})}function pp(e){let{userValue:t,hasEducationPlan:n,emailChangeStore:o}=e;const l=(0,f.useIntl)(),d=(0,r.Fg)(),u=(0,i.O7)(),m=(0,s.useCallback)((()=>async function(e,t,n,s){const i=Jm(n,t,s);if(!i)return;const o=await Em.c({environment:e,userEmail:i});o.error?s.setState({open:s.state.open,authorized:!1,authorizationType:void 0,error:t.formatMessage({id:"profileSettings.changeEmailModal.errorFetchingAccountData",defaultMessage:"Could not fetch account information for {currentEmail}."},{currentEmail:i})}):o.value.isSamlEnforced||!o.value.hasPassword?s.setState({open:!0,authorized:!1,authorizationType:Nm.CurrentEmail,currentEmailPasscodeSent:!1,currentEmailPasscode:""}):s.setState({open:!0,authorized:!1,authorizationType:Nm.Password,password:""})}(u,l,t,o)),[u,l,t,o]),p=(0,a.VK)((()=>o.state),[o]);return(0,c.jsx)("div",{style:{...zm.modal,...Ym(d).modal},children:(0,c.jsx)(Wm.Z,{fetch:m,loading:e=>e?(0,c.jsx)("div",{style:zm.loadingSpinner,children:(0,c.jsx)(zi.Z,{})}):null,render:()=>(0,c.jsxs)(s.Fragment,{children:[p.authorizationType===Nm.Password?(0,c.jsx)(ip,{userValue:t,emailChangeStore:o,state:p}):p.authorizationType===Nm.CurrentEmail?(0,c.jsx)(dp,{userValue:t,emailChangeStore:o,state:p}):void 0,p.authorized&&(0,c.jsx)(mp,{userValue:t,hasEducationPlan:n,emailChangeStore:o,state:p})]})})})}var gp=n(10020);class fp extends N.default{getInitialState(){return{open:!1}}}const hp=new fp;const yp=function(){const e=(0,i.O7)(),{iconStyle:t}=(0,r.yK)((e=>({iconStyle:{width:20,height:20,fill:e.lightIconColor}})),[]),n=(0,c.jsx)(f.FormattedMessage,{id:"manageActiveSessions.title",defaultMessage:"Log out of all devices"}),s=(0,c.jsx)(f.FormattedMessage,{id:"manageActiveSessions.logOutActiveSessions.label",defaultMessage:"Log out of all other active sessions on other devices besides this one."});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ds.Z,{type:"custom",isMobile:!1,title:n,caption:s,customButton:(0,c.jsx)(Me.Z,{style:{borderRadius:"0.25em"},onClick:async()=>{b.AQ(e),await I.logoutActiveSessions(e,{}),hp.setState({...hp.state,open:!0})},children:(0,gp.C)(t)})}),(0,c.jsx)(Sp,{})]})};function xp(){hp.setState({...hp.state,open:!1})}function Sp(){const e=(0,a.VK)((()=>hp.state.open),[]),t=(0,a.VK)((()=>function(){let e;const{currentUserStore:t}=Ge.default.state;return t&&(e=t.getEmail()),e}()),[]);return(0,c.jsx)(Hs.Z,{open:e,onDismiss:xp,innerStyle:{width:350,padding:24,display:"flex",flexDirection:"column"},render:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{marginBottom:24},children:t?(0,c.jsx)(f.FormattedMessage,{id:"manageActiveSessions.confirmationModal.withEmail",defaultMessage:"You have been logged out from other active sessions for {email}.",values:{email:t}}):(0,c.jsx)(f.FormattedMessage,{id:"manageActiveSessions.confirmationModal.withoutEmail",defaultMessage:"You have been logged out from other active sessions for your account."})}),(0,c.jsx)(Bs.Z,{onClick:xp,children:(0,c.jsx)(f.FormattedMessage,{id:"manageActiveSessions.confirmationModal.close",defaultMessage:"Close"})})]})})}var vp=n(801799),bp=n(616010);class Mp extends N.default{getInitialState(){return{step:"backupCodesUninitialized"}}}class jp extends bp.o{constructor(e,t){super(e,"backupCodes"),this.service=void 0,this.service=t}backupCodesInitialSetup(e){if(!this.checkStep("backupCodesUninitialized"))return;const{onLoadingComplete:t,onComplete:n}=e;this.store.setState({step:"backupCodesLoading"}),this.doCreateBackupCodes({forceRecreate:!1,onComplete:n,onLoadingComplete:t}).catch(this.handleUnexpectedError)}backupCodesShowCreate(){this.checkStep("backupCodesUninitialized")&&this.store.setState({step:"backupCodesRegenerateCodes"})}backupCodesRegenerateCodes(){this.checkStep("backupCodesRegenerateCodes")&&(this.store.setState({step:"backupCodesRegenerateCodes",isLoading:!0}),this.doCreateBackupCodes({forceRecreate:!0,onComplete:()=>{},onLoadingComplete:()=>{}}).catch(this.handleUnexpectedError))}exit(){this.store.setState({step:"backupCodesUninitialized"})}async doCreateBackupCodes(e){const{forceRecreate:t,onComplete:n,onLoadingComplete:s}=e,i=await this.withStep(["backupCodesLoading","backupCodesRegenerateCodes"],(()=>this.service.createBackupCodes(t)));if(!i)return;const{result:o}=i;if("already-exists"===o.status)n();else{const e=function(e){const t=V.default.getIntl(),n=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.title",defaultMessage:"Notion Backup Codes"}),s=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.createdAt",defaultMessage:"Created at {createdAt}"},{createdAt:`${new Date}`}),i=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.warningMessage",defaultMessage:"Please store these in a secure location and mark off codes as they are used."}),o=`${n}\n${s}\n\n${e.map(vp.K).join("\n")}\n\n${i}\n`;return encodeURIComponent(o)}(o.backupCodes);this.store.setState({step:"backupCodesShowCodes",backupCodes:o.backupCodes,mfaSettingId:o.mfaSettingId,backupCodesFile:e}),s()}}}var Cp=n(375752),wp=n(188175);function kp(e){let{errorMessage:t,isLoading:n,onDisplayBackupCodes:s,onCancel:i,onDismiss:o}=e;const a=(0,c.jsx)(f.FormattedMessage,{id:"mfa.regenerateBackupCodes.title",defaultMessage:"Regenerate backup codes"}),r=(0,c.jsx)(f.FormattedMessage,{id:"mfa.regenerateBackupCodes.message",defaultMessage:"Backup codes are used to log in if you lose access to your password and second factors. <boldtext>Your existing codes won't work after regenerating new ones.</boldtext>",values:{boldtext:e=>(0,c.jsx)("span",{style:{fontWeight:y.Z.fontWeight.semibold},children:e})}}),l={text:n?(0,c.jsx)(zi.Z,{}):(0,c.jsx)(f.FormattedMessage,{id:"mfa.regenerateBackupCodes.regenerateBackupCodes.button.message",defaultMessage:"Generate new backup codes"}),onClick:s,view:"outline",disabled:n,isRed:!0},d=[{text:(0,c.jsx)(f.FormattedMessage,{id:"mfa.regenerateBackupCodes.cancel.button.message",defaultMessage:"Cancel"}),onClick:i,view:"outline",type:"button"}];return(0,c.jsx)(wp.Z,{title:a,header:r,errorMessage:t,primaryAction:l,secondaryActions:d,onDismiss:o})}var Ip=n(245656);function Tp(e){let{backupCodes:t,backupCodeDownload:n,backupCodeFileName:s,errorMessage:i,onNoted:o,onDownload:a}=e;const r=(0,c.jsx)(f.FormattedMessage,{id:"mfa.showBackupCodes.title",defaultMessage:"Save your backup codes"}),l=(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(f.FormattedMessage,{id:"mfa.showBackupCodes.message",defaultMessage:"<boldtext>You can only see this once</boldtext>, so be sure to keep them to avoid getting locked out of your account.",values:{boldtext:e=>(0,c.jsx)("span",{style:{fontWeight:y.Z.fontWeight.semibold},children:e})}})}),d={text:(0,c.jsx)(f.FormattedMessage,{id:"mfa.showBackupCodes.codesNotedDown.button.message",defaultMessage:"I've saved them"}),onClick:o},u=[{text:(0,c.jsx)(f.FormattedMessage,{id:"mfa.showBackupCodes.downloadAsTextFile.button.message",defaultMessage:"Download as text file"}),href:`data:text/plain;charset=UTF-8,${n}`,saveAs:s,view:"outline",type:"link",onClick:a}];return(0,c.jsx)(wp.Z,{title:r,header:l,errorMessage:i,primaryAction:d,secondaryActions:u,children:(0,c.jsx)(Ip.Z,{type:"unencryptedCodes",backupCodes:t})})}function Zp(e){const{backupCodesStateMachine:t,onGoToSettings:n,onDismiss:s}=e,i=t.useCurrentStep(),o=()=>t.backupCodesRegenerateCodes();switch(i.step){case"backupCodesUninitialized":case"backupCodesLoading":return null;case"backupCodesRegenerateCodes":return(0,c.jsx)(kp,{isLoading:i.isLoading,errorMessage:i.error,onDisplayBackupCodes:o,onDismiss:s,onCancel:n});case"backupCodesShowCodes":return(0,c.jsx)(Tp,{errorMessage:i.error,backupCodes:i.backupCodes,backupCodeDownload:i.backupCodesFile,backupCodeFileName:"Notion Backup Codes.txt",onNoted:n});default:return(0,Zn.t1)(i)}}var Pp=n(764898),Fp=n(303338);function _p(e){let{type:t,errorMessage:n,onDismiss:s,onAddMethod:i}=e;const o=(0,r.yK)(Ap,[]),a=(0,c.jsx)(f.FormattedMessage,{id:"mfa.setupComplete.confirmation.header",defaultMessage:"Every time you enter your password, Notion will ask you for a verification code to confirm your identity."}),l=[{text:(0,c.jsx)(f.FormattedMessage,{id:"mfa.setupComplete.confirmation.viewTwoStepMethods.button.message",defaultMessage:"View 2-step methods"}),onClick:i,type:"button",view:"outline"}];return(0,c.jsx)(wp.Z,{title:"totp"===t?(0,c.jsx)(f.FormattedMessage,{id:"mfa.totp.setupComplete.confirmation.title",defaultMessage:"2-step verification with authenticator is turned on"}):"sms"===t?(0,c.jsx)(f.FormattedMessage,{id:"mfa.sms.setupComplete.confirmation.title",defaultMessage:"2-step verification with phone number is turned on"}):(0,Zn.t1)(t),header:a,errorMessage:n,icon:(0,Fp.p)(o.confirmationIcon),secondaryActions:l,onDismiss:s})}function Ap(e){return(0,r.EM)({confirmationIcon:{width:30,fill:"green"}})}n(430541);var Bp=n(304387);const Rp={name:"United States",countryCode:"1",regionCode:"US"};function Dp(e){let{isLoading:t,phoneNumber:n,country:i,errorMessage:o,onDismiss:l,onBack:d,onContinue:u}=e;const m=(0,r.yK)(Op,[]),p=(0,f.useIntl)(),[g,h]=(0,s.useState)(n??""),[y,x]=(0,s.useState)([]),[S,v]=(0,s.useState)(""),[b,M]=(0,s.useState)(i??Rp),j=(0,a.qz)(void 0,Na.Z),C=(0,s.useMemo)((()=>(0,Bp.PG)(b.regionCode)),[b.regionCode]),w=(0,s.useCallback)((e=>{const t=e.target.value.replace(/\D/g,"");h(C.reset(t))}),[C]);(0,s.useEffect)((()=>{h(i!==b?C.reset(g??""):C.reset(n??""));const e=new Intl.DisplayNames(["en"],{type:"region"}),t=(0,Bp.wJ)();let s=-1;const o=t.map(((t,n)=>{const i=(0,Bp.t7)(t).toString(),o=e.of(t);return t===b.regionCode&&(s=n),{name:o??t,countryCode:i,regionCode:t}}));-1!==s&&o.unshift(o.splice(s,1)[0]),x(o)}),[b]);const I=(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneTitle",defaultMessage:"Add a phone number"}),T=(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneHeader",defaultMessage:"Enter your phone number to receive a 2-step verification code."}),Z={text:t?(0,c.jsx)(zi.Z,{}):(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.mfa.sms.continueButton",defaultMessage:"Continue"}),onClick:()=>u(b,g.trim()),disabled:t||""===g},P=[{text:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneNeedHelp",defaultMessage:"Need help?"}),href:(0,ze.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}],F=p.formatMessage({id:"profileSettings.mfa.sms.phoneNumberInput.placeholder",defaultMessage:"Enter phone number"}),_=p.formatMessage({defaultMessage:"Search country code",id:"profileSettings.mfa.sms.countryCodeSelect.placeholder"}),A=e=>(0,c.jsxs)("div",{style:m.countryCodeSelectTitle,children:[e.name,(0,c.jsx)(Ce.Z,{isSmall:!0,children:`+${e.countryCode}`})]}),B=(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,placementToOrigin:xd.Iw.Bottom,alignmentToOrigin:xd.lU.Start,buttonPopupStore:j,renderOrigin:e=>(0,c.jsx)(yt.Z,{...e,children:`+${b.countryCode}`}),render:e=>(0,c.jsx)(ps.Z,{menuType:cs.og.Popup,minWidth:280,maxHeight:"30vh",header:(0,c.jsx)(ys.Z,{isInput:!0,children:(0,c.jsx)(ul.ZP,{value:S,onChange:e=>v(e.target.value),focus:!0,focusAfterAnimation:!0,placeholder:_})}),children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:0,sections:[{key:"countries",render:e=>(0,c.jsx)(ys.Z,{...e}),items:(0,Bd.ZP)(S,y,(e=>/\d/.test(S)?`${e.countryCode}`:e.name)).map((t=>({key:t.regionCode,render:e=>(0,c.jsx)(ms.Z,{...e,title:A(t),right:t.name===b.name?(0,ar.k)(m.selectedCountryCodeIcon):void 0}),action:()=>{v(""),M(t),e.close()}})))}]})})});return(0,c.jsx)(wp.Z,{onDismiss:l,onBack:d,title:I,header:T,errorMessage:o,primaryAction:Z,secondaryActions:P,children:(0,c.jsxs)("div",{style:m.container,children:[(0,c.jsx)("div",{style:m.countryCodeDropdownMenu,children:B}),(0,c.jsx)(Cs.Z,{autoFocus:!0,value:g,placeholder:F,spellCheck:!1,style:m.phoneNumberInput,onChange:w,disabled:t,customElementAttributes:k.pf})]})})}function Op(e){return(0,r.EM)({container:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:16,marginBottom:4},countryCodeDropdownMenu:{marginRight:5},selectedCountryCodeIcon:{width:15,height:15},countryCodeSelectTitle:{paddingTop:8,paddingBottom:8},phoneNumberInput:{background:"light"===e.mode?is.ZP.transparent:e.inputBackground}})}var Lp=n(256839);function Vp(e){const{smsStateMachine:t,onGoToSettings:n,onDismiss:s,onStartBackupCodes:i}=e,o=t.useCurrentStep();switch(o.step){case"smsUninitialized":case"smsVerified":return null;case"smsSendingSMS":case"smsSetPhoneNumber":return(0,c.jsx)(Dp,{phoneNumber:o.phoneNumber,country:o.country,isLoading:"smsSendingSMS"===o.step,errorMessage:o.error,onDismiss:s,onBack:n,onContinue:(e,n)=>t.smsCreateSMS(e,n)});case"smsVerifyCode":case"smsResendSMS":case"smsBackupCodesLoading":case"smsVerifying":return(0,c.jsx)(Lp.ZP,{isLoading:"smsVerifying"===o.step||"smsBackupCodesLoading"===o.step,errorMessage:o.error,phoneNumber:`+${o.country.countryCode} ${o.phoneNumber}`,onDismiss:s,onBack:()=>t.smsRestart(),onVerifyCode:e=>t.smsVerifyCode({code:e,onVerified:i}),resentStatus:"smsResendSMS"===o.step?"resending":"resentAt"in o&&void 0!==o.resentAt?"resent":"not-resent",resentAt:"resentAt"in o&&o.resentAt?o.resentAt:0,onResendLink:()=>t.smsResendSMS()});case"smsComplete":return(0,c.jsx)(_p,{type:"sms",errorMessage:o.error,onAddMethod:n,onDismiss:s});default:return(0,Zn.t1)(o)}}function Ep(e){const{placeholder:t,value:n,maxlength:s,style:i,onChange:o}=e,a=(0,r.yK)((e=>(0,r.EM)({input:{background:is.ZP.transparent,color:e.darkTextColor,...i}})),[i]);return(0,c.jsx)(Cs.Z,{value:n,placeholder:t,maxlength:s,style:a.input,inputStyle:y.Z.textOverflowStyle,autoFocus:!0,spellCheck:!1,onChange:o,autoComplete:"off",customElementAttributes:k.pf})}function Np(e){let{isLoading:t,qrCode:n,friendlyName:i,errorMessage:o,onDismiss:a,onBack:l,onCantScanCode:d,onContinue:u}=e;const m=(0,r.yK)(Up,[]),p=(0,f.useIntl)(),[g,h]=(0,s.useState)(i??""),y=(0,s.useCallback)((e=>{h(e.target.value)}),[h]),x=(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeTitle",defaultMessage:"Scan code in authenticator app"}),S=(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeHeader",defaultMessage:"Generate a verification code with an authenticator app, then enter a name to remember it by."}),v={text:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.mfa.totp.continueButton",defaultMessage:"Continue"}),onClick:()=>u(g),disabled:!n||t||0===g.length},b=[{text:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.mfa.totp.cantScanCodeButton",defaultMessage:"Can't scan code?"}),onClick:d,type:"button",view:"plain",disabled:t}],M=p.formatMessage({id:"profileSettings.mfa.totp.authenticatorNameInput.placeholder",defaultMessage:"Enter authenticator name"});return(0,c.jsx)(wp.Z,{onDismiss:a,onBack:l,title:x,header:S,errorMessage:o,primaryAction:v,secondaryActions:b,children:(0,c.jsxs)("div",{style:m.body,children:[(0,c.jsx)("div",{style:m.qrCodeContainer,children:n?(0,c.jsx)("img",{style:m.qrCode,src:n}):(0,c.jsx)(zi.Z,{})}),(0,c.jsx)(Ep,{placeholder:M,value:g,maxlength:30,onChange:y})]})})}function Up(e){return(0,r.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},qrCodeContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:116,height:116,marginBottom:15},qrCode:{width:"100%"}})}function Kp(e){let{textCode:t,friendlyName:n,errorMessage:i,isLoading:o,onDismiss:a,onBack:l,onUseQrCode:d,onContinue:u}=e;const m=(0,r.yK)(Wp,[]),[p,g]=(0,s.useState)(n??""),h=(0,f.useIntl)(),y=(0,s.useCallback)((e=>{g(e.target.value)}),[g]),x=(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.mfa.totp.typeTextCodeTitle",defaultMessage:"Type code from authenticator app"}),S=(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.mfa.totp.typeText.message",defaultMessage:"Input this setup key in your authenticator app, then enter a name to remember it by.",values:{authenticatorlink:e=>(0,c.jsx)(Rs.Z,{external:!0,href:(0,ze.UY)("guides.mfa"),children:e})}}),v={text:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.mfa.totp.continueButton",defaultMessage:"Continue"}),onClick:()=>u(p),disabled:o||0===p.length},b=[{text:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeButton",defaultMessage:"Scan QR code"}),onClick:d,type:"button",view:"plain",disabled:o}],M=h.formatMessage({id:"profileSettings.mfa.totp.authenticatorNameInput",defaultMessage:"Enter authenticator name"});return(0,c.jsx)(wp.Z,{onDismiss:a,onBack:l,title:x,header:S,errorMessage:i,primaryAction:v,secondaryActions:b,children:(0,c.jsxs)("div",{style:m.body,children:[(0,c.jsx)("div",{style:m.content,children:(0,c.jsx)("div",{style:m.textCode,children:t})}),(0,c.jsx)(Ep,{placeholder:M,value:p,maxlength:30,onChange:y})]})})}function Wp(e){return(0,r.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},textCode:{fontWeight:y.Z.fontWeight.medium,fontSize:y.Z.fontSize.UIRegular.desktop,color:e.darkTextColor,textAlign:"center",verticalAlign:"middle"},content:{display:"flex",flexDirection:"column",justifyContent:"center",height:50,marginBottom:15}})}var zp=n(18469);function qp(e){const{totpStateMachine:t,onGoToSettings:n,onStartBackupCodes:s,onDismiss:i}=e,o=t.useCurrentStep();switch(o.step){case"totpUninitialized":case"totpVerified":return null;case"totpLoadingQRCode":case"totpDisplayQRCode":const e="totpLoadingQRCode"===o.step?{isLoading:!0,qrCode:void 0}:{isLoading:o.isLoading,qrCode:o.qrCode};return(0,c.jsx)(Np,{...e,friendlyName:"totpDisplayQRCode"===o.step?o.friendlyName:void 0,errorMessage:o.error,onDismiss:i,onBack:n,onCantScanCode:()=>t.totpDisplayTextCode(),onContinue:e=>t.totpDisplayVerification(e)});case"totpDisplayTextCode":return(0,c.jsx)(Kp,{textCode:o.rawString,friendlyName:o.friendlyName,errorMessage:o.error,isLoading:o.isLoading,onDismiss:i,onBack:n,onUseQrCode:()=>t.totpDisplayQRCode(),onContinue:e=>t.totpDisplayVerification(e)});case"totpVerifyCode":case"totpBackupCodesLoading":case"totpVerifying":return(0,c.jsx)(zp.ZP,{isLoading:"totpVerifying"===o.step||"totpBackupCodesLoading"===o.step,errorMessage:o.error,onDismiss:i,onBack:()=>t.totpDisplayQRCode(),onVerifyCode:e=>t.totpVerifyCode({code:e,onVerified:s})});case"totpComplete":return(0,c.jsx)(_p,{type:"totp",errorMessage:o.error,onDismiss:i,onAddMethod:n});default:return(0,Zn.t1)(o)}}function Gp(e){const{rootStateMachine:t,settingsStateMachine:n,totpStateMachine:i,smsStateMachine:o,backupCodesStateMachine:a,onReloadSettings:r}=e,l=t.useCurrentStep(),[{showSettings:d,onRootExit:u}]=(0,s.useState)((()=>({onRootExit:()=>t.exit((()=>{n.exit(),i.exit(),o.exit(),a.exit(),r&&r()})),showSettings:()=>t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{n.settingsConfirmIdentityForSettings()}})}))),m=()=>t.rootCloseSettings((()=>{n.exit(),r&&r()})),p=()=>t.rootStartTOTP((()=>i.totpStart())),g=()=>t.rootStartSMS((()=>o.smsStart())),f=()=>{t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{i.exit(),n.settingsShow({refresh:!0})}})},h=()=>{t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{o.exit(),n.settingsShow({refresh:!0})}})},y=()=>{a.exit(),t.rootEndBackupCodes({completeTotp:()=>{i.totpComplete()},completeSMS:()=>{o.smsComplete()},showSettings:d})},x=()=>{a.backupCodesInitialSetup({onLoadingComplete:()=>{i.totpBackupCodesComplete(),t.rootShowBackupCodesFromTOTP()},onComplete:()=>{i.totpBackupCodesComplete(),i.totpComplete(),y()}})},S=()=>{a.backupCodesInitialSetup({onLoadingComplete:()=>{o.smsBackupCodesComplete(),t.rootShowBackupCodesFromSMS()},onComplete:()=>{o.smsBackupCodesComplete(),o.smsComplete(),y()}})},v=()=>{t.rootStartBackupCodesFromSettings((()=>a.backupCodesShowCreate()))},b=n.useCurrentStep(),M=i.useCurrentStep(),j=o.useCurrentStep(),C=a.useCurrentStep();let w;switch(l.step){case"rootUninitialized":break;case"rootSettings":w={open:"settingsUninitialized"!==b.step,onDismiss:u,render:()=>(0,c.jsx)(Pp.Z,{settingsStateMachine:n,onDismiss:m,onStartTOTP:p,onStartSMS:g,onStartBackupCodes:v})};break;case"rootTOTP":w={open:"totpUninitialized"!==M.step,onDismiss:u,render:()=>(0,c.jsx)(qp,{totpStateMachine:i,onGoToSettings:f,onStartBackupCodes:x,onDismiss:u})};break;case"rootSMS":w={open:"smsUninitialized"!==j.step,onDismiss:u,render:()=>(0,c.jsx)(Vp,{smsStateMachine:o,onGoToSettings:h,onStartBackupCodes:S,onDismiss:u})};break;case"rootBackupCodes":w={open:"backupCodesUninitialized"!==C.step,onDismiss:"backupCodesRegenerateCodes"===C.step?u:void 0,render:()=>(0,c.jsx)(Zp,{backupCodesStateMachine:a,onGoToSettings:y,onDismiss:u})};break;default:throw(0,Zn.t1)(l)}return w?(0,c.jsx)(Hs.Z,{...w,preventHideChildrenWhileOpening:!0}):null}class Hp extends N.default{getInitialState(){return{step:"rootUninitialized"}}}class $p extends bp.o{constructor(e){super(e,"root")}rootShowSettings(e){const{refresh:t,startConfirmIdentity:n}=e;if(this.checkStep("rootSettings")){if(!t)return}else this.store.setState({step:"rootSettings"});n()}rootStartBackupCodesFromSettings(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootBackupCodes",source:"settings"}),e())}rootStartTOTP(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootTOTP"}),e())}rootShowBackupCodesFromTOTP(){this.checkStep("rootTOTP")&&this.store.setState({step:"rootBackupCodes",source:"totp"})}rootStartSMS(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootSMS"}),e())}rootShowBackupCodesFromSMS(){this.checkStep("rootSMS")&&this.store.setState({step:"rootBackupCodes",source:"sms"})}rootEndBackupCodes(e){const t=this.checkStep("rootBackupCodes");if(t)switch(t.source){case"settings":return this.store.setState({step:"rootSettings"}),e.showSettings();case"sms":return this.store.setState({step:"rootSMS"}),e.completeSMS();case"totp":return this.store.setState({step:"rootTOTP"}),e.completeTotp();default:(0,Zn.t1)(t.source)}}rootCloseSettings(e){e(),this.store.setState({step:"rootUninitialized"})}exit(e){this.store.setState({step:"rootUninitialized"}),e()}}var Yp=n(924173),Qp=n(801681);class Jp extends N.default{getInitialState(){return{step:"smsUninitialized"}}}class Xp extends bp.o{constructor(e,t){super(e,"sms"),this.service=void 0,this.service=t}smsStart(){this.checkStep("smsUninitialized")&&this.store.setState({step:"smsSetPhoneNumber"})}smsRestart(){const e=this.checkStep(["smsResendSMS","smsVerifyCode","smsVerifying"]);e&&this.store.setState({step:"smsSetPhoneNumber",country:e.country,phoneNumber:e.phoneNumber,error:void 0})}smsCreateSMS(e,t){this.checkStep("smsSetPhoneNumber")&&(this.store.setState({country:e,phoneNumber:t,step:"smsSendingSMS"}),this.doCreateSMS().catch(this.handleUnexpectedError))}smsResendSMS(){const e=this.checkStep(["smsVerifyCode","smsVerifying"]);e&&(this.store.setState({...e,step:"smsResendSMS",error:void 0}),this.doResendSMS().catch(this.handleUnexpectedError))}smsVerifyCode(e){const{code:t,onVerified:n}=e,s=this.checkStep("smsVerifyCode");s&&(this.store.setState({...s,step:"smsVerifying",error:void 0}),this.doVerifyCode({code:t,onVerified:n}).catch(this.handleUnexpectedError))}smsBackupCodesComplete(){this.checkStep("smsBackupCodesLoading")&&this.store.setState({step:"smsVerified"})}smsComplete(){this.checkStep("smsVerified")&&this.store.setState({step:"smsComplete"})}exit(){this.store.setState({step:"smsUninitialized"})}async doCreateSMS(){const e=await this.withStep("smsSendingSMS",(e=>this.service.createSMS(e.country.countryCode,e.phoneNumber)));if(!e)return;const{result:t,state:n}=e;switch(t.status){case"created":this.store.setState({...n,step:"smsVerifyCode",mfaSettingId:t.mfaSettingId,error:void 0});break;case"already_verified_phone_number":this.store.setState({step:"smsSetPhoneNumber",error:Qp.Qj.smsAlreadyVerifiedPhoneNumber});break;case"invalid_country_code":this.store.setState({step:"smsSetPhoneNumber",error:Qp.Qj.smsInvalidCountryCode});break;case"invalid_phone_number":this.store.setState({step:"smsSetPhoneNumber",error:Qp.Qj.smsInvalidPhoneCode});break;case"sms_unsupported_country_code_for_enrollment":this.store.setState({step:"smsSetPhoneNumber",error:Qp.Qj.smsUnsupportedCountryCodeForEnrollment});break;default:return(0,Zn.t1)(t)}}async doVerifyCode(e){const{code:t,onVerified:n}=e,s=await this.withStep("smsVerifying",(e=>this.service.verifySMS({mfaSettingId:e.mfaSettingId,code:t})));if(!s)return;const{result:i,state:o}=s;switch(i.status){case"match":this.store.setState({step:"smsBackupCodesLoading",country:o.country,phoneNumber:o.phoneNumber}),n();break;case"error":this.store.setState({...o,step:"smsVerifyCode",error:Qp.Qj.unexpectedError});break;case"incorrect":this.store.setState({...o,step:"smsVerifyCode",error:Qp.Qj.smsIncorrectCode});break;default:return(0,Zn.t1)(i.status)}}async doResendSMS(){const e=await this.withStep("smsResendSMS",(e=>this.service.sendSMS({mfaSettingId:e.mfaSettingId})));if(!e)return;const{result:t,state:n}=e;switch(t.status){case"ok":this.store.setState({...n,step:"smsVerifyCode",mfaSettingId:n.mfaSettingId,error:void 0,resentAt:Date.now()});break;case"error":this.store.setState({...n,step:"smsVerifyCode",mfaSettingId:n.mfaSettingId,error:Qp.Qj.unexpectedError});break;default:return(0,Zn.t1)(t.status)}}}class eg extends N.default{getInitialState(){return{step:"totpUninitialized"}}}class tg extends bp.o{constructor(e,t){super(e,"totp"),this.service=void 0,this.service=t}totpStart(){this.checkStep("totpUninitialized")&&(this.store.setState({step:"totpLoadingQRCode"}),this.doCreateTOTP().catch(this.handleUnexpectedError))}totpDisplayTextCode(){const e=this.getCurrentStep();switch(e.step){case"totpDisplayQRCode":case"totpVerifyCode":this.store.setState({...e,step:"totpDisplayTextCode",error:void 0,isLoading:!1})}}totpDisplayQRCode(){const e=this.getCurrentStep();switch(e.step){case"totpDisplayTextCode":case"totpVerifyCode":this.store.setState({...e,step:"totpDisplayQRCode",error:void 0,isLoading:!1})}}totpDisplayVerification(e){this.checkStep(["totpDisplayQRCode","totpDisplayTextCode"])&&this.doRenameTOTP(e).catch(this.handleUnexpectedError)}totpVerifyCode(e){const{code:t,onVerified:n}=e,s=this.checkStep("totpVerifyCode");s&&(this.store.setState({...s,step:"totpVerifying",error:void 0}),this.doVerifyCode({code:t,onVerified:n}).catch(this.handleUnexpectedError))}totpBackupCodesComplete(){this.checkStep("totpBackupCodesLoading")&&this.store.setState({step:"totpVerified"})}totpComplete(){this.checkStep("totpVerified")&&this.store.setState({step:"totpComplete"})}exit(){this.store.setState({step:"totpUninitialized"})}async doCreateTOTP(){const e=await this.withStep("totpLoadingQRCode",(()=>this.service.createTOTP()));if(!e)return;const{result:t}=e;this.store.setState({step:"totpDisplayQRCode",qrCode:t.qrCode,rawString:t.secret,mfaSettingId:t.mfaSettingId,isLoading:!1})}async doRenameTOTP(e){const t=await this.withStep(["totpDisplayQRCode","totpDisplayTextCode"],(t=>this.service.renameSettings({mfaSettingId:t.mfaSettingId,friendlyName:e})));if(!t)return;const{result:n,state:s}=t;switch(n.status){case"saved":this.store.setState({...s,step:"totpVerifyCode",friendlyName:e,error:void 0});break;case"duplicate":this.store.setState({...s,isLoading:!1,error:Qp.Qj.totpDuplicateFriendlyName});break;case"empty":this.store.setState({...s,isLoading:!1,error:Qp.Qj.totpEmptyFriendlyName});break;case"bad_friendly_name":this.store.setState({...s,isLoading:!1,error:Qp.Qj.totpBadFriendlyName});break;default:return(0,Zn.t1)(n)}}async doVerifyCode(e){const{code:t,onVerified:n}=e,s=await this.withStep("totpVerifying",(e=>this.service.verifyTOTP({mfaSettingId:e.mfaSettingId,code:t})));if(!s)return;const{result:i,state:o}=s;switch(i.status){case"match":this.store.setState({step:"totpBackupCodesLoading"}),n();break;case"error":this.store.setState({...o,step:"totpVerifyCode",error:Qp.Qj.unexpectedError});break;case"incorrect":this.store.setState({...o,step:"totpVerifyCode",error:Qp.Qj.totpIncorrectCode});break;default:return(0,Zn.t1)(i.status)}}}function ng(e){let{status:t,numMfaSettings:n,onReloadSettings:o,regenerateBackupCodes:l}=e;const d=(0,i.O7)(),[{rootStateMachine:u,settingsStateMachine:m,totpStateMachine:p,smsStateMachine:g,backupCodesStateMachine:h}]=(0,s.useState)((()=>{const e=new Cp.r(d),t={totpStore:new eg,settingsStore:new Yp.c,smsStore:new Jp,backupCodesStore:new Mp,rootStore:new Hp};return{mfaService:e,rootStateMachine:new $p(t.rootStore),settingsStateMachine:new Yp.W(t.settingsStore,e),totpStateMachine:new tg(t.totpStore,e),smsStateMachine:new Xp(t.smsStore,e),backupCodesStateMachine:new jp(t.backupCodesStore,e)}})),x=d.device.isMobile,S=(0,r.yK)((e=>({configureButton:{marginTop:x?12:0,marginBottom:x?4:0},regenerateBackupCodesBadge:{fontWeight:y.Z.fontWeight.medium,letterSpacing:0,fontSize:11,color:e.blueColor,background:"light"===e.mode?is.ZP.diffBackground:"rgba(35, 131, 226, 0.2)",whiteSpace:"nowrap",width:"fit-content"}})),[x]),v=(0,a.VK)((()=>rt.Z.state.highlightedSetting===rt.R.TwoStepVerification),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ds.Z,{type:"toggleToButton",isMobile:!1,title:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.label",defaultMessage:"2-step verification"}),caption:"on"===t?(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.settingConfigured.message",defaultMessage:"You have {numMfaSettings} verification methods turned on.",values:{numMfaSettings:n}}):(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.message",defaultMessage:"Add an additional layer of security to your account during login."}),isOn:"on"===t,buttonStyle:S.configureButton,buttonLabel:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSettingButton.label",defaultMessage:"Change verification methods"}),onClick:()=>{!function(e){let{rootStateMachine:t,settingsStateMachine:n}=e;t.rootShowSettings({refresh:!1,startConfirmIdentity:()=>n.settingsConfirmIdentityForSettings()})}({rootStateMachine:u,settingsStateMachine:m})},tooltipLabel:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSettingButton.tooltip",defaultMessage:"A password is required to enable 2-step verification"}),disableTooltip:"disabled"!==t,disabled:"disabled"===t,badge:l&&(0,c.jsx)(Lm.Z,{style:S.regenerateBackupCodesBadge,content:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.regenerateBackupCodes.badge",defaultMessage:"Regenerate backup codes"})}),shouldHighlight:v}),(0,c.jsx)(Gp,{onReloadSettings:o,rootStateMachine:u,settingsStateMachine:m,totpStateMachine:p,smsStateMachine:g,backupCodesStateMachine:h})]})}var sg=n(860857),ig=n(13490),og=n(830045);const ag=N.default.createClass(!1,{name:"IsEducationStore"});const rg=function(e){let{spaceProfileSettingsStore:t,isEducationPlan:n}=e;const o=(0,f.useIntl)(),r=(0,i.O7)(),l=(0,a.qz)(void 0,ag);return(0,s.useEffect)((()=>{!async function(){const{currentUserStore:e,currentUserSettingsStore:n,currentUserRootStore:s,currentSpaceStore:i}=Ge.default.state;if(e&&n){const s=t.getValueForUser(e,n,o);s&&t.setState({...t.state,...s})}if(s&&i){const e=await(0,Gt.Gh)({environment:r,userRootStore:s}),t=i.canAdmin()&&(e||[]).some((e=>e===ds.default.pricing.student.productId));l.setState(t)}await T(r,t)}()}),[r,o,l,t]),(0,s.useEffect)((()=>()=>{rt.Z.state.highlightedSetting&&rt.Z.setState({...rt.Z.state,highlightedSetting:void 0})}),[]),(0,a.VK)((()=>yn.Z.state.online),[])?(0,c.jsx)(fg,{spaceProfileSettingsStore:t,isEducationPlan:n,isEducationStore:l}):(0,c.jsx)(lg,{})};function lg(){return(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(Ce.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Please go online to manage your profile.",id:"profileSettings.offline.message"})})})}function dg(e){const{emailDomainForUser:t,spaceProfileSettingsStore:n,areProfileEditsDisabled:s}=e,i=(0,a.VK)((()=>{var e;return Boolean(null===(e=n.state.emailDomainSettings)||void 0===e?void 0:e.isDomainVerified)}),[n]);return(0,c.jsxs)(fe.Z,{large:!0,divider:"full",children:[i?(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",margin:"0 0 8px"},children:[(0,c.jsx)(Lm.Z,{style:{fontWeight:y.Z.fontWeight.medium,letterSpacing:0,whiteSpace:"nowrap",width:"fit-content",margin:0},content:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.myProfile.managedByline",defaultMessage:"Your account is managed by {domain}",values:{domain:t}})}),s?(0,c.jsx)(je.Z,{render:e=>(0,c.jsx)("div",{...e,children:(0,wi.D)({marginLeft:4,height:14,width:14,opacity:.5})}),renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.myProfile.managedByTooltip",defaultMessage:"Contact your organization's administrator to change your profile information."})}):null]}):null,(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.myProfile.title",defaultMessage:"My profile"})]})}function cg(e){let{spaceProfileSettingsStore:t}=e;const[n,s]=(0,a.VK)((()=>{var e;return[(null===(e=t.state.emailDomainSettings)||void 0===e?void 0:e.settings)??{},t.state.emailDomainSettings]}),[t]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(fe.Z,{large:!0,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.support.title",defaultMessage:"Support"})}),(0,c.jsx)(og.Z,{emailDomainSettings:n}),(0,c.jsx)(As.Z,{size:18,isHidden:!0}),(0,c.jsx)(yp,{}),(0,c.jsx)(As.Z,{size:18,isHidden:!0}),(0,c.jsx)(Om.Z,{userEmailDomainSettings:s})]})}function ug(e,t){b.He(t),Dm.cR({environment:t,onStart:()=>function(e){e.setState({...e.state,uploadingProfilePhoto:!0})}(e),bucket:"public",onError:()=>function(e){e.setState({...e.state,uploadingProfilePhoto:!1}),M.showErrorMessage((0,c.jsx)(f.FormattedMessage,{id:"profileSettings.profilePhotoSection.uploadProfilePhotoError.message",defaultMessage:"Upload failed."}))}(e),onComplete:n=>function(e,t,n){const s=e[0];t.setState({...t.state,profilePhoto:s,uploadingProfilePhoto:!1}),P.createAndCommit({userAction:"SpaceProfileSettings.handleUploadComplete",environment:n,perform:e=>{const{currentUserStore:t}=Ge.default.state;t&&S.A({userStore:t,data:{profilePhoto:s},transaction:e})}})}(n,e,t),accept:"image/*"})}function mg(e){const t=(0,i.O7)(),{userName:n,emailDomainForUser:s,areProfileEditsDisabled:o,spaceProfileSettingsStore:a}=e;return o?(0,c.jsx)(je.Z,{renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:s}}),placement:ke.u.Bottom,alignment:ke.v.Center,render:e=>(0,c.jsx)("div",{...e,style:{opacity:.4},children:(0,c.jsx)(Cs.Z,{disabled:!0,value:n})})}):(0,c.jsx)(Cs.Z,{value:n,onChange:e=>function(e,t,n){const s=e.target.value;b.O$(n,{from:t.state.name,to:s}),t.setState({...t.state,name:s}),P.createAndCommit({userAction:"SpaceProfileSettings.handleNameChange",environment:n,perform:e=>{const{currentUserStore:t}=Ge.default.state;t&&S.A({userStore:t,data:{name:s},transaction:e})}})}(e,a,t)})}function pg(e){let{currentUserValue:t,spaceProfileSettingsStore:n,isEducationPlan:o,isEducationStore:r}=e;const l=(0,i.O7)(),d=(0,a.VK)((()=>n.state.accountSettings),[n]),u=(0,a.VK)((()=>{var e;return Boolean(null===(e=n.state.emailDomainSettings)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.prevent_profile_edits)}),[n]),m=(0,s.useCallback)((()=>{T(l,n)}),[l,n]),p=(0,a.VK)((()=>r.state),[r]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(fe.Z,{large:!0,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.accountSecurity.title",defaultMessage:"Account security"})}),(0,c.jsx)(Gm,{userValue:t,hasEducationPlan:p,areProfileEditsDisabled:u}),(0,c.jsx)(As.Z,{size:18,isHidden:!0}),(0,c.jsx)(sg.Z,{hasPassword:d.hasPassword,hasPasswordActions:d.canConfigurePassword,isEducationPlan:o,samlEnforced:d.isSamlEnforced,email:t.email,isError:Boolean(d.error),onReloadSettings:m,mfaStatus:d.mfaStatus}),(0,c.jsx)(As.Z,{size:18,isHidden:!0}),(0,c.jsx)(ng,{status:d.mfaStatus,numMfaSettings:d.numMfaSettings,onReloadSettings:m,regenerateBackupCodes:d.regenerateBackupCodes})]})}function gg(e){const{userName:t,currentUserStore:n,currentUserValue:s,spaceProfileSettingsStore:o,isEducationPlan:l,isEducationStore:d}=e,u=(0,r.Fg)(),m=(0,i.O7)(),p=(0,f.useIntl)(),g=(0,a.VK)((()=>(0,Vm.N5)(n,p)),[n,p]),h=(0,sr.Gd)(s.email),y=(0,a.VK)((()=>{var e;return Boolean(null===(e=o.state.emailDomainSettings)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.prevent_profile_edits)}),[o]),x=(0,a.VK)((()=>yn.Z.state.online),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(dg,{spaceProfileSettingsStore:o,emailDomainForUser:h,areProfileEditsDisabled:y}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,c.jsx)(Vm.ZP,{size:60,avatarType:g,isOffline:!x,onUploadProfilePhoto:()=>ug(o,m),onRemoveProfilePhoto:()=>function(e,t){e.setState({...e.state,profilePhoto:void 0}),P.createAndCommit({userAction:"SpaceProfileSettings.handleRemoveProfilePhoto",environment:t,perform:e=>{const{currentUserStore:t}=Ge.default.state;t&&S.A({userStore:t,data:{profilePhoto:null},transaction:e})}})}(o,m),disabled:y,disabledTooltipMessage:(0,c.jsx)(f.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:h}})}),(0,c.jsxs)("div",{style:{marginLeft:20,width:250},children:[(0,c.jsx)(ig.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"profileSettings.personalInfoSection.nameInput.label",defaultMessage:"Preferred name"})}),(0,c.jsx)(mg,{spaceProfileSettingsStore:o,userName:t,emailDomainForUser:h,areProfileEditsDisabled:y})]})]}),"photo"!==g.type&&!y&&(0,c.jsx)("div",{style:{color:u.mediumIconColor,fontSize:14,marginTop:8},children:(0,c.jsx)(f.FormattedMessage,{id:"editableUserAvatar.profilePhoto.addPhoto",defaultMessage:"Add photo"})})]}),(0,c.jsx)(As.Z,{size:48,isHidden:!0}),(0,c.jsx)(pg,{spaceProfileSettingsStore:o,isEducationPlan:l,isEducationStore:d,currentUserValue:s}),(0,c.jsx)(As.Z,{size:48,isHidden:!0}),(0,c.jsx)(cg,{spaceProfileSettingsStore:o})]})}function fg(e){let{spaceProfileSettingsStore:t,isEducationPlan:n,isEducationStore:s}=e;const i=(0,a.VK)((()=>Ge.default.state.currentUserStore),[]),o=(0,a.VK)((()=>i?i.getValue():void 0),[i]),r=(0,a.VK)((()=>t.state.name),[t]);return i&&o?(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(gg,{spaceProfileSettingsStore:t,isEducationPlan:n,isEducationStore:s,currentUserStore:i,currentUserValue:o,userName:r})}):null}var hg=n(91536),yg=n(449150),xg=n(876781),Sg=n(641977);function vg(e){let{spaceStore:t,spacePermissionsSettingsStore:n,groups:s}=e;const{isTeamsEnabled:i,canUseGroups:o,canEditGroups:r,isSpaceStoreDefined:l}=function(e){let{spaceStore:t}=e;const n=(0,qe.Gc)(),s=(0,yg.VJ)(),{canEditMembership:i,isSpaceStoreDefined:o}=(0,a.VK)((()=>({canEditMembership:t.canEditMembership(),isSpaceStoreDefined:t.isDefined()})),[t]),r=(0,a.VK)((()=>i&&s),[i,s]);return{isTeamsEnabled:n,canUseGroups:s,canEditMembership:i,canEditGroups:r,isSpaceStoreDefined:o}}({spaceStore:t});return l?(0,c.jsxs)("div",{children:[o?0===s.length&&(0,c.jsx)(Ce.Z,{isMultiline:!0,style:{marginTop:17,marginBottom:17},children:i?(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.captionWithTeamsV2",defaultMessage:"Set up groups to streamline page permissions from the share menu and manage teamspace members in bulk."}):(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.caption",defaultMessage:"Set up groups to conveniently control page permissions from the share menu."})}):(0,c.jsx)(jc.Z,{subscriptionTier:"plus",from:"permission_groups",icon:xg.x,title:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.upgradeTitle",defaultMessage:"Upgrade to create groups"}),caption:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.upgradeCaption.plus",defaultMessage:"Upgrade to the Plus Plan to set up groups and control permissions from the share menu."}),learnMoreRoute:"guides.groups"}),(0,c.jsx)(Sg.Z,{spaceStore:t,permissionsSettingsStore:n,groups:s,canEdit:r,containerMarginTop:o?0:void 0})]}):null}var bg=n(379362),Mg=n(580136),jg=n(890334);class Cg extends N.default{getInitialState(){return{isModalOpen:!1,guests:[],handleClickDecline:()=>{}}}}const wg=new Cg;function kg(e){let{guest:t,spaceStore:n,shouldDisableInteraction:o}=e;const{environment:l,styles:d,isSubscribed:u,handleConvertToMemberClick:m,handleRemoveClick:p}=function(e){let{guest:t,spaceStore:n,shouldDisableInteraction:o}=e;const l=(0,r.yK)((e=>({container:{width:"100%",display:"flex",justifyContent:"flex-end",opacity:o?.5:1},button:{display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:10,paddingLeft:0,paddingRight:0},buttonIcon:{width:20,height:20,fill:e.v2.icon.secondary},upgradeButton:{padding:"0px 6px 0px 8px",width:257},removeMenuDivider:{paddingTop:4,paddingBottom:4,borderTop:`1px solid ${e.v2.stroke.deemphasized}`},removeButton:{width:257,padding:"0px 6px 0px 8px",color:bg.Lr[e.mode].red},upgradeIcon:{width:17,height:17}})),[o]),d=(0,a.VK)((()=>{const e=Ht.subscriptionDataStoreInstance.state;return Boolean(e&&Gt.YK(e))}),[]),c=(0,i.O7)(),u=(0,s.useCallback)((()=>{const e=oe.U6.createChildStore(n,{table:D.KJ,id:t.userId}),s=d?"read_and_write":"editor";Mg.s({environment:c,guestUserStore:e,role:s,store:n,isConvertToAdmin:!d,origin:"guest_pages_popup"})}),[d,n,c,t.userId]),m=(0,s.useCallback)((()=>{wg.setState({...wg.state,isModalOpen:!0,guests:[t.userId],handleClickDecline:()=>{hg.b4(c,{from:"guest",button_name:"confirm_in_dialog",count:1});const e=oe.U6.createChildStore(n,{table:D.KJ,id:t.userId});Mg.w({environment:c,guestUserStore:e,store:n})}})}),[n,c,t]);return{environment:c,styles:l,isSubscribed:d,handleConvertToMemberClick:u,handleRemoveClick:m}}({guest:t,spaceStore:n,shouldDisableInteraction:o});return(0,c.jsx)("div",{style:d.container,children:(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,renderOrigin:e=>(0,c.jsx)(pn.Z,{style:d.button,...e,children:(0,c.jsx)(c.Fragment,{children:(0,jg.O)(d.buttonIcon)})}),onClick:()=>{hg.b4(l,{from:"guest",button_name:"actions"})},disabled:o,render:()=>(0,c.jsx)("div",{children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:void 0,sections:[{key:"upgrade",render:e=>(0,c.jsx)(ys.Z,{...e}),items:[{key:"upgrade",render:e=>(0,c.jsx)(ms.Z,{...e,buttonStyle:d.upgradeButton,icon:_a(d.upgradeIcon),title:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionguestsTab.upgradeToAdmin",defaultMessage:"Upgrade to {isSubscribed, select, true {member} other {admin}}",values:{isSubscribed:u}})}),action:()=>{m(),hg.b4(l,{from:"guest",button_name:"upgrade"})}}]},{key:"remove",render:e=>(0,c.jsx)(ys.Z,{...e,style:d.removeMenuDivider}),items:[{key:"remove",render:e=>(0,c.jsx)(ms.Z,{...e,buttonStyle:d.removeButton,icon:(0,mi.V)(d.upgradeIcon),title:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionguestsTab.remove",defaultMessage:"Remove from workspace"})}),action:()=>{p(),hg.b4(l,{from:"guest",button_name:"remove"})}}]}]})})})})}const Ig=(0,d.IU)("peopleFillXmark",{viewBox:"0 0 20 20",svg:(0,c.jsx)("path",{d:"M12.2061 6.75684C12.0374 6.75684 11.8916 6.69531 11.7686 6.57227C11.6501 6.44922 11.5908 6.30339 11.5908 6.13477C11.5908 5.96615 11.6523 5.82259 11.7754 5.7041L13.5801 3.89258L11.7754 2.08105C11.6523 1.96257 11.5908 1.81901 11.5908 1.65039C11.5908 1.47721 11.6501 1.33366 11.7686 1.21973C11.8916 1.10124 12.0374 1.04199 12.2061 1.04199C12.3838 1.04199 12.5319 1.10352 12.6504 1.22656L14.4551 3.02441L16.2803 1.21973C16.4033 1.09212 16.5469 1.02832 16.7109 1.02832C16.8841 1.02832 17.0299 1.08984 17.1484 1.21289C17.2669 1.33138 17.3262 1.47493 17.3262 1.64355C17.3262 1.80762 17.2646 1.95117 17.1416 2.07422L15.3369 3.89258L17.1348 5.69727C17.2624 5.82031 17.3262 5.96615 17.3262 6.13477C17.3262 6.30339 17.2646 6.44922 17.1416 6.57227C17.0231 6.69531 16.8796 6.75684 16.7109 6.75684C16.5332 6.75684 16.3828 6.69303 16.2598 6.56543L14.4551 4.76758L12.6572 6.56543C12.5387 6.69303 12.3883 6.75684 12.2061 6.75684ZM1.89746 13.2441C1.51465 13.2441 1.21387 13.1576 0.995117 12.9844C0.776367 12.8112 0.666992 12.5742 0.666992 12.2734C0.666992 11.8314 0.799154 11.3688 1.06348 10.8857C1.33236 10.4027 1.71745 9.94922 2.21875 9.52539C2.72461 9.10156 3.33301 8.75749 4.04395 8.49316C4.75488 8.22884 5.55241 8.09668 6.43652 8.09668C7.3252 8.09668 8.125 8.22884 8.83594 8.49316C9.54688 8.75749 10.153 9.10156 10.6543 9.52539C11.1602 9.94922 11.5475 10.4027 11.8164 10.8857C12.0853 11.3688 12.2197 11.8314 12.2197 12.2734C12.2197 12.5742 12.1104 12.8112 11.8916 12.9844C11.6729 13.1576 11.3721 13.2441 10.9893 13.2441H1.89746ZM6.44336 6.87988C5.94661 6.87988 5.48861 6.74544 5.06934 6.47656C4.65462 6.20768 4.31966 5.84538 4.06445 5.38965C3.8138 4.93392 3.68848 4.4235 3.68848 3.8584C3.68848 3.30241 3.8138 2.80111 4.06445 2.35449C4.31966 1.90332 4.6569 1.54557 5.07617 1.28125C5.49544 1.01693 5.95117 0.884766 6.44336 0.884766C6.9401 0.884766 7.39811 1.01465 7.81738 1.27441C8.23665 1.53418 8.57161 1.88965 8.82227 2.34082C9.07747 2.78743 9.20508 3.28874 9.20508 3.84473C9.20508 4.41439 9.07747 4.92936 8.82227 5.38965C8.57161 5.84538 8.23665 6.20768 7.81738 6.47656C7.39811 6.74544 6.9401 6.87988 6.44336 6.87988Z"})});function Tg(e){let{isModalOpen:t,handleDismiss:n,handleConfirm:s,title:i,description:o,ctaText:a}=e;const{styles:l}=function(){const e=(0,r.yK)((e=>({modal:{width:300,overflow:"hidden",borderRadius:5},container:{display:"flex",padding:"20px 20px 12px 20px",flexDirection:"column",width:299,justifyContent:"center",alignItems:"flex-start",gap:20},iconAndTitle:{display:"flex",flexDirection:"column",alignItems:"center",gap:9,width:"100%"},iconContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:36,height:36},icon:{color:e.v2.icon.secondary,fontSize:24,fontWeight:510},title:{color:e.v2.text.primary,textAlign:"center",fontSize:17,fontWeight:590,width:"100%",wordBreak:"break-word"},description:{color:e.v2.text.secondary,textAlign:"center"},footer:{display:"flex",flexDirection:"column",gap:8,alignItems:"center",width:"100%"},declineButton:{height:32,padding:"0 12px",borderRadius:6,width:"100%",textAlign:"center",alignItems:"center",justifyContent:"center",background:bg.Lr[e.mode].red},declineButtonHovered:{background:e.v2.text.ui.red.pressed},declineText:{fontWeight:590,color:e.v2.text.contrast},cancelButton:{display:"flex",height:24,padding:"0px 6px",justifyContent:"center",alignItems:"center",gap:4,textAlign:"center"}})),[]);return{styles:e}}();return(0,c.jsx)(Hs.Z,{open:t,innerStyle:l.modal,showCloseIcon:!0,onDismiss:n,render:()=>(0,c.jsx)(qs.Z,{capture:!0,allowEsc:!0,render:()=>(0,c.jsx)(Gs.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>(0,c.jsxs)("div",{style:l.container,children:[(0,c.jsxs)("div",{style:l.iconAndTitle,children:[(0,c.jsx)("div",{style:l.iconContainer,children:(0,c.jsx)("div",{style:l.icon,children:Ig({width:24,height:24})})}),(0,c.jsx)("div",{style:l.title,children:i})]}),(0,c.jsx)("div",{style:l.description,children:o}),(0,c.jsxs)("div",{style:l.footer,children:[(0,c.jsx)(pn.Z,{style:l.declineButton,onClick:()=>{s(),n()},hoveredStyle:l.declineButtonHovered,children:(0,c.jsx)("div",{style:l.declineText,children:a})}),(0,c.jsx)(pn.Z,{style:l.cancelButton,onClick:n,children:(0,c.jsx)("div",{children:(0,c.jsx)(f.FormattedMessage,{id:"BulkDeclineConfirmationDialog.cancel",defaultMessage:"Cancel"})})})]})]})})})})}function Zg(){const{isModalOpen:e,handleClickDecline:t,handleDismiss:n,guests:o,firstGuestName:r}=function(){const{isModalOpen:e,guests:t,handleClickDecline:n}=(0,a.VK)((()=>{const{isModalOpen:e,guests:t,handleClickDecline:n}=wg.state;return{isModalOpen:e,guests:t,handleClickDecline:n}}),[]),o=(0,f.useIntl)(),r=(0,a.VK)((()=>{const{currentSpaceStore:e}=Ge.default.state;if(0===t.length||!e)return;return oe.U6.createChildStore(e,{table:D.KJ,id:t[0]}).getDisplayName(o)}),[t,o]),l=(0,i.O7)(),d=(0,s.useCallback)((()=>{wg.reset(),hg.b4(l,{from:"guest",button_name:"confirm_in_dialog",count:t.length})}),[l,t]);return{isModalOpen:e,guests:t,firstGuestName:r,handleClickDecline:n,handleDismiss:d}}();return 0===o.length?null:(0,c.jsx)(Tg,{isModalOpen:e,handleDismiss:n,handleConfirm:t,title:(0,c.jsx)(f.FormattedMessage,{id:"GuestBulkRemoveConfirmationDialog.title",defaultMessage:"Remove {numberOfGuests, plural, one {{firstGuestName}} other {{numberOfGuests} guests}} from the workspace?",values:{numberOfGuests:o.length,firstGuestName:r}}),description:(0,c.jsx)(f.FormattedMessage,{id:"GuestBulkRemoveConfirmationDialog.description",defaultMessage:"They will lose access to all shared pages. To add them as a guest in the future, a request must be submitted, or an admin must invite them."}),ctaText:(0,c.jsx)(f.FormattedMessage,{id:"GuestBulkRemoveConfirmationDialog.remove",defaultMessage:"Remove"})})}var Pg=n(186517),Fg=n(484210);function _g(e){let{guestUserId:t,pageIds:n}=e;const{menuListItems:s,styles:o}=function(e){let{guestUserId:t,pageIds:n}=e;const s=(0,r.yK)((()=>({container:{width:256},chevron:{marginLeft:8,width:16,height:16}})),[]),o=(0,i.O7)(),l=(0,f.useIntl)(),d=(0,a.VK)((()=>n.map((e=>{var n;const s=new oe.G(o,{table:Dr.iU,id:e}),i=null===(n=s.getPermissionItems().find((e=>"user_permission"===e.type&&e.user_id===t)))||void 0===n?void 0:n.role;return{key:e,render:e=>(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(Ku.Z,{...e,store:s,placeholder:(0,c.jsx)(f.FormattedMessage,{id:"guestPagesPopup.privatePagePlaceholder",defaultMessage:"Private page"}),caption:i?l.formatMessage((0,Pg.kD)(i,"block")):void 0})}),action:()=>{const e=(0,Fg.ZP)({store:s,fullyQualified:!1,pageVisitSource:Cr.tY.LinkInPage});Yi.c4({environment:o,url:e,openInNew:"tab"})}}}))),[n,t,o,l]);return{menuListItems:d,styles:s}}({guestUserId:t,pageIds:n});return(0,c.jsx)("div",{style:o.container,children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:void 0,sections:[{key:"pages",render:e=>(0,c.jsx)(ys.Z,{...e}),items:s}]})})}function Ag(e){let{from:t,guestUserId:n,pageIds:s,shouldDisableInteraction:o}=e;const{styles:a}=function(e){let{shouldDisableInteraction:t}=e;const n=(0,r.yK)((e=>({button:{opacity:t?.5:1,color:e.v2.text.secondary},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[t]);return{styles:n}}({shouldDisableInteraction:o}),l=(0,i.O7)(),d=s.length;return 0===d?(0,c.jsx)(pn.Z,{disabled:!0,style:a.button,children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionguestsTab.GuestPagesButton.noPages",defaultMessage:"No pages"})}):(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,onClick:()=>{hg.b4(l,{from:t,button_name:"open_pages"})},renderOrigin:e=>(0,c.jsxs)(pn.Z,{...e,style:a.button,children:[(0,c.jsx)(f.FormattedMessage,{id:"GuestPagesButton.button",defaultMessage:"{numOfPages, plural, one {{numOfPages} page} other {{numOfPages} pages}}",values:{numOfPages:d}}),(0,Jr.i)(a.chevron)]}),disabled:o,render:()=>(0,c.jsx)(_g,{pageIds:s,guestUserId:n})})}function Bg(e){let{guest:t,shouldDisableInteraction:n}=e;return(0,c.jsx)(Ag,{pageIds:t.guestPageIds,guestUserId:t.userId,shouldDisableInteraction:n,from:"guest"})}const Rg=10,Dg=10,Og=5;var Lg=n(217242),Vg=n(938872),Eg=n(344156),Ng=n(388978);function Ug(e){let{userId:t,spaceStore:n,restorationStatus:i,isInternalGuest:o,isForSuggestionsTable:l}=e;const d=(0,f.useIntl)().formatMessage({id:"peopleSettings.userCell.guest",defaultMessage:"Guest"}),{name:u,email:m,userStore:p,styles:g}=function(e){let{userId:t,spaceStore:n,isForSuggestionsTable:s}=e;const i=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",fontSize:y.Z.fontSize.UIRegular.desktop,width:"100%",justifyContent:"space-between"},titleContainer:{maxWidth:s?210:163},userAvatarWrapper:{position:"relative"},userAvatarIcon:{position:"absolute",left:17,top:18},userName:{height:17,alignSelf:"stretch",fontSize:y.Z.fontSize.UIRegular.desktop,fontStyle:"normal",fontWeight:510,lineHeight:"18px",...y.Z.textOverflowStyle},userEmail:{height:17,alignSelf:"stretch",fontSize:y.Z.fontSize.UISmall.desktop,fontStyle:"normal",fontWeight:400,lineHeight:"15px",color:e.v2.text.secondary,...y.Z.textOverflowStyle},nameContainer:{display:"flex",alignItems:"center",gap:10,marginTop:4,marginBottom:4}})),[s]),o=(0,f.useIntl)(),l=oe.U6.createChildStore(n,{table:D.KJ,id:t}),{name:d,email:c}=(0,a.VK)((()=>({name:l.getDisplayName(o),email:l.getEmail()})),[l,o]);return{name:d,email:c,styles:i,userStore:l}}({userId:t,spaceStore:n,isForSuggestionsTable:l}),h=(0,a.VK)((()=>(0,we.Mo)()),[]),[x,S]=(0,s.useState)(!1);return(0,c.jsxs)("div",{style:g.container,children:[(0,c.jsxs)("div",{style:g.nameContainer,children:[(0,c.jsxs)("div",{style:g.userAvatarWrapper,children:[(0,c.jsx)($s.Z,{userStore:p,size:28}),o&&(0,c.jsx)(je.Z,{style:{width:250},textWrap:!0,placement:ke.u.Right,alignment:ke.v.Start,render:e=>(0,c.jsx)("div",{...e,style:g.userAvatarIcon,children:(0,c.jsx)(ft.x,{iconGroup:Vg.t,colorName:"secondary",variantName:"mini"})}),renderTooltip:()=>(0,c.jsxs)("div",{children:[(0,c.jsx)(ht.q,{styleName:"Body-12px/Medium",colorName:"contrast",children:(0,c.jsx)(f.FormattedMessage,{id:"userCell.internalGuest.tooltip.title",defaultMessage:"Using an email domain associated with your workspace"})}),(0,c.jsx)(ht.q,{styleName:"Body-12px/Medium",colorName:"contrastSecondary",children:(0,c.jsx)(f.FormattedMessage,{id:"userCell.internalGuest.tooltip.description",defaultMessage:"You'll see this icon for users who have a workspace owner email domain, verified domain, or allowed email domain"})})]})})]}),(0,c.jsxs)("div",{style:g.titleContainer,children:[(0,c.jsx)("div",{style:g.userName,title:l?m:u,children:l?m:u}),(0,c.jsx)("div",{style:g.userEmail,title:l?d:m,children:l?d:m}),h&&i&&(0,c.jsx)(Eg.Z,{spaceStore:n,restorationStatus:i,didAttemptRecovery:x})]})]}),h&&!x&&"canBeRestored"===(null==i?void 0:i.status)&&(0,c.jsx)(Ng.Z,{spaceId:n.id,userStore:p,onSubmit:()=>S(!0)})]})}function Kg(e){let{guests:t,spaceStore:n,domainFilterValues:o,internalDomains:l}=e;const{environment:d,tableStyles:u,styles:m,sortState:p,setSortState:g,selectedRowIds:h,setSelectedRowIds:y,rows:x,searchQuery:S,onClickApprove:v,onClickDecline:b,isApproveButtonLoading:M,canEditMembership:j,columnRenderInfo:C,isSubscribed:w,shouldHideActions:k,shouldShowRequest:I,canAdmin:T,guestsCount:Z,shouldShowLoadMore:P,onLoadMore:F}=function(e){let{guests:t,spaceStore:n,domainFilterValues:o,internalDomains:l}=e;const d=nn({spaceStore:n}),c=(0,yg.IH)({spaceStore:n}),u=(0,i.O7)(),m=(0,r.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,height:32},titleNumber:{color:e.v2.text.tertiary},emptyMessage:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${e.v2.stroke.regular}`},emptyDivider:{height:1,backgroundColor:e.v2.stroke.deemphasized},headerContainer:{display:"flex",justifyContent:d&&c?"space-between":"flex-end"},actionsContainer:{display:"flex",borderRadius:6,border:`1px solid ${e.v2.stroke.regular}`,boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)"},actionLeftButton:{borderRadius:"4px 0px 0px 4px",paddingLeft:10,paddingRight:0,height:30},buttonContainerApprove:{display:"flex",padding:"0px 12px 0px 0px",justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:e.v2.text.ui.blue.primary},buttonContainerDecline:{display:"flex",padding:"0px 12px 0px 10px",justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:bg.Lr[e.mode].red},buttonIcon:{width:20,height:20,paddingTop:1,flexDirection:"column",justifyContent:"center",alignItems:"center",gap:10},buttonText:{fontSize:14,fontWeight:510},buttonDivider:{width:1,background:e.v2.stroke.deemphasized},actionRightButton:{borderRadius:"0px 4px 4px 0px",paddingLeft:0,paddingRight:0,height:30}})),[d,c]),p=(0,yg.eA)({spaceStore:n}),g=(0,a.VK)((()=>p?[Wg,zg,qg]:[Wg]),[p]),h=(0,r.yK)((e=>({...(0,be.b)({columnRenderInfo:g,theme:e,containerMarginTop:0})})),[g]),y=(0,a.VK)((()=>g[0]),[g]),[x,S]=(0,s.useState)({column:y,sortAscending:!0}),[v,b]=(0,s.useState)([]),M=(0,f.useIntl)(),j=(0,a.VK)((()=>Lg.Z.state.searchQuery),[]),C=(0,a.VK)((()=>t.map((e=>{const t=oe.U6.createChildStore(n,{table:D.KJ,id:e.userId}),s=t.getEmail(),i=null==s?void 0:s.split("@")[1],o=l.some((e=>e.url===i));return{spaceStore:n,user:e,email:s,userName:t.getDisplayName(M),id:e.userId,shouldDisableInteraction:v.includes(e.userId),isClickable:!1,isInternalGuest:o}})).filter((e=>{var t;if(j){var n;if(!((null===(n=e.email)||void 0===n?void 0:n.includes(j))||e.userName.includes(j)))return!1}if(!o||0===o.length)return!0;const s=null===(t=e.email)||void 0===t?void 0:t.split("@")[1];return null==o?void 0:o.some((e=>"other"===e?!(null!=l&&l.some((e=>e.url===s))):s===e))}))),[n,t,M,j,v,l,o]),w=(0,a.VK)((()=>{const e=Ht.subscriptionDataStoreInstance.state;return Boolean(e&&Gt.YK(e))}),[]),k=(0,s.useCallback)((()=>{hg.b4(u,{from:"guest",button_name:"bulk_upgrade",count:v.length}),v.forEach((e=>{const t=oe.U6.createChildStore(n,{table:D.KJ,id:e}),s=w?"read_and_write":"editor";Mg.s({environment:u,guestUserStore:t,role:s,store:n,isConvertToAdmin:!w,origin:"guest_actions"}),b([])}))}),[v,u,w,n]),I=(0,s.useCallback)((()=>{hg.b4(u,{from:"guest",button_name:"bulk_remove",count:v.length}),wg.setState({...wg.state,isModalOpen:!0,guests:v,handleClickDecline:()=>{hg.b4(u,{from:"guest",button_name:"confirm_in_dialog",count:v.length}),v.forEach((e=>{const t=oe.U6.createChildStore(n,{table:D.KJ,id:e});Mg.w({environment:u,guestUserStore:t,store:n})})),b([])}})}),[v,u,n]),T=!C.some((e=>v.includes(e.id))),[Z,P]=(0,s.useState)(Dg),F=(0,s.useCallback)((()=>{P(Z+Dg)}),[Z]),_=Z<C.length,A=C.slice(0,Z);return{environment:u,tableStyles:h,styles:m,sortState:x,setSortState:S,selectedRowIds:v,setSelectedRowIds:b,rows:A,searchQuery:j,onClickApprove:k,onClickDecline:I,isApproveButtonLoading:!1,canEditMembership:p,columnRenderInfo:g,isSubscribed:w,shouldHideActions:T,shouldShowRequest:d,canAdmin:c,guestsCount:C.length,shouldShowLoadMore:_,onLoadMore:F}}({guests:t,spaceStore:n,domainFilterValues:o,internalDomains:l});return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:m.headerContainer,children:[I&&T&&(0,c.jsxs)("div",{style:m.titleContainer,children:[(0,c.jsx)("span",{children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionguestsTab.activeguests.title",defaultMessage:"Active"})}),(0,c.jsx)("span",{style:m.titleNumber,children:Z})]}),h.length>0&&!k&&(0,c.jsxs)("div",{style:m.actionsContainer,children:[(0,c.jsx)(pn.Z,{style:m.actionLeftButton,onClick:v,isLoading:M,children:(0,c.jsxs)("div",{style:m.buttonContainerApprove,children:[(0,c.jsx)("div",{style:m.buttonIcon,children:_a({width:20,height:16})}),(0,c.jsx)("div",{style:m.buttonText,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.peopleSection.guestsTable.bulkUpgrade",defaultMessage:"Upgrade {numberOfRequests, plural, one {1 guest} other {{numberOfRequests} guests}} to {isSubscribed, select, true {member} other {admin}}",values:{numberOfRequests:h.length,isSubscribed:w}})})]})}),(0,c.jsx)("div",{style:m.buttonDivider}),(0,c.jsx)(pn.Z,{style:m.actionRightButton,onClick:b,children:(0,c.jsxs)("div",{style:m.buttonContainerDecline,children:[(0,c.jsx)("div",{style:{...m.buttonIcon,paddingTop:3},children:(0,mi.V)({width:20,height:16})}),(0,c.jsx)("div",{style:m.buttonText,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.peopleSection.guestsTable.bulkDecline",defaultMessage:"Remove from workspace"})})]})})]})]}),(0,c.jsxs)("div",{style:{marginTop:I&&T?4:-1},children:[(0,c.jsx)(be.D,{allowHorizontalScroll:j,setStickyHeaderRow:!0,columnRenderInfo:C,rows:Gg(x,p),showRowBorders:!0,hideHeaderRowPadding:!0,sortState:p,onSortStateChanged:g,loadMoreType:"button",onLoadMore:P?F:void 0,renderNoRowsComponent:()=>(0,c.jsx)(Ce.Z,{isSmall:!0,style:m.emptyMessage,children:S?(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionGuestsTab.emptySearch",defaultMessage:"No search results"}):(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionGuestsTab.emptyRow",defaultMessage:"No guests"})}),styles:u,multiselect:j?{header:{isDisabled:0===x.length,isSelected:h.length>0&&h.length===x.length,onClick:()=>{h.length===x.length?(y([]),hg.pZ(d,{from:"guests",action:"deselect_all",row_count:h.length})):(y(x.map((e=>e.id))),hg.pZ(d,{from:"guests",action:"select_all",row_count:x.length}))}},row:{getDisabledState:()=>!1,getSelectedState:e=>h.includes(e.id),onClick:e=>{y((t=>t.includes(e.id)?(hg.pZ(d,{from:"guests",action:"deselect_row",row_count:1}),t.filter((t=>t!==e.id))):(hg.pZ(d,{from:"guests",action:"select_row",row_count:1}),t.concat(e.id))))}}}:void 0}),(0,c.jsx)(Zg,{})]})]})}const Wg={id:"user",headerTitle:(0,c.jsx)("div",{style:{fontSize:14},children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionGuestsTab.user",defaultMessage:"User"})}),renderCell:e=>(0,c.jsx)(Ug,{userId:e.user.userId,spaceStore:e.spaceStore,isInternalGuest:e.isInternalGuest}),widthData:{width:210},sortable:!0},zg={id:"access",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionGuestsTab.access",defaultMessage:"Access"})}),renderCell:e=>(0,c.jsx)(Bg,{guest:e.user,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{width:180},sortable:!1},qg={id:"actions",headerTitle:(0,c.jsx)(c.Fragment,{}),renderCell:e=>(0,c.jsx)(kg,{guest:e.user,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{width:300},sortable:!1};function Gg(e,t){let{sortAscending:n}=t;const s=h.MR(e,(e=>e.email));return n||s.reverse(),s}var Hg=n(642499),$g=n(982114);const Yg=(0,d.IU)("checkMarkShield",{viewBox:"0 0 10 11",svg:(0,c.jsx)("path",{d:"M5.08789 10.4893C5.03906 10.4893 4.9821 10.4795 4.91699 10.46C4.85514 10.4437 4.79167 10.4193 4.72656 10.3867C4.02669 10.0189 3.43262 9.68522 2.94434 9.38574C2.45931 9.08952 2.06868 8.79655 1.77246 8.50684C1.47624 8.21712 1.25977 7.90462 1.12305 7.56934C0.989583 7.23405 0.922852 6.84831 0.922852 6.41211V2.8623C0.922852 2.52051 0.986328 2.26335 1.11328 2.09082C1.24023 1.91829 1.45345 1.77018 1.75293 1.64648C1.84733 1.60742 1.98405 1.55534 2.16309 1.49023C2.34212 1.42188 2.54069 1.35026 2.75879 1.27539C2.98014 1.19727 3.19987 1.12077 3.41797 1.0459C3.63932 0.971029 3.83789 0.904297 4.01367 0.845703C4.19271 0.787109 4.32617 0.743164 4.41406 0.713867C4.52148 0.681315 4.63379 0.655273 4.75098 0.635742C4.87142 0.616211 4.98372 0.606445 5.08789 0.606445C5.19206 0.606445 5.30436 0.616211 5.4248 0.635742C5.5485 0.655273 5.66243 0.681315 5.7666 0.713867C5.85449 0.743164 5.98633 0.787109 6.16211 0.845703C6.34115 0.904297 6.53971 0.971029 6.75781 1.0459C6.97591 1.12077 7.19564 1.19727 7.41699 1.27539C7.63835 1.35026 7.83854 1.42025 8.01758 1.48535C8.19661 1.55046 8.33333 1.60417 8.42773 1.64648C8.72721 1.77018 8.9388 1.91829 9.0625 2.09082C9.18945 2.26335 9.25293 2.52051 9.25293 2.8623V6.41211C9.25293 6.84831 9.1862 7.23568 9.05273 7.57422C8.92253 7.91276 8.70931 8.23014 8.41309 8.52637C8.12012 8.81934 7.73112 9.11393 7.24609 9.41016C6.76107 9.70638 6.16374 10.0319 5.4541 10.3867C5.389 10.4193 5.32389 10.4437 5.25879 10.46C5.19694 10.4795 5.13997 10.4893 5.08789 10.4893ZM4.55078 7.73047C4.6582 7.73047 4.75586 7.70605 4.84375 7.65723C4.9349 7.60514 5.01302 7.5319 5.07812 7.4375L7.34863 3.9707C7.3877 3.90885 7.41862 3.84538 7.44141 3.78027C7.46745 3.71517 7.48047 3.65169 7.48047 3.58984C7.48047 3.4401 7.4235 3.31641 7.30957 3.21875C7.19889 3.12109 7.07031 3.07227 6.92383 3.07227C6.73177 3.07227 6.57064 3.17643 6.44043 3.38477L4.54102 6.40723L3.68652 5.3623C3.62142 5.28092 3.55306 5.22233 3.48145 5.18652C3.41309 5.15072 3.33333 5.13281 3.24219 5.13281C3.0957 5.13281 2.96875 5.18652 2.86133 5.29395C2.75391 5.39811 2.7002 5.52507 2.7002 5.6748C2.7002 5.74642 2.71322 5.81478 2.73926 5.87988C2.7653 5.94499 2.80599 6.01172 2.86133 6.08008L4.00391 7.44727C4.08203 7.54167 4.16504 7.61328 4.25293 7.66211C4.34082 7.70768 4.4401 7.73047 4.55078 7.73047Z",fill:"#91918E"})}),Qg=(0,d.IU)("globe4",{viewBox:"0 0 12 12",svg:(0,c.jsx)("path",{d:"M5.99512 10.5156C5.64355 10.5156 5.31315 10.4001 5.00391 10.1689C4.69792 9.94108 4.42773 9.62207 4.19336 9.21191C3.96224 8.7985 3.77995 8.31673 3.64648 7.7666C3.51302 7.21647 3.44629 6.6224 3.44629 5.98438C3.44629 5.3431 3.51302 4.7474 3.64648 4.19727C3.77995 3.64388 3.96224 3.16211 4.19336 2.75195C4.42448 2.33854 4.69466 2.01628 5.00391 1.78516C5.31315 1.55404 5.64355 1.43848 5.99512 1.43848C6.34993 1.43848 6.68197 1.55404 6.99121 1.78516C7.30046 2.01628 7.57064 2.33854 7.80176 2.75195C8.03613 3.16211 8.21842 3.64388 8.34863 4.19727C8.47884 4.7474 8.54395 5.3431 8.54395 5.98438C8.54395 6.6224 8.47721 7.21647 8.34375 7.7666C8.21354 8.31673 8.03125 8.7985 7.79688 9.21191C7.56576 9.62207 7.29557 9.94108 6.98633 10.1689C6.68034 10.4001 6.34993 10.5156 5.99512 10.5156ZM5.99512 2.15137C5.76725 2.15137 5.5459 2.25553 5.33105 2.46387C5.11947 2.6722 4.92904 2.95703 4.75977 3.31836C4.59375 3.67643 4.46191 4.08496 4.36426 4.54395C4.2666 5.00293 4.21777 5.48307 4.21777 5.98438C4.21777 6.48242 4.2666 6.95931 4.36426 7.41504C4.46191 7.87077 4.59375 8.27767 4.75977 8.63574C4.92904 8.99382 5.11947 9.27702 5.33105 9.48535C5.5459 9.69368 5.76725 9.79785 5.99512 9.79785C6.22624 9.79785 6.44759 9.69368 6.65918 9.48535C6.87402 9.27702 7.06445 8.99382 7.23047 8.63574C7.39974 8.27767 7.5332 7.87077 7.63086 7.41504C7.72852 6.95931 7.77734 6.48242 7.77734 5.98438C7.77734 5.48307 7.72852 5.00293 7.63086 4.54395C7.5332 4.08496 7.39974 3.67643 7.23047 3.31836C7.06445 2.95703 6.87402 2.6722 6.65918 2.46387C6.44759 2.25553 6.22624 2.15137 5.99512 2.15137ZM5.61914 1.50684H6.37598V10.4229H5.61914V1.50684ZM5.99512 7.47363C6.51921 7.47363 7.01562 7.51432 7.48438 7.5957C7.95312 7.67708 8.37142 7.79427 8.73926 7.94727C9.1071 8.10026 9.40007 8.2793 9.61816 8.48438L9.04199 8.96289C8.84017 8.8099 8.58464 8.67806 8.27539 8.56738C7.9694 8.45671 7.62272 8.3737 7.23535 8.31836C6.84798 8.25977 6.43457 8.23047 5.99512 8.23047C5.55892 8.23047 5.14714 8.25977 4.75977 8.31836C4.3724 8.3737 4.02409 8.45671 3.71484 8.56738C3.40885 8.67806 3.15332 8.8099 2.94824 8.96289L2.37207 8.48438C2.59342 8.2793 2.88802 8.10026 3.25586 7.94727C3.6237 7.79427 4.04199 7.67708 4.51074 7.5957C4.97949 7.51432 5.47428 7.47363 5.99512 7.47363ZM10.4189 5.59375V6.35059H1.57617V5.59375H10.4189ZM5.99512 4.5C5.47428 4.5 4.97949 4.45931 4.51074 4.37793C4.04199 4.29329 3.6237 4.17611 3.25586 4.02637C2.88802 3.87337 2.59342 3.69434 2.37207 3.48926L2.94824 3.00586C3.15332 3.16211 3.41048 3.29557 3.71973 3.40625C4.02897 3.51367 4.37728 3.59668 4.76465 3.65527C5.15202 3.71387 5.56217 3.74316 5.99512 3.74316C6.43457 3.74316 6.84798 3.71387 7.23535 3.65527C7.62272 3.59668 7.9694 3.51367 8.27539 3.40625C8.58464 3.29557 8.84017 3.16211 9.04199 3.00586L9.61816 3.48926C9.40007 3.69434 9.1071 3.87337 8.73926 4.02637C8.37142 4.17611 7.95312 4.29329 7.48438 4.37793C7.01562 4.45931 6.51921 4.5 5.99512 4.5ZM5.99512 11.1309C5.28874 11.1309 4.62467 10.9958 4.00293 10.7256C3.38118 10.4587 2.83268 10.0876 2.35742 9.6123C1.88216 9.1403 1.50944 8.59342 1.23926 7.97168C0.972331 7.34993 0.838867 6.68424 0.838867 5.97461C0.838867 5.26823 0.972331 4.60417 1.23926 3.98242C1.50944 3.36068 1.88053 2.81217 2.35254 2.33691C2.8278 1.86165 3.3763 1.49056 3.99805 1.22363C4.62305 0.953451 5.28874 0.818359 5.99512 0.818359C6.7015 0.818359 7.36556 0.953451 7.9873 1.22363C8.6123 1.49056 9.16081 1.86165 9.63281 2.33691C10.1081 2.81217 10.4808 3.36068 10.751 3.98242C11.0212 4.60417 11.1562 5.26823 11.1562 5.97461C11.1562 6.68424 11.0212 7.34993 10.751 7.97168C10.4808 8.59342 10.1081 9.1403 9.63281 9.6123C9.16081 10.0876 8.61393 10.4587 7.99219 10.7256C7.37044 10.9958 6.70475 11.1309 5.99512 11.1309ZM5.99512 10.1396C6.56803 10.1396 7.10514 10.0306 7.60645 9.8125C8.10775 9.5944 8.55046 9.29492 8.93457 8.91406C9.31868 8.52995 9.61816 8.08724 9.83301 7.58594C10.0511 7.08138 10.1602 6.54427 10.1602 5.97461C10.1602 5.40495 10.0511 4.86947 9.83301 4.36816C9.61816 3.86361 9.31868 3.4209 8.93457 3.04004C8.55046 2.65592 8.10612 2.35482 7.60156 2.13672C7.10026 1.91862 6.56478 1.80957 5.99512 1.80957C5.42546 1.80957 4.88835 1.91862 4.38379 2.13672C3.88249 2.35482 3.43978 2.65592 3.05566 3.04004C2.6748 3.4209 2.37533 3.86361 2.15723 4.36816C1.94238 4.86947 1.83496 5.40495 1.83496 5.97461C1.83496 6.54427 1.94238 7.08138 2.15723 7.58594C2.37533 8.08724 2.6748 8.52995 3.05566 8.91406C3.43978 9.29492 3.88249 9.5944 4.38379 9.8125C4.88835 10.0306 5.42546 10.1396 5.99512 10.1396Z",fill:"#91918E"})});var Jg=n(947969),Xg=n(883817),ef=n(187142),tf=n(757118),nf=n(673254),sf=n(994273),of=n(301978);const af=(0,f.defineMessages)({infoTitle:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.title",defaultMessage:"Find teammates more easily by filtering to your workspace's email domains"},infoDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.description",defaultMessage:"Upgrade these guests to members for better collaboration and reduced page-by-page permissions."},emailDomainTooltip:{defaultMessage:"Your workspace’s email domains include allowed email domains, verified domains, and workspace owner email domains.",id:"spacePermissionsSettings.guestsTab.internalGuestBanner.tooltip"},overLimitTitle:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.title",defaultMessage:"Your workspace is over the {limit}-guest limit"},upsellDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.upselldescription",defaultMessage:"Find teammates who are currently guests by filtering to your workspace's email domains and upgrade them to members to continue collaborating. To get more guest seats, <upgradelink>upgrade your plan</upgradelink> or <saleslink>reach out to sales</saleslink>."},contactSalesDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.contactSales.description",defaultMessage:"Find teammates who are currently guests by filtering to your workspace's email domains and upgrade them to members to continue collaborating. To get more guest seats, <saleslink>reach out to sales</saleslink>."},salesAssistedDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.salesAssisted.description",defaultMessage:"Find teammates who are currently guests by filtering to your workspace's email domains and upgrade them to members to continue collaborating. To get more guest seats, reach out to your account manager."},nonAdminTooltip:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.nonAdmin.tooltip",defaultMessage:"New users can continue to be added as members. To resume adding guests, contact your workspace owner to upgrade or remove existing guests from your workspace."}}),rf={warning_upsell:{iconGroup:Hg.G,tint:"yellow",label:af.overLimitTitle,description:af.upsellDescription,tooltip:af.emailDomainTooltip},warning_contact_sales:{iconGroup:Hg.G,tint:"yellow",label:af.overLimitTitle,description:af.contactSalesDescription,tooltip:af.emailDomainTooltip},warning_sales_assisted:{iconGroup:Hg.G,tint:"yellow",label:af.overLimitTitle,description:af.salesAssistedDescription,tooltip:af.emailDomainTooltip},warning_nonadmin:{iconGroup:Hg.G,tint:"yellow",label:af.overLimitTitle,tooltip:af.nonAdminTooltip},info:{iconGroup:Vg.t,tint:"gray",label:af.infoTitle,description:af.infoDescription,tooltip:af.emailDomainTooltip}};function lf(e){let{guests:t,spaceStore:n,internalDomains:s,domainFilterValues:i,setDomainFilterValues:o}=e;const a=(0,yg.IH)({spaceStore:n}),r=s.length>0;if(!r)return null;const l=r&&a,d=(0,c.jsx)(df,{guests:t,spaceStore:n});return l||d?(0,c.jsxs)(gt.jX,{padding:"16px 0px",gap:16,children:[d,l&&(0,c.jsx)(cf,{internalDomains:s,domainFilterValues:i??[],setDomainFilterValues:o})]}):null}function df(e){let{spaceStore:t,guests:n}=e;const s=function(e){let{spaceStore:t}=e;const n=(0,i.O7)(),s=(0,yg.IH)({spaceStore:t}),o=n.currentUser.id,a=t.id,r=o&&a?(0,Jg.Ni)({spaceId:a,userId:o}):void 0,l=(0,nf.oo)({name:"internal_guests",spaceId:a,spaceUserId:r,amount:0});if(!l)return null;return(0,Xg.V5)(l,{available:()=>s?{...rf.info,messageValues:{}}:null,upsell:e=>{let{limit:t,upsell:n}=e;return"product"===n.type?{...rf.warning_upsell,messageValues:{limit:t.total,saleslink:e=>(0,c.jsx)(Rs.Z,{onClick:()=>(0,tf.n)("manage_guests"),children:e}),upgradelink:e=>(0,c.jsx)(Rs.Z,{onClick:()=>{rt.Z.setState({...rt.Z.state,currentTab:"plans",defaultSubtab:void 0})},children:e})}}:"contact_sales"===n.type?{...rf.warning_contact_sales,messageValues:{limit:t.total,saleslink:e=>(0,c.jsx)(Rs.Z,{onClick:()=>(0,tf.n)("manage_guests"),children:e})}}:"contact_account_manager"===n.type?{...rf.warning_sales_assisted,messageValues:{limit:t.total}}:(0,Zn.t1)(n)},blocked:e=>{let{limit:t}=e;return{...rf.warning_nonadmin,messageValues:{limit:t.total}}}})}({spaceStore:t});if(!s)return null;const o=(0,c.jsx)(je.Z,{style:{width:250},textWrap:!0,renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{...s.tooltip}),originGap:6,placement:ke.u.Bottom,alignment:ke.v.Start,render:e=>(0,c.jsx)("div",{style:{paddingLeft:3,display:"inline-block",verticalAlign:"text-bottom"},...e,children:(0,di.m)({width:14})})});return(0,c.jsx)(ef.r,{children:(0,c.jsx)(of.j,{iconGroup:s.iconGroup,display:"inline",tint:s.tint,label:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(f.FormattedMessage,{...s.label,values:s.messageValues}),s.description?void 0:o]}),description:s.description&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(f.FormattedMessage,{...s.description,values:s.messageValues}),o]})})})}function cf(e){let{internalDomains:t,domainFilterValues:n,setDomainFilterValues:s}=e;const i=[...t.map((e=>({key:e.url,value:`${e.url}`,title:uf({domain:`${e.url}`})}))),{key:"other",value:"other",title:uf({domain:"other"})}];return(0,c.jsx)(sf.F,{pillIcon:$g.p,pillTitle:n?(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.guestsTab.internalDomainFilter.filtered",defaultMessage:"Email domain: {domainFilter}",values:{domainFilter:n.join(", ")}}):(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.guestsTab.internalDomainFilter.placeholder",defaultMessage:"Email domain"}),selectedItems:n,setSelectedItems:e=>{s(e)},items:i})}function uf(e){let{domain:t}=e;return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)(c.Fragment,{children:"other"===t?(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Other",id:"spacePermissionsSettings.guestsTab.internalDomainFilter.other"}):`@${t}`}),(0,c.jsx)("div",{style:{paddingLeft:5},children:"other"===t?Qg({width:14}):Yg({width:14})})]})}const mf=(0,d.IU)("peopleFillCheckmark",{viewBox:"0 0 20 20",svg:(0,c.jsx)("path",{d:"M14.5391 10.3174C14.4115 10.3174 14.2975 10.29 14.1973 10.2354C14.097 10.1807 13.999 10.0964 13.9033 9.98242L12.29 8.01367C12.1715 7.86328 12.1123 7.70833 12.1123 7.54883C12.1123 7.38021 12.1693 7.23665 12.2832 7.11816C12.4017 6.99967 12.5452 6.94043 12.7139 6.94043C12.8141 6.94043 12.9053 6.96322 12.9873 7.00879C13.0739 7.0498 13.1582 7.12272 13.2402 7.22754L14.5117 8.84082L17.2188 4.51367C17.3555 4.28581 17.5309 4.17188 17.7451 4.17188C17.9046 4.17188 18.0482 4.22428 18.1758 4.3291C18.3034 4.42936 18.3672 4.56608 18.3672 4.73926C18.3672 4.81673 18.349 4.89648 18.3125 4.97852C18.2806 5.05599 18.2419 5.12891 18.1963 5.19727L15.1406 9.97559C14.9948 10.2035 14.7943 10.3174 14.5391 10.3174ZM2.85645 16.2441C2.47363 16.2441 2.17285 16.1576 1.9541 15.9844C1.73535 15.8112 1.62598 15.5742 1.62598 15.2734C1.62598 14.8314 1.75814 14.3688 2.02246 13.8857C2.29134 13.4027 2.67643 12.9492 3.17773 12.5254C3.68359 12.1016 4.29199 11.7575 5.00293 11.4932C5.71387 11.2288 6.51139 11.0967 7.39551 11.0967C8.28418 11.0967 9.08398 11.2288 9.79492 11.4932C10.5059 11.7575 11.112 12.1016 11.6133 12.5254C12.1191 12.9492 12.5065 13.4027 12.7754 13.8857C13.0443 14.3688 13.1787 14.8314 13.1787 15.2734C13.1787 15.5742 13.0693 15.8112 12.8506 15.9844C12.6318 16.1576 12.3311 16.2441 11.9482 16.2441H2.85645ZM7.40234 9.87988C6.9056 9.87988 6.44759 9.74544 6.02832 9.47656C5.61361 9.20768 5.27865 8.84538 5.02344 8.38965C4.77279 7.93392 4.64746 7.4235 4.64746 6.8584C4.64746 6.30241 4.77279 5.80111 5.02344 5.35449C5.27865 4.90332 5.61589 4.54557 6.03516 4.28125C6.45443 4.01693 6.91016 3.88477 7.40234 3.88477C7.89909 3.88477 8.3571 4.01465 8.77637 4.27441C9.19564 4.53418 9.5306 4.88965 9.78125 5.34082C10.0365 5.78743 10.1641 6.28874 10.1641 6.84473C10.1641 7.41439 10.0365 7.92936 9.78125 8.38965C9.5306 8.84538 9.19564 9.20768 8.77637 9.47656C8.3571 9.74544 7.89909 9.87988 7.40234 9.87988Z"})});var pf=n(685740);function gf(e){let{request:t,shouldDisableInteraction:n,requestType:o,handleApprove:a,handleDecline:l}=e;const d=function(e){let{shouldDisableInteraction:t}=e;return(0,r.yK)((e=>({approveButton:{background:e.outlineBlueButtonHoveredBackground,color:e.blueColor,fontWeight:510,fontSize:14,borderRadius:4,paddingLeft:10,paddingRight:10},declineButton:{marginRight:10,borderRadius:4,paddingLeft:10,paddingRight:10,color:e.v2.text.secondary},container:{opacity:t?.5:1,display:"flex",width:"100%",justifyContent:"flex-end"}})),[t])}({shouldDisableInteraction:n}),[u,m]=(0,s.useState)(!1),p=(0,i.O7)(),g=(0,s.useCallback)((()=>{hg.b4(p,{from:`${o}_request`,button_name:"decline"}),l(t)}),[p,o,t,l]),h=(0,s.useCallback)((async()=>{m(!0),hg.b4(p,{from:`${o}_request`,button_name:"approve"}),await a(t),m(!1)}),[p,t,o,a]);return(0,c.jsxs)("div",{style:d.container,children:[(0,c.jsx)("div",{children:(0,c.jsx)(pn.Z,{style:d.declineButton,onClick:g,disabled:n,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.Decline",defaultMessage:"Decline"})})}),(0,c.jsx)("div",{children:(0,c.jsx)(pn.Z,{style:d.approveButton,onClick:h,isLoading:u,disabled:n,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.approve",defaultMessage:"Approve"})})})]})}function ff(e){const{isModalOpen:t,handleClickDecline:n,handleClickDismiss:o,requestType:r,requests:l}=e,d=function(e,t,n){const o=(0,i.O7)();return(0,s.useCallback)((()=>{n(),hg.b4(o,{from:"member"===e?"member_request":"guest_request",button_name:"dismiss_in_dialog",count:t.length})}),[n,o,t,e])}(r,l,o),u=(0,f.useIntl)(),m=(0,a.VK)((()=>{var e;return null===(e=l[0])||void 0===e||null===(e=e.createdByActorsWithReason[0])||void 0===e?void 0:e.actor.getDisplayName(u)}),[l,u]),p=(0,a.VK)((()=>{var e;return null===(e=l[0])||void 0===e?void 0:e.forActor.email}),[l]);return 0===l.length?null:(0,c.jsx)(Tg,{isModalOpen:t,handleDismiss:d,handleConfirm:()=>n(l),title:(0,c.jsx)(f.FormattedMessage,{id:"RequestBulkDeclineConfirmationDialog.title",defaultMessage:"Decline {numberOfRequests, plural, one {{requestType} request for {firstRequestEmail}} other {{numberOfRequests} {requestType} requests}}?",values:{numberOfRequests:l.length,requestType:r,firstRequestEmail:p}}),description:(0,c.jsx)(f.FormattedMessage,{id:"RequestBulkDeclineConfirmationDialog.description",defaultMessage:"{numberOfRequests, plural, one {To add them as a {requestType} in the future, {inviter} must resubmit a request, or an admin must invite them} other {Requests must be resubmitted, or an admin must add them as {isMemberRequest, select, true {members} other {guests}} in the future}}.",values:{numberOfRequests:l.length,requestType:r,isMemberRequest:"member"===r,inviter:m}}),ctaText:(0,c.jsx)(f.FormattedMessage,{id:"RequestBulkDeclineConfirmationDialog.decline",defaultMessage:"Decline"})})}function hf(e){let{createdByActorsWithReason:t,latestRequestTime:n}=e;return(0,c.jsx)("div",{style:{width:241,maxHeight:600,overflowY:"auto",whiteSpace:"pre-wrap",padding:"12px 12px 12px 12px"},children:t.map((e=>(0,c.jsx)(yf,{createdByActorWithReason:e,latestRequestTime:n},e.actor.id)))})}function yf(e){let{createdByActorWithReason:t,latestRequestTime:n}=e;const{requestorName:s,reason:i,actor:o,styles:l}=function(e){let{createdByActorWithReason:t}=e;const{actor:n,reason:s}=t,i=(0,f.useIntl)(),o=(0,a.VK)((()=>n.getDisplayName(i)),[i,n]),l=(0,r.yK)((e=>({avatar:{width:24,height:24},metadata:{display:"flex",alignItems:"center",gap:6,flex:"1 0 0"},userName:{textOverflow:"ellipsis",fontSize:14,fontWeight:510,overflow:"hidden",width:100,whiteSpace:"nowrap"},timestamp:{color:e.v2.text.tertiary,textAlign:"right",fontSize:12,fontWeight:400,lineHeight:"15px"},header:{display:"flex",alignItems:"center",gap:10},reason:{paddingLeft:30,fontSize:14,fontWeight:400,color:e.v2.text.primary,letterSpacing:"-0.154px",display:"inline-block",overflowWrap:"break-word",inlineSize:200},noReason:{color:e.v2.text.quaternary}})),[]);return{requestorName:o,reason:s,actor:n,styles:l}}({createdByActorWithReason:t});return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:l.header,children:[(0,c.jsx)($s.Z,{hasTooltip:!0,userValue:o,style:l.avatar,size:24,avatarShouldShowShadow:!1}),(0,c.jsxs)("div",{style:l.metadata,children:[(0,c.jsx)("div",{style:l.userName,children:s}),(0,c.jsx)(Ce.Z,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:l.timestamp,children:(0,yo.IS)(n)})]})]}),(0,c.jsx)("span",{style:l.reason,children:i||(0,c.jsx)("div",{style:l.noReason,children:(0,c.jsx)(f.FormattedMessage,{id:"requestReasonContent.noReason",defaultMessage:"No message"})})})]})}function xf(e){let{request:t,shouldDisableInteraction:n,requestType:s}=e;const{styles:o,firstRequestorName:l,numberOfRequestors:d}=function(e){let{request:t,shouldDisableInteraction:n}=e;const s=(0,r.yK)((e=>({firstRequestorName:{color:e.v2.text.secondary,opacity:n?.5:1,maxWidth:118,...y.Z.textOverflowStyle},buttonSuffix:{color:e.v2.text.tertiary,paddingLeft:4},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[n]),o=(0,i.O7)(),l=(0,f.useIntl)(),d=(0,a.VK)((()=>{if(0===t.createdByActorsWithReason.length)return;return new oe.U6(o,{table:D.KJ,id:t.createdByActorsWithReason[0].actor.id}).getDisplayName(l)}),[o,l,t.createdByActorsWithReason]);return{styles:s,firstRequestorName:d,numberOfRequestors:t.createdByActorsWithReason?t.createdByActorsWithReason.length:0}}({request:t,shouldDisableInteraction:n}),u=(0,i.O7)();return void 0===l||0===d?null:(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,onClick:()=>{hg.b4(u,{from:`${s}_request`,button_name:"open_requested_by"})},renderOrigin:e=>(0,c.jsx)(pn.Z,{...e,disabled:n,children:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{style:o.firstRequestorName,title:l,children:l}),(0,c.jsx)("span",{style:o.buttonSuffix,children:d>1?(0,c.jsxs)("div",{children:["+",d-1]}):null}),(0,Jr.i)(o.chevron)]})}),render:()=>(0,c.jsx)(hf,{createdByActorsWithReason:t.createdByActorsWithReason,latestRequestTime:t.accessRequest.created_time})})}function Sf(e){let{request:t,spaceStore:n,shouldDisableInteraction:s}=e;const{accessRequest:i,forActor:o}=t,r=function(e){let{accessRequest:t}=e;return(0,a.VK)((()=>t.isGuestInviteRequest()?t.getAttributes().permission_records_and_roles.map((e=>e.id)):[]),[t])}({accessRequest:i});return(0,c.jsx)(Ag,{pageIds:r,guestUserId:o.id,shouldDisableInteraction:s,from:"guest_request"})}var vf=n(429369),bf=n(455838),Mf=n(748019);const jf=(0,f.defineMessages)({filterTeams:{defaultMessage:"Filter teamspaces…",id:"teamsDropdownForMember.filterForTeams.placeholder"},privateTeamspace:{defaultMessage:"Private teamspace",id:"teamsDropdownForMember.privateTeamspace"}});function Cf(e){const t=(0,i.O7)(),[n,o]=(0,s.useState)(""),l=(0,s.useCallback)((e=>el.RF({environment:t,teamId:e,tab:bf.a.Members,from:"teams_dropdown_space_settings_people"})),[t]),d=(0,r.yK)((e=>({teamName:{color:e.v2.text.primary,fontSize:14},teamMemberCount:{color:e.v2.text.secondary,fontSize:12}})),[]),u=(0,a.VK)((()=>[{key:"teams for member",render:e=>(0,c.jsx)(ys.Z,{...e}),actions:e.teamStores.map((e=>{const t={key:e.id,displayName:e.getName()??V.default.formatMessage(jf.privateTeamspace),analyticsName:e.getName()||"team_unknown",searchName:e.getName(),render:t=>(0,c.jsx)(ms.Z,{style:{padding:4},textWrapperStyle:{marginLeft:0,marginRight:0},title:(0,c.jsxs)("div",{style:{display:"flex",padding:"4px 6px 4px 8px",alignItems:"flex-start",gap:8,alignSelf:"stretch"},children:[(0,c.jsx)(Ur.p,{disabled:!0,store:e,size:20,style:{borderRadius:4}}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:d.teamName,children:e.getName()??V.default.formatMessage(jf.privateTeamspace)}),(0,c.jsx)("div",{style:d.teamMemberCount,children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"{numMembers} {numMembers, plural, one {member} other {members}}",id:"teamsDropdownForMember.numMembers",values:{numMembers:e.getNumberOfMembersOrZero((0,Gt.Io)())}})})]})]}),disabled:!Boolean(e.getName()),inline:!0,...t}),action:()=>{l(e.id)},closeParentMenu:!1};return t}))}]),[e.teamStores,l,d.teamMemberCount,d.teamName]),m=n,p=(0,c.jsx)(ys.Z,{isInput:!0,children:(0,c.jsx)(ul.ZP,{value:m,onChange:(0,s.useCallback)((e=>{o(e.target.value)}),[]),focus:!0,focusAfterAnimation:!0,placeholder:V.default.formatMessage(jf.filterTeams)})}),g={menuType:cs.og.Popup,maxWidth:350,maxHeight:300,header:e.teamStores.length>5?p:void 0};return(0,c.jsx)(ps.Z,{...g,children:(0,c.jsx)(Mf.Z,{filter:m,context:{blocks:[],environment:t,publicEditMode:void 0},initialFocus:void 0,sections:u})})}function wf(e){let{from:t,teamStores:n}=e;const{styles:o,onClickButton:a}=function(e){let{from:t}=e;const n=(0,r.yK)((e=>({button:{marginRight:8},noTeams:{marginRight:8,color:e.lightTextColor},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},teamspaceName:{color:e.v2.text.secondary,maxWidth:70,...y.Z.textOverflowStyle},teamspaceNameSuffix:{color:e.v2.text.tertiary,paddingLeft:4}})),[]),o=(0,i.O7)(),a=(0,s.useCallback)((()=>{hg.b4(o,{from:t,button_name:"open_teamspaces"})}),[o,t]);return{styles:n,onClickButton:a}}({from:t}),l=n.length;return(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,onClick:a,renderOrigin:e=>(0,c.jsx)(pn.Z,{disabled:0===l,style:0===l?o.noTeams:o.button,...e,children:0===l?(0,c.jsx)(f.FormattedMessage,{id:"teamsDropdownForMember.teamsCountNone.label",defaultMessage:"No access"}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{style:o.teamspaceName,title:n[0].getName(),children:n[0].getName()}),(0,c.jsx)("span",{style:o.teamspaceNameSuffix,children:l>1?(0,c.jsxs)("div",{children:["+",l-1]}):null}),(0,Jr.i)(o.chevron)]})}),render:()=>(0,c.jsx)(Cf,{teamStores:n})})}function kf(e){let{spaceStore:t,request:n}=e;const{teamStores:s}=function(e){let{request:{accessRequest:t},spaceStore:n}=e;const s=(0,a.VK)((()=>{var e,s;const i=Lr.Z.state.teams.filter((e=>e.isDefault())),o=null===(e=t.getAttributes())||void 0===e?void 0:e.origin_table,a=null===(s=t.getAttributes())||void 0===s?void 0:s.origin_id;if(o&&a){const e=oe.zX.createChildStore(n,{table:vf.e0,id:a});i.includes(e)||i.push(e)}return i}),[t,n]);return{teamStores:s}}({request:n,spaceStore:t});return(0,c.jsx)(wf,{teamStores:s,from:"member_request"})}var If=n(842875);function Tf(e){let{request:t,spaceStore:n}=e;const{relativeDate:s,email:i,userStore:o,styles:l}=function(e){let{request:{accessRequest:t,forActor:n},spaceStore:s}=e;const i=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",fontSize:y.Z.fontSize.UIRegular.desktop,gap:10,flex:"1 0 0",maxWidth:50},userAvatar:{},title:{height:17,alignSelf:"stretch",fontSize:y.Z.fontSize.UIRegular.desktop,fontStyle:"normal",fontWeight:510,lineHeight:"18px",maxWidth:160,...y.Z.textOverflowStyle},subtitle:{height:17,alignSelf:"stretch",fontSize:y.Z.fontSize.UISmall.desktop,fontStyle:"normal",fontWeight:400,lineHeight:"15px",color:e.v2.text.secondary,maxWidth:160,...y.Z.textOverflowStyle}})),[]),o=oe.U6.createChildStore(s,{table:D.KJ,id:n.id}),{email:l}=(0,a.VK)((()=>({email:o.getEmail()})),[o]),d=(0,f.useIntl)(),c=(0,a.VK)((()=>t.created_time),[t]),u=_.CQ(c,(0,If.r)()),m=(0,Eo.ZV)({value:u,date_format:"relative",userTimeZone:(0,If.r)(),intl:d,allowRelativeDates:!0});return{email:l,styles:i,userStore:o,relativeDate:m}}({request:t,spaceStore:n});return(0,c.jsxs)("div",{style:l.container,children:[(0,c.jsx)($s.Z,{style:l.userAvatar,userStore:o,size:28}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:l.title,title:i,children:i}),(0,c.jsx)("div",{style:l.subtitle,title:s,children:s})]})]})}function Zf(e){let{spaceStore:t,requests:n,requestType:o,domainFilterValues:l,internalDomains:d}=e;const u=(0,i.O7)(),[m,p]=(0,s.useState)(Og),[g,y]=(0,s.useState)({column:Pf,sortAscending:!0}),x=(0,a.VK)((()=>Lg.Z.state.searchQuery),[]),[S,v]=(0,s.useState)([]),{rows:b,hasMore:M}=function(e){let{spaceStore:t,requestType:n,requests:s,searchQuery:i,domainFilters:o=[],internalDomains:r=[],limit:l,selectedRowIds:d,sortState:c}=e;const u=(0,a.VK)((()=>s.map((e=>{const s=oe.U6.createChildStore(t,{table:D.KJ,id:e.forActor.id});return{id:e.accessRequest.id,spaceStore:t,isClickable:!1,request:e,requestType:n,email:s.getEmail(),shouldDisableInteraction:d.includes(e.accessRequest.id)}}))),[t,n,s,d]),m=(0,h.oA)(o),p=u.filter((e=>{var t;const n=e.email?(0,sr.Gd)(e.email):void 0,s=(0,Jt.is)(e.email,r);return!(i&&(null===(t=e.email)||void 0===t||!t.includes(i)))&&(!(m.length>0)||m.some((e=>"other"===e?!s:n===e)))})),g=function(e,t){let{sortAscending:n}=t;const s=(0,h.MR)(e,(e=>e.email));n||s.reverse();return s}(p,c),f=g.length>l;return{rows:g.slice(0,l),hasMore:f}}({spaceStore:t,requestType:o,requests:n,domainFilters:(0,h.oA)(l),internalDomains:d,searchQuery:x,limit:m,sortState:g,selectedRowIds:S}),j=(0,s.useMemo)((()=>n.filter((e=>S.includes(e.accessRequest.id)))),[n,S]),[C,w]=(0,s.useState)(!1),[k,I]=(0,s.useState)(void 0),T=!b.some((e=>S.includes(e.id))),Z=(0,s.useCallback)((async()=>{w(!0),hg.b4(u,{from:`${o}_request`,button_name:"bulk_approve",count:j.length});const e=await Rf({environment:u,spaceStore:t,requests:j.map((e=>e.accessRequest)),requestType:o,status:"approved"});w(!1),e&&v([])}),[u,t,j,o]),P=(0,s.useCallback)((()=>{hg.b4(u,{from:`${o}_request`,button_name:"bulk_decline",count:j.length}),I(j)}),[u,o,I,j]),F=(0,s.useCallback)((()=>I(void 0)),[I]),_=function(e){let{requestType:t,onClickApprove:n,onClickDecline:s}=e;return"member"===t?[Pf,Ff,Af,Bf({onClickApprove:n,onClickDecline:s})]:[Pf,_f,Af,Bf({onClickApprove:n,onClickDecline:s})]}({requestType:o,onClickApprove:e=>Rf({environment:u,spaceStore:t,requests:[e.accessRequest],requestType:o,status:"approved"}),onClickDecline:e=>I([e])}),A=(0,r.yK)((e=>({container:{paddingBottom:30},headerContainer:{display:"flex",justifyContent:"space-between"},titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,minHeight:30,paddingTop:10},titleNumber:{color:e.v2.text.tertiary},actionsContainer:{display:"flex",borderRadius:6,border:`1px solid ${e.v2.stroke.regular}`,boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)"},actionLeftButton:{borderRadius:"4px 0px 0px 4px",paddingLeft:10,paddingRight:0,height:30},buttonContainerApprove:{display:"flex",padding:"0px 12px 0px 0px",justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:e.v2.text.ui.blue.primary},buttonContainerDecline:{display:"flex",padding:"0px 12px 0px 10px",justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:e.v2.text.secondary},buttonIcon:{width:20,height:20,paddingTop:1,flexDirection:"column",justifyContent:"center",alignItems:"center",gap:10},buttonText:{fontSize:14,fontWeight:510},buttonDivider:{width:1,background:e.v2.stroke.deemphasized},actionRightButton:{borderRadius:"0px 4px 4px 0px",paddingLeft:0,paddingRight:0,height:30},noRowContainer:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${e.v2.stroke.regular}`},noRowText:{color:e.v2.text.secondary,fontSize:14,fontWeight:400,textAlign:"center"}})),[]),B=function(e){return(0,r.yK)((t=>({...(0,be.b)({columnRenderInfo:e,theme:t,containerMarginTop:0})})),[e])}(_);return 0===n.length?null:(0,c.jsxs)("div",{style:A.container,children:[(0,c.jsxs)("div",{style:A.headerContainer,children:[(0,c.jsxs)("div",{style:A.titleContainer,children:[(0,c.jsx)("div",{children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionMembersTab.memberRequests.title",defaultMessage:"Requests"})}),(0,c.jsx)("span",{style:A.titleNumber,children:n.length})]}),S.length>0&&!T&&(0,c.jsxs)("div",{style:A.actionsContainer,children:[(0,c.jsx)(pf.Z,{style:A.actionLeftButton,onClick:Z,isLoading:C,children:(0,c.jsxs)("div",{style:A.buttonContainerApprove,children:[(0,c.jsx)("div",{style:A.buttonIcon,children:mf({width:20,height:20})}),(0,c.jsx)("div",{style:A.buttonText,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.bulkApprove",defaultMessage:"Approve {numberOfRequests, plural, one {1 request} other {{numberOfRequests} requests}}",values:{numberOfRequests:S.length}})})]})}),(0,c.jsx)("div",{style:A.buttonDivider}),(0,c.jsx)(pf.Z,{style:A.actionRightButton,onClick:P,isLoading:!1,children:(0,c.jsxs)("div",{style:A.buttonContainerDecline,children:[(0,c.jsx)("div",{style:{...A.buttonIcon,paddingTop:3},children:Ig({width:20,height:20})}),(0,c.jsx)("div",{style:A.buttonText,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.bulkDecline",defaultMessage:"Decline"})})]})})]})]}),(0,c.jsx)("div",{style:{marginTop:4},children:(0,c.jsx)(be.D,{allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:_,rows:b,showRowBorders:!0,hideHeaderRowPadding:!0,sortState:g,onSortStateChanged:y,renderNoRowsComponent:()=>(0,c.jsx)("div",{style:A.noRowContainer,children:(0,c.jsx)("div",{style:A.noRowText,children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionRequestTable.emptySearch",defaultMessage:"No search results"})})}),styles:B,getStyleForRow:e=>{if(e.shouldDisableInteraction)return{backgroundColor:"rgba(35, 131, 226, 0.07)"}},loadMoreType:"button",onLoadMore:M?()=>p(m+Og):void 0,multiselect:n.length>0?{header:{isDisabled:0===b.length,isSelected:S.length>0&&S.length===b.length,onClick:()=>{S.length===b.length?(v([]),hg.pZ(u,{from:`${o}_request`,action:"deselect_all",row_count:S.length})):(v(b.map((e=>e.id))),hg.pZ(u,{from:`${o}_request`,action:"select_all",row_count:b.length}))}},row:{getDisabledState:e=>!1,getSelectedState:e=>S.includes(e.id),onClick:e=>{v((t=>t.includes(e.id)?(hg.pZ(u,{from:`${o}_request`,action:"deselect_row",row_count:1}),t.filter((t=>t!==e.id))):(hg.pZ(u,{from:`${o}_request`,action:"select_row",row_count:1}),t.concat(e.id))))}}}:void 0})}),(0,c.jsx)(ff,{isModalOpen:(0,Zn.$K)(k),requestType:o,requests:k??[],handleClickDecline:async e=>{await Rf({environment:u,spaceStore:t,requests:e.map((e=>e.accessRequest)),requestType:o,status:"rejected"})&&v([]),I(void 0)},handleClickDismiss:F})]})}const Pf={id:"user",headerTitle:(0,c.jsx)("div",{style:{fontSize:14},children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionRequestsTable.user",defaultMessage:"User"})}),renderCell:e=>(0,c.jsx)(Tf,{request:e.request,spaceStore:e.spaceStore}),widthData:{width:219},sortable:!0},Ff={id:"teamspaces",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionRequestsTable.teamspaces",defaultMessage:"Teamspaces"})}),renderCell:e=>(0,c.jsx)(kf,{spaceStore:e.spaceStore,request:e.request}),widthData:{width:175},sortable:!1},_f={id:"pages",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14,minWidth:175,textAlign:"left"},children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionRequestsTable.pages",defaultMessage:"Access"})}),renderCell:e=>(0,c.jsx)(Sf,{request:e.request,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{width:175},sortable:!1},Af={id:"requestBy",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14,minWidth:160,textAlign:"left"},children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionRequestsTable.requestBy",defaultMessage:"Requested by"})}),renderCell:e=>(0,c.jsx)(xf,{request:e.request,shouldDisableInteraction:e.shouldDisableInteraction,requestType:e.requestType}),widthData:{width:120},sortable:!1};function Bf(e){let{onClickApprove:t,onClickDecline:n}=e;return{id:"actions",headerTitle:(0,c.jsx)("div",{style:{minWidth:155}}),renderCell:e=>(0,c.jsx)(gf,{request:e.request,shouldDisableInteraction:e.shouldDisableInteraction,requestType:e.requestType,handleApprove:t,handleDecline:n}),widthData:{width:100},sortable:!1}}async function Rf(e){let t,{environment:n,spaceStore:s,requests:i,requestType:o,status:a}=e;if(0===i.length)return!0;if("member"===o){const e=i.filter((e=>"guest_invite_request"!==e.getType())),o=i.filter((e=>"guest_invite_request"===e.getType())),r=await x.YN({environment:n,store:s,requests:e,status:a,from:"requests_center"}),l=await x.fJ({environment:n,store:s,requests:o,status:a,from:"requests_center"});t={failedUsers:r.failedUsers.concat(l.failedUsers),resolvedUsers:r.resolvedUsers.concat(l.resolvedUsers)}}else"guest"===o?t=await x.mY({environment:n,requests:i,status:a,from:"requests_center"}):(0,Zn.t1)(o);const r=function(e){let{requestType:t,result:{resolvedUsers:n,failedUsers:s},status:i}=e;if("guest"===t&&"approved"===i&&n.length>0)return{label:(0,c.jsx)(f.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.guests",defaultMessage:"Approved {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}",values:{numberOfSuccesses:n.length,userEmail:n[0].getEmail()}})};if("guest"===t&&"approved"===i&&s.length>0)return{label:(0,c.jsx)(f.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.guests.failed",defaultMessage:"Failed approve {numberOfRequests, plural, one {guest request for {userEmail}} other {{numberOfRequests} guest requests}}, please try again.",values:{numberOfRequests:s.length,userEmail:s[0].getEmail()}})};if("guest"===t&&"rejected"===i&&n.length>0)return{label:(0,c.jsx)(f.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.guests.success",defaultMessage:"Declined {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}",values:{numberOfSuccesses:n.length,userEmail:n[0].getEmail()}})};if("guest"===t&&"rejected"===i&&s.length>0)return{label:(0,c.jsx)(f.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.guests.failed",defaultMessage:"Failed decline {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}, please try again.",values:{numberOfSuccesses:s.length,userEmail:s[0].getEmail()}})};if("member"===t&&"approved"===i&&n.length>0)return{label:(0,c.jsx)(f.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.members.success",defaultMessage:"Approved {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}",values:{numberOfRequests:n.length,userEmail:n[0].getEmail()}})};if("member"===t&&"approved"===i&&s.length>0)return{label:(0,c.jsx)(f.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.members.failed",defaultMessage:"Failed to approve {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}, please try again.",values:{numberOfRequests:s.length,userEmail:s[0].getEmail()}})};if("member"===t&&"rejected"===i&&n.length>0)return{label:(0,c.jsx)(f.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.members.success",defaultMessage:"Declined {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}",values:{numberOfRequests:n.length,userEmail:n[0].getEmail()}})};if("member"===t&&"rejected"===i&&s.length>0)return{label:(0,c.jsx)(f.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.members.failed",defaultMessage:"Failed to decline {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}, please try again.",values:{numberOfRequests:s.length,userEmail:s[0].getEmail()}})};return}({requestType:o,result:t,status:a});return r&&vi.oV(r),0===t.failedUsers.length}function Df(e){let{spaceStore:t,guests:n}=e;const[o,r]=(0,s.useState)(),l=(0,i.O7)(),d=(0,a.VK)((()=>(bu.Z.getData(l,{spaceId:t.id})??[]).filter((e=>n.some((n=>{var s;return null===(s=oe.U6.createChildStore(t,{table:D.KJ,id:n.userId}).getEmail())||void 0===s?void 0:s.endsWith(`@${e.url}`)}))))),[l,t,n]),u=nn({spaceStore:t}),m=(0,yg.IH)({spaceStore:t}),p=tn({spaceStore:t,requestType:"guest"});return on({requestType:"guest",spaceStore:t}),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(lf,{guests:n,spaceStore:t,internalDomains:d,domainFilterValues:o,setDomainFilterValues:r}),u&&m&&(0,c.jsx)(Zf,{requests:p,spaceStore:t,requestType:"guest",domainFilterValues:o,internalDomains:d}),(0,c.jsx)(Kg,{guests:n,spaceStore:t,domainFilterValues:o??[],internalDomains:d})]})}var Of=n(587244);function Lf(e){let{spaceStore:t,spacePermissionsSettingsStore:n}=e;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Vf,{}),(0,c.jsx)(Ef,{spaceStore:t,spacePermissionsSettingsStore:n})]})}function Vf(){const e=Kf(),t=(0,i.O7)(),n=(0,s.useCallback)((()=>{C.D({environment:t,url:(0,ze.UY)("guides.invitePerson")})}),[t]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(fe.Z,{large:!0,style:e.headingStyle,children:[(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.people.common.title",defaultMessage:"People"}),(0,c.jsx)(yt.Z,{isSmall:!0,onClick:n,icon:di.m,children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSection.title.helpButton",defaultMessage:"Learn more"})})]}),(0,kt.Um)()]})}function Ef(e){let{spaceStore:t,spacePermissionsSettingsStore:n}=e;const s=(0,i.O7)(),o=(0,a.VK)((()=>{const e=Ht.subscriptionDataStoreInstance.state;return function(e){let{environment:t,spaceStore:n,subscriptionData:s}=e;if(!n.canEditMembership())return;const i=n.id,o=s&&("subscribed_admin"===s.type||"unsubscribed_admin"===s.type||"subscribed_membership_admin"===s.type)&&s.inviteLinkCode;if(!o)return;return(0,Nn.cJ)(t,i,o)}({spaceStore:t,environment:s,subscriptionData:e})}),[t,s]),r=(0,yg.tM)({spaceStore:t}),l=(0,a.VK)((()=>Boolean(t.getInviteLinkEnabled())),[t]),d=Kf();return r&&o?(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:d.inviteLinkSection,children:[(0,c.jsxs)("div",{style:{marginRight:8,flexGrow:1},children:[(0,c.jsx)(fe.Z,{children:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.inviteLink.title",defaultMessage:"Invite link"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"},children:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionSettings.spaceMembers.inviteLink.caption.v2",defaultMessage:"Enable a secret link for Workspace Owners and Membership Admins to invite new members."})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"},children:n&&l&&o&&(0,c.jsx)(Uf,{spaceStore:t})})]}),(0,c.jsx)("div",{style:{marginTop:28},children:(0,c.jsx)(al.Z,{on:l,onClick:()=>{!function(e){let{environment:t,spaceStore:n,inviteLinkEnabled:s}=e;const i=!s;b.eo(t,{enabled:i}),P.createAndCommit({userAction:"SpacePermissionsSettings.handleInviteLinkClick",environment:t,perform:e=>{w.ys({transaction:e,spaceStore:n,inviteLinkEnabled:Boolean(i)})}})}({environment:s,spaceStore:t,inviteLinkEnabled:l})}})})]}),n&&l&&o&&(0,c.jsx)(Nf,{inviteLinkUrl:o}),(0,c.jsx)(As.Z,{size:40})]}):null}function Nf(e){let{inviteLinkUrl:t}=e;const n=(0,r.yK)((e=>({input:{height:32,padding:"0px 4px 0px 8px",alignItems:"center",gap:"8px",flex:"1 0 0",borderRadius:"6px",border:e.v2.stroke.deemphasized,background:e.v2.surface.wash},button:{display:"flex",height:"32px",padding:"0px 12px",justifyContent:"center",alignItems:"center",borderRadius:"6px",border:`1px solid ${e.v2.stroke.regular}`,paddingLeft:12,paddingRight:12},buttonText:{fontSize:"14px",fontWeight:"510",lineHeight:"18px",textAlign:"center",fontStyle:"normal",color:e.v2.text.primary}})),[]),s=(0,i.O7)();return(0,c.jsx)("div",{children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px",alignSelf:"stretch",paddingBottom:"0px"},children:[(0,c.jsx)(Cs.Z,{type:"text",format:Cs.B.Default,value:t,disabled:!0,style:n.input}),(0,c.jsx)(Of.N,{step:"collaborate_copy_link",isFullWidth:!1,showContentOverlays:!1,highlightStyle:{borderRadius:6},children:(0,c.jsx)(Me.Z,{onClick:()=>{!function(e){let{environment:t,inviteLinkUrl:n}=e;ve.RD({environment:t,stringValue:n,copiedMessage:ve.tq.copiedLinkToClipboard}),hu.nl(t)}({environment:s,inviteLinkUrl:t})},style:n.button,children:(0,c.jsx)("div",{style:n.buttonText,children:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.inviteLink.copyButton",defaultMessage:"Copy link"})})})})]})})}function Uf(e){let{spaceStore:t}=e;const n=(0,i.O7)();return(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionSettings.spaceMembers.inviteLink.resetLink.v2",defaultMessage:"You can also <resetlink>generate a new link</resetlink>",values:{resetlink:e=>(0,c.jsx)(Rs.Z,{onClick:()=>{M.showDialog({message:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.description",defaultMessage:"Are you sure you want to reset the invite link for all space members? Your old one will no longer be able to be used."}),showCancel:!0,keepFocus:!1,handleCancel:M.dismissDialog,items:[{label:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.accept",defaultMessage:"Reset"}),color:"red",onAccept:async()=>{await I.refreshInviteLink(n,{spaceId:t.id}),ct.bi(n)}}]})},children:e})}})}function Kf(){return(0,r.yK)((e=>({commonTitle:{display:"flex",alignItems:"center"},commonTitleText:{fontSize:"17px",lineHeight:"22px",fontWeight:590,color:e.v2.text.primary,fontStyle:"normal"},commonHelpButton:{paddingLeft:"1px"},inviteLinkSection:{paddingTop:"16px",paddingBottom:"16px",display:"flex",alignItems:"flex-start"},headingStyle:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:y.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"}})),[])}var Wf=n(772141),zf=n(524665);function qf(e){let{user:t,spaceStore:n,shouldDisableAction:o}=e;const{styles:l,handleRemoveMemberFromWorkspace:d,environment:u,isCurrentUser:m}=function(e){let{user:t,spaceStore:n}=e;const o=(0,r.yK)((e=>({container:{width:"100%",display:"flex",justifyContent:"flex-end"},button:{display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:10,paddingLeft:0,paddingRight:0},buttonIcon:{width:20,height:20,fill:e.v2.icon.secondary},upgradeButton:{},removeMenuDivider:{borderTop:e.v2.stroke.deemphasized},removeButton:{color:bg.Lr[e.mode].red},upgradeIcon:{width:17,height:17}})),[]),l=(0,i.O7)(),d=(0,s.useCallback)((async()=>{const{currentUserSettingsStore:e}=Ge.default.state;return e?await(0,zf.$A)({user:t,spaceStore:n,environment:l,userSettingStore:e}):()=>{}}),[n,l,t]),c=(0,a.VK)((()=>{var e;return(null===(e=Ge.default.state.currentUserStore)||void 0===e?void 0:e.id)===t.userId}),[t]);return{styles:o,handleRemoveMemberFromWorkspace:d,environment:l,isCurrentUser:c}}({user:t,spaceStore:n});return(0,c.jsx)("div",{style:l.container,children:(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,renderOrigin:e=>(0,c.jsx)(pn.Z,{style:l.button,...e,children:(0,c.jsx)(c.Fragment,{children:(0,jg.O)(l.buttonIcon)})}),onClick:()=>{hg.b4(u,{from:"member",button_name:"actions"})},disabled:o,render:()=>(0,c.jsx)("div",{children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:void 0,sections:[{key:"remove",render:e=>(0,c.jsx)(ys.Z,{...e,style:l.removeMenuDivider}),items:[{key:"remove",render:e=>(0,c.jsx)(ms.Z,{...e,buttonStyle:l.removeButton,icon:(0,mi.V)(l.upgradeIcon),title:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionmembersTab.removeMember",defaultMessage:"{isCurrentUser, select, true {Leave workspace} other {Remove from workspace}} ",values:{isCurrentUser:m}})}),action:async()=>{await d(),hg.b4(u,{from:"member",button_name:"remove"})}}]}]})})})})}var Gf=n(516639);function Hf(e){let{shouldShowSearchHeader:t,sections:n,filterPlaceholder:o}=e;const a=(0,i.O7)(),[r,l]=(0,s.useState)(""),d=r,u=(0,c.jsx)(ys.Z,{isInput:!0,children:(0,c.jsx)(ul.ZP,{value:d,onChange:(0,s.useCallback)((e=>{l(e.target.value)}),[]),focus:!0,focusAfterAnimation:!0,placeholder:o&&V.default.formatMessage(o)})}),m={menuType:cs.og.Popup,maxWidth:350,maxHeight:300,header:t?u:void 0};return(0,c.jsx)(ps.Z,{...m,children:(0,c.jsx)(Mf.Z,{filter:d,context:{blocks:[],environment:a,publicEditMode:void 0},initialFocus:0,sections:n})})}const $f=(0,f.defineMessages)({filterGroups:{defaultMessage:"Filter groups...",id:"GroupPopupContent.filterGroups"}});function Yf(e){let{groups:t,spaceStore:n,spacePermissionsSettingsStore:s}=e;const i=(0,a.VK)((()=>t.map((e=>({group:e,numberOfGroupMembers:(0,Gf.kQ)({group:e,spaceStore:n}).length})))),[t,n]),o=(0,r.yK)((e=>({buttonTitle:{display:"flex",padding:"4px 6px 4px 8px",alignItems:"flex-start",gap:8,alignSelf:"stretch"},groupName:{color:e.v2.text.primary,fontSize:14},groupMemberCount:{color:e.v2.text.secondary,fontSize:12}})),[]),l=t.length>5;return(0,c.jsx)(Hf,{shouldShowSearchHeader:l,sections:[{key:"groups for member",render:e=>(0,c.jsx)(ys.Z,{...e}),actions:i.map((e=>{const{group:t,numberOfGroupMembers:i}=e;return{key:t.id,displayName:t.name,analyticsName:t.name??"unknown group",searchName:t.name,render:e=>(0,c.jsx)(ms.Z,{style:{padding:4},textWrapperStyle:{marginLeft:0,marginRight:0},title:(0,c.jsxs)("div",{style:o.buttonTitle,children:[(0,c.jsx)(hs.Z,{disabled:!0,bucket:"public",icon:t.icon?{pointer:n.pointer,icon:t.icon}:void 0,size:20,isEmptyPage:!1,title:t.name}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:o.groupName,children:t.name}),(0,c.jsx)("div",{style:o.groupMemberCount,children:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.userGroup.memberCount",defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} member} other {{numberOfGroupMembers} members}}",values:{numberOfGroupMembers:i}})})]})]}),...e}),action:()=>{s.setState({...s.state,currentTab:Mc.Q.Groups})},closeParentMenu:!1}}))}],filterPlaceholder:$f.filterGroups})}function Qf(e){let{user:t,spaceStore:n,spacePermissionsSettingsStore:o}=e;const{styles:l,groups:d,numberOfGroups:u,firstGroupName:m,onClick:p}=function(e){let{user:t,spaceStore:n}=e;const o=(0,a.VK)((()=>n.getPermissionGroups().filter((e=>(0,Gf.kQ)({group:e,spaceStore:n}).includes(t.userId)))),[n,t.userId]),l=(0,i.O7)(),d=(0,s.useCallback)((()=>{hg.b4(l,{from:"member",button_name:"open_groups"})}),[l]),c=(0,r.yK)((e=>({button:{marginRight:8},noGroups:{marginRight:8,color:e.lightTextColor},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},noneGroupText:{color:e.v2.text.tertiary},groupNameText:{color:e.v2.text.secondary,maxWidth:100,...y.Z.textOverflowStyle},groupNumberText:{color:e.v2.text.secondary}})),[]),u=(0,f.useIntl)(),m=o.length,p=m>0?(0,Gf.kF)({group:o[0],intl:u}):void 0;return{styles:c,groups:o,numberOfGroups:m,firstGroupName:p,onClick:d}}({user:t,spaceStore:n});return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,onClick:p,renderOrigin:e=>(0,c.jsx)(pn.Z,{disabled:0===u,style:0===u?l.noGroups:l.button,...e,children:0===u?(0,c.jsx)("span",{style:l.noneGroupText,children:(0,c.jsx)(f.FormattedMessage,{id:"userGroupsCell.noGroups",defaultMessage:"None"})}):1===u?(0,c.jsx)("span",{style:l.groupNameText,title:m,children:m}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:l.groupNumberText,children:u}),(0,Jr.i)(l.chevron)]})}),render:()=>(0,c.jsx)(Yf,{groups:d,spaceStore:n,spacePermissionsSettingsStore:o})})})}var Jf=n(207567);function Xf(e){let{user:t,spaceStore:n,maxWidth:s}=e;const o=(0,r.yK)((e=>({button:{color:e.v2.text.secondary,maxWidth:s}})),[s]),l=(0,i.O7)(),{isPermissionSelectDisabled:d,currentUserId:u}=(0,a.VK)((()=>{let e=!0;return(n.canAdmin()||n.canEditMembership()&&(Wf.RN(t.role)||t.userId===l.currentUser.id))&&(e=!1),{isPermissionSelectDisabled:e,currentUserId:l.currentUser.id}}),[n,l,t.role,t.userId]),m=(0,a.VK)((()=>Ge.default.state.currentUserSettingsStore),[]),p=(0,f.useIntl)(),g=(0,a.VK)((()=>{const e=p.formatMessage({id:"spacePermissionSettings.memberRoleSelect.permissionitem.roleUpgradeDisabled",defaultMessage:"Cannot upgrade to a higher role than member"}),t="enterprise"===n.getSubscriptionTier();return h.oA(Wf.an.filter((e=>"none"!==e)).map((s=>{if(t||"membership_admin"!==s)return{role:s,disabledInfo:!n.canAdmin()&&Wf.Bc(s)?{isDisabled:!0,disabledMessage:e}:void 0}})))}),[p,n]);return m?(0,c.jsx)(Jf.ZP,{role:t.role,table:Dn.bx,type:"user_permission",disabled:d,isUserPermission:t.userId===u,upgradeButtonName:"space_permission_item",availableRoleItems:g,buttonStyle:o.button,onChange:async e=>{await zf.Vu({member:t,newRole:e,currentUserSettingsStore:m,spaceStore:n,environment:l})},onClick:()=>{hg.b4(l,{from:"member",button_name:"open_role"})}}):null}function eh(e){let{user:t,spaceStore:n}=e;return(0,c.jsx)("div",{children:(0,c.jsx)(Xf,{user:t,spaceStore:n,maxWidth:148})})}function th(e){let{user:t}=e;const{userTeamStores:n}=function(e){let{user:t}=e;const n=(0,a.VK)((()=>Lr.Z.state.teams.filter((e=>e.isMemberOrGuest(t.userId)))),[t.userId]);return{userTeamStores:n}}({user:t});return(0,c.jsx)(wf,{teamStores:n,from:"member"})}function nh(e){let{members:t,spaceStore:n,spacePermissionsSettingsStore:i,shouldShowHeading:o}=e;const{tableStyles:l,styles:d,sortState:u,setSortState:m,rows:p,membersCount:g,searchQuery:y,columnRenderInfo:x,shouldShowLoadMore:S,onLoadMore:v}=function(e){let{members:t,spaceStore:n,spacePermissionsSettingsStore:i}=e;const o=(0,yg.eA)({spaceStore:n}),l=(0,a.VK)((()=>n.canAdmin()),[n]),d=(0,a.VK)((()=>o?[sh,ih,oh,ah,rh]:[sh,ih,oh,ah]),[o]),c=(0,r.yK)((e=>({...(0,be.b)({columnRenderInfo:d,theme:e,containerMarginTop:0})})),[d]),u=(0,r.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,height:32},titleNumber:{color:e.v2.text.tertiary},emptyMessage:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${e.v2.stroke.regular}`}})),[]),[m,p]=(0,s.useState)({column:ah,sortAscending:!1}),g=(0,f.useIntl)(),y=(0,a.VK)((()=>Lg.Z.state.searchQuery),[]),x=(0,yg.bS)({spaceStore:n,members:t}),S=(0,a.VK)((()=>t.map((e=>{const t=oe.U6.createChildStore(n,{table:D.KJ,id:e.userId}),s=null==x?void 0:x.find((t=>t.userId===e.userId));return{spaceStore:n,user:e,email:t.getEmail(),userName:t.getDisplayName(g),id:e.userId,isClickable:!1,userRole:e.role,spacePermissionsSettingsStore:i,shouldDisableAction:!(l||!o||"editor"!==e.role&&"membership_admin"!==e.role),restorationStatus:null==s?void 0:s.restorationStatus}})).filter((e=>{var t,n;return void 0===y||(((null===(t=e.email)||void 0===t?void 0:t.includes(y))||(null===(n=e.userName)||void 0===n?void 0:n.includes(y)))??!1)}))),[n,t,g,y,l,o,i,x]),v=S.length,b=(0,a.VK)((()=>function(e,t){let{sortAscending:n,column:s}=t,i=e;switch(s.id){case"user":i=h.MR(e,(e=>e.email));break;case"roles":i=h.MR(e,(e=>Wf.xm[e.userRole]))}n||i.reverse();return i}(S,m)),[S,m]),[M,j]=(0,s.useState)(Rg),C=(0,s.useCallback)((()=>{j(M+Rg)}),[M]),w=M<b.length,k=b.slice(0,M);return{tableStyles:c,styles:u,sortState:m,setSortState:p,rows:k,searchQuery:y,membersCount:v,columnRenderInfo:d,onLoadMore:C,shouldShowLoadMore:w}}({members:t,spaceStore:n,spacePermissionsSettingsStore:i});return(0,c.jsxs)(c.Fragment,{children:[o&&(0,c.jsxs)("div",{style:d.titleContainer,children:[(0,c.jsx)("span",{children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionMembersTab.activeMembers.title",defaultMessage:"Active"})}),(0,c.jsx)("span",{style:d.titleNumber,children:g})]}),(0,c.jsx)("div",{style:{marginTop:o?4:-1},children:(0,c.jsx)(be.D,{allowHorizontalScroll:!0,setStickyHeaderRow:!0,columnRenderInfo:x,rows:p,showRowBorders:!0,hideHeaderRowPadding:!0,sortState:u,onSortStateChanged:m,loadMoreType:"button",onLoadMore:S?v:void 0,renderNoRowsComponent:()=>(0,c.jsx)(Ce.Z,{isSmall:!0,style:d.emptyMessage,children:y?(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionMembersTab.emptySearch",defaultMessage:"No search results"}):(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionMembersTab.emptyRow",defaultMessage:"No members"})}),styles:l})})]})}const sh={id:"user",headerTitle:(0,c.jsx)("div",{style:{fontSize:14},children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionMembersTab.user",defaultMessage:"User"})}),renderCell:e=>(0,c.jsx)(Ug,{userId:e.user.userId,restorationStatus:e.restorationStatus,spaceStore:e.spaceStore}),widthData:{width:219},sortable:!0},ih={id:"teamspaces",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,c.jsx)(f.FormattedMessage,{id:"teamspaces",defaultMessage:"Teamspaces"})}),renderCell:e=>(0,c.jsx)(th,{user:e.user}),widthData:{width:175},sortable:!1},oh={id:"groups",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,c.jsx)(f.FormattedMessage,{id:"groups",defaultMessage:"Groups"})}),renderCell:e=>(0,c.jsx)(Qf,{user:e.user,spaceStore:e.spaceStore,spacePermissionsSettingsStore:e.spacePermissionsSettingsStore}),widthData:{width:118.5},sortable:!1},ah={id:"roles",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,c.jsx)(f.FormattedMessage,{id:"role",defaultMessage:"Role"})}),renderCell:e=>(0,c.jsx)(eh,{user:e.user,spaceStore:e.spaceStore}),widthData:{width:118.5},sortable:!0},rh={id:"actions",headerTitle:(0,c.jsx)(c.Fragment,{}),renderCell:e=>(0,c.jsx)(qf,{user:e.user,spaceStore:e.spaceStore,shouldDisableAction:e.shouldDisableAction}),widthData:{width:51},sortable:!1};var lh=n(747612),dh=n(732566);function ch(e){let{currentTab:t}=e;const n=(0,r.yK)((e=>({icon:{fontSize:14,fontWeight:510,fill:e.v2.icon.secondary,cursor:"pointer"},ctaIcon:{fontSize:12,fill:e.v2.icon.secondary,fontWeight:510}})),[]),o=(0,i.O7)(),a=(0,s.useCallback)((()=>{rt.Z.setState({...rt.Z.state,currentTab:"security",defaultSubtab:void 0}),hg.kx(o,{current_tab:t})}),[o,t]);return(0,s.useEffect)((()=>{hg.Ad(o,{current_tab:t})}),[o,t]),(0,c.jsx)(Ji,{leftIcon:(0,lh.C)(n.icon),content:(0,c.jsx)(f.FormattedMessage,{id:"PeopleSectionSecurityBanner.title",defaultMessage:"Some invite settings have moved, make changes in Security tab"}),rightIcon:(0,dh.k)(n.ctaIcon),onClick:a})}var uh=n(561061);const mh=3;function ph(e){let{guests:t,spaceStore:n,internalDomains:o}=e;const{environment:l,tableStyles:d,sortState:u,setSortState:m,selectedRowIds:p,setSelectedRowIds:g,rows:h,searchQuery:y,canEditMembership:x,columnRenderInfo:S,guestsCount:v,onClickApprove:b,isSubscribed:M}=function(e){let{guests:t,spaceStore:n,internalDomains:o}=e;const l=(0,i.O7)(),d=(0,yg.eA)({spaceStore:n}),c=(0,a.VK)((()=>d?[hh,yh,xh]:[hh]),[d]),u=(0,r.yK)((e=>({...(0,be.b)({columnRenderInfo:c,theme:e,containerMarginTop:0})})),[c]),m=(0,a.VK)((()=>c[0]),[c]),[p,g]=(0,s.useState)({column:m,sortAscending:!0}),[h,y]=(0,s.useState)([]),x=(0,f.useIntl)(),S=(0,a.VK)((()=>Lg.Z.state.searchQuery),[]),v=(0,a.VK)((()=>{const e=Ht.subscriptionDataStoreInstance.state;return Boolean(e&&Gt.YK(e))}),[]),b=(0,a.VK)((()=>t.map((e=>{const t=oe.U6.createChildStore(n,{table:D.KJ,id:e.userId}),s=t.getEmail(),i=null==s?void 0:s.split("@")[1],a=o.some((e=>e.url===i));return{spaceStore:n,user:e,email:s,userName:t.getDisplayName(x),guestUserStore:t,id:e.userId,shouldDisableInteraction:h.includes(e.userId),isClickable:!1,isInternalGuest:a,isSubscribed:v}})).filter((e=>{if(S){var t;if(!((null===(t=e.email)||void 0===t?void 0:t.includes(S))||e.userName.includes(S)))return!1}return e.isInternalGuest})).slice(0,mh)),[t,n,o,x,h,v,S]),M=(0,s.useCallback)((()=>{hg.b4(l,{from:"guest_suggestions",button_name:"bulk_upgrade",count:h.length}),h.forEach((e=>{const t=oe.U6.createChildStore(n,{table:D.KJ,id:e}),s=v?"read_and_write":"editor";Mg.s({environment:l,guestUserStore:t,role:s,store:n,isConvertToAdmin:!v,origin:"suggested_guest_table"}),y([])}))}),[h,l,v,n]),j=!b.some((e=>h.includes(e.id)));return{environment:l,tableStyles:u,sortState:p,setSortState:g,selectedRowIds:h,setSelectedRowIds:y,rows:b,searchQuery:S,isApproveButtonLoading:!1,canEditMembership:d,columnRenderInfo:c,isSubscribed:v,shouldHideActions:j,guestsCount:b.length,onClickApprove:M}}({guests:t,spaceStore:n,internalDomains:o}),j=function(){const e=(0,r.yK)((e=>({suggestions:{transition:"opacity 1s",marginTop:12},suggestionsHidden:{transition:"opacity 1s",opacity:0},titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,height:32},titleNumber:{color:e.v2.text.tertiary},emptyMessage:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${e.v2.stroke.regular}`},emptyDivider:{height:1,backgroundColor:e.v2.stroke.deemphasized},headerContainer:{display:"flex",justifyContent:"space-between",alignItems:"center"},suggestionsMenu:{width:265},hideSuggestionIcon:{height:20,width:20},learnMoreIcon:{height:20,width:20},learnMoreMenuItem:{color:e.text.secondary},learnMoreSection:{paddingTop:4,paddingBottom:4,borderTop:`1px solid ${e.v2.stroke.deemphasized}`},optionsContainer:{display:"flex",alignItems:"center"},actionsContainer:{display:"flex",borderRadius:6,border:`1px solid ${e.v2.stroke.regular}`,boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)"},buttonIcon:{width:20,height:20,paddingTop:1,flexDirection:"column",justifyContent:"center",alignItems:"center",gap:10},buttonText:{fontSize:14,fontWeight:510},buttonContainerApprove:{display:"flex",padding:"0px 12px 0px 0px",justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:e.v2.text.ui.blue.primary},approveButton:{borderRadius:"4px 0px 0px 4px",paddingLeft:10,paddingRight:0,height:30}})),[]);return e}(),[w,k]=(0,s.useState)(!0),I=(0,s.useCallback)((()=>{C.D({environment:l,url:(0,ze.UY)("guides.invitePerson")})}),[l]);if(0===o.length)return null;if(0===h.length)return null;if(!w)return null;const T=p.length>0;return(0,c.jsxs)("div",{style:w?j.suggestions:j.suggestionsHidden,children:[(0,c.jsxs)("div",{style:j.headerContainer,children:[(0,c.jsxs)("div",{style:j.titleContainer,children:[(0,c.jsx)("span",{children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionguestsTab.suggestions.title",defaultMessage:"Suggestions"})}),(0,c.jsx)("span",{style:j.titleNumber,children:v})]}),(0,c.jsx)("div",{style:j.optionsContainer,children:T?(0,c.jsx)("div",{style:j.actionsContainer,children:(0,c.jsx)(pn.Z,{style:j.approveButton,onClick:b,children:(0,c.jsxs)("div",{style:j.buttonContainerApprove,children:[(0,c.jsx)("div",{style:j.buttonIcon,children:_a({width:20,height:16})}),(0,c.jsx)("div",{style:j.buttonText,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.peopleSection.guestsTable.bulkUpgrade",defaultMessage:"Upgrade {numberOfRequests, plural, one {1 guest} other {{numberOfRequests} guests}} to {isSubscribed, select, true {member} other {admin}}",values:{numberOfRequests:p.length,isSubscribed:M}})})]})})}):(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,renderOrigin:e=>(0,c.jsx)(ui.Z,{icon:jg.O,ariaLabel:"3 Dots",style:{height:24,width:24},iconStyle:{width:20,height:20},...e}),onClick:()=>{hg.b4(l,{from:"guest_suggestions",button_name:"upgrade"})},render:()=>(0,c.jsx)("div",{children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:void 0,style:j.suggestionsMenu,sections:[{key:"hide_suggestions",render:e=>(0,c.jsx)(ys.Z,{...e}),items:[{key:"hide_suggestions",render:e=>(0,c.jsx)(ms.Z,{...e,icon:(0,uh.B)(j.hideSuggestionIcon),title:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionguestsTab.hideSuggestions",defaultMessage:"Hide Suggestions"})}),action:()=>{k(!1),hg.b4(l,{from:"guest_suggestions",button_name:"hide_suggestions"})}}]},{key:"learn_more",render:e=>(0,c.jsx)(ys.Z,{...e,style:j.learnMoreSection}),items:[{key:"learn_more",render:e=>(0,c.jsx)(ms.Z,{...e,icon:(0,di.m)(j.learnMoreIcon),title:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionguestsTab.learnMore",defaultMessage:"Learn more"}),style:j.learnMoreMenuItem}),action:()=>{I(),hg.b4(l,{from:"guest_suggestions",button_name:"suggestions_learn_more"})}}]}]})})})})]}),(0,c.jsx)("div",{style:{marginBottom:36,marginTop:4},children:(0,c.jsx)(be.D,{allowHorizontalScroll:x,setStickyHeaderRow:!0,columnRenderInfo:S,rows:Sh(h,u),showRowBorders:!0,hideHeaderRowPadding:!0,sortState:u,onSortStateChanged:m,loadMoreType:"button",renderNoRowsComponent:()=>(0,c.jsx)(Ce.Z,{isSmall:!0,style:j.emptyMessage,children:y?(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionGuestsTab.emptySearch",defaultMessage:"No search results"}):(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionGuestsTab.emptyRow",defaultMessage:"No guests"})}),styles:d,multiselect:x?{header:{isDisabled:0===h.length,isSelected:p.length>0&&p.length===h.length,onClick:()=>{p.length===h.length?(g([]),hg.pZ(l,{from:"guest_suggestions",action:"deselect_all",row_count:p.length})):(g(h.map((e=>e.id))),hg.pZ(l,{from:"guest_suggestions",action:"select_all",row_count:h.length}))}},row:{getDisabledState:()=>!1,getSelectedState:e=>p.includes(e.id),onClick:e=>{g((t=>t.includes(e.id)?(hg.pZ(l,{from:"guest_suggestions",action:"deselect_row",row_count:1}),t.filter((t=>t!==e.id))):(hg.pZ(l,{from:"guest_suggestions",action:"select_row",row_count:1}),t.concat(e.id))))}}}:void 0})})]})}function gh(){const e=(0,r.Fg)();return(0,c.jsx)("div",{style:{color:e.text.secondary},children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionguestsTab.suggestions.reason.approvedEmailDomain",defaultMessage:"Approved email domain"})})}function fh(e){let{spaceStore:t,upgradeMember:n,guestUserStore:o,disabled:a}=e;const l=(0,r.Fg)(),d=(0,i.O7)(),[u,m]=(0,s.useState)(!1);return(0,c.jsx)(pn.Z,{disabled:a,style:{background:l.tint.uiBlue,color:l.text.uiBluePrimary,fontWeight:510,fontSize:14,borderRadius:4,paddingTop:4,paddingBottom:4,paddingLeft:12,paddingRight:12,marginLeft:24,...a&&{color:l.text.uiBlueTertiary}},hoveredStyle:{background:l.tint.uiBlueHover},onClick:async()=>{m(!0),hg.b4(d,{from:"guest_suggestions",button_name:"upgrade"}),await n({environment:d,store:t,guestUserStore:o}),m(!1)},isLoading:u,children:(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.peopleSection.suggestionsTable.upgrade",defaultMessage:"Upgrade"})})}const hh={id:"user",headerTitle:(0,c.jsx)("div",{style:{fontSize:14},children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionGuestsTab.guest",defaultMessage:"User"})}),renderCell:e=>(0,c.jsx)(Ug,{userId:e.user.userId,spaceStore:e.spaceStore,isInternalGuest:e.isInternalGuest,isForSuggestionsTable:!0}),widthData:{width:210},sortable:!0},yh={id:"access",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionGuestsTab.access",defaultMessage:"Access"})}),renderCell:e=>(0,c.jsx)("div",{style:{display:"flex"},children:(0,c.jsx)(Bg,{guest:e.user,shouldDisableInteraction:e.shouldDisableInteraction})}),widthData:{width:120},sortable:!1},xh={id:"reason",headerTitle:(0,c.jsx)("div",{style:{fontSize:14},children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionguestsTab.suggestions.reason",defaultMessage:"Reason"})}),renderCell:e=>(0,c.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsx)(gh,{}),(0,c.jsx)(fh,{upgradeMember:async t=>{await Mg.s({origin:"suggested_guest_table",isConvertToAdmin:!1,role:e.isSubscribed?"read_and_write":"editor",...t})},spaceStore:e.spaceStore,guestUserStore:e.guestUserStore,disabled:e.shouldDisableInteraction})]}),widthData:{width:256},sortable:!1};function Sh(e,t){let{sortAscending:n}=t;const s=h.MR(e,(e=>e.email));return n||s.reverse(),s}function vh(e){let{spaceStore:t,members:n,spacePermissionsSettingsStore:s,guests:o}=e;const r=(0,i.O7)(),l=(0,a.VK)((()=>(bu.Z.getData(r,{spaceId:t.id})??[]).filter((e=>o.some((n=>{var s;return null===(s=oe.U6.createChildStore(t,{table:D.KJ,id:n.userId}).getEmail())||void 0===s?void 0:s.endsWith(`@${e.url}`)}))))),[r,t,o]),d=nn({spaceStore:t}),u=(0,yg.IH)({spaceStore:t}),m=tn({spaceStore:t,requestType:"member"});on({requestType:"member",spaceStore:t});const p=function(e){let{spaceStore:t,guests:n,internalDomains:s}=e;return(0,a.VK)((()=>{const e=n.map((e=>oe.U6.createChildStore(t,{table:D.KJ,id:e.userId}).getModel())).some((e=>(0,Jt.dr)(e,s)));return t.canEditMembership()&&e&&"on"===Ie.default.getEligibleGroup({experimentId:"people_tab_show_guest_suggestions",defaultGroup:"control"})}),[n,s,t])}({spaceStore:t,guests:o,internalDomains:l}),g=d&&0!==m.length,f=g||p;return(0,c.jsxs)(c.Fragment,{children:[p&&!g&&(0,c.jsx)(ph,{guests:o,spaceStore:t,internalDomains:l}),g&&(0,c.jsxs)("div",{style:{paddingTop:16,paddingBottom:16},children:[u&&(0,c.jsx)(ch,{currentTab:"members"}),(0,c.jsx)(Zf,{requests:m,spaceStore:t,requestType:"member"})]}),(0,c.jsx)(nh,{members:n,spaceStore:t,spacePermissionsSettingsStore:s,shouldShowHeading:f}),p&&g&&(0,c.jsx)(ph,{guests:o,spaceStore:t,internalDomains:l})]})}var bh=n(983890);function Mh(e){let{recentRecoverableUser:t,spaceStore:n}=e;const{environment:o,styles:a,handleReprovisionToUserChange:l,userId:d,selectedTransferToUser:u}=function(e){let{recentRecoverableUser:t,spaceStore:n}=e;const o=(0,r.yK)((e=>({container:{display:"flex",width:"100%",justifyContent:"flex-end"},button:{display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:10,paddingLeft:0,paddingRight:0},buttonIcon:{width:20,height:20,fill:e.v2.icon.secondary},removeMenuDivider:{borderTop:e.v2.stroke.deemphasized},upgradeIcon:{width:17,height:17}})),[]),a=(0,i.O7)(),[l,d]=(0,s.useState)(),u=(0,s.useCallback)((async(e,s)=>{if(!(await M.confirmUserAction({message:(0,c.jsx)("span",{children:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.reprovisionPrivatePagesConfirmationDialog.confirmationMessage",defaultMessage:"Are you sure you want to transfer their private pages? This action cannot be undone."})}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.reprovisionPrivatePagesConfirmationDialog.confirmButton.label",defaultMessage:"Transfer private pages"})})))return;d(s);const i=await I.transferSpaceUserContent(a,{spaceId:n.id,fromUserId:e,toUserId:s});"failed"===i.type?M.showError(i):(t.privatePagesCount=0,Lg.Z.setState({...Lg.Z.state,recentRecoverableUsers:[...Lg.Z.state.recentRecoverableUsers.filter((t=>t.userId!==e)),t]}))}),[a,n,t]);return{environment:a,styles:o,handleReprovisionToUserChange:u,userId:t.userId,selectedTransferToUser:l}}({recentRecoverableUser:t,spaceStore:n});return d?(0,c.jsx)("div",{style:a.container,children:(0,c.jsx)(na.ZP,{popupType:na.Z4.Popup,onClick:()=>{hg.b4(o,{from:"recently_left",button_name:"actions"})},renderOrigin:e=>(0,c.jsx)(pn.Z,{style:a.button,...e,children:(0,c.jsx)(c.Fragment,{children:(0,jg.O)(a.buttonIcon)})}),render:()=>(0,c.jsx)("div",{children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:void 0,sections:[{key:"transfer",render:e=>(0,c.jsx)(ys.Z,{...e,style:a.removeMenuDivider}),items:[{key:"transfer",render:e=>(0,c.jsx)(bh.Z,{mode:J.z.Button,focused:!1,title:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.reprovision.toUser.title",defaultMessage:"Transfer private pages"}),parentStore:n,userIds:u?[u]:[],onChange:e=>{let[t]=e;l(d,t)}}),action:()=>{hg.b4(o,{from:"recently_left",button_name:"open_transfer_ownership"})}}]}]})})})}):null}function jh(e){let{spaceStore:t,recentRecoverableUsers:n}=e;const s=(0,r.yK)((e=>({icon:{fontSize:14,fontWeight:510,fill:e.v2.icon.secondary}})),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{paddingTop:16,paddingBottom:16},children:(0,c.jsx)(Ji,{leftIcon:(0,wi.D)(s.icon),content:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionReprovisioningTab.settingsDeeplinkBannerTitle",defaultMessage:"People left the workspace in the past 30 days and had private pages appear here"})})}),(0,c.jsx)(Ch,{recentRecoverableUsers:n,spaceStore:t})]})}function Ch(e){let{spaceStore:t,recentRecoverableUsers:n}=e;const{rows:i,sortState:o,setSortState:l,tableStyles:d}=function(e){let{recentRecoverableUsers:t,spaceStore:n}=e;const i=(0,r.yK)((e=>(0,be.b)({columnRenderInfo:kh,theme:e,containerMarginTop:0})),[]),[o,l]=(0,s.useState)({column:kh[0],sortAscending:!0}),d=(0,a.VK)((()=>t.map((e=>{const t=oe.U6.createChildStore(n,{table:D.KJ,id:e.userId});return{spaceStore:n,reprovisioningUser:e,email:t.getEmail(),id:e.userId,isClickable:!1}}))),[n,t]);return{rows:d,sortState:o,setSortState:l,tableStyles:i}}({recentRecoverableUsers:n,spaceStore:t}),u=(0,r.yK)((e=>({noRowContainer:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${e.v2.stroke.regular}`}})),[]);return(0,c.jsx)("div",{style:{marginTop:4},children:(0,c.jsx)(be.D,{setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:kh,rows:Ih(i,o),showRowBorders:!0,hideHeaderRowPadding:!0,sortState:o,onSortStateChanged:l,renderNoRowsComponent:()=>(0,c.jsx)(Ce.Z,{isSmall:!0,style:u.noRowContainer,children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionReprovisioningTab.noUser",defaultMessage:"No recent left user"})}),styles:d})})}function wh(e){let{userLeftTime:t}=e;const n=(0,f.useIntl)(),s=(0,a.VK)((()=>{const e=_.CQ(t,(0,If.r)());return(0,Eo.ZV)({value:e,date_format:"relative",userTimeZone:(0,If.r)(),intl:n,allowRelativeDates:!0})}),[t,n]);return(0,c.jsx)(Ce.Z,{isSmall:!0,children:s})}const kh=[{id:"user",headerTitle:(0,c.jsx)("div",{style:{fontSize:14},children:(0,c.jsx)(f.FormattedMessage,{id:"peopleSectionReprovisioningTab.user",defaultMessage:"User"})}),renderCell:e=>(0,c.jsx)(Ug,{userId:e.reprovisioningUser.userId,spaceStore:e.spaceStore}),widthData:{width:220},sortable:!0},{id:"pageCount",headerTitle:(0,c.jsx)("div",{style:{fontSize:14},children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Private pages",id:"peopleSectionReprovisioningTab.privatePages"})}),renderCell:e=>(0,c.jsx)(Ce.Z,{isSmall:!0,children:e.reprovisioningUser.privatePagesCount}),widthData:{width:100},sortable:!1},{id:"leftTime",headerTitle:(0,c.jsx)("div",{style:{fontSize:14},children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Left workspace",id:"peopleSectionReprovisioningTab.leftTime"})}),renderCell:e=>(0,c.jsx)(wh,{userLeftTime:e.reprovisioningUser.userLeftTime}),widthData:{width:100},sortable:!1},{id:"actions",headerTitle:"",renderCell:e=>(0,c.jsx)(Mh,{recentRecoverableUser:e.reprovisioningUser,spaceStore:e.spaceStore}),widthData:{width:100},sortable:!1}];function Ih(e,t){let{sortAscending:n}=t;const s=h.MR(e,(e=>e.email));return n||s.reverse(),s}var Th=n(849019),Zh=n(212534),Ph=n(623063);function Fh(e){let{handleSearchQueryChange:t,currentTab:n,isSearchBarAlwaysOpen:o}=e;const{styles:a,isSearchOpen:l,intl:d,handleSearchButtonClick:u,handleSearchDismiss:m,searchQuery:p,setSearchQuery:g}=function(e){let{handleSearchQueryChange:t,currentTab:n,isSearchBarAlwaysOpen:o}=e;const a=(0,r.yK)((e=>({searchIcon:{width:14,height:void 0,fill:e.mediumTextColor},topbarIconButton:{display:"flex",alignItems:"center",fontSize:14,height:28,width:28,padding:6,color:e.mediumTextColor,fill:e.mediumIconColor,fontWeight:y.Z.fontWeight.regular,lineHeight:1,borderRadius:4},searchInput:{fontSize:14,lineHeight:1,paddingRight:4,color:e.regularTextColor,marginBottom:1}})),[]),l=(0,i.O7)(),[d,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)(void 0),p=(0,s.useCallback)((()=>{c(!0),hg.RP(l,{current_tab:n})}),[l,n]),g=(0,s.useCallback)((()=>{c(!1),m(void 0),t(void 0)}),[t]),h=(0,f.useIntl)();return{styles:a,isSearchOpen:d||o,intl:h,handleSearchButtonClick:p,handleSearchDismiss:g,searchQuery:u,setSearchQuery:m}}({handleSearchQueryChange:t,currentTab:n,isSearchBarAlwaysOpen:o});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ui.Z,{ariaLabel:d.formatMessage({id:"searchPlaceholder",defaultMessage:"Type to search..."}),icon:Th.e,iconStyle:a.searchIcon,style:a.topbarIconButton,onClick:u,disableBackground:o}),(0,c.jsx)(Ph.Z,{isVisible:l,animationStyle:{width:150,opacity:1},enterAnimationStyle:{width:0,opacity:0},exitAnimationStyle:{width:0,opacity:0},skipAnimation:o,render:()=>(0,c.jsx)(qs.Z,{capture:l,allowEsc:!0,render:e=>(0,c.jsx)("div",{...e,children:(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",overflow:"hidden"},children:(0,c.jsx)(Cs.Z,{style:a.searchInput,format:Cs.B.Transparent,value:p,onChange:e=>{const n=e.target.value;g(n),t(n)},placeholder:d.formatMessage({id:"searchPlaceholder",defaultMessage:"Type to search..."}),focusInitial:l,showClearButton:!0,onCancel:m,onClick:Zh.Wi,onClearButtonClick:m,onKeyDown:e=>{27===e.keyCode&&m()},onBlur:()=>{!p&&m()}})})})})})]})}const _h=(0,d.IU)("arrowDownPage",{viewBox:"0 0 14 18",svg:(0,c.jsx)("path",{d:"M7.67969 9.39844V11.7891L7.61719 13.0078L8.21875 12.3828L8.8125 11.7656C8.875 11.7031 8.94531 11.6536 9.02344 11.6172C9.10677 11.5755 9.19271 11.5547 9.28125 11.5547C9.45312 11.5547 9.59635 11.612 9.71094 11.7266C9.83073 11.8411 9.89062 11.9844 9.89062 12.1562C9.89062 12.2552 9.8724 12.3411 9.83594 12.4141C9.79948 12.487 9.74479 12.5573 9.67188 12.625L7.51562 14.6016C7.42708 14.6849 7.34115 14.7448 7.25781 14.7812C7.17969 14.8177 7.09375 14.8359 7 14.8359C6.90104 14.8359 6.8125 14.8177 6.73438 14.7812C6.65625 14.7448 6.57031 14.6849 6.47656 14.6016L4.32031 12.625C4.2474 12.5573 4.19271 12.487 4.15625 12.4141C4.11979 12.3411 4.10156 12.2552 4.10156 12.1562C4.10156 11.9844 4.15885 11.8411 4.27344 11.7266C4.39323 11.612 4.54167 11.5547 4.71875 11.5547C4.79688 11.5547 4.8776 11.5755 4.96094 11.6172C5.04427 11.6536 5.11719 11.7031 5.17969 11.7656L5.77344 12.3828L6.375 13.0078L6.32031 11.7891V9.39844C6.32031 9.21615 6.38542 9.0625 6.51562 8.9375C6.65104 8.80729 6.8125 8.74219 7 8.74219C7.18229 8.74219 7.34115 8.80729 7.47656 8.9375C7.61198 9.0625 7.67969 9.21615 7.67969 9.39844ZM2.83594 17.3203C1.9974 17.3203 1.36458 17.1042 0.9375 16.6719C0.510417 16.2396 0.296875 15.6016 0.296875 14.7578V2.96875C0.296875 2.13021 0.510417 1.49479 0.9375 1.0625C1.36458 0.625 1.9974 0.40625 2.83594 0.40625H6.60156C6.92969 0.40625 7.21615 0.429688 7.46094 0.476562C7.70573 0.518229 7.93229 0.598958 8.14062 0.71875C8.34896 0.833333 8.5625 1.0026 8.78125 1.22656L12.875 5.39062C13.1042 5.61979 13.276 5.84115 13.3906 6.05469C13.5104 6.26302 13.5911 6.49479 13.6328 6.75C13.6745 7 13.6953 7.30729 13.6953 7.67188V14.7578C13.6953 15.5964 13.4818 16.2318 13.0547 16.6641C12.6276 17.1016 11.9948 17.3203 11.1562 17.3203H2.83594ZM2.96094 15.7812H11.0312C11.4115 15.7812 11.6953 15.6849 11.8828 15.4922C12.0703 15.2995 12.1641 15.0234 12.1641 14.6641V7.88281H7.95312C7.39583 7.88281 6.97917 7.74479 6.70312 7.46875C6.43229 7.19271 6.29688 6.77604 6.29688 6.21875V1.9375H2.96875C2.58854 1.9375 2.30469 2.03646 2.11719 2.23438C1.92969 2.43229 1.83594 2.71094 1.83594 3.07031V14.6641C1.83594 15.0234 1.92969 15.2995 2.11719 15.4922C2.30469 15.6849 2.58594 15.7812 2.96094 15.7812ZM8.10156 6.53125H11.9531L7.64844 2.14844V6.07031C7.64844 6.23177 7.68229 6.34896 7.75 6.42188C7.82292 6.49479 7.9401 6.53125 8.10156 6.53125Z"})});function Ah(e){let{spaceStore:t,guests:n}=e;const{styles:o,shouldEnableExportGuests:l,handleExportGuestsClick:d}=function(e){let{spaceStore:t,guests:n}=e;const o=(0,r.yK)((e=>({button:{display:"flex",width:28,height:28,justifyContent:"center",gap:10,alignItems:"center"},buttonIcon:{width:20,height:20,fontSize:16,fontStyle:"normal",flexDirection:"column",flexShrink:0,fontWeight:510,fill:e.v2.icon.secondary}})),[]),l=(0,a.VK)((()=>{const{currentSpaceStore:e}=Ge.default.state,t=Ht.subscriptionDataStoreInstance.state;return Boolean(e&&t&&"subscribed_admin"===t.type&&Ie.default.checkGate({gateName:"enable_guest_export"}))}),[]),d=(0,i.O7)(),c=(0,f.useIntl)(),u=(0,s.useCallback)((()=>{const e=Ht.subscriptionDataStoreInstance.state;t&&e&&"subscribed_admin"===e.type&&Aa.Mj(d,{intl:c,spaceStore:t,guests:n})}),[n,d,c,t]);return{styles:o,shouldEnableExportGuests:l,handleExportGuestsClick:u}}({spaceStore:t,guests:n});return l?(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(je.Z,{render:e=>(0,c.jsx)(pn.Z,{style:o.button,onClick:d,...e,children:_h(o.buttonIcon)}),renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"exportGuestsButton.label",defaultMessage:"Export guests as CSV"})})}):null}var Bh=n(263134);function Rh(e){let{spaceStore:t,guests:n,currentTab:i,spacePermissionsSettingsStore:o}=e;(0,s.useEffect)((()=>()=>{Lg.Z.reset()}),[]);const r=(0,a.VK)((()=>Ie.default.getEligibleGroup({experimentId:"space_setting_people_search_bar_expand",defaultGroup:"control"})),[]);return(0,c.jsxs)("div",{style:{display:"flex",height:34,paddingBottom:0,justifyContent:"flex-end",alignItems:"center",gap:10},children:[(0,c.jsxs)("div",{style:{display:"flex",height:28,justifyContent:"flex-end",alignItems:"center",gap:4},children:[(0,c.jsx)(Fh,{handleSearchQueryChange:e=>{Lg.Z.setState({...Lg.Z.state,searchQuery:e}),i===Mc.Q.Groups&&o.setState({...o.state,groupsFilter:e??""})},currentTab:i,isSearchBarAlwaysOpen:"on"===r}),i===Mc.Q.Guests?(0,c.jsx)(Ah,{spaceStore:t,guests:n}):null]}),(0,c.jsx)("div",{style:{paddingBottom:2},children:(0,c.jsx)(Dh,{spaceStore:t,currentTab:i,spacePermissionsSettingsStore:o})})]})}function Dh(e){let{spaceStore:t,currentTab:n,spacePermissionsSettingsStore:o}=e;const{canUseGroups:r,canCreateGroups:l,handleCreateGroupClick:d,shouldShowRequestMemberButtion:u,canEditMembership:m}=function(e){let{spaceStore:t,currentTab:n,spacePermissionsSettingsStore:o}=e;const r=(0,yg.VJ)(),l=(0,yg.eA)({spaceStore:t}),d=(0,i.O7)(),c=(0,s.useCallback)((()=>{P.createAndCommit({userAction:"PeopleSectionGroupsTab.handleCreateGroupClick",environment:d,perform:e=>{const n=w.mo({environment:d,spaceStore:t,transaction:e});n&&o.setState({...o.state,editingNameGroupId:n.id,groupNameInputValue:""})}})}),[d,t,o]),u=(0,a.VK)((()=>!t.canEditMembership()&&!t.getDisableMembershipRequests()&&(0,we.p1)()),[t]),m=(0,yg.eA)({spaceStore:t});return{canUseGroups:r,canCreateGroups:l,shouldShowRequestMemberButtion:u,canEditMembership:m,handleCreateGroupClick:c}}({spaceStore:t,currentTab:n,spacePermissionsSettingsStore:o});return n===Mc.Q.Groups&&r?l?(0,c.jsx)(je.Z,{renderTooltip:()=>!l&&(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.groupCreationInsufficientPermissions",defaultMessage:"Only membership admins and workspace owners can add a permission group."}),render:e=>(0,c.jsx)(Bs.Z,{isLarge:!0,onClick:d,...e,children:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.createGroupButton.label",defaultMessage:"Create a group"})})}):null:u||m?(0,c.jsx)(Bh.Z,{spaceStore:t,requestFrom:"space_settings_add_members"}):null}function Oh(){const e=(0,a.VK)((()=>{const e=Ge.default.state.currentSpaceStore;if(null!=e&&e.isDefined())return e}),[]),t=(0,a.VK)((()=>yn.Z.state.online),[]),n=(0,a.VK)((()=>Ht.subscriptionDataStoreInstance.state),[]),s=(0,a.qz)(void 0,Mc.Z);return e&&n?t?(0,c.jsxs)(kt.ZP,{children:[(0,c.jsx)(Lf,{spaceStore:e,spacePermissionsSettingsStore:s}),(0,c.jsx)(Vh,{subscriptionData:n,spaceStore:e,spacePermissionsSettingsStore:s})]}):(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(Ce.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."})})}):(0,c.jsx)(Lh,{})}function Lh(){return(0,c.jsx)(zi.Z,{style:{margin:"calc(50% - 1em) auto"}})}function Vh(e){let{subscriptionData:t,spaceStore:n,spacePermissionsSettingsStore:o}=e;(0,s.useEffect)((()=>{if(rt.Z.state.open&&"members"===rt.Z.state.currentTab&&rt.Z.state.defaultSubtab){const e=rt.Z.state.defaultSubtab!==Mc.Q.Requests?rt.Z.state.defaultSubtab:Mc.Q.Members;o.setState({...o.state,currentTab:e})}}),[o]);const{visibleUsersLoaded:l,members:d,guests:u,groups:m,recentRecoverableUsers:p,currentTab:g,canReprovisionContent:y,tabs:x,currentTabs:S,environment:v}=function(e){let{subscriptionData:t,spaceStore:n,spacePermissionsSettingsStore:s}=e;const{visibleUsersLoaded:o,members:l,guests:d,numberOfGuests:u}=(0,a.VK)((()=>{const e=Gt.CM(t);return{visibleUsersLoaded:h.yW(e.map((e=>oe.U6.createChildStore(n,{table:D.KJ,id:e.userId}).isReady()))),members:e.filter(qn.nB),guests:e.filter(qn.FN),numberOfGuests:e.filter(qn.FN).filter((e=>!e.isTeamGuest&&e.isPageGuest)).length}}),[t,n]),m=(0,a.VK)((()=>n.getPermissionGroups()),[n]);(0,yg.yE)({spaceStore:n,subscriptionData:t});const p=(0,a.VK)((()=>{const{recentRecoverableUsers:e}=Lg.Z.state;return e.filter((e=>e.privatePagesCount>0))}),[]),g=(0,a.VK)((()=>s.state.currentTab),[s]),y=(0,yg.JJ)({spaceStore:n,subscriptionData:t}),x=sn({spaceStore:n,requestType:"guest"}),S=sn({spaceStore:n,requestType:"member"}),v=(0,i.O7)(),b=(0,r.yK)((e=>({activeTabStyle:{color:e.regularTextColor},inactiveTabStyle:{color:e.lightTextColor},redDot:{background:e.redBadgeBackground,marginLeft:6,marginTop:6}})),[]),M=(0,a.VK)((()=>l?{[Mc.Q.Members]:(0,c.jsx)(Uh,{text:(0,c.jsx)("div",{children:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.membersTab.title",defaultMessage:"Members"})}),number:l.length,isCurrentTab:g===Mc.Q.Members,styles:b,unread:(S??0)>0}),[Mc.Q.Guests]:(0,c.jsx)(Uh,{text:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.guestsTab.title",defaultMessage:"Guests"}),number:u,isCurrentTab:g===Mc.Q.Guests,styles:b,unread:(x??0)>0}),[Mc.Q.Groups]:(0,c.jsx)(Uh,{text:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.groupsTab.title",defaultMessage:"Groups"}),number:m.length,isCurrentTab:g===Mc.Q.Groups,styles:b}),[Mc.Q.Reprovisioning]:(0,c.jsx)(Uh,{text:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.reprovisioningTab.title",defaultMessage:"Recently left"}),number:p.length,isCurrentTab:g===Mc.Q.Reprovisioning,styles:b}),[Mc.Q.Requests]:(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.requestsTab.title",defaultMessage:"Requests"})})}:{}),[l,m,u,p,g,b,S,x]),j=Nh(y),C=j.map((e=>M[e]));return{visibleUsersLoaded:o,members:l,guests:d,groups:m,numberOfGuests:u,recentRecoverableUsers:p,currentTab:g,canReprovisionContent:y,tabs:C,currentTabs:j,environment:v}}({subscriptionData:t,spaceStore:n,spacePermissionsSettingsStore:o});return l?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Os.Z,{tabs:x,selectedIndex:S.indexOf(g),onChange:e=>function(e){let{newSelectedIndex:t,environment:n,spacePermissionsSettingsStore:s,currentTab:i,canReprovisionContent:o}=e;const a=Nh(o)[t];switch(a){case Mc.Q.Members:hg.qT(n,{tab:"members"});break;case Mc.Q.Groups:hg.qT(n,{tab:"groups"});break;case Mc.Q.Guests:hg.qT(n,{tab:"guests"});break;case Mc.Q.Reprovisioning:hg.qT(n,{tab:"reprovisioning"});break;case Mc.Q.Requests:hg.qT(n,{tab:"requests"});break;default:(0,Zn.t1)(a)}i===Mc.Q.Requests&&a!==Mc.Q.Requests&&lt.Z.reset();s.setState({...s.state,currentTab:a})}({newSelectedIndex:e,environment:v,spacePermissionsSettingsStore:o,currentTab:g,canReprovisionContent:y}),style:{paddingLeft:0,paddingRight:0,marginTop:-6},tabTitleStyle:{fontSize:16,fontWeight:400},tabBorderStyle:{left:0,right:0},right:(0,c.jsx)(Rh,{spaceStore:n,guests:u,currentTab:g,spacePermissionsSettingsStore:o})}),(0,c.jsx)(Eh,{currentTab:g,spaceStore:n,members:d,guests:u,groups:m,spacePermissionsSettingsStore:o,recentRecoverableUsers:p})]}):(0,c.jsx)(Lh,{})}function Eh(e){let{currentTab:t,spaceStore:n,members:s,guests:i,groups:o,spacePermissionsSettingsStore:a,recentRecoverableUsers:r}=e;switch(t){case Mc.Q.Members:return(0,c.jsx)(vh,{spaceStore:n,members:s,spacePermissionsSettingsStore:a,guests:i});case Mc.Q.Guests:return(0,c.jsx)(Df,{spaceStore:n,guests:i});case Mc.Q.Groups:return(0,c.jsx)(vg,{spaceStore:n,spacePermissionsSettingsStore:a,groups:o});case Mc.Q.Reprovisioning:return(0,c.jsx)(jh,{spaceStore:n,recentRecoverableUsers:r});default:return null}}function Nh(e){return[Mc.Q.Members,Mc.Q.Guests,Mc.Q.Groups,...e?[Mc.Q.Reprovisioning]:[]]}function Uh(e){let{text:t,number:n,isCurrentTab:s,unread:i,styles:o}=e;return(0,c.jsxs)("div",{style:{display:"flex",fontSize:y.Z.fontSize.UIRegular.desktop,fontWeight:y.Z.fontWeight.medium,lineHeight:"18px",...s?o.activeTabStyle:o.inactiveTabStyle},children:[t,n&&n>0?(0,c.jsx)("div",{style:{fontSize:y.Z.fontSize.UIRegular.desktop,lineHeight:"18px",paddingLeft:4,...o.inactiveTabStyle},children:n}):void 0,i&&(0,c.jsx)(tl.z,{style:o.redDot,size:6})]})}var Kh=n(176117),Wh=n(107189);function zh(e){const{up:t}=e,n={width:10,height:10,marginLeft:4};return t?(0,Wh.K)({...n,transform:"rotate(180deg)"}):(0,Wh.K)(n)}function qh(e){let{users:t,store:n,extraColumns:i,initialSort:o}=e;const[r,l]=(0,s.useState)(o),d=(0,f.useIntl)();function u(e,t){return(0,c.jsxs)(Me.Z,{disabled:!t.sortable,ignoreLocalHoverState:!0,onClick:()=>{!function(e){l({column:e,asc:(null==r?void 0:r.column)===e&&!(null!=r&&r.asc)})}(e)},style:{display:"flex",alignItems:"center"},children:[t.title,t.sortable&&r&&r.column===e&&zh({up:r.asc})]},e)}const m=(0,s.useMemo)((()=>({title:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.userTable.userColumn.header",defaultMessage:"User"}),style:{width:"60%"},sortable:!0,renderer:e=>(0,c.jsx)(Te.Z,{actorStore:e}),getValue:e=>e.getDisplayName(d)})),[d]),p=(0,s.useMemo)((()=>({name:m,...i})),[i,m]),g=h.XP(p).map((e=>({key:e,header:u(e,p[e]),style:p[e].style}))),y=(0,a.VK)((()=>{const e=t.map((e=>oe.U6.createChildStore(n,{table:D.KJ,id:e.userId}))).filter((e=>e.isDefined()));return r?e.sort(((e,t)=>{const n=p[r.column].getValue(e),s=p[r.column].getValue(t),i=n<s?-1:n>s?1:0;return r.asc?i:-1*i})):e}),[t,n,p,r]);return(0,c.jsx)(Wr.Z,{columns:g,rows:y.map((e=>{const t=Object.values(p).map(((t,n)=>t.renderer?t.renderer(e):(0,c.jsx)(s.Fragment,{children:t.getValue(e)},n)));return{key:e.id,columns:t}}))})}var Gh=function(e){return e[e.UserUserSimilarity=0]="UserUserSimilarity",e}(Gh||{});const Hh={[Gh.UserUserSimilarity]:(0,c.jsx)(f.FormattedMessage,{id:"spaceSettingsDebugZone.userUserSimilarity.title",defaultMessage:"User Similarity"})};function $h(){const e=(0,we.mS)();return["on"===Ie.default.getGroup("user_similarity_debugging")||e?Gh.UserUserSimilarity:void 0].filter(Zn.$K)}function Yh(e){let{store:t}=e;const{isOnline:n,subscriptionDataStoreData:s,userSimilarityData:i,visibleUsersLoaded:o,visibleUsers:r}=(0,a.VK)((()=>{const e=Ht.subscriptionDataStoreInstance.state,n=e?Gt.CM(e):[],s=h.yW(n.map((e=>oe.U6.createChildStore(t,{table:D.KJ,id:e.userId}).isReady())));return{isOnline:yn.Z.state.online,subscriptionDataStoreData:e,userSimilarityData:Kh.O.state||{},visibleUsersLoaded:s,visibleUsers:n}}),[t]);if(!n)return(0,c.jsx)(Ce.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."})});if(!s)return(0,c.jsx)(zi.Z,{style:{margin:"calc(50% - 1em) auto"}});if(!o)return(0,c.jsx)(zi.Z,{style:{margin:"calc(50% - 1em) auto"}});const l={style:{},title:(0,c.jsx)(c.Fragment,{children:"Similarity Score"}),sortable:!0,renderer:e=>{var t;return(0,c.jsx)(c.Fragment,{children:(null===(t=i[e.id])||void 0===t?void 0:t.toFixed(3))||0})},getValue:e=>i[e.id]||0};return(0,c.jsx)(qh,{users:r,store:t,extraColumns:{similarityColumn:l},initialSort:{column:"similarityColumn",asc:!1}})}function Qh(e){let{store:t}=e;const{tabs:n}=(0,a.VK)((()=>({tabs:$h()})),[]),[i,o]=(0,s.useState)(n[0]);return(0,c.jsxs)(kt.ZP,{children:[(0,c.jsx)(Os.Z,{tabs:n.map((e=>Hh[e])),selectedIndex:n.indexOf(i),onChange:e=>o(n[e]),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),i===Gh.UserUserSimilarity&&(0,c.jsx)(Yh,{store:t})]})}var Jh=n(942982);const Xh="teamColumn",ey="ownersColumn",ty="membersColumn",ny="AccessLevelColumn",sy="lastUpdatedColumn",iy="contextMenuColumn",oy=[Xh,ty,ny,sy],ay="filterAccessAny",ry="filterAccessOnlyOpen",ly="filterAccessOnlyClosed",dy="filterAccessOnlyPrivate",cy="filterOwnerAny",uy="filterOwnerShowOrphaned",my="filterOwnerById";class py extends N.default{getInitialState(){return{searchQuery:"",sortColumn:sy,sortAscending:!1,showOnlyArchivedTeams:!1,filterByOwner:{type:cy},filterAccess:ay,showTeamsWithSecurityOverrides:!1}}}const gy=new py;function fy(e){let{environment:t,teamIds:n}=e;const{currentSpaceStore:s,currentUserStore:i}=Ge.default.state;return s&&i?n.map((e=>{const n=oe.zX.createChildStore(s,{table:vf.e0,id:e,spaceId:s.id});if(n.canRead())return n;const i=s&&el.Dv({environment:t,teamId:n.id,spaceStore:s,from:"manage_teams_table"});return null!=i&&i.canRead()?i:void 0})).filter(Zn.$K):[]}var hy=n(880068),yy=n(364684);class xy extends N.default{getInitialState(){return{tokenQuery:"",showAutoCompletePopup:!1,defaultTeams:{}}}addedAndCurrentTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"current-default"===t||"add-default"===t}))}addedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"add-default"===t}))}removedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"remove-default"===t}))}}const Sy=new xy;function vy(e){var t;let{teamStore:n}=e;return null===(t=Sy.state.defaultTeams[n.id])||void 0===t?void 0:t.state}function by(e){let{teamStore:t,persistedDefaultTeams:n}=e;if(n.includes(t))My({store:t,state:"current-default"});else{const e={...Sy.state.defaultTeams};delete e[t.id],Sy.setState({...Sy.state,defaultTeams:e})}}function My(e){const t=Sy.state;Sy.setState({...t,defaultTeams:{...t.defaultTeams,[e.store.id]:e}})}var jy=n(30676),Cy=n(147082),wy=n(475024);function ky(e){let{}=e;const t=(0,i.Fy)(),n=(0,f.useIntl)(),o=(0,i.O7)(),{allTeams:l,loaded:d}=(0,a.VK)((()=>{const e=An.state;return"loaded"!==e.loadingState?{allTeams:[],loaded:!1}:{allTeams:fy({environment:o,teamIds:e.unarchivedTeamIds}),loaded:!0}}),[o]),[u,m]=(0,s.useState)(!1),p=(0,a.qz)(Sy),g=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),{defaultTeams:y,tokenQuery:x}=(0,a.VK)((()=>{const{defaultTeams:e,tokenQuery:t}=p.state;return{defaultTeams:e,tokenQuery:t}}),[p]),S=!x,{addedTeams:v,removedTeams:b,addedAndCurrentTeams:M}=(0,a.VK)((()=>({addedAndCurrentTeams:p.addedAndCurrentTeams(),addedTeams:p.addedTeams(),removedTeams:p.removedTeams()})),[p]),j=(0,a.VK)((()=>l.reduce(((e,t)=>(e[t.id]=t.getName(),e)),{})),[l]),C=(0,a.VK)((()=>l.filter((e=>e.isDefault()))),[l]);(0,s.useEffect)((()=>function(e){let{persistedDefaultTeams:t}=e;const n=t.reduce(((e,t)=>(e[t.id]={state:"current-default",store:t},e)),{}),s=Sy.state;Sy.setState({...s,defaultTeams:n})}({persistedDefaultTeams:C})),[C]);const w=v.length>0||b.length>0,k=e=>function(e){let{teamStore:t,persistedDefaultTeams:n}=e;"add-default"===vy({teamStore:t})?by({teamStore:t,persistedDefaultTeams:n}):My({store:t,state:"remove-default"})}({teamStore:e,persistedDefaultTeams:C}),I=e=>{!function(e){let{teamStore:t,persistedDefaultTeams:n}=e;"remove-default"===vy({teamStore:t})?by({teamStore:t,persistedDefaultTeams:n}):My({store:t,state:"add-default"})}({teamStore:e,persistedDefaultTeams:C}),p.update((e=>({...e,showAutoCompletePopup:!1,tokenQuery:""})))},T=new Set(b.map((e=>e.store.id))),Z=o.currentUser.id,P=(0,a.VK)((()=>Z?l.filter((e=>{const t=e.getSettingsStore().getValue();return!!t&&(e.isOwner(Z)&&"open"===(0,yy.B5)(t))})):[]),[l,Z]),F=function(e){let{query:t,addedAndCurrentTeams:n,eligibleDefaultTeams:s,teamIdsToNames:i}=e;const o=new Set;for(const a of n)o.add(a.store.id);return(0,Bd.ZP)(t,s,(e=>i[e.id]??""))}({query:x,addedAndCurrentTeams:M,teamIdsToNames:j,eligibleDefaultTeams:P}),_=[];F.length>0&&!S&&_.push({key:"default-teams-list",render:e=>(0,c.jsx)(ys.Z,{...e,title:(0,c.jsx)(f.FormattedMessage,{id:"defaultTeamsInput.defaultTeamList.title",defaultMessage:"Teamspaces"}),loading:!1}),items:F.map((e=>({key:e.id,render:t=>(0,c.jsx)(jy.F,{...t,teamStore:e}),action:()=>I(e)})))});const A=(0,a.VK)((()=>p.state.showAutoCompletePopup&&_.length>0),[p,_.length]),B=(0,r.yK)((e=>({defaultTeamsHeader:{fontSize:14,marginBottom:2},inputAndButtonContainer:{paddingTop:12,display:"flex"},inputContainer:{flexGrow:1},tokenInputMenu:{borderRadius:A?Zy:Ty,margin:0},menuList:{maxHeight:300,border:`1px solid ${e.regularDividerColor}`,borderTop:0,borderRadius:Py},updateButton:{marginLeft:10,height:35}})),[A]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:B.defaultTeamsHeader,children:(0,c.jsx)(f.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.title",defaultMessage:"Default teamspaces"})}),(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,children:(0,c.jsx)(f.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.caption",defaultMessage:"Choose teamspaces that all new and current workspace members will automatically join"})}),(0,c.jsxs)("div",{style:B.inputAndButtonContainer,children:[(0,c.jsx)("div",{style:B.inputContainer,children:(0,c.jsx)(ws.ZP,{popupType:os.k.Popup,placementToOrigin:ws.ZP.Placement.Bottom,sameWidthAsOrigin:!0,open:A,borderRadius:Py,onDismiss:()=>p.update((e=>({...e,showAutoCompletePopup:!1}))),origin:(0,c.jsx)(Cy.ZP,{disabled:!d||u,style:B.tokenInputMenu,focusInitial:t.isMobile,focusAfterAnimation:!0,format:Cy.UR.Share,inputDivStyle:{alignItems:"center"},value:x,onChange:e=>p.update((t=>({...t,tokenQuery:e.target.value,showAutoCompletePopup:!0}))),type:"default-teams",tokens:Object.values(y).filter((e=>!T.has(e.store.id))).map((e=>(0,c.jsx)(Iy,{teamStore:e.store,onClickRemove:k},e.store.id))),placeholder:n.formatMessage({id:"teamsWorkspaceSettings.defaultTeams.inputPlaceholder",defaultMessage:"Select a default teamspace..."}),onRemoveLastToken:()=>{const e=M,t=h.Z$(e);t&&k(t.store)},onEmptySubmit:h.yR,showBorder:!0}),render:()=>(0,c.jsx)(ps.Z,{menuType:cs.og.Popup,tokenInputHeader:!0,disableHeaderBorder:!0,children:(0,c.jsx)("div",{style:B.menuList,children:(0,c.jsx)(fs.Z,{type:fs.i.Vertical,initialFocus:0,sections:_})})})})}),(0,c.jsx)(Bs.Z,{style:B.updateButton,disabled:!w||u,isLarge:!0,onClick:async()=>{if(g){m(!0);try{await async function(e){let{addedTeams:t,removedTeams:n,environment:s,spaceStore:i}=e;return!!i.isDefined()&&await el.lH({addedStores:t.map((e=>{let{store:t}=e;return t})),removedStores:n.map((e=>{let{store:t}=e;return t})),environment:s,spaceStore:i,createNewTeamFlowId:void 0,from:"workspace_settings"})}({environment:o,addedTeams:v,removedTeams:b,spaceStore:g})}finally{m(!1)}}},children:(0,c.jsx)(f.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})})]})]})}function Iy(e){const t=(0,i.Fy)(),{teamStore:n,onClickRemove:s}=e,{name:o}=(0,a.VK)((()=>({name:n.getName()})),[n]);return(0,c.jsx)(zl.Z,{showRemoveButton:!0,isSingle:!1,format:t.isMobile?wr.lo.Large:wr.lo.Medium,style:{marginLeft:6},onClickRemove:()=>s(n),value:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)(Ur.p,{disabled:!0,store:n,size:14,style:{marginRight:4}}),o]})})}const Ty=3,Zy=(0,wy.wK)({topLeft:Ty,topRight:Ty,bottomLeft:0,bottomRight:0}),Py=(0,wy.wK)({topLeft:0,topRight:0,bottomLeft:Ty,bottomRight:Ty});var Fy=n(343121),_y=n(117224),Ay=n(45257),By=n(814871);function Ry(e){let{selectItems:t,currentSelectedItem:n,onChange:s,icon:i}=e;return(0,c.jsx)(By.Z,{items:t,getKey:e=>e.key,selectedItem:n,onSelect:s,renderItem:e=>(0,c.jsx)(ms.Z,{title:e.value.name,...e,checkState:n.key===e.value.key}),renderOrigin:e=>(0,c.jsx)(Ay.Z,{...e,title:n.originName??n.name,on:!n.showFilterAsOffWhenSelected,icon:i})})}const Dy={[ay]:{key:ay,name:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterAllTeams",defaultMessage:"Any"}),originName:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsAccessFilter.accessSelectPlaceolder",defaultMessage:"Access"}),showFilterAsOffWhenSelected:!0},[ry]:{key:ry,name:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterOpenTeams",defaultMessage:"Open"})},[ly]:{key:ly,name:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterClosedTeams",defaultMessage:"Closed"})},[dy]:{key:dy,name:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterPrivateTeams",defaultMessage:"Private"})}},Oy=h.oA([Dy[ay],Dy[ry],Dy[ly],Dy[dy]]);function Ly(e){let{manageTeamsStore:t}=e;const n=(0,i.O7)(),o=(0,a.VK)((()=>t.state.filterAccess),[t]),l=(0,r.yK)((e=>({keyIcon:{width:18,height:18,...o!==ay?{fill:is.ZP.blue}:{fill:e.mediumIconColor}}})),[o]),d=(0,s.useCallback)((e=>{t.update((t=>({...t,filterAccess:e.key}))),_y.GZ(n,{filter:"access",value:e.key})}),[t,n]),u=Dy[o];return(0,c.jsx)(Ry,{selectItems:Oy,currentSelectedItem:u,onChange:d,icon:(0,Fy.f)(l.keyIcon)})}const Vy=(0,d.IU)("archiveFilled",{viewBox:"0 0 16 16",svg:(0,c.jsx)("path",{d:"M2.16211 5.06934H13.5029C14.2754 5.06934 14.665 4.61133 14.665 3.8457V3.22363C14.665 2.45801 14.2754 2 13.5029 2H2.16211C1.43066 2 1 2.45801 1 3.22363V3.8457C1 4.61133 1.38965 5.06934 2.16211 5.06934ZM4.08301 14.585H11.582C12.9287 14.585 13.6465 13.8877 13.6465 12.5479V6.00586H2.01855V12.5479C2.01855 13.8945 2.73633 14.585 4.08301 14.585ZM5.58008 8.47363C5.29297 8.47363 5.09473 8.27539 5.09473 7.97461V7.7627C5.09473 7.46191 5.29297 7.27051 5.58008 7.27051H10.0918C10.3789 7.27051 10.584 7.46191 10.584 7.7627V7.97461C10.584 8.27539 10.3789 8.47363 10.0918 8.47363H5.58008Z"})}),Ey="showArchived",Ny="hideArchived",Uy={[Ny]:{key:Ny,name:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.hideArchivedTeams",defaultMessage:"Active"}),originName:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedSelectPlaceolder",defaultMessage:"Archived"}),showFilterAsOffWhenSelected:!0},[Ey]:{key:Ey,name:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.showArchivedTeams",defaultMessage:"Archived"})}};function Ky(e){let{manageTeamsStore:t}=e;const n=(0,i.O7)(),o=(0,a.VK)((()=>t.state.showOnlyArchivedTeams),[t]),l=(0,r.yK)((e=>({archiveIcon:{width:16,height:16,marginRight:5,...o?{fill:is.ZP.blue}:{fill:e.mediumIconColor}}})),[o]),d=[Uy[Ny],Uy[Ey]],u=(0,s.useCallback)((e=>{t.update((t=>({...t,showOnlyArchivedTeams:e.key===Ey}))),_y.GZ(n,{filter:"archived",value:e.key})}),[t,n]),m=Uy[o?Ey:Ny];return(0,c.jsx)(Ry,{selectItems:d,currentSelectedItem:m,onChange:u,icon:Vy(l.archiveIcon)})}var Wy=n(277907);const zy="ShowTeamsWithNoOwnersId";function qy(e){let{teamStores:t,manageTeamsStore:n}=e;const o=(0,i.O7)(),l=(0,a.VK)((()=>n.state.filterByOwner),[n]),d=function(e){switch(e.type){case cy:return;case my:return e.id;case uy:return zy;default:(0,Zn.t1)(e)}}(l),u=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),m=(0,f.useIntl)(),p=(0,a.VK)((()=>{const e=t.flatMap((e=>e.getOwnerUserIds()));return h.jj(e)}),[t]),g=(0,r.yK)((e=>({icon:{marginRight:2,fill:e.mediumIconColor},blueFill:{fill:is.ZP.blue}})),[]),y=(0,s.useCallback)((e=>{if(u)return ta({userId:e,currentSpaceStore:u}).getValue()}),[u]),x=(0,s.useCallback)((e=>{const t=e[e.length-1];let s;s=t===d||void 0===t?{type:cy}:t===zy?{type:uy}:{type:my,id:t},n.update((e=>({...e,filterByOwner:s}))),_y.GZ(o,{filter:"owner",value:s.type})}),[d,n,o]),S=(0,Wy.XJ)(O.FF.searchActions),v=(0,s.useCallback)((async e=>{let{query:t}=e;if(!u||"resolved"!==S.status)return[];const n=S.value,s=(await n.searchUsers({query:t,parentStore:u,userIds:p})).map((e=>e.id));return""===t?[zy,...s]:s}),[u,p,S.status,S.value]),b=(0,s.useCallback)(((e,t)=>{if(!u)return null;if(e===zy)return(0,c.jsx)(ms.Z,{...t,title:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsOwnerFilter.noOwnersFilterOption",defaultMessage:"No owners"}),checkState:l.type===uy,className:"notranslate"});const n=y(e);return n?(0,s.createElement)(ie.Z,{...t,key:e,actor:(0,te.m3)(n),checkState:d===e}):null}),[u,y,d,l.type]),M=(0,a.VK)((()=>{if(l.type!==my)return;const e=y(l.id);return e?(0,ea.Nz)(m,e):void 0}),[l,y,m]);let j;return j=l.type===uy?(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.onlyOrphanedTeams",defaultMessage:"Owner: None"}):M?(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.withSpecifiedOwner",defaultMessage:"Owner: {teamOwnerName}",values:{teamOwnerName:M}}):(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.unset",defaultMessage:"Owner"}),(0,c.jsx)(J.Z,{mode:J.z.Pill,title:j,disabled:0===t.length,icon:ne.f,iconStyles:{...g.icon,...l.type!==cy&&g.blueFill},items:h.oA([d]),hasItemsSelected:(0,Zn.$K)(d),onChange:x,labelText:{title:j,tokenInputPlaceholder:m.formatMessage({defaultMessage:"Search teamspace owner...",id:"manageTeamsOwnerFilter.searchOwner.placeholder"}),resultSectionTitle:m.formatMessage({defaultMessage:"Select users",id:"manageTeamsOwnerFilter.searchOwner.resultsTitle"}),componentDebugName:"ManageTeamsSearchOwnerFilter"},performRequest:v,renderResultMenuItem:b,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}const Gy="showAll",Hy="showTeamsWithSecurityOverrides",$y={[Gy]:{key:Gy,name:(0,c.jsx)(f.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showAllOption",defaultMessage:"Show all"}),originName:(0,c.jsx)(f.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showAllPlaceholder",defaultMessage:"Security"}),showFilterAsOffWhenSelected:!0},[Hy]:{key:Hy,name:(0,c.jsx)(f.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showTeamsWithSecurityOverrides",defaultMessage:"Has overrides"})}};function Yy(e){let{manageTeamsStore:t}=e;const n=(0,i.O7)(),o=(0,a.VK)((()=>t.state.showTeamsWithSecurityOverrides),[t]),l=(0,r.yK)((e=>({securityIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor},blueFill:{fill:is.ZP.blue}})),[]),d=[$y[Gy],$y[Hy]],u=(0,s.useCallback)((e=>{t.setState({...t.state,showTeamsWithSecurityOverrides:e.key===Hy}),_y.GZ(n,{filter:"securityOverrides",value:e.key})}),[t,n]),m=$y[o?Hy:Gy];return(0,c.jsx)(Ry,{selectItems:d,currentSelectedItem:m,onChange:u,icon:(0,Wn.X)({...l.securityIcon,...o&&l.blueFill})})}function Qy(e){let{manageTeamsStore:t,teamStores:n}=e;const i=(0,r.yK)((()=>({container:{display:"flex",alignItems:"center",marginTop:20},searchContainer:{maxWidth:250,marginRight:"auto"},archivedTeamsSwitch:{display:"flex",alignItems:"center",marginLeft:15,marginRight:15},archivedTeamsLabel:{marginLeft:10},dropdownContainer:{display:"flex",alignContent:"stretch",marginLeft:5}})),[]),o=(0,a.VK)((()=>t.state.searchQuery),[t]),l=(0,s.useCallback)((e=>{t.update((t=>({...t,searchQuery:e})))}),[t]);return(0,c.jsxs)("div",{style:i.container,children:[(0,c.jsx)(Jy,{style:i.searchContainer,onChange:l,value:o}),(0,c.jsxs)("div",{style:i.dropdownContainer,children:[(0,c.jsx)(Ky,{manageTeamsStore:t}),(0,c.jsx)(qy,{teamStores:n,manageTeamsStore:t}),(0,c.jsx)(Ly,{manageTeamsStore:t}),(0,c.jsx)(Yy,{manageTeamsStore:t})]})]})}function Jy(e){let{style:t,value:n,onChange:i}=e;const o=(0,f.useIntl)(),a=(0,r.yK)((e=>({input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),l=(0,s.useCallback)((e=>i(e.target.value)),[i]);return(0,c.jsx)(Cs.Z,{placeholder:o.formatMessage({defaultMessage:"Search teamspaces...",id:"manageTeamsFilterRow.searchFilter.placeholder"}),style:{...a.input,...t},value:n,onChange:l,left:(0,Eu.R)(a.searchIcon),format:Cs.B.Small,showClearButton:!0})}var Xy=n(564552),ex=n(139538),tx=n(98742),nx=n(411628);var sx=n(98596),ix=n(30765);function ox(e){let{teamStore:t,accessLevel:n,isTeamOwner:s,onChangeAccessLevel:o,width:l}=e;const d=(0,i.O7)(),u=function(e){return(0,a.VK)((()=>e.isDefault()),[e])}(t),m=(0,sx.U)({teamStore:t,onChange:o,isDefault:u}),p=u?"default":n,g=m.find((e=>e.key===p)),h=!s||Boolean(null==g?void 0:g.disableAllOptionsTooltip),x=(null==g?void 0:g.disableAllOptionsTooltip)||h&&!s&&(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsAccessCell.onlyTeamOwnersCanChangeAccessLevel",defaultMessage:"Only teamspace owners can change teamspace access levels"}),S=(0,nx.P)(),v=(0,r.yK)((e=>{const t=e.lightTextColor;return{selectButton:{paddingLeft:8,marginLeft:-8,maxWidth:l},label:{...h&&{color:t},fontSize:y.Z.fontSize.UIRegular.desktop,fontWeight:y.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.mediumIconColor,...h&&{fill:t}},tooltip:{width:200}}}),[h,l]);if(!g)throw new Error(`Selected access level is not an option found in team access level option: ${p}`);return(0,c.jsx)(By.Z,{items:m,getKey:e=>e.key,selectedItem:g,onSelect:e=>"private"!==e.key||S?e.onSelect():xt.y(d,{from:"team_security_settings",for:"business"}),renderItem:e=>(0,c.jsx)(je.Z,{textWrap:!0,style:v.tooltip,placement:ke.u.Bottom,disableTooltip:!e.value.tooltip,renderTooltip:()=>e.value.tooltip,render:t=>(0,c.jsx)(ms.Z,{title:e.value.title,...(0,tx.Z)(e,t)})}),disabled:h,renderOrigin:e=>(0,c.jsx)(je.Z,{textWrap:!0,style:v.tooltip,disableTooltip:!x,renderTooltip:()=>x,alignment:ke.v.Center,placement:ke.u.Left,render:t=>(0,c.jsxs)(pn.Z,{style:v.selectButton,disabled:h,...(0,tx.Z)(e,t),children:[(0,c.jsx)(ix.s,{style:v.label,children:g.level}),(0,Jr.i)(v.chevron)]})})})}function ax(e){let{teamOwners:t,manageTeamsStore:n}=e;const s=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),i=(0,f.useIntl)(),o=(0,a.VK)((()=>{if(!s)return;const{filterByOwner:e}=n.state;let i=t[0];if(e.type===my){const n=e.id;t.includes(n)&&(i=n)}return i?ta({userId:i,currentSpaceStore:s}):void 0}),[s,n,t]),l=(0,a.VK)((()=>{if(null!=o&&o.isDefined())return(0,ea.Nz)(i,o.getModel())}),[o,i]),d=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",fontSize:y.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},nMoreOwnersText:{paddingLeft:3,color:e.mediumTextColor},noOwners:{marginRight:8,color:e.lightTextColor},userName:{flexShrink:1}})),[]);return t.length<1?(0,c.jsx)("div",{style:d.noOwners,children:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsOwnersCell.noOwners",defaultMessage:"No owners"})}):(0,c.jsxs)("div",{style:d.container,children:[(0,c.jsx)($s.Z,{style:d.userAvatar,avatarShouldShowShadow:!0,userStore:o,size:20}),(0,c.jsx)(ix.s,{style:d.userName,children:l}),t.length>1&&(0,c.jsx)("div",{style:d.nMoreOwnersText,children:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsOwnersCell.nMoreOwnersLabel",defaultMessage:"+{numAdditionalOwners}",values:{numAdditionalOwners:t.length-1}})})]})}const rx=[Xh,ey,ny,sy,iy],lx={[ny]:{headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsTable.columnTitle.access",defaultMessage:"Access"}),renderCell:e=>{let{data:t,environment:n}=e;return(0,c.jsx)(ox,{teamStore:t.store,accessLevel:t.accessLevel,isTeamOwner:t.isCurrentUserOwnerOfTeam,onChangeAccessLevel:(e,s)=>el.Ju({environment:n,store:t.store,accessLevel:e,isDefault:s,teamName:t.name,from:"manage_teams_table"}),width:90})},colWidth:{width:90},hasClickableContents:!0},[Xh]:{headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamspacesTable.columnTitle.teamspace",defaultMessage:"Teamspace"}),renderCell:e=>{let{data:t}=e;return(0,c.jsx)(dx,{teamStore:t.store,isArchivedTeam:t.isArchivedTeam,name:t.name})},colWidth:{minWidth:30,widthPercent:35}},[ey]:{headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsTable.columnTitle.owners",defaultMessage:"Owners"}),renderCell:e=>{let{data:t,manageTeamsStore:n}=e;return(0,c.jsx)(ax,{teamOwners:t.owners,manageTeamsStore:n})},colWidth:{minWidth:60,widthPercent:25}},[ty]:{headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsTable.columnTitle.members",defaultMessage:"Members"}),renderCell:e=>{let{data:t}=e;return(0,c.jsx)(ix.s,{children:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsTable.numMembersCell",defaultMessage:"{numTeamMembers, plural, one {# member} other {# members}}",values:{numTeamMembers:t.members.length}})})},colWidth:{minWidth:40,widthPercent:15}},[sy]:{headerTitle:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsTable.columnTitle.updated",defaultMessage:"Updated"}),renderCell:e=>{let{data:t}=e;return t.lastUpdated&&(0,c.jsx)(cx,{lastUpdatedMillis:t.lastUpdated})},colWidth:{minWidth:50,widthPercent:15}},[iy]:{headerTitle:void 0,renderCell:e=>{let{data:t}=e;return(0,c.jsx)(ex.OutlinerTeamOverflow,{teamStore:t.store,from:"manage_teams_table"})},colWidth:{width:30},hasClickableContents:!0}};function dx(e){let{teamStore:t,name:n,isArchivedTeam:s}=e;const o=(0,i.O7)(),l=(0,f.useIntl)(),d=(0,Xy.e)(t),u=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",overflow:"hidden"},teamIcon:{marginRight:12},nameAndMembersContainer:{display:"flex",flexDirection:"column",minWidth:0},nameAndArchivedPillContainer:{display:"flex"},nameText:{lineHeight:"18px",fontWeight:y.Z.fontWeight.regular},smallText:{fontSize:(0,wy.yv)(o,"UISmall"),color:e.mediumTextColor,fontWeight:y.Z.fontWeight.regular},archivedTag:{marginLeft:5}})),[o]),m=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),p=(0,a.VK)((()=>{if(!m)return;const e=(t.getUserIdsInTeamUsingSpaceMembers((0,Gt.Io)())??[]).length;return(0,ad.uf)(e,"compact",l)}),[m,l,t]),g=(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsTableColumnData.numMembersLabel",defaultMessage:"{numMembers, plural, one {1 member} other {{numMembers} members}}",values:{numMembers:p}}),x=d?(0,c.jsxs)(c.Fragment,{children:[" • ",(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsTableColumnData.joinedLabel",defaultMessage:"Joined"})]}):void 0,S=h.oA([g,x]);return(0,c.jsxs)("div",{style:u.container,children:[(0,c.jsx)(Ur.p,{style:u.teamIcon,size:28,store:t,disabled:!0}),(0,c.jsxs)("div",{style:u.nameAndMembersContainer,children:[(0,c.jsxs)("div",{style:u.nameAndArchivedPillContainer,children:[(0,c.jsx)(ix.s,{style:u.nameText,children:n}),s&&(0,c.jsx)(se.Z,{desktopStyle:u.archivedTag,mobileStyle:u.archivedTag,children:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsTable.archivedTag",defaultMessage:"Archived"})})]}),(0,c.jsx)(ix.s,{style:u.smallText,children:S})]})]})}function cx(e){let{lastUpdatedMillis:t}=e;return(0,c.jsx)(ix.s,{children:(0,Eo.Yx)(t,"very_short",Po.SP)})}function ux(e){let{teamStores:t,manageTeamsStore:n}=e;const o=(0,i.O7)(),l=(0,a.VK)((()=>Ge.default.state.currentUserStore),[]),{sortAscending:d,sortColumn:u}=(0,a.VK)((()=>{const{sortAscending:e,sortColumn:t}=n.state;return{sortAscending:e,sortColumn:t}}),[n]),m=(0,a.VK)((()=>{const e=null==l?void 0:l.id;return e?h.oA(t.map((t=>{if(!t.canRead()||!t.isReady())return;const n=t.getOwnerUserIds();return{store:t,name:t.getName()??"",owners:n,isCurrentUserOwnerOfTeam:n.includes(e),members:t.getUserIdsInTeamUsingSpaceMembers((0,Gt.Io)())??[],hasSecurityOverrides:t.hasSecurityOverrides(),accessLevel:t.getTeamAccessLevel(),isArchivedTeam:(0,yy.m4)({archived_by:t.getArchivedBy()}),lastUpdated:t.getLastEditedTime()}}))):[]}),[null==l?void 0:l.id,t]),p=(0,a.VK)((()=>{const{showOnlyArchivedTeams:e,filterByOwner:t,showTeamsWithSecurityOverrides:s,filterAccess:i}=n.state;return m.filter((t=>e?t.isArchivedTeam:!t.isArchivedTeam)).filter((e=>!s||e.hasSecurityOverrides)).filter((e=>{if(i===ry&&"open"!==e.accessLevel)return!1;if(i===ly&&"closed"!==e.accessLevel)return!1;if(i===dy&&"private"!==e.accessLevel)return!1;switch(t.type){case uy:return 0===e.owners.length;case my:return e.owners.includes(t.id);case cy:return!0;default:(0,Zn.t1)(t)}}))}),[n,m]),g=(0,a.VK)((()=>{const{sortAscending:e,sortColumn:t}=n.state;return function(e){let{data:t,sortColumn:n,sortAscending:s}=e;const i=[s?"asc":"desc"],o=[s?"desc":"asc"];switch(n){case Xh:return h.Xo(t,(e=>e.name),o);case ty:return h.Xo(t,(e=>e.members.length),i);case ny:return h.Xo(t,(e=>vf.bx.indexOf(e.accessLevel)),i);case sy:return h.Xo(t,(e=>e.lastUpdated),i);default:(0,Zn.t1)(n)}}({data:p,sortAscending:e,sortColumn:t})}),[n,p]),f=(0,a.VK)((()=>(0,Bd.ZP)(n.state.searchQuery,g,(e=>e.name))),[n,g]),y=(0,s.useCallback)((e=>el.RF({environment:o,teamId:e,tab:bf.a.Members,from:"manage_teams_table"})),[o]),x=(0,r.yK)((e=>({container:{marginTop:17,tableLayout:"fixed",borderCollapse:"collapse",width:"100%",minWidth:rx.reduce(((e,t)=>e+Sx(lx[t].colWidth)+yx),0)},tableHeaderRow:{borderTop:`1px solid ${e.tableDividerColor}`,borderBottom:`1px solid ${e.tableDividerColor}`},noTeamsLabel:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]),S=(0,s.useCallback)((e=>{const{sortColumn:t,sortAscending:s}=n.state,i=e===t&&!s;n.setState({...n.state,sortAscending:i,sortColumn:e}),_y.dw(o,{sortBy:e,sortOrder:s?"ascending":"descending"})}),[n,o]),v=(0,s.useCallback)((()=>{n.reset()}),[n]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("table",{style:x.container,children:[(0,c.jsx)("tr",{style:x.tableHeaderRow,children:rx.map((e=>(0,c.jsx)(px,{column:e,onSortableColumnClick:S,sortAscending:d,sortColumn:u},`header_${e}`)))}),(0,c.jsx)("tr",{children:rx.map((e=>(0,c.jsx)("td",{},`padding_row_${e}`)))}),f.map((e=>(0,c.jsx)(mx,{onShowTeamSettings:y,teamData:e,manageTeamsStore:n},`${e.store.id}_row`)))]}),(0,c.jsx)(fx,{style:x.noTeamsLabel,numItemsAfterFilter:f.length,numItemsBeforeFilter:t.length,onResetFilters:v})]})}function mx(e){let{teamData:t,manageTeamsStore:n,onShowTeamSettings:i}=e;const[o,a]=(0,s.useState)(!1),l=(0,s.useCallback)((()=>a(!0)),[]),d=(0,s.useCallback)((()=>a(!1)),[]),u=(0,s.useCallback)((e=>{hx(e,(()=>i(t.store.id)))}),[i,t.store.id]),m=(0,r.yK)((e=>({teamRow:{cursor:"pointer",borderBottom:`1px solid ${e.tableDividerColor}`}})),[]);return(0,c.jsx)("tr",{onMouseLeave:d,onMouseEnter:l,style:m.teamRow,onClick:u,children:rx.map((e=>(0,c.jsx)(gx,{isRowHovered:o,teamData:t,columnData:lx[e],manageTeamsStore:n},`${t.store.id}_${e}`)))})}function px(e){let{column:t,onSortableColumnClick:n,sortColumn:s,sortAscending:i}=e;const o=lx[t],a=(0,r.yK)((e=>({th:vx(o),innerDiv:{display:"flex",alignItems:"center",minWidth:Sx(o.colWidth),height:32},text:{fontSize:y.Z.fontSize.UISmall.desktop,fontWeight:y.Z.fontWeight.regular,color:e.mediumTextColor},sortButton:{padding:5,margin:-5,overflow:"hidden",maxWidth:"100%"},sortIcon:{fill:e.mediumTextColor,width:12,height:12,marginLeft:4}})),[o]),l=(0,c.jsx)(ix.s,{style:a.text,children:o.headerTitle}),d=(u=t,oy.includes(u)?(0,c.jsxs)(pn.Z,{style:a.sortButton,onClick:()=>n(t),children:[l,(()=>{if(t===s)return(0,Wh.K)({...a.sortIcon,...i&&{transform:"rotate(180deg)"}})})()]}):l);var u;return(0,c.jsx)("th",{style:a.th,children:(0,c.jsx)("div",{style:a.innerDiv,children:d})})}function gx(e){let{teamData:t,columnData:n,isRowHovered:s,manageTeamsStore:o}=e;const a=(0,i.O7)(),l=(0,r.yK)((e=>({td:{...vx(n),...s&&{background:e.buttonHoveredBackground}},innerDiv:{minWidth:Sx(n.colWidth),fontSize:y.Z.fontSize.UIRegular.desktop,color:e.regularTextColor,height:56,display:"flex",alignItems:"center"}})),[n,s]),d=hx,u=Boolean(n.hasClickableContents);return(0,c.jsx)("td",{style:l.td,children:(0,c.jsx)("div",{style:l.innerDiv,onClick:u?d:void 0,children:n.renderCell({environment:a,data:t,manageTeamsStore:o})})})}function fx(e){let{style:t,numItemsBeforeFilter:n,numItemsAfterFilter:s,onResetFilters:i}=e;if(0!==s)return null;let o;return o=0!==n?(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.teamsFilteredOut",defaultMessage:"Could not find any teamspaces. <linkbutton>Reset your filters</linkbutton>",values:{linkbutton:e=>(0,c.jsx)(Rs.Z,{onClick:i,children:e})}}):(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.noTeamsExist",defaultMessage:"Could not find any teamspaces."}),(0,c.jsx)(Ce.Z,{isSmall:!0,style:t,children:o})}function hx(e,t){(0,Zh.ZP)({event:e,context:Zh.Af.ManageTeamsRowClick,callback:t})}const yx=10,xx={paddingLeft:yx/2,paddingRight:yx/2};function Sx(e){return"minWidth"in e?e.minWidth:e.width}function vx(e){let t={};return t="width"in e.colWidth?{width:e.colWidth.width}:{width:`${e.colWidth.widthPercent}%`,minWidth:e.colWidth.minWidth},{...xx,...t}}function bx(e){let{}=e;const{isMobile:t=!1}=(0,i.Fy)(),n=(0,i.O7)(),o=(0,a.qz)(gy),l=(0,r.yK)((()=>({container:{marginTop:8},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},subheader:{display:"flex",flexDirection:"column"}})),[]),{unarchivedTeamIds:d,archivedTeamIds:u,isLoading:m}=(0,a.VK)((()=>{const e=An.state;return"loaded"!==e.loadingState?{unarchivedTeamIds:[],archivedTeamIds:[],isLoading:!0}:{unarchivedTeamIds:e.unarchivedTeamIds,archivedTeamIds:e.archivedTeamIds,isLoading:!1}}),[]),p=(0,a.VK)((()=>m?[]:fy({environment:n,teamIds:[...d,...u]})),[u,n,m,d]),g=(0,s.useCallback)((()=>el.lo("workspace_settings")),[]);return(0,c.jsxs)("div",{style:l.container,children:[(0,c.jsxs)(fe.Z,{large:!t,style:l.header,small:!0,children:[(0,c.jsxs)("div",{style:l.subheader,children:[(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsBrowser.title",defaultMessage:"Manage teamspaces"}),(0,c.jsx)(Ce.Z,{isSmall:!0,style:{marginTop:3},children:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsBrowser.subtitle",defaultMessage:"Manage all teamspaces you have access here"})})]}),(0,c.jsx)(Bs.Z,{onClick:g,isLarge:!0,className:Ke.myM,children:(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsBrowser.newTeamButton.text",defaultMessage:"New teamspace"})})]}),m?(0,c.jsx)(zi.Z,{}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Qy,{teamStores:p,manageTeamsStore:o}),(0,c.jsx)(ux,{teamStores:p,manageTeamsStore:o})]})]})}var Mx=n(144615),jx=n(702688);function Cx(){const e=(0,i.O7)(),{currentSpaceStore:t,currentUserStore:n}=(0,a.VK)((()=>{const{currentSpaceStore:e,currentUserStore:t}=Ge.default.state;return{currentSpaceStore:e,currentUserStore:t}}),[]);return(0,s.useEffect)((()=>{if("loading"===An.state.loadingState||!t||!n)return;const s=jx.ZP.addListener((0,Mx.pD)({userId:n.id,spaceId:t.id}),((t,n)=>{Bn({environment:e,messageStoreEmitValue:n})}),void 0,e);return function(){s&&jx.ZP.removeListener(s,e)}}),[t,n,e]),null}const wx=s.memo(Cx);function kx(e){let{title:t,description:n,disabled:s=!1,selected:i,onChange:o=(()=>{})}=e;return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>!s&&o(!i),children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[t,n&&(0,c.jsx)(Ce.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:n})]}),(0,c.jsx)("div",{style:{marginTop:5},children:(0,c.jsx)(al.Z,{on:i,disabled:s})})]})}function Ix(){const e=(0,i.Fy)();return(0,c.jsx)(fe.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"teamsWorkspaceSettings.title",defaultMessage:"Teamspace settings"})})}function Tx(){const e=(0,i.O7)(),t=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),n=(0,a.qz)(void 0,Qe.Z),o=(0,a.VK)((()=>t&&n.getValueForSpace(t)),[t,n]),r=(0,a.VK)((()=>(0,we.F$)()),[]),l=(null==o?void 0:o.disableTeamCreation)??!1,d=(null==o?void 0:o.disableTeamGuests)??!1,u=void 0===o,m=(0,s.useCallback)((()=>{t&&o&&async function(e){let{newSettingValue:t,environment:n,workspaceSecuritySettings:s,spaceStore:i}=e;const o="allowTeamCreation"===t?(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsHelpers.confirmChangeSecuritySetting.allowTeamCreation",defaultMessage:"Are you sure you want to allow all members of this workspace to create teamspaces?"}):(0,c.jsx)(f.FormattedMessage,{id:"manageTeamsHelpers.confirmChangeSecuritySetting.workspaceOwners.disableTeamCreation",defaultMessage:"Are you sure you want to limit teamspace creation to only workspace owners?"});!!(await M.confirmUserAction({message:o}))&&ec.n(n,{securitySettingsState:{...s,disableTeamCreation:"disableTeamCreation"===t},spaceStore:i})}({newSettingValue:l?"allowTeamCreation":"disableTeamCreation",environment:e,spaceStore:t,workspaceSecuritySettings:o})}),[t,l,e,o]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(As.Z,{size:34}),(0,c.jsx)(kx,{disabled:u,onChange:m,title:(0,c.jsx)(f.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.title",defaultMessage:"Limit teamspace creation to only workspace owners"}),description:(0,c.jsx)(f.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.caption",defaultMessage:"Only allow workspace owners to create teamspaces"}),selected:l}),(0,c.jsx)(As.Z,{size:34}),r&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(kx,{disabled:u,onChange:async function(){if(t&&o){if(!Boolean(o.disableTeamGuests)){if(!(await M.confirmUserAction({message:(0,c.jsx)(f.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.message",defaultMessage:"Are you sure you want to disable teamspace guests?"}),description:(0,c.jsx)(f.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.description",defaultMessage:"This action will remove all teamspace guests from the workspace."}),acceptLabel:(0,c.jsx)(f.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.acceptButton",defaultMessage:"Disable and remove teamspace guests"})})))return}ec.n(e,{securitySettingsState:{...o,disableTeamGuests:!o.disableTeamGuests},spaceStore:t})}},title:(0,c.jsx)(f.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.title",defaultMessage:"Allow teamspace owners to add teamspace guests"}),description:(0,c.jsx)(f.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.caption",defaultMessage:"This will allow teamspace owners with membership admin permissions to add teamspace guests. Disabling will remove all teamspace guests."}),selected:!d}),(0,c.jsx)(As.Z,{size:34})]})]})}function Zx(e){let{}=e;const t=(0,r.yK)((()=>({learnMoreLinkContainer:{paddingTop:6,paddingBottom:20}})),[]);return(0,c.jsxs)(kt.ZP,{children:[(0,c.jsx)(Ix,{}),(0,c.jsx)(hy.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_workspace_settings",containerStyle:t.learnMoreLinkContainer}),(0,c.jsx)(ky,{}),(0,c.jsx)(Tx,{}),(0,c.jsx)(bx,{}),(0,c.jsx)(wx,{})]})}var Px=n(586993),Fx=n(247839),_x=n(703924),Ax=n(539675),Bx=n(67729),Rx=n(375493),Dx=n(102832),Ox=n(73966);function Lx(e){let{isMobile:t}=e;const n=(0,i.O7)(),s=V.default.getIntl(),o=(0,a.VK)((()=>Ge.default.state.currentUserSettingsStore),[]),{currentTimeZone:r,auto_update_disabled:l}=(0,a.VK)((()=>{const e=null==o?void 0:o.getSettings();return{currentTimeZone:null==e?void 0:e.time_zone,auto_update_disabled:null==e?void 0:e.disable_auto_set_timezone}}),[o]),d=(0,a.VK)((()=>Dx.S.map((e=>({key:e,label:(0,Rx.Z)(s,e)})))),[s]);return(o&&(0,c.jsx)(Ds.Z,{isMobile:t,disabled:!l,title:(0,c.jsx)(f.FormattedMessage,{id:"dateAndTimeSettings.timeZone.title",defaultMessage:"Time Zone"}),caption:(0,c.jsx)(f.FormattedMessage,{id:"dateAndTimeSettings.timeZone.caption",defaultMessage:"Current time zone setting."}),type:"dropdown",currentOption:r??"error_fetch_timezone",options:d,onSelectOption:e=>{Ox.l6({environment:n,userSettingsStore:o,timeZone:e})}}))??null}function Vx(e){let{isMobile:t}=e;const n=(0,i.O7)(),o=(0,a.VK)((()=>Ge.default.state.currentUserSettingsStore),[]),r=(0,a.VK)((()=>{var e;return null==o||null===(e=o.getSettings())||void 0===e?void 0:e.disable_auto_set_timezone}),[o])??!1,l=(0,s.useCallback)((e=>{const t=!r;Ox.k2({environment:n,userSettingsStore:e,disableAutoSetTimezone:t}),t||Ox.wk({environment:n,userSettingsStore:e})}),[n,r]),d=(0,c.jsx)(f.FormattedMessage,{id:"dateAndTimeSettings.autoTimeZone.title",defaultMessage:"Set timezone automatically using your location"}),u=(0,c.jsx)(f.FormattedMessage,{id:"dateAndTimeSettings.autoTimeZone.caption",defaultMessage:"Reminders, notifications and emails are delivered based on your time zone."});return(o&&(0,c.jsx)(Ds.Z,{isMobile:t,title:d,caption:u,type:"toggle",isOn:!r,onToggle:()=>l(o)}))??null}const Ex=function(e){let{isMobile:t}=e;const n=(0,i.O7)(),o=(0,a.VK)((()=>Ge.default.state.currentUserSettingsStore),[]),r=(0,a.VK)((()=>{var e;return null==o||null===(e=o.getSettings())||void 0===e?void 0:e.profile_discoverable}),[o])??!0,l=(0,s.useCallback)((e=>{const t=!r;P.createAndCommit({userAction:"ProfileDIscoverabilitySettings.onToggleOption",environment:n,perform:e=>{o&&F.d2({userSettingsStore:o,data:{profile_discoverable:t},transaction:e})}})}),[n,r,o]),d=(0,c.jsx)(f.FormattedMessage,{id:"profileDiscoverabilitySettings.title",defaultMessage:"Profile discoverability"}),u=(0,c.jsx)(f.FormattedMessage,{id:"profileDiscoverabilitySettings.caption",defaultMessage:"Users with your email can see your name and profile picture when inviting you to a new workspace. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,c.jsx)(Rs.Z,{external:!0,href:(0,ze.UY)("guides.profileSettings"),onClick:e=>{e.stopPropagation()},children:e})}});return(0,c.jsx)(Ds.Z,{isMobile:t,title:d,caption:u,isOn:r,type:"toggle",onToggle:()=>l(o)})};var Nx=n(416347);const Ux=(0,_x.M)((function(e){let{passwordRequestStore:t,userEmailDomainSettings:n}=e;const{isPhone:o,isIOS:r,isMobile:l,isElectron:d}=(0,i.Fy)(),u=(0,i.O7)(),m=(0,a.VK)((()=>yn.Z.state.online),[]),p=(0,a.VK)((()=>l&&t?(0,Ax.E)({isPhone:o,isIOS:r,passwordRequestStore:t,userEmailDomainSettings:n}):(0,Ax.Z)({environment:u})),[u,l,o,r,t,n]);(0,s.useEffect)((()=>(d&&Fx.setGlobalShortcutsEnabled(!1),()=>{d&&Fx.setGlobalShortcutsEnabled(!0)})),[d]);const g=[{key:"timezone-auto",renderSettingsItem:()=>(0,c.jsx)(Vx,{isMobile:l})},{key:"timezone-manual",renderSettingsItem:()=>(0,c.jsx)(Lx,{isMobile:l})}].filter(Zn.$K),h=[(0,a.VK)((()=>(0,Bx.h)(u)),[u])?{key:"cookies",renderSettingsItem:()=>(0,c.jsx)(Bx.Z,{isMobile:l})}:void 0,{key:"view-history",renderSettingsItem:()=>(0,c.jsx)(Nx.H,{isMobile:l})},{key:"profile-discoverability",renderSettingsItem:()=>(0,c.jsx)(Ex,{isMobile:l})}].filter(Zn.$K);return m?(0,c.jsxs)(kt.ZP,{disableScroller:l,children:[(0,c.jsx)(fe.Z,{large:!l,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"mySettings.settingsSection.title",defaultMessage:"My settings"})}),(0,c.jsx)(Qd.O,{items:p}),(0,c.jsx)(As.Z,{size:48,isHidden:!0}),(0,c.jsx)(fe.Z,{large:!l,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"notificationAndPersonalSettings.dateAndTimeSection.title",defaultMessage:"Date & time"})}),(0,c.jsx)(Qd.O,{items:g}),(0,c.jsx)(As.Z,{size:48,isHidden:!0}),(0,c.jsx)(fe.Z,{large:!l,divider:"full",children:(0,c.jsx)(f.FormattedMessage,{id:"mySettings.privacySection.title",defaultMessage:"Privacy"})}),(0,c.jsx)(Qd.O,{items:h})]}):(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(Ce.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Please go online to manage settings.",id:"mySettings.goOnline.prompt"})})})})),Kx={overflow:"auto",paddingBottom:12},Wx={display:"flex",flexDirection:"column",height:"100%",justifyContent:"space-between",paddingTop:10,paddingLeft:4,paddingRight:4},zx={user_settings:{},profile:{},notifications:{},notifications_and_settings:{},connected_apps:{},language_and_region:{},debug_zone:{},settings:{},teams:{adminOnly:!0,membersOnly:!0},members:{membersOnly:!0},analytics:{membersOnly:!0,enterpriseOnly:!0},plans:{membersOnly:!0},billing:{},subscription:{},security:{adminOnly:!0},identity_provisioning:{adminOnly:!0},admin_content_search:{adminOnly:!0,enterpriseOnly:!0},integrations:{adminOnly:!0},imports:{},audit_log:{adminOnly:!0,enterpriseOnly:!0},experiments:{},sites:{membersOnly:!0}},qx=(0,f.defineMessages)({dialogLabel:{id:"spaceSettings.dialogLabel",defaultMessage:"Settings & members"}});function Gx(e){let{spaceStore:t,userStore:n}=e;const l=(0,i.O7)(),{open:d,currentTab:u,openedFrom:m}=(0,a.VK)((()=>{const{open:e,currentTab:t,openedFrom:n}=rt.Z.state;return{open:e,currentTab:t,openedFrom:n}}),[]),p=(0,a.qz)(void 0,nt),g=(0,a.qz)(void 0,at),f=(0,a.qz)(void 0,Qe.Z),h=(0,a.qz)(void 0,Ye),y=(0,a.qz)(void 0,it);(0,o.Z)((()=>{const e=f.getValueForSpace(t);e&&f.setState(e)})),(0,o.Z)((()=>{T(l,g)})),(0,s.useEffect)((()=>{d&&b.SU(l,{tab:u,from:m})}),[l,u,d,m]);const S=(0,s.useCallback)((()=>{ct.bi(l),$x(),x.kj({environment:l,spaceId:t.id,canAdmin:t.canAdmin()})}),[l,t]),v=(0,s.useCallback)((()=>{rS((()=>{rt.Z.setState({...rt.Z.state,open:!1}),Xe.reset(),y.reset(),$x(),lt.Z.reset()}),l,t,p,g,f)}),[l,t,p,g,f,y]),M=(0,r.yK)((()=>({modalInner:{width:1150,maxWidth:"calc(100vw - 100px)",height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:12,maxHeight:715}})),[]);return(0,c.jsx)(Hs.Z,{ariaLabel:V.default.formatMessage(qx.dialogLabel),open:d,innerStyle:M.modalInner,onOpen:S,onDismiss:v,render:()=>(0,c.jsx)(uS,{spaceStore:t,userStore:n,spaceBasicSettingsStore:p,spaceProfileSettingsStore:g,securitySettingsStore:f,samlSettingsStore:h,spaceDomainSettingsStore:y}),className:Ke.zYS})}function Hx(e,t){const n=zx[e];return!(n.adminOnly&&!t.canAdmin())&&(!(n.membersOnly&&!t.canRead())&&!(n.enterpriseOnly&&!(0,g.wP)(t.getSubscriptionTier())))}function $x(){E.Z.reset(),z.reset()}function Yx(e){let{userStore:t}=e;const n=(0,f.useIntl)(),s=(0,a.VK)((()=>t.getFullName(n)),[n,t]);return s?(0,c.jsx)(Ce.Z,{style:{fontWeight:y.Z.fontWeight.medium},children:s}):null}function Qx(e,t,n){const{disablePublicAccess:s,disableGuests:i,disableMoveToSpace:o,disableExport:a,disableSpacePageEdits:r,disablePublicAccessRequests:l,disableTeamCreation:d,disableMembershipRequests:c,disableExternalMembershipRequests:u,disableGuestMembershipRequests:m,enableAiFeature:p,disableTeamGuests:g,enableGuestInviteRequests:f,enableAiTraining:h}=e.state;P.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:n,perform:e=>{w.Xr({environment:n,disablePublicAccess:s,disableGuests:i,disableMoveToSpace:o,disableExport:a,disableSpacePageEdits:r,disablePublicAccessRequests:l,transaction:e,spaceStore:t,disableTeamCreation:d,disableMembershipRequests:c,disableExternalMembershipRequests:u,disableGuestMembershipRequests:m,enableAiFeature:Boolean(p),disableTeamGuests:g,enableGuestInviteRequests:f,enableAiTraining:Boolean(h)})}})}function Jx(e){let{spaceStore:t}=e;const n=(0,i.O7)(),s=(0,a.VK)((()=>(0,we.wE)(n)),[n]),o=(0,a.VK)((()=>lt.Z.state.count),[]);return s?(0,c.jsx)(Oh,{}):(0,c.jsx)(Rm.Z,{store:t,unreadAccessRequests:o})}function Xx(e){let{spaceStore:t}=e;const n=(0,i.O7)(),s=(0,a.VK)((()=>Ht.subscriptionDataStoreInstance.state),[]),o=(0,a.VK)((()=>dt.Z.getData(n,{spaceId:t.id})),[t,n]);if(!s)return null;const r="unsubscribed_admin"===s.type&&s.customerData&&(0,p.E3)(s.customerData.stripe.addOns);if("subscribed_admin"===s.type||r){var l;const e=null===(l=s.customerData)||void 0===l?void 0:l.stripe;return e?(0,c.jsx)(Ct.Z,{spaceStore:t,subscriptionData:s,upcomingInvoiceData:o,customerData:e}):null}return s&&"unsubscribed_admin"===s.type?(0,c.jsx)(Cn,{spaceStore:t,data:s}):null}function eS(){const e=(0,a.VK)((()=>(0,We.tt)()),[]),t=(0,a.VK)((()=>(0,We.RT)()),[]);return(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(nd,{genericImporterEnabled:e,zipImporterEnabled:t})})}function tS(e){return{fontSize:12,lineHeight:1,marginBottom:1,color:e.mediumTextColor,fontWeight:y.Z.fontWeight.semibold,alignItems:"center",display:"flex",height:24,paddingLeft:12,paddingRight:11,textOverflow:"ellipsis",overflow:"hidden"}}function nS(e,t){return{width:20,height:20,marginRight:8,color:t?e.text.uiBluePrimary:e.regularIconColor,fill:t?e.text.uiBluePrimary:e.regularIconColor}}function sS(e){return{width:14,height:14,color:e.regularIconColor}}function iS(){const e=(0,r.Fg)(),t=(0,i.O7)(),n=(0,a.VK)((()=>(0,Ue.B7)(t)),[t]),s=(0,a.VK)((()=>null==n?void 0:n.getEmail()),[n]),o={size:20,hasTooltip:!0,avatarShouldShowShadow:!0,userStore:n};return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",height:44,paddingLeft:12,paddingRight:12},children:[(0,c.jsx)("div",{style:nS(e),children:(0,c.jsx)($s.Z,{...o})}),n?(0,c.jsxs)("div",{children:[(0,c.jsx)(Yx,{userStore:n}),s&&(0,c.jsx)(Ce.Z,{isSmall:!0,children:s})]}):(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.userDetails.title",defaultMessage:"Me"})]})}function oS(e){let{tab:t}=e;const n=(0,r.Fg)(),s=(0,i.O7)(),o=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]);return(0,a.VK)((()=>"members"===t&&s.device.isDesktop&&(null==o?void 0:o.canEditMembership())&&(0,we.p1)()&&!(0,we.wE)(s)&&lt.Z.state.count>0),[t,s,o])?(0,c.jsx)(tl.z,{color:n.redBadgeBackground}):null}function aS(e){let{spaceProfileSettingsStore:t}=e;const n=(0,a.VK)((()=>Gt.wl(Ht.subscriptionDataStoreInstance.state)),[]);return(0,c.jsx)(rg,{isEducationPlan:n,spaceProfileSettingsStore:t})}async function rS(e,t,n,s,i,o){const{currentUserStore:a,currentUserSettingsStore:r}=Ge.default.state;if(!a||!r)throw new Error("No user or settings store.");const l=(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Save changes?"}),d=(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationButton.label",defaultMessage:"Yes"}),u=(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.cancelationButton.label",defaultMessage:"No"}),{currentTab:m}=rt.Z.state;if("profile"===m){if(!h.Xy(i.state,i.getValueForUser(a,r,V.default.getIntl()))){const{profilePhoto:n,name:s,startDayOfWeek:o}=i.state;return s?M.showDialog({message:l,showCancel:!0,keepFocus:!0,items:[{label:(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.updateSettingsButton.label",defaultMessage:"Update"}),color:"blue",onAccept:()=>{P.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:t,perform:e=>{const{currentUserStore:t}=Ge.default.state;if(t&&S.A({userStore:t,data:{name:s,profilePhoto:n},transaction:e}),r){const t=r.getSettings();(null==t?void 0:t.start_day_of_week)!==o&&F.d2({userSettingsStore:r,data:{start_day_of_week:o},transaction:e})}}}),e()}}],handleCancel:()=>{e()}}):M.showErrorMessage((0,c.jsx)(f.FormattedMessage,{id:"profileSettings.personalInfoSection.nameMissing.message",defaultMessage:"Please fill in name."})),!0}e()}else if("settings"===m&&n.canEdit()){const i=!h.Xy(o.state,o.getValueForSpace(n)),a=!h.Xy(s.state,s.getValueForSpace(n));if(i||a){if(await M.confirmUserAction({message:l,acceptLabel:d,cancelLabel:u})){if(!(await w.Y5({environment:t,spaceId:n.id,domain:s.state.domain})))return!1;a&&w.OF({environment:t,spaceStore:n,spaceBasicSettingsStore:s}),i&&Qx(o,n,t),e()}else e();return!0}e()}else if("audit_log"===m)$x(),e();else if("analytics"===m)et.Z.reset(),e();else if("plans"===m&&n.canAdmin()){const s=o.getValueForSpace(n);!h.Xy(o.state,o.getValueForSpace(n))&&s&&(o.setState(s),Qx(o,n,t)),e()}else"teams"===m?(Fn.Z.reset(),An.reset(),e()):e();return!1}function lS(e){let{tab:t,spaceStore:n,spaceBasicSettingsStore:s,spaceProfileSettingsStore:o,securitySettingsStore:l,spaceDomainSettingsStore:d}=e;const u=(0,r.Fg)(),m=(0,i.O7)(),p=(0,a.VK)((()=>rt.Z.state.currentTab===t),[t]),g=(0,a.VK)((()=>Hx(t,n)),[n,t]),f=(0,a.VK)((()=>cn[t](m)),[m,t]),h=(0,a.VK)((()=>(0,vt.wP)()&&"plans"===t),[t]),x=(0,a.VK)((()=>un[t](m)),[m,t]),S=(0,a.VK)((()=>mn[t](m)),[m,t]);if(!g)return null;const v=h?{color:u.text.uiBluePrimary}:{};return(0,c.jsxs)(Me.Z,{hovered:p,style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingLeft:12,paddingRight:12,borderRadius:4,marginTop:1,marginBottom:1,minHeight:27,position:"relative"},onClick:e=>{if(p)return null;rS((()=>{rt.Z.setState({...rt.Z.state,currentTab:t,defaultSubtab:void 0}),d.reset(),b.XI(m,{tab:t})}),m,n,s,o,l)},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",...p&&!h&&{fontWeight:y.Z.fontWeight.semibold}},children:[(0,c.jsx)("div",{style:nS(u,h),children:f}),(0,c.jsx)(Ce.Z,{style:v,isMultiline:!0,children:x}),S]}),(0,c.jsx)(oS,{tab:t})]})}function dS(e){let{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:d,renderBelowPrompt:m}=e;const p=(0,r.Fg)(),g=(0,i.O7)(),h=(0,a.VK)((()=>function(e){var t,n;const{currentSpaceViewStore:s,currentSpaceStore:i,currentUserStore:o}=Ge.default.state;if(!i||!Hx("analytics",i))return!1;if(null==o||!o.id)return!1;if(null==i||!i.isDefined())return!1;const a=null==s?void 0:s.getSettings();return"dismissed"!==(null==a||null===(t=a.space_analytics_settings_prompt)||void 0===t?void 0:t.status)&&"hidden"!==(null==a||null===(n=a.space_analytics_settings_prompt)||void 0===n?void 0:n.status)&&(Z.lo(e),!0)}(g)),[g]),y=(0,a.VK)((()=>Ge.default.state.currentSpaceStore),[]),x=(0,a.VK)((()=>null==y?void 0:y.canAdmin()),[y]),S=(0,a.VK)((()=>function(e,t){var n,s;const{currentSpaceViewStore:i,currentSpaceStore:o,currentUserStore:a}=Ge.default.state;if(null==a||!a.id)return!1;if(null==o||!o.isDefined())return!1;const r=null==i?void 0:i.getSettings();return"dismissed"!==(null==r||null===(n=r.mfa_settings_prompt)||void 0===n?void 0:n.status)&&"hidden"!==(null==r||null===(s=r.mfa_settings_prompt)||void 0===s?void 0:s.status)&&"off"===t.state.accountSettings.mfaStatus&&(Z.GZ(e),!0)}(g,s)),[g,s]);if(h){const e=x?(0,c.jsx)(f.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.workspaceOwner",defaultMessage:"Explore how members & guests are engaging with this workspace, common searches that are made, and content engagement metrics with workspace analytics."}):(0,c.jsx)(f.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.member",defaultMessage:"See how your content is performing by reviewing metrics like number of views or unique visitors using workspace analytics."});return(0,c.jsx)(Xc,{onDismiss:()=>Z.TY(g),onClick:()=>{rS((()=>{rt.Z.setState({...rt.Z.state,currentTab:"analytics",defaultSubtab:void 0}),d.reset(),b.XI(g,{tab:"analytics"}),Z.pE(g)}),g,t,n,s,o)},onView:e=>{"enterprise"===(null==y?void 0:y.getSubscriptionTier())&&Z.pE(e)},onClickLearnMore:()=>{const e=(0,ze.UY)("guides.workspaceAnalytics");C.D({environment:g,url:e})},descriptionMessage:e,title:(0,c.jsx)(f.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.title",defaultMessage:"New workspace analytics"}),buttonText:(0,c.jsx)(f.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.cta",defaultMessage:"View metrics"}),icon:u(sS(p))})}return S?(0,c.jsx)(Xc,{onClick:()=>{rS((()=>{rt.Z.setState({...rt.Z.state,open:!0,currentTab:"profile",defaultSubtab:void 0,highlightedSetting:rt.R.TwoStepVerification}),b.XI(g,{tab:"profile"})}),g,t,n,s,o)},onView:Z.E6,onDismiss:()=>Z.ZJ(g),onClickLearnMore:()=>{const e=(0,ze.UY)("guides.mfa");C.D({environment:g,url:e})},descriptionMessage:(0,c.jsx)(f.FormattedMessage,{id:"mfaSettingsPrompt.description",defaultMessage:"2-step verification, also known as 2FA or MFA, is now available. Add a secondary method of verification used during login."}),title:(0,c.jsx)(f.FormattedMessage,{id:"mfaSettingsPrompt.title",defaultMessage:"Add an extra layer of security to your account."}),buttonText:(0,c.jsx)(f.FormattedMessage,{id:"mfaSettingsPrompt.button.label",defaultMessage:"Enable 2-step verification"}),icon:(0,l.Q)(sS(p))}):m}function cS(e){let{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l}=e;const d=(0,r.Fg)(),u=(0,i.O7)(),g=(0,a.VK)((()=>Ht.subscriptionDataStoreInstance.state),[]),h=(0,a.VK)((()=>rt.Z.state.currentTab),[]),y=Gt.wY(g),x=(0,a.VK)((()=>(0,we.mS)()),[]),S=(0,a.VK)((()=>$h().length>0),[]),b=(0,a.VK)((()=>function(e,t){var n;const s=Ht.subscriptionDataStoreInstance.state;return!(!s||e||!t.canAdmin()||"subscribed_admin"!==s.type&&("unsubscribed_admin"!==s.type||!(0,p.E3)(null===(n=s.customerData)||void 0===n?void 0:n.stripe.addOns))&&!(0,Gt.MM)(s)&&!s.hasPaidNonzero)}(y,t)),[y,t]),M=(0,a.VK)((()=>(0,qe.bq)()),[]),j=(0,a.VK)((()=>t.canRead()),[t]),C=(0,a.VK)((()=>(0,vt.YX)()),[]),w=(0,a.VK)((()=>b&&(0,vt.Lv)()),[b]);return(0,c.jsxs)("div",{style:Wx,children:[(0,c.jsx)("div",{style:Kx,children:(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:tS(d),children:(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.title",defaultMessage:"Account"})}),(0,c.jsx)(iS,{}),(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"profile"}),(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"user_settings"}),(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"notifications"}),(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"connected_apps"}),(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"language_and_region"}),S&&(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"debug_zone"}),(0,c.jsx)(As.Z,{size:18,isHidden:!0}),(0,c.jsx)("div",{style:tS(d),children:(0,c.jsx)(f.FormattedMessage,{id:"spaceSettings.sidebar.workspaceSettingsSection.title",defaultMessage:"Workspace"})}),"top"===C?(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"plans"}):null,"top"===C&&b?(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"billing"}):null,(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"settings"}),M&&(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"teams"}),(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"members"}),!u.device.isMobile&&(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"analytics"}),"control"===C||w?(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"plans"}):null,"control"===C&&b?(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"billing"}):null,y&&(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"subscription"}),(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"sites"}),(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"security"}),(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"identity_provisioning"}),!u.device.isMobile&&(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"admin_content_search"}),(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"integrations"}),!u.device.isMobile&&(0,c.jsx)("span",{onClick:()=>{const e=m.Il();He.Z.setState({flowId:e}),v.Sy(u,{from:"settings",flowId:e})},children:(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"imports"})}),!u.device.isMobile&&(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"audit_log"}),x&&(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"experiments"}),"bottom"===C&&b?(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"billing"}):null,"bottom"===C?(0,c.jsx)(lS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,tab:"plans"}):null]})}),(0,c.jsx)(dS,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:o,spaceDomainSettingsStore:l,renderBelowPrompt:j?(0,c.jsx)(jt,{currentSettingsTab:h}):null})]})}function uS(e){let{spaceStore:t,userStore:n,spaceBasicSettingsStore:s,spaceProfileSettingsStore:i,securitySettingsStore:o,samlSettingsStore:r,spaceDomainSettingsStore:l}=e;const{organizationOverrides:d,organizationInfo:u,isOrganizationOwner:m}=(0,Yc.u)({spaceId:t.id}),p=(0,a.VK)((()=>rt.Z.state.currentTab),[]),g=(0,a.VK)((()=>function(e,t,n,s,i,o,a,r,l,d,u){const m={profile:()=>(0,c.jsx)(aS,{spaceProfileSettingsStore:i}),notifications_and_settings:()=>(0,c.jsx)(Hd.Z,{isMobile:!1}),user_settings:()=>(0,c.jsx)(Ux,{}),notifications:()=>(0,c.jsx)(Xd,{}),language_and_region:()=>(0,c.jsx)(zd,{}),connected_apps:()=>(0,c.jsx)(Px.Z,{location:"settings-page"}),debug_zone:()=>(0,c.jsx)(Qh,{store:t}),settings:()=>(0,c.jsx)(Bm,{spaceStore:t,spaceBasicSettingsStore:s,securitySettingsStore:o,organizationOverrides:l}),teams:()=>(0,c.jsx)(Zx,{}),members:()=>(0,c.jsx)(Jx,{spaceStore:t}),analytics:()=>(0,c.jsx)(mu,{spaceStore:t}),plans:()=>(0,c.jsx)(In.Y,{}),billing:()=>(0,c.jsx)(Xx,{spaceStore:t}),subscription:()=>(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(Jh.Z,{})}),security:()=>(0,c.jsx)(_c,{spaceStore:t,userStore:n,securitySettingsStore:o,organizationOverrides:l}),identity_provisioning:()=>(0,c.jsx)(jr,{spaceStore:t,userStore:n,samlConfigStore:a,domainSettingsStore:r,organizationInfo:d,isOrganizationOwner:u}),admin_content_search:()=>(0,c.jsx)(Rn.Z,{spaceStore:t,userStore:n}),integrations:()=>(0,c.jsx)(Ks,{spaceStore:t,userStore:n,organizationOverrides:l}),experiments:()=>(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(Ys.U,{})}),audit_log:()=>(0,c.jsx)(kt.ZP,{children:(0,c.jsx)(Ne,{spaceStore:t})}),imports:()=>(0,c.jsx)(eS,{}),sites:()=>(0,c.jsx)(O.CT,{spaceStore:t})};if(Hx(e,t))return m[e];{const e=j.CT(t);return j.r$({currentTab:e}),m[e]}}(p,t,n,s,i,o,r,l,d,u,m)),[p,r,o,s,l,i,t,n,d,u,m]);return(0,c.jsx)(qs.Z,{capture:!0,allowEsc:!0,render:e=>(0,c.jsx)(Gs.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>(0,c.jsx)(eu,{sidebar:(0,c.jsx)(cS,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:i,securitySettingsStore:o,spaceDomainSettingsStore:l}),...e,children:g()})})})}const mS=s.memo(Gx)},556633:(e,t,n)=>{n.d(t,{G:()=>y});var s=n(667294),i=n(800480),o=n(886628),a=n(371663),r=n(494714),l=n(842875),d=n(559054),c=n(396367),u=n(709291),m=n(454642),p=n(566890),g=n(256596),f=n(785893);const h=(0,u.defineMessages)({cannotSetSprintToCurrentTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToCurrentTooltip",defaultMessage:"Current sprint already exists"},cannotSetSprintToNextTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToNextTooltip",defaultMessage:"Next sprint already exists"},cannotSetSprintToLastTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToLastTooltip",defaultMessage:"Last sprint already exists"}});function y(e){const{blockPropertyValueOverlayStore:t}=e,n=(0,i.O7)(),y=(0,p.Y$)(),x=(0,o.VK)((()=>y.normalizedSchemaStore.state),[y.normalizedSchemaStore]),S=function(e){let{sprintCollectionStore:t,environment:n,normalizedBlockSchema:s}=e;const[{value:i,status:o}]=(0,d.r5)((async()=>{var e;if(!t)return;const i=t.getSchema(),o=t.getFormat().app_config_uri;if(!o||o!==r.p$)return;const d=(0,c.Zv)(i,o).includes("last"),u=c.qB[o],p=u.current.reducer.get(s),g=u.next.reducer.get(s),f=u.last.reducer.get(s);if(!p||!g)return;const h={userId:n.currentUser.id,userTimeZone:(0,l.r)(),searchQuery:void 0,reducers:{[a.SF]:p,[a.YE]:g,...d&&f?{[a.Rw]:f}:{}},currentPageInRelatedCollection:void 0},y=null===(e=t.getParentBlockStore())||void 0===e?void 0:e.getCollectionViewStores()[0],x=t.getSpaceId();if(!y)return;const S=await m.queryCollection(n,{source:{type:"collection",id:t.id,spaceId:x},collectionView:{id:y.id,spaceId:x},loader:h},void 0,{src:"sprint_status_overlay_check"});if("success"!==S.type)return;const v=S.data.result.reducerResults[a.SF],b=S.data.result.reducerResults[a.YE];if("results"!==v.type||"results"!==b.type)return;const M=v.blockIds.length>0,j=b.blockIds.length>0;if(!d)return{hasCurrentSprint:M,hasNextSprint:j,hasLastSprint:!1};const C=S.data.result.reducerResults[a.Rw];if("results"!==C.type)return;return{hasCurrentSprint:M,hasNextSprint:j,hasLastSprint:C.blockIds.length>0}}),[n,s,t]);if("resolved"!==o||!i)return;return i}({sprintCollectionStore:(0,o.VK)((()=>{const e=t.state;if(e.isOpen)return e.store.getAssociatedCollectionStore()}),[t]),environment:n,normalizedBlockSchema:x}),v=(0,u.useIntl)(),b=(0,s.useCallback)((e=>void 0===S&&[a.YE,a.SF,a.Rw].includes(e)?{disabled:!0}:e===a.YE&&null!=S&&S.hasNextSprint?{disabled:!0,disableReasonMessage:v.formatMessage(h.cannotSetSprintToNextTooltip)}:e===a.SF&&null!=S&&S.hasCurrentSprint?{disabled:!0,disableReasonMessage:v.formatMessage(h.cannotSetSprintToCurrentTooltip)}:e===a.Rw&&null!=S&&S.hasLastSprint?{disabled:!0,disableReasonMessage:v.formatMessage(h.cannotSetSprintToLastTooltip)}:{disabled:!1}),[S,v]);return(0,f.jsx)(g.x,{...e,shouldDisableOption:b})}},256596:(e,t,n)=>{n.d(t,{x:()=>_});var s=n(443261),i=n.n(s),o=n(667294),a=n(800480),r=n(886628),l=n(724405),d=n(180951),c=n(984619),u=n(204635),m=n(709291),p=n(653965),g=n(401898),f=n(805149),h=n(710274),y=n(849616),x=n(243224),S=n(460709),v=n(98742),b=n(825464),M=n(374617),j=n(552275),C=n(478140),w=n(632163),k=n(840721),I=n(672495),T=n(526388),Z=n(122084),P=n(147082),F=n(785893);function _(e){var t;const{propertySchema:n,blockPropertyValueOverlayStore:s,onChange:_}=e,{device:A}=(0,a.O7)(),[B,R]=o.useState(e.initialValue??""),[D,O]=o.useState(""),L=(0,l.Fg)(),V=(0,m.useIntl)(),E=(0,r.VK)((()=>{const e=s.state;if(e.isOpen)return e.collectionContextStore}),[s]),N=(0,r.VK)((()=>(null==E?void 0:E.permissionScopesStore.state.canConfigureCollection)&&"collectionPage"!==(null==E?void 0:E.contextType)),[E]),U=(0,r.VK)((()=>{const e=s.state;return!!e.isOpen&&(0,y.aJ)({store:e.store,additionalStores:e.additionalStores,collectionContextStore:e.collectionContextStore})}),[s]),K=U?[]:n.options??[],W=(0,d.i7)(K,B),z=n.groups??[],q=W&&z.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(W.id)})),G=W?[(0,F.jsx)(Z.F,{value:W.value,color:W.color,groupColor:null==q?void 0:q.color,isSingle:!1,format:A.isMobile?c.lo.Large:c.lo.Medium,onClickRemove:()=>{R(""),_(void 0,void 0)},showRemoveButton:void 0===n.defaultOption,shouldShrink:!0,showEllipsis:!0,tooltipPlacement:b.u.Left,hideTooltip:!(null===(t=W.description)||void 0===t||!t.length)},"status")]:[],H=U?null:(0,F.jsx)(P.ZP,{focus:!A.isMobile||void 0,focusAfterAnimation:!0,format:P.UR.Select,tokens:G,placeholder:V.formatMessage({id:"database.selectPropertyEditMenu.searchStatusPlaceholder",defaultMessage:"Search for an option"}),onRemoveLastToken:()=>{},value:D,disabled:e.disabled,hideInput:e.disabled,onChange:e=>{O(e.target.value)},dontShowBorderBottom:A.isAndroid});let $;if($=A.isMobile?{menuType:S.og.Modal,title:n.name,right:(0,F.jsx)(k.DoneMenuText,{}),onClickRight:e.onDismiss,header:H}:{menuType:S.og.Popup,header:H,tokenInputHeader:!0},e.disabled)return(0,F.jsx)(C.Z,{...$});let Y=K;if(""!==D){const e=i().filter(D,K.map((e=>e.value))).map((e=>e.original));Y=K.filter((t=>e.includes(t.value)))}const Q=z.map((e=>{const t=Y.filter((t=>{var n;return null===(n=e.optionIds)||void 0===n?void 0:n.includes(t.id)}));if(0!==t.length)return{group:e,groupOptions:t}})).filter(g.$K),J=Q.length>1,X=U?[{items:z.map((t=>({key:t.name,render:e=>(0,F.jsx)(j.Z,{...e,disabledFeedback:!0,focused:e.focused,title:(0,F.jsx)(M.r_,{style:{fontWeight:500,marginTop:2},group:t,showIcon:!0,showColor:!0})}),action:()=>{e.onChange(void 0,t.name)}}))),key:"all-groups",render:e=>(0,F.jsx)(I.Z,{...e})}]:Q.map(((t,n)=>{let{group:s,groupOptions:i}=t;return{items:i.map((t=>{const n=e.shouldDisableOption?e.shouldDisableOption(t.id):{disabled:!1};return{key:t.value,render:e=>{var i;return(0,F.jsx)(T.Z,{disableTooltip:n.disabled&&!(null!==(i=t.description)&&void 0!==i&&i.length),placement:b.u.Left,renderTooltip:e=>n.disabled?n.disableReasonMessage:(0,F.jsxs)("div",{...e,style:x.F6,children:[(0,F.jsx)("div",{children:t.value}),(0,F.jsx)("div",{style:{color:L.mediumInvertedTextColor},children:t.description})]}),render:i=>{var o;return(0,F.jsx)(j.Z,{...(0,v.Z)(i,e),disabled:n.disabled,disabledFeedback:!0,focused:e.focused,title:(0,F.jsx)(Z.F,{...i,value:t.value,color:t.color,hideTooltip:!(null===(o=t.description)||void 0===o||!o.length),tooltipPlacement:b.u.Left,groupColor:s.color,showRemoveButton:!1,isSingle:!0,format:A.isMobile?c.lo.Large:c.lo.Medium}),isTokenTitle:!0})}})},action:()=>{e.onChange(t.value,void 0)}}})),key:`group-${n}`,render:e=>(0,F.jsx)(I.Z,{...e,topBorder:e.index>0,title:J&&(0,F.jsx)(M.r_,{group:s,showColor:!1,style:{fontSize:12}})})}})),ee=E&&N?{items:[{key:"edit property",render:e=>(0,F.jsx)(j.Z,{...e,title:(0,F.jsx)(m.FormattedMessage,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:(0,u.W)({width:14})}),action:()=>{const t=E.settingsStore;E.collectionStore()&&(e.onDismiss(),h.n1({collectionContextStore:E}),f.r$({collectionContextStore:E,collectionSettingsStore:t}),f.H4({collectionSettingsStore:t,item:{type:"property",formatKey:E.getPropertyFormatKey(),property:e.property}}))}}],key:"edit-property",render:e=>(0,F.jsx)(I.Z,{...e,topBorder:e.index>0})}:void 0;return(0,F.jsx)(C.Z,{...$,children:(0,F.jsx)(w.Z,{type:w.i.Vertical,initialFocus:D.length>0?0:void 0,sections:p.oA([...X,ee]),onAccept:(t,n,s)=>{e.onAccept(s)}})})}},705478:(e,t,n)=>{n.d(t,{YF:()=>l,ZP:()=>c});n(667294);var s=n(724405),i=n(825464),o=n(526388),a=n(685567),r=n(785893);const l={Success:"success",Pending:"pending",Failure:"failure"};const d={display:"flex",justifyContent:"center",alignItems:"baseline"},c=function(e){let{status:t,value:n,renderTooltip:c,...u}=e;const m=(0,s.Fg)(),p={[l.Success]:m.statusTokenBackground.green,[l.Pending]:m.statusTokenBackground.yellow,[l.Failure]:m.statusTokenBackground.red},g={[l.Success]:m.statusTokenIndicator.green,[l.Pending]:m.statusTokenIndicator.yellow,[l.Failure]:m.statusTokenIndicator.red},f={[l.Success]:m.statusTokenText.green,[l.Pending]:m.statusTokenText.yellow,[l.Failure]:m.statusTokenText.red};return c?(0,r.jsx)(a.Z,{...u,backgroundColor:p[t],color:f[t],value:(0,r.jsx)(o.Z,{placement:i.u.Bottom,alignment:i.v.Start,renderTooltip:c,render:e=>(0,r.jsxs)("div",{style:d,...e,children:[(0,r.jsx)("div",{style:{background:g[t],width:8,height:8,borderRadius:"100%",marginRight:4}}),n]})})}):(0,r.jsx)(a.Z,{...u,backgroundColor:p[t],color:f[t],value:(0,r.jsxs)("div",{style:d,children:[(0,r.jsx)("div",{style:{background:g[t],width:8,height:8,borderRadius:"100%",marginRight:4}}),n]})})}},113787:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(749085),l=n(584169),d=n(89101),c=n(709291),u=n(531701),m=n(137810),p=n(454642),g=n(492658),f=n(628020),h=n(992083),y=n(909209),x=n(374194),S=n(550506),v=n(158297),b=n(942402),M=n(785893);const j={padding:"24px 36px 24px",minWidth:300,maxWidth:400},C=r.default.createClass(void 0,{name:"PromoErrorStore"});const w=function(){const e=(0,o.qz)(void 0,C),t=(0,o.qz)(void 0,g.Z),n=(0,o.VK)((()=>y.Z.state.open),[]);return(0,M.jsx)(S.Z,{open:n,innerStyle:j,preventHideChildrenWhileOpening:!0,render:()=>(0,M.jsx)(F,{promoCodeStore:t,promoErrorStore:e}),onDismiss:I})};function k(){const e=(0,a.Fg)();return(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center",color:e.lightTextColor,borderTop:`1px solid ${e.regularDividerColor}`,paddingTop:14},children:[(0,l.m)({width:14,marginTop:1,marginRight:6,fill:e.lightIconColor})," ",(0,M.jsx)("div",{children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:e=>(0,M.jsx)(b.Z,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0,children:e})}})})]})}function I(){y.Z.setState({open:!1})}function T(){I(),h.Z.setState({open:!0,openedFrom:"upsell",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})}function Z(){const e=(0,a.Fg)(),t=(0,i.O7)(),n=(0,o.VK)((()=>(0,f.B7)(t)),[t]),s=(0,o.VK)((()=>null==n?void 0:n.getEmail()),[n]);return(0,M.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,M.jsx)("div",{style:{width:18,flexShrink:0,color:e.mediumTextColor},children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})}),(0,M.jsxs)("div",{style:{flexGrow:1},children:[(0,M.jsx)("div",{style:{color:e.mediumTextColor},children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})}),(0,M.jsx)("div",{style:{fontWeight:m.Z.fontWeight.medium,marginTop:0},children:s}),(0,M.jsx)("div",{style:{color:e.mediumTextColor,marginTop:4},children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})}),(0,M.jsx)(v.Z,{style:{marginTop:12},onClick:T,isLarge:!0,children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"})})]})]})}function P(e){let{promoCodeStore:t,promoErrorStore:n}=e;const r=(0,c.useIntl)(),l=(0,a.Fg)(),d=(0,i.O7)(),m=(0,s.useCallback)((()=>async function(e,t,n,s){const i=n.state.inputValue;if(i){const o=await p.getPromoCode(e,{code:i});"failed"!==o.type&&o.data.promo?y.Z.state.open&&(await y.Z.state.handlePromoCode(n.state.inputValue),I()):s.setState(t.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:i}))}}(d,r,t,n)),[d,r,t,n]),g=(0,s.useCallback)((e=>function(e,t,n){t.setState({...t.state,inputValue:e.target.value.toUpperCase()}),n.setState(void 0)}(e,t,n)),[t,n]),f=(0,o.VK)((()=>t.state.inputValue),[t]),h=(0,o.VK)((()=>n.state),[n]),S=r.formatMessage({defaultMessage:"Enter code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return(0,M.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,M.jsx)("div",{style:{width:18,flexShrink:0,color:l.mediumTextColor},children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})}),(0,M.jsxs)("div",{style:{flexGrow:1},children:[(0,M.jsx)("div",{style:{color:l.mediumTextColor},children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})}),(0,M.jsxs)("div",{style:{display:"flex",marginTop:12},children:[(0,M.jsx)(x.Z,{style:{marginRight:8,height:32},value:f,onChange:g,onSubmit:m,placeholder:S}),(0,M.jsx)(v.Z,{onClick:m,disabled:!f,isLarge:!0,children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"})})]}),(0,M.jsx)("div",{style:{color:u.ZP.red,fontSize:12,marginTop:4,marginLeft:8,height:20},children:h})]})]})}function F(e){let{promoCodeStore:t,promoErrorStore:n}=e;return(0,M.jsxs)("div",{style:{fontSize:14},children:[(0,M.jsx)("div",{children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"<p>Unfortunately you are not eligible for a free Education plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Education Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Free Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:(0,M.jsx)("br",{}),p:e=>(0,M.jsx)("p",{style:{marginTop:0,marginBottom:8},children:1===e.length?e[0]:s.Children.toArray(e)}),pricinglink:e=>(0,M.jsx)(b.Z,{external:!0,href:d.AR.pricing,children:e})}})}),(0,M.jsx)(Z,{}),(0,M.jsx)(P,{promoCodeStore:t,promoErrorStore:n}),(0,M.jsx)(k,{})]})}},306202:(e,t,n)=>{n.d(t,{Z:()=>d});n(667294);var s=n(800480),i=n(531701),o=n(164921),a=n(828992),r=n(158297),l=n(785893);const d=function(e){let{onClick:t,disabled:n,title:s}=e;return(0,l.jsx)(a.Z,{title:(0,l.jsx)(c,{onClick:t,disabled:n,title:s})})};function c(e){let{onClick:t,disabled:n,title:a}=e;const d=(0,s.O7)(),{isMobile:c}=d.device,u={width:"100%",color:i.ZP.blue};return c?(0,l.jsx)(o.Z,{onClick:t,mobileFeedback:!0,disabled:n,style:u,children:a}):(0,l.jsx)(r.Z,{onClick:t,disabled:n,style:{width:"100%",maxWidth:300,display:"flex",margin:"auto"},children:a})}},100719:(e,t,n)=>{n.d(t,{Z:()=>d});n(667294);var s=n(800480),i=n(724405),o=n(98742),a=n(374194),r=n(785893);const l={flexGrow:1,flexShrink:1,flexBasis:60,minWidth:60,width:"auto",lineHeight:"20px"};const d=function(e){let{readOnly:t,onClick:n,style:o,tokens:a,value:l,onRemoveLastToken:d,onChange:p,onSubmit:g,onBlur:f,overflowHorizontally:h,focus:y,type:x,placeholder:S,...v}=e;const b=(0,i.Fg)(),M=(0,s.O7)(),{device:j}=M;return(0,r.jsxs)("div",{className:t?void 0:"notion-focusable-within",onClick:n,style:j.isMobile?u(b,o):c(b,o),children:[h?(0,r.jsx)("div",{style:{display:"flex",flexShrink:0},children:a}):a,(0,r.jsx)(m,{tokens:a,value:l,onRemoveLastToken:d,onChange:p,onSubmit:g,onBlur:f,focus:y,readOnly:t,type:x,placeholder:S,inputStyle:v.inputStyle})]})};function c(e,t){return{display:"flex",flexWrap:"wrap",alignItems:"flex-start",minHeight:32,boxShadow:e.inputBoxShadow,background:e.inputBackground,borderRadius:4,fontSize:14,cursor:"text",overflow:"hidden",padding:"7px 9px 0px",...t}}function u(e,t){return{...c(e,t),fontSize:14,padding:"7px 10px 0"}}function m(e){let{tokens:t,value:n,onRemoveLastToken:i,onChange:d,onSubmit:c,onBlur:u,focus:m,readOnly:p,type:g,placeholder:f,...h}=e;const y=(0,s.O7)(),{device:x}=y,S=0===t.length;return(0,r.jsx)(a.Z,{format:a.B.Transparent,...(0,o.Z)({onKeyDown:e=>function(e,t,n){"Backspace"===e.key&&0===t.length&&n()}(e,n,i)},{onChange:d}),value:n,onSubmit:c,onBlur:u,focus:m,style:{...l,margin:x.isMobile?"0 8px 8px 0":"0 6px 6px 0"},readOnly:p,inputStyle:{height:18,...h.inputStyle},size:1,type:g,placeholder:S?f:"",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1})}},706175:(e,t,n)=>{n.d(t,{W:()=>l,Z:()=>c});var s=n(667294),i=n(724405),o=n(401898),a=n(555797),r=n(785893);const l={"en-US":"en","ja-JP":"ja","ko-KR":"ko","fr-FR":"fr","de-DE":"de","pt-BR":"pt-BR","es-ES":"es-ES"};function d(e){return e.src?(0,r.jsx)("img",{style:e.style,src:e.src}):null}const c=s.forwardRef((function(e,t){const n=(0,i.Fg)(),l=s.useRef(e);l.current=e,s.useEffect((()=>{const t=document.createElement("script");t.src="https://player.vimeo.com/api/player.js",document.body.appendChild(t);const n=window.Vimeo;if(!n)return()=>{};const s=document.getElementById(e.src),i=new n.Player(s);return i?(i.on("play",(e=>{var t,n;null===(t=(n=l.current).onPlay)||void 0===t||t.call(n,e)})),i.on("pause",(e=>{var t,n;null===(t=(n=l.current).onPause)||void 0===t||t.call(n,e)})),i.on("ended",(e=>{var t,n;null===(t=(n=l.current).onEnd)||void 0===t||t.call(n,e)})),()=>{i.off("play"),i.off("pause"),i.off("ended")}):()=>{}}),[e.src,l.current.src]);const c=function(e,t){const n=(0,o.qP)(t).flatMap((e=>{let[t,n]=e;return`${t}=${n}`})).join("&");return`${e}&${n}`}(l.current.src,{texttrack:l.current.defaultTextTrack,playsinline:!1,...l.current.options}),u={position:"absolute",top:0,left:0,width:"100%",height:"100%",borderStyle:"solid",borderColor:n.tableDividerColor,borderWidth:"0 0 1px 0"};return(0,r.jsxs)(a.Z,{ratio:l.current.aspectRatioOverride??9/16,children:[(0,r.jsx)(d,{style:u,src:l.current.preloadThumbnailSrc}),(0,r.jsx)("iframe",{ref:t,id:l.current.src,className:l.current.className,allowFullScreen:!0,src:c,style:{...u,...l.current.style}})]})}))},400182:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Y});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(815145),l=n(841892),d=n(964275),c=n(726139),u=n(709291),m=n(137810),p=n(541432),g=n(247025),f=n(180951),h=n(253877),y=n(842875),x=n(719531),S=n(145953),v=n(421202),b=n(606287),M=n(307032),j=n(215828),C=n(27105),w=n(924990),k=n(433929),I=n(141433),T=n(119785),Z=n(709953),P=n(328014),F=n(210228);function _(e){const{environment:t,spaceViewStore:n,appParentStore:s}=e;let i;return F.createAndCommit({environment:t,userAction:"chartsLaunchModal.tryCharts",perform:e=>{i=function(e){const{environment:t,spaceViewStore:n,appParentStore:s,transaction:i}=e,o=s.getSpaceId(),a=Z.j4({environment:t,type:p.Ti.page,spaceId:o,format:{page_icon:"📊"},properties:{title:[[k.default.formatMessage(B.chartsPlayground)]]},inMemoryRecordCache:s.inMemoryRecordCache,transaction:i,useCrdt:(0,C.S9)("private")}),r=window.document.createElement("span");r.innerHTML=k.default.formatMessage(B.callout);const l=x.xR({node:r,window,stripText:!0,stripSurroundingWhitespace:!0,emojiData:w.Z.state}),d=Z.j4({environment:t,type:p.Ti.callout,spaceId:o,format:{page_icon:"💡",block_color:"default"},properties:{title:l},inMemoryRecordCache:s.inMemoryRecordCache,transaction:i,useCrdt:(0,C.S9)("private")});T.jG({childStore:d,parentStore:a,transaction:i});const c=Z.j4({environment:t,type:p.Ti.text,spaceId:o,inMemoryRecordCache:s.inMemoryRecordCache,transaction:i,useCrdt:(0,C.S9)("private")});T.jG({childStore:c,parentStore:a,transaction:i});const u=Z.j4({environment:t,type:p.Ti.columnList,spaceId:o,inMemoryRecordCache:s.inMemoryRecordCache,transaction:i,useCrdt:(0,C.S9)("private")});T.jG({childStore:u,parentStore:a,transaction:i});const m=Z.j4({environment:t,type:p.Ti.column,spaceId:o,inMemoryRecordCache:s.inMemoryRecordCache,transaction:i,useCrdt:(0,C.S9)("private")});T.jG({childStore:m,parentStore:u,transaction:i});const F=(0,j.ZP)(),_=(0,j.ZP)(),R=(0,j.ZP)(),D=(0,M.ZP)(),O=(0,M.ZP)(),L=(0,M.ZP)(),V=(0,M.ZP)(),E={[F]:{name:k.default.formatMessage(A.createdDate),type:"date"},[_]:{icon:"/icons/friends_gray.svg",name:k.default.formatMessage(A.team),type:"select",options:[{id:(0,M.ZP)(),color:"blue",value:k.default.formatMessage(A.education)},{id:(0,M.ZP)(),color:"yellow",value:k.default.formatMessage(A.marketing)},{id:(0,M.ZP)(),color:"green",value:k.default.formatMessage(A.collaboration)},{id:(0,M.ZP)(),color:"purple",value:k.default.formatMessage(A.people)},{id:(0,M.ZP)(),color:"orange",value:k.default.formatMessage(A.content)}]},[R]:{icon:"/icons/traffic-light_gray.svg",name:k.default.formatMessage(A.status),type:"status",groups:[{id:(0,M.ZP)(),name:"To-do",color:"gray",optionIds:[D]},{id:(0,M.ZP)(),name:"In progress",color:"blue",optionIds:[O,L]},{id:(0,M.ZP)(),name:"Complete",color:"green",optionIds:[V]}],options:[{id:D,value:k.default.formatMessage(A.notStarted)},{id:O,color:"yellow",value:k.default.formatMessage(A.atRisk)},{id:L,color:"blue",value:k.default.formatMessage(A.inProgress)},{id:V,color:"green",value:k.default.formatMessage(A.done)}]},title:{name:k.default.formatMessage(A.tasks),type:"title"}},N=Z.j4({environment:t,type:p.Ti.collectionView,spaceId:o,inMemoryRecordCache:s.inMemoryRecordCache,transaction:i,useCrdt:(0,C.S9)("private")}),U=function(e){const{spaceId:t,parentId:n,collectionSchema:s,createdDateId:i,teamSelectId:o,statusId:a}=e,r=function(e){const{createdDateId:t,teamSelectId:n,statusId:s,spaceId:i}=e,o=(0,y.r)(),a={type:"date",start_date:(0,h.BC)((0,h.Uu)(o).minus({days:4}))},r={type:"date",start_date:(0,h.BC)((0,h.Uu)(o).minus({days:3}))},l={type:"date",start_date:(0,h.BC)((0,h.Uu)(o).minus({days:2}))},d={type:"date",start_date:(0,h.BC)((0,h.Uu)(o).minus({days:1}))},c={type:"date",start_date:(0,h.BC)((0,h.Uu)(o))},u=[{[t]:(0,f.d7)(a),[n]:(0,f.O2)(k.default.formatMessage(A.education)),[s]:(0,f.Is)(k.default.formatMessage(A.notStarted)),title:[[k.default.formatMessage(A.title_0)]]},{[t]:(0,f.d7)(d),[n]:(0,f.O2)(k.default.formatMessage(A.education)),[s]:(0,f.Is)(k.default.formatMessage(A.notStarted)),title:[[k.default.formatMessage(A.title_1)]]},{[t]:(0,f.d7)(a),[n]:(0,f.O2)(k.default.formatMessage(A.education)),[s]:(0,f.Is)(k.default.formatMessage(A.notStarted)),title:[[k.default.formatMessage(A.title_2)]]},{[t]:(0,f.d7)(r),[n]:(0,f.O2)(k.default.formatMessage(A.education)),[s]:(0,f.Is)(k.default.formatMessage(A.atRisk)),title:[[k.default.formatMessage(A.title_3)]]},{[t]:(0,f.d7)(d),[n]:(0,f.O2)(k.default.formatMessage(A.education)),[s]:(0,f.Is)(k.default.formatMessage(A.atRisk)),title:[[k.default.formatMessage(A.title_4)]]},{[t]:(0,f.d7)(a),[n]:(0,f.O2)(k.default.formatMessage(A.collaboration)),[s]:(0,f.Is)(k.default.formatMessage(A.atRisk)),title:[[k.default.formatMessage(A.title_5)]]},{[t]:(0,f.d7)(a),[n]:(0,f.O2)(k.default.formatMessage(A.collaboration)),[s]:(0,f.Is)(k.default.formatMessage(A.atRisk)),title:[[k.default.formatMessage(A.title_6)]]},{[t]:(0,f.d7)(a),[n]:(0,f.O2)(k.default.formatMessage(A.marketing)),[s]:(0,f.Is)(k.default.formatMessage(A.inProgress)),title:[[k.default.formatMessage(A.title_7)]]},{[t]:(0,f.d7)(c),[n]:(0,f.O2)(k.default.formatMessage(A.education)),[s]:(0,f.Is)(k.default.formatMessage(A.inProgress)),title:[[k.default.formatMessage(A.title_8)]]},{[t]:(0,f.d7)(d),[n]:(0,f.O2)(k.default.formatMessage(A.education)),[s]:(0,f.Is)(k.default.formatMessage(A.inProgress)),title:[[k.default.formatMessage(A.title_9)]]},{[t]:(0,f.d7)(d),[n]:(0,f.O2)(k.default.formatMessage(A.education)),[s]:(0,f.Is)(k.default.formatMessage(A.inProgress)),title:[[k.default.formatMessage(A.title_10)]]},{[t]:(0,f.d7)(l),[n]:(0,f.O2)(k.default.formatMessage(A.people)),[s]:(0,f.Is)(k.default.formatMessage(A.inProgress)),title:[[k.default.formatMessage(A.title_11)]]},{[t]:(0,f.d7)(a),[n]:(0,f.O2)(k.default.formatMessage(A.marketing)),[s]:(0,f.Is)(k.default.formatMessage(A.inProgress)),title:[[k.default.formatMessage(A.title_12)]]},{[t]:(0,f.d7)(a),[n]:(0,f.O2)(k.default.formatMessage(A.education)),[s]:(0,f.Is)(k.default.formatMessage(A.inProgress)),title:[[k.default.formatMessage(A.title_13)]]},{[t]:(0,f.d7)(a),[n]:(0,f.O2)(k.default.formatMessage(A.marketing)),[s]:(0,f.Is)(k.default.formatMessage(A.inProgress)),title:[[k.default.formatMessage(A.title_14)]]},{[t]:(0,f.d7)(r),[n]:(0,f.O2)(k.default.formatMessage(A.marketing)),[s]:(0,f.Is)(k.default.formatMessage(A.done)),title:[[k.default.formatMessage(A.title_15)]]},{[t]:(0,f.d7)(r),[n]:(0,f.O2)(k.default.formatMessage(A.collaboration)),[s]:(0,f.Is)(k.default.formatMessage(A.done)),title:[[k.default.formatMessage(A.title_16)]]},{[t]:(0,f.d7)(a),[n]:(0,f.O2)(k.default.formatMessage(A.content)),[s]:(0,f.Is)(k.default.formatMessage(A.done)),title:[[k.default.formatMessage(A.title_17)]]},{[t]:(0,f.d7)(c),[n]:(0,f.O2)(k.default.formatMessage(A.content)),[s]:(0,f.Is)(k.default.formatMessage(A.done)),title:[[k.default.formatMessage(A.title_18)]]},{[t]:(0,f.d7)(c),[n]:(0,f.O2)(k.default.formatMessage(A.education)),[s]:(0,f.Is)(k.default.formatMessage(A.done)),title:[[k.default.formatMessage(A.title_19)]]}],m={};return u.forEach(((e,t)=>{const n=`item_${t}`;m[n]={value:{id:n,type:"page",parent_id:"collection",parent_table:"collection",alive:!0,space_id:i,version:0,properties:{...e}}}})),m}({spaceId:t,createdDateId:i,teamSelectId:o,statusId:a});return S.Ak.create({__version__:3,block:{root:{value:{id:"root",type:"collection_view",collection_id:"collection",format:{collection_pointer:{table:b.vF,id:"collection"}},view_ids:["view"],alive:!0,space_id:t,parent_id:n,parent_table:v.iU,version:0}},...r},collection_view:{view:{value:{id:"view",version:0,type:"chart",name:k.default.formatMessage(A.tasksByTeam),format:{collection_pointer:{table:b.vF,id:"collection"},chart_config:{type:"donut",dataConfig:{type:"groups_reducer",groupBy:{sort:{type:"manual"},type:"select",property:o,hideEmptyGroups:!0},aggregationConfig:{aggregation:{aggregator:"count"}}},chartFormat:{axisSort:g.hd.xAscending,colorTheme:"auto",hideLegend:!1,weightColorValue:!1,axisHideEmptyGroups:!0}},subitem_display_mode:"flattened",hide_linked_collection_name:!0,collection_view_icon:"/icons/chart-donut_gray.svg"},page_sort:[],parent_id:"root",parent_table:"block",alive:!0,space_id:t}}},collection:{collection:{value:{id:"collection",name:[[k.default.formatMessage(A.taskList)]],schema:s,format:{collection_page_properties:[{property:a,visible:!0},{property:i,visible:!0},{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0,space_id:t,version:0}}}})}({environment:t,spaceId:o,parentId:N.pointer.id,collectionSchema:E,createdDateId:F,teamSelectId:_,statusId:R}),{targetBlockStore:K}=I.ZI({environment:t,sourceBlockId:"root",targetBlockPointer:N.pointer,sourceBlockSubtree:U,targetRecordCache:N.inMemoryRecordCache,transaction:i,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:N.useCrdt()});if(T.jG({childStore:K,parentStore:m,transaction:i}),!N||!N.isDefined())return;const W=N.getCollectionPointer();if(!W)return;const z=Z.j4({environment:t,type:p.Ti.column,spaceId:o,inMemoryRecordCache:s.inMemoryRecordCache,transaction:i,useCrdt:(0,C.S9)("private")});T.jG({childStore:z,parentStore:u,transaction:i});const q=Z.j4({environment:t,type:p.Ti.collectionView,spaceId:o,inMemoryRecordCache:s.inMemoryRecordCache,transaction:i,useCrdt:(0,C.S9)("private")}),G=function(e){const{spaceId:t,parentId:n,collectionId:s,statusId:i}=e;return S.Ak.create({__version__:3,block:{root:{value:{id:"root",type:"collection_view",collection_id:"collection",format:{collection_pointer:{table:b.vF,id:s}},view_ids:["view"],alive:!0,space_id:t,parent_id:n,parent_table:v.iU,version:0}}},collection_view:{view:{value:{id:"view",version:0,type:"chart",name:k.default.formatMessage(A.tasksByStatus),format:{collection_pointer:{table:b.vF,id:s},chart_config:{type:"column",dataConfig:{type:"groups_reducer",groupBy:{sort:{type:"ascending"},type:"status",groupBy:"option",property:i,hideEmptyGroups:!0},aggregationConfig:{aggregation:{aggregator:"count"},seriesFormat:{displayType:"column"},stackOptions:void 0}},chartFormat:{axisSort:g.hd.xAscending,colorTheme:"auto",hideLegend:!0,weightColorValue:!1,axisHideEmptyGroups:!0}},subitem_display_mode:"flattened",hide_linked_collection_name:!0,collection_view_icon:"/icons/chart_gray.svg"},page_sort:[],parent_id:"root",parent_table:"block",alive:!0,space_id:t}}}})}({environment:t,spaceId:o,parentId:q.pointer.id,collectionId:W.id,statusId:R}),{targetBlockStore:H}=I.ZI({environment:t,sourceBlockId:"root",targetBlockPointer:q.pointer,sourceBlockSubtree:G,targetRecordCache:q.inMemoryRecordCache,transaction:i,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:q.useCrdt()});T.jG({childStore:H,parentStore:z,transaction:i});const $=Z.j4({environment:t,type:p.Ti.text,spaceId:o,inMemoryRecordCache:s.inMemoryRecordCache,transaction:i,useCrdt:(0,C.S9)("private")});T.jG({childStore:$,parentStore:a,transaction:i});const Y=Z.j4({environment:t,type:p.Ti.collectionView,spaceId:o,inMemoryRecordCache:s.inMemoryRecordCache,transaction:i,useCrdt:(0,C.S9)("private")}),Q=function(e){const{spaceId:t,parentId:n,collectionId:s,createdDateId:i}=e;return S.Ak.create({__version__:3,block:{root:{value:{id:"root",type:"collection_view",collection_id:"collection",format:{collection_pointer:{table:b.vF,id:s}},view_ids:["view"],alive:!0,space_id:t,parent_id:n,parent_table:v.iU,version:0}}},collection_view:{view:{value:{id:"view",version:0,type:"chart",name:k.default.formatMessage(A.newTasksCreated),format:{collection_pointer:{table:b.vF,id:s},chart_config:{type:"line",dataConfig:{type:"groups_reducer",groupBy:{sort:{type:"ascending"},type:"date",groupBy:"day",property:i},aggregationConfig:{aggregation:{aggregator:"count"},seriesFormat:{displayType:"line"},stackOptions:void 0}},chartFormat:{axisSort:g.hd.xAscending,axisHideEmptyGroups:!1}},subitem_display_mode:"flattened",hide_linked_collection_name:!0,collection_view_icon:"/icons/chart-line_gray.svg"},page_sort:[],parent_id:"root",parent_table:"block",alive:!0,space_id:t}}}})}({environment:t,spaceId:o,parentId:Y.pointer.id,collectionId:W.id,createdDateId:F}),{targetBlockStore:J}=I.ZI({environment:t,sourceBlockId:"root",targetBlockPointer:Y.pointer,sourceBlockSubtree:Q,targetRecordCache:Y.inMemoryRecordCache,transaction:i,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:q.useCrdt()});T.jG({childStore:J,parentStore:a,transaction:i});const X=Z.j4({environment:t,type:p.Ti.text,spaceId:o,inMemoryRecordCache:s.inMemoryRecordCache,transaction:i,useCrdt:(0,C.S9)("private")});T.jG({childStore:X,parentStore:a,transaction:i});const ee=Z.j4({environment:t,type:p.Ti.collectionView,spaceId:o,inMemoryRecordCache:s.inMemoryRecordCache,transaction:i,useCrdt:(0,C.S9)("private")}),te=function(e){const{spaceId:t,parentId:n,collectionId:s,createdDateId:i,statusId:o,teamSelectId:a}=e;return S.Ak.create({__version__:3,block:{root:{value:{id:"root",type:"collection_view",collection_id:"collection",format:{collection_pointer:{table:b.vF,id:s}},view_ids:["view"],alive:!0,space_id:t,parent_id:n,parent_table:v.iU,version:0}}},collection_view:{view:{value:{id:"view",version:0,type:"table",name:k.default.formatMessage(A.taskList),format:{collection_pointer:{table:b.vF,id:s},hide_linked_collection_name:!0,table_frozen_column_index:-1,table_wrap:!0,table_properties:[{width:279,visible:!0,property:"title"},{width:127,visible:!0,property:o},{width:131,visible:!0,property:i},{width:125,visible:!0,property:a}]},page_sort:[],query2:{sort:[{property:o,direction:"ascending"}]},parent_id:"root",parent_table:"block",alive:!0,space_id:t}}}})}({environment:t,spaceId:o,parentId:ee.pointer.id,collectionId:W.id,createdDateId:F,teamSelectId:_,statusId:R}),{targetBlockStore:ne}=I.ZI({environment:t,sourceBlockId:"root",targetBlockPointer:ee.pointer,sourceBlockSubtree:te,targetRecordCache:ee.inMemoryRecordCache,transaction:i,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:q.useCrdt()});return T.jG({childStore:ne,parentStore:a,transaction:i}),P.Hj({environment:t,spaceStore:s,spaceViewStore:n,pageStore:a,isPrivate:!0,transaction:i,location:{type:"prepend"}}),a}({environment:t,spaceViewStore:n,appParentStore:s,transaction:e})}}),i}const A=(0,u.defineMessages)({education:{defaultMessage:"Education",id:"charts.playgroundPage.teamSelect.education"},marketing:{defaultMessage:"Marketing",id:"charts.playgroundPage.teamSelect.marketing"},collaboration:{defaultMessage:"Collaboration",id:"charts.playgroundPage.teamSelect.collaboration"},people:{defaultMessage:"People",id:"charts.playgroundPage.teamSelect.people"},content:{defaultMessage:"Content",id:"charts.playgroundPage.teamSelect.content"},notStarted:{defaultMessage:"Not started",id:"charts.playgroundPage.status.notStarted"},atRisk:{defaultMessage:"At risk",id:"charts.playgroundPage.status.atRisk"},inProgress:{defaultMessage:"In progress",id:"charts.playgroundPage.status.inProgress"},done:{defaultMessage:"Done",id:"charts.playgroundPage.status.done"},tasks:{defaultMessage:"Tasks",id:"charts.playgroundPage.collectionSchema.tasks"},status:{defaultMessage:"Status",id:"charts.playgroundPage.collectionSchema.status"},createdDate:{defaultMessage:"Created date",id:"charts.playgroundPage.collectionSchema.createdDate"},team:{defaultMessage:"Team",id:"charts.playgroundPage.collectionSchema.team"},taskList:{defaultMessage:"Task list",id:"charts.playgroundPage.collection.taskList"},tasksByTeam:{defaultMessage:"Tasks by team",id:"charts.playgroundPage.collection.tasksByTeam"},tasksByStatus:{defaultMessage:"Tasks by status",id:"charts.playgroundPage.collection.tasksByStatus"},newTasksCreated:{defaultMessage:"New tasks created",id:"charts.playgroundPage.collection.newTasksCreated"},title_0:{defaultMessage:"Review and update training materials",id:"charts.playgroundPage.title_0"},title_1:{defaultMessage:"Update website content",id:"charts.playgroundPage.title_1"},title_2:{defaultMessage:"Update help center content",id:"charts.playgroundPage.title_2"},title_3:{defaultMessage:"Review team feedback",id:"charts.playgroundPage.title_3"},title_4:{defaultMessage:"Update project plan",id:"charts.playgroundPage.title_4"},title_5:{defaultMessage:"Conduct market research",id:"charts.playgroundPage.title_5"},title_6:{defaultMessage:"Review budget report",id:"charts.playgroundPage.title_6"},title_7:{defaultMessage:"Develop new marketing strategy",id:"charts.playgroundPage.title_7"},title_8:{defaultMessage:"Create content for social media",id:"charts.playgroundPage.title_8"},title_9:{defaultMessage:"Plan team building activity",id:"charts.playgroundPage.title_9"},title_10:{defaultMessage:"Analyze survey results",id:"charts.playgroundPage.title_10"},title_11:{defaultMessage:"Plan social media posts",id:"charts.playgroundPage.title_11"},title_12:{defaultMessage:"Prepare presentation slides",id:"charts.playgroundPage.title_12"},title_13:{defaultMessage:"Draft client email",id:"charts.playgroundPage.title_13"},title_14:{defaultMessage:"Update project proposal",id:"charts.playgroundPage.title_14"},title_15:{defaultMessage:"Conduct market research",id:"charts.playgroundPage.title_15"},title_16:{defaultMessage:"Prepare for client meeting",id:"charts.playgroundPage.title_16"},title_17:{defaultMessage:"Analyze survey results",id:"charts.playgroundPage.title_17"},title_18:{defaultMessage:"Organize files",id:"charts.playgroundPage.title_18"},title_19:{defaultMessage:"Schedule team meeting",id:"charts.playgroundPage.title_19"}}),B=(0,u.defineMessages)({chartsPlayground:{defaultMessage:"Charts playground",id:"charts.playgroundPage.title"},callout:{defaultMessage:"Try it yourself by typing '<code>'/chart'</code>' anywhere!",id:"charts.playgroundPage.callout"}});var R=n(412714),D=n(321862),O=n(237181),L=n(199726),V=n(706210),E=n(65037),N=n(80444),U=n(915560),K=n(897122),W=n(164921),z=n(661519),q=n(584076),G=n(164369),H=n(785893);const $="charts_launch_modal";const Y=function(e){const t=(0,i.O7)(),n=(0,a.yK)((e=>({container:{maxWidth:480,padding:24},image:{height:240,width:480,marginLeft:-24},closeButton:{position:"absolute",top:12,right:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:22,height:22},closeButtonHovered:{background:e.buttonPressedBackground},closeIcon:{width:14,fill:e.lightTextColor},titleContainer:{padding:"0 0 10px 0",display:"inline-block"},title:{display:"inline-block",fontWeight:m.Z.fontWeight.semibold,fontSize:28,lineHeight:"30px",maxWidth:280,textAlign:"left"},betaBadge:{display:"inline-block",marginLeft:"10px",position:"relative",top:-5},captionContainer:{width:"100%"},caption:{maxWidth:280,textAlign:"left",padding:"0 0 25px 0"},divider:{backgroundColor:e.tableLightDividerColor,opacity:.5,marginLeft:-24,width:"calc(100% + 48px)"},footerContainer:{margin:"20px 0px 0px 0px",display:"inline-block",width:"100%"},learnMoreLink:{color:e.lightTextColor,fontSize:14,display:"inline-block",margin:"0 auto",position:"relative",top:5},learnMoreLinkHoveredPressed:{padding:"2px 7px 3px 9px",borderRadius:4,margin:"0 0 0 -9px"},externalLinkIcon:{width:16,position:"relative",top:3,display:"inline-block",marginLeft:2},footerRight:{float:"right"},skipLink:{display:"inline-block",fontSize:14,color:e.lightTextColor,padding:"3px 9px",borderRadius:4,marginRight:10},tryChartsButton:{display:"inline-block",fontSize:14,margin:"0 auto",gap:4,padding:"8px 12px"}})),[]),p=(0,a.Fg)(),g=(0,o.VK)((()=>{const{currentUserSettingsStore:e}=N.default.state,t=null==e?void 0:e.getSettings();return null==t?void 0:t.charts_launch_modal_phase}),[]);(0,s.useEffect)((()=>{L.GS(t,$)}),[t,g]);const f=(0,s.useCallback)((()=>{const{currentUserSettingsStore:e}=N.default.state;e&&(O.f1(t,{phase:"dismissed_beta_modal",transactionUserAction:"ChartsBetaLaunchModal.debug.clickCancel",userSettingsStore:e}),L.GS(t,$))}),[t]),h=(0,s.useCallback)((()=>{f(),V.bl(t,{callout_key:$,placement_key:"Modal",dismiss_type:"modal_dismiss_clicked"})}),[t,f]),y=(0,s.useCallback)((()=>{f(),V.bl(t,{callout_key:$,placement_key:"Modal",dismiss_type:"modal_background_clicked"})}),[t,f]),x=(0,s.useCallback)((()=>{const{currentUserSettingsStore:e}=N.default.state;if(!e)return;R.D({environment:t,url:"https://notion.notion.site/Charts-Beta-Overview-Doc-80335abc15304d22b7b42b09baf5ea91"}),V.Ev(t,{callout_key:$,placement_key:"Modal",engagement_type:"modal_learn_more_clicked"}),O.f1(t,{phase:"clicked_beta_modal_engagement",transactionUserAction:"ChartsBetaLaunchModal.debug.clickLearnMore",userSettingsStore:e}),L.GS(t,$)}),[t]),S=(0,s.useCallback)((()=>{const{currentUserSettingsStore:e,currentSpaceViewStore:n,currentSpaceStore:s}=N.default.state;if(!e||!n||!s)return;const i=_({environment:t,spaceViewStore:n,appParentStore:s});V.Ev(t,{callout_key:$,placement_key:"Modal",engagement_type:"modal_try_feature_clicked",playground_page_id:null==i?void 0:i.pointer.id}),O.f1(t,{phase:"clicked_beta_modal_engagement",transactionUserAction:"ChartsBetaLaunchModal.debug.clickTryCharts",userSettingsStore:e}),i&&(L.GS(t,$),D.r({environment:t,store:i,pageVisitSource:r.tY.ChartsLaunchModal,openInCenterPeek:!0}))}),[t]);return t.device.isMobile?null:(0,H.jsx)(E.Z,{calloutKey:$,desktopRenderInner:()=>(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(W.Z,{onClick:h,style:n.closeButton,hoveredStyle:n.closeButtonHovered,children:(0,d.D)(n.closeIcon)}),(0,H.jsx)("img",{src:"dark"===p.mode?l.Z.images.charts.chartsLaunchModalDarkPng:l.Z.images.charts.chartsLaunchModalPng,style:n.image}),(0,H.jsxs)("div",{style:n.titleContainer,children:[(0,H.jsx)(G.Z,{isMultiline:!0,style:n.title,children:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Introducing Charts",id:"chartsLaunchModal.title"})}),(0,H.jsx)(U.Z,{style:n.betaBadge})]}),(0,H.jsx)("div",{style:n.captionContainer,children:(0,H.jsx)(G.Z,{isSecondaryColor:!0,isMultiline:!0,style:n.caption,children:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Create beautiful charts from your database in just a few clicks.",id:"chartsLaunchModal.caption"})})}),(0,H.jsx)(z.Z,{size:1,style:n.divider}),(0,H.jsxs)("div",{style:n.footerContainer,children:[(0,H.jsxs)(q.Z,{onClick:x,style:n.learnMoreLink,hoveredStyle:n.learnMoreLinkHoveredPressed,external:!0,children:[(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Learn more",id:"chartLaunchModal.learnMore"}),(0,c.K)(n.externalLinkIcon)]}),(0,H.jsxs)("div",{style:n.footerRight,children:[(0,H.jsx)(q.Z,{onClick:h,style:n.skipLink,external:!0,children:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Skip",id:"chartsLaunchModal.skip"})}),(0,H.jsx)(K.h,{styles:n.tryChartsButton,onClick:S,children:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Try Charts",id:"chartsLaunchModal.tryCharts"})})]})]})]}),desktopInnerStyle:n.container,desktopOnDismiss:y,phoneRenderInner:()=>null})}},750187:(e,t,n)=>{n.d(t,{c:()=>B,Z:()=>R});n(21703);var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(399036),l=n(653965),d=n(401898),c=n(619584),u=n(582356),m=n(727714),p=n(709291),g=n(307032),f=n(800893),h=n(863296),y=n(95477),x=n(319385),S=n(762878),v=n(13555),b=n(785893);const M=(0,p.defineMessages)({linkCopied:{defaultMessage:"Link copied. Share it with others who may find this useful.",id:"ai.gtmFavoriteActions.linkCopied"},share:{defaultMessage:"Share as AI favorite",id:"ai.gtmFavoriteActions.share"},add:{defaultMessage:"Add to AI favorites",id:"ai.gtmFavoriteActions.add"}});function j(e){const{blockId:t}=e,n=(0,i.O7)(),o=(0,p.useIntl)(),a=(0,s.useCallback)((()=>{(0,S.importGtmFavorite)({environment:n,importArgs:{name:"aiGtmFavoriteImport",blockId:t}})}),[t,n]),r=(0,s.useCallback)((()=>{const e=`${y.default.domainBaseUrl}/ai-gtm/${(0,g.cj)(t)}`;f.RD({environment:n,stringValue:e,copiedMessage:M.linkCopied})}),[t,n]);return(0,b.jsxs)("div",{style:{marginTop:12,marginBottom:12},children:[(0,b.jsx)(h.Z,{onClick:r,icon:m.N,children:o.formatMessage(M.share)}),n.currentUser.isLoggedIn()&&(0,b.jsx)(h.Z,{onClick:a,style:{marginLeft:12},icon:u.l,children:o.formatMessage(M.add)})]})}var C=n(128651),w=n(135314),k=n(846010),I=n(334017),T=n(850478),Z=n(487167),P=n(841883),F=n(912867),_=n(65091);const A=5,B=4;function R(e){const{collectionStore:t,schema:n,store:u,format:m,propertyIds:p,propertyGroupId:g,variant:f,customization:h,pagePropertiesStore:y}=e,S=(0,i.O7)(),[M,R]=(0,w.e)(),D=(0,o.qz)(void 0,C.Z),O=(0,a.yK)((e=>({pageProperties:{width:"100%",fontSize:14},dragHandle:{marginLeft:-(T.C$+10),marginRight:6},hidePropertiesButton:{margin:"0 0 10px"},showMoreButton:{margin:0},addPropertyButton:{margin:"4px 0 0"},moreProperties:{border:`1px solid ${"dark"===e.mode?e.accentColors.gray[300]:e.accentColors.gray[75]}`,borderRadius:4,padding:"8px 6px"}})),[]),L=(0,o.VK)((()=>"pinned"===f||Boolean(u.isAssociatedCollectionAPageTree())),[u,f]),V=(0,k.y)();let E=(0,Z.nd)({store:u,format:m,schema:n,collectionStore:t,propertyIds:p,propertyGroupId:V?g:void 0});const N=(0,s.useMemo)((()=>{const e={};for(const t of E)e[t.property]=t;return e}),[E]);h&&(E=function(e,t){const{hideEmptyProperties:n,neverShowEmptyPropertiesIfMoreThanNProperties:s,neverShowNotionSystemProperties:i,sortNonEmptyPropertiesFirst:o}=t;n&&(e=e.map((e=>({...e,visibility:e.hasValue?e.visibility:"hide"}))));i&&(e=e.filter((e=>!(r.S4(e.property)||"show"!==e.visibility&&e.property.startsWith("notion://")))));void 0!==s&&e.length>s&&(e=e.filter((e=>e.hasValue)));o&&(e=l.MR(e,(e=>!e.hasValue)));return e}(E,h));const U=(0,o.VK)((()=>y.state.forceShowProperties),[y]),[K,W]=(0,s.useMemo)((()=>{if((0,c.z4)(f))return l.uK(E,(e=>{var t;return!!(null===(t=n[e.property])||void 0===t?void 0:t.type)&&function(e){if("section"===e.visibility)return!1;if("hide"===e.visibility)return!1;if("hide_if_empty"===e.visibility&&!e.hasValue)return!1;return!0}(e)}));if(V&&"pinned"===f){if(!p)return[[],[]];const e=p.map((e=>{var t;const s=n[e];if(s)return{property:e,visibility:"show",hasValue:(null===(t=N[e])||void 0===t?void 0:t.hasValue)??!1,name:s.name}})).filter(d.$K);return[e.slice(0,B),e.slice(B)]}throw new Error("Pinned variant is only supported in page layouts")}),[V,E,N,p,n,f]),z=function(e){const t=(0,o.VK)((()=>{if(!x.default.checkGate({gateName:"ai_favorites"}))return!1;const t=(0,v.OF)();return!!t&&t.spaceId===e.getSpaceId()&&t.collectionId===e.id}),[e]);return t}(t),q=K.concat(W),[G,H]=(0,s.useState)({open:!1,query:"",hide:null==h?void 0:h.hideSearch}),{paddingLeft:$,paddingRight:Y,width:Q}=e,J=(0,o.VK)((()=>I.Z.state.isOpen??!1),[]),X=Math.min(A,K.length)*F.Uv,ee="pinned"!==f&&R<X;let te;return null!=h&&h.dontRenderIfNoPropertiesDefaultShown&&0===K.length?null:(te=!L||S.device.isMobile||ee?(0,b.jsxs)("div",{style:null!=h&&h.assistantEditsPadding?{}:{paddingBottom:8},children:[(0,b.jsx)(P.Z,{...e,showHiddenProperties:U,mergedProperties:L?q:E,propertySearchState:G}),(0,b.jsx)(_.ZP,{...e,mergedProperties:L?q:E,propertySearchState:G,setPropertySearchState:H})]}):(0,b.jsx)(F.ZP,{...e,rowLength:A,compactProperties:K,hiddenProperties:W,variant:f}),(0,b.jsx)("div",{style:O.pageProperties,onMouseEnter:()=>{D.setState({...D.state,mouseEntered:!0})},onMouseLeave:()=>{D.setState({...D.state,mouseEntered:!1})},ref:M,children:(0,b.jsxs)("div",{style:{width:Q,maxWidth:"100%",padding:L?"pinned"===f?`0 0 ${J?0:"10px"} 0`:"10px 0":null!=h&&h.assistantEditsPadding?void 0:"16px 0 8px 0",margin:"pinned"===f?`0 auto ${J?0:"20px"} auto`:"0 auto",...$?{paddingLeft:$}:{},...Y?{paddingRight:Y}:{}},children:[te,z&&(0,b.jsx)(j,{blockId:u.id})]})}))}},554985:(e,t,n)=>{n.d(t,{u:()=>r});var s=n(800480),i=n(559054),o=n(401898),a=n(454642);function r(e){let{spaceId:t}=e;const n=(0,s.O7)(),[{status:r,error:l,value:d}]=(0,i.r5)((async()=>{if(!t)return{overrides:{},organizationInfo:void 0,isOrganizationOwner:!1};const e=await a.getOrganizationSettingsOverrides(n,{spaceId:t});if("success"===e.type)return e.data;if("failed"===e.type)throw e.error;return(0,o.t1)(e)}),[n,t]);return{organizationOverrides:(null==d?void 0:d.overrides)??{},organizationInfo:null==d?void 0:d.organizationInfo,isOrganizationOwner:null==d?void 0:d.isOrganizationOwner,loading:"pending"===r||"idle"===r,error:l}}},449150:(e,t,n)=>{n.d(t,{IH:()=>f,JJ:()=>g,VJ:()=>y,bS:()=>m,eA:()=>h,tM:()=>x,yE:()=>p});var s=n(800480),i=n(886628),o=n(559054),a=n(647425),r=n(454642),l=n(547307),d=n(88893),c=n(288280),u=n(217242);function m(e){let{spaceStore:t,members:n}=e;const i=f({spaceStore:t}),a=(0,s.O7)(),d=t.id,[c]=(0,o.r5)((async()=>{if(!i)return;const e=await r.getRecentlyRemovedUsers(a,{spaceId:d});if("failed"===e.type)throw l.showError(e),e;return e.data.recentlyRemovedMembers}),[d,a,i,n]);return c.value}function p(e){let{spaceStore:t,subscriptionData:n}=e;const i=g({spaceStore:t,subscriptionData:n}),a=(0,s.O7)();(0,o.r5)((async()=>{if(!i)return;const e=await r.getRecoverableSpaceUserContent(a,{spaceId:t.id});if("failed"===e.type)throw e;const n=e.data.recentSpaceRecoverPages;return u.Z.setState({...u.Z.state,recentRecoverableUsers:n}),n}),[t,a,i])}function g(e){let{spaceStore:t,subscriptionData:n}=e;return(0,i.VK)((()=>t.canAdmin()&&a.wP(n.subscriptionTier)),[n,t])}function f(e){let{spaceStore:t}=e;return(0,i.VK)((()=>t.canAdmin()),[t])}function h(e){let{spaceStore:t}=e;return(0,i.VK)((()=>t.canEditMembership()),[t])}function y(){const e=(0,s.O7)();return(0,i.VK)((()=>{const t=c.subscriptionDataStoreInstance.state,n=Boolean(t&&d.YK(t));return d.qF(e)&&n}),[e])}function x(e){let{spaceStore:t}=e;const n=(0,s.O7)();return(0,i.VK)((()=>t.canEditMembership()&&d.qF(n)),[n,t])}},217242:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(749085);class i extends s.default{getInitialState(){return{recentRecoverableUsers:[],searchQuery:void 0}}}const o=new i},769931:(e,t,n)=>{n.r(t),n.d(t,{default:()=>F});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(356666),l=n(745238),d=n(785893);const c=(0,l.IU)("mobileQuickCaptureMore",{viewBox:"0 0 14 3",svg:(0,d.jsx)("path",{d:"M1.86621 3.00684C1.59733 3.00684 1.35352 2.94303 1.13477 2.81543C0.916016 2.68327 0.74056 2.50781 0.608398 2.28906C0.480794 2.07031 0.416992 1.82878 0.416992 1.56445C0.416992 1.29557 0.480794 1.05176 0.608398 0.833008C0.74056 0.614258 0.916016 0.441081 1.13477 0.313477C1.35352 0.181315 1.59733 0.115234 1.86621 0.115234C2.13053 0.115234 2.37207 0.181315 2.59082 0.313477C2.80957 0.441081 2.98275 0.614258 3.11035 0.833008C3.24251 1.05176 3.30859 1.29557 3.30859 1.56445C3.30859 1.82878 3.24251 2.07031 3.11035 2.28906C2.98275 2.50781 2.80957 2.68327 2.59082 2.81543C2.37207 2.94303 2.13053 3.00684 1.86621 3.00684ZM6.99316 3.00684C6.72884 3.00684 6.4873 2.94303 6.26855 2.81543C6.0498 2.68327 5.87435 2.50781 5.74219 2.28906C5.61458 2.07031 5.55078 1.82878 5.55078 1.56445C5.55078 1.29557 5.61458 1.05176 5.74219 0.833008C5.87435 0.614258 6.0498 0.441081 6.26855 0.313477C6.4873 0.181315 6.72884 0.115234 6.99316 0.115234C7.25749 0.115234 7.49902 0.181315 7.71777 0.313477C7.94108 0.441081 8.11654 0.614258 8.24414 0.833008C8.3763 1.05176 8.44238 1.29557 8.44238 1.56445C8.44238 1.82878 8.3763 2.07031 8.24414 2.28906C8.11654 2.50781 7.94108 2.68327 7.71777 2.81543C7.49902 2.94303 7.25749 3.00684 6.99316 3.00684ZM12.127 3.00684C11.8581 3.00684 11.6143 2.94303 11.3955 2.81543C11.1768 2.68327 11.0013 2.50781 10.8691 2.28906C10.7415 2.07031 10.6777 1.82878 10.6777 1.56445C10.6777 1.29557 10.7415 1.05176 10.8691 0.833008C11.0013 0.614258 11.1768 0.441081 11.3955 0.313477C11.6143 0.181315 11.8581 0.115234 12.127 0.115234C12.3913 0.115234 12.6328 0.181315 12.8516 0.313477C13.0703 0.441081 13.2458 0.614258 13.3779 0.833008C13.5101 1.05176 13.5762 1.29557 13.5762 1.56445C13.5762 1.82878 13.5101 2.07031 13.3779 2.28906C13.2458 2.50781 13.0703 2.68327 12.8516 2.81543C12.6328 2.94303 12.3913 3.00684 12.127 3.00684Z"})});var u=n(830681),m=n(709291),p=n(436610),g=n(524677),f=n(296994),h=n(843250),y=n(98742),x=n(635328),S=n(825464),v=n(80444),b=n(424042),M=n(21884),j=n(164921),C=n(231945),w=n(526388),k=n(828451),I=n(481415),T=n(971424);function Z(e){let{originRef:t}=e;return(0,d.jsx)(k.P,{calloutId:"wiki_promo",children:(0,d.jsx)(I.U,{origin:t,placementToOrigin:"bottom",header:"Upgrade your existing wikis",content:"Look for the Turn into wiki action here",onCloseClick:()=>{M.E.reset()},pointerPosition:"98%",pointerLength:24,pointerOffset:-3,style:{width:T.G5}})})}var P=n(42543);const F=function(e){let{buttonPopupStore:t,store:n,shouldShowAddTo:a,styling:r}=e;const l=(0,i.O7)(),{device:c}=l,[u,m]=(0,s.useState)(void 0),h=(0,s.useRef)(null),y=(0,s.useCallback)((()=>{M.E.reset(),g.ZH({debug:{userAction:"TopbarMoreButton.handleClick"},environment:l});const e=h.current;e&&m(e.getBoundingClientRect()),p.kq(l)}),[h,l]),S=(0,o.VK)((()=>M.E.state.showConvertTooltip),[]),j=(0,o.VK)((()=>{var e;return Boolean(null===(e=b.Z.state.preferences)||void 0===e?void 0:e.isUnifiedTitleBarEnabled)}),[]);return(0,d.jsxs)(d.Fragment,{children:[S?(0,d.jsx)(Z,{originRef:h}):null,(0,d.jsx)(C.ZP,{popupType:c.isMobile?C.Z4.SlideUp:C.Z4.Popup,buttonPopupStore:t,renderOrigin:e=>(0,d.jsx)(B,{ref:h,buttonPopupEvents:e,styling:r}),onClick:y,render:()=>(0,d.jsx)(f.Uk,{blockStore:n,onClickOriginRect:u,handleAccept:e=>function(e,t,n){const{mainEditorCurrentBlockStore:s}=v.default.state;if(s){const t=s.getType();var i;if(t)p.dh(n,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"topbar_more_menu",block_id:s.id,block_type:t,is_toggleable:(0,x._A)(t,s.getFormat()),collection_id:null===(i=s.getCollectionViewSourceCollectionStore())||void 0===i?void 0:i.id,parent_collection_id:s.getParentCollectionIdUpToTwoLevels()})}e.closeParentMenu&&A(t)}(e,t,l),handleDismiss:()=>A(t)}),originGap:j&&c.isElectronWindows?12:8,trapFocus:!0,forceInitialInbound:!0,style:c.isMobile?{}:{width:240,maxHeight:"80vh"}})]})};function _(e,t,n){const{device:s}=e;return s.isMobile?"mobile_horizon1_quick_capture_circle_icons"===n?(0,P.Tg)(t).iconContainer:"mobile_horizon1_quick_capture"===n?{...(0,P.$d)(t).iconContainer,width:20}:{display:"flex",justifyContent:"center",height:"100%",paddingLeft:8,paddingRight:8,marginRight:2}:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4}}function A(e){e.setState({...e.state,open:!1})}const B=s.forwardRef((function(e,t){let{buttonPopupEvents:n,styling:s}=e;const l=(0,a.Fg)(),p=(0,i.O7)(),{device:g}=p,f=(0,o.VK)((()=>{var e;return Boolean(null===(e=b.Z.state.preferences)||void 0===e?void 0:e.isUnifiedTitleBarEnabled)}),[]),x=(0,P.Kh)(l);return(0,d.jsx)(w.Z,{renderTooltip:()=>p.currentUser.isLoggedIn()?(0,d.jsx)(m.FormattedMessage,{defaultMessage:"Style, export, and more…",id:"topbarMoreButton.tooltip"}):(0,d.jsx)(m.FormattedMessage,{defaultMessage:"More…",id:"topbarMoreButton.loggedOut.tooltip"}),placement:S.u.Bottom,originGap:f&&g.isElectronWindows?10:void 0,delayThreshold:400,render:e=>(0,d.jsx)(j.Z,{ref:t,style:_(p,l,s),mobileFeedback:g.isMobile,className:h.mSZ,...(0,y.Z)(n,e),children:g.isMobile?"mobile_horizon1_quick_capture_circle_icons"===s?c(x.mobile_horizon1_quick_capture_circle_icons.iconStyle):"mobile_horizon1_quick_capture"===s?c({height:20,width:20,fill:l.icon.primary}):(0,u.I)({width:26}):(0,r.o)({width:18,height:18,fill:l.regularIconColor})})})}))},638433:(e,t,n)=>{n.r(t),n.d(t,{TopbarMoreMenu:()=>Zt});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(709291),l=(n(21703),n(313991)),d=n(815145),c=n(541432),u=n(883176),m=n(605336),p=n(590792),g=n(745238),f=n(785893);const h=(0,g.IU)("clockArrows",{viewBox:"0 0 18 15",svg:(0,f.jsx)("g",{children:(0,f.jsx)("path",{d:"M8.993.003c2.222 0 4.293 1.121 5.558 2.768.294.363.239.807-.075 1.026-.335.24-.732.137-1.005-.185a5.608 5.608 0 00-4.478-2.215 5.63 5.63 0 00-5.49 4.28h.978c.527 0 .664.403.376.793L3.203 8.773c-.225.315-.58.322-.813 0L.735 6.477c-.294-.404-.157-.8.376-.8h.964C2.731 2.457 5.603.003 8.993.003zM8.74 3.1c.328 0 .595.266.595.594v3.514l1.593 2.14c.212.294.191.656-.09.847-.293.212-.642.157-.888-.164L8.316 7.878a.767.767 0 01-.17-.465V3.694c0-.328.266-.594.594-.594zm.253 11.026c-2.215 0-4.286-1.114-5.55-2.769-.301-.362-.24-.8.075-1.025.335-.24.731-.137 1.004.185a5.61 5.61 0 004.471 2.221 5.66 5.66 0 005.503-4.279h-.984c-.527 0-.663-.41-.376-.8l1.654-2.304c.226-.314.581-.314.807 0l1.66 2.297c.288.404.158.807-.382.807h-.964c-.65 3.213-3.52 5.667-6.918 5.667z"})})});var y=n(677366),x=n(388437),S=n(53136);const v=(0,g.IU)("graph",{viewBox:"0 0 16 14",svg:(0,f.jsx)("g",{children:(0,f.jsx)("path",{d:"M.521 12.977V1.288c0-.376.288-.677.67-.677.383 0 .67.301.67.677v5.893l2.482-1.436v-.061c0-.718.58-1.306 1.305-1.306.718 0 1.3.588 1.3 1.306 0 .068-.008.136-.014.205l1.415 1.203a1.3 1.3 0 01.601-.144 1.3 1.3 0 01.8.274l3.07-1.84a1.6 1.6 0 01-.028-.259 1.31 1.31 0 011.306-1.306 1.31 1.31 0 011.305 1.306 1.31 1.31 0 01-1.305 1.306c-.267 0-.52-.082-.725-.226l-3.13 1.873c.006.055.013.116.013.171 0 .725-.588 1.306-1.306 1.306a1.3 1.3 0 01-1.299-1.306c0-.15.028-.3.076-.437L6.44 6.716a1.286 1.286 0 01-1.682-.082L1.862 8.315v3.72c0 .143.048.19.192.19h12.749a.669.669 0 110 1.34H1.109c-.355 0-.588-.232-.588-.588z"})})});var b=n(582356),M=n(287132),j=n(727714),C=n(460651),w=n(418442),k=n(23867),I=n(531701),T=n(653965),Z=n(137810),P=n(800893),F=n(730188),_=n(579257),A=n(276725),B=n(850799),R=n(461652),D=n(496802),O=n(594419),L=n(119785),V=n(709953),E=n(275754),N=n(608055),U=n(937834),K=n(210228),W=n(110906),z=n(693405),q=n(690403),G=n(983242),H=n(672495),$=n(98742),Y=n(825464),Q=n(164921),J=n(526388),X=n(164369);function ee(e,t){let{id:n,caption:s,focused:o,isActive:r,onClick:l,onMouseDown:d,onMouseEnter:c,onMouseLeave:u,role:m,style:p,tooltip:g,ignoreLocalHoverState:h,disallowTabbing:y}=e;const x=(0,i.Fy)(),S=(0,a.yK)((()=>({optionItem:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:34,justifyContent:"flex-end"},button:{width:"100%",...x.isMobile?{padding:16,paddingTop:20,transition:"color 300ms, border 300ms",lineHeight:1}:{padding:6,paddingTop:10,borderRadius:4,transition:"color 300ms, border 300ms",lineHeight:1},justifyContent:"center",color:r?I.ZP.blue:"inherit"}})),[r,x]);return(0,f.jsx)(J.Z,{renderTooltip:()=>g,placement:Y.u.Bottom,delayThreshold:80,render:e=>{const i=(0,$.Z)(e,{onMouseEnter:c,onMouseLeave:u}),{onMouseDown:a,...r}=i;return(0,f.jsx)(Q.Z,{...r,id:n,role:m,ref:t,mobileFeedback:x.isMobile,onClick:l,onMouseDown:i.onMouseDown||d,hovered:o,style:S.button,ignoreLocalHoverState:h,disallowTabbing:y,className:"notranslate",children:(0,f.jsxs)("div",{style:S.optionItem,children:[(0,f.jsx)("div",{style:{...p,height:25},children:"Ag"}),(0,f.jsx)(X.Z,{isSmall:!0,style:{marginTop:4},children:s})]})})}})}const te=s.forwardRef(ee);const ne=function(e){const{children:t}=e,n=(0,i.O7)(),{mobileStyle:s,desktopStyle:o}=(0,a.yK)((e=>({mobileStyle:{display:"flex",justifyContent:"space-around",boxShadow:`0 1px 0 ${e.regularDividerColor}`,background:e.popoverBackground},desktopStyle:{display:"flex",justifyContent:"space-between",marginLeft:14,marginRight:14}})),[]);return(0,f.jsx)(H.Z,{...e,children:(0,f.jsx)("div",{style:n.device.isMobile?s:o,children:t})})};var se,ie=n(629551),oe=n(883283),ae=n(248603),re=n(95477),le=n(27105),de=n(119037),ce=n(730459),ue=n(628020),me=n(277181),pe=n(321969),ge=n(484210),fe=n(433929),he=n(341984),ye=n(424764),xe=n(282356),Se=n(966324),ve=n(136896),be=n(44604),Me=n(436391),je=n(80444),Ce=n(925489),we=n(400807),ke=n(319385),Ie=n(770681),Te=n(530496),Ze=n(992083),Pe=n(452258),Fe=n(897630),_e=n(854669),Ae=n(175306),Be=n(593685),Re=n(129768),De=n(62967),Oe=n(342784),Le=n(802295),Ve=n(924212),Ee=n(405337),Ne=n(336154);const Ue=(0,r.defineMessages)({customizePageLabel:{id:"action.customizePage.label",defaultMessage:"Customize page"},customizePageOptionsLabel:{id:"action.customizePageOptions.label",defaultMessage:"Page options"},exportName:{id:"action.export.name",defaultMessage:"Export"},exportCaption:{id:"action.export.caption",defaultMessage:"PDF, HTML, Markdown & CSV"},fontDefaultName:{id:"action.setPageFont.default.fuzzySearchKeywords",defaultMessage:"Font Default"},fontDefaultCaption:{id:"action.setPageFont.default.caption",defaultMessage:"Default"},fontDefaultTooltip:{id:"action.setPageFont.default.tooltip",defaultMessage:"The default sans-serif workhorse"},fontSerifName:{id:"action.setPageFont.serif.fuzzySearchKeywords",defaultMessage:"Font Serif"},fontSerifCaption:{id:"action.setPageFont.serif.caption",defaultMessage:"Serif"},fontSerifTooltip:{id:"action.setPageFont.serif.tooltip",defaultMessage:"Good for publishing"},fontMonoName:{id:"action.setPageFont.mono.fuzzySearchKeywords",defaultMessage:"Font Mono"},fontMonoCaption:{id:"action.setPageFont.mono.caption",defaultMessage:"Mono"},fontMonoTooltip:{id:"action.setPageFont.mono.tooltip",defaultMessage:"Good for drafting and notes"},fontComicName:{id:"action.setPageFont.comic.fuzzySearchKeywords",defaultMessage:"Font Comic"},fontComicCaption:{id:"action.setPageFont.comic.caption",defaultMessage:"Comic"},fontComicTooltip:{id:"action.setPageFont.comic.tooltip",defaultMessage:"Playful but cringe"},fontSmallTextKeywords:{id:"action.fontSmallText.fuzzySearchKeywords",defaultMessage:"Font Small Text"},fontSmallTextLabel:{id:"action.fontSmallText.label",defaultMessage:"Small text"},fontStyleSection:{id:"action.section.fontStyle",defaultMessage:"Style"},fullWidthLabel:{id:"action.fullWidth.label",defaultMessage:"Full width"},getNotifiedFor:{defaultMessage:"Get notified",id:"topbar.moreButton.getNotified"},importName:{id:"action.import.name",defaultMessage:"Import"},lockPageName:{id:"action.lockPage.name",defaultMessage:"Lock page"},floatingTableOfContents:{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"},notifyMe:{id:"action.notifyMe.name",defaultMessage:"Notify me"},openAIAssistant:{id:"action.openMobileAIAssistant.name",defaultMessage:"Open AI Assistant"},openinMacAppName:{id:"action.openinMacApp.name",defaultMessage:"Open in Mac app"},openinWindowsAppName:{id:"action.openinWindowsApp.name",defaultMessage:"Open in Windows app"},openiniOSAppName:{id:"action.openiniOSApp.name",defaultMessage:"Open in iOS app"},openinAndroidAppName:{id:"action.openinAndroidApp.name",defaultMessage:"Open in Android app"},pageAnalyticsName:{id:"action.pageAnalytics.name",defaultMessage:"Page analytics"},pageHistoryName:{id:"action.pageHistory.name",defaultMessage:"View edit history"},pageUpdates:{id:"action.pageUpdates.title",defaultMessage:"Page updates"},privacySettingsName:{id:"action.privacySettings.name",defaultMessage:"Privacy settings"},showDeletedPagesName:{id:"action.showDeletedPages.name",defaultMessage:"Show deleted pages"},unlockPageName:{id:"action.unlockPageName.name",defaultMessage:"Unlock page"},suggestEditsName:{id:"action.suggestEdits.name",defaultMessage:"Suggest edits"},viewAnalyticsName:{id:"action.viewAnalytics.name",defaultMessage:"View analytics"},openPageLayoutEditor:{id:"action.layoutEditor.open",defaultMessage:"Customize layout"}});function Ke(e){return(0,De.cN)({key:`font ${e.font||"default"}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:[de.or([de.ffD(de.YGm),de.f7f]),de.J5S,de.ffD(de.uY7),...e.extraValidators],render:(t,n)=>{const s=n.blocks[0].getFormat().page_font,i=e.font===s||!e.font&&!s;return(0,f.jsx)(te,{...t,isActive:i,font:e.font,tooltip:e.tooltip,style:e.style,caption:e.caption})},closeParentMenu:!1,action:(t,n)=>{let{blocks:s,environment:i}=t;K.createAndCommit({userAction:"actionRegistry.createFontAction",environment:i,perform:t=>{D.FH({stores:s,update:{page_font:e.font},transaction:t}),function(e,t){ce.K4(e,"change_font_type",t)}(i,{type:e.font||"default"})}})}})}const We=Ke({displayName:Ue.fontDefaultName,caption:(0,f.jsx)(r.FormattedMessage,{...Ue.fontDefaultCaption}),font:void 0,tooltip:(0,f.jsx)(r.FormattedMessage,{...Ue.fontDefaultTooltip}),style:{fontSize:24,fontFamily:Z.Z.getCompositeFontFamily(l.SP).sans,position:"relative",top:-2},extraValidators:[]}),ze=Ke({displayName:Ue.fontSerifName,caption:(0,f.jsx)(r.FormattedMessage,{...Ue.fontSerifCaption}),font:"serif",tooltip:(0,f.jsx)(r.FormattedMessage,{...Ue.fontSerifTooltip}),style:{fontSize:25,fontFamily:Z.Z.getCompositeFontFamily(l.SP).serif},extraValidators:[]}),qe=Ke({displayName:Ue.fontMonoName,caption:(0,f.jsx)(r.FormattedMessage,{...Ue.fontMonoCaption}),font:"mono",tooltip:(0,f.jsx)(r.FormattedMessage,{...Ue.fontMonoTooltip}),style:{fontSize:26,fontFamily:Z.Z.getCompositeFontFamily(l.SP).mono,position:"relative",top:-3,letterSpacing:-1},extraValidators:[]}),Ge=Ke({displayName:Ue.fontComicName,caption:(0,f.jsx)(r.FormattedMessage,{...Ue.fontComicCaption}),font:"comic",tooltip:(0,f.jsx)(r.FormattedMessage,{...Ue.fontComicTooltip}),style:{fontSize:26,fontFamily:Z.Z.getCompositeFontFamily(l.SP).comic,position:"relative",top:-3,letterSpacing:-1},extraValidators:[de.or([de.QLY("comic_sans"),e=>e.blocks.some((e=>"comic"===e.getFormatStore().getKeyStore("page_font").getValue()))])]}),He=(0,De.$J)({key:"font section",title:void 0,render:e=>(0,f.jsx)(ne,{...e}),actions:[We,ze,qe,Ge]}),$e=(0,De.N$)({key:"small text",displayName:Ue.fontSmallTextKeywords,label:fe.default.formatMessage(Ue.fontSmallTextLabel),isEnabled:e=>Boolean(e.getFormat().page_small_text),validators:[de.ffD(de.tqC),de.or([de.ffD(de.YGm),de.f7f]),de.J5S,de.ffD(de.uY7)],action:(e,t,n)=>D.FH({stores:[t],update:{page_small_text:!t.getFormat().page_small_text},transaction:n}),afterAction:(e,t)=>{ce.K4(t,"change_font_size",{type:e?"small":"large"})}}),Ye=(0,De.N$)({key:"full width",displayName:Ue.fullWidthLabel,label:fe.default.formatMessage(Ue.fullWidthLabel),isEnabled:e=>e.isFullWidth(),validators:[de.ffD(de.Mnk),de.ffD(de.YGm),de.J5S,de.ffD(de.uY7)],action:(e,t,n)=>D.FH({stores:[t],update:{page_full_width:!t.isFullWidth()},transaction:n}),afterAction:(e,t)=>{ce.K4(t,"change_page_width",{type:e?"full_width":"default_width"})}}),Qe=(0,De.N$)({key:"page lock",displayName:Ue.lockPageName,label:fe.default.formatMessage(Ue.lockPageName),isEnabled:e=>e.isLocked(),validators:[de.ffD(de.YGm),de.J5S,de.ffD(de.uY7)],action:(e,t,n)=>V.sW({store:t.getFormatStore(),data:{block_locked:!t.isLocked(),block_locked_by:e.currentUser.id},transaction:n}),afterAction:()=>null}),Je=(0,De.N$)({key:"suggest edits",displayName:Ue.suggestEditsName,label:fe.default.formatMessage(Ue.suggestEditsName),badge:(0,f.jsx)(G.Z,{newBadgeKey:"suggested_edits_topbar_more_actions",didUserEngage:Boolean(null===(se=je.default.state.currentUserSettingsStore)||void 0===se||null===(se=se.getSettings())||void 0===se?void 0:se.dismissed_suggest_mode_tooltip)}),isEnabled:e=>"suggest"===we.Z.getMode(e),validators:[de.ffD(de.p1d),de.ffD(de.tqC),de.ffD(de.YGm),de.ffD(de.NnH),de.iR0,de.ffD(de.uY7)],action:(e,t,n)=>{const s="suggest"===we.Z.getMode(t)?"default":"suggest";"suggest"===s&&Pe.Z.reset(),B.t({environment:e,blockStore:t,mode:s,location:"page_more_actions"})},afterAction:()=>null}),Xe=[de.ffD(de.YGm),de.J5S,de.ffD(de.uY7),de.QLY("floating_table_of_contents"),de.ffD(de.tqC)],et=(0,De.N$)({key:"floating table of contents",displayName:Ue.floatingTableOfContents,label:fe.default.formatMessage(Ue.floatingTableOfContents),isEnabled:e=>{var t;return"off"!==(null===(t=e.getModel())||void 0===t?void 0:t.getFloatingTableOfContentsState())},validators:Xe,action:(e,t,n)=>{var s;const i="off"!==(null===(s=t.getModel())||void 0===s?void 0:s.getFloatingTableOfContentsState());V.sW({store:t.getFormatStore(),data:{page_floating_table_of_contents:{state:i?"off":"minimal"}},transaction:n})},afterAction:(e,t)=>{ce.j({environment:t,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:e}}})}});function tt(e,t){return(0,De.$J)({key:"page style",render:e=>(0,f.jsx)(H.Z,{...e}),actions:[$e,Ye,Je,Qe,Ae.cO,Ae.Bj,Ae.fK,et]})}const nt=(0,De.cN)({key:"customize page",displayName:ke.default.checkGate({gateName:"page_layouts"})?Ue.customizePageOptionsLabel:Ue.customizePageLabel,analyticsName:ke.default.checkGate({gateName:"page_layouts"})?Ue.customizePageOptionsLabel.defaultMessage:Ue.customizePageLabel.defaultMessage,svg:y.F,validators:[de.U_8,de.ffD(de.YGm),de.ffD(de.uY7)],closeParentMenu:!0,render:e=>(0,f.jsx)(z.Z,{...e,title:(0,f.jsx)(r.FormattedMessage,{...ke.default.checkGate({gateName:"page_layouts"})?Ue.customizePageOptionsLabel:Ue.customizePageLabel}),svg:y.F}),action:e=>{_.bA({originRect:e.originRect})}}),st=(0,De.cs)({key:"copy link to block non-desktop",displayName:De.RE.copyLinkNavigableTypeName,analyticsName:De.RE.copyLinkNavigableTypeName.defaultMessage,svg:j.N,shortcuts:["copyCurrentPageLinkifiedBlockTitle"],validators:[de.jlf,de.U7o,de.ffD(de.daU),de.ffD(de.uY7)],closeParentMenu:!0,action:(e,t)=>{P.Hs({...e,event:t})}}),it=(0,De.cs)({key:"duplicate",displayName:De.RE.duplicateName,analyticsName:De.RE.duplicateName.defaultMessage,svg:x.a,validators:[de.DFt,de.J5S,de.KEd,de.xks,de.ffD(de.P99(c.Ti.externalObjectInstancePage)),de.ffD(de.Q_M),de.ffD(de.uY7)],shortcuts:["duplicate"],closeParentMenu:!0,action:async(e,t)=>{let{environment:n}=e;const s=ue.np();if(!s)return;const i=s.getAssociatedCollectionStore();if(i&&Fe.M_(n)){const e=new Ce.Z(n);e.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:i}),(0,me.vJ)(s,e)?await F.h5({environment:n,blocks:[s],collectionContextStore:e,useCrdt:(0,le.Sy)({event:t,contextualDefault:s.useCrdt()})}):K.createAndCommit({userAction:"actionRegistry.duplicateToCollection",environment:n,perform:e=>{const[o,a]=A.Qi({environment:n,stores:[s],addCopyName:(0,he.Z)(s),transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!s.isInsideTemplate(),targetSpaceId:(0,k.C)(i.pointer.spaceId),baseUrl:re.default.domainBaseUrl,publicDomainName:re.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:(0,le.Sy)({event:t,contextualDefault:s.useCrdt()})}),r=o[0];L.zw({childStore:r,parentStore:i,transaction:e}),s.isTemplate()&&O.R3({parentStore:i.getTemplatePagesStore(),appendStore:r,transaction:e}),E._c({environment:n,store:r,pageVisitSource:d.tY.Duplicate})}})}}}),ot=(0,De.cN)({key:"open in mac app",displayName:Ue.openinMacAppName,analyticsName:Ue.openinMacAppName.defaultMessage,svg:C.h,validators:[de.U7o,de.ffD(de.tYA),de.ffD(de.tqC),de.V5r],closeParentMenu:!0,action:(e,t)=>{let{blocks:n,environment:s}=e;const i=(0,ge.ZP)({store:n[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});N.RX({url:(0,pe.W)(i),environment:s})}}),at=(0,De.cN)({key:"open in windows app",displayName:Ue.openinWindowsAppName,analyticsName:Ue.openinWindowsAppName.defaultMessage,svg:C.h,validators:[de.U7o,de.ffD(de.tYA),de.ffD(de.tqC),de.EDF],closeParentMenu:!0,action:(e,t)=>{let{blocks:n,environment:s}=e;const i=(0,ge.ZP)({store:n[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});N.RX({url:(0,pe.W)(i),environment:s})}}),rt=(0,De.cN)({key:"open in ios app",displayName:Ue.openiniOSAppName,analyticsName:Ue.openiniOSAppName.defaultMessage,svg:C.h,validators:[de.U7o,de.ffD(de.tYA),de.gnQ],closeParentMenu:!0,action:(e,t)=>{let{blocks:n,environment:s}=e;const i=(0,ge.ZP)({store:n[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});N.RX({url:i,environment:s})}}),lt=(0,De.cN)({key:"open in android app",displayName:Ue.openinAndroidAppName,analyticsName:Ue.openinAndroidAppName.defaultMessage,svg:C.h,validators:[de.U7o,de.ffD(de.tYA),de.DtP],closeParentMenu:!0,action:(e,t)=>{let{blocks:n,environment:s}=e;const i=(0,ge.ZP)({store:n[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});N.RX({url:i,environment:s})}}),dt=(0,De.cN)({key:"open page updates",analyticsName:"Open page updates",displayName:Ue.pageUpdates,svg:p.t,validators:[de.RFc,de.tqC],closeParentMenu:!0,action:()=>{Te.Z.setState({open:!0})}}),ct=(0,De.cN)({key:"action page history",displayName:Ue.pageHistoryName,analyticsName:Ue.pageHistoryName.defaultMessage,svg:m.r,validators:[de.or([de._Tt,de.k5s]),de.Ggh,de.DFt,de.jlf,de.ffD(de.YO6)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;return U.jN({environment:t,blockStore:n[0],from:"topbar"})},render:(e,t)=>{let{onClick:n,key:s,...i}=e,{environment:o}=t;return(0,f.jsx)(_e.Z,{requireUpgradeToTier:!1,analyticsName:"history_modal",onClick:n,alwaysAllowClick:!0,render:(e,t)=>(0,f.jsx)(z.Z,{...(0,$.Z)(i,e),title:fe.default.formatMessage(Ue.pageHistoryName),svg:m.r,dontShrinkRight:!0,right:t}),renderUpgradeTooltip:()=>{}},s)}}),ut=(0,De.cN)({key:"open page trash",displayName:Ue.showDeletedPagesName,analyticsName:Ue.showDeletedPagesName.defaultMessage,svg:h,validators:[de.DFt,de.J5S,de.OOv,de.jlf,de.ffD(de.nJQ),de.ffD(de.uY7)],closeParentMenu:!0,action:()=>{ve.Z.setState({open:!0}),be.ZP.setState({...be.ZP.state,currentTab:"in_current_page"})}}),mt=((0,De.MV)({key:"page analytics menu",displayName:Ue.pageAnalyticsName,analyticsName:Ue.pageAnalyticsName.defaultMessage,validators:[de.DFt],svg:u.z,subActions:e=>[{key:"view analytics",render:e=>(0,f.jsx)(H.Z,{...e}),actions:[(0,De.cN)({key:"view analytics",displayName:Ue.viewAnalyticsName,analyticsName:Ue.viewAnalyticsName.defaultMessage,svg:u.z,validators:[de.cFU],closeParentMenu:!0,action:()=>{Se.handleSidebarButtonClick(e.environment,e.blocks[0],Me.gY.Updates,"more_menu"),Me.ZP.setState({...Me.ZP.state,currentSubTab:Me.uF.Analytics})}}),(0,De.cN)({key:"privacy settings",displayName:Ue.privacySettingsName,analyticsName:Ue.privacySettingsName.defaultMessage,svg:w.H,validators:[],closeParentMenu:!0,action:e=>{ae.TopbarPageAnalyticsOptOutMenuStore.setState({isOpen:!0,rect:e.originRect})}})]}]}),(0,De.cN)({key:"view analytics",displayName:Ue.viewAnalyticsName,analyticsName:Ue.viewAnalyticsName.defaultMessage,svg:v,validators:[de.cFU],closeParentMenu:!0,action:e=>{Se.handleSidebarButtonClick(e.environment,e.blocks[0],Me.gY.Updates,"more_menu"),Me.ZP.setState({...Me.ZP.state,currentSubTab:Me.uF.Analytics})}}));function pt(e,t){var n;const s=(0,I.gh)({theme:e.ThemeModeStore.state});return(0,De.$J)({key:"editorActions",render:e=>(0,f.jsx)(H.Z,{...e}),actions:[Ne.Yw,dt,ct,ut,mt,(0,De.MV)({key:"notifications",displayName:Ue.notifyMe,analyticsName:Ue.notifyMe.defaultMessage,svg:p.t,right:(0,f.jsx)(f.Fragment,{children:null===(n=t.find((e=>e.isSelectedOption)))||void 0===n?void 0:n.action.displayName}),rightStyle:{color:s.lightTextColor,marginRight:5},width:300,initialFocus:t.findIndex((e=>e.isSelectedOption))??0,validators:[de.ffD(de.uY7)],subActions:()=>[(0,De.$J)({key:"notifications",render:e=>(0,f.jsx)(H.Z,{...e}),actions:t.map((e=>{let{action:t}=e;return t}))})]})]})}const gt=(0,De.cN)({key:"open import modal",displayName:Ue.importName,analyticsName:Ue.importName.defaultMessage,svg:b.l,validators:[de.Ggh,de.YZb,de.J5S,de.ffD(de.P99(c.Ti.externalObjectInstancePage)),de.ffD(de.Q_M),de.ffD(de.uY7)],closeParentMenu:!0,action:e=>{let{blocks:t}=e,n=!1;if(1===t.length){const[e]=t;n=e.isCollectionView()}n?Ie.Z.setState({open:!0}):Ze.Z.setState({...Ze.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"topbar"})}}),ft=(0,De.cN)({key:"export block",displayName:Ue.exportName,analyticsName:Ue.exportName.defaultMessage,validators:[de.Ggh,de.jlf,de.KbU],closeParentMenu:!0,render:e=>(0,f.jsx)(z.Z,{...e,svg:S.h,title:(0,f.jsx)(r.FormattedMessage,{...Ue.exportName}),tooltipText:(0,f.jsx)(r.FormattedMessage,{...Ue.exportCaption})}),action:e=>{let{blocks:t,environment:n}=e;const s=t[0];if(!s.isDefined())return;let i=!0;const o=(0,W.fm)(t[0]);if(o){const e=null==o?void 0:o.collectionStore();null!=e&&e.isPageTreeCollection()&&(i=!1)}R.q$({environment:n,root:{id:s.id,table:"block",spaceId:s.getSpaceId()},isCollectionViewExportTypeSupported:i})}}),ht=(0,De.cN)({key:"open page layout editor",displayName:Ue.openPageLayoutEditor,analyticsName:Ue.openPageLayoutEditor.defaultMessage,validators:[de.iBZ],closeParentMenu:!0,render:e=>(0,f.jsx)(z.Z,{...e,svg:M.J,title:(0,f.jsxs)(ie.gq,{children:[(0,f.jsx)(r.FormattedMessage,{...Ue.openPageLayoutEditor}),(0,f.jsx)(q.Z,{content:"Dev"})]})}),action:e=>{let{environment:t,blocks:n}=e,s=null;for(const i of n){const e=i.getAssociatedCollectionStore();if(e&&!e.isPageTreeCollection()){s=e;break}}if(!s)throw new Error("Could not edit page layout: Could not find collection");xe.IR({environment:t,collectionStore:s,from:"customize_page_button_in_three_dot_menu"})}});var yt=n(460709),xt=n(918514),St=n(513713),vt=n(748019),bt=n(478140),Mt=n(828992),jt=n(840721),Ct=n(483182),wt=n(400939),kt=n.n(wt),It=n(849427);function Tt(e){const t=(0,s.useMemo)((()=>function(e){const t=It.Z.find((t=>t.props.store===e));if(t){const e=t.getContentWrapEl();if(e)return kt()(e.innerText)}return 0}(e.store)),[e.store]);return(0,f.jsx)(f.Fragment,{children:t})}function Zt(e){const{blockStore:t,onClickOriginRect:n,handleAccept:s,handleDismiss:l}=e,d=(0,i.O7)(),c=(0,i.Fy)(),u=(0,o.VK)((()=>({environment:d,blocks:[t],originRect:n,publicEditMode:void 0})),[d,t,n]),m=(0,o.VK)((()=>function(e){const{environment:t,context:n}=e,{device:s}=t,i=n.blocks[0],o=i.getFollowSettingsKey(),a=ye.Z({followSettingsKey:o,environment:t,blockStore:i,from:"more_menu"});return[He,tt(),Oe.ww,(0,De.$J)({key:"topbar dictate action",render:e=>(0,f.jsx)(H.Z,{...e}),actions:[Be.gz]}),(0,De.$J)({key:"topbar page customization",render:e=>(0,f.jsx)(H.Z,{...e}),actions:(0,T.oA)([nt,ke.default.checkGate({gateName:"page_layouts"})&&!s.isMobile?ht:void 0,Ee.bV,Ee.R$])}),(0,De.$J)({key:"topbar primary actions",render:e=>(0,f.jsx)(H.Z,{...e}),actions:[Ae.q6,Ae.hS,Ne.aU,st,it,Re.m7,Re.nh,Re.fI,Re.MI,Le.A,Ve.Op]}),pt(t,a),(0,De.$J)({key:"topbar import actions",render:e=>(0,f.jsx)(H.Z,{...e}),actions:[gt,Ae.mS,ft]}),(0,De.$J)({key:"topbar view options",render:e=>(0,f.jsx)(H.Z,{...e}),actions:[ot,at,rt,lt]}),(0,oe.Z)(n)]}({environment:d,context:u})),[d,u]),p=(0,o.VK)((()=>!t.isCollectionView()&&t.canEdit()&&t.hasContent()),[t]),g=(0,o.VK)((()=>t.canEdit()),[t]),h=(0,o.VK)((()=>t.canEdit()&&t.isCollectionView()),[t]),y=(0,a.yK)((e=>({caption:{color:e.lightTextColor}})),[]),x=c.isMobile?{menuType:yt.og.Modal,title:(0,f.jsx)(r.FormattedMessage,{defaultMessage:"Actions",id:"topbarMoreButton.mobileActionsMenu.title"}),right:(0,f.jsx)(jt.DoneMenuText,{}),onClickRight:l}:{menuType:yt.og.Popup,maxHeight:"80vh"};return(0,f.jsxs)(bt.Z,{...x,children:[(0,f.jsx)(vt.Z,{sections:m,onAccept:s,context:u}),(p||g)&&(0,f.jsxs)(H.Z,{topBorder:!0,children:[p&&(0,f.jsx)(Mt.Z,{caption:(0,f.jsx)("span",{style:y.caption,children:(0,f.jsx)(r.FormattedMessage,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,f.jsx)(Tt,{store:t})}})})}),g&&(0,f.jsx)("div",{style:{paddingBottom:p?6:0},children:(0,f.jsx)(St.Z,{store:t,isPageMoreButton:!0})})]}),h&&(0,f.jsx)(Pt,{})]})}function Pt(){return(0,f.jsx)(H.Z,{topBorder:!0,children:(0,f.jsx)(Ct.Z,{title:(0,f.jsx)(r.FormattedMessage,{defaultMessage:"Learn about databases",id:"topbar.moreButton.collectionHelpButton"}),href:(0,xt.UY)("guides.database"),analyticsFrom:"topbar_more_button"})})}},248603:(e,t,n)=>{n.r(t),n.d(t,{PageAnalyticsPageOptOut:()=>x,TopbarPageAnalyticsOptOutMenu:()=>y,TopbarPageAnalyticsOptOutMenuStore:()=>h});n(667294);var s=n(800480),i=n(886628),o=n(749085),a=n(709291),r=n(310259),l=n(918514),d=n(223196),c=n(80444),u=n(973420),m=n(953437),p=n(942402),g=n(555422),f=n(785893);const h=o.default.createValue({isOpen:!1,rect:void 0},{name:"TopbarPageAnalyticsOptOutMenuStore"});function y(){const e=(0,s.O7)(),t=(0,i.VK)((()=>h.state.isOpen),[]),n=(0,i.VK)((()=>h.state.rect),[]),o=(0,i.VK)((()=>c.default.state.mainEditorCurrentBlockStore),[]);return o?(0,f.jsx)(m.ZP,{popupType:e.device.isMobile?d.k.SlideUp:d.k.Popup,alignmentToOrigin:m.ZP.Alignment.Center,open:t,render:()=>(0,f.jsx)("div",{style:{minWidth:360,padding:16},children:(0,f.jsxs)(u.sg,{gap:16,children:[(0,f.jsx)("div",{style:{fontSize:16,fontWeight:500},children:(0,f.jsx)(a.FormattedMessage,{id:"TopbarPageAnalyticsOptOutMenu.heading",defaultMessage:"Privacy settings"})}),(0,f.jsx)(x,{store:o})]})}),originRect:n,onDismiss:()=>h.setState({isOpen:!1,rect:void 0})}):null}function x(e){const t=(0,s.O7)(),n=(0,i.VK)((()=>{const e=c.default.state.currentSpaceViewStore;return null==e?void 0:e.getSettings()}),[]),o=(0,i.VK)((()=>{const t=null==n?void 0:n.page_analytics_opt_out_list;return null==t?void 0:t.includes(e.store.id)}),[n,e.store.id]);return(0,f.jsx)(g.Z,{type:"dropdown",currentOption:o?"do_not_record":"record",options:[{key:"record",label:(0,f.jsx)(a.FormattedMessage,{id:"page_analytics.opt_out.record",defaultMessage:"Record"})},{key:"do_not_record",label:(0,f.jsx)(a.FormattedMessage,{id:"page_analytics.opt_out.do_not_record",defaultMessage:"Don't record"})}],onSelectOption:n=>{"do_not_record"===n?r.kY(t,e.store.id):r.pu(t,e.store.id)},isMobile:t.device.isMobile,title:(0,f.jsx)(a.FormattedMessage,{id:"page_analytics.opt_out.title",defaultMessage:"My view history"}),caption:(0,f.jsx)(a.FormattedMessage,{id:"page_analytics.opt_out.caption",defaultMessage:"Page editors can see my view history for this page. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,f.jsx)(p.Z,{external:!0,href:(0,l.UY)("guides.pageAnalytics"),children:e})}}),captionStyle:{maxWidth:270}})}},486467:(e,t,n)=>{n.d(t,{IX:()=>L,ZP:()=>V,qh:()=>K,dY:()=>H});n(757658);var s=n(667294),i=n(313991),o=n(800480),a=n(886628),r=n(724405),l=n(407057),d=n(519889),c=n(307928),u=n(709291),m=n(531701),p=n(653965),g=n(761045),f=n(107401),h=n(934700),y=n(220095),x=n(424042),S=n(319385),v=n(206258),b=n(164921),M=n(526388),j=n(164369),C=n(729302),w=n(45653),k=n(540107),I=n(144615),T=n(325320),Z=n(702688),P=n(453730);function F(e){const t=(0,o.O7)(),n=(0,s.useRef)(),i=(0,k.t)(),a=(0,s.useCallback)((async()=>{if(await P.transactionQueue.awaitRecordTransaction(e.blockStore.pointer),!i())return;const s=(0,I.pb)(e.blockStore.id);n.current=Z.ZP.addListener(s,p.P2((()=>T.Ri(t,{blockStore:e.blockStore,pageVisitStore:e.pageVisitStore,incremental:!0,limit:e.limit})),1e3),void 0,t)}),[t,i,e.blockStore,e.limit,e.pageVisitStore]),r=(0,s.useCallback)((()=>{n.current&&(Z.ZP.removeListener(n.current,t),n.current=void 0)}),[t]);return(0,s.useEffect)((()=>(a(),r)),[a,r]),null}var _=n(785893);const A=5,B=25,R=5,D=23,O=6,L=22;const V=function(e){let{pageVisitStore:t,presenceStore:n,rootStore:s,maxUsers:i}=e;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(f.at,{rootStore:s}),(0,_.jsx)(Y,{rootStore:s,pageVisitStore:t,presenceStore:n,maxUsers:i}),(0,_.jsx)(F,{blockStore:s,pageVisitStore:t,limit:1+N(i)+B})]})};function E(e){return p.MR(e,(e=>e.activityTimestampNearestMinuteMs))}function N(e){return e??A}function U(e,t){return v.U6.createChildStore(t,{table:d.KJ,id:e})}function K(e,t,n,s){const i=s?O:R;return{...(0,h.X)({noDrag:n?e.device.isElectron&&!t:e.device.isElectronMac&&!t}),display:"flex",alignItems:"center",position:"relative",flexDirection:"row-reverse",marginLeft:4+i,marginTop:-2,transform:"translateZ(0)"}}function W(e){return{color:e.mediumInvertedTextColor,fontSize:10,textTransform:"uppercase",letterSpacing:"0.015em"}}function z(e){let{userData:t,isPresent:n,rootStore:s}=e;const d=(0,r.Fg)(),m=(0,o.O7)(),p=(0,u.useIntl)(),g=m.currentUser.id,f=(0,a.VK)((()=>U(t.userId,s)),[t,s]),h=(0,a.VK)((()=>f.isDefined()),[f]),y=(0,a.VK)((()=>(0,c.Nz)(p,f.getModel())),[p,f]),x=(0,a.VK)((()=>f.getEmail()),[f]);if(!h)return null;let S;return n?g!==f.id&&(S=t.blockId?(0,_.jsx)(u.FormattedMessage,{defaultMessage:"Viewing now. Click to see where they are.",id:"topbar.presenceIndicator.viewingNowWithLocation.tooltip"}):(0,_.jsx)(u.FormattedMessage,{defaultMessage:"Viewing now",id:"topbar.presenceIndicator.viewingNow.tooltip"})):g!==f.id&&t.activityTimestampNearestMinuteMs&&(S=(0,_.jsx)(u.FormattedMessage,{defaultMessage:"Last viewed {timeFromNow}",id:"topbar.presenceIndicator.lastViewedTime.tooltip",values:{timeFromNow:(0,l.tv)(Math.min(t.activityTimestampNearestMinuteMs,Date.now()),i.SP)}})),(0,_.jsxs)("div",{children:[(0,_.jsx)("div",{className:"notranslate",children:y}),(0,_.jsx)("div",{style:{fontWeight:400},children:x}),S&&(0,_.jsx)("div",{style:{color:d.mediumInvertedTextColor,minWidth:150,paddingTop:2,paddingBottom:2,lineHeight:1.3},children:S})]})}function q(e){let{userData:t,index:n,rootStore:s}=e;const d=(0,r.Fg)(),c=(0,o.O7)(),u=(0,y.MR)(c,t),m=(0,a.VK)((()=>U(t.userId,s)),[t,s]);if(!(0,a.VK)((()=>m.isDefined()),[m]))return null;let p;!u&&t.activityTimestampNearestMinuteMs&&(p=(0,l.tv)(t.activityTimestampNearestMinuteMs,i.SP));const f=(0,_.jsxs)("div",{style:{display:"flex",alignContent:"flex-end",minWidth:140,width:"100%",marginTop:4},children:[(0,_.jsx)(C.Z,{userStore:m,avatarSize:18,style:{flexGrow:1}}),(0,_.jsx)("div",{style:{marginLeft:"auto",paddingLeft:12,textAlign:"right",flexShrink:1,color:d.mediumInvertedTextColor},children:p})]});if(u&&t.blockId){const e=t.blockId;return(0,_.jsx)(b.Z,{onClick:()=>g.hl([e],!0),style:{display:"flex",alignItems:"center"},children:f})}return(0,_.jsx)("div",{style:{display:"flex",alignItems:"center"},children:f})}function G(e){let{hiddenUsers:t,rootStore:n,areColorfulBordersEnabled:s}=e;const i=(0,r.Fg)(),a=(0,o.O7)(),l=s?O:R;return(0,_.jsx)(M.Z,{allowHover:!0,originGap:7,renderTooltip:e=>{const s=[],o=[];for(const n of t)(0,y.MR)(a,n)?s.push(n):o.push(n);const r=o.slice(0,B-s.length);return(0,_.jsxs)("div",{...e,children:[s.length>0&&(0,_.jsxs)("div",{style:{marginBottom:4},children:[(0,_.jsx)(j.Z,{style:W(i),children:(0,_.jsx)(u.FormattedMessage,{defaultMessage:"Viewing now",id:"topbar.presenceIndicator.hiddenUsers.viewingNow.tooltip"})}),s.map(((e,t)=>(0,_.jsx)(q,{userData:e,index:t,rootStore:n},t)))]}),r.length>0&&(0,_.jsxs)("div",{style:{marginBottom:4},children:[(0,_.jsx)(j.Z,{style:{...W(i)},children:(0,_.jsx)(u.FormattedMessage,{defaultMessage:"Last viewed by",id:"topbar.presenceIndicator.hiddenUsers.lastViewedBy.tooltip"})}),r.map(((e,t)=>(0,_.jsx)(q,{userData:e,index:t,rootStore:n},t)))]}),o.length>r.length&&(0,_.jsx)("div",{style:{marginLeft:2,marginTop:2,color:i.mediumInvertedTextColor},children:(0,_.jsx)(u.FormattedMessage,{defaultMessage:"{notViewingMoreUsersCount} more…",id:"topbarPresence.presenceIndicator.hiddenUsers.moreUsersNotViewing.tooltip",values:{notViewingMoreUsersCount:o.length-r.length}})})]})},render:e=>(0,_.jsx)("div",{style:{color:i.mediumTextColor,fontSize:14,marginLeft:2*l,marginRight:-l,whiteSpace:"nowrap"},...e,children:(0,_.jsx)(u.FormattedMessage,{defaultMessage:"{hiddenUsersCount, plural, one {+{hiddenUsersCount}} other {+{hiddenUsersCount}}}",id:"topbar.presenceIndicator.hiddenUsers.otherCount.message",values:{hiddenUsersCount:t.length}})})})}function H(e,t){return(0,r.yK)((n=>{const s={width:L,height:L,borderRadius:L},i=e(n);return{button:{transition:"all 0.2s ease",transform:"scale(1)"},buttonHovered:{transform:"scale(1.15)",background:"none"},buttonPressed:{transform:"scale(0.9)",background:"none"},uiUserAvatarStyles:{...s},avatarInnerOutline:{...s,outlineStyle:"solid",outlineColor:n.UIUserAvatarInnerOutline,outlineWidth:.5,outlineOffset:-.5},avatarBorder:t?{...s,outlineStyle:"solid",outlineColor:i,outlineWidth:1.5,outlineOffset:-.5}:{},avatarOuterOutline:{...s,outlineStyle:"solid",outlineColor:t?n.UIUserAvatarOuterOutline:n.UIUserAvatarIdleOutline,outlineWidth:.5,outlineOffset:t?1:0,marginRight:-6,position:"relative"},initialColor:{color:t?i:n.icon.secondary},legacyAvatarStyle:{width:D,height:D,borderRadius:D,marginRight:-R,position:"relative"}}}),[e,t])}function $(e){let{userData:t,rootStore:n,areColorfulBordersEnabled:i}=e;const r=(0,o.O7)(),{userId:l}=t,d=(0,y.MR)(r,t),c=U(l,n),u=(0,a.VK)((()=>c.isDefined()&&!c.getIsSuspended()),[c]),p=H((0,s.useCallback)((e=>l===r.currentUser.id?e.UIUserAvatarSelfBorder:(0,m.iY)(l,e)),[r.currentUser.id,l]),d);return u?(0,_.jsx)(M.Z,{textWrap:!0,renderTooltip:()=>(0,_.jsx)(z,{rootStore:n,userData:t,isPresent:d}),render:e=>{const n=i?(0,_.jsx)("div",{style:p.avatarOuterOutline,children:(0,_.jsx)("div",{style:p.avatarBorder,children:(0,_.jsx)(w.Z,{iconStyle:p.avatarInnerOutline,userStore:c,style:p.uiUserAvatarStyles,isOffline:!d,size:L,avatarShouldShowShadow:!0,initialOverrideStyle:p.initialColor})})}):(0,_.jsx)(w.Z,{userStore:c,style:p.legacyAvatarStyle,isOffline:!d,size:D,avatarShouldShowShadow:!0});if(d&&t.blockId){const s=t.blockId;return(0,_.jsx)(b.Z,{...e,onClick:()=>g.hl([s],!0),style:p.button,hoveredStyle:p.buttonHovered,pressedStyle:p.buttonPressed,children:n})}return(0,_.jsx)("div",{...e,children:n})}}):null}function Y(e){let{rootStore:t,pageVisitStore:n,presenceStore:s,maxUsers:i}=e;const r=(0,o.O7)(),l=r.currentUser.id,d=(0,a.VK)((()=>{const e=r.currentUser.id;if(!e)return;const t=(0,y.AQ)(n,s),o=[],a=[];for(const n of t)n.userId!==e&&((0,y.MR)(r,n)?o.push(n):a.push(n));const l=[...E(o).reverse(),...E(a).reverse()],d=N(i)-1;return{visibleUsers:l.slice(0,d),hiddenUsers:l.slice(d)}}),[n,s,r,i]),{visibleUsers:c,hiddenUsers:u,isEveryUserStoreReady:m}=(0,a.VK)((()=>{if(!l)return{};const{visibleUsers:e=[],hiddenUsers:n=[]}=d??{},s=[l,...e.map((e=>e.userId)),...n.map((e=>e.userId))];return{visibleUsers:e,hiddenUsers:n,isEveryUserStoreReady:s.map((e=>U(e,t))).every((e=>e.isReady()))}}),[l,d,t]),{isShowingTabBar:p,isUnifiedTitleBarEnabled:g}=(0,a.VK)((()=>{var e;return{isShowingTabBar:Boolean(x.Z.state.isShowingTabBar),isUnifiedTitleBarEnabled:Boolean(null===(e=x.Z.state.preferences)||void 0===e?void 0:e.isUnifiedTitleBarEnabled)}}),[]),h=(0,a.VK)((()=>S.default.checkGate({gateName:"colorful_presence_avatars"})),[]);if(!l||!d||!m)return null;if(0===c.length&&0===u.length)return(0,_.jsx)("div",{style:K(r,p,g,h),children:(0,_.jsx)(f.ew,{enableClickToScroll:!0,rootStore:t})});{const e=[...c];return e.reverse(),(0,_.jsxs)("div",{style:K(r,p,g,h),children:[u.length>0&&(0,_.jsx)(G,{rootStore:t,hiddenUsers:u,areColorfulBordersEnabled:h}),e.map((e=>(0,_.jsx)($,{userData:e,rootStore:t,areColorfulBordersEnabled:h},e.userId))),(0,_.jsx)($,{rootStore:t,userData:{userId:l,present:!0},areColorfulBordersEnabled:h}),(0,_.jsx)(f.ew,{enableClickToScroll:!0,rootStore:t})]})}}},250034:(e,t,n)=>{n.r(t),n.d(t,{default:()=>G});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(715769),l=n(443876),d=n(745238),c=n(785893);const u=(0,d.IU)("mobileQuickCaptureShare",{viewBox:"0 0 14 17",svg:(0,c.jsx)("path",{d:"M3.05566 15.8516C2.29915 15.8516 1.72266 15.6556 1.32617 15.2637C0.934245 14.8763 0.738281 14.3066 0.738281 13.5547V6.89648C0.738281 6.14453 0.934245 5.57487 1.32617 5.1875C1.72266 4.79557 2.29915 4.59961 3.05566 4.59961H4.9834V6.12402H3.17871C2.87793 6.12402 2.64779 6.2015 2.48828 6.35645C2.33333 6.50684 2.25586 6.73926 2.25586 7.05371V13.3975C2.25586 13.7119 2.33333 13.9466 2.48828 14.1016C2.64779 14.2565 2.87793 14.334 3.17871 14.334H10.8145C11.1107 14.334 11.3385 14.2565 11.498 14.1016C11.6576 13.9466 11.7373 13.7119 11.7373 13.3975V7.05371C11.7373 6.73926 11.6576 6.50684 11.498 6.35645C11.3385 6.2015 11.1107 6.12402 10.8145 6.12402H9.0166V4.59961H10.9443C11.7008 4.59961 12.2751 4.79557 12.667 5.1875C13.0635 5.57943 13.2617 6.14909 13.2617 6.89648V13.5547C13.2617 14.3021 13.0635 14.8717 12.667 15.2637C12.2751 15.6556 11.7008 15.8516 10.9443 15.8516H3.05566ZM6.99316 10.335C6.80176 10.335 6.6377 10.2666 6.50098 10.1299C6.36426 9.99316 6.2959 9.83138 6.2959 9.64453V2.84961L6.35742 1.84473L5.96094 2.35742L5.05859 3.32129C4.93555 3.45345 4.7806 3.51953 4.59375 3.51953C4.42513 3.51953 4.2793 3.46484 4.15625 3.35547C4.03776 3.24154 3.97852 3.09798 3.97852 2.9248C3.97852 2.7653 4.04232 2.61947 4.16992 2.4873L6.45312 0.292969C6.54883 0.201823 6.63997 0.140299 6.72656 0.108398C6.81315 0.0719401 6.90202 0.0537109 6.99316 0.0537109C7.08887 0.0537109 7.18001 0.0719401 7.2666 0.108398C7.35775 0.140299 7.44889 0.201823 7.54004 0.292969L9.82324 2.4873C9.95085 2.61947 10.0146 2.7653 10.0146 2.9248C10.0146 3.09798 9.95312 3.24154 9.83008 3.35547C9.70703 3.46484 9.56348 3.51953 9.39941 3.51953C9.21712 3.51953 9.06445 3.45345 8.94141 3.32129L8.03223 2.35742L7.64258 1.84473L7.69727 2.84961V9.64453C7.69727 9.83138 7.62891 9.99316 7.49219 10.1299C7.36003 10.2666 7.19368 10.335 6.99316 10.335Z"})});var m=n(709291),p=n(619584),g=n(524677),f=n(785526),h=n(237181),y=n(296994),x=n(843250),S=n(98742),v=n(75472),b=n(457345),M=n(825464),j=n(80444),C=n(319385),w=n(655899),k=n(8675),I=n(352878),T=n(897630),Z=n(88893),P=n(288280),F=n(231945),_=n(58261),A=n(489728),B=n(953437),R=n(526388),D=n(213148),O=n(531701),L=n(623063),V=n(573063),E=n(828451);function N(e){const{visible:t,onDismiss:n}=e,s=(0,a.yK)((e=>({overlayContainer:{position:"relative",width:240,height:140,paddingTop:0,paddingBottom:20,paddingLeft:20,paddingRight:20},container:{fontSize:12,color:O.ZP.white,position:"absolute",top:13,background:O.ZP.blue,borderRadius:6,padding:"8px 12px 12px 12px",width:200,boxShadow:e.largeLightBoxShadow,zIndex:9999},circle:{position:"absolute",top:-12,left:"calc(50% - 2.5px)",background:O.ZP.blue,width:5,height:5,borderRadius:5,boxShadow:`0 0 0 1.5px ${e.contentBackground}`},verticalLine:{position:"absolute",top:-12,left:"calc(50% - 1px)",background:O.ZP.blue,width:2,height:12},textContainer:{width:"90%",fontWeight:500},iconButton:{position:"absolute",top:4,right:4,opacity:.8},iconStyle:{width:12,fill:O.ZP.white}})),[]);return(0,c.jsx)("div",{style:s.overlayContainer,children:(0,c.jsx)(L.Z,{isVisible:t,animationStyle:{opacity:1},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},render:function(){return(0,c.jsx)(E.P,{calloutId:"share_button_tooltip",children:(0,c.jsxs)("div",{style:s.container,children:[(0,c.jsx)("div",{style:s.circle}),(0,c.jsx)("div",{style:s.verticalLine}),(0,c.jsx)("div",{style:s.textContainer,children:(0,c.jsx)(m.FormattedMessage,{defaultMessage:"You can share your content with your teammates here",id:"shareButtonIntroTooltip.title"})}),(0,c.jsx)(V.Z,{icon:D.U,style:s.iconButton,iconStyle:s.iconStyle,onClick:()=>n()})]})})}})})}var U=n(42543);function K(e){let{store:t,buttonPopupStore:n,styling:r}=e;const l=(0,i.O7)(),d=(0,o.VK)((()=>l.device.isMobile),[l]),u=(0,o.qz)(void 0,I.Z),m=(0,o.qz)(void 0,w.ZP),p=(0,o.qz)(void 0,k.Z),h=(0,o.VK)((()=>function(e,t){if(t.shouldUserHaveAccessToPrivatePageBlock()&&t.state.changePermissionsEnabled&&t.state.privatePageStore)return t.state.privatePageStore;return e}(t,p)),[t,p]),x=(0,o.VK)((()=>t.canAdmin()),[t]),S=(0,o.VK)((()=>!d&&function(e,t){const{permissionsInviteStore:n}=e.state;return n.state.inviteTargets.length>0||t.state.inviteTargets.length>0}(u,m)),[m,d,u]);(0,s.useEffect)((()=>{x||f.i({environment:l,sudoModeStore:p,pageBlockId:t.id})}),[x,l,t.id,p]);const M=(0,s.useCallback)((e=>(0,c.jsx)(W,{buttonPopupEvents:e,styling:r})),[r]),j=(0,s.useCallback)((()=>{n.reset()}),[n]),C=(0,s.useCallback)((()=>{q(n,u,m),g.ZH({environment:l,debug:{userAction:"TopbarShareButton.handleClick"}}),b.lG(l),T.bi(l)}),[l,n,u,m]),Z=(0,s.useCallback)((async()=>{if(m.state.inviteTargets.length>0){return void(await b.zd({environment:l,inviteTargetsStore:m})&&(b.a6(l),q(n,u,m)))}const{permissionsInviteStore:e}=u.state;"invitee"===e.state.inputFocus&&e.setState({...e.state,inputFocus:"none"});await(0,v.Aw)({environment:l,permissionsInviteStoreState:e.state,from:"share_menu"})||(b.a6(l),q(n,u,m))}),[n,l,m,u]),P=(0,a.yK)((()=>({buttonPopup:{...d?{width:460}:{width:500,overflow:"hidden"}}})),[d]);return(0,c.jsx)(F.ZP,{popupType:d?F.Z4.SlideUp:F.Z4.Popup,forceInitialInbound:!0,buttonPopupStore:n,renderOrigin:M,originGap:d?void 0:8,style:P.buttonPopup,onClick:C,render:()=>(0,c.jsx)(y._e,{buttonPopupStore:n,sudoModeStore:p,store:h,inviteTargetsStore:m,onUpgradeButtonClick:j,location:d?"topbar_mobile":"topbar_share_button",onClose:Z}),persistOnClose:S,onDismiss:Z,onClose:Z})}function W(e){let{buttonPopupEvents:t,styling:n}=e;const o=(0,i.Fy)().isMobile,r=(0,a.yK)((e=>({shortcut:{color:e.mediumInvertedTextColor}})),[]),l=(0,s.useCallback)((()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{children:(0,c.jsx)(m.FormattedMessage,{defaultMessage:"Share or publish to the web",id:"topbar.shareButton.tooltip"})}),(0,c.jsx)(_.Z,{style:r.shortcut,name:"openShareMenu"})]})),[r.shortcut]);return(0,c.jsx)(R.Z,{disableTooltip:o,renderTooltip:l,placement:M.u.Bottom,delayThreshold:400,render:e=>(0,c.jsx)(z,{events:(0,S.Z)(e,t),styling:n})})}function z(e){let{events:t,styling:n}=e;const d=(0,i.O7)(),{isMobile:g,isAndroid:f}=(0,i.Fy)(),y=(0,o.VK)((()=>function(e){const{currentUserSettingsStore:t,mainEditorCurrentBlockStore:n,inAppCalloutStore:s}=j.default.state;if(null!=n&&n.isTypedCollectionViewBlock())return!1;if(!t)return!1;if(t.id!==e.currentUser.id)return!1;const i=t.getKeyStore("settings").getKeyStore("seen_share_button_tooltip_at").getValue();if(Boolean(i))return!1;const o=t.getKeyStore("settings").getKeyStore("signup_time").getValue();if(!o)return!1;if(!s.getCalloutVisibility("share_button_tooltip").canShow)return!1;const a=Date.now()-o;if(a<=30*p.A0){switch(C.default.getEligibleGroup({experimentId:"intro_share_tooltip_condition",defaultGroup:"control"})){case"b200":const t=P.subscriptionDataStoreInstance.state;if(t){return(0,Z.Lz)(e,t)>=200}return!1;case"d3":return a>=3*p.A0;case"control":return a>=10*p.A0}}return!1}(d)),[d]),v=(0,a.yK)((e=>{const t=(0,U.Kh)(e),s="default"===n||void 0===n?{display:"flex",alignItems:"center",height:"100%",paddingLeft:8,paddingRight:8}:t[n].iconContainer;return{androidShareIcon:{width:16,height:16,marginRight:4},iOSShareIcon:{width:26},mobileQuickCaptureCircleIcons:t.mobile_horizon1_quick_capture_circle_icons.iconStyle,mobileQuickCapture:t.mobile_horizon1_quick_capture.iconStyle,shareButton:{...g?s:{marginRight:2,marginLeft:12}},popup:{boxShadow:"none",backgroundColor:"rgba(0, 0, 0, 0)"}}}),[g,n]);const b=g?"mobile_horizon1_quick_capture_circle_icons"===n?u(v.mobileQuickCaptureCircleIcons):"mobile_horizon1_quick_capture"===n?(0,l.s)(v.mobileQuickCapture):f?(0,r.Q)(v.androidShareIcon):(0,l.s)(v.iOSShareIcon):(0,c.jsx)(m.FormattedMessage,{defaultMessage:"Share",id:"topbar.shareButton.title"}),w=(0,s.useCallback)((()=>{y&&h.Qm(d)}),[d,y]),k=(0,c.jsx)(A.Z,{className:x.MD7,...(0,S.Z)(t,{onClick:w}),mobileFeedback:g,style:v.shareButton,children:b}),I=(0,s.useCallback)((()=>(0,c.jsx)(N,{visible:!0,onDismiss:w})),[w]);return y?(0,c.jsx)(B.ZP,{popupType:B.kQ.Popup,open:!0,origin:k,placementToOrigin:M.u.Bottom,alignmentToOrigin:B.ZP.Alignment.Center,preventScaleTransition:!0,preventOpacityTransition:!0,viewportPadding:4,preventCaptureEsc:!0,preventPointerEvents:!1,disableMouseCapture:!0,render:I,style:v.popup}):k}function q(e,t,n){e.reset(),t.reset(),n.reset()}const G=s.memo(K)},942975:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var s=n(365820),i=n(733993),o=n(667294),a=n(800480),r=n(886628),l=n(724405),d=n(213148),c=n(743590),u=n(709291),m=n(850799),p=n(237181),g=n(934700),f=n(80444),h=n(424042),y=n(164921),x=n(481415),S=n(785893);const v=(0,u.defineMessages)({stopSuggestRole:{defaultMessage:"Turn off suggesting",id:"topbar.stopsuggestmodel."},tooltip:{defaultMessage:"You’re suggesting",id:"topbarStopSuggestModeButton.tooltip"}});function b(e){let{store:t,isVisible:n}=e;const p=(0,a.O7)(),f=(0,u.useIntl)(),{isShowingTabBar:x,isUnifiedTitleBarEnabled:b}=(0,r.VK)((()=>{var e;return{isShowingTabBar:Boolean(h.Z.state.isShowingTabBar),isUnifiedTitleBarEnabled:Boolean(null===(e=h.Z.state.preferences)||void 0===e?void 0:e.isUnifiedTitleBarEnabled)}}),[]),j=(0,l.yK)((e=>({button:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:256,color:e.text.uiBluePrimary,gap:2,height:24,padding:"0 8px 0 8px",background:e.accentColors.uiBlue[100],...(0,g.X)({noDrag:b?p.device.isElectron&&!x:p.device.isElectronMac&&!x})},hoveredButton:{background:e.accentColors.uiBlue[200]},pressedButton:{background:e.accentColors.uiBlue[300]},suggestionIcon:{height:12,width:12,marginRight:5},text:{fontSize:12,lineHeight:1.5,letterSpacing:-.15},closeIcon:{height:12,width:12,fill:e.text.uiBlueSecondary,marginLeft:5,marginRight:2}})),[b,p.device.isElectron,p.device.isElectronMac,x]),C=(0,o.useCallback)((()=>{m.t({environment:p,blockStore:t,mode:"default",location:"stop_suggest_pill"})}),[p,t]),w=(0,o.useRef)(null);return(0,S.jsx)(s.M,{children:n&&(0,S.jsxs)(i.E.div,{ref:w,initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:.1},children:[(0,S.jsxs)(y.Z,{style:j.button,hoveredStyle:j.hoveredButton,pressedStyle:j.pressedButton,onClick:C,ariaLabel:f.formatMessage(v.stopSuggestRole),children:[(0,c.I)(j.suggestionIcon),(0,S.jsx)("div",{style:j.text,children:(0,S.jsx)(u.FormattedMessage,{id:"topbar.stopsuggestmodel.label",defaultMessage:"Suggesting"})}),(0,d.U)(j.closeIcon)]},"button"),(0,S.jsx)(M,{store:t,origin:w})]})})}function M(e){const{store:t,origin:n}=e,s=(0,u.useIntl)(),i=(0,a.O7)(),l=(0,r.VK)((()=>t.isCommentOnly()),[t]),d=(0,r.VK)((()=>{var e;return null===(e=f.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.dismissed_suggest_mode_tooltip}),[]),c=l||!d,[m,g]=(0,o.useState)(c);return m?(0,S.jsx)(x.U,{origin:n,placementToOrigin:"bottom",content:null,header:(0,S.jsx)(S.Fragment,{children:s.formatMessage(v.tooltip)}),headerStyle:{marginBottom:-2,width:"max-content"},hideCloseButton:!0,shouldDismissUponOutsideClick:!0,onCloseClick:()=>{g(!1),p.g2({environment:i,dismissed:!0})},pointerPosition:"50%",pointerLength:20}):null}},971424:(e,t,n)=>{n.d(t,{EZ:()=>i,FD:()=>o,G5:()=>s,rK:()=>a});const s=220,i=24,o=-7,a=-3},868750:(e,t,n)=>{n.d(t,{O:()=>L});var s=n(667294),i=n(800480),o=n(724405),a=n(253877),r=n(842875),l=n(519889),d=n(604308),c=n(730459),u=n(460709),m=n(319385),p=n(478140),g=n(840721),f=n(213148),h=n(709291),y=n(552275),x=n(672495),S=n(785893);function v(e){const{onClick:t}=e;return(0,S.jsx)(x.Z,{topBorder:!0,children:(0,S.jsx)(y.Z,{focused:!1,icon:(0,f.U)({width:14,marginLeft:0}),title:(0,S.jsx)(h.FormattedMessage,{defaultMessage:"Remove verification",id:"VerificationPropertyOverlayMenu.removeVerificationButton"}),onClick:t,style:{fontSize:14}})})}var b=n(730120),M=n(886628),j=n(628020),C=n(433929),w=n(366653),k=n(793289);const I=(0,h.defineMessages)({placeholder:{id:"VerificationExpiryMenu.pickSpecificDate.placeholder",defaultMessage:"Pick a date"}});function T(e){const{onChange:t,clearCustomDatePicker:n}=e,i=(0,s.useRef)(e.today),o=(0,s.useRef)(e.today.plus({days:1})),[r,l]=(0,s.useState)(!1),d=(0,M.VK)((()=>j.AK.state),[]);return(0,S.jsxs)(x.Z,{mobileStyle:{paddingBottom:10},style:{padding:"12px 0"},children:[(0,S.jsx)(w.Z,{placeholder:C.default.formatMessage(I.placeholder),focused:r,value:"verified"!==e.verificationState.type||e.verificationState.isIndefinite?void 0:a.ME(e.verificationState.dateTimeRange.end),onUpdate:e=>{if(e.error)return;const s=e.value&&a.XI(e.value);s?t({start:i.current,end:s.start}):n()},onFocus:()=>l(!0),onBlur:()=>l(!1),onClearButtonClick:n,hideClearButton:!0}),(0,S.jsx)(k.Z,{firstDayOfWeek:d,value:o.current.toMillis(),selectValue:!1,onChange:e=>{t({start:i.current,end:b.ou.fromMillis(e)})},disabledDays:{before:new Date(o.current.toMillis())}})]})}var Z=n(136700),P=n(569651);const F=(0,n(745238).IU)("infinity",{viewBox:"0 0 40 19",svg:(0,S.jsx)("path",{d:"M0.297852 9.42383C0.297852 11.2695 0.65918 12.876 1.38184 14.2432C2.11426 15.6104 3.13477 16.6748 4.44336 17.4365C5.75195 18.1885 7.26562 18.5645 8.98438 18.5645C10.3613 18.5645 11.6504 18.2715 12.8516 17.6855C14.0625 17.0898 15.2881 16.1963 16.5283 15.0049L20 11.6504L23.4717 15.0049C24.7119 16.1963 25.9375 17.0898 27.1484 17.6855C28.3594 18.2715 29.6484 18.5645 31.0156 18.5645C32.7344 18.5645 34.248 18.1885 35.5566 17.4365C36.8652 16.6748 37.8809 15.6104 38.6035 14.2432C39.3359 12.876 39.7021 11.2695 39.7021 9.42383C39.7021 7.57812 39.3359 5.97168 38.6035 4.60449C37.8809 3.2373 36.8652 2.17773 35.5566 1.42578C34.248 0.664062 32.7344 0.283203 31.0156 0.283203C29.6484 0.283203 28.3594 0.581055 27.1484 1.17676C25.9375 1.7627 24.7119 2.65137 23.4717 3.84277L20 7.19727L16.5283 3.84277C15.2881 2.65137 14.0625 1.7627 12.8516 1.17676C11.6504 0.581055 10.3613 0.283203 8.98438 0.283203C7.26562 0.283203 5.75195 0.664062 4.44336 1.42578C3.13477 2.17773 2.11426 3.2373 1.38184 4.60449C0.65918 5.97168 0.297852 7.57812 0.297852 9.42383ZM3.5791 9.42383C3.5791 8.23242 3.80371 7.19727 4.25293 6.31836C4.71191 5.43945 5.34668 4.76074 6.15723 4.28223C6.96777 3.80371 7.91016 3.56445 8.98438 3.56445C9.88281 3.56445 10.752 3.78418 11.5918 4.22363C12.4316 4.66309 13.3154 5.3125 14.2432 6.17188L17.7002 9.42383L14.2285 12.6758C13.3105 13.5352 12.4316 14.1846 11.5918 14.624C10.752 15.0635 9.88281 15.2832 8.98438 15.2832C7.91016 15.2832 6.96777 15.0439 6.15723 14.5654C5.34668 14.0869 4.71191 13.4082 4.25293 12.5293C3.80371 11.6406 3.5791 10.6055 3.5791 9.42383ZM22.2998 9.42383L25.7568 6.17188C26.6846 5.3125 27.5684 4.66309 28.4082 4.22363C29.248 3.78418 30.1172 3.56445 31.0156 3.56445C32.0898 3.56445 33.0322 3.80371 33.8428 4.28223C34.6533 4.76074 35.2832 5.43945 35.7324 6.31836C36.1914 7.19727 36.4209 8.23242 36.4209 9.42383C36.4209 10.6055 36.1914 11.6406 35.7324 12.5293C35.2832 13.4082 34.6533 14.0869 33.8428 14.5654C33.0322 15.0439 32.0898 15.2832 31.0156 15.2832C30.1172 15.2832 29.248 15.0635 28.4082 14.624C27.5684 14.1846 26.6895 13.5352 25.7715 12.6758L22.2998 9.42383Z"})});var _=n(970693);function A(e){const{verificationState:t,onChange:n,onCustomDateClick:i}=e,a=(0,h.useIntl)(),r=(0,s.useRef)(e.today),l=(0,o.yK)((e=>({title:{fontSize:14,color:e.regularTextColor},optionsContainer:{width:"100%"},clockIconStyle:{width:14,marginLeft:0,marginTop:2}})),[]),c="expired"===t.type||"none"===t.type?(0,S.jsx)(h.FormattedMessage,{defaultMessage:"Verify page",id:"VerificationExpiryPicker.verify.header"}):(0,S.jsx)(h.FormattedMessage,{defaultMessage:"Reverify page",id:"VerificationExpiryPicker.reverify.header"}),u="verified"===t.type&&t.isIndefinite,m="verified"===t.type&&!t.isIndefinite&&t.dateTimeRange.end;return(0,S.jsxs)(x.Z,{title:c,children:[d.Xs.map((e=>{const t=m&&d.fm({start:r.current,end:m})===e;return(0,S.jsx)(y.Z,{focused:!1,icon:(0,Z.m)(l.clockIconStyle),inline:!1,title:(0,S.jsx)("span",{style:l.title,children:(0,S.jsx)(h.FormattedMessage,{defaultMessage:"For {numDays} days",id:"VerificationExpiryMenu.preset.title",values:{numDays:e}})}),caption:a.formatMessage({defaultMessage:"Until {date}",id:"VerificationExpiryMenu.preset.subtitle"},{date:_.mb({dateTime:d.z5(e,r.current).end,intl:a,shortenDateAndRange:!0})}),checkState:!!t,onClick:()=>{return t=e,void n({start:r.current,end:r.current.plus({days:t})});var t}},e)})),(0,S.jsx)(y.Z,{focused:!1,icon:F({width:14,marginLeft:0,marginTop:1}),inline:!1,title:(0,S.jsx)("span",{style:l.title,children:(0,S.jsx)(h.FormattedMessage,{defaultMessage:"Indefinitely",id:"VerificationExpiryPicker.option.indefinitely"})}),onClick:()=>n(),checkState:u},"indefinite"),(0,S.jsx)(y.Z,{focused:!1,icon:(0,P.C)({width:14,marginLeft:0}),title:(0,S.jsx)("span",{style:l.title,children:(0,S.jsx)(h.FormattedMessage,{defaultMessage:"Pick a date",id:"VerificationExpiryPicker.option.customDate"})}),onClick:i},"custom")]})}var B=n(266897),R=n(164369);function D(e){const{getRecordModel:t,actorPointer:n,lastVerifiedDate:s}=e,o=(0,i.Fy)(),a=(0,h.useIntl)(),r=(0,M.VK)((()=>(0,B.$4)(a,(0,B.Hl)({pointer:n,getRecordModel:t}))),[t,a,n]);return(0,S.jsxs)("div",{style:{padding:"8px 14px"},children:[(0,S.jsx)(R.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:o.isMobile,isMultiline:!0,style:{marginBottom:4},children:(0,S.jsx)(h.FormattedMessage,{defaultMessage:"Last verified by {user}",id:"VerificationMetadata.lastVerified",values:{user:r}})}),(0,S.jsx)(R.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:o.isMobile,children:(0,_.mb)({dateTime:s,intl:a})})]})}var O=n(111028);function L(e){const{verificationValue:t,getRecordModel:n,onChange:c,blockId:m,propertyName:f,onClose:h}=e,y=(0,i.O7)(),x=(0,i.Fy)(),b=(0,o.Fg)(),[M,j]=(0,s.useState)(!1),C=(0,s.useMemo)((()=>d.WN(t)),[t]),w="verified"===C.type,k=(0,s.useRef)(a.Uu((0,r.r)())),I=(0,s.useRef)(a.Uu((0,r.r)()).plus({days:1})),Z=e=>{var t;const n=null===(t=y.currentUser)||void 0===t?void 0:t.id;if(!n)return;if(null!=e&&e.end&&e.end.toMillis()<I.current.toMillis())return;const s={table:l.KJ,id:n},i=e?a.OQ.toPersistedDateTimeRange(e):a.OQ.toPersistedDateTime(k.current.toMillis()),o="none"===C.type?"add":"update";V(y,{action:o,verification_page_id:m,verification_expiry:e?e.end.toMillis():void 0}),c({value:[s,i]})};let P={menuType:u.og.Popup,footer:"none"!==C.type&&(0,S.jsx)("div",{style:{borderTop:`1px solid ${b.regularDividerColor}`},children:(0,S.jsx)(D,{lastVerifiedDate:w&&C.isIndefinite?C.startDateTime:C.dateTimeRange.start,getRecordModel:n,actorPointer:C.actorPointer})})};return x.isMobile&&(P={...P,title:f,menuType:u.og.Modal,right:(0,S.jsx)(g.DoneMenuText,{}),onClickRight:h}),(0,S.jsx)(p.Z,{...P,header:!M&&"none"!==C.type&&(0,S.jsx)(S.Fragment,{children:(0,S.jsx)("div",{style:{padding:x.isMobile?10:7,paddingLeft:x.isMobile?20:7,background:x.isMobile?b.popoverBackground:b.tokenInputMenuItemBackground,display:"flex",alignItems:"center",borderBottom:`1px solid ${b.regularDividerColor}`},children:(0,S.jsx)(O.z,{verificationValue:t})})}),children:M?(0,S.jsx)(T,{today:k.current,verificationState:C,onChange:e=>Z(e),clearCustomDatePicker:()=>j(!1)}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(A,{today:k.current,verificationState:C,onChange:e=>Z(e),onCustomDateClick:()=>j(!0)}),(w||"expired"===C.type)&&(0,S.jsx)(v,{onClick:()=>{V(y,{action:"remove",verification_page_id:m}),c({value:void 0})}})]})})}function V(e,t){c.K4(e,"verification_update",t),m.default.logEvent("verification_update",t.action)}},972402:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(535431);class i extends s.Z{}const o=new i},107401:(e,t,n)=>{n.d(t,{AZ:()=>r,at:()=>a,ew:()=>c,vo:()=>d,wI:()=>l});var s=n(296994),i=n(277907);const o=s.FF.dictation,a=(0,i.kF)(o,(e=>e.StopDictationButton)),r=(0,i.kF)(o,(e=>e.StopDictationListener)),l=(0,i.kF)(o,(e=>e.StopDictationButtonMobile)),d=(0,i.kF)(o,(e=>e.DictationBubble)),c=(0,i.kF)(o,(e=>e.DictationAvatar))},583469:(e,t,n)=>{n.d(t,{Is:()=>H,ZP:()=>te});n(430541),n(757658),n(292087);var s=n(667294),i=n(883355),o=n(14577),a=n(490902),r=n(542129),l=n(415095),d=n(745238),c=n(785893);const u=(0,d.IU)("emojiActivities",{viewBox:"0 0 17 17",svg:(0,c.jsx)("path",{d:"M8.22266 16.3281C3.87109 16.3281 0.253906 12.7109 0.253906 8.35938C0.253906 4 3.86328 0.390625 8.21484 0.390625C12.5742 0.390625 16.1914 4 16.1914 8.35938C16.1914 12.7109 12.582 16.3281 8.22266 16.3281ZM8.66016 5.55469L10.8477 7.25L12.8164 6.45312L13.5586 4.00781C12.7852 3.07031 11.7852 2.33594 10.6367 1.89844L8.66016 3.5V5.55469ZM3.62891 6.45312L5.59766 7.25L7.79297 5.55469V3.51562L5.78516 1.89844C4.65234 2.33594 3.65234 3.07031 2.88672 4L3.62891 6.45312ZM1.31641 8.38281C1.32422 9.73438 1.72266 10.9922 2.41797 12.0625L5.07422 12.0234L6.16797 10.625L5.34766 8.08594L3.31641 7.26562L1.31641 8.38281ZM11.3633 12.0547L14.0117 12.0938C14.7148 11.0156 15.1289 9.72656 15.1289 8.38281L13.1289 7.26562L11.0977 8.08594L10.2695 10.6484L11.3633 12.0547ZM8.22266 15.2656C8.88672 15.2656 9.52734 15.1719 10.1367 14.9922L10.6914 12.6016L9.69141 11.3203H6.72266L5.74609 12.5703L6.30859 14.9922C6.91797 15.1719 7.55859 15.2656 8.22266 15.2656Z",fill:"#91918E"})}),m=(0,d.IU)("emojiCustom",{viewBox:"0 0 16 15",svg:(0,c.jsx)("path",{d:"M2.29688 6.72656C1.30469 6.72656 0.804688 6.22656 0.804688 5.19531V1.70312C0.804688 0.671875 1.30469 0.179688 2.29688 0.179688H5.85938C6.85156 0.179688 7.35156 0.671875 7.35156 1.70312V5.19531C7.35156 6.22656 6.85156 6.72656 5.85938 6.72656H2.29688ZM10.1406 6.72656C9.14062 6.72656 8.64062 6.22656 8.64062 5.19531V1.70312C8.64062 0.671875 9.14062 0.179688 10.1406 0.179688H13.6953C14.6875 0.179688 15.1875 0.671875 15.1875 1.70312V5.19531C15.1875 6.22656 14.6875 6.72656 13.6953 6.72656H10.1406ZM2.3125 5.625H5.83594C6.10938 5.625 6.25 5.48438 6.25 5.19531V1.70312C6.25 1.42188 6.10938 1.28125 5.83594 1.28125H2.3125C2.03906 1.28125 1.90625 1.42188 1.90625 1.70312V5.19531C1.90625 5.48438 2.03906 5.625 2.3125 5.625ZM10.1562 5.625H13.6797C13.9531 5.625 14.0859 5.48438 14.0859 5.19531V1.70312C14.0859 1.42188 13.9531 1.28125 13.6797 1.28125H10.1562C9.875 1.28125 9.74219 1.42188 9.74219 1.70312V5.19531C9.74219 5.48438 9.875 5.625 10.1562 5.625ZM2.29688 14.5625C1.30469 14.5625 0.804688 14.0703 0.804688 13.0391V9.53906C0.804688 8.51562 1.30469 8.01562 2.29688 8.01562H5.85938C6.85156 8.01562 7.35156 8.51562 7.35156 9.53906V13.0391C7.35156 14.0703 6.85156 14.5625 5.85938 14.5625H2.29688ZM2.3125 13.4609H5.83594C6.10938 13.4609 6.25 13.3203 6.25 13.0391V9.54688C6.25 9.25781 6.10938 9.11719 5.83594 9.11719H2.3125C2.03906 9.11719 1.90625 9.25781 1.90625 9.54688V13.0391C1.90625 13.3203 2.03906 13.4609 2.3125 13.4609Z",fill:"#32302C"})}),p=(0,d.IU)("emojiFlags",{viewBox:"0 0 15 17",svg:(0,c.jsx)("path",{d:"M1.49902 16.0312C1.17871 16.0312 0.905273 15.7656 0.905273 15.4453V2.46094C0.905273 1.75 1.25684 1.34375 1.7959 1.10156C2.38965 0.835938 2.85059 0.703125 4.06934 0.703125C6.96777 0.703125 8.77246 2.11719 11.5225 2.11719C12.8662 2.11719 13.585 1.78906 13.9678 1.78906C14.4209 1.78906 14.7803 2.03125 14.7803 2.45312V10.3828C14.7803 11.1016 14.4287 11.5078 13.8896 11.75C13.2959 12.0156 12.8428 12.1484 11.624 12.1484C8.87402 12.1484 7.06152 10.7344 4.1709 10.7344C3.02246 10.7344 2.28809 11.0156 2.09277 11.1016V15.4453C2.09277 15.7734 1.82715 16.0312 1.49902 16.0312ZM11.624 10.9688C12.8428 10.9688 13.4912 10.6094 13.6006 10.3516V3.04688C13.0771 3.19531 12.374 3.29688 11.5225 3.29688C8.65527 3.29688 6.81934 1.88281 4.06934 1.88281C2.85059 1.88281 2.20215 2.24219 2.09277 2.5V9.83594C2.53027 9.65625 3.31152 9.55469 4.1709 9.55469C7.17871 9.55469 9.02246 10.9688 11.624 10.9688Z",fill:"#91918E"})}),g=(0,d.IU)("emojiFood",{viewBox:"0 0 19 19",svg:(0,c.jsx)("path",{d:"M2.89355 18.2188C2.13574 18.6953 1.52637 18.4375 1.12793 18.0312C0.666992 17.5703 0.487305 16.9453 0.924805 16.2422L7.44824 5.875C8.96387 3.46875 11.2373 2.82031 13.1279 4.17188C12.9248 2.57812 13.4404 0.304688 14.5654 0.5625C15.2139 0.726562 15.2842 1.58594 15.0498 2.53906C15.9873 1.39062 17.1826 0.617188 17.8779 1.3125C18.5732 2.01562 17.7998 3.21094 16.6514 4.14844C17.6123 3.91406 18.4795 3.98438 18.6357 4.64844C18.9014 5.76562 16.5811 6.28125 14.9873 6.0625C16.2998 7.96875 15.6592 10.2031 13.2842 11.6953L2.89355 18.2188ZM5.57324 13.8125C5.77637 13.6094 6.08887 13.6016 6.2998 13.8125L6.83887 14.3438L7.70605 13.7969L6.97168 13.0859C6.76074 12.875 6.76855 12.5625 6.96387 12.3594C7.1748 12.1562 7.4873 12.1484 7.69043 12.3516L8.59668 13.2422L12.6748 10.6797C14.8076 9.33594 15.0732 7.72656 13.5967 6.22656L12.9326 5.54688C11.6279 4.23438 10.2061 4.28906 8.96387 5.78125L10.4717 7.26562C10.6826 7.47656 10.6826 7.78125 10.4873 7.98438C10.2842 8.19531 9.97168 8.20312 9.76074 7.99219L8.37012 6.625L7.82324 7.49219L8.70605 8.35938C8.91699 8.57031 8.91699 8.88281 8.71387 9.08594C8.50293 9.28906 8.19824 9.29688 7.9873 9.08594L7.26855 8.38281L1.94043 16.8516C1.77637 17.1016 2.04199 17.3594 2.2998 17.1953L5.94824 14.9062L5.58105 14.5391C5.37012 14.3359 5.37012 14.0156 5.57324 13.8125Z",fill:"#91918E"})}),f=(0,d.IU)("emojiNature",{viewBox:"0 0 18 15",svg:(0,c.jsx)("path",{d:"M0.830078 3.47656C0.830078 3.05469 0.876953 1.71875 1.06445 0.960938C1.2832 0.0625 2.18164 0.109375 2.63477 0.640625C3.49414 1.61719 4.5332 1.98438 5.73633 1.98438C7.16602 1.98438 8.45508 1.625 9.72852 1.625C13.4238 1.625 16.1035 4 16.1035 7.28906C16.1035 8.21094 15.9082 9.0625 15.5488 9.8125C16.3535 10.9531 17.3848 12.6016 17.3848 13.5859C17.3848 14.2344 16.9238 14.7734 16.3457 14.7734C16.0723 14.7734 15.8145 14.6406 15.6973 14.2656C15.3301 13.0859 15.1191 12.0469 14.6504 11.1484C13.5098 12.3906 11.7676 13.1328 9.69727 13.1328C4.32227 13.1328 0.830078 9.30469 0.830078 3.47656ZM5.40039 5.29688C5.2832 4.94531 5.66602 4.71094 5.91602 5.04688C6.81445 6.21875 8.12695 6.60938 9.61133 6.85938C11.9551 7.24219 13.5879 7.84375 14.6816 8.8125C14.8379 8.34375 14.9238 7.83594 14.9238 7.28906C14.9238 4.67188 12.7754 2.80469 9.72852 2.80469C9.20508 2.80469 8.6582 2.875 8.0332 2.96094C7.3457 3.05469 6.58008 3.16406 5.73633 3.16406C4.47852 3.16406 3.10352 2.71094 2.22852 1.91406C2.1582 1.85156 2.10352 1.85938 2.08789 1.96094C2.01758 2.38281 2.00977 2.96094 2.00977 3.47656C2.00977 8.65625 4.98633 11.9531 9.69727 11.9531C11.541 11.9531 13.041 11.2734 13.9551 10.1484C12.9316 8.96875 11.7129 8.47656 9.21289 7.88281C7.36914 7.42969 5.89258 6.82031 5.40039 5.29688Z",fill:"#91918E"})}),h=(0,d.IU)("emojiObjects",{viewBox:"0 0 19 23",svg:(0,c.jsx)("path",{d:"M8.66113 2.90625V1.40625C8.66113 1.03906 8.96582 0.726562 9.33301 0.726562C9.7002 0.726562 10.0127 1.03906 10.0127 1.40625V2.90625C10.0127 3.26562 9.70801 3.57812 9.33301 3.57812C8.96582 3.57812 8.66113 3.26562 8.66113 2.90625ZM3.85645 5.45312L2.79395 4.38281C2.53613 4.125 2.53613 3.71094 2.79395 3.4375C3.05957 3.17969 3.49707 3.17969 3.74707 3.4375L4.80176 4.50781C5.05957 4.76562 5.06738 5.1875 4.80176 5.45312C4.54395 5.71875 4.11426 5.71094 3.85645 5.45312ZM13.8564 4.50781L14.9268 3.4375C15.1846 3.17969 15.5986 3.17969 15.8721 3.4375C16.1299 3.71094 16.1299 4.125 15.8721 4.38281L14.8018 5.45312C14.5439 5.71094 14.1299 5.71875 13.8564 5.45312C13.5908 5.1875 13.5986 4.76562 13.8564 4.50781ZM9.33301 5.03125C12.0908 5.03125 14.2705 7.03906 14.2705 9.59375C14.2705 12.4219 12.5752 13.125 12.0986 18.0078C12.0752 18.2812 11.9268 18.4531 11.6377 18.4531H7.02832C6.73926 18.4531 6.59082 18.2812 6.55957 18.0078C6.09082 13.125 4.40332 12.4219 4.40332 9.59375C4.40332 7.03906 6.56738 5.03125 9.33301 5.03125ZM9.33301 6.17969C7.27832 6.17969 5.55176 7.60938 5.55176 9.59375C5.55176 11.6875 6.93457 12.1719 7.60645 17.3047H11.0596C11.7314 12.1719 13.1221 11.6875 13.1221 9.59375C13.1221 7.60938 11.3877 6.17969 9.33301 6.17969ZM2.25488 10.6484H0.754883C0.395508 10.6484 0.0908203 10.3359 0.0908203 9.97656C0.0908203 9.60938 0.395508 9.29688 0.754883 9.29688H2.25488C2.62207 9.29688 2.94238 9.60156 2.94238 9.97656C2.94238 10.3438 2.62207 10.6484 2.25488 10.6484ZM17.8955 10.6484H16.3955C16.0361 10.6484 15.7236 10.3438 15.7236 9.97656C15.7236 9.60156 16.0361 9.29688 16.3955 9.29688H17.8955C18.2627 9.29688 18.5752 9.60938 18.5752 9.97656C18.5752 10.3359 18.2627 10.6484 17.8955 10.6484ZM7.00488 20.0469C6.75488 20.0469 6.55957 19.8594 6.55957 19.6016C6.55957 19.3438 6.75488 19.1562 7.00488 19.1562H11.6611C11.9189 19.1562 12.1143 19.3438 12.1143 19.6016C12.1143 19.8594 11.9189 20.0469 11.6611 20.0469H7.00488ZM9.33301 22.1875C8.17676 22.1875 7.2002 21.6094 7.15332 20.75H11.5127C11.458 21.6094 10.4814 22.1875 9.33301 22.1875Z",fill:"#91918E"})}),y=(0,d.IU)("emojiPeople",{viewBox:"0 0 17 17",svg:(0,c.jsx)("path",{d:"M8.55566 16.3281C4.2041 16.3281 0.586914 12.7109 0.586914 8.35938C0.586914 4 4.19629 0.390625 8.54785 0.390625C12.9072 0.390625 16.5244 4 16.5244 8.35938C16.5244 12.7109 12.915 16.3281 8.55566 16.3281ZM8.55566 15C12.2432 15 15.1963 12.0469 15.1963 8.35938C15.1963 4.67188 12.2354 1.71875 8.54785 1.71875C4.86035 1.71875 1.92285 4.67188 1.92285 8.35938C1.92285 12.0469 4.86816 15 8.55566 15ZM6.23535 7.66406C5.74316 7.66406 5.31348 7.21875 5.31348 6.59375C5.31348 5.96094 5.74316 5.51562 6.23535 5.51562C6.73535 5.51562 7.16504 5.96094 7.16504 6.59375C7.16504 7.21875 6.72754 7.66406 6.23535 7.66406ZM10.8682 7.66406C10.376 7.66406 9.94629 7.21875 9.94629 6.59375C9.94629 5.96094 10.376 5.51562 10.8682 5.51562C11.3682 5.51562 11.7979 5.96094 11.7979 6.59375C11.7979 7.21875 11.3604 7.66406 10.8682 7.66406ZM8.54785 12.2734C6.91504 12.2734 5.82129 11.1875 5.82129 10.6719C5.82129 10.4844 6.00098 10.3984 6.17285 10.4766C6.73535 10.7812 7.41504 11.1406 8.54785 11.1406C9.68066 11.1406 10.3604 10.7891 10.9307 10.4766C11.0947 10.3984 11.2744 10.4844 11.2744 10.6719C11.2744 11.1875 10.1807 12.2734 8.54785 12.2734Z",fill:"#91918E"})}),x=(0,d.IU)("emojiRecents",{viewBox:"0 0 18 17",svg:(0,c.jsx)("path",{d:"M9 16.4297C4.58594 16.4297 0.929688 12.7812 0.929688 8.35938C0.929688 3.94531 4.57812 0.289062 8.99219 0.289062C13.4141 0.289062 17.0703 3.94531 17.0703 8.35938C17.0703 12.7812 13.4141 16.4297 9 16.4297ZM9 14.8438C12.5938 14.8438 15.4844 11.9531 15.4844 8.35938C15.4844 4.76562 12.5859 1.88281 8.99219 1.88281C5.39844 1.88281 2.52344 4.76562 2.52344 8.35938C2.52344 11.9531 5.40625 14.8438 9 14.8438ZM5.04688 9.32812C4.69531 9.32812 4.42969 9.05469 4.42969 8.71094C4.42969 8.35938 4.69531 8.09375 5.04688 8.09375H8.375V3.58594C8.375 3.24219 8.64844 2.96875 8.99219 2.96875C9.34375 2.96875 9.61719 3.24219 9.61719 3.58594V8.71094C9.61719 9.05469 9.34375 9.32812 8.99219 9.32812H5.04688Z",fill:"#91918E"})}),S=(0,d.IU)("emojiSymbols",{viewBox:"0 0 17 17",svg:(0,c.jsx)("path",{d:"M8.88867 16.3281C4.53711 16.3281 0.919922 12.7109 0.919922 8.35938C0.919922 4 4.5293 0.390625 8.88086 0.390625C13.2402 0.390625 16.8574 4 16.8574 8.35938C16.8574 12.7109 13.248 16.3281 8.88867 16.3281ZM8.88867 15C12.5762 15 15.5293 12.0469 15.5293 8.35938C15.5293 4.67188 12.5684 1.71875 8.88086 1.71875C5.19336 1.71875 2.25586 4.67188 2.25586 8.35938C2.25586 12.0469 5.20117 15 8.88867 15ZM8.0293 12.0703C7.77148 12.0703 7.56055 11.9609 7.36523 11.7031L5.45898 9.35938C5.34961 9.21094 5.2793 9.04688 5.2793 8.875C5.2793 8.53125 5.54492 8.25781 5.88086 8.25781C6.09961 8.25781 6.27148 8.32031 6.45898 8.57031L7.99805 10.5625L11.2402 5.35938C11.3887 5.13281 11.584 5.00781 11.7793 5.00781C12.1074 5.00781 12.4199 5.23438 12.4199 5.58594C12.4199 5.75781 12.3184 5.92969 12.2324 6.08594L8.66211 11.7031C8.50586 11.9453 8.28711 12.0703 8.0293 12.0703Z",fill:"#91918E"})}),v=(0,d.IU)("emojiTravel",{viewBox:"0 0 19 18",svg:(0,c.jsx)("path",{d:"M18.3867 8.95312C18.3789 9.85938 17.1367 10.5312 15.6445 10.5312H12.4961C12.0586 10.5312 11.8945 10.6016 11.6367 10.8906L6.38672 16.625C6.22266 16.8047 6.01953 16.9062 5.78516 16.9062H4.87891C4.67578 16.9062 4.55859 16.7188 4.66016 16.5078L7.36328 10.5312L3.39453 10.0781L1.98047 12.6719C1.87891 12.8594 1.70703 12.9453 1.44922 12.9453H1.11328C0.910156 12.9453 0.777344 12.8203 0.777344 12.6172V5.28906C0.777344 5.08594 0.910156 4.95312 1.11328 4.95312H1.44922C1.70703 4.95312 1.87891 5.03906 1.98047 5.23438L3.39453 7.82812L7.36328 7.375L4.66016 1.39844C4.55859 1.17969 4.67578 1 4.87891 1H5.78516C6.01953 1 6.22266 1.09375 6.38672 1.28125L11.6367 7.00781C11.8945 7.30469 12.0586 7.375 12.4961 7.375H15.6445C17.1367 7.375 18.3789 8.03906 18.3867 8.95312Z",stroke:"#91918E"})});var b=n(375071),M=n(554153),j=n(709291),C=n(531701),w=n(530615),k=n(653965),I=n(401898),T=n(368425),Z=n(73657),P=n(411066),F=n(632163),_=n(543145),A=n(672495),B=n(922145),R=n(270177),D=n(433929),O=n(80444),L=n(991049),V=n(598185),E=n(319385),N=n(229798),U=n(938530),K=n(360682),W=n(924990),z=n(883620),q=n(653048),G=n(401496);const H=[{id:"recent",title:(0,c.jsx)(j.FormattedMessage,{id:"emojiPicker.section.recent",defaultMessage:"Recent"}),icon:x},{id:"callout",title:(0,c.jsx)(j.FormattedMessage,{id:"emojiPicker.section.callout",defaultMessage:"Callout"})},{id:"people",category:"People & Body",title:(0,c.jsx)(j.FormattedMessage,{id:"emojiPicker.section.people",defaultMessage:"People"}),icon:y},{id:"nature",category:"Animals & Nature",title:(0,c.jsx)(j.FormattedMessage,{id:"emojiPicker.section.animals",defaultMessage:"Animals and nature"}),icon:f},{id:"food",category:"Food & Drink",title:(0,c.jsx)(j.FormattedMessage,{id:"emojiPicker.section.food",defaultMessage:"Food and drink"}),icon:g},{id:"activities",category:"Activities",title:(0,c.jsx)(j.FormattedMessage,{id:"emojiPicker.section.activity",defaultMessage:"Activity"}),icon:u},{id:"travel",category:"Travel & Places",title:(0,c.jsx)(j.FormattedMessage,{id:"emojiPicker.section.travel",defaultMessage:"Travel and places"}),icon:v},{id:"objects",category:"Objects",title:(0,c.jsx)(j.FormattedMessage,{id:"emojiPicker.section.objects",defaultMessage:"Objects"}),icon:h},{id:"symbols",category:"Symbols",title:(0,c.jsx)(j.FormattedMessage,{id:"emojiPicker.section.symbols",defaultMessage:"Symbols"}),icon:S},{id:"flags",category:"Flags",title:(0,c.jsx)(j.FormattedMessage,{id:"emojiPicker.section.flags",defaultMessage:"Flags"}),icon:p},{id:"custom",title:(0,c.jsx)(j.FormattedMessage,{id:"emojiPicker.section.custom",defaultMessage:"Custom"}),icon:m}],$=Object.fromEntries(H.map((e=>[e.id,e]))),Y={display:"flex",flexDirection:"column"},Q=["💡","👉","☝","👌","🔑","🚧","⚠️","🔥","📌","✂️","❓","🚫","⛔","⏰","☎️","🚨","♻️","✅","🔒","📎","📖","🗣","➡️","📢","🛠","⚙"],J=(0,j.defineMessages)({noResults:{defaultMessage:"No results",id:"emojiPicker.noResults.message"}});let X=!1;class ee extends i.Z{constructor(){super(...arguments),this.filter="",this.splitFilter=[],this.sectionRefs=new w.G((()=>s.createRef())),this.storeTypes={menuListStore:N.Z},this.createCategorySection=e=>{let t=[];if("recent"===e.id)t=z.Z.state.recentEmojis||[];else if("callout"===e.id)t=Q;else if("custom"===e.id)t=se.state.customEmojiIds;else{const{category:n}=e;t=W.Z.state.emojiByCategory[n]||[]}this.filter&&(t=ie(t,this.filter,this.splitFilter));const n=t.map((e=>le(e))).map((e=>ce(e,this.props.onSubmit,this.props.menuRef,this.environment,this.props.iconLoggingData)));if("custom"===e.id&&n.unshift({key:"custom-emoji-add",action:e=>{let{event:t}=e;const n=t.target;V.Z.setState({open:!0,originRect:n.getBoundingClientRect(),uploadFileEventHandlers:this.props.onUpload})},render:e=>(0,c.jsx)(P.Z,{...e,style:{width:U.T8,height:U.T8,display:"flex",justifyContent:"center",alignItems:"center",background:this.theme.accentColors.gray[30],cursor:"pointer",borderRadius:4},children:(0,b.f)({height:14,width:14,color:this.theme.accentColors.gray[400]})})}),0===n.length)return;const s=this.sectionRefs.get(e.id);return{key:e.id,items:n,render:t=>(0,c.jsx)(A.Z,{isTitleUppercase:!0,title:e.title,ref:s,children:(0,c.jsx)("div",{style:ue(this.environment,this.theme),children:t.children})},t.key)}},this.handleScrollOffsetChange=e=>{if(e<100){const{loadEmojiCount:e}=z.Z.state,t=oe(this.environment,this.props.menuRef)*ae(this.environment),n=Math.max(t,this.getAllSectionsEmojiCount());z.Z.setState({...z.Z.state,loadEmojiCount:Math.min(n,e+t)})}}}UNSAFE_willMount(e){super.UNSAFE_willMount(e),z.Z.setState({...z.Z.state,loadEmojiCount:oe(this.environment,this.props.menuRef)*ae(this.environment)}),z.Z.cleanupSkinTonedRecents((0,K.sg)()),async function(){await(0,R.L)(),await async function(){if(!X){await W.Z.waitUntilLoaded();for(const t in W.Z.state.positionalEmojiData){var e;const n=null===(e=(0,r.y)(t,W.Z.state))||void 0===e?void 0:e.keywords;n&&(a.Q4[t]={...a.Q4[t],uniqueKeywords:k.jj(n.flatMap((e=>e.split(" "))))})}X=!0}}()}()}didUpdate(e){const{menuListStore:t}=this.stores;e.filter!==this.props.filter&&t.setState({...t.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}renderComponent(){const{menuListStore:e}=this.stores,t=function(e){const{loadEmojiCount:t}=z.Z.state,n=[];let s=0;for(const i of e){if(!(s+i.items.length<=t)){n.push({...i,items:i.items.slice(0,t-s)});break}n.push(i),s+=i.items.length}return n}(this.getAllSections()),n=this.environment.device.isDesktop&&t.length>0?0:void 0;return 0===t.length&&(this.props.onNoResults&&this.props.onNoResults(),t.push({key:"no results",items:[{key:"no results",action:()=>{},render:(e,t)=>(0,c.jsx)(Z.Z,{...e,caption:D.default.formatMessage(J.noResults)})}],render:e=>(0,c.jsx)(A.Z,{...e})})),(0,c.jsxs)("div",{style:Y,children:[(0,c.jsx)("div",{style:{flexGrow:1},children:(0,c.jsx)(F.Z,{...(s=this.environment,i=this.props.menuRef,{type:F.i.Grid,itemsPerRow:oe(s,i),renderRow:(e,t)=>(0,c.jsx)("div",{style:{display:"flex"},children:e},t)}),store:e,initialFocus:n,sections:t,disableKeyboardArrowWrap:!0,unfocusOnScroll:this.environment.device.isMobile})}),(0,c.jsx)(_.Z,{onChange:this.handleScrollOffsetChange})]});var s,i}getAllSections(){this.filter=l.rJ(this.props.filter)??"",this.splitFilter=this.filter?this.filter.split(" ").filter(Boolean):[];const e=k.oA(ne(this.props.filter,this.props.isCallout).map(this.createCategorySection));return this.props.filter&&this.filter?function(e){let t=0;for(const n of e)t+=n.items.length;return t}(e)>oe(this.environment,this.props.menuRef)*ae(this.environment)/2?e:this.createFilteredSection():e}getAllSectionsEmojiCount(){const e=this.getAllSections();let t=0;for(const n of e)t+=n.items.length;return t}createFilteredSection(){const e=ie(k.xH(ne(this.props.filter,this.props.isCallout).map((e=>"custom"===e.id?se.state.customEmojiIds:e.category&&(0,I.qg)(W.Z.state.emojiByCategory,e.category)?W.Z.state.emojiByCategory[e.category]??[]:[]))),this.filter,this.splitFilter);return 0===e.length?[]:[{key:"search-results",items:e.map((e=>le(e))).map((e=>ce(e,this.props.onSubmit,this.props.menuRef,this.environment,this.props.iconLoggingData))),render:e=>(0,c.jsx)(A.Z,{children:(0,c.jsx)("div",{style:ue(this.environment,this.theme),children:e.children})},e.key)}]}scrollToCategory(e){var t;null===(t=this.sectionRefs.get(e).current)||void 0===t||t.scrollIntoView()}}ee.displayName="EmojiPicker";const te=ee;function ne(e,t){return k.oA([""===e?$.recent:void 0,t&&$.callout,$.people,$.nature,$.food,$.activities,$.travel,$.objects,$.symbols,$.flags,E.default.checkGate({gateName:"custom_emojis"})&&$.custom])}const se=new o.Z((()=>{const e=L.Z.getForSpace((0,B.J)());return{customEmojiIds:(null==e?void 0:e.customEmojiPointers.map((e=>e.id)))??[],getEmojiById:t=>null==e?void 0:e.DEPRECATED_getById(t),customEmojiNames:(null==e?void 0:e.customEmojiNames)??new Set}}),{debugName:"DeprecatedCustomEmojisStore"});function ie(e,t,n){const s=k.oA(e.map((e=>{const s=(0,r.y)(e,W.Z.state);let i=[];if(s&&s.keywords)i=s.keywords||[];else if((0,B.h)(e)){var o;const t=null===(o=se.state.getEmojiById(e))||void 0===o?void 0:o.getName();i=l.xu(t??"")}const a=t.length<3||t.includes(" ")?i:i.map((e=>e.replaceAll(" ",""))),d=a.findIndex((e=>e===`:${t}`));if(-1!==d)return[100-d,e];const c=a.findIndex((e=>e===t));if(-1!==c)return[10*(10-c),e];const u=a.findIndex((e=>e.startsWith(t)));if(-1!==u)return[10-u,e];if(n.length>1){const t=s&&s.uniqueKeywords||[];if(n.every((e=>t.find((t=>t.startsWith(e))))))return[n.length,e]}return a.some((e=>e.includes(t)))?[1,e]:void 0})));return k.MR(s,(e=>-e[0])).map((e=>e[1]))}function oe(e,t){var n,s;const{device:i,WindowSizeStore:o}=e;return i.isPhone?(window.innerWidth-o.getSafePaddingLeftPx(U.$P)-o.getSafePaddingRightPx(U.qJ))/U.mz:i.isTablet?U.tg:null!=t&&null!==(n=t.current)&&void 0!==n&&n.offsetWidth?((null==t||null===(s=t.current)||void 0===s?void 0:s.offsetWidth)-2*U.PS)/U.T8:U.IQ}function ae(e){return e.device.isMobile?U.pq:U.II}function re(e){return void 0===(0,K.sg)()?e:l.Gb(e)}function le(e){var t;const n=(0,K.sg)();if(!(void 0!==n&&0!==n))return e;const s=null===(t=(0,r.y)(e,W.Z.state))||void 0===t?void 0:t.variations;return 5===(null==s?void 0:s.length)||"🤝"===e?(null==s?void 0:s[n-1])??e:e}function de(e,t,n,s,i){t(e),function(e,t,n){if(E.default.checkGate({gateName:"custom_emojis"})){var s;const i=q.Z.getStore((null===(s=O.default.state.currentSpaceStore)||void 0===s?void 0:s.getSpaceId())||""),o=i.state,a=k.jj(k.G0([re(e)],null==o?void 0:o.split(",").filter(Boolean))),r=k.qn(a,U.Nm*oe(n,t));i.setState(r.join(",")),z.Z.setState({...z.Z.state,recentEmojis:r})}else{const s=M.Z.get(z.W),i=k.jj(k.G0([re(e)],l.p4(s))),o=k.qn(i,U.Nm*oe(n,t));M.Z.set(z.W,o.join("")),z.Z.setState({...z.Z.state,recentEmojis:o})}}(e,n,s),i&&T.fA(s,"pick_emoji",{icon:e,...i})}function ce(e,t,n,s,i){var o;const a=(0,B.h)(e)?null===(o=se.state.getEmojiById(e))||void 0===o?void 0:o.getName():l.Hk(e,W.Z.state),r=void 0===(0,K.sg)()?l.yS(e,W.Z.state):[];return{key:e,action:()=>{0===r.length&&de(e,t,n,s,i)},render:o=>(0,c.jsx)(G.Z,{...o,emoji:e,tooltip:a,variations:r,insertEmoji:e=>de(e,t,n,s,i)})}}function ue(e,t){const{device:n,WindowSizeStore:s}=e;return{display:"flex",flexDirection:"column",flexWrap:"wrap",alignItems:"flex-start",...n.isPhone?{background:t.popoverBackground,paddingTop:10,paddingBottom:10,paddingLeft:s.getSafePaddingLeftCSS(U.$P),paddingRight:s.getSafePaddingRightCSS(U.qJ),boxShadow:`0 1px 0 ${t.regularDividerColor}`,marginBottom:1}:{background:C.ZP.transparent,paddingLeft:n.isTablet?U.vP:U.PS,paddingRight:n.isTablet?U.vP:U.PS}}}},401496:(e,t,n)=>{n.d(t,{Z:()=>k});var s=n(667294),i=n(800480),o=n(886628),a=n(490902),r=n(164921),l=n(231945),d=n(301743),c=n(203386),u=n(632163),m=n(526388),p=n(667946),g=n(95477),f=n(922145),h=n(991049),y=n(785893);const x=function(e){let{emojiId:t,size:n}=e;const s=(0,i.O7)();return(0,o.VK)((()=>{var e;const i=(0,f.J)(),o=null===(e=h.Z.getForSpace(i))||void 0===e||null===(e=e.DEPRECATED_getById(t))||void 0===e?void 0:e.getModel();return o?(0,y.jsx)(p.Z,{emojiId:t,emojiName:o.name,emojiUrl:o.url,spaceId:o.space_id,size:n,baseUrl:g.default.domainBaseUrl,currentUserId:s.currentUser.id}):(0,y.jsx)(y.Fragment,{})}),[t,n,s.currentUser.id])};var S=n(938530),v=n(98742),b=n(61766),M=n(360682),j=n(711059),C=n(198534);function w(e,t){const{variations:n,emoji:s,focused:i,onClick:a,onMouseEnter:r,tooltip:l,insertEmoji:d}=e,c=(0,o.qz)(void 0,b.Z);return void 0===(0,o.VK)((()=>(0,M.sg)()),[])&&n&&n.length>0?(0,y.jsx)(_,{buttonPopupStore:c,emoji:s,focused:i,insertEmoji:d,onClick:a,onMouseEnter:r,tooltip:l,variations:n,ref:t}):(0,y.jsx)(Z,{emoji:s,focused:i,onClick:a,onMouseEnter:r,ref:t,tooltip:l})}const k=(0,s.forwardRef)(w);function I(e){const{device:t}=e;return t.isMobile?{width:S.mz,height:S.mz,fontSize:S.jo}:{width:S.T8,height:S.T8,fontSize:S.WB}}function T(e){return{emojiButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,...I(e)},variationMenu:{display:"flex",padding:4}}}const Z=(0,s.forwardRef)((function(e,t){let{events:n,emoji:s,focused:o,onClick:a,onMouseEnter:l,tooltip:d}=e;const c=(0,i.O7)(),{fontSize:u}=I(c);return(0,y.jsx)(m.Z,{allowHover:Boolean(d),renderTooltip:()=>d,closeDelay:0,disableTooltip:!d,render:e=>(0,y.jsx)(r.Z,{ref:t,focused:o,onClick:a,...(0,v.Z)(n||{},(0,v.Z)({onMouseEnter:l},e)),ignoreLocalHoverState:!0,style:T(c).emojiButton,children:(0,f.h)(s)?(0,y.jsx)(x,{size:u,emojiId:s}):(0,y.jsx)(j.Z,{size:u,char:s})},s)})}));function P(e){let{props:t}=e;const n=(0,i.O7)();return(0,y.jsx)("div",{style:T(n).variationMenu,...t})}function F(e){const{parent:t,emoji:n,variations:s,insertEmoji:o}=e,r=(0,i.O7)(),l=(s&&s.length>0?[n,...s]:[n]).map(((n,i)=>({key:n,action:e=>{t.close(),(null==s?void 0:s.length)===a.tN&&(0,C.W)({environment:r,skinTone:i}),o(n,i)},render:t=>(0,y.jsx)(w,{...e,...t,emoji:n,variations:void 0})})));return(0,y.jsx)(d.Z,{debugName:"EmojiPickerMenuItem",capture:!0,allowEsc:!0,children:(0,y.jsx)(u.Z,{type:u.i.Horizontal,initialFocus:0,sections:[{key:"variations",render:e=>(0,y.jsx)(P,{props:e}),items:l}]})})}const _=(0,s.forwardRef)((function(e,t){const{emoji:n,focused:i,onClick:o,onMouseEnter:a,tooltip:r,variations:d,insertEmoji:u,buttonPopupStore:m}=e,p=(0,s.useCallback)((()=>function(e){e.setState({...e.state,open:!1})}(m)),[m]),g=(0,s.useCallback)((e=>function(e,t){var n;null===(n=e.preventDefault)||void 0===n||n.call(e),t.setState({...t.state,open:!0})}(e,m)),[m]);return(0,y.jsx)(c.Z,{debugName:"EmojiPickerMenuItem",capture:i,onEnter:g,onEsc:p,children:(0,y.jsx)(l.ZP,{buttonPopupStore:m,popupType:l.Z4.Popup,renderOrigin:e=>(0,y.jsx)(Z,{ref:t,emoji:n,focused:i,onClick:o,onMouseEnter:a,tooltip:r,events:e}),render:e=>(0,y.jsx)(F,{parent:e,emoji:n,variations:d,insertEmoji:u})})},n)}))},198534:(e,t,n)=>{n.d(t,{W:()=>j,Z:()=>M});n(667294);var s=n(800480),i=n(886628),o=n(490902),a=n(709291),r=n(210228),l=n(237181),d=n(231945),c=n(301743),u=n(268894),m=n(632163),p=n(526388),g=n(98742),f=n(825464),h=n(80444),y=n(61766),x=n(319385),S=n(883620),v=n(401496),b=n(785893);function M(){const e=(0,i.VK)((()=>{var e;return null===(e=h.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.emoji_picker_skin_tone}),[]),t=(0,s.O7)(),n=(0,i.qz)(void 0,y.Z);return(0,b.jsx)(p.Z,{renderTooltip:()=>(0,b.jsx)(a.FormattedMessage,{defaultMessage:"Select skin tone",id:"emojiPickerSkinTonePicker.selectSkinTone"}),placement:f.u.Bottom,render:s=>(0,b.jsx)(d.ZP,{buttonPopupStore:n,popupType:d.Z4.Popup,renderOrigin:t=>(0,b.jsx)(u.DO,{icon:()=>(0,b.jsx)("div",{style:{paddingRight:6},children:void 0!==e?o.YN[e]:"✋"}),style:{fontSize:20,...x.default.checkGate({gateName:"custom_emojis"})?{border:"none"}:{}},...(0,g.Z)(t,s)}),render:n=>function(e){const{parent:t,environment:n,currentSkinTone:s}=e,i=o.YN.map(((e,s)=>({key:e,action:()=>{t.close(),j({environment:n,skinTone:s})},render:t=>(0,b.jsx)(v.Z,{...t,insertEmoji:()=>{},emoji:e,variations:void 0,tooltip:void 0})})));return(0,b.jsx)(c.Z,{debugName:"EmojiPickerSkinTonePicker",capture:!0,allowEsc:!0,children:(0,b.jsx)(m.Z,{type:m.i.Horizontal,initialFocus:s,sections:[{key:"variations",render:e=>(0,b.jsx)("div",{style:{display:"flex",padding:4},...e}),items:i}]})})}({parent:n,environment:t,currentSkinTone:e}),...s})})}function j(e){const{environment:t,skinTone:n}=e,{currentUserSettingsStore:s}=h.default.state;s&&(void 0!==n&&S.Z.cleanupSkinTonedRecents(n),r.createAndCommit({userAction:"mediaPicker.setEmojiSkinTone",environment:t,perform:e=>{l.d2({userSettingsStore:s,transaction:e,data:{emoji_picker_skin_tone:n}})}}))}},883620:(e,t,n)=>{n.d(t,{W:()=>c,Z:()=>m});var s=n(749085),i=n(415095),o=n(554153),a=n(653965),r=n(80444),l=n(319385),d=n(653048);const c="recentEmojis";class u extends s.default{getInitialState(){return{recentEmojis:[],loadEmojiCount:0}}cleanupSkinTonedRecents(e){if(l.default.checkGate({gateName:"custom_emojis"})){var t,n;const s=d.Z.getStore((null===(t=r.default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId())||""),o=a.jj(null===(n=s.state)||void 0===n?void 0:n.split(",").filter(Boolean).map((t=>void 0===e?t:i.Gb(t))));return s.setState(o.join(",")),this.setState({...this.state,recentEmojis:o}),o}{const t=a.jj(i.p4(o.Z.get(c)).map((t=>void 0===e?t:i.Gb(t))));return o.Z.set(c,t.join("")),this.setState({...this.state,recentEmojis:t}),t}}}const m=new u},653048:(e,t,n)=>{n.d(t,{Z:()=>r});var s=n(453809),i=n(749085),o=n(430548);class a extends i.default{getInitialState(){return{stores:{}}}getStore(e){return this.state.stores[e]||(this.state.stores[e]=new s.D({key:`recentEmojis:${e}`,namespace:o.$p,important:!0,trackingType:"necessary"})),this.state.stores[e]}}const r=new a},274244:(e,t,n)=>{n.d(t,{U:()=>a});var s=n(800480),i=n(886628),o=n(893586);function a(e){const t=(0,s.O7)();return(0,i.VK)((()=>{const n=null==e?void 0:e.id;if(n)return o.Z.getData(t,{spaceId:n})}),[t,e])}},764286:(e,t,n)=>{n.d(t,{u:()=>a});var s=n(80444),i=n(319385),o=n(215010);function a(e){const{currentUserSettingsStore:t}=s.default.state;if(!t)return!1;const n=(0,o.e2)(t);return!("number"==typeof n&&n>7)&&(!e.device.isMobile&&"on"===i.default.getEligibleGroup({experimentId:"slash_menu_tooltip",defaultGroup:"control"}))}},145567:(e,t,n)=>{n.d(t,{G7:()=>a,Gh:()=>l,LR:()=>o,gU:()=>r,jo:()=>i});var s=n(401898);const i="fileTypeAnyFiles",o="fileTypeImages",a="fileTypeVideos",r="fileTypeNone";function l(e){let{fileMimeType:t,allowedType:n}=e;switch(n){case i:return!0;case o:return function(e){return e.startsWith("image")&&!e.includes("photoshop")}(t);case a:return function(e){return e.startsWith("video")}(t);case r:return!1;default:(0,s.t1)(n)}}},551783:(e,t,n)=>{n.d(t,{Bo:()=>ne,eQ:()=>se,QG:()=>ce,ol:()=>ye,fn:()=>le,_W:()=>xe,vs:()=>Se,O2:()=>ie,UF:()=>he,Z3:()=>de,w1:()=>ve,rZ:()=>re,s0:()=>ae,GH:()=>ge,hc:()=>me,hD:()=>pe,pk:()=>ue,i2:()=>fe,$$:()=>oe,LQ:()=>Y,$3:()=>J,y6:()=>te,Tz:()=>X,oQ:()=>ee,Oh:()=>be});n(21703);var s=n(701302),i=n(427328),o=n(180951),a=n(76233),r=n(211342),l=n(483249),d=n(106404),c=n(536280),u=n(245990),m=n(567060),p=n(628020),g=n(27724),f=n(631781),h=n(742858),y=n(524677),x=n(210228),S=n(353471);var v=n(452423),b=n(384084),M=n(137231),j=n(498724),C=n(898104),w=n(492022),k=n(457819),I=n(18821),T=n(922705),Z=n(745162),P=n(224646),F=n(938676),_=n(444534),A=n(905162),B=n(80444),R=n(798180),D=n(316772),O=n(319385),L=n(803418),V=n(319111),E=n(619671),N=n(156638),U=n(155320),K=n(924666),W=n(119037),z=n(268056),q=n(367669),G=n(918514),H=n(273959),$=n(489086);function Y(e){const{environment:t}=e,{isMobileNative:n,osVersion:s,isIOS:i}=t.device;return!!n&&(!i||!r.isLessThanVersion(s,[14,0]))}const Q=!1;function J(e,t,n){var s;const{NativeMobileActionBarStore:a}=e,r=Q||Boolean(null==a?void 0:a.state.enableShouldShowDebugging);if(!function(e,t,n){var s;const{device:a,NativeMobileActionBarStore:r,TabbedRouterStore:l}=e,d=Q||Boolean(null==r?void 0:r.state.enableShouldShowDebugging);if(!a.isMobile)return Me(d,"canShowMobileActionBar = false (reason: !device.isMobile)"),!1;if((0,G.__)(e)&&O.default.checkGate({gateName:"mab_consider_navigation_top_page"})){const e=(0,i.w_)(l.state);if("web"!==e.type||"page"!==(0,i._r)(e).route.name)return Me(d,"canShowMobileActionBar = false (reason: top page is not a web page)"),!1}if(U.default.state.open)return Me(d,"canShowMobileActionBar = false (reason: quickFindOpen)"),!1;if(!a.isMobileNative&&V.Z.state.open)return Me(d,"canShowMobileActionBar = false (reason: !device.isMobileNative && MentionMenuStore.state.open)"),!1;if(a.isMobileNative&&T.ZP.state.enabled)return Me(d,"canShowMobileActionBar = false (reason: !device.isMobileNative && DictationStore.state.open)"),!1;if(K.default.isEditingComment())return Me(d,"canShowMobileActionBar = false (reason: TextSelectionStore.isEditingComment())"),!1;const c=(0,k.RR)(D.default.state),u=null===(s=R.default.getActiveSession())||void 0===s?void 0:s.hasPendingOperations();if(c||u)return Me(d,"canShowMobileActionBar = false (reason: isCompletionsPopupActive || hasPendingEdits)"),!1;if(!E.Z.state.isOpen&&Y({environment:e})&&L.Z.hasOpenPopups())return Me(d,"canShowMobileActionBar = false (reason: !PageTemplateModalStore.state.open && isNativeMobileActionBarAvailable({ environment }) && GlobalPopupStore.hasOpenPopups() > 0)"),!1;if(E.Z.state.isOpen){var m;const e=E.Z.state,t=null===(m=e.collectionContextStore)||void 0===m?void 0:m.normalizedSchemaStore.state;if(!t)return Me(d,"canShowMobileActionBar = false (reason: !collectionSchema)"),!1;const n=(0,o.Qm)({schema:t,property:e.property});if(!n||"text"!==n.type||n.ai_inference)return Me(d,"canShowMobileActionBar = false (reason: PageBlockPropertyValueOverlayStore.state.isOpen && propertySchema.type !== text)"),!1}return P.in(e)&&F.sidebarOpenStore.state?(Me(d,"canShowMobileActionBar = false (reason: sidebarHelpers.sidebarIsExpanded(environment) && sidebarOpenStore.get()"),!1):(0,W.ryx)()?!!(0,W.J5S)({environment:e,blocks:[t],publicEditMode:n})||(Me(d,"canShowMobileActionBar = false (reason: !_canEdit)"),!1):(Me(d,"canShowMobileActionBar = false (reason: !currentPageIsNotLocked())"),!1)}(e,t,n))return Me(r,"shouldShowMobileActionBar = false (reason: !canShowMobileActionBar)"),{canShow:!1,canShowNativeBar:!1,shouldShow:!1};const l=Y({environment:e});if(a&&null!==a.state.menuType&&!(0,p.JE)())return Me(r,"shouldShowMobileActionBar = true (reason: NativeMobileActionBarStore && NativeMobileActionBarStore.state.menuType !== null"),{canShow:!0,canShowNativeBar:l,shouldShow:!0};const d=K.default.state;if("editing"!==d.mode)return Me(r,"shouldShowMobileActionBar = false (reason: TextSelectionStore.state.mode !== editing"),{canShow:!0,canShowNativeBar:l,shouldShow:!1};const c=d.multiSelection,u=(0,Z.L5)(c),m=u.some((e=>e.editable.props.disableStyleAnnotations)),g=u.some((e=>e.editable.props.disableMobileActionBar)),f=u.some((e=>e.editable.props.disableComment));return u&&g?(Me(r,"shouldShowMobileActionBar = false (reason: !renderedBlocks || !disableMobileActionBar)"),{canShow:!0,canShowNativeBar:l,shouldShow:!1}):(Me(r,"shouldShowMobileActionBar = true"),{shouldShow:!0,canShowNativeBar:l,disableStyleAnnotations:m,disableComment:f,isEmpty:(0,z.iG)(c)&&0===c.end.index&&0===(null===(s=(0,$.x0)(c.end.store))||void 0===s?void 0:s.endIndex)})}function X(e){const{environment:t,store:n}=e,{isPhone:s}=t.device,i=B.default.state.currentLoadingContainerStore,o=Boolean(null==n?void 0:n.isCollectionView()),a=Boolean(null==n?void 0:n.getAssociatedCollectionStore()),r=t.currentUser.isLoggedIn(),l=N.Z.state.open;return Boolean(!a&&!o&&!l&&s&&n&&i&&n.isDefined()&&n.canEdit()&&!n.hasContent()&&r&&i.state.ready)}function ee(e,t){const n=(0,A.Y)("supportsNativeMobileDynamicActionBar"),s=K.default.state;if("editing"===s.mode)return!t.state.isComposing&&!(0,z.iG)(s.multiSelection)||!n&&_.g$.getSimpleTableCellFromTextSelection();const i=e.state.savedTextSelectionStoreState;return!(!i||"editing"!==i.mode)&&!(0,z.iG)(i.multiSelection)}function te(e){const{NativeMobileActionBarStore:t,device:n}=e;return Boolean(t&&null!==t.state.menuType&&!n.isTablet&&!n.isAndroid&&!(0,A.Y)("supportsMobileActionBarNativeActionMenuWithoutIgnoreSelectionArea"))}function ne(e){if((0,q.YF)(e))return!1;const{stores:t}=g.default.state;return t.length>0&&t[0].canEdit()&&!t[0].isNavigableBlock()&&!Boolean(_.g$.getSimpleTableCellFromTextSelection())}function se(e,t){return!(0,q.YF)(e)&&t.canEdit()}function ie(e){"editing"===K.default.state.mode&&(x.createAndCommit({userAction:"mobileActionBarHelpers.handleIndent",environment:e,perform:t=>{M.n2({environment:e,transaction:t,shiftKey:!1})}}),be(e,"indent"))}function oe(e){"editing"===K.default.state.mode&&(x.createAndCommit({userAction:"mobileActionBarHelpers.handleUnindent",environment:e,perform:t=>{M.n2({environment:e,transaction:t,shiftKey:!0})}}),be(e,"unindent"))}function ae(e){x.createAndCommit({userAction:"mobileActionBarHelpers.handleMoveUp",environment:e,perform:t=>{M.fs({environment:e,transaction:t,direction:"up"})}}),be(e,"move-up")}function re(e){x.createAndCommit({userAction:"mobileActionBarHelpers.handleMoveDown",environment:e,perform:t=>{M.fs({environment:e,transaction:t,direction:"down"})}}),be(e,"move-down")}function le(e){const t=g.default.state.stores[0],n=K.default.state;if(t&&"editing"===n.mode){const{multiSelection:s}=n,i=(0,$.hn)(s.end.store)||(0,$.mK)(s.start.store);x.createAndCommit({userAction:"mobileActionBarHelpers.handleDelete",environment:e,perform:e=>{h.Od({store:t,transaction:e})}});if(_.g$.getSimpleTableCellFromTextSelection())x.createAndCommit({userAction:"mobileActionBarHelpers.handleDelete",environment:e,perform:t=>{_.HM.clearSelectedCell({environment:e,transaction:t})}});else if(i){const t=(0,H.sQ)(i);y.eP({environment:e,store:t}),y.Db(e)}else y.ZH({debug:{userAction:"mobileActionBarHelpers.handleDelete"},environment:e});be(e,"remove")}}function de(e){m.lZ({environment:e,mentionTypes:{page:!0,heading:!0,createPage:!0,user:!0,inviteUserToWorkspace:!1,inviteUserToPage:!0,bot:!0,date:!0,reminder:!0,templateVariable:!0,group:!0}}),be(e,"mention")}function ce(e){const t=K.default.state;if("empty"===t.mode){const t=(0,p.RM)();if(!t)throw new Error("No root store.");y.Ys({environment:e,store:t})}else if((0,z.iG)(t.multiSelection)){const n=(0,H.sQ)(t.multiSelection.start.store);y.Ys({environment:e,store:n})}(0,w.toggleInitialPrompt)({from:"mobile_action_bar",environment:e}),be(e,"ai")}function ue(e,t){j.aS({environment:e,annotation:t}),be(e,t[0])}function me(e,t,n){const{NativeMobileActionBarStore:s}=e;null==s||s.update((e=>({...e,menuType:t,shouldRestoreSelectionForMenu:n})))}function pe(e,t,n){const{NativeMobileActionBarStore:s}=e;null==s||s.update((e=>({...e,isSubMenuOverridden:n,subMenuType:t}))),null===t?b.xv():null!==t&&be(e,t)}function ge(e){v.KX(e),be(e,"redo")}function fe(e){v.Yw(e),be(e,"undo")}function he(e){u.dz({type:"focusOnly",focus:!0}),be(e,a.GKr.Link)}function ye(e,t){const n=g.default.state.stores[0];if(!n)return;const s=K.default.state,i="empty"!==s.mode&&s.multiSelection;i&&!(0,z.iG)(i)?(I.WD({environment:e,blockStore:n,multiSelection:i}),be(e,"comment",t)):(I.yw({environment:e,blockStore:n}),be(e,"discuss",t))}function xe(e){c.qn({environment:e,analyticsFrom:"rich_text_menu"}),be(e,"equation")}function Se(e){!async function(e){const t=g.default.state.stores,n=await S.y({multiple:!0,accept:e.device.isIOS?"image/*, video/*":"image/*"}),s=g.default.getCurrentRecordCache(),i=p.qQ(e);0!==n.length&&s&&x.createAndCommit({userAction:"mobileActions.takePicture",environment:e,perform:o=>{var a,r;const l=f.z({environment:e,files:n,inMemoryRecordCache:s,pageWidth:i,transaction:o,spaceId:0!==t.length?t[0].pointer.spaceId:null===(a=(0,p.RM)())||void 0===a?void 0:a.pointer.spaceId,useCrdt:0!==t.length?t[0].useCrdt():(null===(r=(0,p.RM)())||void 0===r?void 0:r.useCrdt())??!1});h.is({environment:e,blocks:l,selection:t,transaction:o,replaceEmptyTextBlock:!0}),y.ZH({debug:{userAction:"mobileActions.takePicture"},environment:e})}})}(e),be(e,"take_picture")}function ve(e,t,n){const{device:i}=e,o=i.isMobileNative&&i.isIOS&&i.isPhone;o||y.Z5({environment:e,stores:g.default.state.stores}),t&&n?d.Qn({environment:e,stores:g.default.state.stores,actionSectionGroupKey:"default",left:t,top:n,showInput:!1,analyticsFrom:"mobile_more_menu"}):d.$Z({environment:e,stores:g.default.state.stores,actionSectionGroupKey:"default",showInput:!1,analyticsFrom:"mobile_more_menu"}),be(e,"more"),s.default.afterNextFlush((()=>{o&&C.sD()}))}function be(e,t,n){l.YO(e,{itemName:t,from:n})}function Me(e,t){e&&console.log(t)}},220095:(e,t,n)=>{n.d(t,{AQ:()=>m,EB:()=>c,MR:()=>u});n(757658);var s=n(772141),i=n(653965),o=n(619584),a=n(88893),r=n(288280),l=n(367669);const d=18e4;function c(e){if(e&&e.blockId)return e.blockId}function u(e,t){const n=e.currentUser.id;if(t.userId===n)return!0;{const e=Date.now();return Boolean(t.present&&t.activityTimestampNearestMinuteMs&&e-t.activityTimestampNearestMinuteMs<=d)}}function m(e,t){const n=r.subscriptionDataStoreInstance.state,{remotePresenceData:d,rootStore:c}=t.state;if(!c||!c.canEdit()||!n)return[];let u=[];d&&i.M6(d,(e=>{e&&e.userId&&u.push(e)}));const{pageId:m,lastViewTime:p,lastExitTime:g,...f}=e.state;i.M6(f,(e=>{e.isDefined()&&u.push({userId:e.getUserId(),activityTimestampNearestMinuteMs:(0,o.ud)(e.getVisitedAt()),present:!1})})),u=i.mN(u,(e=>e.userId));const h=(0,l.YO)(c).map((e=>{let{permissionItem:t}=e;return t})).filter(s.jg).map((e=>e.user_id)),y=(0,a.CM)(n).map((e=>e.userId)),x=i.G0(h,y);return u=u.filter((e=>!!x.includes(e.userId)&&!(!e.present&&!f[e.userId]))),u=i.MR(u,(e=>{let{activityTimestampNearestMinuteMs:t}=e;return t?-t:0})),u}},598481:(e,t,n)=>{n.d(t,{J:()=>d});var s=n(401898),i=n(640506);var o=n(170060),a=n(88893),r=n(535057),l=n(288280);function d(e){let{environment:t}=e;const n=(0,r.zt)(),d=l.subscriptionDataStoreInstance.state,c=(0,a.XX)(d);return function(e){let{subscriptionTier:t,subscriptionCreatedAtTime:n,useLegacyBehavior:o}=e;return"enterprise"===t||!("plus"!==t||!o)&&(0,s.$K)(n)&&n<i.Xn}({subscriptionTier:n,subscriptionCreatedAtTime:null==c?void 0:c.created,useLegacyBehavior:!(0,o.fX)()})}},28092:(e,t,n)=>{n.d(t,{v:()=>g,E:()=>f});n(252262),n(324506);var s=n(800480),i=n(886628),o=n(151744),a=n(519889),r=n(653965),l=n(667294),d=n(376719);var c=n(206258),u=n(250557),m=n(288280),p=n(883165);function g(e){var t;let{spaceStore:n,request:o}=e;const l=(0,s.O7)(),d=(0,i.VK)((()=>{if(o)return new c.U6(l,{id:o.getForActorId(),table:a.KJ}).getModel()}),[o,l]),u=o&&d?{accessRequest:o,forActor:d}:void 0;return null===(t=f({spaceStore:n,requests:(0,r.oA)([u])}))||void 0===t?void 0:t.at(0)}function f(e){let{spaceStore:t,requests:n}=e;const a=function(e){let{spaceStore:t,requests:n}=e;const o=(0,s.O7)(),a=function(e){const t=(0,d.U)(e);return(0,l.useCallback)((e=>t.memberEmails.has(e)?"member":t.guestEmails.has(e)?"guest":void 0),[t])}(m.subscriptionDataStoreInstance),r=(0,i.VK)((()=>null==n?void 0:n.map((e=>({email:e.forActor.email,currentRole:a(e.forActor.email)})))),[n,a]),c=o.currentUser.id,g=c?(0,p.VK)(t,c):void 0;return(0,u.WT)({space:t,spaceUser:g,team:void 0,optimism:"optimistic",invitees:r??[]})}({spaceStore:t,requests:n});return(0,i.VK)((()=>null==n?void 0:n.map((e=>{var t;const n=(0,o.Z)(e.accessRequest),s=null==a||null===(t=a[e.forActor.email])||void 0===t?void 0:t.type;return"guest_invite_request"!==n?n:"cannot_add"===s?"space_membership_request":"guest_invite_request"}))),[n,a])}},73205:(e,t,n)=>{n.d(t,{Z:()=>i});var s=n(667294);function i(e){const[t,n]=s.useState(!1);return s.useEffect((()=>{const t=window.matchMedia(e);function s(){n(t.matches)}return s(),t.addEventListener("change",s),()=>{t.removeEventListener("change",s)}}),[e]),t}},284123:(e,t,n)=>{n.d(t,{E:()=>l});var s=n(886628),i=n(401898),o=n(798165),a=n(440134),r=n(80444);function l(e){let{store:t}=e;return(0,s.VK)((()=>{const e=(0,a.B)({blockId:t.id,setting:"publicAccess"});if((0,i.$K)(e))return e;const n=r.default.state.currentSpaceStore,s=(0,o.VP)(t);return s?{disabled:Boolean(s.getDisablePublicAccess()),disabledBy:"team"}:!s&&null!=n&&n.getDisablePublicAccess()?{disabled:!0,disabledBy:"space"}:{disabled:!1}}),[t])}},400135:(e,t,n)=>{n.d(t,{Z:()=>se});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(709291),l=n(531701),d=n(653965),c=n(781918),u=n(203386),m=n(526388),p=n(207567),g=n(274244),f=n(100859),h=n(883165),y=n(711985),x=n(147082),S=n(655899),v=n(88411),b=n(910039),M=n(785893);const j=function(e){const{flowId:t,store:n,disabled:s,placeholder:r,right:c,focus:u,hideIconColorAndTooltips:m,showEmptyError:p,origin:g,onFocus:f,onSubmit:h,onInputChanged:j}=e,C=(0,i.O7)(),w=(0,i.Fy)(),k=(0,o.qz)(e.inviteTargetsStore,S.ZP),I=(0,o.VK)((()=>k.state.inviteTargets),[k]),T=(0,o.VK)((()=>k.state.tokenQuery),[k]),Z=I.map((e=>{const t="newUser"===e.type?e.value.email:"invalidUser"===e.type?e.value.text:e.value.id;return(0,M.jsx)(b.Z,{store:n,target:e,showRemoveButton:!0,tokenType:m?"member":void 0,onClickRemove:()=>y.P({inviteTargetsStore:k,targetToRemove:e})},t)})),P=(0,a.yK)((e=>({tokenSpan:{maxWidth:"100%"},tokenInputMenuItem:{paddingTop:Z.length>0?4:6,paddingLeft:4,paddingRight:4,paddingBottom:4,borderRadius:4,minHeight:32,...u&&{background:"none"},...s&&{background:e.inputBackground,color:e.mediumTextColor,fill:l.ZP.white,opacity:.4}},inputAndTokenWrapRight:{gap:2},tokenInputMenuItemInput:{paddingTop:0},warningMessage:{color:"#DE5550"}})),[u,s,Z]);return(0,M.jsx)(x.ZP,{focus:u,focusAfterAnimation:!0,onClick:()=>{w.isMobile||null==f||f()},format:x.UR.Share,value:T,onChange:e=>y.j({environment:C,event:e,inviteTargetsStore:k,inviteOrigin:g,flowId:t,onInputChanged:j}),type:"email",tokens:Z,disabled:s,autoComplete:"off",placeholder:r,onRemoveLastToken:()=>{k.setState({...k.state,inviteTargets:k.state.inviteTargets.slice(0,-1)})},right:c,showBorder:!0,inputStyle:P.tokenInputMenuItemInput,inputAndTokenWrapRightStyle:P.inputAndTokenWrapRight,style:P.tokenInputMenuItem,onSubmit:h,inputFullWidth:!0,message:(0,M.jsx)(v.z,{invalidInvites:(0,d.oA)(I.map((e=>"invalidUser"===e.type?e:void 0))),showEmptyError:p,styles:P.warningMessage})})};var C=n(8675),w=n(222508),k=n(513394),I=(n(21703),n(772141)),T=n(137810),Z=n(195209),P=n(158297),F=n(164369),_=n(544385),A=n(118168),B=n(626907),R=n(367669),D=n(853353),O=n(26781),L=n(80444),V=n(535057),E=n(288280);function N(e){const{store:t,sudoModeStore:n,personPropertyInviteStore:a,onInviteCompleteFn:l,inviteOrigin:d}=e,u=(0,i.O7)(),p=z(),g=(0,o.qz)(e.inviteTargetsStore,S.ZP),f=(0,o.VK)((()=>a.state.isLoading),[a]),h=(0,s.useCallback)((e=>{a.setState({...a.state,isLoading:e,focus:k.S.NoFocus})}),[a]),[y,x]=(0,s.useState)("member"),v=(0,o.VK)((()=>{const{emailMessage:e}=a.state;return e}),[a]),b=(0,o.VK)((()=>{const{role:e}=a.state;return e}),[a]),j=(0,r.useIntl)(),C=(0,o.VK)((()=>a.state.flowId),[a]),T=(0,o.VK)((()=>L.default.state.currentSpaceStore),[]),P=(0,o.VK)((()=>t.canEditMembership()),[t]),F=(0,o.VK)((()=>(0,B.B)({inviteTargetsStore:g})),[g]),N=(0,s.useCallback)((async()=>{await w.Uw({environment:u,inviteTargetsStore:g,personPropertyInviteStore:a,allowShowEmptyError:!0})}),[u,g,a]),q=(0,s.useCallback)((()=>{const e=(0,B.B)({inviteTargetsStore:g}),t=e.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),n=e.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return R.Xu({subscriptionData:E.subscriptionDataStoreInstance.state,newGuestIds:[...t,...n]})}),[g]),G=(0,o.VK)((()=>q()),[q]),H=(0,o.VK)((()=>R.Z9(E.subscriptionDataStoreInstance.state)),[]),$=(0,D.Z)(t),Y=(0,o.VK)((()=>{if($.isGuestRequestRequired)return!1;const e=$.isStoreInTeam&&!$.teamAllowsGuests,t=!$.isStoreInTeam&&!$.spaceAllowsGuests||$.isStoreInTeam&&!$.teamAllowsGuests&&!$.spaceAllowsGuests,n=F.some((e=>"newUser"===e.type||("existingUser"===e.type?"none"===e.spaceRole||"not_in_space"===e.spaceRole:void 0)));return(e||t)&&n}),[F,$]),Q=(0,o.VK)((()=>null==T?void 0:T.getRole()),[T]),J=(0,o.VK)((()=>!(!Q||!(0,I.RN)(Q))&&!(!T||T.getDisableMembershipRequests())),[Q,T]),X=(0,o.VK)((()=>!!(Q&&(0,I.dy)(Q)&&(0,V.Mk)())||(J||x("guest"),!1)),[Q,J,x]),ee=(0,O.S)(t),te=v.length>1e3,ne=(0,s.useCallback)((e=>{const{response:t,shouldDoCompleteFn:n,invitedUserEmails:s,isRequestMember:i}=e;t.success?n&&(c.Y7(u,{invited_user_count:s.length,is_success:t.success,can_add_member:X,invite_option:y,origin:d,invite_flow_id:C}),w.TW({success:t.success,invitedUserEmails:s,isRequestMember:i}),h(!1),l(t)):(w.TW({success:t.success,invitedUserEmails:s}),c.Y7(u,{invited_user_count:s.length,is_success:t.success,can_add_member:X,invite_option:y,origin:d}))}),[l,C,h,u,y,X,d]),se=(0,s.useCallback)((async e=>{const{invitedUserEmails:s,shouldDoCompleteFn:i}=e;return await w.GZ({environment:u,inviteOrigin:d,role:b,emailMessage:v,inviteTargetsStore:g,blockStore:t,sudoModeStore:n,flowId:C,onInviteComplete:e=>{ne({response:e,shouldDoCompleteFn:i||!1,invitedUserEmails:s})}})}),[u,b,v,t,n,C,g,ne,d]),ie=(0,s.useCallback)((async e=>{const{invitedUserEmails:t,disable_invite_email:n,guestInviteResponse:s,shouldDoCompleteFn:i}=e;if(!T)return null;const o=null!=s&&s.success?s.invitedUsers:void 0;await w.E6({environment:u,spaceStore:T,flowId:C,onInviteComplete:e=>{ne({response:e,shouldDoCompleteFn:i||!1,invitedUserEmails:t})},intl:j,invitedUsers:o,inviteTargetsStore:g,inviteOrigin:d,disable_invite_email:n})}),[T,u,C,g,j,ne,d]),oe=(0,s.useCallback)((async e=>{const{invitedUserEmails:n,guestInviteResponse:s}=e;if(!T)return null;const i=null!=s&&s.success?s.invitedUsers:void 0;i&&await w.rw({environment:u,spaceStore:T,originType:"person_property_invite",intl:j,invitedUsers:i,reasonMessage:void 0,originId:t.id,flowId:C,onInviteComplete:e=>{ne({response:e,shouldDoCompleteFn:!0,invitedUserEmails:n,isRequestMember:!0})},inviteOrigin:d})}),[u,C,T,j,ne,t,d]),ae=(0,s.useCallback)((async()=>{const e="member"===y,t=g.state.inviteTargets.filter((e=>"newUser"===e.type||"existingUser"===e.type)).map((e=>e.value.email));if(0===t.length)return void c.S4(u,{invite_stage:"click_invite_button",invite_flow_id:C,error:"No valid input emails"});const n=q();if(h(!0),e)if(n)await ie({invitedUserEmails:t,disable_invite_email:!1,guestInviteResponse:void 0,shouldDoCompleteFn:!0});else{const e=!X&&!J,n=await se({invitedUserEmails:t,shouldDoCompleteFn:e});X?await ie({invitedUserEmails:t,disable_invite_email:!0,guestInviteResponse:n,shouldDoCompleteFn:!0}):J&&await oe({invitedUserEmails:t,guestInviteResponse:n})}else n?c.S4(u,{invite_stage:"click_invite_button",invite_flow_id:C,error:"Invite guest with guest limitation exceed"}):await se({invitedUserEmails:t,shouldDoCompleteFn:!0});h(!1),g.reset()}),[u,X,J,y,C,q,g,se,ie,oe,h]),re=(0,s.useCallback)((async()=>{await N();const e=(0,B.B)({inviteTargetsStore:g}).length;c.tX(u,{invited_user_count:e,invite_option:y,can_add_member:X,origin:d,inviteTargets:g.state.inviteTargets.map((e=>e.type.toString())),inviteTokenQuery:g.state.tokenQuery,invite_flow_id:C}),await ae()}),[u,C,N,ae,y,X,g,d]);let le;le=Y?ee:te?(0,M.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0;const de=(0,s.useMemo)((()=>[{key:"member",render:()=>(0,M.jsx)(m.Z,{disableTooltip:X||J,renderTooltip:()=>(0,M.jsx)(r.FormattedMessage,{id:"invite.person_property.invite_member.tooltip",defaultMessage:"You do not have permission to add or request members to this workspace"}),render:e=>(0,M.jsx)(W,{isSelected:"member"===y,inviteOption:"member",events:e})}),isDisabled:!X&&!J},{key:"guest",render:()=>(0,M.jsx)(m.Z,{disableTooltip:!G&&H,renderTooltip:()=>(0,M.jsx)(_.e,{}),render:e=>(0,M.jsx)(W,{isSelected:"guest"===y,inviteOption:"guest",events:e})})}]),[y,G,H,J,X]);return(0,M.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,M.jsx)("div",{style:p.section,children:(0,M.jsx)(A.Z,{items:de,itemStyle:p.itemStyle,innerStyle:p.innerStyle,value:y,onChange:e=>{x(e),c.Io(u,{invite_option:e,invite_flow_id:C,origin:d})}})}),!G&&H||"guest"!==y?(0,M.jsx)(K,{tooltip:le,disabled:!P||Y||te,onClick:re,isLoading:f}):(0,M.jsx)(U,{onClick:()=>{c.ZA(u,{invited_user_count:F.length,invite_flow_id:C,origin:d}),Z.Vu({environment:u,upgradeButtonName:"user_permission_item"})}})]})}function U(e){const{onClick:t}=e;return(0,M.jsx)(m.Z,{disableTooltip:!1,renderTooltip:()=>(0,M.jsx)(_.e,{}),render:e=>(0,M.jsx)(P.Z,{isLarge:!0,style:{margin:"0 16px 16px 16px",borderRadius:6},onClick:t,...e,children:(0,M.jsx)(r.FormattedMessage,{id:"invite.person_property.upgrade",defaultMessage:"Upgrade"})})})}function K(e){const{tooltip:t,disabled:n,onClick:s,isLoading:i}=e;return(0,M.jsx)(m.Z,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,M.jsx)(P.Z,{isLarge:!0,style:{margin:"0 16px 16px 16px",borderRadius:6},disabled:n,onClick:s,...e,isLoading:i,children:(0,M.jsx)(r.FormattedMessage,{id:"invite.person_property.invite",defaultMessage:"Invite"})})})}function W(e){const{isSelected:t,inviteOption:n,events:s}=e,i=z(),o=t?i.mainTextSelected:i.mainTextUnselected;let a,l;switch(n){case"guest":a=(0,M.jsx)(r.FormattedMessage,{id:"invite.person_property.addAsGuest.title",defaultMessage:"Add to page only"}),l=(0,M.jsx)(r.FormattedMessage,{id:"invite.person_property.addAsGuest.subtitle",defaultMessage:"Invite as a Guest"});break;case"member":a=(0,M.jsx)(r.FormattedMessage,{id:"invite.person_property.addAsMember.title",defaultMessage:"Add to Workspace"}),l=(0,M.jsx)(r.FormattedMessage,{id:"invite.person_property.addAsMember.subtitle",defaultMessage:"Invite and bill as a Member"});break;default:throw new Error(`Unsupported invite option: ${n}`)}return(0,M.jsx)(M.Fragment,{children:(0,M.jsx)("div",{style:i.row,...s,children:(0,M.jsxs)("div",{style:o,children:[a,(0,M.jsx)(F.Z,{isSmall:!0,style:i.optionSubtitle,children:l})]})})})}function z(){return(0,a.yK)((e=>({mainTextSelected:{fontWeight:T.Z.fontWeight.medium,color:e.regularTextColor,fontSize:14,lineHeight:"14px"},mainTextUnselected:{color:e.mediumTextColor,fontSize:14,lineHeight:"14px"},row:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,lineHeight:"14px"},section:{padding:"16px 11px 16px 11px"},itemStyle:{margin:5,borderRadius:8,borderWidth:2},innerStyle:{borderWidth:0},optionSubtitle:{whiteSpace:"pre-wrap",paddingTop:2,fontSize:12}})),[])}var q=n(80721),G=n(573063);function H(e){let{handleBackButtonClick:t}=e;const n=(0,a.yK)((()=>({container:{display:"flex",margin:"0 12px 0px",height:40}})),[]);return(0,M.jsx)("div",{style:n.container,children:(0,M.jsx)($,{onClick:t})})}function $(e){const{onClick:t}=e,n=(0,r.useIntl)(),s=(0,a.yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:16,width:16,strokeWidth:T.Z.fontWeight.semibold},sendInviteLabel:{fontWeight:T.Z.fontWeight.medium}})),[]);return(0,M.jsxs)("div",{style:s.topContainer,children:[(0,M.jsx)(G.Z,{icon:q.W,iconStyle:s.arrowIcon,style:s.iconButton,onClick:t,ariaLabel:n.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,M.jsx)(F.Z,{style:s.sendInviteLabel,children:(0,M.jsx)(r.FormattedMessage,{id:"invite.person_property.popup_title",defaultMessage:"Invite and mention"})})]})}var Y=n(994044),Q=n(374194),J=n(419306);const X=d.Ds((e=>{let{environment:t,flowId:n,origin:s}=e;c.KZ(t,{origin:s,invite_flow_id:n})}),1e3);function ee(e){const{inviteTargetsStore:t,personPropertyInviteStore:n,inviteOrigin:a}=e,r=(0,i.O7)(),{focus:l,emailMessage:d}=(0,o.VK)((()=>{const{focus:e,emailMessage:t}=n.state;return{focus:e,emailMessage:t}}),[n]),c=(0,o.VK)((()=>n.state.flowId),[n]),u=(0,s.useCallback)((()=>{t.reset()}),[t]),m=(0,s.useCallback)((e=>{n.setState({...n.state,focus:l,emailMessage:e.target.value}),X({environment:r,flowId:c,origin:a})}),[r,n,c,a,l]),p=(0,s.useCallback)((()=>{u()}),[u]),g=(0,s.useCallback)((()=>{n.setState({...n.state,focus:k.S.MessageInput,emailMessage:d})}),[n,d]);return(0,M.jsx)(te,{focus:l===k.S.MessageInput,value:d,onFocus:g,onChange:m,onCancel:p,maxLength:1e3,inviteTargetsStore:t})}function te(e){const{focus:t,value:n,maxLength:s,inviteTargetsStore:l,onFocus:d,onChange:c,onCancel:u}=e,m=(0,r.useIntl)(),p=n.length/s>=.8,g=(0,Y.TQ)(n),f=p||g,h=(0,i.Fy)(),y=(0,a.yK)((e=>({container:{maxHeight:80,bottom:0,padding:"2px 16px 2px 16px",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",overflow:"hidden",zIndex:1,height:72},input:{maxHeight:80,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:2,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s",height:"100%"},inputBox:{padding:"0px 4px 0px 4px",boxShadow:e.inputBoxShadow,background:e.inputBackground,width:"auto",height:"100%",borderRadius:6,...t&&{background:"none",boxShadow:"rgba(35, 131, 226, 0.57) 0px 0px 0px 1px inset, rgba(35, 131, 226, 0.35) 0px 0px 0px 2px"}}})),[t]),x=(0,o.VK)((()=>l.state.inviteTargets.filter((e=>"newUser"===e.type||"existingUser"===e.type)).map((e=>e.value.email))),[l]),S=(0,o.VK)((()=>x.length>0?m.formatMessage({id:"invite.person_property.emailMessageInput.placeholder.withEmails",defaultMessage:"Add a message for {users}"},{users:(0,J.W)(x)}):m.formatMessage({id:"invite.person_property.emailMessageInput.placeholder.noEmails",defaultMessage:"Add a message to your invite..."})),[m,x]);return(0,M.jsxs)("div",{style:y.container,children:[f&&(0,M.jsx)(ne,{value:n,maxLength:s,shouldShowLengthWarning:p,shouldShowLinkWarning:g}),(0,M.jsx)(Q.Z,{textarea:!0,focusInitial:!1,format:Q.B.Transparent,placeholder:S,maxlength:s,focus:t,value:n,onFocus:d,onChange:c,inputStyle:y.input,onCancel:u,style:y.inputBox,onClick:()=>{h.isMobile||null==d||d()}})]})}function ne(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:n,value:s,maxLength:i}=e,o=(0,a.yK)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,M.jsx)("div",{style:o.container,children:(0,M.jsxs)("div",{style:o.warning,children:[t&&(0,M.jsx)(r.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:s.length,maxCharacters:i}}),t&&n&&" · ",n&&(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}function se(e){const{store:t,handleBackButtonClick:n,onInviteCompleteFn:r,inviteTargetsStore:l,personPropertyInviteStore:c,inviteOrigin:m}=e,p=(0,o.qz)(void 0,C.Z),g=(0,i.O7)(),f=(0,s.useCallback)((async()=>{await w.Uw({environment:g,inviteTargetsStore:l,personPropertyInviteStore:c,allowShowEmptyError:!1})}),[g,l,c]),h=(0,a.yK)((()=>({container:{position:"relative",width:450,transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:500},searchBar:{paddingLeft:16,paddingRight:16,paddingBottom:16,paddingTop:16},horizontalLine:{margin:"0",color:"#E3E2E0",opacity:.3}})),[]);return(0,M.jsx)(u.Z,{debugName:"PersonPropertyInvitePopup",capture:!0,onLeft:d.yR,onRight:d.yR,onSelectAll:d.yR,onRedo:d.yR,onUndo:d.yR,onCut:d.yR,onCopy:d.yR,onPaste:d.yR,onKeypress:d.yR,onDelete:d.yR,onBackspace:d.yR,onTab:d.yR,onEnter:f,children:(0,M.jsxs)("div",{style:h.container,children:[(0,M.jsx)(H,{handleBackButtonClick:n}),(0,M.jsx)("hr",{style:h.horizontalLine}),(0,M.jsx)("div",{style:h.searchBar,children:(0,M.jsx)(ie,{store:t,inviteTargetsStore:l,personPropertyInviteStore:c,inviteOrigin:m})}),(0,M.jsx)(ee,{store:t,inviteTargetsStore:l,personPropertyInviteStore:c,inviteOrigin:m}),(0,M.jsx)("div",{children:(0,M.jsx)(N,{store:t,inviteTargetsStore:l,sudoModeStore:p,onInviteCompleteFn:r,personPropertyInviteStore:c,inviteOrigin:m})})]})})}function ie(e){const{store:t,personPropertyInviteStore:n,inviteOrigin:s}=e,d=(0,r.useIntl)(),u=(0,i.O7)(),y=(0,o.qz)(e.inviteTargetsStore,S.ZP),x=(0,f.r)(),v=(0,h.r_)(),b=(0,g.U)(x),{focus:C,emailMessage:w}=(0,o.VK)((()=>{const{focus:e,emailMessage:t}=n.state;return{focus:e,emailMessage:t}}),[n]),{role:I,showEmptyError:T}=(0,o.VK)((()=>{const{role:e,showEmptyError:t}=n.state;return{role:e,showEmptyError:t}}),[n]),Z=(0,o.VK)((()=>t.getType()),[t]),P=(0,o.VK)((()=>n.state.flowId),[n]),F=(0,o.VK)((()=>t.canEditMembership()),[t]),_=(0,a.yK)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:0,borderRadius:4,color:l.ZP.uiGray}})),[]);return x&&v&&b?(0,M.jsx)(m.Z,{disableTooltip:F,renderTooltip:()=>{if(!F)return(0,M.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip",defaultMessage:"Only those with full access can add people."})},render:e=>(0,M.jsx)("div",{style:{display:"flex"},...e,children:(0,M.jsx)(j,{inviteTargetsStore:y,store:x,disabled:!F,origin:s,flowId:P,focus:C===k.S.InviteInput,showEmptyError:T,onFocus:()=>{n.setState({...n.state,focus:k.S.InviteInput,emailMessage:w||""})},placeholder:d.formatMessage({id:"invite.person_property.inviteTargetsInput.placeholder",defaultMessage:"Add emails..."}),onInputChanged:()=>n.setState({...n.state,showEmptyError:!1}),right:(0,M.jsx)(p.ZP,{disabled:!F,role:I,table:"block",type:"user_permission",blockType:Z,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:_.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>{n.setState({...n.state,role:e}),c.Om(u,{invited_role:e,invite_flow_id:P,origin:s})}})})})}):null}},513394:(e,t,n)=>{n.d(t,{S:()=>o,Z:()=>r});var s=n(749085),i=n(471924);let o=function(e){return e.InviteInput="invite_input",e.MessageInput="message_input",e.NoFocus="no_focus",e}({});class a extends s.default{getInitialState(){return{flowId:i.Il(),role:"editor",focus:o.InviteInput,emailMessage:"",isLoading:!1,showEmptyError:!1}}}const r=a},689813:(e,t,n)=>{n.d(t,{v3:()=>bt,s5:()=>pt,ZP:()=>at});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(643593),l=n(379362),d=n(745238),c=n(785893);const u=(0,d.IU)("giphyLogo",{viewBox:"0 0 12 12",svg:(0,c.jsx)("path",{d:"M 1.332031 0 L 1.332031 12 L 10.667969 12 L 10.667969 4.332031 L 9.332031 5.667969 L 9.332031 10.667969 L 2.667969 10.667969 L 2.667969 1.335938 L 5 1.335938 L 6.332031 0 Z M 6.667969 0 L 6.667969 4 L 10.667969 4 L 10.667969 2.667969 L 9.332031 2.667969 L 9.332031 1.335938 L 8 1.335938 L 8 0 "})});var m=n(435840);const p=(0,d.IU)("shuffle",{viewBox:"0 0 16 16",svg:(0,c.jsx)("path",{d:"M0.162354 11.7542C0.162354 12.1365 0.458984 12.4067 0.867676 12.4067H2.41675C3.55054 12.4067 4.21631 12.0771 4.99414 11.1609L6.58936 9.26245L8.16479 11.1279C8.9624 12.0771 9.71387 12.4067 10.8477 12.4067H12.166V13.9954C12.166 14.3118 12.3572 14.4963 12.6736 14.4963C12.8186 14.4963 12.9504 14.4436 13.0625 14.3579L15.6465 12.2024C15.897 11.998 15.897 11.6816 15.6465 11.4641L13.0625 9.30859C12.9504 9.21631 12.8186 9.17017 12.6736 9.17017C12.3572 9.17017 12.166 9.34814 12.166 9.67114V11.095H10.8872C10.1094 11.095 9.60181 10.8379 9.0415 10.1655L7.43311 8.2605L9.0481 6.34888C9.62158 5.66992 10.083 5.42603 10.8477 5.42603H12.166V6.87622C12.166 7.19263 12.3572 7.3772 12.6736 7.3772C12.8186 7.3772 12.9504 7.32446 13.0625 7.23877L15.6465 5.08325C15.897 4.87891 15.897 4.5625 15.6465 4.34497L13.0625 2.18945C12.9504 2.09717 12.8186 2.05103 12.6736 2.05103C12.3572 2.05103 12.166 2.229 12.166 2.552V4.10767H10.8542C9.68091 4.10767 8.9624 4.43066 8.12524 5.43262L6.58936 7.25854L4.99414 5.36011C4.21631 4.44385 3.50439 4.11426 2.3772 4.11426H0.867676C0.458984 4.11426 0.162354 4.38452 0.162354 4.76685C0.162354 5.14917 0.458984 5.42603 0.867676 5.42603H2.32446C3.06274 5.42603 3.5769 5.68311 4.1438 6.35547L5.74561 8.2605L4.1438 10.1655C3.5769 10.8379 3.10229 11.095 2.37061 11.095H0.867676C0.458984 11.095 0.162354 11.3718 0.162354 11.7542Z"})});var g=n(11751);const f=(0,d.IU)("unsplashLogo",{viewBox:"0 0 12 12",svg:(0,c.jsx)("path",{d:"M3.75 3.375V0H8.25V3.375H3.75ZM8.25 5.25H12V12H0V5.25H3.75V8.625H8.25V5.25Z"})});var h=n(709291),y=n(997466),x=n(531701),S=n(653965),v=n(368425),b=n(757549),M=n(191584),j=n(496802),C=n(164964),w=n(353471),k=(n(757658),n(519889)),I=n(768657),T=n(80444),Z=n(206258),P=n(843250),F=n(249394),_=n(924666),A=n(965187);function B(e){const{placeholder:t,onSubmit:n}=e,i=(0,a.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:4,padding:"6px 10px",marginLeft:8,marginRight:8,overflow:"hidden",fontSize:14,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},text:{minHeight:60},placeholder:{minHeight:60}})),[]),o=(0,s.useCallback)((e=>{if(n&&!e.shiftKey)n();else{if("editing"!==_.default.state.mode)return}}),[n]);return(0,c.jsx)("div",{style:i.wrap,className:P.Wh_,children:(0,c.jsx)(A.Z,{placeholder:t,disabled:!1,store:e.store,style:i.text,placeholderStyle:i.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:o,disableMobileActionBar:!1,disabledMentionTypes:{reminder:!0},disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,inPageFind:F.B3.none})})}var R=n(73657),D=n(672495),O=n(306202);function L(e){const{tab:t}=e,n=(0,i.O7)(),{store:o}=(0,I.Cl)({initialValue:void 0,onChange:S.yR}),r=(0,a.yK)((e=>({desktopStyle:{marginTop:8,marginBottom:6},sparkleStyle:{width:16,height:16,marginRight:4},captionStyle:{textAlign:n.device.isMobile?"left":"center"}})),[n.device.isMobile]),l=(0,s.useCallback)((async()=>{const n=o.getValue();if(!n)return;const s=[];for(const e of n){var i;if("‣"===e[0]&&null!==(i=e[1])&&void 0!==i&&i.length){if("d"===e[1][0][0]){const t=e[1][0][1].start_date;s.push(t)}else if("u"===e[1][0][0]){const t=e[1][0][1],{currentSpaceStore:n}=T.default.state;if(!n)return{users:[],bots:[]};const i=Z.U6.createChildStore(n,{table:k.KJ,id:t});await i.load();const o=i.getEmail();s.push(o||"")}}else s.push(e[0])}const a=s.join(""),r=t.integration;if(a){e.store.setState({...e.store.state,loading:!0});const n=await t.getResults(a,r);e.store.setState({...e.store.state,loading:!1,result:n.results})}}),[o,e.store,t]);return(0,c.jsxs)("div",{children:[(0,c.jsx)(D.Z,{desktopStyle:r.desktopStyle,children:(0,c.jsx)(B,{placeholder:e.placeholder,onSubmit:l,store:o})}),(0,c.jsx)(D.Z,{children:(0,c.jsx)(O.Z,{onClick:l,title:t.buttonText||(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Ask",id:"mediaPicker.aiSourcePickerTab.askButtonText"}),(0,c.jsx)("div",{children:(0,g.t)(r.sparkleStyle)})]}),fullWidth:e.isSmallWidth})}),t.caption&&(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:t.caption,style:r.captionStyle})]})}var V=n(552275),E=n(400949),N=n(751077),U=n(268894),K=n(291839),W=n(478140),z=n(863296),q=n(489728),G=n(158297),H=n(430506),$=n(526388),Y=n(702520);const Q=(0,d.IU)("colorPickerCircle",{viewBox:"0 0 32 32",svg:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("circle",{cx:"16",cy:"16",r:"14",strokeWidth:"3",fill:"none"}),(0,c.jsx)("circle",{cx:"16",cy:"16",r:"14",opacity:"0.9"})]})});var J=n(210228),X=n(237181),ee=n(938530),te=n(98742),ne=n(825464),se=n(61766),ie=n(231945),oe=n(573063),ae=n(301743),re=n(632163),le=n(886825);const de=(0,h.defineMessages)({selectSpecificIconColor:{defaultMessage:"Select icon color {iconColor}",id:"iconPickerColorPicker.selectSpecificColor"},selectIconColor:{defaultMessage:"Select icon color",id:"iconPickerColorPicker.selectColor"},selectIconColorWithCurrentColor:{defaultMessage:"Select icon color, {iconColor} selected",id:"iconPickerColorPicker.selectColorWithCurrentColor"},noIconColor:{defaultMessage:"no color",id:"iconPickerColorPicker.noColor"}});function ce(){const e=(0,o.VK)((()=>{var e;return null===(e=T.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.icon_picker_color}),[]),t=(0,h.useIntl)(),n=(0,i.O7)(),s=(0,a.Fg)(),r=(0,i.Fy)(),d=(0,o.qz)(void 0,se.Z);return(0,c.jsx)($.Z,{renderTooltip:()=>t.formatMessage(de.selectIconColor),placement:ne.u.Bottom,render:i=>(0,c.jsx)(ie.ZP,{preventBlockRenderQueueOnEnter:!0,buttonPopupStore:d,popupType:ie.Z4.Popup,renderOrigin:n=>(0,c.jsx)(U.DO,{ariaLabel:t.formatMessage(de.selectIconColorWithCurrentColor,{iconColor:t.formatMessage(e?l.RR[e]:de.noIconColor)}),icon:t=>Q({...t,stroke:e?l.Lr[s.mode][e]:l.Lr[s.mode].lightgray,fill:e?l.Lr[s.mode][e]:s.lightIconColor}),...(0,te.Z)(n,i)}),render:i=>function(e){const{parent:t,environment:n,currentIconPickerColor:s,theme:i,device:o,intl:a}=e,r=l.Oe.map((e=>({key:e,action:s=>{t.close(),ue({environment:n,color:e})},render:t=>(0,c.jsx)($.Z,{renderTooltip:()=>a.formatMessage(l.RR[e]),placement:ne.u.Bottom,render:n=>(0,c.jsx)(oe.Z,{...(0,te.Z)(n,t),ariaLabel:a.formatMessage(de.selectSpecificIconColor,{iconColor:a.formatMessage(l.RR[e])}),style:{...o.isMobile?{width:ee.mz,height:ee.mz}:{width:ee.T8,height:ee.T8}},icon:t=>Q({...t,height:o.isMobile?18:14,width:o.isMobile?18:14,stroke:l.Lr[i.mode][e],fill:l.Lr[i.mode][e]})})})})));return r.push({key:"askEveryTime",action:()=>{t.close(),ue({environment:n,color:void 0})},render:e=>(0,c.jsx)(le.Z,{...e,title:(0,c.jsx)(h.FormattedMessage,{id:"iconPickerColorPicker.askEveryTime",defaultMessage:"Ask every time"}),onClick:()=>{ue(void 0!==s?{environment:n,color:void 0}:{environment:n,color:"gray"})},on:void 0===s,style:{boxShadow:void 0},textWrapperStyle:{marginLeft:o.isMobile?10:6},rightStyle:{marginRight:4}})}),(0,c.jsx)(ae.Z,{debugName:"IconPickerColorPicker",capture:!0,allowEsc:!0,children:(0,c.jsx)(re.Z,{type:re.i.Grid,itemsPerRow:5,initialFocus:s?Math.max(l.Oe.indexOf(s),0):10,sections:[{key:"variations",render:e=>(0,c.jsx)("div",{...e}),items:r}],renderRow:(e,t)=>(0,c.jsx)("div",{style:{display:"flex",padding:4,...t<2&&void 0===s&&{opacity:.5},...2===t&&{padding:"0 0 4px 0",flexDirection:"row-reverse"}},children:e},t)})})}({parent:i,environment:n,currentIconPickerColor:e,theme:s,device:r,intl:t})})})}function ue(e){const{environment:t,color:n}=e,{currentUserSettingsStore:s}=T.default.state;s&&J.createAndCommit({userAction:"mediaPicker.setIconPickerColor",environment:t,perform:e=>{const t=void 0!==n?n:null;X.d2({userSettingsStore:s,transaction:e,data:{icon_picker_color:t}})}})}var me=n(278948),pe=n(66957),ge=n(95477),fe=n(823586),he=n(492658),ye=n(583469);function xe(e){const t=(0,a.yK)((e=>({footer:{borderTopStyle:"solid",borderTopWidth:1,borderTopColor:e.stroke.deemphasized,display:"flex",justifyContent:"space-between",paddingTop:8,paddingBottom:8,paddingLeft:12,paddingRight:12},categoryIcon:{width:28,height:28,padding:4}})),[]);return(0,c.jsx)("div",{style:t.footer,children:ye.Is.map(((n,s)=>"callout"===n.id?null:(0,c.jsx)(oe.Z,{ariaLabel:n.category??n.id,icon:()=>{var e;return null===(e=n.icon)||void 0===e?void 0:e.call(n,t.categoryIcon)},style:{width:32,height:32},onClick:t=>{e.onCategoryClick(n)}},n.id)))})}var Se=n(198534),ve=n(883620),be=n(5385),Me=n(145567),je=n(460709),Ce=n(775538),we=n(749085);class ke extends we.default{getInitialState(){return{inputValue:"",focus:!1,result:void 0,loading:!1,hover:""}}}const Ie=ke;var Te=n(319385),Ze=n(904391),Pe=n(791390),Fe=n(891694),_e=n(88893),Ae=n(288280),Be=n(3403),Re=n(164921),De=n(634406),Oe=n(316354),Le=n(81865),Ve=n(462385),Ee=n(296994),Ne=n(433929);function Ue(){const{device:e,WindowSizeStore:t}=(0,i.O7)(),n=(0,o.VK)((()=>e.isPhone),[e]),{phonePaddingLeft:s,phonePaddingRight:r}=(0,o.VK)((()=>({phonePaddingLeft:t.getSafePaddingLeftCSS(14),phonePaddingRight:t.getSafePaddingRightCSS(14)})),[t]);return(0,a.yK)((e=>({galleryWrap:{display:"flex",flexWrap:"wrap",alignContent:"flex-start",background:e.popoverBackground,paddingTop:n?12:0,paddingBottom:n?12:0,paddingLeft:n?s:12,paddingRight:n?r:12,boxShadow:n?`0 1px 0 ${e.regularDividerColor}`:""}})),[n,s,r])}function Ke(e){let{pageCover:t,tab:n}=e;const{coverUrl:i,title:o,subtitle:r,position:l}=t,d=(0,a.yK)((e=>({container:{width:"25%",padding:3},tooltip:{maxWidth:180,whiteSpace:"normal"},title:{color:e.regularInvertedTextColor},subtitle:{color:e.mediumInvertedTextColor},buttonHover:{opacity:.85},imageBox:{width:"100%",height:64,objectFit:"cover",objectPosition:`center ${100*(l||0)}%`,borderRadius:4}})),[l]),u=(0,s.useCallback)((()=>{n.onChange({url:i,position:l})}),[n,i,l]);return(0,c.jsx)("div",{style:d.container,children:(0,c.jsx)($.Z,{originGap:0,placement:ne.u.Bottom,delayThreshold:600,renderTooltip:()=>(0,c.jsxs)("div",{style:d.tooltip,children:[(0,c.jsx)("span",{style:d.title,children:Ne.default.formatMessage(o)})," ",(0,c.jsx)("span",{style:d.subtitle,children:r&&Ne.default.formatMessage(r)})]}),render:e=>(0,c.jsx)(Re.Z,{hoveredStyle:d.buttonHover,...e,onClick:u,children:(0,c.jsx)(Le.Z,{url:i,width:200,isAuthenticated:!1,render:(e,t)=>t&&(0,c.jsx)(De.Z,{src:t,style:d.imageBox})})})})})}const We=function(e){let{tab:t}=e;const[n,i]=(0,s.useState)({}),[o,r]=(0,s.useState)(!1);(0,s.useEffect)((()=>{(async()=>{r(!0),await Ee.FF.pageCovers.load().then((e=>{i(e.default),r(!1)}))})()}),[]);const l=Ue(),d=(0,a.yK)((e=>({container:{paddingBottom:8},groupTitle:{marginLeft:-5},loader:{height:300}})),[]);return o?(0,c.jsx)("div",{style:d.loader,children:(0,c.jsx)(Be.Z,{})}):(0,c.jsx)("div",{style:d.container,children:S.UI(n,((e,n)=>(0,c.jsx)(D.Z,{title:(0,c.jsx)(Oe.Z,{style:d.groupTitle,href:e.url,external:!0,children:(0,c.jsx)(Ve.Z,{children:Ne.default.formatMessage(e.title)})}),isTitleUppercase:!0,noTextOverflow:!0,children:(0,c.jsx)("div",{style:l.galleryWrap,children:e.items.map(((e,n)=>(0,c.jsx)(Ke,{pageCover:e,tab:t},n)))})},n)))})};var ze=n(454642),qe=n(568785),Ge=n(164369),He=n(942402),$e=n(675822);const Ye=(0,h.defineMessages)({giphyPlaceholder:{id:"mediaPicker.giphyPlaceholder.text",defaultMessage:"Search GIPHY"}});function Qe(e){const{tab:t,results:n,ready:i,isSmallWidth:o,giphyRandomId:r}=e,l=(0,a.yK)((e=>({loading:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1},captionMenuItem:{textAlign:o?"left":"center",color:e.mediumTextColor}})),[o]);return i?!n||n&&!n.length?(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.giphy.noResultsText"}),style:l.captionMenuItem}):(0,c.jsxs)(s.Fragment,{children:[n.map(((e,n)=>(0,c.jsx)(Je,{tab:t,image:e,giphyRandomId:r},n))),(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.giphy.searchText"}),style:l.captionMenuItem})]}):(0,c.jsx)("div",{style:l.loading,children:(0,c.jsx)(qe.Z,{})})}function Je(e){var t;let{tab:n,image:o,giphyRandomId:r}=e;const l=(0,i.O7)(),{device:d}=l,u=(0,a.yK)((e=>({container:{width:d.isMobile?"33%":"25%",padding:3},hoveredButton:{opacity:.85},imageBox:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:4},label:{marginTop:2,marginBottom:4}})),[d.isMobile]),m=(0,s.useCallback)((async()=>{var e;if(n.onChange({url:o.imageUrl}),null!==(e=o.analytics)&&void 0!==e&&e.onclick)try{var t;await ze.postGiphyAnalytics(l,{url:null===(t=o.analytics)||void 0===t?void 0:t.onclick.url,timestamp:Date.now(),random_id:r})}catch(s){}}),[l,r,o.imageUrl,n,null===(t=o.analytics)||void 0===t?void 0:t.onclick]);return(0,c.jsxs)("div",{style:u.container,children:[(0,c.jsx)(Re.Z,{hoveredStyle:u.hoveredButton,onClick:m,children:(0,c.jsx)(De.Z,{src:o.thumbUrl,style:u.imageBox})}),(0,c.jsx)(Ge.Z,{isSmall:!0,isSecondaryColor:!0,style:u.label,children:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.giphy.byAuthor",values:{authorName:o.authorName||"GIPHY",inlinetextlink:e=>(0,c.jsx)(He.Z,{external:!0,href:o.imageUrl,children:e})}})})]},o.id)}const Xe=function(e){let{tab:t,isSmallWidth:n}=e;const[o,a]=(0,s.useState)(""),[r,l]=(0,s.useState)(""),d=(0,i.O7)(),{device:u}=d,m=Ue(),p=(0,s.useCallback)((async()=>{if(!S.xb(o))return o;const e=await ze.getGiphyRandomId(d,{});return"success"===e.type?(a(e.data.random_id),e.data.random_id):void 0}),[d,o]);return(0,c.jsxs)("div",{style:{paddingBottom:8},children:[(0,c.jsx)(D.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,c.jsx)(U.ZP,{value:r,placeholder:Ne.default.formatMessage(Ye.giphyPlaceholder),showClearButton:!0,focus:!u.isMobile||void 0,onChange:e=>l(e.target.value)})}),(0,c.jsx)("div",{style:m.galleryWrap,children:(0,c.jsx)(fe.Z,{request:r,debounce:$e.vp,performRequest:async e=>{await p();const t=await ze.searchGiphyImages(d,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(e,s,i)=>(0,c.jsx)(Qe,{tab:t,results:s,ready:i,isSmallWidth:n,giphyRandomId:o})})})]})};var et=n(979947);const tt=(0,h.defineMessages)({unsplashPlaceholder:{id:"mediaPicker.unsplashPlaceholder.text",defaultMessage:"Search for an image…"}});function nt(e){const{tab:t,results:n,ready:i,isSmallWidth:o}=e,r=(0,a.yK)((e=>({loading:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1},captionMenuItem:{textAlign:o?"left":"center",color:e.mediumTextColor}})),[o]);return i?!n||n&&!n.length?(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.unsplash.noResultsText"}),style:r.captionMenuItem}):(0,c.jsxs)(s.Fragment,{children:[n.map(((e,n)=>(0,c.jsx)(st,{tab:t,image:e},n))),(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.unsplash.searchText"}),style:r.captionMenuItem})]}):(0,c.jsx)("div",{style:r.loading,children:(0,c.jsx)(qe.Z,{})})}function st(e){let{tab:t,image:n}=e;const o=(0,i.O7)(),{device:a}=o,r=(0,s.useCallback)((async()=>{const e=await(0,et.default)({environment:o,url:n.downloadUrl,method:"GET",format:"json"});"success"===e.type&&t.onChange({url:e.data.url})}),[o,n.downloadUrl,t]);return(0,c.jsxs)("div",{style:{width:a.isMobile?"33%":"25%",padding:3},children:[(0,c.jsx)(Re.Z,{hoveredStyle:{opacity:.85},onClick:r,children:(0,c.jsx)(De.Z,{src:n.thumbUrl,style:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:4}})}),(0,c.jsx)(Ge.Z,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:2,marginBottom:4},children:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.unsplash.byAuthor",values:{authorName:n.authorName,inlinetextlink:e=>(0,c.jsx)(He.Z,{external:!0,href:n.unsplashUrl,children:e})}})})]},n.id)}const it=function(e){let{tab:t,isSmallWidth:n}=e;const[o,a]=(0,s.useState)(""),r=(0,i.O7)(),{device:l}=r,d=Ue();return(0,c.jsxs)("div",{style:{paddingBottom:8},children:[(0,c.jsx)(D.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,c.jsx)(U.ZP,{value:o,placeholder:Ne.default.formatMessage(tt.unsplashPlaceholder),showClearButton:!0,focus:!l.isMobile||void 0,onChange:e=>a(e.target.value)})}),(0,c.jsx)("div",{style:d.galleryWrap,children:(0,c.jsx)(fe.Z,{request:o,debounce:$e.vp,performRequest:async e=>{const t=await ze.searchUnsplashImages(r,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(e,s,i)=>(0,c.jsx)(nt,{tab:t,results:s,ready:i,isSmallWidth:n})})})]})},ot=(0,h.defineMessages)({embedPlaceholder:{id:"mediaPicker.embedPlaceholder.text",defaultMessage:"Paste in https://…"},filterPlaceholder:{id:"mediaPicker.emojiFilter.text",defaultMessage:"Filter…"},aiSourcePickerPlaceholder:{id:"mediaPicker.githubPlaceholder.text",defaultMessage:"Ask query here"},aiIsFetchingLoader:{id:"mediaPicker.aiIsFetchingLoader.text",defaultMessage:"Ai is fetching"}});const at=function(e){var t,n;const a=(0,i.O7)(),r=(0,s.useRef)(null),d=(0,s.useRef)(null),u=(0,o.qz)(void 0,he.Z),[m,p]=(0,s.useState)({inputValue:"",focus:!1}),[g,f]=(0,s.useState)({inputValue:"",focus:!1}),y=(0,o.qz)(void 0,Ze.Z),x=(0,o.qz)(void 0,Ie),v=(0,o.VK)((()=>Te.default.checkGate({gateName:"custom_emojis"})),[]);function b(){const t=e.tabs.find((t=>t.type===e.currentTab));if(!t)return(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Uh oh! Something went wrong.",id:"mediaPicker.errorMessage"});switch(t.type){case"embed":return(0,c.jsx)(kt,{isSmallWidth:e.isSmallWidth,embedInputStore:u,tab:t});case"file":return(0,c.jsx)(mt,{isSmallWidth:e.isSmallWidth,onCancel:e.onCancel,tab:t});case"emoji":return(0,c.jsx)(ye.ZP,{onSubmit:t.onChange,filter:m.inputValue||"",isCallout:e.isCallout,iconLoggingData:e.recordIconLoggingData,menuRef:r,ref:d,onUpload:t.uploadFileEventHandlers});case"icon":return(0,c.jsx)(Y.ZP,{store:y,filter:g.inputValue||"",onSubmit:t.onChange,iconLoggingData:e.recordIconLoggingData,enforceIconColor:t.enforceIconColor,menuRef:r});case"gallery":return(0,c.jsx)(We,{tab:t});case"unsplash":return(0,c.jsx)(it,{tab:t,isSmallWidth:e.isSmallWidth});case"giphy":return(0,c.jsx)(Xe,{tab:t,isSmallWidth:e.isSmallWidth});case"drive":return(0,c.jsx)(Mt,{tab:t});case"box":return(0,c.jsx)(yt,{tab:t});case"aiSourcePicker":return(0,c.jsx)(jt,{isSmallWidth:e.isSmallWidth,aiSourcePickerStore:x,tab:t});case"custom":return(0,c.jsx)(wt,{isSmallWidth:e.isSmallWidth,onCancel:e.onCancel,embedInputStore:u,tab:t})}}const M=null!=r&&null!==(t=r.current)&&void 0!==t&&t.offsetWidth?((null==r||null===(n=r.current)||void 0===n?void 0:n.offsetWidth)-24)/32:12,{device:C}=a,w=(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)(vt,{tabs:e.tabs,onDelete:e.onDelete,currentTab:e.currentTab}),(0,c.jsx)(rt,{tabs:e.tabs,currentTab:e.currentTab,onFilterChange:e=>{const t=M*(a.device.isMobile?ee.pq:ee.II),n=M*(a.device.isMobile?Y.L6:Y.OF);p({...m,inputValue:e.currentTarget.value}),ve.Z.setState({...ve.Z.state,loadEmojiCount:t}),f({...g,inputValue:e.currentTarget.value}),y.setState({...y.state,loadIconCount:n})},iconInput:g.inputValue,emojiInput:m.inputValue,onRandomButtonClick:t=>{"emoji"===t.type?function(e,t,n){const{device:s}=n,i=e.find((e=>e.type===t));if(i&&"emoji"===i.type){const e=j.zM();i.onChange(e,{keepVisible:!s.isMobile})}}(e.tabs,e.currentTab,a):function(e,t,n,s){const{device:i}=e,o=t.find((e=>e.type===n));if(o&&"icon"===o.type){const e=o.enforceIconColor??be.x(),t=`/icons/${S.UP(Object.keys(s.getState().allIcons))}_${e??S.UP(l.Oe)}.svg`;o.onChange(t,{keepVisible:!i.isMobile})}}(a,e.tabs,e.currentTab,y)}})]}),k=e.tabs.find((t=>t.type===e.currentTab)),I=v&&"emoji"===(null==k?void 0:k.type)?(0,c.jsx)(xe,{onCategoryClick:e=>{var t;null===(t=d.current)||void 0===t||t.scrollToCategory(e.id)}}):void 0;let T;if(C.isMobile)T={menuType:je.og.Modal,title:e.title,header:w,right:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Close",id:"mediaPicker.mobileCloseButton.label"}),onClickRight:e.onCancel,left:e.onDelete&&(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Remove",id:"mediaPicker.mobileRemoveButton.label"}),onClickLeft:e.onDelete};else{T={menuType:je.og.Popup,header:w,footer:I};const t=e.tabs.find((t=>t.type===e.currentTab)),n=t&&"custom"===t.type?t.tabHeight:void 0;T.width=e.popupWidth||300,T.height=n||e.popupHeight,T.maxHeight=e.maxHeight,T.maxWidth=e.maxWidth}return(0,c.jsx)(H.Z,{onSwipeLeft:()=>function(e,t){if(!Pe.Z.state.isActive)return;const n=e.map((e=>e.type)).indexOf(Pe.Z.state.currentTab),s=e[n+1];void 0!==s&&St(s.type,t)}(e.tabs,a),onSwipeRight:()=>function(e,t){if(!Pe.Z.state.isActive)return;const n=e.map((e=>e.type)).indexOf(Pe.Z.state.currentTab),s=e[n-1];void 0!==s&&St(s.type,t)}(e.tabs,a),render:e=>(0,c.jsx)(W.Z,{...T,...e,className:P.tQh,innerRef:r,children:b()})})};function rt(e){const t=(0,h.useIntl)(),{isPhone:n,isMobile:s,isAndroid:o}=(0,i.Fy)(),a=e.tabs.find((t=>t.type===e.currentTab));if("emoji"===(null==a?void 0:a.type)||"icon"===(null==a?void 0:a.type)){const i="emoji"===a.type?e.emojiInput:e.iconInput,r=()=>e.onRandomButtonClick(a),l=(0,c.jsx)(ct,{tabs:e.tabs,currentTab:e.currentTab,hasRandomButtonOnLeft:!a.hideRandomButton});return(0,c.jsx)("div",{style:{display:"flex",...n?{}:{marginTop:16,marginBottom:10}},children:(0,c.jsx)(U.ZP,{value:i,placeholder:t.formatMessage(ot.filterPlaceholder),autoFocus:!s||void 0,focusInitial:!s||void 0,showClearButton:!0,inputLeft:(0,c.jsx)(U.f_,{icon:m.R}),onChange:e.onFilterChange,right:(0,c.jsxs)("div",{style:{display:"flex"},children:[null!=a&&a.hideRandomButton?void 0:(0,c.jsx)($.Z,{renderTooltip:()=>(0,c.jsx)(h.FormattedMessage,{id:"mediaPicker.emojiTab.random",defaultMessage:"Random"}),placement:ne.u.Bottom,render:e=>(0,c.jsx)(U.DO,{icon:p,onClick:r,...e})}),l]}),isRightLastElementOfInput:!0,style:{...o&&{borderBottom:"none"}}})})}return null}function lt(e){return e.fileUpload?Me.jo:e.imageUpload?Me.LR:e.videoUpload?Me.G7:void 0}async function dt(e,t){const n=await w.y({multiple:!1,accept:t});n.length&&e.onUpload(n[0])}function ct(e){let{hasRandomButtonOnLeft:t,tabs:n,currentTab:s}=e;const i=n.find((e=>e.type===s));if(!i)return null;let o;return"emoji"===(null==i?void 0:i.type)?o=(0,c.jsx)(Se.Z,{}):"icon"===(null==i?void 0:i.type)&&void 0===i.enforceIconColor&&(o=(0,c.jsx)(ce,{})),t&&o?(0,c.jsx)("div",{style:{marginLeft:6},children:o}):o??null}function ut(e){let{tab:t,isSmallWidth:n}=e;return t.imageUpload||t.videoUpload?(0,c.jsxs)(D.Z,{desktopStyle:{marginTop:4,display:"flex",justifyContent:"center",marginRight:12,marginLeft:12},children:[t.imageUpload&&(0,c.jsx)(z.Z,{isLarge:!0,onClick:()=>dt(t,"image/*"),style:{width:"100%"},children:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Upload file",id:"mediaPicker.chooseImage.buttonText"})}),t.videoUpload&&(0,c.jsx)(O.Z,{title:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Choose a video",id:"mediaPicker.chooseVideo.buttonText"}),onClick:()=>dt(t,"video/*"),fullWidth:n})]}):null}function mt(e){let{tab:t,isSmallWidth:n,onCancel:s}=e;const r=(0,i.O7)(),l=(0,o.VK)((()=>Ae.subscriptionDataStoreInstance.state),[]),d=(0,a.yK)((e=>({dropzone:{background:(0,x.fn)([x.ZP.blueWithAlpha(.14),(0,y.Fq)(e.contentBackground,.5)])},caption:{textAlign:n?"left":"center",color:e.mediumTextColor},fileLimitWrapper:{display:"flex",alignItems:"center",justifyContent:n?"flex-start":"center"},fileLimitInner:{marginRight:6,color:e.mediumTextColor}})),[n]),u=(0,o.VK)((()=>Ce.default.state.isOnboarding),[]),m=(0,o.VK)((()=>_e.M9(r)||"plus"),[r]);return(0,c.jsx)(E.Q,{type:lt(t)??Me.gU,dropTargetKey:"uploadTab",onDropFile:e=>{if("invalidFileDrop"===e.type)return C.oV({label:(0,c.jsx)(h.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",defaultMessage:"Sorry, that file type is not supported."})}),null;t.onUpload(e.file)},dropzoneStyle:d.dropzone,children:(0,c.jsxs)("div",{style:{marginTop:-24,paddingTop:24},children:[t.fileUpload&&(0,c.jsx)(D.Z,{desktopStyle:{marginTop:n?8:24},children:(0,c.jsx)(O.Z,{title:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>dt(t),fullWidth:n})}),(0,c.jsx)(ut,{isSmallWidth:n,tab:t}),t.caption&&(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:t.caption,style:d.caption}),t.preventUploadLimitFreeFileSize||l&&_e.YK(l)&&(0,c.jsx)("div",{style:{height:8}}),l&&!t.preventUploadLimitFreeFileSize&&!_e.YK(l)&&(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:(0,c.jsxs)("div",{style:d.fileLimitWrapper,children:[(0,c.jsx)("div",{style:d.fileLimitInner,children:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:w.K_}})}),!u&&(0,c.jsx)(Fe.Z,{subscriptionTier:m,onClick:()=>{s&&s()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}})]})})]})})}let pt=function(e){return e.Drive="drive",e.Docs="gDocs",e}({});function gt(e){let{tab:t,type:n}=e;return n===pt.Docs?(0,c.jsx)(ht,{tab:t}):(0,c.jsx)(ft,{tab:t})}function ft(e){let{tab:t}=e;const n=(0,a.yK)((e=>({buttonItem:{color:e.blueColor}})),[]);return(0,c.jsxs)(D.Z,{children:[(0,c.jsx)(V.Z,{title:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Connect Google account",id:"mediaPicker.menuItem.connectFirstGoogleAccount.label"}),onClick:()=>t.onSelect(),focused:!1,style:n.buttonItem}),(0,c.jsx)(R.Z,{shouldWrapCaption:!1,caption:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Find and embed your Google Drive files.",id:"mediaPicker.menuItem.connectFirstGoogleAccount.caption"})})]})}function ht(e){let{tab:t}=e;return(0,c.jsx)(D.Z,{children:(0,c.jsx)(V.Z,{title:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Connect Google account",id:"mediaPicker.menuItem.connectFirstGoogleAccount.label"}),onClick:()=>t.onSelect(),focused:!1})})}function yt(e){let{tab:t}=e;const n=(0,a.yK)((e=>({connectFirstAccountButton:{color:e.blueColor},connectSecondAccountButton:{color:e.mediumTextColor}})),[]),{accounts:s}=t;return 0===s.length?(0,c.jsxs)(D.Z,{children:[(0,c.jsx)(V.Z,{title:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Connect Box account",id:"mediaPicker.menuItem.connectFirstBoxAccount.label"}),onClick:()=>t.onSelect(),focused:!1,style:n.connectFirstAccountButton}),(0,c.jsx)(R.Z,{shouldWrapCaption:!1,caption:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Find and embed your Box files.",id:"mediaPicker.menuItem.connectFirstBoxAccount.caption"})})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(D.Z,{children:s.map((e=>(0,c.jsx)(V.Z,{title:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:e.account_name}}),onClick:()=>t.onSelect(e),focused:!1},e.account_key)))}),(0,c.jsx)(D.Z,{topBorder:!0,children:(0,c.jsx)(V.Z,{title:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreBoxAccounts.label"}),onClick:()=>t.onSelect(),style:n.connectSecondAccountButton,focused:!1})})]})}function xt(e,t){return()=>{e&&t.onChange(e)}}function St(e,t){Pe.Z.state.isActive&&(Pe.Z.setState({...Pe.Z.state,currentTab:e}),"icon"===e&&Pe.Z.state.recordIconLoggingData&&v.kz(t,"select_icon_tab",Pe.Z.state.recordIconLoggingData))}function vt(e){let{tabs:t,onDelete:n,currentTab:o}=e;const r=(0,a.yK)((e=>({sparklesIcon:{width:16,height:16,marginRight:4,color:e.accentColors.purple[400]}})),[]),l=(0,i.O7)(),{device:d}=l;if(t.length<=1&&!n)return null;{const e={gallery:(0,c.jsx)(h.FormattedMessage,{id:"mediaPicker.tabs.gallery",defaultMessage:"Gallery"}),embed:(0,c.jsx)(h.FormattedMessage,{id:"mediaPicker.tabs.embedLink",defaultMessage:"Embed link"}),file:(0,c.jsx)(h.FormattedMessage,{id:"mediaPicker.tabs.upload",defaultMessage:"Upload"}),emoji:(0,c.jsx)(h.FormattedMessage,{id:"mediaPicker.tabs.emoji",defaultMessage:"Emoji"}),icon:(0,c.jsx)(h.FormattedMessage,{id:"mediaPicker.tabs.icon",defaultMessage:"Icon"}),custom:(0,c.jsx)(h.FormattedMessage,{id:"mediaPicker.tabs.custom",defaultMessage:"Custom"}),unsplash:(0,c.jsxs)(s.Fragment,{children:[f({width:12,marginRight:4,height:12}),(0,c.jsx)("span",{children:"Unsplash"})]}),giphy:(0,c.jsxs)(s.Fragment,{children:[u({width:12,marginRight:4,height:12}),(0,c.jsx)("span",{children:"GIPHY"})]}),drive:(0,c.jsx)(h.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),box:(0,c.jsx)(h.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),aiSourcePicker:(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,c.jsx)(h.FormattedMessage,{id:"mediaPicker.tabs.ask",defaultMessage:"Ask"}),(0,g.t)(r.sparklesIcon)]})},i=t.findIndex((e=>e.type===o)),a=t.map((t=>t.title||e[t.type])),m=t.find((e=>e.type===o)),p=m&&"emoji"!==m.type&&d.isAndroid;return(0,c.jsx)(pe.Z,{tabs:a,selectedIndex:i,onChange:e=>{St(t[e].type,l)},right:n&&!d.isMobile&&(0,c.jsx)(q.Z,{isGray:!0,onClick:n,children:(0,c.jsx)(h.FormattedMessage,{id:"mediaPicker.tabs.remove",defaultMessage:"Remove"})}),style:{...p&&{borderBottom:"none"}}})}}function bt(e){let{tab:t,accounts:n,type:i=pt.Drive}=e;const o=(0,a.yK)((e=>({buttonItem:{color:e.mediumTextColor}})),[]);return"accounts"in t?t.accounts&&0===t.accounts.length?(0,c.jsx)(gt,{tab:t,type:i}):(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)(D.Z,{children:t.accounts.map(((e,n)=>(0,c.jsx)(V.Z,{title:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:e.account_name}}),onClick:()=>t.onSelect(e),focused:!1},e.account_key)))}),(0,c.jsx)(D.Z,{topBorder:!0,children:(0,c.jsx)(V.Z,{title:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>t.onSelect(),style:o.buttonItem,focused:!1})})]}):n?0===n.length?(0,c.jsx)(gt,{tab:t,type:i}):(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)(D.Z,{children:n.map(((e,n)=>(0,c.jsx)(V.Z,{title:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:e.accountName}}),onClick:()=>t.onSelect(e),focused:!1},e.accountId)))}),(0,c.jsx)(D.Z,{topBorder:!0,children:(0,c.jsx)(V.Z,{title:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>t.onSelect(),style:o.buttonItem,focused:!1})})]}):null}function Mt(e){let{tab:t}=e;const n=(0,i.O7)();return"accounts"in t?(0,c.jsx)(bt,{tab:t}):(0,c.jsx)(fe.Z,{request:n,performRequest:M.vQ,render:(e,n,s)=>{if(!s)return(0,c.jsx)(D.Z,{children:(0,c.jsx)(me.Z,{})});const i=n&&n.accounts?n.accounts:[];return(0,c.jsx)(bt,{tab:t,accounts:i})}})}function jt(e){var t,n;let{tab:i,isSmallWidth:r,aiSourcePickerStore:l}=e;const d=(0,h.useIntl)(),u=(0,a.yK)((e=>({captionItem:{textAlign:r?"left":"center",color:e.mediumTextColor},aiResult:{cursor:"pointer",color:e.mediumTextColor,textAlign:"left",hyphens:"auto",padding:"10px 8px",display:"flex",flexDirection:"row"},aiTitleWrapper:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"rgb(55, 53, 47)",fontWeight:500,fontSize:"14px",paddingLeft:8},aiLoadingWrapper:{flex:1,color:e.accentColors.purple[400],fontWeight:500,flexDirection:"row",gap:6,display:"flex",alignItems:"center",padding:"12px 12px",marginLeft:10},loadingDots:{backgroundColor:e.accentColors.purple[400]}})),[r]),m=(0,o.qz)(l,Ie),p=(0,o.VK)((()=>m.state),[m]);return(0,c.jsxs)(s.Fragment,{children:[p.result&&!1===p.loading&&(0===(null===(t=p.result)||void 0===t?void 0:t.length)?(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.aiSourcePicker.noResultsText"}),style:u.captionItem}):null===(n=p.result)||void 0===n?void 0:n.map((e=>(0,c.jsxs)("div",{style:{...u.aiResult,backgroundColor:p.hover===e.url?"rgba(55,53,47,0.08)":""},onClick:xt(e.url,i),onMouseEnter:()=>{m.setState({...p,hover:e.url})},children:[(0,c.jsx)(N.Z,{imageURL:"NONE"===e.avatar?i.defaultAvatar:e.avatar,size:24,imageStyle:{borderRadius:34,boxShadow:"0 2px 4px rgba(15, 15, 15, 0.1)"},type:"image_url"}),(0,c.jsx)("div",{style:u.aiTitleWrapper,children:e.title})]},e.url)))),p.loading&&(0,c.jsxs)("div",{style:u.aiLoadingWrapper,children:[d.formatMessage(ot.aiIsFetchingLoader),(0,c.jsx)(K.Z,{style:u.loadingDots})]}),!p.result&&!p.loading&&(0,c.jsx)(L,{tab:i,placeholder:i.inputPlaceholder||d.formatMessage(ot.aiSourcePickerPlaceholder),store:m,isSmallWidth:r})]})}function Ct(e,t,n){return()=>{const s=n.state.inputValue;if(s){const n=(0,r.Wv)(s,ge.default.secureFileS3.url,ge.default.secureFileS3V2.url,ge.default.secureFileConfig.rootPath,ge.default.secureFileConfig.hostname),i=n?n.link:s;e.onChange(i),b.bO(t,{pastedText:i,source:"media_picker"})}}}function wt(e){let{tab:t,isSmallWidth:n,onCancel:s,embedInputStore:r}=e;const l=(0,h.useIntl)(),d=(0,i.O7)(),u=(0,i.Fy)(),m=(0,o.VK)((()=>Ae.subscriptionDataStoreInstance.state),[]),p=(0,o.VK)((()=>_e.M9(d)),[d]),g=(0,o.VK)((()=>r.state.inputValue),[r]),f=(0,o.VK)((()=>Ce.default.state.isOnboarding),[]),S=(0,a.yK)((e=>({dropZone:{background:(0,x.fn)([x.ZP.blueWithAlpha(.14),(0,y.Fq)(e.contentBackground,.5)])},caption:{textAlign:n?"left":"center",color:e.mediumTextColor},subscriptionLimitWrapper:{display:"flex",alignItems:"center",justifyContent:n?"flex-start":"center"},subscriptionLimitInner:{marginRight:6,color:e.mediumTextColor}})),[n]),v=(0,c.jsx)(G.Z,{onClick:Ct(t,d,r),disabled:0===g.length,hovered:!1,children:t.buttonText||(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"})}),b=(0,c.jsx)(D.Z,{desktopStyle:{marginTop:16,display:"flex",paddingTop:0,paddingBottom:12},children:(0,c.jsx)(U.ZP,{type:"url",value:g,placeholder:t.inputPlaceholder||l.formatMessage(ot.embedPlaceholder),autoFocus:!u.isMobile||void 0,showClearButton:!0,focus:!u.isMobile||void 0,onSubmit:Ct(t,d,r),onChange:e=>{r.setState({...r.state,inputValue:e.target.value})},inputRight:u.isPhone?v:void 0,right:u.isPhone?void 0:v,isRightLastElementOfInput:!0})}),M=(0,c.jsx)(E.Q,{type:lt(t)??Me.gU,dropTargetKey:"uploadTab",onDropFile:e=>{if("invalidFileDrop"===e.type)return C.oV({label:(0,c.jsx)(h.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",defaultMessage:"Sorry, that file type is not supported."})}),null;t.onUpload(e.file)},dropzoneStyle:S.dropZone,children:(0,c.jsxs)("div",{style:{marginTop:-24,paddingTop:24},children:[t.fileUpload&&(0,c.jsx)(D.Z,{desktopStyle:{marginTop:n?8:24},children:(0,c.jsx)(O.Z,{title:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>dt(t),fullWidth:n})}),(0,c.jsx)(ut,{isSmallWidth:n,tab:t}),t.caption&&(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:t.caption,style:S.caption}),t.preventUploadLimitFreeFileSize||m&&_e.YK(m)&&(0,c.jsx)("div",{style:{height:8}}),m&&!t.preventUploadLimitFreeFileSize&&!_e.YK(m)&&(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:(0,c.jsxs)("div",{style:S.subscriptionLimitWrapper,children:[(0,c.jsx)("div",{style:S.subscriptionLimitInner,children:(0,c.jsx)(h.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:w.K_}})}),!f&&(0,c.jsx)(Fe.Z,{subscriptionTier:p||"plus",onClick:()=>{s&&s()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}})]})})]})});return(0,c.jsxs)(c.Fragment,{children:[b,M]})}function kt(e){let{tab:t,isSmallWidth:n,embedInputStore:a}=e;const r=(0,i.O7)(),l=(0,h.useIntl)(),{device:d}=r,u=(0,o.VK)((()=>a.state.inputValue),[a]);return(0,c.jsxs)(s.Fragment,{children:[(0,c.jsx)(D.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,c.jsx)(U.ZP,{type:"url",value:u,placeholder:t.inputPlaceholder||l.formatMessage(ot.embedPlaceholder),autoFocus:!d.isMobile||void 0,showClearButton:!0,focus:!d.isMobile||void 0,onSubmit:Ct(t,r,a),onChange:e=>{a.setState({...a.state,inputValue:e.target.value})}})}),(0,c.jsx)(D.Z,{children:(0,c.jsx)(O.Z,{onClick:Ct(t,r,a),title:t.buttonText||(0,c.jsx)(h.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"}),fullWidth:n})}),t.caption&&(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:t.caption,style:{textAlign:d.isMobile?"left":"center"}})]})}},535868:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(749085);class i extends s.default{getInitialState(){return{open:!1}}}const o=new i},424764:(e,t,n)=>{n.d(t,{t:()=>M,Z:()=>v});n(667294);var s=n(371663),i=n(698519),o=n(709291),a=n(401898),r=n(62967),l=n(57883),d=n(519719),c=n(709953),u=n(210228);function m(e){const{environment:t,key:n,selectedKey:s,following:i,followSettings:o,navigableBlockId:a,userId:r,spaceId:m,from:p}=e;u.createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{c.Ue({environment:e.environment,table:l.t0,args:{following:i,followSettings:o,navigableBlockId:a,userId:r,spaceId:m},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),i?d.RJ(t,{from:"page_updates"}):d.ub(t,{from:"page_updates"}),s!==n&&d.kL(t,{from:p,navigableBlockId:a,oldSetting:s,newSetting:n})}var p=n(164964),g=n(693405),f=n(164369),h=n(80444),y=n(157538),x=n(785893);const S=(0,o.defineMessages)({repliesAndMentions:{id:"pageNotificationSettings.repliesAndMentions.displayName",defaultMessage:"Mentions"},comments:{id:"pageNotificationSettings.comments.displayName",defaultMessage:"Comments"},allUpdates:{id:"pageNotificationSettings.allUpdates.displayName",defaultMessage:"All"},importantUpdates:{id:"pageNotificationSettings.importantUpdates.displayName",defaultMessage:"Important"}});function v(e){const{followSettingsKey:t,environment:n,blockStore:i,from:a}=e,r=b({key:"none",selectedKey:t,title:(0,x.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.repliesAndMentions.label",defaultMessage:"Replies and @mentions"}),displayName:S.repliesAndMentions,environment:n,blockStore:i,from:a}),l=b({key:"comments",selectedKey:t,title:(0,x.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.allComments.label",defaultMessage:"All comments"}),displayName:S.comments,environment:n,blockStore:i,from:a}),d=b({key:"all",selectedKey:t,title:(0,x.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.allUpdates.label",defaultMessage:"All updates"}),caption:(0,x.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.simpleAllUpdates.caption",defaultMessage:"All comments and property changes"}),displayName:S.allUpdates,environment:n,blockStore:i,from:a}),c=i.getAssociatedCollectionStore();if(!c)return[l,r];const u=c.getDatabaseType();if(u===s.iS){return[d,b({key:"important",selectedKey:t,title:(0,x.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesTasks.label",defaultMessage:"Important updates"}),caption:(0,x.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesTasks.caption",defaultMessage:"All comments and changes to Status, Assignee, or Due Date"}),displayName:S.importantUpdates,environment:n,blockStore:i,from:a}),r]}if(u===s.wW){return[d,b({key:"important",selectedKey:t,title:(0,x.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesProjects.label",defaultMessage:"Important updates"}),caption:(0,x.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesProjects.caption",defaultMessage:"All comments and changes to Status or Date"}),displayName:S.importantUpdates,environment:n,blockStore:i,from:a}),r]}return[d,b({key:"comments",selectedKey:t,title:(0,x.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.onlyCommentsAllComments.label",defaultMessage:"All comments"}),displayName:S.comments,environment:n,blockStore:i,from:a}),r]}function b(e){const{key:t,title:n,caption:s,selectedKey:o,environment:a,blockStore:l,from:d,displayName:c}=e,u=M({key:t,userSelectedKey:o}),S={icon:{width:14,height:14},rightWrapper:s?{alignSelf:"flex-start",paddingTop:2}:{}};return{action:(0,r.cN)({key:t,displayName:c,analyticsName:t,validators:[],closeParentMenu:!0,action:()=>{const{currentUserRootStore:e}=h.default.state;if(e){const{following:n,followSettings:s}=(0,y.Z)(t),i=e.id,r=l.id,c=l.getSpaceId();m({environment:a,following:n,followSettings:s,navigableBlockId:r,spaceId:c,userId:i,from:d,key:t,selectedKey:o}),"inbox"!==d&&"more_menu"!==d||p.d4({item:{label:j(t)},undoFunc:()=>{const{following:e,followSettings:n}=(0,y.Z)(o);m({environment:a,following:e,followSettings:n,navigableBlockId:r,spaceId:c,userId:i,from:d,key:t,selectedKey:o})}})}},render:e=>(0,x.jsx)(g.Z,{...e,title:(0,x.jsx)(f.Z,{children:n}),caption:s,shouldWrapCaption:!0,right:u?(0,i.k)(S.icon):(0,x.jsx)("div",{style:S.icon}),rightStyle:S.right})}),title:n,isSelectedOption:u}}function M(e){const{key:t,userSelectedKey:n}=e;return"important"===n||"comments"===n?"important"===t||"comments"===t:t===n}function j(e){switch(e){case"none":return(0,x.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.subscribedRepliesAndMentionsSuccess.snackbarMessage",defaultMessage:"Subscribed to replies and @mentions"});case"comments":return(0,x.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllCommentsSuccess.snackbarMessage",defaultMessage:"Subscribed to all comments"});case"important":return(0,x.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.subscribedImportantUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to important updates"});case"all":return(0,x.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to all updates"});default:(0,a.t1)(e)}}},391264:(e,t,n)=>{n.d(t,{Z:()=>b,v:()=>v});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(559054),l=n(89806),d=n(709291),c=n(247839),u=n(412714),m=n(897122),p=n(158297),g=n(95477),f=n(548779),h=n(80444),y=n(584437),x=n(671574),S=n(785893);const v=(0,d.defineMessages)({continueWithGoogle:{id:"notionCalendarLaunchButton.continueWithGoogle",defaultMessage:"Continue with Google"},downloadApp:{id:"notionCalendarLaunchButton.downloadApp",defaultMessage:"Download app"},openCalendar:{id:"notionCalendarLaunchButton.openCalendar",defaultMessage:"Open Calendar"}});const b=function(e){let{style:t,openCalendarFrom:n,continueWithGoogleFrom:b,onOpenCalendarClick:M,onContinueWithGoogleClick:j,onDownloadClick:C}=e;const w=(0,i.O7)(),k=(0,a.yK)((e=>({button:{height:32,marginLeft:8,fontSize:14,whiteSpace:"nowrap",...t},googleLogoIcon:{width:14,height:14,marginRight:8}})),[t]),I=(0,o.VK)((()=>(0,x.tE)()),[]),T=(0,o.VK)((()=>h.default.state.currentSpaceStore&&(0,f.XY)({env:"production",spaceStore:h.default.state.currentSpaceStore})),[]),[{value:Z}]=(0,r.r5)((async()=>{var e;return!(null===(e=c.electronApi)||void 0===e||!e.isProtocolRegistered)&&c.electronApi.isProtocolRegistered(g.default.calendar.desktopProtocol)}),[]),P=(0,s.useCallback)((()=>{y.sh({environment:w,spaceStore:void 0,collectionViewStore:void 0,from:n}),null==M||M()}),[w,n,M]),F=(0,s.useCallback)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:t}=h.default.state;e&&t&&(y.sh({environment:w,spaceStore:t,collectionViewStore:void 0,from:b}),null==j||j())}),[w,b,j]),_=(0,s.useCallback)((()=>{u.D({environment:w,url:g.default.calendar.downloadUrl}),null==C||C()}),[w,C]);return w.device.isElectron?Z?(0,S.jsx)(p.Z,{style:k.button,onClick:P,children:(0,S.jsx)(d.FormattedMessage,{...v.openCalendar})}):(0,S.jsx)(p.Z,{style:k.button,onClick:_,children:(0,S.jsx)(d.FormattedMessage,{...v.downloadApp})}):I||T?(0,S.jsx)(p.Z,{style:k.button,onClick:P,children:(0,S.jsx)(d.FormattedMessage,{...v.openCalendar})}):(0,S.jsxs)(m.h,{styles:k.button,onClick:F,children:[(0,l.R)(k.googleLogoIcon),(0,S.jsx)(d.FormattedMessage,{...v.continueWithGoogle})]})}},650:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O});var s=n(667294),i=n(313991),o=n(800480),a=n(886628),r=n(724405),l=n(745238),d=n(785893);const c=(0,l.IU)("checkedRoundedCheckmark",{viewBox:"0 0 16 16",svg:(0,d.jsx)("path",{d:"M7.99617 16C12.3807 16 15.9923 12.3807 15.9923 7.99617C15.9923 3.61167 12.373 0 7.99617 0C3.61167 0 0 3.61167 0 7.99617C0 12.3807 3.61167 16 7.99617 16ZM7.99617 14.2018C4.5605 14.2018 1.80583 11.4319 1.80583 7.99617C1.80583 4.5605 4.55285 1.79818 7.99617 1.79818C11.4319 1.79818 14.1942 4.5605 14.2018 7.99617C14.2018 11.4319 11.4319 14.2018 7.99617 14.2018ZM7.18508 11.6461C7.47585 11.6461 7.73601 11.4931 7.912 11.2329L11.3324 5.96078C11.4395 5.79244 11.5237 5.60115 11.5237 5.42516C11.5237 5.01196 11.1564 4.72119 10.7585 4.72119C10.506 4.72119 10.2841 4.86657 10.1081 5.14969L7.16212 9.84027L5.80775 8.14921C5.6241 7.912 5.43281 7.82783 5.18795 7.82783C4.7824 7.82783 4.45337 8.14921 4.45337 8.56241C4.45337 8.76136 4.52224 8.93735 4.66762 9.12099L6.42755 11.2406C6.6418 11.5084 6.87901 11.6461 7.18508 11.6461Z"})});var u=n(964275),m=n(368211),p=n(401436),g=n(709291),f=n(137810),h=n(86615),y=n(412714),x=n(61202),S=n(366309),v=n(164921),b=n(661519),M=n(584076),j=n(158297),C=n(164369),w=n(706175),k=n(95477),I=n(215010),T=n(918514),Z=n(548779),P=n(80444),F=n(319385),_=n(85844),A=n(584437),B=n(159110),R=n(391264);function D(e){let{launchModalPhase:t,renderChild:n}=e;const i=(0,o.O7)();return(0,s.useEffect)((()=>{"connected_notion_calendar"===t?h.Wy(i):h.QL(i)}),[i,t]),n()}const O=function(){const e=(0,o.O7)(),t=(0,r.yK)((e=>({container:{maxWidth:442},closeButton:{position:"absolute",top:12,right:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.outlineButtonPressedBackground,width:18,height:18},closeButtonHovered:{background:e.outlineButtonHoveredBackground},closeIcon:{width:14,fill:e.mediumTextColor},content:{padding:24,display:"flex",flexDirection:"column"},title:{fontWeight:f.Z.fontWeight.bold,fontSize:25,display:"flex",marginBottom:6},divider:{backgroundColor:e.tableLightDividerColor,opacity:.5},footer:{padding:"20px 24px",display:"flex",alignItems:"center",justifyContent:"space-between"},learnMoreLink:{display:"flex",alignItems:"center",fontSize:12,color:e.mediumTextColor,padding:"0 4px",marginLeft:-4},inlineLearnMoreLink:{display:"inline-flex",fontSize:"inherit",marginLeft:0,padding:0},externalLinkIcon:{width:14,height:14,marginLeft:2},inlineExternalLinkIcon:{width:16,height:16},successCheckmark:{width:50,height:50,display:"flex",alignItems:"center",justifyContent:"center"},successCheckmarkIcon:{width:32,height:32,color:e.mediumTextColor},successTitle:{fontSize:25,fontWeight:f.Z.fontWeight.bold,margin:"8px 0"},downloadContainer:{display:"flex",padding:"16px 20px",marginTop:28,borderRadius:12,background:e.cardBackground},downloadContent:{display:"flex",flexDirection:"column",paddingRight:8},downloadTitle:{fontSize:16,fontWeight:f.Z.fontWeight.semibold,marginBottom:4},downloadButtonContainer:{display:"flex"},downloadButton:{height:32,marginTop:12},notionCalendarLogo:{display:"flex",alignSelf:"end"},notionCalendarLogoIcon:{width:56,height:58}})),[]);(0,s.useEffect)((()=>{const t=()=>{_.Z.state.isVisible&&B.Z.state.isConnectingCalendar&&(B.Z.setState({isConnectingCalendar:!1}),x.pJ({environment:e}))};return _.Z.addListener(t),()=>{_.Z.removeListener(t)}}),[e]);const n=(0,s.useCallback)((()=>{const{currentUserSettingsStore:t}=P.default.state;t&&(A.tE({environment:e,userSettingsStore:t}),B.Z.setState({isForceShowing:!1}))}),[e]),l=(0,s.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n}=P.default.state;t&&n&&(A.WS(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.openCalendar",userSettingsStore:t}),B.Z.setState({isForceShowing:!1}))}),[e]),O=(0,s.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n}=P.default.state;t&&n&&(A.WS(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.existingNotionCalendarUser",userSettingsStore:t}),A.sh({environment:e,spaceStore:n,collectionViewStore:void 0,from:"onboardingModalExistingUser"}))}),[e]),L=(0,s.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n}=P.default.state;t&&n&&A.WS(e,{phase:"connected_notion_calendar",transactionUserAction:"NotionCalendarLaunchModal.continueWithGoogle",userSettingsStore:t})}),[e]),V=(0,s.useCallback)((()=>{const{currentUserSettingsStore:t}=P.default.state;t&&(A.WS(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.clickDownload",userSettingsStore:t}),B.Z.setState({isForceShowing:!1}))}),[e]),E=(0,a.VK)((()=>P.default.state.currentUserSettingsStore),[]),N=(0,a.VK)((()=>{const e=null==E?void 0:E.getSettings();return null==e?void 0:e.notion_calendar_launch_modal_phase}),[E]),U=(0,a.VK)((()=>{if(!E)return!1;const e=(0,I.e2)(E);return Number(e)>=4}),[E]),K=(0,a.VK)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n,mainEditorCurrentBlockStore:s}=P.default.state;if(e.device.isMobile)return!1;if(!t||!t.isReady())return!1;return!!t.getSettings()&&(!!(n&&s&&s.canRead())&&(!!B.Z.state.isForceShowing||!!F.default.checkGate({gateName:"notion_calendar_launch_modal"})&&(!(0,Z.Cx)(n)&&(!(0,Z.Dj)(n)&&(!!U&&(e.device.isElectron?void 0===N:void 0===N||"connected_notion_calendar"===N))))))}),[e,N,U]),W=()=>(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(v.Z,{onClick:n,style:t.closeButton,hoveredStyle:t.closeButtonHovered,children:(0,u.D)(t.closeIcon)}),(0,d.jsxs)("div",{style:t.content,children:[(0,d.jsx)("div",{style:t.successCheckmark,children:c(t.successCheckmarkIcon)}),(0,d.jsx)("div",{style:t.successTitle,children:(0,d.jsx)(g.FormattedMessage,{defaultMessage:"Success!",id:"notionCalendarLaunchModal.successTitle"})}),(0,d.jsx)(C.Z,{isSecondaryColor:!0,isMultiline:!0,children:(0,d.jsx)(g.FormattedMessage,{defaultMessage:"You can now view Notion docs, projects, tasks, and timelines alongside calendar events on Notion Calendar",id:"notionCalendarLaunchModal.successCaption"})}),(0,d.jsxs)("div",{style:t.downloadContainer,children:[(0,d.jsxs)("div",{style:t.downloadContent,children:[(0,d.jsx)("div",{style:t.downloadTitle,children:(0,d.jsx)(g.FormattedMessage,{defaultMessage:"Get the desktop app",id:"notionCalendarLaunchModal.downloadTitle"})}),(0,d.jsx)(C.Z,{isSecondaryColor:!0,isMultiline:!0,children:(0,d.jsx)(g.FormattedMessage,{defaultMessage:"See notifications, view your schedule, and join meetings from anywhere",id:"notionCalendarLaunchModal.downloadCaption"})}),(0,d.jsx)("div",{style:t.downloadButtonContainer,children:(0,d.jsx)(j.Z,{style:t.downloadButton,onClick:()=>{h.G(e,{cta:"download"}),y.D({environment:e,url:k.default.calendar.downloadUrl}),V()},children:(0,d.jsx)(g.FormattedMessage,{...R.v.downloadApp})})})]}),(0,d.jsx)("div",{style:t.notionCalendarLogo,children:(0,m.D)(t.notionCalendarLogoIcon)})]})]})]}),z=()=>(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(w.Z,{src:"https://player.vimeo.com/video/900939588?h=187435ef3c",defaultTextTrack:w.W[i.SP]||"en",options:{muted:!0,autoplay:!0,loop:!0,background:!0,playsinline:!0}}),(0,d.jsx)(v.Z,{onClick:n,style:t.closeButton,hoveredStyle:t.closeButtonHovered,children:(0,u.D)(t.closeIcon)}),(0,d.jsxs)("div",{style:t.content,children:[(0,d.jsx)("div",{style:t.title,children:(0,d.jsx)(g.FormattedMessage,{defaultMessage:"Meet Notion Calendar",id:"notionCalendarLaunchModal.title"})}),(0,d.jsxs)(C.Z,{isSecondaryColor:!0,isMultiline:!0,children:[(0,d.jsx)(g.FormattedMessage,{defaultMessage:"The beautifully designed calendar for your life and work. Integrated and synced with all your Google Calendar events.",id:"notionCalendarLaunchModal.caption"})," ",(0,d.jsxs)(M.Z,{external:!0,href:(0,T.UY)("blog.notionCalendarLaunch"),style:{...t.learnMoreLink,...t.inlineLearnMoreLink},children:[(0,d.jsx)(g.FormattedMessage,{defaultMessage:"Learn more",id:"notionCalendarLaunchModal.learnMore"}),(0,p.g)({...t.externalLinkIcon,...t.inlineExternalLinkIcon})]})]})]}),(0,d.jsx)(b.Z,{size:1,style:t.divider}),(0,d.jsxs)("div",{style:t.footer,children:[(0,d.jsx)(M.Z,{external:!0,onClick:O,style:t.learnMoreLink,children:(0,d.jsx)(g.FormattedMessage,{defaultMessage:"I already use Notion Calendar",id:"notionCalendarLaunchModal.alreadyUseNotionCalendar"})}),(0,d.jsx)(R.Z,{openCalendarFrom:"onboardingModalOpenCalendar",continueWithGoogleFrom:"onboardingModalSignIn",onOpenCalendarClick:()=>{h.Et(e,{cta:"open_calendar"}),l()},onContinueWithGoogleClick:()=>{h.Et(e,{cta:"continue_with_google"}),L()},onDownloadClick:()=>{h.Et(e,{cta:"download"}),V()}})]})]});return(0,d.jsx)(S.default,{shouldShow:K,calloutId:"notion_calendar_launch_promo",desktopRenderInner:()=>(0,d.jsx)(D,{launchModalPhase:N,renderChild:()=>"connected_notion_calendar"===N?W():z()}),desktopInnerStyle:t.container,desktopOnDismiss:n,phoneRenderInner:()=>null})}},494043:(e,t,n)=>{n.d(t,{Nx:()=>A,Pb:()=>_,Vc:()=>w,Vw:()=>R,Xg:()=>C,a3:()=>L,bj:()=>B,dp:()=>O,uI:()=>V,us:()=>P,w3:()=>k});var s=n(294184),i=n.n(s),o=n(667294),a=n(724405),r=n(831103),l=n(973420),d=n(60217),c=n(785893);const u="layout-wide",m="layout-wide-right-margin-expanded",p="layout-side-peek",g="layout-center-peek",f="layout-home",h="layout-form",y="layout-home-phone",x="layout-phone",S="layout-tablet",v="layout-template-preview",b="layout-chat",M="layout-layout-editor",j="layout-layout-editor-wide";function C(e){let{children:t,type:n,gap:s,withBottomPadding:o,style:a}=e;const r=(0,d.n1)(n);return(0,c.jsx)("div",{className:i()("layout",{[u]:"wide"===n,[m]:"wide-right-margin-expanded"===n,[p]:"side-peek"===n,[g]:"center-peek"===n,[f]:"home"===n,[y]:"home-phone"===n,[h]:"form"===n,[x]:"phone"===n,[S]:"tablet"===n,[v]:"template-preview"===n,[b]:"chat"===n,[M]:"layout-editor"===n,[j]:"layout-editor-wide"===n}),style:{paddingBottom:o?r:void 0,gap:s,...a},children:t})}const w="layout-content",k="layout-full",I="layout-margin-left",T="layout-margin-right",Z="layout-nested-grid",P="hide-scrollbar",F="layout-column";function _(e){return(0,c.jsx)("div",{className:i()(w,e.className),style:e.style,children:e.children})}function A(e){return(0,c.jsx)("div",{className:k,style:e.style,children:e.children})}function B(e){return(0,c.jsx)("div",{className:I,style:e.style,children:e.children})}function R(e){return(0,c.jsx)("div",{className:T,style:e.style,children:e.children})}const D=(0,o.forwardRef)((function(e,t){return(0,c.jsx)("div",{className:i()(Z,e.className),onClick:e.onClick,style:e.style,role:e.role,id:e.id,"aria-labelledby":e["aria-labelledby"],ref:t,children:e.children})}));function O(e){let{items:t,style:n}=e;const[s,i]=o.useState(0),d=(0,o.useRef)([]),u=(0,a.yK)((e=>({icon:{width:16,height:16,fill:"currentColor"},label:{fontSize:14,fontWeight:600},tab:"centered"===n?{cursor:"pointer",border:"none",padding:"6px 12px",borderRadius:20,color:e.text.secondary,background:"none"}:{cursor:"pointer",border:"none",borderBottom:"2px solid",borderColor:"transparent",padding:"6px 8px 12px",color:e.text.secondary,background:"none"},tabSelected:"centered"===n?{color:e.text.primary,background:e.tint.regular}:{color:e.text.primary,borderColor:e.regularTextColor}})),[n]),m=(0,o.useId)(),p=(0,o.useCallback)((e=>`${m}-tab-${e}`),[m]),g=(0,o.useCallback)((e=>`${m}-tabpanel-${e}`),[m]),f=(0,o.useCallback)((e=>{let n;var o;("ArrowLeft"===e.key?(e.preventDefault(),n=(s+t.length-1)%t.length):"ArrowRight"===e.key&&(e.preventDefault(),n=(s+1)%t.length),void 0!==n)&&(i(n),null===(o=d.current[n])||void 0===o||o.focus())}),[s,t.length]);return(0,c.jsx)(r.Z,{name:"PageLayoutTabs",children:(0,c.jsxs)(D,{children:[(0,c.jsx)(_,{children:(0,c.jsx)("div",{role:"tablist",children:(0,c.jsx)(l.X2,{justifyContent:"centered"===n?"center":"flex-start",children:t.map(((e,t)=>{var n;return(0,c.jsx)("button",{ref:e=>{e&&(d.current[t]=e)},id:p(t),role:"tab","aria-controls":g(t),"aria-selected":t===s,tabIndex:t===s?void 0:-1,onKeyDown:f,style:{...u.tab,...t===s&&u.tabSelected},onClick:e=>{e.stopPropagation(),i(t)},children:(0,c.jsxs)(l.X2,{gap:4,alignItems:"center",children:[null===(n=e.icon)||void 0===n?void 0:n.call(e,u.icon),e.label&&(0,c.jsx)("div",{style:u.label,children:e.label})]})},e.key)}))})})}),(0,c.jsx)(D,{id:g(s),role:"tabpanel","aria-labelledby":p(s),children:t[s]?t[s].children:null})]})})}function L(e){return(0,c.jsx)("div",{className:i()(F,e.className),style:{"--min-column-width":`${e.minWidth}px`,...e.style},children:e.children})}function V(e){return(0,c.jsxs)(L,{minWidth:e.minWidth,className:e.className,style:e.style,children:[e.left,e.right]})}},211368:(e,t,n)=>{n.r(t),n.d(t,{PageLayoutEditor:()=>Nt});var s=n(667294),i=n(886628),o=n(724405),a=n(953336),r=n(629551),l=n(212534),d=n(305971),c=n(434859),u=n(282725),m=n(334017),p=n(709291),g=n(137810),f=(n(21703),n(207525)),h=n(435840),y=n(552275),x=n(449953),S=n(573063),v=n(268894),b=n(632163),M=n(672495),j=n(566890),C=n(623879),w=n(152840),k=n(800480),I=n(195586),T=n(652136),Z=n(215828),P=n(316956),F=n(210228),_=n(287578);var A=n(399036),B=n(180951),R=n(912398),D=n(401898),O=n(312775),L=n(6429),V=n(785893);var E=n(446737),N=n(471924),U=n(213493),K=n(709953),W=n(741195),z=n(319385),q=n(206258),G=n(12396),H=n(220603);function $(e){const{propertyId:t}=e,{collectionStore:n}=(0,w.PP)(),s=(0,o.Fg)(),a=(0,i.VK)((()=>{const e=n.getSchema();return(0,B.Qm)({schema:e,property:t})}),[n,t]);return a?(0,V.jsx)(H.z,{...e,icon:(0,V.jsx)(G.ZP,{size:16,theme:s,icon:a.icon,type:a.type}),name:a.name}):null}const Y=(0,p.defineMessages)({heading:{id:"AddPageLayoutModuleEditorSidebar.title",defaultMessage:"Add to layout"},suggestedModulesSectionTitle:{defaultMessage:"Suggested",id:"AddPageLayoutModuleEditorSidebar.suggestedModulesSectionTitle"},existingPropertiesSectionTitle:{defaultMessage:"Use an existing property",id:"AddPageLayoutModuleEditorSidebar.existingPropertiesSectionTitle"},relatedCollectionPropertiesSectionTitle:{defaultMessage:"Add a database view",id:"AddPageLayoutModuleEditorSidebar.relatedCollectionPropertiesSectionTitle"},createNewPropertyModuleSectionTitle:{defaultMessage:"Create new property",id:"AddPageLayoutModuleEditorSidebar.createNewPropertyModuleSectionTitle"},closeAddModulesMenu:{defaultMessage:"Close add modules menu",id:"AddPageLayoutModuleEditorSidebar.closeAddModulesMenu"},searchInputPlaceholder:{defaultMessage:"Search...",id:"AddPageLayoutModuleEditorSidebar.searchInputPlaceholder"}}),Q=3;function J(){const{layoutStore:e,setModuleSelection:t}=(0,w.J9)(),{collectionStore:n}=(0,w.PP)(),a=function(){const e=(0,k.O7)(),{layoutStore:t,currentModuleSelection:n,setModuleSelection:i,sessionId:o}=(0,w.J9)(),{collectionStore:a}=(0,w.PP)();return(0,s.useCallback)((s=>{const{performResult:r}=F.createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.handleCreateNewStandardProperty",environment:e,perform:i=>{const r=t.getModel(),l=a.getModel();if(!r||!l||"new_module"!==(null==n?void 0:n.type))return;const d=P.G3({environment:e,collectionStore:a,collectionViewArgs:void 0,propertyName:C.SO[s],propertyType:s,transaction:i}),c={id:(0,Z.ZP)(),type:"property",propertyId:d,style:"expanded"};"person"===s&&(c.config={property_person:{style:"compact"}});const u=(0,I.G)(n.area),m=(0,T.$S)({collectionModel:l,module:c});return m?((0,_.s)({environment:e,transaction:i,layoutStore:t,position:"page_main"===u?{area:u,location:{type:"endConfigurable"}}:{area:u,location:{type:"end"}},module:m,sessionId:o}),c):void 0}});r&&i({type:"existing_module",moduleId:r.id,isDragging:!1})}),[e,i,t,a,n,o])}(),[l,d]=(0,s.useState)(!1),c=(0,j.Y$)(),u=(0,E.c)({actionHandler:a}),m=(0,i.VK)((()=>(0,C.TP)(c)),[c]),G=function(){const{layoutStore:e}=(0,w.J9)(),{collectionStore:t}=(0,w.PP)(),n=(0,L.K)(),s=(0,i.VK)((()=>new Set([...e.getModules().page_main,...e.getModules().page_details].filter(R.f).map((e=>e.propertyId)))),[e]);return(0,i.VK)((()=>{const i=t.getSchema();return e.getModel()?(0,D.qP)(i).map((e=>{let[t,n]=e;if(t!==A.iw&&!s.has(t)&&n)return(0,A.U8)(n)?{id:(0,Z.ZP)(),type:`property_${n.type}`,propertyId:t,style:"compact"}:{id:(0,Z.ZP)(),type:`property_${n.type}`,propertyId:t,style:"expanded"}})).filter(D.$K).map((e=>{const t=(0,B.Qm)({schema:i,property:e.propertyId});if(t)return{key:e.id,keywords:[t.name,C.SO[t.type]],render:t=>{let{ref:n,...s}=t;return(0,V.jsx)(O.R,{...s,propertyId:e.propertyId})},action:()=>{n({layoutModule:e})}}})).filter(D.$K):[]}),[n,t,e,s])}(),H=function(){const{layoutStore:e,currentModuleSelection:t}=(0,w.J9)(),{collectionStore:n}=(0,w.PP)(),o=(0,i.VK)((()=>z.default.checkGate({gateName:"page_layouts"})),[]),a=(0,k.O7)(),r=(0,L.K)(),l=(0,i.VK)((()=>n.getSchema()),[n]),d=(0,s.useCallback)((e=>{const t=l[e];if(!t||!(0,A.p_)(t))return;const s=t.collection_pointer;if(!s)return;const i=t.property;if(!i)return;const o=q.NW.createChildStore(n,s);if(!o)return;const d=o.getParentBlockStore();if(!d)return;const c=(0,Z.ZP)(),u=(0,W.$x)({environment:a,table:U.np,spaceId:d.getSpaceId()}),m=u.id,p={id:c,propertyId:e,type:"collectionView",collectionViewBlockPointer:d.getSpaceShardedPointer(),collectionViewPointer:u},g={id:m,type:"table",parent_id:d.id,parent_table:d.table,space_id:d.getSpaceId(),alive:!0,format:{property_filters:[{id:N.Il(),filter:{property:i,filter:{operator:"relation_contains",value:{type:"relative",value:{type:"current_page_in_related_collection"}}}}}],hide_linked_collection_name:!0}};F.createAndCommit({environment:a,perform:e=>{K.ae({environment:a,table:U.np,value:g,inMemoryRecordCache:d.inMemoryRecordCache,transaction:e})},userAction:"BuilderLayoutModules.createCollectionViewModule"}),r({layoutModule:p})}),[r,l,n,a]),c=(0,i.VK)((()=>"new_module"===(null==t?void 0:t.type)&&"page_info_layout_schema"===t.area),[t]);return(0,i.VK)((()=>{if(!o||c)return[];const t=n.getSchema();return e.getModel()?Object.keys(t).filter((e=>{const n=null==t?void 0:t[e];return n&&(0,A.p_)(n)&&(0,D.$K)(n.property)})).map((e=>{const n=(0,B.Qm)({schema:t,property:e});if(n)return{key:e,keywords:[n.name],render:t=>{let{ref:n,...s}=t;return(0,V.jsx)($,{...s,propertyId:e})},action:()=>{d(e)}}})).filter(D.$K):[]}),[d,n,o,e,c])}(),[J,X]=(0,s.useState)(),ee=(0,o.yK)((e=>({sidebarHeading:{fontWeight:g.Z.fontWeight.semibold,marginLeft:6},closeButton:{marginLeft:"auto",marginRight:4},searchInputContainer:{marginTop:12,marginBottom:14,marginLeft:6},searchInput:{background:e.contentBackground},searchInputIcon:{fill:e.mediumIconColor,width:10},moreButton:{margin:0,color:e.lightTextColor,fontSize:12,padding:"0 0 0 6px"},sectionTitle:{padding:"0 0 0 6px"}})),[]),te=(0,i.VK)((()=>{const t=e.getModel(),s=n.getModel();if(!t||!s)throw new Error("Error getting model for layoutStore");const i={file:1,person:2};return[...m.sort(((e,t)=>(i[e]??1/0)-(i[t]??1/0))).slice(0,l||J?void 0:Q).map(u),...J?[]:[{keywords:[],key:"create-new-property-more",render:e=>(0,V.jsx)(y.Z,{...e,desktopTitleStyle:ee.moreButton,title:(0,V.jsx)("span",{children:l?"Less":"More"})}),action:()=>d((e=>!e))}]]}),[m,n,l,u,e,J,ee.moreButton]),ne=(0,p.useIntl)(),se={key:"existing-properties",render:e=>(0,V.jsx)(M.Z,{title:ne.formatMessage(Y.existingPropertiesSectionTitle),desktopTitleStyle:ee.sectionTitle,...e}),items:G},ie={key:"related-collection-properties",render:e=>(0,V.jsx)(M.Z,{title:ne.formatMessage(Y.relatedCollectionPropertiesSectionTitle),desktopTitleStyle:ee.sectionTitle,...e}),items:H},oe={key:"create-new-properties",render:e=>(0,V.jsx)(M.Z,{title:ne.formatMessage(Y.createNewPropertyModuleSectionTitle),desktopTitleStyle:ee.sectionTitle,...e}),items:te},ae=(0,s.useCallback)((()=>{t(void 0)}),[t]),re=(0,s.useCallback)((e=>X(e.target.value)),[]);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(r.gq,{style:ee.sidebarHeading,alignItems:"center",children:[(0,V.jsx)(p.FormattedMessage,{...Y.heading}),(0,V.jsx)(S.Z,{onClick:ae,style:ee.closeButton,icon:f.t,ariaLabel:ne.formatMessage(Y.closeAddModulesMenu)})]}),(0,V.jsx)(v.ZP,{focusInitial:!0,onChange:re,placeholder:ne.formatMessage(Y.searchInputPlaceholder),showClearButton:!0,value:J||"",style:ee.searchInputContainer,inputOuterStyle:ee.searchInput,inputLeft:(0,h.R)(ee.searchInputIcon),itemMarginLeft:0}),(0,V.jsx)(x.f,{filterQuery:J,initialFocus:0,type:b.i.Vertical,sections:[oe,...G.length>0?[se]:[],...H.length>0?[ie]:[]]})]})}var X=n(805149),ee=n(413182),te=n(966603),ne=n(925489);function se(e){return(0,V.jsx)(V.Fragment,{children:(0,V.jsx)("div",{style:{marginLeft:-16},children:e.children})})}n(252262),n(324506);var ie=n(406695),oe=n(295519),ae=n(487167),re=n(65091),le=n(985526),de=n(950780),ce=n(937612),ue=n(76233),me=n(653965),pe=n(496802),ge=n(231945),fe=n(301743),he=n(374194),ye=n(478140),xe=n(489728),Se=n(953437),ve=n(158297),be=n(460709),Me=n(825464),je=n(61766),Ce=n(749085);class we extends Ce.default{getInitialState(){return{}}isRenameInputForcedOpenForGroup(e){var t;return(null===(t=this.getState())||void 0===t?void 0:t.forceOpenRenameInputForGroupId)===e}resetForceRenameInputOpen(){const e=this.getState();return this.setState({...e,forceOpenRenameInputForGroupId:void 0})}}const ke=new we;function Ie(e){const{title:t,propertyGroupId:n,styles:a}=e,r=(0,i.qz)(void 0,je.Z),l=(0,i.VK)((()=>ke.isRenameInputForcedOpenForGroup(n)),[n]),[d,c]=(0,s.useState)(l);(0,s.useEffect)((()=>{r.setState({...r.state,open:l})}),[r,l]);const u=(0,s.useCallback)((()=>{c(!1),ke.resetForceRenameInputOpen()}),[]),m=function(){const{collectionStore:e}=(0,w.PP)(),t=(0,k.O7)();return(0,s.useCallback)((n=>{const s=e.getFormat().property_groups;if(void 0===s)throw new Error("Error deleting property group. Collection Does not have property groups.");if(1===s.length)return void F.createAndCommit({environment:t,perform(t){pe.FH({stores:[e],update:{property_groups:void 0},transaction:t})},userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"});const i=s.findIndex((e=>e.id===n));if(-1===i)throw new Error(`Error deleting property group. Could not find property group with id: ${n}`);const o=s.at(i);if(!o)throw new Error(`Error deleting property group. Could not find property group with id: ${n}`);const a=0===i,r=a?1:i-1,l=s.at(r);if(!l)throw new Error("Error deleting property group. Could not find group to move property ids to.");const d=(0,me.zu)(s,o).map((e=>{if(e.id===l.id){const t=a?[...o.propertyIds||[],...e.propertyIds||[]]:[...e.propertyIds||[],...o.propertyIds||[]];return{...e,propertyIds:t}}return e}));F.createAndCommit({environment:t,perform(t){pe.FH({stores:[e],update:{property_groups:d},transaction:t})},userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),g=(0,o.yK)((e=>({container:{display:"flex",alignItems:"center",marginBottom:8,...(null==a?void 0:a.container)||{}},label:{fontSize:"12px",lineHeight:"15px",color:e.mediumTextColor,fontWeight:500,marginRight:"auto",padding:"2px 4px 2px 4px",borderRadius:2,height:"auto",marginLeft:"-4px"}})),[a]);return(0,V.jsx)("div",{style:g.container,children:(0,V.jsx)(ge.ZP,{style:{width:268},onClose:u,popupType:Se.kQ.Popup,renderOrigin:e=>(0,V.jsx)(xe.Z,{style:g.label,...e,children:t}),buttonPopupStore:r,alignmentToOrigin:Me.v.Start,render:e=>{return d?(0,V.jsx)(Te,{propertyGroupId:n,value:t||"",afterSubmit:e.close}):(0,V.jsx)(ye.Z,{menuType:be.og.Popup,children:(0,V.jsx)(b.Z,{type:b.i.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,V.jsx)(M.Z,{...e}),items:(s=e.close,[{key:"rename",render:e=>(0,V.jsx)(y.Z,{...e,icon:(0,de.E)({width:16,height:16}),title:(0,V.jsx)(p.FormattedMessage,{defaultMessage:"Rename",id:"ConfigurePropertyGroupModuleGroupHeading.rename"})}),action:()=>{c(!0)}},{key:"delete",render:e=>(0,V.jsx)(y.Z,{...e,icon:(0,ce.y)({width:16,height:16}),title:(0,V.jsx)(p.FormattedMessage,{defaultMessage:"Delete",id:"ConfigurePropertyGroupModuleGroupHeading.delete"})}),action:()=>{m(n),s()}}])}]})});var s}})})}function Te(e){let{propertyGroupId:t,afterSubmit:n,value:i}=e;const a=(0,s.useRef)(null),[r,l]=(0,s.useState)(i),d=(0,o.yK)((()=>({container:{display:"flex",padding:"6px"},input:{marginRight:4,flexGrow:1},button:{}})),[]),c=function(){const{collectionStore:e}=(0,w.PP)(),t=(0,k.O7)();return(0,s.useCallback)(((n,s)=>{const i=e.getFormat().property_groups;if(void 0===i)throw new Error("Error renaming property group. Collection Does not have property groups.");const o=i.map((e=>e.id===n?{...e,title:s}:e));F.createAndCommit({environment:t,perform(t){pe.FH({stores:[e],update:{property_groups:o},transaction:t})},userAction:"ConfigurePropertyExplorerModule.renameCollectionPropertyGroup"})}),[e,t])}(),u=(0,s.useCallback)((()=>{const e=(0,ue.vJ3)(r).trim();0!==e.length&&(c(t,e),n())}),[n,c,r,t]),m=(0,s.useCallback)((e=>{l(e.target.value)}),[]);return(0,V.jsx)(fe.Z,{debugName:"ConfigurePropertyGroupHeader",capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,V.jsxs)("div",{style:d.container,children:[(0,V.jsx)(he.Z,{style:d.input,onSubmit:u,ref:a,value:r,onChange:m,focusInitial:!0}),(0,V.jsx)(ve.Z,{style:d.button,onClick:u,children:(0,V.jsx)(p.FormattedMessage,{id:"ConfigurePropertyGroupModuleGroupHeading.updatePropertyGroupTitle",defaultMessage:"Done"})})]})})}var Ze=n(3093),Pe=n(279131),Fe=n(123347);function _e(e){const{collectionFormat:t,mergedProperties:n,renderPropertyRow:o}=e,{collectionStore:a}=(0,w.PP)(),r=(0,i.VK)((()=>null==n?void 0:n.map((e=>e.property))),[n]),l=(0,s.useCallback)(((e,t)=>o({propertyId:e,rowIndex:t})),[o]),d=(0,ae.G_)({collectionStore:a,format:t});return r?(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(Pe.ZP,{keys:r,onDrop:d,direction:"vertical",renderKey:l})}):null}function Ae(e){const{renderPropertyRow:t,renderPropertyGroupRow:n}=e,{collectionStore:o}=(0,w.PP)(),{keys:a,renderKey:r,onDrop:l}=function(e){const{renderPropertyRow:t,renderPropertyGroupRow:n,collectionStore:o}=e,a=(0,k.O7)(),r=(0,i.VK)((()=>o.getFormat().property_groups||[]),[o]),{flattenedGroupsAndProperties:l,groupAndPropertyLookupMap:d}=(0,Ze.T8)({propertyGroups:r}),c=l.map((e=>{const t=d[e];if(!t)throw new Error(`cannot render unknown key draggable list: ${e}`);return"property"===t.type?{key:e,draggable:!0}:{key:e,draggable:!1}})),u=(0,s.useCallback)(((e,s)=>{const i=d[e];if(!i)throw new Error(`cannot render unknown key draggable list: ${e}`);return"property"===i.type?t({propertyId:e,rowIndex:s}):n({groupId:e,groupTitle:i.group.title,rowIndex:s})}),[d,n,t]),m=(0,s.useCallback)((e=>{const t=(0,Ze.Lr)({flattenedGroupsAndProperties:e,groupAndPropertyLookupMap:d});F.createAndCommit({environment:a,perform(e){(0,Fe.N7)({collectionStore:o,newGroups:t,transaction:e})},userAction:"ConfigurePropertyExplorerModule.onDrop"})}),[o,a,d]);return{keys:c,renderKey:u,onDrop:m}}({renderPropertyRow:t,renderPropertyGroupRow:n,collectionStore:o});return(0,V.jsx)(Pe.ZP,{direction:"vertical",keys:a,renderKey:r,onDrop:l})}var Be=n(239132),Re=n(561061);const De=(0,n(745238).IU)("eyelash",{viewBox:"0 0 16 16",svg:(0,V.jsx)("path",{fillRule:"evenodd",d:"M2.1488 5.12366C1.94088 4.76541 1.48191 4.64354 1.12366 4.85145C0.76541 5.05937 0.643537 5.51833 0.851451 5.87659C1.05856 6.23345 1.30425 6.56012 1.58188 6.85746L0.46967 7.96967C0.176777 8.26256 0.176777 8.73744 0.46967 9.03033C0.762563 9.32322 1.23744 9.32322 1.53033 9.03033L2.73804 7.82262C3.18107 8.11266 3.66308 8.35645 4.17017 8.55584L3.30384 10.7217C3.15001 11.1062 3.33707 11.5427 3.72166 11.6966C4.10624 11.8504 4.54272 11.6633 4.69656 11.2787L5.61111 8.99235C6.14972 9.11164 6.70058 9.18864 7.25 9.22519V11.5C7.25 11.9142 7.58579 12.25 8 12.25C8.41421 12.25 8.75 11.9142 8.75 11.5V9.2252C9.29955 9.18866 9.85054 9.11164 10.3893 8.99232L11.3038 11.2787C11.4577 11.6633 11.8942 11.8504 12.2787 11.6966C12.6633 11.5427 12.8504 11.1062 12.6966 10.7217L11.8302 8.55579C12.3372 8.35643 12.8191 8.11269 13.2621 7.82272L14.4697 9.03033C14.7626 9.32322 15.2374 9.32322 15.5303 9.03033C15.8232 8.73744 15.8232 8.26256 15.5303 7.96967L14.4182 6.85759C14.6959 6.56021 14.9417 6.2335 15.1488 5.87659C15.3567 5.51833 15.2348 5.05937 14.8766 4.85145C14.5183 4.64354 14.0594 4.76541 13.8515 5.12366C12.883 6.79244 10.5428 7.75012 8.00012 7.75012C5.45748 7.75012 3.11728 6.79244 2.1488 5.12366Z"})});var Oe=n(579257),Le=n(13654);function Ve(e){const{propertyId:t,propertyFormat:n,pagePropertiesStore:a,collectionStore:r,pageStore:l}=e,d=(0,p.useIntl)(),c=(0,k.O7)(),u=(0,o.yK)((e=>({propertyRow:{display:"flex",alignItems:"center",width:"100%",gap:2},propertyRowName:{flexGrow:1}})),[]),m=(0,i.VK)((()=>r.getSchema()),[r]),g=(0,i.VK)((()=>(0,oe.i)(r.getFormat(),m,void 0,ie.j5.Collection)),[r,m]),f=m[t],h=(0,s.useCallback)((e=>{F.createAndCommit({environment:c,userAction:"LayoutBuilder.propertiesConfiguration.toggleVisibility",perform:n=>{Oe.M0({property:t,visibility:e,store:r,format:g,transaction:n})}})}),[g,r,c,t]),y="show"===(null==n?void 0:n.visibility)?Be.c:"hide_if_empty"===(null==n?void 0:n.visibility)?Re.B:De,x="show"===(null==n?void 0:n.visibility)||"hide_if_empty"===(null==n?void 0:n.visibility);return f?(0,V.jsxs)("div",{style:u.propertyRow,children:[(0,V.jsx)(Le.Z,{schema:m,style:u.propertyRowName,format:g,property:t,collectionStore:r,disabled:!1,locked:!1,canConfigureCollection:!0,isInPeekRenderer:!1,hideDragHandle:!0,blockStore:l,pagePropertiesStore:a}),(0,V.jsx)(ge.ZP,{popupType:Se.kQ.Popup,renderOrigin:e=>(0,V.jsx)(S.Z,{ariaLabel:d.formatMessage(Ne.visibilityToggleIconAriaLabel,{propertyName:f.name}),icon:y,isDarkIconColor:x,...e}),alignmentToOrigin:Me.v.Start,render:e=>(0,V.jsx)(Ee,{parentClose:e.close,setVisibilityOfProperty:h})})]}):null}function Ee(e){const{setVisibilityOfProperty:t,parentClose:n}=e,i=(0,s.useMemo)((()=>[{key:0,render:e=>(0,V.jsx)(M.Z,{...e}),items:[{key:"always_show",render:e=>(0,V.jsx)(y.Z,{...e,icon:(0,Be.c)({width:16,height:16}),title:(0,V.jsx)(p.FormattedMessage,{defaultMessage:"Always Show",id:"ConfigurePropertiesPropertyRow.visibility.alwaysShow"})}),action:()=>{t("show"),n()}},{key:"hide_if_empty",render:e=>(0,V.jsx)(y.Z,{...e,icon:(0,Re.B)({width:16,height:16}),title:(0,V.jsx)(p.FormattedMessage,{defaultMessage:"Hide when empty",id:"ConfigurePropertiesPropertyRow.visibility.hide_when_empty"})}),action:()=>{t("hide_if_empty"),n()}},{key:"hide",render:e=>(0,V.jsx)(y.Z,{...e,icon:De({width:16,height:16}),title:(0,V.jsx)(p.FormattedMessage,{defaultMessage:"Always hide",id:"ConfigurePropertiesPropertyRow.visibility.alwaysHide"})}),action:()=>{t("hide"),n()}}]}]),[n,t]);return(0,V.jsx)(ye.Z,{menuType:be.og.Popup,children:(0,V.jsx)(b.Z,{type:b.i.Vertical,initialFocus:0,sections:i})})}const Ne=(0,p.defineMessages)({visibilityToggleIconAriaLabel:{id:"pageLayout.configureProperties.visibilityToggleIconAriaLabel",defaultMessage:"Toggle the visibility {propertyName}"}});var Ue=n(846010),Ke=n(375071);const We=(0,p.defineMessages)({newSection:{id:"NewCollectionPropertyGroupButton.label",defaultMessage:"New section"}});function ze(){const{collectionStore:e}=(0,w.PP)(),t=(0,k.O7)(),n=(0,p.useIntl)(),i=(0,o.yK)((e=>({button:{borderRadius:999,fontSize:12,background:"dark"===e.mode?e.accentColors.translucentGray[300]:e.accentColors.gray[50],color:e.darkTextColor,padding:"3px 10px 3px 8px"},icon:{fill:e.darkTextColor}})),[]),a=(0,s.useCallback)((()=>{const s=n.formatMessage(We.newSection),{performResult:i}=F.createAndCommit({environment:t,perform:t=>(0,Fe.xN)({collectionStore:e,newGroupTitle:s,transaction:t}),userAction:"ConfigurePropertyExplorerModule.onDrop"});i&&ke.setState({forceOpenRenameInputForGroupId:i})}),[e,t,n]);return(0,V.jsx)(xe.Z,{icon:Ke.f,onClick:a,style:i.button,iconStyle:i.icon,children:(0,V.jsx)(p.FormattedMessage,{...We.newSection})})}function qe(e){const{title:t}=e,n=(0,Ue.y)()?(0,V.jsx)(ze,{}):null;return(0,V.jsxs)(r.gq,{justifyContent:"space-between",children:[t,n]})}function Ge(e){let{module:t}=e;const{collectionStore:n}=(0,w.PP)(),o=(0,j.Y$)(),a=(0,i.VK)((()=>n.getSchema()),[n]),r=(0,i.VK)((()=>{if((0,R.f)(t))return t}),[t]),l=(0,i.VK)((()=>r&&a[r.propertyId]),[r,a]);return(0,s.useEffect)((()=>{r&&(X.r$({collectionContextStore:o,collectionSettingsStore:o.settingsStore}),X.FK({collectionSettingsStore:o.settingsStore,item:{type:"property",property:r.propertyId,formatKey:void 0}}))}),[o,r]),l&&r?(0,V.jsx)(se,{children:(0,V.jsx)(ee.PJ,{collectionContextStore:o,collectionSettingsStore:o.settingsStore,context:te.HV.ViewBlock,fullHeight:!0})}):null}n(757658);var He=n(923903),$e=n(634040),Ye=n(750187),Qe=n(282356),Je=n(339861);function Xe(e){let{layoutModule:t,propertyId:n,draggable:a,isPinned:r}=e;const l=(0,p.useIntl)(),{collectionStore:d,pageStore:c}=(0,w.PP)(),u=(0,i.VK)((()=>d.getSchema()),[d]),m=(0,s.useMemo)((()=>new le.p),[]),g=(0,i.VK)((()=>(0,oe.i)(d.getFormat(),u,void 0,ie.j5.Collection)),[d,u]),f=function(e){const{layoutStore:t}=(0,w.J9)(),n=(0,k.O7)();return(0,s.useCallback)((s=>{if(!e)return;const i=t.getModel(),o=null==i?void 0:i.getPageModuleAreaById(e.id);if(!o||!i||"titleWithIcon"!==e.type||e.id!=e.id)return;let a=[...e.propertyIds??[]];a.includes(s)?a=a.filter((e=>e!==s)):a.push(s);const r={...e,type:"titleWithIcon",propertyIds:a};F.createAndCommit({environment:n,perform(s){(0,Je.U)({environment:n,transaction:s,layoutStore:t,position:{area:o,moduleId:e.id},updatedModule:r})},userAction:"ConfigureTitleAndIconModule.togglePinProperty"})}),[n,e,t])}(t),h=(0,o.yK)((()=>({propertyRow:{display:"flex",alignItems:"center",width:"100%",minWidth:"100%",gap:2,marginLeft:5},propertyRowName:{flexGrow:1}})),[]),y=(0,i.VK)((()=>d.canEdit()),[d]),x=(0,i.VK)((()=>c.isLocked()),[c]),v=u[n];return v?(0,V.jsxs)("div",{style:h.propertyRow,children:[(0,V.jsx)(Le.Z,{schema:u,style:h.propertyRowName,format:g,property:n,collectionStore:d,disabled:!1,locked:x,canConfigureCollection:y,isInPeekRenderer:!1,hideDragHandle:!a,blockStore:c,pagePropertiesStore:m}),(0,V.jsx)(S.Z,{ariaLabel:r?l.formatMessage(et.toggleUnpinnedAriaLabel,{propertyName:v.name}):l.formatMessage(et.togglePinnedAriaLabel,{propertyName:v.name}),icon:r?$e._:He.P,onClick:()=>f(n)})]},n):null}const et=(0,p.defineMessages)({togglePinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.togglePinnedAriaLabel",defaultMessage:"Show {propertyName} as pinned"},toggleUnpinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.toggleUnpinnedAriaLabel",defaultMessage:"Do not show {propertyName} as pinned"},pinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.pinnedPropertiesLabel",defaultMessage:"Pinned Properties"},unpinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.unpinnedPropertiesLabel",defaultMessage:"Unpinned Properties"},noPinnedPropertiesMessage:{id:"pageLayout.configurePinnedProperties.noPinnedPropertiesMessage",defaultMessage:"No properties pinned"},noUnpinnedPropertiesMessage:{id:"pageLayout.configurePinnedProperties.noUnpinnedPropertiesMessage",defaultMessage:"No properties to pin"}});function tt(e){let{moduleId:t}=e;const{layoutStore:n}=(0,w.J9)(),s=(0,i.VK)((()=>n.getModuleById(t)),[n,t]),a=(0,o.yK)((()=>({container:{height:"100%"}})),[]);return s?(0,V.jsxs)("div",{style:a.container,children:[(0,V.jsx)(nt,{module:s}),(0,V.jsx)(it,{module:s})]}):null}function nt(e){const{module:t}=e,{collectionStore:n}=(0,w.PP)(),s=(0,i.VK)((()=>(0,R.f)(t)?n.getSchema()[t.propertyId]:void 0),[n,t]),a=(0,o.yK)((()=>({title:{fontWeight:g.Z.fontWeight.semibold,marginBottom:16}})),[]),r=s?(0,V.jsx)("span",{children:C.SO[s.type]}):(0,V.jsx)(p.FormattedMessage,{...ot[(0,T.cm)(t).type]}),l=(0,V.jsx)("div",{style:a.title,children:r});return"properties"===t.type?(0,V.jsx)(qe,{title:l}):l}const st={properties:function(e){var t;const{module:n}=e;if("properties"!==n.type)throw new Error("Wrong page module type for component");const{collectionStore:a,pageStore:r}=(0,w.PP)(),l=(0,i.VK)((()=>a.getSchema()),[a]),d=(0,s.useMemo)((()=>new le.p),[]),c=(0,i.VK)((()=>a.getFormat().property_groups),[a]),u=null==c||null===(t=c.at(-1))||void 0===t?void 0:t.id,m=(0,i.VK)((()=>(0,oe.i)(a.getFormat(),l,void 0,ie.j5.Collection)),[a,l]),p=(0,ae.nd)({store:r,format:m,schema:l,collectionStore:a}),g=(0,s.useMemo)((()=>{const e={};return p.forEach((t=>e[t.property]=t)),e}),[p]),f=(0,s.useCallback)((e=>{let{propertyId:t,rowIndex:n}=e;return(0,V.jsx)(Ve,{propertyId:t,propertyFormat:g[t],collectionStore:a,pagePropertiesStore:d,pageStore:r})}),[a,g,d,r]),h=(0,s.useCallback)((e=>{let{groupId:t,groupTitle:n,rowIndex:s}=e;const i={container:0===s?void 0:{marginTop:16}};return(0,V.jsx)(Ie,{title:n,propertyGroupId:t,styles:i})}),[]),y=(0,o.yK)((()=>({addPropertyButtonContainer:{marginTop:16}})),[]);return(0,V.jsxs)("div",{children:[c?(0,V.jsx)(Ae,{renderPropertyRow:f,renderPropertyGroupRow:h}):(0,V.jsx)(_e,{collectionFormat:m,mergedProperties:p,renderPropertyRow:f}),(0,V.jsx)("div",{style:y.addPropertyButtonContainer,children:(0,V.jsx)(re.le,{collectionStore:a,isInPeekRenderer:!1,pagePropertiesStore:d,propertyGroupId:c?u:void 0})})]})},titleWithIcon:function(e){let{module:t}=e;if("titleWithIcon"!==t.type)throw new Error(`TitleWithIcon configuration shouldn't be used for ${t.type}`);const{collectionStore:n}=(0,w.PP)(),a=(0,i.VK)((()=>n.getSchema()),[n]),r=(0,s.useMemo)((()=>new le.p),[]),l=(0,s.useMemo)((()=>"titleWithIcon"!==t.type?[]:t.propertyIds??[]),[t]),d=(0,s.useMemo)((()=>new Set(l)),[l]),c=(0,i.VK)((()=>(0,D.Yd)(a).filter((e=>!(0,A.pn)(e)&&!d.has(e)))),[d,a]),u=function(e){const t=(0,k.O7)(),{layoutStore:n}=(0,w.J9)();return(0,s.useCallback)((s=>{const i=n.getModel(),o=null==i?void 0:i.getRawPageModuleAreaById(e.id);if(!o||!i)return;const a=i.updatePageModuleWithId({area:o,moduleId:e.id,fn:t=>"titleWithIcon"!==t.type||t.id!==e.id?t:{...t,propertyIds:s}});F.createAndCommit({environment:t,perform(e){Qe.JH({transaction:e,rawModules:a,layoutStore:n,area:o})},userAction:"ConfigureTitleAndIconModule.handlePinnedPropertyReorderDrop"})}),[t,e,n])}(t),m=(0,o.yK)((e=>({label:{fontSize:"12px",lineHeight:"15px",color:e.mediumTextColor,fontWeight:500,marginBottom:5},noPinnedPropertiesMessage:{fontSize:g.Z.fontSize.UIRegular.desktop,color:e.mediumTextColor,borderRadius:2},popoverMessage:{color:e.lightTextColor,fontSize:g.Z.fontSize.UISmall.desktop,marginTop:10}})),[]),f=l.length?(0,V.jsx)(Pe.ZP,{keys:l,onDrop:u,direction:"vertical",renderKey:e=>(0,V.jsx)(Xe,{layoutModule:t,propertyId:e,isPinned:!0,draggable:!0})}):(0,V.jsx)("span",{style:m.noPinnedPropertiesMessage,children:(0,V.jsx)(p.FormattedMessage,{...et.noPinnedPropertiesMessage})}),h=c.map((e=>(0,V.jsx)(Xe,{layoutModule:t,propertyId:e,isPinned:!1,draggable:!1},e)));return(0,V.jsxs)(V.Fragment,{children:[l.length>Ye.c&&(0,V.jsx)("div",{style:m.popoverMessage,children:(0,V.jsx)(p.FormattedMessage,{id:"pageLayout.configurePinnedProperties.maxPinnedProperties",defaultMessage:"Pinned properties will appear in a popover menu when space is limited"})}),(0,V.jsx)("div",{style:{...m.label,marginTop:10},children:(0,V.jsx)(p.FormattedMessage,{...et.pinnedPropertiesLabel})}),f,(0,V.jsx)("div",{style:{...m.label,marginTop:24},children:(0,V.jsx)(p.FormattedMessage,{...et.unpinnedPropertiesLabel})}),h,(0,V.jsx)("div",{style:{marginTop:14},children:(0,V.jsx)(re.le,{collectionStore:n,isInPeekRenderer:!1,pagePropertiesStore:r})})]})},property_title:Ge,property_text:Ge,property_url:Ge,property_email:Ge,property_phone_number:Ge,property_checkbox:Ge,property_person:Ge,property_created_by:Ge,property_last_edited_by:Ge,property_file:Ge,property_select:Ge,property_multi_select:Ge,property_status:Ge,property_number:Ge,property_date:Ge,property_created_time:Ge,property_last_edited_time:Ge,property_last_visited_time:Ge,property_formula:Ge,property_relation:Ge,property_rollup:Ge,property_button:Ge,property_auto_increment_id:Ge,property_location:Ge,property_verification:Ge,collectionView:function(e){let{module:t}=e;const{pageStore:n}=(0,w.PP)(),s=function(e){const{environment:t,module:n,pageStore:s}=e;return(0,i.VK)((()=>{if(!(0,R.o1)(n))return;const e=q.G.createChildStore(s,n.collectionViewBlockPointer);if(!e||!e.isCollectionView())return;const i=e.getCollectionPointer();if(!i)return;const o=q.Xr.createChildStore(e,n.collectionViewPointer);if(!o)return;const a=q.NW.createChildStore(e,i),r=new ne.Z(t);return r.collectionViewModuleContextStore.setState({type:"layoutBuilder",collectionViewModule:n,currentPageInRelatedCollectionStore:s}),r.setContext({type:"collectionView",collectionViewBlockStore:e,collectionStore:a,collectionViewStore:o,pageVisitSourceOverride:void 0}),X.r$({collectionContextStore:r,collectionSettingsStore:r.settingsStore}),r}),[t,n,s])}({environment:(0,k.O7)(),module:t,pageStore:n}),o=(0,i.VK)((()=>null==s?void 0:s.settingsStore),[s]);return t&&s&&o?(0,V.jsx)(se,{children:(0,V.jsx)(j.cu.Provider,{value:s,children:(0,V.jsx)(ee.PJ,{collectionContextStore:s,collectionSettingsStore:o,context:te.HV.ViewBlock})})}):null}};function it(e){const{module:t}=e,n=st[t.type];return n?(0,V.jsx)(n,{...e}):null}const ot=(0,p.defineMessages)({cover:{id:"pageLayoutEditor.cover",defaultMessage:"Cover"},titleWithIcon:{id:"pageLayoutEditor.titleWithIcon",defaultMessage:"Heading"},properties:{id:"pageLayoutEditor.properties",defaultMessage:"Properties"},property:{id:"pageLayoutEditor.property",defaultMessage:"Property"},inlinePageSections:{id:"pageLayoutEditor.inlinePageSections",defaultMessage:"Inline Page Sections"},expandedBacklinks:{id:"pageLayoutEditor.expandedBacklinks",defaultMessage:"Backlinks"},discussions:{id:"pageLayoutEditor.discussions",defaultMessage:"Page Comments"},editor:{id:"pageLayoutEditor.editor",defaultMessage:"Editor"},tabs:{id:"pageLayoutEditor.tabs",defaultMessage:"Tabs"},transcript:{id:"pageLayoutEditor.transcript",defaultMessage:"Transcript"},bottomControls:{id:"pageLayoutEditor.bottomControls",defaultMessage:"Bottom Controls"},selectAModulePrompt:{id:"pageLayoutEditor.selectAModuleTitle",defaultMessage:"Select a module to configure"},deleteModuleButton:{id:"pageLayoutEditor.deleteModuleButton",defaultMessage:"Delete"},collectionView:{id:"pageLayoutEditor.collectionView",defaultMessage:"View"},formTitle:{id:"pageLayoutEditor.formTitle",defaultMessage:"Form Title"},formQuestion:{id:"pageLayoutEditor.formQuestion",defaultMessage:"Form Question"},formSubmit:{id:"pageLayoutEditor.formSubmit",defaultMessage:"Form Submit"},placeholder:{id:"pageLayoutEditor.placeholder",defaultMessage:"New"}}),at=300;function rt(){const{currentModuleSelection:e}=(0,w.J9)(),t=(0,o.yK)((e=>({container:{padding:"8px 16px 24px 16px",minWidth:at,width:at,maxWidth:at},title:{fontSize:17,fontWeight:g.Z.fontWeight.semibold},subTitle:{fontSize:g.Z.fontSize.UISmall.desktop,fontWeight:g.Z.fontWeight.medium,marginBottom:8}})),[]);return e?(0,V.jsxs)(a.Z,{type:c.Z.Y,style:t.container,children:["existing_module"===e.type&&(0,V.jsx)(tt,{moduleId:e.moduleId}),"new_module"===e.type&&(0,V.jsx)(J,{})]}):(0,V.jsxs)("div",{style:t.container,children:[(0,V.jsx)("div",{style:t.title,children:(0,V.jsx)(p.FormattedMessage,{id:"PageLayoutConfigurationSidebar.title",defaultMessage:"Page settings"})}),(0,V.jsx)("div",{style:t.subTitle,children:(0,V.jsx)(p.FormattedMessage,{id:"PageLayoutConfigurationSidebar.comingSoonTitle",defaultMessage:"Coming soon"})}),(0,V.jsx)(lt,{})]})}function lt(){const e=(0,o.yK)((e=>({fontItem:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",fontSize:22},overlay:{position:"absolute",inset:0},container:{color:"dark"===e.mode?e.accentColors.gray[400]:e.accentColors.gray[100],display:"flex",flexDirection:"column",userSelect:"none",touchAction:"none",cursor:"default"}})),[]);return(0,V.jsxs)("div",{style:e.container,children:[(0,V.jsx)("span",{style:{fontSize:g.Z.fontSize.UISmall.desktop,marginBottom:5},children:(0,V.jsx)(p.FormattedMessage,{id:"PageLayoutConfigurationSidebar.PageSettings.styleTitle",defaultMessage:"Style"})}),(0,V.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:10},children:[(0,V.jsx)(dt,{content:(0,V.jsx)("div",{style:{...e.fontItem,fontFamily:g.Z.baseFontFamily.sans},children:"Ag"}),caption:"Default"}),(0,V.jsx)(dt,{content:(0,V.jsx)("div",{style:{...e.fontItem,fontFamily:g.Z.baseFontFamily.serif},children:"Ag"}),caption:"Serif"}),(0,V.jsx)(dt,{content:(0,V.jsx)("div",{style:{...e.fontItem,fontFamily:g.Z.baseFontFamily.mono},children:"Ag"}),caption:"Mono"})]})]})}function dt(e){let{content:t,caption:n}=e;const s=(0,o.yK)((e=>({box:{width:"100%",padding:10,border:`1px solid ${"dark"===e.mode?e.accentColors.gray[400]:e.accentColors.gray[100]}`,borderRadius:5,display:"flex",alignItems:"center",justifyContent:"center"},caption:{fontSize:10},container:{display:"flex",flexDirection:"column",alignItems:"center",flexGrow:1}})),[]);return(0,V.jsxs)("div",{style:s.container,children:[(0,V.jsx)("div",{style:{...s.box,fontFamily:g.Z.baseFontFamily.sans},children:t}),(0,V.jsx)("div",{style:s.caption,children:n})]})}var ct=n(622446),ut=n(494043),mt=n(167175),pt=n(95477);var gt=n(484398);function ft(e,t){let{canUndo:n}=t;const o=(0,k.O7)(),[a,r]=(0,s.useState)([]),l=(0,s.useCallback)((e=>{r((t=>[...t,e]))}),[]),d=(0,gt.$)(e,{cacheFallback:o.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0,onOperationCallback:l}),c=(0,i.VK)((()=>a.length>0),[a.length]),u=(0,s.useCallback)((e=>{F.createAndCommit({environment:o,userAction:e,perform(e){!function(e){let{environment:t,transaction:n,operationsWithStores:s}=e;for(const{operation:i,store:o}of s){if(!(o instanceof q.ST))continue;if((0,mt.Qf)(i))continue;const e=o.clone(t.defaultRecordCache.inMemoryRecordCache);F.applyOperation({transaction:n,store:e,operation:i})}}({environment:o,transaction:e,operationsWithStores:a})},canUndo:n})}),[n,o,a]);return{cache:d,hasChanges:c,persist:u}}function ht(e,t){return(0,i.VK)((()=>t.clone(e.cache)),[t,e.cache])}var yt=n(80444),xt=n(882206);function St(e){let{children:t,collectionStore:n,pageStore:o,sessionId:a,layoutBuilderModuleSelectionStore:r}=e;const l=(0,k.O7)(),d=(0,i.VK)((()=>{var e;return null===(e=yt.default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]),c=ft("PageLayoutEditorContext",{canUndo:!1}),u=ht(c,o),m=function(e,t){const n=(0,k.O7)(),o=(0,s.useMemo)((()=>new ne.Z(n)),[n]),a=ht(e,t),r=(0,i.VK)((()=>null==t?void 0:t.getParentBlockStore()),[t]);return(0,s.useEffect)((()=>{o.setContext({type:"collectionPage",collectionViewBlockStore:r,collectionStore:a})}),[o,a,r]),o}(c,n),p=(0,i.VK)((()=>{const e=m.collectionStore();if(e)return e}),[m]),g=(0,i.VK)((()=>null==p?void 0:p.getLayoutStore()),[p]),f=(0,i.qz)(void 0,xt.Z);(0,i.VK)((()=>{d&&p&&(g||F.createAndCommit({environment:l,perform:e=>Qe.m2({environment:l,transaction:e,collectionStore:p,userId:d}),userAction:"PageLayoutEditorContext.initCollectionLayout"}))}),[l,p,g,d]);const h=(0,s.useCallback)((()=>d&&g?(c.persist("PageLayoutEditorContext.updateLayout"),{value:[]}):{error:!0}),[c,g,d]),y=(0,i.VK)((()=>r.getState()),[r]);return g?(0,V.jsx)(j.L1,{value:m,children:(0,V.jsx)(w.Dt.Provider,{value:{layoutStore:g,collectionStore:p,currentModuleSelection:y,setModuleSelection:function(e){r.setState(e)},sessionId:a,addModuleHoverMenuStore:f},children:(0,V.jsx)(w.eK.Provider,{value:{pageStore:u,hasUnsavedChanges:c.hasChanges,saveChanges:h},children:t})})}):null}var vt=n(294184),bt=n.n(vt),Mt=n(517755),jt=n(522808);function Ct(e){let{size:t,style:n,icon:s,baseUrl:i}=e;return(0,V.jsx)("div",{style:{height:t,width:t,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,verticalAlign:"top",marginTop:1,...n},children:(0,V.jsx)(Tt,{icon:s,size:t,baseUrl:i})})}const wt=s.memo(Ct);function kt(e){return.9*e}function It(e){return.888*e}function Tt(e){let{icon:t,size:n,baseUrl:s}=e;if(!t)return null;if((0,jt.Z)(t.icon))return(0,V.jsx)("div",{style:{fontSize:kt(n)},children:t.icon});{const e=Mt.EK({url:t.icon,baseUrl:s,fullyQualified:!0,permissionRecord:t.pointer,width:It(n),userId:void 0});return(0,V.jsx)("img",{alt:"icon",src:e,style:{width:It(n),height:It(n),objectFit:"cover",borderRadius:4,marginTop:1}})}}var Zt=n(536591),Pt=n(213148),Ft=n(380503),_t=n(940470),At=n(547307),Bt=n(776798),Rt=n(843250),Dt=n(424042),Ot=n(571960);n(316354);function Lt(){(0,o.yK)((()=>({link:{fontSize:g.Z.fontSize.UIRegular.desktop,fontWeight:g.Z.fontWeight.medium}})),[]);return null}function Vt(){const e=(0,k.O7)(),{device:t}=e,{isElectron:n,isElectronMac:a}=t,{sessionId:l}=(0,w.J9)(),{collectionStore:d,hasUnsavedChanges:c,saveChanges:u}=(0,w.PP)(),m=(0,i.VK)((()=>!!n&&!Dt.Z.state.isShowingTabBar),[n]),g=(0,i.VK)((()=>(0,Ft.R6)(a)),[a]),f=(0,s.useCallback)((async()=>{Ot.If({environment:e,sessionId:l});const t=()=>Qe.gm({environment:e});if(!c)return void t();const{accept:n}=await At.confirmUserActionV2({message:(0,V.jsx)(p.FormattedMessage,{id:"pageLayoutEditor.closeConfirmModal.content",defaultMessage:"Discard all layout changes?"}),acceptLabel:(0,V.jsx)(p.FormattedMessage,{id:"pageLayoutEditor.closeConfirmModal.discard",defaultMessage:"Discard"})});n&&t()}),[e,l,c]),h=(0,s.useCallback)((()=>{const t=u();_t.x.isSuccess(t)?Ot.r$({environment:e,sessionId:l,modules:t.value}):Ot.If({environment:e,sessionId:l}),Qe.gm({environment:e})}),[e,u,l]),y=(0,o.yK)((e=>({topbarPlaceholder:{minHeight:g,background:e.v2.surface.washDesktop,borderBottom:`1px solid ${e.stroke.deemphasized}`},container:{width:"100%",backgroundColor:e.sidebarBackground,padding:"8px 16px 8px 16px"},rightButtons:{display:"flex",gap:16,alignItems:"center"}})),[g]);return(0,V.jsxs)("header",{children:[m?(0,V.jsx)("div",{style:y.topbarPlaceholder,className:bt()({[Rt.lIT]:!0,[Rt.pMC]:!0})}):null,(0,V.jsxs)(r.gq,{style:y.container,alignItems:"center",justifyContent:"space-between",children:[(0,V.jsx)("div",{children:(0,V.jsx)(xe.Z,{onClick:f,icon:Pt.U,isLarge:!0,children:(0,V.jsx)(p.FormattedMessage,{id:"pageLayoutEditor.close",defaultMessage:"Cancel"})})}),(0,V.jsx)(Et,{collectionStore:d}),(0,V.jsxs)("div",{style:y.rightButtons,children:[(0,V.jsx)(Lt,{}),(0,V.jsx)(ve.Z,{onClick:h,disabled:!c,icon:Zt.e,isLarge:!0,children:(0,V.jsx)(p.FormattedMessage,{id:"pageLayoutEditor.saveAndClose",defaultMessage:"Apply to all pages"})})]})]})]})}function Et(e){let{collectionStore:t}=e;const n=(0,o.yK)((()=>({container:{display:"flex",gap:10}})),[]),s=(0,i.VK)((()=>t.getIcon()),[t]);return(0,V.jsxs)("div",{style:n.container,children:[(0,V.jsx)(wt,{icon:s,size:24,baseUrl:pt.default.domainBaseUrl}),(0,V.jsx)(Bt.Z,{store:t})]})}function Nt(){const e=(0,o.yK)((e=>({container:{width:"100%",backgroundColor:e.sidebarBackground,minWidth:1040,cursor:"default"}})),[]),t=(0,i.VK)((()=>m.Z.getState()),[m.Z]),n=(0,i.qz)(void 0,u.Z);return t.isOpen&&"layout-editor"===t.mode?(0,V.jsx)(St,{...t,layoutBuilderModuleSelectionStore:n,children:(0,V.jsxs)(r.Ht,{style:e.container,children:[(0,V.jsx)(Vt,{}),(0,V.jsxs)(r.gq,{style:{overflowY:"auto",padding:"20px 0 0 24px",height:"100%"},children:[(0,V.jsx)(Ut,{}),(0,V.jsx)(rt,{})]})]})}):null}function Ut(){const{pageStore:e}=(0,w.PP)(),{setModuleSelection:t}=(0,w.J9)(),n=(0,d.E)("page_layouts"),s=(0,i.VK)((()=>e.getFormat().page_full_width?"layout-editor-wide":"layout-editor"),[e]),r=(0,o.yK)((e=>({container:{height:"100%",background:e.contentBackground,flexGrow:3,borderRadius:"12px 12px 0 0",boxShadow:e.mediumBoxShadow,borderColor:e.accentColors.gray[300],borderWidth:1,overflowY:"auto",display:"flex"},mainPage:{flex:3},sidebar:{padding:10,flex:1,minWidth:300,maxWidth:300,width:300}})),[]);return(0,V.jsxs)("div",{style:r.container,onClick:e=>{(0,l.ZP)({event:e,context:l.Af.EditorClick,callback:()=>{t(void 0)}})},children:[(0,V.jsx)(a.Z,{type:c.Z.Y,style:{flex:1},children:(0,V.jsx)("div",{style:r.mainPage,children:(0,V.jsx)(ut.Xg,{type:s,children:(0,V.jsx)(ct.v,{area:"page_layout_schema"})})})}),n?(0,V.jsx)(a.Z,{type:c.Z.Y,children:(0,V.jsx)("div",{style:r.sidebar,children:(0,V.jsx)(ct.v,{area:"page_info_layout_schema"})})}):null]})}},266594:(e,t,n)=>{n.r(t),n.d(t,{CollapsiblePropertyGroupsModule:()=>S});var s=n(667294),i=n(886628),o=n(724405),a=n(542853),r=n(709291),l=n(668709),d=n(164921),c=n(750187),u=n(450627),m=n(80444),p=n(619671),g=n(985526),f=n(282136),h=n(813023),y=n(494043),x=n(785893);function S(e){const{store:t,context:n,disabled:a,wrapper:r,expandedByDefault:d}=e,c=(0,i.VK)((()=>t.getAssociatedCollectionStore()),[t]),m=(0,i.VK)((()=>{var e;return(null==c||null===(e=c.getFormat())||void 0===e?void 0:e.property_groups)||[]}),[c]),p=(0,i.VK)((()=>{if(t.isCollectionViewPageWithContent())return{type:"hidden"};const e=t.getAssociatedCollectionStore();if(!e)return{type:"hidden"};const n=(0,u.y6)(t);return n?{type:"visible",store:t,format:n,collectionStore:e}:{type:"hidden"}}),[t]),g=(0,o.yK)((e=>({container:{borderBottom:`1px solid ${e.lightDividerColor}`,margin:"20px 0px 20px 0px",cursor:"default"}})),[]);if("hidden"===p.type)return null;return(r||(e=>(0,x.jsx)(y.Pb,{className:"layout-content",children:e})))((0,x.jsx)(y.Pb,{children:(0,x.jsx)(l.p,{allowSelectionWithin:!0,children:(0,x.jsx)("div",{style:g.container,children:m.map((e=>(0,s.createElement)(v,{...p,key:e.id,context:n,disabled:a,propertyGroup:e,expandedByDefault:d})))})})}))}function v(e){const{store:t,context:n,disabled:a,propertyGroup:r,format:l,collectionStore:d,expandedByDefault:u}=e,[y,S]=(0,s.useState)(Boolean(u)),v=n===f.S.PeekView,M=(0,i.VK)((()=>t.isNonEditableState()),[t]),j=(0,i.VK)((()=>d.getSchema()),[d]),C=(0,i.VK)((()=>{var e;return t.id===(null===(e=m.default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.id)?g.m.getNewMainEditorPagePropertiesStore():new g.p}),[t]),w=(0,s.useCallback)((()=>{S((e=>!e))}),[]),k=(0,o.yK)((e=>({container:{borderTop:`1px solid ${e.lightDividerColor}`},groupContent:{paddingBottom:4,paddingLeft:2,marginTop:-6},bottomButtonContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start"},propertyVisibilityButton:{borderRadius:4,height:34,paddingLeft:6,paddingRight:6,width:"auto",display:"flex",alignItems:"center",justifyContent:"center"},propertyVisibilityButtonMessage:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0,fontSize:"14px",color:e.lightTextColor}})),[]);return(0,x.jsxs)("div",{style:k.container,children:[(0,x.jsx)(b,{onClick:w,isExpanded:y,children:r.title}),y&&(0,x.jsx)("div",{style:k.groupContent,children:(0,x.jsx)(c.Z,{propertyGroupId:r.id,pagePropertiesStore:C,schema:j,format:l,store:t,collectionStore:d,disabled:a,locked:M,blockPropertyValueOverlayStore:v?h.Z:p.Z,isInPeekRenderer:v,width:"100%",customization:{hideSearch:!0,neverShowNotionSystemProperties:!0}})})]})}function b(e){const{children:t,isExpanded:n,onClick:s}=e,i=(0,r.useIntl)(),l=(0,o.yK)((e=>({container:{display:"flex",alignItems:"center",padding:"10px 6px 10px 6px",paddingTop:"10px",paddingLeft:"6px",paddingRight:"6px",paddingBottom:"10px"},label:{fontSize:12,color:e.mediumTextColor,fontWeight:500,marginRight:"auto"},button:{borderRadius:"100%"},icon:{transition:"transform .2s ease",width:14,height:14,color:e.mediumTextColor,transform:n?"rotate(0deg)":"rotate(-90deg)",fill:e.mediumTextColor},iconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24}})),[n]);return n?(0,x.jsxs)(d.Z,{onClick:s,style:l.container,children:[(0,x.jsx)("div",{style:l.label,children:t}),(0,x.jsx)("div",{style:l.iconContainer,children:(0,a.i)(l.icon)})]}):(0,x.jsxs)(d.Z,{style:l.container,onClick:s,ariaLabel:i.formatMessage(M.showProperties),children:[(0,x.jsx)("div",{style:l.label,children:t}),(0,x.jsx)("div",{style:l.iconContainer,children:(0,a.i)(l.icon)})]})}const M=(0,r.defineMessages)({hideProperties:{id:"CollapsiblePropertyGroups.hideProperties",defaultMessage:"Hide properties in section"},showProperties:{id:"CollapsiblePropertyGroups.showProperties",defaultMessage:"Show properties in section"}})},343617:(e,t,n)=>{n.d(t,{V:()=>S});n(667294);var s=n(886628),i=n(668709),o=n(750187),a=n(296994),r=n(450627),l=n(99340),d=n(80444),c=n(400807),u=n(619671),m=n(985526),p=n(282136),g=n(813023),f=n(846010),h=n(494043),y=n(785893);function x(e){const{store:t,format:n,collectionStore:i,disabled:a,blockPropertyValueOverlayStore:r,isInPeekRenderer:l,variant:d,propertyIds:c,customization:u,pagePropertiesStore:m}=e,p=(0,s.VK)((()=>i.getSchema()),[i]),g=(0,s.VK)((()=>t.isNonEditableState()),[t]);return(0,y.jsx)(o.Z,{store:t,collectionStore:i,schema:p,format:n,disabled:a,locked:g,width:"100%",blockPropertyValueOverlayStore:r,isInPeekRenderer:l,propertyIds:c,variant:d,customization:u,pagePropertiesStore:m})}function S(e){const{store:t,context:n,disabled:o,variant:S,propertyIds:v,customization:b,wrapper:M}=e,j=(0,f.y)(),C=(0,l.PE)(t,o),w=(0,s.VK)((()=>c.Z.getMode(t)),[t]),k=(0,s.VK)((()=>{var e;return t.id===(null===(e=d.default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.id)?m.m.getNewMainEditorPagePropertiesStore():new m.p}),[t]),I=(0,s.VK)((()=>{if(t.isCollectionViewPageWithContent())return{type:"hidden"};const e=t.getAssociatedCollectionStore();if(!e)return{type:"hidden"};const n=(0,r.y6)(t);return n?{type:"visible",store:t,format:n,collectionStore:e}:{type:"hidden"}}),[t]),T=(0,s.VK)((()=>{const e=t.getAssociatedCollectionStore();return Boolean(null==e?void 0:e.getFormat().property_groups)}),[t]);if("hidden"===I.type)return null;const Z=n===p.S.PeekView;if(T&&"pinned"!==S&&(null==b||!b.doNotShowPropertyGroups)&&j)return(0,y.jsx)(a.fe,{...e});return(M||(e=>(0,y.jsx)(h.Pb,{className:"layout-content-with-divider",children:e})))((0,y.jsx)(i.p,{allowSelectionWithin:!0,children:(0,y.jsx)(x,{...I,disabled:!C||"suggest"===w,isInPeekRenderer:Z,blockPropertyValueOverlayStore:Z?g.Z:u.Z,propertyIds:v,variant:S,customization:b,pagePropertiesStore:k})}))}},255535:(e,t,n)=>{n.d(t,{W:()=>a,Z:()=>l});var s=n(667294),i=n(751077),o=n(785893);const a=16;function r(e){let{icon:t,style:n,size:s=a}=e;return(0,o.jsx)(i.Z,{type:"notion_icon",size:s,icon:`/icons/${t}_lightgray.svg`,largeIcon:!0,style:n})}const l=s.memo(r)},713484:(e,t,n)=>{n.d(t,{Z:()=>b});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(137810),l=n(526388),d=n(536420),c=n(475024),u=n(825464),m=n(450334),p=n(861931),g=n(749085);class f extends g.default{getInitialState(){}}class h extends g.default{getInitialState(){return!1}}var y=n(622863),x=n(255535),S=n(785893);function v(e){let{icon:t,title:n,tooltip:s,hasRightElement:o,iconContainerStyle:d}=e;const m=(0,i.O7)(),p=(0,a.yK)((e=>({panelTitleAndIcon:{display:"flex",alignItems:"center",fontSize:(0,c.yv)(m,"UISmall"),fontWeight:r.Z.fontWeight.medium,color:e.text.secondary,fill:e.mediumIconColor,flexShrink:0,maxWidth:o?200:"100%"},title:{...r.Z.textOverflowStyle},panelIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:x.W,height:x.W,marginRight:8,marginTop:1,...d}})),[m,d,o]);return n?(0,S.jsx)(l.Z,{renderTooltip:()=>s,disableTooltip:!s,placement:u.u.Top,alignment:u.v.Start,render:e=>(0,S.jsxs)("div",{style:p.panelTitleAndIcon,...e,children:[(0,S.jsx)("div",{style:p.panelIconContainer,children:t}),(0,S.jsx)("span",{style:p.title,children:n})]})}):null}const b=function(e){let{children:t,title:n,icon:r,tooltip:l,iconContainerStyle:c,panelStyle:u,headerStyle:g,rightStyle:x,actions:b,right:M,disableRightFadeIn:j,disableActionsFadeIn:C,hideWrapStyle:w,actionsGap:k}=e;const I=(0,i.MO)(),T=Boolean(n),Z=Boolean(M),P=(0,o.qz)(void 0,h),F=(0,o.qz)(void 0,f),_=(0,s.useMemo)((()=>({isHoveredOnPanelStore:P,sizeStore:F})),[P,F]),A=(0,s.useCallback)((()=>P.setState(!0)),[P]),B=(0,s.useCallback)((()=>P.setState(!1)),[P]),R=(0,s.useCallback)((e=>{e.width<p.d_?F.setState("narrow"):F.setState("wide")}),[F]),D=(0,a.yK)((e=>({tile:{userSelect:"none",WebkitUserSelect:"none"},panel:w?{}:{paddingLeft:12,paddingRight:12,...(0,p.KI)({isPhone:I,theme:e}),...u},headerContainer:{flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center",height:p.jX,marginLeft:p.pW,...g},rightActions:{display:"flex",flexDirection:"row",alignItems:"center"},actions:{display:"flex",alignItems:"center",gap:k??6,paddingLeft:6}})),[I,w,u,g,k]),O=(T||Z)&&(0,S.jsxs)("div",{style:D.headerContainer,children:[(0,S.jsx)(v,{title:n,icon:r,tooltip:l,hasRightElement:Z,iconContainerStyle:c}),(Z||b)&&(0,S.jsxs)("div",{style:D.rightActions,children:[Z&&(0,S.jsx)(y.Z,{force:j?"forceShow":void 0,additionalStyles:x,children:M}),b&&(0,S.jsx)(y.Z,{force:C?"forceShow":void 0,additionalStyles:D.actions,children:b})]})]});return(0,S.jsx)(m.L8,{value:_,children:(0,S.jsxs)("div",{style:D.tile,onMouseEnter:A,onMouseLeave:B,children:[O,(0,S.jsx)(d.n,{onSizeChange:R,children:(0,S.jsx)("div",{style:D.panel,children:t})})]})})}},622863:(e,t,n)=>{n.d(t,{Z:()=>d});var s=n(667294),i=n(724405),o=n(401898),a=n(886628),r=n(450334);var l=n(785893);const d=function(e){let{additionalStyles:t,transitionMs:n,force:d,children:c}=e;const u=function(){var e;const t=null===(e=(0,s.useContext)(r.uU))||void 0===e?void 0:e.isHoveredOnPanelStore;return(0,a.VK)((()=>Boolean(null==t?void 0:t.getState())),[t])}(),m=(0,i.yK)((()=>{let e;switch(d){case"forceShow":e=1;break;case"forceHide":e=0;break;case void 0:e=u?1:0;break;default:(0,o.t1)(d)}return{hoverStyle:{opacity:e,transition:`opacity ${(0,o.$K)(n)?n:200}ms ease-in`,...t}}}),[t,d,u,n]);return(0,l.jsx)("div",{style:m.hoverStyle,children:c})}},450334:(e,t,n)=>{n.d(t,{L8:()=>o,uU:()=>i});const s=(0,n(67381).Q)({displayName:"HomePanelContext",legacyContextKey:"homePanelContext",modernContextDefaultValue:{isHoveredOnPanelStore:void 0,sizeStore:void 0}}),i=s.context,o=s.Provider;s.legacyPropTypes},509339:(e,t,n)=>{n.d(t,{O:()=>r});var s=n(379362),i=n(522808),o=n(401898),a=n(924990);function r(e){let{icon:t,theme:n}=e;if(t)return(0,i.Z)(t)?a.Z.state.emojiByColorProcessed[t]:(0,s.V2)(t)?function(e){var t;let{uri:n,theme:i}=e;const o=null===(t=n.match(/\/icons\/[\w\-]*_(.+)\.svg/))||void 0===t?void 0:t[1];if(!function(e){if(!e)return!1;return l.has(e)}(o))return;return s.Lr[i.mode][o]}({uri:t,theme:n}):void 0}const l=new Set((0,o.Yd)(s.Lr.light))},117031:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(535431);class i extends s.Z{findCollectionTemplatePickerItemFromStore(e){if(e)return this.find((t=>t.props.templateStore===e))}}const o=new i},88411:(e,t,n)=>{n.d(t,{z:()=>o});n(667294);var s=n(709291),i=n(785893);function o(e){let{invalidInvites:t,showEmptyError:n,styles:o}=e;if(n)return(0,i.jsx)("div",{style:o,children:(0,i.jsx)(s.FormattedMessage,{id:"inviteTargetsInput.invalidWarning.noEmails",defaultMessage:"Please enter an email address"})});if(0===t.length)return null;const a=t[0].value.text;return 1===t.length?(0,i.jsx)("div",{style:o,children:(0,i.jsx)(s.FormattedMessage,{id:"inviteTargetsInput.invalidWarning.singleEmail",defaultMessage:"“{text}” is not a valid email",values:{text:a}})}):(0,i.jsx)("div",{style:o,children:(0,i.jsx)(s.FormattedMessage,{id:"inviteTargetsInput.invalidWarning.multipleEmails",defaultMessage:"{additionalInvalid, plural, one {“{text}” and {additionalInvalid} other are not valid emails} other {“{text}” and {additionalInvalid} others are not valid emails}}",values:{text:a,additionalInvalid:t.length-1}})})}},910039:(e,t,n)=>{n.d(t,{Z:()=>F});n(667294);var s=n(800480),i=n(886628),o=n(724405),a=n(984619),r=n(133728),l=n(303338),d=n(40462),c=n(584169),u=n(636329),m=n(526774),p=n(307928),g=n(709291),f=n(531701),h=n(401898),y=n(137810),x=n(526388),S=n(45653),v=n(685567),b=n(75472),M=n(516639),j=n(853353),C=n(26781),w=n(825464),k=n(80444),I=n(655899),T=n(88893),Z=n(288280),P=n(785893);const F=function(e){const{store:t,target:n}=e,F=(0,s.Fy)(),_=(0,g.useIntl)(),A=function(){const e=(0,o.yK)((()=>({verifiedDomain:{margin:2,backgroundColor:"rgba(83, 168, 63, 0.1)"},disabled:{margin:2,backgroundColor:"rgba(211, 79, 67, 0.1)",border:"dashed #D9655B 1px",paddingLeft:5},normal:{margin:2},guest:{margin:2,backgroundColor:"rgba(218, 163, 64, 0.2)"},error:{margin:2,backgroundColor:"rgba(195,90,75,0.2)",color:"#DE5550"},tokenContent:{display:"flex",alignItems:"center",maxWidth:"100%"},tokenSpan:{maxWidth:"100%"},tokenText:{marginLeft:4,...y.Z.textOverflowStyle}})),[]);return e}(),B=(0,i.VK)((()=>{const e=Z.subscriptionDataStoreInstance.state,t=e?T.CM(e):[],n={};return t.forEach((e=>{n[e.userId]=e})),n}),[]),R=(0,i.VK)((()=>{const e=k.default.state.currentSpaceStore;return new Set(null==e?void 0:e.getEmailDomains())}),[]),D=(0,j.Z)(t),O=(0,C.S)(t),L=(0,i.VK)((()=>{if("invalidUser"===n.type)return"invalidUser";if(e.tokenType)return e.tokenType;if("group"===n.type)return"group";if("existingUser"===n.type&&!Boolean(n.spaceRole)){const e=B[n.value.id];n.spaceRole=e?e.role:"not_in_space"}if(!(0,b.OA)(n))return"member";if(D.isGuestRequestRequired)return"guestRequestRequired";if(D.isStoreInTeam&&!D.teamAllowsGuests)return"teamGuestDisabled";if(!D.isStoreInTeam&&!D.spaceAllowsGuests||D.isStoreInTeam&&!D.teamAllowsGuests&&!D.spaceAllowsGuests)return"spaceGuestDisabled";const t=(0,r.Gd)(n.value.email);return t&&R.has(t)?"verifiedDomain":"guest"}),[e.tokenType,n,B,R,D]),V=(0,i.VK)((()=>{switch(L){case"member":case"group":return A.normal;case"invalidUser":return A.error;case"guest":case"guestRequestRequired":return A.guest;case"verifiedDomain":return A.verifiedDomain;case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return A.disabled;default:(0,h.t1)(L)}}),[L,A]);function E(){const e=(0,c.m)({height:16,width:16,color:"#D34F43"});switch(L){case"member":return(0,I.fZ)(n)?(0,P.jsx)(S.Z,{userValue:n.value,size:16}):(0,I.KU)(n)?(0,P.jsx)(S.Z,{size:16,avatar:n.value}):(0,P.jsx)(S.Z,{size:16});case"guest":case"guestRequestRequired":return(0,d.o)({height:16,width:16,color:"#DAA340"});case"invalidUser":return(0,u._)({height:16,width:16,color:"#DE5550"});case"verifiedDomain":return(0,l.p)({height:16,width:16,color:"#53A83F"});case"group":return(0,P.jsx)("div",{style:{height:16,width:16,backgroundColor:f.ZP.whiteWithAlpha(.8),borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,m.O)({height:12,width:12,color:f.ZP.mediumTextColor})});case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return e;default:(0,h.t1)(L)}}function N(t){const s=E();let i=function(){switch(n.type){case"newUser":return n.value.email.trim();case"invalidUser":return n.value.text.trim();case"existingUser":return(0,p.Nz)(_,n.value);case"group":return(0,M.kF)({intl:_,group:n.value});default:(0,h.t1)(n)}}(),o=A.tokenText;return e.onlyShowTokenType&&(["guest","teamGuestDisabled","spaceGuestDisabled"].includes(t)?(i="Guest",o={...o,color:"#DAA340"}):(i="Member",o={...o,color:"#53A83F"})),(0,P.jsxs)("div",{style:A.tokenContent,children:[s,(0,P.jsx)("div",{style:o,children:i})]})}function U(t){var n;t.stopPropagation(),null===(n=e.onClickRemove)||void 0===n||n.call(e)}const K="newUser"===n.type?n.value.email:"invalidUser"===n.type?n.value.text:n.value.id,W="group"!==n.type&&"invalidUser"!==n.type?n.value.email:void 0;return(0,P.jsx)(x.Z,{placement:w.u.Top,renderTooltip:()=>function(e){const{tokenType:t,target:n,email:s}=e;return"guest"===t?(0,P.jsx)(g.FormattedMessage,{defaultMessage:"{email} will be invited as a guest",id:"inviteTargetToken.guest.tooltip",values:{email:s}}):"spaceGuestDisabled"===t||"teamGuestDisabled"===t||"guestRequestRequired"===t?O:"teamGroupOwner"===t&&"group"===n.type?(0,P.jsx)(g.FormattedMessage,{defaultMessage:"Groups cannot be added as teamspace owners.",id:"inviteTargetToken.groupTeamOwner.tooltip"}):"invalidUser"===n.type?(0,P.jsx)(g.FormattedMessage,{defaultMessage:"{text} is not a valid email",id:"inviteTargetToken.invalidUser.tooltip",values:{text:n.value.text}}):"verifiedDomain"===t&&"group"!==n.type?(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(g.FormattedMessage,{defaultMessage:"{email}{br}will automatically be added to the workspace{br}since @{domain} is an allowed email domain.",id:"inviteTargetToken.verifiedDomain.tooltip",values:{email:n.value.email,br:(0,P.jsx)("br",{}),domain:(0,r.Gd)(n.value.email)}})}):"group"===n.type?n.value.name??(0,P.jsx)(g.FormattedMessage,{defaultMessage:"Untitled group",id:"inviteTargetToken.group.untitled"}):s}({tokenType:L,email:W,target:n}),render:t=>(0,P.jsx)("div",{style:A.tokenSpan,...t,children:(0,P.jsx)(v.Z,{isSingle:!1,format:F.isMobile?a.lo.Large:a.lo.Medium,showRemoveButton:e.showRemoveButton,onClickRemove:U,disabledFeedback:!0,value:N(L),style:V,shouldWrap:!1})})},K)}},471862:(e,t,n)=>{n.d(t,{Z:()=>E,C:()=>H});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(815145),l=n(772141),d=n(421202),c=n(429369),u=n(709291),m=n(531701),p=n(653965),g=n(401898),f=n(137810),h=n(547307),y=n(164921),x=n(584076),S=n(731278),v=n(776798),b=n(526388),M=n(164369),j=n(207567),C=n(484210),w=n(433929),k=n(165598),I=n(195697),T=n(8874),Z=n(131075),P=n(455838),F=n(825464),_=n(990827),A=n(61766),B=n(319385),R=n(206258),D=n(109867),O=n(301951),L=n(785893);const V=function(e){const{store:t}=e;return(0,L.jsx)(u.FormattedMessage,{defaultMessage:"This access is based on {inlineIconAndName}. Changing this access will restrict permissions of this page.",id:"blockPermissionsSettings.restrictedPermissions.tooltip",values:{inlineIconAndName:(0,L.jsx)(O.Z,{store:t,useInvertedColors:!0})}})},E=32,N=(0,u.defineMessages)({fromLinkBox:{defaultMessage:"From {linkBoxWithPageTitle}",id:"pagePermissionItem.fromInheritedRecordPermissions.setting"},basedOnLinkBox:{defaultMessage:"Based on {linkBoxWithPageTitle}",id:"pagePermissionItem.inheritedRecordPermissions.setting"},moveToPrivate:{defaultMessage:"Move to Private",id:"blockPermissionsSettings.confirmationDialog.privateButton.label"},moveToWorkspace:{defaultMessage:"Move to workspace",id:"blockPermissionsSettings.confirmationDialog.workspaceButton.label"}});function U(e){const{from:t,currentBlockStore:n,onClick:r,permissionItem:l,ignoreLocalHoverState:u,nonInheritedTooltip:m}=e,p=(0,i.Fy)(),f=(0,o.qz)(void 0,A.Z),h=(0,o.VK)((()=>{const e=t.table;return e===d.iU?R.G.createChildStore(n,{table:d.iU,id:t.blockId}):e===c.e0?R.zX.createChildStore(n,{table:c.e0,id:t.teamId}):void(0,g.t1)(e)}),[t,n]),x=(0,s.useCallback)((()=>{f.setState({...f.state,open:!0})}),[f]),S=(0,o.VK)((()=>"hidden_permission"===l.type||(!G(l)&&!n.canAdmin()||n.pathIsDead()&&B.default.checkGate({gateName:"prevent_edits_trash"})||(0,_.Eo)(n))),[l,n]),v=(0,o.VK)((()=>h.id!==n.id),[h,n]),M=(0,o.VK)((()=>G(l)?null:v?(0,L.jsx)(V,{store:h}):m),[l,v,h,m]),j=(0,a.yK)((()=>({disabledButton:{cursor:"not-allowed"},tooltip:{maxWidth:240}})),[]);return(0,L.jsx)(b.Z,{delayThreshold:0,renderTooltip:()=>M,textWrap:!0,disableTooltip:!Boolean(M),style:j.tooltip,render:t=>(0,L.jsx)(y.Z,{disabled:S,mobileFeedback:p.isMobile,ignoreLocalHoverState:u,style:S?j.disabledButton:void 0,onClick:r??x,...t,children:(0,L.jsx)(K,{...e,isDisabled:S,fromBlockStore:h,buttonPopupStore:f,isInherited:v})}),placement:F.u.Left})}function K(e){const{permissionItem:t,fromBlockStore:n,isCompact:s,iconStyle:r,icon:l,title:d,tag:c,subtitle:u,showInherited:m,isInherited:p,permissionRoleSelect:g}=e,f=(0,i.O7)(),h=f.device.isMobile,y=(0,o.VK)((()=>function(e){return"user_permission"===e.type}(t)),[t]),{paddingLeft:x,paddingRight:S}=(0,o.VK)((()=>({paddingLeft:f.WindowSizeStore.getSafePaddingLeftCSS(14),paddingRight:f.WindowSizeStore.getSafePaddingRightCSS(14)})),[f.WindowSizeStore]),v=(0,a.yK)((e=>({container:{display:"flex",alignItems:"center",minHeight:s?44:52,paddingTop:8,paddingBottom:8,paddingLeft:x,paddingRight:S},icon:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,marginRight:h?12:10,...r},title:{marginRight:"auto",minWidth:0},labelWrapper:{display:"flex",flexDirection:"row"},label:{fontWeight:400},tag:{marginLeft:4},roleSelect:{display:"flex",alignItems:"center",flexShrink:0,marginLeft:8},button:{marginRight:-8,color:e.mediumTextColor,fontSize:h?14:12}})),[s,x,S,h,r]);return(0,L.jsxs)("div",{className:"notranslate",style:v.container,children:[(0,L.jsx)("div",{style:v.icon,children:l}),(0,L.jsxs)("div",{style:v.title,children:[(0,L.jsxs)("div",{style:v.labelWrapper,children:[(0,L.jsx)(M.Z,{style:y?void 0:v.label,children:d}),c&&(0,L.jsx)("div",{style:v.tag,children:c})]}),u&&(0,L.jsx)(M.Z,{style:e.subtitleStyle,isSmall:!0,children:u}),m&&p&&(0,L.jsx)(z,{store:n})]}),(0,L.jsx)("div",{style:v.roleSelect,children:q(t)?g:(0,L.jsx)(W,{...e,permissionItem:t})})]})}function W(e){const{isInherited:t,permissionItem:n,currentBlockStore:r,fromBlockStore:c,isDisabled:m,sudoModeStore:g,location:y,fromPermissionWrapper:x,onUpgradeButtonClick:S,upgradeButtonName:v,buttonPopupStore:b,isRemovableOverride:M}=e,C=(0,i.O7)(),k=C.device.isMobile,P=(0,o.VK)((()=>{if(t&&l.WY(n.role)){const e=r.getAssociatedCollectionStore(),t=null==e?void 0:e.getParentBlockStore();return t&&t.table===c.table&&t.id===c.id?n.role:"read_and_write"}return n.role}),[t,n,r,c]),F=(0,o.VK)((()=>r.getType()),[r]),_=(0,o.VK)((()=>{const e=C.currentUser.id;return l.jg(n)&&n.user_id===e}),[C,n]),A=(0,T.S)()||1,B=(0,s.useCallback)((async e=>{const s=n,i=p.d9(s);if(i.role=e,!(0,I.bq)()&&r.isTopLevel()&&l.Ir(i)){const e=await async function(e,t,n){const s=e=>(0,L.jsx)("span",{style:{fontWeight:f.Z.fontWeight.semibold},children:e});if(l.YX(t.role)&&!l.YX(n.role)&&e>1){if(!(await h.confirmUserAction({message:(0,L.jsx)(u.FormattedMessage,{defaultMessage:"Are you sure you want to make this page private? <semibold>Only you will be able to access it.</semibold>",values:{semibold:s},id:"blockPermissionsSettings.confirmationDialog.private.message"}),acceptLabel:w.default.formatMessage(N.moveToPrivate)})))return!1}else if(!l.YX(t.role)&&l.YX(n.role)){if(!(await h.confirmUserAction({message:(0,L.jsx)(u.FormattedMessage,{defaultMessage:"Are you sure you want to share this page with the workspace? <semibold>It will be accessible by all {memberCount} members.</semibold>",id:"blockPermissionsSettings.confirmationDialog.workspace.message",values:{semibold:s,memberCount:e}}),acceptLabel:w.default.formatMessage(N.moveToWorkspace)})))return!1}return!0}(A,s,i);if(!e)return}(0,Z.i)({oldPermissionItem:s,newPermissionItem:i,wasInherited:t,environment:C,store:r,sudoModeStore:g,location:y,fromPermissionWrapper:x})}),[n,r,C,t,g,y,x,A]),R=(0,a.yK)((e=>({button:{marginRight:-8,color:e.mediumTextColor,fontSize:k?14:12}})),[k]);return(0,L.jsx)(j.ZP,{role:P,table:d.iU,blockType:F,type:n.type,disabled:m,isUserPermission:_,onChange:B,onUpgradeButtonClick:S,upgradeButtonName:v,buttonPopupStore:b,buttonStyle:R.button,showPermissionOverrideWarning:t&&!e.selectFooter,isRemovableOverride:M,footer:e.selectFooter})}function z(e){const{store:t}=e,n=(0,i.O7)(),l=(0,u.useIntl)(),c=n.device.isMobile,p=(0,o.VK)((()=>{if(t.table===d.iU)return(0,C.ZP)({store:t,fullyQualified:!1,pageVisitSource:r.tY.LinkInPage})}),[t]),g=(0,o.VK)((()=>(0,k.Y)(t)),[t]),h=(0,s.useCallback)((()=>{D.RF({environment:n,teamId:t.id,tab:P.a.Members,from:"permission_item"})}),[t.id,n]),y=(0,o.VK)((()=>t.getIcon()),[t]),b=(0,o.VK)((()=>!(0,k.Y)(t)&&t.isEmptyPage()),[t]),j=(0,a.yK)((e=>({label:{lineHeight:1.4},linkBox:{display:"inline-flex",alignItems:"center",borderBottom:`0.5px solid ${m.ZP.mediumTextColor}`},icon:{marginRight:4},title:{display:"inline",fontWeight:c?f.Z.fontWeight.regular:f.Z.fontWeight.semibold}})),[c]),w=c?(0,L.jsx)(v.Z,{store:t,style:j.title}):(0,L.jsxs)(x.Z,{inline:!0,href:p,onClick:g?h:void 0,innerStyle:j.linkBox,children:[(0,L.jsx)(S.Z,{disabled:!0,style:j.icon,icon:y,size:14,isEmptyPage:b}),(0,L.jsx)(v.Z,{store:t,style:j.title})]});return(0,L.jsx)(M.Z,{isSmall:!0,style:j.label,children:c?l.formatMessage(N.basedOnLinkBox,{linkBoxWithPageTitle:w}):l.formatMessage(N.fromLinkBox,{linkBoxWithPageTitle:w})})}function q(e){return"team_overview_permission"===e.type||"hidden_permission"===e.type}function G(e){return"team_overview_permission"===e.type}const H=s.memo(U)},655574:(e,t,n)=>{n.r(t),n.d(t,{OfflineMessage:()=>Jo,default:()=>Xo});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(709291),l=n(301743),d=n(256940),c=n(478140),u=n(840721),m=n(164369),p=n(246247),g=n(843250),f=n(460709),h=n(918514),y=n(100859),x=n(883165),S=n(788632),v=n(785834),b=n(352878),M=n(190335),j=n(28578),C=n(184747),w=n(749085),k=n(841892),I=n(80721),T=n(89036),Z=n(401898),P=n(137810),F=n(891219),_=n(689024),A=n(164921),B=n(260458),R=n(573063),D=n(707124),O=n(863296),L=n(158297),V=n(731278),E=n(118168),N=n(379817),U=n(548779),K=n(195697),W=n(224646),z=n(535057),q=n(973466),G=n(910039),H=n(785893);function $(e){const{spaceStore:t,blockStore:n,variant:s="control"}=e,a=(0,i.O7)(),r=(0,o.VK)((()=>(0,K.$)(a)),[a]),l=(0,o.qz)(e.contextualInviteStore,v.ZP);(0,C.Z)((()=>{F.$2(a,N.Oh(a,l)),r&&l.setState({...l.state,selection:v.uq.page_guest})}));const d=(0,o.VK)((()=>l.getGuestEmails()),[l]),c=(0,o.VK)((()=>(0,U.Q6)(t)),[t]);return d.length?"variant1"===s?(0,H.jsx)(Y,{contextualInviteStore:l,spaceStore:t,blockStore:n,useZeroTeamsExperience:r,guestEmails:d,useGuestInviteRequestExperience:c}):"variant2"===s?(0,H.jsx)(Q,{contextualInviteStore:l,spaceStore:t,blockStore:n,useZeroTeamsExperience:r,guestEmails:d,useGuestInviteRequestExperience:c}):(0,H.jsx)(X,{contextualInviteStore:l,spaceStore:t,blockStore:n,useZeroTeamsExperience:r,guestEmails:d,useGuestInviteRequestExperience:c}):null}function Y(e){const{guestEmails:t,spaceStore:n,contextualInviteStore:s,blockStore:l}=e,d=(0,i.O7)(),c=(0,r.useIntl)(),u=(0,o.VK)((()=>(0,U.rn)(d,n)),[d,n]),m=(0,a.yK)((e=>({header:{marginBottom:6},buttonWrapper:{marginTop:12,marginBottom:16}})),[]);return(0,H.jsxs)("div",{className:g.B8p,children:[(0,H.jsx)("div",{style:{height:"48px",display:"flex",paddingLeft:12},children:(0,H.jsx)(oe,{contextualInviteStore:s})}),(0,H.jsxs)(_.jX,{padding:"0px 12px 16px 12px",gap:4,children:[(0,H.jsx)(D.q,{styleName:"UIRegular-14px/Medium",style:m.header,children:(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.variantOne.header",defaultMessage:"{inviteCount, plural, one {Also add {firstEmail} to the workspace?} other {Also add invitees to the workspace?}}",values:{firstEmail:t[0],inviteCount:t.length}})}),(0,H.jsx)(D.q,{styleName:"UIRegular-14px/Regular",color:"secondary",children:(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.variantOne.description",defaultMessage:"{otherInviteCount, plural, =0 {Make it easy to collaborate on pages in {workspaceName} by adding them as a workspace member.} one {Make it easy to collaborate on pages in {workspaceName} by adding {firstEmail} and 1 other as workspace members.} other {Make it easy to collaborate on pages in {workspaceName} by adding {firstEmail} and {otherInviteCount} others as workspace members.}}",values:{firstEmail:t[0],otherInviteCount:t.length-1,workspaceName:u}})}),(0,H.jsx)("div",{style:m.buttonWrapper,children:(0,H.jsx)(J,{contextualInviteStore:s,guestEmails:t})}),(0,H.jsx)(L.Z,{isLarge:!0,disabled:!1,onClick:async()=>{await ae(d,n,l,c,s)},children:(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.variantOne.confirm",defaultMessage:"Done"})})]})]})}function Q(e){const{guestEmails:t,spaceStore:n,contextualInviteStore:s,blockStore:l}=e,d=(0,i.O7)(),c=(0,r.useIntl)(),u=(0,o.VK)((()=>(0,U.rn)(d,n)),[d,n]),m=(0,o.VK)((()=>s.state.selection),[s]),p=(0,a.yK)((e=>({header:{marginBottom:6},buttonWrapper:{marginTop:12,marginBottom:16},headerImage:{width:"100%",paddingBottom:8}})),[]);return(0,H.jsxs)("div",{className:g.B8p,children:[(0,H.jsx)("div",{style:{height:"48px",display:"flex",paddingLeft:12},children:(0,H.jsx)(oe,{contextualInviteStore:s})}),(0,H.jsx)("img",{src:m===v.uq.page_guest?k.Z.images.sharing.sharingPagePng:k.Z.images.sharing.sharingWorkspacePng,style:p.headerImage}),(0,H.jsxs)(_.jX,{padding:"0px 12px 16px 12px",gap:4,children:[(0,H.jsx)(D.q,{styleName:"UIRegular-14px/Medium",style:p.header,children:(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.variantTwo.header",defaultMessage:"{inviteCount, plural, one {Is {firstEmail} a frequent collaborator?} other {Are these frequent collaborators?}}",values:{firstEmail:t[0],inviteCount:t.length}})}),(0,H.jsx)(D.q,{styleName:"UIRegular-14px/Regular",color:"secondary",children:(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.variantTwo.description",defaultMessage:"{otherInviteCount, plural, =0 {Make it easy to collaborate on pages across {workspaceName} by adding them as a workspace member.} one {Make it easy for {firstEmail} and 1 other to work on pages across {workspaceName} by adding them as workspace members.} other {Make it easy for {firstEmail} and {otherInviteCount} others to work on pages across {workspaceName} by adding them as workspace members.}}",values:{firstEmail:t[0],otherInviteCount:t.length-1,workspaceName:u}})}),(0,H.jsx)("div",{style:p.buttonWrapper,children:(0,H.jsx)(J,{contextualInviteStore:s,guestEmails:t})}),(0,H.jsx)(L.Z,{isLarge:!0,disabled:!1,onClick:async()=>{await ae(d,n,l,c,s)},children:(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.variantOne.confirm",defaultMessage:"Done"})})]})]})}function J(e){const{contextualInviteStore:t,guestEmails:n}=e,i=(0,r.useIntl)(),l=(0,o.VK)((()=>t.state.selection),[t]),d=(0,a.yK)((e=>({itemStyle:{margin:5,borderRadius:8,borderWidth:2},innerStyle:{borderWidth:0},optionDescription:{color:e.text.secondary}})),[]),c=(0,s.useMemo)((()=>[{key:v.uq.workspace_member,render:()=>(0,H.jsxs)("div",{children:[(0,H.jsx)(D.q,{styleName:"UIRegular-14px/Medium",children:(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.variantOne.memberOption.header",defaultMessage:"Add to workspace"})}),(0,H.jsx)(D.q,{styleName:"UISmall-12px/Regular",style:d.optionDescription,children:(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.variantOne.memberOption.price",defaultMessage:"This is a billable event",values:{inviteCount:n.length}})})]}),ariaLabel:i.formatMessage({id:"ContextualInvite.variantOne.memberOption.ariaLabel",defaultMessage:"Add to workspace"})},{key:v.uq.page_guest,render:()=>(0,H.jsxs)("div",{children:[(0,H.jsx)(D.q,{styleName:"UIRegular-14px/Medium",children:(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.variantOne.guestOption.header",defaultMessage:"No, add to this page ony"})}),(0,H.jsx)(D.q,{styleName:"UISmall-12px/Regular",style:d.optionDescription,children:(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.variantOne.guestOption.description",defaultMessage:"{inviteCount, plural, one {Invite as a guest} other {Invite as guests}}",values:{inviteCount:n.length}})})]}),ariaLabel:i.formatMessage({id:"ContextualInvite.variantOne.guestOption.ariaLabel",defaultMessage:"Add to page only"})}]),[n,d,i]);return(0,H.jsx)(E.Z,{items:c,itemStyle:d.itemStyle,innerStyle:d.innerStyle,value:l,onChange:e=>{t.setState({...t.state,selection:e})}})}function X(e){const t=(0,i.O7)(),n=(0,r.useIntl)(),{contextualInviteStore:s,spaceStore:a,blockStore:l,useZeroTeamsExperience:d,guestEmails:c,useGuestInviteRequestExperience:u}=e,{inviteStage:p,selection:f}=(0,o.VK)((()=>{const{inviteStage:e,selection:t}=s.state;return{inviteStage:e,selection:t}}),[s]),h=(0,o.qz)(void 0,w.default),y=(0,o.VK)((()=>h.state),[h]);return(0,H.jsxs)("div",{className:g.B8p,style:{display:"flex",flexDirection:"column",gap:16,paddingTop:16,paddingBottom:16,paddingLeft:18,paddingRight:18},children:[(0,H.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:(0,H.jsxs)("div",{children:[p===v.TG.share_workspace?(0,H.jsx)(ne,{useZeroTeamsExperience:d,guestEmails:c,useGuestInviteRequestExperience:u}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(m.Z,{style:{fontWeight:600,marginBottom:4},children:u?(0,H.jsx)(r.FormattedMessage,{id:"contextualInvite.requestToWorkspace.guestInviteRequestEnabled.title",defaultMessage:"Also request to add as member"}):(0,H.jsx)(r.FormattedMessage,{id:"contextualInvite.requestToWorkspace.title",defaultMessage:"Request to add to workspace"})}),(0,H.jsx)(m.Z,{isMultiline:!0,isSmall:!0,children:u?(0,H.jsx)(r.FormattedMessage,{id:"contextualInvite.requestToWorkspace.guestInviteRequestEnabled.subtitle",defaultMessage:"Guest {emailCount, plural, one {request} other {requests}} sent. Do you want to send a request to your workspace admin to add {emailCount, plural, one {this person} other {these people}} to the workspace?",values:{emailCount:c.length}}):(0,H.jsx)(r.FormattedMessage,{id:"contextualInvite.requestToWorkspace.subtitle",defaultMessage:"Do you want to send a request to your workspace admin to add {emailCount, plural, one {this person} other {these people}} to the workspace?",values:{emailCount:c.length}})})]}),(0,H.jsx)("div",{style:{display:"flex",flexWrap:"wrap",marginTop:16,marginBottom:16},children:(0,H.jsx)(se,{spaceStore:a,emails:c})})]})}),(0,H.jsx)(ie,{spaceStore:a,isSpaceCardSelectedStore:h,showSpaceCardToggle:d}),(0,H.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,H.jsx)(O.Z,{isLarge:!0,style:{marginRight:10},onClick:async()=>{!function(e){e.setState({...e.state,selection:v.uq.page_guest})}(s),await ae(t,a,l,n,s)},children:(0,H.jsx)(r.FormattedMessage,{id:"contextualInvite.skip.button",defaultMessage:"Skip for now"})}),(0,H.jsx)(L.Z,{isLarge:!0,disabled:d&&!y||!d&&f===v.uq.closed,onClick:async()=>{s.state.inviteStage===v.TG.share_workspace&&function(e){e.setState({...e.state,selection:v.uq.workspace_member})}(s),s.state.inviteStage===v.TG.request_workspace&&function(e){e.setState({...e.state,selection:v.uq.request_workspace_member})}(s),await ae(t,a,l,n,s)},children:(0,H.jsx)(ee,{inviteStage:p,useGuestInviteRequestExperience:u})})]})]})}function ee(e){const{inviteStage:t,useGuestInviteRequestExperience:n}=e;return t===v.TG.share_workspace?n?(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.addToWorkspace.guestInviteRequestEnabled.button",defaultMessage:"Add member to workspace"}):(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.addToWorkspace.button",defaultMessage:"Add to workspace"}):n?(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.sendRequest.guestInviteRequestEnabled.button",defaultMessage:"Send member request"}):(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.sendRequest.button",defaultMessage:"Send request"})}const te=s.memo($);function ne(e){let{useZeroTeamsExperience:t,useGuestInviteRequestExperience:n,guestEmails:s}=e;const i=(0,o.VK)((()=>!(0,z.QM)()),[]);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(m.Z,{style:{fontWeight:600,marginBottom:4},children:n?(0,H.jsx)(r.FormattedMessage,{id:"contextualInvite.addToWorkspace.guestInviteRequestEnabled.title",defaultMessage:"Also add as member"}):(0,H.jsx)(r.FormattedMessage,{id:"contextualInvite.addToWorkspace.title",defaultMessage:"Add to workspace"})}),(0,H.jsx)(m.Z,{isMultiline:!0,isSmall:!0,style:{marginBottom:6},children:n?(0,H.jsx)(r.FormattedMessage,{id:"contextualInvite.addToWorkspace.guestInviteRequestEnabled.subtitle",defaultMessage:"Guest {emailCount, plural, one {request} other {requests}} sent. Do you want to add {emailCount, plural,\none {this person}\nother {these people}\n} to the workspace in addition to the page? {isPaid, select,\ntrue {This is a billable event.}\nother {}\n}",values:{emailCount:s.length,isPaid:i}}):(0,H.jsx)(r.FormattedMessage,{id:"contextualInvite.addToWorkspace.subtitle",defaultMessage:"Do you want to add {emailCount, plural,\none {this person}\nother {these people}\n} to the workspace in addition to the page? {isPaid, select,\ntrue {This is a billable event.}\nother {}\n}",values:{emailCount:s.length,isPaid:i}})}),(0,H.jsx)(m.Z,{isMultiline:!0,isSmall:!0,children:t?(0,H.jsx)(r.FormattedMessage,{id:"contextualInvite.addToWorkspace.zeroTeams.subtitle.blockLimit",defaultMessage:"Adding them as a member will auto-create a teamspace{isFreeTier, select,\nfree { and apply the 1,000 block limit to your workspace.}\nother {}\n}",values:{isFreeTier:i?"paid":"free"}}):(0,H.jsx)(r.FormattedMessage,{id:"contextualInvite.addToWorkspace.zeroTeams.subtitle",defaultMessage:"{isFreeTier, select,\nfree {This action will apply the 1,000 block limit to your workspace.}\nother {}\n}",values:{emailCount:s.length,isFreeTier:i?"paid":"free"}})})]})}function se(e){let{emails:t,spaceStore:n}=e;const s=(0,o.VK)((()=>(0,U.Q6)(n)),[n]);return(0,H.jsx)(H.Fragment,{children:t.map((e=>(0,H.jsx)(G.Z,{store:n,tokenType:s?"guestRequestRequired":"guest",showRemoveButton:!1,target:{source:"email",type:"newUser",value:{email:e},spaceRole:"not_in_space"}},e)))})}function ie(e){let{showSpaceCardToggle:t,spaceStore:n,isSpaceCardSelectedStore:s}=e;const l=(0,r.useIntl)(),d=(0,a.Fg)(),c=(0,i.O7)(),u=(0,o.VK)((()=>(0,U.Wd)(c,n)),[c,n]),p=(0,o.VK)((()=>(0,U.rn)(c,n)),[c,n]),g=(0,o.VK)((()=>n.getPublicSpaceData()),[n]),f=(0,o.VK)((()=>s.state),[s]);let h;g&&"none"!==g.role&&(h=(0,H.jsx)(r.FormattedMessage,{id:"contextualInvite.spaceCard.subtitle",defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}} · {planType}",values:{numberOfWorkspaceMembers:l.formatNumber(g.memberCount),planType:l.formatMessage((0,W.em)(g.subscriptionTier))}}));const y=u||p?(0,H.jsx)(V.Z,{disabled:!0,icon:u,isEmptyPage:!1,title:p,size:30,style:{color:d.regularTextColor,marginRight:12}}):(0,T.v)(function(e){return{width:20,height:20,fill:e.lightIconColor}}(d));return(0,H.jsxs)(A.Z,{style:{display:"flex",borderWidth:1,borderStyle:"solid",borderColor:d.regularDividerColor,borderRadius:5,padding:12,justifyContent:"space-between",alignItems:"center"},disabled:!t,onClick:()=>s.setState(!s.state),children:[(0,H.jsxs)("div",{style:{display:"flex"},children:[y,(0,H.jsxs)("div",{children:[(0,H.jsx)(m.Z,{children:p}),(0,H.jsx)(m.Z,{isSmall:!0,children:h})]})]}),t&&(0,H.jsx)(B.Z,{round:!0,checked:f,fill:d.contentBackground,size:20,onClick:()=>s.setState(!s.state)})]})}function oe(e){let{contextualInviteStore:t}=e;const n=(0,r.useIntl)(),s=(0,a.yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},backButtonPressedStyle:{backgroundColor:"transparent"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:16,width:16,strokeWidth:P.Z.fontWeight.semibold},sendInviteLabel:{fontWeight:P.Z.fontWeight.medium}})),[]);return(0,H.jsxs)("div",{style:s.topContainer,children:[(0,H.jsx)(R.Z,{icon:I.W,iconStyle:s.arrowIcon,style:s.iconButton,onClick:()=>{t.reset()},ariaLabel:n.formatMessage({id:"ContextualInvite.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,H.jsx)(m.Z,{style:s.sendInviteLabel,children:(0,H.jsx)(r.FormattedMessage,{id:"ContextualInvite.title",defaultMessage:"Send invite"})})]})}async function ae(e,t,n,s,i){if(i.state.inviteStage===v.TG.closed||i.state.inviteStage===v.TG.share_page)return;const{selection:o}=i.state;switch(o){case v.uq.request_workspace_member:F.d(e,{...N.Oh(e,i),from:"share_menu"}),await N.fC({environment:e,spaceStore:t,originId:n.id,originType:"share_menu",reasonMessage:void 0,contextualInviteStore:i,intl:s});break;case v.uq.workspace_member:if(F.E0(e,N.Oh(e,i)),(0,K.$)(e)){i.setState({...i.state,inviteStage:v.TG.closed});if(!(await q.HD({environment:e,flowId:i.state.flowId??"",trackCreateTeamComplete:!1})))return}await N.j_({environment:e,spaceStore:t,contextualInviteStore:i,from:"page_contextual_invite",intl:s});break;case v.uq.page_guest:case v.uq.closed:i.reset();break;default:(0,Z.t1)(o)}}var re=n(655899),le=n(288280),de=n(139226),ce=n(964275),ue=n(471924),me=n(905581),pe=n(751077),ge=n(66957);function fe(e){let{inviteTargetsStore:t,mostPermissivePublicItem:n}=e;const{display:s,source:i}=(0,o.VK)((()=>{const{display:e}=j.ZP.state;if(e===j.wV.Invite){const{source:t}=j.ZP.state;return{display:e,source:t}}return{display:e,source:void 0}}),[]);switch(s){case j.wV.MainShareMenu:case j.wV.Publish:return(0,H.jsx)(ye,{mostPermissivePublicItem:n});case j.wV.Invite:if("notion"===i)return(0,H.jsx)(xe,{inviteTargetsStore:t});if("slack"===i)return(0,H.jsx)(Se,{});throw(0,Z.t1)(i);default:(0,Z.t1)(s)}}const he=[j.XF.Share,j.XF.Publish];function ye(e){let{mostPermissivePublicItem:t}=e;const n=(0,i.O7)(),l=s.useRef(null),{isMobile:d}=n.device,c="none"!==t.permissionItem.role;(0,s.useEffect)((()=>{c&&j.ZP.setState({tab:j.XF.Publish,display:j.wV.Publish,sessionId:ue.Il()})}),[c]);const u=(0,o.VK)((()=>j.ZP.state.tab),[]),m=(0,a.yK)((e=>({tabStyle:{color:e.lightTextColor,...d&&{width:"50%",textAlign:"center"}},selectedTabStyle:{fontWeight:P.Z.fontWeight.medium},tabTitleStyle:{color:"inherit"},style:d?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:14}})),[d]),p=(0,a.yK)((()=>({publishTabContainer:{display:"flex",alignItems:"center"},publishIcon:{height:16,width:16,marginLeft:4,opacity:u===j.XF.Publish?1:.5}})),[u]),f=(0,s.useCallback)((e=>{const t=he[e];t!==u&&(me.Y(n,{tab:t}),t===j.XF.Share&&j.ZP.setState({...j.ZP.state,display:j.wV.MainShareMenu,tab:j.XF.Share}),t===j.XF.Publish&&j.ZP.setState({...j.ZP.state,display:j.wV.Publish,tab:j.XF.Publish}))}),[u,n]),h=[(0,H.jsx)(s.Fragment,{children:d?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Permissions",id:"shareMenu.permissionsTab.title"},"permissions"):(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title"),(0,H.jsxs)("div",{ref:l,style:p.publishTabContainer,className:g.UBk,children:[(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Publish",id:"shareMenu.publishTab.title"},"publish"),c&&(0,de.v)(p.publishIcon)]},"publishTab")];return(0,H.jsx)(ge.Z,{...m,tabs:h,selectedIndex:he.indexOf(u),onChange:f})}function xe(e){let{inviteTargetsStore:t}=e;const n=(0,a.yK)((()=>({container:{display:"flex",margin:"0 12px 6px",height:48}})),[]),i=(0,s.useCallback)((()=>{t.reset(),j.ZP.setState({...j.ZP.state,display:j.wV.MainShareMenu,tab:j.XF.Share})}),[t]);return(0,H.jsx)("div",{style:n.container,children:(0,H.jsx)(ve,{onClick:i})})}function Se(){const e=(0,r.useIntl)(),t=(0,a.yK)((()=>({container:{display:"flex",justifyContent:"space-between",margin:"0 12px",height:48,alignItems:"center"},titleLabel:{display:"flex",fontSize:12,alignItems:"center",fontWeight:P.Z.fontWeight.semibold}})),[]),n=(0,s.useCallback)((()=>{j.ZP.setState({...j.ZP.state,tab:j.XF.Share,display:j.wV.Invite,source:j.T5.Notion,focus:j.Sw.Search,emailMessage:""})}),[]),i=(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(pe.Z,{type:"image_url",imageURL:k.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:{marginLeft:4,marginRight:4}}),(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Slack",id:"shareMenu.slackIntegrationName.label"})]});return(0,H.jsxs)("div",{style:t.container,children:[(0,H.jsx)(m.Z,{style:t.titleLabel,children:(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.addFromSlack.label",defaultMessage:"Add people from {integrationNameWithLogo}",values:{integrationNameWithLogo:i}})}),(0,H.jsx)(R.Z,{ariaLabel:e.formatMessage({id:"shareMenuHeader.goBackToInviteFromNotionMenu.iconButton",defaultMessage:"Close slack integration and go back to the main invite flow."}),icon:ce.D,style:{borderRadius:"100%"},onClick:n})]})}function ve(e){const{onClick:t}=e,n=(0,r.useIntl)(),s=(0,a.yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},backButtonPressedStyle:{backgroundColor:"transparent"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:16,width:16,strokeWidth:P.Z.fontWeight.semibold},sendInviteLabel:{fontWeight:P.Z.fontWeight.medium}})),[]);return(0,H.jsxs)("div",{style:s.topContainer,children:[(0,H.jsx)(R.Z,{icon:I.W,iconStyle:s.arrowIcon,style:s.iconButton,onClick:t,ariaLabel:n.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,H.jsx)(m.Z,{style:s.sendInviteLabel,children:(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.sendInvite.label",defaultMessage:"Send invite"})})]})}var be=n(296994),Me=n(304708),je=n(584169),Ce=n(953877),we=n(421202),ke=n(412714),Ie=n(284123),Te=n(80444),Ze=n(131075);function Pe(e){const{store:t,mostPermissivePublicItem:n,permissionItemArgs:l}=e,{permissionItem:d,from:c}=n,{sudoModeStore:u,location:p}=l,f=(0,i.O7)(),h=(0,o.VK)((()=>t.canAdmin()),[t]),{disabled:y}=(0,Ie.E)({store:t}),x=!h||y,S=(0,a.yK)((e=>({container:{display:"flex",flex:1,justifyContent:"center",alignItems:"center",flexDirection:"column",padding:32,textAlign:"center",cursor:x?"not-allowed":""},icon:{height:30,width:30,marginBottom:10,fill:e.mediumIconColor},title:{fontWeight:P.Z.fontWeight.semibold,fontSize:14},caption:{display:"flex",alignItems:"center",marginLeft:26,marginRight:26,marginBottom:20},button:{display:"flex",width:"100%",padding:16,cursor:x?"not-allowed":"pointer"}})),[x]),v=(0,o.VK)((()=>{var e;return null===(e=Te.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace()}),[]),b=c.table===we.iU?c.blockId:c.teamId,M=(0,s.useCallback)((()=>{const e=!v&&d.allow_duplicate;(0,Ze.i)({oldPermissionItem:d,newPermissionItem:{...d,role:"reader",allow_duplicate:e},wasInherited:b!==t.id,environment:f,store:t,sudoModeStore:u,location:p})}),[f,b,p,v,d,t,u]);return(0,H.jsxs)("div",{style:S.container,children:[(0,Ce.u)(S.icon),(0,H.jsx)("div",{style:S.title,children:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Publish to web",id:"publishTab.publishToWeb.title"})}),(0,H.jsx)(m.Z,{isMultiline:!0,isSecondaryColor:!0,style:S.caption,children:(0,H.jsx)(Fe,{store:t})}),(0,H.jsx)(L.Z,{style:S.button,disabled:x,onClick:M,className:g.wlU,children:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Publish",id:"publishTab.publishToWeb.button"})})]})}function Fe(e){let{store:t}=e;const n=(0,Ie.E)({store:t}),s=(0,i.O7)(),l=(0,o.VK)((()=>t.canAdmin()),[t]),d=(0,a.yK)((e=>({helpIcon:{width:16,height:16}})),[]);return n.disabled&&"team"===n.disabledBy?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Publishing to web is disabled for this page via teamspace settings.",id:"publishTab.publishToWeb.disabledByTeamspace.caption"}):n.disabled&&"space"===n.disabledBy?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Publishing to web is disabled for this page via workspace settings.",id:"publishTab.publishToWeb.disabledByWorkspace.caption"}):l?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Publish a static website of this page.",id:"publishTab.publishToWeb.hasFullAccess.caption"}),(0,H.jsx)(R.Z,{iconStyle:d.helpIcon,onClick:()=>{ke.D({environment:s,url:(0,h.UY)("guides.autogeneratedDomains")})},icon:je.m,ariaLabel:"Learn more about sites"})]}):(0,H.jsx)(r.FormattedMessage,{defaultMessage:"You must have full access to this page to publish to web.",id:"publishTab.publishToWeb.noFullAccess.caption"})}var _e=n(711668);function Ae(e){const{store:t,mostPermissivePublicItem:n,permissionItemArgs:s}=e,{permissionItem:i}=n,a="none"!==i.role;return(0,o.VK)((()=>Me.Aq()),[])?a?(0,H.jsx)(be.D7,{store:t,mostPermissivePublicItem:n,sudoModeStore:s.sudoModeStore,location:s.location,showManageAllDomains:!0,showAllPublishedSites:!0}):(0,H.jsx)(be.vk,{store:t,mostPermissivePublicItem:n,sudoModeStore:s.sudoModeStore,location:s.location}):a?(0,H.jsx)(_e.Z,{store:t,mostPermissivePublicItem:n,permissionItemArgs:s,showAllPublishedSites:!0}):(0,H.jsx)(Pe,{store:t,mostPermissivePublicItem:n,permissionItemArgs:s})}var Be=n(133728),Re=n(125829),De=n(490814),Oe=n(203386),Le=n(449150),Ve=n(274244),Ee=n(626907),Ne=n(798165),Ue=n(229798),Ke=n(319385);function We(e){const{featureGateId:t,whenEnabled:n,whenDisabled:s,disableExposureLogging:i}=e,a=function(e){const{featureGateId:t,disableExposureLogging:n}=e;return(0,o.VK)((()=>Ke.default.checkGate({gateName:t,disableExposureLogging:n})),[t,n])}({featureGateId:t,disableExposureLogging:i});return a?n:s}var ze=n(673254),qe=n(250557);function Ge(e){const{currentMembersAndGuests:t,inviteTarget:n}=e,s=He(n);if(!s)return;const i=function(e){const{email:t,currentMembersAndGuests:n}=e;return n.memberEmails.has(t)?"member":n.guestEmails.has(t)?"guest":void 0}({email:s,currentMembersAndGuests:t});return{email:s,currentRole:i}}function He(e){const{type:t}=e;switch(t){case"newUser":case"existingUser":return e.value.email;case"invalidUser":case"group":return;default:(0,Z.t1)(t)}}var $e=n(376719);var Ye=n(790392),Qe=n(24433),Je=n(181886),Xe=n(997466),et=n(81254),tt=n(685740),nt=n(992083),st=n(353578);function it(e){const{spaceId:t,spaceUserId:n,spaceModel:s,spaceUserModel:i,teamModel:l,domains:d}=e,c=(0,r.useIntl)(),u=(0,ze.oo)({name:"internal_guests",spaceId:t,spaceUserId:n,amount:1}),m=(0,ze.VX)({name:"non_admin_members",spaceId:t,spaceUserId:n}),p=(0,a.yK)((e=>{const t=u&&!(0,De._e)(u),n=t?20:5,s=t?e.accentColors.orange[100]:"transparent",i=t?e.accentColors.orange[400]:e.fill.uiBlue;return{container:{borderImage:`repeating-linear-gradient(-45deg, ${s}, ${s} ${n}px, ${i} ${n}px, ${i} ${2*n}px) 5 0`,borderWidth:"4px 0 0 0",borderStyle:"solid",background:t?(0,Xe.Fq)(e.accentColors.orange[400],.15):(0,Xe.Fq)(e.fill.uiBlue,.15),position:"relative",padding:10,zIndex:5},fill:{background:e.surface.elevated,border:`1px solid ${e.stroke.deemphasized}`},button:{height:"auto",width:"calc(100% + 16px)",padding:8,margin:-8}}}),[u]),g=(0,o.VK)((()=>{var e;const t=(0,Je.KE)((null===(e=le.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.subscriptionTier)??"free");return st.i$[t].label}),[]),f=(0,o.VK)((()=>null==i?void 0:i.isWorkspaceOwner()),[i]),h=(0,o.VK)((()=>null==i?void 0:i.isMember()),[i]);let y;y=f?"You are a workspace owner":h?"You are a member":"You are a guest";const x=(0,o.VK)((()=>[{label:"Disable members inviting guests to pages",isEnabled:(null==s?void 0:s.getDisableGuests())??!1},{label:"Allow members to request adding guests",isEnabled:(null==s?void 0:s.getSettings().enable_guest_invite_requests)??!1},{label:"Allow members to request adding other members",isEnabled:!(null!=s&&s.getSettings().disable_membership_requests)??!1}]),[s]),S=(0,o.VK)((()=>[{label:"Disable guests",isEnabled:(null==l?void 0:l.getSettings().disable_guests)??!1}]),[l]),v=(0,o.VK)((()=>{if(!s||!d||!i)return;const{autojoinDomains:e}=(0,Qe.tV)({space:s,spaceUser:i,domains:d});return e}),[s,i,d]),b=(0,o.VK)((()=>{if(!s||!i)return;const{type:e}=(0,Qe.tX)({space:s,spaceUser:i,team:l});switch(e){case"can_add":return"You can add guests.";case"can_request":return"You can request to add guests.";case"cannot_add":return"You can't add or request to add guests.";default:(0,Z.t1)(e)}}),[s,i,l]),M=(0,o.VK)((()=>{if(!s||!d||!i)return;const{type:e}=(0,Qe.tV)({space:s,spaceUser:i,domains:d});switch(e){case"can_add":return"You can add members.";case"can_request":return"You can request to add members.";case"cannot_add":return"You can't add or request to add members.";default:(0,Z.t1)(e)}}),[s,i,d]),j=(0,o.VK)((()=>{if(!s||!i||!d)return!1;return"can_add"===(0,Qe.tV)({space:s,spaceUser:i,domains:d}).type}),[s,i,d]),C=(0,o.VK)((()=>{if(!u)return;const e=u.type;switch(e){case"available":return"You can add an internal guest.";case"blocked":case"upsell":return j?m?"Internal guests will be added to the space with member access.":"Internal guests will be added to the space with workspace owner access.":"You can't add internal guests.";default:(0,Z.t1)(e)}}),[u,m,j]),w=(0,o.VK)((()=>{if(!u)return"Guest limit data is unavailable";if("cumulative"===u.limit.type){const{current:e,total:t}=u.limit;return"unlimited"===t?"No guest limit":`Space has ${e} of ${t} guests`}}),[u]),k=e=>{nt.Z.setState({open:!0,openedFrom:"misc",currentTab:e,defaultSubtab:void 0,highlightedSetting:void 0})};return(0,H.jsxs)(_.jX,{gap:10,style:p.container,children:[(0,H.jsxs)(_.jX,{gap:12,borderRadius:6,padding:10,style:p.fill,children:[(0,H.jsx)(tt.Z,{onClick:()=>k("security"),style:p.button,children:(0,H.jsxs)(_.jX,{gap:4,children:[(0,H.jsx)(D.q,{styleName:"UISmall-12px/Medium",children:"Space security settings"}),x.map(((e,t)=>(0,H.jsxs)(_.jX,{direction:"row",gap:4,align:"center-left",children:[(0,H.jsx)(ot,{isEnabled:e.isEnabled}),(0,H.jsx)(D.q,{colorName:e.isEnabled?"secondary":"tertiary",styleName:"UISmall-12px/Regular",children:e.label})]},t)))]})}),(0,H.jsxs)(_.jX,{gap:4,children:[(0,H.jsx)(D.q,{styleName:"UISmall-12px/Medium",children:"Team security settings"}),S.map(((e,t)=>(0,H.jsxs)(_.jX,{direction:"row",gap:4,align:"center-left",children:[(0,H.jsx)(ot,{isEnabled:e.isEnabled}),(0,H.jsx)(D.q,{colorName:e.isEnabled?"secondary":"tertiary",styleName:"UISmall-12px/Regular",children:e.label})]},t)))]}),(0,H.jsx)(tt.Z,{onClick:()=>k("billing"),style:p.button,children:(0,H.jsxs)(_.jX,{gap:4,children:[(0,H.jsx)(D.q,{styleName:"UISmall-12px/Medium",children:"Subscription"}),(0,H.jsx)(D.q,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:`${c.formatMessage(g)} plan`}),(0,H.jsx)(D.q,{colorName:"secondary",styleName:"UISmall-12px/Regular",children:w})]})}),(0,H.jsx)(tt.Z,{onClick:()=>k("settings"),style:p.button,children:(0,H.jsxs)(_.jX,{gap:4,children:[(0,H.jsx)(D.q,{styleName:"UISmall-12px/Medium",children:"Allowed email domains"}),null==v?void 0:v.map((e=>(0,H.jsx)(D.q,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:e},e))),0===(null==v?void 0:v.length)&&(0,H.jsx)(D.q,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:"None"})]})})]}),(0,H.jsxs)(_.jX,{gap:4,borderRadius:6,padding:10,style:p.fill,children:[(0,H.jsx)(D.q,{styleName:"UISmall-12px/Medium",children:y}),(0,H.jsx)(D.q,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:M}),(0,H.jsx)(D.q,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:b}),(0,H.jsx)(D.q,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:C})]})]})}function ot(e){const{isEnabled:t}=e,n=(0,a.yK)((e=>({circle:{width:10,height:10,borderRadius:"50%",border:`1px solid ${e.icon.quaternary}`}})),[]);return t?(0,H.jsx)(et.x,{iconGroup:Ye.K,variantName:"mini",colorName:"secondary"}):(0,H.jsx)(_.jX,{width:14,height:14,align:"center",children:(0,H.jsx)("div",{style:n.circle})})}var at=n(977657),rt=n(454642),lt=n(953336),dt=n(434859),ct=n(530874),ut=n(457345),mt=n(994044),pt=n(374194);function gt(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:n,value:s,maxLength:i}=e,o=(0,a.yK)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,H.jsx)("div",{style:o.container,children:(0,H.jsxs)("div",{style:o.warning,children:[t&&(0,H.jsx)(r.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:s.length,maxCharacters:i}}),t&&n&&" · ",n&&(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}function ft(e){const{open:t,focus:n,value:s,maxLength:i,onFocus:o,onChange:l,onCancel:d}=e,c=(0,r.useIntl)(),u=s.length/i>=.8,m=(0,mt.TQ)(s),p=u||m,g=(0,a.yK)((e=>({container:{maxHeight:t?100:0,position:"absolute",bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",overflow:"hidden",zIndex:1},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),f=c.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite..."});return(0,H.jsxs)("div",{style:g.container,children:[p&&(0,H.jsx)(gt,{value:s,maxLength:i,shouldShowLengthWarning:u,shouldShowLinkWarning:m}),(0,H.jsx)(pt.Z,{textarea:!0,focusInitial:!1,format:pt.B.Transparent,placeholder:f,maxlength:i,focus:n,value:s,onFocus:o,onChange:l,inputStyle:g.input,onCancel:d})]})}var ht=n(956678),yt=(n(757658),n(158573)),xt=n(559054),St=n(185397),vt=n(747612),bt=n(460322),Mt=n(536591),jt=n(516880),Ct=n(925942),wt=n(636329),kt=n(772141),It=n(429369),Tt=n(519889),Zt=n(364684),Pt=n(531701),Ft=n(91536),_t=n(195209),At=n(621752),Bt=n(552275),Rt=n(312793),Dt=n(632163),Ot=n(743765),Lt=n(776798),Vt=n(672495),Et=n(526388),Nt=n(333241),Ut=n(869507),Kt=n(670268),Wt=n(88893);function zt(){const e=le.subscriptionDataStoreInstance.state,t=e?Wt.CM(e):[],n=new Map;return t.forEach((e=>{n.set(e.userId,e)})),n}function qt(e){const{spaceVisibleUserMap:t,blockStore:n,userId:s}=e,i=t.get(s);if(!i||"none"!==i.role)return;if(!i.isTeamGuest)return"guest";const o=Ne.VP(n),a=null==o?void 0:o.getModel();if(!a)return"guest";return(0,Zt.s8)({team:a,userId:s})?"team_level_guest":"guest"}var Gt=n(98742),Ht=n(367669),$t=n(75472),Yt=n(516639),Qt=n(853353),Jt=n(825464),Xt=n(206258),en=n(125735),tn=n(760442),nn=n(471862);function sn(e){const{group:t}=e,n=(0,r.useIntl)(),s=(0,Yt.kF)({intl:n,group:t});return(0,H.jsx)(en.Y,{group:t,limit:15,noMembersMessage:(0,H.jsx)(tn.Z,{imageURL:k.Z.images.tooltips.share.sharedPng,imageWidth:240,imageHeight:120,caption:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"For all members of the {groupName} group, this page will show up in the <boldtext>Shared</boldtext> section in their sidebar.",values:{boldtext:e=>(0,H.jsx)("span",{style:{fontWeight:P.Z.fontWeight.bold},children:e}),groupName:s},id:"blockPermissionsSettings.groupPermission.tooltip"})})})}const on=function(e){const{store:t,groupPermission:n,spaceId:s,fromPermissionWrapper:i}=e,a=(0,r.useIntl)(),l=(0,o.VK)((()=>{const{currentSpaceStore:e}=Te.default.state;if(!e)return!1;return e.getPermissionGroups().find((e=>e.id===n.permissionItem.group_id))}),[n.permissionItem.group_id]);if(!l)return null;const d=l.user_ids||[],c=(0,Yt.kF)({intl:a,group:l}),u=l.icon&&(0,H.jsx)(V.Z,{disabled:!0,title:c,icon:l.icon?{pointer:{table:"space",id:s},icon:l.icon}:void 0,isEmptyPage:!1,size:18});return(0,H.jsx)("div",{style:{fontWeight:400},className:g.gGc,children:(0,H.jsx)(nn.C,{currentBlockStore:t,permissionItem:n.permissionItem,from:n.from,icon:(0,H.jsx)(Rt.Z,{size:nn.Z}),title:c,tag:u,ignoreLocalHoverState:e.ignoreLocalHoverState,showInherited:e.showInherited,nonInheritedTooltip:(0,H.jsx)(sn,{group:l}),subtitle:(0,H.jsxs)("div",{children:[(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,H.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:d.length}})]}),upgradeButtonName:"group_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:i,...e.permissionItemArgs})},l.id)};var an=n(307928),rn=n(588198),ln=n(45653);function dn(e){const{userValue:t,shouldShowPendingInvitation:n}=e,s=(0,a.yK)((()=>({iconPlaceholder:{height:nn.Z,width:nn.Z,borderRadius:20}})),[]);return t?(0,H.jsx)(ln.Z,{userValue:t,size:nn.Z,initialOverrideStyle:n?{borderStyle:"dashed"}:void 0}):(0,H.jsx)(mn,{style:s.iconPlaceholder})}function cn(e){const{userValue:t,guestLabel:n,shouldShowPendingInvitation:s}=e,i=(0,r.useIntl)(),l=(0,o.VK)((()=>{const{currentUserStore:e}=Te.default.state;return!!e&&(!!t&&e.id===t.id)}),[t]),d=(0,a.yK)((e=>({titlePlaceholder:{height:8,width:81,borderRadius:4},pendingInvitation:{color:Pt.ZP.PendingInvitationTextColor},titleYouIndicator:{color:e.mediumTextColor}})),[]);if(!t)return(0,H.jsx)(mn,{style:d.titlePlaceholder});const c=(0,an.Nz)(i,t);return(0,H.jsx)(H.Fragment,{children:c?(0,H.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,H.jsx)(m.Z,{className:"notranslate",style:s?d.pendingInvitation:void 0,children:l?(0,H.jsx)(r.FormattedMessage,{id:"cellMemberAvatar.displayName.title",defaultMessage:"{userFullDisplayName} <youIndicatorText>(You)</youIndicatorText>",values:{userFullDisplayName:c,youIndicatorText:e=>(0,H.jsx)("span",{style:d.titleYouIndicator,children:e})}}):c}),n&&(0,H.jsx)(rn.b,{labelType:n})]}):(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Invitation sent",id:"blockPermissionsSettings.sentInvitation.message"})})}function un(e){const{userValue:t,shouldShowPendingInvitation:n}=e,s=(0,a.yK)((()=>({uiLabel:{display:"flex"},subtitlePlaceholder:{height:8,width:139,borderRadius:4,marginTop:10},dotSeparator:{marginLeft:2,marginRight:2},pendingInvitation:{color:Pt.ZP.PendingInvitationTextColor}})),[]);return null!=t&&t.email?n?(0,H.jsx)(m.Z,{isSmall:!0,style:s.pendingInvitation,children:(0,H.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.invitationSent",defaultMessage:"Pending Invitation"})}):(0,H.jsx)(m.Z,{isSmall:!0,children:t.email}):(0,H.jsx)(mn,{style:s.subtitlePlaceholder})}function mn(e){const t=(0,a.yK)((t=>({placeholder:{...e.style,background:t.lightDividerColor}})),[e.style]);return(0,H.jsx)("div",{style:t.placeholder})}const pn=function(e){const{store:t,userPermission:n,spaceVisibleUserMap:s,fromPermissionWrapper:i}=e,a=(0,o.VK)((()=>Xt.U6.createChildStore(t,{table:Tt.KJ,id:n.permissionItem.user_id}).getValue()),[t,n.permissionItem.user_id]),r=(0,o.VK)((()=>{if(null!=a&&a.id)return qt({spaceVisibleUserMap:s,userId:a.id,blockStore:t})}),[t,s,a]),l=(0,o.VK)((()=>!0!==(null==a?void 0:a.onboarding_completed)&&(0,Me.fJ)()),[a]);return(0,H.jsx)("div",{children:(0,H.jsx)(nn.C,{currentBlockStore:t,permissionItem:n.permissionItem,from:n.from,ignoreLocalHoverState:e.ignoreLocalHoverState,icon:(0,H.jsx)(dn,{userValue:a,shouldShowPendingInvitation:l}),title:(0,H.jsx)(cn,{userValue:a,guestLabel:r,shouldShowPendingInvitation:l}),subtitle:(0,H.jsx)(un,{userValue:a,shouldShowPendingInvitation:l}),showInherited:e.showInherited,upgradeButtonName:"user_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:i,...e.permissionItemArgs})},n.permissionItem.user_id)};var gn=n(745238);const fn=(0,gn.IU)("globe3",{viewBox:"0 0 15 15",svg:(0,H.jsx)("path",{d:"M8.052 12.458c.196 0 .44-.114.731-.342a6.52 6.52 0 00.916-.882c.315-.364.609-.752.882-1.162a8.03 8.03 0 00.67-1.19c.173-.377.26-.694.26-.95 0-.19-.082-.405-.246-.642a3.52 3.52 0 00-.63-.69 3.984 3.984 0 00-.792-.547c-.27-.146-.513-.219-.732-.219a.93.93 0 00-.43.123c-.155.078-.308.157-.458.24a.842.842 0 01-.383.115c-.078 0-.182-.038-.315-.116a3.409 3.409 0 01-.758-.608c-.096-.11-.144-.194-.144-.253 0-.041.03-.084.089-.13a.296.296 0 01.178-.075c.059 0 .166.055.32.164.16.105.33.21.507.314.178.1.332.15.465.15.291 0 .526-.088.704-.266.177-.178.266-.42.266-.724 0-.187-.082-.4-.246-.636.192-.1.408-.219.65-.356.246-.14.492-.298.738-.471.246-.178.47-.372.67-.581.205-.21.36-.429.465-.657l-.663-.341c-.087.21-.235.412-.445.608a5 5 0 01-.717.54c-.265.169-.53.321-.793.458a61.02 61.02 0 00-.69.362.332.332 0 00-.172.199c-.027.082-.004.173.069.273.14.196.241.344.3.444a.47.47 0 01.096.246c0 .05-.016.092-.048.123a.182.182 0 01-.123.042c-.073 0-.191-.05-.355-.15a9.923 9.923 0 00-.527-.315c-.182-.11-.34-.164-.471-.164a.889.889 0 00-.472.143 1.38 1.38 0 00-.383.362.747.747 0 00-.15.438c0 .155.068.33.205.526.141.196.317.385.526.568.21.182.424.332.643.45.223.115.417.172.58.172.128 0 .279-.039.452-.116.173-.082.337-.164.492-.247.155-.082.265-.123.328-.123.11 0 .256.055.438.164.187.105.374.237.56.397.187.155.345.308.472.458.132.146.198.262.198.349 0 .155-.075.385-.225.69-.15.3-.342.627-.575.978-.232.35-.476.688-.731 1.011-.255.324-.492.59-.71.8-.22.205-.386.308-.5.308a.393.393 0 01-.226-.082c-.072-.06-.109-.117-.109-.171a.54.54 0 01.014-.116 5.696 5.696 0 00.192-.623c.04-.145.058-.303.054-.471-.005-.228-.103-.438-.294-.63a7.264 7.264 0 00-.882-.71 4.55 4.55 0 00-.219-.15l-.218-.164c-.196-.15-.294-.301-.294-.452 0-.082.03-.21.089-.382.068-.242.102-.415.102-.52a.703.703 0 00-.123-.41 1.948 1.948 0 00-.376-.397.747.747 0 01-.061-.054.188.188 0 00-.055-.048l-1.087-.97c-.442-.397-.743-.748-.902-1.054-.16-.31-.215-.603-.164-.881.054-.278.175-.57.362-.875l-.718-.144c-.205.324-.33.668-.376 1.032-.046.365.03.752.226 1.162.196.41.556.848 1.08 1.313l1.08.957c.123.105.214.184.273.24.064.054.098.104.103.15a1.235 1.235 0 01-.103.341c-.059.15-.089.33-.089.54 0 .401.196.748.588 1.04.392.296.709.533.95.71.247.174.37.297.37.37a1.26 1.26 0 01-.13.587c-.087.187-.13.4-.13.636 0 .16.055.312.164.458.11.146.248.267.417.363.169.095.337.143.506.143zm-.267 1.668c.966 0 1.875-.185 2.728-.554a7.22 7.22 0 003.787-3.78 6.788 6.788 0 00.553-2.728c0-.966-.184-1.875-.553-2.727a7.137 7.137 0 00-1.531-2.25 7.219 7.219 0 00-2.256-1.53A6.805 6.805 0 007.778.003a6.77 6.77 0 00-2.727.554 7.241 7.241 0 00-3.774 3.78 6.788 6.788 0 00-.553 2.727c0 .967.184 1.876.553 2.728.37.852.878 1.604 1.525 2.256a7.124 7.124 0 002.256 1.524 6.77 6.77 0 002.727.554zm0-1.094a5.692 5.692 0 01-2.304-.472 6.034 6.034 0 01-1.9-1.285 6.217 6.217 0 01-1.292-1.907 5.765 5.765 0 01-.465-2.304c0-.815.155-1.583.465-2.303a6.133 6.133 0 011.292-1.9 6.036 6.036 0 011.9-1.286 5.676 5.676 0 012.297-.471 5.7 5.7 0 012.304.471c.72.31 1.356.738 1.907 1.285.552.547.982 1.18 1.292 1.9.315.72.472 1.489.472 2.304 0 .816-.157 1.584-.472 2.304a6.06 6.06 0 01-3.192 3.192 5.693 5.693 0 01-2.304.472z"})});var hn=n(462385);function yn(e){const{publicPermission:t}=e,n=(0,a.yK)((e=>({banner:{backgroundColor:e.accentColors.gray[50],borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:14,display:"flex",alignItems:"center"},label:{fontSize:12,display:"inline-flex",marginRight:10},icon:{height:20,width:20,marginLeft:14,marginRight:8,color:e.mediumIconColor},manageButton:{color:e.regularTextColor,fontWeight:P.Z.fontWeight.medium}})),[]),s=t.permissionItem.role;return kt.YX(s)?(0,H.jsxs)("div",{style:n.banner,children:[(0,H.jsxs)(m.Z,{style:n.label,children:[fn(n.icon),(0,H.jsx)(xn,{role:s})]}),(0,H.jsx)(hn.Z,{style:n.manageButton,onClick:()=>j.ZP.setState({...j.ZP.state,display:j.wV.Publish,tab:j.XF.Publish}),children:(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.managePublishSettingsButton.label",defaultMessage:"Manage"})})]}):null}function xn(e){const{role:t}=e;switch(t){case"read_and_write":return(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canEdit",defaultMessage:"This page allows edits from anyone on the web"});case"comment_only":return(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canComment",defaultMessage:"This page allows comments from anyone on the web"});case"reader":return(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canRead",defaultMessage:"This page can be viewed by anyone on the web"});case"editor":case"membership_admin":case"content_only_editor":case"none":return null;default:(0,Z.t1)(t)}}var Sn=n(727714),vn=n(274016);function bn(e){const{store:t,spacePermission:n,fromPermissionWrapper:s}=e,i=(0,a.yK)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]);return(0,H.jsx)(nn.C,{icon:(0,Sn.N)(i.icon),iconStyle:i.iconContainer,title:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Members with the link",id:"blockPermissionsSettings.permissionItem.linkAccess"}),currentBlockStore:t,permissionItem:n.permissionItem,from:n.from,upgradeButtonName:"space_permission_item",fromPermissionWrapper:s,...e.permissionItemArgs})}function Mn(e){const{spaceStore:t}=e,n=(0,i.O7)(),s=(0,o.VK)((()=>(0,U.rn)(n,t)),[n,t]);return(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at {workspaceName}",id:"blockPermissionsSettings.permissionItem.workspaceAccessNew",values:{workspaceName:s}})}function jn(){const e=(0,o.VK)((()=>(0,Wt.Io)().length),[]);return(0,H.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} person} other {{numberOfWorkspaceMembers} people}}",id:"blockPermissionsSettings.spacePermission.none",values:{numberOfWorkspaceMembers:e}})}function Cn(){return(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all members in your workspace.",id:"blockPermissionsSettings.spacePermission.tooltip"})}const wn=function(e){const{store:t,spacePermission:n,fromPermissionWrapper:s}=e,i=(0,o.VK)((()=>{const e=Te.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),r=(0,a.yK)((()=>({container:{width:"100%"}})),[]);return i?n.permissionItem.unlisted_timestamp?(0,H.jsx)(bn,{...e}):(0,H.jsx)("div",{style:r.container,className:g.afv,children:(0,H.jsx)(nn.C,{currentBlockStore:t,permissionItem:n.permissionItem,from:n.from,icon:(0,H.jsx)(vn.p,{disabled:!0,store:i,size:nn.Z}),title:(0,H.jsx)(Mn,{spaceStore:i}),nonInheritedTooltip:(0,H.jsx)(Cn,{}),subtitle:(0,H.jsx)(jn,{}),upgradeButtonName:"space_permission_item",fromPermissionWrapper:s,...e.permissionItemArgs})}):null};var kn=n(379362),In=n(91192);function Tn(e){const{teamName:t,isCompact:n}=e;return n?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace guests",id:"blockPermissionsSettings.permissionItem.teamGuestAccess.compact"}):t?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace guests of {teamName}",id:"blockPermissionsSettings.permissionItem.teamGuestAccess",values:{teamName:t}}):(0,H.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.teamspaceGuestsTeamName.hidden",defaultMessage:"Teamspace guests of a private teamspace"})}function Zn(e){const{membersCount:t,isCompact:n}=e;return n?null:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}function Pn(e){const{teamName:t}=e,n=(0,a.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,H.jsx)("div",{style:n.tooltip,children:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all teamspace guests of {teamName}.",values:{teamName:t},id:"blockPermissionsSettings.teamGuestPermission.tooltip"})}):null}const Fn=function(e){const{store:t,blockTeamGuestPermission:n,isExternalTeam:s,fromPermissionWrapper:i}=e,{permissionItem:r}=n,l=(0,o.VK)((()=>Te.default.state.currentSpaceStore),[]),d=(0,o.VK)((()=>{var e;return kt.bm(r)?r.team_id:null===(e=Ne.VP(t))||void 0===e?void 0:e.id}),[r,t]),{teamStore:c,teamIsDefined:u,teamName:m,teamIcon:p,membersCount:f}=(0,o.VK)((()=>{var e;if(!l||!d)return{};const t=Xt.zX.createChildStore(l,{table:It.e0,id:d,spaceId:l.id});return null!=t&&t.isDefined()?{teamStore:t,teamIsDefined:null==t?void 0:t.isDefined(),teamName:t.getName(),teamIcon:t.getIcon(),membersCount:(null===(e=t.getNonGuestUserIdsInTeamUsingSpaceMembers((0,Wt.Io)()))||void 0===e?void 0:e.length)??0}:{}}),[l,d]),h=!s,y=(0,a.yK)((()=>({container:{width:"100%"}})),[]);if(!c)return null;const x=p&&kn.V2(p.icon)?kn.mk(p.icon):"gray",S=p?{...p,icon:`/icons/user-circle_${x}.svg`}:void 0;return(0,H.jsx)("div",{style:y.container,className:g.YHn,children:(0,H.jsx)(nn.C,{isCompact:h,currentBlockStore:t,permissionItem:r,icon:u?(0,H.jsx)(vn.p,{disabled:!0,store:c,size:nn.Z,icon:S}):(0,In.x)(),title:(0,H.jsx)(Tn,{teamName:m,isCompact:h}),nonInheritedTooltip:(0,H.jsx)(Pn,{teamName:m}),from:n.from,subtitle:u&&(0,H.jsx)(Zn,{membersCount:f,isCompact:h}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:i,...e.permissionItemArgs})})};var _n=n(301951);function An(e){const{teamName:t,isCompact:n}=e;return n&&t?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace members",id:"blockPermissionsSettings.permissionItem.teamAccessV2"}):t?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Members of {teamName}",id:"blockPermissionsSettings.permissionItem.teamAccess",values:{teamName:t}}):(0,H.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.membersTeamName.hidden",defaultMessage:"Members of a private teamspace"})}function Bn(e){const{membersCount:t,isCompact:n}=e;return n?null:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}function Rn(e){const{teamName:t}=e,n=(0,a.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,H.jsx)("div",{style:n.tooltip,children:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all owners and members of {teamName}.",values:{teamName:t},id:"blockPermissionsSettings.teamPermission.tooltip"})}):null}const Dn=function(e){const{store:t,blockTeamPermission:n,isExternalTeam:s,fromPermissionWrapper:i}=e,{permissionItem:r}=n,l=(0,o.VK)((()=>Te.default.state.currentSpaceStore),[]),d=(0,o.VK)((()=>{var e;return kt.zU(r)?r.team_id:null===(e=Ne.VP(t))||void 0===e?void 0:e.id}),[r,t]),{teamStore:c,teamIsDefined:u,teamName:m,membersCount:p}=(0,o.VK)((()=>{var e;if(!l||!d)return{};const t=Xt.zX.createChildStore(l,{table:It.e0,id:d,spaceId:l.id});return{teamStore:t,teamIsDefined:null==t?void 0:t.isDefined(),teamName:null==t?void 0:t.getName(),membersCount:(null===(e=t.getNonGuestUserIdsInTeamUsingSpaceMembers((0,Wt.Io)()))||void 0===e?void 0:e.length)??0}}),[l,d]),f=!s,h=(0,a.yK)((()=>({container:{width:"100%"}})),[]);return c?(0,H.jsx)("div",{style:h.container,className:g.YHn,children:(0,H.jsx)(nn.C,{isCompact:f,currentBlockStore:t,permissionItem:n.permissionItem,from:n.from,icon:u?(0,H.jsx)(vn.p,{disabled:!0,store:c,size:nn.Z}):(0,In.x)(),title:(0,H.jsx)(An,{teamName:m,isCompact:f}),nonInheritedTooltip:(0,H.jsx)(Rn,{teamName:(0,H.jsx)(_n.Z,{store:c,useInvertedColors:!0})}),subtitle:u&&(0,H.jsx)(Bn,{membersCount:p,isCompact:f}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:i,...e.permissionItemArgs})}):null};var On=n(279414);function Ln(e){const{store:t,teamOwners:n,teamStore:s,teamName:i}=e;if(i){const e=n.map((e=>Xt.U6.createChildStore(t,{table:Tt.KJ,id:e})));return(0,H.jsx)(On.n,{teamStore:s,ownerStores:e})}return(0,In.x)()}function Vn(e){const{teamName:t,isCompact:n}=e;return n&&t?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV2",values:{teamName:t}}):t?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Owners of {teamName}",id:"blockPermissionsSettings.permissionItem.teamOwnerAccess",values:{teamName:t}}):(0,H.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.teamName.hidden",defaultMessage:"Owners of a private teamspace"})}function En(e){const{teamOwnersCount:t,isCompact:n}=e;return n||0===t?null:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",values:{teamOwnersCount:t}})}function Nn(e){const{teamName:t}=e,n=(0,a.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,H.jsx)("div",{style:n.tooltip,children:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all owners of {teamName}",values:{teamName:t},id:"blockPermissionsSettings.teamOwnerPermission.tooltip"})}):null}const Un=function(e){const{store:t,blockTeamOwnerPermission:n,isExternalTeam:s,fromPermissionWrapper:i}=e,{permissionItem:r}=n,l=(0,o.VK)((()=>Te.default.state.currentSpaceStore),[]),d=(0,o.VK)((()=>{var e;return kt.LW(r)?r.team_id:null===(e=Ne.VP(t))||void 0===e?void 0:e.id}),[r,t]),{teamStore:c,teamName:u,teamOwners:m}=(0,o.VK)((()=>{if(!l||!d)return{undefined:void 0};const e=Xt.zX.createChildStore(l,{table:It.e0,id:d,spaceId:l.id});return{teamStore:e,teamName:e.getName(),teamOwners:e.getOwnerUserIds()}}),[l,d]),p=!s,f=(0,a.yK)((()=>({container:{width:"100%"}})),[]);return c?(0,H.jsx)("div",{style:f.container,className:g.ZmO,children:(0,H.jsx)(nn.C,{isCompact:p,currentBlockStore:t,permissionItem:n.permissionItem,from:n.from,icon:(0,H.jsx)(Ln,{store:t,teamName:u,teamStore:c,teamOwners:m}),title:(0,H.jsx)(Vn,{teamName:u,isCompact:p}),nonInheritedTooltip:(0,H.jsx)(Nn,{teamName:(0,H.jsx)(_n.Z,{store:c,useInvertedColors:!0})}),subtitle:(0,H.jsx)(En,{teamOwnersCount:m.length,isCompact:p}),upgradeButtonName:"team_owner_permission_item",fromPermissionWrapper:i,...e.permissionItemArgs})}):null};function Kn(e){const{store:t,shouldShowSlackOnly:n,calculatedPermissions:s,permissionItemArgs:l,tokenQuery:d,showShimmer:c,error:u,ready:m,result:p}=e,g=s.pagePermissionUIModel,f=(0,i.O7)(),h=(0,o.qz)(e.inviteTargetsStore,re.ZP),y=(0,o.qz)(e.menuListStore,Ue.Z),x=(0,o.VK)((()=>zt()),[]),S=(0,o.VK)((()=>Me.Rv()),[]),v=(0,a.yK)((e=>({sectionMenuItem:{paddingTop:0,display:"flex",flexDirection:"column",gap:2},zeroState:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.mediumTextColor,fontSize:14,position:"relative",pointerEvents:"auto",paddingTop:10,marginTop:110},zeroStateText:{width:"70%",alignSelf:"center"},zeroStateIcon:{height:54,width:54,marginBottom:12,fill:e.mediumIconColor},arrowUpLeftIcon:{width:12,height:12,marginRight:3,marginTop:3,color:e.v2.text.quaternary}})),[]),{inPageTargets:b,notInPageTargets:M,filteredImportedContacts:j}=(0,o.VK)((()=>{const{inviteUsers:e,inviteGroups:n,importedContacts:i=[]}=p??{inviteUsers:[],inviteGroups:[],importedContacts:[]},o=[...e,...n],a=[],r=[],l=new Set;o.forEach((e=>{"group"!==e.type&&l.add(e.value.email.toLowerCase());const n=Boolean($t.Zp({store:t,target:e})),i=function(e){const{inviteTarget:t,blockStore:n,spacePermission:s,teamMemberPermission:i,groupPermission:o}=e,a=t.type;if("newUser"===a)return{role:"none",type:"user_permission",user_id:t.value.email};if("existingUser"===a)return Ht.uY({userId:t.value.id,store:n});if("group"===a){const e={role:"none",type:"group_permission",group_id:t.value.id},a=(0,Ne.VP)(n),r=null==a?void 0:a.getRawMembership().find((e=>(0,Zt.lF)({groupId:t.value.id,teamMember:e})));return[s,...a&&i&&r?[i]:[],o||{permissionItem:e,from:{table:we.iU,blockId:n.id}}].sort(((e,t)=>kt.xm[t.permissionItem.role]-kt.xm[e.permissionItem.role]))}(0,Z.t1)(a)}({inviteTarget:e,blockStore:t,spacePermission:s.mostPermissiveSpaceItem,teamMemberPermission:s.mostPermissiveAncestorTeamMemberItem,groupPermission:"group"===e.type?g.mostPermissiveGroupPermissions.find((t=>t.permissionItem.group_id===e.value.id)):void 0}),o=Array.isArray(i)?i[0].permissionItem:i;if("existingUser"===e.type&&!Boolean(e.spaceRole)){const t=x.get(e.value.id);e.spaceRole=t?t.role:"not_in_space"}(n||kt.YX(o.role??"none"))&&"newUser"!==e.type?a.push({inviteTarget:e,permissionItem:o,mostPermissivePermissions:Array.isArray(i)?i:void 0}):"newUser"!==e.type&&r.push(e)}));const d=i.filter((e=>!l.has(e.value.email.toLowerCase())));return{inPageTargets:a,notInPageTargets:r,filteredImportedContacts:d}}),[t,p,s.mostPermissiveSpaceItem,s.mostPermissiveAncestorTeamMemberItem,g.mostPermissiveGroupPermissions,x]),{isValidEmail:C,isEmailInTargets:w}=(0,o.VK)((()=>{const e=(0,Be.H3)(d);return{isValidEmail:(0,Be.oH)(e),isEmailInTargets:[...b.map((e=>{let{inviteTarget:t}=e;return t})),...M].some((t=>"group"!==t.type&&t.value.email===e))}}),[d,b,M]),k=C&&!w,I=!n&&M.length>0&&0===d.length,T=!n&&d.length>0&&b.length>0,P=!n&&M.length>0&&d.length>0,_=S&&j.length>0,A={key:"imported contacts",render:e=>(0,H.jsx)(Vt.Z,{...e,style:v.sectionMenuItem,title:(0,H.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.importedContactsSection.title",defaultMessage:"From Slack"}),loading:!m}),items:j.map(((e,n)=>({key:e.value.email,render:n=>(0,H.jsx)(Xn,{...n,invited:!1,inviteTarget:e,isInInviteTargets:Ee.H({target:e,inviteTargetsStore:h}),blockStore:t,spaceVisibleUserMap:x}),action:()=>{Ee.H({target:e,inviteTargetsStore:h})?h.setState({...h.state,inviteTargets:h.state.inviteTargets.filter((t=>"newUser"!==t.type||e.value.email!==t.value.email))}):(F.hE(f,{invite_token_query:d,selected_user_token:e,selected_user_token_rank:n,from:"share_modal_invite",subscription_tier:(0,z.zt)(),type:"slack"}),h.setState({inviteTargets:[...h.state.inviteTargets,e],tokenQuery:""}),y.unsetFocus())}})))},B=k||!I&&!T&&!P&&!_&&!n&&d.length>0,R=(0,o.VK)((()=>{const e=le.subscriptionDataStoreInstance.state,{currentSpaceStore:t}=Te.default.state;return t&&e?Wt.hn(e).map((n=>{if(("unsubscribed_admin"===e.type||"unsubscribed_member"===e.type||"subscribed_admin"===e.type)&&e.joinedMemberIds.includes(n.userId)){const e=Xt.U6.createChildStore(t,{table:Tt.KJ,id:n.userId}).getEmail();return e&&(0,Be.Gd)(e)}})).reduce(((e,t)=>(t&&!e.includes(t)&&e.push(t),e)),[]):[]}),[]),D=(0,Qt.Z)(t);if(u)return(0,H.jsx)(Ut.l,{loading:!m,children:(0,H.jsx)(Ot.Z,{title:(0,H.jsx)(r.FormattedMessage,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})})});if(!m&&c)return(0,H.jsx)(Kt.B,{areaHeight:window.innerHeight});const O={key:"user results",render:e=>(0,H.jsx)(Vt.Z,{...e,style:v.sectionMenuItem,loading:!m,title:(0,H.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})}),items:ss({tokenQuery:d,possibleDomains:R,shouldShowAutoFillEmail:B,isGuestInviteRequestRequired:D.isGuestRequestRequired,environment:f,inviteTargetsStore:h,menuListStore:y,store:t,styles:v})},L={key:"suggested",render:e=>(0,H.jsx)(Vt.Z,{...e,style:v.sectionMenuItem,title:(0,H.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.suggestedSection.title",defaultMessage:"Suggested"}),loading:!m}),items:M.map(((e,n)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:n=>{const s=Ee.H({target:e,inviteTargetsStore:h});return(0,H.jsx)(Xn,{...n,invited:!1,inviteTarget:e,isInInviteTargets:s,blockStore:t,spaceVisibleUserMap:x})},action:()=>Wn({inviteTarget:e,inviteTargetsStore:h,menuListStore:y,rank:n,tokenQuery:d,environment:f,type:"suggested"})})))},V={key:"in page",render:e=>(0,H.jsx)(Vt.Z,{...e,style:v.sectionMenuItem,title:(0,H.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inPageSection.title",defaultMessage:"In page"}),loading:!m}),items:b.map(((e,n)=>{const{inviteTarget:s,permissionItem:i,mostPermissivePermissions:o}=e,{type:a}=s;if("existingUser"===a){if(!!o&&o.length>1)return{key:s.value.id,render:e=>(0,H.jsx)(Gn,{...e,blockStore:t,inviteTarget:s,permissionItem:i,mostPermissivePermissions:o,spaceVisibleUserMap:x,permissionItemArgs:l,rank:n,tokenQuery:d}),action:()=>{}};{const e=g.mostPermissiveUserPermissions.find((e=>e.permissionItem.user_id===s.value.id));return e?{key:s.value.id,render:n=>(0,H.jsx)(Bt.Z,{...n,itemMarginLeft:0,itemMarginRight:0,title:(0,H.jsx)(pn,{store:t,userPermission:e,showInherited:!0,ignoreLocalHoverState:!0,spaceVisibleUserMap:x,permissionItemArgs:l})}),action:()=>{}}:{key:s.value.id,render:e=>(0,H.jsx)(Gn,{...e,blockStore:t,inviteTarget:s,permissionItem:i,spaceVisibleUserMap:x,permissionItemArgs:l,rank:n,tokenQuery:d}),action:()=>Wn({inviteTarget:s,inviteTargetsStore:h,menuListStore:y,rank:n,tokenQuery:d,environment:f,type:"in_page"})}}}if("group"===a){if(!!o&&o.length>1)return{key:s.value.id,render:o=>(0,H.jsx)(Gn,{...o,blockStore:t,inviteTarget:s,permissionItem:i,mostPermissivePermissions:e.mostPermissivePermissions,spaceVisibleUserMap:x,permissionItemArgs:l,rank:n,tokenQuery:d}),action:()=>{}};{const e=g.mostPermissiveGroupPermissions.find((e=>e.permissionItem.group_id===s.value.id));return e?{key:s.value.id,render:n=>(0,H.jsx)(Bt.Z,{...n,itemMarginLeft:0,itemMarginRight:0,title:(0,H.jsx)(on,{store:t,groupPermission:e,spaceId:t.getSpaceId(),showInherited:!0,permissionItemArgs:l})}),action:()=>{}}:{key:s.value.id,render:e=>(0,H.jsx)(Gn,{...e,blockStore:t,inviteTarget:s,permissionItem:i,spaceVisibleUserMap:x,permissionItemArgs:l,rank:n,tokenQuery:d}),action:()=>Wn({inviteTarget:s,inviteTargetsStore:h,menuListStore:y,rank:n,tokenQuery:d,environment:f,type:"in_page"})}}}(0,Z.t1)(a)}))},E={key:"not in page",render:e=>(0,H.jsx)(Vt.Z,{...e,style:v.sectionMenuItem,title:d.length>0&&(0,H.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.notInPageSection.title",defaultMessage:"Not in page"}),loading:!m}),items:M.map(((e,n)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:n=>(0,H.jsx)(Xn,{...n,invited:!1,inviteTarget:e,isInInviteTargets:Ee.H({target:e,inviteTargetsStore:h}),blockStore:t,spaceVisibleUserMap:x}),action:()=>Wn({inviteTarget:e,inviteTargetsStore:h,menuListStore:y,rank:n,tokenQuery:d,environment:f,type:"not_in_page"})})))};let N=[];return k&&N.push(O),I&&N.push(L),T&&N.push(V),P&&N.push(E),_&&N.push(A),n&&(N=[A],0===A.items.length)?(0,H.jsx)(es,{styles:v}):0===N.length&&(N=[O],0===d.length)?(0,H.jsx)(ts,{styles:v,shouldShowSlackMessage:S}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(yn,{publicPermission:s.mostPermissivePublicItem}),(0,H.jsx)(Dt.Z,{type:Dt.i.Vertical,initialFocus:d.length>0?0:void 0,sections:N,store:y})]})}function Wn(e){const{inviteTarget:t,inviteTargetsStore:n,menuListStore:s,rank:i,tokenQuery:o,environment:a,type:r}=e;if(Ee.H({target:t,inviteTargetsStore:n})){const e=n.state.inviteTargets.filter((e=>"group"===t.type&&"group"===e.type||"existingUser"===t.type&&"existingUser"===e.type?t.value.id!==e.value.id:"newUser"!==t.type||"newUser"!==e.type||t.value.email!==e.value.email));return n.setState({...n.state,inviteTargets:e}),void s.unsetFocus()}F.hE(a,{invite_token_query:o,selected_user_token:t,selected_user_token_rank:i,from:"share_modal_invite",subscription_tier:(0,z.zt)(),type:r}),n.setState({inviteTargets:[...n.state.inviteTargets,t],tokenQuery:""}),s.unsetFocus()}const zn=s.forwardRef((function(e,t){const{blockStore:n,inviteTarget:l,permissionItem:d,mostPermissivePermissions:c,permissionItemArgs:u}=e,p=(0,i.O7)(),g=(0,r.useIntl)(),[f,h]=(0,s.useState)(!1),y=(0,o.VK)((()=>Te.default.state.currentSpaceStore),[]),x=(0,o.VK)((()=>n.getSpaceId()),[n]),S=(0,o.VK)((()=>c&&c.length>0),[c]),v=(0,o.VK)((()=>{if("group"===l.type)return(0,Yt.kF)({group:l.value,intl:g})}),[l,g]),b=(0,o.VK)((()=>{if(y&&"group"===l.type&&l.value.icon)return{pointer:{table:y.table,id:y.id},icon:l.value.icon}}),[y,l]),M=(0,o.VK)((()=>y?"group"!==l.type?0:(0,Yt.rm)({group:l.value,spaceStore:y,limit:void 0}).totalNumberMembers:0),[y,l]),C=(0,s.useCallback)((()=>{if(S){const e=!1===f;h(!f),e&&Ft.dS(p,{share_menu_session_id:j.ZP.state.sessionId,type:"group",group_id:l.value.id})}}),[p,S,f,h,l]),w=(0,a.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:8,paddingBottom:8,marginLeft:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10},permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:P.Z.fontWeight.bold},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:16},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[]);return(0,H.jsx)(Et.Z,{delayThreshold:0,placement:Jt.u.Left,textWrap:!0,style:w.tooltip,renderTooltip:()=>(0,H.jsx)(Hn,{blockStore:n,blockPermissionItem:d}),render:s=>(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("div",{...s,children:(0,H.jsx)(Bt.Z,{...e,...(0,Gt.Z)(e,{onClick:C}),ref:t,title:(0,H.jsxs)("div",{style:w.titleContainer,children:[(0,H.jsx)(Rt.Z,{size:32}),(0,H.jsxs)("div",{style:w.groupInfoContainer,children:[(0,H.jsxs)("div",{style:w.nameAndIconContainer,children:[(0,H.jsx)(m.Z,{style:w.groupNameLabel,children:v}),Boolean(null==b?void 0:b.icon)&&(0,H.jsx)(V.Z,{disabled:!0,bucket:"public",title:v,icon:b,size:18,isEmptyPage:!1})]}),(0,H.jsx)(m.Z,{isSmall:!0,style:w.groupMembersLabel,children:S&&f?(0,H.jsx)($n,{}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,H.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:M}})]})})]})]}),right:(0,H.jsx)(Nt.d,{type:d.type,table:we.iU,disabled:!0,icon:S?f?jt.R:Ct.P:void 0,role:d.role??"none",isRemovable:!1,isCurrentUser:!1,buttonStyle:w.permissionRoleButton})})}),S&&f&&(0,H.jsx)("div",{style:w.expandablePermissionList,children:null==c?void 0:c.map(((e,t)=>{const s=e.permissionItem.type;let i=null;switch(s){case"space_permission":i=(0,H.jsx)(wn,{store:n,spacePermission:e,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":i=(0,H.jsx)(Dn,{store:n,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":i=(0,H.jsx)(on,{spaceId:x,store:n,groupPermission:e,permissionItemArgs:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":case"trusted_domain_permission":case"team_owner_permission":case"team_permission":break;default:(0,Z.t1)(s)}return(0,H.jsx)("div",{style:w.roundedPermissionItem,children:i},t)}))})]})})})),qn=s.forwardRef((function(e,t){const{blockStore:n,inviteTarget:r,permissionItem:l,mostPermissivePermissions:d,spaceVisibleUserMap:c,permissionItemArgs:u}=e,m=(0,i.O7)(),[p,g]=(0,s.useState)(!1),f="existingUser"===r.type?Xt.U6.createChildStore(n,{table:Tt.KJ,id:r.value.id}):void 0,h=(0,o.VK)((()=>"none"===r.spaceRole?qt({spaceVisibleUserMap:c,userId:r.value.id,blockStore:n}):(0,At.K)(r.spaceRole)),[r,c,n]),y=(0,o.VK)((()=>n.getSpaceId()),[n]),x=(0,o.VK)((()=>d&&d.length>0),[d]),S=(0,s.useCallback)((()=>{const e=!1===p;g(!p),e&&Ft.dS(m,{share_menu_session_id:j.ZP.state.sessionId,type:"user",userId:r.value.id})}),[m,p,g,r]),v=(0,a.yK)((e=>({permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:P.Z.fontWeight.bold},cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:24},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[]);return(0,H.jsx)(Et.Z,{delayThreshold:0,placement:Jt.u.Left,textWrap:!0,style:v.tooltip,renderTooltip:()=>(0,H.jsx)(Hn,{blockStore:n,blockPermissionItem:l}),render:s=>(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("div",{...s,children:(0,H.jsx)(Bt.Z,{...e,...(0,Gt.Z)(e,{onClick:S}),ref:t,title:(0,H.jsx)(At.Z,{isLarge:!0,actorStore:f,containerStyle:v.cellMemberAvatarContainer,spaceRole:h,caption:x&&p?(0,H.jsx)($n,{}):void 0}),right:(0,H.jsx)(Nt.d,{type:l.type,table:we.iU,disabled:!0,icon:x?p?jt.R:Ct.P:void 0,role:l.role??"none",isRemovable:!1,isCurrentUser:!1,buttonStyle:v.permissionRoleButton})})}),x&&p&&(0,H.jsx)("div",{style:v.expandablePermissionList,children:null==d?void 0:d.map(((e,t)=>{const s=e.permissionItem.type;let i=null;switch(s){case"space_permission":i=(0,H.jsx)(wn,{store:n,spacePermission:e,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_owner_permission":i=(0,H.jsx)(Un,{store:n,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":i=(0,H.jsx)(Dn,{store:n,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_guest_permission":i=(0,H.jsx)(Fn,{store:n,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":i=(0,H.jsx)(on,{store:n,spaceId:y,groupPermission:e,permissionItemArgs:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":i=(0,H.jsx)(pn,{store:n,userPermission:e,permissionItemArgs:u,spaceVisibleUserMap:c,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":case"trusted_domain_permission":case"team_owner_permission":case"team_permission":break;default:(0,Z.t1)(s)}return(0,H.jsx)("div",{style:v.roundedPermissionItem,children:i},t)}))})]})})})),Gn=s.forwardRef((function(e,t){const{inviteTarget:n}=e,s=n.type;switch(s){case"group":return(0,H.jsx)(zn,{...e,ref:t,inviteTarget:n});case"existingUser":return(0,H.jsx)(qn,{...e,ref:t,inviteTarget:n});default:(0,Z.t1)(s)}}));function Hn(e){const{blockStore:t,blockPermissionItem:n}=e,s=(0,i.O7)(),l=(0,o.VK)((()=>Te.default.state.currentSpaceStore),[]),d=(0,o.VK)((()=>{if(l)return(0,U.Wd)(s,l)}),[s,l]),c=(0,o.VK)((()=>{const e=n.type;if("explicit_team_permission"===e||"explicit_team_owner_permission"===e||"explicit_team_guest_permission"===e){return Xt.zX.createChildStore(t,{table:It.e0,id:n.team_id})}}),[t,n]),u=(0,o.VK)((()=>null==c?void 0:c.getIcon()),[c]),m=(0,a.yK)((()=>({container:{fontWeight:P.Z.fontWeight.bold,...P.Z.textOverflowStyle},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]),p=n.type;return"space_permission"===p?(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.spacePermission.tooltip",defaultMessage:"Everyone at {spaceIconAndName} has access.",values:{spaceIconAndName:(0,H.jsxs)("span",{style:m.container,children:[d&&(0,H.jsx)(V.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:12,style:m.recordIcon}),l&&(0,H.jsx)(Lt.Z,{store:l,style:m.recordTitle})]})}}):"explicit_team_owner_permission"===p?(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamPermission.tooltip",defaultMessage:"Teamspace owners of {teamIconAndName} have access.",values:{teamIconAndName:(0,H.jsxs)("span",{style:m.container,children:[u&&(0,H.jsx)(V.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,H.jsx)(Lt.Z,{store:c,style:m.recordTitle})]})}}):"explicit_team_permission"===p?(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamMemberPermission.tooltip",defaultMessage:"Teamspace members of {teamIconAndName} have access.",values:{teamIconAndName:(0,H.jsxs)("span",{style:m.container,children:[u&&(0,H.jsx)(V.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,H.jsx)(Lt.Z,{store:c,style:m.recordTitle})]})}}):"explicit_team_guest_permission"===p?(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamGuestPermission.tooltip",defaultMessage:"Teamspace guests of {teamIconAndName} have access.",values:{teamIconAndName:(0,H.jsxs)("span",{style:m.container,children:[u&&(0,H.jsx)(V.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,H.jsx)(Lt.Z,{store:c,style:m.recordTitle})]})}}):"group_permission"===p?(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.groupPermission.tooltip",defaultMessage:"This group has access."}):"user_permission"===p||"exclusive_user_permission"===p||"public_permission"===p||"trusted_domain_permission"===p||"restricted_permission"===p||"deleted_permission"===p||"team_permission"===p||"team_owner_permission"===p||"bot_permission"===p?(0,H.jsx)(H.Fragment,{children:kt.YX(n.role??"none")&&(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.userPermission.tooltip",defaultMessage:"This user has access"})}):void(0,Z.t1)(p)}function $n(){return(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.inPageSearchResult.caption",defaultMessage:"Permission from"})}function Yn(e){const{checked:t}=e,n=(0,a.yK)((e=>({circleCheckmark:{display:"flex",justifyContent:"center",alignItems:"center",width:22,height:22,borderRadius:"50%",borderStyle:"solid",borderWidth:1.75,borderColor:t?Pt.ZP.blue:e.buttonPressedBackground,backgroundColor:t?Pt.ZP.blue:"transparent",marginRight:6},checkIcon:{height:12,width:12,color:"white"}})),[t]);return(0,H.jsx)("div",{style:n.circleCheckmark,children:t&&(0,Mt.e)(n.checkIcon)})}const Qn=s.forwardRef((function(e,t){const{inviteTarget:n,isInInviteTargets:s,disabled:i}=e,l=(0,r.useIntl)(),d=(0,o.VK)((()=>Te.default.state.currentSpaceStore),[]),c=(0,o.VK)((()=>(0,Yt.kF)({group:n.value,intl:l})),[n,l]),u=(0,o.VK)((()=>{if(d&&n.value.icon)return{pointer:{table:d.table,id:d.id},icon:n.value.icon}}),[d,n]),p=(0,o.VK)((()=>{if(!d)return 0;return(0,Yt.rm)({group:n.value,spaceStore:d,limit:void 0}).totalNumberMembers}),[d,n]),g=(0,a.yK)((()=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:8,paddingBottom:8,marginLeft:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10}})),[]),f=(0,H.jsxs)("div",{style:g.titleContainer,children:[(0,H.jsx)(Rt.Z,{size:32}),(0,H.jsxs)("div",{style:g.groupInfoContainer,children:[(0,H.jsxs)("div",{style:g.nameAndIconContainer,children:[(0,H.jsx)(m.Z,{style:g.groupNameLabel,children:c}),Boolean(null==u?void 0:u.icon)&&(0,H.jsx)(V.Z,{disabled:!0,bucket:"public",title:c,icon:u,size:18,isEmptyPage:!1})]}),(0,H.jsxs)(m.Z,{isSmall:!0,style:g.groupMembersLabel,children:[(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,H.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:p}})]})]})]});return(0,H.jsx)(Bt.Z,{...e,ref:t,title:f,right:(0,H.jsx)(Yn,{checked:s}),disabled:i})})),Jn=s.forwardRef((function(e,t){const{inviteTarget:n,blockStore:i,isInInviteTargets:r,disabled:l,spaceVisibleUserMap:d,...c}=e,u=(0,a.yK)((()=>({cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},iconBox:{position:"absolute",bottom:-3,right:-3},iconBoxImage:{background:"white",padding:2,borderRadius:"100%"}})),[]),m=(0,o.VK)((()=>"existingUser"===n.type?qt({spaceVisibleUserMap:d,userId:n.value.id,blockStore:i}):void 0),[n,d,i]),p=(0,s.useMemo)((()=>"existingUser"===n.type?{actorStore:Xt.U6.createChildStore(i,{table:Tt.KJ,id:n.value.id}),avatar:void 0}:"newUser"===n.type?{actorStore:void 0,avatar:{email:n.value.email,name:"slack"===n.source?n.value.name:void 0,avatarUrl:"slack"===n.source?n.value.avatar_url:void 0}}:void(0,Z.t1)(n)),[n,i]);return(0,H.jsx)(Bt.Z,{...c,ref:t,title:(0,H.jsx)(At.Z,{isLarge:!0,...p,containerStyle:u.cellMemberAvatarContainer,avatarBadge:"newUser"===n.type&&"slack"===n.source?(0,H.jsx)(pe.Z,{type:"image_url",imageURL:k.Z.images.externalIntegrations.slackIconPng,size:18,style:u.iconBox,imageStyle:u.iconBoxImage}):void 0,spaceRole:m}),disabled:l,right:!l&&(0,H.jsx)(Yn,{checked:r})})})),Xn=s.forwardRef((function(e,t){const{inviteTarget:n,blockStore:s,spaceVisibleUserMap:i}=e,o=n.type;switch(o){case"group":return(0,H.jsx)(Qn,{...e,ref:t,inviteTarget:n});case"newUser":case"existingUser":return(0,H.jsx)(Jn,{...e,ref:t,inviteTarget:n,blockStore:s,spaceVisibleUserMap:i});default:(0,Z.t1)(o)}}));function es(e){const{styles:t}=e;return(0,H.jsxs)("div",{style:t.zeroState,children:[(0,wt._)(t.zeroStateIcon),(0,H.jsxs)("div",{style:t.zeroStateText,children:[(0,H.jsx)("div",{style:{fontWeight:P.Z.fontWeight.semibold,marginBottom:4},children:(0,H.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noImportedContacts.title",defaultMessage:"No contacts found"})}),(0,H.jsx)("div",{children:(0,H.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noImportedContacts.text",defaultMessage:"Try connecting a different Slack workspace or typing an email address"})})]})]})}function ts(e){const{styles:t,shouldShowSlackMessage:n}=e;return(0,H.jsxs)("div",{style:t.zeroState,children:[(0,vt.C)(t.zeroStateIcon),(0,H.jsxs)("div",{style:t.zeroStateText,children:[(0,H.jsx)("div",{style:{fontWeight:P.Z.fontWeight.semibold,marginBottom:4},children:(0,H.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.title",defaultMessage:"Search or add people"})}),(0,H.jsx)("div",{children:n?(0,H.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.text",defaultMessage:"Try connecting a Slack workspace or typing an email address"}):(0,H.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.defaultText",defaultMessage:"Try typing an email address"})})]})]})}function ns(e){let{tokenQuery:t,possibleDomains:n,shouldShowAutoFillEmail:s}=e;const i=(0,yt.ZP)(t,function(e,t,n){return n?Array.from(new Set([...t,"gmail.com","yahoo.com","outlook.com","hotmail.com"])).map(((t,n)=>({tokenQuery:`${e.split("@")[0]}@${t}`,weight:n}))).slice(0,3):[{tokenQuery:e,weight:0}]}(t,n,s),(e=>e.tokenQuery));return 0===i.length?[{tokenQuery:t,weight:0}]:i}function ss(e){let{tokenQuery:t,possibleDomains:n,isGuestInviteRequestRequired:s,shouldShowAutoFillEmail:i,environment:o,inviteTargetsStore:a,menuListStore:l,store:d,styles:c}=e;return ns({tokenQuery:t,possibleDomains:n,shouldShowAutoFillEmail:i}).map(((e,n)=>({key:e.tokenQuery,render:t=>(0,H.jsx)(Bt.Z,{icon:(0,St.a)({width:24,height:24}),title:(0,H.jsx)(is,{tokenQuery:e.tokenQuery,shouldShowAutofillEmail:i,isGuestInviteRequestRequired:s}),caption:s?(0,H.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.requestNewUser.buttonItem.caption",defaultMessage:"Workspace owners are required to view and approve guest invites"}):void 0,right:(0,H.jsx)(H.Fragment,{children:i?(0,bt.y)(c.arrowUpLeftIcon):null}),rightStyle:{marginRight:4},...t}),action:async()=>{const s=(0,Be.H3)(e.tokenQuery);if(!(0,Be.oH)(s)){const t={type:"invalidUser",value:{text:e.tokenQuery}};return void(Ee.H({target:t,inviteTargetsStore:a})||a.setState({inviteTargets:[...a.state.inviteTargets,t],tokenQuery:""}))}const i=await _t.M5(o,[s]);if(!i.length)return;const r=i[0];Ee.H({target:r,inviteTargetsStore:a})||(F.hE(o,{invite_token_query:t,selected_user_token:r,selected_user_token_rank:n,from:"share_modal_invite",subscription_tier:(0,z.zt)(),type:"autofill"}),a.setState({inviteTargets:[...a.state.inviteTargets,r],tokenQuery:""}),l.unsetFocus())}})))}function is(e){const{tokenQuery:t,shouldShowAutofillEmail:n,isGuestInviteRequestRequired:s}=e;return s?(0,H.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.requestNewUser.buttonItem",defaultMessage:"Request {tokenQuery} as a guest",values:{tokenQuery:t}}):n?(0,H.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem.v1",defaultMessage:"”{tokenQuery}”",values:{tokenQuery:t}}):(0,H.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem",defaultMessage:"Invite {tokenQuery}",values:{tokenQuery:t}})}const os=function(e){const t=(0,i.O7)(),n=(0,r.useIntl)(),[a,l]=(0,s.useState)(!0),d=(0,o.VK)((()=>e.inviteTargetsStore.state.tokenQuery),[e.inviteTargetsStore]),c=(0,o.VK)((()=>{if(e.shouldShowSlackOnly)return{userLimit:0,botLimit:0,groupLimit:0,importContactLimit:e.sectionRenderLimit};const t=ct.Z.completeSlackAuthentications.state.length>0&&Me.Rv();return{userLimit:e.sectionRenderLimit,botLimit:0,groupLimit:e.shouldShowGroups?e.sectionRenderLimit:0,importContactLimit:t?e.sectionRenderLimit:0}}),[e.sectionRenderLimit,e.shouldShowGroups,e.shouldShowSlackOnly]),[{value:u,status:m}]=(0,xt.r5)((async()=>_t.jL({query:d,sectionLimit:c,membersOnly:e.membersOnly,environment:t,intl:n}).finally((()=>l(!1)))),[t,n,e.membersOnly,d,c],{debounce:40});return(0,H.jsx)(Kn,{...e,tokenQuery:d,showShimmer:a,ready:"pending"!==m,error:"rejected"===m,result:u})};function as(e){const t=(0,i.O7)(),n=ls(),a=(0,o.qz)(e.inviteTargetsStore,re.ZP),r=(0,o.VK)((()=>a.state.inviteTargets),[a]),{display:l,source:d,focus:c,emailMessage:u}=(0,o.VK)((()=>{const{display:e}=j.ZP.state;return e===j.wV.Invite?j.ZP.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),m=(0,o.VK)((()=>Te.default.state.currentSpaceStore),[]),p=(0,o.VK)((()=>d===j.T5.Notion&&0===r.length&&(0,Me.Rv)()),[r.length,d]),g=(0,o.VK)((()=>ct.Z.completeSlackAuthentications.state),[]),f=(0,s.useCallback)((()=>{a.reset()}),[a]),[h,y]=(0,s.useState)(!1);(0,s.useEffect)((()=>{if(m&&!h&&p){for(const e of g)rt.loadContacts(t,{botId:e.id,spaceId:m.id,integrationId:at.nO}).catch((e=>{}));y(!0)}}),[p]);const x=l===j.wV.Invite&&r.length>0;return l!==j.wV.Invite?null:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(lt.Z,{type:dt.Z.Y,style:n.scroller,children:(0,H.jsx)(os,{inviteTargetsStore:a,store:e.store,menuListStore:e.menuListStore,shouldShowGroups:!0,shouldShowSlackOnly:d===j.T5.Slack,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs})}),p&&(0,H.jsx)(ht.Z,{onClickAuthenticated:()=>{j.ZP.setState({...j.ZP.state,tab:j.XF.Share,display:j.wV.Invite,focus:j.Sw.Search,source:j.T5.Slack,emailMessage:u}),a.setState({...a.state,tokenQuery:""})},title:(0,H.jsx)(rs,{}),containerStyle:n.importContactsContainer,buttonStyle:n.importContactsButton,from:"share_menu",inviteOrigin:"page_share_modal",flowId:e.flowId,loadContacts:!0}),(0,H.jsx)(ft,{open:x&&!p,focus:c===j.Sw.Message,value:u,onFocus:()=>{d&&l===j.wV.Invite&&j.ZP.setState({...j.ZP.state,focus:j.Sw.Message,tab:j.XF.Share,display:l,source:d,emailMessage:u})},onChange:e=>{j.ZP.setState({...j.ZP.state,focus:c,tab:j.XF.Share,display:l,source:d,emailMessage:e.target.value})},onCancel:async()=>{await ut.zd({environment:t,inviteTargetsStore:a})&&(ut.a6(t),f())},maxLength:1e3})]})}function rs(){const e=ls(),t=(0,H.jsxs)("div",{style:e.integrationName,children:[(0,H.jsx)(pe.Z,{type:"image_url",imageURL:k.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:e.integrationIcon}),(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Slack",id:"importContactsButton.integrationName"})]});return(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Add contacts from {integrationNameWithLogo}",id:"importContactsButton.integrationButton.label",values:{integrationNameWithLogo:t}})}function ls(){return(0,a.yK)((e=>({scroller:{flexGrow:1},integrationName:{display:"flex"},integrationIcon:{marginRight:4},importContactsContainer:{height:36,bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9}})),[])}var ds=n(207567),cs=n(99340),us=n(699884),ms=n(969098),ps=n(642499),gs=n(382914),fs=n(893586),hs=n(938872);function ys(e){const{email:t}=e;return(0,H.jsx)(ln.Z,{avatar:{email:t},size:28})}function xs(e){const{children:t}=e,n=(0,a.yK)((()=>({wrapper:{position:"relative"},shield:{position:"absolute",left:17,top:18}})),[]);return(0,H.jsxs)("div",{style:n.wrapper,children:[t,(0,H.jsx)("div",{style:n.shield,children:(0,H.jsx)(et.x,{iconGroup:hs.t,colorName:"secondary",variantName:"mini"})})]})}function Ss(e){const{rows:t,internalDomains:n}=e,s=(0,a.yK)((e=>({inviteTargetList:{background:e.surface.wash,borderRadius:12,maxHeight:227,overflowY:"auto",padding:"12px 16px",width:"100%"}})),[]);return(0,H.jsx)(lt.Z,{type:dt.Z.Y,style:s.inviteTargetList,children:(0,H.jsx)(_.jX,{gap:16,children:t.map((e=>{const{type:t}=e;switch(t){case"new":return(0,H.jsx)(vs,{email:e.email,internalDomains:n},e.email);case"existing":return(0,H.jsx)(bs,{userStore:e.userStore,internalDomains:n},e.userStore.id);default:(0,Z.t1)(t)}}))})})}function vs(e){const{email:t,internalDomains:n}=e,s=(0,Re.is)(t,n);return(0,H.jsx)(Ms,{avatar:s?(0,H.jsx)(xs,{children:(0,H.jsx)(ys,{email:t})}):(0,H.jsx)(ys,{email:t}),name:t,email:t})}function bs(e){const{userStore:t,internalDomains:n}=e,s=(0,r.useIntl)(),{name:i,email:a}=(0,o.VK)((()=>({name:t.getDisplayName(s),email:t.getEmail()})),[t,s]);if(!i||!a)return null;const l=(0,Re.is)(a,n);return(0,H.jsx)(Ms,{avatar:l?(0,H.jsx)(xs,{children:(0,H.jsx)(ln.Z,{userStore:t,size:28})}):(0,H.jsx)(ln.Z,{userStore:t,size:28}),name:i,email:a})}function Ms(e){const{avatar:t,name:n,email:s}=e;return(0,H.jsxs)(_.jX,{direction:"row",gap:10,align:"center-left",children:[t,(0,H.jsxs)(_.jX,{gap:2,children:[(0,H.jsx)(D.q,{styleName:"Body-14px/Medium",children:n}),(0,H.jsx)(D.q,{styleName:"Caption-12px/Regular",colorName:"secondary",children:s})]})]})}function js(e){const{type:t}=e;switch(t){case"new":return e.email;case"existing":return e.userStore.getEmail();default:(0,Z.t1)(t)}}function Cs(e){const{inviteUserListRows:t,spaceStore:n,spaceUserStore:a,onClickAddMembers:l,onClickManageGuests:d}=e,c=(0,i.O7)(),u=(0,r.useIntl)(),[m,p]=(0,o.VK)((()=>[n.id,n.getName()]),[n]),g=(0,o.VK)((()=>null==a?void 0:a.id),[a]),f=(0,o.VK)((()=>fs.Z.getData(c,{spaceId:m})),[c,m]),h=(0,ze.oo)({name:"internal_guests",spaceId:m,spaceUserId:g,amount:0}),y=(0,s.useCallback)((()=>{const e=t.map(js).filter(Z.$K);l(e)}),[t,l]);return h&&f?(0,H.jsx)(Oe.Z,{debugName:"AddAsMembersModalContent",capture:!0,onEnter:y,children:(0,H.jsx)(gs.sR,{header:(0,H.jsx)(gs.vI,{iconAndTitle:(0,H.jsx)(gs.kC,{iconGroup:ps.G,iconColorName:"secondary",title:u.formatMessage(ks.title,{spaceName:p,guestLimit:h.limit.total})}),description:u.formatMessage(ks.description,{domain:f[0].url,p:e=>(0,H.jsx)(D.q,{colorName:"uiBluePrimary",children:(0,H.jsx)("p",{children:e})})})}),footer:(0,H.jsx)(ws,{rowCount:t.length,onClickAddMembers:y,onClickManageGuests:d}),children:(0,H.jsx)(Ss,{rows:t,internalDomains:f})})}):null}function ws(e){const{rowCount:t,onClickAddMembers:n,onClickManageGuests:s}=e,i=(0,r.useIntl)(),o=i.formatMessage(ks.addMember,{rowCount:t});return(0,H.jsxs)(_.jX,{gap:16,children:[(0,H.jsxs)(_.jX,{gap:8,children:[(0,H.jsx)(L.Z,{"aria-label":o,onClick:n,style:{height:32},children:o}),(0,H.jsx)(O.Z,{"aria-label":i.formatMessage(ks.manageGuestsInSettings),onClick:s,children:i.formatMessage(ks.manageGuestsInSettings)})]}),(0,H.jsx)("div",{style:{textAlign:"center"},children:(0,H.jsx)(D.q,{styleName:"Caption-12px/Regular",colorName:"secondary",children:i.formatMessage(ks.billingNotice)})})]})}const ks=(0,r.defineMessages)({title:{id:"addAsMembersModal.title",defaultMessage:"{spaceName} is over the guest limit of {guestLimit}"},description:{id:"addAsMembersModal.description",defaultMessage:"Shares to work email domains ending with ‘@{domain}’ must be added as members with access to your entire workspace."},upgradeButton:{id:"addAsMembersModal.addMembersButton",defaultMessage:"{guestCount, plural, one {Add as member} other {Add as {guestCount} members}}"},addMember:{id:"addAsMembersModal.addMember",defaultMessage:"Add {rowCount, plural, one {member} other {{rowCount} members}}"},manageGuestsInSettings:{id:"addAsMembersModal.manageGuestsInSettings",defaultMessage:"Manage guests in settings"},billingNotice:{id:"addAsMembersModal.billingNotice",defaultMessage:"Each new member will be billed as an additional seat"}});n(21703);var Is=n(937850),Ts=n(164964),Zs=n(924211),Ps=n(476464),Fs=n(433929);async function _s(e){const{environment:t,email:n}=e,s=await rt.findUser(t,{email:n});if("success"===s.type){const e=s.data;if(e.value)return e.value.value.id}return await async function(e){const{environment:t,email:n}=e,s=await rt.createEmailUser(t,{email:n,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:(0,Zs.E2)(Fs.default.getIntl())});if("failed"===s.type)throw s.error;return s.data.userId}({environment:t,email:n})}async function As(e){const{blockPermissionItem:t,blockStore:n,environment:s,metadata:i,sudoModeStore:o}=e;await Ps.pk({environment:s,store:n,sudoModeStore:o,permissionItems:[t],invite:i,skipGuestLimitValidation:!0})}var Bs=n(215010);function Rs(e){const{environment:t,internalDomains:n,inviteResults:s,destination:i,metadata:o}=e;0!==s.length&&(function(e){var t;const{addedPermissions:n,environment:s,internalDomains:i,metadata:o,destination:a}=e;if(0===n.length)return;const r=n.map((e=>e.invite.inviteTarget)),l=n.map((e=>e.blockPermissionItem)),d=n.filter(Ls).filter((e=>void 0!==e.invite.internalDomain)).map((e=>e.inviteeUserId));F.jB(s,{domainType:(0,Bs.JF)(),internal_domains:i??[],invite_flow_id:o.inviteFlowId,invite_message_length:(null===(t=o.inviteMessage)||void 0===t?void 0:t.length)??0,invite_origin:o.inviteOrigin,invite_targets:r,invitee_ids_with_internal_domain:d,invitee_ids_with_internal_domain_enforced:[],is_onboarding:!1,is_space:!1,permission_items:l,role:a.blockRole,share_menu_session_id:o.shareMenuSessionId})}({addedPermissions:s.filter(Vs),environment:t,internalDomains:n,destination:i,metadata:o}),function(e){var t;const{createdMembers:n,environment:s,internalDomains:i,metadata:o,destination:a}=e;if(0===n.length)return;const r=n.map((e=>e.invite.inviteTarget)),l=n.map((e=>e.spacePermissionItem)),d=n.filter((e=>void 0!==e.invite.internalDomain)).map((e=>e.inviteeUserId)),c=n.filter((e=>e.wasInternalDomainEnforced)).map((e=>e.inviteeUserId));if(F.jB(s,{domainType:(0,Bs.JF)(),internal_domains:i??[],invite_flow_id:o.inviteFlowId,invite_message_length:(null===(t=o.inviteMessage)||void 0===t?void 0:t.length)??0,invite_origin:o.inviteOrigin,invite_targets:r,invitee_ids_with_internal_domain:d,invitee_ids_with_internal_domain_enforced:c,is_onboarding:!1,is_space:!0,permission_items:l,role:a.spaceRole,share_menu_session_id:o.shareMenuSessionId}),c.length>0){const e=i?i.map((e=>e.url)):[];F.oI(s,{invite_flow_id:o.inviteFlowId,invite_origin:o.inviteOrigin,user_ids:c,internal_domains:e})}}({createdMembers:s.filter(Es),environment:t,internalDomains:n,destination:i,metadata:o}),function(e){const{createdGuestRequests:t,environment:n,destination:s,metadata:i}=e;if(0===t.length)return;const o=t.filter((e=>void 0!==e.invite.internalDomain)).map((e=>{var t;return null===(t=e.invite.invitee)||void 0===t?void 0:t.email})).filter(Z.$K);F.zx(n,{internal_guest_enforcement:!1,invite_flow_id:i.inviteFlowId,is_bot:!1,is_internal_domain:o.length>0,invitee_emails_with_internal_domain:o,invitee_emails_with_internal_domain_enforced:[],role:s.blockRole,space_role:s.spaceRole,user_count:t.length})}({createdGuestRequests:s.filter(Ds),environment:t,destination:i,metadata:o}),function(e){const{createdMemberRequests:t,environment:n,destination:s,metadata:i}=e;if(0===t.length)return;const o=t.filter((e=>void 0!==e.invite.internalDomain)).map((e=>{var t;return null===(t=e.invite.invitee)||void 0===t?void 0:t.email})).filter(Z.$K),a=t.filter((e=>e.wasInternalDomainEnforced)).map((e=>{var t;return null===(t=e.invite.invitee)||void 0===t?void 0:t.email})).filter(Z.$K);F.d(n,{from:"share_menu",invite_flow_id:i.inviteFlowId,invite_space_role_selection:v.uq.workspace_member,is_bot:!1,is_internal_domain:o.length>0,internal_guest_enforcement:a.length>0,invitee_emails_with_internal_domain:o,invitee_emails_with_internal_domain_enforced:a,role:s.blockRole,space_role:s.spaceRole,user_count:t.length})}({createdMemberRequests:s.filter(Os),environment:t,destination:i,metadata:o}))}function Ds(e){return"createdGuestRequest"===e.type}function Os(e){return"createdMemberRequest"===e.type}function Ls(e){return"addedUserPermission"===e.type}function Vs(e){return!(!Ls(e)&&!function(e){return"addedGroupPermission"===e.type}(e))}function Es(e){return"createdMember"===e.type}async function Ns(e){const{environment:t,intl:n,internalDomains:s,destination:i,invites:o,metadata:a,sudoModeStore:r}=e,l=await async function(e){const{environment:t,invites:n,destination:s,metadata:i,sudoModeStore:o}=e,a=await(0,Is.Lc)(n,20,(e=>async function(e){const{invite:t}=e,{defaultAddability:n}=t;switch(n.type){case"none":break;case"member":return await async function(e){const{environment:t,invite:n,destination:s,metadata:i}=e,{invitee:o,defaultAddability:a}=n;if(void 0===o)throw new Error("Expected invite.invitee to be defined");const{email:r}=o,{blockRole:l,blockStore:d,spaceRole:c,spaceStore:u}=s,{inviteOrigin:m}=i,p=await _s({environment:t,email:r});if(!p)return;const g={type:"user_permission",role:c,user_id:p},f={type:"user_permission",role:l,user_id:p};await async function(e){const{blockPermissionItem:t,blockStore:n,environment:s,inviteOrigin:i,spacePermissionItem:o,spaceStore:a,sudoModeStore:r}=e;if(t.user_id!==o.user_id)throw new Error("User IDs for block and space permission items must match");if(a.getSubscriptionTier(),(0,K.$)(s)&&!(await q.HD({environment:s,flowId:"",trackCreateTeamComplete:!1})))return;await Promise.all([Ps.pk({environment:s,store:a,sudoModeStore:r,permissionItems:[o],invite:{inviteOrigin:i}}),Ps.pk({environment:s,store:n,sudoModeStore:r,permissionItems:[t],skipGuestLimitValidation:!0,invite:{inviteOrigin:i}})])}({blockPermissionItem:f,blockStore:d,environment:t,inviteOrigin:m,spacePermissionItem:g,spaceStore:u});const h="member"===a.type&&"over_internal_guest_limit"===a.reason;return{type:"createdMember",invite:n,inviteeUserId:p,spacePermissionItem:g,blockPermissionItem:f,wasInternalDomainEnforced:h}}(e);case"member_request":return await async function(e){const{environment:t,invite:n,destination:s,metadata:i}=e,{invitee:o,internalDomain:a}=n;if(void 0===o)throw new Error("Expected invite.invitee to be defined");const{email:r}=o,{spaceStore:l}=s,{inviteMessage:d}=i,c=await _s({environment:t,email:r});if(!c)return;await async function(e){const{environment:t,spaceStore:n,inviteeUserId:s,inviteMessage:i}=e;if(n.canAdmin())throw new Error("This operation is not valid for workspace owners, because member requests are immediately approved when created by a workspace owner. Use createMember instead.");const o=await rt.requestAccess(t,{type:"actor-to-space",forActorId:s,spaceId:n.id,message:i});if("failed"===o.type)throw o.error}({environment:t,inviteeUserId:c,inviteMessage:d,spaceStore:l});const u=void 0!==a;return{type:"createdMemberRequest",invite:n,wasInternalDomainEnforced:u}}(e);case"guest":case"guest_page_add":case"member_page_add":return await async function(e){const{environment:t,invite:n,destination:s,metadata:i,sudoModeStore:o}=e,{invitee:a}=n;if(void 0===a)throw new Error("Expected invite.invitee to be defined");const{email:r}=a,{blockRole:l,blockStore:d}=s,c=await _s({environment:t,email:r});if(!c)return;const u={type:"user_permission",role:l,user_id:c};return await As({blockPermissionItem:u,blockStore:d,environment:t,metadata:i,sudoModeStore:o}),{type:"addedUserPermission",invite:n,inviteeUserId:c,blockPermissionItem:u}}(e);case"guest_request":return await async function(e){const{environment:t,invite:n,destination:s,metadata:i}=e;if(void 0===n.invitee)throw new Error("Expected invite.invitee to be defined");const{email:o}=n.invitee,{blockRole:a,blockStore:r,spaceStore:l}=s,{inviteMessage:d}=i,c={id:r.id,spaceId:l.id},u=await _s({environment:t,email:o});if(!u)return;return await async function(e){const{block:t,blockRole:n,environment:s,inviteeUserId:i,inviteMessage:o}=e,a=await rt.requestAccess(s,{type:"guest-invite-request",block:t,forActorId:i,message:void 0,attributes:{role:n,inviteMessage:o}});if("failed"===a.type)throw a.error}({block:c,blockRole:a,environment:t,inviteeUserId:u,inviteMessage:d}),{type:"createdGuestRequest",invite:n}}(e);case"group":return await async function(e){const{environment:t,invite:n,destination:s,metadata:i,sudoModeStore:o}=e,{blockRole:a,blockStore:r}=s;if("group"!==n.inviteTarget.type)throw new Error("Expected invite.inviteTarget to be a group");const l=n.inviteTarget.value,d={type:"group_permission",role:a,group_id:l.id};return await As({blockPermissionItem:d,blockStore:r,environment:t,metadata:i,sudoModeStore:o}),{type:"addedGroupPermission",invite:n,group:l,blockPermissionItem:d}}(e);default:(0,Z.t1)(n)}}({environment:t,invite:e,destination:s,metadata:i,sudoModeStore:o})));return a.filter(Z.$K)}({destination:i,environment:t,invites:o,metadata:a,sudoModeStore:r});Rs({destination:i,environment:t,internalDomains:s,inviteResults:l,metadata:a}),o.length>0&&Ts.oV({label:n.formatMessage({id:"shareMenu.inviteResultsToast.label",defaultMessage:"Successfully sent"})})}function Us(e){e.reset(),j.ZP.setState({...j.ZP.state,tab:j.XF.Share,display:j.wV.MainShareMenu})}async function Ks(e){const{addAsMembersResult:t,destination:n,environment:s,internalDomains:i,intl:o,invites:a,inviteTargetsStore:r,metadata:l}=e;var d;t&&("manageGuests"===t?(d="members",nt.Z.setState({currentTab:d,defaultSubtab:void 0,highlightedSetting:void 0,open:!0,openedFrom:"share_menu"})):"addMembers"===t?(Us(r),await Ns({destination:n,environment:s,internalDomains:i,invites:a,intl:o,metadata:l})):(0,Z.t1)(t))}async function Ws(e){const{destination:t,contextualInviteStore:n,defaultAddabilities:s,metadata:i,invites:o,environment:a,internalDomains:r,intl:l,inviteTargetsStore:d,spaceStore:c,spaceUserStore:u,sudoModeStore:m}=e,p=o.map((e=>e.defaultAddability)).some((e=>"member"===e.type&&"over_internal_guest_limit"===e.reason)),g=o.map((e=>e.defaultAddability)).some((e=>["guest","guest_request","guest_page_add"].includes(e.type)));if(p){const e=o.map((e=>function(e){const{inviteTarget:t,environment:n}=e,{type:s}=t;switch(s){case"existingUser":return{type:"existing",userStore:new Xt.U6(n,{table:Tt.KJ,id:t.value.id})};case"newUser":return{type:"new",email:t.value.email};case"group":return;default:(0,Z.t1)(s)}}({environment:a,inviteTarget:e.inviteTarget}))).filter(Z.$K),n=await async function(e){const{inviteUserListRows:t,spaceStore:n,spaceUserStore:s}=e;return await ms.o.showAsyncModal((e=>(0,H.jsx)(us.c,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,areaConstraint:{width:{type:"fixed",length:400}},render:()=>(0,H.jsx)(Cs,{inviteUserListRows:t,spaceStore:n,spaceUserStore:s,onClickAddMembers:()=>{e.resolve("addMembers")},onClickManageGuests:()=>{e.resolve("manageGuests")}})})))}({inviteUserListRows:e,spaceStore:c,spaceUserStore:u});await Ks({addAsMembersResult:n,destination:t,environment:a,internalDomains:r,intl:l,invites:o,inviteTargetsStore:d,metadata:i})}else{Us(d),await Ns({destination:t,environment:a,internalDomains:r,intl:l,invites:o,metadata:i,sudoModeStore:m});const e=o.map((e=>e.invitee)).filter(Z.$K);g&&function(e){const{contextualInviteStore:t,defaultAddabilities:n,environment:s,invitees:i,spaceStore:o}=e,a=i.filter((e=>function(e){const t=e.type;return["guest","guest_request","guest_page_add"].includes(t)}(n[e.email]))).map((e=>({email:e.email,isGuest:"member"!==(null==e?void 0:e.currentRole)})));t.setState({...t.state,invitedUsers:a,callbackAsyncFn:void 0,resetShareMenuFn:void 0}),N.fr({environment:s,spaceStore:o,contextualInviteStore:t})}({contextualInviteStore:n,environment:a,spaceStore:c,defaultAddabilities:s,invitees:e})}}function zs(e){const{tooltip:t,disabled:n,onClick:s}=e;return(0,H.jsx)(Et.Z,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,H.jsx)(L.Z,{isLarge:!0,style:{marginLeft:8},disabled:n,onClick:s,...e,children:(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.invite",defaultMessage:"Invite"})})})}var qs=n(653965),Gs=n(711985),Hs=n(147082),$s=n(88411),Ys=n(679956),Qs=n(493535);const Js=(0,gn.CZ)("globe",{default:{loader:()=>n.e(5978).then(n.bind(n,705978)),size:20},small:{loader:()=>n.e(17024).then(n.bind(n,517024)),size:16},mini:{loader:()=>n.e(11545).then(n.bind(n,511545)),size:14},large:{loader:()=>n.e(62669).then(n.bind(n,462669)),size:24}}),Xs=(0,gn.CZ)("xmark",{default:{loader:()=>n.e(45377).then(n.bind(n,45377)),size:20},small:{loader:()=>n.e(60200).then(n.bind(n,560200)),size:16},mini:{loader:()=>n.e(64137).then(n.bind(n,64137)),size:14},large:{loader:()=>n.e(3825).then(n.bind(n,103825)),size:24}});var ei=n(526774),ti=n(959753);const ni=(0,r.defineMessages)({autojoinMember:{defaultMessage:"{email} will automatically be added to the workspace since @{domain} is an allowed email domain",id:"inviteTargetToken.autojoinMember.tooltip"},guestsDisabledMember:{defaultMessage:"Since guests are disabled, {email} will automatically be added to the workspace as a member",id:"inviteTargetToken.guestsDisabledMember.tooltip"},guest:{defaultMessage:"{email} will be invited as a guest",id:"inviteTargetToken.guest.tooltip"},guestRequest:{id:"inviteTargetToken.guestRequest.tooltip",defaultMessage:"This guest must be approved by a workspace owner first"},invalidUser:{defaultMessage:"{text} is not a valid email",id:"inviteTargetToken.invalidUser.tooltip"}});function si(e){const{inviteTarget:t,defaultAddability:n,onClickRemove:i}=e,o=function(e,t){if("group"===e.type)return"gray";if("invalidUser"===e.type)return"red";if("existingUser"!==e.type&&"newUser"!==e.type)return(0,Z.t1)(e);if(void 0===t)return"red";if("member"===t.type)return"autojoin_domain"===t.reason||"guests_disabled"===t.reason?"green":"over_internal_guest_limit"===t.reason?"yellow":(0,Z.t1)(t.reason);if("member_request"===t.type)return"yellow";if("member_page_add"===t.type)return"gray";if("guest"===t.type)return"yellow";if("guest_request"===t.type)return"yellow";if("guest_page_add"===t.type)return"yellow";if("none"===t.type){if("other"===t.reason)return"red";if("must_upgrade"===t.reason)return"yellow";(0,Z.t1)(t.reason)}else(0,Z.t1)(t)}(t,n),a=(0,r.useIntl)(),l=oi(o),d=(0,s.useCallback)((()=>{i(t)}),[t,i]),c=function(e){const{inviteTarget:t,defaultAddability:n,intl:s}=e,i=He(t),o=t.type;if("group"===o)return;if("invalidUser"===o)return s.formatMessage(ni.invalidUser,{text:t.value.text});if(!i)return;if("existingUser"!==o&&"newUser"!==o)return(0,Z.t1)(o);if(void 0===n)return;if("none"===n.type)return;if("member"===n.type)return"autojoin_domain"===n.reason?s.formatMessage(ni.autojoinMember,{email:i,domain:(0,Be.Gd)(i)}):"guests_disabled"===n.reason?s.formatMessage(ni.guestsDisabledMember,{email:i}):"over_internal_guest_limit"===n.reason?i:(0,Z.t1)(n.reason);if("member_request"===n.type)return i;if("member_page_add"===n.type)return i;if("guest"===n.type)return s.formatMessage(ni.guest,{email:i});if("guest_request"===n.type)return s.formatMessage(ni.guestRequest);if("guest_page_add"===n.type)return s.formatMessage(ni.guest,{email:i});(0,Z.t1)(n)}({inviteTarget:t,defaultAddability:n,intl:a});return(0,H.jsx)(Et.Z,{placement:Jt.u.Top,renderTooltip:()=>c,disableTooltip:!c,render:e=>(0,H.jsx)("div",{style:{maxWidth:"100%"},...e,children:(0,H.jsxs)(_.jX,{gap:2,style:l.token,borderRadius:3,padding:"2px 4px",width:"hug",children:[(0,H.jsxs)(_.jX,{align:"center-left",borderRadius:3,direction:"row",gap:4,width:"hug",children:[(0,H.jsx)(ii,{inviteTarget:t,tokenColor:o}),(0,H.jsx)(D.q,{colorName:ai(o),styleName:"UIRegular-14px/Regular",customStyles:l.label,children:ci(t,a)}),(0,H.jsx)(A.Z,{hoveredStyle:l.removeButtonHovered,pressedStyle:l.removeButtonPressed,onClick:d,children:(0,H.jsx)(et.x,{iconGroup:Xs,colorName:"secondary",variantName:"mini"})})]}),(0,H.jsx)(We,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,H.jsx)("div",{style:{marginLeft:24,paddingBottom:2},children:(0,H.jsx)(D.q,{colorName:"secondary",styleName:"UISmall-12px/Medium",children:null==n?void 0:n.type})}),whenDisabled:null})]})})})}function ii(e){const{inviteTarget:t,tokenColor:n}=e,s=oi(n);switch(n){case"green":return(0,H.jsx)(et.x,{iconGroup:Ys.F,colorName:"green",variantName:"default"});case"yellow":return(0,H.jsx)(et.x,{iconGroup:Js,colorName:"yellow",variantName:"default"});case"red":return(0,H.jsx)(et.x,{iconGroup:Qs.x,colorName:"uiRedPrimary",variantName:"default"});case"gray":return"existingUser"===t.type?(0,H.jsx)(_.jX,{align:"center",width:20,height:20,children:(0,H.jsx)(ln.Z,{userValue:t.value,size:16})}):(0,H.jsx)("div",{style:s.iconCircle,children:(0,ei.O)(s.icon)});default:(0,Z.t1)(n)}}function oi(e){return(0,a.yK)((t=>({token:ri(e,t),iconCircle:{alignItems:"center",backgroundColor:t.white,borderRadius:"50%",display:"flex",height:16,justifyContent:"center",width:16},icon:{color:t.icon.secondary,height:12,width:12},label:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},removeButtonHovered:{background:"transparent",opacity:.8},removeButtonPressed:{background:"transparent",opacity:.6}})),[e])}function ai(e){switch(e){case"green":return"green";case"yellow":return"yellow";case"red":return"uiRedPrimary";case"gray":return"primary";default:(0,Z.t1)(e)}}function ri(e,t){return{background:li(e,t),border:di(e,t)}}function li(e,t){switch(e){case"green":return t.fill.green;case"yellow":return t.fill.yellow;case"red":return t.tint.uiRed;case"gray":return t.legacyDefaultSelectColor;default:(0,Z.t1)(e)}}function di(e,t){switch(e){case"red":return`1px dashed ${t.stroke.uiRed}`;case"green":case"yellow":case"gray":return;default:(0,Z.t1)(e)}}function ci(e,t){const{type:n}=e;switch(n){case"newUser":return e.value.email.trim();case"invalidUser":return e.value.text.trim();case"existingUser":return ti.kk.fromValue(Tt.KJ,e.value).getDisplayName(t);case"group":return(0,Yt.kF)({intl:t,group:e.value});default:(0,Z.t1)(n)}}function ui(e){const{addabilities:t,disabled:n,metadata:r,focus:l,onFocus:d,onInputChanged:c,onSubmit:u,placeholder:m,right:p,showEmptyError:g}=e,f=(0,i.O7)(),h=(0,i.Fy)(),y=function(e){const{focus:t,disabled:n,tokens:s}=e;return(0,a.yK)((e=>({tokenSpan:{maxWidth:"100%"},tokenInputMenuItem:{paddingTop:s.length>0?4:6,paddingLeft:4,paddingRight:4,paddingBottom:4,borderRadius:4,minHeight:32,...t&&{background:"none"},...n&&{background:e.inputBackground,color:e.mediumTextColor,fill:Pt.ZP.white,opacity:.4}},inputAndTokenWrapRight:{gap:2},tokenInputMenuItemInput:{paddingTop:0},warningMessage:{color:"#DE5550"}})),[t,n,s])}({focus:l,disabled:n,tokens:[]}),x=(0,o.qz)(e.inviteTargetsStore,re.ZP),S=(0,o.VK)((()=>x.state.inviteTargets),[x]),v=(0,o.VK)((()=>x.state.tokenQuery),[x]),b=(0,s.useCallback)((e=>{Gs.P({inviteTargetsStore:x,targetToRemove:e})}),[x]);return S?(0,H.jsx)(Hs.ZP,{focus:l,focusAfterAnimation:!0,onClick:()=>{h.isMobile||null==d||d()},format:Hs.UR.Share,value:v,onChange:e=>Gs.j({environment:f,event:e,inviteTargetsStore:x,inviteOrigin:r.inviteOrigin,flowId:r.inviteFlowId,onInputChanged:c}),type:"email",tokens:S.map(((e,n)=>(0,H.jsx)(si,{inviteTarget:e,onClickRemove:b,defaultAddability:mi(e,t)},n))),disabled:n,autoComplete:"off",placeholder:m,onRemoveLastToken:()=>{x.setState({...x.state,inviteTargets:x.state.inviteTargets.slice(0,-1)})},right:p,showBorder:!0,inputStyle:y.tokenInputMenuItemInput,inputAndTokenWrapRightStyle:y.inputAndTokenWrapRight,style:y.tokenInputMenuItem,onSubmit:u,inputFullWidth:!0,message:(0,H.jsx)($s.z,{invalidInvites:(0,qs.oA)(S.map((e=>"invalidUser"===e.type?e:void 0))),showEmptyError:g,styles:y.warningMessage})}):null}function mi(e,t){const n=He(e);if(n)return null==t?void 0:t[n]}var pi=n(544385);function gi(e){const{onClick:t,featureAvailability:n}=e;return(0,H.jsx)(Et.Z,{disableTooltip:!1,renderTooltip:()=>(0,H.jsx)(pi.e,{featureAvailability:n}),render:e=>(0,H.jsx)(L.Z,{isLarge:!0,style:{marginLeft:8},onClick:t,...e,children:(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade"})})})}const fi=1e3;function hi(e){const{blockStore:t,contextualInviteStore:n,defaultAddabilities:l,internalDomains:d,inviteTargetsStore:c,invites:u,metadata:m,spaceRole:p,spaceStore:g,spaceUserStore:f,sudoModeStore:h}=e,y=(0,i.O7)(),x=(0,r.useIntl)(),S=(0,a.yK)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:2,borderRadius:4,color:Pt.ZP.uiGray}})),[]),[v,b]=(0,s.useState)("editor"),[M,C]=(0,s.useState)(!1),{source:w,focus:k,emailMessage:I}=(0,o.VK)((()=>{const{display:e}=j.ZP.state;return e===j.wV.Invite?j.ZP.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),T=(0,o.VK)((()=>t.getType()),[t]),{inviteTargets:P,inputFieldText:_}=(0,o.VK)((()=>({inviteTargets:(0,Ee.B)({inviteTargetsStore:c}),inputFieldText:c.state.tokenQuery.trim()})),[c]),A=async()=>{if(!M&&l&&d){C(!0);try{const e={blockRole:v,blockStore:t,spaceRole:p,spaceStore:g};await Ws({contextualInviteStore:n,defaultAddabilities:l,destination:e,environment:y,internalDomains:d,intl:x,invites:u,inviteTargetsStore:c,metadata:m,spaceStore:g,spaceUserStore:f,sudoModeStore:h})}finally{C(!1)}}},B=(0,Qe.I2)(u.map((e=>e.invitee)).filter(Z.$K)),R=(0,ze.oo)({name:"guests",spaceId:g.id,spaceUserId:null==f?void 0:f.id,amount:B}),D=(0,o.VK)((()=>t.canEditMembership()),[t]),O=(0,cs.cR)(t),L=(0,cs.xb)(t),V=Object.values(l??{}).some((e=>"none"===e.type)),E=I.length>fi;return(0,H.jsx)(Et.Z,{disableTooltip:D&&!O&&!L,renderTooltip:()=>D?O?(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.pageInTrash",defaultMessage:"Restore page from trash to add people"}):L?(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.hasAIEdits",defaultMessage:"Resolve pending edits to add people"}):void 0:(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.needFullAccess",defaultMessage:"Only those with full access can add people."}),render:e=>(0,H.jsxs)("div",{style:{display:"flex"},...e,children:[(0,H.jsx)(ui,{inviteTargetsStore:c,metadata:m,focus:k===j.Sw.Search,addabilities:l,disabled:M||!D||O||L,onFocus:()=>{j.ZP.setState({...j.ZP.state,tab:j.XF.Share,display:j.wV.Invite,focus:j.Sw.Search,source:w||j.T5.Notion,emailMessage:I||""}),F.yE(y,{source:w||j.T5.Notion})},onSubmit:()=>{_.length>0||A()},placeholder:x.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder.exp",defaultMessage:"Email or group, separated by commas"}),right:P.length>0?(0,H.jsx)(ds.ZP,{disabled:!D||O||L,role:v,table:"block",type:"user_permission",blockType:T,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:S.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>b(e)}):void 0}),R&&(0,ze.V5)(R,{available:()=>(0,H.jsx)(zs,{tooltip:I.length>fi?(0,H.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0,disabled:!D||O||L||V||E,onClick:A}),unavailable:e=>(0,H.jsx)(gi,{featureAvailability:e,onClick:()=>_t.Vu({environment:y,upgradeButtonName:"user_permission_item"})})})]})})}var yi=n(496455);const xi=function(e){const{store:t}=e,{isMobile:n}=(0,i.Fy)(),s=(0,o.VK)((()=>t.canEditMembership()),[t]),l=(0,cs.cR)(t),d=(0,cs.xb)(t),c=(0,a.yK)((()=>({buttonContainer:{display:"flex",alignItems:"center",gap:mt.p_},inputButton:{flex:1,justifyContent:"flex-start",height:30,overflow:"hidden"},blueButton:{minWidth:mt.UF}})),[]);return(0,H.jsx)(Et.Z,{renderTooltip:()=>d?(0,H.jsx)(r.FormattedMessage,{id:"inviteUserButton.tooltip.resolveAIEditsMessage",defaultMessage:"Resolve pending edits to add people"}):(0,H.jsx)(r.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."}),disableTooltip:s&&!l&&!d,render:t=>(0,H.jsxs)("div",{style:c.buttonContainer,...t,children:[(0,H.jsx)(yi.Z,{onClick:e.onClick,disabled:!s||l||d,style:c.inputButton,children:(0,H.jsx)("div",{style:P.Z.textOverflowStyle,children:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"})})}),!n&&(0,H.jsx)(L.Z,{isLarge:!0,onClick:e.onClick,disabled:!s||l||d,style:c.blueButton,children:(0,H.jsx)(r.FormattedMessage,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})})]})})};function Si(e){const{store:t,permissionItemArgs:n}=e,{onUpgradeButtonClick:l}=n,d=(0,o.qz)(void 0,b.Z),c=(0,o.VK)((()=>d.state.permissionsInviteStore),[d]),u=(0,o.VK)((()=>d.stage),[d]),m=(0,o.VK)((()=>c.state.modalOpen),[c]),p=(0,i.MO)(),g=(0,i.O7)(),f=(0,o.VK)((()=>t.canAdmin()),[t]),h=(0,o.VK)((()=>{const e=le.subscriptionDataStoreInstance.state;return Boolean(e&&Wt.YK(e))}),[]),y=(0,o.VK)((()=>(0,M.pR)({store:t})),[t]),x=(0,a.yK)((e=>({button:{display:"flex",alignItems:"center",minHeight:52},buttonInner:{width:"100%"},modalButton:{height:36},requestedUsersToast:{marginBottom:96}})),[]),S=(0,s.useCallback)(((e,t)=>{e&&t>0&&Ts.oV({label:(0,H.jsx)(r.FormattedMessage,{id:"mobileInviteSection.onInviteComplete.toastMessage.requestedUsers",defaultMessage:"Sent request to invite {numRequests, plural, one {a guest} other {{numRequests} guests}}",values:{numRequests:t}}),style:p?x.requestedUsersToast:void 0})}),[p,x.requestedUsersToast]);return u!==v.TG.closed?null:(0,H.jsx)(A.Z,{mobileFeedback:!0,disabled:!0,style:x.button,children:(0,H.jsxs)("div",{style:x.buttonInner,children:[m&&(0,H.jsx)(be.r1,{store:t,disabled:!f,membersOnly:y,isSubscribed:h,onUpgradeButtonClick:l,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:x.modalButton,permissionsInviteStore:c,onInviteComplete:S}),(0,H.jsx)(xi,{store:t,onClick:()=>(0,$t.z5)({environment:g,permissionsInviteStore:c,store:t,isSubscribed:h,renderInShareModal:!1})})]})})}var vi=n(301978);function bi(e){const{spaceName:t,domainUrl:n}=e,s=(0,r.useIntl)();return(0,H.jsx)(vi.j,{tint:"gray",iconGroup:ps.G,label:s.formatMessage(Mi.label,{spaceName:t}),description:s.formatMessage(Mi.description,{domain:n}),display:"inline"})}const Mi=(0,r.defineMessages)({label:{id:"shareMenu.overLimitBanner.label",defaultMessage:"{spaceName} is over the guest limit"},description:{id:"shareMenu.overLimitBanner.description",defaultMessage:"If you share this page to a ‘@{domain}‘ email, the invite will be sent to your workspace owners as a request to add them as a member with full access to the workspace."}});var ji=n(165598),Ci=n(356666);function wi(e){let{permissions:t}=e;const[n,i]=(0,s.useState)(!1),o=(0,a.yK)((e=>({button:{display:n?"none":"inline-flex",padding:10,width:"100%"},icon:{width:14,transform:"rotate(90deg)",marginLeft:14,marginRight:18,fill:e.lightIconColor},list:{display:n?"block":"none"}})),[n]);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)(A.Z,{onClick:()=>i(!0),style:o.button,children:[(0,H.jsx)("div",{children:(0,Ci.o)(o.icon)}),(0,H.jsx)(m.Z,{isSmall:!0,isSecondaryColor:!0,children:(0,H.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.expandButton",defaultMessage:"{count} more people",values:{count:t.length}})})]}),(0,H.jsx)("div",{style:o.list,children:t})]})}var ki=n(750571);const Ii=function(e){const{store:t}=e,n=(0,a.yK)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]),s={table:we.iU,blockId:t.id};return(0,H.jsx)(nn.C,{icon:(0,ki.S)(n.icon),iconStyle:n.iconContainer,title:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"More people may have access",id:"blockPermissionsSettings.permissionItem.hiddenAccess"}),nonInheritedTooltip:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"This page may be shared with additional people through a parent page or teamspace that you don't have access to",id:"blockPermissionsSettings.hiddenAccess.tooltip"}),permissionRoleSelect:(0,H.jsx)(H.Fragment,{}),currentBlockStore:t,permissionItem:{type:"hidden_permission"},from:s,upgradeButtonName:"team_permission_item"})};var Ti=n(876781),Zi=n(584076),Pi=n(628020),Fi=n(815145),_i=n(561061),Ai=n(844495),Bi=n(186517),Ri=n(484210),Di=n(547307),Oi=n(210228),Li=n(18878);var Vi=n(455838),Ei=n(109867);function Ni(e){const{showRestoreButton:t,store:n,type:s,sudoModeStore:r}=e,{isMobile:l}=(0,i.Fy)(),d=(0,o.VK)((()=>Ne.uJ(n)[1]),[n]),c=(0,i.O7)(),u=(0,o.VK)((()=>({paddingLeft:c.WindowSizeStore.getSafePaddingLeftCSS(14),paddingRight:c.WindowSizeStore.getSafePaddingLeftCSS(14)})),[c]),p=(0,a.yK)((e=>({container:{display:"flex",minHeight:20,flexDirection:"row",alignItems:"center",paddingTop:8,paddingBottom:6,paddingLeft:u.paddingLeft,paddingRight:u.paddingRight},banner:{display:"flex",flexDirection:"row",width:"100%",fontSize:12},icon:{width:16,fill:e.mediumIconColor},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginRight:5},messageContainer:{display:"flex",flexDirection:"column"},label:{display:"inline",marginLeft:l?14:0,color:l?"#CF8807":e.mediumTextColor,fontWeight:l?P.Z.fontWeight.regular:P.Z.fontWeight.medium,marginRight:6,lineHeight:"20px"},buttonContainer:{marginLeft:-5},divider:{opacity:"75%"},mobileContainer:{borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:9,display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"rgba(246, 192, 80, 0.26)"}})),[l,u]);return l?(0,H.jsxs)("div",{style:p.mobileContainer,children:[(0,H.jsx)(m.Z,{isMultiline:!0,isSmall:!0,style:p.label,children:(0,H.jsx)(Wi,{type:s,navigableParentStore:d,showRestoreButton:t})}),t&&(0,H.jsx)(Ui,{store:n,type:s})]}):(0,H.jsx)("div",{style:p.container,children:(0,H.jsxs)("div",{style:p.banner,children:[(0,H.jsx)("div",{style:p.iconContainer,children:zi[s](p.icon)}),(0,H.jsxs)("div",{children:[(0,H.jsx)(m.Z,{isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:p.label,children:(0,H.jsx)(Wi,{type:s,navigableParentStore:d,showRestoreButton:t})}),t&&(0,H.jsx)("span",{style:p.buttonContainer,children:(0,H.jsx)(Ui,{store:n,type:s,sudoModeStore:r})})]})]})})}function Ui(e){const{type:t,store:n,sudoModeStore:s}=e,{isMobile:l}=(0,i.Fy)(),d=(0,o.VK)((()=>!!s&&s.shouldSaveTransactionWithSudoMode(n)),[n,s]),c=(0,a.yK)((e=>({button:{color:l?"#CF8807":e.regularTextColor,fontWeight:P.Z.fontWeight.medium},tooltip:{width:210,whiteSpace:"initial"}})),[l]),u=(0,i.O7)();if("restore-team"===t){const e=async()=>{await async function(e){const{environment:t,useSudoMode:n,store:s}=e,i={type:"restoreTeamPermissions",permissionChanges:[]};await Di.confirmUserAction({message:(0,Li.mX)(i),acceptLabel:(0,Li.nH)(i),cancelLabel:(0,H.jsx)(r.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"})})&&Oi.createAndCommit({userAction:"PermissionsRestoreBanner.restoreTeamPermissions",environment:t,useSudoMode:n,perform:e=>{Ps.Kh({environment:t,store:s,transaction:e})}})}({environment:u,useSudoMode:d,store:n})};return(0,H.jsx)(Et.Z,{style:c.tooltip,placement:Jt.u.Bottom,renderTooltip:()=>(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Reset page permissions to match default teamspace permissions",id:"permissionsRestoreBanner.tooltip.teamPermissions"}),render:t=>(0,H.jsx)("span",{...t,children:(0,H.jsx)(hn.Z,{style:c.button,onClick:e,children:(0,H.jsx)(r.FormattedMessage,{id:"permissionsRestoreBanner.button.teamPermissions",defaultMessage:"Reset"})})})})}if("unrestrict"===t){const e=async()=>{const e=n.getPermissionItems(),t=Ne.Om(n),s=t?(0,Bi.Wo)(Ne.fJ(t)):[],i=(0,Bi.Xr)(e,s);await async function(e){const{environment:t,useSudoMode:n,store:s,permissionChanges:i}=e,o={type:"restore",permissionChanges:i};await Di.confirmUserAction({message:(0,Li.mX)(o),acceptLabel:(0,Li.nH)(o),cancelLabel:(0,H.jsx)(r.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,H.jsx)(Li.mo,{openState:o})})&&(s.getPermissionItemsStore().canAdmin()?Oi.createAndCommit({userAction:"PermissionsRestoreBanner.restoreRestrictedPermissions",environment:t,useSudoMode:n,perform:e=>{Ps.MX({environment:t,store:s,transaction:e})}}):Ps.hs({environment:t,store:s}))}({environment:u,useSudoMode:d,store:n,permissionChanges:i})};return(0,H.jsx)(hn.Z,{style:c.button,onClick:e,children:(0,H.jsx)(r.FormattedMessage,{id:"permissionsRestoreBanner.button.restrictedPermissions",defaultMessage:"Restore"})})}(0,Z.t1)(t)}function Ki(e){const{navigableParentStore:t,maxLength:n,showUnderline:s}=e,{isMobile:r}=(0,i.Fy)(),l=(0,i.O7)(),d=(0,a.yK)((e=>({linkBox:{color:e.mediumTextColor},title:{display:"inline"}})),[]),c=(0,o.VK)((()=>{if(t instanceof Xt.G)return(0,Ri.ZP)({store:t,fullyQualified:!1,pageVisitSource:Fi.tY.LinkInPage})}),[t]);if(!t)return null;const u=r&&t.table===It.e0;return(0,H.jsx)(Zi.Z,{disabled:u,style:u?void 0:d.linkBox,underline:s&&!u,inline:!0,onClick:t.table===It.e0?()=>{t.table===It.e0&&Ei.RF({environment:l,teamId:t.id,tab:Vi.a.Members,from:"permission_item"})}:void 0,href:c,children:(0,H.jsx)(Lt.Z,{shouldWrap:!0,maxLength:n,store:t,style:d.title})})}function Wi(e){const{type:t,navigableParentStore:n,showRestoreButton:s}=e,{isMobile:o}=(0,i.Fy)(),a=(0,H.jsx)(Ki,{navigableParentStore:n,maxLength:o||!s?void 0:30,showUnderline:!0});switch(t){case"restore-team":return(0,H.jsx)(r.FormattedMessage,{id:"pageShareMenu.restoreTeamPermissionsBanner.label",defaultMessage:"Page access is different from {linkBoxWithPageTitle}.",values:{linkBoxWithPageTitle:a}});case"unrestrict":return o?(0,H.jsx)(r.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.mobileLabel",defaultMessage:"Page access is restricted to people below.",values:{linkBoxWithPageTitle:a}}):(0,H.jsx)(r.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.label",defaultMessage:"Access restricted. May not be shared with everyone from {linkBoxWithPageTitle}.",values:{linkBoxWithPageTitle:a}});default:(0,Z.t1)(t)}}const zi={unrestrict:_i.B,"restore-team":Ai.D},qi=(0,r.defineMessages)({fullAccess:{id:"permissionsLevelBanner.fullAccess.label",defaultMessage:"You have full access to this page {hasAttribution, select, true {via {attribution}} other {}}"},editor:{id:"permissionsLevelBanner.editor.label",defaultMessage:"You have edit access to this page {hasAttribution, select, true {via {attribution}} other {}}"},contentEditor:{id:"permissionsLevelBanner.contentEditor.label",defaultMessage:"You have edit access to content on this page {hasAttribution, select, true {via {attribution}} other {}}"},commenter:{id:"permissionsLevelBanner.commenter.label",defaultMessage:"You have comment access to this page {hasAttribution, select, true {via {attribution}} other {}}"},reader:{id:"permissionsLevelBanner.reader.label",defaultMessage:"You have view access to this page {hasAttribution, select, true {via {attribution}} other {}}"}});function Gi(e){let{store:t}=e;const n=(0,i.O7)(),l=(0,o.VK)((()=>(0,Pi.B7)(n)),[n]),d=(0,o.VK)((()=>t.canEditContentOnly()),[t]),{role:c,attribution:u}=(0,o.VK)((()=>{if(!l)return{role:"none",attribution:null};const e=(0,Ht.Dt)({userId:l.id,store:t}),s=function(e){let{environment:t,calculatedPermission:n,store:s}=e;const i=(0,Ne.Pj)(s)||Te.default.state.currentSpaceStore;if(!i)return null;if((0,kt.hV)(n)){const e=(0,U.TC)({spaceStore:i,groupId:n.group_id}),t=null==e?void 0:e.name;return t?(0,H.jsxs)(H.Fragment,{children:[(0,Ti.x)({width:18,marginRight:5}),t]}):null}if((0,kt.fG)(n)){var o;const e=n.team_id||(null===(o=(0,Ne.VP)(s))||void 0===o?void 0:o.id);if(!e)return null;const t=Xt.zX.createChildStore(i,{table:It.e0,id:e,spaceId:i.id});return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(vn.p,{disabled:!0,store:t,size:18,style:{marginRight:5}}),(0,H.jsx)(Ki,{navigableParentStore:t,showUnderline:!0,maxLength:30})]})}if((0,kt.Ir)(n))return(0,kt.tx)(n)?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"the link",id:"permissionsLevelBanner.spacePermission.attribution"}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(vn.p,{disabled:!0,store:i,size:18,style:{marginRight:5}}),(0,U.rn)(t,i)]});if((0,kt.$D)(n))return(0,H.jsx)(Zi.Z,{underline:!0,inline:!0,onClick:()=>{j.ZP.setState({...j.ZP.state,display:j.wV.Publish,tab:j.XF.Publish})},children:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"the published site",id:"permissionsLevelBanner.publicPermission.attribution"})});return null}({environment:n,calculatedPermission:e,store:t});return{role:e.role,attribution:s}}),[l,t,n]),p=(0,o.VK)((()=>!!c&&(!(0,z.QM)()&&!(0,kt.J5)(c))),[c]);(0,s.useEffect)((()=>{c&&Ft.hY(n,{share_menu_session_id:j.ZP.state.sessionId,role:c})}),[]);const g=(0,a.yK)((e=>({container:{background:e.surface.wash,border:1,borderStyle:"solid",borderColor:e.accentColors.gray[75],borderRadius:4,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingTop:10,paddingBottom:10,paddingLeft:12,paddingRight:12,display:"flex",alignItems:"center",justifyContent:"space-between"},bannerBodyContainer:{display:"flex",alignItems:"center"},icon:{marginRight:8},bannerLabel:{fontSize:12,display:"flex",flexDirection:p?"column":"row"},attribution:{display:"inline-flex",alignItems:"center",fill:e.regularIconColor,marginLeft:p?0:5},requestAccessContainer:{fontSize:12,flexShrink:0},pendingAccessRequestButton:{color:e.lightTextColor},accessRequestButton:{color:e.blueColor,padding:5,borderRadius:4}})),[p]),[f,h]=(0,s.useState)(!1),[y,x]=(0,s.useState)(!1),S=(0,s.useCallback)((async()=>{var e;if("reader"!==c&&"comment_only"!==c)return;const s=await rt.requestAccess(n,{type:"current-actor-to-block",block:{id:t.id,spaceId:t.getSpaceId()},attributes:{origin_type:"share_menu",add_permissions_on_approval:!1,role:"read_and_write",existing_permissions:c},message:void 0});"success"===s.type&&s.data.request?(h(!0),Ft.dU(n,{request_access_type:"page",previous_access_level:c,requested_access_level:"read_and_write",requestId:s.data.requestId})):"failed"===s.type&&"UserRateLimitResponse"===(null===(e=s.body)||void 0===e?void 0:e.name)&&x(!0)}),[n,c,t]);if(!(0,kt.iC)(c))return null;const v=function(e){switch(e){case"editor":return qi.fullAccess;case"read_and_write":return qi.editor;case"content_only_editor":return qi.contentEditor;case"comment_only":return qi.commenter;case"reader":return qi.reader;case"none":case"membership_admin":return null;default:(0,Z.t1)(e)}}(c);return v?(0,H.jsx)(Et.Z,{delayThreshold:0,renderTooltip:()=>(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"}),disableTooltip:!d,textWrap:!0,style:{maxWidth:180},render:e=>(0,H.jsxs)("div",{style:g.container,...e,children:[(0,H.jsxs)("div",{style:g.bannerBodyContainer,children:[(0,H.jsx)(ln.Z,{userStore:l,size:20,style:g.icon}),(0,H.jsx)(m.Z,{style:g.bannerLabel,isMultiline:!0,children:(0,H.jsx)(r.FormattedMessage,{...v,values:{hasAttribution:Boolean(u),attribution:(0,H.jsx)("span",{style:g.attribution,children:u})}})})]}),p&&(0,H.jsx)("div",{style:g.requestAccessContainer,children:(0,H.jsx)(A.Z,{style:f||y?g.pendingAccessRequestButton:g.accessRequestButton,onClick:S,disabled:f||y,children:f?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Edit access requested",id:"permissionsLevelBanner.requestPermission.accessRequested"}):y?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Try again later",id:"permissionsLevelBanner.requestPermission.rateLimited"}):(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Request edit access",id:"permissionsLevelBanner.requestPermission.requestEdit"})})})]}),placement:Jt.u.Left}):null}function Hi(){return(0,H.jsx)($i,{children:(0,H.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.moreAttribution",defaultMessage:"More people with access"})})}function $i(e){const{children:t}=e,{WindowSizeStore:n}=(0,i.O7)(),{paddingLeft:s,paddingRight:r}=(0,o.VK)((()=>({paddingLeft:n.getSafePaddingLeftCSS(14),paddingRight:n.getSafePaddingRightCSS(14)})),[n]),l=(0,a.yK)((e=>({label:{color:e.mediumTextColor,fontWeight:P.Z.fontWeight.medium,paddingLeft:s,paddingRight:r,paddingTop:8,paddingBottom:6}})),[s,r]);return(0,H.jsx)(m.Z,{isSmall:!0,style:l.label,children:t})}const Yi=function(e){const{store:t}=e,{parentStore:n,canAccessParent:s}=(0,o.VK)((()=>(0,M.HB)({store:t})),[t]);return s?(0,H.jsx)($i,{children:(0,H.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.attribution",defaultMessage:"From {attribution}",values:{attribution:(0,H.jsx)(Ki,{navigableParentStore:n})}})}):(0,H.jsx)($i,{children:(0,H.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.genericHeader",defaultMessage:"People with access"})})};var Qi=n(119037);function Ji(e){const{store:t}=e,n=(0,i.O7)(),s=(0,o.VK)((()=>function(e){const{store:t,environment:n}=e;return Qi.or([Qi.zzA,Qi.xDy([Qi.c2G,Qi.ffD(Qi.zzA)])])({environment:n,blocks:[t],publicEditMode:void 0})}({store:t,environment:n})),[t,n]);return(0,H.jsx)(Ni,{type:"unrestrict",showRestoreButton:s,store:t,sudoModeStore:e.sudoModeStore})}function Xi(e){const{store:t}=e;return(0,o.VK)((()=>(0,M.Np)({store:t})),[t])?(0,H.jsx)(Ni,{type:"restore-team",showRestoreButton:!1,store:t,sudoModeStore:e.sudoModeStore}):null}const eo=function(e){const{store:t,showRestrictedPermissionBanner:n}=e,{canAccessParent:s}=(0,o.VK)((()=>(0,M.HB)({store:t})),[t]);return s?n?(0,H.jsx)(Ji,{store:t,sudoModeStore:e.sudoModeStore}):(0,H.jsx)(Xi,{store:t,sudoModeStore:e.sudoModeStore}):null};var to=n(40462),no=n(489728),so=n(475024),io=n(316354);function oo(e){let{}=e;const t=(0,i.O7)(),{device:n}=t,o=(0,s.useCallback)((()=>{j.ZP.update((e=>({...e,tab:j.XF.Publish,display:j.wV.Publish})))}),[]),l=(0,a.yK)((e=>({container:{padding:12,backgroundColor:e.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${e.regularDividerColor}`,marginTop:n.isMobile?28:1},link:{textDecoration:"underline",display:"inline"}})),[n.isMobile]);return(0,H.jsx)(m.Z,{style:l.container,isMultiline:!0,isSmall:!0,children:(0,H.jsx)(r.FormattedMessage,{id:"publicItemFooter.caption",defaultMessage:"Anyone on the web can access this published page · <link>Site settings</link>",values:{link:e=>(0,H.jsx)(io.Z,{style:l.link,onClick:o,children:e})}})})}const ao=s.memo(oo);function ro(){const e=(0,a.yK)((e=>({backgroundContainer:{background:e.regularDividerColor,width:32,height:32,borderRadius:4,display:"flex",justifyContent:"center",alignItems:"center"},globeIcon:{width:22,fill:e.icon.secondary}})),[]);return(0,H.jsx)("div",{style:e.backgroundContainer,children:(0,to.o)(e.globeIcon)})}const lo=function(e){let{store:t,publicPermissionItem:n,permissionItemArgs:l}=e;const d=(0,i.O7)(),[c,u]=(0,s.useState)(!1),m=(0,o.VK)((()=>t.canAdmin()),[t]),p=(0,s.useCallback)((()=>{j.ZP.update((e=>({...e,tab:j.XF.Publish,display:j.wV.Publish})))}),[]),g=(0,s.useCallback)((()=>{const e=!1===c;u(!c),e&&Ft.dS(d,{share_menu_session_id:j.ZP.state.sessionId,type:"public_link"})}),[d,c,u]),f=(0,a.yK)((e=>({link:{textDecoration:"underline",fontSize:(0,so.yv)(d,"UISmall"),color:e.text.secondary,paddingTop:0,paddingBottom:0,height:20,paddingLeft:4,paddingRight:4,marginTop:-4,marginLeft:-4,overflow:"hidden"},linkUILabelStyle:{overflow:"unset"}})),[d]);return(0,H.jsx)(nn.C,{currentBlockStore:t,permissionItem:n.permissionItem,from:n.from,nonInheritedTooltip:(0,H.jsx)(r.FormattedMessage,{id:"publicLinkPermissionItem.tooltip",defaultMessage:"Anyone on the web can access this published page"}),icon:(0,H.jsx)(ro,{}),title:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Anyone with published link",id:"publicLinkPermissionItem.title"}),subtitle:(0,H.jsx)(no.Z,{style:f.link,onClick:p,children:m?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Edit site settings",id:"publicLinkPermissionItem.manageSettings"}):(0,H.jsx)(r.FormattedMessage,{defaultMessage:"View site settings",id:"publicLinkPermissionItem.viewSettings"})}),selectFooter:(0,H.jsx)(ao,{}),subtitleStyle:f.linkUILabelStyle,onClick:g,upgradeButtonName:"public_permission_item",...l})};var co=n(542853),uo=n(16184),mo=n(521213),po=n(698519),go=n(623063),fo=n(231945);function ho(){const e=(0,i.O7)(),{currentSpaceStore:t}=(0,o.Kw)(Te.default);return(0,o.VK)((()=>t?(0,U.rn)(e,t):""),[e,t])}var yo=n(61766),xo=n(960709);const So=[{key:"private",title:()=>(0,H.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.inviteOnly",defaultMessage:"Invite only"}),caption:()=>(0,H.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.inviteOnly",defaultMessage:"Only you and people invited can access"}),icon:uo.Q},{key:"unlisted",title:e=>(0,H.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.anyoneWithLink",defaultMessage:"Anyone with link at {spaceName}",values:{spaceName:e}}),caption:()=>(0,H.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.anyoneWithLink",defaultMessage:"People invited and workspace members with link can access"}),icon:Sn.N},{key:"open",title:e=>(0,H.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone at {spaceName}",values:{spaceName:e}}),caption:()=>(0,H.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.everyoneInWorkspace",defaultMessage:"All workspace members can search and access"}),icon:mo.T}],vo={key:"trustedDomain",title:(e,t)=>(0,H.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.everyoneInTrustedDomain",defaultMessage:"Anyone with a {trustedDomainName} email",values:{trustedDomainName:t}}),caption:e=>(0,H.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.everyoneInTrustedDomain",defaultMessage:"Anyone with an email address in {trustedDomainName} can view this page, even if they're not part of the workspace.",values:{trustedDomainName:e}}),icon:Sn.N};function bo(e){const{store:t,spacePermission:n,trustedDomainPermission:i}=e,l=ko(),d=(0,o.VK)((()=>Ke.default.checkGate({gateName:"trusted_domain_pages"})&&(l&&!(0,kt.Wi)(n.permissionItem.role)||(0,kt.YX)(i.permissionItem.role))),[n,i,l]),c=d?jo(n.permissionItem,i.permissionItem):Co(n.permissionItem),u=d?[...So,vo]:So,p=(0,o.VK)((()=>t.canAdmin()),[t]),g=(0,cs.cR)(t),f=(0,cs.xb)(t),h=ho(),y=(0,o.VK)((()=>{const e=Te.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),[x,S]=(0,s.useState)(!1),v=(0,a.yK)((e=>({chevron:{width:12,fill:e.mediumIconColor,marginLeft:"auto"},button:{height:42,color:e.mediumTextColor,marginBottom:8,padding:"0 6px",marginLeft:-6,marginRight:-6,width:"100%"},icon:{fill:e.regularIconColor,width:32,height:32,backgroundColor:e.lightDividerColor,padding:6,borderRadius:4,marginRight:12},animation:{maxHeight:220},enterAnimation:{maxHeight:0},exitAnimation:{maxHeight:0},container:{overflow:"hidden"}})),[]),b=u.find((e=>e.key===c));return b&&y?(0,H.jsxs)("div",{style:v.container,children:[(0,H.jsxs)(no.Z,{style:v.button,icon:b.icon,iconStyle:v.icon,disabled:!p||g||f,disabledFeedback:!0,onClick:()=>S(!x),children:[(0,H.jsxs)("div",{children:[(0,H.jsx)(m.Z,{isSmall:!0,children:(0,H.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityMobileTitle",defaultMessage:"Page visibility"})}),(0,H.jsx)(m.Z,{children:b.title(h)})]}),p&&(x?(0,co.i)(v.chevron):(0,jt.R)(v.chevron))]}),(0,H.jsx)(go.Z,{isVisible:x,animationStyle:v.animation,enterAnimationStyle:v.enterAnimation,exitAnimationStyle:v.exitAnimation,render:()=>(0,H.jsx)(Mo,{...e,parentCloseCallback:()=>S(!1),pageVisibilityDisplayInfo:u,isTrustedDomainsEnabled:d})})]}):null}function Mo(e){const{store:t,spacePermission:n,trustedDomainPermission:s,sudoModeStore:r,location:l,isRestricted:d,pageVisibilityDisplayInfo:u,isTrustedDomainsEnabled:p,parentCloseCallback:g}=e,h=(0,i.O7)(),y=h.device.isMobile,x=p?jo(n.permissionItem,s.permissionItem):Co(n.permissionItem),S=ko(),v=(0,M.Xz)({permissionItem:s,store:t}),b=(0,M.Xz)({permissionItem:n,store:t}),j=(0,o.VK)((()=>{const{currentSpaceStore:e}=Te.default.state;return!!e&&t.isTopLevelWorkspacePage(e.id)}),[t]),C=ho(),w=(0,o.VK)((()=>{const e=M.bQ({store:t});return e?Co(e):"private"}),[t]),k=(0,a.yK)((e=>{const t={width:14,fill:y?e.regularIconColor:e.mediumTextColor};return{icon:{fill:y?e.regularIconColor:e.mediumTextColor,width:16},iconContainer:{alignSelf:"center",marginLeft:y?13:9},hiddencheckmark:{...t,visibility:"hidden"},selectedCheckmark:{...t,visibility:"visible"},checkmarkContainer:{marginLeft:12},selectedTitle:{fontWeight:P.Z.fontWeight.semibold},mobileScroller:{border:`1px solid ${e.regularDividerColor}`,borderRadius:8,marginBottom:24},mobileButton:{paddingTop:8,paddingBottom:8},mobileButtonDivider:{borderBottom:`1px solid ${e.regularDividerColor}`},caption:{whiteSpace:"normal"}}}),[y]);return(0,H.jsx)(c.Z,{menuType:f.og.Popup,disableScroller:!0,scrollerStyle:y?k.mobileScroller:{},children:(0,H.jsx)(Dt.Z,{type:Dt.i.Vertical,initialFocus:void 0,sections:[{key:"visibilityOptions",render:e=>(0,H.jsx)(Vt.Z,{...e,disableDesktopPadding:y}),items:u.map(((e,i)=>{const o=e.key,a=x===o,c=a?k.selectedCheckmark:k.hiddencheckmark,f=i!==u.length-1,M={...y?k.mobileButton:{},...y&&f?k.mobileButtonDivider:{}};return{key:o,render:t=>(0,H.jsx)("div",{children:(0,H.jsx)(Bt.Z,{title:e.title(C,S),caption:(0,H.jsx)(m.Z,{isSmall:!0,isMultiline:!0,style:k.caption,children:e.caption(C)}),icon:e.icon(k.icon),desktopIconStyle:k.iconContainer,titleStyle:a&&!y?k.selectedTitle:void 0,right:(0,po.k)(c),rightStyle:k.checkmarkContainer,style:M,...t})}),action:()=>{if(a)return;let e,i,c;if("trustedDomain"===o){if(!p)return;e=s.permissionItem,i={type:"trusted_domain_permission",role:"reader"},c=v}else e=n.permissionItem,i={type:"space_permission",role:wo(e,x,o)},c=b,"unlisted"===o&&(i.unlisted_timestamp=Date.now()),p&&function(){const e={role:"none"},n=v&&"none"!==s.permissionItem.role;(0,Ze.i)({oldPermissionItem:s.permissionItem,newPermissionItem:{...s.permissionItem,...e},wasInherited:v,environment:h,store:t,sudoModeStore:r,location:l,restrictingVisibility:n})}();const u="trustedDomain"!==o&&function(e,t){if(e===t)return!1;switch(t){case"open":return!1;case"unlisted":return"open"===e;case"private":return!0;default:(0,Z.t1)(t)}}(w,o)&&!d&&!j;(0,Ze.i)({oldPermissionItem:e,newPermissionItem:i,wasInherited:c,environment:h,store:t,sudoModeStore:r,location:l,restrictingVisibility:u}),g()}}}))}]})})}function jo(e,t){return"reader"===t.role?"trustedDomain":"none"===e.role?"private":e.unlisted_timestamp?"unlisted":"open"}function Co(e){return"none"===e.role?"private":e.unlisted_timestamp?"unlisted":"open"}function wo(e,t,n){return"private"===n?"none":"private"===t?"editor":e.role}function ko(){return(0,o.VK)((()=>{const{currentSpaceStore:e}=Te.default.state,t=e?e.getTrustedDomains():[];return t.length?t[0]:""}),[])}const Io=function(e){const{store:t,spacePermission:n,trustedDomainPermission:i}=e,l=ko(),d=(0,o.VK)((()=>Ke.default.checkGate({gateName:"trusted_domain_pages"})&&(l&&!(0,kt.Wi)(n.permissionItem.role)||(0,kt.YX)(i.permissionItem.role))),[n,i,l]),c=d?jo(n.permissionItem,i.permissionItem):Co(n.permissionItem),u=(0,o.VK)((()=>t.canAdmin()),[t]),m=(0,cs.cR)(t),p=(0,cs.xb)(t),g=ho(),f=(0,o.VK)((()=>{const e=Te.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),h=(0,o.qz)(void 0,yo.Z),y=(0,s.useRef)(null),x=d?[...So,vo]:So,S=(0,a.yK)((e=>({chevron:{width:12,marginLeft:4,fill:e.mediumIconColor},popup:{overflow:"visible",width:"100%",minWidth:430},button:{justifyContent:"center",borderRadius:32,height:32,color:e.mediumTextColor,paddingLeft:12,maxWidth:380},title:{...P.Z.textOverflowStyle},icon:{fill:e.mediumTextColor,width:16}})),[]);return f?(0,H.jsx)(fo.ZP,{buttonPopupStore:h,popupType:fo.Z4.Popup,popupWrapStyle:S.popup,renderOrigin:e=>{const t=x.find((e=>e.key===c));return t?(0,H.jsx)(Et.Z,{placement:Jt.u.Bottom,alignment:Jt.v.Start,disableTooltip:u&&!m&&!p,renderTooltip:()=>u?m?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Restore page from trash to change the privacy setting",id:"linkSharingPill.disabledTooltip.message.pageInTrash"}):p?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Resolve pending edits to change the privacy setting",id:"linkSharingPill.disabledTooltip.message.hasAIEdits"}):void 0:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"You must have full access to change the privacy setting",id:"linkSharingPill.disabledTooltip.message"}),render:n=>(0,H.jsxs)(O.Z,{...e,ref:y,style:S.button,icon:t.icon,iconStyle:S.icon,disabled:!u||m||p,disabledFeedback:!0,...n,children:[(0,H.jsx)("div",{style:S.title,children:t.title(g,l)}),u&&(0,co.i)(S.chevron)]})}):null},placementToOrigin:xo.Iw.Bottom,alignmentToOrigin:xo.lU.Start,sameWidthAsOrigin:!0,render:t=>(0,H.jsx)(Mo,{...e,parentCloseCallback:()=>t.close(),pageVisibilityDisplayInfo:x,isTrustedDomainsEnabled:d})}):null};var To=n(203303),Zo=n(800893),Po=n(95477),Fo=n(730459);function _o(e){const{store:t,buttonPopupStore:n,events:s}=e,o=(0,i.O7)(),{device:l,mobileNative:d}=o,c=(0,a.yK)((e=>({button:{flex:1,height:36,minHeight:36}})),[]);return(0,H.jsx)(L.Z,{onClick:()=>{var e;l.isMobileNative?function(e){const{store:t,mobileNative:n}=e,s=(0,To.u5)({schemeUrl:(0,Ri.ZP)({store:t,pageVisitSource:Fi.tY.CopyLink}),baseUrl:Po.default.domainBaseUrl});n&&n.share(s)}({store:t,mobileNative:d}):Ro({store:t,buttonPopupStore:n,environment:o});const s=null===(e=t.getCollectionViewCollectionStore())||void 0===e?void 0:e.id,i=t.getParentCollectionIdUpToTwoLevels();Oo(o,{collection_id:s,parent_collection_id:i})},style:c.button,...s,children:l.isMobileNative?(0,H.jsx)(r.FormattedMessage,{id:"pageShareMenu.shareLinkButton.label",defaultMessage:"Share link"}):(0,H.jsx)(r.FormattedMessage,{id:"pageShareMenu.copyLinkButton.label",defaultMessage:"Copy link"})})}function Ao(e){const{store:t,buttonPopupStore:n,events:s}=e,o=(0,i.O7)(),l=(0,a.yK)((e=>({button:{height:24,paddingLeft:8,paddingRight:8,color:e.regularTextColor,marginLeft:"auto"},icon:{width:14,height:14,fill:e.regularIconColor,marginLeft:0,marginRight:6},label:{color:e.regularTextColor}})),[]);return(0,H.jsxs)(no.Z,{isSmall:!0,onClick:()=>{var e;Ro({store:t,buttonPopupStore:n,environment:o});const s=null===(e=t.getCollectionViewCollectionStore())||void 0===e?void 0:e.id,i=t.getParentCollectionIdUpToTwoLevels();Oo(o,{collection_id:s,parent_collection_id:i})},style:l.button,...s,children:[(0,Sn.N)(l.icon),(0,H.jsx)(m.Z,{isSmall:!0,style:l.label,children:(0,H.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.copyLinkButton.label",defaultMessage:"Copy link"})})]})}function Bo(e){const{calculatedPermissions:t}=e,n=t.mostPermissivePublicItem.permissionItem;if((0,kt.YX)(n.role))return(0,H.jsx)(r.FormattedMessage,{defaultMessage:"This page has public link access, so anyone with the link will be able to view the page.",id:"blockPermissionsSettings.publicLinkInfo.tooltip"});const s=t.mostPermissiveSpaceItem.permissionItem;return(0,kt.YX)(s.role)?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"This page has workspace access, so anyone in the workspace will be able to view the link.",id:"blockPermissionsSettings.workspacePermissions.tooltip"}):t.permissionItemsCount>1?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Only you and other invited members and guests will be able to view the link.",id:"blockPermissionsSettings.userPermissions.tooltip"}):(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Only you can access this page, so the link will only work for you.",id:"blockPermissionsSettings.privatePermissions.tooltip"})}async function Ro(e){const{store:t,buttonPopupStore:n,environment:s}=e,i=(0,Ri.ZP)({store:t,pageVisitSource:Fi.tY.CopyLink});await Zo.RD({environment:s,stringValue:i,copiedMessage:Zo.tq.copiedLinkToClipboard}),n&&n.setState({open:!1})}const Do=function(e){const{store:t,buttonPopupStore:n,calculatedPermissions:s}=e,{device:o}=(0,i.O7)(),r=(0,a.yK)((()=>({tooltip:{width:280}})),[]);return(0,H.jsx)(Et.Z,{delayThreshold:0,placement:Jt.u.Bottom,renderTooltip:()=>(0,H.jsx)(Bo,{calculatedPermissions:s}),textWrap:!0,style:r.tooltip,render:e=>o.isMobile?(0,H.jsx)(_o,{store:t,buttonPopupStore:n,events:e}):(0,H.jsx)(Ao,{store:t,buttonPopupStore:n,events:e})})};function Oo(e,t){Fo.K4(e,"copy_link_from_permissions_setting",t)}const Lo=function(e){const{isMobile:t}=(0,i.Fy)(),n=(0,a.yK)((e=>({container:{display:"flex",alignItems:t?"normal":"center",boxShadow:`0 -1px 0 ${e.regularDividerColor}`,flexDirection:t?"column":"row",justifyContent:"space-between",padding:"8px 14px"}})),[t]),{mostPermissiveSpaceItem:s,mostPermissiveTrustedDomainItem:o,showRestrictedPermissionBanner:r}=e.calculatedPermissions;return(0,H.jsx)(H.Fragment,{children:(0,H.jsxs)("div",{style:n.container,children:[t?(0,H.jsx)(bo,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:s,trustedDomainPermission:o,isRestricted:r}):(0,H.jsx)(Io,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:s,trustedDomainPermission:o,isRestricted:r}),(0,H.jsx)(Do,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})]})})};var Vo=n(22487);function Eo(e){const{teamName:t}=e;return t?(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at {teamName}",id:"blockPermissionsSettings.permissionItem.teamspaceAccess",values:{teamName:t??""}}):(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at a private teamspace",id:"blockPermissionsSettings.permissionItem.teamspace.hidden"})}function No(e){const{membersCount:t}=e;return(0,H.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}const Uo=function(e){const{store:t,blockTeamMemberPermission:n,blockTeamOwnerPermission:r,blockTeamGuestPermission:l}=e,d=(0,i.O7)(),c=(0,i.Fy)(),[u,m]=(0,s.useState)(!1),{permissionItem:p}=n,g=(0,o.VK)((()=>Te.default.state.currentSpaceStore),[]),f=(0,o.VK)((()=>{var e;return kt.zU(p)?p.team_id:null===(e=Ne.VP(t))||void 0===e?void 0:e.id}),[p,t]),h=r.permissionItem.role,y=p.role,x={type:"team_overview_permission",role:h===y?y:"none"===y||"none"===h?"limited":"access"},{teamStore:S,teamIsDefined:v,teamName:b}=(0,o.VK)((()=>{if(!g||!f)return{undefined:void 0};const e=Xt.zX.createChildStore(g,{table:It.e0,id:f,spaceId:g.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[g,f]),M=(0,Vo.K)(S),C=(0,o.VK)((()=>{if(!g)return!1;return!g.getDisableTeamGuests()&&((null==S||!S.isDefault())&&(0,Me.F$)())}),[g,S]),w=(0,s.useCallback)((()=>{const e=!1===u;if(m(!u),e){if(!S)return;Ft.dS(d,{share_menu_session_id:j.ZP.state.sessionId,type:"team",team_id:S.id})}}),[d,u,m,S]),k=(0,a.yK)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor},teamPermissionsContainer:{paddingLeft:16,display:u?"block":"none"},roleButton:{marginRight:-8,color:e.mediumTextColor,fontSize:c.isMobile?14:12}})),[u,c.isMobile]),I=(0,jt.R)(k.icon);return S?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(nn.C,{currentBlockStore:t,permissionItem:x,from:n.from,icon:v?(0,H.jsx)(vn.p,{disabled:!0,store:S,size:nn.Z}):(0,In.x)(),title:(0,H.jsx)(Eo,{teamName:b}),subtitle:v&&(0,H.jsx)(No,{membersCount:M}),upgradeButtonName:"team_permission_item",onClick:w,permissionRoleSelect:u?I:(0,H.jsx)(Nt.d,{type:x.type,role:x.role,icon:Ct.P,disabled:!0,buttonStyle:k.roleButton,table:we.iU,isRemovable:!1,isCurrentUser:!1}),...e.permissionItemArgs}),(0,H.jsxs)("div",{style:k.teamPermissionsContainer,children:[r&&(0,H.jsx)(Un,{store:t,permissionItemArgs:e.permissionItemArgs,blockTeamOwnerPermission:r,fromPermissionWrapper:"expandable_permission"}),n&&(0,H.jsx)(Dn,{store:t,permissionItemArgs:e.permissionItemArgs,blockTeamPermission:n,fromPermissionWrapper:"expandable_permission"}),C&&l&&(0,H.jsx)(Fn,{store:t,permissionItemArgs:e.permissionItemArgs,blockTeamGuestPermission:l,fromPermissionWrapper:"expandable_permission"})]})]}):null};function Ko(e){const{store:t,permissionItemArgs:n}=e,{showTeamPermission:s,showSpacePermission:i,mostPermissiveAncestorTeamOwnerItem:o,mostPermissiveAncestorTeamMemberItem:a,mostPermissiveAncestorTeamGuestItem:r,mostPermissiveSpaceItem:l,pagePermissionUIModel:d,mostPermissivePublicItem:c,showPublicPermission:u}=e.calculatedPermissions,m=Number(s)+Number(i)+Number(u);return(0,H.jsxs)(H.Fragment,{children:[u&&c&&(0,H.jsx)(lo,{store:t,publicPermissionItem:c,permissionItemArgs:n}),s&&o&&a&&(0,H.jsx)(Uo,{store:t,blockTeamOwnerPermission:o,blockTeamMemberPermission:a,blockTeamGuestPermission:r,permissionItemArgs:n}),i&&(0,H.jsx)(wn,{store:t,spacePermission:l,permissionItemArgs:n,fromPermissionWrapper:"permission_list"}),(0,H.jsx)(Wo,{store:t,pagePermissions:d,numberPermissionsAlreadyRendered:m,permissionItemArgs:n})]})}function Wo(e){const t=(0,r.useIntl)(),n=(0,o.VK)((()=>{const e=Te.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e.id:""}),[]),{store:s,pagePermissions:i,numberPermissionsAlreadyRendered:a,permissionItemArgs:l,showHeader:d}=e,{showUserPermissions:c,mostPermissiveGroupPermissions:u,mostPermissiveTeamPermissions:m,mostPermissiveUserPermissions:p,spacePermissionGroups:g}=i,f=(0,o.VK)((()=>zt()),[]),h=(0,o.VK)((()=>{const e=c?function(e){const{mostPermissiveUserPermissions:t,spaceVisibleUserMap:n}=e,s={};return t.forEach((t=>{s[t.permissionItem.user_id]=(0,H.jsx)(pn,{store:e.store,userPermission:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,spaceVisibleUserMap:n,fromPermissionWrapper:"permission_list"},t.permissionItem.user_id)})),s}({store:s,mostPermissiveUserPermissions:p,permissionItemArgs:l,spaceVisibleUserMap:f}):[];return qs.oA(Object.keys(e).map((n=>{const i=Xt.U6.createChildStore(s,{table:Tt.KJ,id:n}),o=i.getModel();if(!i.isReady()||o)return{title:(0,an.Nz)(t,o),permissionItem:e[n]}})))}),[c,p,l,s,t,f]),y=n?function(e){const{spaceId:t,spacePermissionGroups:n,mostPermissiveGroupPermissions:s}=e,i={};return s.forEach((s=>{const o=s.permissionItem.group_id;n.find((e=>e.id===o))&&(i[o]=(0,H.jsx)(on,{store:e.store,groupPermission:s,spaceId:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list"}))})),i}({store:s,spaceId:n,spacePermissionGroups:g,mostPermissiveGroupPermissions:u,permissionItemArgs:l}):[],x=function(e){const{store:t,mostPermissiveTeamPermissions:n,permissionItemArgs:s}=e;return n.map((e=>kt.LW(e.permissionItem)?(0,H.jsx)(Un,{store:t,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:s,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.owner`):kt.bm(e.permissionItem)?(0,H.jsx)(Fn,{store:t,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:s,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.teamGuest`):(0,H.jsx)(Dn,{store:t,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:s,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.member`)))}({store:s,mostPermissiveTeamPermissions:m,permissionItemArgs:l}),S=[...h,...Object.keys(y).map((e=>{const n=g.find((t=>t.id===e));return{title:n?(0,Yt.kF)({intl:t,group:n}):"",permissionItem:y[e]}}))];S.sort(((e,t)=>e.title.localeCompare(t.title)));const v=x.concat(S.map((e=>e.permissionItem))),b=v.length;if(0===b)return null;if(b>5-a){const e=Math.max(2-a,0);return(0,H.jsxs)(H.Fragment,{children:[d&&(0,H.jsx)(Hi,{}),v.slice(0,e),(0,H.jsx)(wi,{permissions:v.slice(e,-1)}),v[b-1]]})}return(0,H.jsxs)(H.Fragment,{children:[d&&(0,H.jsx)(Hi,{}),v]})}function zo(e,t){return e.from.table===we.iU&&e.from.blockId===t.id}const qo=function(e){const t=(0,i.O7)(),{device:n}=t,{store:r,permissionItemArgs:l,calculatedPermissions:d}=e,{sudoModeStore:c}=l,{permissionItemsCount:u,pagePermissionUIModel:m,showRestrictedPermissionBanner:p}=d,g=(0,o.VK)((()=>{const e=Te.default.state.currentSpaceStore;if(!e)return!0;if(r.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;const n=(0,Ne.uJ)(r);for(const s of n)if((0,ji.OY)(s)&&s.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;return!1}),[r,t]);let f=null;const h=(0,o.VK)((()=>(0,M.up)({store:r,showRestrictedPermissionBanner:p})),[r,p]),{canAccessParent:y}=(0,o.VK)((()=>(0,M.HB)({store:r})),[r]),x={...d};if(!h&&y){const[e,t]=function(e,t){const{mostPermissiveGroupPermissions:n,mostPermissiveTeamPermissions:s,mostPermissiveUserPermissions:i}=t,[o,a]=qs.uK(n,(t=>zo(t,e))),[r,l]=qs.uK(s,(t=>zo(t,e))),[d,c]=qs.uK(i,(t=>zo(t,e))),u={...t,mostPermissiveGroupPermissions:a,mostPermissiveTeamPermissions:l,mostPermissiveUserPermissions:c},m={...t,mostPermissiveGroupPermissions:o,mostPermissiveTeamPermissions:r,mostPermissiveUserPermissions:d};return[u,m]}(r,m);x.pagePermissionUIModel=e,f=(0,H.jsx)(Wo,{store:r,pagePermissions:t,numberPermissionsAlreadyRendered:0,permissionItemArgs:l,showHeader:!0})}const S=(0,o.VK)((()=>!(0,M.gi)({store:r})),[r]),v=n.isMobile?dt.Z.None:dt.Z.Y,b=(0,a.yK)((e=>({scroller:{paddingBottom:10,minHeight:n.isMobile||0===u?void 0:1===u?60:90}})),[n,u]);return(0,s.useEffect)((()=>{Ft.oE({environment:t,calculatedPermissions:d})}),[]),(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)(lt.Z,{style:b.scroller,type:v,children:[!g&&(0,H.jsx)(Gi,{store:r}),(0,H.jsx)(eo,{store:r,showRestrictedPermissionBanner:p,sudoModeStore:c}),!h&&u>0&&(0,H.jsx)(Yi,{store:r}),(0,H.jsx)(Ko,{store:r,calculatedPermissions:x,permissionItemArgs:l}),f,S&&(0,H.jsx)(Ii,{store:r})]}),!n.isMobile&&(0,H.jsx)(Lo,{store:r,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:x,permissionItemArgs:l})]})};function Go(e){const{blockStore:t,contextualInviteStore:n,inviteTargetsStore:r,permissionItemArgs:l,spaceStore:d,spaceUserStore:c,subscriptionDataStore:u}=e,m=(0,i.Fy)(),{spaceId:p,spaceName:g,spaceUserId:f,spaceModel:h}=(0,o.VK)((()=>({spaceId:d.getSpaceId(),spaceName:d.getName(),spaceUserId:c.id,spaceModel:d.getModel()})),[d,c]),y=(0,o.VK)((()=>(0,Ne.VP)(t)),[t]),[x,S]=(0,o.VK)((()=>[null==c?void 0:c.getModel(),null==y?void 0:y.getModel()]),[c,y]),v=(0,o.VK)((()=>j.ZP.state.display),[]),b=function(e){return(0,a.yK)((()=>({container:{position:"relative",height:e!==j.wV.MainShareMenu?540:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:540}})),[e])}(v),M=(0,o.qz)(void 0,Ue.Z),C=(0,o.VK)((()=>n.state.flowId),[n]),w=function(e){const t=(0,i.Fy)();return(0,s.useCallback)((n=>{n.preventDefault(),t.isMobile||e!==j.wV.MainShareMenu||j.ZP.setState({...j.ZP.state,tab:j.XF.Share,display:j.wV.Invite,focus:j.Sw.Search,source:j.T5.Notion,emailMessage:""})}),[t,e])}(v),k=(0,$e.U)(u),I=(0,o.VK)((()=>(0,Ee.B)({inviteTargetsStore:r,includeInputFieldText:!0}).map((e=>({inviteTarget:e,invitee:Ge({currentMembersAndGuests:k,inviteTarget:e})}))).filter(Z.$K)),[r,k]),T=(0,qe.AW)({space:d,spaceUser:c,team:y,invitees:I.map((e=>e.invitee)).filter(Z.$K)}),P=(0,Ve.U)(d),F=I.map((e=>e.invitee)).filter((e=>void 0!==e&&void 0===e.currentRole&&P&&(0,Re.is)(e.email,P))),A=(0,ze.oo)({name:"internal_guests",spaceId:p,spaceUserId:f,amount:F.length}),B=(0,ze.VX)({name:"non_admin_members",spaceId:p,spaceUserId:f})?"read_and_write":"editor",R=(0,Le.IH)({spaceStore:d}),D=(0,o.VK)((()=>{const e=j.ZP.state,t=e.display===j.wV.Invite?e.emailMessage:"";return{inviteFlowId:n.state.flowId,inviteMessage:t,inviteOrigin:"share_menu",shareMenuSessionId:e.sessionId}}),[n]),O=(0,o.VK)((()=>T?I.map((e=>{const{inviteTarget:t,invitee:n}=e,s=null==n?void 0:n.email;let i,o;return"group"===t.type?o={type:"group"}:s?(i=(0,Re.TC)(s,P??[]),o=T[s]??{type:"none",reason:"other"}):o={type:"none",reason:"other"},{defaultAddability:o,internalDomain:i,invitee:n,inviteTarget:t}})):[]),[I,T,P]),L=(0,De.Kz)(A,(()=>{if(!g)return;if(R)return;const e=F[0];if(!e)return;const t=(0,Be.Gd)(e.email);return t?(0,H.jsx)(bi,{spaceName:g,domainUrl:t}):void 0}));return(0,H.jsx)(Oe.Z,{debugName:"ShareMenuShareTab",capture:!0,onTab:w,children:(0,H.jsxs)("div",{style:b.container,children:[(0,H.jsxs)(_.jX,{direction:"column",gap:16,padding:"0 14px 8px 14px",children:[m.isMobile?(0,H.jsx)(Si,{store:t,permissionItemArgs:l}):(0,H.jsx)(hi,{blockStore:t,contextualInviteStore:n,defaultAddabilities:T,internalDomains:P,invites:O,inviteTargetsStore:r,metadata:D,spaceRole:B,spaceStore:d,spaceUserStore:c,sudoModeStore:l.sudoModeStore}),L]}),v===j.wV.MainShareMenu&&(0,H.jsx)(qo,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:l}),v===j.wV.Invite&&!m.isMobile&&(0,H.jsx)(as,{store:t,inviteTargetsStore:r,menuListStore:M,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,flowId:C}),(0,H.jsx)(We,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,H.jsx)(it,{domains:P,spaceId:p,spaceModel:h,spaceUserId:f,spaceUserModel:x,teamModel:S}),whenDisabled:null})]})})}var Ho=n(262397);const $o=function(e){const{store:t,sudoModeStore:n}=e,s=(0,o.VK)((()=>n.state.changePermissionsEnabled),[n]),i=(0,o.VK)((()=>n&&n.shouldUserHaveAccessToPrivatePageBlock()&&!n.doesUserAlreadyHaveEditorAccessOnBlock(t.id)&&n.state.privatePageStore),[n,t]),l=(0,a.yK)((e=>({container:{background:e.cardBackground,padding:"12px 18px",boxShadow:e.borderBoxShadow,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"baseline"},button:{fontWeight:P.Z.fontWeight.medium,justifyContent:"center",marginTop:8,opacity:s?.5:1},icon:{width:16,height:16,marginRight:6,transition:"all 200ms ease",transform:s?"rotate(-90deg)":void 0}})),[s]);return i?(0,H.jsxs)("div",{style:l.container,children:[(0,H.jsx)(m.Z,{isMultiline:!0,children:(0,H.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessage",defaultMessage:"As a <b>workspace owner</b>, you can change the permissions of this page to add yourself or others. Any changes will appear in the audit log.",values:{b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,H.jsx)("b",{children:t})}}})}),(0,H.jsxs)(O.Z,{disabled:s,style:l.button,onClick:()=>{n.setState({...n.state,changePermissionsEnabled:!0})},children:[(0,Ho.I)(l.icon),s?(0,H.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.isChangingPermissionsMessageButton",defaultMessage:"Changing permissions"}):(0,H.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessageButton",defaultMessage:"Change permissions"})]})]}):null};function Yo(e){const t=(0,o.VK)((()=>j.ZP.state.tab),[]);switch(t){case j.XF.Share:return(0,H.jsx)(Go,{...e,blockStore:e.store,subscriptionDataStore:le.subscriptionDataStoreInstance});case j.XF.Publish:return(0,H.jsx)(Ae,{store:e.store,permissionItemArgs:e.permissionItemArgs,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem});default:(0,Z.t1)(t)}}const Qo=function(e){const{store:t,permissionItemArgs:n}=e,s=(0,i.Fy)(),r=(0,o.qz)(e.inviteTargetsStore,re.ZP),l=(0,a.yK)((()=>({container:{display:"flex",flexDirection:"column",height:"100%"}})),[]);return(0,H.jsxs)("div",{style:l.container,children:[n.sudoModeStore&&(0,H.jsx)($o,{store:t,sudoModeStore:n.sudoModeStore}),!s.isMobile&&(0,H.jsx)(fe,{inviteTargetsStore:r,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem}),(0,H.jsx)(Yo,{inviteTargetsStore:r,...e})]})};function Jo(){const e=(0,i.Fy)(),t=(0,a.yK)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"center",height:160}})),[]);return(0,H.jsx)("div",{style:t.container,children:(0,H.jsx)(m.Z,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Please go online to publish & share.",id:"blockPermissionsSettings.offline.prompt"})})})}const Xo=function(e){const{store:t,sudoModeStore:n,onUpgradeButtonClick:C,location:w}=e,k=(0,i.Fy)(),I=(0,o.qz)(void 0,b.Z),T=(0,o.VK)((()=>I.state.contextualInviteStore),[I]),Z=(0,y.r)(),P=(0,x.r_)(),F=(0,o.VK)((()=>M.mk({spaceStore:Z,store:t})),[Z,t]),_=(0,o.VK)((()=>T.state.inviteStage),[T]),A=(0,o.VK)((()=>j.ZP.state.tab),[]),B=(0,a.yK)((()=>({title:{fontSize:18},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto"}})),[]),R=(0,s.useMemo)((()=>({onUpgradeButtonClick:C,sudoModeStore:n,location:w})),[C,n,w]);if(!Z)return null;if(!k.isMobile&&(_===v.TG.share_workspace||_===v.TG.request_workspace))return(0,H.jsx)(te,{blockStore:t,spaceStore:Z,contextualInviteStore:T});const D=k.isMobile?{menuType:f.og.Modal,disableHeaderShadow:!0,title:(0,H.jsx)(m.Z,{isMobile:k.isMobile,style:B.title,children:(0,H.jsx)(r.FormattedMessage,{defaultMessage:"Share",id:"blockPermissionsSettings.mobileShareMenu.title"})}),additionalTopbarContent:(0,H.jsx)(ye,{mostPermissivePublicItem:F.mostPermissivePublicItem}),left:(0,H.jsx)(p.Z,{href:(0,h.UY)("guides.sharing"),analyticsFrom:"sharing"}),footer:A===j.XF.Share&&(0,H.jsx)(Lo,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:F,permissionItemArgs:R}),topbarStyle:B.topbarStyle,right:(0,H.jsx)(u.DoneMenuText,{}),onClickRight:e.onClose,whiteBackground:!0}:{menuType:f.og.Popup,maxHeight:"90vh"};return P?(0,H.jsx)(H.Fragment,{children:(0,H.jsx)(c.Z,{...D,className:g.B8p,children:(0,H.jsx)(l.Z,{debugName:"ShareMenuContainer",capture:!0,allowEsc:!0,children:(0,H.jsx)(d.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!1,render:()=>S.Z.state.online?(0,H.jsx)(Qo,{store:t,spaceStore:Z,spaceUserStore:P,permissionItemArgs:R,calculatedPermissions:F,buttonPopupStore:e.buttonPopupStore,inviteTargetsStore:e.inviteTargetsStore,contextualInviteStore:T}):(0,H.jsx)(Jo,{})})})})}):null}},376719:(e,t,n)=>{n.d(t,{U:()=>d});var s=n(800480),i=n(886628),o=n(519889),a=n(401898),r=n(206258),l=n(88893);function d(e){const t=(0,s.O7)();return(0,i.VK)((()=>{const n=e.state;if(!n)return{memberEmails:new Set,guestEmails:new Set};const s=l.hn(n),i=l.ND(n),d=e=>new r.U6(t,{table:o.KJ,id:e.userId}).getEmail();return{memberEmails:new Set(s.map(d).filter(a.$K)),guestEmails:new Set(i.map(d).filter(a.$K))}}),[t,e])}},922756:(e,t,n)=>{n.d(t,{Z:()=>r});var s=n(749085),i=n(292595);class o extends s.default{getInitialState(){return{isModalOpen:!1,currentTab:"selectData",account:void 0,isAccountLinkingInProgress:!1,isAccountDelinkingInProgress:!1,workspaces:[],teamsAndProjects:[],selectedWorkspace:void 0,selectedProjectsAndTeamspaces:{},importCompletedTasks:!0,teams:void 0,loadMoreClicks:0,isLoadingProjects:!1,isLoadingAsanaWorkspaces:!1,result:void 0,isComplete:!1,loggerPageId:void 0,templateCreationInProgress:!1,isFetchingAsanaAccount:!1,choosingWorkspacesCompleted:!1}}resetImport(){const{account:e,workspaces:t}=this.getState();this.setState({...this.getInitialState(),account:e,workspaces:t})}}const a=new o,r=a;(0,i.exposeDebugValue)("AsanaImportStore",a)},279827:(e,t,n)=>{n.r(t),n.d(t,{CalloutGroupStore:()=>o,default:()=>r});var s=n(749085),i=n(79571);class o extends s.default{getInitialState(){return new Set}add(e){this.setState(new Set(this.state).add(e))}delete(e){const t=new Set(this.state);t.delete(e),this.setState(t)}has(e){return this.state.has(e)}clear(){this.setState(new Set)}}class a extends s.default{getInitialState(){return{placementStores:{Modal:new o,SidebarFooter:new o},forcedCalloutsStore:new o}}getCalloutVisibility(e){const t=(0,i.QN)(e);return{isEligible:this.state.placementStores[t].has(e),isForced:this.state.forcedCalloutsStore.has(e)}}isForced(e){return this.state.forcedCalloutsStore.has(e)}getCalloutsForPlacement(e){return Array.from(this.state.placementStores[e].state)}}const r=new a},200758:(e,t,n)=>{n.d(t,{P:()=>c,x:()=>d});var s=n(927117),i=n.n(s),o=n(554153),a=n(653965),r=n(247839);const l="spellcheckEnabled";function d(e){return e instanceof c}class c{constructor(e){this.langCache=new(i())(100),this.enabled=void 0,this.currentInputElement=void 0,this.handleSelectionChange=()=>{if(this.enabled){const e=this.getInputElement();e&&e!==this.currentInputElement?(this.currentInputElement=e,this.handleDetectLanguageChange(e)):e&&this.handleDetectLanguageChangeThrottled(e)}},this.handleDetectLanguageChange=e=>{const t=e.textContent;if(t){let e=this.detectLanguages(t);void 0!==e&&(e=e.map((e=>navigator.language.startsWith(e)?navigator.language:e))),this.setLanguages(e)}},this.handleDetectLanguageChangeThrottled=a.P2(this.handleDetectLanguageChange,500),this.currentLanguages=void 0;const t=o.Z.get(l);this.setEnabled(void 0===t||t);const{isMac:n}=e.device;!n&&r.electronApi&&r.electronApi.loadSpellcheck&&(r.electronApi.loadSpellcheck(),document.addEventListener("selectionchange",this.handleSelectionChange))}setEnabled(e){this.enabled=e,o.Z.set(l,e),r.electronApi&&r.electronApi.setSpellCheckerLanguages&&(e?r.electronApi.setSpellCheckerLanguages(this.getLanguages()):r.electronApi.setSpellCheckerLanguages([]))}isEnabled(){return this.enabled}detectLanguages(e){let t;return this.langCache.cache[e]?(t=this.langCache.get(e),t):(r.electronApi&&r.electronApi.cld&&r.electronApi.cld.detect(e,((e,n)=>{n&&n.reliable&&n.languages&&(t=n.languages.map((e=>e.code)))})),this.langCache.set(e,t),t)}getCorrections(e){return e.dictionarySuggestions}setLanguages(e){a.Xy(this.currentLanguages,e)||(this.currentLanguages=e,r.electronApi&&r.electronApi.setSpellCheckerLanguages&&r.electronApi.setSpellCheckerLanguages(e||[]))}getInputElement(){const e=document.activeElement;if(e instanceof HTMLElement&&("input"===e.tagName||"true"===e.contentEditable))return e}getLanguages(){return navigator.languages.filter((e=>e.includes("-")))}}},517549:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(749085);class i extends s.default{getInitialState(){return{open:!1}}}const o=new i},598185:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(749085);class i extends s.default{getInitialState(){return{open:!1}}}const o=new i},485680:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(749085);class i extends s.default{getInitialState(){return{isOpen:!1}}}const o=new i},52507:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(749085);class i extends s.default{getInitialState(){return{modalOpen:!1,loading:!1,domainVerification:void 0}}}const o=i},845214:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(749085);class i extends s.default{getInitialState(){return{open:!1}}}const o=new i},325775:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(749085);class i extends s.default{getInitialState(){return{loading:!1,areAccountsFetched:!1,accountsResponse:{accounts:[]}}}}const o=new i},146096:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(749085);class i extends s.default{getInitialState(){return{open:!1}}}const o=new i},78900:(e,t,n)=>{n.d(t,{Z:()=>s});const s=new(n(61766).Z)},770681:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(749085);class i extends s.default{getInitialState(){return{open:!1}}}const o=new i},369122:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(749085);class i extends s.default{getInitialState(){return{isModalOpen:!1,account:void 0,workspaces:[],isLoadingProjects:!1,mondayFoldersAndBoards:[],selectedProjectsAndTeamspaces:{},templateCreationInProgress:!1,currentTab:"selectData",loggerPageId:void 0,showAuthPopup:!1,email:void 0,APIToken:void 0,result:void 0,isComplete:!1,selectedWorkspace:void 0,isLoadingMondayWorkspaces:!1,isFetchingMondayAccount:!1}}resetImport(){const{account:e,workspaces:t}=this.getState();this.setState({...this.getInitialState(),account:e,workspaces:t})}}const o=new i},625399:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(749085);class i extends s.default{getInitialState(){return{open:!1}}}const o=new i},21884:(e,t,n)=>{n.d(t,{E:()=>s});const s=n(749085).default.createValue({showConvertTooltip:!1,forceShow:!1},{name:"WikiPromoStore"})},727533:(e,t,n)=>{n.d(t,{W:()=>a});n(667294);var s=n(894919),i=n(709291),o=n(785893);function a(e){const t=(0,i.useIntl)();return(0,o.jsx)(s.W,{...e,intl:t})}},28833:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ce,isCancellationStage:()=>le,isConfirmPurchaseStage:()=>re,isLimitReachedStage:()=>ae});n(21703);var s=n(667294),i=n(313991),o=n(800480),a=n(886628),r=n(724405),l=n(841892),d=n(407057),c=n(964275),u=n(844495),m=n(909182),p=n(306995),g=n(500896),f=n(647425),h=n(709291),y=n(531701),x=n(401898),S=n(137810),v=n(547307),b=n(164964),M=n(411066),j=n(568785),C=n(158297),w=n(292660),k=n(942402),I=n(352533),T=n(918514),Z=n(548779),P=n(80444),F=n(194160),_=n(480671),A=n(897630),B=n(140469),R=n(44041),D=n(681886),O=n(740670),L=n(843163),V=n(88893),E=n(535057),N=n(163423),U=n(333493),K=n(288280),W=n(727533),z=n(785893);function q(e){const{addOnFeature:t,canPurchaseAddOn:n,isSubscribed:s}=e,i=oe(),a=(0,o.O7)();return n&&s?(0,z.jsx)(G,{addOnFeature:t,canPurchaseAddOn:n}):(0,z.jsxs)(z.Fragment,{children:[(0,u.D)(i.icon),(0,z.jsx)($,{addOnFeature:t,canPurchaseAddOn:n}),(0,z.jsx)(Y,{addOnFeature:t,canPurchaseAddOn:n}),(0,z.jsx)(C.Z,{isLarge:!0,style:i.button,onClick:async()=>n?s?_.Cl(void 0):async function(e,t,n){await R.y(e,{from:"plans_page",for:n,addOnFeature:t}),_.v5()}(a,t,"free"):_.v5(),children:n?(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.purchase.button.label",defaultMessage:"Purchase"}):(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function G(e){var t,n;const{addOnFeature:s,canPurchaseAddOn:i}=e,r=(0,o.O7)(),d=oe(),c=(0,a.VK)((()=>(0,E.zt)()),[]),u=(0,a.VK)((()=>K.subscriptionDataStoreInstance.state),[]),m=(0,a.VK)((()=>N.Z.state.open?N.Z.state.coupon:null),[]),p=(0,a.VK)((()=>P.default.state.currentSpaceStore),[]);if(!p)return null;const g=(0,I.S$)({environment:r})&&(0,f.QR)(c);if(r.device.isMobileNative&&!g)return null;let y;if(!u||"unsubscribed_admin"!==u.type&&"subscribed_admin"!==u.type||(y=u),y&&"revenueCat"===(null===(t=y.customerData)||void 0===t?void 0:t.activeSubscriptionPlatform)){const e=(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.errorMessage.switchPlanFromInAppPurchase",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."});return v.showErrorMessage(e),null}const S=(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.errorMessage.notAdmin",defaultMessage:"You don't have permissions to upgrade this workspace to an add-on. If you think this is a mistake please contact your administrator."});if(!(0,V.GJ)(u))return v.showErrorMessage(S),null;const b=null===(n=y)||void 0===n||null===(n=n.customerData)||void 0===n?void 0:n.stripe;if(!b)return null;const M=b.isSubscribed?b.interval:"month",j=m?function(e){if("ai_fifty_percent"===e)return(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.coupon.fiftyPercent.label",defaultMessage:"50% off discount"});(0,x.t1)(e)}(m):"year"===M?(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.coupon.twentyPercent.label",defaultMessage:"20% off discount"}):null;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("img",{src:l.Z.images.pricing.aiLogoPng,style:d.aiLogo}),(0,z.jsx)($,{addOnFeature:s,canPurchaseAddOn:i}),(0,z.jsx)(Q,{addOnFeature:s}),j?H(j):null,(0,z.jsx)(J,{addOnFeature:s,interval:M,stripeData:b,spaceStore:p})]})}function H(e){const t=oe();return(0,z.jsx)(M.Z,{style:{...t.sharedStyleForDiscountBadge},disabled:!0,children:(0,z.jsx)("div",{style:{...t.innerStyleForDiscountBadge},children:e})})}function $(e){const{addOnFeature:t,canPurchaseAddOn:n}=e,s=oe();let i;switch(t){case"ai":i=n?(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.title.admin",defaultMessage:"Get more Notion AI"}):(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"You've used up all free AI responses in your plan"});break;case"sites_custom_hostnames":throw new Error("not implemented");default:(0,x.t1)(t)}return(0,z.jsx)("h3",{style:s.title,children:i})}function Y(e){const{addOnFeature:t,canPurchaseAddOn:n}=e;let s;const i=oe();switch(t){case"ai":s=n?(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.description.admins",defaultMessage:"Your one-time promotion has ran out. To continue using AI features, purchase more AI uses for your workspace"}):(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.description.nonAdmins",defaultMessage:"Your workspace’s one-time Notion AI promotion is over. Contact a workspace admin to purchase unlimited AI for your team to use."});break;case"sites_custom_hostnames":throw new Error("not implemented");default:(0,x.t1)(t)}return(0,z.jsx)("p",{style:i.paragraph,children:(0,z.jsx)("div",{style:i.text,children:s})})}function Q(e){const{addOnFeature:t}=e;let n;const s=(0,o.O7)(),i=oe(),r=(0,a.VK)((()=>P.default.state.currentSpaceStore),[]);if(!r)return null;const l=(0,a.VK)((()=>(0,Z.rn)(s,r)),[s,r]);switch(t){case"ai":n=(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.description.admins",defaultMessage:"Go unlimited with Notion AI for all members in {spaceName}.",values:{spaceName:l}});break;case"sites_custom_hostnames":throw new Error("not implemented");default:(0,x.t1)(t)}return(0,z.jsx)("p",{style:i.paragraph,children:(0,z.jsx)("div",{style:i.text,children:n})})}function J(e){const{addOnFeature:t,interval:n,stripeData:i,spaceStore:r}=e,l=oe(),d=(0,o.O7)(),c=(0,a.VK)((()=>(0,V.qX)()),[]),u=i.currencyCode??"USD",{tax:g,coupon:f}=(0,a.VK)((()=>({tax:N.Z.state.open?N.Z.state.tax:0,coupon:N.Z.state.open?N.Z.state.coupon:void 0})),[]),y=(0,a.VK)((()=>U.Z.getPrice(d,(e=>e.product===t&&e.billingInterval===n&&e.currencyCode===u))),[t,d,n,u]),x=(0,a.VK)((()=>U.Z.getPrice(d,(e=>e.product===t&&"month"===e.billingInterval&&e.currencyCode===u))),[t,u,d]);if((0,s.useEffect)((()=>{!async function(){if(y.result&&i&&i.address){const e=y.result.getCostPerBillingInterval({quantity:c,coupon:f}).amount;await B.nf({environment:d,priceForTaxCalculation:e,address:i.address,customerId:i.customerId,vatId:i.vatId})}}()}),[d,i,y,c,f]),!y.isLoaded||!x.isLoaded)return(0,z.jsx)(j.Z,{});if(!y.result||!x.result)return null;const S=y.result,v=S.getCostPerBillingInterval({quantity:c,coupon:f}).withAddedAmount(g),M=x.result,w=M.getMonthlyUnitCost();let I=M.getMonthlyCost({quantity:c});"year"===n&&(I=I.withMultipliedAmount(12));const{addOnCostItem:Z,addOnCostItemWithMembers:P}=(0,D.OL)(t,c,n,(0,z.jsx)(W.W,{cost:w.toMoneyValue(),trailingZeroDisplay:"stripIfInteger"}));return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("p",{style:l.monthlyCostText,children:[(0,z.jsx)("h3",{style:l.title,children:(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.monthlyCost.title",defaultMessage:"Add on"})}),(0,z.jsxs)("div",{style:l.costSectionTitle,children:[(0,z.jsx)("div",{children:Z}),(0,z.jsx)("div",{style:l.rightAlign,children:(0,z.jsx)(W.W,{cost:I.toMoneyValue(),trailingZeroDisplay:"auto"})})]}),(0,z.jsx)("div",{style:l.costSection,children:P}),(0,z.jsx)(X,{cost:S.getCostPerBillingInterval({quantity:c}),fullCost:I}),(0,z.jsx)(ee,{price:S,coupon:f,quantity:c}),(0,z.jsxs)("div",{style:l.costSection,children:[(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.taxes",defaultMessage:"Taxes:"}),(0,z.jsx)("div",{style:l.rightAlign,children:(0,z.jsx)(W.W,{cost:{amount:g,currencyCode:u},trailingZeroDisplay:"auto"})})]}),(0,z.jsxs)("div",{style:l.totalCostSection,children:[(0,z.jsx)("h3",{style:l.title,children:(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.total",defaultMessage:"Total"})}),(0,z.jsx)("div",{style:l.rightAlign,children:(0,z.jsx)("h3",{style:l.title,children:(0,z.jsx)(W.W,{cost:v.toMoneyValue(),trailingZeroDisplay:"auto"})})})]}),(0,z.jsx)("div",{style:l.perMonth,children:(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.interval.label",defaultMessage:"{interval, select, month {per month} other {per year}}",values:{interval:n}})})]}),(0,z.jsx)(C.Z,{isLarge:!0,style:l.button,onClick:async()=>{const e=await F.Z.awaitData(d,{spaceId:r.id});if(!e)throw new Error("Billing data not loaded");const n=(0,m.Lg)(e),s=(0,p.AI)(n,{price:S,quantity:c});await A.Mg({environment:d,spaceStore:r,from:"add_on_upgrade_modal",desiredState:s,inAppOffer:f}),_.v5();const i=O.aQ({addOnFeature:t});i&&b.oV(i)},children:(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.confirmPurchase.button.label",defaultMessage:"Confirm purchase"})}),(0,z.jsx)("p",{style:l.termsOfService,children:(0,z.jsx)("div",{style:l.text,children:(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.prorated.description",defaultMessage:"Performance subject to <fairUsePolicies>fair use policies</fairUsePolicies>.{br}By clicking Confirm Purchase you agree to the <terms>Notion AI Supplementary Terms</terms>.",values:{br:(0,z.jsx)("br",{}),fairUsePolicies:e=>(0,z.jsx)(k.Z,{href:(0,T.UY)("ai.fairUsePolicies"),children:e}),terms:e=>(0,z.jsx)(k.Z,{href:(0,T.UY)("ai.terms"),children:e})}})})})]})}function X(e){const t=oe(),{cost:n,fullCost:s}=e;if(n.amount===s.amount)return null;const i=s.minus(n),o=Math.floor(i.amount/s.amount*100);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{style:t.costSectionTitle,children:[(0,z.jsx)("div",{children:(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.annual.dynamicDiscountMessage",defaultMessage:"<bold>Annual discount ({discountPercent}%)</bold>",values:{bold:e=>(0,z.jsx)("b",{children:e}),discountPercent:o}})}),(0,z.jsx)("div",{style:t.greenRightAlign,children:(0,z.jsx)(W.W,{cost:i.withMultipliedAmount(-1).toMoneyValue(),trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,z.jsx)("div",{style:t.costSection,children:(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.annualPlanMessage",defaultMessage:"for being on the annual plan"})})]})}function ee(e){const t=oe(),{price:n,coupon:s,quantity:i}=e;if(!(0,g.pp)(s))return null;const o=n.getDiscountPerBillingInterval({quantity:i,coupon:s}).withMultipliedAmount(-1);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{style:t.costSectionTitle,children:[(0,z.jsx)("div",{children:(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount",defaultMessage:"<bold>Special discount ({percentage})</bold>",values:{bold:e=>(0,z.jsx)("b",{children:e}),percentage:(0,L.o)(s)}})}),(0,z.jsx)("div",{style:t.greenRightAlign,children:(0,z.jsx)(W.W,{cost:o,trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,z.jsx)("div",{style:t.costSection,children:(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.threeMonthsMessage",defaultMessage:"for the next 3 months"})})]})}function te(e){const{addOnFeature:t}=e,n=oe(),s=(0,o.O7)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{style:n.buttonWithTopPadding,children:(0,z.jsx)(M.Z,{style:n.redButton,hoveredStyle:{background:y.ZP.redWithAlpha(.8)},onClick:async()=>{const e=(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.cancellationStage.errorMessage",defaultMessage:"Unable to cancel add-on subscription. Please try again later."}),n=P.default.state.currentSpaceStore;if(!n)return v.showErrorMessage(e);const i=await F.Z.awaitData(s,{spaceId:n.id});if(!i)throw new Error("Billing data not loaded");const o=(0,m.Lg)(i),a=(0,p.t4)(o,t);await A.Mg({environment:s,spaceStore:n,from:"add_on_upgrade_modal",desiredState:a}),_.v5()},children:(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.midterm.yesButton.label",defaultMessage:"Schedule removal"})})}),(0,z.jsx)("div",{style:n.buttonWithTopPadding,children:(0,z.jsx)(M.Z,{style:n.noButton,onClick:()=>_.v5(),children:(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.noButton.label",defaultMessage:"Cancel"})})})]})}function ne(e){const{data:t}=e,n=oe();let s;if("subscribed_admin"===t.type||"unsubscribed_admin"===t.type){var o;const e=null===(o=t.customerData)||void 0===o?void 0:o.stripe;s=null==e?void 0:e.periodEnd}return s?(0,z.jsx)("p",{style:n.paragraph,children:(0,z.jsx)("div",{style:n.text,children:(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellation.description",defaultMessage:"Thank you for your input! You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. You can resubscribe anytime.",values:{periodEnd:(0,d.Yx)(s,"long",i.SP),bold:e=>(0,z.jsx)("b",{children:e})}})})}):null}function se(e){const{addOnFeature:t,canPurchaseAddOn:n,data:s}=e,i=oe();if(!n)return null;let o;switch(t){case"ai":o=(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellation.title.ai",defaultMessage:"Remove AI at the end of your billing period?"});break;case"sites_custom_hostnames":o=(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellation.title.sites",defaultMessage:"Remove Custom domains at the end of your billing period?"});break;default:(0,x.t1)(t)}return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("h3",{style:i.cancellationTitle,children:o}),(0,z.jsx)(ne,{data:s}),(0,z.jsx)(te,{data:s,addOnFeature:t})]})}function ie(){const e=oe(),t=(0,o.O7)();let n=(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.mobileMessage.button.label",defaultMessage:"Use the web or desktop app to add Notion AI to your plan and go unlimited."});return(t.device.isIOS||t.device.isIpad)&&(n=(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.mobileMessage.ios.button.label",defaultMessage:"Unlimited AI cannot be purchased on mobile."})),(0,z.jsxs)(z.Fragment,{children:[(0,u.D)(e.icon),(0,z.jsx)("h3",{style:e.title,children:(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"You've used up all free AI responses in your plan"})}),(0,z.jsx)("p",{style:e.paragraph,children:(0,z.jsx)("div",{style:e.text,children:n})}),(0,z.jsx)(C.Z,{isLarge:!0,style:e.button,onClick:()=>_.v5(),children:(0,z.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function oe(){return(0,r.yK)((e=>({modal:{maxWidth:350,padding:24,fontSize:14,textAlign:"center"},largeModal:{maxWidth:420,padding:24,fontSize:14,textAlign:"center"},mobileModal:{padding:24,fontSize:14,textAlign:"center"},cancellationModal:{maxWidth:350,padding:"24px 16px 12px",fontSize:14,textAlign:"center"},innerModalPadding:{padding:"0px 8px"},cancellationInnerModalPadding:{padding:0},innerStyle:{borderRadius:10},title:{margin:0,marginBottom:0},cancellationTitle:{margin:0,marginBottom:0,marginTop:14},monthlyCostText:{textAlign:"left",paddingBottom:16},costSection:{margin:0,marginBottom:8,display:"flex",color:e.mediumTextColor},costSectionTitle:{display:"flex",color:e.mediumTextColor},totalCostSection:{display:"flex"},paymentMethodSection:{marginBottom:8,marginTop:8,display:"flex"},rightAlign:{position:"absolute",right:24},greenRightAlign:{position:"absolute",right:24,color:e.invoiceGreen},paragraph:{lineHeight:1.4,marginTop:4,marginBottom:12},termsOfService:{fontSize:"small",marginTop:8},text:{margin:0,color:e.mediumTextColor,marginBottom:8},icon:{display:"inline",height:24,fill:e.lightIconColor,marginTop:8,marginBottom:8},aiLogo:{height:60},button:{width:"100%"},buttonWithTopPadding:{paddingTop:12},noButton:{width:"100%",height:24,display:"inline-flex",alignItems:"center",justifyContent:"center"},cancelButton:{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},redButton:{width:"100%",color:y.ZP.white,background:e.redBadgeBackground,display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,borderRadius:4,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontWeight:S.Z.fontWeight.medium},closeIcon:{width:14,fill:e.mediumTextColor},hovered:{background:e.buttonPressedBackground},perMonth:{position:"absolute",right:24,display:"flex",color:e.mediumTextColor,marginTop:-4},sharedStyleForDiscountBadge:{display:"inline-flex",alignItems:"center",borderRadius:4},innerStyleForDiscountBadge:{padding:"2px 6px",borderRadius:4,color:e.regularTextColor,background:e.accentColors.gray[50],fontWeight:400,fontSize:14,lineHeight:"16px",letterSpacing:"0.04em",whiteSpace:"nowrap"}})),[])}function ae(){return de("limit_reached")}function re(){return de("confirm_purchase")}function le(){return de("cancel_plan")}function de(e){const t=N.Z.state;if(t.open)return t.stage===e}const ce=function(e){const{data:t}=e,n=(0,V.GJ)(t),s=oe(),i=V.YK(t),r=(0,o.O7)(),{isOpen:l,addOnFeature:d}=(0,a.VK)((()=>{const{state:e}=N.Z;return{isOpen:e.open,addOnFeature:e.addOnFeature}}),[]);return r.device.isMobile?(0,z.jsx)(w.Z,{innerStyle:s.innerStyle,isOpen:l,onDismiss:()=>_.v5(),render:()=>(0,z.jsx)("div",{style:s.mobileModal,children:(0,z.jsx)("div",{style:s.innerModalPadding,children:(0,z.jsx)(ie,{})})})}):(0,z.jsx)(w.Z,{innerStyle:s.innerStyle,isOpen:l,onDismiss:()=>_.v5(),render:()=>(0,z.jsx)("div",{style:re()||ae()&&i&&n?s.largeModal:le()?s.cancellationModal:s.modal,children:(0,z.jsxs)("div",{style:le()?s.cancellationInnerModalPadding:s.innerModalPadding,children:[(0,z.jsx)(M.Z,{onClick:()=>{_.v5()},style:s.cancelButton,hoveredStyle:s.hovered,children:(0,c.D)(s.closeIcon)}),ae()&&d&&(0,z.jsx)(q,{addOnFeature:d,canPurchaseAddOn:n,isSubscribed:i}),re()&&d&&(0,z.jsx)(G,{addOnFeature:d,canPurchaseAddOn:n}),le()&&d&&(0,z.jsx)(se,{addOnFeature:d,canPurchaseAddOn:n,data:t})]})})})}},756684:(e,t,n)=>{n.d(t,{r:()=>r});n(667294);var s=n(699884),i=n(785893);const o=406,a=300;function r(e){let{step:t,isOpen:n,onClose:r,children:l}=e;return(0,i.jsx)(s.c,{areaConstraint:{width:{type:"min",length:"confirmation"===t?a:o},height:{type:"unlimited",scroll:"allow"}},isOpen:n,onDismiss:r,animateSizeTransition:"confirmation"!==t,render:()=>l})}},168028:(e,t,n)=>{n.d(t,{AF:()=>l,oR:()=>B,ud:()=>J,hy:()=>ie,tt:()=>ce});var s=n(667294),i=n(679956),o=n(709291),a=n(382914),r=n(785893);function l(e){let{title:t,formattedPeriodEndDate:n}=e;return(0,r.jsx)(a.sR,{header:(0,r.jsx)(a.vI,{iconAndTitle:(0,r.jsx)(a.kC,{iconGroup:i.F,title:t}),description:(0,r.jsx)("div",{style:{maxWidth:260},children:(0,r.jsx)(o.FormattedMessage,{id:"downgradeFlow.confirmationStep.description",defaultMessage:"You can still utilize all the features of your current plan until {hasEndDate, select, true {{date}} other {the end of your billing period}}. You can resubscribe or switch to another plan anytime.",values:{hasEndDate:!!n,date:(0,r.jsx)("span",{style:{fontWeight:590},children:n})}})})}),footer:null})}var d=n(724405),c=n(965991),u=n(605336),m=n(742696),p=n(963222),g=n(350066),f=n(747409),h=n(920669),y=n(788507),x=n(226939),S=n(725651),v=n(128495),b=n(636312),M=n(376994),j=n(647425),C=n(707124),w=n(843163),k=n(88893),I=n(732566),T=n(689024);function Z(e){let{title:t,tint:n,features:s}=e;const i=F(n),o="red"===n?"uiRedPrimary":"uiBluePrimary";return(0,r.jsxs)(T.jX,{gap:10,padding:"14px 12px",style:i.container,children:[(0,r.jsx)(C.q,{styleName:"Body-13px/Semibold",colorName:o,children:t}),(0,r.jsx)(T.jX,{gap:10,children:s.map(((e,t)=>(0,r.jsx)(P,{feature:e,tint:n},`feature-${t}`)))})]})}function P(e){let{feature:t,key:n,tint:s}=e;const i=F(s),o="red"===s?"uiRedPrimary":"uiBluePrimary",a=t.beforeMessage&&t.message;return(0,r.jsxs)(T.jX,{direction:"row",gap:4,align:"center-left",children:[t.icon({...i.icon,...t.iconStyle??{}}),t.beforeMessage?(0,r.jsx)(C.q,{styleName:"Body-14px/Regular",colorName:"secondary",customStyles:{textDecoration:"line-through"},children:t.beforeMessage}):null,a?(0,I.k)(i.arrowIcon):null,t.message?(0,r.jsx)(C.q,{styleName:"Body-14px/Regular",colorName:o,children:t.message}):null]},n)}function F(e){return(0,d.yK)((t=>({container:{background:"red"===e?t.tint.uiRed:t.tint.uiBlue,borderRadius:6},icon:{display:"flex",height:void 0,width:16,color:t.icon.secondary},arrowIcon:{width:12,height:12,color:t.icon.secondary}})),[e])}const _={plus:["unlimited_synced_databases","unlimited_file_uploads","version_history_30"],business:["saml","version_history_90","private_teamspaces"],enterprise:["scim","audit_log","security"],ai:["ai_writer","qa","autofill"]},A={unlimited_synced_databases:{message:(0,r.jsx)(o.FormattedMessage,{id:"churnSurvey.features.unlimited_synced_databases",defaultMessage:"Unlimited synced databases"}),icon:m.t},unlimited_file_uploads:{message:(0,r.jsx)(o.FormattedMessage,{id:"churnSurvey.features.unlimited_file_uploads",defaultMessage:"Unlimited file uploads"}),icon:g.R},version_history_30:{message:(0,r.jsx)(o.FormattedMessage,{id:"churnSurvey.features.versionHistory",defaultMessage:"30 day version history"}),icon:u.r},saml:{message:(0,r.jsx)(o.FormattedMessage,{id:"churnSurvey.features.saml",defaultMessage:"SAML SSO"}),icon:v.v},private_teamspaces:{message:(0,r.jsx)(o.FormattedMessage,{id:"churnSurvey.features.privateTeamspaces",defaultMessage:"Private teamspaces"}),icon:y.I},version_history_90:{message:(0,r.jsx)(o.FormattedMessage,{id:"churnSurvey.features.versionHistory.90",defaultMessage:"90 day version history"}),icon:M.w},scim:{message:(0,r.jsx)(o.FormattedMessage,{id:"churnSurvey.features.scim",defaultMessage:"SCIM"}),icon:b.o},audit_log:{message:(0,r.jsx)(o.FormattedMessage,{id:"churnSurvey.features.auditLog",defaultMessage:"Audit log"}),icon:f.N},security:{message:(0,r.jsx)(o.FormattedMessage,{id:"churnSurvey.features.securityAndControls",defaultMessage:"Advanced security and controls"}),icon:x.c},autofill:{message:(0,r.jsx)(o.FormattedMessage,{id:"churnSurvey.features.autofill",defaultMessage:"Autofill for easy database updates"}),icon:h.y},ai_writer:{message:(0,r.jsx)(o.FormattedMessage,{id:"churnSurvey.features.aiWriter",defaultMessage:"Writer to brainstorm new ideas"}),icon:S.R},qa:{message:(0,r.jsx)(o.FormattedMessage,{id:"churnSurvey.features.q&a",defaultMessage:"Q&A to quickly find info and answers"}),icon:p.a}};function B(e){let{currentProduct:t,newProduct:n,coupon:s,onSubmit:i,secondaryButtonMessage:l}=e;const c=(0,w.o)(s),u=(0,w.W)(s),m=(0,d.yK)((e=>({icon:{color:e.icon.uiBlueSecondary}})),[]);if("ai"!==t&&!(0,j.mq)(t))return null;const p=_[t].map((e=>({icon:A[e].icon,iconStyle:m.icon,message:A[e].message})));return(0,r.jsx)(a.sR,{header:(0,r.jsx)(R,{currentProduct:t,percentage:c,duration:u}),footer:(0,r.jsx)(D,{onSubmit:i,percentage:c,nextProduct:n,secondaryButtonMessage:l}),children:(0,r.jsx)(Z,{title:(0,r.jsx)(o.FormattedMessage,{id:"churnSurvey.offerSection.description.v2",defaultMessage:"You'll get to keep:"}),tint:"blue",features:p})})}function R(e){let{currentProduct:t,percentage:n,duration:s}=e;const i=(0,o.useIntl)(),l=(0,k.v$)(t,i);return(0,r.jsx)(a.vI,{iconAndTitle:(0,r.jsx)(a.kC,{iconGroup:c.$,title:(0,r.jsx)(o.FormattedMessage,{id:"downgradeFlow.offerStep.header.title",defaultMessage:"{percentage} off your {currentProductMessage} plan",values:{percentage:n,currentProductMessage:l}})}),description:(0,r.jsx)(o.FormattedMessage,{id:"downgradeFlow.offerStep.header.description",defaultMessage:"Get {percentage} off for {duration} if you keep your plan",values:{percentage:n,duration:s}})})}function D(e){let{onSubmit:t,percentage:n,nextProduct:s,secondaryButtonMessage:i}=e;const l=(0,o.useIntl)(),d=(0,k.v$)(s,l);return(0,r.jsx)(a.a6,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:(0,r.jsx)(o.FormattedMessage,{id:"downgradeFlow.offerStep.getDiscountMessage",defaultMessage:"Get {percentage} off",values:{percentage:n}}),onClick:()=>t(!0)}],secondaryButtons:[{buttonType:"secondary",label:(0,r.jsx)(C.q,{children:i??(0,r.jsx)(o.FormattedMessage,{id:"downgradeFlow.continueWithDowngrade",defaultMessage:"Continue downgrade to {nextProductMessage}",values:{nextProductMessage:d}})}),onClick:()=>t(!1)}]})}var O=n(800480),L=n(886628),V=n(745238);const E=(0,V.CZ)("arrowLeftAndRight",{default:{loader:()=>n.e(66931).then(n.bind(n,566931)),size:20},small:{loader:()=>n.e(62548).then(n.bind(n,962548)),size:16},mini:{loader:()=>n.e(19486).then(n.bind(n,519486)),size:14},large:{loader:()=>n.e(87500).then(n.bind(n,87500)),size:24}});var N=n(84267),U=n(286572),K=n(91376),W=n(164921),z=n(449806),q=n(81254),G=n(526388),H=n(825464),$=n(353578),Y=n(333493),Q=n(727533);function J(e){let{initialPlan:t,asyncPriceByProduct:n,onSubmit:i}=e;const l=(0,o.useIntl)(),d=(0,O.O7)(),[c,u]=s.useState(t),m=c===t,p=(0,L.VK)((()=>Y.Z.selectedCurrencyCode),[]),g=s.useMemo((()=>$.cM.map((e=>{const t=l.formatMessage($.mY[e]);if("free"===e)return{label:t,value:e,description:l.formatMessage($.aq.price,{money:(0,r.jsx)(Q.W,{cost:{amount:0,currencyCode:p},trailingZeroDisplay:"stripIfInteger"})})};const s=(0,k.lo)(n[e]);return{label:t,value:e,description:l.formatMessage($.aq.price,{money:s?(0,r.jsx)(Q.W,{cost:s,trailingZeroDisplay:"stripIfInteger"}):"-"})}}))),[n,l,p]);return(0,r.jsx)(a.sR,{header:(0,r.jsx)(X,{}),footer:(0,r.jsx)(ee,{disableSubmit:m,handleSubmit:()=>i(c)}),children:(0,r.jsx)(T.jX,{gap:8,children:g.map((e=>(0,r.jsx)(z.n,{name:"plan-options",selectType:"radio",selectAlign:"right",isSelected:c===e.value,onChange:e=>{return t=e.target.value,void(["free","plus","business","enterprise"].includes(t)&&(u(t),U.j(d,{name:"change_plan_button_clicked",args:{plan_selected:t}})));var t},...e},e.value)))})})}function X(){return(0,r.jsx)(a.vI,{iconAndTitle:(0,r.jsx)(a.kC,{iconGroup:E,title:(0,r.jsx)(o.FormattedMessage,{id:"downgradeFlow.planSelectStep.title",defaultMessage:"Which plan do you want to change to?"})}),description:(0,r.jsxs)(T.jX,{gap:4,direction:"row",align:"center",children:[(0,r.jsx)(o.FormattedMessage,{id:"downgradeFlow.planSelectStep.description",defaultMessage:"Pick one of the following Notion plans"}),(0,r.jsx)(G.Z,{placement:H.u.Bottom,renderTooltip:()=>(0,r.jsx)(o.FormattedMessage,{id:"downgradeFlow.planSelectionStep.planTooltip",defaultMessage:"See all Notion plans"}),render:e=>(0,r.jsx)(W.Z,{style:{borderRadius:2},onClick:()=>K.r$({currentTab:"plans"}),...e,children:(0,r.jsx)(q.x,{iconGroup:N.M,colorName:"tertiary",variantName:"small"})})})]})})}function ee(e){let{disableSubmit:t,handleSubmit:n}=e;return(0,r.jsx)(a.a6,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:(0,r.jsx)(o.FormattedMessage,{id:"downgradeFlow.continue",defaultMessage:"Continue"}),onClick:n,isDisabled:t}],secondaryButtons:[{buttonType:"dismiss"}]})}n(757658);const te=(0,V.CZ)("arrowDownCircled",{default:{loader:()=>n.e(65570).then(n.bind(n,665570)),size:20},small:{loader:()=>n.e(80891).then(n.bind(n,580891)),size:16},mini:{loader:()=>n.e(78023).then(n.bind(n,878023)),size:14},large:{loader:()=>n.e(60710).then(n.bind(n,860710)),size:24}});var ne=n(401898),se=n(602982);function ie(e){let{title:t,description:n,onSubmit:s,restrictionList:i,newProduct:l}=e;const d=(0,se.E)(l);return(0,r.jsx)(a.sR,{header:(0,r.jsx)(a.vI,{iconAndTitle:(0,r.jsx)(a.kC,{iconGroup:te,iconColorName:"uiRedPrimary",title:t}),description:n}),footer:(0,r.jsx)(oe,{onSubmit:s,canChurnImmediately:d}),children:i&&(0,ne.Of)(i)?(0,r.jsx)(Z,{title:(0,r.jsx)(o.FormattedMessage,{id:"churnSurvey.restrictionStep.description",defaultMessage:"Your workspace will be restricted to:"}),tint:"red",features:i}):null})}function oe(e){let{onSubmit:t,canChurnImmediately:n}=e;const s=[{buttonType:"destructive",label:(0,r.jsx)(o.FormattedMessage,{id:"downgradeFlow.restrictionStep.downgrade",defaultMessage:"Downgrade"}),onClick:t}];return n&&s.push({buttonType:"destructive",label:(0,r.jsx)(r.Fragment,{children:"🚧 Downgrade immediately (dev only) 🚧"}),onClick:()=>t({churnImmediately:!0})}),(0,r.jsx)(a.a6,{layout:"vertical",primaryButtons:s,secondaryButtons:[{buttonType:"dismiss"}]})}var ae=n(184747);const re=(0,V.CZ)("bubbleLeftTextBubbleRight",{default:{loader:()=>n.e(49179).then(n.bind(n,149179)),size:20},small:{loader:()=>n.e(74686).then(n.bind(n,174686)),size:16},mini:{loader:()=>n.e(75285).then(n.bind(n,275285)),size:14},large:{loader:()=>n.e(19383).then(n.bind(n,719383)),size:24}});var le=n(842605),de=n(488101);function ce(e){let{onSubmit:t,options:n,description:s}=e;return(0,ae.Z)((()=>de.z.setOptions(n))),(0,r.jsx)(a.sR,{header:(0,r.jsx)(ue,{}),footer:(0,r.jsx)(me,{handleSubmit:()=>t(de.z.toSurveyResult())}),children:(0,r.jsx)(le.m,{store:de.z})})}function ue(e){let{description:t}=e;return(0,r.jsx)(a.vI,{iconAndTitle:(0,r.jsx)(a.kC,{iconGroup:re,title:(0,r.jsx)("div",{style:{padding:"0 24px"},children:(0,r.jsx)(o.FormattedMessage,{id:"downgradeFlow.surveyStep.title",defaultMessage:"We’d love your input to help us make Notion better for everyone"})})}),description:t??(0,r.jsx)(o.FormattedMessage,{id:"downgradeFlow.surveyStep.description",defaultMessage:"Let us know why you’re downgrading"})})}function me(e){let{handleSubmit:t}=e;return(0,r.jsx)(a.a6,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:(0,r.jsx)(o.FormattedMessage,{id:"downgradeFlow.continue",defaultMessage:"Continue"}),onClick:t}],secondaryButtons:[{buttonType:"dismiss"}]})}},602982:(e,t,n)=>{n.d(t,{E:()=>a,n:()=>r});var s=n(65965),i=n(647425),o=(n(95477),n(535057));function a(e){return"free"===e&&["local","staging","development"].includes("production")}function r(e){const t=(0,o.zt)();return(0,i.QM)(e)?(0,i.wP)(t)?s.BE:(0,i.NG)(t)?s.by:s.qQ:"personal"===e?s.rs:(0,i.NG)(e)?s.l2:(0,i.eR)(e)?(0,i.NG)(t)?s._F:s.C5:void 0}},843163:(e,t,n)=>{n.d(t,{W:()=>r,o:()=>a});n(667294);var s=n(709291),i=n(401898),o=n(785893);function a(e){switch(e){case"team_three_months":case"ai_fifty_percent":return(0,o.jsx)(s.FormattedMessage,{id:"coupon.percentage.fiftyPercent",defaultMessage:"50%"});case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return(0,o.jsx)(s.FormattedMessage,{id:"coupon.percentage.tenPercent",defaultMessage:"10%"});default:(0,i.t1)(e)}}function r(e){switch(e){case"team_annual":case"business_annual":case"enterprise_annual":return(0,o.jsx)(s.FormattedMessage,{id:"coupon.duration.twelveMonths",defaultMessage:"12 months"});case"team_three_months":case"business_three_months":case"enterprise_three_months":case"ai_fifty_percent":return(0,o.jsx)(s.FormattedMessage,{id:"coupons.duration.threeMonths",defaultMessage:"3 months"})}}},195014:(e,t,n)=>{n.r(t),n.d(t,{getStripe:()=>x,getStripeAppearanceV2:()=>M,injectStripe:()=>y,isBillingUsingSendInvoice:()=>j,stripeElementLocaleGivenNotionLocale:()=>S,translateStripeError:()=>b,useElementsOptions:()=>v});var s=n(886664),i=n(797894),o=n(667294),a=n(886628),r=n(724405),l=n(924211),d=n(102438),c=n(401898),u=n(137810),m=n(286572),p=n(95477),g=n(80444),f=n(785893);let h=null;function y(e){return function(t){const[n]=o.useState(x);return(0,f.jsx)(s.Elements,{stripe:n,children:(0,f.jsx)(s.ElementsConsumer,{children:n=>{let{stripe:s,elements:i}=n;const o={...t,stripe:s,elements:i};return(0,f.jsx)(e,{...o})}})})}}async function x(){return h||(i.loadStripe.setLoadParameters({advancedFraudSignals:!1}),h=(0,i.loadStripe)(p.default.stripe.key)),h}function S(e){switch(e){case"en-US":return"en";case"ko-KR":return"ko";case"ja-JP":return"ja";case"fr-FR":return"fr-FR";case"de-DE":return"de";case"es-ES":return"es-ES";case"es-LA":return"es-419";case"pt-BR":return"pt-BR";case"zh-CN":return"zh";case"zh-TW":return"zh-TW";case"da-DK":return"da";case"nl-NL":return"nl";case"fi-FI":return"fi";case"nb-NO":return"nb";case"sv-SE":return"sv";default:return"auto"}}function v(e){const t=(0,r.Fg)(),{type:n}=e,s="setup"===n||"subscription"===n?e.currency:void 0,i="subscription"===n?e.amount:void 0,u=(0,a.VK)((()=>{var e;return(null===(e=g.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)||l.al}),[]);return(0,o.useMemo)((()=>{const e={appearance:M(t),locale:S(u)},o={paymentMethodTypes:(0,d.Rb)({currency:s})};switch(n){case"address":return e;case"setup":return{...e,currency:null==s?void 0:s.toLowerCase(),mode:"setup",paymentMethodCreation:"manual"};case"subscription":return{...e,...o,amount:i,currency:null==s?void 0:s.toLowerCase(),mode:"subscription",paymentMethodCreation:"manual",setupFutureUsage:"off_session"};default:(0,c.t1)(n)}}),[t,u,n,s,i])}function b(e,t,n){if(!n.code)return n.message||"";switch(m._q(e,{error:n.code,stripe_decline_code:n.decline_code}),n.code){case"invalid_expiry_year_past":return t.formatMessage({id:"stripeHelpers.invalidExpiryYear.error.message",defaultMessage:"Your card's expiration year is in the past."});case"invalid_cvc":return t.formatMessage({id:"stripeHelpers.invalidCVC.error.message",defaultMessage:"Your card's security code is invalid."});case"invalid_number":return t.formatMessage({id:"stripeHelpers.invalidNumber.error.message",defaultMessage:"Your card number is not a valid credit card number."});case"card_declined":return function(e,t){switch(t){case"expired_card":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.expiredCard",defaultMessage:"Your card was declined because it is an expired card."});case"incorrect_number":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.incorrectNumber",defaultMessage:"Your card was declined because you input an incorrect number."});case"insufficient_funds":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.declinedFunds",defaultMessage:"Your card was declined because of insufficient funds."});case"invalid_cvc":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.invalidCvc",defaultMessage:"Your card was declined because you input an invalid CVC number"});case"invalid_amount":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.invalidAmount",defaultMessage:"Your card was declined because payment amount exceeds the amount that's allowed."});default:return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message",defaultMessage:"Your card was declined."})}}(t,n.decline_code);default:return n.message||""}}function M(e){return{labels:"floating",theme:"dark"===e.mode?"night":"stripe",variables:{spacingGridRow:"8px",spacingGridColumn:"8px",spacingUnit:"4px",spacingTab:"4px",colorPrimary:e.text.primary,colorPrimaryText:e.text.primary,colorText:e.text.primary,colorTextSecondary:e.text.secondary,colorTextPlaceholder:e.text.tertiary,colorIcon:e.text.primary,colorIconCheckmark:e.icon.contrast,colorDanger:e.text.uiRedPrimary,colorBackground:e.whiteButtonBackground,colorIconTabHover:e.text.primary,colorIconTabSelected:e.text.uiBluePrimary,colorIconChevronDown:e.text.primary,fontFamily:u.Z.baseFontFamily.sans,fontWeightLight:`${u.Z.fontWeight.light}`,fontWeightNormal:`${u.Z.fontWeight.regular}`,fontWeightMedium:`${u.Z.fontWeight.medium}`,fontWeightBold:`${u.Z.fontWeight.semibold}`,fontSizeBase:"14px",fontSizeSm:"12px",colorLogo:e.mode,colorLogoBlock:e.mode,colorLogoTab:e.mode,colorLogoTabSelected:e.mode,borderRadius:"6px"},rules:{".Tab":{padding:"10px 16px 10px 10px",fontSize:"13px",fontWeight:"510",lineHeight:"16px",color:e.text.primary,border:`1px solid ${e.stroke.regular}`,boxShadow:"none",backgroundColor:e.whiteButtonBackground},".Tab:hover":{backgroundColor:e.whiteButtonHoveredBackground,color:e.text.primary},".Tab:focus":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.regular}`,boxShadow:e.outlineBlueInputBoxShadow},".Tab--selected, .Tab--selected:hover, .Tab--selected:active":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.uiBlue}`,color:e.text.primary,boxShadow:"none",outline:"none"},".Tab--selected:focus":{border:`1px solid ${e.stroke.uiBlue}`,boxShadow:e.outlineBlueInputBoxShadow},".Input":{fontSize:"14px",lineHeight:"18px",letterSpacing:"-0.154px",padding:"4px 8px",boxShadow:"none",backgroundColor:e.surface.wash,border:`1px solid ${e.stroke.regular}`,color:e.text.primary},".Input--invalid":{border:"none",color:e.text.primary,boxShadow:e.outlineRedInputBoxShadow},".Label":{fontSize:"14px",lineHeight:"18px",letterSpacing:"-0.154px",color:e.text.tertiary},".Label--floating":{fontSize:"10px",fontWeight:"510",lineHeight:"13px",letterSpacing:"0.12px",marginTop:"4px",transition:"all 200ms ease",color:e.text.secondary},".Error":{fontSize:"12px",fontWeight:"400",lineHeight:"15px",color:e.text.uiRedPrimary},".CodeInput":{backgroundColor:e.surface.wash,border:`1px solid ${e.stroke.regular}`,boxShadow:"none"},".PickerItem, .PickerItem--selected":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.regular}`,boxShadow:"none",color:e.text.primary},".PickerItem:hover, .PickerItem--selected:hover":{backgroundColor:e.whiteButtonHoveredBackground,color:e.text.primary,border:`1px solid ${e.stroke.regular}`,boxShadow:"none"},".PickerItem--new":{fontSize:"14px",fontWeight:"500",lineHeight:"18px",color:e.text.primary},".PickerItem--highlight, .PickerItem--highlight:hover":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.uiBlue}`,boxShadow:"none"},".PickerItem--highlight:hover":{backgroundColor:e.whiteButtonHoveredBackground},".TermsText":{color:e.text.secondary,fontSize:"12px",fontWeight:"400",lineHeight:"15px"},".CheckboxLabel":{color:e.text.primary,fontSize:"12px",fontWeight:"500",lineHeight:"15px"},".Action, .MenuAction":{color:e.text.primary,fontWeight:"400"},".Action:hover, .MenuAction:hover":{backgroundColor:e.buttonHoveredBackground},".BlockAction:focus, .CodeInput:focus, .Input:focus,.CheckboxInput:focus, .PickerItem:focus, .PickerAction:focus,.MenuAction:focus, .Action:focus, .SecondaryLink:focus":{boxShadow:e.outlineBlueInputBoxShadow},".MenuIcon, .MenuIcon:hover":{fill:e.text.primary},".Block":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.regular}`,boxShadow:"none",color:e.text.primary}}}}function j(e){return e.isSubscribed&&"send_invoice"===e.billing}},581137:(e,t,n)=>{n.d(t,{T:()=>m,LU:()=>u});n(667294);var s=n(841892),i=n(70954),o=n(709291),a=n(724405),r=n(785893);function l(e){const{size:t}=e,n=(0,a.Fg)();return(0,r.jsxs)("svg",{width:t,height:t,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("rect",{width:"48",height:"48",rx:"8",fill:n.fill.purple}),(0,r.jsx)("path",{d:"M36.78 26.5198C38.38 26.9198 38.38 27.5798 36.78 27.9798L33.24 28.8598C31.64 29.2598 30 30.8998 29.6 32.4998L28.72 36.0398C28.32 37.6398 27.66 37.6398 27.26 36.0398L26.38 32.4998C25.98 30.8998 24.34 29.2598 22.74 28.8598L19.2 27.9798C17.6 27.5798 17.6 26.9198 19.2 26.5198L22.74 25.6398C24.34 25.2398 25.98 23.5998 26.38 21.9998L27.26 18.4598C27.66 16.8598 28.32 16.8598 28.72 18.4598L29.6 21.9998C30 23.5998 31.64 25.2398 33.24 25.6398L36.78 26.5198Z",fill:n.icon.purple}),(0,r.jsx)("path",{d:"M23.04 17.4001C23.56 17.6001 23.56 17.9201 23.04 18.1001L20.22 19.1801C19.7 19.3801 19.12 19.9601 18.94 20.4601L17.86 23.2801C17.66 23.8001 17.34 23.8001 17.16 23.2801L16.08 20.4601C15.88 19.9401 15.3 19.3601 14.8 19.1801L11.98 18.1001C11.46 17.9001 11.46 17.5801 11.98 17.4001L14.8 16.3201C15.32 16.1201 15.9 15.5401 16.08 15.0401L17.16 12.2201C17.36 11.7001 17.68 11.7001 17.86 12.2201L18.94 15.0401C19.14 15.5601 19.72 16.1401 20.22 16.3201L23.04 17.4001Z",fill:n.icon.purple})]})}var d=n(733941);const c=(0,o.defineMessages)({unlimitedBlocksForIndividuals:{id:"SpaceSubscriptionPlans.includes.unlimitedBlocksForIndividuals",defaultMessage:"Unlimited blocks for individuals"},unlimitedBlocksForTeams:{id:"SpaceSubscriptionPlans.includes.unlimitedBlocksForTeams",defaultMessage:"Unlimited blocks for teams"},unlimitedFileUploads:{id:"SpaceSubscriptionPlans.includes.unlimitedFileUploads",defaultMessage:"Unlimited file uploads"},collaborativeWorkspace:{id:"SpaceSubscriptionPlans.includes.collaborativeWorkspaces",defaultMessage:"Collaborative workspace"},integrations:{id:"SpaceSubscriptionPlans.includes.integrations",defaultMessage:"Slack, GitHub, and more integrations"},pageHistory7Days:{id:"SpaceSubscriptionPlans.includes.pageHistory.7",defaultMessage:"7 day page history"},pageHistory30Days:{id:"SpaceSubscriptionPlans.includes.pageHistory.30",defaultMessage:"30 day page history"},pageHistory90Days:{id:"SpaceSubscriptionPlans.includes.pageHistory.90",defaultMessage:"90 day page history"},pageHistoryUnlimited:{id:"SpaceSubscriptionPlans.includes.pageHistory.unlimited",defaultMessage:"Unlimited page history"},guests10:{id:"SpaceSubscriptionPlans.includes.guests.10",defaultMessage:"Invite up to 10 guests"},guests100:{id:"SpaceSubscriptionPlans.includes.guests.100",defaultMessage:"Invite up to 100 guests"},guests250:{id:"SpaceSubscriptionPlans.includes.guests.250",defaultMessage:"Invite up to 250 guests"},guestsCustom:{id:"SpaceSubscriptionPlans.includes.guests.custom",defaultMessage:"Custom guest limits"},aiCredits:{id:"SpaceSubscriptionPlans.includes.aiCredits",defaultMessage:"10 free AI credits"},samlSSO:{id:"SpaceSubscriptionPlans.includes.saml.sso",defaultMessage:"SAML SSO"},userProvisioning:{id:"SpaceSubscriptionPlans.includes.scim",defaultMessage:"User provisioning (SCIM)"},advancedSecurityControls:{id:"SpaceSubscriptionPlans.includes.advancedSecurityControls",defaultMessage:"Advanced security controls"},auditLog:{id:"SpaceSubscriptionPlans.includes.auditLog",defaultMessage:"Audit log"},privateTeamspaces:{id:"SpaceSubscriptionPlans.includes.privateTeamspaces",defaultMessage:"Private Teamspaces"},bulkPdfExport:{id:"SpaceSubscriptionPlans.includes.bulkPdfExport",defaultMessage:"Bulk PDF export"},customerSuccessManager:{id:"SpaceSubscriptionPlans.includes.customerSuccessManager",defaultMessage:"Customer success manager"}}),u={ai:{imageByMode:{light:s.Z.images.pricing.aiLogoPng,dark:s.Z.images.pricing.aiLogoPng},originalImage:{path:s.Z.images.pricing.aiLogoPng,width:100,height:100},planTitle:d.a.ai,highlights:[],highlightsWhenComparedWithPlanBelow:[]},sites_custom_hostnames:{imageByMode:{dark:s.Z.images.pricing.dark.freePlanPng,light:s.Z.images.pricing.light.freePlanPng},originalImage:{path:s.Z.images.pricing.original.freePng,width:108,height:146},planTitle:d.a.sites,highlights:[],highlightsWhenComparedWithPlanBelow:[]},free:{imageByMode:{dark:s.Z.images.pricing.dark.freePlanPng,light:s.Z.images.pricing.light.freePlanPng},originalImage:{path:s.Z.images.pricing.original.freePng,width:108,height:146},planTitle:d.a.freePlan,highlights:[c.unlimitedBlocksForIndividuals,c.collaborativeWorkspace,c.integrations,c.pageHistory7Days,c.guests10],highlightsWhenComparedWithPlanBelow:[]},personal:{imageByMode:{light:s.Z.images.pricing.light.plusPlanPng,dark:s.Z.images.pricing.dark.plusPlanPng},originalImage:{path:s.Z.images.pricing.original.plusPng,width:163,height:168},planTitle:d.a.plusPlan,highlights:[c.integrations,c.unlimitedFileUploads,c.pageHistory30Days,c.guests100],highlightsWhenComparedWithPlanBelow:[]},student:{imageByMode:{light:s.Z.images.pricing.light.freePlanPng,dark:s.Z.images.pricing.dark.freePlanPng},originalImage:{path:s.Z.images.pricing.original.freePng,width:108,height:146},planTitle:d.a.educationPlusPlan,highlights:[c.unlimitedBlocksForIndividuals,c.integrations,c.pageHistory30Days,c.guests100],highlightsWhenComparedWithPlanBelow:[]},plus:{imageByMode:{light:s.Z.images.pricing.light.plusPlanPng,dark:s.Z.images.pricing.dark.plusPlanPng},originalImage:{path:s.Z.images.pricing.original.plusPng,width:163,height:168},planTitle:d.a.plusPlan,highlights:[c.collaborativeWorkspace,c.integrations,c.unlimitedBlocksForTeams,c.unlimitedFileUploads,c.pageHistory30Days,c.guests100],highlightsWhenComparedWithPlanBelow:[]},business:{imageByMode:{light:s.Z.images.pricing.light.businessPlanPng,dark:s.Z.images.pricing.dark.businessPlanPng},originalImage:{path:s.Z.images.pricing.original.businessPng,width:122,height:146},planTitle:d.a.businessPlan,highlights:[c.samlSSO,c.privateTeamspaces,c.bulkPdfExport,c.pageHistory90Days,c.guests250],highlightsWhenComparedWithPlanBelow:[]},enterprise:{imageByMode:{light:s.Z.images.pricing.light.enterprisePlanPng,dark:s.Z.images.pricing.dark.enterprisePlanPng},originalImage:{path:s.Z.images.pricing.original.enterprisePng,width:197,height:206},planTitle:d.a.enterprisePlan,highlights:[c.samlSSO,c.privateTeamspaces,c.bulkPdfExport,c.pageHistoryUnlimited,c.guestsCustom,c.userProvisioning,c.advancedSecurityControls,c.auditLog,c.customerSuccessManager],highlightsWhenComparedWithPlanBelow:[]}};function m(e){var t;const{tier:n,mode:s,onlyShowAddOn:o}=e,a=null===(t=u[n])||void 0===t||null===(t=t.imageByMode)||void 0===t?void 0:t[s];return o?(0,r.jsx)(l,{size:45}):void 0!==a?(0,r.jsx)("img",{role:"presentation",src:a,style:{width:40}}):(0,i.C)({width:34,height:34,marginBottom:14})}},250557:(e,t,n)=>{n.d(t,{AW:()=>d,WT:()=>c});var s=n(800480),i=n(886628),o=n(24433),a=n(893586),r=n(281236),l=n(673254);function d(e){let{space:t,team:n,spaceUser:r,invitees:d}=e;const c=(0,l.oo)({name:"internal_guests",spaceId:null==t?void 0:t.id,spaceUserId:null==r?void 0:r.id,amount:0}),g=(0,l.oo)({name:"guests",spaceId:null==t?void 0:t.id,spaceUserId:null==r?void 0:r.id,amount:0}),f=u(t),h=m(r),y=p(h,n),x=(0,s.O7)();return(0,i.VK)((()=>{if(!(f&&h&&g&&c))return;const e=f.id,t=a.Z.getData(x,{spaceId:e})??[];return(0,o.CR)({space:f,domains:t,team:y,spaceUser:h,invitees:d,internalGuestFeatureAvailability:c,guestFeatureAvailability:g})}),[f,y,c,g,h,d,x])}function c(e){let{space:t,team:n,spaceUser:r,invitees:d,optimism:c="pessimistic"}=e;const g=(0,l.oo)({name:"internal_guests",spaceId:null==t?void 0:t.id,spaceUserId:null==r?void 0:r.id,amount:0}),f=(0,l.oo)({name:"guests",spaceId:null==t?void 0:t.id,spaceUserId:null==r?void 0:r.id,amount:0}),h=(0,s.O7)(),y=u(t),x=m(r),S=p(x,n);return(0,i.VK)((()=>{if(!(y&&x&&f&&g))return;const e=y.id,t=a.Z.getData(h,{spaceId:e})??[];return(0,o.Lw)({space:y,domains:t,team:S,spaceUser:x,invitees:d,optimism:c,guestFeatureAvailability:f,internalGuestFeatureAvailability:g})}),[y,x,h,S,d,f,g,c])}function u(e){const t=(0,s.O7)(),n=(0,i.VK)((()=>null==e?void 0:e.getModel()),[e]),o=(0,i.VK)((()=>{if(null==e||!e.id)return;const n=r.Z.getData(t,{spaceId:e.id});return n?{id:n.id,disable_guests:n.disableGuests,getSettings:()=>({disable_membership_requests:!1,enable_guest_invite_requests:n.enableGuestInviteRequest})}:void 0}),[e,t]);return n??o}function m(e){return(0,i.VK)((()=>null==e?void 0:e.getModel()),[e])??{isMember:()=>!1,isWorkspaceOwner:()=>!1}}function p(e,t){const n=(0,i.VK)((()=>null==t?void 0:t.getModel()),[t]);return(0,i.VK)((()=>null==e?void 0:e.isMember()),[e])?n:{getDisableGuests:()=>!1}}},739284:(e,t,n)=>{n.d(t,{P:()=>d});var s=n(886628),i=n(215010),o=n(548779),a=n(80444),r=n(535057),l=n(404135);function d(){const e=(0,l.m)();return(0,s.VK)((()=>{const t=(0,r.QM)()&&e,n="professional"===(0,i.JF)(),s="team"===(0,o.kO)().intent,l=n||s,d=(0,o.zP)(a.default.state.currentSpaceStore);return t&&l&&(!!d&&d>=14)}),[e])}},515418:(e,t,n)=>{n.r(t),n.d(t,{CreateTeamFromPageConfirmModal:()=>y});n(667294);var s=n(800480),i=n(886628),o=n(724405),a=n(762208),r=n(709291),l=n(137810),d=n(863296),c=n(158297),u=n(292660),m=n(629551),p=n(973466),g=n(366214),f=n(880068),h=n(785893);function y(){const e=(0,s.O7)(),t=(0,r.useIntl)(),n=(0,o.yK)((e=>({modal:{maxWidth:350,padding:24},loopIcon:{height:28,width:28,fill:e.darkTextColor},infoIcon:{height:16,width:16,fill:e.lightIconColor,marginRight:4},title:{marginTop:16,marginBottom:12,color:e.regularTextColor,fontWeight:l.Z.fontWeight.semibold,fontSize:18},description:{color:e.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]),y=(0,i.VK)((()=>g.Z.state.open),[]);return(0,h.jsx)(u.Z,{onDismiss:()=>{g.Z.setState({open:!1})},render:()=>(0,h.jsx)("div",{style:n.modal,children:(0,h.jsxs)(m.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,a.z)(n.loopIcon),(0,h.jsx)("div",{style:n.title,children:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?"})}),(0,h.jsx)("div",{style:n.description,children:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page."})}),(0,h.jsx)(c.Z,{isLarge:!0,style:n.confirmButton,onClick:()=>{if(g.Z.state.open){const{pageStore:n,flowId:s}=g.Z.state;p.Sq({environment:e,intl:t,page:n,flowId:s}),g.Z.setState({open:!1})}},children:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace"})}),(0,h.jsx)(d.Z,{isLarge:!0,style:n.cancelButton,onClick:()=>g.Z.setState({open:!1}),children:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel"})}),(0,h.jsx)(f.Z,{message:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces"}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"})]})}),isOpen:y})}},139538:(e,t,n)=>{n.r(t),n.d(t,{OutlinerTeamOverflow:()=>te,TeamOverflowMenu:()=>ne});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(185397),l=n(552867),d=n(356666),c=n(388437),u=n(713797),m=n(519981),p=n(745238),g=n(785893);const f=(0,p.IU)("personAdmin",{viewBox:"0 0 15 16",svg:(0,g.jsx)("path",{d:"M6.082 7.215a2.71 2.71 0 001.504-.438c.451-.296.811-.69 1.08-1.182a3.352 3.352 0 00.403-1.634 3.21 3.21 0 00-.403-1.6 3.059 3.059 0 00-1.08-1.141A2.776 2.776 0 006.082.796c-.547 0-1.048.143-1.504.43a3.153 3.153 0 00-1.087 1.156 3.195 3.195 0 00-.403 1.593 3.39 3.39 0 00.41 1.627c.269.487.629.88 1.08 1.175a2.71 2.71 0 001.504.438zm0-1.19c-.314 0-.606-.088-.875-.266a1.974 1.974 0 01-.636-.738 2.247 2.247 0 01-.239-1.046c0-.379.08-.718.24-1.019.159-.3.37-.538.635-.71.264-.179.556-.267.875-.267.319 0 .61.086.875.26.264.172.476.41.636.71.16.296.239.634.239 1.012 0 .387-.08.738-.24 1.053-.159.31-.37.556-.635.738a1.508 1.508 0 01-.875.273zm-4.266 7.54h5.948a3.113 3.113 0 01-.082-.752v-.43H1.59c-.082 0-.141-.014-.178-.041-.032-.027-.048-.073-.048-.137 0-.26.105-.56.315-.902.21-.342.512-.673.909-.992.4-.323.893-.59 1.476-.8.588-.213 1.26-.32 2.017-.32a5.648 5.648 0 011.92.328c.17-.42.466-.732.89-.937a6.605 6.605 0 00-1.313-.417 6.856 6.856 0 00-1.497-.157c-.92 0-1.75.139-2.488.417-.739.273-1.372.631-1.9 1.073-.525.442-.928.918-1.21 1.429-.279.51-.418.998-.418 1.463 0 .784.584 1.175 1.75 1.175zm6.843-.731c0 .438.091.804.274 1.1.182.297.469.58.861.848.392.274.907.588 1.545.944a.6.6 0 00.294.082.62.62 0 00.335-.082c.638-.36 1.153-.675 1.545-.944.392-.269.679-.551.861-.847.182-.297.274-.664.274-1.101v-2.468a.979.979 0 00-.137-.54c-.087-.141-.24-.26-.458-.355a17.47 17.47 0 00-.417-.15c-.182-.069-.38-.14-.595-.213-.21-.077-.403-.145-.581-.205a13.002 13.002 0 01-.403-.15 1.263 1.263 0 00-.417-.055c-.146 0-.292.028-.438.082-.077.028-.205.07-.383.13l-.574.198c-.205.073-.399.144-.58.212-.183.064-.32.114-.411.15-.219.096-.374.215-.465.356a1.02 1.02 0 00-.13.54v2.468zm2.598 1.326a.601.601 0 01-.212-.04.416.416 0 01-.178-.124l-1.155-1.244a.671.671 0 01-.096-.178.492.492 0 01-.034-.178c0-.145.048-.264.144-.355a.492.492 0 01.341-.13.485.485 0 01.363.15l.793.869 1.613-2.229a.484.484 0 01.41-.219c.132 0 .246.048.342.144.1.091.15.205.15.342 0 .04-.009.086-.027.136a.463.463 0 01-.075.15l-1.983 2.722c-.086.123-.218.184-.396.184z"})});var h=n(747453);const y=(0,p.IU)("restore",{viewBox:"0 0 18 15",svg:(0,g.jsx)("path",{d:"M8.61427 3.17871C8.292 3.17871 8.02833 3.43506 8.02833 3.75732L8.02833 7.84424C8.02833 8.0127 8.0796 8.15918 8.20411 8.32031L10.0132 10.708C10.2549 11.0229 10.5918 11.0742 10.8921 10.8691C11.1631 10.6787 11.1851 10.3345 10.9653 10.0342L8.52638 6.74561L9.19288 8.79639L9.19288 3.75732C9.19288 3.43506 8.93654 3.17871 8.61427 3.17871ZM8.89259 0C5.28907 0 2.22755 2.62939 1.56105 6.05713L0.521008 6.05713C-0.00633599 6.05713-0.138172 6.41602 0.147473 6.82617L1.7881 9.15527C2.0298 9.49219 2.38136 9.48486 2.61573 9.15527L4.25636 6.81885C4.53468 6.41602 4.40284 6.05713 3.88282 6.05713L2.82814 6.05713C3.45802 3.28857 5.91896 1.25244 8.89259 1.25244C10.98 1.25977 12.811 2.26318 13.9317 3.82324C14.1514 4.12354 14.5029 4.21875 14.8032 4.02832C15.1035 3.85254 15.1841 3.44971 14.9351 3.12744C13.5435 1.25977 11.3609 0 8.89259 0ZM8.89259 14.9414C12.4961 14.9414 15.5576 12.3047 16.2241 8.88428L17.2568 8.88428C17.7842 8.88428 17.9234 8.52539 17.6304 8.11523L15.9971 5.78613C15.7554 5.44922 15.4038 5.45654 15.1694 5.78613L13.5288 8.12256C13.2432 8.52539 13.3823 8.88428 13.9024 8.88428L14.9644 8.88428C14.3272 11.6455 11.8589 13.6963 8.89259 13.6963C6.80519 13.689 4.97413 12.6782 3.85353 11.1182C3.62648 10.8179 3.28224 10.7227 2.97462 10.9058C2.68165 11.0889 2.60109 11.4917 2.85011 11.814C4.24171 13.6816 6.42433 14.9414 8.89259 14.9414Z"})});var x=n(605108),S=n(647425),v=n(364684),b=n(709291),M=n(401898),j=n(62967),C=n(117224),w=n(693405),k=n(748019),I=n(164921),T=n(231945),Z=n(478140),P=n(672495),F=n(526388),_=n(296994),A=n(843250),B=n(460709),R=n(195697),D=n(224646),O=n(455838),L=n(825464),V=n(80444),E=n(61766),N=n(733052),U=n(973466),K=n(109867);function W(e){let{adminStatus:t,accessLevel:n,isArchivedTeam:s}=e;if("adminThatCanPerformPrivilegedActions"===t)return new Set(["join","joinAsOwner"]);if(s)switch(t){case"none":return new Set;case"admin":return new Set("open"===n?["join"]:[]);default:(0,M.t1)(t)}switch(n){case"open":return new Set(["join"]);case"closed":case"private":return new Set;default:(0,M.t1)(n)}}var z=n(382740),q=n(373365),G=n(530297),H=n(411628),$=n(897082),Y=n(564552);const Q=["join","view","add","duplicate","leave","archive","restore"],J=["add"],X=["join","joinAsOwner","upgradeSelfToOwner","leave"],ee=(0,b.defineMessages)({add:{defaultMessage:"Add members",id:"sidebar.outlinerTeamToggleButton.addLabel"},leave:{defaultMessage:"Leave teamspace",id:"sidebar.outlinerTeamToggleButton.leaveLabel"},joinAsOwner:{defaultMessage:"Join as owner",id:"sidebar.outlinerTeamToggleButton.joinAsOwnerLabel"},joinAsMember:{defaultMessage:"Join as member",id:"sidebar.outlinerTeamToggleButton.joinAsMemberLabel"},joinTeamspace:{defaultMessage:"Join teamspace",id:"sidebar.outlinerTeamToggleButton.joinLabel"},upgradeSelfToOwner:{defaultMessage:"Become owner",id:"sidebar.outlinerTeamToggleButton.upgradeSelfToOwnerLabel"},archive:{defaultMessage:"Archive teamspace",id:"sidebar.outlinerTeamToggleButton.archiveLabel"},restore:{defaultMessage:"Restore teamspace",id:"outlinerTeamOverflow.teamActions.restoreLabel"},duplicate:{defaultMessage:"Duplicate teamspace",id:"sidebar.outlinerTeamToggleButton.duplicateLabel"},teamspaceSettings:{defaultMessage:"Teamspace settings",id:"sidebar.outlinerTeamToggleButton.ownerViewLabel"},viewMembers:{defaultMessage:"View members",id:"sidebar.outlinerTeamToggleButton.unjoinedMemberViewLabel"}});function te(e){let{teamStore:t,style:n,from:s,hideJoin:r,onPopupClick:l,onPopupClose:c}=e;const u=(0,i.Fy)(),m=(0,b.useIntl)(),p=(0,o.qz)(void 0,N.Z),f=(0,o.VK)((()=>V.default.state.currentSpaceStore),[]),h=(0,o.qz)(void 0,E.Z),y=(0,i.O7)(),x=(0,o.VK)((()=>(0,D.BH)(y)),[y]),S=(0,a.yK)((e=>({buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,height:20,width:20,...n},icon:{fill:x?e.mediumIconColor:e.sidebarTextColor,width:14,height:14}})),[n,x]),v=m.formatMessage({defaultMessage:"Teamspace settings and members...",id:"sidebar.outlinerTeamToggleButton.tooltip"});return f?u.isMobile?null:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(F.Z,{textWrap:!1,renderTooltip:()=>v,placement:L.u.Bottom,render:e=>(0,g.jsx)(T.ZP,{popupType:T.Z4.Popup,buttonPopupStore:h,alignmentToOrigin:T.vR.Start,originGap:2,renderOrigin:t=>(0,g.jsx)(I.Z,{ariaLabel:v,className:A.qxR,style:S.buttonStyle,mobileFeedback:!1,...e,...t,children:(0,d.o)(S.icon)}),render:e=>(0,g.jsx)(ne,{teamStore:t,permissionsInviteStore:p,onDismiss:e.close,from:s,hideJoin:r,buttonPopupStore:h}),onClick:l,onClose:c})}),(0,g.jsx)(_.Bq,{permissionsInviteStore:p,store:t})]}):null}function ne(e){const{teamStore:t,permissionsInviteStore:n,onDismiss:d,from:p,hideJoin:I,buttonPopupStore:T}=e,_=(0,a.Fg)(),D=(0,i.O7)(),E=(0,a.yK)((()=>({menuItemButton:{minWidth:200},caption:{minWidth:230}})),[]),N=(0,o.VK)((()=>V.default.state.currentSpaceStore),[]),te=(0,Y.e)(t),ne=(0,o.VK)((()=>(0,v.m4)({archived_by:t.getArchivedBy()})),[t]),se=D.currentUser.id,ie=(0,o.VK)((()=>se?t.getTeamRoleForUser(se)??"none":"none"),[se,t]),oe=(0,o.VK)((()=>!(!t.isDefined()||!se)&&Boolean(t.isOwner(se))),[se,t]),ae=(0,$.y)(t.id),re=(0,z.e)(t),{id:le,name:de,isDefault:ce}=(0,o.VK)((()=>({id:t.id,name:t.getName(),isDefault:t.isDefault()})),[t]),ue=(0,q.n)(),me=(0,o.VK)((()=>(0,R.Xq)({environment:D,spaceStore:N})),[N,D]),pe=(0,G.r)(p),ge=function(e){const{isDefault:t,accessLevel:n,settings:s}=(0,o.VK)((()=>({isDefault:e.isDefault(),accessLevel:e.getTeamAccessLevel(),settings:e.getSettings()})),[e]),i="private"===n,a=(0,H.P)(),r=i&&!a?"business":void 0,l=(null==s?void 0:s.disable_public_access)||(null==s?void 0:s.disable_export)||(null==s?void 0:s.disable_guests),d=(0,H.z)(),c=l&&!d?"enterprise":void 0,u=(0,S.bo)([c,r]);if(t)return"isDefault";if(u)return u}(t),fe="isDefault"===(he=ge)?(0,g.jsx)(b.FormattedMessage,{id:"sidebar.outlinerTeamToggleButton.cannotDuplicateDefaultTeamspace",defaultMessage:"Cannot duplicate a default teamspace"}):"business"===he?(0,g.jsx)(b.FormattedMessage,{id:"sidebar.outlinerTeamToggleButton.cannotDuplicateTeamspaceWithBusinessFeaturesOnDowngradedAccount",defaultMessage:"Cannot duplicate a teamspace with settings only allowed on Business plans or above"}):"enterprise"===he?(0,g.jsx)(b.FormattedMessage,{id:"sidebar.outlinerTeamToggleButton.cannotDuplicateTeamspaceWithEnterpriseFeaturesOnDowngradedAccount",defaultMessage:"Cannot duplicate a teamspace with settings only allowed on Enterprise plans or above"}):void 0===he?void 0:(0,M.t1)(he);var he;const ye=(0,o.VK)((()=>t.getTeamAccessLevel()),[t]),xe=(0,s.useCallback)((e=>{C.z(D,{store:t,from:p,option:e})}),[D,t,p]),Se=ae&&!ue,ve=(0,o.VK)((()=>Boolean(null==N?void 0:N.canAdmin())),[N]),{joinLeaveOptionsToShow:be,leaveOptionDisabledState:Me}=function(e){let{teamRole:t,adminStatus:n,isDefaultTeam:s,accessLevel:i,isArchivedTeam:o}=e;switch(t){case"owner":case"member":const e=new Set,a=!o;return a&&e.add("leave"),"owner"!==t&&"adminThatCanPerformPrivilegedActions"===n&&e.add("upgradeSelfToOwner"),{joinLeaveOptionsToShow:e,leaveOptionDisabledState:a&&s?{disabled:!0,disabledReasonKey:"defaultTeam"}:void 0};case"team_level_guest":return{joinLeaveOptionsToShow:new Set,leaveOptionDisabledState:void 0};case"none":return{joinLeaveOptionsToShow:W({adminStatus:n,accessLevel:i,isArchivedTeam:o}),leaveOptionDisabledState:void 0};default:(0,M.t1)(t)}}({teamRole:ie,adminStatus:pe?"adminThatCanPerformPrivilegedActions":ve?"admin":"none",isArchivedTeam:ne,isDefaultTeam:ce,accessLevel:ye}),je=be.has("joinAsOwner"),Ce=pe&&!(1===be.size&&be.has("leave")),we={add:{type:"action",show:!ne&&re,handle:()=>{n.update((e=>({...e,modalOpen:!0})))},title:ee.add,icon:(0,r.a)({width:17})},leave:{type:"action",...Ce&&{colorOverride:_.redBadgeBackground},show:be.has("leave"),handle:()=>{K.s({environment:D,teamStore:t,currentSpaceStore:N,from:p})},title:ee.leave,disabled:Boolean(null==Me?void 0:Me.disabled),icon:(0,m.V)({width:17}),disabledTooltipText:"defaultTeam"===(null==Me?void 0:Me.disabledReasonKey)&&(0,g.jsx)(b.FormattedMessage,{id:"sidebar.outlinerTeamToggleButton.cannotLeaveDefaulTeamTooltip",defaultMessage:"Cannot leave a default teamspace"})},join:{type:"action",show:!I&&be.has("join"),handle:async()=>{if(N)switch(ye){case"open":await K.um({environment:D,teamStore:t,currentSpaceStore:N,from:p,andNavigateToTeamHome:!1});break;case"closed":case"private":await K.wT({environment:D,teamStore:t,currentSpaceStore:N,from:p,action:"joinClosedOrPrivateTeamAsMember"});break;default:(0,M.t1)(ye)}},title:je?ee.joinAsMember:ee.joinTeamspace,icon:(0,h.R)({width:17})},joinAsOwner:{type:"action",show:je,handle:()=>K.wT({environment:D,teamStore:t,currentSpaceStore:N,from:p,action:"joinTeamAsOwner"}),title:ee.joinAsOwner,icon:f({width:17})},upgradeSelfToOwner:{type:"action",show:be.has("upgradeSelfToOwner"),handle:()=>K.wT({environment:D,teamStore:t,currentSpaceStore:N,from:p,action:"upgradeToOwner"}),title:ee.upgradeSelfToOwner,icon:f({width:17})},archive:{type:"action",show:!ne&&oe,colorOverride:_.redBadgeBackground,handle:()=>{!Se&&K.aQ({teamStore:t,environment:D,from:p})},title:ee.archive,disabled:Se,disabledTooltipText:(0,g.jsx)("div",{style:{whiteSpace:"normal"},children:(0,g.jsx)(b.FormattedMessage,{id:"sidebar.outlinerTeamToggleButton.cannotArchiveTooltip.moreThanOneMember",defaultMessage:"There must only be one member in the workspace to archive this teamspace"})}),icon:(0,l.H)({width:17})},restore:{type:"action",show:ne,handle:()=>{oe&&K.YH({environment:D,teamStore:t,teamName:de,from:p})},title:ee.restore,icon:y({width:17}),disabled:!oe,disabledTooltipText:(0,g.jsx)(b.FormattedMessage,{id:"outlinerTeamOverflow.restoreArchivedTeam.disabledTooltipText",defaultMessage:"Only teamspace owners can restore archived teamspaces."})},duplicate:{type:"action",show:!ne&&me,handle:()=>{U.tW({environment:D,teamStore:t,from:p,buttonPopupStore:T})},title:ee.duplicate,disabled:void 0!==ge,icon:(0,c.a)({width:17}),disabledTooltipText:fe,caption:(0,g.jsx)(b.FormattedMessage,{id:"sidebar.outlinerTeamToggleButton.duplicateCaption",defaultMessage:"Duplicates permissions and other settings but not pages and members"})},view:{type:"action",show:!ne||"manage_teams_table"===p,handle:()=>K.RF({environment:D,teamId:le,tab:O.a.Members,from:p}),title:te?ee.teamspaceSettings:ee.viewMembers,icon:te?(0,u.F)({width:15}):(0,x.n)({width:17})}},ke=(Ce?[{sectionName:"join/leave section",orderedOptions:X},{sectionName:"other actions",orderedOptions:Q.filter((e=>!X.includes(e)))}]:[{sectionName:"add section",orderedOptions:J},{sectionName:"other actions section",orderedOptions:Q.filter((e=>!J.includes(e)))}]).map((e=>{const t=e.orderedOptions.filter((e=>we[e].show));if(0!==t.length)return{sectionName:e.sectionName,filteredOptions:t}})).filter(M.$K).map((e=>{const t=e.filteredOptions.map((e=>{const t=we[e],{type:n}=t;return"action"===n?(0,j.cN)({key:e,displayName:t.title,analyticsName:t.title.defaultMessage,svg:()=>t.icon,validators:[],closeParentMenu:!0,action:()=>{d(),xe(e),t.handle()},render:e=>(0,g.jsx)(F.Z,{placement:L.u.Left,textWrap:!1,disableTooltip:!(t.disabled&&t.disabledTooltipText),renderTooltip:()=>t.disabledTooltipText,render:n=>(0,g.jsx)(w.Z,{...e,...n,svg:()=>t.icon,title:(0,g.jsx)(b.FormattedMessage,{...t.title}),buttonStyle:{...E.menuItemButton,...!t.disabled&&t.colorOverride?{fill:t.colorOverride,color:t.colorOverride}:{fill:_.regularIconColor,color:_.regularTextColor}},disabled:t.disabled,disabledFeedback:t.disabled,caption:t.caption,captionStyle:E.caption,shouldWrapCaption:!0})})}):"extensionAction"===n?(0,j.MV)({key:e,displayName:t.title,analyticsName:t.title.defaultMessage,svg:()=>t.icon,width:250,validators:[],subActions:()=>t.subActionSections.map((t=>({...t,actions:t.actions.map((t=>({...t,action:n=>{d(),xe(e),t.action(n)}})))})))}):void(0,M.t1)(n)}));return(0,j.$J)({key:e.sectionName,render:e=>(0,g.jsx)(P.Z,{...e}),actions:t})}));return(0,g.jsx)(Z.Z,{className:A.Mdu,menuType:B.og.Popup,minWidth:"100%",children:(0,g.jsx)(k.Z,{context:{blocks:[],environment:D,publicEditMode:void 0},sections:ke,initialFocus:void 0})})}},714982:(e,t,n)=>{n.r(t),n.d(t,{SidebarCreateTeamModal:()=>te});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(841892),l=n(964275),d=n(49364),c=n(709291),u=n(653965),m=n(401898),p=n(137810),g=n(117224),f=n(164921),h=n(374194),y=n(203386),x=n(568785),S=n(550506),v=n(164369),b=n(45653),M=n(13490),j=n(433929),C=n(548779),w=n(195697),k=n(568418),I=n(80444),T=n(206258),Z=n(733052),P=n(109867),F=n(158297),_=n(178122),A=n(535057),B=n(973466),R=n(880068),D=n(785893);function O(){const e=(0,i.O7)(),{currentSpaceStore:t,spaceViewStore:n}=(0,o.VK)((()=>({currentSpaceStore:I.default.state.currentSpaceStore,spaceViewStore:I.default.state.currentSpaceViewStore})),[]),r=(0,o.VK)((()=>k.Z.state),[]),l=(0,w.OX)(),d=function(){const e=(0,o.VK)((()=>A.Mk()&&!k.Z.state.isDefault),[]),t=k.F.Team,n=k.F.Members;return e?[t,n]:[t]}(),{screen:p,pageNumber:g,teamId:f}=r,h=""===r.name,y=(0,a.yK)((e=>({box:{justifyContent:"space-between",alignItems:"center",display:"flex",width:"100%",paddingTop:22},button:{marginLeft:8},previous:{fontSize:14,color:e.mediumTextColor,cursor:"pointer"},learnMoreLink:{overflow:"hidden"}})),[]),x=(0,s.useCallback)(((n,s)=>{t&&function(e){let{pageOrder:t,pageNumber:n,teamId:s,currentSpaceStore:i,environment:o,from:a}=e;const r=n+1;if(r<=t.length)k.Z.update((e=>({...e,loading:!1,screen:t[r-1],pageNumber:r})));else if(s){const e=T.zX.createChildStore(i,{table:"team",id:s,spaceId:i.id});P.hI({environment:o,teamStore:e,shouldScroll:!0}),P.ED({environment:o,from:a,teamStore:e})}}({pageOrder:d,pageNumber:g,teamId:s||f,currentSpaceStore:t,environment:e,from:n})}),[t,e,g,d,f]),S=u.Ds((async()=>{if(!t||!n)return;let s=f;switch(p){case k.F.Team:s=await async function(e){var t;let{spaceStore:n,environment:s,shouldShowZeroTeamsExperience:i,sidebarCreateTeamModalStoreState:o}=e;const{name:a,description:r,icon:l,flowId:d,accessLevel:c,isDefault:u}=o,m=await(0,_.Xg)({environment:s,spaceStore:n,teamName:a});if(!m)return;let p;k.Z.update((e=>({...e,loading:!0}))),p=i?await B.HD({environment:s,name:a,description:r,icon:l,flowId:d,trackCreateTeamComplete:!0}):await B.Cm({environment:s,name:a,description:r,icon:l,accessLevel:c,isDefault:u,flowId:d,createTeamHome:!0});if(!p)return;const g=null===(t=p)||void 0===t?void 0:t.id;return k.Z.update((e=>({...e,teamId:g}))),g}({spaceStore:t,environment:e,shouldShowZeroTeamsExperience:l,sidebarCreateTeamModalStoreState:r});break;case k.F.Members:break;default:(0,m.t1)(p)}s?x("success",s):k.Z.update((e=>({...e,loading:!1})))}),1e3,{leading:!0,trailing:!1}),v=(0,s.useCallback)(S,[S]);return(0,D.jsxs)("div",{style:y.box,children:[(0,D.jsx)(R.Z,{containerStyle:y.learnMoreLink,helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_sidebar_create_team_modal"}),(0,D.jsx)("div",{style:{display:"inline-flex"},children:(0,D.jsx)(F.Z,{isLarge:!0,onClick:v,disabled:h,style:y.button,children:(0,D.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.footer.createTeam",defaultMessage:"Create teamspace"})})})]})}var L=n(960701),V=n(638078),E=n(274016);const N={userSelect:"none",WebkitUserSelect:"none",position:"relative",padding:"22px 26px"},U={createTeamContainer:{...N,width:480},addMembersContainer:{...N,width:500},full:{width:"100%"}},K=(0,c.defineMessages)({teamNamePlaceholder:{id:"sidebarCreateTeamModal.teamScreen.namePlaceholder",defaultMessage:"Acme Labs"},teamDescriptionPlaceholder:{id:"sidebarCreateTeamModal.teamScreen.descriptionPlaceholder",defaultMessage:"Details about your teamspace"}});function W(){const[e,t]=(0,o.AF)(k.Z);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(M.Z,{hasMarginTop:!0,children:(0,D.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamDescriptionLabel",defaultMessage:"Description"})}),(0,D.jsx)(h.Z,{value:e.description,placeholder:j.default.formatMessage(K.teamDescriptionPlaceholder),textarea:!0,onChange:n=>{t({...e,description:n.target.value})}})]})}function z(e){return(0,D.jsx)("div",{id:e.titleAriaId,style:{fontSize:18,fontWeight:p.Z.fontWeight.semibold},children:(()=>{switch(e.screen){case k.F.Team:return(0,D.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.teamTitle.label",defaultMessage:"Create a new teamspace"});case k.F.Members:return(0,D.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.membersTitle.label",defaultMessage:"Add people"});default:(0,m.t1)(e.screen)}})()})}function q(e){const t=(0,i.O7)(),[n]=(0,o.AF)(k.Z),a=(0,s.useCallback)(((e,n)=>{P.ED({environment:t,from:n,teamStore:e})}),[t]),{screen:r}=n;switch(r){case k.F.Team:return(0,D.jsx)($,{titleAriaId:e.titleAriaId,descriptionAriaId:e.descriptionAriaId});case k.F.Members:const t=n.teamId;return t?(0,D.jsx)(J,{teamId:t,onCompleted:e=>{a(e,"success")},onCanceled:e=>{a(e,"dismiss_button")}}):null;default:(0,m.t1)(r)}}function G(){const[e,t]=(0,o.AF)(k.Z),n=(0,o.VK)((()=>I.default.state.currentSpaceStore),[]),s=(0,a.yK)((e=>({container:{display:"inline-flex",width:"100%",verticalAlign:"middle"},icon:{marginRight:8,marginTop:1}})),[]);if(!n)return null;const i=e.icon?{icon:e.icon,pointer:{table:"space",id:n.id}}:void 0;return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(M.Z,{hasMarginTop:!0,children:(0,D.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamNameLabel",defaultMessage:"Icon & name"})}),(0,D.jsxs)("div",{style:s.container,children:[(0,D.jsx)(E.p,{icon:i,size:26,style:s.icon,onChange:n=>{t({...e,icon:n})},iconLoggingData:{recordTable:"team",source:"team_creation"}}),(0,D.jsx)(h.Z,{value:e.name,placeholder:j.default.formatMessage(K.teamNamePlaceholder),onChange:n=>{t({...e,name:n.target.value})},preventSafariAutofill:!0})]})]})}function H(e){const t=(0,a.yK)((()=>({})),[]);return(0,D.jsx)(v.Z,{id:e.descriptionAriaId,isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:t.description,children:(()=>{switch(e.screen){case k.F.Team:return(0,D.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.teamDescription.label",defaultMessage:"Teamspaces are where your team organizes pages, permissions, and members"});case k.F.Members:return null;default:(0,m.t1)(e.screen)}})()})}function $(e){const[t]=(0,o.AF)(k.Z),n=(0,i.O7)();return(0,s.useEffect)((()=>{if(t.open){const{from:e,flowId:s}=t;g.kr(n,{from:e,flowId:s})}}),[]),(0,D.jsxs)("div",{style:U.createTeamContainer,children:[(0,D.jsx)(z,{titleAriaId:e.titleAriaId,screen:k.F.Team}),(0,D.jsx)(H,{descriptionAriaId:e.descriptionAriaId,screen:k.F.Team}),(0,D.jsxs)("div",{style:U.full,children:[(0,D.jsx)(G,{}),(0,D.jsx)(W,{}),(0,D.jsx)(Q,{})]}),(0,D.jsx)(O,{})]})}function Y(){const e=(0,o.VK)((()=>k.Z.state.loading),[]),t=(0,a.yK)((e=>({spinner:{width:"100%",height:"100%",backgroundColor:e.modalUnderlayBackground,position:"absolute",top:0,left:0}})),[]);return(0,D.jsx)(D.Fragment,{children:e&&(0,D.jsx)("div",{style:t.spinner,children:(0,D.jsx)(x.Z,{style:{position:"absolute",top:"50%",left:"50%"}})})})}function Q(){const e=(0,a.yK)((e=>({openAccessMessage:{fontSize:13,color:e.mediumTextColor,marginTop:20,lineHeight:1.4,display:"flex"},iconContainer:{marginRight:8},openTeamIcon:{width:24,fill:e.mediumIconColor},teamAccessPopupContainer:{marginTop:20}})),[]),[t,n]=(0,o.AF)(k.Z),s=(0,w.OX)(),r=(0,i.O7)(),l=(0,o.VK)((()=>{const e=I.default.state.currentSpaceStore;return e?(0,C.rn)(r,e):"this workspace"}),[r]);return s?(0,D.jsxs)("div",{style:e.openAccessMessage,children:[(0,D.jsx)("div",{style:e.iconContainer,children:(0,d.R)(e.openTeamIcon)}),(0,D.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.openAccessLabel",defaultMessage:"Everyone at {spaceName} and new members will have access to this teamspace",values:{spaceName:l}})]}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(M.Z,{hasMarginTop:!0,children:(0,D.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.permissionsLabel",defaultMessage:"Permissions"})}),(0,D.jsx)(L._,{currentAccessLevel:t.accessLevel,currentIsDefault:t.isDefault,onChange:(e,s)=>{n(s?{...t,accessLevel:"open",isDefault:s}:{...t,accessLevel:e,isDefault:s})}})]})}function J(e){const t=(0,i.O7)(),[,,n]=(0,o.AF)(k.Z),[,,s]=(0,o.AF)(void 0,Z.Z);(0,o.VK)((()=>{const{defaultInviteTargets:e,flowId:t}=n.state;s.setState({...s.state,flowId:t}),e&&s.setState({...s.state,isInviteTargetsEmpty:!1,inviteTargets:e})}),[n,s]);const a=(0,o.VK)((()=>I.default.state.currentSpaceStore),[]);if(!a)return null;const r=T.zX.createChildStore(a,{table:"team",id:e.teamId,spaceId:a.id});return(0,D.jsx)("div",{style:U.full,children:(0,D.jsx)("div",{style:U.addMembersContainer,children:(0,D.jsx)(V.Z,{store:r,permissionsInviteStore:s,isNewlyCreatedTeam:!0,onSubmitSuccessful:()=>{e.onCompleted(r),P.hI({environment:t,teamStore:r,shouldScroll:!0})},onDismiss:()=>{e.onCanceled(r)}})})})}const X=[r.Z.images.avatars.avatar1Png,r.Z.images.avatars.avatar2Png,r.Z.images.avatars.avatar3Png];function ee(e){let{handleModalClose:t}=e;const n=(0,a.yK)((e=>({container:{borderTopLeftRadius:5,borderTopRightRadius:5,background:e.inputBackground,boxShadow:e.inputBoxShadow},header:{display:"flex",padding:14,fontWeight:p.Z.fontWeight.medium},avatarGroup:{display:"flex",width:"100",marginLeft:4,alignSelf:"center"},avatar:{marginLeft:-4},message:{paddingLeft:14,paddingRight:14},closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor}})),[]);return(0,D.jsx)("div",{style:n.container,children:(0,D.jsxs)("div",{style:n.header,children:[(0,D.jsx)("div",{style:n.avatarGroup,children:X.map(((e,t)=>(0,D.jsx)(b.Z,{avatarShouldShowShadow:!0,style:n.avatar,size:28,avatar:{avatarUrl:e}},t)))}),(0,D.jsx)(v.Z,{style:n.message,isMultiline:!0,isSmall:!0,children:(0,D.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.firstTeamHeader",defaultMessage:"Create your first teamspace to start using Notion with your teammates"})}),(0,D.jsx)(f.Z,{onClick:t,style:n.closeButton,hoveredStyle:n.closeButtonHover,children:(0,l.D)(n.closeButtonIcon)})]})})}function te(){const e=(0,i.O7)(),[t,,]=(0,o.AF)(k.Z),n=(0,s.useId)(),r=(0,s.useId)(),d=(0,a.yK)((e=>({modal:{maxWidth:500,borderRadius:5,overflow:"visible"},closeButton:{position:"absolute",top:14,right:14,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:14,fill:e.mediumTextColor},wrapper:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"}})),[]),c=(0,s.useCallback)((t=>{P.ED({environment:e,from:t})}),[e]),{open:m,loading:p,screen:g}=t,h=(0,w.OX)(),x=(0,s.useRef)(h);return(0,s.useEffect)((()=>{p||(x.current=h&&g===k.F.Team)}),[p,g,h]),m?(0,D.jsx)(S.Z,{ariaLabelledBy:n,ariaDescribedBy:r,open:m,innerStyle:d.modal,onDismiss:()=>{c("modal")},render:()=>{const{device:t}=e;return(0,D.jsxs)("div",{style:{height:"100%"},children:[!t.isMobile&&(x.current?(0,D.jsx)(ee,{handleModalClose:()=>{c("close_button")}}):(0,D.jsx)(f.Z,{onClick:()=>{c("close_button")},style:d.closeButton,hoveredStyle:d.closeButtonHover,children:(0,l.D)(d.closeButtonIcon)})),(0,D.jsx)("div",{style:d.wrapper,children:(0,D.jsx)(y.Z,{debugName:"SidebarCreateTeamModal",capture:!0,onBackspace:u.yR,onLeft:u.yR,onRight:u.yR,onSelectAll:u.yR,onRedo:u.yR,onUndo:u.yR,onCut:u.yR,onCopy:u.yR,onPaste:u.yR,onKeypress:u.yR,onDelete:u.yR,onTab:u.yR,children:(0,D.jsx)(q,{titleAriaId:n,descriptionAriaId:r})})}),(0,D.jsx)(Y,{})]})}}):null}},960701:(e,t,n)=>{n.d(t,{_:()=>M});n(667294);var s=n(800480),i=n(886628),o=n(724405),a=n(536591),r=n(542853),l=n(605257),d=n(552275),c=n(231945),u=n(478140),m=n(632163),p=n(672495),g=n(526388),f=n(460709),h=n(98742),y=n(825464),x=n(960709),S=n(256187),v=n(98596),b=n(785893);function M(e){let{currentAccessLevel:t,currentIsDefault:n=!1,onChange:M,teamStore:j,disabledWithRightChevron:C=!1,style:w}=e;const{device:k}=(0,s.O7)(),I=(0,S.q)(j),T=(0,o.yK)((e=>({chevron:{width:12,marginLeft:3,marginRight:3,fill:e.lightIconColor},selectedButton:{width:"100%",margin:0,paddingTop:4,paddingBottom:4,border:`1px solid ${e.outlineButtonBorder}`,...w},selectedCheckmark:{width:k.isMobile?16:14},icon:{alignSelf:"center",marginTop:0}})),[k.isMobile,w]),Z=(0,i.VK)((()=>(null==j?void 0:j.isDefault())??n),[j,n]),P=Z?"default":t,F=(0,v.U)({teamStore:j,onChange:M,isDefault:Z});return(0,b.jsx)(c.ZP,{popupType:k.isMobile?c.Z4.SlideUp:c.Z4.Popup,renderOrigin:e=>{const t=F.find((e=>e.key===P));if(!t)return null;const n=t.disableAllOptionsTooltip,s=C||Boolean(n)||Boolean(j)&&!I;return(0,b.jsx)(g.Z,{placement:y.u.Bottom,alignment:y.v.Start,disableTooltip:!n||!I,renderTooltip:()=>n,style:{width:350},textWrap:!0,render:n=>(0,b.jsx)(d.Z,{...(0,h.Z)(e,n),title:t.title,caption:t.caption,icon:t.icon({fill:t.iconColor}),desktopIconStyle:T.icon,disabled:s,right:C?(0,l.o)(T.chevron):s?void 0:(0,r.i)(T.chevron),focused:!1,shouldWrapCaption:!0,buttonStyle:T.selectedButton})})},placementToOrigin:x.Iw.Bottom,alignmentToOrigin:x.lU.Start,sameWidthAsOrigin:!0,render:e=>{const t=[{key:"access levels",render:e=>(0,b.jsx)(p.Z,{...e,topBorder:0!==e.index}),items:F.map((t=>{const n=t.key===P;return{key:t.key,render:e=>(0,b.jsx)(g.Z,{placement:y.u.Top,disableTooltip:!t.tooltip,renderTooltip:()=>t.tooltip,render:s=>(0,b.jsx)(d.Z,{...(0,h.Z)(e,s),title:t.title,caption:t.caption,icon:t.icon({fill:t.iconColor}),desktopIconStyle:T.icon,right:n?(0,b.jsx)("div",{style:T.selectedCheckmark,children:(0,a.e)()}):void 0,disabled:t.disabled,shouldWrapCaption:!0})}),action:()=>{t.onSelect(),e.close()}}}))}];return(0,b.jsx)(u.Z,{menuType:f.og.Popup,children:(0,b.jsx)(m.Z,{type:m.i.Vertical,initialFocus:void 0,sections:t})})}})}},438680:(e,t,n)=>{n.r(t),n.d(t,{default:()=>D});n(667294);var s=n(800480),i=n(886628),o=n(724405),a=n(133728),r=n(559054),l=n(709291),d=n(478140),c=n(943579),u=n(791487),m=n(147082),p=n(304708),g=n(460709),f=n(75472),h=n(195697),y=n(80444),x=n(733052),S=n(897630),v=n(542853),b=n(653965),M=n(552275),j=n(231945),C=n(632163),w=n(489728),k=n(672495),I=n(526388),T=n(825464),Z=n(960709),P=n(256187),F=n(785893);function _(e){const{disabled:t,selectedRole:n,allRoles:a,onChange:r,store:c,labelStyle:u}=e,{device:m}=(0,s.O7)(),p=(0,o.Fg)(),f=(0,P.q)(c),x=(0,i.VK)((()=>{const{currentSpaceStore:e}=y.default.state;return null==e?void 0:e.canEditMembership()}),[]),S=(0,i.VK)((()=>c.isDefault()),[c]);return(0,F.jsx)(j.ZP,{popupType:m.isMobile?j.Z4.SlideUp:j.Z4.Popup,renderOrigin:e=>(0,F.jsxs)(w.Z,{style:u,disabled:t,disabledFeedback:!0,...e,children:[(0,F.jsx)(l.FormattedMessage,{...h.q9[n].label}),(0,v.i)({width:10,marginLeft:4,fill:p.lightIconColor})]}),placementToOrigin:Z.Iw.Bottom,render:e=>{const t=[{key:"roles",render:e=>(0,F.jsx)(k.Z,{...e,topBorder:0!==e.index}),items:a.map((t=>{const s=!f&&"owner"===t,i=S&&"team_level_guest"===t,o=!x&&"team_level_guest"===t,a=!f&&"team_level_guest"===t,d=s||i||o||a,c={key:t,render:e=>(0,F.jsx)(I.Z,{disableTooltip:!d,placement:T.u.Right,textWrap:!0,renderTooltip:()=>s?(0,F.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingOwnerForMembers",defaultMessage:"Teamspace members can't add owners"}):i?(0,F.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingGuestsInDefaultTeam",defaultMessage:"Default teams can't contain teamspace guests"}):o||a?(0,F.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingGuestForNonSpaceAdminsOrNonTeamOwners",defaultMessage:"You must be a workspace owner and a teamspace owner to add teamspace guests"}):void 0,render:s=>(0,F.jsx)("span",{...s,children:(0,F.jsx)(M.Z,{...e,focused:!1,checkState:b.Xy(t,n),disabled:d,disabledFeedback:d,title:(0,F.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,F.jsx)(l.FormattedMessage,{...h.q9[t].label})}),caption:(0,F.jsx)("span",{style:{color:p.mediumTextColor},children:(0,F.jsx)(l.FormattedMessage,{...h.q9[t].caption})}),shouldWrapCaption:!0})})}),action:()=>{r(t),e.close()}};return c}))}];let s;return s=m.isMobile?{menuType:g.og.Modal,title:(0,F.jsx)(l.FormattedMessage,{id:"teamPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role"}),right:(0,F.jsx)(l.FormattedMessage,{id:"teamPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:g.og.Popup,width:264},(0,F.jsx)(d.Z,{...s,children:(0,F.jsx)(C.Z,{type:C.i.Vertical,initialFocus:void 0,sections:t})})}})}const A="member";function B(e){const{store:t,permissionsInviteStore:n,onEmptySubmit:s}=e,r=(0,l.useIntl)(),d=(0,i.VK)((()=>Boolean(n.state.isFocused)),[n]),c=(0,i.VK)((()=>n.state.tokenQuery),[n]),p=(0,i.VK)((()=>n.state.inviteRole),[n]),g=(0,i.VK)((()=>n.state.inviteTargets),[n]),h=(0,o.yK)((e=>({inputTokenVerticalMargin:{marginTop:3,marginBottom:3},tokenMenuItem:{alignItems:"unset",borderRadius:4,paddingTop:5,paddingBottom:5,paddingLeft:8,paddingRight:5,boxShadow:d?e.outlineBlueInputBoxShadow:e.inputBoxShadow,maxHeight:"40vh"},inputDiv:{marginBottom:0}})),[d]);function y(e){if(n.state.isInviteTargetsEmpty)return;const t=n.state.inviteTargets.filter((t=>t!==e));0===g.length?n.setState({...n.state,inviteTargets:[],inviteRole:A,isInviteTargetsEmpty:!0}):n.setState({...n.state,inviteTargets:t})}function x(e){n.setState({...n.state,isFocused:e})}const S=g.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`;return(0,F.jsx)(u.Z,{target:e,onClickRemove:y,role:p,shouldWrap:!0,style:h.inputTokenVerticalMargin,backgroundColor:(0,f.gQ)(e)},t)}));return(0,F.jsx)(m.ZP,{focus:d,onClick:()=>x(!0),format:m.UR.Share,value:c,onChange:function(e){const t=e.target.value,{extractedEmails:s,newInputValue:i}=(0,a.zI)(t),o=s.map((e=>({type:"newUser",value:{email:e},source:"email"}))).filter((e=>!(0,f.Nd)({target:e,permissionsInviteStore:n}))),r=[...n.state.inviteTargets,...o];r.length>0?(n.setState({...n.state,inviteTargets:r,isInviteTargetsEmpty:!1,tokenQuery:i}),x(!(o.length>0))):n.setState({...n.state,inviteTargets:[],isInviteTargetsEmpty:!0,tokenQuery:i})},onEmptySubmit:s,type:"email",placeholder:r.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups"}),tokens:S,onRemoveLastToken:function(){const e={...n.state};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=A),n.setState(e)},focusAfterAnimation:!0,right:(0,F.jsx)(R,{store:t,permissionsInviteStore:n}),style:h.tokenMenuItem,inputStyle:h.inputTokenVerticalMargin,inputDivStyle:h.inputDiv,inputFullWidth:!0})}function R(e){const{store:t,permissionsInviteStore:n}=e,s=(0,i.VK)((()=>{const e=y.default.state.currentSpaceStore;return!(null!=e&&e.getDisableTeamGuests())&&(0,p.F$)()}),[]),a=(0,i.VK)((()=>n.state.inviteRole),[n]),r=(0,o.yK)((()=>({teamRoleLabel:{marginTop:3,marginBottom:3,marginLeft:5}})),[]);function l(e){n.setState({...n.state,inviteRole:e})}return s?(0,F.jsx)(_,{store:t,selectedRole:a,allRoles:h.ZN,onChange:l,labelStyle:r.teamRoleLabel}):(0,F.jsx)(_,{store:t,selectedRole:a,allRoles:h.$r,onChange:l,labelStyle:r.teamRoleLabel})}const D=function(e){const{store:t,onEmptySubmit:n}=e,a=(0,s.O7)();(0,r.r5)((async()=>{await S.bi(a)}),[]);const l=(0,i.qz)(e.permissionsInviteStore,x.Z),u=(0,i.VK)((()=>Boolean(l.state.isFocused)),[l]),m=(0,i.VK)((()=>l.state.tokenQuery),[l]),p=(0,i.VK)((()=>u&&m.length>0),[u,m]),f=(0,o.yK)((e=>({permissionsInviteSearchRequest:{position:"absolute",width:"100%",borderRadius:4,backgroundColor:e.contentBackground,boxShadow:e.largeBoxShadow,marginTop:4},scroller:{zIndex:1}})),[]);function h(e){l.setState({...l.state,isFocused:e})}return(0,F.jsx)("div",{onFocus:()=>h(!0),onBlur:()=>h(!1),children:(0,F.jsx)(d.Z,{menuType:g.og.Popup,header:(0,F.jsx)(B,{store:t,permissionsInviteStore:l,onEmptySubmit:n}),scrollerStyle:f.scroller,width:"100%",tokenInputHeader:!1,disableScroller:!0,children:p&&(0,F.jsx)("div",{style:f.permissionsInviteSearchRequest,children:(0,F.jsx)(c.Z,{permissionsInviteStore:l,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:!1,shouldShowGroups:!0,sectionRenderLimit:10,membersOnly:!1,hideUserTypeToken:!0,disableInvitedUsers:!0})})})})}},638078:(e,t,n)=>{n.d(t,{Z:()=>D,u:()=>R});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(133728),l=n(727714),d=n(709291),c=n(137810),u=n(117224),m=n(800893),p=n(195209),g=n(164964),f=n(568785),h=n(863296),y=n(489728),x=n(158297),S=n(526388),v=n(164369),b=n(296994),M=n(843250),j=n(304708),C=n(75472),w=n(195697),k=n(80444),I=n(535057),T=n(109867),Z=n(274016),P=n(30765),F=n(785893);const _={button:{height:32},buttonContainer:{width:"100%",paddingTop:22,display:"flex",justifyContent:"end"},multiButtonContainer:{width:"100%",paddingTop:12,display:"flex",justifyContent:"space-between"},singleButtonContainer:{width:"100%",paddingTop:12,display:"flex",justifyContent:"right"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},containerLeftAligned:{display:"flex",alignItems:"left",justifyContent:"left",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},titleAndIcon:{paddingBottom:18,alignItems:"center",display:"flex"},addMembersTo:{minWidth:"25%"},icon:{paddingRight:3,paddingLeft:3},teamName:{paddingRight:10,fontWeight:c.Z.fontWeight.medium,...c.Z.textOverflowStyle,maxWidth:250},full:{width:"100%"},submitTooltip:{minWidth:250},subtitle:{paddingTop:16}};function A(e){var t;let{isLoading:n,isNewlyCreatedTeam:s,onDismiss:i,onSubmit:a,inviteTargets:r,includesGroups:l,inviteRole:c,canEditSpaceMembership:u,membershipRequestsDisabled:m,spaceAllowedDomains:p,hasTeamGuestsMatchAllowedDomain:g}=e;const y=r.length>0,v=l&&"owner"===c,b=r.filter((e=>(0,C.OA)(e))).length>0&&m&&!u,M=(0,o.VK)((()=>(0,j.F$)()&&"team_level_guest"===c&&r.some((e=>"group"===e.type||"existingUser"===e.type&&"none"!==e.spaceRole&&"not_in_space"!==e.spaceRole))),[c,r]),w=v||M||b||g;if(n)return(0,F.jsx)(x.Z,{style:{..._.button,minWidth:80},disabled:!0,children:(0,F.jsx)(f.Z,{isWhite:!0})});if(s&&!y)return(0,F.jsx)(h.Z,{style:_.button,onClick:i,disabled:n,children:(0,F.jsx)(d.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.skipForNow",defaultMessage:"Skip for now"})});const k=v?(0,F.jsx)(d.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.groupsAsOwnersTooltip",defaultMessage:"Cannot add groups as teamspace owners. Remove any groups to continue."}):M?(0,F.jsx)(d.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.memberOrGroupInvitedAsTeamGuestTooltip",defaultMessage:"Cannot add space members or groups as teamspace guests. Remove them to continue."}):g?(0,F.jsx)(d.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.hasTeamGuestsMatchAllowedDomain",defaultMessage:"Cannot add users with {emailDomains} as teamspace guests. Remove them to continue.",values:{emailDomains:null==p||null===(t=p.map((e=>`@${e}`)))||void 0===t?void 0:t.join(", ")}}):null;return(0,F.jsx)(S.Z,{textWrap:!0,style:_.submitTooltip,disableTooltip:!k,renderTooltip:()=>k,render:e=>(0,F.jsx)(x.Z,{style:_.button,onClick:a,disabled:!y||n||w,...e,children:(0,F.jsx)(d.FormattedMessage,{id:"teamPermissionsInviteOverlayV2.inviteButton.label",defaultMessage:"Invite"})})})}function B(e){let{inviteTargets:t,workspaceName:n,canEditSpaceMembership:s,membershipRequestsDisabled:i,isFreeTier:o,inviteRole:a,hasTeamGuestsMatchAllowedDomain:r}=e;if(void 0===s)return null;if(!t||0===t.length)return null;const l=t.map((e=>{if("group"!==e.type&&(0,C.OA)(e))return e.value.email})).filter((e=>e));if(!l||0===l.length)return null;const c=e=>(0,F.jsx)("b",{children:e}),u=n??"this workspace";return s?o?(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingularOwner.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a workspace owner.",values:{guestEmail:l[0],workspaceName:u,b:c}}):(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPluralOwners.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as workspace owners.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:c}})}):"team_level_guest"===a?r?null:(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingular.teamGuest.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a billed teamspace guest.",values:{guestEmail:l[0],workspaceName:u,b:c}}):(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPlural.teamGuest.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as billed teamspace guests.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:c}})}):(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingular.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a billed workspace member.",values:{guestEmail:l[0],workspaceName:u,b:c}}):(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPlural.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as billed workspace members.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:c}})}):i?(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipDisabled.subtitle",defaultMessage:"You can't add workspace guests to a teamspace. Ask your admin to add them as workspace members first."})}):(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipSingular.subtitle",defaultMessage:"Request will be sent to your admin to add <b>{guestEmail}</b> as a member to {workspaceName}.",values:{guestEmail:l[0],workspaceName:u,b:c}}):(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipPlural.subtitle",defaultMessage:"Request will be sent to your admin to add <b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> as members to {workspaceName}.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:c}})})}function R(e){const{store:t,isSmall:n}=e,s=(0,i.O7)(),o=(0,a.yK)((e=>({button:{marginRight:5,marginLeft:5,height:32,fontSize:n?12:14},icon:{width:n?12:14,height:n?12:14}})),[n]);return(0,F.jsx)(y.Z,{onClick:()=>{m.RD({environment:s,stringValue:w.W8(t.id),copiedMessage:m.tq.copiedLinkToClipboard}),u.XT(s,{store:t})},icon:l.N,style:o.button,iconStyle:o.icon,isBlue:!0,children:n?(0,F.jsx)(d.FormattedMessage,{id:"teamPermissionsInviteOverlay.copyLinkCondensedButton.label",defaultMessage:"Copy link"}):(0,F.jsx)(d.FormattedMessage,{id:"teamPermissionsInviteOverlay.copyLinkButton.label",defaultMessage:"Copy invite link"})})}const D=function(e){let{store:t,permissionsInviteStore:n,isNewlyCreatedTeam:a,onSubmitSuccessful:l,onDismiss:c}=e;const u=(0,i.O7)(),{teamName:m,workspaceName:f,canEditSpaceMembership:h,membershipRequestsDisabled:y,teamAccessLevel:x,spaceAllowedDomains:S}=(0,o.VK)((()=>{const{currentSpaceStore:e}=k.default.state;return{teamName:t.getName(),workspaceName:null==e?void 0:e.getName(),canEditSpaceMembership:null==e?void 0:e.canEditMembership(),membershipRequestsDisabled:null==e?void 0:e.getDisableMembershipRequests(),teamAccessLevel:t.getTeamAccessLevel(),spaceAllowedDomains:null==e?void 0:e.getEmailDomains()}}),[t]);(0,s.useEffect)((()=>()=>{a&&T.hI({environment:u,teamStore:t,shouldScroll:!0})}),[a,t,u]);const[v,D]=(0,s.useState)(!1),O=(0,o.VK)((()=>n.state.inviteTargets),[n]),L=(0,o.VK)((()=>n.state.inviteTargets.length),[n]),V=(0,o.VK)((()=>n.state.inviteRole),[n]),E=(0,o.VK)((()=>{if(n.state.isInviteTargetsEmpty)return!1;return Boolean(n.state.inviteTargets.find((e=>"group"===e.type)))}),[n]),N=(0,o.VK)((()=>I.QM()),[]),U=(0,o.VK)((()=>!(null==S||!S.length||"team_level_guest"!==V||!(0,j.F$)())&&O.some((e=>"group"!==e.type&&(0,r.dy)(S,e.value.email)))),[S,V,O]),K=(0,o.VK)((()=>(0,j.s$)()?!N&&!w.U2(t):"open"===x&&(0,j.u3)()),[t,x,N]),W=async()=>{if(D(!0),L>0){const e=n.state.inviteTargets,{success:s}=await p.zK({environment:u,store:t,permissionsInviteStore:n,inviteOrigin:"team_invite_overlay"});if(void 0!==h)if(s){const n=(0,C.t0)({inviteTargets:e,recordStore:t,canEditSpaceMembership:h});if(!n)return;setTimeout((()=>{g.oV({label:n})}))}else setTimeout((()=>{g.oV({label:(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlay.inviteMembersFailure.message",defaultMessage:"Failed to send invites"})})}))}p.Mr({permissionsInviteStore:n}),D(!1),null==l||l()};return(0,F.jsx)("div",{className:M.D$4,style:{..._.full},children:(0,F.jsxs)("div",{style:_.containerLeftAligned,children:[(0,F.jsxs)("div",{style:_.titleAndIcon,children:[(0,F.jsx)("div",{style:_.addMembersTo,children:(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.membersTitle.label",defaultMessage:"Invite people to"})}),(0,F.jsx)("div",{style:_.icon,children:(0,F.jsx)(Z.p,{disabled:!0,store:t,size:20})}),(0,F.jsx)(P.s,{style:_.teamName,children:m})]}),(0,F.jsxs)("div",{style:_.full,children:[(0,F.jsx)(b.V8,{store:t,permissionsInviteStore:n,onEmptySubmit:W}),(0,F.jsx)("div",{style:_.subtitle,children:(0,F.jsx)(B,{inviteTargets:O,workspaceName:f,canEditSpaceMembership:h,membershipRequestsDisabled:y,isFreeTier:N,inviteRole:V,hasTeamGuestsMatchAllowedDomain:U})})]}),(0,F.jsx)("div",{style:K?_.multiButtonContainer:_.singleButtonContainer,children:(0,F.jsxs)("div",{style:K?_.multiButtonContainer:{},children:[K&&(0,F.jsx)(R,{store:t}),(0,F.jsx)(A,{isLoading:v,onSubmit:W,onDismiss:()=>{p.Mr({permissionsInviteStore:n}),null==c||c()},isNewlyCreatedTeam:a,inviteTargets:O,includesGroups:E,inviteRole:V,canEditSpaceMembership:h,membershipRequestsDisabled:y,spaceAllowedDomains:S,hasTeamGuestsMatchAllowedDomain:U})]})})]})})}},671015:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});n(667294);var s=n(886628),i=n(709019),o=n(638078),a=n(785893);const r=function(e){const[t,,n]=(0,s.AF)(e.permissionsInviteStore),r=()=>{n.reset()};return(0,a.jsx)(i.Z,{modalStyle:{alignSelf:"center",overflow:"visible",top:0,width:500},open:t.modalOpen,onDismiss:r,renderContent:()=>(0,a.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"end",padding:22},children:(0,a.jsx)(o.Z,{store:e.store,permissionsInviteStore:n,isNewlyCreatedTeam:!1,onSubmitSuccessful:r,onDismiss:r})}),origin:e.origin})}},343119:(e,t,n)=>{n.d(t,{C:()=>M,Z:()=>j});n(757658);var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(16184),l=n(709291),d=n(552275),c=n(231945),u=n(478140),m=n(632163),p=n(672495),g=n(45653),f=n(460709),h=n(575546),y=n(80444),x=n(88893),S=n(214034),v=n(274016),b=n(785893);function M(e){const{renderOrigin:t,onTeamAccept:n,sectionTitle:s,showMemberCount:a,right:h,showPrivate:x,onPrivateAccept:v,captionItem:M}=e,w=(0,i.Fy)().isMobile,k=C(),I=(0,S.E)(),T=(0,o.VK)((()=>I.filter((e=>e.canAddOrRemoveTopLevelPages()))),[I]),Z=(0,o.VK)((()=>y.default.state.currentUserStore),[]),P=[];if(M){const e={key:"caption",render:e=>(0,b.jsx)(p.Z,{...e,topBorder:!0}),items:[M]};P.push(e)}const F=T.map((e=>({key:e.id,action:()=>{n(e)},render:t=>(0,b.jsx)(j,{...t,teamStore:e,onAccept:n,showMemberCount:a,right:h})}))),_={key:"teams",render:e=>(0,b.jsx)(p.Z,{...e,title:s}),items:F};if(P.push(_),x){const e={key:"private",render:e=>(0,b.jsx)(p.Z,{...e,topBorder:F.length>0}),items:[{key:"private",action:()=>{},render:e=>(0,b.jsx)(d.Z,{...e,icon:(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)(g.Z,{hasTooltip:!1,userStore:Z}),(0,r.Q)(k.privateItemLockIcon)]}),title:(0,b.jsx)(l.FormattedMessage,{id:"teamPickerButton.addToPrivate",defaultMessage:"Add to Private"}),onClick:()=>{null==v||v()}})}]};P.push(e)}return(0,b.jsx)(c.ZP,{...e,popupType:w?c.Z4.SlideUp:c.Z4.Popup,renderOrigin:t,render:e=>{let t;return t=w?{menuType:f.og.ActionSheet}:{menuType:f.og.Popup,width:"100%"},(0,b.jsx)(u.Z,{...t,children:(0,b.jsx)(m.Z,{style:{width:w?void 0:256},type:m.i.Vertical,initialFocus:void 0,sections:P})})}})}const j=s.forwardRef((function(e,t){const{teamStore:n,onAccept:s,showMemberCount:i,right:a,...r}=e,c=C(),u=(0,o.VK)((()=>n.getNumberOfMembersOrZero((0,x.Io)())),[n]);return(0,b.jsx)(d.Z,{...r,ref:t,onClick:e=>s(n),icon:(0,b.jsx)(v.p,{store:n,size:20,disabled:!0}),title:(0,b.jsx)(h.o,{teamStore:n}),right:r.focused?a:null,caption:i?(0,b.jsx)("div",{style:c.caption,children:(0,b.jsx)(l.FormattedMessage,{defaultMessage:"{numberOfMembers, plural, one {{numberOfMembers} member} other {{numberOfMembers} members}}",id:"teamPickerButton.teamItem.teamMemberCount",values:{numberOfMembers:u}})}):null})}));function C(){return(0,a.yK)((e=>({privateItemLockIcon:{position:"absolute",bottom:-2,right:-2,zIndex:1,width:10,height:10,fill:e.accentColors.red[500]},caption:{color:e.lightTextColor}})),[])}},880068:(e,t,n)=>{n.d(t,{Z:()=>m});n(667294);var s=n(724405),i=n(709291),o=n(401898),a=n(474523),r=n(918514),l=n(30765),d=n(785893);function c(e){switch(e){case"bestPractices":return(0,r.UY)("guides.teamspacesLearnMore");case"workspaceOwnerGuide":return(0,r.UY)("guides.teamspacesWorkspaceOwner");case"settingsAndPermissions":return(0,r.UY)("guides.teamspacesSettingsAndPermissions");default:return(0,o.t1)(e)}}function u(e){return e||(0,d.jsx)(l.s,{children:(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Learn about teamspaces",id:"teamsLearnMoreLink"})})}function m(e){let{onClick:t,message:n,helpCenterLocation:i,analyticsFrom:o,containerStyle:r}=e;const l=(0,s.yK)((()=>({button:{maxWidth:"100%"}})),[]);return(0,d.jsx)("div",{style:r,children:(0,d.jsx)(a.Z,{buttonStyle:l.button,title:u(n),analyticsFrom:o,href:c(i),onClick:t})})}},279414:(e,t,n)=>{n.d(t,{n:()=>g});n(667294);var s=n(886628),i=n(724405),o=n(307928),a=n(709291),r=n(731278),l=n(45653),d=n(471862),c=n(680993),u=n(785893);const m=c.Kt,p=16;function g(e){let{ownerStores:t,teamStore:n,isSmall:o=!1}=e;const a=o?m:d.Z,l=o?10:p,c=(0,i.yK)((e=>({container:{position:"relative",width:a,height:a},teamBadge:{position:"absolute",bottom:-5,right:-3,background:e.modalBackground,padding:.75,borderRadius:"0.25em"}})),[a]),{teamName:g,teamIcon:h}=(0,s.VK)((()=>({teamName:n.getName(),teamIcon:n.getIcon()})),[n]),y=e=>(0,u.jsx)(r.Z,{disabled:!0,title:g,icon:h,isEmptyPage:!1,size:e});return 0===t.length?y(a):(0,u.jsxs)("div",{style:c.container,children:[(0,u.jsx)(f,{isSmall:o,store:t[0]}),(0,u.jsx)("div",{style:c.teamBadge,children:y(l)})]})}function f(e){let{store:t,isSmall:n=!1,style:c={}}=e;const p=(0,a.useIntl)(),g=n?m:d.Z,f=(0,i.yK)((e=>({icon:{width:g,height:g,borderRadius:g,boxShadow:e.avatarBoxShadow,...c}})),[g,c]),h=(0,s.VK)((()=>null!=t&&t.isDefined()?(0,o.Nz)(p,null==t?void 0:t.getModel()):void 0),[p,t]),y=h?(0,u.jsx)(l.Z,{avatarShouldShowShadow:!0,userStore:t,size:g}):(0,u.jsx)(r.Z,{bucket:"public",disabled:!0,isEmptyPage:!1,title:h,size:g,icon:void 0});return(0,u.jsx)("div",{style:f.icon,children:y})}},14465:(e,t,n)=>{n.d(t,{z:()=>a});n(667294);var s=n(724405),i=n(137810),o=n(785893);function a(e){let{title:t,subtitle:n,style:a}=e;const r=(0,s.yK)((e=>({base:{width:"100%"},title:{fontWeight:i.Z.fontWeight.medium,color:e.regularTextColor,fontSize:14},subtitle:{fontWeight:i.Z.fontWeight.regular,color:e.mediumTextColor,fontSize:12}})),[]);return(0,o.jsxs)("div",{style:{...r.base,...a},children:[(0,o.jsx)("div",{style:r.title,children:t}),n&&(0,o.jsx)("div",{style:r.subtitle,children:n})]})}},680993:(e,t,n)=>{n.d(t,{Kt:()=>u,MQ:()=>c,Ph:()=>m,oM:()=>d});var s=n(667294),i=n(724405),o=n(661519),a=n(489728),r=n(14465),l=n(785893);const d=15,c=8,u=20;function m(e){const t=(0,i.yK)((()=>({button:{height:"auto",paddingLeft:0,paddingRight:0,display:"flex"},title:{marginBottom:10}})),[]);return Boolean(e.onClick)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.z,{title:e.title,style:t.title}),(0,l.jsx)(a.Z,{onClick:e.onClick,style:t.button,children:(0,l.jsx)(p,{...e})})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.z,{title:e.title,style:t.title}),(0,l.jsx)(p,{...e})]})}function p(e){let{title:t,rows:n,hideDividers:a=!1,itemStyle:r,onClick:u}=e;const m=(0,i.yK)((e=>({container:{border:`1px solid ${e.regularDividerColor}`,borderRadius:4,width:"100%"},list:{listStyle:"none",padding:0,margin:0},listItem:{marginLeft:d,marginRight:d,paddingTop:c,paddingBottom:c,...r},divider:{marginLeft:d,marginRight:d,borderColor:`${e.regularDividerColor}`}})),[r]);return(0,l.jsx)("div",{style:{...m.container},children:(0,l.jsx)("ul",{style:m.list,children:n.map(((e,t)=>(0,l.jsxs)(s.Fragment,{children:[!a&&t>0&&(0,l.jsx)(o.Z,{size:1,innerStyle:m.divider}),(0,l.jsx)("li",{style:m.listItem,children:e},t)]},t)))})})}},382740:(e,t,n)=>{n.d(t,{e:()=>l});var s=n(886628),i=n(401898),o=n(535057),a=n(564552),r=n(256187);function l(e){const t=(0,r.q)(e),n=(0,a.e)(e);return(0,s.VK)((()=>{if(!(0,o.Mk)())return!1;const s=e.getSetting("invite_access");switch(s){case void 0:return!1;case"team_members":return n;case"team_owners":return t;default:(0,i.t1)(s)}}),[e,t,n])}},373365:(e,t,n)=>{n.d(t,{n:()=>d});var s=n(800480),i=n(886628),o=n(186517),a=n(401898),r=n(80444),l=n(88893);function d(){const e=(0,s.O7)().currentUser.id,t=(0,i.VK)((()=>r.default.state.currentSpaceViewStore),[]);return(0,i.VK)((()=>!(!e||null==t||!t.isDefined())&&(0,o._V)({userId:e,teamsThatUserIsANonGuestMemberOf:t.getNonGuestTeamsStores().map((e=>e.getModel())).filter(a.$K),spaceMembers:(0,l.Io)()})),[e,t])}},214034:(e,t,n)=>{n.d(t,{E:()=>a});var s=n(800480),i=n(886628),o=n(628020);function a(){var e;const t=(0,s.O7)();return(null===(e=(0,i.Kw)((0,o.k_)(t)))||void 0===e?void 0:e.userJoinedTeamsStores)??[]}},411628:(e,t,n)=>{n.d(t,{P:()=>d,z:()=>c});var s=n(800480),i=n(886628),o=n(647425),a=n(598481),r=n(80444),l=n(170060);function d(){const{currentSpaceStore:e}=(0,i.Kw)(r.default);return(0,i.VK)((()=>{const t=(null==e?void 0:e.getSubscriptionTier())??"free";return(0,o.$V)(t,"business")}),[e])}function c(){const e=(0,s.O7)(),{currentSpaceStore:t}=(0,i.Kw)(r.default);return(0,i.VK)((()=>{const n=(null==t?void 0:t.getSubscriptionTier())??"free";return!(0,l.fX)()&&(0,o.$V)(n,"business")||(0,a.J)({environment:e})}),[e,t])}},897082:(e,t,n)=>{n.d(t,{y:()=>o});var s=n(886628),i=n(30397);function o(e){const[t]=(0,s.AF)(i.Z);return(0,s.VK)((()=>{if(!e)return!1;const n=t.teams.filter((e=>e.isDefault()&&!e.isArchived()));return 1===n.length&&n[0].id===e}),[t,e])}},256187:(e,t,n)=>{n.d(t,{q:()=>o});var s=n(800480),i=n(886628);function o(e){const t=(0,s.O7)();return(0,i.VK)((()=>{const n=t.currentUser.id;return!!(e&&e.isDefined()&&n)&&Boolean(e.isOwner(n))}),[t.currentUser.id,e])}},98596:(e,t,n)=>{n.d(t,{U:()=>j});n(430541),n(667294);var s=n(800480),i=n(886628),o=n(724405),a=n(745238),r=n(785893);const l=(0,a.IU)("closedTeam",{viewBox:"0 0 28 28",svg:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("path",{d:"M18.0459 13.8125C20.1377 13.8125 21.8428 11.9492 21.8428 9.68164C21.8428 7.43164 20.1465 5.66504 18.0459 5.66504C15.9541 5.66504 14.2402 7.4668 14.249 9.69922C14.2578 11.958 15.9541 13.8125 18.0459 13.8125ZM7.9209 13.8828C9.73145 13.8828 11.2168 12.2568 11.2168 10.2617C11.2168 8.31055 9.74902 6.7373 7.9209 6.7373C6.11035 6.7373 4.61621 8.33691 4.625 10.2793C4.625 12.2656 6.11035 13.8828 7.9209 13.8828ZM18.0459 12.4854C16.7627 12.4854 15.6641 11.2549 15.6641 9.69922C15.6553 8.16992 16.7363 6.99219 18.0459 6.99219C19.3555 6.99219 20.4277 8.15234 20.4277 9.68164C20.4277 11.2373 19.3379 12.4854 18.0459 12.4854ZM7.9209 12.5732C6.83984 12.5732 5.93457 11.5449 5.93457 10.2793C5.93457 9.04004 6.83105 8.04688 7.9209 8.04688C9.02832 8.04688 9.91602 9.02246 9.91602 10.2617C9.91602 11.5449 9.00195 12.5732 7.9209 12.5732ZM3.02539 21.9424H9.9248C9.50293 21.7051 9.18652 21.1777 9.24805 20.6416H2.81445C2.62988 20.6416 2.55078 20.5713 2.55078 20.4043C2.55078 18.2246 5.03809 16.1855 7.91211 16.1855C9.01074 16.1855 10.0127 16.4492 10.8652 16.9502C11.1377 16.5986 11.4629 16.291 11.8584 16.0186C10.7246 15.2715 9.3623 14.8848 7.91211 14.8848C4.22949 14.8848 1.24121 17.5566 1.24121 20.4834C1.24121 21.459 1.83887 21.9424 3.02539 21.9424ZM12.5176 21.9424H23.5566C25.0244 21.9424 25.7188 21.5029 25.7188 20.5361C25.7188 18.2334 22.8096 14.9023 18.0371 14.9023C13.2734 14.9023 10.3643 18.2334 10.3643 20.5361C10.3643 21.5029 11.0586 21.9424 12.5176 21.9424ZM12.0957 20.6152C11.8672 20.6152 11.7793 20.5537 11.7793 20.3691C11.7793 18.9277 14.0117 16.2295 18.0371 16.2295C22.0713 16.2295 24.3037 18.9277 24.3037 20.3691C24.3037 20.5537 24.207 20.6152 23.9785 20.6152H12.0957Z"})})});var d=n(40462),c=n(890199),u=n(49364),m=n(364684),p=n(709291),g=n(531701),f=n(548779),h=n(212205),y=n(80444),x=n(44041),S=n(174136);const v=function(e){let{tier:t}=e;const n=()=>"business"===t?(0,r.jsx)(p.FormattedMessage,{id:"upgradeToBusinessBadge",defaultMessage:"Business"}):(0,r.jsx)(p.FormattedMessage,{id:"upgradeToEnterpriseBadge",defaultMessage:"Enterprise"});return(0,r.jsx)(S.Z,{children:(0,r.jsx)(n,{})})};var b=n(411628),M=n(897082);function j(e){let{teamStore:t,isDefault:n,onChange:a=(()=>{})}=e;const S=(0,s.O7)(),j=(0,h.J)(),w=(0,M.y)(null==t?void 0:t.id),k=(0,b.P)(),I="business",T=(0,i.VK)((()=>y.default.state.currentSpaceStore),[]),Z=(0,i.VK)((()=>{if(T)return(0,f.rn)(S,T)}),[S,T]),P=(0,i.VK)((()=>{const e=null==t?void 0:t.getSettingsStore().getValue();return!!e&&("private"===(0,m.B5)(e)??!1)}),[t]),F=(0,o.yK)((()=>({openIcon:{width:20,height:20},lockIcon:{width:18,height:18},closedIcon:{width:20,height:20},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginLeft:5,marginRight:5}})),[]),_=(0,r.jsx)(p.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamspaceUpsellBusiness.tooltip",defaultMessage:"Upgrade to Business Plan to enable Private teamspaces"}),A=(0,r.jsx)(p.FormattedMessage,{id:"TeamAccessLevelSwitcher.defaultTeamSpace.title",defaultMessage:"Default"}),B=(0,r.jsx)(p.FormattedMessage,{id:"TeamAccessLevelSwitcher.openTeamspace.title",defaultMessage:"Open"}),R=(0,r.jsx)(p.FormattedMessage,{id:"TeamAccessLevelSwitcher.closedTeamSpace.title",defaultMessage:"Closed"}),D=(0,r.jsx)(p.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamSpace.title",defaultMessage:"Private"}),O="dark"===(0,o.Fg)().mode?g.ZP.uiLightGray:g.ZP.black,L=[{key:"open",icon:e=>(0,r.jsx)("div",{style:F.iconContainer,children:(0,u.R)({...e,...F.openIcon})}),iconColor:O,level:B,title:B,caption:(0,r.jsx)(p.FormattedMessage,{id:"CreateTeamspaceMenu.openTeamspace.caption",defaultMessage:"Anyone can see and join this teamspace"}),disabled:!1,onSelect:()=>a("open",!1)},{key:"closed",icon:e=>(0,r.jsx)("div",{style:F.iconContainer,children:l({...e,...F.closedIcon})}),iconColor:O,level:R,title:R,caption:(0,r.jsx)(p.FormattedMessage,{id:"CreateTeamspaceMenu.closedTeamspace.caption",defaultMessage:"Anyone can see this teamspace but not join"}),disabled:!1,onSelect:()=>a("closed",!1)},{key:"private",icon:e=>(0,r.jsx)("div",{style:F.iconContainer,children:(0,c.b)({...e,...F.lockIcon})}),iconColor:O,level:D,title:k?D:(0,r.jsx)(C,{title:D,badge:(0,r.jsx)(v,{tier:I})}),caption:(0,r.jsx)(p.FormattedMessage,{id:"CreateTeamspaceMenu.privateTeamspace.caption",defaultMessage:"Only members can see that this teamspace exists"}),disabled:!k&&!j,tooltip:k?void 0:_,onSelect:()=>{if(!k&&!P)return x.y(S,{from:"team_security_settings",for:I,dontOpenPlansOnCancel:!0});a("private",!1)}}];if(n||j){const e=n&&(!j||w),t={key:"default",icon:e=>(0,r.jsx)("div",{style:F.iconContainer,children:(0,d.o)({...e,...F.lockIcon})}),iconColor:O,level:A,title:A,caption:(0,r.jsx)(p.FormattedMessage,{id:"CreateTeamspaceMenu.defaultTeamspace.caption",defaultMessage:"Everyone at {spaceName} must be a member",values:{spaceName:Z}}),disabled:!1,disableAllOptionsTooltip:e?j?(0,r.jsx)(p.FormattedMessage,{id:"TeamAccessLevelSwitcher.closeOrPrivateTeamspace.disabledTooltipOnlyDefaultTeam",defaultMessage:"Add another default teamspace to change teamspace permissions."}):(0,r.jsx)(p.FormattedMessage,{id:"TeamAccessLevelSwitcher.defaultTeamspace.disabledTooltipNonAdmin",defaultMessage:"You can't change this setting because you are not a workspace admin"}):void 0,onSelect:()=>a("open",!0)};L.unshift(t)}return L}function C(e){let{title:t,badge:n}=e;const s=(0,o.yK)((()=>({container:{display:"flex",flexWrap:"wrap",alignItems:"center"},badge:{marginLeft:5}})),[]);return(0,r.jsxs)("div",{style:s.container,children:[t,(0,r.jsx)("div",{style:s.badge,children:n})]})}},219913:(e,t,n)=>{n.d(t,{h:()=>r,v:()=>a});var s=n(454642),i=n(359307);let o=s.getInAppCategoriesAndTemplates;function a(e){o=e??s.getInAppCategoriesAndTemplates}async function r(e){const{environment:t,spaceId:n}=e,s=await o(t,{spaceId:n});return"success"===s.type&&(i.Z.setState({data:s.data}),"current"===s.data.version)}},533535:(e,t,n)=>{n.r(t),n.d(t,{default:()=>qe});var s=n(667294),i=n(800480),o=n(886628),a=n(724405),r=n(815145),l=n(371663),d=n(240005),c=n(172111),u=n(811002),m=n(709291),p=n(307032),g=n(137810),f=n(100952),h=n(981193),y=n(547307),x=n(104617),S=n(275754),v=n(608055),b=n(210228),M=n(54814),j=n(288833),C=n(486095),w=n(416536),k=n(174927),I=n(940663),T=n(51592),Z=n(550506),P=n(164369),F=n(628020),_=n(798165),A=n(548779),B=n(194660),R=n(80444),D=n(219913),O=n(934593),L=n(665435),V=n(951247),E=n(284465),N=n(194952),U=n(173314),K=n(401898),W=n(433929),z=n(319385),q=n(359307);function G(e){const{subscriptionTier:t,userPersona:n,selectedTopCategory:s}=e,i=function(e){var t;const n=e??(null===(t=q.Z.state.data)||void 0===t?void 0:t.defaultCategoryId);if(!n)return;const s=(0,L.oO)(n);if(!s)return;return{selectedTopCategory:n,allTemplates:$(s)}}(s);return i||function(e){return{selectedTopCategory:void 0,allTemplates:H(e)}}({subscriptionTier:t,userPersona:n})}function H(e){let{userPersona:t,subscriptionTier:n}=e;const s=W.default.getIntl();return Object.fromEntries((0,L.Io)({userPersona:t,subscriptionTier:n}).map((e=>[e,[...E.gh[e].map((e=>(0,I.kY)((0,w.appConfigs)(),e))),...E.J9[e].filter((e=>(0,N.G)(e,z.default))).map((e=>(0,U.G)(e,s)))]])))}function $(e){return e.subcategories.reduce(((e,t)=>{let{id:n,templates:s}=t;return n&&null!=s&&s.length?{...e,[n]:s.map((e=>"preset"===e.type?(0,I.kY)((0,w.appConfigs)(),e.uri):"pageTemplate"===e.type?e.template:void(0,K.t1)(e)))}:e}),{})}var Y=n(429949),Q=n(841892),J=n(375071),X=n(421202),ee=n(231945),te=n(573063),ne=n(316354),se=n(158297),ie=n(531192),oe=n(73205),ae=n(282136),re=n(206258),le=n(343119),de=n(214034),ce=n(785893);function ue(e){const t=(0,i.O7)(),n=(0,m.useIntl)(),s=(0,oe.Z)("(max-width: 960px)"),r=(0,a.yK)((e=>({container:{width:"100%",height:"100%",overflow:"auto",flex:1,display:"flex",flexDirection:"column",alignItems:"stretch",background:e.contentBackground,color:e.regularTextColor},contentContainer:{margin:16,padding:"20px 24px",border:"1px solid rgba(0, 0, 0, 0.07)",borderRadius:8,background:e.sidebarBackground,display:"flex",flexDirection:"row",justifyContent:"space-between",columnGap:50,flexWrap:s?"wrap":"nowrap"},getTemplateColumn:{width:s?"100%":void 0,display:"flex",flexDirection:s?"column-reverse":"column"},heroImg:{height:"100%",width:"100%"},getTemplateButton:{width:s?"100%":220,height:38,fontSize:16},addBadgeTeamTemplateButton:{textTransform:"none",color:e.blueColor},madeByContainer:{marginBottom:16,display:"flex",flexDirection:"row",alignItems:"center",gap:6,width:"content-fit"},madeByLabel:{fontSize:14,fontWeight:500},madeByAvatarContainer:{width:30,height:30,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",borderRadius:"50%",border:`1px solid ${e.outlineButtonBorder}`,overflow:"hidden",backgroundColor:"rgb(245, 245, 245)"},madeByAvatar:{width:30,height:30},madeByNotionAvatar:{width:16,height:16}})),[s]),{status:l,selectedTemplate:d,cloneTo:c,selectedTeam:u}=(0,o.VK)((()=>{const{status:e,selectedTemplate:t,cloneTo:n,selectedTeam:s}=Y.Z.state;return{status:e,selectedTemplate:t,cloneTo:n,selectedTeam:s}}),[]),p=(0,o.VK)((()=>{if("open"===l&&"preset"===(null==d?void 0:d.type)){const e=d.uri,t=(0,I.iX)((0,w.appConfigs)(),e),n=null==t?void 0:t.presets.find((t=>t.uri===e));if(t&&n)return{currentApp:t,currentPreset:n}}}),[l,d]),g=(0,o.VK)((()=>{if(d){if("preset"===d.type){var e;if(!p)return;const{currentPreset:n}=p,s=null===(e=n.previews)||void 0===e?void 0:e.find((e=>"previewRootId"in e)),i=s&&new re.G(t,{table:X.iU,id:s.previewRootId,spaceId:s.spaceId}),o=i?(0,ce.jsx)("div",{style:{overflow:"hidden",paddingTop:64,paddingLeft:64,paddingRight:64},children:(0,ce.jsx)(ie.ZP,{store:i,context:ae.S.InAppTemplatePreview,styleOverrides:{paddingX:0,pageCoverHeight:0},paddingBottom:0,titleStyle:{fontSize:32},disabled:!0},i.id)}):(0,ce.jsx)("img",{style:r.heroImg,src:Q.Z.images.appPackages.projectPreview1Png});return{name:n.name,description:n.description,preview:o}}if("pageTemplate"===d.type){const{template:e}=d,n=new re.G(t,{table:X.iU,id:e.previewRootId,spaceId:e.spaceId}),s=n.isCollectionView()?64:0,i=(0,ce.jsx)("div",{style:{overflow:"hidden",paddingTop:s,paddingLeft:s,paddingRight:s},children:(0,ce.jsx)(ie.ZP,{store:n,context:ae.S.InAppTemplatePreview,styleOverrides:{paddingX:0},paddingBottom:0,disabled:!0,style:{...n.isFullWidth()?{width:"calc(100% - 64px)",margin:`0 ${V.wN}px`}:{}}})});return{name:e.name,description:e.description,preview:i}}(0,K.t1)(d)}}),[p,t,d,r.heroImg]),f=(0,de.E)(),y=(0,o.VK)((()=>f.filter((e=>e.canAddOrRemoveTopLevelPages()))),[f]),{creatorName:x,creatorAvatar:S,creatorUrl:v}=(0,o.VK)((()=>{if(!d||"preset"===d.type)return{creatorName:"Notion",creatorAvatar:Q.Z.images.notionLogoPng,creatorUrl:(0,L.D2)("notion")};const{template:e}=d,{creatorId:n}=e;if(!n){const{creatorName:t,creatorAvatar:n,creatorHandle:s}=e;return{creatorName:t,creatorAvatar:n,creatorUrl:t&&s?(0,L.D2)(s):void 0}}const s=new re.yj(t,{table:"template_creator",id:n}),i=s.getName(),o=s.getCreatorAvatarWithProtocol(),a=s.getUsername();return{creatorName:i,creatorAvatar:o,creatorUrl:i&&a?(0,L.D2)(a):void 0}}),[d,t]);if("open"!==l||void 0===d||!g)return null;const{name:b,description:M,preview:j}=g,C=y.length>0&&"destination_picker"===c&&!u,k=(0,ce.jsx)(m.FormattedMessage,{id:"templateDetail.getTemplateButton.label",defaultMessage:"Get template"}),T=(0,ce.jsx)(se.Z,{style:r.getTemplateButton,onClick:()=>{e.onAcceptTemplate(d,u),h.ye(t,{template_name:b,from:Y.Z.state.analyticsFrom,template_id:(0,B.gA)(d),target_team:null==u?void 0:u.id})},children:k}),Z=(0,ce.jsx)(le.C,{showMemberCount:!0,showPrivate:!0,placementToOrigin:ee.pO.Top,originGap:4,sectionTitle:(0,ce.jsx)(m.FormattedMessage,{...L.cY.addToTeamspace}),renderOrigin:e=>(0,ce.jsx)(se.Z,{...e,style:r.getTemplateButton,children:k}),onTeamAccept:n=>{e.onAcceptTemplate(d,n),h.ye(t,{template_name:b,from:Y.Z.state.analyticsFrom,template_id:(0,B.gA)(d),target_team:n.id})},onPrivateAccept:()=>{e.onAcceptTemplate(d),h.ye(t,{template_name:b,from:Y.Z.state.analyticsFrom,template_id:(0,B.gA)(d),target_team:"private"})},right:(0,ce.jsx)(te.Z,{isBlue:!0,style:{borderRadius:"100px",pointerEvents:"none"},icon:J.f,hovered:!0,caption:(0,ce.jsx)(m.FormattedMessage,{defaultMessage:"Add",id:"TemplateDetail.TeamItem.addButton"}),ariaLabel:n.formatMessage({id:"TemplateDetail.TeamItem.addButtonLabel",defaultMessage:"Add"}),captionStyle:r.addBadgeTeamTemplateButton})}),F=x?(0,ce.jsxs)(ne.Z,{style:{...r.madeByContainer,...!v&&{cursor:"default"}},href:v,disabled:!v,external:!0,children:[S&&(0,ce.jsx)("div",{style:r.madeByAvatarContainer,children:(0,ce.jsx)("img",{src:S,style:S===Q.Z.images.notionLogoPng?r.madeByNotionAvatar:r.madeByAvatar})}),(0,ce.jsx)(P.Z,{style:r.madeByLabel,children:(0,ce.jsx)(m.FormattedMessage,{id:"templateDetail.madeBy.label.v2",defaultMessage:"By {author}",values:{author:x}})})]}):null;return(0,ce.jsx)(ce.Fragment,{children:(0,ce.jsxs)("div",{style:r.container,children:[(0,ce.jsx)("div",{style:{height:"100%",overflowX:"hidden",overflowY:"auto",maskImage:"linear-gradient(black 80%, transparent 100%)",WebkitMaskImage:"linear-gradient(black 80%, transparent 100%)"},children:(0,ce.jsxs)("div",{style:{position:"relative"},children:[(0,ce.jsx)("div",{style:{marginTop:-20,opacity:1,zIndex:999,pointerEvents:"none"},children:j}),(0,ce.jsx)("div",{style:{backgroundColor:"transparent",position:"absolute",left:0,top:0,right:0,bottom:0,zIndex:1e3}})]})}),(0,ce.jsxs)("div",{style:r.contentContainer,children:[(0,ce.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,ce.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-start",marginBottom:0},children:(0,ce.jsx)("div",{style:{display:"flex",flexDirection:"column",marginLeft:0},children:(0,ce.jsx)("span",{style:{fontSize:20,fontWeight:700,lineHeight:1.2,marginTop:3,marginBottom:12},children:b})})}),(0,ce.jsx)("div",{children:F}),(0,ce.jsx)("div",{style:{fontSize:14},children:M})]}),(0,ce.jsx)("div",{style:r.getTemplateColumn,children:C?Z:T})]})]})})}var me=n(158573),pe=n(435840),ge=n(150226),fe=n(788779),he=n(653965),ye=n(73657),xe=n(552275),Se=n(661519),ve=n(362896),be=n(374194),Me=n(203386),je=n(672495),Ce=n(918514),we=n(587244),ke=n(314694);function Ie(e){let{topCategoryId:t,categoryId:n}=e;const s=(0,m.useIntl)(),i=(0,a.yK)((e=>({sidebarTitle:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"4px 4px 0 6px"}})),[]),r=(0,o.VK)((()=>{const e=function(){var e;if(!t)return;const s=L.oO(t);return s?null===(e=s.subcategories)||void 0===e?void 0:e.find((e=>e.id===n)):void 0}();if(e)return e.name;const i=E._5[n];return i?s.formatMessage(i):""}),[t,n,s]);return(0,ce.jsx)(ke.Z,{style:i.sidebarTitle,children:r})}var Te=n(83065);function Ze(){const e=(0,i.O7)(),t=(0,a.yK)((e=>({button:{height:28,padding:"0 4px",borderRadius:5,transition:"background 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start",fontWeight:500,marginLeft:6,marginRight:6,width:"calc(100% - 12px)"},icon:{width:14,height:14,marginLeft:6,transform:"rotate(45deg)"},linkContentV2Container:{display:"flex",flexDirection:"column",gap:4},linkContentV2Title:{display:"flex",flexDirection:"row",alignItems:"center",fontWeight:600,fontSize:14},linkContentV2Subtitle:{maxWidth:250,whiteSpace:"inherit",overflow:"inherit",fontWeight:400,fontSize:13}})),[]);return(0,ce.jsx)(ne.Z,{href:(0,Ce.UY)("templateGallery"),onClick:()=>h.T2(e),style:{display:"flex",flexDirection:"row",alignItems:"center"},external:!0,children:(0,ce.jsxs)("div",{style:t.linkContentV2Container,children:[(0,ce.jsxs)(P.Z,{isInline:!1,style:t.linkContentV2Title,children:[(0,ce.jsx)(m.FormattedMessage,{defaultMessage:"More templates",id:"templateGallerySidebar.goToCommunityTemplateGalleryButton.labe2"}),(0,Te._)(t.icon)]}),(0,ce.jsx)(P.Z,{isInline:!1,isSecondaryColor:!0,style:t.linkContentV2Subtitle,children:(0,ce.jsx)(m.FormattedMessage,{defaultMessage:"Discover thousands of templates made by Notion users like you",id:"templateGallerySidebar.goToCommunityTemplateGalleryButton.reason2"})})]})})}var Pe=n(542853),Fe=n(698519),_e=n(531701),Ae=n(751077),Be=n(478140),Re=n(632163),De=n(489728),Oe=n(460709),Le=n(98742);function Ve(e){let{}=e;const t=(0,a.yK)((e=>({newInAppGalleryTopCategoryFilterBarContainer:{border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,marginBottom:8},newInAppGalleryTopCategoryFilterButton:{display:"flex",alignItems:"center",justifyContent:"space-between",color:e.mediumTextColor,padding:"8px 12px",borderRadius:4,marginRight:0,fontSize:g.Z.fontSize.UIRegular.desktop,background:e.inputBackground},newInAppGalleryTopCategoryFilterChevronIcon:{width:15,height:15,fill:e.mediumIconColor}})),[]),n=(0,o.VK)((()=>Y.Z.state.selectedTopCategory),[]),s=(0,o.VK)((()=>q.Z.getTopTemplateCategories()),[]),i=(0,o.VK)((()=>n?L.oO(n):void 0),[n]),r=(0,o.VK)((()=>(null==s?void 0:s.length)>0),[s]);return r?(0,ce.jsx)("div",{style:t.newInAppGalleryTopCategoryFilterBarContainer,children:(0,ce.jsx)(ee.ZP,{popupType:ee.Z4.Popup,alignmentToOrigin:ee.vR.End,placementToOrigin:ee.pO.Bottom,sameWidthAsOrigin:!0,render:e=>(0,ce.jsx)(Be.Z,{menuType:Oe.og.Popup,children:(0,ce.jsx)(Re.Z,{type:Re.i.Vertical,initialFocus:void 0,sections:[{key:"top-category",items:s.map((e=>({key:e.id,action:()=>{if(!r)return;const t=$(e);Y.Z.setState({...Y.Z.state,selectedTopCategory:e.id,allTemplates:t,limitResults:L.JL(t)})},render:t=>(0,ce.jsx)(xe.Z,{...t,title:(0,ce.jsx)(Ee,{category:e,showSelected:e.id===n})})}))),render:e=>(0,ce.jsx)(je.Z,{...e})}],onAccept:()=>e.close()})}),renderOrigin:e=>(0,ce.jsxs)(De.Z,{...(0,Le.Z)(e,{onClick:()=>{}}),style:t.newInAppGalleryTopCategoryFilterButton,children:[(0,ce.jsx)(Ee,{category:i}),(0,Pe.i)(t.newInAppGalleryTopCategoryFilterChevronIcon)]})})}):null}function Ee(e){let{category:t,showSelected:n=!1}=e;const s=(0,a.yK)((e=>({selectedIconStyle:{width:14,height:14,fill:_e.ZP.defaultText},categorySelection:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,lineHeight:"20px"},categoryButtonContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}})),[]);return t?(0,ce.jsxs)("span",{style:s.categoryButtonContainer,children:[(0,ce.jsxs)("span",{style:s.categorySelection,children:[(0,ce.jsx)(Ae.Z,{type:"notion_icon",size:20,icon:t.icon.name,isLoading:!1,progressPercent:void 0,largeIcon:!0}),(0,ce.jsx)("span",{children:t.name})]}),n&&(0,ce.jsx)("span",{children:(0,Fe.k)(s.selectedIconStyle)})]}):null}const Ne=(0,m.defineMessages)({allPersona:{id:"templateGallery.sidebar.persona.allTemplates",defaultMessage:"All templates"},noResults:{id:"templateGallery.sidebar.results",defaultMessage:"No results"}});function Ue(){const[e,t]=(0,s.useState)(""),n=(0,m.useIntl)(),r=(0,i.O7)(),{selectedCategory:l,status:d}=(0,o.VK)((()=>{const{selectedCategory:e,status:t}=Y.Z.state;return{selectedCategory:e,status:t}}),[]),[c,u]=(0,s.useState)(!1);(0,s.useEffect)((()=>{if(!c){const t=Y.Z.state.selectedTemplate;var e;if(t)null===(e=document)||void 0===e||null===(e=e.getElementById(`tg-${"uri"in t?w.presetUriToHumanReadableName[t.uri]:t.template.name}`))||void 0===e||e.scrollIntoView({block:"center"}),u(!0)}}),[c]),(0,s.useEffect)((()=>{"closed"===d&&u(!1)}),[u,d]);const p=(0,a.yK)((e=>({sidebar:{height:"100%",width:V.dm,background:e.sidebarBackground,alignContent:"center",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"stretch",boxShadow:e.sidebarBoxShadow},sidebarMoreFromCommunityContainer:{padding:12,borderTop:`1px solid ${e.accentColors.translucentGray[200]}`},header:{padding:"12px 12px 0 12px"},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor},searchBar:{height:32,borderRadius:5,fontSize:14,marginTop:0,marginBottom:8,padding:"16px 10px"},filterBar:{display:"flex",flexDirection:"row",width:273,flexWrap:"wrap",gap:6},newInAppGalleryBrandContainer:{display:"flex",alignItems:"center",width:"100%",gap:6,marginBottom:10},newInAppGalleryBrandName:{fontSize:15,fontWeight:600,color:e.regularTextColor},newInAppGalleryBrandIcon:{width:18,height:15,fill:e.regularTextColor},newInAppGallerySearchBarContainer:{padding:"0px 12px"}})),[]),g=(0,s.useMemo)((()=>(0,ce.jsx)(Me.Z,{debugName:"TemplateGallerySidebar",capture:!0,onBackspace:he.yR,onLeft:he.yR,onRight:he.yR,onSelectAll:he.yR,onRedo:he.yR,onUndo:he.yR,onCut:he.yR,onCopy:he.yR,onPaste:he.yR,onKeypress:he.yR,onDelete:he.yR,onTab:he.yR,children:(0,ce.jsx)(we.N,{step:"browse_templates",isFullWidth:!1,children:(0,ce.jsx)(be.Z,{placeholder:n.formatMessage({id:"templateGallery.sidebar.searchbar.placeholder",defaultMessage:"Search templates"}),left:(0,pe.R)(p.searchIcon),showClearButton:!0,format:be.B.Small,value:e,style:p.searchBar,onChange:e=>t(e.target.value)})})})),[e,n,p.searchBar,p.searchIcon]);return(0,ce.jsxs)("div",{style:p.sidebar,children:[(0,ce.jsxs)("div",{style:p.header,children:[(0,ce.jsxs)(ne.Z,{href:(0,Ce.UY)("templateGallery"),onClick:()=>h.Ib(r),style:p.newInAppGalleryBrandContainer,external:!0,children:[(0,ge.I)(p.newInAppGalleryBrandIcon),(0,ce.jsx)("span",{style:p.newInAppGalleryBrandName,children:(0,ce.jsx)(m.FormattedMessage,{id:"templateGallery.brand.title",defaultMessage:"Templates"})})]}),(0,ce.jsx)(Ve,{})]}),(0,ce.jsx)("div",{style:p.newInAppGallerySearchBarContainer,children:g}),(0,ce.jsx)(Ke,{currentQuery:e,selectedCategory:l}),(0,ce.jsxs)("div",{children:[(0,ce.jsx)(Se.Z,{size:"0"}),(0,ce.jsx)("div",{style:p.sidebarMoreFromCommunityContainer,children:(0,ce.jsx)(Ze,{})})]})]})}function Ke(e){const{currentQuery:t,selectedCategory:n}=e,i=""!==t||void 0!==n,{allTemplates:r,selectedTopCategory:l,status:d,limitResults:c}=(0,o.VK)((()=>{const{allTemplates:e,selectedTopCategory:t,status:n,limitResults:s}=Y.Z.state;return{allTemplates:e,selectedTopCategory:t,status:n,limitResults:s}}),[]),u=(0,a.yK)((e=>({button:{height:44,padding:"8px 0",borderRadius:4,marginBottom:4,transition:"all 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start"},categoryDiv:{marginBottom:i?0:14},unSelectedItem:{color:e.mediumTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.buttonHoveredBackground,fontWeight:500,color:e.regularTextColor},hoveredItem:{borderRadius:4,background:e.buttonHoveredBackground},presetTitle:{fontSize:14,color:e.regularTextColor},presetDescription:{fontSize:12},sidebarTitle:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"4px 4px 0 6px"},sidebarShowMore:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"2px 2px 0 6px"}})),[i]),p=(0,o.VK)((()=>{if("open"!==d||void 0===r)return[];const e=new Set;return Object.fromEntries(Object.entries(r).filter((e=>{let[t]=e;return void 0===n||t===n})).map((n=>{let[s,i]=n;return[s,(0,me.ZP)(t.replaceAll("-",""),i,(e=>`${e.name}`.replaceAll("-",""))).filter((t=>{const n=e.has(t.name);return e.add(t.name),!n}))]})))}),[d,r,n,t]),g=(0,s.useCallback)((e=>{"open"===d&&void 0!==c&&Y.Z.setState({...Y.Z.state,limitResults:{...c,[e]:!1}})}),[c,d]);return"open"!==d?null:(0,ce.jsx)("div",{style:{flexGrow:1,width:"100%",overflowX:"hidden",overflowY:"auto"},children:(0,ce.jsxs)(je.Z,{desktopTitleStyle:{paddingLeft:8},children:[Object.entries(p).map((e=>{let[t,n]=e;if(0===n.length)return;const s=!(null==c||!c[t])&&!i&&n.length>B.IJ+1,o=s?n.length-B.IJ:0,a=s?n.slice(0,B.IJ):n;return(0,ce.jsxs)("div",{style:u.categoryDiv,children:[!i&&(0,ce.jsx)(Ie,{topCategoryId:l,categoryId:t}),a.map((e=>"uri"in e?(0,ce.jsx)(We,{icon:e.icon,name:e.name,template:{type:"preset",uri:e.uri},preferIcon:!0},e.uri):(0,ce.jsx)(We,{icon:e.icon,emoji:e.emoji,name:e.name,template:{type:"pageTemplate",template:e},preferIcon:"suggested"===t},e.id))),s&&o>0?(0,ce.jsx)(xe.Z,{style:u.sidebarShowMore,focused:!1,onClick:()=>g(t),title:(0,ce.jsx)(m.FormattedMessage,{defaultMessage:"{numNotShown} more...",id:"templateGallerySidebar.category.showMore",values:{numNotShown:o}})}):void 0]},t)})),0===Object.values(p).flatMap((e=>e)).length&&(0,ce.jsx)(ye.Z,{caption:W.default.formatMessage(Ne.noResults),style:{lineHeight:"14px",padding:6,margin:0}})]})})}function We(e){var t;const n=(0,i.O7)(),r=(0,a.yK)((e=>({button:{height:28,padding:"0 4px",borderRadius:5,transition:"background 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start",fontWeight:500,marginLeft:6,marginRight:6,width:"calc(100% - 12px)"},itemText:{marginLeft:5},unSelectedItemText:{color:e.mediumTextColor},selectedItemText:{color:e.regularTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.sidebarItemSelectedBackground,fontWeight:500},hoveredItem:{background:e.buttonHoveredBackground},presetIcon:{width:16,height:16,fontSize:16,color:e.regularEmojiColor},presetTitle:{fontSize:14},presetDescription:{fontSize:12}})),[]),{status:l,selectedTemplate:d,analyticsFrom:c}=(0,o.VK)((()=>{const{status:e,selectedTemplate:t,analyticsFrom:n}=Y.Z.state;return{status:e,selectedTemplate:t,analyticsFrom:n}}),[]),u=(0,o.VK)((()=>"open"===l&&he.Xy(d,e.template)),[l,e.template,d]),m=(0,s.useCallback)((()=>{const t="uri"in e.template?w.presetUriToHumanReadableName[e.template.uri]:e.template.template.previewRootId,s=(0,B.W4)({templateGalleryItem:t});v.c4({environment:n,url:s}),h.n1(n,{template_name:"preset"===e.template.type?e.template.uri:e.template.template.name,page_prepopulated_template_id:t,from:c})}),[c,n,e.template]);if("open"!==l)return null;let p=(0,ce.jsx)("div",{style:r.presetIcon,children:(0,ce.jsx)(ve.Z,{children:fe.kQ})});e.preferIcon&&null!==(t=e.icon)&&void 0!==t&&t.startsWith("/")?p=(0,ce.jsx)("img",{src:e.icon,style:r.presetIcon}):e.emoji&&(p=(0,ce.jsx)("div",{style:r.presetIcon,children:(0,ce.jsx)(ve.Z,{children:e.emoji})}));const g=`tg-${"uri"in e.template?w.presetUriToHumanReadableName[e.template.uri]:e.template.template.name}`;return(0,ce.jsx)(xe.Z,{id:g,desktopIconStyle:{alignSelf:"unset"},buttonStyle:{...r.button,...u?r.selectedItem:void 0},textWrapperStyle:{...u?r.selectedItemText:r.unSelectedItemText,...r.itemText},focused:!1,icon:p,title:(0,ce.jsx)("span",{style:r.presetTitle,children:e.name}),shouldWrapCaption:!0,hoveredStyle:r.hoveredItem,onClick:m})}const ze=["companyHome","defaultWiki","engineeringWiki","salesWiki","teamWiki"];function qe(){const e=(0,i.Fy)(),t=(0,i.O7)(),n=(0,m.useIntl)(),d=(0,s.useRef)(void 0),u=(0,a.yK)((t=>({modal:{width:e.isMobile?"auto":`${V.E2}vw`,height:e.isMobile?"auto":`${V.YQ}vh`,borderRadius:8}})),[e.isMobile]),g=(0,o.VK)((()=>R.default.state.currentSpaceStore),[]),{templateGalleryItem:T}=(0,o.VK)((()=>t.RouterStore.state.route),[t.RouterStore]),{status:P,allTemplates:E,selectedTemplate:N,cloneTo:U,limitResults:K}=(0,o.VK)((()=>{const{status:e,allTemplates:t,selectedTemplate:n,cloneTo:s,limitResults:i}=Y.Z.state;return{status:e,allTemplates:t,selectedTemplate:n,cloneTo:s,limitResults:i}}),[]);(0,s.useEffect)((()=>{if(T)return d.current=window.setTimeout((()=>{Y.Z.setState({...Y.Z.state,status:"closed"})}),1e4),()=>{void 0!==d.current&&window.clearTimeout(d.current)}}),[]);const W=(0,s.useRef)(void 0);(0,s.useEffect)((()=>{W.current&&(W.current=void 0)}),[null==g?void 0:g.id]),(0,s.useEffect)((()=>{var e;W.current&&"opening"!==P||"closed"!==P&&(W.current||(W.current=D.h({environment:t,spaceId:null==g?void 0:g.id})),null===(e=W.current)||void 0===e||e.then((()=>{var e;const t=T&&L.vY(T),{selectedTopCategory:n,allTemplates:s}=G({userPersona:(0,A.kO)().function,subscriptionTier:null===(e=R.default.state.currentSpaceStore)||void 0===e?void 0:e.getSubscriptionTier(),selectedTopCategory:t});Y.Z.setState({...Y.Z.state,selectedTopCategory:n,allTemplates:s,limitResults:L.JL(s)})})).finally((()=>{void 0!==d.current&&window.clearTimeout(d.current)})))}),[t,null==g?void 0:g.id,W,P,T]),(0,s.useEffect)((()=>{if(void 0!==E&&"opening"===P){const e=void 0!==N&&(void 0===T||"gallery"===T)?N:Ge({templateGalleryItem:T,allTemplates:E,environment:t});return Y.Z.setState({...Y.Z.state,status:"open",allTemplates:E,selectedTemplate:e,limitResults:K??L.JL(E),cloneTo:Y.Z.state.cloneTo,analyticsFrom:Y.Z.state.analyticsFrom}),void h.jW(t,{template_name:"preset"===e.type?e.uri:e.template.name,template_id:(0,B.gA)(e),from:Y.Z.state.analyticsFrom})}}),[T,t,E,P,N,U,K]),(0,s.useEffect)((()=>{"open"===P&&void 0!==E&&void 0!==T&&"gallery"!==T&&Y.Z.setState({...Y.Z.state,selectedTemplate:Ge({templateGalleryItem:T,allTemplates:E})})}),[E,P,T]);const z=(0,o.VK)((()=>{const e=(0,F.np)();if("open"===P&&"current_page"===U&&e&&e.isEmptyPage())return e}),[U,P]),q=(0,s.useCallback)((async(e,n)=>{var s,i,o;Y.Z.setState({...Y.Z.state,status:"closed",selectedTemplate:void 0});const{currentSpaceStore:a,currentSpaceViewStore:d}=R.default.state,u=null==z||!z.getParentStore()||"block"!==(null===(s=z.getParentStore())||void 0===s?void 0:s.table)&&"space"!==(null===(i=z.getParentStore())||void 0===i?void 0:i.table)&&"team"!==(null===(o=z.getParentStore())||void 0===o?void 0:o.table)?n||a:z.getParentStore(),p=Date.now();let g;if("preset"===e.type&&(0,l.SA)(e.uri)){var v;const s=e.uri,i=null===(v=(0,I.iX)((0,w.appConfigs)(),s))||void 0===v?void 0:v.uri;if(!(i&&a&&d&&u))return;const o=n||_.VP(u);if(o){const e=await async function(e){let{environment:t,spaceId:n,presetUri:s,teamStore:i}=e;const o=await async function(e){let{environment:t,spaceId:n,presetUri:s,parentStore:i,teamId:o}=e;const a=n?await M.nc({environment:t,spaceId:n,databaseTypes:(0,c.Pi)(s),parentStore:i,teamId:o}):[];if(0===a.length)return{shouldShowConfirmModal:!1};return{shouldShowConfirmModal:!0,existingDatabaseTypes:a}}({environment:t,spaceId:n,presetUri:s,parentStore:i,teamId:i.id}),{shouldShowConfirmModal:a}=o;if(!a)return!0;const{existingDatabaseTypes:r}=o;return new Promise((e=>{h.Yn(t,{from:"template_gallery"}),y.showDialog({handleCancel:()=>{h.nn(t,{from:"template_gallery",option:"no"}),e(!1)},showCancel:!0,keepFocus:!1,message:(0,ce.jsx)($e,{presetUri:s,existingDatabaseTypes:r}),items:[{label:(0,ce.jsx)(m.FormattedMessage,{id:"sidebar.appTemplate.confirmAdditionalAppTemplate.confirmAddAnyway.label",defaultMessage:"Add anyway"}),color:"red",onAccept:()=>{h.nn(t,{from:"template_gallery",option:"yes"}),e(!0)}}]})}))}({environment:t,spaceId:a.id,presetUri:s,teamStore:o});if(!e)return}const r=z||(n?n.getTeamPagesStores().find((e=>e.getFormat().app_config_uri&&e.getFormat().app_config_uri===i)):void 0);b.createAndCommit({environment:t,userAction:"templateGallery.getTemplate",perform:e=>{const n=(0,w.appConfigs)().find((e=>e.uri===i)),o=null==n?void 0:n.presets.find((e=>e.uri===s));if(d&&o){const n=j.initializeApp({environment:t,spaceViewStore:d,appUri:i,presetUri:o.uri,appParentStore:u,temporaryContainerBlockStore:r,transaction:e,from:"template_gallery"});j.markTasksDatabaseTemplateIfNeeded(n),C.createSprintPage({environment:t,spaceViewStore:d,appParentStore:u,transaction:e,blockStores:n,creationEntryPoint:{type:"preset",presetUri:o.uri}}),g=null==n?void 0:n[0]}}})}else{const s="preset"===e.type?(0,k.CQ)(e.uri):e.template;if(!s)return;if(!a||!d)return;const i={environment:t,item:s,spaceStore:a,spaceViewStore:d,useMinimalTemplates:!1,from:"template_gallery"},o=z?await x.rC({...i,isPrivate:!1,initializeStore:z,type:"inExistingStore"}):n?await x.rC({...i,isPrivate:!1,teamStore:n,type:"inTeam",appendOrPrepend:"append"}):await x.rC({...i,isPrivate:!0,type:"inSpace"});g=o,o&&S._c({environment:t,store:o,pageVisitSource:r.tY.Create})}const T="preset"===e.type?e.uri:e.template.name,Z=Date.now()-p,P=z?!_.VP(z):!Boolean(n),F=P||null==n?void 0:n.id,A=g?g.id:null==z?void 0:z.id;h.en(t,{template_name:T,destination:P?"private":"team",template_block_id:"pageTemplate"===e.type?e.template.rootId:void 0,template_duplication_duration_ms:Z,team_id:F,created_page_id:A}),h.Xy(t,{from:"inApp",template_name:T,template_id:"preset"===e.type?e.uri:e.template.id,template_block_id:"pageTemplate"===e.type?e.template.rootId:void 0,template_duplication_duration_ms:Z,success:!!A}),f.W(t,{type:"page",from:"template_gallery",new_page_id:A,creating_block_id:A}),"preset"===e.type&&(0,l.SA)(e.uri)&&g&&h.bR(t,{preset_uri:e.uri,created_block_stores:[g],from:"template_gallery",destination_team_id:F}),"pageTemplate"===e.type&&Je(e.template.id)&&g&&h.Jw(t,{from:"template_gallery",wiki_block_id:g.id,destination_team_id:F,wiki_template_id:e.template.id})}),[t,z]),H=(0,s.useCallback)((()=>{const{mainEditorCurrentBlockStore:e}=R.default.state,{RouterStore:n}=t,s=n.state.route,i=window.location.href,{tg:o}=(0,B.SG)(i),a=o&&(0,p.t)(o);if(h.Tt(t,{template_id:a?o:void 0,preset_uri:a?void 0:o}),e&&"page"===s.name){const e=(0,B.p8)();v.c4({environment:t,url:e})}else"chat"===s.name&&(0,O.W)()}),[t]);return(0,ce.jsx)(Z.Z,{ariaLabel:n.formatMessage({id:"templateGallery.dialogLabel",defaultMessage:"Templates"}),open:"open"===P,innerStyle:u.modal,onDismiss:H,render:()=>"open"!==P?null:(0,ce.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"},children:[(0,ce.jsx)(Ue,{}),(0,ce.jsx)(ue,{onAcceptTemplate:q})]})})}function Ge(e){let{templateGalleryItem:t,allTemplates:n,environment:s}=e;if(!t||"gallery"===t)return He(n);const i=Object.values(n).flatMap((e=>e)).find((e=>"uri"in e?w.presetUriToHumanReadableName[e.uri]===t:e.previewRootId===t));return i?"uri"in i?{type:"preset",uri:i.uri}:{type:"pageTemplate",template:i}:(s&&h.Ui(s,{templateBlockId:t}),He(n))}function He(e){const t=e[Object.keys(e)[0]][0];return"uri"in t?{type:"preset",uri:t.uri}:{type:"pageTemplate",template:t}}function $e(e){const{presetUri:t,existingDatabaseTypes:n}=e,s=(0,m.useIntl)(),i=(0,a.yK)((()=>({messageContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:12,marginTop:8,marginBottom:8},titleIcon:{height:38,width:38,color:"#D34F43"},confirmationTitle:{fontWeight:g.Z.fontWeight.medium,fontSize:18,textAlign:"center",marginTop:8,marginBottom:4},confirmationSubtitle:{fontSize:14,textAlign:"center"}})),[]),{title:r,icon:l}=(0,o.VK)((()=>function(e){let{presetUri:t,iconStyle:n}=e;return{title:Ye(t),icon:Qe({presetUri:t,style:n})}}({presetUri:t,iconStyle:i.titleIcon})),[t,i.titleIcon]);return(0,ce.jsxs)("div",{style:i.messageContainer,children:[l,(0,ce.jsx)(P.Z,{isMultiline:!0,style:i.confirmationTitle,children:(0,ce.jsx)(m.FormattedMessage,{id:"sidebar.appTemplate.confirmAdditionalAppTemplate",defaultMessage:"Are you sure you want to add another {templateName} template?",values:{templateName:r}})}),(0,ce.jsx)(P.Z,{isMultiline:!0,style:i.confirmationSubtitle,children:n&&n.length>0?(0,ce.jsx)(m.FormattedMessage,{id:"sidebar.appTemplate.confirmAdditionalAppTemplate.existingAppsCaption",defaultMessage:"{existingDatabaseTypes} already exist in this teamspace. This template works best if there is only one per teamspace.",values:{existingDatabaseTypes:s.formatList(n.map((e=>(0,T.Mn)(e))))}}):(0,ce.jsx)(m.FormattedMessage,{id:"sidebar.appTemplate.confirmAdditionalAppTemplate.caption",defaultMessage:"{templateName} template works best if there is only one per teamspace.",values:{templateName:r}})})]})}function Ye(e){return e===l.rK?(0,ce.jsx)(m.FormattedMessage,{id:"sidebar.addTemplateToExistingTeam.wiki",defaultMessage:"Wiki"}):(0,I.YC)((0,w.appConfigs)(),e).name}function Qe(e){var t,n;let{presetUri:s,style:i}=e;return l.xm.includes(s)?null===(t=(n=d.y[s]).icon)||void 0===t?void 0:t.call(n,i):null}function Je(e){return ze.some((t=>u.Yt[t].nameMessage.id===e))}},151744:(e,t,n)=>{n.d(t,{Z:()=>i});var s=n(401898);function i(e){return e.isGuestInviteRequest()?"guest_invite_request":e.isPageAccessRequest()?"page_access_request":e.isSpaceMembershipRequest()?"space_membership_request":e.isTeamMembershipRequest()?"team_membership_request":void(0,s.t1)(e)}},79571:(e,t,n)=>{n.d(t,{xg:()=>d,$Q:()=>c,$Z:()=>r,rx:()=>l,Y6:()=>m,QN:()=>p,$e:()=>u,nK:()=>o});var s=n(730120);const i=[{name:"ai_qna_alpha",placement:"Modal",start:s.ou.fromISO("June 1 2024").toMillis(),end:s.ou.fromISO("June 15 2025").toMillis()},{name:"ai_slack_universal_qna_announcement",placement:"Modal",migrated:!0,start:s.ou.fromISO("June 1 2024").toMillis(),end:s.ou.fromISO("June 15 2025").toMillis()},{name:"ai_assistant_announcement",placement:"Modal",migrated:!0,start:s.ou.fromISO("June 1 2024").toMillis(),end:s.ou.fromISO("June 15 2025").toMillis()},{name:"dummy_modal",placement:"Modal",migrated:!0,start:s.ou.fromISO("June 1 2024").toMillis(),end:s.ou.fromISO("June 15 2025").toMillis()},{name:"notion_calendar_launch_promo",placement:"Modal",start:s.ou.fromISO("June 1 2024").toMillis(),end:s.ou.fromISO("June 15 2025").toMillis()},{name:"charts_launch_modal",placement:"Modal",start:s.ou.fromISO("June 1 2024").toMillis(),end:s.ou.fromISO("June 15 2025").toMillis()},{name:"sites_launch_modal",placement:"Modal",start:s.ou.fromISO("June 25 2024").toMillis(),end:s.ou.fromISO("June 25 2025").toMillis()},{name:"persistent_upgrade_nudge",placement:"SidebarFooter",migrated:!0,start:s.ou.fromISO("June 1 2024").toMillis(),end:s.ou.fromISO("June 15 2025").toMillis()},{name:"sidebar_upgrade_nudge",placement:"SidebarFooter",migrated:!0,start:s.ou.fromISO("June 1 2024").toMillis(),end:s.ou.fromISO("June 15 2025").toMillis()},{name:"startup_sidebar_footer",placement:"SidebarFooter",start:s.ou.fromISO("June 1 2024").toMillis(),end:s.ou.fromISO("June 15 2025").toMillis()}],o=["Modal","SidebarFooter"],a=i,r=a.map((e=>e.name)),l=a.filter((e=>!!e.migrated)).map((e=>e.name)),d=a.reduce(((e,t)=>({...e,[t.name]:t})),{}),c={globalConstraint:{frequencyCap:{maxCountInWindow:Number.POSITIVE_INFINITY,window:"week"}},placementConstraints:{Modal:{conflictsWith:[],maxConcurrent:1,frequencyCap:{maxCountInWindow:Number.POSITIVE_INFINITY,window:"week"}},SidebarFooter:{conflictsWith:[],maxConcurrent:1,frequencyCap:{maxCountInWindow:Number.POSITIVE_INFINITY,window:"week"}}}};function u(){return{Modal:new Set,SidebarFooter:new Set}}function m(){return{Modal:[],SidebarFooter:[]}}function p(e){return d[e].placement}},247025:(e,t,n)=>{n.d(t,{Dv:()=>T,Fh:()=>l,GX:()=>x,Gs:()=>d,II:()=>I,Kx:()=>j,OY:()=>y,Oy:()=>_,PL:()=>k,QJ:()=>f,R1:()=>S,Sw:()=>P,T9:()=>C,UJ:()=>g,Vu:()=>A,Xg:()=>m,Xm:()=>p,dY:()=>v,f3:()=>Z,h_:()=>h,hd:()=>c,l2:()=>F,lr:()=>u,qV:()=>w,vi:()=>B,vx:()=>M});var s=n(401898),i=n(435011),o=n(114714),a=n(399036),r=n(180951);const l=["gray","blue","yellow","green","purple","teal","orange","pink","red"],d=["auto","colorful"];let c=function(e){return e.manual="manual",e.resultsAdvanced="results-advanced",e.yAscending="y-ascending",e.yDescending="y-descending",e.xAscending="x-ascending",e.xDescending="x-descending",e}({}),u=function(e){return e.avatar="avatar",e.avatar_name="avatar_name",e.name="name",e}({}),m=function(e){return e.none="none",e.x_axis="x_axis",e.y_axis="y_axis",e.both="both",e}({}),p=function(e){return e.none="none",e.horizontal="horizontal",e.vertical="vertical",e.both="both",e}({}),g=function(e){return e.normal="normal",e.percent="percent",e.side_by_side="side_by_side",e}({});function f(e){if(!e)return!1;return o.vu.includes(e)}function h(e){if(!e)return!1;return o.z8.includes(e)}function y(e){const t=(0,i.r9)(e);return"text"===t||"number"===t||"checkbox"===t||"person"===t||"date"===t}function x(e){let t,n=e.chartFormat;if("groups_reducer"===e.dataConfig.type){var i;const{chartFormat:s,chartGroupByFormat:o}=b(null==e||null===(i=e.dataConfig)||void 0===i?void 0:i.groupBy,null==e?void 0:e.chartFormat,"donut");n=s,t={...e.dataConfig,groupBy:o,aggregationConfig:{aggregation:e.dataConfig.aggregationConfig.aggregation}}}else"results_reducer"===e.dataConfig.type?t=e.dataConfig:(0,s.t1)(e.dataConfig);const o={...e,type:"donut",dataConfig:t};return n&&(o.chartFormat=n),o}function S(e,t){let n;return"groups_reducer"===e.dataConfig.type?n={...e.dataConfig,aggregationConfig:{...e.dataConfig.aggregationConfig,seriesFormat:{displayType:t},stackOptions:void 0}}:"results_reducer"===e.dataConfig.type?n={...e.dataConfig,valueSeriesFormat:{displayType:t}}:(0,s.t1)(e.dataConfig),{...e,type:t,dataConfig:n}}function v(e,t){let n,i=e.chartFormat;if("groups_reducer"===e.dataConfig.type){var o;const{chartFormat:s,chartGroupByFormat:a}=b(null==e||null===(o=e.dataConfig)||void 0===o?void 0:o.groupBy,null==e?void 0:e.chartFormat,t);i=s,n={...e.dataConfig,groupBy:a,aggregationConfig:{...e.dataConfig.aggregationConfig,seriesFormat:{displayType:t}}}}else"results_reducer"===e.dataConfig.type?n={...e.dataConfig,valueSeriesFormat:{displayType:t}}:(0,s.t1)(e.dataConfig);const a={...e,type:t,dataConfig:n};return i&&(a.chartFormat=i),a}function b(e,t,n){if(!((null==t?void 0:t.axisSort)!==c.yAscending&&(null==t?void 0:t.axisSort)!==c.yDescending||"line"!==n&&"donut"!==n)){const n=(0,o.Cc)(e);return{chartFormat:{...t,axisSort:j(n.sort)},chartGroupByFormat:n}}return{chartFormat:t,chartGroupByFormat:e}}function M(){return c.xAscending}function j(e){switch(null==e?void 0:e.type){case"manual":return c.manual;case"descending":return c.xDescending;default:return c.xAscending}}function C(e){let{chartConfig:t,xAxisPropertyId:n,newDataConfigType:i,groupBy:o,aggregation:a,valueProperty:r}=e;const l="groups_reducer"===t.dataConfig.type?t.dataConfig.aggregationConfig.seriesFormat:t.dataConfig.valueSeriesFormat;"groups_reducer"===i?t.dataConfig={type:"groups_reducer",groupBy:o,aggregationConfig:{aggregation:a,seriesFormat:l,stackOptions:"groups_reducer"===t.dataConfig.type?t.dataConfig.aggregationConfig.stackOptions:void 0}}:"results_reducer"===i?t.dataConfig={type:"results_reducer",nameProperty:n,valueProperty:r,valueSeriesFormat:l}:(0,s.t1)(i);const d="formula"===o.type?o.groupBy.sort:o.sort;return t.chartFormat={...t.chartFormat,axisSort:j(d)},t}function w(e){let{property:t,propertySchema:n,groupByOption:s}=e;const a=n.type;if((0,o.LG)(n)){if((0,o.A1)(a)){if(s&&h(s))return{type:a,property:t,groupBy:s,sort:{type:"ascending"}}}else{if((0,o.zb)(a)||"select"===a||"multi_select"===a)return{type:a,property:t,sort:{type:"ascending"}};if((0,o.H1)(a)){if(s&&f(s))return{type:a,property:t,groupBy:s,sort:{type:"ascending"}}}else{if("number"===a)return{type:a,property:t,groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}};if("formula"===a){const e=(0,i.mm)(n);if("number"===e)return{type:"formula",property:t,groupBy:{type:"number",groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}}};if("date"===e&&h(s))return{type:"formula",property:t,groupBy:{type:"date",groupBy:s,sort:{type:"ascending"}}}}else if("person"===a)return{type:a,property:t,sort:{type:"manual"}}}}return(0,o.fw)(t,n)}}function k(e){if((0,o.ib)(e)||(0,o.TD)(e))return e.groupBy;if("formula"===e.type){const t=e.groupBy;if((0,o.ib)(t)||(0,o.TD)(t))return t.groupBy}}function I(e){let{collectionSchema:t,property:n}=e;const s=(0,r.Qm)({schema:t,property:n});return s&&(0,o.LG)(s)?T(s)?[{aggregator:"count"},{aggregator:"sum",property:n},{aggregator:"average",property:n},{aggregator:"min",property:n},{aggregator:"max",property:n},{aggregator:"median",property:n}]:[{aggregator:"count"}]:[]}function T(e){const t="formula"===e.type?(0,i.mm)(e):void 0;return(0,a.G$)(e)||"number"===t}function Z(e){const t="formula"===e.type?(0,i.mm)(e):void 0;return(0,o.A1)(e.type)||"date"===t}function P(e){const t="formula"===e.type?(0,i.mm)(e):void 0;return(0,a.U8)(e)||"person"===t}function F(e){return(0,o.A1)(e.type)}function _(e){return"text"===e||"number"===e||"person"===e||"date"===e}function A(e){var t;return("bar"===(null==e?void 0:e.type)||"column"===(null==e?void 0:e.type))&&("groups_reducer"!==e.dataConfig.type||!e.dataConfig.aggregationConfig.stackOptions||"percent"!==(null===(t=e.chartFormat)||void 0===t?void 0:t.axisGroupStyle))}function B(e){return!!A(e)&&(("bar"===(null==e?void 0:e.type)||"column"===(null==e?void 0:e.type))&&(void 0===(null===(t=e.chartFormat)||void 0===t?void 0:t.axisShowDataLabels)||(null===(n=e.chartFormat)||void 0===n?void 0:n.axisShowDataLabels)));var t,n}},894919:(e,t,n)=>{n.d(t,{W:()=>o});n(667294);var s=n(398724),i=n(785893);function o(e){const{cost:t,intl:n}=e,o=e.trailingZeroDisplay??"auto",a=e.currencySign??"accounting",r=s.n.fromValue(t);let l=n.formatNumber(r.amount/Math.pow(10,r.currencyValue.minorUnitDigits),{style:"currency",currency:r.currencyCode,currencyDisplay:"symbol",currencySign:a});return"stripIfInteger"===o&&(l=l.replace(new RegExp(`[.,]0{${r.currencyValue.minorUnitDigits}}(\\s+.*)?$`),"$1")),(0,i.jsx)(i.Fragment,{children:l})}},143169:(e,t,n)=>{n.d(t,{AS:()=>a,Hs:()=>r,b:()=>l});var s=n(401898),i=n(959753),o=n(244312);const a=(0,s.AO)((e=>"invalid"===e.type||"unverified"===e.type?{true:e}:{false:e}));function r(e){const t=i.kk.fromValue(o.Jd,e);return{type:t.verified_at?"verified":"unverified",id:t.id,domain:t.domain,verificationCode:t.verification_code,createdAt:t.created_at,expiresAt:t.expires_at,invalidatedAt:t.getInfo().invalidated_at}}let l=function(e){return e.ConfiguredSSO="configured-sso",e.EnforcedSSO="enforced-sso",e.Standard="standard",e.NotAvailable="not-available",e}({})},679956:(e,t,n)=>{n.d(t,{F:()=>s});const s=(0,n(745238).CZ)("checkmarkCircle",{default:{loader:()=>n.e(25055).then(n.bind(n,825055)),size:20},small:{loader:()=>n.e(23132).then(n.bind(n,123132)),size:16},mini:{loader:()=>n.e(87790).then(n.bind(n,587790)),size:14},large:{loader:()=>n.e(26031).then(n.bind(n,226031)),size:24}})},938872:(e,t,n)=>{n.d(t,{t:()=>s});const s=(0,n(745238).CZ)("checkmarkShieldFill",{default:{loader:()=>n.e(32692).then(n.bind(n,532692)),size:20},small:{loader:()=>n.e(21812).then(n.bind(n,121812)),size:16},mini:{loader:()=>n.e(53016).then(n.bind(n,53016)),size:14},large:{loader:()=>n.e(21763).then(n.bind(n,721763)),size:24}})},493535:(e,t,n)=>{n.d(t,{x:()=>s});const s=(0,n(745238).CZ)("exclamationMarkCircle",{default:{loader:()=>n.e(37597).then(n.bind(n,837597)),size:20},small:{loader:()=>n.e(49067).then(n.bind(n,949067)),size:16},mini:{loader:()=>n.e(58812).then(n.bind(n,58812)),size:14},micro:{loader:()=>n.e(27347).then(n.bind(n,327347)),size:14},large:{loader:()=>n.e(7360).then(n.bind(n,807360)),size:24},max:{loader:()=>n.e(7360).then(n.bind(n,807360)),size:28}})},965991:(e,t,n)=>{n.d(t,{$:()=>s});const s=(0,n(745238).CZ)("gift",{default:{loader:()=>n.e(22765).then(n.bind(n,22765)),size:20},small:{loader:()=>n.e(83153).then(n.bind(n,483153)),size:16},mini:{loader:()=>n.e(33467).then(n.bind(n,933467)),size:14},large:{loader:()=>n.e(69743).then(n.bind(n,569743)),size:24}})},747612:(e,t,n)=>{n.d(t,{C:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("addPersonCircle",{viewBox:"0 0 50 43",svg:(0,i.jsx)("path",{d:"M28.5 42c11.214 0 20.535-9.322 20.535-20.535C49.035 10.23 39.694.93 28.48.93 17.99.93 9.233 9.003 8.106 19.21c.987-.181 2.416-.262 3.483-.141 1.107-8.355 8.194-14.717 16.89-14.717 9.483 0 17.133 7.61 17.133 17.113 0 4.429-1.65 8.455-4.409 11.455-1.973-2.356-6.643-4.61-12.723-4.61a22.58 22.58 0 00-5.295.624 12.85 12.85 0 01-2.718 11.375 19.941 19.941 0 008.033 1.69zm-.02-17.113c3.865.04 6.905-3.261 6.905-7.59 0-4.067-3.06-7.429-6.905-7.429-3.866 0-6.946 3.362-6.905 7.43.02 4.308 3.04 7.549 6.905 7.589zM10.562 42.221c5.537 0 10.227-4.63 10.227-10.227 0-5.617-4.61-10.227-10.227-10.227-5.597 0-10.227 4.63-10.227 10.227 0 5.637 4.63 10.227 10.227 10.227zm0-3.825c-.745 0-1.228-.483-1.228-1.228v-3.946H5.388c-.725 0-1.228-.483-1.228-1.228s.503-1.228 1.228-1.228h3.946V26.82c0-.725.483-1.228 1.228-1.228s1.228.503 1.228 1.228v3.946h3.946c.725 0 1.228.483 1.228 1.228s-.503 1.228-1.228 1.228H11.79v3.946c0 .745-.483 1.228-1.228 1.228z"})})},715769:(e,t,n)=>{n.d(t,{Q:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("androidShare",{viewBox:"0 0 15 15",svg:(0,i.jsx)("path",{d:"M11.9952,10.6024 C11.4229,10.6024 10.9108,10.8283 10.51928,11.1822 L5.15029999,8.05723 C5.18794999,7.88404 5.21806999,7.71084 5.21806999,7.53012 C5.21806999,7.3494 5.18794999,7.1762 5.15029999,7.00301 L10.45904,3.90813 C10.8657,4.28464 11.4003,4.51807 11.9952,4.51807 C13.2452,4.51807 14.2542,3.50904 14.2542,2.25904 C14.2542,1.00904 13.2452,0 11.9952,0 C10.7452,0 9.73614999,1.00904 9.73614999,2.25904 C9.73614999,2.43976 9.76626999,2.61295 9.80391999,2.78614 L4.49517999,5.88102 C4.08854999,5.50452 3.55391999,5.27108 2.95903999,5.27108 C1.70903999,5.27108 0.699999988,6.28012 0.699999988,7.53012 C0.699999988,8.78012 1.70903999,9.78916 2.95903999,9.78916 C3.55391999,9.78916 4.08854999,9.55572 4.49517999,9.17922 L9.85662999,12.3117 C9.81897999,12.4699 9.79638999,12.6355 9.79638999,12.8012 C9.79638999,14.0136 10.7828,15 11.9952,15 C13.2075,15 14.194,14.0136 14.194,12.8012 C14.194,11.5889 13.2075,10.6024 11.9952,10.6024 Z"})})},188145:(e,t,n)=>{n.d(t,{E:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("appDownload",{viewBox:"0 0 23 16",svg:(0,i.jsx)("path",{clipRule:"evenodd",d:"m23 11.4338c0 2.5317-2.1591 4.5662-4.922 4.5662h-12.59789c-3.12888 0-5.48011-2.2739-5.48011-4.9804 0-2.2463 1.28998-4.10591 3.3576-4.43732.04574-2.57768 2.49761-4.2992 4.74821-3.63637 1.09785-1.61104 2.86359-2.94591 5.34289-2.94591 3.7418 0 6.6786 2.96433 6.6603 7.0702 1.784.75489 2.891 2.43038 2.891 4.3636zm-17.51989 3.084h12.59789c1.9487 0 3.449-1.3717 3.449-3.084 0-1.66625-1.0704-2.89065-2.7354-3.25889-.1098-.02761-.1556-.09206-.1464-.21173.0366-.43269.064-.92981.0366-1.35328-.1555-2.73418-2.2323-5.12774-5.2331-5.12774-2.3695 0-3.73271 1.30725-4.62014 2.89989-.05489.10126-.11893.12888-.22872.09206-1.8755-.6168-3.90652.22094-3.90652 3.05638 0 .11968-.04575.18412-.17383.18412-1.93954 0-3.04654 1.46376-3.04654 3.30499 0 1.878 1.70167 3.4982 4.00716 3.4982zm7.19089-9.49502c0-.39047-.3145-.70701-.7026-.70701-.388 0-.7026.31654-.7026.70701v4.89196l-1.61105-1.62112c-.27439-.27611-.71927-.27611-.99366 0-.2744.27611-.2744.72377 0 .99987l2.81051 2.82811c.2744.2761.7193.2761.9936 0l2.8106-2.82811c.2743-.2761.2743-.72376 0-.99987-.2744-.27611-.7193-.27611-.9937 0l-1.6111 1.62112z",fillRule:"evenodd"})})},552867:(e,t,n)=>{n.d(t,{H:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("archive",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M6.247 16.456c-.706 0-1.246-.182-1.62-.547-.37-.364-.554-.9-.554-1.606V7.07h1.34v7.212c0 .287.075.508.226.663.155.15.376.226.663.226h7.39c.282 0 .498-.075.649-.226.155-.155.232-.376.232-.663V7.07h1.347v7.233c0 .702-.187 1.235-.56 1.6-.374.368-.912.553-1.614.553H6.247Zm1.545-5.94a.538.538 0 0 1-.554-.568V9.73c0-.168.05-.303.15-.403a.56.56 0 0 1 .404-.15h4.416c.164 0 .296.05.396.15.105.1.158.235.158.403v.22a.538.538 0 0 1-.554.567H7.792Zm-3.26-2.79c-.466 0-.828-.136-1.088-.41-.255-.278-.382-.647-.382-1.107v-.998c0-.465.132-.834.396-1.107.264-.274.622-.41 1.073-.41H15.47c.46 0 .818.136 1.073.41.26.273.39.642.39 1.107v.998c0 .46-.13.83-.39 1.107-.255.274-.613.41-1.073.41H4.53ZM4.79 6.49h10.418c.16 0 .273-.036.342-.11.068-.077.102-.193.102-.348V5.39c0-.16-.034-.276-.102-.349-.069-.073-.183-.11-.342-.11H4.791c-.16 0-.276.037-.349.11-.068.073-.102.19-.102.349v.642c0 .155.034.271.102.349.073.073.19.11.349.11Z"})})},192165:(e,t,n)=>{n.d(t,{Z:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("arrowsDiverging",{viewBox:"0 0 12 12",svg:(0,i.jsx)("path",{d:"M6 11.2891C6.42188 11.2891 6.63281 11.0469 6.63281 10.5625V7.3457C6.63281 7.00586 6.71875 6.64062 6.89062 6.25C7.06641 5.85938 7.29492 5.47266 7.57617 5.08984C7.86133 4.70703 8.16992 4.35547 8.50195 4.03516C8.83789 3.71484 9.16406 3.45312 9.48047 3.25L9.95508 2.94531C10.1621 2.81641 10.2656 2.63281 10.2656 2.39453C10.2656 2.21875 10.2109 2.07227 10.1016 1.95508C9.99219 1.83789 9.8418 1.7793 9.65039 1.7793C9.4668 1.7793 9.29102 1.83398 9.12305 1.94336L8.81836 2.14844C8.51367 2.34766 8.20898 2.58984 7.9043 2.875C7.59961 3.15625 7.31641 3.45508 7.05469 3.77148C6.79297 4.08398 6.56836 4.39258 6.38086 4.69727C6.19727 4.99805 6.07227 5.26953 6.00586 5.51172H5.98828C5.91797 5.26953 5.79102 4.99805 5.60742 4.69727C5.42383 4.39258 5.19922 4.08398 4.93359 3.77148C4.67188 3.45508 4.38867 3.15625 4.08398 2.875C3.7832 2.58984 3.48047 2.34766 3.17578 2.14844L2.87109 1.94336C2.69922 1.83398 2.52344 1.7793 2.34375 1.7793C2.14844 1.7793 1.99609 1.83984 1.88672 1.96094C1.78125 2.08203 1.72852 2.22461 1.72852 2.38867C1.72852 2.62695 1.83203 2.8125 2.03906 2.94531L2.51367 3.25C2.83008 3.45312 3.1543 3.71484 3.48633 4.03516C3.81836 4.35547 4.12695 4.70703 4.41211 5.08984C4.69727 5.47266 4.92773 5.85938 5.10352 6.25C5.2793 6.64062 5.36719 7.00586 5.36719 7.3457V10.5625C5.36719 11.0469 5.57812 11.2891 6 11.2891ZM1.81641 3.9707L3.71484 1.52734C3.85547 1.33984 3.88281 1.17578 3.79688 1.03516C3.71484 0.890625 3.55469 0.814453 3.31641 0.806641L0.808594 0.712891C0.613281 0.705078 0.466797 0.763672 0.369141 0.888672C0.271484 1.00977 0.251953 1.16406 0.310547 1.35156L1.02539 3.75391C1.0918 3.98438 1.20312 4.125 1.35938 4.17578C1.51953 4.22656 1.67188 4.1582 1.81641 3.9707ZM10.0898 3.95898C10.2266 4.1543 10.375 4.23047 10.5352 4.1875C10.6992 4.14062 10.8164 4.00391 10.8867 3.77734L11.6777 1.39258C11.7402 1.20508 11.7246 1.04883 11.6309 0.923828C11.541 0.798828 11.3984 0.736328 11.2031 0.736328L8.68945 0.753906C8.45117 0.753906 8.28711 0.824219 8.19727 0.964844C8.10742 1.10156 8.13086 1.26562 8.26758 1.45703L10.0898 3.95898Z"})})},516880:(e,t,n)=>{n.d(t,{R:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("chevronUpRounded",{viewBox:"0 0 15 9",svg:(0,i.jsx)("path",{d:"M1.258 6.5L7.203.422a.946.946 0 01.719-.32.99.99 0 01.726.32L14.586 6.5a.89.89 0 01.266.648c0 .524-.407.93-.922.93a.921.921 0 01-.672-.281L7.93 2.32 2.586 7.797a.926.926 0 01-.672.281.915.915 0 01-.922-.93c0-.25.094-.476.266-.648z"})})},677366:(e,t,n)=>{n.d(t,{F:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("customizePage",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M10.5361 5.54883C11.2744 5.54883 11.9033 5.09082 12.1631 4.44141H14.4258C14.7607 4.44141 15.0479 4.14746 15.0479 3.79199C15.0479 3.43652 14.7676 3.14258 14.4258 3.14258H12.1699C11.9102 2.49316 11.2744 2.03516 10.5361 2.03516C9.79785 2.03516 9.16211 2.49316 8.90234 3.14258H1.59473C1.23242 3.14258 0.952148 3.43652 0.952148 3.79199C0.952148 4.14746 1.23926 4.44141 1.59473 4.44141H8.90234C9.16211 5.09082 9.79785 5.54883 10.5361 5.54883ZM10.5361 4.62598C10.0713 4.62598 9.69531 4.25684 9.69531 3.79199C9.69531 3.31348 10.0713 2.95117 10.5361 2.95117C11.0078 2.95117 11.3701 3.31348 11.3701 3.79199C11.3701 4.25684 11.0078 4.62598 10.5361 4.62598ZM1.56738 7.40137C1.23242 7.40137 0.952148 7.68848 0.952148 8.05078C0.952148 8.39941 1.23926 8.69336 1.56738 8.69336H3.91211C4.16504 9.34277 4.80078 9.80762 5.5459 9.80762C6.27734 9.80762 6.91309 9.34277 7.17285 8.69336H14.4053C14.7607 8.69336 15.0479 8.40625 15.0479 8.05078C15.0479 7.68848 14.7676 7.40137 14.4053 7.40137H7.17285C6.91309 6.75195 6.27734 6.29395 5.5459 6.29395C4.80762 6.29395 4.17188 6.75195 3.91211 7.40137H1.56738ZM5.5459 8.88477C5.07422 8.88477 4.70508 8.51562 4.70508 8.05078C4.70508 7.57227 5.07422 7.20996 5.5459 7.20996C6.01758 7.20996 6.37988 7.57227 6.37988 8.05078C6.37988 8.51562 6.01758 8.88477 5.5459 8.88477ZM10.5361 14.0596C11.2744 14.0596 11.9102 13.6016 12.1699 12.9521H14.4258C14.7607 12.9521 15.0479 12.6582 15.0479 12.3027C15.0479 11.9404 14.7676 11.6533 14.4258 11.6533H12.1631C11.9102 11.0039 11.2744 10.5459 10.5361 10.5459C9.79785 10.5459 9.16211 11.0039 8.90234 11.6533H1.59473C1.23242 11.6533 0.952148 11.9473 0.952148 12.3027C0.952148 12.6582 1.23926 12.9521 1.59473 12.9521H8.90234C9.16211 13.6016 9.79785 14.0596 10.5361 14.0596ZM10.5361 13.1436C10.0713 13.1436 9.69531 12.7676 9.69531 12.3027C9.69531 11.8311 10.0713 11.4619 10.5361 11.4619C11.0078 11.4619 11.3701 11.8311 11.3701 12.3027C11.3701 12.7676 11.0078 13.1436 10.5361 13.1436Z"})})},963222:(e,t,n)=>{n.d(t,{a:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("docMagnifyingGlass",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.87695 14.1426C4.25195 14.1426 3.77734 13.9805 3.45312 13.6562C3.13281 13.332 2.97266 12.8535 2.97266 12.2207V3.38477C2.97266 2.75586 3.13281 2.2793 3.45312 1.95508C3.77734 1.62695 4.25195 1.46289 4.87695 1.46289H11.123C11.748 1.46289 12.2207 1.625 12.541 1.94922C12.8613 2.27344 13.0215 2.75195 13.0215 3.38477V9.30273C12.8652 9.13086 12.6895 8.97656 12.4941 8.83984C12.2988 8.70312 12.0918 8.59375 11.873 8.51172V3.45508C11.873 3.18555 11.7988 2.97852 11.6504 2.83398C11.5059 2.68555 11.2969 2.61133 11.0234 2.61133H4.97656C4.69531 2.61133 4.48242 2.68555 4.33789 2.83398C4.19727 2.97852 4.12695 3.18555 4.12695 3.45508V12.1621C4.12695 12.4355 4.19727 12.6426 4.33789 12.7832C4.48242 12.9238 4.69531 12.9941 4.97656 12.9941H7.40234C7.48438 13.2129 7.5918 13.4199 7.72461 13.6152C7.86133 13.8105 8.01562 13.9863 8.1875 14.1426H4.87695ZM5.86133 4.99609C5.74805 4.99609 5.65625 4.95898 5.58594 4.88477C5.51562 4.81055 5.48047 4.72266 5.48047 4.62109C5.48047 4.51953 5.51562 4.43359 5.58594 4.36328C5.65625 4.29297 5.74805 4.25781 5.86133 4.25781H10.1445C10.25 4.25781 10.3379 4.29297 10.4082 4.36328C10.4824 4.43359 10.5195 4.51953 10.5195 4.62109C10.5195 4.72266 10.4824 4.81055 10.4082 4.88477C10.3379 4.95898 10.25 4.99609 10.1445 4.99609H5.86133ZM5.86133 6.99414C5.74805 6.99414 5.65625 6.95898 5.58594 6.88867C5.51562 6.81445 5.48047 6.72461 5.48047 6.61914C5.48047 6.51758 5.51562 6.43164 5.58594 6.36133C5.65625 6.29102 5.74805 6.25586 5.86133 6.25586H10.1445C10.25 6.25586 10.3379 6.29102 10.4082 6.36133C10.4824 6.43164 10.5195 6.51758 10.5195 6.61914C10.5195 6.72461 10.4824 6.81445 10.4082 6.88867C10.3379 6.95898 10.25 6.99414 10.1445 6.99414H5.86133ZM10.4434 14.1426C9.9707 14.1426 9.53906 14.0254 9.14844 13.791C8.75781 13.5605 8.44336 13.25 8.20508 12.8594C7.9707 12.4688 7.85352 12.0371 7.85352 11.5645C7.85352 11.0879 7.9707 10.6543 8.20508 10.2637C8.44336 9.86914 8.75781 9.55664 9.14844 9.32617C9.53906 9.0918 9.9707 8.97461 10.4434 8.97461C10.9199 8.97461 11.3535 9.0918 11.7441 9.32617C12.1348 9.55664 12.4453 9.86719 12.6758 10.2578C12.9102 10.6484 13.0273 11.084 13.0273 11.5645C13.0273 12.0371 12.9102 12.4688 12.6758 12.8594C12.4453 13.25 12.1348 13.5605 11.7441 13.791C11.3535 14.0254 10.9199 14.1426 10.4434 14.1426ZM10.4434 13.252C10.752 13.252 11.0332 13.1758 11.2871 13.0234C11.5449 12.8711 11.75 12.666 11.9023 12.4082C12.0547 12.1543 12.1309 11.873 12.1309 11.5645C12.1309 11.252 12.0547 10.9688 11.9023 10.7148C11.75 10.4609 11.5449 10.2578 11.2871 10.1055C11.0332 9.94922 10.752 9.87109 10.4434 9.87109C10.1309 9.87109 9.8457 9.94922 9.58789 10.1055C9.33398 10.2578 9.12891 10.4609 8.97266 10.7148C8.82031 10.9688 8.74414 11.252 8.74414 11.5645C8.74414 11.873 8.82031 12.1543 8.97266 12.4082C9.12891 12.666 9.33398 12.8711 9.58789 13.0234C9.8457 13.1758 10.1309 13.252 10.4434 13.252ZM13.5078 15.209C13.3398 15.209 13.1895 15.1426 13.0566 15.0098L11.4629 13.416L12.2715 12.6719L13.8594 14.2598C13.9141 14.3105 13.957 14.3711 13.9883 14.4414C14.0195 14.5117 14.0352 14.582 14.0352 14.6523C14.0352 14.8125 13.9844 14.9453 13.8828 15.0508C13.7812 15.1562 13.6562 15.209 13.5078 15.209Z"})})},925942:(e,t,n)=>{n.d(t,{P:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("expandThin",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.992.61c.156 0 .3.033.43.1.13.069.27.16.422.274l5.265 4.25a.948.948 0 01.368.774 1 1 0 01-.149.547c-.099.156-.229.28-.39.375a1.013 1.013 0 01-.508.133 1.07 1.07 0 01-.399-.079 1.6 1.6 0 01-.375-.226L7.992 3.016 3.336 6.758a1.74 1.74 0 01-.383.226 1.056 1.056 0 01-.906-.055 1.145 1.145 0 01-.383-.374 1 1 0 01-.148-.547c0-.318.122-.576.367-.774L7.148.984C7.3.87 7.44.78 7.57.711a.9.9 0 01.422-.102zm0 14.85a.901.901 0 01-.422-.1 2.288 2.288 0 01-.422-.274l-5.265-4.25a.962.962 0 01-.367-.774 1.055 1.055 0 01.531-.914 1.01 1.01 0 01.906-.062c.125.052.253.128.383.226l4.656 3.743 4.664-3.742a1.6 1.6 0 01.375-.227c.13-.052.263-.078.399-.078a.97.97 0 01.508.14 1.036 1.036 0 01.539.915c0 .312-.123.57-.368.773l-5.265 4.258a2.512 2.512 0 01-.422.265.917.917 0 01-.43.102z"})})},53136:(e,t,n)=>{n.d(t,{h:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("exportArrow",{viewBox:"0 0 12 16",svg:(0,i.jsx)("g",{children:(0,i.jsx)("path",{d:"M11.291 7.613c0 .417-.3.732-.71.732a.772.772 0 01-.534-.219L8.495 6.595 6.69 4.578l.062 1.477v8.497c0 .444-.308.752-.752.752-.438 0-.745-.308-.745-.752V6.055l.055-1.47-1.805 2.01-1.552 1.531a.755.755 0 01-.526.219.708.708 0 01-.718-.732c0-.198.075-.376.232-.54l4.505-4.511a.774.774 0 01.492-.233H1.44a.717.717 0 01-.731-.738c0-.424.308-.738.731-.738h9.133c.417 0 .718.314.718.738 0 .417-.3.738-.718.738H6.068a.79.79 0 01.493.233l4.498 4.511a.758.758 0 01.232.54z"})})})},443876:(e,t,n)=>{n.d(t,{s:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("iOSShare",{viewBox:"0 0 27 27",svg:(0,i.jsx)("path",{d:"M13.4902 15.6055C13.9102 15.6055 14.2715 15.2539 14.2715 14.8438V4.81445L14.2129 3.34961L14.8672 4.04297L16.3516 5.625C16.4883 5.78125 16.6836 5.85938 16.8789 5.85938C17.2793 5.85938 17.5918 5.56641 17.5918 5.16602C17.5918 4.96094 17.5039 4.80469 17.3574 4.6582L14.0566 1.47461C13.8613 1.2793 13.6953 1.21094 13.4902 1.21094C13.2949 1.21094 13.1289 1.2793 12.9238 1.47461L9.62305 4.6582C9.47656 4.80469 9.39844 4.96094 9.39844 5.16602C9.39844 5.56641 9.69141 5.85938 10.1016 5.85938C10.2871 5.85938 10.502 5.78125 10.6387 5.625L12.1133 4.04297L12.7773 3.34961L12.7188 4.81445V14.8438C12.7188 15.2539 13.0703 15.6055 13.4902 15.6055ZM7.89453 23.252H19.0957C21.1367 23.252 22.1621 22.2363 22.1621 20.2246V10.4785C22.1621 8.4668 21.1367 7.45117 19.0957 7.45117H16.3711V9.02344H19.0664C20.0332 9.02344 20.5898 9.55078 20.5898 10.5664V20.1367C20.5898 21.1523 20.0332 21.6797 19.0664 21.6797H7.91406C6.9375 21.6797 6.40039 21.1523 6.40039 20.1367V10.5664C6.40039 9.55078 6.9375 9.02344 7.91406 9.02344H10.6191V7.45117H7.89453C5.85352 7.45117 4.82812 8.4668 4.82812 10.4785V20.2246C4.82812 22.2363 5.85352 23.252 7.89453 23.252Z"})})},582356:(e,t,n)=>{n.d(t,{l:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("import",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M13.291 14.5723C13.291 14.1484 12.9902 13.834 12.5732 13.834H8.06836C8.24609 13.8203 8.42383 13.7314 8.56055 13.5947L13.0586 9.08301C13.2158 8.91895 13.291 8.74121 13.291 8.54297C13.291 8.12598 12.9902 7.81836 12.5801 7.81836C12.3682 7.81836 12.1836 7.90039 12.0469 8.03711L10.4951 9.56836L8.69043 11.585L8.75195 10.1084V1.61133C8.75195 1.16016 8.44434 0.852539 8 0.852539C7.5625 0.852539 7.25488 1.16016 7.25488 1.61133V10.1084L7.30957 11.5781L5.50488 9.56836L3.95312 8.03711C3.82324 7.90039 3.63184 7.81836 3.42676 7.81836C3.0166 7.81836 2.70898 8.12598 2.70898 8.54297C2.70898 8.74121 2.78418 8.91895 2.94141 9.08301L7.44629 13.5947C7.58301 13.7314 7.75391 13.8203 7.93848 13.834H3.44043C3.0166 13.834 2.70898 14.1484 2.70898 14.5723C2.70898 14.9893 3.0166 15.3037 3.44043 15.3037H12.5732C12.9902 15.3037 13.291 14.9893 13.291 14.5723Z"})})},480342:(e,t,n)=>{n.d(t,{$:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("minus",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.037 8.844h9.92a.705.705 0 00.368-.103.825.825 0 00.28-.28.73.73 0 000-.773.752.752 0 00-.28-.28.705.705 0 00-.369-.102H3.037a.705.705 0 00-.369.102.824.824 0 00-.28.28.73.73 0 000 .772.914.914 0 00.28.281.705.705 0 00.37.103z"})})},368211:(e,t,n)=>{n.d(t,{D:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("notionCalendarLogo",{viewBox:"0 0 20 21",svg:(0,i.jsxs)("svg",{width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:[(0,i.jsxs)("g",{clipPath:"url(#clip0_970_53429)",children:[(0,i.jsx)("path",{d:"M2.17141 17.1924C1.81019 17.1884 1.48919 17.0958 1.23979 16.8633C1.23979 16.8633 1.23899 16.8633 1.23819 16.8617C1.20922 16.8336 1.18187 16.8046 1.15613 16.7756C0.959022 16.5504 0.852023 16.2615 0.852023 15.9494L0.849609 3.0915C0.849609 2.34732 1.47712 1.67957 2.21968 1.63371L15.0636 0.838839C15.0918 0.83723 15.1191 0.836426 15.1473 0.836426C15.4683 0.836426 15.7675 0.952277 15.996 1.16789C16.0274 1.19766 16.0572 1.22823 16.0845 1.26041C16.1585 1.34488 16.2197 1.43821 16.268 1.53877C16.2205 1.43901 16.1585 1.34569 16.0845 1.26121C16.2768 1.48487 16.3822 1.76967 16.3822 2.07861V2.40766C16.3822 2.40766 16.3902 2.67717 16.1231 2.69487L16.1247 2.69648L4.3114 3.43664C3.44494 3.49055 2.741 4.24117 2.741 5.10925C2.741 5.10925 2.73617 16.9768 2.73537 16.9961C2.72652 17.1924 2.56481 17.1924 2.43127 17.1924H2.17141Z",fill:"black"}),(0,i.jsx)("path",{d:"M19.1589 18.1882C19.1589 18.2075 19.1573 18.2269 19.1556 18.2462C19.1275 18.6589 18.7984 19.0225 18.3938 19.0973C18.3857 19.0973 18.3777 19.0998 18.3696 19.0998L4.66812 19.9292H4.62548C4.35758 19.9155 4.10979 19.8126 3.91671 19.6307C3.7003 19.4272 3.57882 19.1488 3.56997 18.8439C3.56997 18.8319 3.56836 18.8198 3.56836 18.8069V5.19278C3.56836 5.17347 3.56836 5.15497 3.56997 5.13566C3.59974 4.6988 3.96498 4.31746 4.40102 4.2724C4.41229 4.2724 4.42355 4.26919 4.43481 4.26838L17.5531 3.44616L18.1436 3.40915C18.1653 3.40754 18.187 3.40674 18.2087 3.40674C18.4557 3.40674 18.6858 3.49604 18.862 3.66097C18.9851 3.77601 19.072 3.92002 19.1186 4.08012C19.1388 4.14851 19.1508 4.22011 19.1556 4.29332V13.1785L19.1589 18.1874V18.1882Z",fill:"black"}),(0,i.jsx)("path",{d:"M20.001 4.36907C20.001 3.86302 19.8023 3.3972 19.4402 3.0577C19.0782 2.71819 18.6011 2.54763 18.0967 2.57981L17.3928 2.62245C17.2166 2.62808 17.2246 2.49212 17.2246 2.49212V2.08583C17.2246 1.49692 16.9929 0.955478 16.5722 0.560458C16.1514 0.165437 15.5955 -0.0324757 15.009 0.00372785L2.16349 0.798596C0.97121 0.872612 0.000976562 1.90482 0.000976562 3.09953L0.00339008 15.9574C0.00339008 16.5455 0.235088 17.0878 0.655844 17.4836C1.04442 17.8488 1.54724 18.0468 2.08465 18.0468C2.12889 18.0468 2.55448 18.0387 2.55448 18.0387C2.70975 18.0387 2.73549 18.1103 2.73549 18.2439V18.9012C2.73549 19.4289 2.94547 19.9157 3.32278 20.2705C3.67113 20.5979 4.12246 20.7749 4.60436 20.7749C4.62366 20.7749 4.64217 20.7733 4.66148 20.7733C4.67113 20.7733 4.67998 20.7749 4.68963 20.7749C4.73147 20.7749 4.7733 20.7733 4.81594 20.7709L18.3477 19.9519C18.4081 19.9478 18.4668 19.9406 18.5255 19.931C19.3461 19.8304 19.9994 19.1071 19.9994 18.2728L19.9978 18.2648C19.9978 18.2415 20.001 18.2181 20.001 18.1948V4.36907ZM2.17153 17.1996C1.81031 17.1956 1.48931 17.1031 1.23991 16.8705C1.23991 16.8705 1.23911 16.8705 1.23831 16.8689C1.20934 16.8408 1.18199 16.8118 1.15625 16.7829C0.959142 16.5576 0.852143 16.2688 0.852143 15.9566L0.84973 3.09873C0.84973 2.35454 1.47724 1.68679 2.2198 1.64093L15.0637 0.846063C15.0919 0.844454 15.1192 0.84365 15.1474 0.84365C15.4684 0.84365 15.7677 0.959501 15.9961 1.17511C16.0275 1.20488 16.0573 1.23545 16.0846 1.26763C16.1587 1.35211 16.2198 1.44543 16.2681 1.546C16.2206 1.44624 16.1587 1.35291 16.0846 1.26844C16.2769 1.49209 16.3823 1.7769 16.3823 2.08583V2.41488C16.3823 2.41488 16.3904 2.6844 16.1233 2.7021L16.1249 2.70371L4.31152 3.44387C3.44506 3.49777 2.74112 4.24839 2.74112 5.11647C2.74112 5.11647 2.73629 16.984 2.73549 17.0033C2.72664 17.1996 2.56493 17.1996 2.43139 17.1996H2.17153ZM19.1635 18.1948C19.1635 18.2141 19.1619 18.2334 19.1603 18.2527C19.1321 18.6654 18.8031 19.0291 18.3984 19.1039C18.3904 19.1039 18.3823 19.1063 18.3743 19.1063L4.67274 19.9358H4.6301C4.3622 19.9221 4.11441 19.8191 3.92133 19.6373C3.70492 19.4338 3.58344 19.1554 3.57459 18.8505C3.57459 18.8384 3.57298 18.8263 3.57298 18.8135V5.19934C3.57298 5.18003 3.57298 5.16152 3.57459 5.14221C3.60436 4.70536 3.9696 4.32402 4.40564 4.27896C4.41691 4.27896 4.42817 4.27574 4.43943 4.27494L17.5577 3.45272L18.1482 3.41571C18.1699 3.4141 18.1916 3.4133 18.2134 3.4133C18.4603 3.4133 18.6904 3.5026 18.8666 3.66752C18.9897 3.78257 19.0766 3.92658 19.1233 4.08668C19.1434 4.15507 19.1554 4.22667 19.1603 4.29988V13.185L19.1635 18.194V18.1948Z",fill:"white"}),(0,i.jsx)("path",{d:"M17.1877 17.7582L5.7163 18.426C5.24727 18.459 4.83215 18.2997 4.84502 17.685V8.11764C4.84502 7.7894 5.11533 7.57942 5.4138 7.56413L17.3398 6.84891C17.6375 6.83362 17.8812 7.04924 17.8812 7.34771V16.932C17.8812 17.2828 17.7935 17.7341 17.1901 17.7574H17.1885L17.1877 17.7582Z",fill:"white"}),(0,i.jsx)("path",{d:"M8.39759 10.4651C7.83685 10.4997 7.64699 10.9277 7.64779 11.5858V11.7016C7.58102 11.7177 7.5247 11.7322 7.45712 11.7362C7.05326 11.7612 6.76203 11.4329 6.76123 10.844C6.76042 9.94293 7.56654 9.09577 9.10234 9.00003C10.47 8.91475 11.3453 9.57607 11.3469 10.7426C11.3469 11.6204 10.6196 12.2439 9.90282 12.4386C11.248 12.5045 11.8095 13.2551 11.8111 14.2141C11.8127 15.8546 10.614 16.7838 8.76445 16.8988L8.71939 16.9012C7.32921 16.9881 6.35334 16.4596 6.35254 15.5472C6.35254 15.0275 6.73227 14.5882 7.30427 14.552C7.34932 14.5488 7.39357 14.5577 7.43862 14.5553C7.55206 15.4837 8.18037 15.8256 8.80789 15.787C9.41288 15.7492 9.83846 15.3413 9.83846 14.7636V14.7403C9.83766 13.8392 9.08625 13.7942 7.9535 13.7491L7.77329 12.6743C8.8272 12.4812 9.35334 12.1369 9.35254 11.5134C9.35254 10.8432 8.98166 10.4273 8.3984 10.4643H8.39759V10.4651Z",fill:"black"}),(0,i.jsx)("path",{d:"M13.4544 10.0227C12.3338 10.3469 12.0868 9.85373 12.2091 9.33803C12.8816 9.18034 14.6298 8.65579 15.2911 8.41846L15.2992 15.3374L16.5212 15.5152C16.5212 15.9657 16.2638 16.2473 15.8044 16.2762C15.4231 16.2996 14.5373 16.3317 14.1117 16.3583C13.4504 16.3993 12.2396 16.4983 12.2396 16.4983C12.2058 16.4082 12.1946 16.3165 12.1946 16.2352C12.1946 16.0156 12.2839 15.7903 12.5751 15.6913L13.4601 15.4049L13.4536 10.0227H13.4544Z",fill:"black"})]}),(0,i.jsx)("defs",{children:(0,i.jsx)("clipPath",{id:"clip0_970_53429",children:(0,i.jsx)("rect",{width:"20",height:"20.7752",fill:"white"})})})]})})},204635:(e,t,n)=>{n.d(t,{W:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("options",{viewBox:"0 0 17 15",svg:(0,i.jsx)("path",{d:"M11.2871 4.48438C12.1309 4.48438 12.8574 3.95312 13.1621 3.21875H15.7324C16.123 3.21875 16.4512 2.875 16.4512 2.46094C16.4512 2.04688 16.123 1.71094 15.7324 1.71094H13.1621C12.8652 0.96875 12.1387 0.4375 11.2871 0.4375C10.4355 0.4375 9.70898 0.96875 9.41211 1.71094H1.04492C0.630859 1.71094 0.302734 2.04688 0.302734 2.46094C0.302734 2.875 0.630859 3.21875 1.04492 3.21875H9.41211C9.7168 3.95312 10.4434 4.48438 11.2871 4.48438ZM11.2871 3.42188C10.748 3.42188 10.3262 2.99219 10.3262 2.46094C10.3262 1.91406 10.748 1.49219 11.2871 1.49219C11.834 1.49219 12.248 1.91406 12.248 2.46094C12.248 2.99219 11.834 3.42188 11.2871 3.42188ZM1.02148 6.58594C0.630859 6.58594 0.302734 6.92188 0.302734 7.33594C0.302734 7.74219 0.630859 8.08594 1.02148 8.08594H3.67773C3.98242 8.83594 4.70898 9.35938 5.56055 9.35938C6.4043 9.35938 7.13086 8.83594 7.43555 8.08594H15.709C16.123 8.08594 16.4512 7.75 16.4512 7.33594C16.4512 6.92188 16.123 6.58594 15.709 6.58594H7.43555C7.13086 5.84375 6.4043 5.32031 5.56055 5.32031C4.70898 5.32031 3.98242 5.84375 3.67773 6.58594H1.02148ZM5.56055 8.30469C5.02148 8.30469 4.5918 7.875 4.5918 7.33594C4.5918 6.78906 5.02148 6.375 5.56055 6.375C6.09961 6.375 6.52148 6.78906 6.52148 7.33594C6.52148 7.875 6.09961 8.30469 5.56055 8.30469ZM11.2871 14.2344C12.1387 14.2344 12.8652 13.7031 13.1621 12.9609H15.7324C16.123 12.9609 16.4512 12.625 16.4512 12.2109C16.4512 11.7891 16.123 11.4609 15.7324 11.4609H13.1621C12.8652 10.7188 12.1387 10.1875 11.2871 10.1875C10.4434 10.1875 9.70898 10.7188 9.41211 11.4609H1.04492C0.630859 11.4609 0.302734 11.7969 0.302734 12.2109C0.302734 12.6172 0.630859 12.9609 1.04492 12.9609H9.41211C9.70898 13.7031 10.4355 14.2344 11.2871 14.2344ZM11.2871 13.1719C10.748 13.1719 10.3262 12.7422 10.3262 12.2109C10.3262 11.6641 10.748 11.25 11.2871 11.25C11.834 11.25 12.248 11.6641 12.248 12.2109C12.248 12.7422 11.834 13.1719 11.2871 13.1719Z"})})},636329:(e,t,n)=>{n.d(t,{_:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("personBadgeExclamationMark",{viewBox:"0 0 24 22",svg:(0,i.jsx)("path",{d:"M14 20.91c1.36 0 2.64-.26 3.838-.781a10.166 10.166 0 003.183-2.158 10.198 10.198 0 002.159-3.174 9.59 9.59 0 00.78-3.848c0-1.36-.263-2.64-.79-3.838a10.165 10.165 0 00-2.158-3.183 10.165 10.165 0 00-3.184-2.158A9.52 9.52 0 0013.99.988c-1.27 0-2.47.228-3.603.684A10.24 10.24 0 007.34 3.566 10.179 10.179 0 005.152 6.39a9.75 9.75 0 00-1.045 3.466c.235-.045.508-.074.82-.087.32-.02.61-.013.87.02.137-1.01.44-1.948.908-2.813A8.088 8.088 0 018.512 4.7a8.261 8.261 0 012.5-1.504 8.095 8.095 0 012.978-.547c1.153 0 2.23.215 3.233.645a8.233 8.233 0 012.646 1.777 8.365 8.365 0 011.787 2.647 8.11 8.11 0 01.645 3.232 8.15 8.15 0 01-2.139 5.557c-.319-.378-.775-.736-1.367-1.074-.593-.345-1.296-.625-2.11-.84-.813-.215-1.712-.322-2.695-.322-.469 0-.918.029-1.347.087-.43.053-.837.124-1.221.215.117.469.176.96.176 1.475 0 .762-.134 1.488-.4 2.178a6.308 6.308 0 01-1.095 1.865c.6.26 1.228.462 1.885.605A9.426 9.426 0 0014 20.91zm-.01-8.3a3.02 3.02 0 001.69-.47 3.53 3.53 0 001.21-1.318c.3-.56.45-1.191.45-1.894 0-.658-.15-1.26-.45-1.807a3.55 3.55 0 00-1.21-1.309 3.035 3.035 0 00-1.69-.488c-.625 0-1.191.163-1.699.489a3.622 3.622 0 00-1.65 3.115c0 .696.15 1.321.449 1.875.3.553.7.993 1.201 1.318a3.194 3.194 0 001.7.488zM5.3 21.017c.67 0 1.305-.13 1.904-.391a5.082 5.082 0 001.582-1.074A5 5 0 009.87 17.97c.26-.6.39-1.237.39-1.914 0-.684-.13-1.325-.39-1.924a4.945 4.945 0 00-1.064-1.582 4.946 4.946 0 00-1.582-1.065 4.772 4.772 0 00-1.924-.39c-.677 0-1.315.13-1.914.39a4.87 4.87 0 00-1.582 1.074A5.082 5.082 0 00.73 14.142a4.707 4.707 0 00-.391 1.914c0 .683.13 1.325.39 1.924a5.07 5.07 0 001.075 1.581c.455.456.983.811 1.582 1.065.599.26 1.237.39 1.914.39zm-.01-1.797a.788.788 0 01-.576-.244.768.768 0 01-.244-.577c0-.227.081-.423.244-.585a.788.788 0 01.576-.245c.234 0 .43.085.586.254a.788.788 0 01.244.576.77.77 0 01-.244.577.8.8 0 01-.586.244zm.01-2.325a.601.601 0 01-.43-.156.613.613 0 01-.166-.41l-.078-2.793a.63.63 0 01.176-.488.673.673 0 01.498-.186.66.66 0 01.488.186.63.63 0 01.176.488l-.078 2.793a.592.592 0 01-.176.41.554.554 0 01-.41.157z"})})},750571:(e,t,n)=>{n.d(t,{S:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("personBadgeQuestionMark",{viewBox:"0 0 15 14",svg:(0,i.jsx)("path",{d:"M12.4551 5.41699C12.8037 5.41699 13.0088 5.19824 13.0088 4.93164V4.84961C13.0088 4.45996 13.2344 4.2207 13.7061 3.90625C14.3691 3.46875 14.8408 3.07227 14.8408 2.25195C14.8408 1.11719 13.8291 0.501953 12.667 0.501953C11.498 0.501953 10.7256 1.0625 10.5342 1.69141C10.5 1.80078 10.4795 1.91016 10.4795 2.02637C10.4795 2.33398 10.7188 2.49805 10.9443 2.49805C11.1836 2.49805 11.3271 2.38867 11.4502 2.22461L11.5732 2.06055C11.8125 1.66406 12.1748 1.43164 12.626 1.43164C13.248 1.43164 13.6514 1.78711 13.6514 2.30664C13.6514 2.77148 13.3643 2.99707 12.7695 3.41406C12.2773 3.75586 11.915 4.11816 11.915 4.78809V4.87695C11.915 5.23242 12.1064 5.41699 12.4551 5.41699ZM5.79004 6.99609C7.25293 6.99609 8.52441 5.68359 8.52441 3.97461C8.52441 2.28613 7.25293 1.03516 5.79004 1.03516C4.32715 1.03516 3.05566 2.31348 3.05566 3.98828C3.05566 5.68359 4.32031 6.99609 5.79004 6.99609ZM12.4414 7.4541C12.8379 7.4541 13.1797 7.13965 13.1797 6.74316C13.1797 6.34668 12.8447 6.03223 12.4414 6.03223C12.0381 6.03223 11.7031 6.35352 11.7031 6.74316C11.7031 7.13281 12.0449 7.4541 12.4414 7.4541ZM1.20312 13.3262H10.3701C11.1016 13.3262 11.5391 12.9844 11.5391 12.417C11.5391 10.6533 9.33105 8.21973 5.7832 8.21973C2.24219 8.21973 0.0341797 10.6533 0.0341797 12.417C0.0341797 12.9844 0.47168 13.3262 1.20312 13.3262Z"})})},923903:(e,t,n)=>{n.d(t,{P:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("pin",{viewBox:"0 0 13 19",svg:(0,i.jsx)("path",{d:"M1.25 12.875h4.227v3.648c0 1.196.5 2.188.695 2.188.187 0 .687-.992.687-2.188v-3.648h4.227c.703 0 1.148-.438 1.148-1.102 0-1.648-1.32-3.304-3.359-4.109L8.617 4c.992-.648 1.93-1.383 2.328-1.914.211-.266.305-.531.305-.758 0-.476-.367-.828-.914-.828H2.008c-.555 0-.914.352-.914.828 0 .227.093.492.297.758.398.531 1.343 1.266 2.328 1.914L3.46 7.664C1.42 8.47.1 10.125.1 11.774c0 .664.446 1.101 1.149 1.101zm4.922-5.719c-.5 0-.984.047-1.438.14l.235-3.874c.008-.11-.008-.149-.086-.188-1.172-.601-2.078-1.312-2.14-1.468-.063-.102 0-.164.085-.164h6.68c.086 0 .148.062.086.164-.063.156-.969.867-2.14 1.468-.071.04-.095.079-.079.188l.234 3.875a7.177 7.177 0 00-1.437-.14zm-4.61 4.54c-.18 0-.257-.102-.226-.313.172-1.406 1.969-3.086 4.836-3.086 2.86 0 4.656 1.68 4.828 3.086.031.21-.047.312-.227.312h-9.21z"})})},634040:(e,t,n)=>{n.d(t,{_:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("pinFilled",{viewBox:"0 0 13 19",svg:(0,i.jsx)("path",{d:"M.102 11.773c0 .665.445 1.102 1.148 1.102h4.227v3.648c0 1.196.5 2.188.695 2.188.187 0 .687-.992.687-2.188v-3.648h4.227c.703 0 1.148-.438 1.148-1.102 0-1.648-1.32-3.39-3.515-4.187L8.46 4c1.14-.648 2.078-1.383 2.484-1.906.203-.266.305-.531.305-.766 0-.476-.367-.828-.914-.828H2.008c-.555 0-.914.352-.914.828 0 .234.093.5.297.766.406.523 1.343 1.258 2.484 1.906l-.258 3.586C1.422 8.383.102 10.125.102 11.773z"})})},79310:(e,t,n)=>{n.d(t,{A:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("pinStrikethrough",{viewBox:"0 0 15 19",svg:(0,i.jsx)("path",{d:"M3.094 1.328c0 .227.094.492.297.758.398.531 1.343 1.266 2.328 1.914l-.055.86 1.149 1.156.156-2.594c.008-.11-.008-.149-.086-.188-1.172-.601-2.078-1.312-2.14-1.468-.063-.102.007-.164.085-.164h6.68c.086 0 .148.062.086.164-.063.156-.961.867-2.14 1.468-.071.04-.087.079-.079.188l.234 3.875a7.12 7.12 0 00-1.437-.14h-.203l1.203 1.226c2.164.219 3.758 1.984 3.758 3.234 0 .04-.008.078-.008.117l.844.97c.257-.157.468-.477.468-.93 0-1.649-1.32-3.313-3.359-4.11L10.617 4c.992-.648 1.93-1.383 2.336-1.914.203-.266.297-.531.297-.758 0-.476-.367-.828-.914-.828H4.008c-.555 0-.914.352-.914.828zM.367 2.656l14.125 14.11a.603.603 0 00.852 0 .597.597 0 000-.852L1.227 1.804a.606.606 0 00-.86 0 .618.618 0 000 .852zm1.735 9.117c0 .665.445 1.102 1.148 1.102h4.234v3.648c0 1.196.493 2.188.688 2.188.195 0 .687-.992.687-2.188V12.97h.446L8.03 11.695H3.562c-.171 0-.257-.101-.226-.312.094-.875.828-1.805 1.984-2.399l-.82-.82c-1.477.867-2.398 2.234-2.398 3.61z"})})},605108:(e,t,n)=>{n.d(t,{n:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("settingsMembers",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M13.726 9.989c1.725 0 3.123-1.585 3.123-3.536 0-1.92-1.39-3.453-3.123-3.453-1.712 0-3.124 1.556-3.124 3.468.008 1.943 1.405 3.52 3.123 3.52zm-8.264.171c1.504 0 2.716-1.392 2.716-3.111 0-1.675-1.212-3.03-2.716-3.03-1.49 0-2.724 1.378-2.717 3.037 0 1.72 1.22 3.104 2.717 3.104zm8.264-1.474c-.985 0-1.819-.967-1.819-2.225 0-1.213.827-2.159 1.819-2.159.998 0 1.818.93 1.818 2.151 0 1.25-.827 2.233-1.819 2.233zm-8.264.186c-.806 0-1.49-.803-1.49-1.816 0-.967.677-1.756 1.49-1.756.827 0 1.497.774 1.497 1.749 0 1.02-.684 1.823-1.497 1.823zM1.54 17h5.54c-.392-.238-.656-.782-.606-1.273H1.476c-.136 0-.193-.067-.193-.193 0-1.705 1.911-3.327 4.172-3.327.798 0 1.597.208 2.21.566.242-.365.542-.678.934-.946-.906-.58-2.032-.893-3.144-.893C2.438 10.934 0 13.182 0 15.653 0 16.546.513 17 1.54 17zm7.743 0h8.885C19.4 17 20 16.59 20 15.712c0-2.046-2.453-4.77-6.274-4.77-3.822 0-6.275 2.724-6.275 4.77 0 .879.599 1.288 1.832 1.288zm-.228-1.303c-.164 0-.228-.059-.228-.193 0-1.139 1.761-3.26 4.899-3.26 3.137 0 4.898 2.121 4.898 3.26 0 .134-.064.194-.235.194H9.055z"})})},64530:(e,t,n)=>{n.d(t,{y:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("settingsNotificationsAndPersonal",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M12.5361 7.54883C13.2744 7.54883 13.9033 7.09082 14.1631 6.44141H16.4258C16.7607 6.44141 17.0479 6.14746 17.0479 5.79199C17.0479 5.43652 16.7676 5.14258 16.4258 5.14258H14.1699C13.9102 4.49316 13.2744 4.03516 12.5361 4.03516C11.7979 4.03516 11.1621 4.49316 10.9023 5.14258H3.59473C3.23242 5.14258 2.95215 5.43652 2.95215 5.79199C2.95215 6.14746 3.23926 6.44141 3.59473 6.44141H10.9023C11.1621 7.09082 11.7979 7.54883 12.5361 7.54883ZM12.5361 6.62598C12.0713 6.62598 11.6953 6.25684 11.6953 5.79199C11.6953 5.31348 12.0713 4.95117 12.5361 4.95117C13.0078 4.95117 13.3701 5.31348 13.3701 5.79199C13.3701 6.25684 13.0078 6.62598 12.5361 6.62598ZM3.56738 9.40137C3.23242 9.40137 2.95215 9.68848 2.95215 10.0508C2.95215 10.3994 3.23926 10.6934 3.56738 10.6934H5.91211C6.16504 11.3428 6.80078 11.8076 7.5459 11.8076C8.27734 11.8076 8.91309 11.3428 9.17285 10.6934H16.4053C16.7607 10.6934 17.0479 10.4062 17.0479 10.0508C17.0479 9.68848 16.7676 9.40137 16.4053 9.40137H9.17285C8.91309 8.75195 8.27734 8.29395 7.5459 8.29395C6.80762 8.29395 6.17188 8.75195 5.91211 9.40137H3.56738ZM7.5459 10.8848C7.07422 10.8848 6.70508 10.5156 6.70508 10.0508C6.70508 9.57227 7.07422 9.20996 7.5459 9.20996C8.01758 9.20996 8.37988 9.57227 8.37988 10.0508C8.37988 10.5156 8.01758 10.8848 7.5459 10.8848ZM12.5361 16.0596C13.2744 16.0596 13.9102 15.6016 14.1699 14.9521H16.4258C16.7607 14.9521 17.0479 14.6582 17.0479 14.3027C17.0479 13.9404 16.7676 13.6533 16.4258 13.6533H14.1631C13.9102 13.0039 13.2744 12.5459 12.5361 12.5459C11.7979 12.5459 11.1621 13.0039 10.9023 13.6533H3.59473C3.23242 13.6533 2.95215 13.9473 2.95215 14.3027C2.95215 14.6582 3.23926 14.9521 3.59473 14.9521H10.9023C11.1621 15.6016 11.7979 16.0596 12.5361 16.0596ZM12.5361 15.1436C12.0713 15.1436 11.6953 14.7676 11.6953 14.3027C11.6953 13.8311 12.0713 13.4619 12.5361 13.4619C13.0078 13.4619 13.3701 13.8311 13.3701 14.3027C13.3701 14.7676 13.0078 15.1436 12.5361 15.1436Z"})})},953877:(e,t,n)=>{n.d(t,{u:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("sites",{viewBox:"0 0 22 17",svg:(0,i.jsx)("path",{d:"M3.305 15.164c-.844 0-1.482-.216-1.914-.648-.433-.428-.649-1.058-.649-1.891V3.117c0-.838.216-1.471.649-1.898.437-.427 1.075-.64 1.914-.64h13.382c.844 0 1.482.213 1.915.64.432.427.648 1.06.648 1.898v5.524l-1.234-1.25a.985.985 0 00-.149-.11.613.613 0 00-.148-.086v-2.57H2.28v7.867c0 .38.097.664.29.852.197.187.476.281.835.281h11.469l-.023 1.54H3.305zm.148-11.836a.68.68 0 00.508-.219.697.697 0 000-1.015.68.68 0 00-.508-.219.714.714 0 00-.523.219.71.71 0 00-.211.508c0 .192.07.362.21.507.147.146.321.22.524.22zm2.305 0c.198 0 .367-.07.508-.21a.705.705 0 000-1.024.68.68 0 00-.508-.219.714.714 0 00-.524.219.71.71 0 00-.21.508.718.718 0 00.734.726zm2.297 0c.198 0 .37-.07.515-.21a.705.705 0 000-1.024.705.705 0 00-.515-.219.705.705 0 00-.516.219.71.71 0 00-.21.508.718.718 0 00.726.726zm7.922 10.695l.078-6.156c.005-.161.073-.265.203-.312.13-.052.25-.024.36.086l4.234 4.336c.125.12.153.247.085.382-.062.13-.174.198-.335.204L19 12.608l1.344 3.11a.374.374 0 01.023.25c-.02.088-.08.153-.18.195l-.773.305a.313.313 0 01-.266-.008.41.41 0 01-.18-.195l-1.265-3.149-1.117 1.133a.372.372 0 01-.398.102c-.146-.047-.217-.157-.211-.329z"})})},743590:(e,t,n)=>{n.d(t,{I:()=>o});n(667294);var s=n(745238),i=n(785893);const o=(0,s.IU)("suggestion",{viewBox:"0 0 16 16",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{d:"M8.651 8.465l-1.397.54c-.088.035-.17.018-.244-.053-.07-.07-.086-.15-.046-.237l.567-1.378 5.945-5.939 1.127 1.12-5.952 5.947zm6.447-6.427L13.97.91l.567-.567a.702.702 0 01.474-.217.615.615 0 01.468.165l.198.184c.136.14.2.306.191.495a.718.718 0 01-.217.494l-.554.574z"}),(0,i.jsx)("path",{d:"M14.084 5.065V9.65c0 .611-.152 1.072-.455 1.384-.299.308-.76.462-1.384.462h-4.1a1.37 1.37 0 00-.488.072 1.147 1.147 0 00-.389.277l-2.09 2.07v-1.879c0-.197-.043-.336-.131-.415-.084-.083-.218-.125-.402-.125H3.74c-.62 0-1.08-.154-1.384-.462-.299-.312-.448-.773-.448-1.384V4.62c0-.606.15-1.063.448-1.37.303-.313.765-.469 1.384-.469h6.36l1.3-1.298H3.71c-.664 0-1.227.123-1.688.369-.457.246-.806.6-1.048 1.061C.73 3.37.61 3.926.61 4.581v5.115c0 .655.121 1.213.363 1.675.246.457.595.808 1.048 1.054.457.246 1.004.37 1.641.37h.356v1.621c0 .294.073.527.218.699.15.171.356.257.62.257.184 0 .358-.049.52-.145a3.65 3.65 0 00.58-.435l2.255-1.998h4.073c.66 0 1.22-.123 1.681-.369a2.492 2.492 0 001.055-1.054c.242-.462.363-1.02.363-1.675V4.581c0-.267-.02-.518-.06-.752l-.208.215-1.031 1.021z"})]})})},334390:(e,t,n)=>{n.d(t,{UP:()=>a,by:()=>o});const s=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"],i=["text/plain",".md",".mdown",".markdown",".mkdn",".mkd",".Rmd",".md.txt"],o={markdown:i,csv:["text/plain",".csv"],html:["text/html"],docx:s,gdocs:s,dropbox:s,quip:["text/html",i],workflowy:["text/plain"],confluence:["application/zip"],genericImporter:["application/zip"],pdf:["application/pdf"]},a=Object.keys(o)},957222:(e,t,n)=>{function s(e){return{"en-US":{label:"English",caption:e.formatMessage({defaultMessage:"English (US)",id:"languagePicker.captions.englishUS"})},"de-DE":{label:"Deutsch",caption:e.formatMessage({defaultMessage:"German",id:"languagePicker.captions.germanDE"})},"ko-KR":{label:"한국어",caption:e.formatMessage({defaultMessage:"Korean",id:"languagePicker.captions.koreanKo"})},"zh-CN":{label:"简体中文",caption:e.formatMessage({defaultMessage:"Simplified Chinese",id:"languagePicker.captions.chineseS"})},"zh-TW":{label:"繁體中文",caption:e.formatMessage({defaultMessage:"Traditional Chinese",id:"languagePicker.captions.chineseT"})},"ja-JP":{label:"日本語",caption:e.formatMessage({defaultMessage:"Japanese",id:"languagePicker.captions.japaneseJa"})},"es-ES":{label:"Español (España)",caption:e.formatMessage({defaultMessage:"Spanish (Spain)",id:"languagePicker.captions.spanishEs"})},"es-LA":{label:"Español (Latinoamérica)",caption:e.formatMessage({defaultMessage:"Spanish (Latin America)",id:"languagePicker.captions.spanishLatam"})},"pt-BR":{label:"Português (Brasil)",caption:e.formatMessage({defaultMessage:"Portuguese (Brazil)",id:"languagePicker.captions.portugueseBr"})},"fr-FR":{label:"Français (France)",caption:e.formatMessage({defaultMessage:"French",id:"languagePicker.captions.frenchFr"})},"da-DK":{label:"Dansk",caption:e.formatMessage({defaultMessage:"Danish",id:"languagePicker.captions.danishDk"})},"fi-FI":{label:"Suomi",caption:e.formatMessage({defaultMessage:"Finnish",id:"languagePicker.captions.finnishFi"})},"nb-NO":{label:"Norsk",caption:e.formatMessage({defaultMessage:"Norwegian",id:"languagePicker.captions.norwegianNo"})},"nl-NL":{label:"Nederlands",caption:e.formatMessage({defaultMessage:"Dutch",id:"languagePicker.captions.dutchNl"})},"sv-SE":{label:"Svenska",caption:e.formatMessage({defaultMessage:"Swedish",id:"languagePicker.captions.swedishSe"})},pseudo:{label:"🤡Pseudolocale🤡",caption:e.formatMessage({defaultMessage:"Pseudolocale",id:"languagePicker.captions.pseudolocale"})}}}n.d(t,{t:()=>s})},24433:(e,t,n)=>{n.d(t,{CR:()=>r,I2:()=>p,Lw:()=>l,tV:()=>m,tX:()=>u});var s=n(653965),i=n(401898),o=n(133728),a=n(125829);function r(e){let{space:t,domains:n,team:o,spaceUser:a,invitees:r,internalGuestFeatureAvailability:d,guestFeatureAvailability:u}=e;const m=l({domains:n,internalGuestFeatureAvailability:d,guestFeatureAvailability:u,invitees:r,space:t,spaceUser:a,team:o}),p=c({domains:n,internalGuestFeatureAvailability:d,guestFeatureAvailability:u,invitees:r,space:t,spaceUser:a,team:o}),f=r.some((e=>{const t=p[e.email],n=m[e.email];return"can_autojoin"!==t.type&&g(n)}));return(0,s.Pe)(r.map((e=>{const{email:t,currentRole:n}=e,s=p[t].type,o=m[t].type;return"member"===n?[t,{type:"member_page_add"}]:"guest"===n&&"can_add"===o?[t,{type:"guest_page_add"}]:"can_autojoin"===s?[t,{type:"member",reason:"autojoin_domain"}]:"cannot_add"===(a=m[t]).type&&"over_general_guest_limit"===a.reason?[t,{type:"none",reason:"must_upgrade"}]:"can_add"===s&&f?[t,{type:"member",reason:"over_internal_guest_limit"}]:"can_add"===o?[t,{type:"guest"}]:"can_request"===o?[t,{type:"guest_request"}]:"can_add"===s?[t,{type:"member",reason:"guests_disabled"}]:"can_request"===s?[t,{type:"member_request"}]:"cannot_add"===o||"cannot_add"===s?[t,{type:"none",reason:"other"}]:(0,i.t1)(s)&&(0,i.t1)(o);var a})))}function l(e){let{space:t,domains:n,team:i,internalGuestFeatureAvailability:o,guestFeatureAvailability:r,optimism:l="pessimistic",spaceUser:c,invitees:m}=e;const g=u({space:t,team:i,spaceUser:c}),f=d(l,r,p(m)),h=function(e,t){return e.filter((e=>(0,a.is)(e.email,t)&&!e.currentRole)).length}(m,n),y=d(l,o,h);return(0,s.Pe)(m.map((e=>{const t=(0,a.is)(e.email,n),s=void 0!==e.currentRole;let i;return i=s||f?!t||s||y?"cannot_add"===g.type?{type:"cannot_add",reason:"disabled_by_admins"}:g:{type:"cannot_add",reason:"over_internal_guest_limit"}:{type:"cannot_add",reason:"over_general_guest_limit"},[e.email,i]})))}function d(e,t,n){const s=t.limit,i="unlimited"===s.total?"unlimited":s.total-s.current;return"optimistic"===e?"unlimited"===i||i>=1:"unlimited"===i||i>=n}function c(e){let{space:t,team:n,domains:a,spaceUser:r,invitees:d,internalGuestFeatureAvailability:c,guestFeatureAvailability:u}=e;const p=m({space:t,domains:a,spaceUser:r}),f=l({space:t,domains:a,internalGuestFeatureAvailability:c,guestFeatureAvailability:u,team:n,spaceUser:r,invitees:d}),h=!r.isMember();return(0,s.Pe)(d.map((e=>{const t=(0,o.Gd)(e.email);if(!t)return[e.email,{type:"cannot_add",reason:"invalid_email"}];const n=g(f[e.email]),s=p.autojoinDomains;let a;return s.includes(t)?a={type:"can_autojoin"}:"can_add"===p.type?a={type:"can_add"}:"can_request"===p.type||n&&!h?a={type:"can_request"}:s.length>0?a={type:"cannot_add",reason:"not_authorized_domain"}:"cannot_add"===p.type?a={type:"cannot_add",reason:"disabled_by_admins"}:(0,i.t1)(p),[e.email,a]})))}function u(e){let{space:t,team:n,spaceUser:s}=e;const i=s.isWorkspaceOwner(),o=function(e){let t,n,{space:s,team:i}=e;t=i&&i.getDisableGuests()?"cannot_add":i&&!i.getDisableGuests()?"can_add":void 0;const o=s.disable_guests,a=s.getSettings().enable_guest_invite_requests;n=a?"can_request":o?"cannot_add":"can_add";return"can_request"===n?{type:"can_request"}:void 0!==t?{type:t}:{type:n}}({space:t,team:n});return i&&"can_request"===o.type?{type:"can_add"}:o}function m(e){let{space:t,domains:n,spaceUser:s}=e;const i=!s.isMember(),o=function(e){let{space:t,domains:n}=e;const s=n.filter((e=>e.isAutojoinable)).map((e=>e.url));return t.getSettings().disable_membership_requests?{type:"cannot_add",autojoinDomains:s}:{type:"can_request",autojoinDomains:s}}({space:t,domains:n});return i?{type:"cannot_add",autojoinDomains:[]}:s.isWorkspaceOwner()?{...o,type:"can_add"}:o}function p(e){return e.filter((e=>!e.currentRole)).length}function g(e){return"cannot_add"===e.type&&"over_internal_guest_limit"===e.reason}},125829:(e,t,n)=>{n.d(t,{TC:()=>a,dr:()=>i,is:()=>o});var s=n(133728);function i(e,t){return!!e&&o(e.getEmail(),t)}function o(e,t){return void 0!==a(e,t)}function a(e,t){if(!e)return;const n=(0,s.Gd)(e);return t.find((e=>e.url===n))}}}]);