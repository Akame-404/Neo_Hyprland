"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[24199],{667436:(e,t,n)=>{n.d(t,{X:()=>c,s:()=>u});n(667294);var s=n(886628),i=n(709291),a=n(828451),o=n(288492),r=n(80444),l=n(521273),d=n(785893);function c(e){let{origin:t}=e;const n=(0,s.VK)((()=>"enhanced_beta"===l.Z.getMode()),[]);return(0,s.VK)((()=>{var e;const t=null===(e=r.default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettings();if(!t)return!1;const n=t.qna_sessions_initialized;return!!n&&0!==n}),[])?(0,d.jsx)(a.g,{shouldShow:n,calloutId:"ai_enhanced_qna_notification_tooltip",children:(0,d.jsx)(o.r,{origin:t,placementToOrigin:"top",style:{minWidth:280,marginBottom:10},tutorialId:"enhanced-qna-onboarding",tutorialStepId:"find-in-tooltip",pointerLength:30,header:(0,d.jsx)(i.FormattedMessage,{id:"EnhancedQnaOnboardingTooltip.FindIn.header",defaultMessage:"New! Target your search with Notion AI"}),content:(0,d.jsx)(i.FormattedMessage,{id:"EnhancedQnaOnboardingTooltip.FindIn.content",defaultMessage:"Choose where Notion AI finds answers: teamspaces, databases or pages"})})}):null}function u(e){let{origin:t}=e;return(0,d.jsx)(o.r,{origin:t,placementToOrigin:"top",style:{minWidth:280,marginBottom:10},tutorialId:"enhanced-qna-onboarding",tutorialStepId:"mention-tooltip",pointerLength:30,pointerPosition:"75%",header:(0,d.jsx)(i.FormattedMessage,{id:"EnhancedQnaOnboardingTooltip.Mention.header",defaultMessage:"Enhance context with @mentions"}),content:(0,d.jsx)(i.FormattedMessage,{id:"EnhancedQnaOnboardingTooltip.Mention.content",defaultMessage:"Mention people, dates, and pages in chat so Notion AI has the relevant context"})})}},83982:(e,t,n)=>{n.d(t,{f6:()=>y,xx:()=>f});n(252262),n(324506),n(757658),n(21703);var s=n(471924),i=n(959753),a=n(940470),o=n(831658),r=n(80444),l=n(798180),d=n(316772),c=n(319385),u=n(199672),p=n(252193),g=n(828344),m=n(365147),h=n(237074);async function f(e){const{environment:t,keepVisualSteps:n,assistantSurface:o}=e,c=e.sessionId??l.default.getActiveSessionId(),g=c?l.default.getSessionContext(c):void 0;if(!g)return{error:"No active session available to reset."};const f=g.evaluator,y=f.getTranscript(),x=(0,u.Pn)({currentSteps:y,stepType:"human"});if(a.x.isFail(x))return{error:x.error};g.hasPendingOperations()&&await(0,h.rejectEdits)({environment:t,inferenceId:s.Il(),sessionContext:g});const v=x.value.previousStep,S=x.value.newSteps,b=r.default.state.currentSpaceStore,C=(0,u.VB)({step:v,evaluatorState:f.state,getRecordModel:(null==b?void 0:b.getRecordModel)??i.om.constant(void 0)}),{sessionId:j}=await(0,p.resetAndInitializeAssistantSession)({environment:t,...g.sessionMetadata,makeActiveSession:!1}),k=l.default.getSessionContextOrThrow(j);if(!n){const e=g.clientSteps,t=e.at(e.length-1),n="assistantScopeChange"===(null==t?void 0:t.type)?t:void 0,s=(0,u.Pn)({currentSteps:e,stepType:"human"});if(a.x.isSuccess(s)){const e=s.value.newSteps;n&&e.push(n),k.setClientStepsAndClearPreviewingStep(e)}}k.assistantConfigurationStore.setSearchScope(g.assistantConfigurationState.searchScope);if(k.evaluator.setTranscript(S),o.isWriter){const e=d.default.state;"assistantCompletionPopup"===e.type&&d.default.setState({...e,sessionId:k.sessionId})}else l.default.update((e=>({...e,activeAiSessionId:k.sessionId}))),(0,m.GD)({environment:t,sessionId:k.sessionId}),(0,m.If)({environment:t,sessionId:g.sessionId});return{value:{textValue:C,sessionId:k.sessionId}}}async function y(e){var t;const{environment:n,sessionId:i,assistantSurfaceType:a}=e,d=l.default.getSessionContextOrThrow(i),u=r.default.state.currentSpaceStore,{assistantConfigurationStore:m}=d;if(!u)throw new Error("No space store.");d.clearPreviewingStep(),m.setState({...m.state,retrying:!0});const h=s.Il(),f=Date.now();c.default.logEvent("qna_inference_start"),g.trackInferenceStart({environment:n,configurationState:m.state,inferenceId:h,isRetry:!0,source:void 0,mentionsUsed:void 0,skillType:void 0,from:a}),await(0,p.sampleNextAssistantStepsAsHumanSubmission)({environment:n,inferenceId:h,sessionId:i}),(0,p.trackInferenceEndFromState)({environment:n,assistantSessionContext:d,inferenceId:h,timeTook:Date.now()-f,parentStore:u,transcript:d.evaluator.getTranscript()});const y=null===(t=r.default.state.currentSpaceStore)||void 0===t?void 0:t.id;y&&o.completionActions.updateAiEligibility(n,y)}},148604:(e,t,n)=>{n.r(t),n.d(t,{exitTutorial:()=>M,incrementTutorialStepOnCompletionOfCurrentStep:()=>k,setTutorialStep:()=>j,startTutorial:()=>I});n(252262),n(324506);var s=n(126263),i=n(541432),a=n(292595),o=n(702607),r=n(29299),l=n(89101),d=n(815047),c=n(401898),u=n(594419),p=n(709953),g=n(608055),m=n(210228),h=n(237181),f=n(548779),y=n(206258),x=n(435367),v=n(759162),S=n(995853),b=n(828344),C=n(484681);async function j(e){const{stepIndex:t,groupIndex:n}=e;if(!(0,c.$K)(t)||!(0,c.$K)(n))return S.l.setState({isActive:!1}),void(0,C.setPrimeTextInput)("");const s=S.l.state;if(!s.isActive)return;const i=s.steps.at(t),a=null==i?void 0:i.steps.at(n);if((0,c.$K)(a)){if("assistantPlaintextChat"===a.type)return(0,C.setPrimeTextInput)(""),S.l.setState({...s,showThinking:!0}),await new Promise((e=>setTimeout(e,1500))),void(S.l.state.isActive&&S.l.state.showThinking&&S.l.setState({...s,stepIndex:t,groupIndex:n,showThinking:!1}));"userTurn"===a.type&&(0,C.setPrimeTextInput)(a.message),S.l.setState({...s,stepIndex:t,groupIndex:n,showThinking:!1})}}async function k(e){const t=()=>{var e;const t=S.l.state;if(t.isActive&&(0,c.$K)(t.groupIndex))return null===(e=t.steps.at(t.stepIndex))||void 0===e?void 0:e.steps.at(t.groupIndex)};await w(e);let n=t();for(;n&&!n.shouldPauseAndWaitForEvent;)await w(e),n=t()}async function w(e){var t;const n=S.l.state;if(!n.isActive)return;const s=n.stepIndex,i=n.groupIndex,a=null===(t=n.steps.at(s))||void 0===t?void 0:t.steps.length;if(!a)return;let o=s,r=i;i===a-1?(o=s+1,r=0):r++,e.skipAnalytics||b.trackAssistantTutorialStepChange(e.environment,{current_step_index:o-1,next_step_index:o,current_group_index:i,next_group_index:r}),await j({stepIndex:o,groupIndex:r})}function I(e){if(S.l.state.isActive)return;const{personaOverride:t,intl:n,environment:a}=e,l=t??function(){const e=(0,f.kO)().intent;switch(e){case"personal":case"team":case"school":case void 0:return"personal";default:return(0,c.P)(e),"personal"}}(),{steps:g,pagesToCreate:h}=(0,x.m)({persona:l,intl:n,environment:a}),C=v.Hd[l],j=v.tX[l](n),k=new s.Z({name:"assistantTutorialActions.tutorialScriptCache",isTemporaryData:!0});a.defaultRecordCache.inMemoryRecordCache.addCacheOverride(k);const w=m.createAndCommit({userAction:"assistantTutorialActions.startTutorial",environment:a,canUndo:!1,perform:e=>{for(const t of h){const n=p.j4({environment:a,type:i.Ti.page,id:t.id,properties:{title:t.title},format:{page_icon:t.icon},inMemoryRecordCache:k,transaction:e,useCrdt:!1});m.applyOperation({store:n,operation:(0,r.v2)({pointer:n.pointer,parent_table:d.bx,parent_id:n.getSpaceId(),alive:!0}),transaction:e})}return function(e){const{environment:t,temporaryCache:n,pageSpec:s,transaction:a,intl:l}=e,c=!1,g=p.j4({environment:t,type:i.Ti.page,properties:{title:o.b.text(l.formatMessage(s.title)).build()},format:{page_icon:s.emoji},inMemoryRecordCache:n,transaction:a,useCrdt:c});m.applyOperation({store:g,operation:(0,r.v2)({pointer:g.pointer,parent_table:d.bx,parent_id:g.getSpaceId(),alive:!0}),transaction:a});for(const{type:i,title:r}of s.content){const e=r?o.b.text(l.formatMessage(r)).build():void 0,s=p.j4({environment:t,type:i,properties:{title:e},inMemoryRecordCache:n,transaction:a,useCrdt:c});u.BE({parentStore:g.getContentStore(),insertStore:y.G.createChildStore(g.getContentStore(),s.pointer),afterStore:void 0,transaction:a})}return g}({environment:a,temporaryCache:k,pageSpec:C,transaction:e,intl:n})}}),I=w.performResult;I&&S.l.setState({showThinking:!1,isActive:!0,stepIndex:0,groupIndex:0,persona:l,steps:g,peekPageStore:I,editsXmlString:j,editsAreCommitted:!1}),e.skipAnalytics||b.trackAssistantTutorialStarted(e.environment,{from:e.fromForAnalytics,persona:l})}function M(e){const{environment:t}=e;S.l.setState({isActive:!1}),h.Q({environment:t}),g.c4({environment:t,url:l._j.chat})}(0,a.exposeDebugValue)("setAssistantTutorialStep",j),(0,a.exposeDebugValue)("incrementAssistantTutorialStep",(()=>w({skipAnalytics:!0}))),(0,a.exposeDebugValue)("repeatAssistantTutorial",((e,t)=>I({skipAnalytics:!0,intl:e,environment:t})))},605319:(e,t,n)=>{n.d(t,{T:()=>s});const s=new(n(933147).Z)},724199:(e,t,n)=>{n.r(t),n.d(t,{AssistantFullPageChat:()=>st,AssistantMenuPopup:()=>lt,AssistantOriginElement:()=>ze,AssistantRegistryStore:()=>Z,AssistantScopedSearchMenuPopup:()=>It.Z,MobileAssistantPendingOperationsCollapsedElement:()=>wt,ModalOverlayCollectionListView:()=>Ct,ReportBadQnAForm:()=>zt,SearchAssistantPane:()=>dt.u,assistantActions:()=>i,assistantAnalyticsActions:()=>o,assistantEditActions:()=>a,assistantMenuActions:()=>r,assistantMenuStore:()=>P.d,assistantOriginElementStore:()=>B.N,assistantSkillActions:()=>s,assistantSurfaceValidators:()=>A,assistantTutorialActions:()=>l,clientSkillHelpers:()=>T,executeAssistantSkillAction:()=>V.vi,getCurrentQnaReminderUserSettings:()=>Me.Tw,handleSubmitNewQuestion:()=>_.AF,modalOverlayCollectionListViewStore:()=>F.j});var s={};n.r(s),n.d(s,{activateSkill:()=>w,createCustomSkill:()=>C,createSkill:()=>k,deleteSkill:()=>M,fetchSkillsInSpace:()=>b,updateSkillSettings:()=>I});var i=n(252193),a=n(237074),o=n(828344),r=n(484681),l=n(148604),d=(n(21703),n(417586)),c=n(471924),u=n(91644),p=n(815047),g=n(519889),m=n(454642),h=n(709953),f=n(80444),y=n(749085),x=n(292595);class v extends y.default{getInitialState(){return{serverSkillIds:new Set,locallyCreatedSkillIds:new Set}}getSkillIds(){return Array.from(new Set([...this.state.serverSkillIds,...this.state.locallyCreatedSkillIds]))}addLocallyCreatedSkillId(e){this.state.locallyCreatedSkillIds.add(e),this.emit()}}const S=new v;async function b(e){const{environment:t,spaceId:n}=e,s=await m.getSkillsInSpace(t,{spaceId:n});if("success"!==s.type)throw new Error("Failed to fetch skills in space.");const{skillIds:i}=s.data;S.setState({...S.state,serverSkillIds:new Set(i)})}function C(e){const{environment:t,transaction:n}=e,s=t.currentUser.id,{currentSpaceStore:i,mainEditorCurrentBlockStore:a}=f.default.state;if(!s)throw new Error("No current user.");if(!i)throw new Error("No current space.");if(!a)throw new Error("No current block.");const o={id:i.id,table:p.bx,spaceId:i.id};return k({environment:t,transaction:n,skillValue:{type:"custom",parent_id:o.id,parent_table:o.table,space_id:o.spaceId,alive:!0}})}function j(e){const{environment:t}=e,n=t.currentUser.id,s=Date.now();if(!n)throw new Error("No current user.");return{created_time:s,created_by_id:n,created_by_table:g.KJ,last_edited_time:s,last_edited_by_id:n,last_edited_by_table:g.KJ}}function k(e){const{environment:t,skillValue:n,transaction:s}=e,{inMemoryRecordCache:i}=t.defaultRecordCache,a=h.ae({environment:t,table:u.AT,value:{...n,...j({environment:t})},inMemoryRecordCache:i,transaction:s});return S.addLocallyCreatedSkillId(a.id),a}async function w(e){const{environment:t,clientSkillWithParameterValues:n,onRequiresInput:s}=e,a=(0,d.Fq)(n.clientSkill.skillType);(0,r.navigateToView)({view:"chat"});const{sessionId:o}=await(0,i.resetAndInitializeAssistantSession)({environment:t,clientSkillWithParameterValues:n});a.requiresInput?null==s||s():(0,i.sampleNextAssistantStepsAsHumanSubmission)({environment:t,inferenceId:c.Il(),sessionId:o})}function I(e){const{store:t,update:n,transaction:s}=e;h.sW({store:t.getSettingsStore(),data:n,transaction:s})}function M(e){const{store:t,transaction:n}=e;h.sW({store:t,data:{alive:!1},transaction:n})}(0,x.exposeDebugValue)("AssistantSkillsStore",S);var T=n(144500),A=n(183583),P=n(728495),B=n(148168),_=n(365147),F=n(266402),Z=n(798180),V=n(646564),R=n(921974),L=n(733993),E=n(667294),K=n(800480),O=n(886628),D=n(724405),W=n(841892),H=n(605257),N=n(11751),z=n(709291),U=n(401898),G=n(619584),q=n(244458),$=n(453365),Q=n(416091),Y=n(911969),X=n(210228),J=n(237181),ee=n(481415),te=n(785893);const ne=(0,z.defineMessages)({salesAssistedAiNotificationHeader:{id:"AiSalesAssistedNotificationTooltip.header",defaultMessage:"You now have unlimited Notion AI"},salesAssistedAiNotificationContent:{id:"AiSalesAssistedNotificationTooltip.content",defaultMessage:"Ask for edits to pages, find answers, and chat about anything. Click here to see examples."}});function se(e){const{origin:t,setDismissed:n}=e,s=(0,K.O7)(),i=(0,O.VK)((()=>f.default.state.currentUserSettingsStore),[]);(0,E.useEffect)((()=>{i&&function(e,t){const{userSettingsStore:n}=t;X.createAndCommit({environment:e,userAction:"AiSalesAssistedNotificationTooltip.setSalesAssistedNotificationSeenAtToCurrentTimestamp",perform:e=>{J.d2({userSettingsStore:n,transaction:e,data:{ai_sales_assisted_extra_notification_seen_at:Date.now()}})}})}(s,{userSettingsStore:i}),Y.K(s,{from:"sales_assisted_ai_notification"})}),[s,i]);const a=(0,E.useCallback)((()=>{n(!0),Y.y(s,{from:"sales_assisted_ai_notification"})}),[s,n]);return(0,te.jsx)(ee.U,{style:{width:250},pointerLength:25,pointerPosition:"94%",origin:t,placementToOrigin:"top",header:(0,te.jsx)(z.FormattedMessage,{...ne.salesAssistedAiNotificationHeader}),content:(0,te.jsx)(z.FormattedMessage,{...ne.salesAssistedAiNotificationContent}),onCloseClick:a})}var ie=n(310259),ae=n(690403),oe=n(863296),re=n(548779),le=n(521273);const de=(0,z.defineMessages)({primedTextInput:{id:"assistant.universalQna.slackConnectedNotificationTooltip.tryItPrimedInput",defaultMessage:"Find a Slack message about: "}});function ce(e){const{origin:t,setDismissed:n}=e,s=(0,K.O7)(),i=(0,D.Fg)(),a=(0,z.useIntl)(),o="dark"===i.mode,l=(0,O.VK)((()=>{const e=f.default.state.currentSpaceStore;if(e)return(0,re.rn)(s,e)}),[s]),d=(0,D.yK)((e=>({tooltip:{width:250},headerWrapper:{display:"flex",flexDirection:"row",alignItems:"start"},slackIcon:{width:20},betaBadge:{borderRadius:4,background:e.accentColors.translucentGray[300],color:"#7F7F7F",display:"inline-block",fontSize:11,fontWeight:500,padding:"2px 5px"},content:{padding:"4px 0px"},tryIt:{border:o?`1px solid ${e.accentColors.gray[500]}`:`1px solid ${e.accentColors.gray[700]}`,marginTop:6,color:e.regularInvertedTextColor},tryItHovered:{border:`1px solid ${e.accentColors.gray[600]}`,backgroundColor:o?e.accentColors.gray[400]:e.accentColors.gray[800]}})),[o]);(0,E.useEffect)((()=>{ie.dg(s),Y.K(s,{from:"slack_qna_ai_notification"})}),[s]);const c=(0,E.useCallback)((e=>{const{tryIt:t}=e;n(!0),t?(0,r.openAssistantRightHandSideMenu)({environment:s,primeTextInput:a.formatMessage(de.primedTextInput),from:"slack_qna_notification_try_it"}):Y.y(s,{from:"slack_qna_ai_notification"})}),[s,a,n]);return(0,U.$K)(l)?(0,te.jsx)(ee.U,{style:d.tooltip,pointerLength:25,pointerPosition:"90%",origin:t,placementToOrigin:"top",header:(0,te.jsxs)("div",{style:d.headerWrapper,children:[(0,te.jsx)("img",{src:W.Z.images.externalIntegrations.slackIconPng,style:d.slackIcon}),(0,te.jsx)(ae.Z,{style:d.betaBadge,content:(0,te.jsx)(z.FormattedMessage,{id:"AiSlackQnaNotificationTooltip.betaLabel",defaultMessage:"Beta"})})]}),content:(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{style:d.content,children:(0,te.jsx)(z.FormattedMessage,{id:"AiSlackQnaNotificationTooltip.message",defaultMessage:"Notion AI can now find information from public Slack channels. Your workspace owner has enabled this feature for you!"})}),(0,te.jsx)(oe.Z,{style:d.tryIt,hoveredStyle:d.tryItHovered,isSmall:!0,onClick:()=>c({tryIt:!0}),children:(0,te.jsx)(z.FormattedMessage,{id:"AiSlackQnaNotificationTooltip.tryIt",defaultMessage:"Ask AI"})})]}),onCloseClick:()=>c({tryIt:!1})}):null}var ue=n(402551);function pe(e){const t=(0,K.O7)(),n=(0,O.VK)((()=>f.default.state.currentSpaceStore),[]),s=(0,O.VK)((()=>le.Z.canShowUniversalSearchScopes()),[]),i=(0,E.useCallback)((async()=>{n&&await(0,q.updateSlackQnAConnectionState)({environment:t,spaceStore:n})}),[n,t]);return(0,ue.W)(i,30*G.hM,s),null}var ge=n(955031),me=n(164921),he=n(828451),fe=n(58261),ye=n(291839),xe=n(526388),ve=n(510102),Se=n(628020),be=n(843250),Ce=n(679897),je=n(318245),ke=n(825464),we=n(316772),Ie=n(155320),Me=n(791683),Te=n(13808),Ae=n(365820),Pe=n(599405),Be=n(151454),_e=n(653965),Fe=n(804827),Ze=n(606854),Ve=n(779683),Re=n(604489);function Le(e){const t=(0,K.O7)(),n=(0,O.VK)((()=>P.d.state.open),[]),s=(0,O.VK)((()=>{const e=Z.default.getActiveSession();if(!e)return[];const n=(0,Pe.getPageIdsFromRoute)(t.RouterStore.state.route);return e.groupedPendingOperations.state.filter((0,U.AO)((e=>"updatedPage"!==e.type||e.didCreatePage?{false:e}:{true:e}))).filter((e=>n.includes(e.pageId)))}),[t]),i=!n&&s.length>0;return(0,te.jsx)(Ae.M,{children:i&&(0,te.jsx)(Ee,{...e,operationGroups:s})})}function Ee(e){const{onChat:t,operationGroups:n}=e,s=(0,K.O7)(),[i]=(0,E.useState)(c.Il()),r=(0,E.useMemo)((()=>_e.Sm(n.map((e=>e.groupedEdits.length)))),[n]),l=(0,E.useMemo)((()=>n.flatMap((e=>e.groupedEdits.flatMap((e=>e.operationIds))))),[n]),d=(0,Re.E)({inferenceId:i,operationIds:l}),u=(0,ve.Io)().type,p=(0,E.useCallback)((async()=>{const e=Z.default.getActiveSession();e&&(await(0,a.rejectEdits)({environment:s,inferenceId:i,sessionContext:e,operationIds:l}),o.trackDiscardAllPill(s,{sessionId:e.sessionId,from:u}))}),[u,s,i,l]),g=(0,E.useCallback)((async()=>{await d()}),[d]);return(0,te.jsx)(Ke,{pendingEdits:r,onAcceptEdits:g,onRejectEdits:p,onChat:t})}function Ke(e){const{pendingEdits:t,onAcceptEdits:n,onRejectEdits:s,onChat:i}=e,a=(0,Ve.k)(),o=(0,D.yK)((e=>({outer:{position:"fixed",bottom:a,left:0,width:"100%",display:"flex",zIndex:Be.E,padding:4,pointerEvents:"none"},inner:{background:e.tooltipBackground,color:e.regularInvertedTextColor,borderRadius:8,padding:"11px 16px",boxShadow:e.largeBoxShadow,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center",pointerEvents:"auto",gap:10},button:{paddingLeft:0,paddingRight:0}})),[a]),r=(0,O.VK)((()=>{var e;return Boolean(null===(e=Z.default.getActiveSession())||void 0===e?void 0:e.isStreaming())}),[]);return(0,te.jsx)(Fe.Z,{open:!0,zIndex:201,children:(0,te.jsx)("div",{style:o.outer,children:(0,te.jsxs)(L.E.div,{"aria-live":"polite",style:o.inner,transition:{duration:.2},initial:{transform:"translateY(50px) scale(0.95)",opacity:0},animate:{transform:"translateY(0) scale(1)",opacity:1},exit:{opacity:0},children:[(0,te.jsx)("div",{children:(0,te.jsx)(z.FormattedMessage,{id:"AssistantOriginElement.aiPendingEdits",defaultMessage:"{numPendingEdits, plural, one {1 pending AI edit} other {{numPendingEdits} pending AI edits}}",values:{numPendingEdits:t}})}),(0,te.jsx)(Ze.Pn,{onClick:n,style:o.button,disabled:r,children:(0,te.jsx)(z.FormattedMessage,{id:"AssistantOriginElement.pendingEdits.accept",defaultMessage:"Accept"})}),(0,te.jsx)(Ze.Pn,{onClick:s,style:o.button,disabled:r,children:(0,te.jsx)(z.FormattedMessage,{id:"AssistantOriginElement.pendingEdits.discard",defaultMessage:"Discard"})}),(0,te.jsx)(Ze.Pn,{onClick:i,style:o.button,children:(0,te.jsx)(z.FormattedMessage,{id:"AssistantOriginElement.pendingEdits.chat",defaultMessage:"Chat"})})]})})})}function Oe(e){const{originRef:t,reminderStatus:n,setDismissed:s}=e,i=(0,K.O7)(),a=(0,O.VK)((()=>f.default.state.currentUserSettingsStore),[]),r=(0,E.useCallback)((()=>{s(!0),a&&n&&X.createAndCommit({environment:i,userAction:"AiAssistantReminderTooltip.setNumQnaRemindersShown",perform:e=>{J.d2({userSettingsStore:a,transaction:e,data:n.update})}})}),[i,a,n,s]);(0,E.useEffect)((()=>{n&&o.trackQnaReminderShown(i,{number:n.number})}),[i,n]);const l=(0,O.VK)((()=>le.Z.showAssistantNotionAiCopy()?(0,te.jsx)(z.FormattedMessage,{id:"AssistantReminderTooltip.reminderToUseAssistantHeader",defaultMessage:"Try the new Notion AI"}):(0,te.jsx)(z.FormattedMessage,{id:"QnAReminderTooltip.reminderToUseQnAHeader",defaultMessage:"Try Notion AI"})),[]),d=(0,O.VK)((()=>le.Z.showAssistantNotionAiCopy()?(0,te.jsx)(z.FormattedMessage,{id:"AssistantReminderTooltip.reminderToUseAssistantContent",defaultMessage:"Chat, create, and find anything, powered by your knowledge."}):(0,te.jsx)(z.FormattedMessage,{id:"QnAReminderTooltip.reminderToUseQnAContent",defaultMessage:"Find pages, get instant answers with Q&A"})),[]);return(0,te.jsx)(ee.U,{origin:t,style:{width:250},pointerLength:25,pointerPosition:"94%",placementToOrigin:"top",header:l,content:d,onCloseClick:r})}var De=n(500007),We=n(224646),He=n(304926);const Ne=2*G.hM;function ze(){const e=(0,K.O7)(),t=(0,K.Fy)(),n=(0,z.useIntl)();!function(){const e=(0,K.O7)(),t=(0,O.VK)((()=>f.default.state.mainEditorCurrentBlockStore),[]),n=(0,O.VK)((()=>{var e;return null===(e=f.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),s=(0,O.VK)((()=>{var e;return Boolean(null===(e=Z.default.getActiveSession())||void 0===e?void 0:e.isCurrentlyCommittingHumanStep)}),[]),i=(0,O.VK)((()=>B.N.state.currentState),[]),a=(0,O.VK)((()=>f.default.state.currentUserSettingsStore),[]);(0,E.useEffect)((()=>{let e;return"answerWaitingForUserClick"===i&&(e=setTimeout((()=>{"answerWaitingForUserClick"===B.N.state.currentState&&B.N.setState({...B.N.state,currentState:"default"})}),Ne)),()=>clearTimeout(e)}),[i]);const{lastStepLoadingCompletionUnixEpochMs:o,aiWindowLastSeenUnixEpochMs:r}=(0,O.VK)((()=>B.N.state),[]);(0,E.useEffect)((()=>{const e=B.N.state.currentState,t=o===-1/0||r>o;s||t||"answerLoading"!==e||o===-1/0?s||"answerLoading"!==e&&!t?s&&"default"===e&&B.N.setState({...B.N.state,currentState:"answerLoading"}):B.N.setState({...B.N.state,currentState:"default"}):B.N.setState({...B.N.state,currentState:"answerWaitingForUserClick"})}),[e,t,n,r,s,o,a])}();const s=(0,E.useRef)(null),i=(0,O.VK)((()=>P.d.state.open),[]),a=(0,Me.Bt)(i),[o,l]=(0,E.useState)(!1);(0,E.useEffect)((()=>{(0,U.$K)(a)||l(!1)}),[a,l]);const d=(0,U.$K)(a)&&!o,c=(0,O.VK)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n,mainEditorCurrentBlockStore:s}=f.default.state;return!Se.tu.state&&(!!(n&&s&&s.canRead())&&(!i&&le.Z.isQnATooltipsVisible(e.device,t)))}),[e.device,i]),[u,p]=(0,E.useState)(!1),[g,h]=(0,E.useState)(!1),y=u&&!g,x=(0,O.VK)((()=>{var e;return null===(e=f.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]);(0,E.useEffect)((()=>{p(!1),h(!1)}),[x]),(0,E.useEffect)((()=>{u||i||async function(){const t=await async function(e){var t;const n=f.default.state.currentSpaceStore,s=null===(t=f.default.state.currentSpaceViewStore)||void 0===t?void 0:t.getSettings();if(!n||!s)return!1;if(e.device.isMobile)return!1;if(!le.Z.isSlackQnaNotificationEnabled())return!1;if(!le.Z.isAiEnabled())return!1;if((0,U.$K)(s.ai_slack_qna_notification_seen_at))return!1;const i=await m.getConnectedAppsForUniversalQna(e,{spaceId:n.getSpaceId()});if("success"!==i.type||!i.data.connectedApps.includes("slack-admin"))return!1;const a=await m.getSlackBulkIngestionStatus(e,{spaceId:n.getSpaceId()});return"success"===a.type&&!a.data.inProgress&&!1!==a.data.isSyncCompleted}(e);t&&p(!0)}()}),[e,x,u,p,i]);const[v,S]=(0,E.useState)(!1),[b,C]=(0,E.useState)(!1),j=v&&!b;(0,E.useEffect)((()=>{v||i||!(0,$.lV)(e)||S(!0)}),[e,v,S,i]);const k=(0,O.VK)((()=>{var e;const t=B.N.state;return P.d.state.open||null!==(e=Ie.default.state)&&void 0!==e&&e.open?{currentState:"default"}:t}),[]),w=(0,E.useCallback)((()=>{l(!0),h(!0),C(!0)}),[l,h,C]),I=(0,E.useCallback)((()=>{const t=je.default.mark("assistant.origin_element_click_lag");je.default.measureAfterNextFlush(t,{environment:e});const{currentUserSettingsStore:s}=f.default.state;s&&(0,q.setQnaOnboardingPhase)(e,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipClose",userSettingsStore:s}),le.Z.shouldIssueWarmUpQuery()&&(0,_.aM)({environment:e,assistantSurfaceType:"corner"}),B.N.setState({...B.N.state,currentState:"default"}),r.openAssistantRightHandSideMenu({environment:e,from:"button",isReminder:d,reminderType:void 0,primeTextInput:y?n.formatMessage(de.primedTextInput):void 0}),w()}),[e,n,d,w,y]),M=(0,O.VK)((()=>le.Z.showAssistantNotionAiCopy()),[]),T=(0,ge.r)({environment:e,rightEdgeDistance:16,isInPeekRenderer:!1,width:36}),A=(0,D.yK)((e=>({sparkleImg:{width:16,pointerEvents:"none"},faceImg:{width:36,pointerEvents:"none"},button:{...T,...c||d||j||y?{boxShadow:"0 0 0 1px #2383e2, 0 0 0 3px #b6cce7"}:{},background:M?e.assistantCornerButtonBackground:e.whiteButtonBackground},hoveredButton:{background:M?e.assistantCornerButtonBackgroundHovered:e.whiteButtonHoveredBackground},pressedButton:{background:M?e.assistantCornerButtonBackgroundPressed:e.whiteButtonPressedBackground}})),[T,c,d,j,y,M]),F=(0,O.VK)((()=>le.Z.showAssistantNotionAiCopy()?(0,te.jsx)("img",{style:A.faceImg,src:W.Z.images.assistantStaticTransparentFacePng}):(0,N.t)({...A.sparkleImg})),[A.faceImg,A.sparkleImg]),V=(0,Ce.A3)(),R=(0,O.VK)((()=>le.Z.shouldShowAnimatedAssistantFace(t)),[t]),L=(0,E.useMemo)((()=>R?(0,te.jsx)(xe.Z,{originGap:6,disableTooltip:d||c||j||y,renderTooltip:()=>(0,te.jsx)(Ge,{}),placement:ke.u.Top,alignment:ke.v.End,delayThreshold:400,render:e=>(0,te.jsx)(me.Z,{onFocus:e.onFocus,onBlur:e.onBlur,onMouseDown:e.onMouseDown,onMouseLeave:e.onMouseLeave,ariaLabel:"ai",className:be.U9U,style:A.button,hoveredStyle:A.hoveredButton,pressedStyle:A.pressedButton,onClick:I,ref:s,children:(0,te.jsx)(Te.E,{onMouseEnter:e.onMouseEnter,sizeVariant:"medium"})})}):(0,te.jsx)(xe.Z,{originGap:6,disableTooltip:d||c||j||y,renderTooltip:()=>(0,te.jsx)(Ge,{}),placement:ke.u.Top,alignment:ke.v.End,delayThreshold:400,render:e=>(0,te.jsx)(me.Z,{...e,ariaLabel:"ai",className:be.U9U,style:A.button,hoveredStyle:A.hoveredButton,pressedStyle:A.pressedButton,onClick:I,ref:s,children:F})})),[A,F,R,c,d,j,y,I]),H=(0,E.useMemo)((()=>{const e=(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(he.g,{shouldShow:c,calloutId:"ai_assistant_origin_element_tooltip",children:(0,te.jsx)(Q.ND,{origin:s})}),(0,te.jsx)(he.g,{shouldShow:j,calloutId:"ai_sales_assisted_notification_tooltip",children:(0,te.jsx)(se,{origin:s,setDismissed:C})}),(0,te.jsx)(he.g,{shouldShow:y,calloutId:"ai_slack_qna_notification_tooltip",children:(0,te.jsx)(ce,{origin:s,setDismissed:h})}),(0,te.jsx)(he.g,{shouldShow:d,calloutId:"ai_assistant_reminder_tooltip",children:a&&(0,te.jsx)(Oe,{originRef:s,reminderStatus:a,setDismissed:l})}),L]});switch(k.currentState){case"answerLoading":return M||t.isMobile?e:(0,te.jsx)(Ue,{onClick:I,isAnswerReady:!1});case"answerWaitingForUserClick":return M||t.isMobile?e:(0,te.jsx)(Ue,{onClick:I,isAnswerReady:!0});case"default":return e;default:(0,U.t1)(k.currentState)}}),[L,I,c,d,y,a,l,k,M,j,C,t.isMobile]),G=(0,O.VK)((()=>Ie.default.state.open||"assistantCompletionPopup"===we.default.state.type),[]);return V||G?null:(0,te.jsx)(ve.JU,{surface:ve.FP.corner,children:(0,te.jsxs)("div",{className:be.Phn,children:[(0,te.jsx)(pe,{}),(0,te.jsx)(Le,{onChat:I}),H]})})}function Ue(e){let{onClick:t,isAnswerReady:n}=e;const s=(0,D.yK)((e=>({sparklesIcon:{height:18,width:18,fill:e.regularIconColor},aiProcessingButtonTopLevelStyle:{display:"flex",alignItems:"center",flexDirection:"row",marginLeft:12.5,marginRight:14,height:52},sparklesIconWrapperStyle:{borderRadius:"100%",background:e.whiteButtonBackground,height:30,width:30,display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`,fill:e.regularIconColor},messagesWrapperStyle:{display:"flex",flexDirection:"column",justifyContent:"center",marginLeft:8},notionAiTitleStyle:{fontSize:12,fontWeight:"500",color:e.lightTextColor},answerReadyStyle:{fontSize:13,fontWeight:"500",color:e.aiPurpleColor,display:"flex",alignItems:"center"},preparingYourAnswerStyle:{fontSize:14,fontWeight:"500",color:e.aiPurpleColor},chevronRightStyle:{height:19,width:15,opacity:.2,marginLeft:"auto"}})),[]),i=function(e){const{rightEdgeDistance:t,environment:n,isInPeekRenderer:s,alwaysVisible:i,bottomEdgeDistance:a,overrides:o}=e,r=(0,O.VK)((()=>(0,We.ll)(n,s)-(0,We.vJ)(n)),[n,s]),l=(0,O.VK)((()=>t+He.Z.state),[t]),d=(0,O.VK)((()=>(0,ge.G)(n,(a??16)+He.Z.state)),[a,n]),c=(0,O.VK)((()=>Se.tu.state&&!i?0:1),[i]),{ovalButtonStyle:u}=(0,D.yK)((e=>({ovalButtonStyle:{position:"absolute",bottom:d,right:l,borderRadius:100,fontSize:20,boxShadow:e.lightBoxShadow,zIndex:Be.hT,backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",backgroundBlendMode:"overlay, normal",opacity:c,transform:`translateX(-${r}px) translateZ(0)`,transition:`\n\t\t\t\topacity ${De.nk}ms,\n\t\t\t\tcolor ${De.nk}ms,\n\t\t\t\ttransform 200ms\n\t\t\t`,...null==o?void 0:o(e)}})),[r,l,d,c,o]);return u}({rightEdgeDistance:16,isInPeekRenderer:!1,environment:(0,K.O7)(),overrides:e=>({width:278,height:52,background:e.aiPurpleTranslucentRadialGradientBackground})}),[a,o]=(0,R.H)(),[r,l]=(0,R.H)(),d=(0,E.useCallback)((async()=>{await o(a.current,{width:278}),await l(r.current,{display:"block",opacity:1})}),[o,l,a,r]);(0,E.useEffect)((()=>{d()}),[d]);return(0,te.jsx)(L.E.div,{"aria-label":"ai processing",className:be.U9U,onClick:t,style:{...i,cursor:"pointer",overflow:"hidden",flexWrap:"wrap"},variants:{initial:{width:28},animate:{width:278,transition:{type:"spring",stiffness:20,damping:15}}},initial:"initial",animate:"animate",ref:a,children:(0,te.jsxs)("div",{style:s.aiProcessingButtonTopLevelStyle,children:[(0,te.jsx)("div",{style:s.sparklesIconWrapperStyle,children:(0,N.t)(s.sparklesIcon)}),(0,te.jsx)("div",{style:{...s.messagesWrapperStyle,display:"none"},ref:r,children:n?(0,te.jsx)("div",{style:s.answerReadyStyle,children:(0,te.jsx)(z.FormattedMessage,{id:"AssistantOriginElement.answerReady",defaultMessage:"Your answer is ready"})}):(0,te.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,te.jsx)("div",{style:s.preparingYourAnswerStyle,children:(0,te.jsx)(z.FormattedMessage,{id:"AssistantOriginElement.notionAiLoadingText",defaultMessage:"Preparing your answer"})}),(0,te.jsx)("div",{style:{marginLeft:6,fontWeight:"500"},children:(0,te.jsx)(ye.Z,{})})]})}),(0,H.o)(s.chevronRightStyle)]})})}function Ge(){const e=(0,O.VK)((()=>{var e;return null===(e=f.default.state.currentSpaceStore)||void 0===e||null===(e=e.getModel())||void 0===e?void 0:e.getRenderTitle()}),[]),t=(0,D.yK)((e=>({tooltipBody:{color:e.mediumInvertedTextColor,display:"flex",flexDirection:"column"},tooltip:{minWidth:222,whiteSpace:"pre-wrap"}})),[]),n=(0,O.VK)((()=>le.Z.showAssistantNotionAiCopy()?(0,te.jsx)(z.FormattedMessage,{defaultMessage:"Notion AI",id:"assistantOriginElement.notionAi.tooltipHeading"}):(0,te.jsx)(z.FormattedMessage,{defaultMessage:"Ask AI",id:"assistantOriginElement.default.tooltipHeading"})),[]),s=(0,O.VK)((()=>le.Z.showAssistantNotionAiCopy()?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(z.FormattedMessage,{defaultMessage:"Find answers, make edits, and more",id:"assistantOriginElement.assistantCaption.hoverTooltipBody"}),(0,te.jsx)(fe.Z,{name:"commandJ"})]}):e?(0,te.jsx)(z.FormattedMessage,{defaultMessage:"Find pages and get answers about anything in {currentSpaceName}",id:"assistantOriginElement.default.withSpace.hoverTooltipBody",values:{currentSpaceName:e}}):(0,te.jsx)(z.FormattedMessage,{defaultMessage:"Find pages and get answers about anything in your workspace",id:"assistantOriginElement.default.withoutSpace.hoverTooltipBody"})),[e]);return(0,te.jsxs)("div",{style:t.tooltip,children:[(0,te.jsx)("div",{children:n}),(0,te.jsx)("div",{style:t.tooltipBody,children:s})]})}var qe=n(805809),$e=n(276915),Qe=n(802159),Ye=n(994134),Xe=n(494043),Je=n(966324),et=n(424042),tt=n(938622),nt=n(741799);function st(){const e=(0,K.O7)(),{isElectronWindows:t}=(0,K.Fy)(),{isShowingTabBar:n,isUnifiedTitleBarEnabled:s}=(0,O.VK)((()=>{var e;return{isShowingTabBar:Boolean(et.Z.state.isShowingTabBar),isUnifiedTitleBarEnabled:Boolean(null===(e=et.Z.state.preferences)||void 0===e?void 0:e.isUnifiedTitleBarEnabled)}}),[]),i=E.useCallback((()=>{tt.Z.state.isChatHistoryOpen?(0,Je.closeAssistantChatHistoryIfTooNarrow)(e):(0,Je.openAssistantChatHistoryIfWideEnough)(e)}),[e]);(0,E.useEffect)((()=>(e.WindowSizeStore.addListener(i),()=>e.WindowSizeStore.removeListener(i))),[e.WindowSizeStore,i]),(0,E.useEffect)((()=>()=>{o.trackLeavingFullPageChat(e)}),[e]),(0,E.useEffect)((()=>{!function(e){const{environment:t}=e,n=performance.now();if(it)return;const s=t.RouterStore.state;if("chat"!==s.initialRoute.name)return;je.default.measureFromAppStart({metricName:"initial_assistant_full_page_chat_render",endTime:n},{environment:t,data:{profiling_tool:(0,Ye.getProfilingToolForSession)(),time_origin_to_app_start:qe.getAppStartTime()},shouldSendIfStatsigNotInitialized:!1}),it=!0}({environment:e})}),[e]);const a=(0,D.yK)((e=>({pageLayout:{order:$e.Z.appCursorListener.aiChat,display:"flex",width:"100%"},layoutContent:{flex:1,height:"100vh"},newChatButtonText:{color:e.lightTextColor,fontSize:12,display:"flex",alignItems:"center"}})),[]);return(0,te.jsx)(ve.JU,{surface:ve.FP.fullPage,children:(0,te.jsxs)(Xe.Xg,{type:"chat",style:a.pageLayout,children:[(0,te.jsx)(Xe.Pb,{style:a.layoutContent,children:(0,te.jsx)(nt.Q,{})}),t&&s&&!n&&(0,te.jsx)(Qe.m,{})]})})}let it=!1;var at=n(231945),ot=n(953437),rt=n(605319);function lt(){const e=(0,O.VK)((()=>P.d.state.open),[]),[t,n]=(0,E.useState)(),s=(0,K.O7)(),{isMobile:i,isPhone:a}=(0,K.Fy)(),o=(0,O.VK)((()=>{const e=(0,We.ll)(s,!1)-(0,We.vJ)(s);return{bottom:15+He.Z.state,right:15+He.Z.state,xPosition:e}}),[s]);(0,E.useEffect)((()=>{const e=()=>{n(new DOMRect(window.innerWidth-o.right-o.xPosition,window.innerHeight-o.bottom,0,0)),rt.T.emit()};return e(),addEventListener("resize",e),()=>removeEventListener("resize",e)}),[o.right,o.xPosition,o.bottom]);const l=(0,D.yK)((e=>({wrap:{borderRadius:12,boxShadow:e.largeLightBoxShadow}})),[]),d=(0,E.useCallback)((async()=>{await r.closeAssistantRightHandSideMenu({environment:s,withoutDismissCheck:!0})}),[s]);return(0,te.jsx)(ot.ZP,{popupType:i?at.Z4.SlideUp:at.Z4.Popup,forceFullScreenSlideUp:i&&a,alignmentToOrigin:ke.v.End,alignBoxStyle:{transition:"left 200ms, top 200ms"},originRect:t,disableMouseCapture:!0,preventScaleTransition:!1,preventSlideUpTransition:i,keepFocus:i,popupWrapStyle:l.wrap,isWaxPaper:!0,open:e,slideUpWrapStyle:{...i&&a?{height:"var(--full-viewport-height)"}:{}},render:()=>(0,te.jsx)(ve.JU,{surface:i?ve.FP.mobileWeb:ve.FP.corner,children:(0,te.jsx)(nt.Q,{onClose:d})}),onDismiss:d})}var dt=n(661719),ct=n(559054),ut=n(213493),pt=n(153223),gt=n(436488),mt=n(568785),ht=n(550506),ft=n(965187),yt=n(768657),xt=n(249394),vt=n(206258);const St=600,bt=800;function Ct(){const e=(0,D.yK)((e=>({modalInnerStyle:{background:e.sidebarBackground,borderRadius:12,minHeight:250,maxHeight:St,width:bt}})),[]),t=(0,O.VK)((()=>F.j.state),[]),n=(0,E.useCallback)((()=>F.j.close()),[]);if(!t.isOpen)return null;const{collectionViewBlockId:s,collectionViewId:i,assistantSessionId:a}=t;return(0,te.jsx)(ht.Z,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:n,innerStyle:e.modalInnerStyle,render:()=>(0,te.jsx)(gt.Z,{capture:!0,allowEsc:!0,render:()=>(0,te.jsx)(jt,{collectionViewBlockId:s,collectionViewId:i,assistantSessionId:a})})})}function jt(e){const{collectionViewBlockId:t,collectionViewId:n,assistantSessionId:s}=e,i=function(e){const{collectionViewBlockId:t,collectionViewId:n}=e,s=(0,O.VK)((()=>f.default.state.currentSpaceStore),[]),[{value:i}]=(0,ct.r5)((async()=>{if(!s)return{type:"loading"};const e=vt.G.createChildStore(s,{table:"block",id:t});if(await e.load(),!e.isCollectionView())throw new Error("expected collection view");const i=vt.Xr.createChildStore(e,{table:ut.np,id:n});await i.load();const a=i.getCollectionStore();return await(null==a?void 0:a.load()),{collectionViewBlockStore:e,collectionViewStore:i,collectionStore:a}}),[t,n,s]);return i&&"loading"!==i.type&&i.collectionViewBlockStore?{type:"loaded",value:{collectionViewBlockStore:i.collectionViewBlockStore,collectionViewStore:i.collectionViewStore,collectionStore:i.collectionStore}}:{type:"loading"}}({collectionViewBlockId:t,collectionViewId:n}),a=(0,D.yK)((e=>({loadingSpinner:{display:"flex",justifyContent:"center",alignItems:"center",height:250}})),[]),[o,r]=(0,E.useState)(void 0);switch(i.type){case"loading":return(0,te.jsx)("div",{style:a.loadingSpinner,children:(0,te.jsx)(mt.Z,{})});case"loaded":{const{collectionViewBlockStore:e,collectionViewStore:t,collectionStore:a}=i.value;return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(kt,{assistantSessionId:s,queriedCollectionId:null==a?void 0:a.id,collectionViewBlock:o}),(0,te.jsx)("div",{style:{paddingTop:20,paddingRight:16},children:(0,te.jsx)(pt.DZ,{ref:e=>r(e),hideHeaderActions:!0,hideHeader:!0,hideViewTabBar:!0,isUnlistedView:!0,store:e,isFullScreen:!1,disabled:!1,viewId:n,overrideViewType:"table",overridePaddingLeft:16,overridePaddingRight:16,maxHeight:St-72,setCollectionContextStore:n=>{n.setContext({type:"collectionView",collectionViewBlockStore:e,collectionViewStore:t,collectionStore:a,pageVisitSourceOverride:void 0})}})})]})}default:(0,U.t1)(i)}}function kt(e){const{assistantSessionId:t,collectionViewBlock:n}=e,s=(0,O.VK)((()=>{var e;return null===(e=Z.default.getSessionContext(t))||void 0===e?void 0:e.clientSteps}),[t]),i=(0,E.useMemo)((()=>{if(s&&e.queriedCollectionId)return function(e){const{clientSteps:t,searchedCollectionId:n}=e;let s=-1;for(let a=t.length-1;a>=0;a--){const e=t[a];if("queryDatabase"===e.type&&e.collectionPointer.id===n){s=a;break}}if(-1===s)return;let i=s-1;for(;i>=0;){const e=t[i];if("human"===e.type)return e.text;i--}}({clientSteps:s,searchedCollectionId:e.queriedCollectionId})}),[s,e.queriedCollectionId]),a=(0,D.yK)((e=>({textWrapper:{paddingLeft:16,color:e.lightTextColor,fontSize:14,fontWeight:700,display:"flex",alignItems:"center"},humanMessage:{fontWeight:400,fontSize:14,display:"flex",alignItems:"center",flexGrow:0,minWidth:0,marginLeft:4,maxWidth:350,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxHeight:20},textValue:{whiteSpace:"nowrap",maxWidth:350,overflow:"hidden",textOverflow:"ellipsis"}})),[]),{store:o}=(0,yt.Cl)({initialValue:i}),r=(0,O.VK)((()=>n&&n.renderUnlistedCollectionsActionBar()),[n]);return(0,te.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:16},children:[(0,te.jsx)("div",{style:a.textWrapper,children:(0,te.jsx)(z.FormattedMessage,{defaultMessage:"Results for {textWithQuotes}",id:"AssistantEphemeralViewHeader",values:{textWithQuotes:(0,te.jsxs)("div",{style:a.humanMessage,children:['"',(0,te.jsx)(ft.Z,{disabled:!0,store:o,inPageFind:xt.B3.none,style:a.textValue,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDrag:!0,disableFilters:!0,disableSelectAllBlocks:!0,disableComment:!0,disableInsertText:!0,disableEmbedMenu:!0}),'"']})}})}),r]})}function wt(){const e=(0,K.O7)(),t=E.useCallback((()=>{(0,r.openAssistantFromEdit)({environment:e})}),[e]);return(0,te.jsx)(ve.JU,{surface:ve.FP.mobileNative,children:(0,te.jsx)(Le,{onChat:t})})}var It=n(400578);const Mt=["search-qa","page-qa","database-qa"];const Tt=["should-chat","should-search","should-query-database","should-edit","should-create","should-search-people","should-load-database","should-load-page"],At=["filter","sort","aggregation","search"];var Pt=n(772141),Bt=n(137810),_t=n(260458),Ft=n(374194),Zt=n(158297),Vt=n(953336),Rt=n(292660),Lt=(n(95477),n(319124)),Et=n(615447),Kt=n(637034),Ot=n(434859),Dt=n(869454),Wt=n(19541),Ht=n(88893),Nt=n(288280);function zt(){const{isMobile:e}=(0,K.Fy)();return(0,O.VK)((()=>Wt.Z.state.open),[])?(0,te.jsx)(Rt.Z,{onDismiss:Gt,style:e?{maxHeight:"100%",display:"flex"}:{},render:()=>(0,te.jsx)(Ut,{}),isOpen:!0}):null}function Ut(){const{isMobile:e}=(0,K.Fy)(),t=(0,D.yK)((t=>({wrap:{display:"flex",flexDirection:"column",width:e?"min(100%, 600px)":void 0,minHeight:128,maxHeight:e?void 0:"max(calc(100vh - 78px), 300px)"},modalWrap:{width:"32rem",padding:24,fontSize:14,maxWidth:"100%"},modalTitle:{fontSize:16,fontWeight:Bt.Z.fontWeight.medium},modalWarning:{fontSize:13,color:t.lightTextColor},titleContainer:{marginBottom:12},buttonArea:{display:"flex",justifyContent:"flex-end",marginTop:18,gap:8},scroller:{flexGrow:1,display:"flex",flexDirection:"column",WebkitMaskImage:"linear-gradient(black calc(100% - 12px), transparent)"}})),[e]),n=(0,z.useIntl)(),[s,i]=(0,E.useState)(),[a,o]=(0,E.useState)([]),[r,l]=(0,E.useState)([]),[d,c]=(0,E.useState)([]),u=(0,O.VK)((()=>f.default.state.currentSpaceStore),[]),p=(0,K.O7)(),g=(0,O.VK)((()=>(0,Lt.Gw)()),[]),{userMemberCount:h}=(0,O.VK)((()=>{const e=Nt.subscriptionDataStoreInstance.state;return{userMemberCount:e?(0,Ht.CM)(e).filter((e=>(0,Pt.Jy)(e.role))).length:0}}),[]),y=(0,O.VK)((()=>Et.X4.state),[]),x=(0,O.VK)((()=>y.slice(0,5).map((e=>(0,Kt.V)(e.store,n,p,!1))).filter((e=>Boolean(e)))),[p,n,y]),v=(0,E.useCallback)((()=>{const e=Wt.Z.state,t=null==u?void 0:u.id;if(!e.open||!t)return;const{inferenceId:n,sessionId:i,thumbsUpOrDown:o}=e;m.saveAssistantFeedback(p,{type:"slackbot_followup_feedback",id:n,notes:s||"",tags:a,routingLabels:r,isLabelerMode:g,filterTools:d,recentTitles:x,userMemberCount:h,space_id:t}),Wt.Z.reset()}),[null==u?void 0:u.id,p,s,a,r,g,d,x,h]),S=(0,E.useRef)(void 0);return(0,te.jsx)(gt.Z,{allowMobileAutoScroll:!0,capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:u=>(0,te.jsx)("div",{style:t.wrap,children:(0,te.jsx)(Vt.Z,{ref:S,type:Ot.Z.Y,style:t.scroller,...u,children:(0,te.jsxs)("div",{style:t.modalWrap,...u,children:[(0,te.jsxs)("div",{style:t.titleContainer,children:[(0,te.jsx)("div",{style:t.modalTitle,children:g?(0,te.jsx)(z.FormattedMessage,{id:"BadQnAFeedbackForm.assistant.title",defaultMessage:"Give additional feedback on this step"}):(0,te.jsx)(z.FormattedMessage,{id:"BadQnAFeedbackForm.title",defaultMessage:"How can we improve this response?"})}),!g&&(0,te.jsx)("div",{style:t.modalWarning,children:(0,te.jsx)(z.FormattedMessage,{id:"BadQnAFeedbackForm.warning",defaultMessage:"Your feedback helps Notion AI improve. We'll share this conversation and any pages from its search results with the Notion team."})})]}),g&&(0,te.jsxs)("div",{style:{marginBottom:12},children:[(0,te.jsx)("div",{style:{marginBottom:8},children:"Tags"}),Mt.map((e=>(0,te.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[(0,te.jsx)(_t.Z,{size:16,checked:a.includes(e),onClick:()=>{a.includes(e)?o(a.filter((t=>t!==e))):o([...a,e])}}),(0,te.jsx)("span",{style:{marginLeft:4},children:e})]},e)))]}),g&&(0,te.jsxs)("div",{style:{marginBottom:12},children:[(0,te.jsx)("div",{style:{marginBottom:8},children:"Expected action(s)"}),Tt.map((e=>(0,te.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[(0,te.jsx)(_t.Z,{size:16,checked:r.includes(e),onClick:()=>{r.includes(e)?l(r.filter((t=>t!==e))):l([...r,e])}}),(0,te.jsx)("span",{style:{marginLeft:4},children:e})]},e)))]}),g&&r.includes("should-query-database")&&(0,te.jsxs)("div",{style:{marginBottom:12},children:[(0,te.jsx)("div",{style:{marginBottom:8},children:"Expect filter tool(s)"}),At.map((e=>(0,te.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[(0,te.jsx)(_t.Z,{size:16,checked:d.includes(e),onClick:()=>{d.includes(e)?c(d.filter((t=>t!==e))):c([...d,e])}}),(0,te.jsx)("span",{style:{marginLeft:4},children:e})]},e)))]}),(0,te.jsx)(Ft.Z,{placeholder:n.formatMessage({id:"BadQnAFeedbackForm.additionalCommentsPlaceholder",defaultMessage:"What did you want to see? How can we make it better?"}),value:s,onChange:e=>i(e.target.value),focusInitial:!e,onFocus:()=>{e&&Dt.Z.onShow((()=>{var e;null===(e=S.current)||void 0===e||e.scrollToBottom()}))},textareaSubmitOnEnter:!0,inputStyle:{padding:8},onSubmit:v}),(0,te.jsxs)("div",{style:t.buttonArea,children:[(0,te.jsx)(oe.Z,{onClick:Gt,children:(0,te.jsx)(z.FormattedMessage,{id:"BadQnAFeedbackForm.cancelButton.label",defaultMessage:"Cancel"})}),(0,te.jsx)(Zt.Z,{isLarge:!0,onClick:v,children:(0,te.jsx)(z.FormattedMessage,{id:"BadQnAFeedbackForm.reportButton.label",defaultMessage:"Send"})})]})]})})})})}function Gt(){Wt.Z.update((()=>({open:!1,inferenceId:void 0})))}},2405:(e,t,n)=>{n.d(t,{Z:()=>p,b:()=>u});var s=n(667294),i=n(800480),a=n(724405),o=n(872787),r=n(164921),l=n(794562),d=n(785893);const c=s.forwardRef((function(e,t){const{style:n,hoveredStyle:s,icon:o,disabled:c,iconStyle:u,title:p,onClick:g,focused:m,variant:h,singleLineTitle:f,...y}=e,x=function(e){const t=(0,l.u)(),{isMobile:n}=(0,i.Fy)();return(0,a.yK)((s=>({AssistantActionButton:{display:"flex",alignItems:"center",boxShadow:e.tinted?"none":s.inputBoxShadow,padding:"6px 12px 6px 12px",color:e.lightGrey?s.lightTextColor:s.regularTextColor,fontSize:t.actionButtonLabelTextSize,fontWeight:500,borderRadius:24,width:"max-content",background:e.tinted?s.assistantTintedActionButtonBackground:"transparent",height:t.actionButtonHeight,...e.tinted&&{hoveredStyle:{background:s.assistantTintedActionButtonBackgroundHovered},pressedStyle:{background:s.assistantTintedActionButtonBackgroundPressed}},...n&&{flexWrap:"nowrap",textWrap:"nowrap"}},icon:{width:t.actionIconSize,height:t.actionIconSize,fill:e.lightGrey?s.lightIconColor:s.regularIconColor,marginRight:6}})),[e.lightGrey,e.tinted,t,n])}({lightGrey:"lightGrey"===h,tinted:"tinted"===h});return(0,d.jsxs)(r.Z,{...y,ref:t,disabled:c,style:{...x.AssistantActionButton,...n},hoveredStyle:{...x.AssistantActionButton.hoveredStyle,...s},pressedStyle:x.AssistantActionButton.pressedStyle,onClick:g,focused:m,...e.tooltipEvents??{},children:[null==o?void 0:o({...x.icon,...u}),f?(0,d.jsx)("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:p}):p]})}));function u(e){const{onDropdownClick:t,variant:n,...s}=e,{isMobile:r}=(0,i.Fy)(),l=(0,a.yK)((e=>({wrap:{display:"flex",alignItems:"center",borderRadius:24},button:{boxShadow:"none"},buttonLeft:{...!r&&{borderTopRightRadius:0,borderBottomRightRadius:0,borderRight:`1px solid ${e.shadowColor}`,paddingRight:7}},buttonRight:{borderTopLeftRadius:0,borderBottomLeftRadius:0,alignSelf:"stretch",paddingLeft:5,paddingRight:5},buttonRightIconStyle:{marginRight:4,height:10,width:10}})),[r]);return(0,d.jsxs)("div",{style:l.wrap,children:[(0,d.jsx)(c,{style:{...l.button,...l.buttonLeft},variant:n,...s}),!r&&(0,d.jsx)(c,{onClick:t,style:{...l.button,...l.buttonRight},icon:e=>(0,o.Y)({...e,...l.buttonRightIconStyle}),variant:n})]})}const p=c},286649:(e,t,n)=>{n.d(t,{s:()=>m});n(757658),n(252262);var s=n(667294),i=n(800480),a=n(886628),o=n(724405),r=n(76233),l=n(401898),d=n(360682),c=n(214976),u=n(80444),p=n(785893);const g=20;function m(e){const{textValue:t,onAnimationEnd:n,disableAnimation:m,overrideTextStyles:h}=e,f=(0,i.O7)(),y=(0,o.Fg)(),x=e.chunkSize??g,v=(0,a.VK)((()=>{const e=u.default.state.currentSpaceStore;if(!e)return[];const n=e.getSpaceId(),s=function(e){const{textValue:t,chunkSize:n}=e,s=[];for(const o of t)if((0,r.QJH)(o)){const[e]=o;for(const t of e)s.push([t])}else if((0,r.AJd)(o)){const[e,t]=o;for(const n of e){const e=[n,t];s.push(e)}}else(0,r.km_)(o)?s.push(o):(0,r.YrK)(o)||(0,l.t1)(o);let i=0;const a=[];for(const o of s){const e=Math.floor(i/n),t=a.at(e),s=t?[...t,o]:[o];a[e]=s,i+=1}return a}({textValue:t,chunkSize:x});return s.map((t=>c.IY({environment:f,textValue:{value:t,spaceId:n},parentStore:e,disableHover:!1,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0,disableSuggestionAnnotations:!0,disabled:!0,emojiType:(0,d.e_)(f),theme:y,katex:f.KatexStore.getKatex(),formulaValueTypes:[]})))}),[f,y,t,x]),S=m?v.length:0,[b,C]=s.useState(S);return(0,s.useEffect)((()=>{if(b<v.length){const n=setTimeout((()=>{C(b+1)}),(e=25,t=100,Math.floor(Math.random()*(t-e+1)+e)));return()=>clearTimeout(n)}var e,t}),[b,v]),(0,s.useEffect)((()=>{v.length!==b||m||null==n||n()}),[v.length,b,n,m]),(0,p.jsx)("div",{style:h,children:v.slice(0,b).map(((e,t)=>(0,p.jsx)(s.Fragment,{children:e},t)))})}},421016:(e,t,n)=>{n.d(t,{Z:()=>je});var s=n(667294),i=n(800480),a=n(886628),o=n(724405),r=n(231945),l=n(80444),d=n(665955),c=n(276927),u=n(937612),p=n(709291),g=n(547307),m=n(627153),h=n(709953),f=n(524677),y=n(898104),x=n(210228),v=n(793174),S=n(819471),b=n(409015),C=n(74404),j=n(668709),k=n(552275),w=n(573063),I=n(828992),M=n(158297),T=n(731278),A=n(953336),P=n(672495),B=n(824006),_=n(526388),F=n(938530),Z=n(212534),V=n(98742),R=n(434859),L=n(168910),E=n(642915),K=n(542853),O=n(808808),D=n(489728),W=n(776798),H=n(206258),N=n(785893);function z(e){const{automationStore:t,automationContextStore:n,disabled:l}=e,d=(0,i.O7)(),c=(0,o.yK)((e=>({chevronIcon:{width:10,height:10,marginLeft:4,marginTop:2,fill:e.lightIconColor}})),[]),u=(0,a.VK)((()=>t.getParentStore()),[t]),p=(0,a.VK)((()=>u instanceof H.NW?{type:"collection",collection:u.pointer}:u instanceof H.G?{type:"page",page:u.pointer}:void 0),[u]),g=(0,s.useCallback)(((e,n)=>{x.createAndCommit({userAction:"AssistantAutomationParentDropdownButton.handleParentChange",environment:d,perform:n=>{const s="collection"===e.type?e.collection:"page"===e.type?e.page:void 0;if(!s)return;u instanceof H.NW&&(0,E.tt)({transaction:n,collectionStore:u,automationStore:t}),h.sW({store:t,transaction:n,data:{parent_id:s.id,parent_table:s.table}});const i=t.getParentStore();i instanceof H.NW&&(0,E.Mn)({transaction:n,collectionStore:i,automationStore:t})}}),n.close()}),[t,d,u]);return u&&p?(0,N.jsx)(r.ZP,{popupType:d.device.isMobile?r.Z4.SlideUp:r.Z4.Popup,renderOrigin:e=>(0,N.jsxs)(D.Z,{shouldShrink:!0,disabled:l,disabledFeedback:l,...e,children:[(0,N.jsx)(W.Z,{store:u}),(0,K.i)(c.chevronIcon)]}),render:e=>(0,N.jsx)(O.L,{automationContextStore:n,onChange:t=>g(t,e),selectedTarget:p,skipVariables:!0,onClose:e.close})}):null}var U=n(519889),G=n(653965),q=n(140190),$=n(595193),Q=n(435294),Y=n(478140),X=n(632163),J=n(61766);function ee(e){const{automationStore:t,disabled:n}=e,s=(0,p.useIntl)(),i=(0,Q.d)(),o=(0,a.qz)(void 0,J.Z),l=(0,a.VK)((()=>{var e;return null===(e=t.getProperties())||void 0===e?void 0:e.assistant_run_as_user_id}),[t]),d=(0,a.VK)((()=>{if(!l)return;return H.U6.createChildStore(t,{table:U.KJ,id:l}).getModel()}),[t,l]);return(0,N.jsx)(r.ZP,{buttonPopupStore:o,disabled:n,originGap:0,popupType:i,render:e=>(0,N.jsx)(te,{selectedUserId:l,automationStore:t,parent:e}),renderOrigin:e=>(0,N.jsx)(q.S,{...e,disabled:n,isSecondary:!0,children:d?d.getFullName(s):(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Bot user",id:"AssistantAutomationMenu.runAsUser.botUser"})})})}function te(e){const{selectedUserId:t,automationStore:n,parent:o}=e,r=(0,p.useIntl)(),l=(0,i.O7)(),d=(0,$.F)({maxWidth:360}),c=l.currentUser.id,u=(0,a.VK)((()=>{if(!c)return;return H.U6.createChildStore(n,{table:U.KJ,id:c}).getModel()}),[n,c]),g=(0,a.VK)((()=>{if(!t)return;return H.U6.createChildStore(n,{table:U.KJ,id:t}).getModel()}),[n,t]),m=(0,s.useCallback)((e=>{x.createAndCommit({userAction:"AssistantAutomationRunAsUserDropdownButton.onChangeImpl",environment:l,perform:t=>{h.sW({store:n.getPropertiesStore(),transaction:t,data:{assistant_run_as_user_id:e||null}})}}),o.close()}),[n,,l,o]);if(!u||!c)return null;const f=G.oA(G.jj(["bot",c,t])),y=t||"bot",v=f.map((e=>({key:e,render:t=>(0,N.jsx)(k.Z,{...t,checkState:y===e,title:u&&e===u.id?u.getFullName(r):g&&e===g.id?g.getFullName(r):(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Bot user",id:"AssistantAutomationMenu.runAsUser.botUser"})}),action:()=>m("bot"===e?void 0:e)})));return(0,N.jsx)(Y.Z,{...d,children:(0,N.jsx)(X.Z,{initialFocus:0,sections:[{key:0,render:e=>(0,N.jsx)(P.Z,{enableActionSheetTitle:!0,...e}),items:v}],type:X.i.Vertical})})}n(21703);var ne=n(213148),se=n(950780),ie=n(747453),ae=n(253523),oe=n(405829),re=n(471924),le=n(606287),de=n(401898),ce=n(137810),ue=n(469317);const pe=["chat","recurrence","collection_page_added","collection_page_edited"],ge=(0,p.defineMessages)({chatTriggerName:{defaultMessage:"Chat",id:"AssistantAutomationTrigger.chatTriggerName"},recurrenceTriggerName:{defaultMessage:"Repeat",id:"AssistantAutomationTrigger.recurrenceTriggerName"},collectionPageAddedTriggerName:{defaultMessage:"Page added in database",id:"AssistantAutomationTrigger.collectionPageAddedTriggerName"},collectionPageEditedTriggerName:{defaultMessage:"Page properties edited in database",id:"AssistantAutomationTrigger.collectionPageEditedTriggerName"}}),me={chat:ge.chatTriggerName,recurrence:ge.recurrenceTriggerName,collection_page_added:ge.collectionPageAddedTriggerName,collection_page_edited:ge.collectionPageEditedTriggerName};function he(e){const{automationStore:t,automationContextStore:n,disabled:l}=e,d=(0,i.O7)(),c=(0,p.useIntl)(),u=(0,Q.d)(),g=(0,o.yK)((e=>({container:{background:e.contentBackground,borderRadius:5,display:"flex",flexDirection:"column",gap:8,padding:8,marginLeft:12,marginRight:12,marginBottom:8,fontSize:14,boxShadow:e.lightBoxShadow,width:"calc(100% - 24px)"},nameRow:{display:"flex",alignItems:"center"},name:{fontWeight:ce.Z.fontWeight.medium,marginLeft:2},iconWrap:{width:24,height:24,display:"flex",alignItems:"center",borderRadius:4,background:"rgba(35, 131, 226, 0.14)"},icon:{width:14,height:14,fill:e.blueColor,margin:"0 auto"},chevronIcon:{width:10,height:10,marginLeft:4,marginTop:2,fill:e.lightIconColor}})),[]),m=(0,a.VK)((()=>t.getTriggerStore()),[t]),f=(0,a.VK)((()=>m.getValue()),[m]),y=(0,a.VK)((()=>t.getStatus()),[t]),v=(0,a.VK)((()=>t.getProperties()||{}),[t]).assistant_context||[],S=(0,a.VK)((()=>{const e=m.getValue();if(e)return"chat"===e.type?"chat":"recurrence"===e.type?"recurrence":"event"===e.type&&e.event.pagesAdded?"collection_page_added":"event"===e.type&&"any"===e.event.pagePropertiesEdited.type?"collection_page_edited":void 0}),[m]),b=(0,s.useCallback)((e=>{const n=function(e,t){const n=e.getParentPointer(),s=e.getSpacePointer();if(!n||!s)throw new Error("Invalid parent pointer");const i={...n,spaceId:s.id};if("chat"===t)return{id:re.Il(),type:"chat"};if("recurrence"===t)return{id:re.Il(),type:"recurrence",recurrence:(0,ue.defaultRecurrenceConfig)()};if("collection_page_added"===t){if(i.table!==le.vF)throw new Error("Invalid parent pointer");return{id:re.Il(),type:"event",event:{source:{type:"collection",pointer:i},pagesAdded:!0,pagePropertiesEdited:{type:"none"}}}}if("collection_page_edited"===t){if(i.table!==le.vF)throw new Error("Invalid parent pointer");return{id:re.Il(),type:"event",event:{source:{type:"collection",pointer:i},pagesAdded:!1,pagePropertiesEdited:{type:"any"}}}}(0,de.t1)(t)}(t,e);x.createAndCommit({userAction:"AssistantAutomationTrigger.onTriggerTypeChange",environment:d,perform:e=>{h.sW({store:t,transaction:e,data:{trigger:n}})}})}),[t,d]),C=(0,s.useCallback)((e=>{x.createAndCommit({userAction:"AssistantAutomationTrigger.onTriggerTypeChange",environment:d,perform:n=>{e?(h.sW({store:m,transaction:n,data:{recurrence:e}}),h.sW({store:t,transaction:n,data:{status:"active"}})):h.sW({store:t,transaction:n,data:{status:"disabled"}})}})}),[t,d,m]),j=(0,s.useCallback)((()=>{x.createAndCommit({userAction:"AssistantAutomationTrigger.handleActiveClick",environment:d,perform:e=>{h.sW({store:t,transaction:e,data:{status:"active"===y?"disabled":"active"}})}})}),[t,y,d]),w=(0,s.useCallback)((()=>{x.createAndCommit({userAction:"AssistantAutomationTrigger.handleAddContextClick",environment:d,perform:e=>{const n=t.getPropertiesStore().getKeyStore("assistant_context");x.applyOperation({store:n,operation:{pointer:n.pointer,command:"keyedObjectListAfter",path:n.path,args:{value:{id:re.Il(),name:"New context key",type:"collection_view_block",value:void 0}}},transaction:e})}})}),[t,d]);return S?(0,N.jsxs)("div",{style:g.container,children:[(0,N.jsxs)("div",{style:g.nameRow,children:[(0,N.jsx)("div",{style:g.iconWrap,children:(0,N.jsx)(fe,{triggerType:S,style:g.icon})}),(0,N.jsx)(r.ZP,{alignmentToOrigin:r.vR.Start,disabled:l,originGap:0,placementToOrigin:r.pO.Bottom,popupType:u,render:e=>(0,N.jsx)(ye,{automationStore:t,triggerType:S,onChange:b,parent:e}),renderOrigin:e=>(0,N.jsxs)(D.Z,{shouldShrink:!0,disabled:l,style:g.name,...e,children:[c.formatMessage(me[S]),(0,K.i)(g.chevronIcon)]})}),"recurrence"===(null==f?void 0:f.type)&&(0,N.jsx)(ue.default,{recurrence:f.recurrence,onChange:C,disabled:l,focused:!1,variant:"label"})]}),(0,N.jsxs)(P.Z,{children:[v.map(((e,s)=>(0,N.jsx)(xe,{automationStore:t,automationContextStore:n,contextItem:e,disabled:l},s))),(0,N.jsx)(D.Z,{isGray:!0,disabled:l,icon:ie.R,onClick:w,children:(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Add context",id:"AssistantAutomationTrigger.addContextLabel"})})]}),"chat"!==(null==f?void 0:f.type)&&(0,N.jsx)(k.Z,{title:(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Active",id:"AssistantAutomationTrigger.activeLabel"}),focused:!1,onClick:j,right:(0,N.jsx)(B.Z,{on:"active"===y,onClick:j})})]}):null}function fe(e){const{triggerType:t,style:n}=e;switch(t){case"chat":return(0,oe.s)(n);case"recurrence":return(0,ae.N)(n);case"collection_page_added":return(0,ie.R)(n);case"collection_page_edited":return(0,se.E)(n)}}function ye(e){const{automationStore:t,triggerType:n,onChange:s,parent:i}=e,o=(0,p.useIntl)(),r=(0,$.F)({maxWidth:360}),l=(0,a.VK)((()=>pe.filter((e=>function(e,t){const n=e.getParentPointer();if(!n)return!1;return"collection_page_added"!==t&&"collection_page_edited"!==t||n.table===le.vF}(t,e)))),[t]),d=l.map((e=>({key:e,render:t=>(0,N.jsx)(k.Z,{...t,checkState:n===e,title:o.formatMessage(me[e])}),action:()=>{null==s||s(e),i.close()}})));return(0,N.jsx)(Y.Z,{...r,children:(0,N.jsx)(X.Z,{initialFocus:0,sections:[{key:0,render:e=>(0,N.jsx)(P.Z,{enableActionSheetTitle:!0,...e}),items:d}],type:X.i.Vertical})})}function xe(e){const{automationContextStore:t,automationStore:n,contextItem:a,disabled:r}=e,l=(0,i.O7)(),d=(0,o.yK)((e=>({wrap:{display:"flex",alignItems:"center",padding:"4px 8px",borderRadius:4,marginBottom:4,fontSize:14},name:{marginRight:4}})),[]),c=(0,s.useCallback)((e=>{x.createAndCommit({userAction:"AssistantAutomationTrigger.handleNameChange",environment:l,perform:t=>{const s=n.getPropertiesStore().getKeyStore("assistant_context");x.applyOperation({store:s,operation:{pointer:s.pointer,command:"keyedObjectListUpdate",path:s.path,args:{value:{...a,name:e}}},transaction:t})}})}),[l,n,a]),u=(0,s.useCallback)((()=>{x.createAndCommit({userAction:"AssistantAutomationTrigger.handleRemoveClick",environment:l,perform:e=>{const t=n.getPropertiesStore().getKeyStore("assistant_context");x.applyOperation({store:t,operation:{pointer:t.pointer,command:"keyedObjectListRemove",path:t.path,args:{remove:{id:a.id}}},transaction:e})}})}),[l,n,a]);return(0,N.jsxs)(j.p,{allowSelectionWithin:!0,style:d.wrap,children:[(0,N.jsx)(S.b,{value:a.name,style:d.name,disabled:r,onChange:c}),(0,N.jsx)(ve,{automationStore:n,automationContextStore:t,contextItem:a,disabled:r}),(0,N.jsx)(w.Z,{ariaLabel:"remove",icon:ne.U,disabled:r,onClick:u})]})}function ve(e){const{automationStore:t,automationContextStore:n,contextItem:l,disabled:d}=e,c=(0,i.O7)(),u=(0,o.yK)((e=>({chevronIcon:{width:10,height:10,marginLeft:4,marginTop:2,fill:e.lightIconColor}})),[]),g=(0,a.VK)((()=>{if("collection_view_block"===l.type){if(!l.value)return;return H.G.createChildStore(n.context.parentRecordStore,l.value).getCollectionViewSourceCollectionStore()}if("page"===l.type){if(!l.value)return;return H.G.createChildStore(n.context.parentRecordStore,l.value)}(0,de.t1)(l)}),[l,n]),m=(0,a.VK)((()=>{if(g)return g instanceof H.NW?{type:"collection",collection:g.getSpaceShardedPointer()}:g instanceof H.G?{type:"page",page:g.getSpaceShardedPointer()}:void(0,de.t1)(g)}),[g]),h=(0,s.useCallback)(((e,s)=>{"collection"!==e.type&&"page"!==e.type||(x.createAndCommit({userAction:"ContextValuePicker.handleChange",environment:c,perform:s=>{const i=t.getPropertiesStore().getKeyStore("assistant_context");if("collection"===e.type){const t=H.NW.createChildStore(n.context.parentRecordStore,e.collection).getParentPointer();x.applyOperation({store:i,operation:{pointer:i.pointer,command:"keyedObjectListUpdate",path:i.path,args:{value:{...l,type:"collection_view_block",value:t}}},transaction:s})}else"page"===e.type?x.applyOperation({store:i,operation:{pointer:i.pointer,command:"keyedObjectListUpdate",path:i.path,args:{value:{...l,type:"page",value:e.page}}},transaction:s}):(0,de.t1)(e)}}),s.close())}),[t,n,l,c]);return(0,N.jsx)(r.ZP,{popupType:c.device.isMobile?r.Z4.SlideUp:r.Z4.Popup,renderOrigin:e=>(0,N.jsxs)(D.Z,{disabled:d,disabledFeedback:d,...e,children:[g?(0,N.jsx)(W.Z,{store:g}):(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Select a page or database",id:"ContextValuePicker.buttonPlaceholder"}),(0,K.i)(u.chevronIcon)]}),render:e=>(0,N.jsx)(O.L,{automationContextStore:n,onChange:t=>h(t,e),selectedTarget:m,skipVariables:!0,onClose:e.close})})}const Se=500,be=(0,p.defineMessages)({addIconButtonAriaLabel:{defaultMessage:"Add icon",id:"AssistantAutomationMenu.addIconAriaLabel"},inputPlaceholder:{defaultMessage:"New workflow",id:"AssistantAutomationMenu.placeholder"}});function Ce(e){const{automationStore:t,onClose:n,disabled:r,spaceId:l}=e,K=(0,i.O7)(),O=(0,p.useIntl)(),D=(0,o.yK)((e=>({header:{display:"flex",alignItems:"center",padding:"12px 12px 8px 12px",gap:6},scroller:{maxHeight:"75vh"},nameInputWrap:{flexGrow:"1"}})),[]),W=(0,a.VK)((()=>t.getNameStore()),[t]),H=(0,a.VK)((()=>t.getTrigger()),[t]),U=(0,a.VK)((()=>{var e;return Boolean(null===(e=t.getProperties())||void 0===e?void 0:e.assistant_auto_confirm)}),[t]),G=(0,a.VK)((()=>{const e=t.getSpaceId(),n=t.getParentPointer();if(e&&n)return{...n,spaceId:e}}),[t]),q=(0,a.VK)((()=>t.getIconStore()),[t]),$=(0,a.VK)((()=>(null==W?void 0:W.getValue())??""),[W]),Q=(0,a.VK)((()=>t.canEdit()),[t]),{maybePersistedTransactionActions:Y}=(0,C.$)({automationId:null==t?void 0:t.id,spaceId:l,defaultValue:void 0,persist:!0}),X=(0,a.VK)((()=>null==q?void 0:q.getValue()),[q]),J=(0,s.useMemo)((()=>{if(G)return new L.L({type:"assistant",persisted:!0,automationStore:t,intl:O,parentRecordStore:t,parentPointer:G})}),[t,O,G]),te=(0,s.useCallback)((e=>{(0,Z.ZP)({event:e,context:Z.Af.EditorClick,callback:()=>{y.ZH({debug:{userAction:"AssistantAutomationMenu.handleClick"},environment:K}),f.ZH({debug:{userAction:"AssistantAutomationMenu.handleClick"},environment:K})}})}),[K]),ne=(0,s.useCallback)(((e,n)=>{t&&x.createAndCommit({userAction:"AssistantAutomationMenu.updateProperty",environment:K,perform:s=>{h.sW({store:t.getPropertiesStore(),transaction:s,data:{[e]:n??null}})}})}),[t,K]),se=(0,s.useCallback)((e=>ne("icon",e)),[ne]),ie=(0,s.useCallback)((e=>ne("name",e)),[ne]),ae=(0,s.useCallback)((e=>{m.$(K,{originRect:e.currentTarget.getBoundingClientRect(),originGap:4,popupWidth:F.FZ,popupHeight:F.kX,isSmallWidth:!1,title:O.formatMessage({defaultMessage:"Icon",id:"AssistantAutomationMenu.button.iconHeading"}),currentTab:"icon",tabs:[{type:"icon",onChange:e=>{se(e),m.Z()}},{type:"emoji",onChange:(e,t)=>{se(e),m.Z()}}],onDelete:()=>{se(void 0),m.Z()}})}),[K,se,O]),oe=(0,s.useCallback)((()=>{ne("assistant_auto_confirm",!U)}),[ne,U]),re=(0,s.useCallback)((async()=>{await g.confirmUserAction({message:(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Are you sure you want to delete this workflow?",id:"AssistantAutomationMenu.delete.cancelConfirmation"}),acceptLabel:(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Delete",id:"AssistantAutomationMenu.delete.cancelConfirmation.delete"})})&&x.createAndCommit({userAction:"AssistantAutomationMenu.handleDelete",environment:K,perform:e=>{h.sW({store:t,transaction:e,data:{alive:!1}})}})}),[t,K]),le=(0,s.useCallback)((async()=>{await(0,E.Zq)({environment:K,automationStore:t})}),[t,K]),de=r||!Q;if(!J||!t)return null;const ce=e=>(0,N.jsx)(w.Z,{ariaLabel:O.formatMessage(be.addIconButtonAriaLabel),style:{width:26,height:26},iconStyle:{width:16,height:16},hasBackground:!0,disabled:de,showShadow:!0,icon:e=>X?(0,N.jsx)(T.Z,{disabled:!0,isEmptyPage:!1,size:20,icon:{icon:X,pointer:t.pointer},style:e}):(0,d.o)(e),...(0,V.Z)(e??{},{onClick:ae})}),ue=X?ce():(0,N.jsx)(_.Z,{renderTooltip:()=>(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Add an icon",id:"AssistantAutomationMenu.button.addIcon"}),delayThreshold:300,render:ce});return(0,N.jsx)("div",{onClick:te,children:(0,N.jsxs)(b.Z.Provider,{value:{automationContextStore:J,automationStore:t,disabled:!Q,editorPlacement:void 0,editorWidth:Se,suppressActionErrors:[],maybePersistedTransactionActions:Y},children:[(0,N.jsxs)(j.p,{allowSelectionWithin:!0,style:D.header,children:[ue,(0,N.jsx)(S.b,{onChange:ie,value:$,disabled:de,placeholder:O.formatMessage(be.inputPlaceholder),wrapStyle:D.nameInputWrap}),(0,N.jsx)(M.Z,{onClick:n,children:(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Done",id:"AssistantAutomationMenu.button.done"})})]}),(0,N.jsxs)(A.Z,{style:D.scroller,type:R.Z.Y,children:[(0,N.jsx)(P.Z,{children:(0,N.jsx)(k.Z,{left:(0,c.p)({width:16}),title:(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Test run",id:"AssistantAutomationMenu.testRun"}),focused:!1,onClick:le})}),(0,N.jsx)(P.Z,{title:(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Trigger",id:"AssistantAutomationMenu.trigger"}),children:(0,N.jsx)(he,{automationStore:t,disabled:de,automationContextStore:J})}),(0,N.jsx)(P.Z,{children:(0,N.jsx)("div",{style:{marginInline:12},children:(0,N.jsx)(v.GN,{isEditable:!0})})}),(0,N.jsxs)(P.Z,{children:[(0,N.jsx)(I.Z,{left:(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Owned by",id:"AssistantAutomationMenu.ownedBy"}),right:(0,N.jsx)(z,{automationStore:t,automationContextStore:J,disabled:r})}),"chat"!==(null==H?void 0:H.type)&&(0,N.jsx)(I.Z,{left:(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Run as user",id:"AssistantAutomationMenu.runAsUser"}),right:(0,N.jsx)(ee,{automationStore:t,disabled:r})}),(0,N.jsx)(k.Z,{title:(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Apply edits without confirmation",id:"AssistantAutomationMenu.autoConfirm"}),focused:!1,onClick:oe,right:(0,N.jsx)(B.Z,{on:U,onClick:oe})}),(0,N.jsx)(k.Z,{left:(0,u.y)({width:16}),title:(0,N.jsx)(p.FormattedMessage,{defaultMessage:"Delete",id:"AssistantAutomationMenu.delete"}),focused:!1,onClick:re})]})]})]})})}function je(e){const{automationStore:t,renderOrigin:n,buttonPopupStore:s,onClick:d}=e,c=(0,a.VK)((()=>{var e;return null===(e=l.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),u=(0,i.O7)(),p=(0,o.yK)((e=>({headerWrap:{display:"flex",alignItems:"center",margin:"0 4px"},editPopupWrap:{borderRadius:12,boxShadow:e.largeLightBoxShadow,width:Se,minHeight:400}})),[]);return(0,N.jsx)(r.ZP,{popupType:u.device.isMobile?r.Z4.SlideUp:r.Z4.Popup,preventScaleTransition:!0,preventOpacityTransition:!0,disableMouseCapture:!0,popupWrapStyle:p.editPopupWrap,renderOrigin:n,onClick:d,render:e=>t&&c&&(0,N.jsx)(Ce,{automationStore:t,onClose:e.close,disabled:!1,spaceId:c}),buttonPopupStore:s})}},784969:(e,t,n)=>{n.d(t,{m:()=>j});n(757658);var s=n(667294),i=n(126263),a=n(800480),o=n(886628),r=n(421202),l=n(76233),d=n(744805),c=n(653965),u=n(401898),p=n(215201),g=n(955217),m=n(162619),h=n(741195),f=n(206258),y=n(148588),x=n(365147),v=n(366076),S=n(567973),b=n(561144),C=n(785893);function j(e){const{clientStep:t,parentStore:n,isLatestStep:j,searchResultsSteps:k,sessionId:w}=e,I=(0,a.O7)(),M=(0,s.useMemo)((()=>new i.Z({name:"AssistantChatMessageListRenderer",isSyntheticAssistantData:!0,relatedAssistantSessionId:w})),[w]),T=(0,s.useMemo)((()=>(0,h.TS)({environment:I,table:r.iU,spaceId:n.pointer.spaceId})),[I,n.pointer.spaceId]),A=(0,o.qz)(void 0,S.d),P=e.citationHoverStore??A,B=(0,o.VK)((()=>c.jj(k.flatMap((e=>(0,v.us)({searchResultsStep:e,parentStore:n}))))),[n,k]),_=(0,x.RS)({environment:I,clientStep:t,citationOrdering:B,inMemoryRecordCache:M,listId:T}),F=(0,s.useMemo)((()=>e.wrapperRef??s.createRef()),[e.wrapperRef]);!function(e){const{containerRef:t,citationHoverStore:n,parentStore:i,searchResultsSteps:a}=e,{universalCitations:r}=(0,o.VK)((()=>(0,v.MD)({searchResultsSteps:a,clientStep:void 0,parentStore:i})),[i,a]),c=(0,o.VK)((()=>{const e=y.Z.state;if(!e||!t.current||!m.r3(t.current,e.token.node))return;const n=e.annotations.find(l.OU5);if(!n)return;const s=l.Vv0(n);if(void 0!==s.type&&"query_database_result"!==s.type&&"url"!==s.type&&"google-drive"!==s.type){if("slack"===s.type){const t=r.find((e=>e.href===s.href));return{type:"token",citationType:"universal_search",target:"slack",href:s.href,channel:null==t?void 0:t.channelName,text:null==t?void 0:t.text,lastEdited:null==t?void 0:t.lastEdited,messageId:s.messageId,node:e.token.node}}if("block"===s.type){const t=n?s.blockId:void 0;if(!t)return;const a=f.G.createChildStore(i,{table:"block",id:t}).getNavigableBlockStore();if(!a)return;return{type:"token",citationType:"notion",pageId:a.id,blockId:a.id===t?void 0:t,node:e.token.node}}(0,u.t1)(s.type)}}),[t,i,r]),p=(0,s.useRef)([]);(0,s.useEffect)((()=>{n.setState(c)}),[n,c]),(0,o.VK)((()=>{var e;for(const t of p.current)t.style.removeProperty("background-color");if(c)return;const s=[];if("list"===(null===(e=n.state)||void 0===e?void 0:e.type)&&t.current){let e;const i=n.state.citationType;if("notion"===i){e=`${(n.state.blockIds.length>0?n.state.blockIds:[n.state.pageId]).map((e=>`[${d.JQ}='${e}']`)).join(",")}`}else"universal_search"===i?e=`[${d.im}='${n.state.messageId}']`:(0,u.t1)(i);const a=t.current.querySelectorAll(e);for(const t of Array.from(a))t instanceof HTMLElement&&t&&(t.style.backgroundColor="#2383e2",s.push(t))}p.current=s}),[n,t,c]),(0,s.useEffect)((()=>()=>{for(const e of p.current)e.style.removeProperty("background-color")}),[])}({containerRef:F,citationHoverStore:P,parentStore:n,searchResultsSteps:k});const Z=(0,C.jsx)(p.O,{displayName:"AssistantChatStepContent",disabled:!0,children:(0,C.jsx)(g.Z,{store:_,disabled:!1,disableCommentMenu:!0,disableHoverMenu:!0,disableDrag:!0})});return e.disableWrap?(0,C.jsx)(C.Fragment,{children:Z}):(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(b.JC,{ref:F,clientStep:t,forceShowFeedback:j,children:Z})})}},22668:(e,t,n)=>{n.d(t,{H:()=>Re});n(867635);var s=n(667294),i=n(800480),a=n(886628),o=n(724405),r=n(403124),l=n(435840),d=n(23867),c=n(76233),u=n(709291),p=n(401898),g=n(137810),m=n(291839),h=n(776798),f=n(526388),y=n(32203),x=n(360682),v=n(157254),S=n(214976),b=n(825464),C=n(798180),j=n(206258),k=n(366076),w=n(56348),I=n(199672),M=n(80444),T=n(237074),A=n(96653),P=n(785893);function B(e){const{clientStep:t,parentStore:n}=e,s=(0,i.Fy)(),r=(0,o.yK)((e=>({wrap:{fontSize:s.isMobile?g.Z.fontSize.UIRegular.mobile:g.Z.fontSize.UIRegular.desktop,display:"flex",flexDirection:"column",gap:8}})),[s]),l=(0,a.VK)((()=>(0,T.getPageGroupForGroupedEditCard)(t)),[t]),d=(0,a.VK)((()=>{var e;return null===(e=M.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]);return d&&l?(0,P.jsx)("div",{style:r.wrap,children:(0,P.jsx)(A.E,{group:l,parentStore:n,parentSpaceId:d})}):null}var _=n(421202),F=n(836993),Z=n(514387),V=n(355863),R=n(573063),L=n(458281),E=n(682190);const K=(0,u.defineMessages)({undo:{id:"AssistantEditsAcceptedCard.undo",defaultMessage:"Undo"}});function O(e){const{pageId:t,message:n,parentStore:s,onUndo:i}=e,a=(0,o.yK)((e=>({wrap:{marginTop:12,marginBottom:12}})),[]),r=j.G.createChildStore(s,{table:_.iU,id:t});return(0,P.jsx)(L.Y,{style:a.wrap,children:(0,P.jsx)(E._C,{pageStore:r,showLocationIfNotCurrentPage:!1,detail:(0,P.jsx)(E.fT,{label:n}),rightSide:i?(0,P.jsx)(D,{onClick:i}):null})})}function D(e){const t=(0,u.useIntl)();return(0,P.jsx)(f.Z,{renderTooltip:()=>(0,P.jsx)(u.FormattedMessage,{...K.undo}),render:n=>(0,P.jsx)(R.Z,{ariaLabel:t.formatMessage(K.undo),icon:V.s,onClick:e.onClick,...n})},"expand")}var W=n(7493);function H(e){const{clientStep:t,parentStore:n}=e;return"accept"===t.action?(0,P.jsx)(z,{clientStep:t,parentStore:n}):"accept_page_delete"===t.action?(0,P.jsx)(G,{clientStep:t,parentStore:n}):"reject"===t.action?(0,P.jsx)(Q,{clientStep:t}):"insert"===t.action?(0,P.jsx)(X,{parentStore:n,clientStep:t}):"create_page"===t.action?(0,P.jsx)(J,{clientStep:t}):"reject_all"===t.action?(0,P.jsx)(ee,{clientStep:t,parentStore:n}):void(0,p.t1)(t)}function N(e){const{children:t}=e,n=(0,i.Fy)(),s=(0,o.yK)((e=>({stepContainer:{display:"flex",alignItems:"center",marginTop:4,marginBottom:4,justifyContent:"center"},step:{fontSize:n.isMobile?g.Z.fontSize.UISmall.mobile:g.Z.fontSize.UISmall.desktop,color:e.lightTextColor,display:"flex",alignItems:"center",gap:2,overflow:"hidden"}})),[n]);return(0,P.jsx)("div",{style:s.stepContainer,children:(0,P.jsx)("div",{style:s.step,children:t})})}function z(e){const{parentStore:t,clientStep:n}=e;return void 0===n.version?null:1===n.version?(0,P.jsx)(U,{parentStore:t,clientStep:n}):void(0,p.t1)(n)}function U(e){const{parentStore:t,clientStep:n}=e;return n.wasPageCreate?(0,P.jsx)(q,{parentStore:t,clientStep:n}):(0,P.jsx)($,{parentStore:t,clientStep:n})}function G(e){const{parentStore:t,clientStep:n}=e,{canUndo:s,handleUndo:i}=Y(n);return(0,P.jsx)(O,{parentStore:t,pageId:n.pageId,message:(0,P.jsx)(u.FormattedMessage,{id:"assistantChatHumanActionStep.acceptPageDelete.message",defaultMessage:"Page deleted"}),onUndo:s?i:void 0})}function q(e){const{parentStore:t,clientStep:n}=e,s=j.G.createChildStore(t,{table:_.iU,id:n.pageId});return(0,P.jsx)(W.d,{pageStore:s,shouldHighlightOpenPageButton:!1,truncatable:!0})}function $(e){const{parentStore:t,clientStep:n}=e,{canUndo:s,handleUndo:i}=Y(n);return(0,P.jsx)(O,{parentStore:t,pageId:n.pageId,message:(0,P.jsx)(u.FormattedMessage,{id:"assistantChatHumanActionStep.acceptEdits.numberOfEditsAccepted",defaultMessage:"{numberOfEdits, plural, one {1 edit accepted} other {{numberOfEdits} edits accepted}}",values:{numberOfEdits:n.numberOfEdits}}),onUndo:s?i:void 0})}function Q(e){const{clientStep:t}=e,{canUndo:n,renderUndo:s}=Y(t);return n?(0,P.jsx)(N,{children:(0,P.jsx)(u.FormattedMessage,{id:"assistantChatHumanActionStep.rejectedEdits.confirmationWithUndo",defaultMessage:"{numberOfEdits, plural, one {1 edit rejected} other {{numberOfEdits} edits rejected}}<undo>Undo</undo>",values:{numberOfEdits:t.numberOfEdits,undo:e=>s(e)}})}):(0,P.jsx)(N,{children:(0,P.jsx)(u.FormattedMessage,{id:"assistantChatHumanActionStep.rejectedEdits.confirmation",defaultMessage:"{numberOfEdits, plural, one {1 edit rejected} other {{numberOfEdits} edits rejected}}",values:{numberOfEdits:t.numberOfEdits}})})}function Y(e){const t=(0,i.O7)(),n=te(),o=(0,a.VK)((()=>(0,T.canUndoStepEdits)(e)),[e]),r=(0,s.useCallback)((()=>{(0,T.undoEditsForClientStep)({environment:t,clientStep:e})}),[e,t]);return{canUndo:o,renderUndo:(0,s.useCallback)((e=>(0,P.jsx)(Z.y,{isSmall:!0,style:n.undoButton,onClick:r,children:e})),[r,n]),handleUndo:r}}function X(e){const{clientStep:t,parentStore:n}=e,i=te(),a=j.G.createChildStore(n,{table:_.iU,id:t.pageId}),{canUndo:o,renderUndo:r}=Y(t),l=(0,s.useMemo)((()=>(0,P.jsx)(F.c,{pageStore:a,isSmall:!0,style:i.pageTitleButton})),[a,i]);return(0,P.jsx)(N,{children:o?(0,P.jsx)(u.FormattedMessage,{id:"assistantChatHumanActionStep.acceptedInserts.confirmationWithPageAndUndo",defaultMessage:"{numberOfEdits, plural, one {<growSpan><span>Added 1 block in{nbspThisIsASpacePleaseIgnore}</span>{page}</growSpan>} other {Added <growSpan><span>{numberOfEdits} blocks in{nbspThisIsASpacePleaseIgnore}</span>{page}</growSpan>}}{middotThisIsADivider}<undo>Undo</undo>",values:{nbspThisIsASpacePleaseIgnore:(0,P.jsx)("span",{children:""}),middotThisIsADivider:(0,P.jsx)("span",{children:""}),numberOfEdits:t.numberOfEdits,growSpan:e=>(0,P.jsx)("span",{style:i.growSpan,children:e}),span:e=>(0,P.jsx)("span",{style:i.noShrinkSpan,children:e}),undo:e=>r(e),page:l}}):(0,P.jsx)(u.FormattedMessage,{id:"assistantChatHumanActionStep.acceptedInserts.confirmationWithPage",defaultMessage:"{numberOfEdits, plural, one {<growSpan><span>Added 1 block in{nbspThisIsASpacePleaseIgnore}</span>{page}</growSpan>} other {Added <growSpan><span>{numberOfEdits} block in{nbspThisIsASpacePleaseIgnore}</span>{page}</growSpan>}}",values:{nbspThisIsASpacePleaseIgnore:(0,P.jsx)("span",{children:""}),numberOfEdits:t.numberOfEdits,growSpan:e=>(0,P.jsx)("span",{style:i.growSpan,children:e}),span:e=>(0,P.jsx)("span",{style:i.noShrinkSpan,children:e}),page:l}})})}function J(e){return(0,P.jsx)(N,{children:(0,P.jsx)(u.FormattedMessage,{id:"assistantChatHumanActionStep.createdPage.confirmation",defaultMessage:"1 page created"})})}function ee(e){const{clientStep:t,parentStore:n}=e,{canUndo:s,renderUndo:i,handleUndo:a}=Y(t);let o;return t.pageId?(0,P.jsx)(O,{parentStore:n,pageId:t.pageId,message:(0,P.jsx)(u.FormattedMessage,{id:"assistantChatHumanActionStep.rejectAll.confirmationNoPageTitle",defaultMessage:"{numberOfEdits, plural, one {Edit discarded} other {Edits discarded}}",values:{numberOfEdits:t.numberOfEdits}}),onUndo:s?a:void 0}):(o=s?(0,P.jsx)(u.FormattedMessage,{id:"assistantChatHumanActionStep.rejectAll.confirmationPageCreatedWithUndo",defaultMessage:"Page discarded<undo>Undo</undo>",values:{undo:e=>i(e)}}):(0,P.jsx)(u.FormattedMessage,{id:"assistantChatHumanActionStep.rejectAll.confirmationPageCreated",defaultMessage:"Page discarded"}),(0,P.jsx)(N,{children:o}))}function te(){return(0,o.yK)((e=>({pageTitleButton:{color:e.lightTextColor,fontWeight:g.Z.fontWeight.regular,flex:"1 1 auto"},undoButton:{color:e.lightTextColor},growSpan:{display:"flex",alignItems:"center",cursor:"default",flex:"1 1 auto",overflow:"hidden"},noShrinkSpan:{display:"flex",alignItems:"center",flexShrink:0,cursor:"default"}})),[])}var ne=n(784969),se=(n(21703),n(118466)),ie=n(126263),ae=n(646964),oe=n(800893),re=n(210228),le=n(484654),de=n(215201),ce=n(955217),ue=n(296994),pe=n(277907);function ge(e){const{clientStep:t}=e,n=(0,i.O7)(),{value:a}=(0,pe.XJ)(ue.FF.markdownLinkifyIt),o=(0,s.useMemo)((()=>a?se.Z.withListenerIgnored((()=>function(e){const{environment:t,clientStep:n,markdownLinkifyIt:s}=e,i=new ie.Z({name:"AssistantChatMessageListRenderer"}),a=re.createAndCommit({userAction:"AssistantChatMessageRenderer.temporaryListStore",environment:t,canUndo:!1,perform:e=>{const a=function(e){const{environment:t,clientStep:n,transaction:s,markdownLinkifyIt:i}=e,a=new ie.Z({name:"AssistantChatMessageRenderer",isSyntheticAssistantData:!0}),o=t.currentUser.id;if(!o)throw new Error("No current user.");const r=e=>{const s=oe.Mt({environment:t,text:(0,ae.rr)(n.text),transaction:e,inMemoryRecordCache:a,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:void 0,useCrdt:!1});if(!s)return[];for(const t of s)a.setModelAndRole({pointer:t.pointer,userId:o},t.getModel(),"reader");return s};if(a.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),s)return r(s);return re.createAndCommit({userAction:"AssistantChatMessageRenderer.temporaryListStore",environment:t,perform:r,canUndo:!1}).performResult}({environment:t,clientStep:n,transaction:e,markdownLinkifyIt:s});return le.wrapTemporaryBlocksInList({environment:t,stores:a,inMemoryRecordCache:i,transaction:e})}}).performResult;return a}({environment:n,clientStep:t,markdownLinkifyIt:a}))):void 0),[t,n,a]);return(0,P.jsx)(de.O,{displayName:"AssistantChatStepContent",disabled:!0,children:o?(0,P.jsx)(ce.Z,{store:o,disabled:!0,disableCommentMenu:!0,disableHoverMenu:!0,disableDrag:!0}):null})}var me=n(561144),he=n(842875),fe=n(731278),ye=n(646735),xe=n(2405);function ve(e){const{clientStep:t,parentStore:n}=e,s=(0,i.O7)(),o=(0,u.useIntl)(),{options:r}=(0,a.VK)((()=>{let e=[];if("options"===t.displayType)e=t.options.map((e=>j.t1.createChildStore(n,e)));else{const t=s.currentUser.id;e=ye.Z.getVisitedIds(t).map((e=>j.G.createChildStore(n,{table:"block",id:e})))}return{options:e.map((e=>e.getModel())).filter(p.$K).map((e=>{if("block"===e.table){const t=e.getRenderTitle({getRecordModel:n.getRecordModel,intl:o,userTimeZone:(0,he.r)()}),s=e.getRenderIcon({getRecordModel:n.getRecordModel});return(0,P.jsx)(xe.Z,{style:{whiteSpace:"nowrap",flexGrow:0},onClick:()=>{},icon:e=>(0,P.jsx)(fe.Z,{style:e,icon:s,title:t,isEmptyPage:!1,size:14,disabled:!0}),title:t},`action__${e.id}`)}return"collection"===e.table||"notion_user"===e.table?(0,P.jsx)("div",{},e.id):void(0,p.t1)(e)}))}}),[t,s.currentUser.id,o,n]);return(0,P.jsx)(P.Fragment,{children:(0,P.jsxs)("div",{style:{display:"grid",gridTemplateRows:"1fr 1fr",gap:"4px",overflow:"auto"},children:[(0,P.jsx)("div",{style:{display:"flex",gap:"4px"},children:r.slice(0,(r.length-1)/2)}),(0,P.jsx)("div",{style:{display:"flex",gap:"4px"},children:r.slice((r.length-1)/2)})]})})}var Se=n(226009),be=n(665422),Ce=n(128495),je=n(11751);function ke(e){var t;const{clientStep:n}=e,s=(0,o.yK)((e=>({header:{display:"flex",alignItems:"center",marginTop:4,marginBottom:4,color:e.aiPurpleColor},headerIcon:{width:10,fill:e.aiPurpleColor,marginRight:4},name:{display:"flex",alignItems:"center",fontWeight:500,marginBottom:4},description:{display:"flex",alignItems:"center",marginBottom:8},triggersHeader:{display:"flex",alignItems:"center",marginBottom:4,color:e.mediumTextColor},trigger:{display:"flex",alignItems:"center",marginBottom:4,background:"rgba(0,0,0,0.03)",padding:4,borderRadius:8},stepsHeader:{display:"flex",alignItems:"center",marginBottom:4,color:e.mediumTextColor},step:{display:"flex",alignItems:"center",marginBottom:4,background:"rgba(0,0,0,0.03)",padding:4,borderRadius:8},pageUpdatedTriggerIcon:{width:14,marginRight:6,marginLeft:4},codeStepIcon:{width:14,marginRight:6,marginLeft:4},aiStepIcon:{width:14,marginRight:6,marginLeft:4},humanStepIcon:{width:14,marginRight:6,marginLeft:4}})),[]);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)("div",{style:s.header,children:[(0,be.K)(s.headerIcon),(0,P.jsx)(u.FormattedMessage,{id:"AssistantWorkflowRenderer.header",defaultMessage:"Workflow"})]}),(0,P.jsx)("div",{style:s.name,children:n.automation.name}),(0,P.jsx)("div",{style:s.description,children:n.automation.description}),(0,P.jsx)("div",{style:s.stepsHeader,children:(0,P.jsx)(u.FormattedMessage,{id:"AssistantWorkflowRenderer.stepsHeader",defaultMessage:"Steps"})}),null===(t=n.automation.steps)||void 0===t?void 0:t.map(((e,t)=>"code"===e.type?(0,P.jsxs)("div",{style:s.step,children:[(0,r._)(s.codeStepIcon),e.description]},t):"prompt"===e.type?(0,P.jsxs)("div",{style:s.step,children:[(0,je.t)(s.aiStepIcon),e.description]},t):"human"===e.type?(0,P.jsxs)("div",{style:s.step,children:[(0,Ce.v)(s.humanStepIcon),e.description]},t):void(0,p.t1)(e.type)))]})}var we=n(433463),Ie=n(988891),Me=n(653965),Te=n(307032),Ae=n(661519),Pe=n(584076),Be=n(173435);function _e(e){const{clientStep:t}=e,n=(0,we.rn)(t.operations.map((e=>({...e,operations:[],id:(0,Ie.Sl)(Te._6),inferenceId:void 0})))),i=(0,o.yK)((e=>({divider:{marginTop:6,marginBottom:6},subheader:{color:e.mediumTextColor}})),[]);return(0,P.jsx)(P.Fragment,{children:n.map(((e,t)=>(0,P.jsxs)(s.Fragment,{children:[(0,P.jsx)(Fe,{group:e},t),n[t+1]&&(0,P.jsx)(Ae.Z,{style:i.divider,size:1})]},t)))})}function Fe(e){const{group:t}=e,n=(0,o.yK)((e=>({header:{marginTop:4,marginBottom:6,color:e.mediumTextColor},pageTitle:{display:"inline",color:e.regularTextColor,fontWeight:g.Z.fontWeight.semibold,whiteSpace:void 0,overflow:void 0,textOverflow:void 0,textDecoration:"underline"},divider:{marginBottom:6},subheader:{color:e.mediumTextColor,marginBottom:4}})),[]),s=(0,a.VK)((()=>M.default.state.mainEditorCurrentBlockStore),[]),i=(0,a.VK)((()=>M.default.state.currentSpaceStore),[]),r=s||i;if(!i)throw new Error("No current space store");if(!r)throw new Error("No parent store");const l=(null==s?void 0:s.id)!==t.pageId,d=i.id,c=j.G.createChildStore(r,{table:_.iU,id:t.pageId,spaceId:d}),m=(0,Be.Dc)(c),f=(0,a.VK)((()=>{if("updatedPage"!==t.type)return[];const e=c.getAssociatedCollectionStore(),n=null==e?void 0:e.getSchema();return Me.oA(Array.from(t.updatedPropertyNames).map((e=>{const t=Object.entries(n||{}).find((t=>{let[,n]=t;return(null==n?void 0:n.name)===e}));if(t)return t[0]})))}),[c,t]);if("updatedPage"===t.type){const{insertedBlockIds:e,updatedBlockIds:s,removedBlockIds:i,updatedTitle:a}=t,o=(0,we.$i)(t);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Pe.Z,{style:n.header,href:m,children:(0,P.jsx)("span",{children:t.didCreatePage?(0,P.jsx)(u.FormattedMessage,{defaultMessage:"Created {page}",id:"assistant.transactionRenderer.createdPage.title",values:{page:(0,P.jsx)(h.Z,{store:c,style:n.pageTitle})}}):(0,P.jsx)(u.FormattedMessage,{defaultMessage:"{numEdits, plural, one {1 edit to {page}} other {{numEdits} edits to {page}}}",id:"assistant.transactionRenderer.editedPage.title",values:{numEdits:o,page:(0,P.jsx)(h.Z,{store:c,style:n.pageTitle})}})})}),a&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{style:n.subheader,children:"Updated title"}),l&&(0,P.jsx)(Be.GD,{spaceId:d,blockIds:[t.pageId],parentStore:r,shouldReverse:!0})]}),f.length>0&&(0,P.jsxs)(P.Fragment,{children:[`Updated ${f.length} ${f.length>1?"properties":"property"}`,l&&f.map(((e,t)=>(0,P.jsx)(Be.Z9,{pageStore:c,property:e},t)))]}),e.size>0&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{style:n.subheader,children:`Inserted ${e.size} block${e.size>1?"s":""}`}),l&&(0,P.jsx)(Be.GD,{spaceId:d,blockIds:Array.from(e),parentStore:r,shouldReverse:!0})]}),s.size>0&&(0,P.jsx)(P.Fragment,{children:(0,P.jsxs)("div",{style:n.subheader,children:[`Updated ${s.size} block${s.size>1?"s":""}`,l&&(0,P.jsx)(Be.GD,{spaceId:d,blockIds:Array.from(s),parentStore:r,shouldReverse:!0})]})}),i.size>0&&(0,P.jsx)(P.Fragment,{children:(0,P.jsxs)("div",{style:n.subheader,children:[`Removed ${i.size} block${i.size>1?"s":""}`,l&&(0,P.jsx)(Be.GD,{spaceId:d,blockIds:Array.from(i),parentStore:r,shouldReverse:!0})]})})]})}if("removedPage"===t.type)return(0,P.jsx)(Pe.Z,{style:n.header,href:m,children:(0,P.jsx)("span",{children:(0,P.jsx)(u.FormattedMessage,{defaultMessage:"Deleted {page}",id:"assistant.transactionRenderer.removedPage.title",values:{page:(0,P.jsx)("span",{style:{fontWeight:g.Z.fontWeight.bold},children:(0,P.jsx)(h.Z,{store:c,style:n.pageTitle})})}})})});(0,p.t1)(t)}var Ze=n(55762);function Ve(e){const{searchScope:t}=e,n=(0,u.useIntl)(),s=(0,i.Fy)(),r=(0,a.VK)((()=>M.default.state.currentSpaceStore),[]),l=(0,a.VK)((()=>{if(r)return(0,Ze.UD)({searchScope:t,currentSpaceStore:r,intl:n,showEverythingLabel:!0})}),[r,n,t]),d=(0,o.yK)((e=>({wrapper:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexGrow:1,color:e.lightTextColor,fontSize:s.isMobile?g.Z.fontSize.UISmall.mobile:g.Z.fontSize.UISmall.desktop,fontWeight:g.Z.fontWeight.medium}})),[s.isMobile]);return(0,P.jsx)("div",{style:d.wrapper,children:(0,P.jsx)(u.FormattedMessage,{id:"assistant.chat.scopeChangeBadge",defaultMessage:"Finding in {scopeTitle}",values:{scopeTitle:l}})})}function Re(e){const{clientStep:t,parentStore:n,parentSpaceId:y,latestStepCitationHoverStore:M,mockTextStore:T,wrapperRef:A}=e,_=(0,i.O7)(),F=(0,o.Fg)(),Z=(0,a.VK)((()=>{const e=C.default.getActiveSession(),t=(null==e?void 0:e.getCombinedSteps())??[],n=t.findLast((e=>"human"===e.type));if(!n)return;const s=t.indexOf(n);return t.slice(s-1).find((e=>"assistantSearch"===e.type||"assistantLoadPage"===e.type))}),[]),V=(0,a.VK)(w.Hf,[]),{isCurrentClientStepLatestStep:R,searchResultsSteps:L}=(0,a.VK)((()=>{const e=C.default.getActiveSession(),n=(null==e?void 0:e.getCombinedSteps())??[],s=n.indexOf(t),i=(0,I.WY)(n.slice(0,s));return{isCurrentClientStepLatestStep:s>=0&&s===n.length-1,searchResultsSteps:i}}),[t]),E=(0,a.VK)((()=>{var e;return null===(e=C.default.getActiveSession())||void 0===e?void 0:e.sessionId}),[]),K=(0,a.VK)((()=>{if("human"===t.type)return[{key:t.type,element:(0,P.jsx)(f.Z,{placement:b.u.Left,renderTooltip:()=>(0,P.jsx)(Le,{text:(0,c.Jcv)(t.text)}),delayThreshold:0,disableTooltip:!V,render:e=>(0,P.jsx)("div",{...e,style:{wordBreak:"break-word"},children:(0,S.IY)({environment:_,textValue:{value:t.text,spaceId:(0,d.C)(y)},parentStore:n,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disabled:!0,theme:F,emojiType:(0,x.e_)(_),katex:_.KatexStore.getKatex(),formulaValueTypes:[]})})})}];if("groupedEditCard"===t.type)return[{key:t.inferenceId,element:(0,P.jsx)(B,{clientStep:t,parentStore:n}),doNotWrap:!0}];if("assistantLoading"===t.type)return[{key:t.inferenceId,element:(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center",whiteSpace:"pre"},children:["assistantSearch"===(null==Z?void 0:Z.type)?(0,P.jsx)(u.FormattedMessage,{id:"AssistantChatStep.searching",defaultMessage:"Searching {icon} {keywords}",description:"Placeholder text while the AI is searching. The icon is a magnifying glass.",values:{icon:(0,l.R)({width:12,height:12}),keywords:(0,P.jsx)("span",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",maxWidth:"70%",textTransform:"lowercase",whiteSpace:"nowrap"},children:Z.query.questionIntl??Z.query.keywords})},children:function(e){return(0,P.jsx)(P.Fragment,{children:e.map(((e,t)=>"string"==typeof e?(0,P.jsx)("span",{children:e},t):e))})}}):(0,P.jsxs)(P.Fragment,{children:[t.message?(0,P.jsx)("div",{style:{maxWidth:"min(calc(100%), 512px)"},children:(0,P.jsx)("div",{style:{flex:"1 1 auto",...g.Z.textOverflowStyle},children:t.message})}):(0,P.jsx)(u.FormattedMessage,{...Se.K.thinking})," "]}),(0,P.jsx)("div",{style:{marginLeft:4},children:(0,P.jsx)(m.Z,{isTriColored:!0})})]})}];if("assistantChatText"===t.type)return(0,v.S)(t)?[{key:t.inferenceId,element:null,doNotWrap:!0}]:[{key:t.inferenceId,element:(0,P.jsx)(ge,{clientStep:t})}];if("assistantChat"===t.type){if((0,v.S)(t))return[{key:t.inferenceId,element:null,doNotWrap:!0}];const e=(0,k.oc)({clientStep:t}),s=(0,P.jsx)(ne.m,{wrapperRef:A,clientStep:t,parentStore:n,isLatestStep:R,searchResultsSteps:L,citationHoverStore:R?M:void 0,sessionId:E});return[{key:t.inferenceId,element:V?(0,P.jsx)(f.Z,{placement:b.u.Left,renderTooltip:()=>(0,P.jsx)(Le,{text:e}),delayThreshold:0,render:e=>(0,P.jsx)("div",{...e,children:s})}):s,doNotWrap:!0}]}return"assistantTransaction"===t.type?[{key:t.inferenceId,element:(0,P.jsx)(_e,{clientStep:t})}]:"assistantSearch"===t.type?[{key:t.inferenceId,element:(0,P.jsx)(f.Z,{placement:b.u.Left,renderTooltip:()=>(0,P.jsx)("div",{style:{whiteSpace:"pre",fontFamily:"monospace"},children:JSON.stringify(t.query,null,2)}),delayThreshold:0,render:e=>(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center"},...e,children:[(0,r._)({width:16,marginRight:4,marginTop:4}),`Search ${t.query.question}`]})})}]:"assistantLoadPage"===t.type?[{key:t.inferenceId,element:(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,r._)({width:16,marginRight:4,marginTop:4}),(0,P.jsx)("span",{style:{whiteSpace:"nowrap"},children:"Load page"}),(0,P.jsx)(h.Z,{style:{marginLeft:6},store:j.G.createChildStore(n,t.pointer)})]})}]:"assistantSearchPeople"===t.type?[{key:t.inferenceId,element:(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,r._)({width:16,marginRight:4,marginTop:4}),`Search people ${t.search}`]})}]:"assistantSearchDatabases"===t.type?[{key:t.inferenceId,element:(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,r._)({width:16,marginRight:4,marginTop:4}),`Search databases ${t.searchQuery}`]})}]:"queryDatabase"===t.type?[{key:t.inferenceId,element:(0,P.jsx)(f.Z,{placement:b.u.Left,renderTooltip:()=>(0,P.jsx)("div",{style:{whiteSpace:"pre",fontFamily:"monospace"},children:JSON.stringify(t.query,null,2)}),delayThreshold:0,render:e=>(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center"},...e,children:[(0,r._)({width:16,marginRight:4,marginTop:4}),"Query database",(0,P.jsx)(h.Z,{style:{marginLeft:6},store:j.NW.createChildStore(n,t.collectionPointer)})]})})}]:"assistantQueryingDatabase"===t.type?[{key:t.inferenceId,element:(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,r._)({width:16,marginRight:4,marginTop:4}),(0,P.jsx)("span",{style:{whiteSpace:"nowrap"},children:"Querying database"}),(0,P.jsx)(h.Z,{style:{marginLeft:6},store:j.NW.createChildStore(n,t.collectionPointer)})]})}]:"assistantShowSearchResults"===t.type?[{key:t.inferenceId,element:null,doNotWrap:!0}]:"assistantLimitReached"===t.type?[{key:t.inferenceId,element:(0,P.jsx)(P.Fragment,{children:t.message})}]:"assistantCreateAutomation"===t.type?[{key:t.inferenceId,element:(0,P.jsx)(ke,{clientStep:t})}]:"assistantLoadDatabase"===t.type?[{key:t.inferenceId,element:(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,r._)({width:16,marginRight:4,marginTop:4}),(0,P.jsx)("span",{style:{whiteSpace:"nowrap"},children:"Load database"}),(0,P.jsx)("div",{style:{marginLeft:6},children:(0,P.jsx)(h.Z,{store:j.NW.createChildStore(n,t.pointer)})})]})}]:"humanAction"===t.type?[{key:`${t.type}_confirmation_step_${t.inferenceId}`,element:(0,P.jsx)(H,{clientStep:t,parentStore:n}),doNotWrap:!0}]:"assistantRetry"===t.type?[{key:t.type,element:null,doNotWrap:!0}]:"assistantSelectEntity"===t.type?[{key:t.inferenceId,element:(0,P.jsx)(ve,{clientStep:t,parentStore:n,mockTextStore:T})}]:"assistantScopeChange"===t.type?[{key:t.inferenceId,element:(0,P.jsx)(Ve,{searchScope:t.scope})}]:void(0,p.t1)(t)}),[_,F,t,V,y,n,Z,R,L,M,E,T,A]);return(0,P.jsx)(P.Fragment,{children:K.map(((e,n)=>{const i=`${e.key}_${n}`;return e.doNotWrap?(0,P.jsx)(s.Fragment,{children:e.element},i):(0,P.jsx)(me.JC,{ref:A,clientStep:t,forceShowFeedback:R,children:e.element},i)}))})}function Le(e){const{text:t}=e,{getTranslationForString:n}=(0,y.mT)({getTranslatableStrings:(0,s.useCallback)((()=>[t]),[t])});return(0,P.jsx)("div",{style:{whiteSpace:"pre-wrap",fontFamily:"monospace",maxWidth:500,height:"auto",overflowWrap:"break-word"},children:n(t)??"Loading..."})}},561144:(e,t,n)=>{n.d(t,{JC:()=>C,Ol:()=>v,iI:()=>w,jk:()=>b});var s=n(667294),i=n(800480),a=n(706740),o=n(886628),r=n(724405),l=n(875553),d=n(709291),c=n(653965),u=n(573063),p=n(526388),g=(n(95477),n(319124)),m=n(825464),h=n(198008),f=n(794562),y=n(6249),x=n(785893);const v="min(calc(100% - 48px), 512px)",S="100%",b=6,C=(0,s.forwardRef)((function(e,t){const{children:n,clientStep:r}=e,l=(0,i.O7)().device.isMobile,[d,u]=(0,s.useState)(!1),[h,f]=(0,s.useState)(!1),y=(0,s.useMemo)((()=>(0,c.Ds)(f,100)),[f]),v=(0,s.useMemo)((()=>"assistantChat"===(null==r?void 0:r.type)?"assistant":"human"===(null==r?void 0:r.type)||"humanAction"===(null==r?void 0:r.type)?"human":"assistantScopeChange"===(null==r?void 0:r.type)?"context":"assistantLoading"===(null==r?void 0:r.type)||"assistantShowSearchResults"===(null==r?void 0:r.type)?"loading":void 0),[null==r?void 0:r.type]),S=w({hovered:d,isAssistantChat:"assistant"===v}),b=(0,o.VK)((()=>(0,g.Gw)()),[]);return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(p.Z,{placement:m.u.Left,textWrap:!0,style:{maxWidth:240},disableTooltip:!r||!("thought"in r&&r.thought)||!0,renderTooltip:()=>r&&"thought"in r?` ${r.thought}`:void 0,delayThreshold:500,render:e=>(0,x.jsxs)("div",{ref:t,style:S.wrap,...l?{tabIndex:0}:{},...e,onFocus:t=>{var n;null===(n=e.onFocus)||void 0===n||n.call(e,t),(0,a.E)(t.target)&&(u(!0),y(!0))},onMouseEnter:t=>{var n;null===(n=e.onMouseEnter)||void 0===n||n.call(e,t),l||(u(!0),y(!0))},onBlur:t=>{var n;null===(n=e.onBlur)||void 0===n||n.call(e,t),u(!1),y(!1)},onMouseLeave:t=>{var n;null===(n=e.onMouseLeave)||void 0===n||n.call(e,t),l||(u(!1),y(!1))},onClick:e=>{l&&(u(!d),y(!d))},children:["human"===v&&(0,x.jsx)("div",{style:{flexGrow:1}}),(0,x.jsxs)("div",{style:{...S.baseMessage,..."human"===v?S.humanMessage:{},..."loading"===v?S.assistantLoadingMessage:{},..."assistant"===v?S.assistantMessage:{},..."context"===v?S.contextMessage:{}},children:[n,("assistantChat"===(null==r?void 0:r.type)||"assistantTransaction"===(null==r?void 0:r.type))&&(0,x.jsx)(k,{clientStep:r,isLabelerMode:b,isVisible:d&&h})]})]})})})})),j=(0,d.defineMessages)({copyButton:{id:"assistant.chat.actions.copyButton.label",defaultMessage:"Copy"}});function k(e){const{clientStep:t,isLabelerMode:n,isVisible:s}=e,a=(0,i.O7)(),o=(0,r.yK)((e=>({container:{display:"flex",boxShadow:e.lightBoxShadow,position:"absolute",flexShrink:0,backgroundColor:e.buttonGroupBackground,maxHeight:28,top:-16,right:6,gap:1,borderRadius:6,padding:2,transition:"opacity 100ms ease-out",zIndex:1e5,opacity:s?1:0}})),[s]);return(0,x.jsxs)("div",{style:o.container,children:[!n&&(0,x.jsx)(y.xW,{isVisible:!0,clientStep:t,showTooltips:!0}),"assistantChat"===t.type&&(0,x.jsx)(p.Z,{renderTooltip:()=>(0,x.jsx)(d.FormattedMessage,{...j.copyButton}),render:e=>(0,x.jsx)(u.Z,{ariaLabel:"copy",icon:l.U,onClick:()=>{(0,h.p)({environment:a,clientStep:t})},...e})})]})}function w(e){const{hovered:t,isAssistantChat:n}=e,s=(0,f.u)();return(0,r.yK)((e=>({wrap:{display:"flex",marginTop:b,marginBottom:b,gap:6},baseMessage:{maxWidth:S,borderRadius:16,padding:"4px 12px",fontSize:s.chatBodyTextSize,whiteSpace:"pre-wrap",overflowWrap:"break-word",position:"relative",lineHeight:1.45},userLabel:{fontSize:s.smallTextSize,color:e.mediumTextColor},humanMessage:{backgroundColor:"light"===e.mode?e.cardHoveredBackground:e.accentColors.translucentGray[100],color:e.darkTextColor,padding:"6px 14px",border:"unset",marginLeft:80},assistantLoadingMessage:{fontSize:s.smallTextSize,color:e.text.secondary,fontWeight:500,padding:"4px 0 0 4px"},assistantMessage:{fontWeight:500,color:"light"===e.mode?e.accentColors.gray[700]:e.accentColors.translucentGray[700],backgroundColor:t&&n?"light"===e.mode?e.cardHoveredBackground:e.accentColors.translucentGray[100]:void 0,padding:"2px 6px",maxWidth:"calc(100% + 8px)",minWidth:"80px",marginLeft:-4,transition:"background-color 100ms ease-out"},contextMessage:{flexGrow:1}})),[s,t,n])}},207879:(e,t,n)=>{n.d(t,{o:()=>M,t:()=>I});var s=n(667294),i=n(800480),a=n(886628),o=n(724405),r=n(559054),l=n(542853),d=n(11751),c=n(908542),u=n(709291),p=n(137810),g=n(489728),m=n(731278),h=n(510102),f=n(80444),y=n(521273),x=n(798180),v=n(206258),S=n(252193),b=n(484681),C=n(548809),j=n(158449),k=n(785893);const w=(0,u.defineMessages)({assistantNewChatTitle:{id:"assistantMenu.header.newChat.label",defaultMessage:"New chat"},qnaNewChatTitle:{id:"assistantMenu.header.askNotionAI.label",defaultMessage:"Ask AI"}});function I(e){const{chatSessionId:t,chatStore:n}=e,i=(0,u.useIntl)(),o=function(e){const{chatStore:t,chatSessionId:n}=e,i=(0,u.useIntl)(),[{value:o}]=(0,r.r5)((async()=>{if(t)return await(0,C.YO)(t)}),[t]),l=(0,s.useMemo)((()=>{if(!o)return;const e=(0,S.findClientSkillFromTranscriptIfExists)(o.serializedTranscriptSteps);return e?i.formatMessage(e.clientSkill.displayName):void 0}),[i,o]);return(0,a.VK)((()=>{var e;const t=n&&(null===(e=x.default.getSessionContext(n))||void 0===e?void 0:e.selectedSkill);return t?i.formatMessage(t.clientSkill.displayName):l}),[n,i,l])}({chatStore:n,chatSessionId:t});return(0,a.VK)((()=>{const e=null==n?void 0:n.getTitleOrFallback({intl:i,fallback:o});return o||(e||(y.Z.showAssistantNotionAiCopy()?i.formatMessage(w.assistantNewChatTitle):i.formatMessage(w.qnaNewChatTitle)))}),[n,o,i])}function M(){const e=(0,i.O7)(),{isMobile:t}=(0,i.Fy)(),n=(0,a.VK)((()=>f.default.state.currentSpaceStore),[]),r=(0,a.VK)((()=>y.Z.showAssistantNotionAiCopy()),[]),u=(0,a.VK)((()=>x.default.getActiveSessionId()),[]),S=(0,a.VK)((()=>{if(!n)return;const e=j.Z.getSessionsForSpace(n.id).find((e=>e.id===u));return e?v.uj.createChildStore(n,{id:e.id,table:c.t_,spaceId:n.id}):void 0}),[n,u]),C=(0,a.VK)((()=>null==S?void 0:S.getImageIfExists()),[S]),w=I({chatSessionId:u,chatStore:S}),M=(0,h.Io)(),T=s.useMemo((()=>!!u&&M.shouldShowChatHistory),[M,u]),A=s.useCallback((()=>{(0,b.switchToChatHistory)({environment:e,currentSessionId:u,from:M.type})}),[e,u,M]),P=function(){const{isMobile:e}=(0,i.Fy)();return(0,o.yK)((t=>({headerContainer:{display:"flex",gap:4,alignItems:"center",flexShrink:1},headerSparkles:{width:e?18:16,height:e?18:16,marginRight:e?4:6,color:t.regularIconColor,marginTop:e?"-2px":void 0,flexShrink:0},headerLabel:{fontSize:e?15:13,color:t.regularTextColor,fontWeight:p.Z.fontWeight.medium,...p.Z.textOverflowStyle},chevronIcon:{width:e?12:9,height:e?12:9,color:t.lightIconColor,flexShrink:0},icon:{borderRadius:"100%",marginRight:e?4:2,marginTop:e?"-2px":void 0,flexShrink:0}})),[e])}();return u?(0,k.jsxs)(g.Z,{style:P.headerContainer,onClick:A,disabled:!T,children:[C?(0,k.jsx)(m.Z,{disabled:!0,isEmptyPage:!1,icon:C,size:t?18:16,style:P.icon}):r?null:(0,d.t)(P.headerSparkles),(0,k.jsx)("div",{style:P.headerLabel,children:w}),T&&(0,l.i)(P.chevronIcon)]}):(0,k.jsx)(k.Fragment,{})}},351594:(e,t,n)=>{n.d(t,{G:()=>ge});var s=n(667294),i=n(800480),a=n(886628),o=n(724405),r=n(875553),l=n(950780),d=n(561061),c=n(844495),u=n(760493),p=n(479198),g=n(301763),m=n(745238),h=n(785893);const f=(0,m.IU)("tagFilled",{viewBox:"0 0 17 17",svg:(0,h.jsx)("path",{d:"M9.49219 15.4951C8.47363 16.5205 7.40039 16.5273 6.36133 15.4883L2 11.1406C0.960938 10.1084 0.981445 9.02148 1.99316 8.00977L8.70605 1.31055C9.23926 0.777344 9.54688 0.71582 10.3193 0.71582H12.917C13.6689 0.71582 13.9219 0.900391 14.4756 1.44727L16.041 3.0127C16.5947 3.56641 16.7725 3.81934 16.7725 4.57129V7.16895C16.7725 7.94141 16.7178 8.25586 16.1846 8.78906L9.49219 15.4951Z"})});var y=n(709291),x=n(164964),v=n(824615),S=(n(757658),n(782801),n(313991)),b=n(491574),C=n(465993),j=n(407057),k=n(80721),w=n(605257),I=n(653965),M=n(940470),T=n(401898),A=n(800893),P=n(252193),B=n(460709),_=n(98742),F=n(825464),Z=n(798180),V=n(552275),R=n(573063),L=n(478140),E=n(632163),K=n(672495),O=n(526388);const D="general_assistant";function W(e){const{buttonPopupParent:t}=e,n=(0,y.useIntl)(),o=(0,i.O7)(),[r,l]=(0,s.useState)(void 0),d=(0,a.VK)((()=>function(e){const t=[];for(const[i,a]of(0,T.qP)(Z.default.state.sessions)){var n,s;if(!a)continue;const o=null===(n=a.assistantConfigurationStore.state)||void 0===n?void 0:n.sessionStartTimestamp,r=M.x.unwrapOr((0,b.$d)({intl:e,steps:I.oA([...a.evaluator.getTranscript(),a.previewingStep])}),void 0);t.push({sessionId:i.toString(),skillType:null==a||null===(s=a.selectedSkill)||void 0===s?void 0:s.clientSkill.skillType,timestamp:void 0!==o?(0,j.$b)(o,S.SP,e):void 0,humanMessage:r})}return t}(n)),[n]),c=(0,s.useCallback)((()=>{const e=H(null==r?void 0:r.sessionId),t=(null==e?void 0:e.getTranscript())??[],n=N(null==r?void 0:r.sessionId);n&&t.push(n);const s=JSON.stringify(t);A.RD({environment:o,stringValue:s,copiedMessage:A.tq.copiedToClipboard})}),[r,o]),u=(0,s.useCallback)((()=>{const e=H(null==r?void 0:r.sessionId),t=N(null==r?void 0:r.sessionId),n=null==e?void 0:e.getInferenceInputForEval({skipLastAssistantStep:!0,appendPreviewingStepForDebug:t}),s=JSON.stringify(n);A.RD({environment:o,stringValue:s,copiedMessage:A.tq.copiedToClipboard})}),[r,o]),p=(0,s.useCallback)((()=>{var e;const t=H(null==r?void 0:r.sessionId),n=N(null==r?void 0:r.sessionId),s=null==t?void 0:t.getInferenceInputForEval({skipLastAssistantStep:!1,appendPreviewingStepForDebug:n}),i=(r&&(null===(e=Z.default.getSessionContext(r.sessionId))||void 0===e?void 0:e.getCombinedSteps()))??[],a=JSON.stringify({...s,clientSteps:i.map((e=>(0,C.Rd)({step:e})))}),o=btoa(encodeURIComponent(a));window.open(`/design/aiJsonRenderer#jsonl=${o}`,"_blank")}),[r]),g=(0,s.useCallback)((()=>{if(void 0===(null==r?void 0:r.sessionId))return;const e=Z.default.getSessionContextOrThrow(null==r?void 0:r.sessionId),t=e.latestCommitInferenceId;(0,P.saveFeedback)({environment:o,inferenceId:t,type:"assistant_thumbs_down",sessionId:e.sessionId,source:void 0,debugShareWithSpace:!0}),A.RD({environment:o,stringValue:`https://www.braintrustdata.com/app/Notion/p/development-prompt-assistant/logs?r=${t}`,copiedMessage:A.tq.copiedLinkToClipboard})}),[r,o]),m={key:"debug-data",render:e=>(0,h.jsx)(K.Z,{...e,desktopTitleStyle:{alignItems:"center",paddingLeft:2,marginTop:0},title:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(R.Z,{icon:k.W,ariaLabel:"debug-menu-back-button",onClick:()=>l(void 0),iconStyle:{width:12,height:12}}),(null==r?void 0:r.skillType)??D]}),right:null==r?void 0:r.timestamp}),items:[{key:"copy-transcript",render:e=>(0,h.jsx)(V.Z,{...e,title:"Copy transcript"}),action:()=>{c(),t.close()}},{key:"copy-eval",render:e=>(0,h.jsx)(V.Z,{...e,title:"Copy as AssistantInferenceInput"}),action:()=>{u(),t.close()}},{key:"open-in-jsonl-viewer",render:e=>(0,h.jsx)(V.Z,{...e,title:"Open in JSONL viewer"}),action:()=>{p(),t.close()}},{key:"share-braintrust-link",render:e=>(0,h.jsx)(V.Z,{...e,title:"Share to Braintrust and copy link"}),action:()=>{g(),t.close()}}]},f=d.map((e=>{const{sessionId:t,skillType:n,timestamp:s,humanMessage:i=""}=e,a={maxWidth:250,overflow:"hidden",textWrap:"wrap"};return{key:t,action:()=>{l(e)},render:e=>(0,h.jsx)(O.Z,{render:t=>(0,h.jsx)(V.Z,{...(0,_.Z)(e,t),title:i?`${i}`:n??D,right:(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[s,(0,w.o)({marginLeft:4,width:12})]})}),renderTooltip:()=>(0,h.jsx)("div",{style:a,children:i}),placement:F.u.Left})}})),x={key:"sessions",render:e=>(0,h.jsx)(K.Z,{...e}),items:f},v={key:"empty",render:e=>(0,h.jsx)(K.Z,{...e}),items:[{key:"empty-item",action:()=>{},render:e=>(0,h.jsx)(V.Z,{...e,title:"No sessions found"})}]},W=r?m:f.length>0?x:v;return(0,h.jsx)(L.Z,{menuType:B.og.Popup,width:300,children:(0,h.jsx)(E.Z,{type:E.i.Vertical,initialFocus:0,sections:[W]})})}function H(e){var t;if(e)return null===(t=Z.default.getSessionContext(e))||void 0===t?void 0:t.evaluator}function N(e){if(!e)return;const t=Z.default.getSessionContextOrThrow(e);return null==t?void 0:t.previewingStep}var z=n(231945),U=n(510102),G=n(319124),q=n(41747),$=n(80444),Q=n(974520),Y=n(801310),X=n(807339),J=n(56348),ee=n(235997),te=n(628410),ne=n(536591),se=n(164921);function ie(){const e=(0,i.Fy)(),t=(0,o.yK)((e=>({button:{color:e.lightTextColor,padding:"0 2px"}})),[]),n=(0,a.VK)((()=>{const e=(0,J.S9)();return te.mc.find((t=>t===e))}),[]),r=(0,s.useCallback)((e=>{(0,J.iT)(e)}),[]);return(0,h.jsx)(z.ZP,{popupType:e.isMobile?z.Z4.SlideUp:z.Z4.Popup,placementToOrigin:z.pO.Bottom,alignmentToOrigin:z.vR.Start,renderOrigin:e=>(0,h.jsx)(se.Z,{style:t.button,...e,children:n??"Default model"}),render:e=>(0,h.jsx)(L.Z,{menuType:B.og.Popup,width:350,children:(0,h.jsx)(E.Z,{type:E.i.Vertical,initialFocus:0,sections:[{key:"models",render:e=>(0,h.jsx)(K.Z,{...e}),items:[...te.mc,void 0].map((t=>({key:t||"default",action:()=>{r(t),e.close()},render:e=>(0,h.jsx)(V.Z,{...e,title:t||"Default model",right:t===n||!t&&!n?(0,ne.e)({width:12,height:"auto"}):void 0,shouldWrapCaption:!0})})))}]})})})}var ae=n(435294),oe=n(905737),re=n(61766);const le={mode:"default",name:"Default search",description:"Use the default search mode."},de=[{mode:"cohereEmbedding",name:"Use Cohere Embs",description:"Hits cohere embedding vector index for vector hits."},{mode:"notionOnly",name:"Notion Only",description:" Don't query universal search sources"},{mode:"esQueryNLastEdited200Pages",name:"Limited Q&A",description:"Limited Q&A on `es_query_n_last_edited_200_pages`"},{mode:"secondPage",name:"Second Page",description:"Consult the next page of search results."},{mode:"gpt4Rerank",name:"GPT-4 Rerank",description:"Uses GPT4 to classify search results into {relevant, not} and reranks them."},{mode:"firstResult",name:"First Result",description:"Only return the top result, for debugging."},{mode:"firstTwoResults",name:"Two Results",description:"Only return the two result, for debugging."}];function ce(){const e=(0,a.VK)((()=>Z.default.getActiveSession()),[]),t=(0,a.VK)((()=>{var t,n;return e?null===(n=e.assistantConfigurationStore)||void 0===n?void 0:n.getSearchModeForNonRetry():null===(t=(0,J.I)().searchOverrides)||void 0===t?void 0:t.searchMode}),[e]),n=(0,s.useCallback)((t=>{Q.Z.setState({...Q.Z.state,searchOverrides:"default"===t?void 0:{searchMode:t}}),null==e||e.assistantConfigurationStore.setSearchMode(t)}),[e]),i=(0,o.yK)((e=>({button:{color:e.lightTextColor,padding:"0 2px"}})),[]),r=[le,...de].find((e=>{let{mode:n}=e;return n===t}))??le;return(0,h.jsx)(ue,{renderOrigin:e=>{let{buttonPopupEvents:t}=e;return(0,h.jsx)(O.Z,{renderTooltip:()=>(0,h.jsx)("div",{children:r.description}),placement:F.u.Bottom,alignment:F.v.Center,render:e=>(0,h.jsx)(se.Z,{...(0,_.Z)(t,e),style:i.button,children:r.name})})},onSelect:n})}function ue(e){const{renderOrigin:t,onSelect:n,selectedModeForStyling:s}=e,i=(0,a.qz)(void 0,re.Z),r=(0,o.yK)((e=>({selectedMode:{backgroundColor:e.sidebarItemSelectedBackground}})),[]),l=(0,ae.d)();return(0,h.jsx)(z.ZP,{buttonPopupStore:i,popupType:l,placementToOrigin:z.pO.Top,alignmentToOrigin:z.vR.Center,renderOrigin:e=>t({buttonPopupEvents:e,onOpen:()=>{i.setState({open:!0})}}),render:e=>(0,h.jsx)(L.Z,{menuType:B.og.Popup,width:350,children:(0,h.jsx)(E.Z,{type:E.i.Vertical,initialFocus:0,sections:[{key:"modes",render:e=>(0,h.jsx)(K.Z,{...e}),items:[le,...de].map((t=>{let{mode:i,name:a,description:o}=t;return{key:i,action:()=>{null==n||n(i),e.close()},render:e=>(0,oe.vy)(i)?(0,h.jsx)(O.Z,{placement:F.u.Left,renderTooltip:()=>(0,h.jsx)("div",{style:{whiteSpace:"pre",fontFamily:"monospace"},children:JSON.stringify(oe.dm[i],null,2)}),delayThreshold:0,render:t=>(0,h.jsx)(V.Z,{...t,...e,onMouseEnter:n=>{var s;null===(s=t.onMouseEnter)||void 0===s||s.call(t,n),e.onMouseEnter(n)},style:s===i?r.selectedMode:void 0,title:a,caption:o,shouldWrapCaption:!0})}):(0,h.jsx)(V.Z,{...e,title:a,style:s===i?r.selectedMode:void 0,caption:o,shouldWrapCaption:!0})}}))}]})})})}var pe=n(574003);function ge(){const e=(0,i.Fy)(),t=(0,o.yK)((t=>({wrap:{display:"flex",alignItems:"center",fontSize:e.isMobile?14:11,height:28,justifyContent:"space-between",padding:"0 8px",backgroundColor:t.popoverBackground,borderBottom:`1px solid ${t.regularDividerColor}`},sideWrap:{display:"flex",alignItems:"center",gap:8},title:{fontStyle:"italic",cursor:"default"}})),[e]),n=(0,a.VK)((()=>(0,J.yk)()),[]),s=(0,a.VK)((()=>$.default.state.currentSpaceStore),[]);return(0,h.jsxs)("div",{style:t.wrap,children:[(0,h.jsxs)("div",{style:t.sideWrap,children:[!n&&(0,h.jsx)("div",{style:t.title,children:"Debug Tools"}),(0,h.jsx)(ie,{}),n&&(0,h.jsx)(ce,{})]}),(0,h.jsxs)("div",{style:t.sideWrap,children:[(0,h.jsx)(xe,{}),s&&(0,h.jsx)(Se,{currentSpaceStore:s}),(0,h.jsx)(ve,{}),(0,h.jsx)(ye,{}),(0,h.jsx)(fe,{}),(0,h.jsx)(he,{})]})]})}function me(e){return(0,h.jsx)(O.Z,{placement:F.u.Bottom,alignment:F.v.Center,delayThreshold:0,...e})}function he(){const e=(0,i.Fy)(),t=be();return(0,h.jsx)(z.ZP,{popupType:e.isMobile?z.Z4.SlideUp:z.Z4.Popup,placementToOrigin:z.pO.Bottom,alignmentToOrigin:z.vR.Start,renderOrigin:e=>(0,h.jsx)(me,{renderTooltip:()=>(0,h.jsx)("div",{children:"Copy transcripts"}),render:n=>(0,h.jsx)(R.Z,{...(0,_.Z)(e,n),style:t.iconButton,icon:r.U,ariaLabel:"Copy"})}),render:e=>(0,h.jsx)(W,{buttonPopupParent:e})})}function fe(){const e=be(),{showSearchDebugPanel:t}=(0,a.VK)((()=>{var e;return{showSearchDebugPanel:(null===(e=Q.Z.state)||void 0===e?void 0:e.showSearchDebugPanel)??!1}}),[]),n=(0,a.VK)((()=>()=>{var e;const n=!t;null===Q.Z||void 0===Q.Z||Q.Z.setState({...Q.Z.state,showSearchDebugPanel:n,searchOverrides:!1===n||null===(e=Q.Z.state)||void 0===e?void 0:e.searchOverrides})}),[t]);return(0,h.jsx)(me,{renderTooltip:()=>(0,h.jsx)("div",{children:`Toggle search debug mode [${t?"ON":"OFF"}]`}),render:s=>(0,h.jsx)(R.Z,{...s,style:e.iconButton,icon:t?u.N:c.D,onClick:n,ariaLabel:"Toggle search debug mode"})})}function ye(){const e=be(),t=(0,a.VK)((()=>(0,G.Gw)()),[]),n=(0,s.useCallback)((()=>{X.C.updateLocalOverrideGate("assistant-labeler-mode",t?"false":"true")}),[t]);return(0,h.jsx)(me,{renderTooltip:()=>(0,h.jsx)("div",{children:`Toggle labeler mode [${t?"ON":"OFF"}]`}),render:s=>(0,h.jsx)(R.Z,{...s,style:e.iconButton,icon:t?f:g.V,onClick:n,ariaLabel:"Toggle labeler mode"})})}function xe(){const e=be(),t=(0,U.Io)(),n=(0,s.useCallback)((()=>{(0,J.yc)(!1),x.d4({item:{label:"Debug bar hidden",...t.isWriter?{durationMs:Y.JY}:{}},undoFunc:()=>{(0,J.yc)(!0)}})}),[t]);return(0,h.jsx)(me,{renderTooltip:()=>(0,h.jsx)("div",{children:"Hide debug helpers"}),render:t=>(0,h.jsx)(R.Z,{...t,style:e.iconButton,icon:d.B,ariaLabel:"Hide",onClick:n})})}function ve(){const e=be(),t=(0,pe.F)();return(0,h.jsx)(me,{renderTooltip:()=>(0,h.jsx)("div",{children:"Edit last assistant step"}),render:n=>(0,h.jsx)(R.Z,{...n,style:e.iconButton,icon:l.E,ariaLabel:"Edit last step",onClick:t})})}function Se(e){const{currentSpaceStore:t}=e,n=(0,i.O7)(),o=(0,y.useIntl)(),r=be(),l=(0,a.VK)((()=>Z.default.getActiveSession()),[]),d=(0,ee.t)({sessionContext:l,currentSpaceStore:t}),c=(0,a.VK)((()=>"empty_state"===d.type?"loading"===q.Z.state.loadingState.type:void 0===(null==l?void 0:l.followupSuggestions)),[d.type,l]),u=(0,s.useCallback)((()=>{"empty_state"===d.type?(0,v.nv)({environment:n,intl:o}):l&&(0,v.MR)({updater:l.createUpdater(),environment:n,transcript:l.evaluator.getTranscript()})}),[n,l,d.type,o]);return c?null:(0,h.jsx)(me,{renderTooltip:()=>(0,h.jsx)("div",{children:"Reload suggestions"}),render:e=>(0,h.jsx)(R.Z,{...e,style:r.iconButton,icon:p.n,ariaLabel:"Reload suggestions",onClick:u})})}function be(){return(0,o.yK)((()=>({iconButton:{height:20,width:20}})),[])}},693415:(e,t,n)=>{n.d(t,{S:()=>p});var s=n(667294),i=n(800480),a=n(886628),o=n(724405),r=n(240745),l=n(709291),d=n(401898),c=n(137810),u=n(785893);function p(e){const{onClick:t,forceHover:n,variant:p}=e,g=(0,i.Fy)(),[m,h]=(0,s.useState)(!1),f=Boolean(n||m),y=(0,a.VK)((()=>f||g.isMobile),[g,f]),x=(0,o.yK)((t=>({wrap:{position:"absolute",left:0,right:0,bottom:0,cursor:"pointer",height:24,display:"flex",justifyContent:"center",alignItems:"flex-end",fontSize:g.isMobile?c.Z.fontSize.UISmall.mobile:c.Z.fontSize.UISmall.desktop,opacity:y?1:0,transition:"opacity 0.2s ease",...e.style},label:{display:"flex",gap:2,alignItems:"center",color:t.mediumTextColor,fontWeight:500,fontSize:11,borderRadius:6,padding:"2px 6px",boxShadow:"0px 0px 1px 0px rgba(0, 0, 0, 0.04), 0px 0px 2px 0px rgba(0, 0, 0, 0.06), 0px 4px 8px 0px rgba(0, 0, 0, 0.04)",background:t.whiteButtonBackground},icon:{width:12,height:12,fill:t.mediumIconColor}})),[g,y,e.style]);return(0,u.jsx)("div",{style:x.wrap,onClick:t,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:(0,u.jsx)("div",{style:x.label,children:"see_more"===p?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{children:(0,u.jsx)(l.FormattedMessage,{id:"assistantCitationHelpers.seeMore",defaultMessage:"See more"})}),(0,r.M)(x.icon)]}):"open_page"===p?(0,u.jsx)("div",{children:(0,u.jsx)(l.FormattedMessage,{id:"assistantCitationHelpers.openPage",defaultMessage:"Open page"})}):(0,d.t1)(p)})})}},6249:(e,t,n)=>{n.d(t,{xW:()=>w,PI:()=>M,i5:()=>I});n(21703);var s=n(667294),i=n(800480),a=n(886628),o=n(724405),r=n(633676),l=n(297022),d=n(439986),c=n(310498),u=n(709291),p=n(524677),g=n(623063),m=n(573063),h=n(526388),f=n(319124),y=n(749085);class x extends y.default{getInitialState(){return{}}}const v=new x;var S=n(798180),b=n(19541),C=n(724199),j=n(785893);const k=(0,u.defineMessages)({thumbsUpButton:{id:"assistant.chat.actions.thumbsUpButton.label",defaultMessage:"Helpful"},thumbsDownButton:{id:"assistant.chat.actions.thumbsDownButton.label",defaultMessage:"Not helpful"}});function w(e){const{isVisible:t,clientStep:n,style:s,sessionId:i,showTooltips:r}=e,{inferenceId:l}=n,d=(0,a.VK)((()=>v.state[l]??void 0),[l]),c=(0,o.yK)((e=>({wrap:{marginTop:"auto",display:"flex",...s},iconStyle:{width:14,height:14}})),[s]),u=t||Boolean(d),p=!r||!u;return(0,j.jsx)(g.Z,{isVisible:!0,animationStyle:{opacity:u?1:0},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:1},render:()=>(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)("div",{style:c.wrap,children:[(0,j.jsx)(I,{disableTooltip:p,inferenceId:l,sessionId:i,iconStyle:c.iconStyle}),(0,j.jsx)(M,{disableTooltip:p,inferenceId:l,sessionId:i,iconStyle:c.iconStyle})]})})})}function I(e){const{disableTooltip:t,inferenceId:n,sessionId:o,iconStyle:r,buttonStyle:l}=e,p=(0,i.O7)(),g=(0,a.VK)((()=>v.state[n]??void 0),[n]),y=(0,a.VK)((()=>(0,f.Gw)()),[]),x="thumbs_up"===g,w=T({isSelected:x,iconStyle:r}),I=(0,s.useCallback)((()=>{const e=o||S.default.getActiveSessionId();if(!e)throw new Error("No active session ID found");C.assistantActions.saveFeedback({environment:p,inferenceId:n,type:"assistant_thumbs_up",sessionId:e}),v.update((e=>({...e,[n]:"thumbs_up"}))),y&&b.Z.update((()=>({open:!0,inferenceId:n,thumbsUpOrDown:"up",sessionId:e})))}),[p,n,y,o]);return(0,j.jsx)(h.Z,{disableTooltip:t,renderTooltip:()=>(0,j.jsx)(u.FormattedMessage,{...k.thumbsUpButton}),render:e=>(0,j.jsx)(m.Z,{...e,icon:x?c.w:d.P,onClick:x?()=>{}:I,disableBackground:x,style:l,iconStyle:{cursor:x?"initial":"pointer",...w.icon},ariaLabel:"Thumbs up feedback on assistant message"})})}function M(e){const{disableTooltip:t,inferenceId:n,sessionId:o,iconStyle:d,buttonStyle:c}=e,g=(0,i.O7)(),f="thumbs_down"===(0,a.VK)((()=>v.state[n]??void 0),[n]),y=T({isSelected:f,iconStyle:d}),x=(0,s.useCallback)((()=>{p.ZH({debug:{userAction:"AssistantFeedbackButtons.handleClick"},environment:g});const e=o||S.default.getActiveSessionId();if(!e)throw new Error("No active session ID found");C.assistantActions.saveFeedback({environment:g,inferenceId:n,type:"assistant_thumbs_down",sessionId:e}),v.update((e=>({...e,[n]:"thumbs_down"}))),b.Z.update((()=>({open:!0,inferenceId:n,thumbsUpOrDown:"down",sessionId:e})))}),[g,n,o]);return(0,j.jsx)(h.Z,{disableTooltip:t,renderTooltip:()=>(0,j.jsx)(u.FormattedMessage,{...k.thumbsDownButton}),render:e=>(0,j.jsx)(m.Z,{...e,icon:f?l.E:r.A,onClick:f?()=>{}:x,disableBackground:f,style:c,iconStyle:{cursor:f?"initial":"pointer",...y.icon},ariaLabel:"Thumbs down feedback on assistant message"})})}function T(e){const{isSelected:t,iconStyle:n}=e;return(0,o.yK)((e=>({icon:{fill:t?e.blueColor:e.mediumIconColor,...n}})),[t,n])}},520119:(e,t,n)=>{n.d(t,{s:()=>j,y:()=>C});var s=n(667294),i=n(800480),a=n(886628),o=n(724405),r=n(116638),l=n(542853),d=n(993537),c=n(709291),u=n(137810),p=n(227370),g=n(667436),m=n(435294),h=n(231945),f=n(80444),y=n(798180),x=n(55762),v=n(2405),S=n(400578),b=n(785893);function C(e){const{onSelect:t,analyticsSource:n}=e,a=(0,i.O7)(),r=(0,m.d)(),c=function(){const{isMobile:e}=(0,i.Fy)();return(0,o.yK)((t=>({buttonContainer:{display:"flex",alignItems:"center",...!e&&{maxWidth:250,...u.Z.textOverflowStyle}},chevronDown:{fill:t.lightIconColor,width:9,height:"auto",marginLeft:6}})),[e])}(),f=(0,s.useRef)(null);return(0,b.jsx)(h.ZP,{popupType:r,placementToOrigin:h.pO.Top,alignmentToOrigin:h.vR.Center,onClick:()=>{p.dismissTutorial(a,"enhanced-qna-onboarding")},renderOrigin:e=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.Z,{...e,ref:f,style:c.buttonContainer,icon:d.A,title:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j,{}),(0,l.i)(c.chevronDown)]}),variant:"tinted"}),(0,b.jsx)(g.X,{origin:f})]}),render:e=>(0,b.jsx)(S.C,{buttonPopupParent:e,onSelect:t,analyticsSource:n})})}function j(){const e=(0,c.useIntl)(),t=(0,o.yK)((e=>({wrap:{display:"flex",flexGrow:1,justifyItems:"space-between",maxWidth:250,...u.Z.textOverflowStyle},findIn:{flexGrow:1,paddingInlineEnd:6,marginRight:"auto",whiteSpace:"nowrap"},scope:{display:"flex",alignItems:"center",flexShrink:1},scopeText:{minWidth:0,maxWidth:85,color:e.lightTextColor,...u.Z.textOverflowStyle}})),[]),n=(0,a.VK)((()=>f.default.state.currentSpaceStore),[]),s=(0,a.VK)((()=>{const e=y.default.getActiveAssistantConfigurationState();return(null==e?void 0:e.searchScope)??r.QA}),[]),i=(0,a.VK)((()=>{if(n)return(0,x.UD)({searchScope:s,currentSpaceStore:n,intl:e})}),[s,n,e]);return(0,b.jsxs)("div",{style:t.wrap,children:[(0,b.jsx)("div",{style:t.findIn,children:(0,b.jsx)(c.FormattedMessage,{id:"assistantFeedback.actionButton.findIn",defaultMessage:"Find in"})}),(0,b.jsx)("div",{style:t.scope,children:(0,b.jsx)("div",{style:t.scopeText,children:i})})]})}},860114:(e,t,n)=>{n.d(t,{v7:()=>w,lx:()=>_,fq:()=>P,Gw:()=>B});var s=n(667294),i=n(800480),a=n(886628),o=n(724405),r=n(172263),l=n(709291),d=n(401898),c=n(763594),u=n(158297),p=n(99622),g=n(212205),m=n(80444),h=n(521273),f=n(798180),y=n(480671),x=n(44041),v=n(535057),S=n(428956),b=n(785893);function C(e){const t=(0,o.yK)((e=>({assistantBlueLink:{color:e.text.uiBluePrimary,cursor:"pointer",fontWeight:600}})),[]);return(0,b.jsx)("span",{style:t.assistantBlueLink,onClick:e.onClick,children:e.children})}var j=n(22668);const k=(0,l.defineMessages)({requestAccessButton:{id:"AssistantLimitReached.requestAccess.button",defaultMessage:"Request access"},requestAccessMessage:{id:"AssistantLimitReached.requestAccess.message",defaultMessage:"Youve run out of free AI responses. Request the <bold>Notion AI add-on</bold> from your workspace owner."},requestAccessNoFreeCreditsMessage:{id:"AssistantLimitReached.requestAccessNoFreeCredits.message",defaultMessage:"Request the <bold>Notion AI add-on</bold> from your workspace owner."},requestAccessReceived:{id:"AssistantLimitReached.requestAccess.received",defaultMessage:"Youve run out of free Al responses. Weve sent your request to the workspace owner for the Notion AI add-on."},requestAccessReceivedNoFreeCredits:{id:"AssistantLimitReached.requestAccessNoFreeCredits.received",defaultMessage:"Weve sent your request to the workspace owner for the Notion AI add-on."},unavailableMessage:{id:"AssistantLimitReached.unavailable.message",defaultMessage:"Reach out to your account representative to purchase the Notion AI add-on."},upsellButton:{id:"AssistantLimitReached.upsell.button",defaultMessage:"Get unlimited AI"},upsellMessage:{id:"AssistantLimitReached.upsell.message",defaultMessage:"Youve run out of free AI responses. Get the <bold>Notion AI add-on</bold> so that I can answer an unlimited number of questions for you."}});function w(e){const{sessionId:t}=e;return(0,a.VK)((()=>P(t)),[t])?(0,b.jsx)(I,{...e}):null}function I(e){const t=B();return"unavailable"===t?(0,b.jsx)(A,{...e}):"requestAccess"===t?(0,b.jsx)(M,{...e}):"requestAccessNoFreeCredits"===t?(0,b.jsx)(M,{...e,noFreeCredits:!0}):"upsell"===t?(0,b.jsx)(T,{...e}):void(0,d.t1)(t)}function M(e){const{displayAsChatStep:t,chatStepProps:n,noFreeCredits:o}=e,d=(0,i.O7)(),c=(0,a.VK)((()=>S.Z.didRequest()),[]),p=(0,l.useIntl)(),g=F(t),m=(0,a.VK)((()=>h.Z.isXMLAssistantEnabled()),[]),f=(0,s.useCallback)((()=>{_({upsellType:"requestAccess",environment:d,isAssistantEnabled:m})}),[d,m]),y=p.formatMessage(o?k.requestAccessReceivedNoFreeCredits:k.requestAccessReceived);if(c)return(0,b.jsx)("div",{style:g.wrapper,children:t?(0,b.jsx)(j.H,{...n,latestStepCitationHoverStore:void 0,clientStep:{type:"assistantLimitReached",message:y,inferenceId:"hard-coded"}}):y});const x=p.formatMessage(o?k.requestAccessNoFreeCreditsMessage:k.requestAccessMessage,{bold:e=>(0,b.jsx)(C,{onClick:f,children:e})});return(0,b.jsxs)("div",{style:g.wrapper,children:[t?(0,b.jsx)(j.H,{...n,latestStepCitationHoverStore:void 0,clientStep:{type:"assistantLimitReached",message:x,inferenceId:"hard-coded"}}):x,t&&(0,b.jsxs)(u.Z,{style:g.button,onClick:f,children:[(0,r._)(g.icon),p.formatMessage(k.requestAccessButton)]})]})}function T(e){const{displayAsChatStep:t,chatStepProps:n}=e,o=(0,i.O7)(),d=F(t),c=(0,l.useIntl)(),p=(0,a.VK)((()=>h.Z.isXMLAssistantEnabled()),[]),g=(0,s.useCallback)((()=>{_({environment:o,upsellType:"upsell",isAssistantEnabled:p})}),[o,p]),m=c.formatMessage(k.upsellMessage,{bold:e=>(0,b.jsx)(C,{onClick:g,children:e})});return(0,b.jsxs)("div",{style:d.wrapper,children:[t?(0,b.jsx)(j.H,{...n,latestStepCitationHoverStore:void 0,clientStep:{type:"assistantLimitReached",message:m,inferenceId:"hard-coded"}}):m,t&&(0,b.jsxs)(u.Z,{style:d.button,onClick:g,children:[(0,r._)(d.icon),c.formatMessage(k.upsellButton)]})]})}function A(e){const{displayAsChatStep:t,chatStepProps:n}=e,s=F(t),i=(0,l.useIntl)().formatMessage(k.unavailableMessage);return(0,b.jsx)("div",{style:s.wrapper,children:t?(0,b.jsx)(j.H,{...n,latestStepCitationHoverStore:void 0,clientStep:{type:"assistantLimitReached",message:i,inferenceId:"hard-coded"}}):i})}function P(e){var t,n;if(!e)return!1;const s=null===(t=f.default.getSessionContext(e))||void 0===t?void 0:t.assistantConfigurationState,i=Boolean((null==s?void 0:s.sampling)||(null==s?void 0:s.evaluating)),a=null===(n=f.default.getSessionContext(e))||void 0===n?void 0:n.getPreviewingStepErrorObservations(),o=a&&a.length>0;return!i&&o&&!c.Z.state}function B(){const e=(0,g.J)();return(0,p.g)()?e?"unavailable":"requestAccessNoFreeCredits":e?"upsell":"requestAccess"}function _(e){const{environment:t,upsellType:n,isAssistantEnabled:s}=e;if("upsell"===n)x.y(t,{from:s?"ai_assistant_limit_in_app":"ai_qna_limit_in_app",for:(0,v.zt)(),addOnFeature:"ai"});else if("requestAccess"===n||"requestAccessNoFreeCredits"===n){const e=m.default.state.currentSpaceStore;if(!e)return;(0,y.jw)({environment:t,spaceStore:e,from:s?"ai_assistant_limit_in_app":"ai_qna_limit_in_app"});const n=S.Z.state;n&&!n.isEligible&&S.Z.setState({...n,requestedAccess:!0})}else(0,d.t1)(n)}function F(e){return(0,o.yK)((()=>({button:{alignSelf:"flex-start",borderRadius:100,display:"flex",gap:6,marginTop:6,marginBottom:6,padding:"7px 12px"},icon:{width:16,height:16},wrapper:e?{marginTop:4,display:"flex",flexDirection:"column"}:{fontSize:14,padding:8}})),[e])}},561017:(e,t,n)=>{n.d(t,{O:()=>S});var s=n(667294),i=n(886628),a=n(842875),o=n(966673),r=n(559054),l=n(882883),d=n(709291),c=n(401898),u=n(763594),p=n(80444),g=n(206258),m=n(567973),h=n(22668),f=n(816540),y=n(226009),x=n(785893);const v=(0,d.defineMessages)({editing:{id:"AssistantLoadingStateRenderer.editing",defaultMessage:"Editing"},searchingPeople:{id:"AssistantLoadingStateRenderer.searchingPeople",defaultMessage:"Finding people"},searhingDatabases:{id:"AssistantLoadingStateRenderer.searchingDatabases",defaultMessage:"Finding databases"},queryingDatabase:{id:"AssistantLoadingStateRenderer.queryingDatabase",defaultMessage:"Searching {database}"},loadingDatabase:{id:"AssistantLoadingStateRenderer.loadingDatabase",defaultMessage:"Loading {database}"},loadingPage:{id:"AssistantLoadingStateRenderer.loadingPage",defaultMessage:"Reading page"},retrying:{id:"AssistantLoadingStateRenderer.wentWrongTryAgain",defaultMessage:"Trying again"}});function S(e){const t=(0,i.VK)((()=>p.default.state.currentSpaceStore),[]);return t&&e.loadingState?(0,x.jsx)(b,{...e,currentSpaceStore:t}):null}function b(e){const{loadingState:t,currentSpaceStore:n,handleShowSearchResults:a}=e,o=(0,d.useIntl)(),r=(0,i.VK)((()=>!u.Z.state),[]),l=(0,s.useMemo)((()=>{if((0,c.$K)(t.loadingStep)){if(r)return{type:"message",messageFn:()=>o.formatMessage(y.K.thinking)};if("assistantShowSearchResults"===t.loadingStep.type)return a?{type:"comp",comp:(0,x.jsx)(f.N,{parentStore:n,clientStep:t.loadingStep})}:{type:"empty"};if("assistantLoadPage"===t.loadingStep.type)return{type:"message",messageFn:()=>o.formatMessage(v.loadingPage)};if("assistantLoadDatabase"===t.loadingStep.type){const e=t.loadingStep.pointer;return{type:"message",messageFn:async()=>{const t=await j({currentSpaceStore:n,collectionPointer:e,intl:o});return o.formatMessage(v.loadingDatabase,{database:t})}}}if("assistantQueryingDatabase"===t.loadingStep.type||"queryDatabase"===t.loadingStep.type){const e=t.loadingStep.collectionPointer;return{type:"message",messageFn:async()=>{const t=await j({currentSpaceStore:n,collectionPointer:e,intl:o});return o.formatMessage(v.queryingDatabase,{database:t})}}}if("assistantSearchPeople"===t.loadingStep.type)return{type:"message",messageFn:()=>o.formatMessage(v.searchingPeople)};if("assistantSearchDatabases"===t.loadingStep.type)return{type:"message",messageFn:()=>o.formatMessage(v.searhingDatabases)};if("assistantRetry"===t.loadingStep.type)return{type:"message",messageFn:()=>o.formatMessage(v.retrying)};if("groupedEditCard"===t.loadingStep.type)return{type:"message",messageFn:()=>o.formatMessage(v.editing)};(0,c.t1)(t.loadingStep)}return{type:"message",messageFn:void 0}}),[n,o,t,a,r]);return"empty"===l.type?null:(0,x.jsx)(C,{...e,renderState:l})}function C(e){const{currentSpaceStore:t,renderState:n}=e,[s]=(0,r.r5)((async()=>"comp"===n.type?n:"message"===n.type?{type:"message",message:n.messageFn?await n.messageFn():void 0}:void(0,c.t1)(n)),[n]),a=(0,o.Z_)(null==s?void 0:s.value,500,((e,t)=>e===t)),l=(0,i.qz)(void 0,m.d);return(0,x.jsx)(h.H,{clientStep:{type:"assistantLoading",inferenceId:"hard-coded",message:a&&("message"===a.type?a.message:"comp"===a.type?a.comp:(0,c.t1)(a))},parentStore:t,parentSpaceId:t.id,latestStepCitationHoverStore:l})}async function j(e){const{currentSpaceStore:t,collectionPointer:n,intl:s}=e,i=g.NW.createChildStore(t,n);return await i.load(),(0,l.X)({textValue:i.getName(),getRecordModel:i.getRecordModel,userTimeZone:(0,a.r)(),deterministic:!0,intl:s})}},741799:(e,t,n)=>{n.d(t,{Q:()=>ye});n(21703);var s=n(667294),i=n(800480),a=n(886628),o=n(724405),r=n(559054),l=n(37652),d=n(80721),c=n(605336),u=n(2585),p=n(101464),g=n(964275),m=n(779709),h=n(356666),f=n(163048),y=n(709291),x=n(653965),v=n(401898),S=n(137810),b=n(524677),C=n(210228),j=n(781645),k=n(623063),w=n(231945),I=n(573063),M=n(489728),T=n(526388),A=n(840654),P=(n(628020),n(116746)),B=n(224646),_=(n(561436),n(424042));const F=10;var Z=n(510102),V=n(843250),R=n(823376),L=n(48276),E=n(938676),K=n(905162),O=n(80444),D=n(521273),W=n(728495),H=n(148168),N=n(798180),z=n(483627),U=n(45325),G=n(188923),q=n(828344),$=n(642915),Q=n(365147),Y=n(484681),X=n(548809),J=n(56348),ee=n(217978),te=n(938622),ne=n(558530),se=n(211348),ie=n(421016),ae=n(953336),oe=n(434859),re=n(878158),le=n(785893);function de(e){const{spaceStore:t}=e;return(0,le.jsx)(le.Fragment,{children:(0,le.jsx)(ae.Z,{type:oe.Z.Y,children:(0,le.jsx)(re.F,{spaceStore:t})})})}var ce=n(644962),ue=n(351594),pe=n(492928),ge=n(139249),me=n(574003);const he=(0,y.defineMessages)({newChatAriaLabel:{id:"assistantMenu.newChat.ariaLabel",defaultMessage:"New chat"}}),fe=450;function ye(e){const{onClose:t}=e,n=(0,i.O7)(),l=(0,Z.Io)(),{renderAsFullPage:d,isMobile:c}=l,u=s.useMemo((()=>!(0,K.Y)("supportsHorizon1Navigation")&&l.isMobile),[l]),p=(0,a.VK)((()=>D.Z.isJSAssistantEnabled()),[]),g=(0,a.VK)((()=>{var e;return null===(e=O.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),m=(0,a.VK)((()=>W.d.state.currentView),[]),h=(0,a.VK)((()=>(0,J.em)()),[]),f=(0,a.VK)((()=>G.default.isSidePeekOpen()),[]),[y,S]=s.useState(),b=(0,a.VK)((()=>L.VV()),[]),C=(0,a.VK)((()=>P.Z.isTogglingToPanelModeState()),[]);(0,r.r5)((async()=>{g&&p&&await(0,$.Jl)({environment:n,spaceId:g})}),[n,g,p]);const j=s.useCallback((()=>{const e=(0,B.z5)(n);S(e)}),[n]),w=(0,x.Ds)(j,100);s.useEffect((()=>(w(),G.default.addListener(w),te.Z.addListener(w),E.sidebarOpenStore.addListener(w),U.default.addListener(w),n.WindowSizeStore.addListener(w),()=>{G.default.removeListener(w),te.Z.removeListener(w),E.sidebarOpenStore.removeListener(w),U.default.removeListener(w),n.WindowSizeStore.removeListener(w)})),[w,n.WindowSizeStore]);const I=(0,s.useCallback)((()=>{H.N.setAssistantLastViewedTime(),null==t||t();const e=N.default.getActiveSession();q.trackAssistantClosed(n,{sessionContext:e,from:"button"})}),[n,t]),M=(0,ee.u)(),T=(0,o.yK)((e=>({wrap:{display:"flex",flexDirection:"column",transition:"max-height 200ms ease",minHeight:128,...d?c?{width:"100%",height:"100%",maxHeight:void 0}:f?{width:y?Math.max(fe,y):fe,height:"100%",maxHeight:void 0}:{width:"100%",height:"100%",maxHeight:void 0}:{width:420,height:void 0,maxHeight:"empty_state"===M.type?"max(60vh, 365px)":"max(calc(100vh - 66px), 365px)",minHeight:"min(60vh, 365px)"}}})),[d,f,y,c,M]),A={onClose:I,showCloseButton:Boolean(u)};let _;"chat"===m?_=(0,le.jsx)(xe,{...A}):"automations"===m?_=(0,le.jsx)(je,{...A}):"chatHistory"===m?_=(0,le.jsx)(ke,{...A}):(0,v.t1)(m);let F={width:T.wrap.width};return l.isType("fullPage")&&(F={width:`calc(${T.wrap.width} - ${b}px)`,translateX:b}),(0,le.jsx)(me.p,{origin:(0,le.jsx)(k.Z,{isVisible:!0,animationStyle:F,skipAnimation:!l.isType("fullPage")||C,render:()=>(0,le.jsxs)("div",{style:T.wrap,children:[h&&(0,le.jsx)(ue.G,{}),_]})})})}function xe(e){const{showCloseButton:t,onClose:n}=e,s=(0,a.VK)((()=>N.default.getActiveSession()),[]),i=(0,a.VK)((()=>null==s?void 0:s.sessionId),[s]),o=(0,a.VK)((()=>null==s?void 0:s.automationStore),[s]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(we,{backButtonVariant:t?"closeChat":"none",onClose:n,extraRightAlignedContent:(0,le.jsx)(ve,{currentSessionId:i}),children:!o&&(0,le.jsx)(j.Z,{})}),(0,le.jsx)(ce.R,{})]})}function ve(e){const{currentSessionId:t}=e,n=(0,i.O7)(),s=(0,Z.Io)(),o=(0,a.VK)((()=>!t&&s.shouldShowChatHistory),[t,s]),r=Boolean(t);return(0,le.jsxs)(le.Fragment,{children:[o?(0,le.jsx)(T.Z,{render:e=>(0,le.jsx)(Ce,{onClick:()=>{Y.switchToChatHistory({environment:n,currentSessionId:t,from:s.type})},tooltipEvents:e}),renderTooltip:()=>(0,le.jsx)(y.FormattedMessage,{id:"assistantMenu.seeHistory",defaultMessage:"View history"})}):r?(0,le.jsx)(Se,{}):null,(0,le.jsx)(be,{currentSessionId:t})]})}function Se(){const e=(0,y.useIntl)(),t=(0,i.O7)(),{isMobile:n}=(0,i.Fy)(),a=(0,Z.Io)(),r=(0,o.yK)((()=>({iconContainerStyle:n?{borderRadius:"100%",width:28,height:28}:{},iconStyle:{width:n?20:16,height:n?20:16}})),[n]),l=s.useCallback((()=>{(0,Q.MQ)({environment:t,surface:a.type})}),[a,t]);return(0,le.jsx)(T.Z,{renderTooltip:()=>(0,le.jsx)(y.FormattedMessage,{id:"assistantMenu.newChat.tooltip",defaultMessage:"New chat"}),render:t=>(0,le.jsx)(I.Z,{...t,icon:m.e,style:r.iconContainerStyle,iconStyle:r.iconStyle,ariaLabel:e.formatMessage(he.newChatAriaLabel),onClick:l})})}function be(e){const{currentSessionId:t}=e,n=(0,i.O7)(),{isMobile:a,isMobileNative:r,isElectron:l}=(0,i.Fy)(),d=(0,Z.Io)(),c=l&&d.isType("fullPage"),u=(0,o.yK)((e=>({iconParentWrapper:{...c&&{height:44,display:"flex",alignItems:"center"}},iconContainerStyle:{...a&&{borderRadius:"100%",width:28,height:28}},iconStyle:{width:a?18:14,height:a?18:14,fill:d.isType("fullPage")?e.regularIconColor:e.lightIconColor}})),[c,a,d]),p=(0,Z.Io)(),g=s.useMemo((()=>p.isType("fullPage")?w.vR.End:w.vR.Start),[p]),m=s.useMemo((()=>p.isType("fullPage")?w.pO.Bottom:w.pO.Left),[p]),f=(0,s.useRef)(null);(0,s.useEffect)((()=>{z.Z.setOriginComponent(f.current??void 0)}),[]);const x=(0,s.useCallback)((()=>{p.isType("fullPage")?(0,R.AP)({environment:n,contentType:"assistant"}):(W.d.setState({...W.d.state,currentView:"chatHistory"}),q.trackAiChatTranscriptHistoryOpenHistoryButtonSelected(n,{from:p.type}))}),[p,n]);return(0,le.jsx)(w.ZP,{buttonPopupStore:ne.Z,alignmentToOrigin:g,placementToOrigin:m,popupType:a?w.Z4.SlideUp:w.Z4.Popup,onClick:()=>{r&&b.ZH({debug:{userAction:"AssistantMenu.AssistantMoreButton"},environment:n}),se.D.setCurrentView("helpOverflowMenu"),q.trackOpeningThreeDotMenu(n,{sessionId:t})},renderOrigin:e=>(0,le.jsx)("div",{ref:f,style:u.iconContainerStyle,children:(0,le.jsx)(T.Z,{render:t=>(0,le.jsx)("div",{style:u.iconParentWrapper,children:(0,le.jsx)(I.Z,{style:u.iconContainerStyle,iconStyle:u.iconStyle,icon:h.o,ariaLabel:"more",...t,...e})}),renderTooltip:()=>(0,le.jsx)(y.FormattedMessage,{id:"assistant.help",defaultMessage:"Manage chats, get help, more..."})})}),render:e=>(0,le.jsx)(pe.u,{buttonPopupParent:e,onClickViewHistory:x})})}function Ce(e){const{onClick:t,tooltipEvents:n}=e,{isMobile:s}=(0,i.Fy)(),a=(0,o.yK)((()=>({iconContainerStyle:s?{borderRadius:"100%",width:28,height:28}:{},iconStyle:{width:s?20:16,height:s?20:16}})),[s]);return(0,le.jsx)(I.Z,{...n,icon:c.r,style:a.iconContainerStyle,iconStyle:a.iconStyle,ariaLabel:"View chat history",onClick:t})}function je(e){const{showCloseButton:t,onClose:n}=e,r=(0,i.O7)(),d=(0,o.yK)((()=>({addWorkflowIcon:{width:14},header:{marginLeft:4,fontSize:14}})),[]),c=(0,a.VK)((()=>O.default.state.currentSpaceStore),[]),[u,p]=(0,s.useState)(void 0),g=(0,s.useCallback)((()=>{Y.navigateToView({view:"chat"})}),[]),m=(0,s.useCallback)((()=>{const{mainEditorCurrentBlockStore:e}=O.default.state;if(!e)throw new Error("mainEditorCurrentBlockStore is undefined");const t=e.getCollectionViewSourceCollectionStore(),n=C.createAndCommit({environment:r,userAction:"createAutomation",perform:n=>(0,$.wv)({environment:r,parent:t||e,transaction:n})}).performResult;p(n)}),[r]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(we,{backButtonVariant:t?"closeChat":"none",onClose:n,extraRightAlignedContent:(0,le.jsx)(ie.Z,{automationStore:u,renderOrigin:e=>(0,le.jsx)(I.Z,{iconStyle:d.addWorkflowIcon,icon:f.C,ariaLabel:"Add workflow",...e}),onClick:m}),children:(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(I.Z,{icon:l.V,onClick:g,ariaLabel:"back"}),(0,le.jsx)("div",{style:d.header,children:"Workflows"})]})}),c&&(0,le.jsx)(de,{spaceStore:c})]})}function ke(e){const{showCloseButton:t,onClose:n}=e,s=(0,i.O7)(),a=(0,i.Fy)(),r=(0,o.yK)((e=>({newChatButtonText:{color:e.lightTextColor,fontSize:13,display:"flex",alignItems:"center"},chatHistoryTitle:a.isMobile?{fontSize:15,fontWeight:S.Z.fontWeight.medium,display:"flex",alignItems:"center",textAlign:"center",paddingLeft:8,paddingRight:34,flex:1,justifyContent:"center",...S.Z.textOverflowStyle}:{fontSize:14,fontWeight:S.Z.fontWeight.medium,display:"flex",alignItems:"center",padding:"4px 12px"}})),[a.isMobile]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(we,{backButtonVariant:t?"closeChat":"returnToChat",onClose:n,extraRightAlignedContent:a.isMobile?void 0:(0,le.jsx)(M.Z,{style:r.newChatButtonText,onClick:()=>{(0,X.hW)({environment:s,source:"corner"})},isSmall:!0,children:(0,le.jsx)(y.FormattedMessage,{id:"searchAssistantPane.header.newChat.label",defaultMessage:"New chat"})}),children:(0,le.jsx)("div",{style:r.chatHistoryTitle,children:(0,le.jsx)(y.FormattedMessage,{id:"assistantMenu.allChats.askNotionAI.header",defaultMessage:"All chats"})})}),(0,le.jsx)(ge.ZP,{})]})}function we(e){const{children:t,onClose:n,extraRightAlignedContent:r,backButtonVariant:l}=e,c=(0,i.O7)(),{isMobile:m,isElectron:h,isElectronMac:f}=(0,i.Fy)(),y=(0,Z.Io)(),x=y.isType("fullPage"),{isShowingTabBar:v,isUnifiedTitleBarEnabled:S}=(0,a.VK)((()=>{var e;return{isShowingTabBar:Boolean(_.Z.state.isShowingTabBar),isUnifiedTitleBarEnabled:Boolean(null===(e=_.Z.state.preferences)||void 0===e?void 0:e.isUnifiedTitleBarEnabled)}}),[]),b=Boolean(r||!x),C=(0,K.Y)("supportsHorizon1Navigation"),j=function(){const{isMobile:e,isElectronWindows:t}=(0,i.Fy)(),{isShowingTabBar:n,isUnifiedTitleBarEnabled:o,zoomFactor:r}=(0,a.VK)((()=>{var e;return{isShowingTabBar:Boolean(_.Z.state.isShowingTabBar),isUnifiedTitleBarEnabled:Boolean(null===(e=_.Z.state.preferences)||void 0===e?void 0:e.isUnifiedTitleBarEnabled),zoomFactor:_.Z.state.zoomFactor||A.lO}}),[]),l=o&&t&&!n;return(0,s.useMemo)((()=>l?(0,A.RO)(r)+4:e?4:F),[e,l,r])}(),k=(0,i.Fy)().isElectron&&x&&!v,w=(0,o.yK)((()=>({wrap:{display:"flex",alignItems:"start",pointerEvents:"auto",paddingLeft:k?0:12,paddingRight:x?j:12,paddingTop:k?0:10,paddingBottom:10,height:60,marginBottom:"auto"},leftContentWrap:{display:"flex",flexGrow:1,alignItems:"center",overflow:"hidden",marginRight:b?8:0},rightContentWrap:{display:"flex",flexDirection:"column",justifyContent:"flex-start"},rightContentRowWrap:{display:"flex",flexDirection:"row",alignItems:"center",gap:m?8:x?6:4,flexShrink:0},backwardButton:{marginLeft:4},backwardButtonIcon:{width:32,height:32},closeButton:{borderRadius:"100%",width:m?28:22,height:m?28:22,marginLeft:m?void 0:2},closeButtonIconStyle:m?{width:18,height:18}:{}})),[k,x,j,b,m]),M=S?x&&h&&!v:x&&f&&!v;return(0,le.jsxs)("div",{className:M?V.pMC:void 0,style:w.wrap,children:[(0,le.jsxs)("div",{style:w.leftContentWrap,children:["closeChat"===l&&(0,le.jsx)(I.Z,{iconStyle:w.backwardButtonIcon,style:w.backwardButton,icon:p.k,onClick:n,disableBackground:!0,isDarkIconColor:!0,ariaLabel:"close"}),"returnToChat"===l&&(C?(0,le.jsx)(I.Z,{iconStyle:w.closeButtonIconStyle,style:w.closeButton,hovered:!0,icon:u.f,onClick:()=>{(0,X.ku)({environment:c,source:"corner"})},ariaLabel:"close"}):(0,le.jsx)(I.Z,{iconStyle:{width:17,height:17},style:w.backwardButton,icon:d.W,onClick:()=>{(0,X.ku)({environment:c,source:"corner"})},ariaLabel:"close"})),t]}),b?(0,le.jsx)("div",{style:w.rightContentWrap,children:(0,le.jsxs)("div",{style:w.rightContentRowWrap,children:[r,y.showCloseButton&&(0,le.jsx)(I.Z,{iconStyle:w.closeButtonIconStyle,style:w.closeButton,hovered:!0,icon:g.D,onClick:n,ariaLabel:"close"})]})}):null]})}},492928:(e,t,n)=>{n.d(t,{u:()=>ht});var s=n(667294),i=n(800480),a=n(886628),o=n(401898),r=n(296994),l=n(798180),d=n(100475),c=n(484681),u=n(387066),p=n(211348),g=(n(757658),n(724405)),m=n(605336),h=n(605257),f=n(403124),y=n(779709),x=n(650209),v=n(993537),S=n(584169),b=n(709291),C=n(547307),j=n(998851),k=n(552275),w=n(231945),I=n(478140),M=n(632163),T=n(953437),A=n(672495),P=n(510102),B=n(934700),_=n(460709),F=n(212205),Z=n(521273),V=n(828344),R=n(548809),L=n(56348),E=n(520119),K=n(400578),O=(n(21703),n(184747)),D=n(841892),W=n(559054),H=n(745238),N=n(785893);const z=(0,H.IU)("googleDriveColor",{viewBox:"0 0 87.3 78",svg:(0,N.jsxs)("g",{children:[(0,N.jsx)("path",{fill:"#0066da",d:"M6.6 66.85l3.85 6.65c.8 1.4 1.95 2.5 3.3 3.3L27.5 53H0c0 1.55.4 3.1 1.2 4.5z"}),(0,N.jsx)("path",{fill:"#00ac47",d:"M43.65 25L29.9 1.2c-1.35.8-2.5 1.9-3.3 3.3l-25.4 44A9.06 9.06 0 000 53h27.5z"}),(0,N.jsx)("path",{fill:"#ea4335",d:"M73.55 76.8c1.35-.8 2.5-1.9 3.3-3.3l1.6-2.75L86.1 57.5c.8-1.4 1.2-2.95 1.2-4.5H59.798l5.852 11.5z"}),(0,N.jsx)("path",{fill:"#00832d",d:"M43.65 25L57.4 1.2C56.05.4 54.5 0 52.9 0H34.4c-1.6 0-3.15.45-4.5 1.2z"}),(0,N.jsx)("path",{fill:"#2684fc",d:"M59.8 53H27.5L13.75 76.8c1.35.8 2.9 1.2 4.5 1.2h50.8c1.6 0 3.15-.45 4.5-1.2z"}),(0,N.jsx)("path",{fill:"#ffba00",d:"M73.4 26.5l-12.7-22c-.8-1.4-1.95-2.5-3.3-3.3L43.65 25 59.8 53h27.45c0-1.55-.4-3.1-1.2-4.5z"})]})});var U=n(418442),G=n(698519),q=n(471924),$=n(137810),Q=n(454642),Y=n(164964),X=n(164921),J=n(396525),ee=n(629551),te=n(730459),ne=n(98742),se=n(80444),ie=n(319385),ae=n(397788),oe=n(550506),re=n(158297);const le=function(){const e=(0,a.VK)((()=>ae.X.state),[]),t=(0,a.VK)((()=>{var e;return null===(e=se.default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),n=(0,i.O7)(),s=t=>{ae.X.setState({...e,screenToShow:t})},o=(0,g.yK)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:$.Z.fontWeight.semibold,color:e.v2.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:$.Z.fontWeight.regular,color:e.v2.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:$.Z.fontWeight.regular,color:e.v2.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:$.Z.fontWeight.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:$.Z.fontWeight.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20}})),[]);return(0,N.jsx)(oe.Z,{showCloseIcon:!0,open:!0,onDismiss:()=>{(0,te.j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_close",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),s("none")},render:()=>(0,N.jsx)("div",{style:o.confirmWrapper,children:(0,N.jsxs)("div",{style:o.confirmContainer,children:[(0,N.jsx)("div",{style:o.confirmModalTitle,children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.disconnectModal.title",defaultMessage:"Are your sure?"})}),(0,N.jsx)("div",{style:o.confirmModalSubTitle,children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.disconnectModal.subTitle",defaultMessage:"Google Drive data will be permanently deleted from Notion."})}),(0,N.jsx)("div",{style:o.confirmModalDescription,children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and youll only be able to reconnect after disconnecting is complete."})}),(0,N.jsxs)(ee.Ht,{style:o.confirmModalActionButtons,children:[(0,N.jsx)(re.Z,{isRed:!0,style:o.confirmDisconnectButton,disabled:e.isDisconnecting,onClick:async()=>{(0,te.j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),await(async()=>{if(!t)return;const s=await Q.disconnectGoogleDriveAIIngestion(n,{spaceId:t});"success"===s.type&&s.data.deletionInitiated?(Y.oV({label:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.disconnectModal.acknowledgeDisconnect",defaultMessage:"Started disconnecting Google Drive. This can take up to 3 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(X.Z,{onClick:Y.rN,children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.disconnectModal.dismissAcknowledgeDisconnect",defaultMessage:"Close"})})}),ae.X.setState({...e,screenToShow:"none",isDisconnecting:!0})):(Y.oV({label:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.disconnectModal.disconnectError",defaultMessage:"Failed to disconnect Google Drive. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(X.Z,{onClick:Y.rN,children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.disconnectModal.closeSnackbarError",defaultMessage:"Close"})})}),ae.X.setState({...e,screenToShow:"error",isDisconnecting:!1}))})()},children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect Google Drive"})}),(0,N.jsx)(X.Z,{style:o.goBackButton,onClick:()=>{(0,te.j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_back_button",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),s("settings_screen")},children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.disconnectModal.goBack",defaultMessage:"Go back"})})]})]})})})};var de=n(89036),ce=n(401436),ue=n(568785),pe=n(830179);const ge=function(){const e=(0,a.VK)((()=>ae.X.state),[]),t=(0,a.VK)((()=>{var e;return null===(e=se.default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),[n,o]=(0,s.useState)(!1),r=(0,i.O7)(),[{status:l,value:d={syncedDrives:[],enableSyncingFutureDrives:!1}}]=(0,W.r5)((async()=>{if(!t)return{syncedDrives:[],enableSyncingFutureDrives:!1};const e=await Q.getSyncControlsForGoogleDriveAIIngestion(r,{spaceId:t});return"success"===e.type?(o(!0),{syncedDrives:e.data.drives,enableSyncingFutureDrives:e.data.enableSyncingFutureDrives}):(o(!1),Y.oV({label:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.settingsModal.userError",defaultMessage:"Cannot disconnect Google Drive. Please contact Notion workspace admin."}),position:"bottom",style:{width:"600px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(X.Z,{onClick:Y.rN,children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.settingsModal.closeSnackbarError",defaultMessage:"Close"})})}),{syncedDrives:[],enableSyncingFutureDrives:!1})}),[r,t]),c=t=>{ae.X.setState({...e,screenToShow:t})},u=(0,g.yK)((e=>({wrapper:{width:400,height:478},googleDriveDetailsContainer:{width:352,height:293,fontSize:14,fontWeight:$.Z.fontWeight.regular,color:e.v2.text.secondary},googleDriveDetailsWrapper:{justifyContent:"center",paddingTop:"24px"},driveNamesContainer:{paddingTop:"12px",gap:2,color:e.v2.text.primary},footer:{position:"absolute",justifyContent:"center",alignItems:"center",bottom:0,width:"100%",padding:"20px 20px 20px 20px",gap:8},disconnectButton:{fontSize:14,fontWeight:$.Z.fontWeight.medium,width:"100%"},moreDrivesContainer:{padding:"4px 0px 4px 0px",gap:8},learnMoreButton:{fontSize:14,fontWeight:$.Z.fontWeight.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:$.Z.fontWeight.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${e.v2.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:$.Z.fontWeight.semibold,color:e.v2.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:$.Z.fontWeight.regular,color:e.v2.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:$.Z.fontWeight.regular,color:e.v2.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:$.Z.fontWeight.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:$.Z.fontWeight.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,justifyContent:"center",alignItems:"center"},driveItemWrapper:{width:"100%",padding:"4px 0px 4px 0px",alignItems:"center"},driveName:{fontSize:14},driveIcon:{width:20,color:e.v2.text.secondary},title:{fontSize:14,fontWeight:$.Z.fontWeight.medium,justifyContent:"center"}})),[]);return(0,N.jsx)(oe.Z,{showCloseIcon:!0,open:!0,onDismiss:()=>{(0,te.j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),c("none")},render:()=>{var t;return(0,N.jsxs)("div",{style:u.wrapper,children:[(0,N.jsx)(pe.V,{integrationLogoIcon:z,title:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDrive.settingsModalTitle",defaultMessage:"Google Drive is connected to Notion AI"}),overrideStyles:{title:u.title}}),"resolved"!==l&&"rejected"!==l?(0,N.jsx)(ee.gq,{style:u.spinner,children:(0,N.jsx)(ue.Z,{})}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ee.gq,{style:u.googleDriveDetailsWrapper,children:(0,N.jsxs)(ee.Ht,{style:u.googleDriveDetailsContainer,children:[(0,N.jsx)("div",{children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI is connected and can answer questions with content from {driveCountMessage}{futureDrivesMessage}",values:{driveCountMessage:d.syncedDrives.length?`${d.syncedDrives.length} Google Drives`:"Google Drive",futureDrivesMessage:d.enableSyncingFutureDrives?", including future drives and users.":"."}})}),(0,N.jsxs)(ee.Ht,{style:u.driveNamesContainer,children:[d.enableSyncingFutureDrives&&(0,N.jsxs)(ee.gq,{style:u.driveItemWrapper,children:[(0,N.jsx)(ee.Ht,{style:u.driveIcon,children:(0,de.v)({width:14,height:14})}),(0,N.jsx)(ee.Ht,{style:u.driveName,children:(0,N.jsx)("div",{children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.settingsModal.includeCurrentAndFutureDrives",defaultMessage:"Includes current and future drives"})})})]}),null===(t=d.syncedDrives.slice(0,4))||void 0===t?void 0:t.map((e=>(0,N.jsx)("div",{children:(0,N.jsxs)(ee.gq,{style:u.driveItemWrapper,children:[(0,N.jsx)(ee.Ht,{style:u.driveIcon,children:(0,de.v)({width:14,height:14})}),(0,N.jsx)(ee.Ht,{style:u.driveName,children:`${e.name}`})]})},e.id)))]}),d.syncedDrives.length-4>0?(0,N.jsx)(ee.gq,{style:u.moreDrivesContainer,children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.settingsModal.moreDrives",defaultMessage:"... and {moreDriveCount} more",values:{moreDriveCount:d.syncedDrives.length-4}})}):(0,N.jsx)(N.Fragment,{})]})}),(0,N.jsxs)(ee.Ht,{style:u.footer,children:[(0,N.jsx)(re.Z,{isGray:!0,style:u.disconnectButton,disabled:!n,onClick:()=>{(0,te.j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),c("disconnect_screen")},children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.settingsModal.disconnectGoogleDrive",defaultMessage:"Disconnect"})}),(0,N.jsx)(X.Z,{style:u.learnMoreButton,onClick:()=>{(0,te.j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_learn_more_url_click",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),(()=>{const e=ie.default.getConfigKey("ingestion","googleDrive"),t=null==e?void 0:e.learnMoreUrl;t&&window.open(t,"_blank")})()},children:(0,N.jsxs)(ee.gq,{style:u.learnMoreText,children:[(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"}),(0,ce.g)(u.externalLinkIcon)]})})]})]})]})}})};var me=n(726139);const he=function(e){const{onPrimaryButtonClick:t,title:n,description:s,onDismiss:i,primaryButtonText:a,styles:o,hidePrimaryButtonIcon:r}=e;return(0,N.jsx)(oe.Z,{showCloseIcon:!0,onDismiss:i,open:!0,render:()=>(0,N.jsxs)("div",{style:o.wrapper,children:[(0,N.jsx)(pe.V,{integrationLogoIcon:z,title:n,subtext:s}),t&&(0,N.jsx)(ee.Ht,{style:o.footer,children:(0,N.jsxs)(re.Z,{style:o.connectButton,onClick:()=>{t()},children:[a,!r&&(0,N.jsx)("div",{style:o.iconWrapper,children:(0,me.K)()})]})})]})})};var fe=n(844495),ye=n(128495),xe=n(500091),ve=n(526774),Se=n(531701),be=n(260458),Ce=n(661519),je=n(573063),ke=n(436488),we=n(256940),Ie=n(374194),Me=n(526388);function Te(e){const{user:t,styles:n,handleUserCheck:s}=e;return(0,N.jsxs)(ee.gq,{gap:8,style:{alignItems:"center",padding:"6px 18px 6px 8px"},children:[(0,N.jsx)(be.Z,{checked:t.checked,checkSize:10,size:14,onClick:()=>s(t.id)}),(0,N.jsx)("div",{style:n.usersRow,children:`${t.name} `},`${t.id}#3`),(0,N.jsx)("div",{style:n.userRowAdditionalText,children:`${t.email}`})]})}function Ae(e){const{drive:t,styles:n,handleDriveCheck:s}=e;return(0,N.jsxs)(ee.gq,{gap:8,style:{alignItems:"center",padding:"6px 18px 6px 8px"},children:[(0,N.jsx)(be.Z,{checked:t.checked,checkSize:10,size:14,onClick:()=>s(t.id)}),(0,N.jsx)("div",{style:n.drivesRow,children:`${t.name}`},`${t.id}#3`)]})}function Pe(e){const{styles:t,drives:n,users:r,isLoading:l,onPrimaryButtonClick:d}=e,c=n.map((e=>({...e,checked:!0}))),u=r.map((e=>({...e,checked:!0}))),[p,g]=(0,s.useState)(!0),[m,h]=(0,s.useState)(!0),[f,y]=(0,s.useState)(""),[x,v]=(0,s.useState)(c),[S,C]=(0,s.useState)(u),[j,k]=(0,s.useState)(!0),[w,I]=(0,s.useState)(!0),[M,T]=(0,s.useState)(!0),[A,P]=(0,s.useState)(!0),B=(0,i.O7)(),_=(0,a.VK)((()=>ae.X.state),[]);(0,s.useEffect)((()=>{const e=e=>{const t=e.every((e=>e.checked)),n=e.every((e=>!e.checked));return!!t||!n&&"partial"},t=e(S),n=e(x);T(t),I(n),k(!0===t&&!0===n||(!1!==t||!1!==n)&&"partial")}),[x,S]);const F=x.find((e=>e.checked))||S.find((e=>e.checked)),Z=e=>{(0,te.j)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"individual_drive_checkbox",integration_type:"google_drive",setup_session_id:_.sessionId,from:_.analyticsFrom}}});const t=x.map((t=>t.id===e?{...t,checked:!t.checked}:t));v(t)},V=e=>{(0,te.j)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"individual_user_checkbox",integration_type:"google_drive",setup_session_id:_.sessionId,from:_.analyticsFrom}}});const t=S.map((t=>t.id===e?{...t,checked:!t.checked}:t));C(t)},R=x.map((e=>{if(""===f||e.name.toLowerCase().includes(f.toLowerCase()))return(0,N.jsx)(Ae,{drive:e,styles:t,handleDriveCheck:Z},e.id)})).filter(o.$K),L=S.map((e=>{if(""===f||e.name.toLowerCase().includes(f.toLowerCase())||e.email.toLowerCase().includes(f.toLowerCase()))return(0,N.jsx)(Te,{handleUserCheck:V,styles:t,user:e},e.id)})).filter(o.$K);return(0,N.jsxs)(ee.Ht,{children:[(0,N.jsx)(ee.gq,{style:t.searchBarWrapper,children:(0,N.jsx)(Ie.Z,{style:t.searchBar,id:"search.users",format:Ie.B.Default,type:"text",placeholder:"Search for Shared Drive or User",value:f,showClearButton:!0,onChange:e=>{e.stopPropagation(),e.preventDefault(),(0,te.j)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"search_input_box",integration_type:"google_drive",setup_session_id:_.sessionId,from:_.analyticsFrom}}}),y(e.target.value)}})}),(0,N.jsx)(ee.gq,{style:t.selectionWrapper,children:(0,N.jsxs)(ee.Ht,{style:t.selection,children:[(0,N.jsxs)(ee.gq,{gap:8,style:{alignItems:"center"},children:[(0,N.jsx)(be.Z,{checked:j,checkSize:10,size:14,disabled:!!f,style:{background:f?Se.ZP.uiLightGray:j?Se.ZP.blue:""},onClick:()=>{const e=!j;(0,te.j)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:`all_drive_and_users_checkbox_${e.toString()}`,integration_type:"google_drive",setup_session_id:_.sessionId,from:_.analyticsFrom}}}),k(e),v(x.map((t=>({...t,checked:e})))),C(S.map((t=>({...t,checked:e}))))}}),z({width:20}),(0,N.jsxs)(ee.gq,{style:{fontSize:14,lineHeight:"18px",letterSpacing:"-0.15px"},children:[f?(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.filteredItems",defaultMessage:"Filtered Drives and Users"}):(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.allItems",defaultMessage:"All Drives and Users"}),(0,N.jsx)("div",{style:{paddingLeft:2,fontSize:12,color:Se.ZP.PendingInvitationTextColor},children:`(${R.length+L.length})`})]})]}),(0,N.jsx)(Ce.Z,{style:{marginTop:12},size:4}),(0,N.jsxs)(ee.Ht,{style:t.scrollContainer,children:[R.length?(0,N.jsx)(Be,{headerTitle:"Shared Drives",headerIcon:ve.O,itemLength:R.length,collapseState:p,setCollapsedState:g,checkboxChecked:w,handleHeaderCheckboxClick:()=>{const e=!w;(0,te.j)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:`all_drive_header_checkbox_${e.toString()}`,integration_type:"google_drive",setup_session_id:_.sessionId,from:_.analyticsFrom}}}),I(e),v(n.map((t=>({...t,checked:e}))))},inputSearchValue:f}):null,!p&&(0,N.jsx)(ee.Ht,{children:R}),L.length?(0,N.jsx)(Be,{headerTitle:"Managed by members",headerIcon:ye.v,itemLength:L.length,collapseState:m,infoTooltip:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.tooltip",defaultMessage:"Notion respects each files privacy settings"})}),(0,N.jsx)("div",{style:{fontWeight:"normal"},children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.tooltip.description",defaultMessage:"AI answers only include information that each member can access"})})]}),setCollapsedState:h,checkboxChecked:M,handleHeaderCheckboxClick:()=>{const e=!M;(0,te.j)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:`all_users_header_checkbox_${e.toString()}`,integration_type:"google_drive",setup_session_id:_.sessionId,from:_.analyticsFrom}}}),T(e),C(r.map((t=>({...t,checked:e}))))},inputSearchValue:f}):null,!m&&(0,N.jsx)(ee.Ht,{children:L})]})]})}),(0,N.jsxs)(ee.Ht,{style:t.footer,children:[(0,N.jsxs)(ee.gq,{style:{gap:4,alignItems:"center",width:"-webkit-fill-available"},children:[(0,N.jsx)(be.Z,{checked:A,checkSize:10,size:14,onClick:()=>{(0,te.j)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:`future_items_checkbox_${(!A).toString()}`,integration_type:"google_drive",setup_session_id:_.sessionId,from:_.analyticsFrom}}}),P(!A)}}),(0,N.jsx)("div",{style:{fontSize:12,lineHeight:"16px",paddingBottom:2},children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.allDrivesAndUsers",defaultMessage:"Add all future drives and users"})})]}),(0,N.jsx)(re.Z,{style:t.continueButton,isLoading:l,onClick:()=>{let e=!0;A&&(e=!1);const t=[];x.forEach((n=>{if(n.checked===e){const{checked:e,...s}=n;t.push({...s})}}));const n=[];S.forEach((t=>{if(t.checked===e){const{checked:e,...s}=t;n.push({...s})}})),(0,te.j)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drive_and_user_selector_primary_button",integration_type:"google_drive",setup_session_id:_.sessionId,from:_.analyticsFrom}}}),d(A,t,n)},disabled:!F,children:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.continue",defaultMessage:"Continue"})})]})]})}function Be(e){const{headerTitle:t,headerIcon:n,itemLength:s,inputSearchValue:i,checkboxChecked:a,handleHeaderCheckboxClick:o,setCollapsedState:r,collapseState:l,infoTooltip:d}=e,c=!!i;return(0,N.jsx)(ee.gq,{style:{height:40},children:(0,N.jsxs)(ee.gq,{gap:8,style:{alignItems:"center",height:40},children:[(0,N.jsx)(be.Z,{checked:a,checkSize:10,size:14,onClick:o,disabled:c,style:{background:c?Se.ZP.uiLightGray:a?Se.ZP.blue:""}}),n({width:20,color:"#91918E"}),(0,N.jsxs)(ee.gq,{style:{fontSize:14,lineHeight:"18px",letterSpacing:"-0.15px"},children:[t,(0,N.jsx)("div",{style:{paddingLeft:2,fontSize:12,color:Se.ZP.PendingInvitationTextColor},children:`(${s})`})]}),d&&(0,N.jsx)(Me.Z,{allowHover:!0,textWrap:!0,renderTooltip:()=>d,style:{width:200},render:e=>(0,N.jsx)(je.Z,{...e,icon:fe.D,ariaLabel:"Info Icon"})}),(0,N.jsx)(je.Z,{icon:xe.L,ariaLabel:"collapse toggle",onClick:()=>r((e=>!e)),style:{transform:l?"rotate(90deg)":"rotate(180deg)",transition:"transform 200ms ease-out",width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}})]})})}const _e=function(e){const t=(0,g.yK)((e=>({wrapper:{width:400,height:585},scrollContainer:{overflow:"auto",height:250},usersRow:{fontSize:14,lineHeight:"18px",letterSpacing:"-0.15px",whiteSpace:"nowrap"},userRowAdditionalText:{fontSize:12,color:Se.ZP.PendingInvitationTextColor,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},drivesRow:{fontSize:14,lineHeight:"18px",letterSpacing:"-0.15px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},footer:{position:"absolute",justifyContent:"center",alignItems:"center",bottom:0,width:"100%",height:75,boxShadow:e.mediumBoxShadow,padding:"16px 20px 16px 20px",gap:6},continueButton:{fontSize:14,fontWeight:$.Z.fontWeight.semibold,width:360},searchBarWrapper:{marginTop:24,justifyContent:"center"},searchBar:{width:360,padding:4},selectionWrapper:{marginTop:24,justifyContent:"center"},selection:{width:360,height:263,marginBotton:12}})),[]),n=(0,a.VK)((()=>ae.X.getState().drivesAndUserData),[]);if(!n.length)return null;const s=n.filter((e=>"shared_drive"===e.type)),i=n.filter((e=>"user_owned_files"===e.type)),o=(0,N.jsx)(Pe,{styles:t,drives:s,users:i,isLoading:e.isLoading||!1,onPrimaryButtonClick:e.onPrimaryButtonClick});return(0,N.jsx)(ke.Z,{capture:!0,allowEsc:!0,render:e=>(0,N.jsx)(we.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>(0,N.jsx)(oe.Z,{showCloseIcon:!0,onDismiss:()=>{ae.X.setState({...ae.X.state,screenToShow:"none"})},open:!0,render:()=>(0,N.jsxs)("div",{style:t.wrapper,children:[(0,N.jsx)(pe.V,{integrationLogoIcon:z,title:"Select Drives to Connect",subtext:"Connecting more content will give you more relevant and useful Notion AI responses"}),o]})})})})};var Fe=n(18550);const Ze=s.forwardRef(((e,t)=>{var n,s;const o=(0,i.O7)(),r=(0,a.VK)((()=>ae.X.state.screenToShow),[]),l=(0,a.VK)((()=>{var e;return null===(e=se.default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),d=(0,a.VK)((()=>ae.X.state.sessionId),[]),c=(0,g.yK)((e=>({icon:{width:16,display:"inline-block"},wrapper:{width:400,height:"service_account_not_added"===r||"error"===r?250:290},footer:{position:"absolute",justifyContent:"center",alignItems:"center",bottom:0,width:"100%",height:60,boxShadow:e.mediumBoxShadow,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:$.Z.fontWeight.semibold,width:"100%"},iconWrapper:{width:16,height:16},chevronRightIcon:{width:14,height:14,fill:e.lightIconColor}})),[r]),u=(0,a.VK)((()=>o.device.isPhone),[o]),p=(0,a.VK)((()=>ae.X.state.initialSyncState),[]),m=(0,a.VK)((()=>ae.X.state.isDisconnecting),[]),f=(0,a.VK)((()=>ae.X.state.analyticsFrom),[]),y=(0,W.r5)((async()=>{if(!l)throw new Error("SpaceId not found");const e=await Q.getGoogleDriveSyncStatus(o,{spaceId:l});if("success"!==e.type)throw console.error(e),new Error("GoogleDriveInitialSyncStatus failed.");ae.X.setState({...ae.X.state,initialSyncState:e.data.initialSyncStatus,isDisconnecting:e.data.isDisconnecting})}),[o,l]),x=(0,N.jsx)("img",{src:D.Z.images.googleDriveLogoPng,style:c.icon}),v={...e,ref:t,loading:"resolved"!==(null===(n=y[0])||void 0===n?void 0:n.status),icon:x,title:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleDriveIngestion.connectGoogleDrive",defaultMessage:"Connect Google Drive"})};return(0,N.jsxs)(N.Fragment,{children:[Oe(r,c),"not_started"===p||"none"===p?(0,N.jsx)(k.Z,{...v,disabled:"resolved"!==(null===(s=y[0])||void 0===s?void 0:s.status),onClick:()=>{const e="chat_menu",t=q.Il();ae.X.setState({...ae.X.state,sessionId:t,analyticsFrom:e}),(0,te.j)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connect_google_drive_info_screen",integration_type:"google_drive",setup_session_id:t,from:e}}}),Ve("info_screen")}}):(0,N.jsx)(J.Z,{...e,stopClickPropagation:!0,popupType:u?w.Z4.SlideUp:w.Z4.Popup,render:()=>(0,N.jsx)(Re,{initialSyncState:p,isDisconnecting:m}),placementToOrigin:w.pO.Left,renderOrigin:t=>(0,N.jsx)(k.Z,{...v,...(0,ne.Z)(e,t),right:(0,h.o)(c.chevronRightIcon)}),onClick:()=>{(0,te.j)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completed"===p?"connect_google_drive_connected_chevron":"connect_google_drive_in_progress_chevron",integration_type:"google_drive",setup_session_id:d,from:f}}})}})]})}));function Ve(e){ae.X.setState({...ae.X.state,screenToShow:e})}function Re(e){const{initialSyncState:t,isDisconnecting:n}=e,s=(0,g.yK)((e=>({icon:{width:16,height:16},caption:{color:e.lightTextColor,fontSize:12,textWrap:"wrap"},option:{paddingTop:4,paddingBottom:4},optionLabel:{fontSize:14,marginBottom:2},disabledOptionLabel:{color:e.lightTextColor,fontSize:14,marginBottom:2},iconWrapper:{width:14,paddingTop:4}})),[]),i=[{key:"google-connection-section",render:e=>(0,N.jsx)(A.Z,{...e}),items:[{key:"google-drive-ingestion-status-connecting",label:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleIngestion.connecting",defaultMessage:"Connecting"}),caption:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleIngestion.subtext",defaultMessage:"This can take up to 48 hours"}),disabled:!0,hidden:"in_progress"!==t||n,action:()=>{}},{key:"google-drive-ingestion-status-connected",label:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleIngestion.connected",defaultMessage:"Connected"}),caption:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleIngestion.connected.subtext",defaultMessage:"Connected by workspace owner"}),icon:G.k,disabled:!1,hidden:"completed"!==t||n,action:()=>{}},{key:"google-drive-ingestion-status-disconnecting",label:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleIngestion.disconnecting",defaultMessage:"Disconnecting..."}),caption:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleIngestion.disconnecting.subtext",defaultMessage:"This can take upto 3h."}),disabled:!0,hidden:!n,action:()=>{}},{key:"google-drive-ingestion-settings",label:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleIngestion.settings",defaultMessage:"Settings"}),icon:U.H,disabled:n,hidden:"completed"!==t||n,action:()=>{Ve("settings_screen")}}].filter((e=>!e.hidden)).map((e=>{let{key:t,label:n,caption:i,icon:a,disabled:o,action:r}=e;return{key:t,action:()=>{r()},render:e=>(0,N.jsx)(k.Z,{...e,title:(0,N.jsx)(ee.gq,{children:(0,N.jsxs)("div",{style:s.option,children:[(0,N.jsx)("div",{style:o?s.disabledOptionLabel:s.optionLabel,children:n}),i&&(0,N.jsx)("div",{style:s.caption,children:i})]})}),left:a&&a({width:12,height:12}),disabled:o})}}))}];return(0,N.jsx)(I.Z,{menuType:_.og.Popup,width:208,children:(0,N.jsx)(M.Z,{type:M.i.Vertical,sections:i,initialFocus:void 0})})}function Le(e){const{styles:t}=e;return(0,N.jsx)(he,{title:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDrive.accountNotAdded.title",defaultMessage:"First, get your Google Workspace ready"}),description:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDrive.accountNotAdded.description",defaultMessage:"Before linking Google Drive with Notion, you'll need to modify a few settings in your Google Workspace."}),onDismiss:()=>Ve("none"),onPrimaryButtonClick:()=>{const e=ie.default.getConfigKey("ingestion","googleDrive"),t=null==e?void 0:e.learnMoreUrl;window.open(t,"_blank")},primaryButtonText:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.integration.seeInstruction",defaultMessage:"See instructions"}),styles:t})}function Ee(e){const{styles:t}=e;return(0,N.jsx)(he,{title:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDrive.error.title",defaultMessage:"Oops! Something went wrong"}),description:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDrive.error.description",defaultMessage:"Something went wrong, please try again later."}),onDismiss:()=>Ve("none"),primaryButtonText:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDrive.error.Dismiss",defaultMessage:"Close"}),hidePrimaryButtonIcon:!0,onPrimaryButtonClick:()=>{Ve("none")},styles:t})}function Ke(e){const{styles:t}=e;return(0,N.jsx)(he,{title:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDrive.notAdmin.title",defaultMessage:"Only Google Workspace Administrators can connect"}),description:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDrive.notAdmin.description",defaultMessage:"We can't verify that this account is a Google Workspace Administrator. Please contact your admin to link Notion using their account."}),onDismiss:()=>Ve("none"),onPrimaryButtonClick:()=>{const e=ie.default.getConfigKey("ingestion","googleDrive"),t=null==e?void 0:e.learnMoreUrl;window.open(t,"_blank")},primaryButtonText:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDrive.notAdmin.learnMore",defaultMessage:"Learn more"}),styles:t})}function Oe(e,t){switch(e){case"info_screen":return(0,N.jsx)(De,{});case"loading_screen":return(0,N.jsx)(De,{isLoading:!0});case"service_account_not_added":return(0,N.jsx)(Le,{styles:t});case"not_admin_screen":return(0,N.jsx)(Ke,{styles:t});case"select_drives_and_users_screen":return(0,N.jsx)(We,{});case"settings_screen":return(0,N.jsx)(ge,{});case"disconnect_screen":return(0,N.jsx)(le,{});case"error":return(0,N.jsx)(Ee,{styles:t});case"none":return;default:(0,o.t1)(e)}}function De(e){const{isLoading:t}=e,n=(0,i.O7)(),s=(0,a.VK)((()=>{var e;return null===(e=se.default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),o=(0,a.VK)((()=>ae.X.state.sessionId),[]),r=(0,a.VK)((()=>ae.X.state.analyticsFrom),[]),l=(0,F.J)();return(0,O.Z)((()=>{(0,te.j)({environment:n,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"google_drive",setup_session_id:o,from:r,is_space_admin:l}}})})),(0,N.jsx)(Fe.Z,{integrationIcon:z,notes:[(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleDriveIngestion.connectGoogleDrive.listpoint1",defaultMessage:"Only Google Workspace admins can connect."},"note1"),(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleDriveIngestion.connectGoogleDrive.listpoint2",defaultMessage:"Only approved drives are connected."},"note2"),(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleDriveIngestion.connectGoogleDrive.listpoint3",defaultMessage:"Notion respects permissions on Google Drive. Members will only see content they have access to."},"note3"),(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleDriveIngestion.connectGoogleDrive.listpoint4",defaultMessage:"Verify the source of Notion AIs answers with citations."},"note4"),(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleDriveIngestion.connectGoogleDrive.listpoint5",defaultMessage:"Your Google Drive data is not used to train Notion AI."},"note5")],onLearnMore:()=>{const e=ie.default.getConfigKey("ingestion","googleDrive"),t=null==e?void 0:e.learnMoreUrl;window.open(t,"_blank")},onConnect:async()=>{s&&await async function(e,t,n,s){(0,te.j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:"google_drive",setup_session_id:n,from:s}}}),Ve("loading_screen");const i=await Q.connectGoogleDriveForAIIngestion(e,{spaceId:t});if("success"===i.type){var a,o,r;null!==(a=i.data)&&void 0!==a&&a.connectionSuccess?((0,te.j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect_select_drives_and_users_screen",integration_type:"google_drive",setup_session_id:n,from:s}}}),ae.X.setState({...ae.X.state,screenToShow:"select_drives_and_users_screen",drivesAndUserData:i.data.syncControlOptions})):401===(null==i||null===(o=i.data)||void 0===o||null===(o=o.errorResponse)||void 0===o?void 0:o.status)?((0,te.j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect_service_account_not_added",integration_type:"google_drive",setup_session_id:n,from:s}}}),Ve("service_account_not_added")):403===(null==i||null===(r=i.data)||void 0===r||null===(r=r.errorResponse)||void 0===r?void 0:r.status)?((0,te.j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect_not_admin_screen",integration_type:"google_drive",setup_session_id:n,from:s}}}),Ve("not_admin_screen")):(console.error(i),(0,te.j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect_error",integration_type:"google_drive",setup_session_id:n,from:s}}}),Ve("error"))}else(0,te.j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect_error",integration_type:"google_drive",setup_session_id:n,from:s}}}),Ve("error")}(n,s,o,r)},onDismiss:()=>{(0,te.j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_dismiss",integration_type:"google_drive",setup_session_id:o,from:r}}}),Ve("none")},title:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.googleDriveTitle",defaultMessage:"Get answers from Google Drive without leaving Notion"}),sampleMessage:(0,N.jsx)(b.FormattedMessage,{id:"universalSearch.googleDriveIngestion.googleDriveTitle.sample",defaultMessage:"I found 3 documents in Drive that are related to this Notion page"}),isLoading:t,titleWidth:352,open:!0})}function We(){const[e,t]=(0,s.useState)(!1),n=(0,a.VK)((()=>{var e;return null===(e=se.default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),o=(0,i.O7)();return(0,N.jsx)(_e,{onPrimaryButtonClick:async(e,s,i)=>{if(!n)return;const a=[...s,...i];t(!0);const r=await Q.patchSyncControlsForGoogleDriveAIIngestion(o,{spaceId:n,exclusionList:e?a:[],inclusionList:e?[]:a});if("success"===r.type&&r.data.patchSuccess){const e=await Q.startGoogleDriveSyncForAIIngestion(o,{spaceId:n});"success"===e.type&&e.data.connectionSuccess?(Y.oV({label:(0,N.jsx)(b.FormattedMessage,{id:"googleIngestionConfirmation.ingestion.acknowledge",defaultMessage:"Started syncing from Google drive. This can take up to 48 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(X.Z,{onClick:Y.rN,children:(0,N.jsx)(b.FormattedMessage,{id:"googleIngestionConfirmation.ingestion.startedMessageDismiss",defaultMessage:"Close"})})}),ae.X.setState({...ae.X.state,initialSyncState:"in_progress",screenToShow:"none"})):(console.error(e),Ve("error"))}else console.error(r),Ve("error");t(!1)},isLoading:e,description:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleDriveIngestion.connectGoogleDrive.adminOnly",defaultMessage:"Only Google Workspace admins can connect."},"note1"),onDismiss:()=>{},primaryButtonText:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleDriveIngestion.connectGoogleDrive.adminOnlyButton",defaultMessage:"Only Google Workspace admins can connect."},"note2"),title:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.googleDriveIntegration.connectGoogleDrive.adminOnlyTitle",defaultMessage:"Only Google Workspace admins can connect."},"note3")})}Ze.displayName="ConnectGoogleDriveButton";var He=n(324600),Ne=n(91376),ze=n(244458),Ue=n(915560),Ge=n(465753),qe=n(427245),$e=n(343121),Qe=n(788507),Ye=n(937612),Xe=n(247839),Je=n(215356),et=n(390837);const tt=(0,b.defineMessages)({userOverwritePopupTitle:{id:"slackConnectionOptions.overwriteEmail.title",defaultMessage:"User Authorization"}});function nt(e){let{parent:t}=e;const n=(0,i.O7)(),o=(0,F.J)(),r=(0,g.yK)((e=>({icon:{width:16,height:16},caption:{color:e.lightTextColor,fontSize:12,textWrap:"wrap"},option:{paddingTop:4,paddingBottom:4},optionLabel:{fontSize:14,marginBottom:2},disabledOptionLabel:{color:e.lightTextColor,fontSize:14,marginBottom:2},iconWrapper:{paddingTop:4}})),[]),l=(0,a.VK)((()=>se.default.state.currentSpaceStore),[]),d=(0,a.VK)((()=>et.y.state.isPublicSync),[]),c=(0,a.VK)((()=>et.y.state.isPrivateSync),[]),u=(0,a.VK)((()=>et.y.state.sessionId),[]),[p,m]=s.useState(!0),[h,f]=s.useState(!1),[y,x]=s.useState([]),v=(0,a.VK)((()=>{var e;return null===(e=se.default.getState().currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),S=(0,a.VK)((()=>et.y.state.isDisconnecting),[]),j=(0,a.VK)((()=>et.y.state.analyticsFrom),[]),[w,T]=(0,s.useState)(!0);(0,O.Z)((async()=>{const e=null==l?void 0:l.id;if(!e)return;const t=await Q.getSlackBulkIngestionStatus(n,{spaceId:e});"success"===t.type&&et.y.setState({...et.y.state,...t.data});const s=await Q.getConnectedAppsForUniversalQna(n,{spaceId:e});"success"===s.type&&x(s.data.connectedApps);const i=await Q.canUserQuerySlack(n,{spaceId:e});"success"===i.type&&(T(i.data.canQuery),et.y.setState({...et.y.state,canQuery:i.data.canQuery})),m(!1)})),(0,W.r5)((async()=>{if(!v)return;const e=await Q.allowPrivateSlackIngestion(n,{spaceId:v});"success"===e.type&&f(e.data.allow)}),[n,v]);const P=(0,a.VK)((()=>y.includes("slack-admin")),[y]),B=(0,a.VK)((()=>y.includes("slack")),[y]),Z=(0,a.VK)((()=>{const e=ie.default.getConfigKey("ingestion","slack");return(null==e?void 0:e.userScopes.length)>0}),[]),V=[{key:"slack-connection-section",render:e=>(0,N.jsx)(A.Z,{...e}),items:[{key:"slack-ingestion-admin-auth",label:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.adminAuth",defaultMessage:"Public conversations"}),caption:st(o,y,d,S),icon:(0,Qe.I)(r.icon),disabled:Boolean(!o||P||S),connected:P,hidden:!1,action:()=>{v&&((0,ze.navigateToSlackUniversalQnAOnboarding)({analyticsFrom:"chat_menu"}),(0,te.j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connect_public_slack",integration_type:"slack",setup_session_id:u,from:j}}}))}},{key:"slack-ingestion-user-auth",label:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.userAuth",defaultMessage:"Private conversations"}),caption:c?(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.privateConnectionInProgress",defaultMessage:"Connecting. This can take up to 36 hours."}):B?(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.connectedByYou",defaultMessage:"Connected by you"}):(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.userCaption",defaultMessage:"Connect to enhance your AI results"}),icon:(0,ye.v)(r.icon),disabled:!1,connected:B,hidden:Boolean(!P||Boolean(y.includes("slack-admin")&&d)||!h||!Z||S),action:async()=>{if(v)if(B){"success"===(await Q.disconnectSlackIngestion(n,{spaceId:v,disconnectForWorkspace:!1})).type&&x((e=>e.filter((e=>"slack"!==e)))),(0,te.j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_private_slack",integration_type:"slack",setup_session_id:u,from:j}}})}else{const e=await Q.getSlackIngestionAuthorizeUrl(n,{spaceId:v,isAdminAuth:!1,isDesktopApp:n.device.isElectron});"success"===e.type&&window.open(e.data.url,"_blank"),(0,te.j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connect_private_slack",integration_type:"slack",setup_session_id:u,from:j}}})}}},{key:"slack-overwrite-email",label:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.overWriteEmail",defaultMessage:"Log in to Slack"}),caption:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.overWriteEmailCaption",defaultMessage:"We couldn't verify your Slack e-mail. Click to authenticate."}),icon:(0,$e.f)(r.icon),disabled:!1,connected:B,hidden:!P||w,action:async()=>{if(!v)return;(0,te.j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connect_slack_user_mapping",integration_type:"slack",setup_session_id:u,from:j}}});const e=await Q.getSlackIngestionAuthorizeUrl(n,{spaceId:v,isAdminAuth:!1,isDesktopApp:n.device.isElectron,isUserMapping:!0});"success"===e.type&&(n.device.isElectron?Xe.openExternalUrl(e.data.url):await Je.M(n,{width:800,height:600,url:e.data.url,titleMessage:tt.userOverwritePopupTitle}))}},{key:"slack-overwrite-email-logout",label:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.overWriteEmailLogout",defaultMessage:"Disconnect your account"}),caption:(0,N.jsx)(N.Fragment,{}),icon:(0,Ye.y)(r.icon),disabled:!1,connected:!1,hidden:!y.includes("slack-user-mapping"),action:async()=>{if(!v)return;t.close();const{accept:e}=await C.confirmUserActionV2({message:(0,N.jsxs)(ee.Ht,{gap:8,children:[(0,N.jsx)("div",{style:{fontWeight:$.Z.fontWeight.semibold,fontSize:18},children:(0,N.jsx)(b.FormattedMessage,{id:"universalQna.slackChannelSelection.disconnectOverwriteHeader",defaultMessage:"Are you sure?"})}),(0,N.jsx)("div",{style:{fontWeight:$.Z.fontWeight.regular},children:(0,N.jsx)(b.FormattedMessage,{id:"universalQna.slackChannelSelection.disconnectOverwriteNote1",defaultMessage:"Your Slack data will be permanently deleted from Notion."})}),(0,N.jsx)("div",{style:{fontWeight:$.Z.fontWeight.regular},children:(0,N.jsx)(b.FormattedMessage,{id:"universalQna.slackChannelSelection.disconnectOverwriteNote2",defaultMessage:"This process can take up to 3 hours, and you'll only be able to reconnect after disconnecting is complete."})})]}),acceptLabel:(0,N.jsx)(b.FormattedMessage,{id:"universalQna.slackChannelSelection.disconnectButtonLabel",defaultMessage:"Disconnect Slack"})});e&&((0,te.j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"slack_user_mapping_disconnect",integration_type:"slack",setup_session_id:u,from:j}}}),await Q.disconnectSlackIngestion(n,{spaceId:v,disconnectUserMapping:!0}))}}].filter((e=>!e.hidden)).map((e=>{let{key:n,label:s,caption:i,icon:a,disabled:o,connected:l,action:d}=e;return{key:n,action:async()=>{await d(),t.close()},render:e=>(0,N.jsx)(k.Z,{...e,title:(0,N.jsxs)(ee.gq,{gap:4,children:[(0,N.jsx)("div",{style:r.iconWrapper,children:a}),(0,N.jsxs)("div",{style:r.option,children:[(0,N.jsx)("div",{style:o?r.disabledOptionLabel:r.optionLabel,children:s}),(0,N.jsx)("div",{style:r.caption,children:i})]})]}),right:l&&(0,qe.U)({width:12,height:12}),disabled:o})}}))}];return y.includes("slack-admin")&&o&&!d&&!S&&V.push({key:"slack-settings-section",render:e=>(0,N.jsx)(A.Z,{...e,topBorder:!0}),items:[{key:"slack-settings",action:()=>{v&&(et.y.setState({...et.y.state,currentScreen:"settings"}),t.close())},render:e=>(0,N.jsx)(k.Z,{...e,title:(0,N.jsxs)(ee.gq,{gap:4,children:[(0,N.jsx)("div",{style:r.iconWrapper,children:(0,U.H)(r.icon)}),(0,N.jsx)("div",{style:r.option,children:(0,N.jsx)("div",{style:r.optionLabel,children:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.settings",defaultMessage:"Settings"})})})]})})}]}),(0,N.jsx)(I.Z,{menuType:_.og.Popup,width:220,children:p?(0,N.jsx)(ee.gq,{style:{padding:8,justifyContent:"center"},children:(0,N.jsx)(ue.Z,{})}):(0,N.jsx)(M.Z,{type:M.i.Vertical,sections:V,initialFocus:void 0})})}function st(e,t,n,s){return e?s?(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.disconnectingPublicSlack",defaultMessage:"Disconnecting. This can take up to 3 hours."}):n?(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.connectingPublicSlack",defaultMessage:"Connecting. This can take up to 36 hours."}):t.includes("slack-admin")?(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.connectedByWorkspaceOwner",defaultMessage:"Connected by workspace owner"}):(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.connectSlackToEnhanceResults",defaultMessage:"Connect to enhance your AI results"}):t.includes("slack-admin")?(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.connectedByWorkspaceOwner",defaultMessage:"Connected by workspace owner"}):(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.contactAdmin",defaultMessage:"Contact your workspace owner to connect"})}const it=s.forwardRef(((e,t)=>{const{buttonPopupParent:n,...o}=e,r=(0,i.O7)(),l=(0,a.VK)((()=>r.device.isPhone),[r]),d=(0,a.VK)((()=>se.default.state.currentSpaceStore),[]),[c,u]=s.useState(!1),[p,m]=s.useState(!1),f=(0,g.yK)((e=>({icon:{width:16,height:16},chevronRightIcon:{width:14,height:14,fill:e.lightIconColor}})),[]),y=(0,Ge.y)(),x=(0,F.J)(),v=(0,s.useCallback)((async()=>{const e="chat_menu",t=q.Il();if(!y)return x?Ne.r$({openedFrom:"slack_connect_button",currentTab:"plans"}):(0,ze.navigateToSlackUniversalQnAOnboarding)({analyticsFrom:e,sessionId:t}),void n.close();if(!d)return;u(!0);const s=await Q.getConnectedAppsForUniversalQna(r,{spaceId:d.getSpaceId()});if("success"!==s.type)return void u(!1);u(!1),(0,te.j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connect_slack",integration_type:"slack",setup_session_id:t,from:e}}});const i=s.data.connectedApps.includes("slack-admin");m(i),i||((0,ze.navigateToSlackUniversalQnAOnboarding)({analyticsFrom:e,sessionId:t}),n.close())}),[n,d,r,y,x]);return(0,N.jsx)(J.Z,{...o,stopClickPropagation:!0,disabled:c,onClick:v,popupType:l?w.Z4.SlideUp:w.Z4.Popup,render:e=>p?(0,N.jsx)(nt,{parent:e}):(0,N.jsx)(N.Fragment,{}),placementToOrigin:w.pO.Left,renderOrigin:e=>(0,N.jsx)(ke.Z,{capture:!0,allowEsc:!0,render:()=>(0,N.jsx)(we.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>(0,N.jsx)(k.Z,{...(0,ne.Z)(o,e),ref:t,icon:(0,He.P)(f.icon),badge:(0,N.jsx)(Ue.Z,{}),right:p?(0,h.o)(f.chevronRightIcon):c?(0,N.jsx)(ue.Z,{}):(0,N.jsx)(N.Fragment,{}),title:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.slackIngestion.connectSlack",defaultMessage:"Connect Slack"})})})})})}));function at(e){const{closeParentPopup:t,onSelectGetHelp:n,onSelectSeeHistory:o,buttonPopupParent:r}=e,d=(0,i.O7)(),{isElectron:u}=(0,i.Fy)(),p=(0,a.VK)((()=>l.default.getActiveSession()),[]),g=(0,s.useCallback)((async()=>{(!(p&&p.getAllPendingOperations().length>0)||await(0,c.confirmAndDiscardPendingEditsIfApplicable)({environment:d}))&&((0,R.hW)({environment:d,source:"corner"}),r.close())}),[r,d,p]),m=(0,s.useCallback)((()=>{(0,L.yc)(!(0,L.em)())||C.showErrorMessage((0,N.jsx)(N.Fragment,{children:"Failed to show the assistant debug bar because the change couldn't be saved to local storage. One possible cause is that you might have a 'notion_cookie_consent' cookie that doesn't allow 'preference' type storage."})),r.close()}),[r]),h={sections:[],nextSectionShouldHaveTopBorder:()=>h.sections.length>0,addSection(e){e&&this.sections.push(e)}};let f;return h.addSection(function(e){const{shouldShowTopBorder:t,closeParentPopup:n}=e,s=(0,i.O7)(),o=(0,a.VK)((()=>Z.Z.showScopedSearch()),[]),r=(0,i.Fy)();if(!o)return;const l=[{key:"findIn",action:()=>{},render:e=>(0,N.jsx)(rt,{...e,closeParentPopup:n})}];r.isMobileNative||l.push({key:"expand",action:()=>{(0,c.navigateToFullPageChatAndLogAnalytics)({environment:s,from:"expand_corner"})},render:e=>(0,N.jsx)(ct,{...e})});return{key:"findIn",render:e=>(0,N.jsx)(A.Z,{...e,topBorder:t}),items:l}}({shouldShowTopBorder:h.nextSectionShouldHaveTopBorder(),closeParentPopup:t})),h.addSection(function(e){const{shouldShowTopBorder:t,onNewChatClick:n,onSeeHistoryClick:s}=e,i=(0,a.VK)((()=>l.default.getActiveSession()),[]),o=(0,a.VK)((()=>Z.Z.isChatHistoryEnabled()),[]),r=(0,P.Io)(),d=[];i&&d.push({key:"new chat",action:()=>{n()},render:e=>(0,N.jsx)(lt,{...e,disabled:!1})});(o||r.isType("fullPage"))&&d.push({key:"chat history",action:()=>{s()},render:e=>(0,N.jsx)(dt,{...e})});if(0===d.length)return;return{key:"chat history",render:e=>(0,N.jsx)(A.Z,{...e,topBorder:t}),items:d}}({shouldShowTopBorder:h.nextSectionShouldHaveTopBorder(),onNewChatClick:g,onSeeHistoryClick:o})),h.addSection(function(e){const{shouldShowTopBorder:t,buttonPopupParent:n}=e,{isMobile:s}=(0,i.Fy)(),o=(0,a.VK)((()=>Z.Z.canShowUniversalSearchScopes()),[]),r=(0,a.VK)((()=>Z.Z.isGoogleDriveQnaEnabled()),[]),l=(0,F.J)();if(!o)return;if(s)return;const d=[{key:"universal_qna_slack",render:e=>(0,N.jsx)(it,{...e,buttonPopupParent:n}),action:()=>{}}];l&&r&&d.push({key:"universal_qna_googleDrive",render:e=>(0,N.jsx)(Ze,{...e}),action:()=>{}});return{key:"universal_qna",render:e=>(0,N.jsx)(A.Z,{...e,topBorder:t}),items:d}}({shouldShowTopBorder:h.nextSectionShouldHaveTopBorder(),buttonPopupParent:r})),h.addSection(function(e){const{shouldShowTopBorder:t,onGetHelpClick:n}=e,s=(0,i.O7)(),o=(0,a.VK)((()=>l.default.getActiveSession()),[]);if((0,i.Fy)().isMobileNative)return;const r=[{key:"notion help",action:()=>{n(),V.trackOpeningHelpFromThreeDotMenu(s,{sessionId:null==o?void 0:o.sessionId})},render:e=>(0,N.jsx)(pt,{...e})}];return{key:"get notion help",render:e=>(0,N.jsx)(A.Z,{...e,topBorder:t}),items:r}}({shouldShowTopBorder:h.nextSectionShouldHaveTopBorder(),onGetHelpClick:n})),h.addSection(function(e){const{shouldShowTopBorder:t,onDebugClick:n}=e;if(!(0,L.EU)())return;const s=[{key:"debug",action:n,render:e=>(0,N.jsx)(ut,{...e})}];return{key:"debug",render:e=>(0,N.jsx)(A.Z,{topBorder:t,...e}),items:s}}({shouldShowTopBorder:h.nextSectionShouldHaveTopBorder(),onDebugClick:m})),h.addSection(function(e){const{shouldShowTopBorder:t}=e;if((0,i.Fy)().isMobile)return;const n=[{key:"version",action:()=>{},render:e=>{let{ref:t,...n}=e;return(0,N.jsx)(j.Z,{...n})}}];return{key:"version",render:e=>(0,N.jsx)(A.Z,{...e,topBorder:t}),items:n}}({shouldShowTopBorder:h.nextSectionShouldHaveTopBorder()})),f=d.device.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,minWidth:208,maxWidth:250},(0,N.jsx)(I.Z,{...f,children:(0,N.jsx)(M.Z,{style:(0,B.X)({noDrag:u}),type:M.i.Vertical,initialFocus:void 0,sections:h.sections})})}function ot(e){const{size:t,iconFunc:n,disabled:s}=e,{iconStyle:i}=(0,g.yK)((e=>{const n=t??16,i=16-n;return{iconStyle:{width:n,height:n,color:s?e.lightTextColor:e.regularTextColor,fill:s?e.lightTextColor:e.regularTextColor,marginRight:i}}}),[s,t]);return n(i)}it.displayName="ConnectSlackButton";const rt=s.forwardRef(((e,t)=>{const{isMobile:n}=(0,i.Fy)(),{closeParentPopup:s}=e,a=(0,g.yK)((e=>({chevronRight:{fill:e.lightIconColor,width:12,height:"auto",marginLeft:2,flexShrink:0}})),[]);return(0,N.jsx)(w.ZP,{popupType:n?T.kQ.SlideUp:T.kQ.Popup,onClose:()=>{s&&s()},placementToOrigin:w.pO.Left,alignmentToOrigin:w.vR.Center,renderOrigin:n=>(0,N.jsx)(k.Z,{...e,...n,ref:t,isTokenTitle:!0,icon:(0,N.jsx)(ot,{iconFunc:v.A}),title:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(E.s,{}),(0,h.o)(a.chevronRight)]})}),render:e=>(0,N.jsx)(K.C,{buttonPopupParent:e,analyticsSource:"overflow_menu"})})}));rt.displayName="FindInButton";const lt=s.forwardRef(((e,t)=>{const{disabled:n,...s}=e,i=(0,g.yK)((e=>({newChatText:{color:n?e.lightTextColor:e.regularTextColor}})),[n]);return(0,N.jsx)(k.Z,{...s,ref:t,isTokenTitle:!0,icon:(0,N.jsx)(ot,{disabled:n,iconFunc:y.e}),title:(0,N.jsx)("div",{style:i.newChatText,children:(0,N.jsx)(b.FormattedMessage,{defaultMessage:"New chat",id:"helpButton.newChat.menuItem"})}),disabled:n})}));lt.displayName="ChatHistoryNewChatButton";const dt=s.forwardRef(((e,t)=>(0,N.jsx)(k.Z,{...e,ref:t,isTokenTitle:!0,icon:(0,N.jsx)(ot,{iconFunc:m.r}),title:(0,N.jsx)(b.FormattedMessage,{defaultMessage:"View history",id:"helpButton.seeHistory.menuItem"})})));dt.displayName="ChatHistorySeeHistoryButton";const ct=s.forwardRef(((e,t)=>(0,N.jsx)(k.Z,{...e,ref:t,icon:(0,N.jsx)(ot,{iconFunc:x.c,size:14}),title:(0,N.jsx)(b.FormattedMessage,{id:"assistantOverflowMenu.openFullPage.menuItem",defaultMessage:"Chat in full page"})})));ct.displayName="OpenFullScreenChat";const ut=s.forwardRef(((e,t)=>{const n=(0,a.VK)((()=>(0,L.em)()),[]);return(0,N.jsx)(k.Z,{...e,ref:t,isTokenTitle:!0,icon:(0,f._)({height:16,width:16,paddingTop:4}),title:n?"Hide debug helpers":"Show debug helpers"})}));ut.displayName="DebugMenuButton";const pt=s.forwardRef(((e,t)=>(0,N.jsx)(k.Z,{...e,ref:t,isTokenTitle:!0,icon:(0,N.jsx)(ot,{iconFunc:S.m}),title:(0,N.jsx)(b.FormattedMessage,{defaultMessage:"Get Notion help",id:"helpButton.getHelp.menuItem"})})));pt.displayName="GetNotionHelpButton";var gt=n(139249),mt=n(661719);function ht(e){const{buttonPopupParent:t}=e,n=(0,i.O7)(),g=(0,a.VK)((()=>p.D.getCurrentView()),[]),m=(0,a.VK)((()=>l.default.getActiveSessionId()),[]),h=(0,s.useCallback)((()=>{e.onClickViewHistory?(t.close(),e.onClickViewHistory()):p.D.setCurrentView("chatHistory"),m&&u.Z.setPreviouslyVisitedSession(m)}),[t,m,e]);switch(g){case"helpOverflowMenu":return(0,N.jsx)(at,{closeParentPopup:t.close,onSelectGetHelp:()=>{d.Z.setState({...d.Z.state,open:!0}),p.D.setCurrentView("mainHelpMenu")},onSelectSeeHistory:h,buttonPopupParent:t});case"chatHistory":return(0,N.jsx)(ft,{buttonPopupParent:t});case"mainHelpMenu":return(0,N.jsx)(r.FD,{shouldRenderAsStaticModal:!1,fromForAnalytics:"ai_qna",onAcceptMessageSupport:()=>{c.closeAssistantRightHandSideMenu({environment:n})}});default:throw(0,o.t1)(g)}}function ft(e){const{buttonPopupParent:t}=e;return(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:mt.B,transition:"height 200ms ease",minHeight:128},children:[(0,N.jsx)("div",{style:{marginTop:"auto"}}),(0,N.jsx)(gt.ZP,{onRestoreChatSession:()=>t.close()})]})}},836993:(e,t,n)=>{n.d(t,{c:()=>p});n(667294);var s=n(886628),i=n(724405),a=n(137810),o=n(731278),r=n(776798),l=n(206258),d=n(514387),c=n(173435),u=n(785893);function p(e){const{pageStore:t,style:n,isSmall:p}=e,g=(0,i.yK)((e=>({wrap:{gap:4,borderRadius:4,color:e.v2.text.primary,fontWeight:a.Z.fontWeight.medium,fontSize:13,...n}})),[n]),m=(0,c.Dc)(t),h=(0,s.VK)((()=>t.getIcon()),[t]),f=(0,s.VK)((()=>t instanceof l.G&&t.isEmptyPage()),[t]);return(0,u.jsxs)(d.y,{href:m,style:g.wrap,isSmall:p,children:[h&&(0,u.jsx)(o.Z,{disabled:!0,icon:h,isEmptyPage:f,size:18}),(0,u.jsx)(r.Z,{store:t})]})}},514387:(e,t,n)=>{n.d(t,{y:()=>l});n(667294);var s=n(800480),i=n(724405),a=n(137810),o=n(489728),r=n(785893);function l(e){const{isSmall:t,children:n,style:l,...d}=e,c=(0,s.Fy)(),u=(0,i.yK)((e=>({wrap:{paddingLeft:4,paddingRight:4,...t?{fontSize:c.isMobile?a.Z.fontSize.UISmall.mobile:a.Z.fontSize.UISmall.desktop,lineHeight:"initial"}:{height:24},...l}})),[c,t,l]);return(0,r.jsx)(o.Z,{style:u.wrap,isSmall:t,...d,children:n})}},816540:(e,t,n)=>{n.d(t,{N:()=>h});var s=n(667294),i=n(886628),a=n(724405),o=n(421202),r=n(709291),l=n(653965),d=n(401898),c=n(137810),u=n(731278),p=n(776798),g=n(206258),m=n(785893);function h(e){const{clientStep:t,parentStore:n}=e,s=(0,i.VK)((()=>{if(t.pageIds)return t.pageIds.map((e=>g.G.createChildStore(n,{table:o.iU,id:e})));{const e=t.searchResults.map((e=>g.G.createChildStore(n,{table:o.iU,id:e})));return l.mN(e.map((e=>e.getNavigableBlockStore())).filter(d.$K),(e=>e.id))}}),[t,n]);return(0,m.jsx)(f,{searchResultStores:s})}function f(e){const{searchResultStores:t}=e,[n,o]=(0,s.useState)(0),l=(0,a.yK)((e=>({currentElementStyle:{display:"flex"}})),[]);(0,s.useEffect)((()=>{const e=setInterval((()=>{o((e=>e+1))}),800);return()=>clearInterval(e)}),[]);const d=(0,i.VK)((()=>t.map(((e,t)=>(0,m.jsx)("div",{style:l.currentElementStyle,children:(0,m.jsx)(r.FormattedMessage,{id:"AssistantChatStep.searchingText",defaultMessage:"Reading {link}",values:{link:(0,m.jsx)("div",{style:c.Z.textOverflowStyle,children:(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,m.jsx)(u.Z,{disabled:!0,isEmptyPage:e.isEmptyPage(),icon:e.getIcon(),size:16,emojiSize:16,disableShrinking:!0,largeIcon:!0,style:{margin:"0px 4px"}}),(0,m.jsx)(p.Z,{store:e})]})})}})},t)))),[t,l]),g=n>=t.length?(0,m.jsx)("div",{style:{...l.currentElementStyle},children:(0,m.jsx)(r.FormattedMessage,{id:"AssistantChatStep.summarize",defaultMessage:"Summarizing"})}):d[n];return(0,m.jsx)("div",{style:{display:"flex"},children:(0,m.jsx)("div",{style:{minWidth:50},children:g})})}},117826:(e,t,n)=>{n.d(t,{Z:()=>u});var s=n(667294),i=n(886628),a=n(724405),o=n(973420),r=n(436488),l=n(374194),d=n(182375),c=n(785893);function u(e){const{sessionContext:t}=e,n=(0,i.VK)((()=>d.H.state.name),[]),u=(0,i.VK)((()=>d.H.state.nudge),[]),p=(0,i.VK)((()=>{var e;return null===(e=d.H.state)||void 0===e?void 0:e.temperatureOverride}),[]),[g,m]=s.useState(!1),h=(0,i.VK)((()=>null==t?void 0:t.assistantConfigurationState.currentUserInfo.name),[t]),f=(0,i.VK)((()=>null==t?void 0:t.assistantConfigurationState.currentSpaceInfo.name),[t]),y=(0,s.useCallback)((e=>{const t=e.target.value;d.H.setState({...d.H.state,name:t})}),[]),x=(0,s.useCallback)((e=>{const t=parseFloat(e.target.value);d.H.setState({...d.H.state,temperatureOverride:isNaN(t)?void 0:t})}),[]),v=(0,s.useCallback)((e=>{const t=e.target.value;d.H.setState({...d.H.state,nudge:t})}),[]),S=(0,s.useCallback)((()=>{m(!0)}),[m]),b=(0,s.useCallback)((()=>{m(!1)}),[m]),C=(0,a.yK)((e=>({heading:{textTransform:"uppercase",fontSize:12,fontWeight:600,color:e.lightTextColor,textAlign:"right",marginRight:4},field:{fontWeight:500,fontSize:14},wrap:{display:"flex",flexDirection:"column",gap:4,borderRadius:6,marginTop:8,marginBottom:8,background:e.assistantTintedActionButtonBackground,padding:10},inputs:{display:"flex",flexDirection:"column",gap:4,whiteSpace:"nowrap"}})),[]);return(0,c.jsxs)("div",{style:C.wrap,children:[(0,c.jsx)("div",{style:C.heading,children:"Labeler mode"}),(0,c.jsx)("div",{style:C.field,children:`User name: ${h||"Not set"}`}),(0,c.jsx)("div",{style:C.field,children:`Workspace name: ${f||"Not set"}`}),(0,c.jsx)("hr",{}),(0,c.jsx)(r.Z,{capture:g,render:e=>(0,c.jsxs)("div",{style:C.inputs,children:[(0,c.jsxs)(o.X2,{gap:8,children:[(0,c.jsx)("div",{style:C.field,children:"Task type: "}),(0,c.jsx)(l.Z,{value:n,onChange:y,placeholder:"Task type",...e,onFocus:S,onBlur:b})]}),(0,c.jsxs)(o.X2,{gap:8,children:[(0,c.jsx)("div",{style:C.field,children:"Temperature override: "}),(0,c.jsx)(l.Z,{value:String(p??""),onChange:x,placeholder:"0.7 (default)",...e,onFocus:S,onBlur:b})]}),(0,c.jsxs)(o.X2,{gap:8,children:[(0,c.jsx)("div",{style:C.field,children:"Nudge: "}),(0,c.jsx)(l.Z,{value:u,onChange:v,placeholder:"Optional nudge shown to the model",...e,onFocus:S,onBlur:b})]})]})})]})}},226009:(e,t,n)=>{n.d(t,{K:()=>l,Q:()=>d});n(667294);var s=n(724405),i=n(709291),a=n(291839),o=n(561144),r=n(785893);const l=(0,i.defineMessages)({thinking:{id:"assistantThinkingMessages.thinking",defaultMessage:"Thinking"}});function d(){const e=(0,o.iI)({hovered:!1,isAssistantChat:!0}),t=(0,s.yK)((e=>({container:{display:"flex",alignItems:"center",whiteSpace:"pre",color:e.text.secondary,padding:"8px 0 0",fontSize:12},dots:{marginLeft:4}})),[]);return(0,r.jsx)("div",{style:e.wrap,children:(0,r.jsxs)("div",{style:{...e.baseMessage,...e.assistantMessage,...t.container},children:[(0,r.jsx)(i.FormattedMessage,{...l.thinking}),(0,r.jsx)("div",{style:t.dots,children:(0,r.jsx)(a.Z,{isTriColored:!0})})]})})}},473957:(e,t,n)=>{n.d(t,{n:()=>m});var s=n(667294),i=n(886628),a=n(521273),o=n(252193),r=n(421202),l=n(990038),d=n(653965),c=n(937850),u=n(661091);const p=new l.z(1);var g=n(785893);function m(){const e=(0,i.VK)((()=>a.Z.isXMLAssistantEnabled()),[]);return(0,g.jsx)(g.Fragment,{children:e?(0,g.jsx)(h,{}):null})}function h(){const e=(0,i.VK)((()=>(0,o.getCurrentPageInformation)()),[]),t=(0,i.VK)((()=>(0,o.getParentRecordStore)()),[]);return(0,s.useEffect)((()=>{t&&e&&async function(e){const{currentPageInformation:t,parentRecordStore:n}=e;await p.enqueue((async()=>{var e,s;const i=d.oA([null===(e=t.primaryEditorStore)||void 0===e?void 0:e.id,null===(s=t.backgroundEditorStore)||void 0===s?void 0:s.id]);await c.Lc(i,5,(e=>u.Z.loadPageAndRelatedRecords({parentRecordStore:n,pointer:{id:e,table:r.iU,spaceId:n.getSpaceId()}})))}))}({currentPageInformation:e,parentRecordStore:t}).catch((e=>{console.error(e)}))}),[e,t]),null}},878158:(e,t,n)=>{n.d(t,{F:()=>S,O:()=>b});n(667294);var s=n(800480),i=n(886628),a=n(724405),o=n(418442),r=n(798963),l=n(653965),d=n(573063),c=n(632163),u=n(731278),p=n(672495),g=n(510102),m=n(206258),h=n(642915),f=n(152284),y=n(2405),x=n(421016),v=n(785893);function S(e){const{spaceStore:t}=e,{renderAsFullPage:n}=(0,g.Io)(),u=(0,i.VK)((()=>f.z.getAutomationIds().map((e=>m.Mz.createChildStore(t,{table:r.cv,id:e,spaceId:t.id})))),[t]),y=(0,s.O7)(),S=(0,a.yK)((e=>({icon:{width:16,marginRight:4},menuItemWrap:{display:"flex",alignItems:"center",margin:n?"8px 0px":8},settingsButton:{marginLeft:8},sectionTitle:n?{paddingLeft:0}:{}})),[n]),C=u.map((e=>function(e){const{environment:t,automationStore:n,styles:s}=e,i={key:n.id,render:e=>(0,v.jsx)(x.Z,{automationStore:n,renderOrigin:t=>(0,v.jsxs)("div",{style:s.menuItemWrap,onMouseEnter:e.onMouseEnter,ref:e.ref,children:[(0,v.jsx)(b,{automationStore:n,onClick:e.onClick,focused:e.focused}),(0,v.jsx)(d.Z,{icon:o.H,ariaLabel:"edit",style:s.settingsButton,...t})]},e.key)}),action:async()=>{await(0,h.Zq)({environment:t,automationStore:n})}};return i}({environment:y,automationStore:e,styles:S})));return(0,v.jsx)(c.Z,{type:c.i.Vertical,initialFocus:void 0,resetFocusOnMouseOut:!0,disableKeyboard:!0,sections:l.oA([C.length>0&&{key:"workspace",render:e=>(0,v.jsx)(p.Z,{topBorder:!1,disableMobileBorders:!0,desktopTitleStyle:S.sectionTitle,...e}),items:C}])})}function b(e){const{automationStore:t,focused:n,onClick:s}=e,a=(0,i.VK)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.getValue()}),[t]),o=(0,i.VK)((()=>t.getName()),[t]);return(0,v.jsx)(y.Z,{title:o||"New workflow",icon:a?e=>(0,v.jsx)(u.Z,{disabled:!0,isEmptyPage:!1,size:18,icon:{icon:a,pointer:t.pointer},style:e}):void 0,onClick:s,focused:n})}},557199:(e,t,n)=>{n.d(t,{D:()=>r});var s=n(733993),i=n(667294),a=n(724405),o=n(785893);function r(e){const{children:t,withBrackground:n,size:r=22,isPillButton:l,onReturnPressed:d}=e,c=(0,i.useRef)(null),u=r+2;(0,i.useEffect)((()=>{d&&c.current&&c.current.focus()}),[d]);const[p,g]=(0,i.useState)(!0),m=(0,a.Fg)(),h=m.accentColors.uiBlue[400],f=m.accentColors.uiBlue[200],y="rgba(35, 131, 226, 0)",x={animate:{boxShadow:p?[`0 0 0 0px ${h}, 0 0 0 0px ${f}`,`0 0 0 2px ${h}, 0 0 4px 4px ${f}`,`0 0 0 5px ${y}, 0 0 4px 8px ${y}`]:void 0,transition:{duration:1.8,repeatDelay:.4,repeat:1/0,ease:"easeInOut"}}},v=(0,i.useCallback)((e=>{"Enter"===e.key&&d&&d()}),[d]),S=(0,a.yK)((e=>({pulseStyle:{borderRadius:u,display:"flex",justifyContent:"center",alignItems:"center",width:l?"auto":r,height:l?r+4:r,padding:2,backgroundColor:n?e.accentColors.uiBlue[300]:void 0}})),[n,l,r,u]);return(0,o.jsx)(s.E.div,{variants:x,animate:p?"animate":void 0,style:S.pulseStyle,ref:c,onBlur:()=>{g(!1)},tabIndex:d?0:void 0,onKeyDown:d?v:void 0,children:t})}},661719:(e,t,n)=>{n.d(t,{B:()=>_,u:()=>F});var s=n(667294),i=n(800480),a=n(886628),o=n(724405),r=n(80721),l=n(213148),d=n(356666),c=n(709291),u=n(247839),p=n(781645),g=n(231945),m=n(573063),h=n(436488),f=n(256940),y=n(478140),x=n(672495),v=n(526388),S=n(333991),b=n(851739),C=n(510102),j=n(843250),k=n(460709),w=n(982063),I=n(798180),M=n(629026),T=n(828344),A=n(644962),P=n(492928),B=n(785893);const _=375;function F(e){const t=(0,i.Fy)();return(0,w.Z)(),(0,B.jsx)(f.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!t.isMobile,render:()=>(0,B.jsx)(h.Z,{capture:!0,allowMenuList:!0,render:t=>(0,B.jsx)(Z,{...e,ignoreAreaEvents:t})})})}function Z(e){const{ignoreAreaEvents:t,renderAsPage:n,quickSearchMode:h,searchContentPaneType:f,onClose:w}=e,{modalBodyMenuRef:_}=(0,s.useContext)(S.SearchStaticContext),F=(0,i.O7)(),Z=(0,a.VK)((()=>null===I.default||void 0===I.default?void 0:I.default.getActiveAssistantConfigurationState()),[]),V=(0,i.Fy)(),R=(0,s.useCallback)((()=>{null!=Z&&Z.sessionId&&T.trackQnaBackToSearch(F,{sessionId:Z.sessionId}),M.ZP.update((e=>({...e,mode:"search"}))),h&&V.isDesktop&&u.quickSearchSetSearchAssistantMode(!1)}),[V.isDesktop,h,null==Z?void 0:Z.sessionId,F]),L=(0,s.useCallback)((()=>{w()}),[w]),E=(0,a.VK)((()=>(0,b.ip)({searchContentPaneType:f,renderAsPage:n,environment:F})),[n,f,F]),{type:K}=(0,C.Io)(),O=(0,o.yK)((e=>({header:{display:"flex",justifyContent:"space-between",alignItems:"center",pointerEvents:"auto",paddingTop:8,paddingLeft:12,paddingRight:16,paddingBottom:8},body:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},scroller:{display:"flex",flexDirection:"column",maxHeight:E.maxHeight,minHeight:E.minHeight},headerButton:{color:e.mediumIconColor},closeButton:{borderRadius:"100%",marginLeft:6},backButton:{marginRight:6},seeMoreButton:{borderRadius:"100%",marginRight:6,color:e.v2.text.quaternary}})),[E]),D=(0,s.useMemo)((()=>{if(V.isMobile){return{menuType:k.og.Modal,width:n?"100vw":void 0,disableHeaderShadow:!0,disableBottomPadding:!0,bodyScrollerClassName:j.GZn,hideMobileTopbar:!0,renderAsPage:!0,scrollerStyle:{display:"flex",flexDirection:"column",paddingBottom:0},...t}}const e={menuType:k.og.Popup,maxHeight:E.maxHeight,minHeight:E.minHeight,...h?{width:"100vw"}:{},disableScroller:!0,scrollerStyle:O.scroller,...t};return n&&V.isDesktop&&(e.maxWidth="100%"),e}),[V,O,t,E,n,h]);return(0,B.jsxs)(y.Z,{...D,className:j.Oau,ref:_,children:[(0,B.jsx)(x.Z,{children:(0,B.jsxs)("div",{className:h?j.pMC:void 0,style:O.header,children:[(0,B.jsx)(m.Z,{icon:r.W,onClick:R,ariaLabel:"back",style:O.backButton}),(0,B.jsx)(p.Z,{}),(0,B.jsx)("div",{style:{flexGrow:1}}),(0,B.jsx)(g.ZP,{onClick:()=>{(0,T.trackAiChatTranscriptHistoryOpenHistoryButtonSelected)(F,{from:K})},popupType:F.device.isMobile?g.Z4.SlideUp:g.Z4.Popup,alignmentToOrigin:g.vR.End,placementToOrigin:g.pO.Bottom,renderOrigin:e=>(0,B.jsx)(v.Z,{renderTooltip:()=>(0,B.jsx)(c.FormattedMessage,{id:"SearchAssistantPane.viewHistoryButton",defaultMessage:"History and help"}),render:t=>(0,B.jsx)(m.Z,{style:O.seeMoreButton,hovered:!1,icon:d.o,ariaLabel:"see more",...t,...e})}),render:e=>(0,B.jsx)(P.u,{buttonPopupParent:e})}),(0,B.jsx)(m.Z,{style:O.closeButton,hovered:!0,icon:l.U,onClick:L,ariaLabel:"close"})]})}),(0,B.jsx)(A.R,{onBackspaceOnEmptyInput:R})]})}},644962:(e,t,n)=>{n.d(t,{R:()=>oi,s:()=>ai});var s=n(667294),i=n(701302),a=n(800480),o=n(886628),r=n(724405),l=n(427328),d=n(681532),c=n(76233),u=n(709291),p=n(653965),g=n(401898),m=n(137810),h=n(524677),f=n(680402),y=n(137231),x=n(898104),v=n(210228),S=n(237181),b=n(953336),C=n(32203),j=n(510102),k=n(319124),w=n(768657),I=n(635622),M=n(318245),T=n(434859),A=n(80444),P=n(521273),B=n(798180),_=n(869454),F=n(745589),Z=n(924666),V=n(365147),R=n(484681),L=n(148604),E=n(724199),K=n(217978),O=n(794562),D=n(274360),W=n(117826),H=n(473957),N=n(584169),z=n(973420),U=n(669128),G=n(2405),q=n(785893);function $(e){let{}=e;const t=(0,a.O7)(),n=(0,j.Io)(),i=(0,o.VK)((()=>"ready"!==U.Pf.state.type?[]:U.Pf.state.questions),[]),l=(0,o.VK)((()=>n.type),[n.type]),d=(0,s.useCallback)((async e=>{await(0,E.handleSubmitNewQuestion)({newValue:[[e]],environment:t,currentClientSkillWithSettings:void 0,source:"abandoned_search_suggested_question",assistantSurfaceType:l}),U.Pf.setState({type:"idle"})}),[l,t]),c=(0,r.yK)((e=>({container:{marginBottom:2},headerMessage:{fontSize:14,marginBottom:8}})),[]);return(0,q.jsxs)("div",{style:c.container,children:[(0,q.jsx)("div",{style:c.headerMessage,children:(0,q.jsx)(u.FormattedMessage,{id:"assistant.failedSearchQnaReminder",defaultMessage:"Couldn't find something? Try asking me"})}),(0,q.jsx)(z.sg,{gap:8,children:i.map((e=>(0,q.jsx)(G.Z,{title:e,icon:N.m,onClick:()=>d(e),variant:"tinted"},e)))})]})}n(252262),n(324506),n(757658);var Q=n(365820),Y=n(733993),X=n(80721),J=n(276927),ee=n(573063),te=n(203386),ne=n(435367),se=n(995853),ie=n(286649),ae=n(428690),oe=n(226009),re=n(561144);function le(e){const{role:t,children:n}=e,{isMobile:i}=(0,a.Fy)(),[o]=(0,s.useState)(!1),r="assistant"===t,l=(0,re.iI)({hovered:o,isAssistantChat:r});return(0,q.jsxs)("div",{style:l.wrap,...i?{tabIndex:0}:{},children:[!r&&(0,q.jsx)("div",{style:{flexGrow:1}}),(0,q.jsx)("div",{style:{...l.baseMessage,...r?l.assistantMessage:l.humanMessage,padding:"6px 12px"},children:n})]})}function de(e){return(0,q.jsx)(le,{role:"assistant",children:e.children})}function ce(e){return(0,q.jsx)(le,{role:"user",children:e.children})}var ue=n(582356),pe=n(761361),ge=n(355863),me=n(471924),he=n(587420),fe=n(167940),ye=n(992083),xe=n(557199);function ve(e){const{mode:t}=e,n=(0,u.useIntl)(),i=(0,a.O7)(),o=(0,s.useCallback)((()=>{(0,L.incrementTutorialStepOnCompletionOfCurrentStep)({intl:n,skipAnalytics:!1,environment:i})}),[i,n]),l=(0,s.useCallback)((e=>{B.default.endCurrentSession(),(0,L.exitTutorial)({environment:i}),E.assistantAnalyticsActions.trackAssistantTutorialFollowupActionSelected(i,{action:e})}),[i]),d=(0,r.yK)((e=>({buttonRow:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",gap:8},initialWrapper:{display:"flex",gap:8,marginBottom:12}})),[]),c=(0,s.useCallback)((()=>{he.xv(i,"restart_assistant_tutorial"),(0,L.startTutorial)({fromForAnalytics:"repeatTourButton",skipAnalytics:!1,environment:i,intl:n}),E.assistantAnalyticsActions.trackAssistantTutorialFollowupActionSelected(i,{action:"repeatTour"})}),[i,n]),p=(0,s.useCallback)((()=>{E.assistantAnalyticsActions.trackAssistantTutorialFollowupActionSelected(i,{action:"importKnowledge"}),ye.Z.setState({...ye.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}),fe.Z.setState({flowId:(0,me.Il)()})}),[i]),m=(0,s.useCallback)((()=>{E.assistantMenuActions.openCornerChatHelp()}),[]);let h;return"initial"===t?h=(0,q.jsxs)("div",{style:d.initialWrapper,children:[(0,q.jsx)(xe.D,{isPillButton:!0,size:32,onReturnPressed:o,children:(0,q.jsx)(G.Z,{onClick:o,title:n.formatMessage(ne.p.showMe),icon:J.p,variant:"tinted"},"showMe")}),(0,q.jsx)(G.Z,{onClick:()=>l("exploreOnMyOwn"),title:n.formatMessage(ne.p.onMyOwn),variant:"tinted"},"onMyOwn")]}):"done"===t?h=(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(G.Z,{onClick:()=>l("newChat"),title:n.formatMessage(ne.p.newChat),icon:pe.E,variant:"tinted"},"newChat"),(0,q.jsx)(G.Z,{onClick:c,title:n.formatMessage(ne.p.repeatTour),icon:ge.s,variant:"tinted"},"repeatTour"),(0,q.jsx)(G.Z,{onClick:p,title:n.formatMessage(ne.p.importYourKnowledge),icon:ue.l,variant:"tinted"},"importYourKnowledge"),(0,q.jsx)(G.Z,{onClick:m,title:n.formatMessage(ne.p.notionHelp),icon:N.m,variant:"tinted"},"notionHelp")]}):void 0===t?h=null:(0,g.t1)(t),(0,q.jsx)("div",{style:d.buttonRow,children:h})}var Se=n(377058),be=n(7493),Ce=n(698519);function je(e){const{incrementStepNumber:t,isStepInLatestGroup:n,isStepLatestStepInGroup:i}=e,o=(0,u.useIntl)(),l=(0,a.O7)(),d=(0,s.useCallback)((()=>{(0,L.incrementTutorialStepOnCompletionOfCurrentStep)({intl:o,skipAnalytics:!1,environment:l})}),[l,o]),c=(0,s.useCallback)((()=>{se.l.commitEdits(),t()}),[t]),p=(0,r.yK)((()=>({acceptEditsMessageButtonStyle:{display:"flex",justifyContent:n&&i?"flex-start":"flex-end",alignItems:"center"}})),[n,i]),g=(0,q.jsx)(G.Z,{variant:"tinted",icon:Ce.k,title:o.formatMessage({id:"AssistantTutorialChatScrollerContent.accept",defaultMessage:"Accept"}),onClick:c,disabled:!(n&&i)});return n?(0,q.jsx)("div",{style:p.acceptEditsMessageButtonStyle,children:(0,q.jsx)(xe.D,{isPillButton:!0,size:32,onReturnPressed:d,children:g})}):(0,q.jsx)("div",{style:p.acceptEditsMessageButtonStyle,children:g})}function ke(){return(0,r.yK)((e=>({progressRing:{marginLeft:12,marginBottom:8},checkmarkSection:{marginLeft:8,marginTop:12,marginBottom:-8},checkmarkSectionFinalMessage:{marginLeft:0,marginTop:12,marginBottom:6},checkmarkIcon:{width:16,height:16},progressRingPlaceholder:{height:24},messageHeading:{display:"block",fontWeight:m.Z.fontWeight.semibold,marginBottom:4,color:e.text.primary},assistantFaceWrap:{boxShadow:e.lightBoxShadow,borderRadius:"100%",width:"fit-content",marginLeft:8},pagesFoundMessage:{fontSize:m.Z.fontSize.UISmall.desktop,color:e.lightTextColor,marginLeft:12}})),[])}var we=n(421202),Ie=n(360682),Me=n(214976),Te=n(206258);function Ae(e){const{textValue:t}=e,n=(0,a.O7)(),s=(0,r.Fg)();return(0,o.VK)((()=>{const e=se.l.state,i=A.default.state.currentSpaceStore;if(!e.isActive||!i)return;const a=i.id,o=e.peekPageStore.id,r=new Te.G(n,{id:o,table:we.iU,spaceId:a});return r&&t?(0,Me.IY)({environment:n,textValue:{value:t,spaceId:a},parentStore:r,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disabled:!0,theme:s,emojiType:(0,Ie.e_)(n),katex:n.KatexStore.getKatex(),formulaValueTypes:[]}):void 0}),[n,t,s])}function Pe(e){const{step:t,createdPageStore:n,incrementStepNumber:s,isStepLatestStepInGroup:i,isStepInLatestGroup:a}=e,o=ke(),r=Ae({textValue:t.heading});return(0,q.jsxs)(de,{children:[t.isFinalStep&&(0,q.jsx)("div",{style:o.checkmarkSectionFinalMessage,children:(0,Se.$)(o.checkmarkIcon)}),t.heading&&n&&(0,q.jsx)("div",{style:o.messageHeading,children:r}),(0,q.jsx)(ie.s,{textValue:t.message,onAnimationEnd:s,disableAnimation:!i||!a},"message")]})}var Be=n(291839);function _e(e){return e.isStepLatestStepInGroup?(0,q.jsx)(Fe,{...e}):null}function Fe(e){const{step:t,onAnimationEnd:n}=e,i=t.searchingMessages,a=i.length,[o,l]=(0,s.useState)(0),d=(0,re.iI)({hovered:!1,isAssistantChat:!0});(0,s.useEffect)((()=>(o<a?setTimeout((()=>{l(o+1)}),1e3):n(),()=>{clearTimeout(undefined)})),[n,o,a]);const c=(0,r.yK)((e=>({messageWrapper:{display:"flex",alignItems:"center",whiteSpace:"pre",color:e.text.tertiary,fontSize:12,marginLeft:10},dots:{marginLeft:4,display:"flex"}})),[]),u=Ae({textValue:i.at(o)});return u?(0,q.jsx)("div",{style:d.wrap,children:(0,q.jsxs)("div",{style:{...d.baseMessage,...d.assistantMessage,...c.messageWrapper,padding:"8px 0 0"},children:[u,(0,q.jsxs)("div",{style:c.dots,children:[(0,q.jsx)(Be.Z,{isTriColored:!0})," "]})]})}):null}function Ze(e){const{step:t,isStepLatestStepInGroup:n}=e,s=Ae({textValue:t.message});return n?null:(0,q.jsx)(ce,{children:s})}n(397391);var Ve=n(126263),Re=n(388421),Le=n(535827),Ee=n(433463),Ke=n(988891),Oe=n(524993),De=n(88315),We=(n(21703),n(342091)),He=n(939040);function Ne(e){return"text"===e.type?{...e,value:e.value.split("\n").map((e=>e.trim())).filter(Boolean).join("\n")}:"element"===e.type?{...e,children:(e.children||[]).map(Ne).filter((e=>!("text"===e.type&&""===e.value)))}:void(0,g.t1)(e)}var ze=n(559054),Ue=n(959753),Ge=n(590468),qe=n(423577),$e=n(96653);const Qe=function(e){const{pageStore:t}=e,n=(0,u.useIntl)(),s=(0,a.O7)(),i=(0,o.VK)((()=>null==t?void 0:t.getSpaceId()),[t]),r=(0,o.VK)((()=>se.l.state.isActive?se.l.state.editsXmlString:void 0),[]),l=(0,o.VK)((()=>!!se.l.state.isActive&&se.l.state.editsAreCommitted),[]),[d]=(0,ze.r5)((async()=>{if(!t||!r)return;const{node:e}=await(0,Oe.IT)({intl:n,pointer:{...t.pointer,spaceId:t.getSpaceId()},loadRecordModel:Ue.s8.fromGetRecordModelFn(t.getRecordModel)}),i=new De.lq,a=De.ll.newBuilder().withCurrentPageNode(e).with(i).build(),o=new Le.$(a);await o.commitStep(o.createContextStep(a.getContext()));const d=await o.evaluateStep(o.createAssistantStep('<load id="0" />'),!0);(0,Re.lD)(d.observations);const c=await o.evaluateStep(o.createAssistantStep(function(e){const t=Ne({type:"element",tagName:"wrap",attributes:{},children:(0,He.P)(e)});if("element"!==t.type)throw new Error("Expected element.");return(t.children||[]).map((e=>(0,We.KT)(e))).join("")}(r)),!0);(0,Re.lD)(c.observations);const u=t.inMemoryRecordCache,p=new Ve.Z({name:"UIDocAIDiffs.modifiedDuplicate",isTemporaryData:!0});u.cacheOverrides.forEach((e=>u.removeCacheOverride(e))),u.addCacheOverride(p),await v.createAndCommitAsync({environment:s,userAction:"UIDocAIDiffs.applyOperations",perform:async e=>{await(0,qe.m2)({environment:s,transaction:e,operations:i.operations,inMemoryRecordCache:p,operationContext:(0,Ke.Yc)()})},waitForServerCommit:!1});const g=(0,Ke.u6)(i.operations,(0,Ke.Yc)()),m=(0,Ee.rn)(i.executableOperations).filter(Ee.b3),h=(0,Ge.Y)(p);return l||(0,Ge.$)({environment:s,operations:g,caches:h,updatedPageGroups:m,originalCache:u,executableOperations:i.executableOperations}),{executableOperations:i.executableOperations,modifiedDuplicatePageStore:new Te.G(s,t.pointer,{inMemoryRecordCache:p})}}),[l,n,t,s,r]);return null!=d&&d.value&&i?(0,q.jsx)($e.y,{operations:d.value.executableOperations,parentStore:d.value.modifiedDuplicatePageStore,parentSpaceId:i}):null};var Ye=n(278942);function Xe(e){const t=(0,r.Fg)(),n=(0,r.yK)((e=>({progressRing:{marginLeft:6,marginTop:16}})),[]);let s="#000";switch(e.currentStep){case 1:s=t.accentColors.green[400];break;case 2:s=t.accentColors.purple[500];break;case 3:s=t.accentColors.uiBlue[600]}return(0,q.jsx)(Ye.e,{percentage:e.currentStep/(e.totalSteps+1)*100,size:40,ringWidth:4,label:`${e.currentStep}/${e.totalSteps}`,style:n.progressRing,filledColor:s})}const Je=function(e){const{step:t,currentStepGroupIndex:n,incrementStepNumber:s,isStepLatestStepInGroup:i,isStepInLatestGroup:a,showThinking:r}=e,l=ke(),d=(0,o.VK)((()=>se.l.state.isActive?se.l.state.peekPageStore:void 0),[]);switch(t.type){case"welcome":case"highlightCreatePageCard":case"complete":return null;case"assistantPlaintextChat":return(0,q.jsx)(Pe,{step:t,createdPageStore:d,incrementStepNumber:s,isStepLatestStepInGroup:i,isStepInLatestGroup:a},`assistantChat_${n}`);case"userTurn":return(0,q.jsx)(Ze,{step:t,isStepLatestStepInGroup:i},`userChat_${n}`);case"createPageCard":return d?(0,q.jsx)(be.d,{pageStore:d,shouldHighlightOpenPageButton:2===n,truncatable:!0,onExpandPageClick:s},"createEditPage"):null;case"tutorialRing":return a&&!r?(0,q.jsx)(Xe,{currentStep:t.index,totalSteps:3},`tutorialRing_${t.index}`):a?null:(0,q.jsx)("div",{style:l.checkmarkSection,children:(0,Se.$)(l.checkmarkIcon)});case"groupedEditCard":return(0,q.jsx)(Qe,{pageStore:d});case"searchStates":return(0,q.jsx)(_e,{step:t,onAnimationEnd:s,isStepLatestStepInGroup:i},"searchSteps");case"acceptEditsMessageButton":return(0,q.jsx)(je,{incrementStepNumber:s,isStepInLatestGroup:a,isStepLatestStepInGroup:i});default:(0,g.t1)(t)}};function et(e){const{scrollerRef:t}=e,n=(0,u.useIntl)(),i=(0,a.O7)(),l=(0,o.VK)((()=>{var e;return null===(e=A.default.state.currentUserStore)||void 0===e?void 0:e.getDisplayName(n)}),[n]),d=(0,o.VK)((()=>se.l.state.isActive?se.l.state.steps:void 0),[]),[p,h]=(0,o.VK)((()=>{const e=se.l.state;if(!e.isActive)return[void 0,void 0];const t=e.stepIndex;return[t,e.steps.at(t)]}),[]),f=(0,o.VK)((()=>!!se.l.state.isActive&&se.l.state.showThinking),[]),y=(0,s.useCallback)((()=>{(0,L.exitTutorial)({environment:i})}),[i]),x=(0,a.Fy)(),v=(0,O.u)(),S=(0,r.yK)((e=>({thinkingWrapper:{marginLeft:12},progressRing:{marginLeft:12,marginBottom:12},progressRingPlaceholder:{height:24},messageHeading:{display:"block",fontWeight:"bold",marginBottom:4},assistantFaceWrap:{width:"fit-content",marginLeft:4,marginBottom:9},pagesFoundMessage:{fontSize:x.isMobile?m.Z.fontSize.UISmall.mobile:m.Z.fontSize.UISmall.desktop,color:e.lightTextColor,marginLeft:12},goBackContainer:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:8},backIcon:{background:e.assistantTintedActionButtonBackground,fill:e.regularIconColor,width:v.actionButtonHeight,height:v.actionButtonHeight,borderRadius:"100%"},hoveredBackIcon:{background:e.assistantTintedActionButtonBackgroundHovered},pressedBackIcon:{background:e.assistantTintedActionButtonBackgroundPressed},contentWrapper:{display:"flex",flexDirection:"column",scrollBarGutter:"none",gap:8}})),[x,v]),b=(0,o.VK)((()=>se.l.state.isActive?se.l.state.groupIndex:void 0),[]),C=(0,s.useMemo)((()=>{const e=[(0,q.jsx)(Q.M,{children:0===p&&(0,q.jsx)(Y.E.div,{style:S.assistantFaceWrap,initial:{opacity:0,scale:.6},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:[0,-5,20],scale:[1,1.1,.4]},transition:{duration:.3},children:(0,q.jsx)(ae.g,{variant:"large",includeBoxShadow:!0},"face")})},"faceWrap"),(0,q.jsxs)(de,{children:[(0,q.jsx)("div",{style:S.messageHeading,children:n.formatMessage(ne.p.greetingHeading,{name:l})},"heading"),(0,q.jsx)(ie.s,{textValue:(0,c.TPx)(n.formatMessage(ne.p.greetingBody))},"body")]},"greetings"),(0,g.$K)(p)&&p>0&&(0,q.jsxs)("div",{style:S.goBackContainer,children:[(0,q.jsx)(ee.Z,{ariaLabel:n.formatMessage(ne.p.goBackAriaLabel),icon:X.W,style:S.backIcon,hoveredStyle:S.hoveredBackIcon,pressedStyle:S.pressedBackIcon,onClick:y}),(0,q.jsx)(G.Z,{title:n.formatMessage(ne.p.showMe),icon:J.p,variant:"tinted",disabled:!0})]},"showMe")];if(d)for(let t=0;t<=(p??0);t++)e.push((0,q.jsx)(tt,{showThinking:f,stepGroup:d[t].steps,isLatestStepGroup:t===p,currentStepGroupIndex:t===p?b:d[t].steps.length},d[t].groupType));return e}),[b,p,l,n,f,S,y,d]),j=(0,s.useCallback)((()=>{(0,L.incrementTutorialStepOnCompletionOfCurrentStep)({intl:n,skipAnalytics:!1,environment:i})}),[i,n]);return(0,s.useEffect)((()=>{var e;null===(e=t.current)||void 0===e||e.scrollToBottom()}),[t,C]),(0,g.$K)(p)&&(0,g.$K)(h)?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(te.Z,{debugName:"AssistantTutorialChatScrollerContent",capture:!0,onEnter:j}),(0,q.jsxs)("div",{style:S.contentWrapper,children:[C,f&&(0,q.jsx)("div",{style:S.thinkingWrapper,children:(0,q.jsx)(oe.Q,{})}),(0,q.jsx)(ve,{mode:"welcome"===h.groupType?"initial":"complete"===h.groupType?"done":void 0})]})]}):null}function tt(e){const{stepGroup:t,isLatestStepGroup:n,currentStepGroupIndex:i,showThinking:o}=e,r=(0,u.useIntl)(),l=(0,a.O7)(),d=(0,s.useCallback)((()=>{(0,L.incrementTutorialStepOnCompletionOfCurrentStep)({intl:r,skipAnalytics:!1,environment:l})}),[l,r]);return(0,g.$K)(i)?(0,q.jsx)(q.Fragment,{children:t.slice(0,i+1).map(((e,t)=>(0,q.jsx)(Je,{showThinking:o,step:e,currentStepGroupIndex:i,incrementStepNumber:d,isStepLatestStepInGroup:t===i,isStepInLatestGroup:n},`${i}-${e.type}-${t}`)))}):null}var nt=n(213148),st=n(164921),it=n(144500),at=n(718942),ot=n(145443),rt=n(184747),lt=n(478140),dt=n(632163),ct=n(953437),ut=n(460709),pt=n(223196),gt=n(229798),mt=n(128093),ht=n(605319);function ft(e){const{open:t,originRect:n,children:i,onDismiss:o}=e,l=(0,a.O7)(),d=(0,r.yK)((e=>({inputMenuStyles:{marginTop:4,marginBottom:6,borderRadius:6,background:e.popoverBackground,boxShadow:e.mediumBoxShadow,width:l.device.isMobile?"100%":388,maxHeight:126,overflow:"hidden",isolation:"isolate"}})),[l.device.isMobile]),[c,u]=(0,s.useState)(null==n?void 0:n.getBoundingClientRect());return(0,s.useEffect)((()=>{const e=p.Ds((()=>{u(null==n?void 0:n.getBoundingClientRect())}),300);return e(),ht.T.addListener(e),()=>ht.T.removeListener(e)}),[n]),(0,q.jsx)(ct.ZP,{popupType:pt.k.Popup,placementToOrigin:ct.ZP.Placement.Top,alignmentToOrigin:ct.ZP.Alignment.Start,disableMouseCapture:!0,open:t,render:()=>(0,q.jsx)(lt.Z,{menuType:ut.og.Popup,width:"100%",maxHeight:"min(40vh, 128px)",maxWidth:"100%",children:i}),onDismiss:o,keepFocus:!0,originRect:c,style:d.inputMenuStyles,preventScaleTransition:!0})}function yt(e){const{clientSkill:t,store:n,onActivateSkill:s,originElement:i,onDismiss:a,inputHasFocus:o}=e;(0,rt.Z)((()=>{mt.Z.reset()}));const r=(0,d.sI)(t.skillType);return(0,q.jsx)(xt,{inputStore:n,clientSkill:t,fillableParameter:r,onActivateSkill:s,originRect:i,onDismiss:a,inputHasFocus:o})}function xt(e){const{clientSkill:t,fillableParameter:n,inputStore:i,onActivateSkill:r,originRect:l,onDismiss:c,inputHasFocus:u}=e,{fillableParameter:p,remainingParameters:m,parameterDefinition:h}=n,f=(0,a.O7)(),{isMobileNative:y}=f.device,x=function(){const[e,t]=(0,s.useState)(!1),n=(0,o.VK)((()=>_.Z.state.phase),[]),i=(0,o.VK)((()=>_.Z.state.estimatedKeyboardWebViewOverlap),[]);return(0,s.useEffect)((()=>{t(!0);const e=setTimeout((()=>{t(!1)}),50);return()=>clearTimeout(e)}),[i,n]),e}(),v=y&&x,S=(0,o.VK)((()=>i.getValue()),[i]),b=(0,s.useCallback)((e=>{r({clientSkill:t,parameterValues:{...m,[p]:e}})}),[t,r,m,p]);if("blockOrText"===h.type)return(0,q.jsx)(vt,{onSelect:b,textValue:S,shouldAcceptText:!0,clientSkill:t,originRect:l,onDismiss:c,hidePopup:!u||v});if("block"===h.type)return(0,q.jsx)(vt,{onSelect:b,textValue:S,shouldAcceptText:!1,clientSkill:t,originRect:l,onDismiss:c,hidePopup:!u||v});if("collection"===h.type)return(0,q.jsx)(St,{onSelect:b,textValue:S,shouldAcceptText:!1,clientSkill:t,originRect:l,onDismiss:c,hidePopup:!u||v});if("tone"===h.type)return(0,q.jsx)(bt,{list:d.hw,onSelectItem:b,textValue:S,clientSkill:t,originRect:l,onDismiss:c,hidePopup:!u||v});if("language"===h.type)return(0,q.jsx)(bt,{list:d.vu,onSelectItem:b,textValue:S,clientSkill:t,originRect:l,onDismiss:c,hidePopup:!u||v});if("textValue"===h.type||"string"===h.type||"summarizeStyle"===h.type||"summarizeMode"===h.type||"user"===h.type)throw new Error("Not implemented yet");(0,g.t1)(h.type)}function vt(e){const{onSelect:t,textValue:n,shouldAcceptText:i,clientSkill:a,originRect:r,onDismiss:l,hidePopup:d=!1}=e,c=(0,o.qz)(void 0,gt.Z),{sections:u,itemsAvailable:p}=(0,ot.bi)({clientSkill:a,shouldAcceptText:i,onSelect:t,textValue:n});return(0,s.useEffect)((()=>{mt.Z.setState({available:p})}),[p]),d?null:(0,q.jsx)(ft,{open:p,onDismiss:l,originRect:r,children:(0,q.jsx)(dt.Z,{type:dt.i.Vertical,disableKeyboard:!1,store:c,sections:u,initialFocus:0,resetInitialFocusOnSectionChange:!0})})}function St(e){const{onSelect:t,textValue:n,shouldAcceptText:i,clientSkill:a,onDismiss:r,originRect:l,hidePopup:d=!1}=e,c=(0,o.qz)(void 0,gt.Z),{sections:u,itemsAvailable:p}=(0,ot.IW)({clientSkill:a,shouldAcceptText:i,onSelect:t,textValue:n});return(0,s.useEffect)((()=>{mt.Z.setState({available:p})}),[p]),d?null:(0,q.jsx)(ft,{open:p,onDismiss:r,originRect:l,children:(0,q.jsx)(dt.Z,{type:dt.i.Vertical,disableKeyboard:!1,store:c,sections:u,initialFocus:0,resetInitialFocusOnSectionChange:!0})})}function bt(e){const{list:t,onSelectItem:n,textValue:s,originRect:i,onDismiss:a,hidePopup:r=!1}=e,l=(0,o.qz)(void 0,gt.Z),d=(0,ot.Dl)({items:t,onSelect:n,textValue:s});return r?null:(0,q.jsx)(ft,{open:!0,onDismiss:a,originRect:i,children:(0,q.jsx)(dt.Z,{type:dt.i.Vertical,disableKeyboard:!1,store:l,initialFocus:0,sections:d,resetInitialFocusOnSectionChange:!0})})}function Ct(e){const{currentSkill:t,store:n,requestedSkill:i,setRequestedSkill:o,onSubmit:r,activateSkill:l,onFocus:d,onBlur:c,...u}=e,p=(0,a.O7)(),[g,m]=(0,s.useState)(!0),h=(0,s.useRef)(null),f=(0,s.useCallback)((e=>{l(e),o(void 0),(0,ot.Zo)({environment:p,store:n})}),[l,p,o,n]),y=(0,s.useCallback)((()=>{"function"==typeof d&&d(),m(!0)}),[d]),x=(0,s.useCallback)((()=>{"function"==typeof c&&c(),m(!1)}),[c]);return(0,q.jsxs)(q.Fragment,{children:[i&&(0,it.clientSkillHasFillableParameters)(i)?(0,q.jsx)(yt,{clientSkill:i,store:n,onActivateSkill:f,originElement:h.current??void 0,onDismiss:()=>o(void 0),inputHasFocus:g}):null,(0,q.jsx)("div",{ref:h,children:(0,q.jsx)(jt,{onFocus:y,onBlur:x,currentSkill:t,requestedSkill:i,setRequestedSkill:o,store:n,onActivateSkill:f,onSubmit:e=>{(0,ot.Zo)({environment:p,store:n}),null==r||r(e),o(void 0)},...u})})]})}function jt(e){const{currentSkill:t,setRequestedSkill:n,requestedSkill:s,store:i,onBackspaceOnEmptyInput:o,onClickInputBox:r,...l}=e,d=(0,a.O7)(),c={typeaheadSkillElement:s?(0,q.jsx)(kt,{requestedSkill:s,onSkillClear:()=>{(0,ot.Zo)({environment:d,store:i}),n(void 0)}}):null,onBackspaceOnEmptyInput:o,store:i,requestedSkill:s,...l};return(0,q.jsx)(D.HY,{...c})}function kt(e){const{requestedSkill:t,onSkillClear:n}=e,[i,a]=(0,s.useState)(!1),o=(0,r.yK)((e=>({typeaheadStyles:{display:"flex",...t?{background:(0,at.zm)(t.category).color(e).background}:{},backgroundBlendMode:"multiply",borderRadius:"100px",paddingTop:"1px",paddingBottom:"1px",paddingLeft:i?"3px":"6px",paddingRight:"12px",gap:"2px",maxHeight:"24px",maxWidth:"120px"},iconStyles:{height:14,width:17,fill:(0,at.zm)(t.category).color(e).color},closeIconStyles:{height:20,width:20,borderRadius:"100px",padding:"3px",fill:"rgba(145, 145, 142, 1)"},hoveredStyles:{...t?{background:(0,at.zm)(t.category).color(e).background}:{}}})),[t,i]);return(0,q.jsx)(G.Z,{singleLineTitle:!0,title:(0,q.jsx)(u.FormattedMessage,{...t.displayName}),style:o.typeaheadStyles,hoveredStyle:o.hoveredStyles,icon:()=>(0,q.jsx)("div",{style:{padding:2.5},children:i?(0,q.jsx)(st.Z,{onClick:n,style:{borderRadius:"100px"},children:(0,nt.U)(o.closeIconStyles)}):t.icon(o.iconStyles)}),onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),onClick:n,variant:"tinted",disabled:!1})}var wt=n(763594),It=n(235997),Mt=n(167133),Tt=n(860114),At=n(561017),Pt=n(479198),Bt=n(863296),_t=n(526388),Ft=n(825464),Zt=n(182375);function Vt(e){const{sessionContext:t}=e,n=(0,a.O7)(),i=(0,o.VK)((()=>{var e;return(null===(e=Zt.H.state)||void 0===e?void 0:e.name)||""}),[]),{sampledSteps:l,previewingStep:d}=(0,o.VK)((()=>({sampledSteps:t.sampledSteps,previewingStep:t.previewingStep})),[t]),c=(0,s.useCallback)((async()=>{await E.assistantActions.commitPreviewAssistantStep({environment:n,sessionId:t.sessionId,updater:t.createUpdater()})}),[n,t]),u=(0,s.useCallback)((async e=>{if(!e.inferenceId)throw new Error("No inference ID");await E.assistantActions.simulateOrCommitStep({environment:n,step:e,commit:!1,isStreaming:!1,sessionId:t.sessionId,inferenceId:e.inferenceId,inferencingError:void 0,updater:t.createUpdater()})}),[n,t]),p=(0,s.useCallback)((async()=>{await E.assistantActions.sampleNextAssistantSteps({environment:n,sessionId:t.sessionId,inferenceId:me.Il(),updater:t.createUpdater()})}),[n,t]),g=(0,r.yK)((e=>({wrap:{display:"flex",alignItems:"center",gap:4,marginTop:8},tooltipInner:{width:400,whiteSpace:"pre-wrap"}})),[]),m=(0,s.useCallback)((e=>{const t=(0,He.P)(e.value).map((e=>(0,We.KT)(e,!0))).join("\n").trim();return(0,q.jsx)("div",{style:g.tooltipInner,children:t})}),[g.tooltipInner]),h=!i;return(0,q.jsxs)("div",{style:g.wrap,children:[l.map(((e,t)=>(0,q.jsx)(_t.Z,{renderTooltip:()=>m(e),placement:Ft.u.Top,alignment:Ft.v.Center,render:n=>(0,q.jsx)(Bt.Z,{focused:d===e,onClick:()=>u(e),...n,children:t+1})},t))),(0,q.jsx)("div",{style:{flexGrow:1}}),(0,q.jsx)(Bt.Z,{onClick:p,icon:Pt.n}),(0,q.jsx)(_t.Z,{renderTooltip:()=>"Please fill task type to commit.",placement:Ft.u.Top,alignment:Ft.v.Center,disableTooltip:!h,render:e=>(0,q.jsx)(Bt.Z,{isBlue:!0,onClick:c,disabled:h,...e,children:"Commit"})})]})}function Rt(e){const{sessionContext:t}=e,n=(0,o.VK)((()=>(0,k.Gw)()),[]),s=(0,o.VK)((()=>(null==t?void 0:t.clientSteps.filter((e=>"human"===e.type)).length)||0),[t]),i=(0,o.VK)((()=>((null==t?void 0:t.sampledSteps.length)||0)>1),[t]),a=(0,o.VK)((()=>n&&s>=3),[n,s]),r=(0,o.VK)((()=>null==t?void 0:t.finetuningDataGeneratorStatus),[t]);return(0,q.jsxs)(q.Fragment,{children:[i&&t&&(0,q.jsx)(Vt,{sessionContext:t}),a&&(0,q.jsx)("div",{style:{margin:4,fontSize:14,color:"red"},children:"Please reset the chat"}),r&&(0,q.jsx)("div",{style:{margin:4,fontSize:14,color:"gray"},children:r})]})}var Lt=n(151454),Et=n(252193);function Kt(e,t){return"skill"===e||"create"===e||"edit"===e?(0,it.getSkillSectionColor)("create",t):"chat"===e?(0,it.getSkillSectionColor)("chat",t):"find"===e?(0,it.getSkillSectionColor)("search",t):void(0,g.t1)(e)}function Ot(){return(0,o.VK)((()=>{const e=U.Pf.isAvailable(),t=P.Z.isXMLAssistantEnabled(),n=B.default.getActiveSession(),{selectedSkill:s,selectedSuggestionGroup:i}=n??{},a=Boolean(null==n?void 0:n.getHasCommittedHumanStep());return t&&!e&&!i&&!a&&(!n||!n.isStreaming())&&!s}),[])?(0,q.jsx)(Wt,{}):null}function Dt(e){const{suggestionGroup:t}=e,n=(0,r.yK)((e=>{const n=t.clientId,{color:s,background:i}=(0,it.getSkillSectionColor)(n,e);return{selectedSuggestionButton:{marginLeft:"auto",background:i},icon:{fill:s}}}),[t]);return(0,q.jsx)(G.Z,{title:(0,q.jsx)("div",{children:t.title}),style:n.selectedSuggestionButton,iconStyle:n.icon,icon:t.icon,variant:"tinted",disabled:!0})}function Wt(e){const t=(0,u.useIntl)(),{renderAsFullPage:n}=(0,j.Io)(),i=(0,s.useMemo)((()=>function(e){let{renderAsFullPage:t,intl:n}=e;return(t?it.globalChatSections:it.pageChatSections).map((e=>{const t=n.formatMessage(e.title),s=e.introAssistantMessage?n.formatMessage(e.introAssistantMessage):void 0;return{type:"prepackaged",clientId:e.key,icon:e.icon,title:t,introAssistantMessage:s,suggestions:e.skills.map((e=>({clientId:e,type:"skill",skillType:e,humanStepMessage:void 0})))}}))}({renderAsFullPage:n,intl:t})),[n,t]),a=(0,r.yK)((e=>({container:{height:"auto",display:"flex",flexDirection:"column",alignItems:"start",gap:6,background:"transparent",top:"unset",bottom:60,zIndex:Lt.hT,borderRadius:0,border:0,boxShadow:"none",marginTop:8,marginBottom:16},carousel:{display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:n?12:6,overflowX:"auto",width:"100%"}})),[n]);return(0,q.jsx)("div",{style:a.container,children:(0,q.jsx)("div",{style:a.carousel,children:i.map((e=>(0,q.jsx)(Ht,{renderAsFullPage:n,suggestionGroup:e},e.clientId)))})})}function Ht(e){let{suggestionGroup:t,renderAsFullPage:n}=e;const{clientId:i,icon:o,title:l}=t,d=(0,a.O7)(),c=(0,j.Io)().type,u=(0,s.useCallback)((async()=>{const{sessionId:e}=await(0,Et.resetAndInitializeAssistantSession)({environment:d,makeActiveSession:!0}),n=B.default.getSessionContext(e);null==n||n.selectSuggestionGroup(t),E.assistantAnalyticsActions.trackAssistantSuggestedSkillGroupClick(d,{sessionId:e,source:c,title:l,skillType:t.clientId})}),[c,d,t,l]),p=(0,r.yK)((e=>{const{color:t,background:s,hoveredBackground:a,pressedBackground:o}=(0,it.getSkillSectionColor)(i,e);return{button:{display:"flex",flexDirection:"column",fontSize:n?13:12,borderRadius:6,width:"100%",padding:n?"12px":"8px 10px",lineHeight:1.25,color:t,background:s},hoveredStyle:{background:a},pressedStyle:{background:o},title:{color:e.regularTextColor,opacity:.9,marginTop:n?8:6,marginRight:n?20:0,marginLeft:0,fontWeight:500,textWrap:n?"balance":"wrap"},icon:{width:n?16:14,height:n?16:14,marginTop:n?0:2,fill:"currentColor"}}}),[i,n]);return(0,q.jsxs)(st.Z,{style:{...p.button},hoveredStyle:p.hoveredStyle,pressedStyle:p.pressedStyle,onClick:u,children:[null==o?void 0:o(p.icon),(0,q.jsx)("div",{style:p.title,children:l})]})}var Nt=n(681886);function zt(){const e=(0,o.VK)((()=>B.default.getActiveSession()),[]),t=(0,Mt.f)(e),n=(0,o.VK)((()=>Boolean(null==e?void 0:e.getHasCommittedHumanStep())),[e]);return(0,o.VK)((()=>{const{selectedSkill:s,selectedSuggestionGroup:i}=e??{};return!(t||n||s||i)}),[e,t,n])?(0,q.jsx)(Ut,{}):null}function Ut(){const{renderAsFullPage:e}=(0,j.Io)(),t=(0,a.Fy)().isMobile,n=(0,u.useIntl)(),s=(0,o.VK)((()=>A.default.state.mainEditorCurrentBlockStore),[]),i=(0,o.VK)((()=>A.default.state.currentSpaceStore),[]),l=(0,o.VK)((()=>{var e;return null===(e=A.default.state.currentUserStore)||void 0===e?void 0:e.getDisplayName(n)}),[n]),d=(0,o.VK)((()=>null==i?void 0:i.getName()),[i]),c=(0,o.VK)((()=>P.Z.isXMLAssistantEnabled()),[]),p=(0,re.iI)({hovered:!1,isAssistantChat:!0}),g=(0,r.yK)((()=>({message:{...p.baseMessage,...p.assistantMessage,marginBottom:0,padding:"0 6px",marginLeft:0,marginTop:8}})),[p.assistantMessage,p.baseMessage]),m=(0,o.VK)((()=>P.Z.isLimitedQnaMode()),[]),h=(0,o.VK)((()=>P.Z.shouldShowEnhancedQnaCopy()),[]),f=(0,Nt.uU)();if(!i||!d||!e&&!s||!l)return null;const y=c?n.formatMessage(ai.assistantChatText,{firstName:l,workspaceName:d}):h?n.formatMessage(ai.qnaEnhancedAssistantChatText,{firstName:l,br:(0,q.jsx)("p",{})}):n.formatMessage(ai.qnaAssistantChatText,{firstName:l,workspaceName:d}),x={opacity:{duration:.6,ease:"linear"},scale:{type:"spring",stiffness:220,damping:20,mass:1},y:{type:"spring",stiffness:220,damping:20,mass:1}};return(0,q.jsxs)("div",{style:{marginBottom:8},children:[c&&(0,q.jsx)(Y.E.div,{variants:{hidden:{opacity:0,scale:.8,y:20},visible:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.6,y:0}},style:{marginBottom:4,padding:e&&!t?"16vh 8px 8px 8px":"4px 8px",transformOrigin:"center left"},initial:"hidden",animate:"visible",exit:"exit",transition:x,children:(0,q.jsx)(ae.g,{variant:e&&!t?"large":"medium",includeBoxShadow:!0})}),(0,q.jsx)(Y.E.div,{style:{...g.message,marginTop:12},initial:"hidden",animate:"visible",exit:"exit",transition:x,children:y}),!c&&!m&&!h&&(0,q.jsx)("p",{style:g.message,children:n.formatMessage(ai.assistantBetaDisclaimerText)}),f&&(0,q.jsx)("p",{style:g.message,children:n.formatMessage(ai.assistantBetaCurrentlyIndexingWorkspaceDisclaimerText)})]})}var Gt=n(749085),qt=n(465993),$t=n(366076),Qt=n(199672),Yt=n(567973),Xt=n(22668),Jt=n(974520);var en=n(676310);function tn(e){const{parentStore:t,searchResultsSteps:n,...s}=e,{pageCitations:i,databaseCitations:a,universalCitations:r}=(0,o.VK)((()=>(0,$t.MD)({searchResultsSteps:n,clientStep:void 0,parentStore:t})),[t,n]);return(0,q.jsx)(en.dd,{pageCitations:i,databaseCitations:a,universalCitations:r,...s})}var nn=n(100859);function sn(e){const{chatStep:t,parentStore:n,searchResultsSteps:i,...r}=e,{pageCitations:l,databaseCitations:d,universalCitations:c}=(0,o.VK)((()=>(0,$t.MD)({searchResultsSteps:i,clientStep:t,parentStore:n})),[t,n,i]),u=function(e){const t=(0,a.O7)(),n=(0,nn.r)(),{assistantSessionContext:i,isStreaming:r}=(0,o.VK)((()=>{const e=B.default.getActiveSession(),t=Boolean(null==e?void 0:e.isStreaming());return{assistantSessionContext:e,isStreaming:t}}),[]),l=(0,o.VK)((()=>i&&e?i.getAssistantResponseCategory(e.inferenceId):void 0),[e,i]);return(0,s.useEffect)((()=>{!l&&!r&&n&&i&&e&&(0,Et.categorizeAssistantStepAndUpdateContext)({environment:t,assistantSessionContext:i,clientAssistantChatStep:e,spaceStore:n})}),[l,i,e,t,r,n]),l}(t);return 0===l.length&&0===d.length&&0===c.length?(0,q.jsx)(en.Pm,{assistantResponseCategory:u,inferenceId:t.inferenceId}):(0,q.jsx)(en.dd,{pageCitations:l,databaseCitations:d,universalCitations:c,...r})}function an(e){const{chatTurn:t,isLastChatTurn:n,hoverStore:s,parentStore:i,expandedStore:a,toggledStore:r,loadingState:l,chatWrapperRef:d}=e,c=(0,o.VK)((()=>{var e;return(null===(e=B.default.getActiveSession())||void 0===e?void 0:e.isStreaming())??!1}),[]),u=n?l??(c?{isStreaming:!0}:void 0):void 0,m=function(){const e=(0,o.VK)((()=>{var e;return(null===(e=B.default.getActiveSession())||void 0===e?void 0:e.isStreaming())??!1}),[]);return(0,o.VK)((()=>{var e;return null===(e=B.default.getActiveSession())||void 0===e||null===(e=e.getPreviewingStepErrorObservations())||void 0===e?void 0:e.map((e=>e.value)).join("\n")}),[])&&!e}(),h=p.dF(t,qt.qT),f=t.filter(qt.EW),y=(0,o.VK)((()=>{var e;return null===(e=Jt.Z.state)||void 0===e?void 0:e.showSearchDebugPanel}),[]),x={hoverStore:s,parentStore:i,expandedStore:a,canExpand:!0,toggledStore:r,loadingState:u};return m&&n?null:(0,q.jsxs)(q.Fragment,{children:[(0,g.$K)(h)?(0,q.jsx)(sn,{...x,chatStep:h,searchResultsSteps:f}):(0,q.jsx)(tn,{...x,searchResultsSteps:f}),(0,q.jsx)(en.PK,{containerRef:d,hoverStore:s,parentStore:i}),y&&(0,q.jsx)(en.wA,{containerRef:d,hoverStore:s,parentStore:i})]})}var on=n(476870),rn=n(319385),ln=n(44041),dn=n(535057);const cn=(0,u.defineMessages)({currentlyIndexing:{id:"assistantChat.limitedQna.currentlyIndexing",defaultMessage:"Im still learning about your workspace. This can take up to 24h, but feel free to try asking me a question."},responseWithCitedPages:{id:"assistantChat.limitedQna.responseWithCitedPages",defaultMessage:"Youre on the free plan, so keep in mind that AI responses can be limited."}});function un(e){const{numberOfCitedPages:t,latestStep:n}=e;return(0,o.VK)((()=>{const e=rn.default.checkGate({gateName:"limited_qna_show_quality_messages"});return Boolean(e)}),[])?(0,q.jsx)(pn,{numberOfCitedPages:t,latestStep:n}):null}function pn(e){const{numberOfCitedPages:t,latestStep:n}=e,{isMobile:i}=(0,a.Fy)(),l=(0,u.useIntl)(),d=(0,Nt.uU)(),c=(0,o.VK)((()=>P.Z.isLimitedQnaMode()),[]),p=(0,o.VK)((()=>wt.Z.state),[]),g=(0,o.VK)((()=>{var e;return null===(e=B.default.getActiveSession())||void 0===e?void 0:e.isStreaming()}),[]),m=(0,o.VK)((()=>{if(g||!c||!p)return!1;return"assistantChat"===(null==n?void 0:n.type)}),[g,c,p,null==n?void 0:n.type]),h=(0,o.VK)((()=>{if(0!==t||d||!n||"assistantChat"!==n.type)return!1;const e=(0,$t.oc)({clientStep:n}).length,s=(0,on.lB)(40);return e<360||s}),[d,n,t]),f=(0,r.yK)((e=>({text:{color:e.mediumTextColor,fontSize:i?16:14,marginTop:13,marginBottom:19,paddingLeft:10,paddingRight:10,fontWeight:500},aiAddonLink:{color:e.accentColors.uiBlue[600],cursor:"pointer"}})),[i]),y=(0,s.useCallback)((()=>h?(0,q.jsx)(gn,{latestStep:n}):null),[n,h]),x=(0,s.useCallback)((()=>d?(0,q.jsx)(q.Fragment,{children:l.formatMessage(cn.currentlyIndexing)}):null),[l,d]),v=(0,s.useCallback)((()=>0===t?null:(0,q.jsx)("div",{children:l.formatMessage(cn.responseWithCitedPages)})),[l,t]),S=(0,s.useCallback)((()=>{switch(!0){case h:return(0,q.jsx)(y,{});case d:return(0,q.jsx)(x,{});case 0!==t:return(0,q.jsx)(v,{});default:return null}}),[h,y,d,x,t,v])();return m&&S?(0,q.jsx)("div",{style:f.text,children:S}):null}function gn(e){const{latestStep:t}=e,{isMobile:n}=(0,a.Fy)(),s=(0,a.O7)(),i=(0,o.VK)((()=>P.Z.isLimitedQnaMode()),[]),l=(0,o.VK)((()=>{var e;return null===(e=B.default.getActiveSession())||void 0===e?void 0:e.isStreaming()}),[]),d=(0,o.VK)((()=>{if(l)return!1;if(!i)return!1;return"assistantChat"===(null==t?void 0:t.type)}),[l,t,i]),c=(0,r.yK)((e=>({text:{color:e.mediumTextColor,fontSize:n?16:14,marginTop:13,marginBottom:19,paddingRight:10,fontWeight:500},aiAddonLink:{color:e.accentColors.uiBlue[600],cursor:"pointer"}})),[n]),p=()=>{(0,ln.y)(s,{from:"ai_limited_qna_no_results",for:(0,dn.zt)(),addOnFeature:"ai"})};return d?(0,q.jsx)("div",{style:c.text,children:(0,q.jsx)(u.FormattedMessage,{id:"assistantChat.limitedQna.upsell",defaultMessage:"Because you're on the Free Plan, Notion AI can only search a limited amount of your workspace. Purchase the <aiAddOnLink>AI add-on to go unlimited</aiAddOnLink>.",values:{aiAddOnLink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,q.jsx)("span",{onClick:p,style:c.aiAddonLink,children:t})}}})}):null}function mn(e){const{steps:t,...n}=e,s=(0,Qt.by)(t);return(0,q.jsx)(q.Fragment,{children:s.map(((e,t)=>(0,q.jsx)(hn,{...n,chatTurn:e,isLastChatTurn:t===s.length-1},t)))})}function hn(e){const{currentSpaceStore:t,chatTurn:n,isLastChatTurn:i,mockTextStore:a,loadingState:r}=e,l=(0,o.VK)((()=>B.default.getActiveAssistantConfigurationState()),[]),d=(0,o.VK)((()=>{var e;return null===(e=B.default.getActiveSession())||void 0===e?void 0:e.isStreaming()}),[]),c=(0,s.useMemo)((()=>Gt.default.createValue(!0)),[]),u=(0,s.useMemo)((()=>Gt.default.createValue(!1)),[]),m=p.sE(n,qt.qT),{pageCitations:h,universalCitations:f}=(0,o.VK)((()=>m?(0,$t.CX)({clientStep:m,citationOrdering:void 0,parentStore:t}):{pageCitations:[],universalCitations:[]}),[t,m]),y=(0,o.qz)(void 0,Yt.d);(0,s.useEffect)((()=>{(!i||!d&&(0,g.$K)(m)&&0===h.length&&0===f.length)&&c.setState(!1)}),[c,d,m,h,f,i]),(0,s.useEffect)((()=>{i&&r&&(u.setState(!1),c.setState(!0))}),[u,c,r,i]);const x=(0,s.useMemo)((()=>p.sE(n,qt.qT)??n.at(-1)),[n]),v=(0,s.useRef)(null),S={chatTurn:n,isLastChatTurn:i,hoverStore:y,parentStore:t,expandedStore:u,toggledStore:c,loadingState:r,chatWrapperRef:v},b={parentStore:t,parentSpaceId:null==t?void 0:t.id,latestStepCitationHoverStore:y,mockTextStore:a};return(0,q.jsxs)(q.Fragment,{children:[n.map(((e,t)=>{const n=e===x;return(0,q.jsxs)(s.Fragment,{children:[(0,q.jsx)(Xt.H,{clientStep:e,wrapperRef:n?v:void 0,...b}),n&&(0,q.jsx)(an,{...S})]},`${(null==l?void 0:l.sessionId)??""}-${t}`)})),i&&(0,q.jsx)(un,{numberOfCitedPages:h.length,latestStep:m})]})}var fn=n(418101);const yn=(0,u.defineMessages)({assistantErrorText:{id:"assistantChat.errorMessage",defaultMessage:"Im sorry, Im having trouble completing this request. Please click {tryAgainIcon} try again or type a new command."}});function xn(){const e=(0,u.useIntl)(),{isMobile:t}=(0,a.Fy)(),n=(0,o.VK)((()=>{const e=B.default.getActiveAssistantConfigurationState();return Boolean((null==e?void 0:e.sampling)||(null==e?void 0:e.evaluating))}),[]),s=(0,r.yK)((e=>({error:{fontSize:t?16:14,color:"light"===e.mode?e.accentColors.gray[600]:e.accentColors.translucentGray[700],fontWeight:500,padding:"2px 6px",marginLeft:-4,lineHeight:1.45},tryAgainIconWrapper:{display:"inline-flex",marginRight:2,alignItems:"center",verticalAlign:"middle",marginTop:-1},icon:{height:12,width:12}})),[t]),i=(0,o.VK)((()=>{var t;if(n)return;const i=null===(t=B.default.getActiveSession())||void 0===t?void 0:t.getPreviewingStepErrorObservations();return i&&i.length>0?e.formatMessage(yn.assistantErrorText,{tryAgainIcon:(0,q.jsx)("div",{style:s.tryAgainIconWrapper,children:(0,fn.b)(s.icon)})}):void 0}),[e,n,s]);return i?(0,q.jsx)("div",{style:s.error,children:i}):null}var vn=n(241154),Sn=n(875553),bn=n(130134),Cn=n(519981),jn=n(701230),kn=n(359584),wn=n(940470),In=n(619584),Mn=n(824615),Tn=n(231945),An=n(436488),Pn=n(374194),Bn=n(636596),_n=n(637034),Fn=n(394841),Zn=n(41747),Vn=n(19541),Rn=n(198008),Ln=n(828344),En=n(237074),Kn=n(83982),On=n(604489),Dn=n(6249),Wn=n(520119),Hn=n(646964),Nn=n(225888),zn=n(139634),Un=n(100475),Gn=n(155320);function qn(e){const{isEmptyState:t}=e,{isQuickSearchMode:n}=(0,j.Io)(),s=(0,a.Fy)(),{isMobile:i}=s,r=(0,o.VK)((()=>Gn.default.state.open),[]),{shouldShow:l,openForethought:d,aiDetectedSupportQuery:c}=(0,o.VK)((()=>{const e=B.default.getActiveSession();return t?{shouldShow:!n&&!r&&!i,aiDetectedSupportQuery:!1,openForethought:!1}:{shouldShow:(null==e?void 0:e.showGetSupportPill)??!1,aiDetectedSupportQuery:!0,openForethought:P.Z.state.isForethoughtHandoffEnabled()}}),[r,i,n,t]);return l?(0,q.jsx)($n,{openForethought:d,aiDetectedSupportQuery:c}):null}function $n(e){const{openForethought:t,aiDetectedSupportQuery:n}=e,i=(0,a.O7)(),{isMobileNative:l}=(0,a.Fy)(),d=(0,o.VK)((()=>{var e;const t=null===(e=B.default.getActiveSession())||void 0===e?void 0:e.getCombinedSteps().reverse().find(qt.th),n=A.default.state.currentSpaceStore;if(n)return(0,Hn.FB)({value:null==t?void 0:t.text,loadRecordModel:n.loadRecordModel})}),[]),c=(0,r.yK)((()=>({wrap:{display:"flex",gap:6}})),[]),p=(0,s.useCallback)((async()=>{const e=B.default.getActiveAssistantConfigurationState();if(e&&(Nn.Ar(i,{qnaSessionId:e.sessionId,from:"qna_modal_chat"}),n&&(0,Ln.trackAiDetectedGetSupportPillClick)(i,{sessionId:e.sessionId})),t)if(E.assistantOriginElementStore.setState({...E.assistantOriginElementStore.state,currentState:"default"}),E.assistantMenuActions.closeAssistantRightHandSideMenu({environment:i,withoutDismissCheck:!0}),"undefined"!=typeof Forethought)Forethought("widget","clearLocalData"),Forethought("widget","show"),Forethought("widget","open");else{const s=await d;function a(e){var t;"forethoughtWidgetLoaded"===e.data.event&&(null===(t=Forethought)||void 0===t||t("widget","open"),window.removeEventListener("message",a))}zn.j({environment:i,from:"ai_assistant_pill",prepopulatedContent:s}),window.addEventListener("message",a)}else l?Un.Z.setState({...Un.Z.state,open:!0}):E.assistantMenuActions.openCornerChatHelp()}),[n,i,l,t,d]);return(0,q.jsx)("div",{style:c.wrap,children:(0,q.jsx)(G.Z,{icon:e=>(0,N.m)({...e,fontWeight:500}),onClick:p,title:(0,q.jsx)(u.FormattedMessage,{defaultMessage:"Get Notion help",id:"AssistantChat.routeToNotionHelp"}),variant:"tinted"})})}const Qn=(0,n(745238).IU)("graduationCap",{viewBox:"0 0 24 24",svg:(0,q.jsx)("path",{d:"M3.41742 14.7449C3.41742 16.1372 4.25009 17.3867 5.70726 18.306V19.1627C5.23021 19.3234 4.93531 19.7518 4.93531 20.3408V22.7416C4.93531 23.5002 5.42103 24 6.15829 24H6.52259C7.25985 24 7.74557 23.5002 7.74557 22.7416V20.3408C7.74557 19.7607 7.45934 19.3234 6.99097 19.1627V18.9575C8.35273 19.5197 10.0614 19.85 11.9957 19.85C17.0958 19.85 20.5826 17.583 20.5826 14.7449V10.7466L23.0459 9.58639C23.6617 9.29187 24 8.72961 24 8.12272C24 7.52475 23.6617 6.95356 23.0459 6.66797L14.4677 2.63394C13.5222 2.19663 12.7589 1.99135 11.9957 2.00028C11.2411 1.99135 10.4778 2.19663 9.52367 2.63394L0.954102 6.66797C0.329599 6.95356 0 7.52475 0 8.12272C0 8.72961 0.329599 9.29187 0.954102 9.58639L3.41742 10.7466V14.7449ZM11.9957 12.4959C11.4405 12.4959 10.9115 12.3531 10.1915 12.005L7.88435 10.934L11.189 9.14907C11.4492 9.22047 11.7355 9.2651 12.0304 9.2651C13.0192 9.2651 13.9733 8.79208 13.9733 8.12272C13.9733 7.4712 13.0192 7.00711 12.0304 7.00711C11.0329 7.00711 10.0701 7.4712 10.0701 8.12272C10.0701 8.21196 10.0875 8.29229 10.1135 8.36369L6.50524 10.2825L2.46332 8.39046C2.32454 8.32799 2.25515 8.23874 2.25515 8.12272C2.25515 8.01562 2.32454 7.91745 2.46332 7.85497L10.1915 4.24041C10.9115 3.90127 11.4405 3.74955 11.9957 3.74955C12.5508 3.74955 13.0799 3.90127 13.8085 4.24041L21.5367 7.85497C21.6668 7.91745 21.7362 8.01562 21.7362 8.12272C21.7362 8.23874 21.6668 8.32799 21.5367 8.39046L13.8085 12.005C13.0799 12.3531 12.5508 12.4959 11.9957 12.4959ZM5.09143 14.7449V11.532L5.70726 11.8176V16.1997C5.2996 15.7445 5.09143 15.2537 5.09143 14.7449ZM11.9957 14.2541C12.7589 14.263 13.5222 14.0577 14.4677 13.6115L18.9086 11.532V14.7449C18.9086 16.5567 16.1677 18.2256 11.9957 18.2256C9.92266 18.2256 8.1966 17.8062 6.99097 17.1636V12.4245L9.52367 13.6115C10.4778 14.0577 11.2411 14.263 11.9957 14.2541Z"})});function Yn(){const{isQuickSearchMode:e}=(0,j.Io)(),t=(0,a.Fy)(),{isMobile:n}=t,s=(0,o.VK)((()=>Gn.default.state.open),[]);return(0,o.VK)((()=>{const t=B.default.getActiveSession(),i=B.default.getActiveAssistantConfigurationState();return!!P.Z.isAssistantTutorialEnabledForUser()&&!(e||s||n||t&&(0!==t.clientSteps.length||0!==t.temporaryClientSteps.length)||i&&(i.sampling||i.evaluating))}),[s,n,e])?(0,q.jsx)(Xn,{}):null}function Xn(){const e=(0,r.yK)((()=>({wrap:{display:"flex",gap:6}})),[]),t=(0,a.O7)(),n=(0,u.useIntl)(),i=(0,s.useCallback)((()=>{(0,R.navigateToFullPageChatAndLogAnalytics)({environment:t,from:"tutorial_button",callback:()=>{(0,L.startTutorial)({environment:t,skipAnalytics:!1,fromForAnalytics:"emptyStateActionButton",intl:n})}})}),[t,n]);return(0,q.jsx)("div",{style:e.wrap,children:(0,q.jsx)(G.Z,{icon:e=>Qn({...e,fontWeight:500}),onClick:i,title:(0,q.jsx)(u.FormattedMessage,{defaultMessage:"Take a tour",id:"AssistantStartTutorialButton.title"}),variant:"tinted"})})}var Jn=n(164369);function es(e){const{text:t}=e,n=(0,r.yK)((()=>({wrap:{display:"flex",padding:"2px 6px",maxWidth:"calc(100% + 8px)",minWidth:"80px",marginLeft:-4}})),[]);return(0,q.jsx)(re.JC,{clientStep:void 0,forceShowFeedback:!1,children:(0,q.jsx)("div",{style:n.wrap,children:t})})}function ts(e){const{title:t,assistantMessage:n,children:s}=e,i=(0,o.VK)((()=>A.default.state.currentSpaceStore),[]),l=(0,O.u)(),{isMobile:d}=(0,a.Fy)(),c=(0,r.yK)((e=>({SuggestionGroup:{width:"100%"},title:{paddingBottom:4,marginBottom:-6,fontSize:l.smallTextSize,fontWeight:500,color:e.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"flex-start",gap:6},titleButton:{display:"flex",fontSize:14,fontWeight:500,color:e.mediumTextColor,marginLeft:-4,whiteSpace:"normal",flexShrink:1,height:"auto",padding:"6px 8px"},icon:{width:16,fill:"currentColor"},suggestions:{display:"flex",alignItems:"flex-start",overflowX:"auto",flexDirection:"row",whiteSpace:"nowrap",gap:6,rowGap:6,flexWrap:"wrap",marginBottom:0,...d&&{overflowX:"scroll",flexWrap:"nowrap",paddingBottom:8,marginBottom:-8,paddingLeft:16,paddingRight:16,marginLeft:-16,marginRight:-16}}})),[l,d]);return i?(0,q.jsxs)("div",{style:c.SuggestionGroup,children:[t&&(0,q.jsx)(Jn.Z,{style:c.title,children:t}),n&&(0,q.jsx)(es,{text:n}),(0,q.jsx)("div",{style:c.suggestions,children:s})]}):null}var ns=n(993537),ss=n(725651),is=n(405829);const as={create:ss.R,edit:ss.R,chat:is.s,find:ns.A};function os(e){let{suggestion:t,suggestionGroup:n,isFollowup:i,sessionId:o}=e;const l=(0,a.O7)(),d=(0,u.useIntl)(),c=(0,j.Io)().type,{title:p,icon:g}=(0,s.useMemo)((()=>{if("skill"===t.type){const e=(0,it.createClientGlobalSkill)(t.skillType);return{title:d.formatMessage(e.displayName),icon:e.icon}}return{title:t.humanStepMessage,icon:as[t.type]}}),[d,t]),m=(0,s.useCallback)((()=>{i?(0,Mn.qJ)({environment:l,suggestion:t,assistantSurfaceType:c}):(0,Mn.Is)({environment:l,suggestion:t,suggestionGroup:"prepackaged"===(null==n?void 0:n.type)?n:void 0,assistantSurfaceType:c});const e="skill"===t.type?t.skillType:void 0,s="prepackaged"===(null==n?void 0:n.type)?null==n?void 0:n.clientId:void 0;E.assistantAnalyticsActions.trackAssistantSkillSuggestedButtonClick(l,{sessionId:o,source:c,skillType:e,skillSectionType:s,suggestionType:t.type,suggestionCreationSource:(null==n?void 0:n.type)??"server"})}),[t,n,l,o,c,i]),h=(0,r.yK)((e=>{const s={display:"inline-flex",borderRadius:16,whiteSpace:"normal",height:"auto",minHeight:32};if(!n||"prepackaged"!==n.type)return{button:s,icon:{fill:Kt(t.type,e).color}};const i=n.clientId,{color:a}=(0,it.getSkillSectionColor)(i,e);return{button:s,icon:{fill:a}}}),[n,t.type]);return(0,q.jsx)(G.Z,{title:(0,q.jsx)("div",{children:p}),style:h.button,icon:g,iconStyle:h.icon,onClick:m,variant:"tinted"})}function rs(e){const{suggestionGroup:t,showTitleOnly:n}=e,{suggestions:s}=t,i=(0,o.VK)((()=>{var e;return null===(e=B.default.getActiveSession())||void 0===e?void 0:e.sessionId}),[]),a=(0,q.jsxs)(q.Fragment,{children:[s.map((e=>(0,q.jsx)(os,{suggestion:e,suggestionGroup:t,sessionId:i},e.clientId))),"prepackaged"===t.type&&"search"===t.clientId&&(0,q.jsx)(Wn.y,{analyticsSource:"empty_chat"})]});return(0,q.jsx)(ts,{assistantMessage:"prepackaged"===t.type?t.introAssistantMessage:void 0,children:!n&&a})}const ls=(0,u.defineMessages)({accept:{id:"assistant.acceptAllButton",defaultMessage:"Accept"},copy:{id:"assistant.copy",defaultMessage:"Copy"},reject:{id:"assistant.undoAllButton",defaultMessage:"Discard"},rejectSingle:{id:"assistant.undoSingleButton",defaultMessage:"Discard"},insert:{id:"assistant.insertButton",defaultMessage:"Insert"},savePage:{id:"assistant.savePage",defaultMessage:"Save page"},savePages:{id:"assistant.savePages",defaultMessage:"Save pages"},insertPage:{id:"assistant.insertPage",defaultMessage:"Insert page"},insertPages:{id:"assistant.insertPages",defaultMessage:"Insert pages"},saveToPrivateTooltip:{id:"assistant.saveToPrivateTooltip",defaultMessage:"Save to your private pages"},saveToDatabaseTooltip:{id:"assistant.saveToDatabaseTooltip",defaultMessage:"Save to {database}"},insertToPageTooltip:{id:"assistant.insertToPageTooltip",defaultMessage:"Insert into this page"},insertToDatabaseTooltip:{id:"assistant.insertToDatabaseTooltip",defaultMessage:"Insert into {database}"}});function ds(e){const{sessionContext:t,renderState:n,mockTextStore:r}=e,l=n.type,d=(0,a.O7)(),c=(0,j.Io)(),p=(0,o.VK)((()=>c.renderAsFullPage),[c.renderAsFullPage]),g=(0,o.VK)((()=>null==t?void 0:t.latestCommitInferenceId),[t]),m=(0,o.VK)((()=>wt.Z.state),[]),h=(0,o.VK)((()=>P.Z.isXMLAssistantEnabled()),[]),f=(0,o.VK)((()=>{if(!A.default.state.mainEditorCurrentBlockStore)return!1;return"page"===A.default.state.mainEditorCurrentBlockStore.getType()}),[]),S=(0,o.VK)((()=>{var e;const t=null===(e=(0,Fn.Al)(A.default.state.currentSpaceViewStore))||void 0===e?void 0:e.id,n=A.default.state.mainEditorCurrentBlockStore;return(null==n?void 0:n.id)===t}),[]),b=(0,o.VK)((()=>P.Z.showScopedSearch()),[]),C=(0,o.VK)((()=>P.Z.isMode("enhanced_beta")),[]),w=(0,o.VK)((()=>(0,k.lV)()),[]),I=(0,o.VK)((()=>P.Z.isAssistantInitialSuggestionsEnabled()),[]),M=(0,s.useCallback)((async()=>{if(!t)return;const e=t.sessionId;g&&(Et.saveFeedback({environment:d,inferenceId:g,type:"assistant_retry",sessionId:e}),(0,on.aw)(.01)&&Vn.Z.update((()=>({open:!0,inferenceId:g,thumbsUpOrDown:"retry",sessionId:e}))));const n=await(0,Kn.xx)({environment:d,sessionId:e,assistantSurface:c});if(wn.x.isSuccess(n)){const e=n.value.textValue;e&&r&&(await i.default.afterNextFlush(),v.createAndCommit({userAction:"AssistantFollowupActionBar.tryAgain",environment:d,perform:t=>{y.sO({environment:d,store:r,value:e,transaction:t})}}),x.NX({store:r}))}else await Kn.f6({environment:d,sessionId:e,assistantSurfaceType:c.type})}),[t,d,g,r,c]),T=(0,o.VK)((()=>{var e;return null===(e=(0,Et.getCurrentPageInformation)())||void 0===e?void 0:e.primaryEditorStore}),[]),_=(0,o.VK)((()=>null==T?void 0:T.isCollectionView()),[T]),F=(0,s.useCallback)((async()=>{const e=B.default.getActiveSessionId();if(!e)return;const t=`assistant-insert-into-${(0,vn.e$)("insert-into-page-")}`;if(!T)return;const n=v.createAndCommit({userAction:"assistant.insertIntoPage",environment:d,undoCheckpoint:t,perform:t=>Et.insertAssistantChatIntoPage({environment:d,pageStore:T,sessionId:e,transaction:t})}),s=B.default.getSessionContextOrThrow(e);await Et.commitPreviewAssistantStep({environment:d,sessionId:e,updater:s.createUpdater()}),s.addClientStep({inferenceId:me.Il(),type:"humanAction",action:"insert",undoCheckpointNames:[t],pageId:T.id,numberOfEdits:n.performResult}),Ln.trackInsertPill(d,{sessionId:e})}),[T,d]);return"empty_state"===l||"chat"===l&&void 0===n.chatStep?(0,q.jsxs)(ts,{title:I&&(0,q.jsx)(u.FormattedMessage,{id:"assistant.suggestionGroup.suggestedForYou",defaultMessage:"For you"}),children:[(0,q.jsx)(ps,{}),b&&(0,q.jsx)(Wn.y,{analyticsSource:"search_results"}),!C&&(0,q.jsx)(qn,{isEmptyState:!0}),(0,q.jsx)(Yn,{}),(0,q.jsx)(ms,{})]}):(0,q.jsxs)(ts,{children:["accept_edits"===n.type&&g&&(0,q.jsx)(xs,{renderState:n,inferenceId:g}),"pages_created"===n.type&&g&&(0,q.jsx)(q.Fragment,{children:t&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(hs,{renderState:n,inferenceId:g,sessionContext:t}),f&&(0,q.jsx)(fs,{renderState:n,inferenceId:g,sessionContext:t})]})}),t&&w&&(0,q.jsx)(Tn.ZP,{popupType:d.device.isMobile?Tn.Z4.SlideUp:Tn.Z4.Popup,placementToOrigin:Tn.pO.Bottom,alignmentToOrigin:Tn.vR.Center,originGap:4,renderOrigin:e=>(0,q.jsx)(G.Z,{icon:Cn.V,title:"Give feedback",variant:"tinted",...e}),render:e=>(0,q.jsx)(ys,{buttonPopupParent:e,sessionContext:t})}),(0,q.jsx)(qn,{isEmptyState:!1}),"actioned_edits"===l&&null,("chat"===n.type||"search_result_chat"===n.type)&&(0,q.jsxs)(q.Fragment,{children:[n.chatStep?(0,q.jsx)(G.Z,{icon:Sn.U,onClick:()=>{(0,Rn.p)({environment:d,clientStep:n.chatStep})},title:(0,q.jsx)(u.FormattedMessage,{...ls.copy}),variant:"tinted"}):null,!h||S||p||_?null:(0,q.jsx)(G.Z,{icon:jn.H,onClick:F,title:(0,q.jsx)(u.FormattedMessage,{...ls.insert}),variant:"tinted"})]}),t&&(0,q.jsx)(us,{sessionContext:t}),m&&"search_result_chat"===l&&b&&(0,q.jsx)(Wn.y,{analyticsSource:"search_results"}),g&&(0,q.jsx)(cs,{inferenceId:g,isActionedEdits:"actioned_edits"===l,handleRetry:M}),(0,q.jsx)(ms,{})]})}function cs(e){const{inferenceId:t,isActionedEdits:n,handleRetry:s}=e,i=(0,o.VK)((()=>{var e,t;const n=Boolean(null===(e=A.default.state.currentSpaceStore)||void 0===e?void 0:e.getSettings().enable_ai_training),s=B.default.getActiveSession();return"groupedEditCard"===(null==s||null===(t=s.getCombinedSteps())||void 0===t||null===(t=t.at(-1))||void 0===t?void 0:t.type)||P.Z.isAssistantThumbsUpDownFeedbackBarActionEnabled(n)}),[]),a=(0,r.yK)((e=>({actionButtonWrapper:{padding:i?"1px 6px":0,gap:2},thumbButton:{height:24,width:24,borderRadius:12},retryButton:{height:32,width:32,borderRadius:"100%"},iconColor:{fill:e.regularIconColor}})),[i]);return n&&!i?null:(0,q.jsx)(G.Z,{style:a.actionButtonWrapper,disabled:!0,title:(0,q.jsxs)(q.Fragment,{children:[i&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Dn.i5,{disableTooltip:!1,inferenceId:t,buttonStyle:a.thumbButton,iconStyle:a.iconColor}),(0,q.jsx)(Dn.PI,{disableTooltip:!1,inferenceId:t,buttonStyle:a.thumbButton,iconStyle:a.iconColor})]}),!n&&(0,q.jsx)(_t.Z,{renderTooltip:()=>(0,q.jsx)(u.FormattedMessage,{defaultMessage:"Try again",id:"assistant.retryButton"}),render:e=>(0,q.jsx)(ee.Z,{...e,icon:fn.b,style:i?a.thumbButton:a.retryButton,iconStyle:a.iconColor,onClick:()=>{null==s||s()},ariaLabel:"Retry an assistant message"})})]}),variant:"tinted"})}function us(e){const{sessionContext:t}=e,n=(0,o.VK)((()=>P.Z.isAssistantFollowupSuggestionsEnabled()),[]),s=(0,o.VK)((()=>(null==t?void 0:t.followupSuggestions)??[]),[t]),i=(0,o.VK)((()=>void 0===(null==t?void 0:t.followupSuggestions)),[t]),a=(0,o.VK)((()=>null==t?void 0:t.sessionId),[t]);return n?i?(0,q.jsx)(gs,{widthPercentages:[25,30]}):(0,q.jsx)(q.Fragment,{children:s.map((e=>(0,q.jsx)(os,{suggestion:e,isFollowup:!0,sessionId:a},e.clientId)))}):null}function ps(){const e=(0,a.O7)(),t=(0,u.useIntl)(),n=(0,j.Io)().type,i=(0,o.VK)((()=>P.Z.isAssistantInitialSuggestionsEnabled()),[]),r=(0,o.VK)((()=>"corner"===n?Zn.Z.state.initialSuggestions.map(vs):Zn.Z.state.initialSuggestions),[n]),l=(0,o.VK)((()=>"loading"===Zn.Z.state.loadingState.type),[]);return(0,s.useEffect)((()=>{if(!i)return;const n=1*In.U6,{lastFetched:s}=Zn.Z.state.loadingState;(void 0===s||Date.now()-s>n||0===r.length)&&(0,Mn.nv)({environment:e,intl:t})}),[e,i,r.length,t]),i?l?(0,q.jsx)(gs,{widthPercentages:[40,45]}):(0,q.jsx)(q.Fragment,{children:r.map((e=>(0,q.jsx)(rs,{suggestionGroup:e},e.clientId)))}):null}function gs(e){const{widthPercentages:t}=e,n=(0,r.yK)((e=>({shimmer:{borderRadius:16,height:32,width:"100%"}})),[]),s=t.map((e=>`${e}%`));return(0,q.jsx)(q.Fragment,{children:s.map(((e,t)=>(0,q.jsx)(Bn.Z,{style:{...n.shimmer,width:e}},`shimmer_${e}_${t}`)))})}function ms(){const e=(0,a.O7)(),t=(0,r.yK)((e=>({limitedQnaUpgradeIcon:{fill:e.accentColors.uiBlue[600]}})),[]),n=(0,Nt.uU)(),i=(0,o.VK)((()=>P.Z.isLimitedQnaMode()&&!n),[n]),l=(0,s.useCallback)((async()=>{await(0,ln.y)(e,{from:"ai_limited_qna_upsell_action_button",for:(0,dn.zt)(),addOnFeature:"ai"})}),[e]);return i?(0,q.jsx)(G.Z,{title:(0,q.jsx)(u.FormattedMessage,{defaultMessage:"Get unlimited AI",id:"assistant.limitedQnaUpsellButton"}),onClick:l,external:!0,variant:"tinted",icon:e=>(0,kn.r)({...e,...t.limitedQnaUpgradeIcon})},"limitedQnaUpsellButton"):null}function hs(e){const{renderState:{groups:t},inferenceId:n,sessionContext:i}=e,r=(0,a.O7)(),l=(0,u.useIntl)(),d=(0,On.E)({inferenceId:n,operationIds:t.flatMap((e=>e.operationIds))}),c=(0,s.useCallback)((async e=>{const n=B.default.getActiveSession();n&&(await(0,En.openMoveToMenuAndAcceptPagesCreated)({environment:r,groups:t,sessionContext:n,originRectForMenu:e.currentTarget.getBoundingClientRect()}),Ln.trackSavePagePill(r,{sessionId:n.sessionId}))}),[r,t]),p=t.length>1?l.formatMessage(ls.savePages):l.formatMessage(ls.savePage),m=(0,o.VK)((()=>{const e=t.map((e=>i.getCollectionTargetForPendingPage({environment:r,pageId:e.pageId})));return e.every((e=>!(0,g.$K)(e)))?l.formatMessage(ls.saveToPrivateTooltip):e.every(g.$K)&&e.length>0&&e.slice(1).every((t=>t.id===e[0].id))?l.formatMessage(ls.saveToDatabaseTooltip,{database:(0,_n.V)(e[0],l,r,!0)}):void 0}),[r,t,l,i]);return(0,q.jsx)(_t.Z,{disableTooltip:!(0,g.$K)(m),renderTooltip:()=>m,render:e=>(0,q.jsx)(G.b,{title:p,icon:bn.c,onDropdownClick:c,onClick:d,variant:"tinted",tooltipEvents:e})})}function fs(e){const{renderState:{groups:t}}=e,n=(0,a.O7)(),i=(0,u.useIntl)(),r=t.length>1?i.formatMessage(ls.insertPages):i.formatMessage(ls.insertPage),l=(0,o.VK)((()=>{if(!A.default.state.mainEditorCurrentBlockStore)return;return"page"===A.default.state.mainEditorCurrentBlockStore.getType()?i.formatMessage(ls.insertToPageTooltip):void 0}),[i]),d=(0,s.useCallback)((async()=>{const e=B.default.getActiveSession();e&&A.default.state.mainEditorCurrentBlockStore&&(await(0,En.acceptPagesCreatedInCurrentBlockStore)({environment:n,groups:t,sessionContext:e}),Ln.trackSavePagePill(n,{sessionId:e.sessionId}))}),[n,t]);return(0,q.jsx)(_t.Z,{disableTooltip:!(0,g.$K)(l),renderTooltip:()=>l,render:e=>(0,q.jsx)(G.Z,{title:r,icon:jn.H,onClick:d,variant:"tinted",tooltipEvents:e})})}function ys(e){const{buttonPopupParent:t,sessionContext:n}=e,i=(0,r.yK)((e=>({wrap:{display:"flex",margin:8,gap:8,width:400}})),[]),[o,l]=(0,s.useState)(""),d=(0,a.O7)(),c=(0,s.useCallback)((async()=>{t.close(),await Et.commitFeedback({environment:d,sessionId:n.sessionId,feedback:o})}),[t,o,d,n]);return(0,q.jsx)(An.Z,{capture:!0,render:e=>(0,q.jsxs)("div",{style:i.wrap,...e,children:[(0,q.jsx)(Pn.Z,{value:o,onChange:e=>l(e.target.value),placeholder:"Write your feedback here",textarea:!0,focus:!0,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),e.stopPropagation(),c())}}),(0,q.jsx)(Bt.Z,{disabled:0===o.length,isBlue:!0,onClick:c,children:"Submit"})]})})}function xs(e){const{renderState:t,inferenceId:n}=e,i=(0,a.O7)(),o=(0,j.Io)(),r=(0,On.E)({inferenceId:n,operationIds:t.operationIds}),l=(0,s.useCallback)((async()=>{const e=B.default.getActiveSession();e&&(await(0,En.rejectEdits)({environment:i,inferenceId:n,sessionContext:e}),Ln.trackDiscardAllPill(i,{sessionId:e.sessionId,from:o.type}))}),[o,i,n]);return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(G.Z,{icon:Ce.k,onClick:r,title:(0,q.jsx)(u.FormattedMessage,{...ls.accept}),variant:"tinted"}),(0,q.jsx)(G.Z,{icon:nt.U,onClick:l,title:(0,q.jsx)(u.FormattedMessage,{...ls.reject}),variant:"tinted"})]})}function vs(e){const t=new Set,n=[];for(const s of e.suggestions)t.has(s.type)||(t.add(s.type),n.push(s));return{...e,suggestions:n}}function Ss(e){const{sessionContext:t}=e,n=(0,o.VK)((()=>function(e){return!!wt.Z.state&&((!e||!function(e){const t=e.assistantConfigurationState;return t.sampling||t.evaluating||e.isCurrentlyCommittingHumanStep}(e))&&((!e||!function(e){const t=e.selectedSuggestionGroup,n=void 0!==t,s=e.getHasCommittedHumanStep();return n&&!s}(e))&&((!e||!function(e){const t=e.selectedSkill,n=void 0!==(null==t?void 0:t.clientSkill.assistantMessage),s=e.getHasCommittedHumanStep();return n&&!s}(e))&&!!P.Z.showScopedSearch())))}(t)),[t]);return n?(0,q.jsx)(ds,{...e}):null}function bs(e){const{sessionContext:t}=e,n=(0,o.VK)((()=>function(e){return!!wt.Z.state&&!(!e||!function(e){const t=e.selectedSkill,n="search_qna"===(null==t?void 0:t.clientSkill.skillType),s=e.getHasCommittedHumanStep();return n&&!s}(e))}(t)),[t]);return n?(0,q.jsx)(Wn.y,{analyticsSource:"find_in_action"}):null}var Cs=n(878158),js=n(798963),ks=n(672495),ws=n(642915),Is=n(152284);function Ms(e){const{spaceStore:t}=e,n=(0,a.O7)(),i=(0,r.yK)((e=>({wrap:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:8},icon:{}})),[]),l=(0,o.VK)((()=>Is.z.getAutomationIds().slice(0,3).map((e=>Te.Mz.createChildStore(t,{table:js.cv,id:e,spaceId:t.id})))),[t]),d=(0,s.useCallback)((async e=>{await(0,ws.Zq)({environment:n,automationStore:e})}),[n]),c=(0,s.useCallback)((()=>{(0,R.navigateToView)({view:"automations"})}),[]);return(0,q.jsx)(ks.Z,{desktopTitleStyle:{paddingLeft:2},title:(0,q.jsx)(u.FormattedMessage,{id:"assistantChat.workflows",defaultMessage:"Workflows"}),children:(0,q.jsxs)("div",{style:i.wrap,children:[l.map((e=>(0,q.jsx)(Cs.O,{automationStore:e,onClick:async()=>{await d(e)}},e.id))),(0,q.jsx)(G.Z,{onClick:c,title:"More"})]})})}function Ts(){const{renderAsFullPage:e}=(0,j.Io)(),t=(0,o.VK)((()=>A.default.state.currentSpaceStore),[]);return(0,o.VK)((()=>{const e=B.default.getActiveSession(),t=!e||e&&!e.selectedSkill&&!e.automation&&0===e.clientSteps.length;return P.Z.isJSAssistantEnabled()&&t}),[])&&t?e?(0,q.jsx)(Cs.F,{spaceStore:t}):(0,q.jsx)(Ms,{spaceStore:t}):null}var As=n(407057),Ps=n(253877),Bs=n(842875);function _s(){const e=(0,u.useIntl)(),t=(0,o.VK)((()=>{const e=B.default.getActiveSession();return!!e&&(e.clientSteps.length>0||(0,g.$K)(e.selectedSkill))}),[]),n=(0,o.VK)((()=>B.default.getActiveAssistantConfigurationState()),[]),i=(0,s.useMemo)((()=>{if(null==n||!n.chatStartTimestamp)return;const t=(0,Ps.kT)({date:null==n?void 0:n.chatStartTimestamp,timezone:(0,Bs.r)()});return[(0,As.p6)({allowRelativeDates:!0,date:t,dateFormat:"relative",intl:e,shortenDate:!1}),t.toFormat("h:mm a")].join(" ")}),[null==n?void 0:n.chatStartTimestamp,e]),a=(0,r.yK)((e=>({date:{fontSize:12,color:e.lightTextColor},dateContainer:{display:"flex",justifyContent:"center",marginTop:4,marginBottom:4}})),[]);return i&&t?(0,q.jsx)("div",{style:a.dateContainer,children:(0,q.jsx)("div",{style:a.date,children:i})}):null}var Fs=n(606287),Zs=n(776798);function Vs(){const e=(0,u.useIntl)(),t=(0,re.iI)({isAssistantChat:!1}),n=(0,o.VK)((()=>{var e;return null===(e=B.default.getActiveSession())||void 0===e?void 0:e.selectedSkill}),[]),s=n?(0,at.zm)(null==n?void 0:n.clientSkill.category):void 0,i=(0,r.yK)((e=>({parameterTitle:{display:"inline",color:e.mediumTextColor,fontWeight:m.Z.fontWeight.medium,overflow:"auto",textOverflow:"ellipsis"},icon:{fill:s?s.color(e).color:void 0}})),[s]),a=(0,o.VK)((()=>A.default.state.mainEditorCurrentBlockStore),[]),l=(0,o.VK)((()=>A.default.state.currentSpaceStore),[]),c=a||l,p=(0,o.VK)((()=>{if(!n)return;const t=n.clientSkill.assistantMessage;return t?e.formatMessage(t):void 0}),[e,n]),h=(0,o.VK)((()=>{if(!n||!c)return;const{displayName:t}=n.clientSkill;if((0,it.clientSkillWithParameterValuesIsFillable)(n)){const s=(0,d.OD)({skillType:n.clientSkill.skillType,parameterValues:n.parameterValues});if("blockOrText"===s.type||"block"===s.type){const n=s.value;if(Array.isArray(n))return(0,q.jsx)(u.FormattedMessage,{id:"assistant.parameters.pill.textValue",defaultMessage:"{displayName}{nbspThisIsASpacePleaseIgnore}{topic}{nbspThisIsASpacePleaseIgnore}",values:{topic:(0,q.jsx)("span",{style:i.parameterTitle,children:n}),displayName:e.formatMessage(t),nbspThisIsASpacePleaseIgnore:(0,q.jsx)("span",{children:""})}});{const s=Te.G.createChildStore(c,{table:we.iU,id:n.id,spaceId:n.spaceId});return(0,q.jsx)(u.FormattedMessage,{id:"assistant.parameters.pill.block",defaultMessage:"{displayName}{nbspThisIsASpacePleaseIgnore}{page}{nbspThisIsASpacePleaseIgnore}",values:{page:(0,q.jsx)(Zs.Z,{store:s,style:i.parameterTitle}),displayName:e.formatMessage(t),nbspThisIsASpacePleaseIgnore:(0,q.jsx)("span",{children:""})}})}}if("collection"===s.type){const n=s.value,a=Te.NW.createChildStore(c,{table:Fs.vF,id:n.id,spaceId:n.spaceId});return(0,q.jsx)(u.FormattedMessage,{id:"assistant.parameters.pill.collection",defaultMessage:"{displayName}{nbspThisIsASpacePleaseIgnore}{collection}{nbspThisIsASpacePleaseIgnore}",values:{collection:(0,q.jsx)(Zs.Z,{store:a,style:i.parameterTitle}),displayName:e.formatMessage(t),nbspThisIsASpacePleaseIgnore:(0,q.jsx)("span",{children:""})}})}if("language"===s.type){const n=s.value,i=(0,d.S8)(n).name;return i?(0,q.jsx)(u.FormattedMessage,{id:"assistant.parameters.pill.language",defaultMessage:"{displayName}{nbspThisIsASpacePleaseIgnore}{language}{nbspThisIsASpacePleaseIgnore}",values:{language:e.formatMessage(i),displayName:e.formatMessage(t),nbspThisIsASpacePleaseIgnore:(0,q.jsx)("span",{children:""})}}):(0,q.jsx)(u.FormattedMessage,{...t})}if("tone"===s.type){const n=s.value,i=(0,d.qC)(n).name;return i?(0,q.jsx)(u.FormattedMessage,{id:"assistant.parameters.pill.tone",defaultMessage:"{displayName}{nbspThisIsASpacePleaseIgnore}{tone}{nbspThisIsASpacePleaseIgnore}",values:{tone:e.formatMessage(i),displayName:e.formatMessage(t),nbspThisIsASpacePleaseIgnore:(0,q.jsx)("span",{children:""})}}):(0,q.jsx)(u.FormattedMessage,{...t})}(0,g.t1)(s)}return(0,q.jsx)(u.FormattedMessage,{...t})}),[n,e,c,i.parameterTitle]);if(!n||!l)return null;const{icon:f}=n.clientSkill;return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(G.Z,{singleLineTitle:!0,title:h,style:{maxWidth:`calc(100% - ${t.humanMessage.marginLeft+t.wrap.gap}px)`,alignSelf:"flex-end"},icon:f,iconStyle:i.icon,variant:"tinted",disabled:!0}),p&&(0,q.jsx)(es,{text:p})]})}function Rs(){const e=(0,o.VK)((()=>{var e;return null===(e=B.default.getActiveSession())||void 0===e?void 0:e.selectedSkill}),[]),t=(0,o.VK)((()=>{var e;return null===(e=B.default.getActiveSession())||void 0===e?void 0:e.selectedSuggestionGroup}),[]);return t?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Dt,{suggestionGroup:t}),(0,q.jsx)(rs,{suggestionGroup:t,showTitleOnly:Boolean(e)})]}):null}var Ls=n(390837);function Es(e){const{type:t}=e,n=(0,o.VK)((()=>Ls.y.state),[]);return(0,o.VK)((()=>{const e=B.default.getActiveSession(),s=(0,g.$K)(e)&&e.clientSteps.length>0;return n.inProgress&&("before_chat"===t?!s:s)}),[n,t])?(0,q.jsx)(Ks,{}):null}function Ks(){const e=(0,r.yK)((e=>({slackProgress:{fontSize:12,color:e.lightTextColor},slackProgressContainer:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:4,marginBottom:4,gap:4},refreshIcon:{width:16,height:16,color:e.lightTextColor}})),[]);return(0,q.jsxs)("div",{style:e.slackProgressContainer,children:[(0,Pt.n)(e.refreshIcon),(0,q.jsx)("div",{style:e.slackProgress,children:(0,q.jsx)(u.FormattedMessage,{id:"assistantChat.slackProgress.text",defaultMessage:"Connecting Slack. This can take up to 36 hours."})})]})}function Os(e){const{currentSpaceStore:t,mockTextStore:n}=e,i=(0,o.VK)((()=>B.default.getActiveSession()),[]),a=(0,o.VK)((()=>null==i?void 0:i.sessionId),[i]),r=(0,o.VK)((()=>wt.Z.state),[]),l=(0,o.VK)((()=>P.Z.isXMLAssistantEnabled()),[]),d=(0,It.t)({sessionContext:i,currentSpaceStore:t}),c=(0,o.VK)((()=>(null==i?void 0:i.getCombinedSteps())??[]),[i]),u=(0,o.VK)((()=>(0,k.Gw)()),[]),p=(0,Mt.f)(i),g=(0,s.useCallback)((e=>!!u||(l?"human"===e.type||"humanAction"===e.type||"groupedEditCard"===e.type||"assistantChat"===e.type||"assistantChatText"===e.type||"assistantShowSearchResults"===e.type||"assistantTransaction"===e.type||"assistantCreateAutomation"===e.type||"assistantScopeChange"===e.type:"human"===e.type||"assistantChat"===e.type||"assistantChatText"===e.type||"assistantShowSearchResults"===e.type||"assistantScopeChange"===e.type)),[u,l]),m=c.filter(g);return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Es,{type:"before_chat"}),(0,q.jsx)(zt,{}),(0,q.jsx)(Ts,{}),(0,q.jsx)(_s,{}),(0,q.jsx)(Es,{type:"after_chat"}),(0,q.jsx)(Ot,{}),(0,q.jsx)(Rs,{}),(0,q.jsx)(Vs,{}),(0,q.jsx)(mn,{...e,steps:m,loadingState:p}),(0,q.jsx)(At.O,{loadingState:p,handleShowSearchResults:!1}),r?(0,q.jsx)(xn,{}):(0,q.jsx)(Tt.v7,{sessionId:a,displayAsChatStep:!0,chatStepProps:{parentStore:t,parentSpaceId:t.id}}),(0,q.jsx)(Ss,{renderState:d,sessionContext:i,mockTextStore:n}),(0,q.jsx)(bs,{sessionContext:i}),(0,q.jsx)(Rt,{sessionContext:i})]})}var Ds=n(118466),Ws=n(158573),Hs=n(730459),Ns=n(628020),zs=n(483627),Us=n(27724),Gs=n(934593),qs=n(150226),$s=n(183583);const Qs=(0,u.defineMessages)({takeATour:{id:"assistantEmptyStateContent.takeATour.label",defaultMessage:"Take a tour"},findIn:{id:"assistantEmptyStateContent.findIn.label",defaultMessage:"Find in..."},getHelp:{id:"assistantEmptyStateContent.getHelp.label",defaultMessage:"Get Notion help"},browseTemplates:{id:"assistantEmptyStateContent.browseTemplates.label",defaultMessage:"Browse templates"},import:{id:"assistantEmptyStateContent.import.label",defaultMessage:"Import"},askQuestionEarly:{id:"assistantEmptyStateContent.askQuestionEarly.label",defaultMessage:"Ask about {text}"}});function Ys(e){const{submitText:t,inputText:n,callback:s}=e;return(0,$s.arbitraryNotionSkillToAssistantSurfaceAction)({key:"askQuestionEarly",title:{...Qs.askQuestionEarly,values:{text:n}},icon:e=>(0,ns.A)({...e,fontWeight:500}),onClick:()=>{t(),null==s||s()},category:"findSearch",validators:[],boosters:[]})}var Xs=n(775e3),Js=n(693405);const ei=(0,u.defineMessages)({thisPage:{id:"assistant.preFilledSkills.thisPage",defaultMessage:"this page"},thisDatabase:{id:"assistant.preFilledSkills.thisDatabase",defaultMessage:"this database"},untitledDatabase:{id:"assistant.preFilledSkills.untitledDatabase",defaultMessage:"Untitled database"}});function ti(e){const{assistantSurfaceAction:t,disableKeyboard:n,menuListItemRef:s,...i}=e,o=(0,a.Fy)(),l=(0,r.yK)((e=>({right:{width:o.isMobile?16:14,height:o.isMobile?16:14,fill:e.lightIconColor},actionItemButtonStyle:{marginBottom:"1px",marginTop:"1px",borderRadius:"100px",display:"flex",margin:0,justifyContent:"space-between"},actionItemDesktopIconStyle:{marginLeft:0},actionItemStyle:{minHeight:"unset",padding:"8px 12px",fontWeight:500,fontSize:o.isMobile?15:13},actionItemRightStyles:{marginRight:8}})),[o.isMobile]),d=(0,at.zm)(t.category);return(0,q.jsx)(Js.Z,{ref:s,...i,svgCustomFill:e=>d.color(e).color,svg:t.icon,buttonStyle:l.actionItemButtonStyle,desktopIconStyle:l.actionItemDesktopIconStyle,style:l.actionItemStyle,right:!e.focused||o.isMobile||n?void 0:(0,Xs.U)(l.right),rightStyle:l.actionItemRightStyles})}function ni(e){const{assistantSurfaceAction:t}=e,n=t,s=(0,a.O7)(),i=(0,r.Fg)(),l=(0,u.useIntl)(),c=(0,o.VK)((()=>{const{currentSpaceStore:e}=A.default.state;return e}),[]),p=(0,r.yK)((e=>({preFilledSkillName:{display:"inline",color:e.mediumTextColor,fontWeight:m.Z.fontWeight.medium,overflow:"auto",textOverflow:"ellipsis"}})),[]),h=(0,o.VK)((()=>{if(!c)return null;if("global"===n.type||!(0,it.clientSkillHasFillableParameters)(n))return(0,q.jsx)(u.FormattedMessage,{id:"assistant.skillMenuItem.globalSkill",defaultMessage:"{acceptsParameters, select, true {{skillName}...} other {{skillName}}}",values:{acceptsParameters:(0,d.Vz)(n.skillType)||(0,d.Zf)(n.skillType),skillName:(0,q.jsx)(u.FormattedMessage,{...n.displayName})}});const e=function(e){const{fillableParameter:t,currentSpaceStore:n,currentPageStore:s}=e;if("block"===t.type||"blockOrText"===t.type||"collection"===t.type){var i;if(Array.isArray(t.value))return t.value;if(t.value.table===we.iU){const e=Te.G.createChildStore(n,t.value);return(null==s?void 0:s.id)===e.id?ei.thisPage:e.getTitleValue()}const e=Te.NW.createChildStore(n,t.value),a=e.getName();return(null==s||null===(i=s.getCollectionStore())||void 0===i?void 0:i.id)===e.id?ei.thisDatabase:void 0===a?ei.untitledDatabase:a}return"tone"===t.type?(0,d.qC)(t.value).name:"language"===t.type?(0,d.S8)(t.value).name:void(0,g.t1)(t)}({fillableParameter:(0,d.OD)(n),currentSpaceStore:c,currentPageStore:(0,Ns.np)()}),t=Array.isArray(e)?(0,Me.IY)({environment:s,textValue:{value:e,spaceId:c.id},parentStore:c,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!0,disabled:!0,theme:i,emojiType:(0,Ie.e_)(s),katex:s.KatexStore.getKatex(),formulaValueTypes:[]}):l.formatMessage(e);return(0,q.jsx)(u.FormattedMessage,{id:"assistant.skillMenuItem.parameterValues",defaultMessage:"{skillName} {parameterValue}",values:{skillName:(0,q.jsx)(u.FormattedMessage,{...n.displayName}),parameterValue:(0,q.jsx)("span",{style:p.preFilledSkillName,children:t})}})}),[n,c,s,l,p.preFilledSkillName,i]);return(0,q.jsx)(ti,{...e,title:h})}function si(e){const{assistantSurfaceAction:t}=e,n=(0,u.useIntl)();return"clientSkill"===t.actionType?(0,q.jsx)(ni,{...e,assistantSurfaceAction:t}):(0,q.jsx)(ti,{...e,title:n.formatMessage(t.title,t.title.values)})}function ii(e){const{store:t,requestedSkill:n,setRequestedSkill:i,setEmptyStateResultsAvailable:r,handleTextSubmit:l,disableKeyboard:d}=e,m=(0,u.useIntl)(),h=(0,a.O7)(),f=(0,j.Io)(),y=(0,o.qz)(void 0,gt.Z),x=(0,o.VK)((()=>t.getValue()),[t]),v=(0,s.useMemo)((()=>(0,c.QaF)(x)),[x]),S=(0,s.useRef)(x),b=(0,s.useRef)(v);void 0===n&&(S.current=x,b.current=v);const C=void 0===n?x:S.current,k=void 0===n?v:b.current,[w]=s.useState(function(e){return Ds.Z.withListenerIgnored((()=>{var t;const{assistantSurface:n}=e,s=null===(t=A.default.state.currentUserSettingsStore)||void 0===t?void 0:t.getSettingsStore().getKeyStore("ai_assistant_tutorial_dismissed_at").getValue(),i=(0,Ns.np)();return n.surfaceSupportsContextWithSelection?{type:"assistant",surface:n.type,selectionState:Us.default.state,textSelectionState:Z.default.state,pageStore:i,assistantTutorialDismissedAt:s,isMobile:n.isMobile}:{type:"assistant",surface:n.type,pageStore:i,assistantTutorialDismissedAt:s,isMobile:n.isMobile}}))}({assistantSurface:f})),I=(0,o.VK)((()=>{const e=(0,Ns.np)(),n=function(e){const{onTakeATourAction:t,onFindInAction:n,onGetHelpAction:s,onBrowseTemplatesAction:i,onImportAction:a,callback:o}=e,r=[],l=e=>()=>{e(),null==o||o()};return t&&r.push({key:"takeATour",title:Qs.takeATour,icon:e=>Qn({...e,fontWeight:500}),onClick:l(t),category:"notionActions",validators:[$s.assistantSurfaceActionValidators.surfaceSupportsTutorialAction],boosters:[[$s.assistantSurfaceActionValidators.isTutorialBoosted,10]]}),n&&r.push({key:"findIn",category:"findSearch",title:Qs.findIn,icon:e=>(0,ns.A)({...e,fontWeight:500}),onClick:l(n),validators:[$s.assistantSurfaceActionValidators.isAssistantSurface,$s.assistantSurfaceActionValidators.not($s.assistantSurfaceActionValidators.isWriterEntrypoint),$s.assistantSurfaceActionValidators.not($s.assistantSurfaceActionValidators.isDeviceMobile)],boosters:[]}),s&&r.push({key:"getHelp",category:"notionActions",title:Qs.getHelp,icon:e=>(0,N.m)({...e,fontWeight:500}),onClick:l(s),validators:[$s.assistantSurfaceActionValidators.not($s.assistantSurfaceActionValidators.isDeviceMobile)],boosters:[]}),i&&r.push({key:"browseTemplates",category:"notionActions",title:Qs.browseTemplates,icon:e=>(0,qs.I)({...e,fontWeight:500}),onClick:l(i),validators:[$s.assistantSurfaceActionValidators.not($s.assistantSurfaceActionValidators.isDeviceMobile)],boosters:[$s.assistantSurfaceActionValidators.isPageEmpty]}),a&&r.push({key:"import",category:"notionActions",title:Qs.import,icon:e=>(0,ue.l)({...e,fontWeight:500}),onClick:l(a),validators:[$s.assistantSurfaceActionValidators.not($s.assistantSurfaceActionValidators.isDeviceMobile)],boosters:[$s.assistantSurfaceActionValidators.isPageEmpty]}),r.map($s.arbitraryNotionSkillToAssistantSurfaceAction)}({callback:()=>{i(void 0),(0,ot.Zo)({environment:h,store:t})},onTakeATourAction:()=>(0,R.navigateToFullPageChatAndLogAnalytics)({environment:h,from:"tutorial_button",callback:()=>{(0,L.startTutorial)({environment:h,intl:m,skipAnalytics:!1,fromForAnalytics:"emptyStateActionButton"})}}),onFindInAction:()=>zs.Z.setState({...zs.Z.state,open:!0}),onGetHelpAction:()=>E.assistantMenuActions.openCornerChatHelp(),onBrowseTemplatesAction:()=>(0,Gs.H)({cloneTo:"current_page",analyticsFrom:"assistant",environment:h}),onImportAction:()=>ye.Z.setState({...ye.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"assistant"})}),s=[...(0,$s.clientSkillToAssistantSurfaceAction)((0,it.getAllClientSkills)({currentPageRecordPointer:null==e?void 0:e.pointer})),...n];return(0,$s.filterAssistantSurfaceActionsForContext)(s,w)}),[w,h,t,m,i]),M=(0,o.VK)((()=>{const e=(0,$s.rankAssistantSurfaceActionsForContext)(I,w),t=(0,$s.filterActionsWithLimitPerCategory)({actions:e,limitPerCategory:$s.SUGGESTED_ACTIONS_PER_CATEGORY_LIMIT});return(0,it.removeGlobalActionsWithParameterizedEquivalents)({actions:t}).slice(0,$s.SUGGESTED_ASSISTANT_ACTIONS_LIMIT)}),[I,w]),T=(0,o.VK)((()=>(0,Ws.ZP)(k,M,(e=>m.formatMessage("clientSkill"===e.actionType?e.displayName:e.title)),{minThreshold:.1,getSortScore:e=>{let{score:t}=e;return-t},normalizeFuzzyScore:!0})),[k,m,M]),P=(0,s.useMemo)((()=>{const e=(0,Ws.ZP)(k,I,(e=>m.formatMessage("clientSkill"===e.actionType?e.displayName:e.title)),{minThreshold:.1,getSortScore:e=>{let{score:t}=e;return-t},normalizeFuzzyScore:!0});return 0===k.length?e:e.filter((e=>!T.some((t=>t.key===e.key))))}),[T,k,m,I]),B=function(e){const{suggestedActions:t,allActions:n,onSkillSelect:i,inputTextValue:a,handleTextSubmit:r,assistantSuggestionContext:l,disableKeyboard:d}=e,m=(0,u.useIntl)(),h=(0,s.useCallback)((e=>"clientSkill"===e.actionType?{key:e.key,action:()=>i(e),render:(t,n)=>{let{ref:s,...i}=t;return(0,q.jsx)(si,{...i,menuListItemRef:s,assistantSurfaceAction:e,disableKeyboard:d})}}:{key:e.key,action:e.onClick,render:(t,n)=>{let{ref:s,...i}=t;return(0,q.jsx)(si,{...i,menuListItemRef:s,assistantSurfaceAction:e,disableKeyboard:d})}}),[i,d]),f=(0,s.useMemo)((()=>(n.length>0||t.length>0)&&a&&(0,c.VrM)(a)>0?[...n,Ys({submitText:()=>r(a),inputText:(0,c.QaF)(a)})]:n),[n,r,a,t]),y=(0,o.VK)((()=>(0,at.K$)(at.dr,l)),[l]);return(0,s.useMemo)((()=>{const e=[];if(t.length>0&&e.push({key:"suggestedSkills",items:t.map((e=>h(e))),render:e=>(0,q.jsx)(ks.Z,{desktopTitleStyle:{paddingLeft:8},mobileTitleStyle:{paddingLeft:8},title:(0,q.jsx)(u.FormattedMessage,{id:"assistant.emptyState.suggested",defaultMessage:"Suggested"}),...e})}),f.length>0){const t=f.reduce(((e,t)=>{var n;return e[t.category]??=[],null===(n=e[t.category])||void 0===n||n.push(h(t)),e}),{}),n=(0,g.Yd)(t).map((e=>{const n=t[e];if(n&&n.length>0)return{key:e,items:n,render:t=>(0,q.jsx)(ks.Z,{title:m.formatMessage((0,at.zm)(e).label),desktopTitleStyle:{paddingLeft:8},mobileTitleStyle:{paddingLeft:8},...t})}})).filter(g.$K);e.push(...n)}return(0,p.MR)(e,(e=>y.indexOf(e.key)))}),[t,f,h,m,y])}({suggestedActions:T,allActions:P,assistantSuggestionContext:w,onSkillSelect:e=>{(0,ot.Zo)({environment:h,store:t}),i(e),(0,Hs.j)({environment:h,event:{eventName:"assistant_inline_menu_option_click",eventProperties:{skill_type:e.skillType,from:f.type}}})},inputTextValue:C,handleTextSubmit:l,disableKeyboard:d}),_=0===B.length;return(0,s.useEffect)((()=>{r(!_)}),[_,r]),(0,q.jsxs)("div",{style:{width:"calc(100% + 8px)",transform:"translateX(-4px)"},children:[(0,q.jsx)(Es,{type:"before_chat"}),(0,q.jsx)(zt,{}),(0,q.jsx)(lt.Z,{menuType:ut.og.Popup,disableScroller:!0,height:"auto",maxHeight:"none",children:(0,q.jsx)(dt.Z,{type:dt.i.Vertical,store:y,sections:B,disableKeyboard:_||d,initialFocus:f.isMobile||d?void 0:0,disableInitialScroll:!0,resetInitialFocusOnSectionChangeAlways:!0,resetFocusOnMouseOut:!0})})]})}const ai=(0,u.defineMessages)({qnaInputPlaceholder:{id:"assistantChat.qnaInputPlaceholder.text",defaultMessage:"Ask a question"},assistantInputPlaceholder:{id:"assistantChat.assistantShortInputPlaceholder.text",defaultMessage:"Ask AI anything"},qnaAssistantChatText:{id:"assistantChat.qnaWelcomeMessage.text",defaultMessage:"Hi {firstName}! Ask me about anything in {workspaceName}. Ill find an answer in the pages you have access to."},qnaEnhancedAssistantChatText:{id:"assistantChat.qnaEnhancedAssistantChatText.text",defaultMessage:"Hi {firstName}!{br}Q&A combines all of GPT-4's general knowledge with the unique context of your Notion workspace. Ask me about anything!"},assistantChatText:{id:"assistantChat.welcomeMessage.text",defaultMessage:"Hi {firstName}! How can I help you today?"},slackQnaAssistantChatText:{id:"assistantChat.slackQnaWelcomeMessage.textNoName",defaultMessage:"Hi {firstName}! Ask me about anything. Ill find an answer in the public Slack channels of your organization."},assistantBetaDisclaimerText:{id:"assistantChat.qnaWelcomeMessage.disclaimerText",defaultMessage:"Im still in Beta, so please use the   buttons to help me improve."},assistantBetaLimitedQnaDisclaimerText:{id:"assistantChat.qnaWelcomeMessage.limitedQnaDisclaimerText",defaultMessage:"Youre on the free plan, so keep in mind that AI responses can be limited."},assistantBetaCurrentlyIndexingWorkspaceDisclaimerText:{id:"assistantChat.qnaWelcomeMessage.currentlyIndexingWorkspaceText",defaultMessage:"Im still learning about your workspace. This can take up to 24 hours, but feel free to try asking me a question."}});function oi(e){const{onBackspaceOnEmptyInput:t}=e,n=(0,a.O7)(),{isMobile:i}=n.device,Z=(0,s.useRef)(),N=(0,u.useIntl)(),{renderAsFullPage:z,type:U}=(0,j.Io)(),[G,Q]=(0,s.useState)(),[Y,X]=(0,s.useState)(!0),J=(0,o.VK)((()=>B.default.getActiveAssistantConfigurationState()),[]),ee=(0,o.VK)((()=>A.default.state.mainEditorCurrentBlockStore),[]),te=(0,o.VK)((()=>A.default.state.currentSpaceStore),[]),ne=(0,o.VK)((()=>(0,l.w_)(n.TabbedRouterStore.state)),[n]),[se,ie]=(0,s.useState)(!1),ae=(0,o.VK)((()=>{var e;return null===(e=B.default.getActiveSession())||void 0===e?void 0:e.selectedSkill}),[]),{store:oe}=(0,w.Cl)({initialValue:void 0,onChange:p.yR}),re=(0,K.u)(),le=(0,j.Io)(),[de,ce]=(0,s.useState)(!1),ue=(0,o.VK)((()=>E.assistantMenuStore.state.primeTextInput),[]),pe=(0,s.useCallback)((()=>{Z.current&&(Z.current.scrollToBottom(),ie(!1))}),[ie]),ge=(0,s.useCallback)((async e=>{await(0,V.tn)({clientSkillWithParameterValues:e,environment:n,snapToBottom:pe,assistantSurface:le})}),[le,n,pe]),me=(0,s.useCallback)((e=>{e?(0,d._Y)(e.skillType)&&"global"===e.type?Q(e):(Q(void 0),ge({clientSkill:e,parameterValues:"with_parameter_values"===e.type?e.parameterValues:{}})):Q(void 0),ri(n,oe)}),[n,ge,oe]),he=(0,s.useCallback)((async e=>{Q(void 0);const{newValue:t,source:s}=e;if(!t)return;if("tutorial"===re.type){if(!re.canUseInput||(0,c.PgY)(t))return void((0,c.PgY)(t)||(0,L.incrementTutorialStepOnCompletionOfCurrentStep)({intl:N,skipAnalytics:!1,environment:n}));(0,L.exitTutorial)({environment:n})}const i=M.default.mark("assistant.chat_submit_lag");M.default.measureAfterNextFlush(i,{environment:n}),S.Q({environment:n}),await(0,V.AF)({environment:n,currentClientSkillWithSettings:ae,snapToBottom:pe,newValue:t,source:s,assistantSurfaceType:U})}),[n,ae,pe,U,N,re,Q]),fe=(0,s.useCallback)(((e,t)=>{const s=Z.current;s&&("empty_state"!==re.type&&(s.atScrollEnd()?ie(!1):ie(!0)),n.device.isMobile&&"up"===t&&(s.distanceToBottom()??0)>0&&s.atOrAboveTop()&&h.ZH({debug:{userAction:"AssistantChat.handleOnScroll"},environment:n}))}),[re.type,n]),ye=(0,o.VK)((()=>(0,k.Gw)()),[]);(0,s.useEffect)((()=>{if(n.device.isMobileNative){var e,t;Boolean("web"===ne.type&&("nativeTab"===ne.route.name&&"assistant"===ne.route.tab||"nativeTab"===(null===(e=ne.redirectedTo)||void 0===e?void 0:e.route.name)&&"assistant"===(null===(t=ne.redirectedTo)||void 0===t?void 0:t.route.tab)))?ri(n,oe):h.ZH({debug:{userAction:"AssistantChat.AssistantChat"},environment:n})}}),[n,ne,oe]),(0,s.useEffect)((()=>{void 0===(null==J?void 0:J.sessionId)&&(0,ot.Zo)({environment:n,store:oe})}),[null==J?void 0:J.sessionId,n,oe]),(0,s.useEffect)((()=>{ri(n,oe)}),[n,oe]),(0,s.useEffect)((()=>{"empty_state"===re.type&&ri(n,oe)}),[n,oe,re.type]),(0,s.useEffect)((()=>{(0,g.$K)(ue)&&(v.createAndCommit({userAction:"assistant.primeTextFromSearch",environment:n,perform:e=>{y.sO({environment:n,store:oe,value:ue,transaction:e})}}),x.Z5({store:oe,selection:{startIndex:(0,c.eeV)(ue).length,endIndex:(0,c.eeV)(ue).length}}),(0,R.setPrimeTextInput)(void 0))}),[n,oe,ue]);const xe=(0,o.VK)((()=>{var e;return null===(e=B.default.getActiveSession())||void 0===e?void 0:e.clientSteps}),[]),ve=(0,o.VK)((()=>{var e;return null===(e=B.default.getActiveSession())||void 0===e?void 0:e.temporaryClientSteps}),[]),Se=(0,o.VK)((()=>B.default.getActiveSession()),[]),be=(0,o.VK)((()=>(null==J?void 0:J.evaluating)||(null==J?void 0:J.sampling)||(null==J?void 0:J.committing)),[null==J?void 0:J.evaluating,null==J?void 0:J.sampling,null==J?void 0:J.committing]),Ce=(0,o.VK)((()=>P.Z.isParameterizationAndEmptyStateEnabled()),[]);(0,s.useEffect)((()=>{var e;se||"empty_state"===re.type||(null===(e=Z.current)||void 0===e||e.scrollToBottom())}),[xe,ve,se,re]);const je=(0,o.qz)(void 0,F.Z),ke=function(){const{device:e}=(0,a.O7)(),{isMobile:t}=e,n=(0,O.u)(),{renderAsFullPage:s}=(0,j.Io)(),i=(0,K.u)(),o=s&&!t?n.fullChatContainerHorizontalPadding:n.chatContainerHorizontalPadding,l="empty_state"===i.type;return(0,r.yK)((e=>({header:{display:"flex",justifyContent:"space-between",alignItems:"center",pointerEvents:"auto",paddingTop:8,paddingLeft:12,paddingRight:12,height:s?44:void 0},labeledInput:{display:"flex",gap:8,alignItems:"center"},reset:{color:e.mediumIconColor},toggleSlackMode:{color:e.mediumIconColor},closeButton:{borderRadius:"100%",marginLeft:4},input:{width:void 0,marginLeft:8,marginRight:8},scroller:{flexGrow:1,width:"100%",margin:"0 auto",display:"flex",flexDirection:"column",paddingTop:8,paddingBottom:12,WebkitMaskImage:l?"linear-gradient(black calc(100% - 28px), transparent calc(100% - 4px))":"linear-gradient(black calc(100% - 16px), transparent calc(100% - 4px))"},samplesLabel:{fontSize:t?14:12,marginTop:8,marginBottom:8},inputLabel:{fontSize:t?16:14,color:e.mediumTextColor},previewLabel:{fontSize:t?14:12},editLink:{fontSize:t?16:14,color:e.mediumTextColor,textDecoration:"underline",paddingLeft:8,paddingRight:8},addCustomInstructionsIcon:{fill:e.aiPurpleColor},suggestionsLabel:{fontSize:n.smallTextSize,color:e.mediumTextColor,marginTop:18,marginBottom:12},emptyStateText:{marginTop:28,fontSize:16,color:e.regularTextColor,fontFamily:m.Z.baseFontFamily.serif},emptyStateWrap:{marginLeft:8,marginRight:8},inputWrap:{padding:o,paddingTop:0,paddingBottom:16,maxWidth:n.assistantChatMaxWidth,width:"100%",margin:"0 auto"},contentWrap:{maxWidth:n.assistantChatMaxWidth,width:"100%",margin:"0 auto",padding:o,paddingBottom:0,display:"flex",flexDirection:"column",gap:2},skillsCaption:{fontSize:n.smallTextSize,color:e.mediumTextColor,marginBottom:8},skillIcon:{fill:e.aiPurpleColor},skillsWrap:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:8},helpCenterBlueBar:{backgroundColor:e.blueButtonBackground,fontSize:14,padding:"8px 16px",color:e.regularInvertedTextColor,display:"flex",justifyContent:"space-between",alignItems:"center"},helpCenterBlueBarCloseButton:{width:16,height:16,borderRadius:"100%"},helpCenterBlueBarCloseButtonIcon:{fill:e.regularInvertedTextColor}})),[t,n,o,s,l])}(),we=(0,I.Z)(i),Ie=(0,s.useMemo)((()=>({store:oe,onSubmit:e=>he({newValue:e,source:"chat"}),onFocus:()=>{if(f.MO(),X(!0),i)"empty_state"!==re.type&&_.Z.onShow(pe);else if("empty_state"===re.type&&void 0===G){var e;null===(e=Z.current)||void 0===e||e.scrollToTop()}},onBlur:()=>{X(!1)},onBackspaceOnEmptyInput:()=>{!G||ae?!ae||!(0,d.gZ)(ae.clientSkill.skillType)||null!=xe&&xe.some((e=>"human"===e.type))?t&&t():B.default.endCurrentSession():Q(void 0)},requestedSkill:G,assistantChatRenderState:re,isSampling:be,emptyStateResultsIsEmpty:!de})),[re,xe,ae,de,he,i,be,oe,t,G,pe]);if(!te||!z&&!ee)return null;let Me;return"chat"===re.type?Me=(0,q.jsx)(Os,{currentSpaceStore:te,handleTextSubmit:e=>he({newValue:e,source:"suggested_question"}),mockTextStore:oe}):"abandoned_search_reminder"===re.type?Me=(0,q.jsx)($,{}):"tutorial"===re.type?Me=(0,q.jsx)(et,{scrollerRef:Z}):"empty_state"===re.type?Me=(0,q.jsx)(ii,{requestedSkill:G,setRequestedSkill:me,store:oe,setEmptyStateResultsAvailable:ce,handleTextSubmit:e=>he({newValue:e,source:"chat"}),disableKeyboard:!Y||void 0!==G}):(0,g.t1)(re),(0,q.jsxs)(C.Io,{xmlMode:!1,children:[(0,q.jsx)(H.n,{}),(0,q.jsxs)(b.T,{ref:Z,type:T.Z.Y,style:ke.scroller,onScroll:fe,store:je,children:[(0,q.jsx)("div",{style:{marginTop:"auto"}}),(0,q.jsxs)("div",{style:ke.contentWrap,children:[ye&&(0,q.jsx)(W.Z,{sessionContext:Se}),Me]})]}),(0,q.jsx)("div",{style:ke.inputWrap,...we,children:Ce?(0,q.jsx)(Ct,{...Ie,setRequestedSkill:me,activateSkill:ge,currentSkill:ae}):(0,q.jsx)(D.HY,{...Ie})})]})}function ri(e,t){e.device.isMobileNative?i.default.afterNextFlush((()=>{setTimeout((()=>{const e="editing"===Z.default.state.mode?Z.default.state.multiSelection:void 0;(null==e?void 0:e.end.store)!==t&&(null==e?void 0:e.start.store)!==t&&x.N_({store:t})}),0)})):(h.ZH({debug:{userAction:"AssistantChat.focusOnInput"},environment:e}),x.NX({store:t}))}},676310:(e,t,n)=>{n.d(t,{gm:()=>He,PK:()=>Ke,dd:()=>Te,Pm:()=>ze,wA:()=>De});var s=n(733993),i=n(667294),a=n(800480),o=n(886628),r=n(724405),l=n(815145),d=n(837167),c=n(317693),u=n(650209),p=n(324600),g=n(421202),m=n(744805),h=n(709291),f=n(401898),y=n(137810),x=n(275754),v=n(137231),S=n(689024),b=n(573063),C=n(584076),j=n(291839),k=n(707124),w=n(489728),I=n(953437),M=n(731278),T=n(776798),A=n(526388),P=n(50116),B=n(869343),_=n(465993),F=n(63811),Z=n(212847),V=n(676725),R=(n(955217),n(785893));var L=n(495940),E=(n(397391),n(21703),n(940470)),K=n(924211),O=n(959753),D=n(388421),W=(n(535827),n(800189)),H=(n(478395),n(433463)),N=n(524993),z=n(342091),U=n(88315);n(715300);async function G(e){const t=await async function(e){const{command:t}=e,n=new U.lq,s=U.ll.newBuilder().with(n).withSimpleDeterministicIDs().buildEvaluator({namespace:"router"}),{observations:i}=await s.commitStep({id:0,type:"assistant",value:t}),a=i.find(D.zZ);if(a)return{error:(0,D.GS)(a)};const o=(0,H.rn)(n.executableOperations);return 1===o.length&&"updatedPage"===o[0].type&&o[0].didCreatePage?{value:{pagePointer:{id:o[0].pageId,table:g.iU},recordMap:n.recordMap}}:{error:new Error("Unexpected operation group: expected 1 create page group")}}(e);if(E.x.isFail(t))return t;const{node:n}=await(0,N.IT)({pointer:{...t.value.pagePointer,spaceId:"fake"},loadRecordModel:O.s8.fromRecordMap(t.value.recordMap),intl:(0,K.vc)()}),s=(new W.Tc).mapNodeKeyToCounter(n);return{value:(0,z.p1)({node:s,selection:void 0,namespace:"end_to_end"})}}var q=n(939040),$=n(559054),Q=n(52897),Y=n(471924);function X(e){return Y.Il()}function J(e){const t=e.defaultExpanded??!0,n=(0,q.P)(e.xml).map((e=>"element"===e.type?e:{type:"element",tagName:"_",attributes:{},children:[e]}));return(0,R.jsx)(R.Fragment,{children:n.map(((e,n)=>(0,R.jsx)(ne,{node:e,defaultExpanded:t},n)))})}function ee(e){return`<create-page>\n<property-title name="Title">Debug page</property-title>\n${e}</create-page>`}const te={"create-page":e=>e,replace:ee,"insert-before":ee,"insert-after":ee,chat:ee};function ne(e){const{node:t,defaultExpanded:n}=e,s=(0,r.yK)((e=>({node:{},light:{color:e.lightTextColor},medium:{color:e.mediumTextColor,fontWeight:y.Z.fontWeight.medium},arrow:{color:e.darkTextColor,fontWeight:y.Z.fontWeight.semibold,marginRight:4,cursor:"pointer"},children:{marginLeft:2,paddingLeft:10,borderLeft:"1px solid rgba(55, 53, 47, 0.2)"},error:{color:"light"===e.mode?e.accentColors.red[500]:e.accentColors.red[800]},iconButton:{marginLeft:4,position:"relative",top:1}})),[]),[a,o]=(0,i.useState)(n),[l,d]=(0,i.useState)(!1),c=(0,i.useMemo)((()=>{if(1!==t.children.length||"text"!==t.children[0].type)return;const e=te[t.tagName];if(!e)return;return e(t.children[0].value)}),[t]),u=c&&a?(0,R.jsx)(A.Z,{renderTooltip:()=>(0,R.jsx)(R.Fragment,{children:"Toggle convert Markdown to XML"}),render:e=>(0,R.jsx)(b.Z,{style:s.iconButton,onClick:()=>d(!l),...e,icon:Q.d,ariaLabel:"Button"})}):null,[p]=(0,$.r5)((async()=>{if(l&&c){const e=await G({command:c});if(E.x.isFail(e))throw e;return(0,q.P)(e.value)}return t.children}),[c,l,t]),g="resolved"===p.status&&p.value.length>0;return(0,R.jsxs)("div",{style:s.node,children:[g&&(0,R.jsx)("span",{style:s.arrow,onClick:()=>o((e=>!e)),children:a?"":""}),(0,R.jsx)("span",{style:s.light,children:"<"}),(0,R.jsx)("span",{style:s.medium,children:t.tagName}),t.attributes&&Object.entries(t.attributes).map((e=>{let[t,n]=e;return(0,R.jsxs)(i.Fragment,{children:[(0,R.jsx)("span",{style:s.light,children:` ${t}="`}),(0,R.jsx)("span",{style:s.medium,children:n}),(0,R.jsx)("span",{style:s.light,children:'"'})]},t)})),(0,R.jsx)("span",{style:s.light,children:g?">":"/>"}),u,"rejected"===p.status&&(0,R.jsx)("div",{style:{...s.children,...s.error},children:`Error: ${p.error.message}`}),"resolved"===p.status&&p.value.length>0&&a&&(0,R.jsx)("div",{style:s.children,children:p.value.map((e=>{const t=X();return"text"===e.type?(0,R.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:e.value},t):L.t[e.tagName]?(0,R.jsx)(se,{node:e},t):(0,R.jsx)(ne,{node:e,defaultExpanded:n},t)}))}),g&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)("span",{style:s.light,children:"</"}),(0,R.jsx)("span",{style:s.medium,children:t.tagName}),(0,R.jsx)("span",{style:s.light,children:">"})]})]})}function se(e){const{node:t}=e,n=(0,r.yK)((e=>({node:{},light:{color:e.lightTextColor},medium:{color:e.mediumTextColor,fontWeight:y.Z.fontWeight.medium}})),[]),s=t.children&&t.children.length>0;return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)("span",{style:n.light,children:"<"}),(0,R.jsx)("span",{style:n.medium,children:t.tagName}),t.attributes&&Object.entries(t.attributes).map((e=>{let[t,s]=e;return(0,R.jsxs)(i.Fragment,{children:[(0,R.jsx)("span",{style:n.light,children:` ${t}="`}),(0,R.jsx)("span",{style:n.medium,children:s}),(0,R.jsx)("span",{style:n.light,children:'"'})]},t)})),(0,R.jsx)("span",{style:n.light,children:s?">":"/>"}),t.children&&t.children.length>0&&t.children.map((e=>{const t=X();return"text"===e.type?(0,R.jsx)("span",{children:`${e.value}`},t):(0,R.jsx)(se,{node:e},t)})),s&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)("span",{style:n.light,children:"</"}),(0,R.jsx)("span",{style:n.medium,children:t.tagName}),(0,R.jsx)("span",{style:n.light,children:">"})]})]})}const ie=Z.object({required:{id:Z.number(),type:Z.literals("context","human","assistant","observation","instructions")},optional:{}});const ae=Z.object({required:{inferenceId:Z.string(),type:Z.literals(..._.Po)},optional:{}});function oe(e){const{data:t,wordsToHighlight:n,shouldExpandNode:s}=e,a=(0,r.Fg)(),o=(0,i.useMemo)((()=>({scheme:"scheme",author:"author",base00:"unset",base01:"#000000",base02:"#000000",base03:"#000000",base04:"#000000",base05:"#000000",base06:"#000000",base07:"#000000",base08:"#000000",base09:"#000000",base0A:"#000000",base0B:a.regularTextColor,base0C:"#000000",base0D:a.mediumTextColor,base0E:"#000000",base0F:"#000000"})),[a]);return(0,R.jsx)("div",{style:{position:"relative",width:"100%"},children:(0,R.jsx)(B.L,{data:t,invertTheme:!1,theme:{extend:o,tree:{marginTop:0,marginBottom:0,marginLeft:0,paddingTop:0,userSelect:"auto"}},hideRoot:!0,shouldExpandNode:s,getItemString:(e,t,n,s,i)=>{return a=t,(0,F.P9)(ie,a)?(0,R.jsx)(re,{step:t}):function(e){return(0,F.P9)(ae,e)}(t)?(0,R.jsx)(le,{step:t}):(0,R.jsxs)("span",{children:[n," ",s]});var a},valueRenderer:function(e,t){return"string"==typeof t&&t.startsWith("<")?(0,R.jsx)("div",{children:(0,R.jsx)(J,{xml:t,defaultExpanded:t.length<300})}):"string"==typeof t&&t.trim().startsWith("Human: <")?(0,R.jsx)("div",{style:{color:a.lightTextColor,display:"inline"},children:`[Transcript "${t.trim().slice(0,24)}..."]`}):"stack"===(arguments.length<=2?void 0:arguments[2])?(s=t,(0,R.jsx)(R.Fragment,{children:(0,V.Z)(s.split("\n"),(()=>(0,R.jsx)("br",{})))})):n?function(e,t){const n=e.split("\n");return n.map(((e,s)=>(0,R.jsxs)(i.Fragment,{children:[e.split(" ").map(((e,n)=>t.includes(e.toLowerCase())?(0,R.jsx)("span",{style:{color:"orange"},children:e},n):(0,R.jsx)("span",{children:e},n))).reduce(((e,t)=>(0,R.jsx)(R.Fragment,{children:[e," ",t]}))),s===n.length-1?null:(0,R.jsx)("br",{})]},s)))}(e,n):(0,R.jsx)(R.Fragment,{children:e});var s}})})}function re(e){const{step:t}=e,n=(0,r.yK)((e=>{let n;return"assistant"===t.type?n=e.accentColors.purple[200]:"context"===t.type?n=e.accentColors.green[200]:"human"===t.type?n=e.accentColors.blue[200]:"observation"===t.type?n="error"===t.observationType?e.accentColors.red[200]:e.accentColors.brown[200]:"instructions"===t.type?n=e.accentColors.yellow[200]:(0,f.t1)(t),{wrap:{backgroundColor:n,borderRadius:4,padding:2}}}),[t]);let s=`${t.type} step`;return"observation"===t.type&&(s=`${t.observationType} ${s}`),(0,R.jsx)("span",{style:n.wrap,children:s})}function le(e){const{step:t}=e,n=(0,r.yK)((e=>{let n=e.accentColors.gray[100];return"human"===t.type?n=e.accentColors.blue[200]:"assistantChat"===t.type?n=e.accentColors.purple[200]:"groupedEditCard"===t.type?n=e.accentColors.yellow[200]:"humanAction"===t.type&&(n=e.accentColors.green[200]),{wrap:{backgroundColor:n,borderRadius:4,padding:2}}}),[t]),s=`${t.type} ClientStep`;return(0,R.jsx)("span",{style:n.wrap,children:s})}var de=n(510102),ce=n(536420),ue=n(730459),pe=n(484210),ge=n(223196),me=n(905737),he=n(798180),fe=n(206258),ye=n(828344),xe=n(484681),ve=n(561144),Se=n(693415),be=n(816540),Ce=n(173435),je=n(618746),ke=n(629551),we=n(80444);function Ie(e){const{hoverInfo:t}=e,n=(0,P.n1)(),s=(0,P.yD)(),a=(0,o.VK)((()=>we.default.state.mainEditorCurrentBlockStore),[]);if(void 0===t.text||""===t.text.trim())return null;const r=t.text.split("\n");return(0,R.jsxs)("div",{style:n.wrapper,children:[(0,R.jsx)("div",{style:{...n.coverContainer,marginLeft:"16px",marginTop:"21px"},children:(0,p.P)({width:24,height:24})}),(0,R.jsxs)(ke.Ht,{gap:4,style:n.content,children:[(0,R.jsxs)(ke.Ht,{gap:2,children:[(0,R.jsx)("div",{style:n.breadcrumb,children:t.lastEdited}),(0,R.jsx)("div",{style:n.pageTitleContainer,children:(0,R.jsx)("span",{style:n.pageTitle,children:(0,R.jsx)(h.FormattedMessage,{id:"slack.citation.preview.title",defaultMessage:"Thread in #{channel}",values:{channel:t.channel}})})})]}),(0,R.jsxs)("div",{style:{...s.contentCover,height:"84px",pointerEvents:"none",overflow:"hidden",position:"relative"},children:[(0,R.jsx)("div",{style:{...s.rendererBlockStyle,color:"inherit",fill:"inherit",opacity:.8,pointerEvents:"none"},children:a&&r.map(((e,t)=>(0,R.jsxs)(i.Fragment,{children:[(0,R.jsx)(je.A,{textValue:[[e]],parentStore:a}),t<r.length-1&&(0,R.jsx)("br",{})]},t)))}),(0,R.jsx)("div",{style:{...s.contentCoverFade,width:"100%",position:"absolute",bottom:0,left:0}})]})]})]})}const Me=3;function Te(e){var t;const{pageCitations:n,databaseCitations:s,universalCitations:l,hoverStore:d,toggledStore:c,loadingState:u}=e,p=(0,a.O7)(),g=(0,a.Fy)(),m=(0,f.$K)(u),x=[...n.map((e=>({type:"notion",...e}))),...l.map((e=>({...e})))],v=e.canExpand&&x.length>Me,S=e.canExpand?e.expandedStore:void 0,b=(0,o.VK)((()=>c.state),[c]),C=(0,i.useCallback)((e=>{const t=he.default.getActiveAssistantConfigurationState();t&&ye.trackQnaCitationsToggle(p,{sessionId:t.sessionId,shown:e}),c.setState(e)}),[p,c]),j=(0,o.VK)((()=>!(0,f.$K)(S)||S.state),[S]),k=(0,i.useCallback)((e=>{(0,f.$K)(S)&&S.setState(e)}),[S]),w=j?x:x.slice(0,Me);(0,o.VK)((()=>{n.forEach((e=>e.store.getTitleValue()))}),[n]);const I=(0,o.VK)((()=>{var e;return"list"===(null===(e=d.state)||void 0===e?void 0:e.type)}),[d]),M=(0,r.yK)((e=>({wrap:{position:"relative",marginLeft:4,marginBottom:8,display:"flex",fontSize:g.isMobile?y.Z.fontSize.UISmall.mobile:y.Z.fontSize.UISmall.desktop},listWrap:{display:"flex",flexDirection:"column",flexGrow:1,gap:2,maxWidth:ve.Ol,marginLeft:-6,paddingLeft:6,...v&&!j?{WebkitMaskImage:"linear-gradient(180deg, black, rgba(0,0,0,0.99) 80%, transparent)"}:{}}})),[v,g,j]),T=(0,o.VK)((()=>he.default.getActiveSessionId()),[]);return 0===s.length&&0===x.length?null:(0,R.jsxs)(R.Fragment,{children:[s.map((e=>(0,R.jsx)(Be,{databaseCitation:e,hoverStore:d,assistantSessionId:T},e.store.id))),(0,R.jsxs)("div",{style:M.wrap,children:[(0,R.jsxs)("div",{style:M.listWrap,children:[x.length>0&&(0,R.jsx)(Ae,{enabled:!m,isLoading:Boolean(m),onClick:()=>{C(!b)},open:b,children:u&&!("isStreaming"in u)&&"assistantShowSearchResults"===(null===(t=u.loadingStep)||void 0===t?void 0:t.type)&&n.length>0?(0,R.jsx)(be.N,{clientStep:u.loadingStep,parentStore:n[0].store}):(0,R.jsx)(h.FormattedMessage,{id:"assistantCitationHelpers.numPagesFound",defaultMessage:"{count, plural, one {{count} source found} other {{count} sources found}}",values:{count:x.length}})}),b&&w.map((e=>{const{type:t}=e;return"notion"===t?(0,R.jsx)(Ve,{citation:e,hoverStore:d},e.store.id):"slack"===t?(0,R.jsx)(Fe,{citation:e,hoverStore:d},e.href):void(0,f.t1)(t)}))]}),v&&!j&&b&&(0,R.jsx)(Se.S,{variant:"see_more",forceHover:I,onClick:()=>{const e=he.default.getActiveAssistantConfigurationState();e&&ye.trackQnaCitationsSeeMoreClick(p,{sessionId:e.sessionId}),k(!0)}})]})]})}function Ae(e){const{enabled:t,onClick:n,children:s,open:o,isLoading:l}=e,{isMobile:d}=(0,a.Fy)(),[u,p]=(0,i.useState)(!1),g=(0,r.yK)((e=>({wrap:{color:e.text.secondary,fontWeight:500,fontSize:12,padding:"0px 0 2px",display:"flex",alignItems:"center"},content:{padding:"1px 2px",margin:"-1px -2px",cursor:t?"pointer":"default"},icon:{width:11,height:11,marginLeft:4,fill:e.icon.secondary,transform:`rotateZ(${o?0:-90}deg)`,opacity:d||u?1:0,transition:"opacity 0.2s ease, transform 200ms ease-out"},loadingDots:{marginLeft:8}})),[t,o,u,d]);return(0,R.jsxs)("div",{style:g.wrap,children:[(0,R.jsx)("div",{style:g.content,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),onClick:()=>{t&&n()},children:s}),t&&(0,c.A)(g.icon),l&&(0,R.jsx)(j.Z,{isTriColored:!0,styleParentContainer:g.loadingDots})]})}const Pe=(0,h.defineMessages)({expandDatabaseCitation:{id:"assistantCitationHelpers.expandDatabaseCitation",defaultMessage:"Open results"}});function Be(e){const{databaseCitation:t,hoverStore:n,assistantSessionId:s}=e,d=(0,o.VK)((()=>({title:t.store.getName(),icon:t.store.getIcon()})),[t.store]),c=(0,a.O7)(),p=c.device.isMobile,g=(0,r.yK)((e=>({textWrap:{fontSize:14,fontWeight:500,color:e.mediumTextColor,display:"flex",alignItems:"center",overflow:"hidden"},citationMessage:{boxShadow:e.lightBoxShadow,backgroundColor:"light"===e.mode?e.contentBackground:e.accentColors.translucentGray[200],color:e.regularTextColor,padding:"5px 10px",maxWidth:"min(100%, 512px)",borderRadius:16,fontSize:p?15:14,whiteSpace:"pre-wrap",overflowWrap:"break-word",position:"relative",lineHeight:1.45},databaseTitleInfo:{display:"inline-flex",alignItems:"center",color:e.regularTextColor,paddingLeft:2,paddingRight:0,marginRight:2,height:24,flex:"1 1 auto"},expandIcon:{height:12,width:12,fill:e.mediumIconColor,cursor:"pointer",padding:10}})),[p]),m=(0,o.VK)((()=>{var e;return null===(e=t.store.getParentBlockStore())||void 0===e?void 0:e.getNavigableBlockStore()}),[t]),f=(0,i.useCallback)((()=>{if(p)return;const e=t.queryDatabaseResultId;s&&v.E3(e,s)}),[p,s,t.queryDatabaseResultId]),y=(0,h.useIntl)();return(0,R.jsxs)("div",{style:g.citationMessage,onClick:f,children:[(0,R.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,R.jsx)("div",{style:g.textWrap,children:(0,R.jsx)(h.FormattedMessage,{defaultMessage:"<span>Results from{nbspThisIsASpacePleaseIgnore}</span>{database}",id:"assistantCitationHelpers.resultsFromDatabase",values:{nbspThisIsASpacePleaseIgnore:(0,R.jsx)("span",{children:""}),span:e=>(0,R.jsx)("span",{style:{display:"flex",flexShrink:0},children:e}),database:(0,R.jsxs)(w.Z,{style:g.databaseTitleInfo,onClick:e=>{m&&(x._c({environment:c,store:m,pageVisitSource:l.tY.AIQna}),e.stopPropagation(),e.preventDefault())},children:[(0,R.jsx)(M.Z,{disabled:!0,icon:d.icon,isEmptyPage:!1,size:14,useInvertedColors:!1,style:{marginLeft:2,marginRight:4}}),(0,R.jsx)(T.Z,{store:t.store})]})}})}),!p&&(0,R.jsx)(A.Z,{renderTooltip:()=>y.formatMessage(Pe.expandDatabaseCitation),render:e=>(0,R.jsx)(b.Z,{ariaLabel:y.formatMessage(Pe.expandDatabaseCitation),icon:u.c,onClick:()=>{},style:g.expandIcon,...e})})]}),t.relatedPages.map((e=>(0,R.jsx)(_e,{citation:e,hoverStore:n},e.store.id)))]})}function _e(e){const{citation:t,hoverStore:n}=e,{store:s,inlineCitedBlockIds:a,number:l}=t,d=(0,o.VK)((()=>{var e;return"notion"===(null===(e=n.state)||void 0===e?void 0:e.citationType)&&n.state.pageId===s.id}),[n,s.id]),c=(0,i.useRef)(null),u=(0,i.useCallback)((e=>{if(e){if(!c.current)return;n.setState({type:"list",citationType:"notion",pageId:s.id,blockIds:a,node:c.current})}else n.setState(void 0)}),[n,a,s.id]),p=(0,r.yK)((e=>({containerWrap:{display:"flex",alignItems:"center",gap:4,padding:"4px 0"},wrap:{gap:4,color:e.v2.text.primary,fontWeight:y.Z.fontWeight.medium,paddingLeft:4,paddingRight:4,height:24,maxWidth:"min(calc(100% - 12px), 512px)"}})),[]),g=(0,Ce.Dc)(s),m=(0,o.VK)((()=>s.getIcon()),[s]),h=(0,o.VK)((()=>s instanceof fe.G&&s.isEmptyPage()),[s]);return(0,R.jsx)("div",{onClick:e=>{e.stopPropagation(),e.preventDefault()},children:(0,R.jsxs)(w.Z,{href:g,style:p.wrap,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),ref:c,hovered:d,children:[l&&d?(0,R.jsx)(He,{number:l,hovered:d,style:{opacity:d?1:0,transition:"opacity 0.2s ease",zIndex:10}}):(0,R.jsx)(M.Z,{style:{paddingRight:4,paddingLeft:4},disabled:!0,icon:m,isEmptyPage:h,size:14,useInvertedColors:!1}),(0,R.jsx)(T.Z,{store:s})]})})}function Fe(e){const{hoverStore:t,citation:n}=e,s=(0,a.O7)(),r=(0,o.VK)((()=>{var e;return"universal_search"===(null===(e=t.state)||void 0===e?void 0:e.citationType)&&t.state.href===n.href}),[t,n]),l=(0,i.useRef)(null),d=(0,i.useCallback)((e=>{if(e){if(!l.current)return;t.setState({type:"list",citationType:"universal_search",target:"slack",node:l.current,href:n.href,channel:n.channelName,text:n.text,lastEdited:n.lastEdited,messageId:n.messageId})}else t.setState(void 0)}),[t,n]),c=Re({hovered:r,number:n.number});let u=null;"slack"===n.type?u=(0,R.jsx)(Ze,{citation:n}):(0,f.t1)(n.type);const g=(0,i.useMemo)((()=>{if("slack"===n.type)return(0,m.St)({...n});(0,f.t1)(n.type)}),[n]);return(0,R.jsx)("div",{style:c.wrap,ref:l,children:(0,R.jsx)(C.Z,{href:g,metaHref:g,external:!0,style:c.linkBox,hovered:r,hoveredStyle:c.linkBoxHoveredStyle,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),onClick:()=>{ye.trackQnaResultClicked(s,{clickedPageId:n.href,configurationState:he.default.getActiveAssistantConfigurationState(),resultType:n.type,source:"citation_list"})},children:(0,R.jsxs)("div",{style:c.titleWrap,children:[(0,R.jsxs)("div",{style:c.iconWrap,children:[(0,f.$K)(n.number)&&(0,R.jsx)(He,{number:n.number,hovered:r,style:c.number}),(0,p.P)({...c.icon,height:12,width:12})]}),u]})})},n.href)}function Ze(e){const{citation:t}=e,n=(0,r.yK)((()=>({title:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}})),[]),s=(0,i.useMemo)((()=>{var e;return null===(e=t.text)||void 0===e||null===(e=e.split(":"))||void 0===e?void 0:e[0]}),[t]);let a=null;return a=(0,f.$K)(t.channelName)?(0,f.$K)(s)?(0,R.jsx)(h.FormattedMessage,{id:"SlackCitationTitle.title",defaultMessage:"{author} in #{channelName}",values:{channelName:t.channelName,author:s}}):(0,R.jsx)(h.FormattedMessage,{id:"SlackCitationTitle.titleWithContentUnknown",defaultMessage:"Unknown author in #{channelName}",values:{channelName:t.channelName}}):(0,f.$K)(s)?(0,R.jsx)(h.FormattedMessage,{id:"SlackCitationTitle.titleWithChannelUnknown",defaultMessage:"{author} in unknown channel",values:{author:s}}):(0,R.jsx)(h.FormattedMessage,{id:"SlackCitationTitle.titleUnknown",defaultMessage:"Unknown content"}),(0,R.jsx)("span",{style:n.title,children:a})}function Ve(e){const{citation:{number:t,store:n,inlineCitedBlockIds:s},hoverStore:r}=e,c=(0,a.O7)(),{isMobile:u}=(0,a.Fy)(),p=(0,o.VK)((()=>{var e;return"notion"===(null===(e=r.state)||void 0===e?void 0:e.citationType)&&r.state.pageId===n.id}),[r,n]),g=Re({hovered:p,number:t}),m=(0,i.useRef)(null),h=(0,i.useCallback)((e=>{if(e){if(!m.current)return;r.setState({type:"list",citationType:"notion",pageId:n.id,blockIds:s,node:m.current})}else r.setState(void 0)}),[r,s,n.id]),y=(0,o.VK)((()=>n.getIcon()),[n]),x=(0,o.VK)((()=>n.isEmptyPage()),[n]),v=(0,o.VK)((()=>c.RouterStore.state.route),[c]),{metaHref:S,href:b}=(0,o.VK)((()=>{const e=(0,pe.ZP)({store:n,fullyQualified:!1,pageVisitSource:l.tY.AIQna});return"page"===v.name||"nativeTab"===v.name&&"assistant"===v.tab||"quickSearch"===v.name?{metaHref:e,href:e}:"chat"===v.name?{metaHref:e,href:(0,d.tj)({pageId:n.id,pageVisitSource:l.tY.AIQna,isMobile:u})}:{metaHref:void 0,href:void 0}}),[v,n,u]);return(0,R.jsx)("div",{style:g.wrap,ref:m,children:(0,R.jsx)(C.Z,{href:S,metaHref:b,style:g.linkBox,hovered:p,hoveredStyle:g.linkBoxHoveredStyle,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),onClick:async()=>{c.device.isMobileBrowser&&await xe.closeAssistantRightHandSideMenu({environment:c}),ye.trackQnaResultClicked(c,{clickedPageId:n.id,configurationState:he.default.getActiveAssistantConfigurationState(),resultType:"page",source:"citation_list"})},children:(0,R.jsxs)("div",{style:g.titleWrap,children:[(0,R.jsxs)("div",{style:g.iconWrap,children:[(0,f.$K)(t)&&(0,R.jsx)(He,{number:t,hovered:p,style:g.number}),(0,R.jsx)(M.Z,{disabled:!0,icon:y,isEmptyPage:x,size:14,style:g.icon,useInvertedColors:!1})]}),(0,R.jsx)(T.Z,{store:n})]})})},n.id)}function Re(e){const{hovered:t,number:n}=e;return(0,r.yK)((e=>({wrap:{display:"flex",position:"relative"},linkBox:{display:"flex",alignItems:"center",gap:4,padding:"0 4px",borderRadius:6,fontWeight:500,fontSize:13,transition:"background 0.2s ease",maxWidth:"95%",marginLeft:-4},linkBoxHoveredStyle:{background:e.accentColors.uiBlue[100]},iconWrap:{position:"relative",marginRight:4,width:14,height:14,flexShrink:0},icon:{position:"absolute",left:0,top:0,transition:"opacity 0.2s ease",opacity:(0,f.$K)(n)&&t?0:1},number:{position:"absolute",left:0,top:0,opacity:t?1:0,transition:"opacity 0.2s ease",zIndex:10},titleWrap:{display:"flex",alignItems:"center",padding:2,minWidth:50}})),[t,n])}const Le=24,Ee=6;function Ke(e){const t=Oe(e);if((0,f.$K)(t)){const{originRect:e,isFullTooltip:n,citationType:s}=t;let i;if("notion"===s){const{stores:e,isBlockLevelCitation:s,navigableBlockStore:a}=t;i=n?s?(0,R.jsx)(P.E5,{store:a,contentBlocks:e.slice(0,Ee),size:1===e.length?"tall":"regular"}):(0,R.jsx)(P.E5,{store:a}):(0,R.jsx)(We,{store:a})}else"universal_search"===s?i=(0,R.jsx)(Ie,{hoverInfo:t}):(0,f.t1)(s);return(0,R.jsx)(I.ZP,{disableMouseCapture:!0,preventCaptureEsc:!0,preventScaleTransition:!0,preventOpacityTransition:!0,popupType:ge.k.Popup,originGap:n?Le:8,alignmentToOrigin:I.ZP.Alignment.Start,open:!0,placementToOrigin:n?I.ZP.Placement.Left:I.ZP.Placement.Bottom,originRect:e,useLightBoxShadow:!n,render:()=>i})}return null}function Oe(e){const{containerRef:t,hoverStore:n,parentStore:s}=e,{isQuickSearchMode:i}=(0,de.Io)(),r=(0,a.Fy)();return(0,o.VK)((()=>{if(!n.state||!t.current||r.isMobile||i)return;const e=t.current.getBoundingClientRect(),a=e.left>=P.Tq+Le;let o;const l=n.state.node.getBoundingClientRect();if(a)o=new DOMRect(e.x,l.y,e.width,l.height);else{if("token"!==n.state.type)return;o=l}const{type:d,citationType:c}=n.state;if("notion"===c){let e,t;return"token"===d?(e=n.state.blockId?[n.state.blockId]:[n.state.pageId],t=Boolean(n.state.blockId)):"list"===d?(e=n.state.blockIds.length>0?n.state.blockIds:[n.state.pageId],t=n.state.blockIds.length>0):(0,f.t1)(d),{citationType:c,stores:e.map((e=>fe.G.createChildStore(s,{id:e,table:g.iU}))),originRect:o,isFullTooltip:a,isBlockLevelCitation:t,navigableBlockStore:fe.G.createChildStore(s,{id:n.state.pageId,table:g.iU})}}if("universal_search"===c){const{target:e}=n.state;if("slack"===e)return{citationType:c,target:"slack",originRect:o,isFullTooltip:a,href:n.state.href,channel:n.state.channel,text:n.state.text,lastEdited:n.state.lastEdited};(0,f.t1)(e)}else(0,f.t1)(c)}),[t,s,r,i,n])}function De(e){const t=Oe(e),n=(0,o.VK)((()=>he.default.getActiveAssistantConfigurationState()),[]),s=(0,r.yK)((e=>({wrap:{fontSize:y.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,fontWeight:y.Z.fontWeight.regular,fill:e.mediumIconColor,padding:"4px 6px 4px 6px",display:"flex",alignItems:"center",gap:2,marginRight:6}})),[]);if((0,f.$K)(t)){var i;const{originRect:e,isFullTooltip:a}=t;let o;"notion"===t.citationType?o=t.stores.map((e=>null==n?void 0:n.searchDebugHits.get(e.id))).find(f.$K):"universal_search"===t.citationType?"slack"===t.target?o=null==n?void 0:n.searchDebugHits.get(t.href):(0,f.t1)(t.target):(0,f.t1)(t);const r=o?{...o.result,...o.hit?Object.fromEntries(Object.entries(o.hit).filter((e=>{let[t]=e;return me.i7.includes(t)}))):{},...null!==(i=o.hit)&&void 0!==i&&i.rankerInputs?Object.fromEntries(Object.entries(o.hit.rankerInputs).filter((e=>{let[t]=e;return me.i7.includes(t)}))):{}}:{};return(0,R.jsx)(I.ZP,{disableMouseCapture:!0,preventCaptureEsc:!0,preventScaleTransition:!0,preventOpacityTransition:!0,popupType:ge.k.Popup,originGap:a?Le+P.Tq:8,alignmentToOrigin:I.ZP.Alignment.Start,open:!0,placementToOrigin:a?I.ZP.Placement.Left:I.ZP.Placement.Bottom,originRect:e,useLightBoxShadow:!a,render:()=>(0,R.jsx)("div",{style:s.wrap,children:(0,R.jsx)(oe,{data:r})})})}return null}function We(e){const{store:t}=e,n=(0,r.yK)((e=>({wrap:{fontSize:y.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,fontWeight:y.Z.fontWeight.regular,fill:e.mediumIconColor,padding:"4px 6px 4px 6px",display:"flex",alignItems:"center",gap:2}})),[]),s=(0,o.VK)((()=>t.getIcon()),[t]),i=(0,o.VK)((()=>t.isEmptyPage()),[t]);return(0,R.jsxs)("div",{style:n.wrap,children:[(0,R.jsx)(M.Z,{disabled:!0,icon:s,isEmptyPage:i,size:14,useInvertedColors:!1}),(0,R.jsx)(T.Z,{store:t})]})}function He(e){const{number:t,hovered:n,style:s}=e,i=(0,r.yK)((e=>({wrap:{verticalAlign:"middle",cursor:"pointer",transition:"all 100ms ease-in",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:90,padding:"0 4px",fontSize:10,minWidth:14,height:14,fontWeight:y.Z.fontWeight.semibold,color:"white",backgroundColor:n?"#2383e2":"dark"===e.mode?"#333333":"#acaba9",...s}})),[n,s]),a=(0,h.useIntl)();return(0,R.jsx)("div",{style:i.wrap,children:t.toLocaleString(a.locale)})}function Ne(e){const{children:t,visibleMarginBottom:n=0}=e,[a,o]=(0,i.useState)(!0),r=(0,i.useRef)(null),l=(0,ce.y)(r);return a?(0,R.jsx)(s.E.div,{initial:{opacity:0,height:0,marginBottom:0},animate:{opacity:1,height:(null==l?void 0:l.height)??0,marginBottom:n},transition:{type:"keyframes",ease:[.25,.1,.35,1],duration:.2},onAnimationComplete:()=>o(!1),style:{overflow:"hidden"},children:(0,R.jsx)("div",{ref:r,children:t})}):(0,R.jsx)("div",{style:{marginBottom:n},children:t})}function ze(e){const{assistantResponseCategory:t,inferenceId:n}=e,s=(0,i.useRef)(void 0===t);let a;switch(t){case"content-unsourced":a=(0,R.jsx)(Ue,{inferenceId:n});break;case"content-sourced":case"meta-discussion":case"meta-refusal":case"meta-unsure":case void 0:return null;default:(0,f.t1)(t)}return s.current?(0,R.jsx)(Ne,{visibleMarginBottom:14,children:a}):(0,R.jsx)("div",{style:{marginBottom:14},children:a})}function Ue(e){const{inferenceId:t}=e,n=(0,a.O7)(),[s,r]=(0,i.useState)(!1),l=(0,o.VK)((()=>he.default.getActiveSessionId()),[]);(0,i.useEffect)((()=>{l&&t&&(0,ue.j)({environment:n,event:{eventName:"assistant_world_knowledge_citation_displayed",eventProperties:{session_id:l,inference_id:t}}})}),[l,t,n]);const d=(0,i.useCallback)((()=>{if(!l||!t)return;const e=!s;r(e),(0,ue.j)({environment:n,event:{eventName:"assistant_world_knowledge_citation_toggled",eventProperties:{session_id:l,inference_id:t,is_expanded:e}}})}),[n,t,s,l]);return(0,R.jsxs)(S.jX,{direction:"column",gap:2,padding:"0 0 0 4px",children:[(0,R.jsx)(Ae,{enabled:!0,isLoading:!1,onClick:d,open:s,children:(0,R.jsx)(h.FormattedMessage,{id:"assistantCitationHelpers.worldKnowledge",defaultMessage:"Powered by GPT-4"})}),s?(0,R.jsx)(k.q,{styleName:"UISmall-12px/Medium",colorName:"tertiary",children:(0,R.jsx)(h.FormattedMessage,{id:"assistantCitationHelpers.worldKnowledgeMore",defaultMessage:"Notion AI generated this answer using GPT-4's general knowledge. Please check for accuracy."})}):null]})}},13808:(e,t,n)=>{n.d(t,{E:()=>r});n(667294);var s=n(296994),i=n(277907),a=n(152183),o=n(785893);function r(e){const{sizeVariant:t,includeBoxShadow:n,onMouseEnter:r}=e,{value:l}=(0,i.XJ)(s.FF.assistantAnimatedFace);if(!l)return(0,o.jsx)(a.P,{variant:t,wrapWithPadding:!1});const d=l.AssistantAnimatedFace;return(0,o.jsx)(d,{sizeVariant:t,includeBoxShadow:n??!1,onMouseEnter:r})}},428690:(e,t,n)=>{n.d(t,{g:()=>c});n(667294);var s=n(800480),i=n(886628),a=n(521273),o=n(215342),r=n(152183),l=n(13808),d=n(785893);function c(e){const{variant:t,includeBoxShadow:n}=e,c=(0,s.Fy)(),u=(0,i.VK)((()=>a.Z.shouldShowAnimatedAssistantFace(c)),[c]),p=(0,i.VK)((()=>a.Z.isXMLAssistantEnabled()),[]);return u?(0,d.jsx)(l.E,{sizeVariant:t,includeBoxShadow:n}):p?(0,d.jsx)(r.P,{variant:t}):(0,d.jsx)(o.n,{})}},274360:(e,t,n)=>{n.d(t,{HY:()=>ee,JO:()=>ae,bR:()=>te});var s=n(667294),i=n(701302),a=n(800480),o=n(886628),r=n(724405),l=n(681532),d=n(709107),c=n(322962),u=n(83065),p=n(745238),g=n(785893);const m=(0,p.IU)("squareStop",{viewBox:"0 0 20 20",svg:(0,g.jsx)("path",{d:"M9.79469 18.5894C8.59333 18.5894 7.46094 18.3595 6.39753 17.8996C5.33986 17.4398 4.40579 16.8046 3.5953 15.9941C2.78481 15.1836 2.14963 14.2495 1.68978 13.1919C1.22993 12.1284 1 10.9961 1 9.79469C1 8.59333 1.22993 7.46381 1.68978 6.40615C2.14963 5.34274 2.78193 4.40579 3.58667 3.5953C4.39717 2.78481 5.33124 2.14963 6.3889 1.68978C7.45232 1.22993 8.5847 1 9.78607 1C10.9874 1 12.1198 1.22993 13.1832 1.68978C14.2466 2.14963 15.1836 2.78481 15.9941 3.5953C16.8046 4.40579 17.4398 5.34274 17.8996 6.40615C18.3595 7.46381 18.5894 8.59333 18.5894 9.79469C18.5894 10.9961 18.3595 12.1284 17.8996 13.1919C17.4398 14.2495 16.8046 15.1836 15.9941 15.9941C15.1836 16.8046 14.2466 17.4398 13.1832 17.8996C12.1256 18.3595 10.9961 18.5894 9.79469 18.5894ZM7.44944 13.028H12.1399C12.4159 13.028 12.6314 12.9504 12.7866 12.7952C12.9476 12.64 13.028 12.4245 13.028 12.1486V7.42357C13.028 7.15341 12.9476 6.94073 12.7866 6.78553C12.6314 6.63033 12.4159 6.55273 12.1399 6.55273H7.44944C7.17353 6.55273 6.9551 6.63033 6.79415 6.78553C6.63895 6.94073 6.56135 7.15341 6.56135 7.42357V12.1486C6.56135 12.4245 6.63895 12.64 6.79415 12.7952C6.9551 12.9504 7.17353 13.028 7.44944 13.028Z"})});var h=n(449143),f=n(76233),y=n(709291),x=n(401898),v=n(567060),S=n(137231),b=n(898104),C=n(210228),j=n(227370),k=n(667436),w=n(623063),I=n(573063),M=n(526388),T=n(965187),A=(n(95477),n(510102)),P=n(843250),B=n(212534),_=n(249394),F=n(268056),Z=n(635622),V=n(828685),R=(n(974520),n(521273)),L=n(798180),E=n(990827),K=n(128093),O=n(629026),D=n(924666),W=n(252193),H=n(724199),N=n(144500),z=n(794562),U=n(428690),G=n(6249),q=n(557199),$=n(883644);const Q={page:!0,createPage:!1,user:!0,inviteUserToWorkspace:!1,inviteUserToPage:!1,date:!0,reminder:!1,bot:!1,group:!1,heading:!1,templateVariable:!1},Y=(0,h.p_)(Q),X=["page","user","date"];const J=(0,y.defineMessages)({default:{id:"assistantRichTextInput.placeholder",defaultMessage:"Ask AI anything"},empty_state:{id:"assistantRichTextInput.placeholder.empty_state",defaultMessage:"Select action or ask anything"}});function ee(e){const{store:t,onSubmit:n,onFocus:d,onBlur:c,onBackspaceOnEmptyInput:u,onActivateSkill:p,onTextChange:m,textInputOverrideStyles:h,inputPlaceholderOverrideStyles:w,textContainerOverrideStyles:I,onEsc:M,typeaheadSkillElement:Z,onClickInputBox:W,requestedSkill:G}=e,q=(0,a.O7)(),{isMobile:ee}=(0,a.Fy)(),se=(0,y.useIntl)(),re=(0,o.VK)((()=>t.getValue()),[t]),le=(0,s.useMemo)((()=>!re||0===(0,f.VrM)(re)),[re]),de=(0,s.useMemo)((()=>f.QaF(re)),[re]),ce=(0,s.useRef)([]),ue=function(e){const{assistantChatRenderState:t,requestedSkill:n,isSampling:s,emptyStateResultsIsEmpty:i,storeIsEmpty:a}=e,r=(0,A.Io)(),d="empty_state"===(null==t?void 0:t.type),c=(0,o.VK)((()=>K.Z.state.available),[]);if(d&&n&&(0,l._Y)(n.skillType))return"blockOrText"!==(0,l.sI)(n.skillType).parameterDefinition.type||c?{type:"select_parameters"}:{type:"select_parameters_freeform"};return d&&i?{type:"default",isWriter:r.isWriter}:d?{type:"empty_state"}:"chat"===(null==t?void 0:t.type)&&s?{type:"inferencing"}:"tutorial"!==(null==t?void 0:t.type)||a?"tutorial"===(null==t?void 0:t.type)?{type:"tutorial_disabled"}:{type:"default",isWriter:r.isWriter}:{type:"tutorial_pulse"}}({...e,storeIsEmpty:le}),pe=(0,A.Io)(),ge=pe.isType("fullPage"),me=(0,s.useRef)(null),he=(0,s.useRef)(null),[fe,ye]=(0,s.useState)(!1),xe=fe&&(de.length>20||de.includes("\n")),ve=Boolean(!xe&&Z),Se=(0,s.useMemo)((()=>{if("default"===ue.type||"inferencing"===ue.type||"tutorial_disabled"===ue.type||"tutorial_pulse"===ue.type)return se.formatMessage(J.default);if("empty_state"===ue.type)return se.formatMessage(J.empty_state);if("select_parameters"===ue.type||"select_parameters_freeform"===ue.type){if(G&&(0,l._Y)(G.skillType)){const e=(0,l.sI)(G.skillType).parameterDefinition.placeholder;return e?se.formatMessage(e):se.formatMessage(J.default)}}else(0,x.t1)(ue.type)}),[se,ue.type,G]),{writerFeedbackInferenceId:be,writerSessionId:Ce}=(0,o.VK)((()=>{if(pe!==A.FP.writer)return{};const e=(0,E.Js)();return 0===(null==e?void 0:e.clientSteps.length)?{}:{writerFeedbackInferenceId:null==e?void 0:e.latestCommitInferenceId,writerSessionId:null==e?void 0:e.sessionId}}),[pe]),je=(0,o.VK)((()=>!!pe.isType("writer")&&R.Z.showInlineDebugButton()),[pe]),ke="default"!==ue.type&&"select_parameters_freeform"!==ue.type,we=(0,z.u)(),Ie=(0,r.yK)((e=>{const t={paddingTop:2,paddingRight:8,paddingBottom:2,paddingLeft:14};return ve?t.paddingLeft=6:ee&&(t.paddingRight=6,t.paddingLeft=16),{wrap:{display:"flex",alignItems:"center",flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,minHeight:we.inputHeight,backgroundColor:"dark"===e.mode?e.accentColors.translucentGray[100]:"transparent",borderRadius:ee?20:18,...t,overflow:"inherit",fontSize:ee?15:14,...xe?{flexWrap:"wrap"}:{},...W?{cursor:"pointer"}:{},...h},textContainer:{flexGrow:1,padding:ee?"6px 0":"4px 0",minHeight:ee?36:void 0,maxHeight:240,overflow:"auto",...xe?{paddingRight:"14px",flexBasis:"100%"}:{},...I},placeholder:{opacity:ke?.5:1,cursor:"text",...w},rightGutter:{marginTop:ee?"0px":"4px",marginBottom:ee?"0px":"4px",display:"flex",alignItems:"center",gap:ee?8:4}}}),[ve,ee,we.inputHeight,xe,W,h,I,ke,w]),Me=(0,s.useCallback)((e=>{(0,B.ZP)({event:e,context:B.Af.ButtonMouseDown,callback:()=>{const e=L.default.getActiveSession();e&&te({environment:q,sessionContext:e,store:t})}})}),[q,t]),Te=(0,s.useCallback)((()=>{const e=t.getValue();!le&&e&&("select_parameters_freeform"===ue.type&&G&&(0,N.clientSkillHasFreeformFillableParameter)(G)?null==p||p({clientSkill:G,parameterValues:(0,l.Vf)(G.skillType,e)}):n&&(n(e),C.createAndCommit({userAction:"AssistantRichTextInput.valueChanged",environment:q,perform:e=>{S.sO({environment:q,store:t,value:void 0,transaction:e})}})))}),[t,le,ue.type,G,n,p,q]),Ae=(0,s.useCallback)((()=>{M?M():(O.ZP.switchToSearchPane(),ge||H.assistantMenuActions.closeAssistantRightHandSideMenu({environment:q,assistantInputTextStore:t}))}),[M,ge,t,q]),Pe=(0,s.useCallback)((e=>{const n=ce.current;ce.current=t.getValue()??[],e&&e instanceof KeyboardEvent&&"Backspace"===e.key&&!e.repeat&&0===(0,f.VrM)(n??[])&&(null==u||u()),null==m||m(t.getValue()),j.dismissTutorial(q,"enhanced-qna-onboarding")}),[m,t,q,u]),Be=(0,s.useCallback)((async()=>{const e=D.default.state;"editing"===e.mode&&(0,F.qS)(e.multiSelection)&&e.multiSelection.start.store===t||(b.NX({store:t}),await i.default.afterNextFlush())}),[t]);(0,s.useEffect)((()=>{let e=null;const t=new ResizeObserver((e=>{const t=e[0],{scrollHeight:n}=t.target;ye(n>=40)}));return me.current&&(e=me.current,t.observe(me.current)),()=>{e&&t.unobserve(e)}}),[]);const _e="select_parameters"===ue.type||"select_parameters_freeform"===ue.type,Fe="tutorial_disabled"===ue.type||"tutorial_pulse"===ue.type;return(0,g.jsxs)("div",{style:{display:"flex",flex:1},children:[(0,g.jsx)($.q,{isMultiline:xe,showEnterTransition:!0}),(0,g.jsxs)("div",{style:Ie.wrap,ref:me,tabIndex:0,...ee||"tutorial_disabled"===ue.type||"tutorial_pulse"===ue.type||"default"===ue.type&&ue.isWriter?{}:{className:P.Wh_},onClick:e=>{if(e.target===e.currentTarget){const n=V.E.findEditableWithStore(t);n&&n.handleClick(e)}},children:[("select_parameters"===ue.type||"select_parameters_freeform"===ue.type)&&(0,g.jsx)("div",{style:{marginRight:4,marginTop:"4px",marginBottom:"4px"},children:Z}),(0,g.jsx)(T.Z,{style:Ie.textContainer,onBlur:c,onEsc:Ae,placeholder:Se,disabled:Fe,onClick:"tutorial_pulse"===ue.type?()=>null==n?void 0:n(t.getValue()):void 0,store:t,placeholderStyle:Ie.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!1,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableEnter:ke,onEnter:Te,disableMobileActionBar:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,onFocus:d,onChange:Pe,disableMentions:_e,disabledMentionTypes:Y,disableSuggestEdit:!0,inPageFind:_.B3.none,usePopupForMentionOnMobile:!0,mentionSectionOrdering:X,disableUpDownArrows:!xe&&ke}),xe&&pe.isWriter&&(0,g.jsx)("div",{style:{marginBottom:8},children:(0,g.jsx)(U.g,{variant:"small",includeBoxShadow:!0})}),xe&&(0,g.jsx)("div",{style:{flexGrow:1,flexBasis:"50px"}}),(0,g.jsxs)("div",{style:Ie.rightGutter,children:[be&&(0,g.jsx)(oe,{sessionId:Ce,inferenceId:be,visible:le}),!_e&&!Fe&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(ie,{ref:he,onClick:e=>{e.preventDefault(),e.stopPropagation(),async function(){await Be(),v.lZ({environment:q,mentionTypes:Q,usePopupOnMobile:!0,mentionSectionOrdering:X}),H.assistantAnalyticsActions.trackAtMentionClick(q)}()}}),(0,g.jsx)(k.s,{origin:he})]}),je&&(0,g.jsx)(ne,{}),(0,g.jsx)(ae,{storeIsEmpty:le,handleClickEnter:Te,handleClickStop:Me,mode:ue})]})]})]})}function te(e){const{sessionContext:t,environment:n,store:s}=e,i=(0,W.stopCurrentHumanStepSubmission)({environment:n,sessionContext:t});if(i){const{lastHumanStepText:e}=i;C.createAndCommit({userAction:"AssistantRichTextInput.stopStepSubmission",environment:n,perform:t=>{S.sO({environment:n,store:s,value:e,transaction:t})}}),b.NX({store:s})}}function ne(){const{isMobile:e}=(0,a.Fy)(),t=(0,y.useIntl)(),n=(0,Z.Z)(!0),s=t.formatMessage({id:"assistantRichTextInput.showDebugHelpers.button.tooltip",defaultMessage:"[Dev only] Show assistant debug helpers."});return(0,g.jsx)(M.Z,{renderTooltip:()=>s,render:t=>(0,g.jsx)(I.Z,{ariaLabel:s,icon:d.z,iconStyle:{width:e?26:16,height:e?26:16},style:{marginRight:4,width:e?36:void 0,height:e?36:void 0},onClick:()=>{},...t,...n})})}function se(e,t){const{onClick:n}=e,{isMobile:s}=(0,a.Fy)(),i=(0,y.useIntl)(),o=(0,Z.Z)(!0),r=i.formatMessage({id:"assistantRichTextInput.insertMention.button.tooltip",defaultMessage:"Mention a person, page, or date"});return(0,g.jsx)(M.Z,{renderTooltip:()=>r,render:e=>(0,g.jsx)(I.Z,{ref:t,ariaLabel:r,icon:c.O,iconStyle:{width:s?20:16,height:s?20:16},style:{marginLeft:s?16:0,marginRight:0,width:s?26:24,height:s?26:24},onClick:n,...e,...o})})}const ie=s.forwardRef(se);function ae(e){const{storeIsEmpty:t,handleClickStop:n,handleClickEnter:s,mode:i}=e,{isMobile:o}=(0,a.Fy)(),l=(0,r.yK)((e=>({stopIcon:{fill:e.icon.primary},icon:{height:o?30:20,width:o?30:20},button:{pointerEvents:"auto",height:o?30:20,width:o?30:20,borderRadius:"100%"}})),[o]);return"inferencing"===i.type?(0,g.jsx)(I.Z,{icon:m,onClick:n,style:l.button,iconStyle:{...l.icon,...l.stopIcon},ariaLabel:"stop-ai-message"}):"select_parameters"===i.type||"empty_state"===i.type?(0,g.jsx)(I.Z,{icon:u._,onClick:s,isBlue:!1,disabled:!0,iconStyle:l.icon,style:l.button,ariaLabel:"submit-ai-message"}):"select_parameters_freeform"===i.type?(0,g.jsx)(I.Z,{icon:u._,onClick:s,style:l.button,iconStyle:l.icon,isBlue:!t,disabled:t,ariaLabel:"Submit text as parameter"}):"tutorial_disabled"===i.type?(0,g.jsx)(I.Z,{icon:u._,isBlue:!1,style:l.button,disabled:!0,iconStyle:l.icon,ariaLabel:"submit-ai-message"}):"tutorial_pulse"===i.type?(0,g.jsx)(q.D,{children:(0,g.jsx)(I.Z,{icon:u._,onClick:s,isBlue:!t,disabled:t,iconStyle:l.icon,style:l.button,ariaLabel:"submit-ai-message"})}):"default"===i.type?(0,g.jsx)(I.Z,{icon:u._,onClick:s,isBlue:!t,disabled:t,iconStyle:l.icon,style:l.button,ariaLabel:"submit-ai-message"}):void(0,x.t1)(i.type)}function oe(e){const{inferenceId:t,sessionId:n,visible:s}=e,i=e=>(0,g.jsx)(w.Z,{isVisible:!0,animationStyle:{opacity:s?1:0},render:()=>e});return(0,g.jsxs)(g.Fragment,{children:[i((0,g.jsx)(G.i5,{disableTooltip:!s,sessionId:n,inferenceId:t})),i((0,g.jsx)(G.PI,{disableTooltip:!s,sessionId:n,inferenceId:t}))]})}},883644:(e,t,n)=>{n.d(t,{q:()=>h});var s=n(733993),i=(n(667294),n(800480)),a=n(886628),o=n(724405),r=n(510102),l=n(521273),d=n(798180),c=n(217978),u=n(167133),p=n(995853),g=n(428690),m=n(785893);function h(e){const{isMultiline:t,showEnterTransition:n}=e,h=(0,c.u)(),f=(0,r.Io)(),y=(0,a.VK)((()=>d.default.getActiveSession()),[]),x=(0,a.VK)((()=>p.l.state),[]),v=(0,u.f)(y),S=(0,a.VK)((()=>Boolean(null==y?void 0:y.getHasCommittedHumanStep())),[y]),b=(0,a.VK)((()=>{const{selectedSkill:e,selectedSuggestionGroup:t}=y??{};return!(v||S||e||t)}),[y,v,S]),C=(0,a.VK)((()=>{if(l.Z.isXMLAssistantEnabled())return f.isWriter?!t:!!(x.isActive&&x.stepIndex>0&&"tutorial"===h.type)||!b}),[f,t,b,x,h.type]),j=function(e){const{isMultiline:t}=e,n=(0,r.Io)(),{isMobile:s}=(0,i.Fy)();return(0,o.yK)((()=>({container:{alignSelf:t?"end":"center",flexShrink:0,marginLeft:n.isWriter?8:0,marginRight:s||n.isWriter?0:8}})),[t,n,s])}({isMultiline:t});return C?(0,m.jsx)(s.E.div,{style:j.container,initial:!!n&&{opacity:0,scale:.4,maxWidth:0},animate:{opacity:1,scale:1,maxWidth:36},transition:{scale:{type:"spring",stiffness:700,damping:30,mass:1},opacity:{duration:.4,ease:"linear"},maxWidth:{type:"spring",stiffness:740,damping:30,mass:1},delay:x.isActive?.15:0},children:(0,m.jsx)(g.g,{variant:"small",includeBoxShadow:!0})}):null}},139249:(e,t,n)=>{n.d(t,{ZP:()=>se});n(757658);var s=n(443261),i=n.n(s),a=n(667294),o=n(118466),r=n(800480),l=n(886628),d=n(724405),c=n(559054),u=n(747453),p=n(908542),g=n(709291),m=n(653965),h=n(401898),f=n(137810),y=n(524677),x=n(595193),v=n(552275),S=n(973420),b=n(268894),C=n(636596),j=n(478140),k=n(632163),w=n(672495),I=n(161496),M=n(510102),T=n(934700),A=n(615447),P=n(80444),B=n(798180),_=n(206258),F=n(365147),Z=n(548809),V=n(724199),R=n(158449),L=n(247560),E=n(937612),K=n(76233),O=n(547307),D=n(573063),W=n(731278),H=n(816402),N=n(828344),z=n(286649),U=n(207879),G=n(785893);const q=(0,g.defineMessages)({trashIconAriaLabel:{id:"assistantChatHistoryIcon.deleteSession.label",defaultMessage:"Delete chat"},chatHistoryConfirmation:{id:"assistantChatHistory.deleteConfirmation.message",defaultMessage:"Are you sure you want to delete this chat?"}}),$=a.forwardRef(((e,t)=>{const{chatStore:n,hideBottomBorder:s,description:i,isSelected:o,...c}=e,{isMobile:u}=(0,r.Fy)(),p=(0,r.O7)(),m=(0,g.useIntl)(),[h,y]=a.useState(!1),{type:x}=(0,M.Io)(),S=(0,U.t)({chatSessionId:n.id,chatStore:n}),b=(0,l.VK)((()=>(0,H.IS)(n.getCreatedTime(),{useUltraCompactFormat:!0,roundDownYears:!0,useWeeks:!0,useLowercase:!0})),[n]),C=a.useCallback((async()=>{(await O.confirmUserActionV2({message:m.formatMessage(q.chatHistoryConfirmation)})).accept&&(0,F.If)({sessionId:n.id,environment:p}),N.trackAIChatTranscriptHistoryChatDeleted(p,{source:x})}),[m,p,x,n.id]),j=(0,d.yK)((e=>({wrapper:{marginLeft:void 0,marginRight:void 0,borderRadius:6,borderBottom:"1px solid transparent",...u?{paddingLeft:16}:{padding:"6px 12px"},...o&&!u?{backgroundColor:e.sidebarItemSelectedBackground}:{}},selectedWrapper:{},titleWrap:{display:"flex",alignItems:"center"},timestamp:{fontSize:f.Z.fontSize.UISmall.desktop,color:e.text.secondary,paddingLeft:6,flexShrink:0},icon:{marginRight:12,marginLeft:2},rightIcon:{marginRight:0},lighterBackground:{backgroundColor:e.hoveredDiscussionBackground},hoveredStyle:{backgroundColor:e.hoveredDiscussionBackground},bodyStyle:{...u&&{backgroundColor:e.contentBackground,boxShadow:void 0}}})),[u,o]),k=(0,G.jsx)(v.Z,{...c,ref:t,hoveredStyle:j.hoveredStyle,left:(0,G.jsx)(X,{chatStore:n}),leftStyle:j.icon,rightStyle:j.rightIcon,title:(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(Y,{title:S}),(0,G.jsx)("div",{style:j.timestamp,children:b})]}),titleStyle:j.titleWrap,style:j.bodyStyle,caption:i,buttonStyle:j.wrapper,right:(u||c.focused&&h)&&(0,G.jsx)(J,{onDeleteHistoryItem:C}),pressedStyle:j.lighterBackground});return u?k:(0,G.jsx)("div",{onMouseEnter:e=>{var t;y(!0),null===(t=c.onMouseEnter)||void 0===t||t.call(c,e)},onMouseLeave:e=>{var t;y(!1),null===(t=c.onMouseLeave)||void 0===t||t.call(c,e)},children:k})}));$.displayName="AssistantChatHistoryItem";const Q=$;function Y(e){const{title:t}=e,n=(0,d.yK)((()=>({title:{fontSize:14,fontWeight:f.Z.fontWeight.medium,...f.Z.textOverflowStyle}})),[]),s=(0,a.useRef)(t),[i,o]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{t!==s.current&&(o(!0),s.current=t)}),[t]),i?(0,G.jsx)(z.s,{textValue:(0,K.TPx)(t),overrideTextStyles:n.title,chunkSize:10}):(0,G.jsx)("div",{style:n.title,children:t})}function X(e){const{chatStore:t}=e,n=(0,l.VK)((()=>t.getImageIfExists()),[t]),s=(0,d.yK)((e=>({icon:{borderRadius:"100%"},emptyChatIcon:{width:20,height:"auto",color:e.lightIconColor},emptyChatIconContainer:{backgroundColor:e.lightDividerColor,width:28,height:28,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center"}})),[]);return n?(0,G.jsx)(W.Z,{disabled:!0,isEmptyPage:!1,icon:n,size:25,style:s.icon}):(0,G.jsx)("div",{style:s.emptyChatIconContainer,children:(0,L.o)(s.emptyChatIcon)})}function J(e){const{onDeleteHistoryItem:t}=e,n=(0,g.useIntl)(),{isMobile:s}=(0,r.Fy)(),i=(0,d.yK)((e=>({container:{padding:3,borderRadius:6,...s&&{marginRight:16}},trashIcon:{height:18,width:18,color:e.icon.tertiary}})),[s]);return(0,G.jsx)(D.Z,{icon:E.y,ariaLabel:n.formatMessage(q.trashIconAriaLabel),style:i.container,iconStyle:i.trashIcon,onClick:t})}const ee=24,te=12,ne=(0,g.defineMessages)({chatHistorySearchPlaceholder:{id:"assistant.chatHistory.placeholder",defaultMessage:"Search or start new chat"}});function se(e){const{onRestoreChatSession:t}=e,{isMobile:n}=(0,r.Fy)(),s=(0,r.O7)(),u=(0,g.useIntl)(),[f,v]=a.useState(!1),[b,C]=a.useState(""),T=(0,l.VK)((()=>P.default.state.currentSpaceStore),[]),V=(0,M.Io)(),{renderAsFullPage:L}=V,E=V.isType("fullPage"),K=(0,d.yK)((e=>({shimmerWrapper:{padding:12,marginTop:10},shimmerRow:{height:10,borderRadius:12,backgroundColor:e.lightDividerColor}})),[]);a.useEffect((()=>{v(!0),(0,Z.t_)({environment:s,currentSpaceStore:T}).then((()=>{v(!1)}))}),[s,T]);const O=(0,l.VK)((()=>{if(!T)return[];const e=T.id;return R.Z.getSessionsForSpace(e).map((t=>{let{id:n}=t;return _.uj.createChildStore(T,{id:n,table:p.t_,spaceId:e})}))}),[T]),[{value:D}]=(0,c.r5)((async()=>await(0,Z.PO)({chatHistorySessionStores:O,intl:u})),[O,u]),W=a.useMemo((()=>{if(!b)return O;const e={extract:e=>o.Z.withListenerIgnored((()=>`${e.getTitleOrFallback({intl:u})} ${(null==D?void 0:D.get(e.id))??""}`))};return i().filter(b,O??[],e).map((e=>e.original))}),[b,O,D,u]),H=(0,l.VK)((()=>{const e=B.default.getActiveSession();return null==e?void 0:e.sessionId}),[]),N=(0,l.VK)((()=>m.vM(W??[],(e=>(0,A._5)(e.getCreatedTime())))),[W]),z=(0,l.VK)((()=>{const e=A._k.map((e=>{const n=N[e]??[];if(0===n.length)return;const i=n.findIndex((e=>e.id===H)),a=n.map(((e,n)=>{const a=-1!==i&&i-1===n;return function(e){const{environment:t,onRestoreChatSession:n,chatStore:s,description:i,isChatItemSelected:a,isBeforeSelectedChatItem:o,assistantSurface:r}=e;return{key:s.id,render:e=>(0,G.jsx)(Q,{...e,chatStore:s,description:i,isSelected:a,hideBottomBorder:e.focused||e.isBeforeFocused||e.isLastInSection||o}),action:()=>{(0,F.N0)({environment:t,assistantSurface:r,action:()=>{(0,Z.HB)({environment:t,chatStore:s,onRestoreChatSession:n})}})}}}({environment:s,chatStore:e,onRestoreChatSession:t,description:(null==D?void 0:D.get(e.id))??"",isChatItemSelected:e.id===H,isBeforeSelectedChatItem:a,assistantSurface:V})})).filter(h.$K);return{key:e,render:t=>(0,G.jsx)(w.Z,{...t,title:(0,I.e)(e),enableActionSheetTitle:!0}),items:a}})).filter(h.$K);return 0===e.length?[{key:"empty",render:e=>(0,G.jsx)(w.Z,{...e}),items:[{key:"no_results",render:()=>(0,G.jsx)(re,{}),action:()=>{}}]}]:(E||e[e.length-1].items.push({key:"start_new_chat_option",render:e=>(0,G.jsx)(le,{...e}),action:()=>{(0,F.N0)({environment:s,action:()=>{(0,Z.hW)({environment:s,source:V.type})},assistantSurface:V})}}),e)}),[s,N,t,D,H,V,E]),U=(0,G.jsx)(oe,{userSearchQuery:b,setUserSearchQuery:C,onFocus:()=>{y.ZH({debug:{userAction:"AssistantChatHistoryList.input"},environment:s})}}),q=ee+te,$={...(0,x.F)(),header:U,...L?{maxHeight:n||E?"100vh":`calc(100vh - ${q}px)`}:{height:450}},Y=(0,G.jsx)(j.Z,{...$,children:f?(0,G.jsx)("div",{style:K.shimmerWrapper,children:(0,G.jsxs)(S.sg,{gap:32,children:[(0,G.jsx)(ie,{count:4}),(0,G.jsx)(ie,{count:10})]})}):(0,G.jsx)(k.Z,{style:n?void 0:{paddingLeft:8},type:k.i.Vertical,initialFocus:void 0,disableKeyboard:!0,sections:z})});return E?(0,G.jsx)("div",{style:{overflow:"hidden"},children:Y}):Y}function ie(e){const{count:t}=e,n=(0,d.yK)((e=>({sectionHeader:{height:13,width:60,borderRadius:4},icon:{height:28,width:28,borderRadius:4},chatSummary:{height:17,borderRadius:4},container:{borderBottom:`1px solid ${e.lightDividerColor}`,paddingBottom:15,PaddingTop:20}})),[]),s=Array.from({length:t},(()=>!0));return(0,G.jsxs)(S.sg,{gap:24,children:[(0,G.jsx)(C.Z,{style:n.sectionHeader}),(0,G.jsx)(S.sg,{gap:12,children:s.map(((e,t)=>(0,G.jsx)("div",{style:n.container,children:(0,G.jsxs)(S.X2,{gap:16,children:[(0,G.jsx)(C.Z,{style:n.icon}),(0,G.jsx)(ae,{})]})},`chat-history-shimmer-${t}`)))})]})}function ae(){const e=(0,d.yK)((e=>({chatTitle:{width:200,height:20,borderRadius:4},chatSummary:{height:12,borderRadius:4},container:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",gap:5}})),[]);return(0,G.jsxs)("div",{style:e.container,children:[(0,G.jsx)(C.Z,{style:{...e.chatTitle,width:"55%"}}),(0,G.jsx)(C.Z,{style:{...e.chatSummary,width:"65%"}})]})}function oe(e){const{onFocus:t,userSearchQuery:n,setUserSearchQuery:s}=e,i=(0,g.useIntl)(),{isMobile:a}=(0,r.Fy)(),o=(0,r.O7)(),l=(0,M.Io)(),c=(0,d.yK)((e=>{let t;return t=l.isType("corner")?{paddingBottom:2,marginTop:0,marginBottom:0}:l.isType("fullPage")?{padding:"6px 4px"}:{padding:"10px 0 2px",...l.isType("commandSearch")&&{...(0,T.X)({noDrag:!0})}},{container:t,inputOuterStyle:{backgroundColor:e.whiteButtonBackground,borderRadius:6,padding:"4px 8px"},inputStyle:{backgroundColor:e.whiteButtonBackground}}}),[l]);return(0,G.jsx)(b.ZP,{autoFocus:a,onFocus:t,...l.isType("fullPage")?{showClearButton:!0}:{},style:c.container,inputOuterStyle:c.inputOuterStyle,inputStyle:c.inputStyle,value:n,onChange:e=>{s(e.target.value)},placeholder:i.formatMessage(ne.chatHistorySearchPlaceholder),onSubmit:()=>{(0,F.N0)({environment:o,assistantSurface:l,action:async()=>{await(0,V.handleSubmitNewQuestion)({newValue:[[n]],environment:o,currentClientSkillWithSettings:void 0,shouldForceStartNewSession:!0,source:"transcript",assistantSurfaceType:l.type}),V.assistantMenuStore.setState({...V.assistantMenuStore.state,currentView:"chat"})}})}})}function re(){const e=(0,d.yK)((e=>({noResultsMessage:{paddingTop:30,paddingBottom:30,display:"flex",justifyContent:"center",alignItems:"center",color:e.lightTextColor,fontSize:12}})),[]);return(0,G.jsx)("div",{style:e.noResultsMessage,children:(0,G.jsx)(g.FormattedMessage,{id:"assistant.chatHistory.noResults",defaultMessage:"No results"})})}const le=a.forwardRef(((e,t)=>{const{isMobile:n}=(0,r.Fy)(),s=(0,d.yK)((e=>({startNewChatIcon:{color:e.icon.secondary,height:16,width:16},hoveredStyle:{borderRadius:12},wrapper:{display:"flex",alignItems:"center",paddingTop:20,paddingBottom:20,marginTop:6,marginBottom:6,fontSize:14,color:e.text.secondary,fontWeight:f.Z.fontWeight.medium,...n&&{backgroundColor:e.contentBackground,boxShadow:void 0}},button:{marginLeft:0},iconWrapper:{marginLeft:16,marginRight:12},lighterBackground:{backgroundColor:e.hoveredDiscussionBackground}})),[n]);return(0,G.jsx)(v.Z,{ref:t,...e,style:s.wrapper,left:(0,u.R)(s.startNewChatIcon),leftStyle:s.iconWrapper,buttonStyle:s.button,title:(0,G.jsx)(g.FormattedMessage,{id:"assistant.chatHistory.startNewChat",defaultMessage:"Start a new chat"}),hoveredStyle:(s.lighterBackground,s.hoveredStyle),pressedStyle:s.lighterBackground})}));le.displayName="CreateNewChatMenuItem"},574003:(e,t,n)=>{n.d(t,{p:()=>U,F:()=>G});var s=n(667294),i=n(294184),a=n.n(i),o=n(800480),r=n(886628),l=n(724405),d=n(388421),c=n(559054),u=n(213148),p=n(239132),g=n(355863),m=n(654497),h=n(820852),f=n(76233),y=n(531701),x=n(401898),v=n(137810),S=n(442274),b=n(328385),C=n(573063),j=n(301743),k=n(953437),w=n(526388),I=n(510102),M=n(296994),T=n(768657),A=n(825464),P=n(223196),B=n(80444),_=n(521273),F=n(798180),Z=n(316772),V=n(252193),R=n(785893);function L(e){const{open:t,onDismiss:n,...s}=e,i=(0,r.VK)((()=>{var e;return null===(e=B.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]);return i?(0,R.jsx)(k.GI,{popupType:P.k.Popup,originGap:8,alignmentToOrigin:k.GI.Alignment.Center,open:t,onDismiss:n,placementToOrigin:k.GI.Placement.Left,...s,render:()=>(0,R.jsx)(E,{parentSpaceId:i,onDismiss:n})}):null}function E(e){const t=(0,I.Io)().isWriter,n=(0,r.VK)((()=>"assistantCompletionPopup"===Z.default.state.type?Z.default.state.sessionId:void 0),[]),s=(0,r.VK)((()=>{const e=t&&n?F.default.getSessionContext(n):F.default.getActiveSession();return null==e?void 0:e.previewingStep}),[n,t],{useDeepEqual:!0});return s?(0,R.jsx)(O,{...e,previewingStep:s}):(0,R.jsx)(K,{})}function K(){const e=(0,l.yK)((()=>({wrap:{display:"flex",flexDirection:"column",padding:8}})),[]);return(0,R.jsx)("div",{style:e.wrap,children:"No previewing step"})}function O(e){const{parentSpaceId:t,onDismiss:n,previewingStep:i}=e,c=(0,l.yK)((()=>({wrap:{display:"flex",flexDirection:"column",width:450},codeWrap:{display:"flex",padding:8,overflow:"scroll"},codeBlock:{padding:0,height:200},codeBlockWrap:{width:"100%"}})),[]),u=(0,o.O7)(),p=(0,r.VK)((()=>F.default.getActiveSession()),[]),g=(0,r.VK)((()=>_.Z.isJSAssistantEnabled()),[]),m=(0,r.VK)((()=>{const e=null==p?void 0:p.assistantConfigurationState;return Boolean(e&&(e.sampling||e.evaluating))}),[p]),y=(0,r.VK)((()=>(null==p?void 0:p.previewingStepObservations)||[]),[p],{useDeepEqual:!0}),x=y.filter(d.zZ),v=y.filter((e=>!(0,d.zZ)(e))),S=(0,s.useCallback)((async e=>{if(!p)return;const t=(0,f.Jcv)(e),n={...i,value:t},s=p.sessionId;p.setPendingStepValue({step:n}),await V.simulateOrCommitStep({environment:u,step:n,commit:!1,isStreaming:!1,preventSelection:!0,sessionId:s,inferenceId:"",updater:p.createUpdater()})}),[u,i,p]),{store:C,setValue:k}=(0,T.Cl)({initialValue:(0,f.TPx)(i.value),onChange:S}),[w]=(0,s.useState)((()=>i.value)),I=(0,s.useCallback)((()=>{k((0,f.TPx)(w))}),[w,k]);return t?(0,R.jsx)(j.Z,{capture:!0,debugName:"EditLastStepPopup",children:(0,R.jsxs)("div",{style:c.wrap,children:[(0,R.jsx)(D,{onDismiss:n,onRevert:I}),(0,R.jsx)("div",{style:c.codeWrap,className:a().focusableWithin,children:(0,R.jsx)(b.Z,{store:C,language:g?h.PrismLanguages.xml:h.PrismLanguages.jsx,blockStore:void 0,codeWrap:!0,isQuickFind:!1,parentSpaceId:t,style:c.codeBlock,disabled:!1,wrapStyle:c.codeBlockWrap})}),x.length>0&&!m&&(0,R.jsx)(N,{messages:x.map((e=>e.value))}),v.length>0&&!m&&(0,R.jsx)(W,{values:v.map((e=>e.value||"")),isJS:g})]})}):null}function D(e){const{onDismiss:t,onRevert:n}=e,s=(0,l.yK)((()=>({wrap:{display:"flex",gap:8,justifyContent:"flex-end",backgroundColor:y.ZP.contentGrayBackground,padding:4},iconButton:{height:14,width:14}})),[]);return(0,R.jsxs)("div",{style:s.wrap,children:[(0,R.jsx)(w.Z,{renderTooltip:()=>(0,R.jsx)("div",{children:"Revert to original value"}),placement:A.u.Bottom,alignment:A.v.Center,render:e=>(0,R.jsx)(C.Z,{...e,style:s.iconButton,icon:g.s,ariaLabel:"Revert",onClick:n})}),(0,R.jsx)(w.Z,{renderTooltip:()=>(0,R.jsx)("div",{children:"Close"}),placement:A.u.Bottom,alignment:A.v.Center,render:e=>(0,R.jsx)(C.Z,{...e,style:s.iconButton,icon:u.U,ariaLabel:"Save",onClick:t})})]})}function W(e){const{values:t,isJS:n}=e,s=(0,l.yK)((e=>({wrap:{display:"flex",flexDirection:"column"},icon:{width:12,height:12,display:"inline",marginRight:4,marginTop:4},itemWrap:{display:"flex",alignItems:"flex-start",fontSize:v.Z.fontSize.UISmall.desktop,borderTop:`1px solid ${e.outlineButtonBorder}`,padding:4}})),[]);return(0,R.jsx)("div",{style:s.wrap,children:t.map(((e,t)=>(0,R.jsxs)("div",{style:s.itemWrap,children:[(0,p.c)(s.icon),(0,R.jsx)(H,{value:e,disableFormat:n})]},t)))})}function H(e){const{value:t,disableFormat:n}=e,s=(0,l.yK)((()=>({wrap:{whiteSpace:"pre",fontFamily:"monospace",overflow:"scroll",maxHeight:150}})),[]),[i]=(0,c.r5)((async()=>{if(!n){const e=await S.XQ({codeSnippet:t,language:"XML"});if(e){const t=await M.FF.prismjs.load();return{type:"html",html:t.highlight(e,t.languages[h.PrismLanguages.xml],h.PrismLanguages.xml)}}}return{type:"plain",value:t}}),[t,n]);if("resolved"!==i.status)return null;const a=i.value;return"plain"===a.type?(0,R.jsx)("div",{style:s.wrap,children:a.value}):"html"===a.type?(0,R.jsx)("div",{style:s.wrap,dangerouslySetInnerHTML:{__html:a.html}}):(0,x.t1)(a)}function N(e){const{messages:t}=e,n=(0,l.yK)((e=>({wrap:{display:"flex",alignItems:"flex-start",fontSize:v.Z.fontSize.UISmall.desktop,borderTop:`1px solid ${e.outlineButtonBorder}`,color:"light"===e.mode?e.accentColors.red[500]:e.accentColors.red[800],padding:4},icon:{width:12,height:12,fill:"light"===e.mode?e.accentColors.red[400]:e.accentColors.red[700],display:"inline",marginRight:4,marginTop:4},messages:{whiteSpace:"pre-wrap"}})),[]);return(0,R.jsxs)("div",{style:n.wrap,children:[(0,m.t)(n.icon),(0,R.jsx)("div",{style:n.messages,children:t.join("\n")})]})}const z=(0,s.createContext)(void 0);function U(e){const{...t}=e,[n,i]=(0,s.useState)(!1),a=(0,s.useCallback)((()=>{i(!0)}),[]),o=(0,s.useCallback)((()=>{i(!1)}),[]),r=(0,s.useMemo)((()=>({openEditLastStepPopup:a})),[a]);return(0,R.jsx)(z.Provider,{value:r,children:(0,R.jsx)(L,{open:n,onDismiss:o,...t})})}function G(){var e;return(null===(e=(0,s.useContext)(z))||void 0===e?void 0:e.openEditLastStepPopup)??(()=>{console.error("Called useOpenEditStepPopup outside of an EditLastStepProvider!")})}z.displayName="EditLastStepContext"},458281:(e,t,n)=>{n.d(t,{F:()=>p,Y:()=>g});var s=n(667294),i=n(800480),a=n(533125),o=n(724405),r=n(137810),l=n(843250),d=n(442092),c=n(561144),u=n(785893);function p(e){const{children:t,group:n,style:i,...o}=e,r=(0,s.useRef)(null);return(0,a.c)(d.Z,(()=>({getNode:()=>r.current,getGroups:()=>[n]})),[n]),(0,u.jsx)(g,{style:i,...o,ref:r,className:l.Y3l,children:t})}const g=s.forwardRef((function(e,t){const{style:n,children:s,...a}=e,d=(0,i.Fy)(),p=(0,o.yK)((e=>({wrap:{display:"flex",flexDirection:"column",boxShadow:e.aiEditCardDropShadow,background:"dark"===e.mode?e.cardBackground:e.contentBackground,borderRadius:12,padding:"6px 0",maxWidth:"min(100%, 640px)",fontSize:d.isMobile?r.Z.fontSize.UIRegular.mobile:r.Z.fontSize.UIRegular.desktop,marginTop:c.jk,marginBottom:c.jk,...n}})),[n,d]);return(0,u.jsx)("div",{style:p.wrap,...a,ref:t,className:l.Y3l,children:s})}))},682190:(e,t,n)=>{n.d(t,{GN:()=>C,_C:()=>S,fT:()=>j});var s=n(667294),i=n(800480),a=n(886628),o=n(724405),r=n(317693),l=n(890199),d=n(222686),c=n(709291),u=n(137810),p=n(731278),g=n(776798),m=n(637034),h=n(80444),f=n(206258),y=n(836993),x=n(173435),v=n(785893);function S(e){const{pageStore:t,renderTitle:n,afterTitle:s,rightSide:r,detail:l,showLocationIfNotCurrentPage:d}=e,c=(0,i.O7)(),u=(0,o.yK)((()=>({wrap:{display:"flex",paddingRight:6,paddingLeft:8,justifyContent:"space-between",alignItems:"center",fontSize:13,...e.style},left:{display:"flex",overflow:"hidden",flexDirection:"column",marginRight:4},titleWrap:{display:"flex",alignItems:"center",overflow:"hidden"},right:{display:"flex",alignItems:"center",flexShrink:0},standalonePageTitle:{flex:"1 1 auto"},detailWrap:{display:"flex",marginLeft:4,fontWeight:500}})),[e.style]),p=(0,a.VK)((()=>{const e=new f.G(c,t.pointer);return e.isDefined()?e:void 0}),[c,t])??t,g=(0,x.JD)(p.id);let m;return m=n?(0,v.jsx)(v.Fragment,{children:n()}):!g&&d?(0,v.jsx)(k,{pageStore:p}):(0,v.jsx)(y.c,{pageStore:p,style:u.standalonePageTitle}),(0,v.jsxs)("div",{style:u.wrap,children:[(0,v.jsxs)("div",{style:u.left,children:[(0,v.jsxs)("div",{style:u.titleWrap,children:[m,s]}),(0,v.jsx)("div",{style:u.detailWrap,children:l})]}),r&&(0,v.jsx)("div",{style:u.right,children:r})]})}function b(e){const{style:t,children:n,...s}=e,a=(0,i.Fy)(),r=(0,o.yK)((e=>({wrap:{display:"flex",fontSize:a.isMobile?u.Z.fontSize.UISmall.mobile:u.Z.fontSize.UISmall.desktop,cursor:"default",alignItems:"center",userSelect:"none",marginTop:-2,...t}})),[a,t]);return(0,v.jsx)("div",{style:r.wrap,...s,children:n})}function C(e){const{label:t,expanded:n,onClick:s}=e,i=(0,o.yK)((e=>({wrap:{cursor:"pointer",color:e.accentColors.uiBlue[600]},icon:{width:11,height:11,marginLeft:4,fill:e.lightIconColor,transform:`rotateZ(${n?0:-90}deg)`,transition:"opacity 0.2s ease, transform 200ms ease-out"}})),[n]);return(0,v.jsxs)(b,{style:i.wrap,onClick:s,children:[t," ",(0,r.A)(i.icon)]})}function j(e){const{label:t}=e,n=(0,o.yK)((e=>({wrap:{color:e.v2.text.secondary}})),[]);return(0,v.jsx)(b,{style:n.wrap,children:t})}function k(e){const{pageStore:t}=e,n=(0,i.O7)(),r=(0,o.yK)((e=>({wrap:{display:"flex",color:e.v2.text.tertiary,cursor:"default",alignItems:"center",width:"100%",borderRadius:12},parentPageWrap:{display:"flex",gap:4,alignItems:"center",flex:"1 1 auto",overflow:"hidden"},customIcon:{width:16,height:16,marginRight:2},pageTitle:{flex:"1 1 auto"},fixedSpan:{flexShrink:0,display:"flex",alignItems:"center"}})),[]),u=(0,s.useMemo)((()=>(0,v.jsx)(y.c,{pageStore:t,style:r.pageTitle})),[t,r]),x=(0,a.VK)((()=>{const e=h.default.state.currentSpaceStore;if(e&&t.isTopLevelPrivatePage({environment:n,spaceStore:e}))return(0,v.jsx)(c.FormattedMessage,{id:"AssistantEditHeader.pageEditInPrivate",defaultMessage:"{pageTitle}<span>{nbspThisIsASpacePleaseIgnore}in{nbspThisIsASpacePleaseIgnore}{icon}Private</span>",values:{nbspThisIsASpacePleaseIgnore:(0,v.jsx)("span",{children:""}),pageTitle:u,icon:(0,l.b)(r.customIcon),span:e=>(0,v.jsx)("span",{style:r.fixedSpan,children:e})}});if(e&&t.isSharedPage(e,n))return(0,v.jsx)(c.FormattedMessage,{id:"AssistantEditHeader.pageEditInShared",defaultMessage:"{pageTitle}<span>{nbspThisIsASpacePleaseIgnore}in{nbspThisIsASpacePleaseIgnore}{icon}Shared</span>",values:{nbspThisIsASpacePleaseIgnore:(0,v.jsx)("span",{children:""}),pageTitle:u,icon:(0,d.f)(r.customIcon),span:e=>(0,v.jsx)("span",{style:r.fixedSpan,children:e})}});{const e=t.getParentStore();if(e&&(0,m.JL)(e)&&!(e instanceof f.T5||e instanceof f.Xr)){const t=e.getIcon(),n=e instanceof f.G&&e.isEmptyPage();return(0,v.jsx)(c.FormattedMessage,{id:"AssistantEditHeader.pageEditInLocation",defaultMessage:"{pageTitle}<span>{nbspThisIsASpacePleaseIgnore}in{nbspThisIsASpacePleaseIgnore}</span>{parentLocation}",values:{nbspThisIsASpacePleaseIgnore:(0,v.jsx)("span",{children:""}),pageTitle:u,parentLocation:(0,v.jsxs)("div",{style:r.parentPageWrap,children:[(0,v.jsx)(p.Z,{disabled:!0,icon:t,isEmptyPage:n,size:18}),(0,v.jsx)(g.Z,{store:e})]}),span:e=>(0,v.jsx)("span",{style:r.fixedSpan,children:e})}})}return u}}),[n,t,u,r]);return(0,v.jsx)("div",{style:r.wrap,children:x})}},96653:(e,t,n)=>{n.d(t,{y:()=>ve,E:()=>Se});var s=n(667294),i=n(800480),a=n(724405),o=n(433463),r=n(421202),l=n(401898),d=n(137810),c=n(206258),u=n(7493),p=(n(252262),n(324506),n(365820)),g=n(733993),m=n(886628),h=n(399036),f=n(471924),y=n(709291),x=n(653965),v=n(608055),S=n(761045),b=n(623063),C=n(489728),j=n(526388),k=n(414200),w=n(212534),I=n(98742),M=n(645010),T=n(825464),A=n(80444),P=n(62740),B=n(798180),_=n(188923),F=n(237074),Z=n(423577),V=n(458281),R=n(682190),L=(n(21703),n(541432)),E=n(407057),K=n(664962),O=n(761075),D=n(842875),W=n(959753),H=n(519889),N=n(76233),z=n(95477);function U(){return Promise.reject(new Error("Async rendering not supported"))}const G={text:U,header:U,sub_header:U,sub_sub_header:U,quote:U,bulleted_list:U,toggle:U,to_do:U,numbered_list:U,code:U,page:U,image:U,video:U,embed:U,bookmark:U,file:U,tweet:U,maps:U,gist:U,framer:U,invision:U,mixpanel:U,drive:U,figma:U,loom:U,pdf:U,typeform:U,codepen:U,audio:U,divider:U,equation:U,collection_view:U,collection_view_page:U,column_list:U,column:U,factory:U,copy_indicator:U,breadcrumb:U,link_to_collection:U,link_to_page:U,table_of_contents:U,callout:U,whimsical:U,miro:U,abstract:U,sketch:U,excalidraw:U,replit:U,alias:U,transclusion_container:U,transclusion_reference:U,external_object_instance:U,table:U,table_row:U,tab:U,hex:U,deepnote:U,external_object_instance_page:U,button:U,ai_block:U,drawing:U,personal_home_page:U,form:U},q={[N.GKr.Page]:e=>{let{annotation:t,exportArgs:n}=e;const s=W.om.fromGetRecordValueFn(n.getRecordValue),i=N.TOT(t);if(!s({table:r.iU,id:i}))return;return`@${(0,O.Ho)({intl:n.intl,blockId:i,getRecordValue:n.getRecordValue,userTimeZone:n.userTimeZone})}`},[N.GKr.CustomEmoji]:e=>{let{annotation:t,exportArgs:n}=e;const s=W.om.fromGetRecordValueFn(n.getRecordValue),i=N.PtE(t);var a;if(i)return null===(a=s(i))||void 0===a?void 0:a.getRenderTitle()},[N.GKr.User]:e=>{let{annotation:t,exportArgs:n}=e;const{intl:s}=n,i=W.om.fromGetRecordValueFn(n.getRecordValue),a=N.zEN(t),o=i({table:H.KJ,id:a});return`@${null==o?void 0:o.getFullName(s)}`},[N.GKr.Group]:e=>{let{annotation:t,exportArgs:n}=e;return(0,O.kF)({annotation:t,exportArgs:n})},[N.GKr.LinkMention]:e=>{let{annotation:t}=e;return N.r0m(t).href},[N.GKr.Date]:e=>{let{annotation:t,exportArgs:n}=e;const{date_format:s,time_format:i,...a}=N.zyO(t);return`@${(0,E.ZV)({value:a,date_format:s,time_format:i,userTimeZone:n.userTimeZone,allowRelativeDates:!1,intl:n.intl})}`},[N.GKr.Equation]:K.O.annotationRenderers[N.GKr.Equation],[N.GKr.ExternalObjectInstance]:O.Hf,[N.GKr.Link]:O.Hf,[N.GKr.Bot]:O.Hf,[N.GKr.Comment]:O.Hf,[N.GKr.Bold]:O.Hf,[N.GKr.Italic]:O.Hf,[N.GKr.Strike]:O.Hf,[N.GKr.Code]:O.Hf,[N.GKr.Highlight]:O.Hf,[N.GKr.Discussion]:O.Hf,[N.GKr.SuggestionInsertText]:O.Hf,[N.GKr.SuggestionRemoveText]:O.Hf,[N.GKr.SuggestionAnnotate]:O.Hf,[N.GKr.SuggestionUnannotate]:O.Hf,[N.GKr.Underline]:O.Hf,[N.GKr.Inserted]:O.Hf,[N.GKr.Deleted]:O.Hf,[N.GKr.TemporaryComment]:O.Hf,[N.GKr.TemporaryCursor]:O.Hf,[N.GKr.TemporaryEquation]:O.Hf,[N.GKr.TemporaryPage]:O.Hf,[N.GKr.TemporaryInput]:O.Hf,[N.GKr.TemporarySelection]:O.Hf,[N.GKr.TemporaryFindHighlight]:O.Hf,[N.GKr.TemporarySelectedFindHighlight]:O.Hf,[N.GKr.TemplateVariable]:O.Hf,[N.GKr.FormulaPageProperty]:O.Hf,[N.GKr.FormulaContextValue]:O.Hf,[N.GKr.FormulaError]:O.Hf,[N.GKr.Citation]:O.Hf,[N.GKr.TemporaryNativeMABFilter]:O.Hf,[N.GKr.TemporaryDictation]:O.Hf,[N.GKr.TemporaryHighlight]:O.Hf,[N.GKr.AssistantInstructionsCollection]:O.Hf};function $(){}const Q={title:$,text:$,select:$,multi_select:$,status:$,relation:$,rollup:$,url:$,email:$,phone_number:$,checkbox:$,person:$,number:$,date:$,file:$,formula:$,created_time:$,last_edited_time:$,created_by:$,last_edited_by:$,button:$,auto_increment_id:$,last_visited_time:$,location:$,verification:$};function Y(e,t){return(0,O.hJ)({textValue:e,exportArgs:t,renderers:ee,fromString:e=>e}).join("")}function X(){return e=>{let{block:t,exportArgs:n}=e;return Y(W.kk.fromBlock(t).getProperty("title"),n)}}function J(){return""}const ee={blockRenderers:{text:X(),header:X(),sub_header:X(),sub_sub_header:X(),quote:X(),bulleted_list:X(),toggle:X(),to_do:X(),numbered_list:X(),code:X(),page:X(),image:J,video:J,embed:J,bookmark:J,file:J,tweet:J,maps:J,gist:J,framer:J,invision:J,mixpanel:J,drive:J,figma:J,loom:J,pdf:J,typeform:J,codepen:J,audio:J,divider:J,equation:J,collection_view:J,collection_view_page:J,column_list:J,column:J,factory:J,copy_indicator:J,breadcrumb:J,link_to_collection:J,link_to_page:J,table_of_contents:J,callout:X(),whimsical:J,miro:J,abstract:J,sketch:J,excalidraw:J,replit:J,alias:J,transclusion_container:J,transclusion_reference:J,external_object_instance:J,table:J,table_row:e=>{let{block:t,exportArgs:n}=e;const s=W.om.fromGetRecordValueFn(n.getRecordValue),i=W.kk.fromBlock(t),a=i.getParentPointer();if(a.table!==r.iU)return;const o=s(a);if(!o||!o.isType(L.Ti.table))return;return(o.getFormatValue("table_block_column_order")??[]).map((e=>Y(i.getProperty(e),n))).filter((e=>e)).join(" ")},tab:J,hex:J,deepnote:J,external_object_instance_page:J,button:J,ai_block:J,drawing:J,personal_home_page:J,form:J},asyncBlockRenderers:G,annotationRenderers:q,propertyRenderers:Q};var te=n(173435),ne=n(785893);const se=(0,y.defineMessages)({added:{id:"assistantGroupedEditsRenderer.added",defaultMessage:"Added"},updated:{id:"assistantGroupedEditsRenderer.updated",defaultMessage:"Edited"},removed:{id:"assistantGroupedEditsRenderer.removed",defaultMessage:"Deleted"},updatedPageProperties:{id:"assistantGroupedEditsRenderer.updatedPageProperties",defaultMessage:"{total, plural, one {Updated property} other {Updated properties}}"},updatedTitle:{id:"assistantGroupedEditsRenderer.updateTitle",defaultMessage:"Updated title"},viewEditInPageTooltip:{id:"assistantGroupedEditsRenderer.viewEditsInPageTooltipLabel",defaultMessage:"View edit in page"},numberOfPendingEdits:{id:"assistantGroupedEditsRenderer.numberOfPendingEdits",defaultMessage:"{numberOfEdits, plural, one {1 pending edit} other {{numberOfEdits} pending edits}}"}});function ie(e){const{group:t,pageStore:n}=e,i=(0,a.yK)((e=>({wrap:{display:"flex",flexDirection:"column",padding:"0 10px",gap:6},groupedEditListWrap:{display:"flex",flexDirection:"column",overflow:"hidden"},groupedEditList:{display:"flex",flexDirection:"column",borderTop:`1px solid ${e.regularDividerColor}`,marginTop:6,paddingTop:6}})),[]),[o,r]=(0,s.useState)(!0),[l,d]=(0,s.useState)(!1),c=(0,s.useCallback)((e=>{r(e),d(!0)}),[]);return(0,ne.jsxs)(V.F,{group:t,children:[(0,ne.jsx)(ae,{group:t,pageStore:n,editsExpanded:o,setEditsExpanded:c}),(0,ne.jsx)(p.M,{children:o&&(0,ne.jsx)(g.E.div,{style:i.groupedEditListWrap,initial:!!l&&{height:0},animate:{height:"auto"},exit:{height:0},children:(0,ne.jsx)("div",{style:i.groupedEditList,children:t.groupedEdits.map(((e,t)=>(0,ne.jsx)(oe,{edit:e,pageStore:n},t)))})})})]})}function ae(e){const{group:t,pageStore:n,editsExpanded:o,setEditsExpanded:r}=e,l=(0,i.O7)(),d=(0,m.VK)((()=>{var e;return Boolean(null===(e=B.default.getActiveSession())||void 0===e?void 0:e.isStreaming())}),[]),c=(0,a.yK)((()=>({acceptRejectButtons:{padding:"0 6px",visibility:d?"hidden":"visible"}})),[d]),u=(0,s.useMemo)((()=>t.groupedEdits.flatMap((e=>e.operationIds))),[t]),p=(0,s.useCallback)((async()=>{const e=B.default.getActiveSession();e&&await(0,F.acceptEdits)({environment:l,sessionContext:e,inferenceId:f.Il(),operationIds:u,operationContext:(0,Z.iD)()})}),[l,u]),g=(0,s.useCallback)((async()=>{const e=B.default.getActiveSession();e&&await(0,F.rejectEdits)({environment:l,sessionContext:e,inferenceId:f.Il(),operationIds:u})}),[l,u]),h=t.groupedEdits.length;return(0,ne.jsx)(R._C,{pageStore:n,rightSide:(0,ne.jsxs)("div",{style:c.acceptRejectButtons,children:[(0,ne.jsx)(te.aT,{onClick:p,variant:"all"}),(0,ne.jsx)(te.Sj,{onClick:g,variant:"all"})]}),showLocationIfNotCurrentPage:!0,detail:(0,ne.jsx)(R.GN,{label:(0,ne.jsx)(y.FormattedMessage,{...se.numberOfPendingEdits,values:{numberOfEdits:h}}),expanded:o,onClick:()=>r(!o)})})}function oe(e){const{edit:t,pageStore:n}=e,s=(0,te.JD)(n.id);return"insertedBlocks"===t.type||"removedBlocks"===t.type||"updatedBlocks"===t.type?s?(0,ne.jsx)(me,{edit:t,pageStore:n}):(0,ne.jsx)(ge,{edit:t,pageStore:n}):"updatedProperties"===t.type?(0,ne.jsx)(ce,{edit:t,pageStore:n}):"updatedTitle"===t.type?(0,ne.jsx)(de,{edit:t,pageStore:n}):void(0,l.t1)(t)}function re(e){const{edit:t,children:n,onClick:i,isCompact:o}=e,r=(0,a.yK)((e=>({wrap:{display:"flex",height:o?32:"initial",margin:"0 6px",padding:"6px 6px",borderRadius:8,position:"relative",...o?{flexDirection:"row",alignItems:"center",justifyContent:"space-between"}:{flexDirection:"column",alignItems:"initial"}}})),[o]),[l,d]=(0,s.useState)(!1),[c,u]=(0,s.useState)(!1),p=(0,m.VK)((()=>P.Z.state.hoveredEditId===t.editId),[t]),g=l||p,h=(0,s.useCallback)((()=>{P.Z.setState({...P.Z.state,hoveredEditId:t.editId}),d(!0),u(!0)}),[t]),f=(0,s.useCallback)((()=>{P.Z.setState({...P.Z.state,hoveredEditId:void 0}),d(!1),u(!1)}),[]);return(0,ne.jsx)(j.Z,{forceVisibleState:c,placement:T.u.Top,alignment:T.v.Start,renderTooltip:()=>(0,ne.jsx)(y.FormattedMessage,{...se.viewEditInPageTooltip}),render:s=>(0,ne.jsxs)(C.Z,{...(0,I.Z)(s,{onMouseEnter:h,onMouseLeave:f}),style:r.wrap,onClick:i,hovered:g,eventContextForClick:w.Af.AssistantGroupedEditClick,children:[!o&&(0,ne.jsx)(le,{headerComp:e.headerComp,headerColor:e.headerColor}),n,(0,ne.jsx)(he,{isCompact:o,setViewEditInPageToolTipVisible:()=>{u(!1)},edit:t,visible:!!o||l})]})})}function le(e){const{headerComp:t,headerColor:n}=e,s=(0,i.Fy)(),o=(0,a.yK)((e=>({wrap:{color:"insert"===n||"update"===n?e.accentColors.uiBlue[600]:"remove"===n?e.text.tertiary:(0,l.t1)(n),fontWeight:d.Z.fontWeight.medium,fontSize:s.isMobile?d.Z.fontSize.UISmall.mobile:d.Z.fontSize.UISmall.desktop}})),[s,n]);return(0,ne.jsx)("div",{style:o.wrap,children:t})}function de(e){const{edit:t,pageStore:n}=e,s=(0,y.useIntl)(),i=(0,h.Kc)(s).title,a=(0,m.VK)((()=>n.getTitleValue()),[n]),o=(0,m.VK)((()=>n.getSpaceId()),[n]),r=ue({pageStore:n});return i?(0,ne.jsx)(re,{isCompact:!1,edit:t,headerColor:"insert",onClick:r,headerComp:(0,ne.jsx)(y.FormattedMessage,{...se.updatedTitle}),children:(0,ne.jsx)(k.Z,{propertySchema:i,rootStore:n,value:{value:a,spaceId:o}})}):null}function ce(e){const{edit:t,pageStore:n}=e,s=(0,m.VK)((()=>{const e=n.getAssociatedCollectionStore(),s=null==e?void 0:e.getSchema();return x.oA(Array.from(t.propertyNames).map((e=>{const t=Object.entries(s||{}).find((t=>{let[,n]=t;return(null==n?void 0:n.name)===e}));if(t)return t[0]})))}),[t,n]),i=ue({pageStore:n});return(0,ne.jsx)(re,{isCompact:!1,edit:t,headerColor:"insert",onClick:i,headerComp:(0,ne.jsx)(y.FormattedMessage,{...se.updatedPageProperties,values:{total:s.length}}),children:s.map(((e,t)=>(0,ne.jsx)(te.Z9,{pageStore:n,property:e},t)))})}function ue(e){const{pageStore:t}=e,n=(0,i.O7)(),a=(0,te.JD)(t.id),o=(0,m.VK)((()=>{var e;return _.default.state.open&&_.default.state.targetStore.id===t.id?M.Z.PeekViewScroller:(null===(e=A.default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.id)===t.id?M.Z.PageScroller:void 0}),[t]),r=(0,te.Dc)(t);return(0,s.useCallback)((()=>{a?null==o||o.scrollToTop({animate:!0}):v.c4({environment:n,url:r})}),[a,o,n,r])}function pe(e){const{edit:t,pageStore:n}=e,a=(0,i.O7)(),o=(0,te.JD)(n.id),r=(0,te.Dc)(n,{scrollToBlockId:"insertedBlocks"===t.type||"updatedBlocks"===t.type?[...t.blockIds].at(0):"removedBlocks"===t.type?void 0:(0,l.t1)(t)});return(0,s.useCallback)((()=>{o?"insertedBlocks"===t.type||"updatedBlocks"===t.type?S.hl(Array.from(t.blockIds),!0):"removedBlocks"===t.type||(0,l.t1)(t):v.c4({environment:a,url:r})}),[t,a,o,r])}function ge(e){const{edit:t,pageStore:n}=e,i=(0,y.useIntl)(),o=(0,te.JD)(n.id),r=(0,a.yK)((e=>{const t="linear-gradient(180deg, black 0, black 30px, transparent 100%)";return{blockListWrap:{marginLeft:-2,marginRight:-2,marginBottom:-4,lineHeight:"1.1rem",...o?{maxHeight:60,overflowY:"hidden",WebkitMaskImage:t,maskImage:t}:{}}}}),[o]),d=pe(e),c=(0,m.VK)((()=>n.getSpaceId()),[n]),u=(0,s.useMemo)((()=>[...t.blockIds]),[t.blockIds]);let p,g;return"insertedBlocks"===t.type?(p="insert",g=i.formatMessage(se.added)):"updatedBlocks"===t.type?(p="update",g=i.formatMessage(se.updated)):"removedBlocks"===t.type?(p="remove",g=i.formatMessage(se.removed)):(0,l.t1)(t),(0,ne.jsx)(re,{isCompact:!1,edit:t,headerColor:p,headerComp:g,onClick:d,children:(0,ne.jsx)("div",{style:r.blockListWrap,children:(0,ne.jsx)(te.GD,{parentStore:n,spaceId:c,blockIds:u,shouldReverse:!1})})})}function me(e){const{edit:t}=e,n=(0,i.O7)(),o=(0,y.useIntl)(),c=(0,a.yK)((e=>({inner:{...d.Z.textOverflowStyle,color:e.text.secondary,fontSize:13},bold:{fontWeight:d.Z.fontWeight.medium,color:e.text.primary}})),[]),u=pe(e),p=(0,m.VK)((()=>{var e;return null===(e=A.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),g=(0,m.VK)((()=>{if("removedBlocks"===t.type)return n.defaultRecordCache.inMemoryRecordCache;if("insertedBlocks"===t.type||"updatedBlocks"===t.type){const e=B.default.getActiveSession();return null==e?void 0:e.caches.updatesCache}(0,l.t1)(t)}),[n,t]),[h,f]=(0,s.useState)("");(0,s.useEffect)((()=>{if(!g||!p)return;const e=g,s=[...t.blockIds].map((e=>({id:e,table:r.iU,spaceId:p})));function i(){const t=s.map((t=>function(e){const{intl:t,pointer:n,getRecordValue:s}=e,i={root:n,navigableBlockId:n.id,renderParentBlockId:void 0,blockId:n.id,userTimeZone:(0,D.r)(),intl:t,getRecordValue:s,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>"",baseUrl:z.default.domainBaseUrl,publicDomainName:z.default.publicDomainName,resultCache:new Map};return(0,O._2)({exportArgs:{...i},renderers:ee})}({intl:o,pointer:t,getRecordValue:e.makeGetRecordValueFn(n.currentUser.id,{ignoreAllCaches:!0})})));f(o.formatList(x.oA(t),{type:"unit"}))}i();for(const t of s)g.addListenerToRecord(t,i);return()=>{for(const e of s)g.removeListenerToRecord(e,i)}}),[g,t,n,o,p]);const v=(0,s.useCallback)((e=>(0,ne.jsx)("span",{style:c.bold,children:e})),[c]);return(0,ne.jsx)(re,{isCompact:!0,edit:t,onClick:u,children:(0,ne.jsx)("div",{style:c.inner,children:"updatedBlocks"===t.type?h?(0,ne.jsx)(y.FormattedMessage,{id:"assistantGroupedEditsRenderer.editedCompact",defaultMessage:"<bold>Edited:</bold>{text}",values:{bold:v,text:h}}):(0,ne.jsx)(y.FormattedMessage,{id:"assistantGroupedEditsRenderer.editedCompactNoText",defaultMessage:"<bold>Edited</bold>",values:{bold:v}}):"insertedBlocks"===t.type?h?(0,ne.jsx)(y.FormattedMessage,{id:"assistantGroupedEditsRenderer.insertedCompact",defaultMessage:"<bold>Added:</bold>{text}",values:{bold:v,text:h}}):(0,ne.jsx)(y.FormattedMessage,{id:"assistantGroupedEditsRenderer.insertedCompactNoText",defaultMessage:"<bold>Added</bold>",values:{bold:v}}):"removedBlocks"===t.type?h?(0,ne.jsx)(y.FormattedMessage,{id:"assistantGroupedEditsRenderer.removedCompact",defaultMessage:"<bold>Deleted:</bold>{text}",values:{bold:v,text:h}}):(0,ne.jsx)(y.FormattedMessage,{id:"assistantGroupedEditsRenderer.removedCompactNoText",defaultMessage:"<bold>Deleted:</bold>",values:{bold:v}}):(0,l.t1)(t)})})}function he(e){const{edit:t,visible:n,setViewEditInPageToolTipVisible:o,isCompact:r}=e,l=(0,i.O7)(),d=(0,a.yK)((e=>({wrap:{display:"flex",alignItems:"center",flexShrink:0,...r?{}:{background:e.contentBackground,position:"absolute",top:6,right:8,boxShadow:e.lightBoxShadow,borderRadius:6}},leftButton:{...r?{}:{borderTopLeftRadius:6,borderTopRightRadius:0,borderBottomLeftRadius:6,borderBottomRightRadius:0}},rightButton:{...r?{}:{borderTopLeftRadius:0,borderTopRightRadius:6,borderBottomLeftRadius:0,borderBottomRightRadius:6}}})),[r]),c=(0,m.VK)((()=>{var e;return Boolean(null===(e=B.default.getActiveSession())||void 0===e?void 0:e.isStreaming())}),[]),u=n&&!c,p=(0,s.useCallback)((async()=>{const e=B.default.getActiveSession();e&&await(0,F.acceptEdits)({environment:l,sessionContext:e,inferenceId:f.Il(),operationIds:t.operationIds,operationContext:(0,Z.iD)()})}),[l,t]),g=(0,s.useCallback)((async()=>{const e=B.default.getActiveSession();e&&await(0,F.rejectEdits)({environment:l,sessionContext:e,inferenceId:f.Il(),operationIds:t.operationIds})}),[l,t]);return(0,ne.jsx)(b.Z,{isVisible:!0,animationStyle:{opacity:u?1:0},render:()=>(0,ne.jsxs)("div",{style:d.wrap,onMouseEnter:o,children:[(0,ne.jsx)(te.aT,{style:d.leftButton,onClick:p}),(0,ne.jsx)(te.Sj,{style:d.rightButton,onClick:g})]})})}var fe=n(836993);function ye(e){const{group:t,pageStore:n}=e;return(0,ne.jsx)(V.Y,{children:(0,ne.jsx)(xe,{group:t,pageStore:n})})}function xe(e){const{group:t,pageStore:n}=e,o=(0,i.O7)(),r=(0,m.VK)((()=>{var e;return Boolean(null===(e=B.default.getActiveSession())||void 0===e?void 0:e.isStreaming())}),[]),l=(0,a.yK)((()=>({acceptRejectButtons:{padding:"0 6px",visibility:r?"hidden":"visible"},titleWrap:{display:"flex",alignItems:"center",cursor:"default",overflow:"hidden"},titleMessage:{lineHeight:1.2,paddingLeft:4},pageTitleButton:{flex:"1 1 auto"}})),[r]),d=(0,s.useCallback)((async()=>{const e=B.default.getActiveSession();e&&await(0,F.acceptEdits)({environment:o,sessionContext:e,inferenceId:f.Il(),operationIds:t.operationIds,operationContext:(0,Z.iD)()})}),[o,t]),c=(0,s.useCallback)((async()=>{const e=B.default.getActiveSession();e&&await(0,F.rejectEdits)({environment:o,sessionContext:e,inferenceId:f.Il(),operationIds:t.operationIds})}),[o,t]);return(0,ne.jsx)(R._C,{pageStore:n,renderTitle:()=>(0,ne.jsx)("div",{style:l.titleWrap,children:(0,ne.jsx)(y.FormattedMessage,{id:"AssistantPageRemovedGroup.title",defaultMessage:"<message>Delete</message>{pageTitle}",values:{message:e=>(0,ne.jsx)("div",{style:l.titleMessage,children:e}),pageTitle:(0,ne.jsx)(fe.c,{pageStore:n,style:l.pageTitleButton})}})}),rightSide:(0,ne.jsxs)("div",{style:l.acceptRejectButtons,children:[(0,ne.jsx)(te.aT,{onClick:d,variant:"single"}),(0,ne.jsx)(te.Sj,{onClick:c,variant:"single"})]}),showLocationIfNotCurrentPage:!1})}function ve(e){const{operations:t,parentStore:n,parentSpaceId:r}=e,l=(0,i.Fy)(),c=(0,s.useMemo)((()=>(0,o.rn)(t)),[t]),u=(0,a.yK)((e=>({wrap:{fontSize:l.isMobile?d.Z.fontSize.UIRegular.mobile:d.Z.fontSize.UIRegular.desktop,display:"flex",flexDirection:"column",gap:8}})),[l]);return(0,ne.jsx)("div",{style:u.wrap,children:c.map(((e,t)=>(0,ne.jsx)(Se,{group:e,parentStore:n,parentSpaceId:r},t)))})}function Se(e){const{group:t,parentStore:n,parentSpaceId:s}=e,i=c.G.createChildStore(n,{table:r.iU,id:t.pageId,spaceId:s});return"updatedPage"===t.type?t.didCreatePage?(0,ne.jsx)(u.N,{group:t,pageStore:i}):(0,ne.jsx)(ie,{group:t,pageStore:i}):"removedPage"===t.type?(0,ne.jsx)(ye,{group:t,pageStore:i}):void(0,l.t1)(t)}},7493:(e,t,n)=>{n.d(t,{N:()=>V,d:()=>O});var s=n(294184),i=n.n(s),a=n(667294),o=n(800480),r=n(886628),l=n(724405),d=n(650209),c=n(130134),u=n(471924),p=n(709291),g=n(653965),m=n(401898),h=n(608055),f=n(623063),y=n(573063),x=n(526388),v=n(566890),S=n(494043),b=n(343617),C=n(798180),j=n(925489),k=n(282136),w=n(237074),I=n(604489),M=n(693415),T=n(514387),A=n(557199),P=n(458281),B=n(682190),_=n(173435),F=n(785893);const Z=(0,p.defineMessages)({expandAriaLabel:{id:"AssistantEditHeader.expandAriaLabel",defaultMessage:"Expand page"}});function V(e){const{group:t,pageStore:n}=e,s=(0,o.O7)(),[i,l]=(0,a.useState)(!1),d=H({hovered:i}),c=(0,r.VK)((()=>n.getRenderableContentIds()),[n]),u=(0,r.VK)((()=>n.getSpaceId()),[n]),p=(0,_.Dc)(n),g=(0,a.useCallback)((()=>{h.c4({environment:s,url:p})}),[s,p]);return(0,F.jsx)(P.F,{onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),group:t,style:d.card,onClick:g,children:(0,F.jsxs)("div",{style:d.inner,children:[(0,F.jsx)(R,{group:t,pageStore:n}),(0,F.jsx)(D,{pageStore:n,hasContent:c.length>0}),c.length>0&&(0,F.jsx)("div",{style:d.blockListWrap,children:(0,F.jsx)(_.GD,{parentStore:n,spaceId:u,blockIds:c,shouldReverse:!1})})]})})}function R(e){const{pageStore:t,shouldHighlight:n,onExpandPageClick:s}=e,i=(0,o.O7)(),r=(0,_.Dc)(t),d=(0,l.yK)((()=>({header:{paddingTop:6,marginLeft:2}})),[]),c=(0,a.useCallback)((()=>{h.c4({environment:i,url:r}),null==s||s()}),[i,s,r]),u=(0,_.JD)(t.id),p=(0,a.useMemo)((()=>u?null:n?(0,F.jsx)(A.D,{withBrackground:!0,onReturnPressed:c,children:(0,F.jsx)(L,{shouldHighlight:n,pageStore:t,onExpandPageClick:s})}):(0,F.jsx)(L,{pageStore:t})),[u,s,t,n,c]);return(0,F.jsx)(B._C,{pageStore:t,style:d.header,afterTitle:e.group?(0,F.jsx)(E,{group:e.group,visible:!0}):void 0,rightSide:p,showLocationIfNotCurrentPage:!1})}function L(e){const{pageStore:t,onExpandPageClick:n,shouldHighlight:s}=e,i=(0,o.O7)(),r=(0,p.useIntl)(),l=(0,_.Dc)(t),c=(0,a.useCallback)((()=>{h.c4({environment:i,url:l}),null==n||n()}),[i,n,l]);return(0,F.jsx)(x.Z,{renderTooltip:()=>r.formatMessage(Z.expandAriaLabel),render:e=>(0,F.jsx)(y.Z,{ariaLabel:r.formatMessage(Z.expandAriaLabel),icon:d.c,onClick:c,isBlue:s,style:s?{borderRadius:"50%"}:void 0,...e})},"expand")}function E(e){const{group:t,visible:n}=e,s=(0,o.O7)(),[i]=(0,a.useState)((()=>u.Il())),d=(0,l.yK)((e=>({button:{color:e.v2.text.secondary,marginLeft:4,marginRight:4},iconStyle:{fill:e.v2.icon.secondary}})),[]),g=(0,I.E)({inferenceId:i,operationIds:t.operationIds}),h=(0,r.VK)((()=>{const e=C.default.getActiveSession();return!!e&&(0,m.$K)(e.getCollectionTargetForPendingPage({environment:s,pageId:t.pageId}))}),[s,t.pageId]),y=(0,a.useCallback)((async e=>{e.stopPropagation();const n=C.default.getActiveSession();n&&(h?await g():await(0,w.openMoveToMenuAndAcceptPagesCreated)({environment:s,groups:[t],sessionContext:n,originRectForMenu:e.currentTarget.getBoundingClientRect()}))}),[g,s,t,h]);return(0,F.jsx)(f.Z,{isVisible:!0,animationStyle:{opacity:n?1:0},render:()=>(0,F.jsx)(T.y,{icon:c.c,style:d.button,iconStyle:d.iconStyle,onClick:y,children:(0,F.jsx)(p.FormattedMessage,{id:"AssistantEditHeader.saveButton",defaultMessage:"Save"})})})}const K=130;function O(e){const{pageStore:t,shouldHighlightOpenPageButton:n,onExpandPageClick:s,truncatable:i}=e,d=(0,o.O7)(),[c,u]=(0,a.useState)(!1),p=H({hovered:c}),m=(0,l.yK)((()=>{const e=K,t=`linear-gradient(180deg, black 0, black ${e-30}px, transparent 100%)`;return{...p,fadeWrap:{position:"relative",display:"flex",flexDirection:"column",...i?{maxHeight:e,overflowY:"hidden",WebkitMaskImage:t,maskImage:t}:{}},expandOverlay:{bottom:8}}}),[p,i]),f=(0,r.VK)((()=>t.getRenderableContentIds()),[t]),y=(0,r.VK)((()=>t.getSpaceId()),[t]),x=(0,_.Dc)(t),v=(0,a.useRef)(null),S=(0,a.useCallback)((()=>{h.c4({environment:d,url:x}),null==s||s()}),[d,s,x]),[b,C]=(0,a.useState)(!1);(0,a.useEffect)((()=>{if(!v.current||!i)return;const e=new ResizeObserver((function(){if(!v.current)return;const e=getComputedStyle(v.current),t=parseFloat(e.getPropertyValue("padding-top")),n=parseFloat(e.getPropertyValue("padding-bottom")),s=g.i2(t)?0:t,i=g.i2(n)?0:n,a=v.current.clientHeight-s-i;C(a===K)}));return e.observe(v.current),()=>{e.disconnect()}}),[i]);const j=(0,a.useCallback)((()=>{u(!0)}),[]),k=(0,a.useCallback)((()=>{u(!1)}),[]);return(0,F.jsxs)(P.Y,{style:m.card,onClick:S,ref:v,onMouseEnter:j,onMouseLeave:k,children:[(0,F.jsxs)("div",{style:m.fadeWrap,children:[(0,F.jsx)(R,{pageStore:t,group:void 0,shouldHighlight:n,onExpandPageClick:s}),(0,F.jsxs)("div",{style:m.inner,children:[(0,F.jsx)(D,{pageStore:t,hasContent:f.length>0}),(0,F.jsx)("div",{style:m.blockListWrap,children:(0,F.jsx)(_.GD,{parentStore:t,spaceId:y,blockIds:f,shouldReverse:!1})})]})]}),b&&(0,F.jsx)(M.S,{variant:"open_page",onClick:S,style:m.expandOverlay,forceHover:c})]})}function D(e){const{pageStore:t,hasContent:n}=e,s=(0,r.VK)((()=>t.getAssociatedCollectionStore()),[t]);return s?(0,F.jsx)(W,{pageStore:t,collectionStore:s,hasContent:n}):null}function W(e){const{pageStore:t,collectionStore:n,hasContent:s}=e,r=(0,o.O7)(),d=(0,l.yK)((()=>({wrap:{marginLeft:6,marginRight:6}})),[]),c=(0,a.useMemo)((()=>new j.Z(r)),[r]);return(0,a.useEffect)((()=>{c.setContext({type:"collectionPage",collectionStore:n})}),[c,n]),(0,F.jsx)("div",{style:d.wrap,children:(0,F.jsx)(v.L1,{value:c,children:(0,F.jsx)(b.V,{context:k.S.PeekView,disabled:!1,store:t,customization:{hideSearch:!0,hideEmptyProperties:!0,neverShowNotionSystemProperties:!0,dontRenderIfNoPropertiesDefaultShown:!0,neverShowEmptyPropertiesIfMoreThanNProperties:20,sortNonEmptyPropertiesFirst:!0,assistantEditsPadding:!0,doNotShowPropertyGroups:!0},wrapper:e=>(0,F.jsx)(S.Pb,{className:i()({"layout-content-with-divider":s}),children:e})})})})}function H(e){const{hovered:t}=e;return(0,l.yK)((e=>({blockListWrap:{marginLeft:6,marginRight:6,padding:"0 6px"},inner:{display:"flex",flexDirection:"column",gap:2},card:{userSelect:"none",position:"relative",cursor:"pointer",marginTop:0,paddingTop:0,...t?{background:"light"===e.mode?e.cardHoveredBackground:e.accentColors.translucentGray[100]}:{},transition:"all .2s ease"}})),[t])}},173435:(e,t,n)=>{n.d(t,{Dc:()=>_,GD:()=>P,JD:()=>F,Sj:()=>V,Z9:()=>A,aT:()=>Z});var s=n(667294),i=n(800480),a=n(886628),o=n(815145),r=n(837167),l=n(213148),d=n(698519),c=n(600606),u=n(421202),p=n(709291),g=n(653965),m=n(401898),h=n(398530),f=n(926730),y=n(215201),x=n(573063),v=n(526388),S=n(411335),b=n(510102),C=n(484210),j=n(799445),k=n(80444),w=n(188923),I=n(206258),M=n(785893);const T=(0,p.defineMessages)({acceptEditsAriaLabel:{id:"assistantGroupedEditsRenderer.acceptEditsAriaLabel",defaultMessage:"Accept edits"},rejectEditsAriaLabel:{id:"assistantGroupedEditsRenderer.rejectEditsAriaLabel",defaultMessage:"Discard edits"},acceptAllEdits:{id:"assistantGroupedEditsRenderer.acceptAllEdits",defaultMessage:"Accept all edits"},rejectAllEdits:{id:"assistantGroupedEditsRenderer.rejectAllEdits",defaultMessage:"Discard all edits"},acceptSingleEdit:{id:"assistantGroupedEditsRenderer.acceptSingleEdit",defaultMessage:"Accept edit"},rejectSingleEdit:{id:"assistantGroupedEditsRenderer.rejectSingleEdit",defaultMessage:"Discard edit"}});function A(e){const{pageStore:t,property:n}=e,s=function(e){const{blockStore:t,property:n}=e,s=(0,i.O7)();return(0,a.VK)((()=>{var e,i;const a=null===(e=s.defaultRecordCache.inMemoryRecordCache.getEntry({pointer:t.pointer,userId:s.currentUser.id},void 0,!0))||void 0===e||null===(e=e.value)||void 0===e?void 0:e.value;return null==a||null===(i=a.properties)||void 0===i?void 0:i[n]}),[s,t.pointer,n])}({blockStore:t,property:n}),o=(0,a.VK)((()=>t.getAssociatedCollectionStore()),[t]),r=(0,a.VK)((()=>{const e=null==o?void 0:o.getSchema(),t=Object.entries(e||{}).find((e=>{let[t]=e;return t===n}));return null==t?void 0:t[1]}),[o,n]),l=(0,a.VK)((()=>t.getPropertyValue(n)),[t,n]),d=(0,a.VK)((()=>null==o?void 0:o.getSpaceId()),[o]);return o&&r&&d?(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(h.Hq,{labeled:!0,name:r.name,type:r.type,icon:r.icon,style:{marginBottom:6},children:(0,M.jsx)(S.Z,{propertySchema:r,beforeValue:{value:s||[],spaceId:d},afterValue:{value:l||[],spaceId:d},rootStore:t})})}):null}function P(e){const{blockIds:t,parentStore:n,spaceId:i,shouldReverse:o}=e,r=o?g.d9(t).reverse():t,l=(0,s.useMemo)((()=>r.map((e=>I.G.createChildStore(n,{table:u.iU,id:e,spaceId:i})))),[r,n,i]),d=(0,a.VK)((()=>(0,j.AM)({blockIds:r,parentStore:n})),[r,n]);return(0,M.jsx)(y.O,{displayName:"AssistantBlockRenderer",disabled:!0,children:l.map(((e,t)=>(0,M.jsx)(B,{store:e,numberedLists:d},t)))})}function B(e){const{store:t,numberedLists:n}=e,s=(0,a.VK)((()=>(0,f.h)(t)),[t]),i=(0,a.SI)((()=>({depth:0,numberedListBlockIdsWithFormat:n.find((e=>e.some((e=>e.id===t.id))))??[]})),[n,t.id]);return s?(0,M.jsx)(s,{store:t,disabled:!0,isFirstItem:!1,isLastItem:!1,disableCommentMenu:!0,numberedListCounterStore:i,smallerHeaders:!0}):null}function _(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,i.O7)();return(0,a.VK)((()=>{const{route:s}=n.RouterStore.state;return"chat"===s.name?(0,r.tj)({pageId:e.id,pageVisitSource:o.tY.AIChat,scrollToBlockId:t.scrollToBlockId,isMobile:n.device.isMobile}):(0,C.ZP)({store:e,pageVisitSource:o.tY.AIChat,fullyQualified:!1,scrollToBlockId:t.scrollToBlockId})}),[e,n,t.scrollToBlockId])}function F(e){const t=(0,b.Io)();return(0,a.VK)((()=>{if(!t.canUseCurrentPageContext)return!1;const n={id:e,table:u.iU},{mainEditorCurrentBlockStore:s}=k.default.state;return!(!s||!c.dr.isEqualIdTable(s.pointer,n))||!(!w.default.state.open||!c.dr.isEqualIdTable(w.default.state.targetStore.pointer,n))}),[e,t])}function Z(e){const{style:t,onClick:n,variant:s}=e,i=(0,p.useIntl)();let a;(0,m.$K)(s)?"all"===s?a=T.acceptAllEdits:"single"===s?a=T.acceptSingleEdit:(0,m.t1)(s):a=T.acceptEditsAriaLabel;const o=i.formatMessage(a);return(0,M.jsx)(v.Z,{renderTooltip:()=>o,render:e=>(0,M.jsx)(x.Z,{ariaLabel:o,icon:d.k,onClick:n,style:t,...e})},"acceptEdits")}function V(e){const{style:t,onClick:n,variant:s}=e,i=(0,p.useIntl)();let a;(0,m.$K)(s)?"all"===s?a=T.rejectAllEdits:"single"===s?a=T.rejectSingleEdit:(0,m.t1)(s):a=T.rejectEditsAriaLabel;const o=i.formatMessage(a);return(0,M.jsx)(v.Z,{renderTooltip:()=>o,render:e=>(0,M.jsx)(x.Z,{style:t,ariaLabel:o,onClick:n,icon:l.U,...e})},"rejectEdits")}},400578:(e,t,n)=>{n.d(t,{Z:()=>Se,C:()=>ve});n(757658);var s=n(667294),i=n(800480),a=n(886628),o=n(116638),r=n(471924),l=n(709291),d=n(401898),c=n(301743),u=n(256940),p=n(268894),g=n(203386),m=n(568785),h=n(478140),f=n(953437),y=n(672495),x=n(460709),v=n(134232),S=n(80444),b=n(521273),C=n(798180),j=n(483627),k=n(863334),w=n(229798),I=n(252193),M=n(724199),T=n(55762),A=n(390837),P=n(443261),B=n.n(P),_=n(118466),F=n(217215),Z=n(842875),V=n(559054),R=n(421202),L=n(552275),E=n(632163),K=n(743765),O=n(511470),D=n(296994),W=n(206258),H=n(724405),N=n(841892),z=n(460651),U=n(731278),G=n(45653),q=n(274016),$=n(785893);function Q(e){const{item:t}=e,n=(0,a.VK)((()=>S.default.state.currentSpaceStore),[]),s=(0,a.VK)((()=>{var e;return null==n||null===(e=n.getModel())||void 0===e?void 0:e.getRenderIcon()}),[n]),i=(0,a.VK)((()=>{var e;return null==n||null===(e=n.getModel())||void 0===e?void 0:e.getRenderTitle()}),[n]),o=(0,a.VK)((()=>"everything"===t.type?{type:"everything",currentUserStore:S.default.state.currentUserStore}:"workspace"===t.type?{type:"workspace"}:"notion"===t.type?{type:"notion"}:"teamspace"===t.type?{type:"teamspace",teamStore:t.teamStore}:"page"===t.type||"collection"===t.type?{type:"page",pageStore:t.pageStore,icon:t.pageStore.getIcon(),isEmptyPage:t.pageStore.isEmptyPage()}:"slack"===t.type?{type:"slack"}:"helpdocs"===t.type?{type:"helpdocs"}:"google-drive"===t.type?{type:"google-drive"}:(0,d.t1)(t)),[t]),r=(0,H.yK)((()=>({icon:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,width:22,height:18,marginRight:4,position:"relative"}})),[]);return"everything"===o.type?(0,$.jsx)("div",{style:r.icon,children:(0,$.jsx)(G.Z,{size:16,userStore:o.currentUserStore})}):"workspace"===o.type?(0,$.jsx)("div",{style:r.icon,children:(0,$.jsx)(U.Z,{icon:s,title:i,isEmptyPage:!1,size:18,disabled:!0})}):"notion"===o.type?(0,$.jsx)("div",{style:r.icon,children:(0,z.h)({width:16,height:16})}):"teamspace"===o.type?(0,$.jsx)("div",{style:r.icon,children:(0,$.jsx)(q.p,{disabled:!0,store:o.teamStore,size:18})}):"page"===o.type?(0,$.jsx)("div",{style:r.icon,children:(0,$.jsx)(U.Z,{icon:o.icon,isEmptyPage:o.isEmptyPage,title:void 0,size:18,disabled:!0})}):"slack"===o.type?(0,$.jsx)("div",{style:r.icon,children:(0,$.jsx)("img",{width:16,src:N.Z.images.externalIntegrations.slackIconPng})}):"helpdocs"===o.type?(0,$.jsx)("div",{style:r.icon,children:(0,$.jsx)("img",{width:16,src:N.Z.images.notionLogoPng})}):"google-drive"===o.type?(0,$.jsx)("div",{style:r.icon,children:(0,$.jsx)("img",{width:16,src:N.Z.images.googleDriveLogoPng})}):(0,d.t1)(o)}var Y=n(16184),X=n(137810),J=n(776798);function ee(e){const{item:t}=e,n=(0,l.useIntl)(),s=(0,a.VK)((()=>S.default.state.mainEditorCurrentBlockStore),[]),i=(0,a.VK)((()=>{var e;return null===(e=S.default.state.currentSpaceStore)||void 0===e||null===(e=e.getModel())||void 0===e?void 0:e.getRenderTitle()}),[]),o=(0,a.VK)((()=>(0,T.dR)({item:t,mainEditorCurrentBlockStore:s,intl:n})),[t,s,n]),r=(0,H.yK)((e=>({lockIcon:{width:14,height:14,marginLeft:4,fill:e.mediumIconColor},recordTitle:{alignItems:"center",display:"flex",...X.Z.textOverflowStyle,minWidth:0,flex:1,marginRight:12},pageTitle:{...X.Z.textOverflowStyle,minWidth:0},lightText:{color:e.lightTextColor,whiteSpace:"nowrap"},hyphen:{display:"inline-block",marginLeft:4,marginRight:4}})),[]);return"everything"===o.type?(0,$.jsx)("div",{style:r.recordTitle,children:(0,$.jsx)(l.FormattedMessage,{id:"assistantScopedSearchMenu.everythingItem.title",defaultMessage:"Everything I can access"})}):"notion"===o.type?(0,$.jsx)("div",{style:r.recordTitle,children:(0,$.jsx)(l.FormattedMessage,{id:"assistantScopedSearchMenu.notionItem.title",defaultMessage:"Notion"})}):"slack"===o.type?(0,$.jsx)("div",{style:r.recordTitle,children:(0,$.jsx)(l.FormattedMessage,{id:"assistantScopedSearchMenu.slackItem.title",defaultMessage:"Slack"})}):"google-drive"===o.type?(0,$.jsx)("div",{style:r.recordTitle,children:(0,$.jsx)(l.FormattedMessage,{id:"assistantScopedSearchMenu.gdriveItem.title",defaultMessage:"Google Drive"})}):"helpdocs"===o.type?(0,$.jsx)("div",{style:r.recordTitle,children:(0,$.jsx)(l.FormattedMessage,{id:"assistantScopedSearchMenu.slackItem.dynamicNotionHelpTitle",defaultMessage:"Notion Help"})}):"workspace"===o.type?(0,$.jsx)("div",{style:r.recordTitle,children:(0,$.jsx)(l.FormattedMessage,{id:"assistantScopedSearchPageMenuItem.workspaceItem.label",defaultMessage:"<title>{spaceName}</title><light><spacearound></spacearound>Workspace</light>",values:{spaceName:i,title:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,$.jsx)("div",{style:r.pageTitle,children:t})},light:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,$.jsx)("div",{style:r.lightText,children:t})},spacearound:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,$.jsx)("div",{style:r.hyphen,children:t})}}})}):"teamspace"===o.type?"private"===o.accessLevel?(0,$.jsxs)("div",{style:r.recordTitle,children:[(0,$.jsx)(J.Z,{store:o.store}),(0,Y.Q)(r.lockIcon)]}):(0,$.jsx)("div",{style:r.recordTitle,children:(0,$.jsx)(J.Z,{store:o.store})}):"page"===o.type?o.isCurrentPage?(0,$.jsx)("div",{style:r.recordTitle,children:(0,$.jsx)(l.FormattedMessage,{id:"assistantScopedSearchPageMenuItem.currentPage.label",defaultMessage:"<title>{pageTitle}</title><light><spacearound></spacearound>Current page</light>",values:{pageTitle:o.title,title:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,$.jsx)("div",{style:r.pageTitle,children:t})},light:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,$.jsx)("div",{style:r.lightText,children:t})},spacearound:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,$.jsx)("div",{style:r.hyphen,children:t})}}})}):(0,$.jsx)("div",{style:r.recordTitle,children:(0,$.jsx)(J.Z,{store:o.store})}):(0,d.t1)(o)}const te=20,ne=(0,l.defineMessages)({everythingItemTitle:{id:"assistantScopedSearchMenu.everythingItem.title",defaultMessage:"Everything I can access"},workspaceFuzzyName:{id:"assistantScopedSearchMenu.workspaceItem.title",defaultMessage:"{workspaceName} workspace"},teamspaceFuzzyName:{id:"assistantScopedSearchMenu.teamspaceItem.label",defaultMessage:"Teamspace"},pageFuzzyName:{id:"assistantScopedSearchMenu.pageItem.label",defaultMessage:"Page"},databaseFuzzyName:{id:"assistantScopedSearchMenu.collectionItem.label",defaultMessage:"Database"},slackFuzzyName:{id:"assistantScopedSearchMenu.slackItem.label",defaultMessage:"Slack"},gdriveFuzzyName:{id:"assistantScopedSearchMenu.gdriveItem.label",defaultMessage:"Google Drive"},notionFuzzyName:{id:"assistantScopedSearchMenu.notionItem.label",defaultMessage:"Notion"}});function se(e){const{query:t,defaultMenuItems:n,teamSpaceMenuItems:s,menuListStore:o,onSelect:r,setIsLoading:c}=e,u=(0,i.O7)(),p=(0,l.useIntl)(),g=(0,a.VK)((()=>S.default.state.currentSpaceStore),[]),m=(0,a.VK)((()=>b.Z.canScopeToPagesTeamspacesAndDatabases()),[]),[{value:h}]=(0,V.r5)((async()=>{if(!m)return;if(!g)return;c(!0);const e=await D.FF.searchActions.load(),n=await e.searchPageIds({environment:u,query:t,limit:te,spaceId:g.id,requireEditPermissions:!1,excludeTemplates:!0,source:"assistant_scoped_search_menu",boostRecentlyViewedPages:!0});return c(!1),n.results.map((e=>W.G.createChildStore(g,{id:e,table:R.iU,spaceId:g.id}))).filter(T.uA)}),[t,u,g,c,m]),f=(0,a.VK)((()=>{const e=ie({intl:p,totalScopedMenuItems:n,userSearchQuery:t,currentSpaceStore:g}).map(((e,t)=>({key:ae(e,t),render:t=>(0,$.jsx)(L.Z,{...t,icon:(0,$.jsx)(Q,{item:e}),title:(0,$.jsx)(ee,{item:e})}),action:()=>{r(e)}})));if(e.length>0)return{key:"fuzzy default results",render:e=>(0,$.jsx)(y.Z,{...e}),items:e}}),[n,p,t,r,g]),x=(0,a.VK)((()=>{if(!m)return;const e=(h??[]).map(((e,t)=>{var n;const s=null===(n=e.getCollectionPointer())||void 0===n?void 0:n.id;let i;return i=e.isCollectionView()&&s?{type:"collection",pageStore:e,collectionId:s}:{type:"page",pageStore:e},{key:ae(i,t),render:e=>(0,$.jsx)(O.Z,{...e,store:i.pageStore}),action:()=>{r(i)}}}));return e.length>0?{key:"search results",render:e=>(0,$.jsx)(y.Z,{...e,title:(0,$.jsx)(l.FormattedMessage,{id:"assistantScopedSearchQueryResults.pageResults.section.title",defaultMessage:"Pages"})}),items:e}:void 0}),[m,h,r]),v=[f,(0,a.VK)((()=>{if(!m)return;const e=ie({intl:p,totalScopedMenuItems:s,userSearchQuery:t,currentSpaceStore:g}).map(((e,t)=>({key:ae(e,t),render:t=>(0,$.jsx)(O.Z,{...t,store:e.teamStore}),action:()=>{r(e)}})));return e.length>0?{key:"fuzzy teamspace results",render:e=>(0,$.jsx)(y.Z,{...e,title:(0,$.jsx)(l.FormattedMessage,{id:"assistantScopedSearchQueryResults.teamResults.section.title",defaultMessage:"Teamspaces"})}),items:e}:void 0}),[m,s,p,t,r,g]),x].filter(d.$K);return 0===v.length?(0,$.jsx)(y.Z,{children:(0,$.jsx)(K.Z,{title:(0,$.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"assistantScopeSearchQueryResults.noResults.label"})})}):(0,$.jsx)(E.Z,{type:E.i.Vertical,initialFocus:Boolean(t)?0:void 0,sections:v,store:o})}function ie(e){const{intl:t,totalScopedMenuItems:n,userSearchQuery:s,currentSpaceStore:i}=e;if(!s)return n;const a={extract:e=>_.Z.withListenerIgnored((()=>{if("everything"===e.type)return t.formatMessage(ne.everythingItemTitle);if("workspace"===e.type){var n;const e=(null==i||null===(n=i.getModel())||void 0===n?void 0:n.getRenderTitle())??"";return t.formatMessage(ne.workspaceFuzzyName,{workspaceName:e})}if("teamspace"===e.type){var s;return`${(null===(s=e.teamStore.getModel())||void 0===s?void 0:s.getRenderTitle())??""} ${t.formatMessage(ne.teamspaceFuzzyName)}`}if("page"===e.type){var a;const{pageStore:n}=e;return`${(null===(a=e.pageStore.getModel())||void 0===a?void 0:a.getRenderTitle({intl:t,userTimeZone:(0,Z.r)(),getRecordModel:n.getRecordModel}))??(0,F.Q2)(t)} ${t.formatMessage(ne.pageFuzzyName)}`}if("collection"===e.type){var o;const{pageStore:n}=e;return`${(null===(o=e.pageStore.getModel())||void 0===o?void 0:o.getRenderTitle({intl:t,userTimeZone:(0,Z.r)(),getRecordModel:n.getRecordModel}))??(0,F.Q2)(t)} ${t.formatMessage(ne.databaseFuzzyName)}`}return"slack"===e.type||"helpdocs"===e.type?t.formatMessage(ne.slackFuzzyName):"google-drive"===e.type?t.formatMessage(ne.gdriveFuzzyName):"notion"===e.type?t.formatMessage(ne.notionFuzzyName):(0,d.t1)(e)}))};return B().filter(s,n,a).map((e=>e.original))}function ae(e,t){return"everything"===e.type||"notion"===e.type||"slack"===e.type||"workspace"===e.type||"helpdocs"===e.type||"google-drive"===e.type?`${e.type}_${t.toString()}`:"teamspace"===e.type?`${e.type}_${e.teamStore.id}`:"page"===e.type||"collection"===e.type?`${e.type}_${e.pageStore.id}`:(0,d.t1)(e)}var oe=n(698519),re=n(164921),le=n(605210),de=n(35026);const ce=20,ue=14,pe=24;function ge(e){const{item:t,onClick:n,showToggle:r}=e,c=e.depth??0,u=(0,H.Fg)(),{isMobile:p}=(0,i.Fy)(),[g,m]=s.useState(!1),h=(0,a.VK)((()=>C.default.getActiveAssistantConfigurationStore()),[]),f=(0,a.VK)((()=>{var e;return(null==h||null===(e=h.state)||void 0===e?void 0:e.searchScope)??o.QA}),[h]),y=s.useMemo((()=>(0,T.MB)({scopeMenuItem:t,currentSearchScope:f})),[t,f]),x=s.useCallback((()=>{n(t)}),[n,t]),v=s.useCallback((()=>{m(!g)}),[g,m]),S=function(e){const{depth:t,isMobile:n}=e;return(0,H.yK)((e=>({outlinerItem:{display:"flex",flexDirection:"row",fontSize:14,height:28,paddingLeft:me(t),color:e.regularTextColor,alignItems:"center",...n&&{fontSize:16,height:56,backgroundColor:e.contentBackground,borderBottom:`1px ${e.darkDividerColor} solid`}},noChildrenLabelItem:{paddingLeft:me(t)+pe,fontSize:14,paddingBottom:6.5,color:e.lightTextColor,...n&&{paddingBottom:void 0,fontSize:16,height:56,backgroundColor:e.contentBackground,borderBottom:`1px ${e.darkDividerColor} solid`}},checkmarkIcon:{marginRight:12,color:e.lightIconColor,width:14,height:"auto",justifySelf:"right"}})),[t,n])}({depth:c,isMobile:p}),b=s.useMemo((()=>!!r&&("everything"!==t.type&&"workspace"!==t.type&&"slack"!==t.type&&"notion"!==t.type&&"helpdocs"!==t.type&&"google-drive"!==t.type&&("teamspace"===t.type||"page"===t.type||"collection"===t.type||(0,d.t1)(t)))),[t,r]),j=(0,a.VK)((()=>"everything"===t.type||"teamspace"===t.type||"workspace"===t.type||"slack"===t.type||"notion"===t.type||"helpdocs"===t.type||"google-drive"===t.type||("page"===t.type||"collection"===t.type?(0,T.uA)(t.pageStore):(0,d.t1)(t))),[t]),k=(0,a.VK)((()=>{const e=(0,T.t4)();return"everything"===t.type||"workspace"===t.type||"collection"===t.type||"slack"===t.type||"notion"===t.type||"helpdocs"===t.type||"google-drive"===t.type?[]:"teamspace"===t.type?t.teamStore.getTeamPageStores():"page"===t.type?(0,de.Q2)(t.pageStore,e,T.OW):(0,d.t1)(t)}),[t]),w=(0,a.VK)((()=>k.map((e=>(0,T.N$)(e)))),[k]);if(!j)return null;const I=0!==k.length?(0,$.jsx)($.Fragment,{children:w.map((e=>(0,$.jsx)(ge,{item:e,onClick:e=>n(e),depth:c+1,showToggle:r},e.pageStore.id)))}):(0,$.jsx)("div",{style:S.noChildrenLabelItem,children:(0,$.jsx)(l.FormattedMessage,{defaultMessage:"No pages inside",id:"assistantScopedSearchOutlinerItem.NoPagesInside.placeholder"})});return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(re.Z,{onClick:x,children:(0,$.jsxs)("div",{style:S.outlinerItem,children:[b&&(0,$.jsx)(le.Z,{isSidebar:!1,fill:!0,icon:"chevron",open:g,color:u.mediumIconColor,onClick:v}),(0,$.jsx)(Q,{item:t}),(0,$.jsx)(ee,{item:t}),y&&(0,oe.k)(S.checkmarkIcon)]})}),g&&c<ce&&I]})}function me(e){return(e+1)*ue}function he(e){const{defaultScopeMenuItems:t,teamSpaceMenuItems:n,onSelect:s}=e,i=(0,H.yK)((()=>({mobileSectionTitleStyle:{lineHeight:"14px"}})),[]),o=(0,a.VK)((()=>b.Z.canScopeToPagesTeamspacesAndDatabases()),[]);return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(y.Z,{mobileTitleStyle:i.mobileSectionTitleStyle,children:t.map(((e,t)=>(0,$.jsx)(ge,{showToggle:!1,item:e,onClick:e=>{s(e)}},`${e.type}_${t}`)))}),o&&(0,$.jsx)(y.Z,{mobileTitleStyle:i.mobileSectionTitleStyle,title:(0,$.jsx)(l.FormattedMessage,{id:"assistantScopedSearchSuggestedResults.teamspaces.title",defaultMessage:"Teamspaces and pages"}),children:n.map(((e,t)=>(0,$.jsx)(ge,{showToggle:!0,item:e,onClick:e=>{s(e)}},`${e.type}_${t}`)))})]})}const fe=300,ye=325,xe=(0,l.defineMessages)({inputPlaceholder:{id:"assistantScopedSearchMenu.inputMenuItem.placeholder",defaultMessage:"Find in"}});function ve(e){const{buttonPopupParent:t,onSelect:n,analyticsSource:p}=e,m=(0,i.O7)(),{isPhone:f}=(0,i.Fy)(),[v,j]=s.useState(""),[P,B]=s.useState(!1),_=(0,a.qz)(void 0,w.Z),F=(0,a.qz)(void 0,k.Z),Z=(0,a.VK)((()=>C.default.getActiveSession()),[]),V=(0,a.VK)((()=>(null==Z?void 0:Z.assistantConfigurationState.searchScope)??o.QA),[Z]),R=(0,a.VK)((()=>S.default.state.currentSpaceStore),[]),L=(0,a.VK)((()=>S.default.state.currentSpaceViewStore),[]),E=(0,a.VK)((()=>L?L.getTeamsStores().map((e=>({type:"teamspace",teamStore:e}))):[]),[L]),K=(0,a.VK)((()=>S.default.state.mainEditorCurrentBlockStore),[]),O=(0,a.VK)((()=>b.Z.canScopeToPagesTeamspacesAndDatabases()),[]),D=(0,a.VK)((()=>{const e=[{type:"everything"}];O&&K&&(0,T.uA)(K)&&e.push((0,T.N$)(K));const{connectedApps:t,inProgress:n}=A.y.state,s=b.Z.canShowUniversalSearchScopes()&&(null==t?void 0:t.includes("slack-admin"))&&!n,i=b.Z.canShowUniversalGoogleDriveSearchScope(),a=b.Z.canShowHelpdocsScope();s&&e.push({type:"slack"}),i&&e.push({type:"google-drive"}),(s||i||a)&&e.push({type:"notion"}),b.Z.canScopeToPublicWorkspace()&&e.push({type:"workspace"}),a&&e.push({type:"helpdocs"});return e.some((e=>(0,T.MB)({scopeMenuItem:e,currentSearchScope:V})))||!R?e:[...e,(0,T._h)({searchScope:V,currentSpaceStore:R})]}),[K,V,R,O]);s.useEffect((()=>(M.assistantAnalyticsActions.trackScopeSearchMenuOpen(m,{from:p}),()=>{M.assistantAnalyticsActions.trackScopeSearchMenuClose(m,{from:p})})),[m,p]);const W=s.useCallback((()=>{t.close()}),[t]),H=s.useCallback((e=>{j(e),_.update((e=>({...e,focus:{section:0,indexLocal:0,indexGlobal:0}})))}),[j,_]),N=s.useCallback((async e=>{let s;"everything"===e.type||"workspace"===e.type||"helpdocs"===e.type||"notion"===e.type||"slack"===e.type||"google-drive"===e.type?s=e:"teamspace"===e.type?s={type:e.type,teamId:e.teamStore.id}:"page"===e.type?s={type:e.type,pageId:e.pageStore.id}:"collection"===e.type?s={type:e.type,pageId:e.pageStore.id,collectionId:e.collectionId}:(0,d.t1)(e);let i=Z;if(i)i.assistantConfigurationStore.setSearchScope(s);else{var a;const{sessionId:e}=await(0,I.resetAndInitializeAssistantSession)({environment:m});i=C.default.getSessionContext(e),null===(a=i)||void 0===a||a.assistantConfigurationStore.setSearchScope(s)}if(i){i.createUpdater().write((e=>{e.commitPreviewingStep(),e.addClientStep({inferenceId:r.Il(),type:"assistantScopeChange",scope:s})}))}i&&"collection"===s.type&&await(0,I.appendLoadDatabaseStepForScopedSearch)({environment:m,assistantSessionContext:i,collectionId:s.collectionId}),M.assistantAnalyticsActions.trackScopeSearchToggle(m,{from:p,scope:s}),t.close(),null==n||n()}),[n,Z,t,m,p]);let z;const U=(0,$.jsx)(be,{onCancel:W,query:v,onChange:H,isLoading:P});let G;return z=f?U:(0,$.jsx)(y.Z,{isInput:!0,children:U}),G=f?{menuType:x.og.Modal,right:(0,$.jsx)(l.FormattedMessage,{defaultMessage:"Done",id:"assistantScopedSearch.rightDoneButton.label"}),onClickRight:W,header:z}:{menuType:x.og.Popup,width:fe,maxHeight:ye,header:z},(0,$.jsxs)(c.Z,{debugName:"AssistantScopedSearchMenuIgnore",capture:!0,children:[(0,$.jsx)(g.Z,{debugName:"AssistantScopedSearchMenu",capture:!0,onEsc:W}),(0,$.jsx)(u.Z,{store:F,ignoreBlockSelection:!1,capture:!0,restoreSelection:!0,render:()=>(0,$.jsx)(h.Z,{...G,children:v?(0,$.jsx)(se,{query:v,defaultMenuItems:D,teamSpaceMenuItems:E,menuListStore:_,onSelect:N,setIsLoading:B}):(0,$.jsx)(he,{defaultScopeMenuItems:D,teamSpaceMenuItems:E,onSelect:N})})})]})}function Se(){var e;const t=(0,a.VK)((()=>j.Z.state),[]);return t.open&&t.originComponent?(0,$.jsx)(f.ZP,{enableOutsideClickDismiss:!0,alignmentToOrigin:f.ZP.Alignment.Start,placementToOrigin:f.ZP.Placement.Left,originGap:8,onDismiss:()=>{j.Z.setState({...j.Z.state,open:!1})},open:t.open,originRect:null===(e=t.originComponent)||void 0===e?void 0:e.getBoundingClientRect(),popupType:f.kQ.Popup,render:()=>(0,$.jsx)(ve,{buttonPopupParent:{close:()=>{j.Z.setState({...j.Z.state,open:!1})}},analyticsSource:"find_in_action"})}):null}function be(e){const{isLoading:t,onCancel:n,query:s,onChange:a}=e,o=(0,l.useIntl)(),{isPhone:r}=(0,i.Fy)(),d=(0,v.Z)(t,400,0);return(0,$.jsx)(p.ZP,{style:{marginBottom:-2},onCancel:n,focus:!r||void 0,focusAfterAnimation:!0,focusInitial:!0,value:s,onChange:e=>{a(e.target.value)},placeholder:o.formatMessage(xe.inputPlaceholder),inputRight:d&&(0,$.jsx)(m.Z,{style:{marginRight:2}})})}},145443:(e,t,n)=>{n.d(t,{Zo:()=>Q,Dl:()=>ee,IW:()=>J,bi:()=>X});n(21703),n(757658);var s=n(667294),i=n(800480),a=n(886628),o=n(158573),r=n(559054),l=n(775e3),d=n(421202),c=n(606287),u=n(492338),p=n(76233),g=n(709291),m=n(653965),h=n(940470),f=n(401898),y=n(137231),x=n(210228),v=n(693405),S=n(568785),b=n(672495),C=n(628020),j=n(394841),k=n(675822),w=n(525286),I=n(596820),M=n(278159),T=n(80444),A=n(788632),P=n(269327),B=n(206258),_=n(724405),F=n(815047),Z=n(429369),V=n(137810),R=n(552275),L=n(731278),E=n(186176),K=n(776798),O=n(548779),D=n(785893);const W=s.forwardRef((function(e,t){const{store:n,caption:s,hoverIcon:i}=e,o=(0,_.yK)((e=>({rightIcon:{width:16,height:14,fill:e.lightIconColor}})),[]),r=(0,a.VK)((()=>s?(0,D.jsx)(N,{caption:s}):!(n instanceof B.zX)&&(0,E.Lk)(n)&&(0,D.jsx)(E.ZP,{store:n,showFullPathInTooltip:!0})),[s,n]);return(0,D.jsx)(R.Z,{...e,right:e.focused&&i?i(o.rightIcon):null,ref:t,title:(0,D.jsx)(K.Z,{store:n,maxLength:21}),icon:(0,D.jsx)(H,{store:n}),caption:r,className:"notranslate"})}));function H(e){let{store:t}=e;const n=(0,i.O7)(),s=(0,a.VK)((()=>t instanceof B.H2?(0,O.Wd)(n,t):t.getIcon()),[n,t]),o=(0,a.VK)((()=>t instanceof B.G&&t.isEmptyPage()),[t]),r=(0,a.VK)((()=>function(e,t){switch(e.table){case F.bx:return(0,O.rn)(t,e);case Z.e0:return e.getName();default:return}}(t,n)),[n,t]);return(0,D.jsx)(L.Z,{disabled:!0,icon:s,isEmptyPage:o,title:r,size:n.device.isMobile?24:20})}function N(e){const{caption:t}=e,n=(0,_.Fg)();return(0,D.jsx)("div",{style:{display:"flex",fontSize:V.Z.fontSize.UISmall.desktop,color:n.lightTextColor,overflow:"hidden"},children:t})}const z=(0,g.defineMessages)({openedPageLabel:{id:"action.openedPage.label",defaultMessage:"Opened page"},noItemsAvailable:{id:"assistantTypeAheadHelpers.noItemsAvailable",defaultMessage:"No items available"}});function U(e,t,n){const s=(0,r.r5)((async()=>{if(0===e.length)return{type:"empty",query:e};const n=await t(e);return{type:"results",query:e,value:n}}),[e,t],{debounce:n}),[i]=s;if("idle"===i.status)return{type:"empty",query:e,loading:!1};if("rejected"===i.status)return{type:"error",query:e,loading:!1};const a=i.value??{type:"empty",query:e};return"pending"===i.status?{...a,loading:!0}:{...a,loading:!1}}function G(e,t){if("error"===e.type&&"error"===t.type)return{serverResults:[],localResults:[]};const n="empty"===t.type||"error"===t.type?[]:t.value;if("empty"===e.type)return{serverResults:[],localResults:[]};if("error"===e.type)return{serverResults:n,localResults:[]};if("results"===e.type){const s=e.query!==t.query,i=0===e.value.length;return{serverResults:s&&!i?[]:n,localResults:e.value}}(0,f.t1)(e)}async function q(e){const{environment:t,searchQuery:n,blockTypes:s,currentSpaceStore:i,currentSpaceViewStore:a,limit:o}=e,r=await(0,I.S)({environment:t,currentSpaceStore:i,currentSpaceViewStore:a,excludeCurrentPage:!1}),l={query:{text:n,filters:(0,u.u4)({requireEditPermissions:!1,isDeletedOnly:!1,excludeTemplates:!0,navigableBlockContentOnly:!0,blockTypes:s}),sort:{field:"relevance"}},limit:o},d=(0,w.Y)({query:l,localCachedPages:r,parentStore:i,isOnline:A.Z.state.online,environment:t,shouldLimitLocalResultsWhenOnline:!1,applyScoreThresholdWhenOnline:!0,canUseLtr:!1});return d&&h.x.isSuccess(d)?d.value.results.filter((e=>e.store.pathIsAccessibleAndAlive())):[]}function $(e){const{record:t,action:n,caption:s}=e;return{key:t.id,action:()=>n(t),render:(e,n)=>(0,D.jsx)(W,{inline:!0,store:t,hoverIcon:l.U,...e,caption:s})}}function Q(e){const{environment:t,store:n}=e;x.createAndCommit({userAction:"assistant.clearInput",environment:t,perform:e=>y.f8({transaction:e,store:n})})}function Y(e){const{query:t,currentPageStore:n,onSelectPage:o}=e,{currentSpaceStore:r,currentSpaceViewStore:l}=(0,a.VK)((()=>({currentSpaceStore:T.default.state.currentSpaceStore,currentSpaceViewStore:T.default.state.currentSpaceViewStore})),[]);if(!r||!l)throw new Error("Expected spaceStore and spaceViewStore to be defined");const c=(0,s.useMemo)((()=>p.QaF(t)),[t]),u=(0,i.O7)(),h=(0,s.useCallback)((e=>{o(e.pointer)}),[o]),f=(0,a.VK)((()=>{if(!r)return[];const e=P.Z.get(r.id)??[];return m.mN(m.oA([n,...e.map((e=>e.store)).filter((e=>e.isType("page")))]),"id")}),[n,r]),y=(0,s.useCallback)((async e=>(await q({environment:u,searchQuery:e,currentSpaceStore:r,currentSpaceViewStore:l,blockTypes:["page"],limit:5})).map((e=>e.store))),[r,l,u]),x=(0,s.useCallback)((async e=>{const t=await async function(e){const{environment:t,searchQuery:n,currentSpaceStore:s}=e;return(await(0,M.searchMentionablePages)({nearBlock:void 0,environment:t,query:n,source:"question_answer_context_search",limit:20})).map(((e,t)=>({...e,serverEventProperties:void 0,originalPosition:t,store:B.G.createChildStore(s,{table:d.iU,id:e.id})})))}({environment:u,searchQuery:e,currentSpaceStore:r});return t.map((e=>e.store)).filter((e=>e.isType("page")))}),[r,u]),v=U(c,y,k.E5),S=U(c,x,k.rE);return{items:(0,s.useMemo)((()=>{if(0===c.length||"empty"===v.type||"results"===v.type&&0===v.value.length&&"empty"===S.type)return f.map((e=>$({record:e,action:h,caption:e.id===(null==n?void 0:n.id)?(0,D.jsx)(g.FormattedMessage,{...z.openedPageLabel}):void 0})));const{localResults:e,serverResults:t}=G(v,S);return m.mN([...e,...t],"id").map((e=>$({record:e,action:h})))}),[c.length,v,S,f,h,null==n?void 0:n.id]),isLoading:v.loading||S.loading}}function X(e){const{clientSkill:t,shouldAcceptText:n,onSelect:i,textValue:o}=e,r=(0,g.useIntl)(),l=(0,a.VK)((()=>{const e=(0,C.np)();return(0,j.Kj)(null==e?void 0:e.id)?void 0:e}),[]),{items:d,isLoading:c}=Y({query:o,currentPageStore:l,onSelectPage:i}),u=(0,s.useMemo)((()=>{const e=[...d];return e.length>0&&o&&p.QaF(o).length>0&&n&&e.push({key:"freeform_activate",action:()=>i(o),render:e=>(0,D.jsx)(v.Z,{...e,svg:t.icon,title:`${r.formatMessage(t.displayName)} ${p.QaF(o)}`})}),e.length>0?[{key:"local",items:e,render:e=>(0,D.jsx)(b.Z,{title:"Select a page",right:c?(0,D.jsx)(S.Z,{}):void 0,...e})}]:[]}),[d,o,n,i,t.icon,t.displayName,r,c]);return{sections:u,itemsAvailable:d.length>0}}function J(e){const{clientSkill:t,onSelect:n,shouldAcceptText:o,textValue:r}=e,l=(0,g.useIntl)(),d=(0,a.VK)((()=>{var e;return null===(e=(0,C.np)())||void 0===e?void 0:e.getCollectionStore()}),[]),{items:u,isLoading:h}=function(e){const{query:t,onSelectCollection:n,currentCollectionStore:o}=e,{currentSpaceStore:r,currentSpaceViewStore:l}=(0,a.VK)((()=>({currentSpaceStore:T.default.state.currentSpaceStore,currentSpaceViewStore:T.default.state.currentSpaceViewStore})),[]);if(!r||!l)throw new Error("Expected spaceStore and spaceViewStore to be defined");const d=(0,i.O7)(),u=(0,s.useMemo)((()=>p.QaF(t)),[t]),h=(0,s.useCallback)((e=>{var t;(null===(t=e.getParentBlockStore())||void 0===t?void 0:t.pointer)&&n(e.pointer)}),[n]),f=(0,a.VK)((()=>{if(!r)return[];const e=P.Z.get(r.id);if(!e)return[];const t=e.map((e=>e.store.isType("collection_view_page")||e.store.isType("collection_view")?e.store.getCollectionStore():void 0));return m.mN(m.oA([o,...t]),"id")}),[o,r]),y=(0,s.useCallback)((async e=>{const t=await q({environment:d,searchQuery:e,currentSpaceStore:r,currentSpaceViewStore:l,blockTypes:["collection_view_page","collection_view"],limit:5});return m.mN(m.oA(t.map((e=>e.store.getCollectionStore()))),"id")}),[r,l,d]),x=(0,s.useCallback)((async e=>{const{results:t}=await(0,M.searchCollections)(d,{query:e,limit:20,source:"assistant_search_databases",spaceStore:r,searchSessionId:void 0});return t.map((e=>B.NW.createChildStore(r,{table:c.vF,id:e})))}),[r,d]),v=U(u,y,k.E5),S=U(u,x,k.rE);return{items:(0,s.useMemo)((()=>{if(0===u.length||"empty"===v.type||"results"===v.type&&0===v.value.length&&"empty"===S.type)return f.map((e=>$({record:e,action:h,caption:e.id===(null==o?void 0:o.id)?(0,D.jsx)(g.FormattedMessage,{...z.openedPageLabel}):void 0})));const{localResults:e,serverResults:t}=G(v,S);return m.mN(m.oA([...e,...t]),"id").map((e=>$({record:e,action:h})))}),[u.length,v,S,f,h,null==o?void 0:o.id]),isLoading:v.loading||S.loading}}({query:r,onSelectCollection:n,currentCollectionStore:d}),f=u.length>0,y=(0,s.useMemo)((()=>{const e=[...u],s=p.QaF(r);if(e.length>0&&r&&s.length>0&&o){const i=`${l.formatMessage(t.displayName)} ${s}`;e.push({key:"freeform_activate",action:()=>n(r),render:e=>(0,D.jsx)(v.Z,{...e,svg:t.icon,title:i})})}return e.length>0?[{key:"local",items:e,render:e=>(0,D.jsx)(b.Z,{title:"Select a database",right:h?(0,D.jsx)(S.Z,{}):void 0,...e})}]:[]}),[u,r,o,l,t.displayName,t.icon,n,h]);return{sections:y,itemsAvailable:f}}function ee(e){const{items:t,onSelect:n,textValue:i}=e,a=(0,g.useIntl)(),r=(0,s.useMemo)((()=>t.map((e=>({...e,name:a.formatMessage(e.name)}))).sort(((e,t)=>e.name.localeCompare(t.name)))),[a,t]),l=(0,s.useMemo)((()=>{const e=p.QaF(i),t=(0,o.ZP)(e,r,(e=>e.name)).map((e=>({key:e.key,action:()=>n(e.key),render:t=>(0,D.jsx)(v.Z,{...t,title:e.name})}))),s=t.length>0;return[{key:"items",items:t,render:e=>(0,D.jsx)(b.Z,{title:s?void 0:a.formatMessage(z.noItemsAvailable),...e})}]}),[a,r,n,i]);return l}},830179:(e,t,n)=>{n.d(t,{V:()=>d});n(667294);var s=n(724405),i=n(193078),a=n(460651),o=n(137810),r=n(629551),l=n(785893);function d(e){const{integrationLogoIcon:t,title:n,subtext:d,titleWidth:c,overrideStyles:u}=e,p=(0,s.yK)((e=>({logoSection:{padding:"40px 20px 24px 20px",gap:8,justifyContent:"center",alignItems:"center"},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:e.v2.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",textAlign:"center",alignItems:"center"},title:{fontSize:17,width:c||352,fontWeight:o.Z.fontWeight.medium,lineHeight:"22px",marginBottom:"2px",justifyContent:"center",textWrap:"balance"},subtext:{fontSize:14,fontWeight:o.Z.fontWeight.regular,color:`${e.v2.text.secondary}`,textAlign:"center",alignItems:"center",justifyContent:"center",paddingLeft:20,paddingRight:20}})),[c]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(r.gq,{style:p.logoSection,children:[(0,a.h)(p.logos),(0,i.O)(p.arrowLogo),t(p.logos)]}),(0,l.jsxs)(r.Ht,{style:p.titleWrapper,children:[(0,l.jsx)(r.gq,{style:null!=u&&u.title?u.title:p.title,children:n}),d&&(0,l.jsx)(r.gq,{style:null!=u&&u.subtext?u.subtext:p.subtext,children:d})]})]})}},18550:(e,t,n)=>{n.d(t,{Z:()=>m});n(667294);var s=n(724405),i=n(180920),a=n(11751),o=n(709291),r=n(137810),l=n(164921),d=n(550506),c=n(158297),u=n(629551),p=n(830179),g=n(785893);const m=function(e){const{title:t,open:n,notes:m,sampleMessage:h,titleWidth:f,integrationIcon:y,onDismiss:x,onConnect:v,onLearnMore:S,isLoading:b,overridePrimaryMessage:C,dontDisplayBullets:j,dontDisplayYourDataIsSafe:k,centerNotes:w,noteStyleOverrides:I}=e,M=(0,s.yK)((e=>({wrapper:{width:400},title:{fontSize:17,width:f,fontWeight:r.Z.fontWeight.medium,lineHeight:"22px",marginBottom:"2px"},assistantSampleWrapper:{width:"100%",justifyContent:"center"},assistantSample:{marginTop:32,marginLeft:80,marginRight:80,padding:"8px 12px 8px 12px",borderRadius:12,boxShadow:e.aiEditCardDropShadow,gap:5,fontSize:12,color:"#787774",justifyContent:"center",alignItems:"center"},assistantFace:{display:"flex",borderRadius:"100%",width:42,height:42,justifyContent:"center",alignItems:"center",border:`1px solid ${e.v2.stroke.regular}`},dataSafetyWrapper:{width:"100%",justifyContent:"center",marginTop:k?2:40},dataSafetyContainer:{width:"352px",font:r.Z.baseFontFamily.sans},integrationSecurityHeading:{gap:10,display:"flex",alignItems:"center"},integrationSecurityIcon:{width:12,height:12,color:e.accentColors.uiBlue[600]},integrationSecurityHeadingText:{fontWeight:r.Z.fontWeight.medium,fontSize:14,lineHeight:"18px"},notes:{marginTop:12,alignItems:"center",gap:12,font:r.Z.baseFontFamily.sans,listStylePosition:"outside",paddingLeft:2,listStyleType:"none",...w&&{textAlign:"center",justifyContent:"center"}},note:{display:"flex",fontSize:r.Z.fontSize.UISmall.desktop,lineHeight:r.Z.lineHeight.UISmall.desktop,color:`${e.v2.text.secondary}`,padding:2,gap:12,listStylePosition:"outside",marginBottom:4,...w&&{alignItems:"center",textAlign:"center",justifyContent:"center"},...I},footer:{justifyContent:"center",alignItems:"center",bottom:0,width:"100%",height:80,boxShadow:"0px 9px 24px 0px #0F0F0F33",padding:"20px 20px 20px 20px",gap:6,marginTop:12},connectButton:{fontSize:14,fontWeight:r.Z.fontWeight.semibold,width:"100%"},learnMoreButton:{fontSize:14,fontWeight:r.Z.fontWeight.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:r.Z.fontWeight.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${e.v2.text.secondary}`},externalLinkIcon:{width:16,height:16},sparklesIcon:{width:20,height:20,color:e.accentColors.gray[500],marginRight:8},sampleText:{display:"flex",width:"100%",color:e.v2.text.secondary,fontWeight:r.Z.fontWeight.medium,fontSize:r.Z.fontSize.UISmall.desktop}})),[f,k,w,I]);return(0,g.jsx)(d.Z,{showCloseIcon:!0,onDismiss:x,open:n,render:()=>(0,g.jsxs)("div",{style:M.wrapper,children:[(0,g.jsx)(p.V,{integrationLogoIcon:y,title:t}),h&&(0,g.jsx)(u.gq,{style:M.assistantSampleWrapper,children:(0,g.jsxs)(u.gq,{style:M.assistantSample,children:[(0,a.t)(M.sparklesIcon),(0,g.jsx)("div",{style:M.sampleText,children:h})]})}),(0,g.jsx)(u.gq,{style:M.dataSafetyWrapper,children:(0,g.jsxs)("div",{style:M.dataSafetyContainer,children:[!k&&(0,g.jsxs)(u.gq,{style:M.integrationSecurityHeading,children:[(0,i.X)(M.integrationSecurityIcon),(0,g.jsx)("div",{style:M.integrationSecurityHeadingText,children:(0,g.jsx)(o.FormattedMessage,{id:"universalSearch.integration.yourDataIsSafe",defaultMessage:"Your data is safe"})})]}),(0,g.jsx)("div",{children:(0,g.jsx)("ul",{style:M.notes,children:m.map(((e,t)=>(0,g.jsxs)("li",{style:M.note,children:[!j&&(0,g.jsx)("div",{children:""}),e]},`note-${t}`)))})})]})}),(0,g.jsxs)(u.Ht,{style:M.footer,children:[(0,g.jsx)(c.Z,{isLoading:b,disabled:b,style:M.connectButton,onClick:v,children:C||(0,g.jsx)(o.FormattedMessage,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})}),S&&(0,g.jsx)(l.Z,{style:M.learnMoreButton,onClick:S,children:(0,g.jsx)(u.gq,{style:M.learnMoreText,children:(0,g.jsx)(o.FormattedMessage,{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"})})})]})]})})}},55762:(e,t,n)=>{n.d(t,{MB:()=>x,N$:()=>v,OW:()=>h,UD:()=>b,_h:()=>y,dR:()=>S,t4:()=>m,uA:()=>f});var s=n(217215),i=n(541432),a=n(150475),o=n(842875),r=n(421202),l=n(429369),d=n(709291),c=n(401898),u=n(521273),p=n(206258);const g=(0,d.defineMessages)({everythingLabel:{id:"assistantHelpers.getScopeTitle.everything",defaultMessage:"Everything"},slackLabel:{id:"assistantHelpers.getScopeTitle.slack",defaultMessage:"Slack"},notionLabel:{id:"assistantHelpers.getScopeTitle.notion",defaultMessage:"Notion"},gdriveLabel:{id:"assistantHelpers.getScopeTitle.gdrive",defaultMessage:"Google Drive"}});function m(){return u.Z.canScopeToDatabases()?new Set([i.Ti.page,i.Ti.collectionView,i.Ti.collectionViewPage]):u.Z.canScopeToPagesTeamspacesAndDatabases()?new Set([i.Ti.page]):new Set}const h=new Set([i.Ti.factory]);function f(e){const t=e.getType(),n=e.getModel(),s=m(),i=!(null==n||!n.isCollectionView())&&!n.getCollectionPointer();return Boolean(t&&s.has(t)&&!i&&!(0,a.R5)(n))}function y(e){const{searchScope:t,currentSpaceStore:n}=e;return"everything"===t.type||"labeler"===t.type||"universal-none"===t.type||"notion-none"===t.type?{type:"everything"}:"teamspace"===t.type?{type:"teamspace",teamStore:p.zX.createChildStore(n,{id:t.teamId,table:l.e0,spaceId:n.id})}:"notion"===t.type?{type:"notion"}:"workspace"===t.type?{type:"workspace"}:"page"===t.type?{type:"page",pageStore:p.G.createChildStore(n,{id:t.pageId,table:r.iU,spaceId:n.id})}:"collection"===t.type?{type:"collection",pageStore:p.G.createChildStore(n,{id:t.pageId,table:r.iU,spaceId:n.id}),collectionId:t.collectionId}:"slack"===t.type?{type:"slack"}:"helpdocs"===t.type?{type:"helpdocs"}:"google-drive"===t.type?{type:"google-drive"}:(0,c.t1)(t)}function x(e){const{scopeMenuItem:t,currentSearchScope:n}=e;return"everything"===n.type||"labeler"===n.type||"universal-none"===n.type||"notion-none"===n.type?"everything"===t.type:"notion"===n.type?"notion"===t.type:"workspace"===n.type?"workspace"===t.type:"slack"===n.type?"slack"===t.type:"teamspace"===n.type?"teamspace"===t.type&&t.teamStore.id===n.teamId:"page"===n.type?"page"===t.type&&t.pageStore.id===n.pageId:"collection"===n.type?"collection"===t.type&&t.pageStore.id===n.pageId&&t.collectionId===n.collectionId:"helpdocs"===n.type?"helpdocs"===t.type:"google-drive"===n.type?"google-drive"===t.type:void(0,c.t1)(n)}function v(e){var t;const n=null===(t=e.getCollectionPointer())||void 0===t?void 0:t.id;return n?{type:"collection",pageStore:e,collectionId:n}:{type:"page",pageStore:e}}function S(e){const{item:t,mainEditorCurrentBlockStore:n,intl:i}=e;if("everything"===t.type)return{type:"everything"};if("workspace"===t.type)return{type:"workspace"};if("helpdocs"===t.type)return{type:"helpdocs"};if("notion"===t.type)return{type:"notion"};if("teamspace"===t.type)return{type:"teamspace",store:t.teamStore,accessLevel:t.teamStore.getTeamAccessLevel()};if("page"===t.type||"collection"===t.type){var a;const e=t.pageStore;return{type:"page",store:e,isCurrentPage:e.id===(null==n?void 0:n.id),title:(null===(a=e.getModel())||void 0===a?void 0:a.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,o.r)(),intl:i}))??(0,s.Q2)(i)}}return"slack"===t.type?{type:"slack"}:"google-drive"===t.type?{type:"google-drive"}:(0,c.t1)(t)}function b(e){const{searchScope:t,currentSpaceStore:n,intl:s,showEverythingLabel:i}=e;if("everything"===t.type)return i?s.formatMessage(g.everythingLabel):void 0;if("labeler"!==t.type&&"universal-none"!==t.type&&"notion-none"!==t.type){if("notion"===t.type)return s.formatMessage(g.notionLabel);if("slack"===t.type)return s.formatMessage(g.slackLabel);if("google-drive"===t.type)return s.formatMessage(g.gdriveLabel);if("helpdocs"===t.type)return"Notion Help";var a;if("workspace"===t.type)return null===(a=n.getModel())||void 0===a?void 0:a.getRenderTitle();if("teamspace"===t.type){var d;return null===(d=p.zX.createChildStore(n,{id:t.teamId,table:l.e0,spaceId:n.id}).getModel())||void 0===d?void 0:d.getRenderTitle()}if("page"===t.type||"collection"===t.type){var u;const e=p.G.createChildStore(n,{id:t.pageId,table:r.iU,spaceId:n.id});return null===(u=e.getModel())||void 0===u?void 0:u.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,o.r)(),intl:s})}return(0,c.t1)(t)}}},435367:(e,t,n)=>{n.d(t,{m:()=>g,p:()=>c});n(757658);var s=n(702607),i=n(511799),a=n(421202),o=n(709291),r=n(401898),l=n(741195),d=n(759162);const c=(0,o.defineMessages)({greetingHeading:{id:"assistant.tutorial.greetingHeading",defaultMessage:"Hi {name}!"},greetingBody:{id:"assistant.tutorial.greetingBody",defaultMessage:"I'm Notion AI. I can chat, create, and find anything, powered by your knowledge. Want to give it a try?"},goBackAriaLabel:{id:"assistant.tutorial.goBack",defaultMessage:"Exit tutorial"},showMe:{id:"assistant.tutorial.takeTour",defaultMessage:"Start tour"},onMyOwn:{id:"assistant.tutorial.onMyOwn",defaultMessage:"I'll explore on my own"},chatResponse:{id:"assistant.tutorial.chatResponse2",defaultMessage:"Here are several quick icebreakers you could use for your team meeting:\n Two Truths and a Lie: Each member states two truths and one lie about themselves, and the rest of the team guesses which one is the lie.\n Desert Island Scenario: Ask each team member to share what three items they would bring if they were stranded on a desert island, and why.\n Virtual Show and Tell: Each team member takes a turn to share and talk about a personal item they have in their workspace.\n Emoji Mood: Ask each team member to pick an emoji that best represents their current mood and explain why they chose it."},doneHeading:{id:"assistant.tutorial.doneHeading",defaultMessage:"That's the tour!"},done:{id:"assistant.tutorial.done",defaultMessage:"Here are some next steps you might want to explore."},newChat:{id:"assistant.tutorial.newChat",defaultMessage:"New chat"},repeatTour:{id:"assistant.tutorial.repeatTour",defaultMessage:"Repeat tour"},importYourKnowledge:{id:"assistant.tutorial.importYourKnowledge",defaultMessage:"Import your knowledge"},notionHelp:{id:"assistant.tutorial.notionHelp",defaultMessage:"Notion help"}}),u=[{groupType:"welcome",steps:[{type:"welcome",shouldPauseAndWaitForEvent:!0}]},{groupType:"chat",steps:[{type:"tutorialRing",index:1,shouldPauseAndWaitForEvent:!1},{type:"assistantPlaintextChat",heading:"chatHeading",message:"chatBody",shouldPauseAndWaitForEvent:!0},{type:"userTurn",message:"chatPrefill",shouldPauseAndWaitForEvent:!0}]},{groupType:"createPage",steps:[{type:"createPageCard",shouldPauseAndWaitForEvent:!1},{type:"assistantPlaintextChat",message:"createEditBody",shouldPauseAndWaitForEvent:!0},{type:"highlightCreatePageCard",shouldPauseAndWaitForEvent:!0}]},{groupType:"createEdit",steps:[{type:"tutorialRing",index:2,shouldPauseAndWaitForEvent:!1},{type:"assistantPlaintextChat",heading:"editYourContentHeading",message:"editYourContentBody",shouldPauseAndWaitForEvent:!0},{type:"userTurn",message:"createEditPrefill",shouldPauseAndWaitForEvent:!0}]},{groupType:"editCard",steps:[{type:"groupedEditCard",shouldPauseAndWaitForEvent:!1},{type:"assistantPlaintextChat",message:"createEditResponse",shouldPauseAndWaitForEvent:!0},{type:"acceptEditsMessageButton",shouldPauseAndWaitForEvent:!0}]},{groupType:"chatFind",steps:[{type:"tutorialRing",index:3,shouldPauseAndWaitForEvent:!1},{type:"assistantPlaintextChat",heading:"findHeading",message:"findBody",shouldPauseAndWaitForEvent:!0},{type:"userTurn",message:"findPrefill",shouldPauseAndWaitForEvent:!0}]},{groupType:"searching",steps:[{type:"searchStates",searchingMessages:["searchingMessage1","searchingMessage2","searchingMessage3"],shouldPauseAndWaitForEvent:!0},{type:"assistantPlaintextChat",message:"findResponse",shouldPauseAndWaitForEvent:!0},{type:"assistantPlaintextChat",heading:"finalResponseHeader",message:"finalResponseBody",isFinalStep:!0,shouldPauseAndWaitForEvent:!0}]},{groupType:"complete",steps:[{type:"complete",shouldPauseAndWaitForEvent:!0}]}];function p(e){const{messageKey:t,persona:n,intl:i,pagesToCreate:o,environment:c}=e,u=d.dF[n][t],p=[];for(const d of u)if("text"===d.type)p.push([i.formatMessage(d.text)]);else if("pageMention"===d.type){const e=i.formatMessage(d.title),t={icon:d.emoji,title:e};let n=o.get(t);if(!n){n={id:(0,l.TS)({environment:c,table:a.iU,spaceId:void 0}),icon:d.emoji,title:s.b.text(i.formatMessage(d.title)).build()},o.set(t,n)}const r=s.b.mentionPage({id:n.id,table:a.iU}).build();p.push(r[0])}else if("citation"===d.type){const e=i.formatMessage(d.title),t={icon:d.emoji,title:e};let n=o.get(t);if(!n){n={id:(0,l.TS)({environment:c,table:a.iU,spaceId:void 0}),icon:d.emoji,title:s.b.text(i.formatMessage(d.title)).build()},o.set(t,n)}const r=s.b.mentionCitation({blockId:n.id,type:"block",href:"",number:d.number}).build();p.push(r[0])}else(0,r.t1)(d);return{textValue:p,pagesToCreate:o}}function g(e){const{persona:t,intl:n,environment:s}=e,a=new i.Z;return{steps:u.map((e=>({...e,steps:e.steps.map((e=>{if("welcome"===e.type||"createPageCard"===e.type||"highlightCreatePageCard"===e.type||"groupedEditCard"===e.type||"acceptEditsMessageButton"===e.type||"complete"===e.type||"tutorialRing"===e.type)return e;if("assistantPlaintextChat"===e.type){const i=p({messageKey:e.message,persona:t,intl:n,pagesToCreate:a,environment:s}),o=e.heading?p({messageKey:e.heading,persona:t,intl:n,pagesToCreate:a,environment:s}):void 0;for(const[e,t]of i.pagesToCreate.entries())a.set(e,t);if(o)for(const[e,t]of o.pagesToCreate.entries())a.set(e,t);return{...e,message:i.textValue,heading:null==o?void 0:o.textValue}}if("userTurn"===e.type){const i=p({messageKey:e.message,persona:t,intl:n,pagesToCreate:a,environment:s});for(const[e,t]of i.pagesToCreate.entries())a.set(e,t);return{...e,message:i.textValue}}if("searchStates"===e.type){const i=[];for(const o of e.searchingMessages){const e=p({messageKey:o,persona:t,intl:n,pagesToCreate:a,environment:s});for(const[t,n]of e.pagesToCreate.entries())a.set(t,n);i.push(e.textValue)}return{...e,searchingMessages:i}}(0,r.t1)(e)}))}))),pagesToCreate:a.compactedValuesArray()}}},759162:(e,t,n)=>{n.d(t,{Hd:()=>S,tX:()=>b,dF:()=>v});var s=n(709291);const i=(0,s.defineMessages)({chatHeading:{id:"assistant.tutorial.multiplayerPersona.chatHeading",defaultMessage:"Explore ideas"},chatBody:{id:"assistant.tutorial.multiplayerPersona.chatBody",defaultMessage:"Notion AI can chat with you about any topic by using info from GPT-4, but also create and edit content in your workspace. Here's one example:"},chatPrefill:{id:"assistant.tutorial.multiplayerPersona.chatPrefill",defaultMessage:"Draft an announcement about a new funding round for Acme, Inc"},createEditBody:{id:"assistant.tutorial.multiplayerPersona.createEditBody",defaultMessage:"I created a draft and added it to a new page for you. Click the icon to expand the new page, so we can keep working on it."},editYourContentHeading:{id:"assistant.tutorial.multiplayerPersona.editYourContent",defaultMessage:"Edit your content"},editYourContentBody:{id:"assistant.tutorial.multiplayerPersona.editYourContentBody",defaultMessage:"Notion AI can edit, organize, and format content for you. For example, what if we improved the draft using the companys style guide?"},createEditPrefill:{id:"assistant.tutorial.multiplayerPersona.createEditPrefill",defaultMessage:"Improve the draft using "},pageMention1:{id:"assistant.tutorial.multiplayerPersona.pageMention1",defaultMessage:"Acme Writing Style Guide"},createEditResponse:{id:"assistant.tutorial.multiplayerPersona.createEditResponse",defaultMessage:"Just like that, Notion AI can edit any content in your workspace. You can always review the changes before accepting them. Click Accept to continue."},findHeading:{id:"assistant.tutorial.multiplayerPersona.findHeading",defaultMessage:"Search your workspace"},findBody:{id:"assistant.tutorial.multiplayerPersona.findBody",defaultMessage:"Notion AI can find anything in your Notion workspace. Here's an example:"},findPrefill:{id:"assistant.tutorial.multiplayerPersona.findPrefill",defaultMessage:"Find similar announcements in our "},pageMention2:{id:"assistant.tutorial.multiplayerPersona.pageMention2",defaultMessage:"Published posts"},searchingMessage1:{id:"assistant.tutorial.multiplayerPersona.searchingMessage1",defaultMessage:"Reading Acme Writing Style Guide"},searchingMessage2:{id:"assistant.tutorial.multiplayerPersona.searchingMessage2",defaultMessage:"Searching Acme announcements"},searchingMessage3:{id:"assistant.tutorial.multiplayerPersona.searchingMessage3",defaultMessage:"Reading Published posts"},findResponse1:{id:"assistant.tutorial.multiplayerPersona.findResponse1",defaultMessage:"I found two posts about funding, first announcing our series A "},findResponse2:{id:"assistant.tutorial.multiplayerPersona.findResponse2",defaultMessage:" and later announcing a tender offer from Prestige Ventures."},finalResponseHeader:{id:"assistant.tutorial.multiplayerPersona.finalResponseHeader",defaultMessage:"Brainstorm, edit, find. Thats the tour!"},finalResponseBody:{id:"assistant.tutorial.multiplayerPersona.finalResponseBody",defaultMessage:"Explore more with Notion AI"}}),a={chatHeading:[{type:"text",text:i.chatHeading}],chatBody:[{type:"text",text:i.chatBody}],chatPrefill:[{type:"text",text:i.chatPrefill}],createEditBody:[{type:"text",text:i.createEditBody}],editYourContentHeading:[{type:"text",text:i.editYourContentHeading}],editYourContentBody:[{type:"text",text:i.editYourContentBody}],createEditPrefill:[{type:"text",text:i.createEditPrefill},{type:"pageMention",emoji:"",title:i.pageMention1}],createEditResponse:[{type:"text",text:i.createEditResponse}],findHeading:[{type:"text",text:i.findHeading}],findBody:[{type:"text",text:i.findBody}],findPrefill:[{type:"text",text:i.findPrefill},{type:"pageMention",title:i.pageMention2,emoji:""}],searchingMessage1:[{type:"text",text:i.searchingMessage1}],searchingMessage2:[{type:"text",text:i.searchingMessage2}],searchingMessage3:[{type:"text",text:i.searchingMessage3}],findResponse:[{type:"text",text:i.findResponse1},{type:"citation",emoji:"",title:i.pageMention2,number:1},{type:"text",text:i.findResponse2},{type:"citation",emoji:"",title:i.pageMention2,number:2}],finalResponseHeader:[{type:"text",text:i.finalResponseHeader}],finalResponseBody:[{type:"text",text:i.finalResponseBody}]},o=(0,s.defineMessages)({pageTitle:{id:"assistantOnboardingTutorial.createdPage.multiplayer.pageTitle",defaultMessage:"Funding Round Announcement"},pageText1:{id:"assistantOnboardingTutorial.createdPage.multiplayer.pageText1",defaultMessage:"We are thrilled to announce that Acme, Inc. has successfully raised $50 million in our Series B funding round. This new round of funding, led by Prestige Ventures with participation from Future Tech Investors and several angel investors, marks a significant milestone in our journey of innovation and growth."},pageText3:{id:"assistantOnboardingTutorial.createdPage.multiplayer.pageText3",defaultMessage:"Since our inception in 2020, Acme, Inc. has been at the forefront of developing cutting-edge, user-friendly productivity solutions. Our flagship product, the Acme Productivity Suite, has empowered over 1 million users worldwide to optimize their workflows and boost efficiency. The trust and support from our user community have been instrumental in our success, and this new funding round is a testament to the potential of our solutions to redefine productivity in the digital age."},pageText5:{id:"assistantOnboardingTutorial.createdPage.multiplayer.pageText5",defaultMessage:"The funds from this round will be instrumental in fueling our next phase of growth. We plan to enhance our product offerings with advanced features, expand our reach to new markets, and double down on our research and development efforts to stay ahead of the curve. Furthermore, we are excited to grow our team and are actively looking for talented individuals who share our vision of making productivity seamless and enjoyable for everyone."},pageText7:{id:"assistantOnboardingTutorial.createdPage.multiplayer.pageText7",defaultMessage:"We are incredibly grateful to our new and existing investors for their confidence in our vision and team. Their wealth of experience and extensive network will be invaluable as we navigate our growth journey and strive to make a lasting impact in the productivity space. We are also immensely thankful to our users, partners, and team members for their unwavering support and contributions to our success."},pageText9:{id:"assistantOnboardingTutorial.createdPage.multiplayer.pageText9",defaultMessage:"Today's announcement is not just a celebration of what we have achieved, but also a reaffirmation of our commitment to our mission. We are more excited than ever about the future of Acme, Inc. and are looking forward to sharing more updates on our progress in the coming months."},pageText11:{id:"assistantOnboardingTutorial.createdPage.multiplayer.pageText11",defaultMessage:"Stay tuned for an exciting journey ahead!"}}),r={emoji:"",title:o.pageTitle,content:[{type:"text",title:void 0},{type:"text",title:o.pageText1},{type:"text",title:void 0},{type:"text",title:o.pageText3},{type:"text",title:void 0},{type:"text",title:o.pageText5},{type:"text",title:void 0},{type:"text",title:o.pageText7},{type:"text",title:void 0},{type:"text",title:o.pageText9},{type:"text",title:void 0},{type:"text",title:o.pageText11}]},l=(0,s.defineMessages)({createEdit1:{id:"assistant.tutorial.multiplayer.createEdit1",defaultMessage:"We're excited to share that Acme, Inc. has raised $50 million in our Series B funding round. This round, led by Prestige Ventures with Future Tech Investors and several angel investors, is a big step in our growth and innovation journey."},createEdit2:{id:"assistant.tutorial.multiplayer.createEdit2",defaultMessage:"Founded in 2020, Acme, Inc. has been a leader in creating intuitive, cutting-edge productivity solutions. Our Acme Productivity Suite, for instance, has boosted the efficiency of over 1 million users worldwide by optimizing their workflows. The continued trust and support from our users have been crucial to our success. The new funding round, therefore, not only reflects our past achievements but also underscores the future potential of our solutions to transform productivity in the digital era."}});const d=(0,s.defineMessages)({chatHeading:{id:"assistant.tutorial.personalPersona.chatHeading",defaultMessage:"Explore ideas"},chatBody:{id:"assistant.tutorial.personalPersona.chatBody",defaultMessage:"Notion AI can chat with you about any topic by using info from GPT-4, but also create and edit content in your workspace. Here's one example:"},chatPrefill:{id:"assistant.tutorial.personalPersona.chatPrefill.version0",defaultMessage:"Make a 5 day itinerary for my upcoming trip to Tokyo"},createEditBody:{id:"assistant.tutorial.personalPersona.createEditBody",defaultMessage:"I created a list based on GPT-4 knowledge, and added it to a Notion page for you. Click the icon to expand it, so we can keep working on your travel plans."},editYourContentHeading:{id:"assistant.tutorial.personalPersona.editYourContent",defaultMessage:"Edit your content"},editYourContentBody:{id:"assistant.tutorial.personalPersona.editYourContentBody",defaultMessage:"Notion AI can edit, organize, and format content for you. For example, what if we turned this list into a trip itinerary?"},createEditPrefill:{id:"assistant.tutorial.personalPersona.createEditPrefill",defaultMessage:"Can you match the format of this page? "},pageMention1:{id:"assistant.tutorial.personalPersona.pageMention1",defaultMessage:"Paris Trip 2022"},createEditResponse:{id:"assistant.tutorial.personalPersona.createEditResponse",defaultMessage:'Just like that, Notion AI can edit any content in your workspace. You can always review the changes before accepting them. Click "Accept" to continue.'},findHeading:{id:"assistant.tutorial.personalPersona.findHeading",defaultMessage:"Search your workspace"},findBody:{id:"assistant.tutorial.personalPersona.findBody",defaultMessage:"Notion AI can find anything in your Notion workspace. Here's an example:"},findPrefill:{id:"assistant.tutorial.personalPersona.findPrefill",defaultMessage:"What time is our train to Kyoto? Check "},pageMention2:{id:"assistant.tutorial.personalPersona.pageMention2",defaultMessage:"Transportation"},searchingMessage1:{id:"assistant.tutorial.personalPersona.searchingMessage1",defaultMessage:"Reading Japanese travel plans"},searchingMessage2:{id:"assistant.tutorial.personalPersona.searchingMessage2",defaultMessage:"Searching Things to do in Japan"},searchingMessage3:{id:"assistant.tutorial.personalPersona.searchingMessage3",defaultMessage:"Reading Tokyo 3-day itinerary"},findResponse:{id:"assistant.tutorial.personalPersona.findResponse",defaultMessage:"Your train to Kyoto leaves at 11:45 from Tokyo."},finalResponseHeader:{id:"assistant.tutorial.personalPersona.finalResponseHeader",defaultMessage:"Brainstorm, edit, find. Thats the tour!"},finalResponseBody:{id:"assistant.tutorial.personalPersona.finalResponseBody",defaultMessage:"Explore more with Notion AI"}}),c={chatHeading:[{type:"text",text:d.chatHeading}],chatBody:[{type:"text",text:d.chatBody}],chatPrefill:[{type:"text",text:d.chatPrefill}],createEditBody:[{type:"text",text:d.createEditBody}],editYourContentHeading:[{type:"text",text:d.editYourContentHeading}],editYourContentBody:[{type:"text",text:d.editYourContentBody}],createEditPrefill:[{type:"text",text:d.createEditPrefill},{type:"pageMention",emoji:"",title:d.pageMention1}],createEditResponse:[{type:"text",text:d.createEditResponse}],findHeading:[{type:"text",text:d.findHeading}],findBody:[{type:"text",text:d.findBody}],findPrefill:[{type:"text",text:d.findPrefill},{type:"pageMention",title:d.pageMention2,emoji:""}],searchingMessage1:[{type:"text",text:d.searchingMessage1}],searchingMessage2:[{type:"text",text:d.searchingMessage2}],searchingMessage3:[{type:"text",text:d.searchingMessage3}],findResponse:[{type:"text",text:d.findResponse},{type:"citation",title:d.pageMention2,emoji:"",number:1}],finalResponseHeader:[{type:"text",text:d.finalResponseHeader}],finalResponseBody:[{type:"text",text:d.finalResponseBody}]},u=(0,s.defineMessages)({pageTitle:{id:"assistantOnboardingTutorial.createdPage.personal.pageTitle",defaultMessage:"5-Day Tokyo Trip"},pageSubSubHeader1:{id:"assistantOnboardingTutorial.createdPage.personal.pageSubSubHeader1",defaultMessage:"Day 1: Arrival and Shinjuku"},pageText2:{id:"assistantOnboardingTutorial.createdPage.personal.pageText2",defaultMessage:"Arrive in Tokyo. After checking into your hotel, start your adventure in the vibrant district of Shinjuku."},pageBulletedList3:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList3",defaultMessage:"Explore Shinjuku Gyoen National Garden"},pageBulletedList4:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList4",defaultMessage:"Shop at Isetan Department Store"},pageBulletedList5:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList5",defaultMessage:"Dinner at an izakaya (Japanese pub) in Omoide Yokocho"},pageBulletedList6:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList6",defaultMessage:"Evening view of Tokyo from Tokyo Metropolitan Government Building"},pageSubSubHeader7:{id:"assistantOnboardingTutorial.createdPage.personal.pageSubSubHeader7",defaultMessage:"Day 2: Shibuya"},pageText8:{id:"assistantOnboardingTutorial.createdPage.personal.pageText8",defaultMessage:"Immerse yourself in the bustling streets of Shibuya and the trendy vibes of Harajuku."},pageBulletedList9:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList9",defaultMessage:"Walk the famous Shibuya Crossing"},pageBulletedList10:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList10",defaultMessage:"Visit Meiji Jingu Shrine"},pageBulletedList11:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList11",defaultMessage:"Stroll along Takeshita Street in Harajuku"},pageBulletedList12:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList12",defaultMessage:"Lunch at a local caf in Harajuku"},pageBulletedList13:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList13",defaultMessage:"Afternoon shopping in Shibuya 109"},pageBulletedList14:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList14",defaultMessage:"Dinner in Shibuya"},pageSubSubHeader15:{id:"assistantOnboardingTutorial.createdPage.personal.pageSubSubHeader15",defaultMessage:"Day 3: Asakusa and Akihabara"},pageText16:{id:"assistantOnboardingTutorial.createdPage.personal.pageText16",defaultMessage:"Step back in time in the traditional district of Asakusa, then jump into the future in the otaku culture hub of Akihabara."},pageBulletedList17:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList17",defaultMessage:"Visit Senso-ji Temple in Asakusa"},pageBulletedList18:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList18",defaultMessage:"Lunch in Asakusa"},pageBulletedList19:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList19",defaultMessage:"Afternoon in Akihabara: visit maid cafs, shop for electronics and anime goods"},pageBulletedList20:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList20",defaultMessage:"Dinner at a themed caf in Akihabara"},pageSubSubHeader21:{id:"assistantOnboardingTutorial.createdPage.personal.pageSubSubHeader21",defaultMessage:"Day 4: Ueno and Roppongi"},pageText22:{id:"assistantOnboardingTutorial.createdPage.personal.pageText22",defaultMessage:"Enjoy a day of culture, shopping, and nightlife."},pageBulletedList23:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList23",defaultMessage:"Morning at Ueno Zoo or Tokyo National Museum"},pageBulletedList24:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList24",defaultMessage:"Lunch in Ueno"},pageBulletedList25:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList25",defaultMessage:"Afternoon shopping in Roppongi Hills"},pageBulletedList26:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList26",defaultMessage:"Dinner in Roppongi"},pageBulletedList27:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList27",defaultMessage:"Evening at Mori Art Museum and Tokyo City View"},pageSubSubHeader28:{id:"assistantOnboardingTutorial.createdPage.personal.pageSubSubHeader28",defaultMessage:"Day 5: Odaiba and Departure"},pageText29:{id:"assistantOnboardingTutorial.createdPage.personal.pageText29",defaultMessage:"Conclude your trip with a relaxing day in the futuristic island of Odaiba, then depart Tokyo."},pageBulletedList30:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList30",defaultMessage:"Visit teamLab Borderless digital art museum"},pageBulletedList31:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList31",defaultMessage:"Lunch and shopping at DiverCity Tokyo Plaza"},pageBulletedList32:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList32",defaultMessage:"Relax at Oedo-Onsen-Monogatari hot springs"},pageBulletedList33:{id:"assistantOnboardingTutorial.createdPage.personal.pageBulletedList33",defaultMessage:"Departure from Tokyo"}}),p={emoji:"",title:u.pageTitle,content:[{type:"text",title:void 0},{type:"sub_sub_header",title:u.pageSubSubHeader1},{type:"text",title:u.pageText2},{type:"bulleted_list",title:u.pageBulletedList3},{type:"bulleted_list",title:u.pageBulletedList4},{type:"bulleted_list",title:u.pageBulletedList5},{type:"bulleted_list",title:u.pageBulletedList6},{type:"sub_sub_header",title:u.pageSubSubHeader7},{type:"text",title:u.pageText8},{type:"bulleted_list",title:u.pageBulletedList9},{type:"bulleted_list",title:u.pageBulletedList10},{type:"bulleted_list",title:u.pageBulletedList11},{type:"bulleted_list",title:u.pageBulletedList12},{type:"bulleted_list",title:u.pageBulletedList13},{type:"bulleted_list",title:u.pageBulletedList14},{type:"sub_sub_header",title:u.pageSubSubHeader15},{type:"text",title:u.pageText16},{type:"bulleted_list",title:u.pageBulletedList17},{type:"bulleted_list",title:u.pageBulletedList18},{type:"bulleted_list",title:u.pageBulletedList19},{type:"bulleted_list",title:u.pageBulletedList20},{type:"sub_sub_header",title:u.pageSubSubHeader21},{type:"text",title:u.pageText22},{type:"bulleted_list",title:u.pageBulletedList23},{type:"bulleted_list",title:u.pageBulletedList24},{type:"bulleted_list",title:u.pageBulletedList25},{type:"bulleted_list",title:u.pageBulletedList26},{type:"bulleted_list",title:u.pageBulletedList27},{type:"sub_sub_header",title:u.pageSubSubHeader28},{type:"text",title:u.pageText29},{type:"bulleted_list",title:u.pageBulletedList30},{type:"bulleted_list",title:u.pageBulletedList31},{type:"bulleted_list",title:u.pageBulletedList32},{type:"bulleted_list",title:u.pageBulletedList33}]},g=(0,s.defineMessages)({createEditFact1:{id:"assistant.tutorial.createEditFact1",defaultMessage:"Shinjuku, now a vibrant commercial and administrative hub in Tokyo, evolved from a quiet post-town on the Koshu Kaido during the Edo period to a major urban center following the construction of Shinjuku Station in 1885."},createEditFact2:{id:"assistant.tutorial.createEditFact2",defaultMessage:"Shibuya, originally a small village, transformed into a bustling Tokyo ward and global cultural hotspot after the establishment of Shibuya Station in 1885, becoming a pivotal area for fashion, entertainment, and technology."},createEditFact3:{id:"assistant.tutorial.createEditFact3",defaultMessage:"Asakusa, a district within Tokyo, has maintained its historical significance from its origins as a center for entertainment and commerce in the Edo period, to being home to the famous Senso-ji Temple, a major cultural and pilgrimage site."}});const m=(0,s.defineMessages)({chatHeading:{id:"assistant.tutorial.studentPersona.chatHeading",defaultMessage:"Explore ideas"},chatBody:{id:"assistant.tutorial.studentPersona.chatBody",defaultMessage:"Notion AI can chat with you about any topic by using info from GPT-4, but also create and edit content in your workspace. Here's one example:"},chatPrefill:{id:"assistant.tutorial.studentPersona.chatPrefill",defaultMessage:"Create a study guide about General Relativity"},createEditBody:{id:"assistant.tutorial.studentPersona.createEditBody",defaultMessage:"I created a guide based on GPT-4 knowledge, and added it to a Notion page for you. Click the icon to expand it, so we can improve it together."},editYourContentHeading:{id:"assistant.tutorial.studentPersona.editYourContent",defaultMessage:"Edit your content"},editYourContentBody:{id:"assistant.tutorial.studentPersona.editYourContentBody",defaultMessage:"Notion AI can edit, organize, and format content for you. For example, what if we added a quiz to your page?"},createEditPrefill:{id:"assistant.tutorial.studentPersona.createEditPrefill",defaultMessage:"Add some quiz questions, with the answers inside toggles."},createEditResponse:{id:"assistant.tutorial.studentPersona.createEditResponse",defaultMessage:'Just like that, Notion AI can edit any content in your workspace. You can always review the changes before accepting them. Click "Accept" to continue.'},findHeading:{id:"assistant.tutorial.studentPersona.findHeading",defaultMessage:"Search your workspace"},findBody:{id:"assistant.tutorial.studentPersona.findBody",defaultMessage:"Notion AI can find anything in your Notion workspace. Here's an example:"},findPrefill1:{id:"assistant.tutorial.studentPersona.findPrefill1",defaultMessage:"When is my next physics exam? Check"},pageMention1:{id:"assistant.tutorial.studentPersona.pageMention1",defaultMessage:"Exam schedule"},searchingMessage1:{id:"assistant.tutorial.studentPersona.searchingMessage1",defaultMessage:"Reading Exam schedule"},searchingMessage2:{id:"assistant.tutorial.studentPersona.searchingMessage2",defaultMessage:"Reading Exam schedule"},searchingMessage3:{id:"assistant.tutorial.studentPersona.searchingMessage3",defaultMessage:"Reading Exam schedule"},findResponse:{id:"assistant.tutorial.studentPersona.findResponse",defaultMessage:"Your upcoming physics exam is next Wednesday at 11am."},finalResponseHeader:{id:"assistant.tutorial.studentPersona.finalResponseHeader",defaultMessage:"Brainstorm, edit, find. Thats the tour!"},finalResponseBody:{id:"assistant.tutorial.studentPersona.finalResponseBody",defaultMessage:"Explore more with Notion AI"}}),h={chatHeading:[{type:"text",text:m.chatHeading}],chatBody:[{type:"text",text:m.chatBody}],chatPrefill:[{type:"text",text:m.chatPrefill}],createEditBody:[{type:"text",text:m.createEditBody}],editYourContentHeading:[{type:"text",text:m.editYourContentHeading}],editYourContentBody:[{type:"text",text:m.editYourContentBody}],createEditPrefill:[{type:"text",text:m.createEditPrefill}],createEditResponse:[{type:"text",text:m.createEditResponse}],findHeading:[{type:"text",text:m.findHeading}],findBody:[{type:"text",text:m.findBody}],findPrefill:[{type:"text",text:m.findPrefill1},{type:"pageMention",emoji:"",title:m.pageMention1}],searchingMessage1:[{type:"text",text:m.searchingMessage1}],searchingMessage2:[{type:"text",text:m.searchingMessage2}],searchingMessage3:[{type:"text",text:m.searchingMessage3}],findResponse:[{type:"text",text:m.findResponse},{type:"citation",emoji:"",title:m.pageMention1,number:1}],finalResponseHeader:[{type:"text",text:m.finalResponseHeader}],finalResponseBody:[{type:"text",text:m.finalResponseBody}]},f=(0,s.defineMessages)({pageTitle:{id:"assistantOnboardingTutorial.createdPage.student.pageTitle",defaultMessage:"General Relativity"},pageText1:{id:"assistantOnboardingTutorial.createdPage.student.pageText1",defaultMessage:"General Relativity is a theory of gravitation that was developed by Albert Einstein between 1907 and 1915. According to general relativity, the observed gravitational effect between masses results from their warping of spacetime."},pageHeader2:{id:"assistantOnboardingTutorial.createdPage.student.pageHeader2",defaultMessage:"Key Concepts"},pageNumberedList3:{id:"assistantOnboardingTutorial.createdPage.student.pageNumberedList3",defaultMessage:"Equivalence Principle: This principle states that the laws of physics are the same for all non-accelerating observers, and that the force of gravity felt by an observer in a given frame of reference is the same as the pseudo-force experienced by an observer in an accelerating frame of reference."},pageNumberedList4:{id:"assistantOnboardingTutorial.createdPage.student.pageNumberedList4",defaultMessage:"Curvature of Spacetime: General relativity predicts that any mass will deform the fabric of spacetime. This curvature is what we perceive as gravity."},pageNumberedList5:{id:"assistantOnboardingTutorial.createdPage.student.pageNumberedList5",defaultMessage:"Black Holes: The theory predicts that a sufficiently compact mass can deform spacetime to form a black hole."},pageNumberedList6:{id:"assistantOnboardingTutorial.createdPage.student.pageNumberedList6",defaultMessage:"Gravitational Waves: General relativity predicts the existence of gravitational waves, which are ripples in the curvature of spacetime that propagate as waves, traveling outward from the source."},pageHeader7:{id:"assistantOnboardingTutorial.createdPage.student.pageHeader7",defaultMessage:"Equations"},pageText8:{id:"assistantOnboardingTutorial.createdPage.student.pageText8",defaultMessage:"The field equations of general relativity, also known as Einstein's field equations, are a set of ten interrelated differential equations. The solutions of the field equations are the components of the metric tensor of spacetime."},pageHeader9:{id:"assistantOnboardingTutorial.createdPage.student.pageHeader9",defaultMessage:"Applications"},pageNumberedList10:{id:"assistantOnboardingTutorial.createdPage.student.pageNumberedList10",defaultMessage:"Cosmology: The current understanding of the expansion of the universe is based on the FriedmannLematreRobertsonWalker solutions of Einstein's field equations."},pageNumberedList11:{id:"assistantOnboardingTutorial.createdPage.student.pageNumberedList11",defaultMessage:"GPS: The Global Positioning System (GPS) provides an interesting example of how general relativity is used in everyday life. The satellites in the GPS are affected by the Earth's gravity, and this must be accounted for using general relativity to provide accurate positioning information."}}),y={emoji:"",title:f.pageTitle,content:[{type:"text",title:void 0},{type:"text",title:f.pageText1},{type:"header",title:f.pageHeader2},{type:"numbered_list",title:f.pageNumberedList3},{type:"numbered_list",title:f.pageNumberedList4},{type:"numbered_list",title:f.pageNumberedList5},{type:"numbered_list",title:f.pageNumberedList6},{type:"header",title:f.pageHeader7},{type:"text",title:f.pageText8},{type:"header",title:f.pageHeader9},{type:"numbered_list",title:f.pageNumberedList10},{type:"numbered_list",title:f.pageNumberedList11}]},x=(0,s.defineMessages)({editHeader:{id:"assistant.tutorial.student.editHeader",defaultMessage:"Quiz questions"},quizQuestionOne:{id:"assistant.tutorial.student.quizQuestionOne",defaultMessage:"Who developed the theory of General Relativity?"},quizAnswerOne:{id:"assistant.tutorial.student.quizAnswerOne",defaultMessage:"The theory of General Relativity was developed by Albert Einstein. He presented this groundbreaking theory early in the twentieth century, revolutionizing our understanding of gravity, space, and time."},quizQuestionTwo:{id:"assistant.tutorial.student.quizQuestionTwo",defaultMessage:"What is the Equivalence Principle?"},quizAnswerTwo:{id:"assistant.tutorial.student.quizAnswerTwo",defaultMessage:"The Equivalence Principle is a fundamental concept in General Relativity stating that the effects of gravity are locally indistinguishable from the effects of acceleration. This means that an observer in a closed system cannot tell whether they are in a gravitational field or accelerating through space."},quizQuestionThree:{id:"assistant.tutorial.student.quizQuestionThree",defaultMessage:"What is a black hole, according to the theory?"},quizAnswerThree:{id:"assistant.tutorial.student.quizAnswerThree",defaultMessage:"According to the theory of General Relativity, a black hole is a region of spacetime where gravity is so strong that nothing, not even light, can escape from it. It is formed when a massive star collapses under its own gravity, creating a singularity surrounded by an event horizon."}});const v={personal:c,student:h,multiplayer:a},S={personal:p,student:y,multiplayer:r},b={personal:function(e){return`<insert-after id="2"><text>${e.formatMessage(g.createEditFact1)}</text></insert-after><insert-after id="9"><text>${e.formatMessage(g.createEditFact2)}</text></insert-after><insert-after id="18"><text>${e.formatMessage(g.createEditFact3)}</text></insert-after>\n`},student:function(e){return`<insert-after id="1">\n\t<h1>${e.formatMessage(x.editHeader)}</h1>\n\t<toggle>\n\t\t${e.formatMessage(x.quizQuestionOne)}\n\t\t<text>\n\t\t\t${e.formatMessage(x.quizAnswerOne)}\n\t\t</text>\n\t</toggle>\n\t<toggle>\n\t\t${e.formatMessage(x.quizQuestionTwo)}\n\t\t<text>\n\t\t\t${e.formatMessage(x.quizAnswerTwo)}\n\t\t</text>\n\t</toggle>\n\t<toggle>\n\t\t${e.formatMessage(x.quizQuestionThree)}\n\t\t<text>\n\t\t\t${e.formatMessage(x.quizAnswerThree)}\n\t\t</text>\n\t</toggle>\n\t<text></text>\n</insert-after>`},multiplayer:function(e){return`<set-title id="2">${e.formatMessage(l.createEdit1)}</set-title>\n    <set-title id="4">${e.formatMessage(l.createEdit2)}</set-title>`}}},217978:(e,t,n)=>{n.d(t,{u:()=>m});n(252262),n(324506);var s=n(667294),i=n(800480),a=n(886628),o=n(709291),r=n(510102),l=n(80444),d=n(521273),c=n(798180),u=n(148604),p=n(995853),g=n(669128);function m(){const e=(0,i.O7)(),t=(0,o.useIntl)(),{RouterStore:n}=e,[m,h]=(0,a.VK)((()=>{const{route:e}=n.state;return"chat"===e.name&&e.isTutorial?[!0,e.persona]:[!1,void 0]}),[n]);(0,s.useEffect)((()=>{m&&(0,u.startTutorial)({skipAnalytics:!1,environment:e,fromForAnalytics:"tutorialRoute",personaOverride:h,intl:t})}),[m,h,e,t]);const f=(0,a.VK)((()=>l.default.state.currentUserSettingsStore),[]),y=(0,a.VK)((()=>void 0!==(null==f?void 0:f.getSettingsStore().getKeyStore("ai_assistant_tutorial_dismissed_at").getValue())),[f]);(0,s.useEffect)((()=>{y||(0,u.startTutorial)({skipAnalytics:!1,environment:e,fromForAnalytics:"redirectFromFullPageChat",intl:t})}),[y,e,t]);const x=(0,a.VK)((()=>p.l.state),[]),v=(0,a.VK)((()=>c.default.getActiveSession()),[]),S=(0,a.VK)((()=>Boolean(null==v?void 0:v.getHasCommittedHumanStep())),[v]),b=(0,a.VK)((()=>{var e;return null===(e=c.default.getActiveSession())||void 0===e?void 0:e.selectedSkill}),[]),C=(0,a.VK)((()=>g.Pf.isAvailable()),[]),j=(0,a.VK)((()=>d.Z.isParameterizationAndEmptyStateEnabled()),[]),k=(0,a.VK)((()=>d.Z.isAssistantTutorialEnabledForUser()),[]),w=(0,r.Io)();if(!S&&C)return{type:"abandoned_search_reminder"};if(S||b)return{type:"chat"};if(k&&x.isActive&&w.isType("fullPage")){var I;if(0===x.stepIndex&&0===x.groupIndex)return{type:"tutorial",canUseInput:!0};if(!(x.steps.length-1===x.stepIndex))return{type:"tutorial",canUseInput:!1};const e=null===(I=x.steps.at(x.stepIndex))||void 0===I?void 0:I.steps.length;if(!e)return{type:"tutorial",canUseInput:!0};return{type:"tutorial",canUseInput:e-1===x.groupIndex}}return j?{type:"empty_state"}:{type:"chat"}}},235997:(e,t,n)=>{n.d(t,{t:()=>c});n(252262),n(324506);var s=n(886628),i=n(465993),a=n(433463),o=n(653965),r=n(401898),l=n(521273),d=n(366076);function c(e){const{sessionContext:t,currentSpaceStore:n}=e;return(0,s.VK)((()=>{if(!t||!t.selectedSkill&&!t.automation&&0===t.clientSteps.length)return{type:"empty_state"};if(null==t?void 0:t.temporaryClientSteps.some((e=>"assistantCreateAutomation"===e.type)))return{type:"create_workflow"};if(null!=t&&t.hasPreviewingStepErrorObservations())return l.Z.isAssistantExperienceQna()?{type:"error_retry_only"}:{type:"error"};const e=(null==t?void 0:t.getCombinedSteps())??[],{latestCommitInferenceId:s}=t,c=o.kb(e,(e=>"groupedEditCard"===e.type&&e.inferenceId===s));if(c.length>0){const e=t.groupedPendingOperations.state,n=new Set(c.map((e=>e.pageId))),s=e.filter((e=>n.has(e.pageId)));return s.length>0?s.every(a.sL)?{type:"pages_created",groups:s}:{type:"accept_edits",operationIds:(0,a.f4)(s)}:{type:"actioned_edits"}}const u=e.filter((e=>!(0,i.bA)(e))),p=u.at(u.length-1);if(void 0===p)return{type:"chat",chatStep:void 0};const{type:g}=p;if("assistantShowSearchResults"===g||"assistantSearch"===g)return{type:"search_result_chat",chatStep:void 0};if("assistantChat"===g){const{pageCitations:e,databaseCitations:t}=(0,d.CX)({clientStep:p,citationOrdering:void 0,parentStore:n});return e.length>0||t.length>0?{type:"search_result_chat",chatStep:p}:{type:"chat",chatStep:p}}return"humanAction"===g?{type:"actioned_edits"}:"human"===g||"groupedEditCard"===g||"assistantLimitReached"===g||"assistantChatText"===g||"assistantSearchPeople"===g||"assistantSearchDatabases"===g||"assistantTransaction"===g||"assistantLoading"===g||"assistantLoadDatabase"===g||"assistantQueryingDatabase"===g||"assistantRetry"===g||"assistantSelectEntity"===g||"assistantCreateAutomation"===g||"assistantLoadPage"===g||"queryDatabase"===g?{type:"chat",chatStep:void 0}:void(0,r.t1)(g)}),[n,t])}},167133:(e,t,n)=>{n.d(t,{f:()=>r});n(252262),n(324506);var s=n(886628),i=n(401898),a=n(157254);const o=(0,i.AO)((e=>"assistantShowSearchResults"===e.type||"assistantSearchPeople"===e.type||"assistantQueryingDatabase"===e.type||"assistantLoadDatabase"===e.type||"assistantLoadPage"===e.type||"queryDatabase"===e.type||"assistantRetry"===e.type||"assistantSearchDatabases"===e.type||"groupedEditCard"===e.type?{true:e}:{false:e}));function r(e){return(0,s.VK)((()=>{if(!e)return;const t=e.assistantConfigurationStore.state;if(!t.sampling&&!t.evaluating&&!e.isCurrentlyCommittingHumanStep)return;const n=e.temporaryClientSteps.find((0,i.AO)((e=>"assistantChat"===e.type||"assistantTransaction"===e.type||"assistantChatText"===e.type||"assistantRetry"===e.type?{true:e}:{false:e})));if(n&&"assistantRetry"!==n.type&&("assistantTransaction"===n.type||!(0,a.S)(n)))return;const s=e.getCombinedSteps().at(-1);return{loadingStep:s&&o(s)?s:void 0}}),[e])}},794562:(e,t,n)=>{n.d(t,{u:()=>i});var s=n(800480);function i(){return(0,s.Fy)().isMobile?{smallTextSize:13,chatBodyTextSize:15,inputHeight:40,actionButtonLabelTextSize:15,actionIconSize:18,actionButtonHeight:36,chatContainerHorizontalPadding:20,fullChatContainerHorizontalPadding:48,assistantChatMaxWidth:640}:{smallTextSize:12,chatBodyTextSize:14,inputHeight:36,actionButtonLabelTextSize:13,actionIconSize:16,actionButtonHeight:32,chatContainerHorizontalPadding:16,fullChatContainerHorizontalPadding:48,assistantChatMaxWidth:640}}},604489:(e,t,n)=>{n.d(t,{E:()=>c});var s=n(667294),i=n(800480),a=n(510102),o=n(798180),r=n(828344),l=n(237074),d=n(423577);function c(e){const{inferenceId:t,operationIds:n}=e,c=(0,i.O7)(),u=(0,a.Io)().type;return(0,s.useCallback)((async()=>{const e=o.default.getActiveSession();e&&(await(0,l.acceptEdits)({environment:c,sessionContext:e,inferenceId:t,operationIds:n,operationContext:(0,d.iD)()}),r.trackAcceptAllPill(c,{sessionId:e.sessionId,from:u}))}),[u,c,t,n])}},567973:(e,t,n)=>{n.d(t,{d:()=>i});var s=n(749085);class i extends s.default{getInitialState(){}}},998851:(e,t,n)=>{n.d(t,{Z:()=>F});var s=n(667294),i=n(313991),a=n(800480),o=n(886628),r=n(724405),l=n(407057),d=n(211342),c=n(709291),u=n(800893),p=n(247839),g=(n(757658),n(336769)),m=n(568626),h=n(421202),f=n(401898),y=n(628020),x=n(688536),v=n(319385),S=n(453730),b=n(454642);async function C(e){const{environment:t}=e,n=function(e){function t(e,n){if(!e)return;if(!n.currentUser.id)return;const s={pointer:e.pointer,userId:n.currentUser.id},i=n.defaultRecordCache.inMemoryRecordCache.getVersion(s),a=e.getRenderableContentIds().length>0,o={id:e.id,type:e.getType(),spaceId:e.getSpaceId(),parentId:e.getParentId(),version:i};return a?{...o,content:e.getRenderableContentStores().map((e=>t(e,n))).filter(f.$K)}:o}return t((0,y.np)(),e)}(t),s=await async function(e,t){if(!e)return;function n(e){const t={id:e.id,table:h.iU,spaceId:e.spaceId};if(e.content){return e.content.map((e=>n(e))).flat().concat([t])}return[t]}const s=n(e).map((e=>({pointer:e,version:-1}))),i={},a=await b.syncRecordValues(t,{requests:s},t.currentUser.id);if("success"===a.type){const e=a.data.recordMap.block;e&&Object.entries(e).forEach((e=>{let[t,n]=e;i[t]=n.value.value.version}))}return i}(n,t),i=function(e){const{clientRecord:t,serverRecordVersions:n}=e;if(!t||!n)return[];const s=[],i={};function a(e){var t;const{record:n,parentRecord:o,isRootPage:r}=e;i[n.id]&&s.push(`[clientRecord] Encountered ${n.id} multiple times`),n.parentId&&(o||r||s.push(`[clientRecord] Encountered ${n.id} with parent id ${n.parentId}, but missing parent`),o&&o.id!==n.parentId&&s.push(`[clientRecord] Encountered ${n.id} with parent id ${n.parentId}, but parent has id ${o.id}`)),i[n.id]=n.version,null===(t=n.content)||void 0===t||t.forEach((e=>a({record:e,parentRecord:n,isRootPage:!1})))}return a({record:t,isRootPage:!0}),Object.entries(i).forEach((e=>{let[t,i]=e;const a=n[t];a||s.push(`[serverRecord] Server record for ${t} does not exist`),a&&a!==i&&s.push(`[serverRecord] Server record version for ${t} is different. Server=${a} vs Client=${i}`)})),s}({clientRecord:n,serverRecordVersions:s}),a=await S.transactionQueue.getTotalNumberOfTasks(),o={clientRecord:n,serverRecord:s,warnings:i,webMessageStore:{...(0,x.ZN)(Date.now()),subscriptions:(0,x.gE)()},webExperiments:v.default.getExperimentsMap(),txnQueue:{numTasks:a}};return m.log({level:"info",from:"pageDebuggingActions",type:"debugPageInfo",data:{miscDataToConvertToString:{info:o}}}),o}(0,g.exposeDebugEnvironmentValue)("getDebugPageInfo",(e=>()=>C({environment:e})));var j=n(95477),k=n(557491),w=n(825464),I=n(749085);class M extends I.default{getInitialState(){return{showUpdateInfo:!1}}}const T=M;var A=n(164921),P=n(828992),B=n(526388),_=n(785893);const F=function(){const e=(0,r.Fg)(),t=(0,a.O7)(),n=(0,o.qz)(void 0,T),u=(0,s.useCallback)((()=>function(e,t){C({environment:e}),t.setState({showUpdateInfo:!0})}(t,n)),[t,n]),g=(0,o.VK)((()=>n.state.showUpdateInfo),[n]),{device:m}=t,h=`Notion 2.40.${j.default.version}`,f=(0,_.jsx)(c.FormattedMessage,{id:"appVersionMenuItem.lastUpdatedTime.menuItem",defaultMessage:"Updated {lastUpdatedTime}",values:{lastUpdatedTime:(0,l.tv)(j.default.lastUpdatedTime,i.SP)}});let y=(0,_.jsxs)(s.Fragment,{children:[h,(0,_.jsx)("br",{}),f]});if(m.isMobileNative){const e=k.getMobileVersion(t),n=(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Mobile {reactNativeVersionFormatted}",values:{reactNativeVersionFormatted:(0,d.formatVersion)(e)},id:"appVersionMenuItem.lastUpdatedReactNativeVersion.menuItem"});y=(0,_.jsxs)(s.Fragment,{children:[h,(0,_.jsx)("br",{}),n,(0,_.jsx)("br",{}),f]})}if(m.isElectron){const e=p.getDesktopVersion(),t=(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Desktop {desktopVersionFormatted}",values:{desktopVersionFormatted:(0,d.formatVersion)(e)},id:"appVersionMenuItem.desktopVersion.menuItem"});y=(0,_.jsxs)(s.Fragment,{children:[h,(0,_.jsx)("br",{}),t,(0,_.jsx)("br",{}),f]})}const x=j.default.isLocalhost||!1;if(m.isMobile){const n=g&&(0,_.jsxs)("div",{children:[(0,_.jsx)(R,{}),x?(0,_.jsx)(A.Z,{style:{paddingTop:4},onClick:()=>function(e){const{AppUpdateStore:t,mobileNative:n}=e;t.setState({appUpdate:void 0,electronUpdate:t.state.electronUpdate}),n&&n.resetAssetCache()}(t),children:(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Clear cache",id:"appVersionMenuItem.mobile.clearCache.message"})}):void 0]});return(0,_.jsx)(P.Z,{caption:(0,_.jsxs)("div",{style:{color:e.lightTextColor},children:[(0,_.jsx)("div",{style:{userSelect:"none",WebkitUserSelect:"none"},children:y}),n]}),onClick:u})}return x?(0,_.jsx)(B.Z,{renderTooltip:()=>(0,_.jsx)(R,{}),placement:w.u.Left,render:n=>(0,_.jsx)(P.Z,{onClick:()=>V(h,t),caption:(0,_.jsx)("div",{style:{color:e.lightTextColor},children:y}),...n})}):(0,_.jsx)(P.Z,{onClick:()=>V(h,t),caption:(0,_.jsx)("div",{style:{color:e.lightTextColor},children:y})})};function Z(e){let{prefix:t,update:n}=e;const s=(0,c.useIntl)();return"checking"===n.state?(0,_.jsxs)("div",{children:[t," ",(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Checking for updates",id:"appVersionMenuItem.updateStateForApp.checking.message"})]}):"no-update"===n.state?(0,_.jsxs)("div",{children:[t," ",(0,_.jsx)(c.FormattedMessage,{defaultMessage:"No update {timeFromNow}",id:"appVersionMenuItem.noUpdatesForApp.message",values:{timeFromNow:(0,l.tv)(n.timestamp,i.SP)}})]}):"downloading"===n.state?(0,_.jsxs)("div",{children:[t," ",(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Downloading {version} {percentComplete}",id:"appVersionMenuItem.downloadingUpdate.message",values:{percentComplete:s.formatNumber(n.progress,{style:"percent",maximumFractionDigits:0}),version:(0,d.formatVersion)(n.version)}})]}):"ready"===n.state?(0,_.jsxs)("div",{children:[t," ",(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Update ready {version}",id:"appVersionMenuItem.updateReady.message",values:{version:(0,d.formatVersion)(n.version)}})]}):"error"===n.state?(0,_.jsxs)("div",{children:[t," ",(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Update error {errorMessage}",id:"appVersionMenuitem.updateError.message",values:{errorMessage:n.error&&n.error.message}})]}):null}function V(e,t){C({environment:t}),u.Pm(t,e)}function R(){const e=(0,a.O7)(),{AppUpdateStore:t}=e,n=(0,o.VK)((()=>t.state.appUpdate),[t]),s=(0,o.VK)((()=>t.state.electronUpdate),[t]),i=n?(0,_.jsx)(Z,{prefix:"App.js - ",update:n}):(0,_.jsx)(c.FormattedMessage,{defaultMessage:"App.js - Waiting",id:"appVersionMenuItem.waitingForAppJsUpdate.message"}),r=s&&(0,_.jsx)(Z,{prefix:"Electron - ",update:s});return(0,_.jsxs)("div",{children:[i,r]})}},781645:(e,t,n)=>{n.d(t,{Z:()=>$});var s=n(667294),i=n(800480),a=n(886628),o=n(724405),r=n(840654),l=n(137810),d=n(207879),c=n(116638),u=n(16184),p=n(709291),g=n(401898),m=n(776798),h=n(80444),f=n(798180),y=n(55762),x=n(785893);function v(){const e=(0,a.VK)((()=>f.default.getActiveAssistantConfigurationStore()),[]),t=(0,a.VK)((()=>h.default.state.currentSpaceStore),[]),n=(0,a.VK)((()=>{var n;return t?(0,y._h)({searchScope:(null==e||null===(n=e.state)||void 0===n?void 0:n.searchScope)??c.QA,currentSpaceStore:t}):{type:"everything"}}),[e,t]),s=(0,o.yK)((e=>({searchScope:{padding:"0 8px",display:"flex",flexDirection:"row",color:e.lightTextColor,whiteSpace:"nowrap"}})),[]);return n&&"everything"!==n.type?(0,x.jsx)("div",{style:s.searchScope,children:(0,x.jsx)(S,{item:n})}):null}function S(e){const{item:t}=e,n=(0,p.useIntl)(),s=(0,a.VK)((()=>h.default.state.mainEditorCurrentBlockStore),[]),i=(0,a.VK)((()=>{var e;return null===(e=h.default.state.currentSpaceStore)||void 0===e||null===(e=e.getModel())||void 0===e?void 0:e.getRenderTitle()}),[]),r=(0,a.VK)((()=>(0,y.dR)({item:t,mainEditorCurrentBlockStore:s,intl:n})),[t,s,n]),d=(0,o.yK)((e=>({lockIcon:{width:14,height:14,marginLeft:4,fill:e.mediumIconColor},recordTitle:{alignItems:"center",display:"flex",...l.Z.textOverflowStyle,minWidth:0,flex:1,marginRight:12},pageTitle:{...l.Z.textOverflowStyle,minWidth:0},lightText:{color:e.lightTextColor,whiteSpace:"nowrap"},hyphen:{display:"inline-block",marginLeft:4,marginRight:4}})),[]);if("everything"===r.type)return(0,x.jsx)("div",{style:d.recordTitle,children:(0,x.jsx)(p.FormattedMessage,{id:"assistantScopedSearchReminder.everythingItem.title",defaultMessage:"In{nbspThisIsASpacePleaseIgnore}Everything I can access",values:{nbspThisIsASpacePleaseIgnore:(0,x.jsx)("span",{children:""})}})});if("notion"===r.type)return(0,x.jsx)("div",{style:d.recordTitle,children:(0,x.jsx)(p.FormattedMessage,{id:"assistantScopedSearchReminder.notionItem.title",defaultMessage:"In{nbspThisIsASpacePleaseIgnore}Notion",values:{nbspThisIsASpacePleaseIgnore:(0,x.jsx)("span",{children:""})}})});if("slack"===r.type)return(0,x.jsx)("div",{style:d.recordTitle,children:(0,x.jsx)(p.FormattedMessage,{id:"assistantScopedSearchReminder.slackItem.title",defaultMessage:"In{nbspThisIsASpacePleaseIgnore}Slack",values:{nbspThisIsASpacePleaseIgnore:(0,x.jsx)("span",{children:""})}})});if("google-drive"===r.type)return(0,x.jsx)("div",{style:d.recordTitle,children:(0,x.jsx)(p.FormattedMessage,{id:"assistantScopedSearchReminder.gdriveItem.title",defaultMessage:"In{nbspThisIsASpacePleaseIgnore}Google Drive",values:{nbspThisIsASpacePleaseIgnore:(0,x.jsx)("span",{children:""})}})});if("helpdocs"===r.type)return(0,x.jsx)("div",{style:d.recordTitle,children:(0,x.jsx)(p.FormattedMessage,{id:"assistantScopedSearchReminder.slackItem.dynamicNotionHelpTitle",defaultMessage:"In{nbspThisIsASpacePleaseIgnore}Notion Help",values:{nbspThisIsASpacePleaseIgnore:(0,x.jsx)("span",{children:""})}})});if("workspace"===r.type)return(0,x.jsx)("div",{style:d.recordTitle,children:(0,x.jsx)(p.FormattedMessage,{id:"assistantScopedSearchPageReminderItem.workspaceItem.label",defaultMessage:"In{nbspThisIsASpacePleaseIgnore}<title>{spaceName}</title><light><spacearound></spacearound>Workspace</light>",values:{spaceName:i,title:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,x.jsx)("div",{style:d.pageTitle,children:t})},light:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,x.jsx)("div",{style:d.lightText,children:t})},spacearound:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,x.jsx)("div",{style:d.hyphen,children:t})},nbspThisIsASpacePleaseIgnore:(0,x.jsx)("span",{children:""})}})});if("teamspace"===r.type){if("private"===r.accessLevel){const e=(0,x.jsxs)("div",{style:d.recordTitle,children:[(0,x.jsx)(m.Z,{store:r.store}),(0,u.Q)(d.lockIcon)]});return(0,x.jsx)(p.FormattedMessage,{id:"assistantScopedSearchReminder.teamspaceItem.title",defaultMessage:"In{nbspThisIsASpacePleaseIgnore}{recordTitle}",values:{recordTitle:e,nbspThisIsASpacePleaseIgnore:(0,x.jsx)("span",{children:""})}})}{const e=(0,x.jsx)("div",{style:d.recordTitle,children:(0,x.jsx)(m.Z,{store:r.store})});return(0,x.jsx)(p.FormattedMessage,{id:"assistantScopedSearchReminder.teamspaceItem.title",defaultMessage:"In{nbspThisIsASpacePleaseIgnore}{recordTitle}",values:{recordTitle:e,nbspThisIsASpacePleaseIgnore:(0,x.jsx)("span",{children:""})}})}}return"page"===r.type?r.isCurrentPage?(0,x.jsx)("div",{style:d.recordTitle,children:(0,x.jsx)(p.FormattedMessage,{id:"assistantScopedSearchPageReminderItem.currentPage.label",defaultMessage:"In{nbspThisIsASpacePleaseIgnore}<title>{pageTitle}</title><light><spacearound></spacearound>Current page</light>",values:{pageTitle:r.title,title:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,x.jsx)("div",{style:d.pageTitle,children:t})},light:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,x.jsx)("div",{style:d.lightText,children:t})},spacearound:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,x.jsx)("div",{style:d.hyphen,children:t})},nbspThisIsASpacePleaseIgnore:(0,x.jsx)("span",{children:""})}})}):(0,x.jsx)("div",{style:d.recordTitle,children:(0,x.jsx)(p.FormattedMessage,{id:"assistantScopedSearchPageMenuItem.pageItem.label",defaultMessage:"In{nbspThisIsASpacePleaseIgnore}{recordTitle}",values:{recordTitle:(0,x.jsx)(m.Z,{store:r.store}),nbspThisIsASpacePleaseIgnore:(0,x.jsx)("span",{children:""})}})}):(0,g.t1)(r)}var b=n(510102),C=n(296994),j=n(628020),k=n(116746),w=n(224646),I=n(938676),M=n(561436),T=n(424042),A=n(512174),P=n(536591),B=n(56348),_=n(595193),F=(n(95477),n(98742)),Z=n(825464),V=n(521273),R=n(807339),L=n(164921),E=n(552275),K=n(231945),O=n(478140),D=n(632163),W=n(672495),H=n(526388);function N(e){const{isMobile:t}=(0,i.Fy)(),{currentMode:n,showsLimitedQnaLabel:r}=(0,a.VK)((()=>({currentMode:V.Z.getMode(),showsLimitedQnaLabel:V.Z.showsLimitedQnaLabel()})),[]),d=s.useCallback((e=>{const{buttonPopupParent:t,mode:n}=e;R.C.updateLocalOverrideConfig("assistant_variant",n),t.close()}),[]),c=(0,o.yK)((n=>({buttonContainer:{...e.style},badge:{fontSize:t?14:11,fontWeight:500,padding:"1px 4px",backgroundColor:n.cardHoveredBackground,color:n.lightTextColor,borderRadius:4,...l.Z.textOverflowStyle}})),[t,e.style]),u=(0,_.F)({width:t?void 0:350}),p=!(0,B.EU)();return"control"===n?null:(0,x.jsx)(K.ZP,{popupType:t?K.Z4.SlideUp:K.Z4.Popup,disabled:p,placementToOrigin:K.pO.Bottom,alignmentToOrigin:K.vR.Start,renderOrigin:e=>(0,x.jsx)(H.Z,{renderTooltip:()=>(0,x.jsx)("div",{children:"Select assistant variant"}),disableTooltip:p,placement:Z.u.Bottom,alignment:Z.v.Center,render:t=>(0,x.jsx)(L.Z,{...(0,F.Z)(e,t),disabled:p,ignoreLocalHoverState:!0,style:c.buttonContainer,children:(0,x.jsx)("div",{style:c.badge,children:(0,x.jsx)(z,{mode:n,showsLimitedQnaLabel:r})})})}),render:e=>(0,x.jsx)(O.Z,{...u,children:(0,x.jsx)(D.Z,{type:D.i.Vertical,initialFocus:0,sections:[{key:"assistant_modes",render:e=>(0,x.jsx)(W.Z,{...e,title:"Mode for Dev",shouldShowBottomDivider:!0}),items:A.KM.map((t=>function(e){const{mode:t,buttonPopupParent:n,currentMode:s,onSelectMode:i,showsLimitedQnaLabel:a}=e,o=(e,n)=>(0,x.jsx)(E.Z,{...e,ref:n,title:(0,x.jsx)(z,{mode:t,showsLimitedQnaLabel:a}),right:t===s?(0,P.e)({width:12,height:"auto"}):void 0,caption:(0,x.jsx)(U,{mode:t}),shouldWrapCaption:!0});return{key:t,render:(e,t)=>o(e),action:()=>{i({buttonPopupParent:n,mode:t})}}}({buttonPopupParent:e,mode:t,currentMode:n,onSelectMode:d,showsLimitedQnaLabel:r})))}]})})})}function z(e){const{mode:t,showsLimitedQnaLabel:n}=e;return n?(0,x.jsx)(p.FormattedMessage,{id:"assistantMenu.header.limited.label",defaultMessage:"Free plan"}):"beta"===t||"enhanced_beta"===t?(0,x.jsx)(p.FormattedMessage,{id:"assistantMenu.header.Beta.label",defaultMessage:"Q&A Beta"}):"enhanced_beta"===t?(0,x.jsx)(p.FormattedMessage,{id:"assistantMenu.header.EnhancedBeta.label",defaultMessage:"Enhanced Q&A Beta"}):"assistant_alpha"===t?(0,x.jsx)(p.FormattedMessage,{id:"assistantMenu.header.AssistantAlpha.label",defaultMessage:"Alpha"}):"development"===t?(0,x.jsx)(p.FormattedMessage,{id:"assistantMenu.header.Development.label",defaultMessage:"Development"}):"exploratory"===t?(0,x.jsx)(p.FormattedMessage,{id:"assistantMenu.header.exploratory.label",defaultMessage:"Exploratory"}):"wild_west"===t?(0,x.jsx)(p.FormattedMessage,{id:"assistantMenu.header.WildWest.label",defaultMessage:"Wild West"}):(0,g.t1)(t)}function U(e){const{mode:t}=e;return"beta"===t?(0,x.jsx)(p.FormattedMessage,{id:"assistantMenu.header.Beta.caption",defaultMessage:" Current AI experience for our users."}):"enhanced_beta"===t?(0,x.jsx)(p.FormattedMessage,{id:"assistantMenu.header.EnhancedBeta.caption",defaultMessage:" Q&A beta experience with some assistant features"}):"assistant_alpha"===t?(0,x.jsx)(p.FormattedMessage,{id:"assistantMenu.header.AssistantAlpha.caption",defaultMessage:" Assistant experience for our Alpha users."}):"development"===t?(0,x.jsx)(p.FormattedMessage,{id:"assistantMenu.header.Development.caption",defaultMessage:" New features we're about to ship."}):"exploratory"===t?(0,x.jsx)(p.FormattedMessage,{id:"assistantMenu.header.Exploratory.caption",defaultMessage:" Features still baking but want feedback on."}):"wild_west"===t?(0,x.jsx)(p.FormattedMessage,{id:"assistantMenu.header.WildWest.caption",defaultMessage:" Yee haw! Use at your own risk!"}):(0,g.t1)(t)}var G=n(333957),q=n(123239);function $(){const e=(0,i.Fy)(),{isMobile:t}=e,n=(0,b.Io)(),c=(0,a.VK)((()=>I.sidebarExpandedStore.state),[]),u=(0,a.VK)((()=>k.Z.isVisible()&&("assistant"===k.Z.state.contentType||"inbox"===k.Z.state.contentType)),[]),p=(0,a.VK)((()=>T.Z.state.isShowingTabBar),[]),g=s.useMemo((()=>n.isType("fullPage")&&!c&&!u&&!t),[c,n,u,t]),m=function(e){const{isMobile:t}=e;return(0,o.yK)((e=>({headerContainer:{display:"flex",flexDirection:"column",gap:2,overflow:"hidden",fontSize:t?14:12,height:44,justifyContent:"flex-start",marginBottom:"auto"},wrap:{display:"flex",gap:2,alignItems:"center",overflow:"hidden"},headerSparkles:{width:t?18:16,height:t?18:16,marginRight:t?4:6,color:e.regularIconColor,marginTop:t?"-2px":void 0,flexShrink:0},headerLabel:{fontSize:t?15:13,color:e.regularTextColor,fontWeight:l.Z.fontWeight.medium,...l.Z.textOverflowStyle},featureGateBadge:{marginLeft:2}})),[t])}({isMobile:t}),h=function(){const e=(0,i.O7)(),t=(0,a.VK)((()=>(0,j.h1)(e)),[e]),n=(0,a.VK)((()=>(0,w.in)(e)),[e]),s=(0,a.VK)((()=>k.Z.isPanelPinnedState()),[]),o=(0,a.VK)((()=>M.Z.state.isFullScreen),[]),{zoomFactor:l,isUnifiedTitleBarEnabled:d}=(0,a.VK)((()=>{var e;return{zoomFactor:T.Z.state.zoomFactor,isUnifiedTitleBarEnabled:Boolean(null===(e=T.Z.state.preferences)||void 0===e?void 0:e.isUnifiedTitleBarEnabled)}}),[]);return(0,q.zb)({environment:e,isShowingTabBar:!1,shouldShowSidebar:t.shouldShowSidebar,isSidebarExpanded:n,isSecondarySidebarVisible:s,isBrowserFullScreen:o,isFloatingPersonalHomeTopbar:!1,zoom:l||r.lO,isUnifiedTitleBarEnabled:d})}();return(0,x.jsxs)("div",{style:m.headerContainer,children:[(0,x.jsxs)("div",{style:m.wrap,children:[function(){const s=!u&&!t&&n.isType("fullPage");if(e.isElectron&&!p&&g&&n.isType("fullPage"))return(0,x.jsxs)("div",{style:{...h},children:[(0,x.jsx)("div",{style:{marginRight:4},children:(0,x.jsx)(C.oX,{})}),(0,x.jsx)(G.Z,{showPlusButton:!1})]});if(e.isElectron&&!p&&s)return(0,x.jsx)("div",{style:{...h},children:(0,x.jsx)(G.Z,{showPlusButton:!1})});const i=n.isType("fullPage")&&e.isElectron;return g&&!i?(0,x.jsx)(C.oX,{}):null}(),(0,x.jsx)(d.o,{}),(0,x.jsx)(N,{style:m.featureGateBadge})]}),(0,x.jsx)(v,{})]})}},469317:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Y,defaultRecurrenceConfig:()=>J});var s=n(730120),i=n(667294),a=n(800480),o=n(724405),r=n(640506),l=n(253877),d=n(542853),c=n(924211),u=n(954061),p=n(709291),g=n(653965),m=n(401898),h=n(619584),f=n(628020),y=n(460709),x=n(425498),v=n(319385),S=n(552275),b=n(231945),C=n(396525),j=n(288359),k=n(374194),w=n(203386),I=n(478140),M=n(828992),T=n(632163),A=n(489728),P=n(672495),B=n(307931),_=n(164369),F=n(793289),Z=n(253523),V=n(531701),R=n(98742),L=n(526388),E=n(785893);function K(e){const{buttonPopupEvents:t,focused:n,frequencyLabel:s,recurrence:i,showTooltip:r,variant:l="dropdown"}=e,c=(0,a.O7)(),{device:u}=c,m=(0,o.Fg)(),h=(0,p.useIntl)(),f=function(){const{isMobile:e}=(0,a.Fy)();return(0,o.yK)((t=>({iconStyle:{fill:t.regularIconColor,width:e?18:16}})),[e])}(),y=Boolean(i);return(0,E.jsx)(L.Z,{disableTooltip:!r,delayThreshold:300,renderTooltip:()=>s,render:e=>{switch(l){case"dropdown":return(0,E.jsx)(j.Z,{...(0,R.Z)(e,t),focused:n,icon:(0,Z.N)(f.iconStyle),title:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Repeat",id:"database.templatePickerItem.actionMenu.repeat"}),showExtensionArrow:u.isMobile,right:D({isActive:y,recurrence:i,intl:h})});case"icon":return(0,E.jsx)(A.Z,{...g.CE((0,R.Z)(e,t),["focused","ignoreLocalHoverState"]),disallowTabbing:!1,isSmall:!0,role:"button",children:(0,Z.N)({color:V.ZP.blue,width:14})});case"label":return(0,E.jsxs)(A.Z,{...(0,R.Z)(e,t),children:[D({isActive:y,recurrence:i,intl:h}),(0,d.i)({fill:m.lightIconColor,marginLeft:4,width:10})]})}}})}function O(e,t){return(0,u.rruleFromRecurrence)({...e,weekdays:void 0,hour:0,minute:0}).toText((e=>{switch(e){case"every":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.every",defaultMessage:"every"});case"day":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.day",defaultMessage:"day"});case"days":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.days",defaultMessage:"days"});case"week":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.week",defaultMessage:"week"});case"weeks":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.weeks",defaultMessage:"weeks"});case"month":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.month",defaultMessage:"month"});case"months":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.months",defaultMessage:"months"});case"year":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.year",defaultMessage:"year"});case"years":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.years",defaultMessage:"years"});default:return e.toString()}}))}function D(e){let{isActive:t,recurrence:n,intl:s}=e;return t?n?(0,E.jsx)(E.Fragment,{children:O(n,s)}):void 0:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Off",id:"database.templatePickerItem.recurrenceConfigMenuLabel.off"})}var W=n(484795),H=n(825464);function N(e){const t=(0,a.O7)(),{device:n}=t,r=(0,p.useIntl)(),[l,d]=(0,i.useState)(e.value),[c,u]=(0,i.useState)(void 0),g=t=>{const n=(0,W.TD)(t,r),i=s.ou.fromFormat(n??"","T");return i.isValid?(u(void 0),e.onUpdate({hour:i.hour,minute:i.minute})):(u("invalid"),e.onError&&e.onError()),i},m=e=>{const t=e.target.value;d(t),g(t)},h=()=>{const e=g(l);e.isValid&&d(e.toLocaleString(s.ou.TIME_SIMPLE))},f=(0,o.yK)((e=>({input:{textAlign:"right"},error:{boxShadow:e.outlineRedInputBoxShadow}})),[]);return(0,E.jsx)(L.Z,{renderTooltip:()=>function(e){if("invalid"===e)return(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Invalid time",id:"timeInput.invalid"})}(c),forceVisibleState:void 0!==c,placement:H.u.Bottom,render:()=>(0,E.jsx)(k.Z,{type:"text",onChange:m,onSubmit:h,onBlur:h,value:l,size:1,style:{...e.style,...c?f.error:{},fontSize:n.isMobile?16:14},inputStyle:f.input})})}var z=n(62069),U=n(567149),G=n(407057),q=n(164921);function $(e){const{weekdays:t,onChange:n}=e,s=e.minimumSelection??0,i=(0,p.useIntl)(),a=(0,o.yK)((e=>({wrapper:{display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"center"},selectedDay:{...Q,background:e.blueButtonBackground,color:e.regularInvertedTextColor},unselectedDay:{...Q,background:e.accentColors.gray[50],color:e.mediumTextColor},selectedDayHover:{background:e.blueButtonHoveredBackground},unselectedDayHover:{background:e.accentColors.gray[100]},selectedDayPressed:{background:e.blueButtonPressedBackground},unselectedDayPressed:{background:e.accentColors.gray[200]}})),[]);return(0,E.jsx)(w.Z,{debugName:"WeekdaySelector",capture:!0,children:(0,E.jsx)("div",{style:{...a.wrapper,...e.style},children:U.Z.map(((o,r)=>(0,E.jsx)(q.Z,{...e,onClick:()=>{const e=t.includes(o)?t.length>s?t.filter((e=>e!==o)):t:[...t,o];n(e)},style:t.includes(o)?a.selectedDay:a.unselectedDay,hoveredStyle:t.includes(o)?a.selectedDayHover:a.unselectedDayHover,pressedStyle:t.includes(o)?a.selectedDayPressed:a.unselectedDayPressed,children:(0,G.er)(i,r+1)},o)))})})}const Q={borderRadius:"50%",marginLeft:3,marginRight:3,height:25,width:25,fontSize:14,paddingTop:2};const Y=(0,i.forwardRef)((function(e,t){const{recurrence:n,onChange:y}=e,v=(0,a.O7)(),{device:M}=v,Z=(0,o.Fg)(),V=(0,p.useIntl)(),[R,L]=(0,i.useState)(void 0),[O,D]=(0,i.useState)(J()),[W,H]=(0,i.useState)(!0);void 0===R&&(void 0!==n?(D({...n,hour:n.hour??0,minute:n.minute??0,start_date:(0,r.YL)(n.start_date)}),L(!0)):L(!1));const U=e=>{const t="week"!==e||void 0!==O.weekdays&&0!==O.weekdays.length?O.weekdays:[(n=O.start_date,(0,m.Yd)(u.RRULE_WEEKDAYS_MAP)[s.ou.fromMillis(n).weekday-1])];var n;D({...O,weekdays:t,frequency:e}),L(!0)},G=()=>{y(O)},q=M.isMobile?b.Z4.SlideUp:b.Z4.Popup,Q=function(){const{isMobile:e}=(0,a.Fy)();return(0,o.yK)((t=>({iconStyle:{fill:t.regularIconColor,width:e?18:16},customFrequencySelectButton:{color:t.mediumTextColor,fill:t.lightIconColor,fontWeight:500,fontSize:12},weekdayWrapper:{padding:10},inputLabel:{display:"flex",alignItems:"center",...e?{padding:"10px 14px",fontSize:16,background:t.cardBackground}:{paddingLeft:8}},intervalFrequencyLabel:{color:t.lightTextColor},intervalInputWrapper:{width:70,marginLeft:10,marginRight:10},intervalInput:{textAlign:"right"},timeInputWrapper:{width:90,marginLeft:10,marginRight:10},inputSection:{...X,alignItems:"center",justifyContent:"flex-start",padding:8},chevron:{width:e?14:10,fill:t.lightIconColor,marginLeft:4}})),[e])}(),Y=M.isMobile?"number":"text",le=x.m.map((e=>{const t={key:e.frequency,action:()=>{U(e.frequency)},render:t=>(0,E.jsx)(S.Z,{...t,title:te(e.frequency)})};return t})),de=(0,E.jsx)(w.Z,{debugName:"RecurrenceConfigMenu",capture:!0,onLeft:g.yR,onRight:g.yR,onSelectAll:g.yR,onRedo:g.yR,onUndo:g.yR,onCut:g.yR,onCopy:g.yR,onPaste:g.yR,onKeypress:g.yR,onDelete:g.yR,onBackspace:g.yR,onTab:g.yR,children:(0,E.jsx)(k.Z,{value:O.interval.toString(),style:Q.intervalInputWrapper,inputStyle:Q.intervalInput,type:Y,maxlength:3,onChange:e=>{const t=parseInt(e.target.value);(0,h.hj)(t)&&t>0&&t<=u.MAX_RECURRENCE_INTERVAL&&D({...O,interval:t})},onBlur:e=>{e.target.value=O.interval.toString()}})});return(0,E.jsx)(C.Z,{...e,disabled:e.disabled,popupType:q,ref:t,stopClickPropagation:!0,renderOrigin:t=>(0,E.jsx)(K,{buttonPopupEvents:t,focused:e.focused,frequencyLabel:n&&ne(n.frequency),recurrence:e.recurrence,showTooltip:e.showTooltip,variant:e.variant}),render:e=>(0,E.jsx)(w.Z,{debugName:"RecurrenceConfigMenu",capture:!0,onEnter:g.yR,children:(0,E.jsxs)(I.Z,{...ie(e,M.isMobile,W,G),children:[R?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)(P.Z,{style:X,children:[(0,E.jsx)(B.Z,{innerButtonStyle:{...!M.isMobile&&Q.customFrequencySelectButton},selectedTitle:ne(O.frequency),renderMenuSections:t=>[{key:"repeatOptionsSection",render:e=>(0,E.jsx)(P.Z,{...e}),items:[...ae({parent:t,updateFrequencyFn:e=>{U(e)}}),oe({environment:v,parent:t,onChange:y,onClose:()=>{L(!1),e.close()}})]}]}),!M.isMobile&&(0,E.jsx)(A.Z,{isBlue:W,isLightGray:!W,onClick:t=>{G(),e.close()},disabled:!W,children:ee})]}),(0,E.jsx)(P.Z,{style:Q.inputSection,shouldShowBottomDivider:!0,children:(0,E.jsx)(_.Z,{style:Q.inputLabel,children:se(de,O.frequency,Q.intervalFrequencyLabel)})}),"week"===O.frequency&&(0,E.jsx)(P.Z,{children:(0,E.jsx)($,{style:Q.weekdayWrapper,focused:!0,weekdays:O.weekdays||[],minimumSelection:1,onChange:e=>{D({...O,weekdays:e})}})}),(0,E.jsx)(P.Z,{topBorder:!0,children:(0,E.jsx)(b.ZP,{popupType:q,renderOrigin:e=>(0,E.jsx)(j.Z,{...e,title:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Starts",id:"database.templatePickerItem.repeatMenu.starts"}),focused:!1,showExtensionArrow:M.isMobile,right:s.ou.fromMillis(O.start_date).setLocale((0,c.E2)(V)).toLocaleString({weekday:"short",month:"short",day:"numeric",year:"numeric"})}),render:e=>(0,E.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,E.jsx)(F.Z,{firstDayOfWeek:f.AK.state,value:Math.max(O.start_date,Date.now()),onChange:t=>{D({...O,start_date:t}),e.close()},disabledDays:{before:new Date}})})})}),(0,E.jsx)(P.Z,{style:Q.inputSection,shouldShowBottomDivider:!0,children:(0,E.jsxs)(_.Z,{style:Q.inputLabel,children:[(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Create at",id:"database.templatePickerItem.repeatMenu.createAt"}),(0,E.jsx)(w.Z,{debugName:"RecurrenceConfigMenu",capture:!0,onLeft:g.yR,onRight:g.yR,onSelectAll:g.yR,onRedo:g.yR,onUndo:g.yR,onCut:g.yR,onCopy:g.yR,onPaste:g.yR,onKeypress:g.yR,onDelete:g.yR,onBackspace:g.yR,onTab:g.yR,children:(0,E.jsx)(N,{value:s.ou.local().set({hour:O.hour,minute:O.minute}).toLocaleString(s.ou.TIME_SIMPLE),style:Q.timeInputWrapper,onUpdate:e=>{D({...O,...e}),H(!0)},onError:()=>{H(!1)}})}),(0,E.jsx)(z.Z,{renderOrigin:e=>(0,E.jsxs)(A.Z,{...e,children:[(0,l.er)(O.timezone),(0,d.i)(Q.chevron)]}),onSelect:e=>{D({...O,timezone:e})}})]})})]}):(0,E.jsx)(T.Z,{type:T.i.Vertical,sections:[{key:"repeatOptionsSection",render:e=>(0,E.jsx)(P.Z,{...e}),items:[...le,oe({environment:v,parent:e,onChange:y})]}],initialFocus:void 0}),R&&re(V,O,Z)]})})})})),X={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px"};function J(){return{start_date:s.ou.local().set({hour:0,minute:0,second:0,millisecond:0}).toMillis(),timezone:(0,l.Sv)(),hour:0,minute:0,frequency:"day",interval:1}}const ee=(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Save",id:"database.templatePickerItem.customRecurrence.save"});function te(e){switch(e){case"day":return(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Daily",id:"database.templatePickerItem.quickOptionMenuItem.day"});case"week":return(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Weekly",id:"database.templatePickerItem.quickOptionMenuItem.week"});case"month":return(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Monthly",id:"database.templatePickerItem.quickOptionMenuItem.month"});case"year":return(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Yearly",id:"database.templatePickerItem.quickOptionMenuItem.year"});default:(0,m.t1)(e)}}function ne(e){switch(e){case"day":return(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Repeat daily",id:"database.templatePickerItem.recurrenceFrequency.daily"});case"week":return(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Repeat weekly",id:"database.templatePickerItem.recurrenceFrequency.weekly"});case"month":return(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Repeat monthly",id:"database.templatePickerItem.recurrenceFrequency.monthly"});case"year":return(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Repeat yearly",id:"database.templatePickerItem.recurrenceFrequency.yearly"});default:(0,m.t1)(e)}}function se(e,t,n){switch(t){case"day":return(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Every {interval} <label>days</label>",id:"database.templatePickerItem.recurrenceInterval.everyXdays",values:{label:e=>(0,E.jsx)("label",{style:n,children:e}),interval:e}});case"week":return(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Every {interval} <label>weeks</label>",id:"database.templatePickerItem.recurrenceInterval.everyXweeks",values:{label:e=>(0,E.jsx)("label",{style:n,children:e}),interval:e}});case"month":return(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Every {interval} <label>months</label>",id:"database.templatePickerItem.recurrenceInterval.everyXmonths",values:{label:e=>(0,E.jsx)("label",{style:n,children:e}),interval:e}});case"year":return(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Every {interval} <label>years</label>",id:"database.templatePickerItem.recurrenceInterval.everyXyears",values:{label:e=>(0,E.jsx)("label",{style:n,children:e}),interval:e}});default:(0,m.t1)(t)}}function ie(e,t,n,s){return t?{menuType:y.og.Modal,title:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Repeat",id:"database.templatePickerItem.mobileRepeatModal.title"}),left:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Cancel",id:"database.templatePickerItem.customRecurrence.cancel"}),right:ee,rightDisabled:!n,onClickRight:()=>{n&&(s(),e.close())},onClickLeft:()=>{e.close()}}:{menuType:y.og.Popup}}function ae(e){let{parent:t,updateFrequencyFn:n}=e;return x.m.map((e=>({key:e.frequency,action:()=>{n(e.frequency),t.close()},render:t=>(0,E.jsx)(S.Z,{...t,title:ne(e.frequency)})})))}function oe(e){let{environment:t,parent:n,onChange:s,onClose:i}=e;return{key:"disable",action:()=>{s(void 0),n.close(),i&&i()},render:e=>(0,E.jsx)(S.Z,{...e,title:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Off",id:"database.templatePickerItem.quickOptionMenuItem.off"})})}}function re(e,t,n){const i=(0,u.rruleFromRecurrence)({...t,start_date:(0,r.Io)(new Date(t.start_date))}).after(new Date((0,r.Io)()));if(!i)return null;const a=s.ou.fromJSDate(i).toUTC().setLocale((0,c.E2)(e)).toLocaleString(s.ou.DATETIME_SHORT),o=s.ou.fromJSDate(i).toUTC().setLocale((0,c.E2)(e)).toLocaleString(s.ou.DATE_SHORT),l=v.default.checkGate({gateName:"recurrence_queue_task_improvements"});return(0===t.hour||1===t.hour||2===t.hour)&&l?(0,E.jsx)(P.Z,{topBorder:!0,children:(0,E.jsx)(M.Z,{caption:(0,E.jsx)("span",{style:{color:n.lightTextColor},children:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Next: {dates} (between 12-3 AM)",id:"database.templatePickerItem.recurrenceConfigMenuLabel.nextAtMidnightMessage",values:{dates:o}})})})}):(0,E.jsx)(P.Z,{topBorder:!0,children:(0,E.jsx)(M.Z,{caption:(0,E.jsx)("span",{style:{color:n.lightTextColor},children:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Next: {dates}",id:"database.templatePickerItem.recurrenceConfigMenuLabel.next",values:{dates:a}})})})})}},32203:(e,t,n)=>{n.d(t,{Io:()=>h,mT:()=>f});n(21703);var s=n(667294),i=n(800480),a=n(886628),o=n(559054),r=n(471924),l=n(990038),d=n(598151),c=n(653965),u=n(454642),p=n(80444),g=n(785893);const m=(0,s.createContext)(void 0);function h(e){let{xmlMode:t,children:n}=e;const[i,a]=(0,s.useReducer)(((e,t)=>({...e,[t.str]:t.translation})),{}),o=(0,s.useMemo)((()=>({translationCache:i,addToTranslationCache:a,xmlMode:t})),[i,a,t]);return(0,g.jsx)(m.Provider,{value:o,children:n})}function f(e){const{getTranslatableStrings:t}=e,n=(0,i.O7)(),g=(0,s.useContext)(m);if(!g)throw Error("TranslationContext is required - please wrap the component using useAITranslations in a TranslationProvider");const{translationCache:h,addToTranslationCache:f,xmlMode:y}=g,x=(0,s.useCallback)((e=>h[e]),[h]),v=(0,s.useCallback)((e=>{f(e)}),[f]),S=(0,s.useRef)([]);(0,s.useEffect)((()=>{S.current=Object.keys(h)}),[h]);const b=(0,a.VK)((()=>{var e;return null===(e=p.default.state.currentUserRootStore)||void 0===e||null===(e=e.getSpaceViewStores())||void 0===e||null===(e=e[0])||void 0===e?void 0:e.getSpaceStore()}),[]),[C]=(0,o.r5)((async()=>{const e=c.e5((null==t?void 0:t())??[],S.current);if(!b)return;await l.z.map(5,e,(async e=>{const t=await u.getCompletion(n,{id:r.Il(),context:{type:"aiJsonTranslate",text:e,textOnly:!y},aiSessionId:r.Il(),model:"openai-4",spaceId:b.id,isSpacePermission:!0,inferenceReason:"eval",attributionForLogging:void 0,metadata:{}});if("success"!==t.type)return;let s="";if(d.H1.is(t.data))for await(const n of t.data){if("success"!==n.type)return;s+=n.completion}s=s.trim(),v({str:e,translation:s})}))}),[n,t,v,y,b]);return(0,s.useMemo)((()=>({getTranslationForString:x,isLoading:"pending"===C.status,handleAddTranslation:v})),[C.status,x,v])}m.displayName="AITranslationContext"},157254:(e,t,n)=>{n.d(t,{S:()=>i});n(21703),n(894568);var s=n(401898);n(80444),n(798165);function i(e){return"assistantChat"===e.type?1===e.operations.length&&"createBlock"===e.operations[0].command&&"text"===e.operations[0].blockNode.tagName&&0===e.operations[0].blockNode.text.length:"assistantChatText"===e.type?0===e.text.length:void(0,s.t1)(e)}},99622:(e,t,n)=>{n.d(t,{g:()=>l,q:()=>r});var s=n(800480),i=n(886628),a=n(80444),o=n(88893);function r(e){return(0,i.VK)((()=>o.ff(e.state)),[e])}function l(){const e=(0,s.O7)(),t=(0,i.VK)((()=>{var e;return null===(e=a.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]);return(0,i.VK)((()=>o.ro(e,t)),[e,t])}},212205:(e,t,n)=>{n.d(t,{J:()=>a});var s=n(886628),i=n(80444);function a(){const{currentSpaceStore:e}=(0,s.Kw)(i.default);return(0,s.VK)((()=>(null==e?void 0:e.canAdmin())??!1),[e])}},465753:(e,t,n)=>{n.d(t,{y:()=>o});var s=n(886628),i=n(803791),a=n(288280);function o(){return(0,s.VK)((()=>{var e;const t=(null===(e=a.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,i.de)(t)}),[])}},779683:(e,t,n)=>{n.d(t,{k:()=>d});var s=n(800480),i=n(797511),a=n(886628),o=n(551783),r=n(80444),l=n(869454);function d(){const e=(0,s.O7)(),{WindowSizeStore:t,device:n}=e,d=(0,i.l)(),c=(0,a.VK)((()=>{if(!n.isMobileNative||!n.isAndroid)return 0;const{mainEditorCurrentBlockStore:t}=r.default.state;if(!t)return 0;return(0,o.$3)(e,t,null==d?void 0:d.publicEditModeStore.state).shouldShow?32:0}),[e,n,d]);return(0,a.VK)((()=>{if(!n.isMobileNative)return 24;const e=l.Z.state.estimatedKeyboardWebViewOverlap,s=24+l.Z.estimatedNativeWebBottomOverlap()+c;return e>0?s:t.getSafePaddingBottomCSS(s)}),[n.isMobileNative,c,t])}},483627:(e,t,n)=>{n.d(t,{Z:()=>r});var s=n(749085),i=n(292595);class a extends s.default{getInitialState(){return{open:!1}}setOpen(e){this.setState({...this.state,open:e})}setOriginComponent(e){this.setState({...this.state,originComponent:e})}}const o=new a,r=o;(0,i.exposeDebugValue)("assistantScopedSearchMenuPopupStore",o)},167940:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(749085),i=n(471924);class a extends s.default{getInitialState(){return{flowId:void 0}}getOrCreateFlowId(){const e=this.state.flowId||i.Il();return this.state.flowId&&this.setState({flowId:e}),e}}const o=new a},45325:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});var s=n(749085);class i extends s.default{getInitialState(){return{discussionIdToExpansionStartPointMap:{}}}}const a=new i},128093:(e,t,n)=>{n.d(t,{Z:()=>a});var s=n(749085);class i extends s.default{getInitialState(){return{available:!0}}}const a=new i},19541:(e,t,n)=>{n.d(t,{Z:()=>a});var s=n(749085);class i extends s.default{getInitialState(){return{open:!1}}}const a=new i},71487:(e,t,n)=>{n.d(t,{AG:()=>d,an:()=>c,yY:()=>l});var s=n(709291),i=n(454642),a=n(547307),o=n(433929);const r=(0,s.defineMessages)({invalidCoupon:{id:"applyCoupon.error.invalidCoupon",defaultMessage:"Unable to apply the coupon to your account."}});async function l(e,t){const{customerId:n,offerType:s}=t,o=await i.getCustomerOffer(e,{customerId:n,newPlan:"downgrade_flow"===s?t.newPlan:void 0,offerType:s});if("failed"===o.type)a.showError(o);else{const e=o.data;if(e.offerType===s)return e.coupon}}async function d(e,t){const{customerId:n,coupon:s,offerType:l}=t;if(!s)return void a.showErrorMessage(o.default.formatMessage(r.invalidCoupon));const d=await i.applyCustomerOffer(e,{customerId:n,newPlan:"downgrade_flow"===l?t.newPlan:void 0,offerType:l,coupon:s});"failed"===d.type&&a.showError(d)}async function c(e){const{environment:t,spaceId:n}=e,s=await i.getCustomerOfferEligibility(t,{spaceId:n});return"failed"!==s.type&&s.data.isEligible}},681886:(e,t,n)=>{n.d(t,{OL:()=>C,Tq:()=>S,VA:()=>j,n_:()=>k,uU:()=>w});n(21703);var s=n(667294),i=n(800480),a=n(886628),o=n(803791),r=n(709291),l=n(401898),d=n(454642),c=n(548779),u=n(465753),p=n(80444),g=n(725823),m=n(316388),h=n(288280),f=n(170060),y=n(88893),x=n(785893);const v=.7,S=1;async function b(e,t,n,s){const i=h.subscriptionDataStoreInstance.state;if(!i)return!1;if((0,o.de)(i.addOns))return!1;const a=y.SX(e,i),r=p.default.state.currentSpaceStore;if(!(r&&(0,c.rn)(e,r))||!(0,y.GJ)(i))return!1;if(!s)return!1;const l=await d.getAIUsageEligibility(e,{spaceId:s});if("failed"===l.type)return!1;const u=l.data,g=u?+u.spaceUsage/u.spaceLimit:0;return(!1!==(null==u?void 0:u.isEligible)||!u.isSalesAssisted)&&(!a&&function(e,t,n){const s=e>=S?"limit_reached":"warning";if("warning"===s){if("settings"===t&&null!=n&&n.disableWarningNotificationInSettings||"sidebar"===t&&null!=n&&n.disableWarningNotificationInSidebar)return!1}else if("limit_reached"===s&&("settings"===t&&null!=n&&n.disableLimitNotificationInSettings||"sidebar"===t&&null!=n&&n.disableLimitNotificationInSidebar))return!1;return e>=v}(g,t,n))}function C(e,t,n,s){switch(e){case"ai":return{addOnCostItem:(0,x.jsx)("div",{children:(0,x.jsx)(r.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.unlimitedAI",defaultMessage:"<bold>Notion AI</bold>",values:{bold:e=>(0,x.jsx)("b",{children:e})}})}),addOnCostItemWithMembers:(0,x.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:(0,x.jsx)(r.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.unlimitedAI.memberInfo",defaultMessage:"({memberCount, plural, one {{memberCount} member} other {{memberCount} members}} x {price} per month{interval, select, month {} other { x 12 months}})",values:{memberCount:t,interval:n,price:s}})})};case"sites_custom_hostnames":throw new Error("not implemented");default:(0,l.t1)(e)}}function j(e){const t=(0,i.O7)(),n=(0,a.VK)((()=>{var e;return null===(e=p.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.addOnLimitNotifications}),[]),o=(0,a.VK)((()=>{var e;return null===(e=p.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),[r,l]=(0,s.useState)();return(0,s.useEffect)((()=>{!async function(){const s=await b(t,e,n,o);l(s)}()}),[t,e,n,o]),r}function k(){const e=(0,m.Z)(),t=(0,u.y)(),n=(0,g.tw)(h.subscriptionDataStoreInstance),s=(0,a.VK)((()=>(0,f.Lv)()),[]);return!e&&!t&&n&&s}function w(){return(0,a.VK)((()=>{var e,t;const n=(null===(e=h.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[],s=(0,o.de)(n),i=p.default.state.currentSpaceStore;return!(!i||!s)&&!Boolean(null===(t=i.getSettings())||void 0===t?void 0:t.embedding_index_is_live)}),[])}},725823:(e,t,n)=>{n.d(t,{pQ:()=>s.p,eG:()=>i.e,Hy:()=>c,PL:()=>a.P,r:()=>u.r,tw:()=>p.t,h1:()=>g.h});n(184968);var s=n(696444),i=(n(288269),n(296935)),a=(n(338866),n(947098)),o=n(886628),r=n(80444),l=n(88893),d=n(535057);function c(e){return(0,o.VK)((()=>{const t=e.state;if(!t)return!1;const n=(0,d.zt)(),s=l.Nf({subscriptionData:t,spaceStore:r.default.state.currentSpaceStore}),i=l.wl(t),a=l.su(t);return s&&!i&&1===a&&("free"===n||"personal"===n)}),[e])}n(404135);var u=n(822387),p=n(574267),g=(n(154561),n(133218));n(303751)},184968:(e,t,n)=>{n.d(t,{y:()=>r});var s=n(800480),i=n(559054),a=n(401898),o=n(454642);function r(){const e=(0,s.O7)(),[t]=(0,i.r5)((async()=>{const t=await o.getAvailableCountries(e,{});return"success"===t.type?t.data.countries:"failed"===t.type?[]:void(0,a.t1)(t)}),[e]);return t.value}},696444:(e,t,n)=>{n.d(t,{p:()=>o});var s=n(800480),i=n(886628),a=n(194160);function o(e){let{spaceId:t}=e;const n=(0,s.O7)();return(0,i.VK)((()=>{if(t)return a.Z.getData(n,{spaceId:t})}),[n,t])}},288269:(e,t,n)=>{n.d(t,{T:()=>a});var s=n(886628),i=n(88893);function a(e){return(0,s.VK)((()=>i.AX(e.state)),[e])}},296935:(e,t,n)=>{n.d(t,{e:()=>o});var s=n(886628),i=n(80444),a=n(88893);function o(e){return(0,s.VK)((()=>a.Nf({subscriptionData:e.state,spaceStore:i.default.state.currentSpaceStore})),[e])}},338866:(e,t,n)=>{n.d(t,{m:()=>r});var s=n(667294),i=n(800480),a=n(454642),o=n(303751);function r(e){const t=(0,i.O7)(),[n,r]=(0,s.useState)(),l=(0,o.$)(e);return(0,s.useEffect)((()=>{!async function(){if(!l)return!1;const e=await a.getCustomerOffer(t,{customerId:l,offerType:"add_on_upgrade_flow"});if("failed"===e.type)return!1;r("ai_fifty_percent"===e.data.coupon)}()}),[t,l]),n}},404135:(e,t,n)=>{n.d(t,{m:()=>l});var s=n(667294),i=n(800480),a=n(886628),o=n(80444),r=n(71487);function l(){const e=(0,i.O7)(),[t,n]=(0,s.useState)(),l=(0,a.VK)((()=>{var e;return null===(e=o.default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]);return(0,s.useEffect)((()=>{!async function(){l&&n(await(0,r.an)({environment:e,spaceId:l}))}()}),[e,l]),t}},947098:(e,t,n)=>{n.d(t,{P:()=>o});var s=n(667294),i=n(800480),a=n(454642);function o(){const e=(0,i.O7)(),[t,n]=(0,s.useState)();return(0,s.useEffect)((()=>{!async function(){const t=await a.getExternalOrgData(e,{});if("failed"===t.type)return!1;const s=t.data;n("company_employee_count"in s&&parseInt(s.company_employee_count)>99)}()}),[e]),t}},822387:(e,t,n)=>{n.d(t,{r:()=>a});var s=n(886628),i=n(88893);function a(e){return(0,s.VK)((()=>i.ri(e.state)),[e])}},574267:(e,t,n)=>{n.d(t,{t:()=>a});var s=n(886628),i=n(88893);function a(e){return(0,s.VK)((()=>i.YK(e.state)),[e])}},154561:(e,t,n)=>{n.d(t,{r:()=>a});var s=n(886628),i=n(88893);function a(e){return(0,s.VK)((()=>(0,i.AY)(e.state)),[e])}},133218:(e,t,n)=>{n.d(t,{h:()=>l});var s=n(667294),i=n(800480),a=n(886628),o=n(80444),r=n(622616);function l(){const e=(0,i.O7)(),t=(0,a.VK)((()=>{var e;return null===(e=o.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]);(0,s.useEffect)((()=>{t&&(0,r.Zz)({environment:e,spaceId:t})}),[e,t])}},303751:(e,t,n)=>{n.d(t,{$:()=>a});var s=n(886628),i=n(88893);function a(e){return(0,s.VK)((()=>i.KU(e.state)),[e])}},316388:(e,t,n)=>{n.d(t,{Z:()=>r});var s=n(886628),i=n(739343),a=n(88893),o=n(288280);function r(){return(0,s.VK)((()=>{const e=o.subscriptionDataStoreInstance.state,t=e&&(0,a.XX)(e);return(0,i.Fk)(t)}),[])}},702607:(e,t,n)=>{n.d(t,{b:()=>c});n(757658),n(430541);var s,i=n(401898),a=n(421202),o=n(177420),r=n(394302),l=n(519889),d=n(76233);class c{}s=c,c.text=e=>new g(e),c.textValue=e=>"string"==typeof e?s.text(e).build():e,c.mentionDate=e=>new h(e),c.mentionUser=e=>new f(e),c.mentionGroup=(e,t)=>new S(e,t),c.mentionBot=e=>new f(e),c.mentionPage=e=>new f(e),c.mentionCustomEmoji=e=>new f(e),c.mentionTemplateVariable=e=>new y(e),c.mentionFormulaContextVariable=e=>new x(e),c.mentionFormulaPagePropertyVariable=e=>new v(e),c.mentionCitation=e=>new b(e),c.equation=e=>new m(e),c.concat=e=>new u(e);class u{constructor(e){this.build=()=>{const e=[];for(const t of this.tokens){const n=t.build();e.push(n[0])}return e},this.tokens=e}}class p{constructor(e){this.styles={},this.highlight=void 0,this.linkData=void 0,this.suggestionInsertTextDiscussionId=void 0,this.suggestionRemoveTextDiscussionId=void 0,this.bold=()=>(this.styles[d.GKr.Bold]=!0,this),this.italic=()=>(this.styles[d.GKr.Italic]=!0,this),this.strike=()=>(this.styles[d.GKr.Strike]=!0,this),this.code=()=>(this.styles[d.GKr.Code]=!0,this),this.underline=()=>(this.styles[d.GKr.Underline]=!0,this),this.color=e=>(this.highlight=e,this),this.link=e=>(this.linkData=e,this),this.suggestionInsertText=e=>(this.suggestionInsertTextDiscussionId=e,this),this.suggestionRemoveText=e=>(this.suggestionRemoveTextDiscussionId=e,this),this.build=()=>{const e=[];for(const t of(0,i.Yd)(this.styles))e.push([t]);return this.highlight&&e.push([d.GKr.Highlight,this.highlight]),this.linkData&&e.push([d.GKr.Link,this.linkData]),this.suggestionInsertTextDiscussionId&&e.push([d.GKr.SuggestionInsertText,this.suggestionInsertTextDiscussionId]),this.suggestionRemoveTextDiscussionId&&e.push([d.GKr.SuggestionRemoveText,this.suggestionRemoveTextDiscussionId]),this.onBuild(e)},this.onBuild=e}}class g extends p{constructor(e){super((t=>{if(this.url&&t.unshift(d.edl(this.url)),t.length>0){return[[e,t]]}return[[e]]})),this.url=void 0,this.link=e=>(this.url=e,this)}}class m extends p{constructor(e){super((t=>[d.qZ6(e,t)]))}}class h extends p{constructor(e){super((t=>{let n;"date"in e?n=this.getDateAnnotationData(e.date,e.reminder):"time"in e?n=this.getTimeAnnotationData(e.time,e.timeZone,e.reminder):(0,i.t1)(e);const s=d.pZr(n);return[d.YCD(s,t)]})),this.getDateString=e=>e.toISOString().split("T")[0],this.getTimeString=e=>e.toISOString().split("T")[1].slice(0,5)}getDateAnnotationData(e,t){if(Array.isArray(e)){const[n,s]=e;return{type:"daterange",start_date:this.getDateString(n),end_date:this.getDateString(s),reminder:t}}return{type:"date",start_date:this.getDateString(e),reminder:t}}getTimeAnnotationData(e,t,n){if(Array.isArray(e)){const[s,i]=e;return{type:"datetimerange",start_date:this.getDateString(s),start_time:this.getTimeString(s),end_date:this.getDateString(i),end_time:this.getTimeString(i),time_zone:t??"Etc/GMT",reminder:n}}return{type:"datetime",start_date:this.getDateString(e),start_time:this.getTimeString(e),time_zone:t??"Etc/GMT",reminder:n}}}class f extends p{constructor(e){super((t=>{let n;return e.table===l.KJ?n=d.tEo(e.id):e.table===o.cZ?n=d.CbB(e.id):e.table===a.iU?n=d.$0A(e.id,e.spaceId):e.table===r.p?n=d.YWq(e):(0,i.t1)(e),[d.YCD(n,t)]}))}}class y extends p{constructor(e){super((t=>{const n=d.WBu({type:e});return[d.YCD(n,t)]}))}}class x extends p{constructor(e){super((t=>{const n=d._QF(e);return[d.YCD(n,t)]}))}}class v extends p{constructor(e){super((t=>{const n=d.kbv(e);return[d.YCD(n,t)]}))}}class S extends p{constructor(e,t){super((n=>{const s=d.XIB(e,t);return[d.YCD(s,n)]}))}}class b extends p{constructor(e){super((t=>{const n=d.hNu(e);return[d.YCD(n,t)]}))}}},193078:(e,t,n)=>{n.d(t,{O:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("arrowsLeftRight",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M13.7791 3.59799C13.9305 3.74539 14.004 3.9196 13.9998 4.1206C13.9998 4.32607 13.9263 4.50251 13.7791 4.64992L10.5317 8.0268C10.3888 8.1742 10.2269 8.24791 10.0462 8.24791C9.84861 8.24791 9.68676 8.1809 9.56065 8.0469C9.43874 7.91736 9.37779 7.74986 9.37779 7.54439C9.37779 7.34785 9.44295 7.18481 9.57326 7.05528L10.9227 5.66834L11.8937 4.77722L10.5506 4.83082L2.66857 4.83082C2.4752 4.83082 2.31546 4.76382 2.18935 4.62982C2.06323 4.49581 2.00018 4.32831 2.00018 4.1273C2.00018 3.91736 2.06323 3.74539 2.18935 3.61139C2.31546 3.48185 2.4752 3.41708 2.66857 3.41708L10.5506 3.41709L11.8937 3.47069L10.9227 2.57286L9.57326 1.19263C9.44295 1.05863 9.37779 0.893355 9.37779 0.696817C9.37779 0.491345 9.43874 0.323841 9.56065 0.194305C9.68676 0.0647681 9.84861 -1.81463e-07 10.0462 -1.72827e-07C10.2269 -1.64925e-07 10.3888 0.0737017 10.5317 0.221105L13.7791 3.59799ZM2.21457 12.4087C2.06744 12.2568 1.99597 12.0804 2.00018 11.8794C2.00018 11.6784 2.07164 11.5042 2.21457 11.3568L5.47459 7.9799C5.61331 7.8325 5.77516 7.75879 5.96012 7.75879C6.1577 7.75879 6.31744 7.82356 6.43935 7.9531C6.56126 8.0871 6.62222 8.25684 6.62222 8.46231C6.62222 8.65438 6.55916 8.81742 6.43305 8.95142L5.08364 10.3317L4.10626 11.2295L5.44937 11.1759L13.3314 11.1759C13.5248 11.1759 13.6845 11.2429 13.8107 11.3769C13.9368 11.5109 13.9998 11.6784 13.9998 11.8794C13.9998 12.0849 13.9368 12.2546 13.8107 12.3886C13.6845 12.5226 13.5248 12.5896 13.3314 12.5896L5.44937 12.5896L4.10626 12.536L5.08364 13.4338L6.43305 14.8141C6.55916 14.9436 6.62222 15.1066 6.62222 15.3032C6.62222 15.5087 6.56126 15.6762 6.43935 15.8057C6.31744 15.9352 6.1577 16 5.96012 16C5.77516 16 5.61331 15.9285 5.47459 15.7856L2.21457 12.4087Z"})})},605336:(e,t,n)=>{n.d(t,{r:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("basicClock",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.541 7.919a.53.53 0 01-.39-.157.53.53 0 01-.157-.39c0-.155.053-.282.157-.383a.53.53 0 01.39-.157h2.905V2.895c0-.15.053-.278.158-.383a.521.521 0 01.382-.158.53.53 0 01.39.158.521.521 0 01.157.383v4.477a.53.53 0 01-.157.39.53.53 0 01-.39.157H4.541zm3.452 6.207a6.789 6.789 0 01-2.727-.554 7.124 7.124 0 01-2.256-1.524 7.277 7.277 0 01-1.525-2.256 6.788 6.788 0 01-.553-2.728c0-.966.184-1.875.553-2.727A7.241 7.241 0 015.258.557 6.788 6.788 0 017.987.003c.971 0 1.882.184 2.735.554.852.369 1.604.88 2.256 1.53a7.136 7.136 0 011.53 2.25c.37.852.555 1.761.555 2.727 0 .967-.185 1.876-.554 2.728a7.218 7.218 0 01-3.787 3.78 6.789 6.789 0 01-2.728.554zm0-1.395c.789 0 1.525-.145 2.208-.437a5.678 5.678 0 001.805-1.217 5.68 5.68 0 001.217-1.805c.291-.683.437-1.42.437-2.208a5.55 5.55 0 00-.437-2.2 5.66 5.66 0 00-3.029-3.029 5.567 5.567 0 00-2.208-.438c-.784 0-1.52.146-2.208.438A5.6 5.6 0 003.98 3.052a5.715 5.715 0 00-1.21 1.811 5.55 5.55 0 00-.437 2.201c0 .789.146 1.525.438 2.208a5.735 5.735 0 001.21 1.805 5.598 5.598 0 004.013 1.654z"})})},377058:(e,t,n)=>{n.d(t,{$:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("checkmark",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M10.0693 18.166C14.7759 18.166 18.6606 14.2812 18.6606 9.58301C18.6606 4.88477 14.7676 1 10.061 1C5.36279 1 1.48633 4.88477 1.48633 9.58301C1.48633 14.2812 5.37109 18.166 10.0693 18.166ZM9.13965 13.6836C8.82422 13.6836 8.56689 13.5508 8.33447 13.2437L6.30078 10.7783C6.15137 10.5874 6.07666 10.3965 6.07666 10.189C6.07666 9.75732 6.41699 9.40869 6.84863 9.40869C7.10596 9.40869 7.30518 9.5 7.521 9.77393L9.11475 11.791L12.5347 6.3125C12.7173 6.02197 12.9497 5.88086 13.2153 5.88086C13.6387 5.88086 14.0205 6.17139 14.0205 6.61133C14.0205 6.80225 13.9209 7.00977 13.8047 7.19238L9.91162 13.2437C9.729 13.5342 9.45508 13.6836 9.13965 13.6836Z"})})},101464:(e,t,n)=>{n.d(t,{k:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("chevronLeftRounded",{viewBox:"0 0 24 24",svg:(0,i.jsx)("path",{d:"M7.1875 11.8594C7.1875 12.0547 7.25781 12.2266 7.40625 12.375L13.6016 18.4297C13.7344 18.5703 13.9062 18.6406 14.1094 18.6406C14.5156 18.6406 14.8281 18.3359 14.8281 17.9297C14.8281 17.7266 14.7422 17.5547 14.6172 17.4219L8.92969 11.8594L14.6172 6.29688C14.7422 6.16406 14.8281 5.98438 14.8281 5.78906C14.8281 5.38281 14.5156 5.07812 14.1094 5.07812C13.9062 5.07812 13.7344 5.14844 13.6016 5.28125L7.40625 11.3438C7.25781 11.4844 7.1875 11.6641 7.1875 11.8594Z"})})},709107:(e,t,n)=>{n.d(t,{z:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("code",{viewBox:"0 0 16 16",svg:(0,i.jsx)("g",{children:(0,i.jsx)("path",{d:"M.056 8.122a.72.72 0 01.07-.306.91.91 0 01.204-.285l3.39-3.05a.745.745 0 01.542-.215.675.675 0 01.505.236c.14.158.202.337.188.537a.737.737 0 01-.264.51L1.855 8.122l2.836 2.573a.737.737 0 01.264.51.716.716 0 01-.188.537.694.694 0 01-.505.242.766.766 0 01-.543-.22L.33 8.708a.87.87 0 01-.204-.274.756.756 0 01-.07-.312zm6.43 5.21a.675.675 0 01-.446-.355.782.782 0 01-.027-.58l2.605-8.942c.068-.226.186-.384.354-.473a.714.714 0 01.559-.054.678.678 0 01.446.344.69.69 0 01.048.553l-2.621 8.98a.738.738 0 01-.35.463.711.711 0 01-.569.064zm9.453-5.21a.695.695 0 01-.065.312.869.869 0 01-.204.274l-3.39 3.056a.773.773 0 01-.547.22.677.677 0 01-.5-.242.707.707 0 01-.193-.537.738.738 0 01.263-.51l2.841-2.573-2.84-2.573a.738.738 0 01-.264-.51.7.7 0 01.193-.537.659.659 0 01.5-.236.75.75 0 01.548.214l3.389 3.051a.91.91 0 01.204.285c.047.1.068.202.064.306z"})})})},779709:(e,t,n)=>{n.d(t,{e:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("compose",{viewBox:"0 0 16 16",svg:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("path",{d:"M14.8359 2.52734L13.79 1.48828L14.2754 1.00977C14.5215 0.763672 14.9111 0.729492 15.1436 0.955078L15.3213 1.13965C15.5811 1.39258 15.5742 1.76855 15.3076 2.04199L14.8359 2.52734ZM6.68066 9.87598C6.52344 9.9375 6.35254 9.75977 6.4209 9.60254L7.03613 8.25586L13.2705 2.01465L14.3096 3.04688L8.0752 9.28809L6.68066 9.87598ZM4.09668 14.4355C2.62695 14.4355 1.85449 13.6836 1.85449 12.2207V4.37988C1.85449 2.91699 2.62695 2.1582 4.09668 2.1582H11.7119L10.3721 3.49805H4.17871C3.54297 3.49805 3.19434 3.83301 3.19434 4.49609V12.1045C3.19434 12.7676 3.54297 13.1025 4.17871 13.1025H11.9854C12.4502 13.1025 12.7988 12.7676 12.7988 12.1045V5.97266L14.1387 4.63281V12.2207C14.1387 13.6836 13.373 14.4355 12.0674 14.4355H4.09668Z"})})})},650209:(e,t,n)=>{n.d(t,{c:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("expandFullPage",{viewBox:"0 0 14 14",svg:(0,i.jsx)("path",{d:"M1.16211 6.20312C0.947917 6.20312 0.770182 6.13249 0.628906 5.99121C0.48763 5.84538 0.416992 5.66764 0.416992 5.45801V1.71191C0.416992 1.32454 0.524089 1.02376 0.738281 0.80957C0.957031 0.59082 1.26237 0.481445 1.6543 0.481445H5.44141C5.66016 0.481445 5.83789 0.552083 5.97461 0.693359C6.11589 0.834635 6.18652 1.01237 6.18652 1.22656C6.18652 1.44531 6.11589 1.62533 5.97461 1.7666C5.83333 1.90332 5.6556 1.97168 5.44141 1.97168H4.91504L2.76172 1.82812L4.43652 3.4209L6.41895 5.38965C6.4873 5.46257 6.53971 5.54688 6.57617 5.64258C6.61719 5.73372 6.6377 5.83171 6.6377 5.93652C6.6377 6.16439 6.5625 6.34896 6.41211 6.49023C6.26628 6.63151 6.07715 6.70215 5.84473 6.70215C5.63965 6.70215 5.46647 6.63151 5.3252 6.49023L3.35645 4.50098L1.76367 2.82617L1.90723 4.97266V5.45801C1.90723 5.6722 1.83659 5.84993 1.69531 5.99121C1.55859 6.13249 1.38086 6.20312 1.16211 6.20312ZM8.55176 13.6543C8.33757 13.6543 8.15755 13.5837 8.01172 13.4424C7.87044 13.3011 7.7998 13.1234 7.7998 12.9092C7.7998 12.695 7.87044 12.5173 8.01172 12.376C8.15755 12.2347 8.33757 12.1641 8.55176 12.1641H9.07812L11.2383 12.3076L9.5498 10.7148L7.58105 8.74609C7.50358 8.67318 7.44434 8.59115 7.40332 8.5C7.36686 8.4043 7.34863 8.30404 7.34863 8.19922C7.34863 7.97135 7.42383 7.78678 7.57422 7.64551C7.72461 7.50423 7.91374 7.43359 8.1416 7.43359C8.35579 7.43359 8.53125 7.50423 8.66797 7.64551L10.6299 9.62793L12.2295 11.3096L12.0859 9.16309V8.67773C12.0859 8.46354 12.1566 8.28581 12.2979 8.14453C12.4391 8.00326 12.6146 7.93262 12.8242 7.93262C13.0384 7.93262 13.2161 8.00326 13.3574 8.14453C13.5033 8.28581 13.5762 8.46354 13.5762 8.67773V12.417C13.5762 12.8089 13.4668 13.112 13.248 13.3262C13.0339 13.5449 12.7308 13.6543 12.3389 13.6543H8.55176Z"})})},130134:(e,t,n)=>{n.d(t,{c:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("export",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.0625 15.8174C2.32422 15.8174 1.76595 15.6305 1.3877 15.2568C1.00944 14.8831 0.820312 14.3294 0.820312 13.5957V6.86914C0.820312 6.13997 1.00944 5.58854 1.3877 5.21484C1.76595 4.83659 2.32422 4.64746 3.0625 4.64746H4.92871V5.99414H3.14453C2.82552 5.99414 2.58171 6.07845 2.41309 6.24707C2.24902 6.41113 2.16699 6.65951 2.16699 6.99219V13.4795C2.16699 13.8122 2.24902 14.0605 2.41309 14.2246C2.58171 14.3932 2.82552 14.4775 3.14453 14.4775H10.8486C11.1631 14.4775 11.4046 14.3932 11.5732 14.2246C11.7464 14.0605 11.833 13.8122 11.833 13.4795V6.99219C11.833 6.65951 11.7464 6.41113 11.5732 6.24707C11.4046 6.07845 11.1631 5.99414 10.8486 5.99414H9.07812V4.64746H10.9375C11.6758 4.64746 12.234 4.83659 12.6123 5.21484C12.9906 5.58854 13.1797 6.13997 13.1797 6.86914V13.5957C13.1797 14.3249 12.9906 14.8763 12.6123 15.25C12.234 15.6283 11.6758 15.8174 10.9375 15.8174H3.0625ZM7 11.3877C6.91797 11.3877 6.83822 11.374 6.76074 11.3467C6.68327 11.3148 6.60124 11.2578 6.51465 11.1758L4.21777 8.96094C4.10384 8.84245 4.04688 8.70801 4.04688 8.55762C4.04688 8.39811 4.09928 8.26823 4.2041 8.16797C4.31348 8.06771 4.44792 8.01758 4.60742 8.01758C4.7806 8.01758 4.92188 8.0791 5.03125 8.20215L5.98828 9.2207L6.43262 9.71973L6.36426 8.70117V1.61914C6.36426 1.45052 6.42578 1.30469 6.54883 1.18164C6.67643 1.05859 6.82682 0.99707 7 0.99707C7.17318 0.99707 7.32129 1.05859 7.44434 1.18164C7.57194 1.30469 7.63574 1.45052 7.63574 1.61914V8.70117L7.56738 9.71973L8.00488 9.2207L8.96191 8.20215C9.07585 8.0791 9.21712 8.01758 9.38574 8.01758C9.54069 8.01758 9.67285 8.06771 9.78223 8.16797C9.89616 8.26823 9.95312 8.39811 9.95312 8.55762C9.95312 8.70801 9.89388 8.84245 9.77539 8.96094L7.47852 11.1758C7.39648 11.2578 7.31673 11.3148 7.23926 11.3467C7.16178 11.374 7.08203 11.3877 7 11.3877Z"})})},726139:(e,t,n)=>{n.d(t,{K:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("externalLink",{viewBox:"0 0 17 16",svg:(0,i.jsx)("path",{d:"M4.94922 13.498C4.31641 13.498 3.83789 13.3359 3.51367 13.0117C3.18945 12.6914 3.02734 12.2188 3.02734 11.5938V4.46289C3.02734 3.83398 3.18945 3.35938 3.51367 3.03906C3.83789 2.71875 4.31641 2.55859 4.94922 2.55859H12.0449C12.6777 2.55859 13.1562 2.71875 13.4805 3.03906C13.8047 3.35938 13.9668 3.83398 13.9668 4.46289V11.5938C13.9668 12.2188 13.8047 12.6914 13.4805 13.0117C13.1562 13.3359 12.6777 13.498 12.0449 13.498H4.94922ZM5.01953 12.3438H11.9746C12.2441 12.3438 12.4512 12.2734 12.5957 12.1328C12.7402 11.9922 12.8125 11.7793 12.8125 11.4941V4.55664C12.8125 4.27539 12.7402 4.06445 12.5957 3.92383C12.4512 3.7832 12.2441 3.71289 11.9746 3.71289H5.01953C4.74609 3.71289 4.53711 3.7832 4.39258 3.92383C4.25195 4.06445 4.18164 4.27539 4.18164 4.55664V11.4941C4.18164 11.7793 4.25195 11.9922 4.39258 12.1328C4.53711 12.2734 4.74609 12.3438 5.01953 12.3438ZM10.334 9.54297C10.1855 9.54297 10.0664 9.49609 9.97656 9.40234C9.89062 9.30859 9.84766 9.17969 9.84766 9.01562V8.08398L9.93555 7.24609L9.15039 8.10156L7.09961 10.1465C6.99023 10.2559 6.85742 10.3105 6.70117 10.3105C6.55273 10.3105 6.42969 10.2637 6.33203 10.1699C6.23828 10.0762 6.19141 9.95117 6.19141 9.79492C6.19141 9.6582 6.24609 9.53516 6.35547 9.42578L8.41211 7.36914L9.2793 6.57227L8.47656 6.66602H7.48633C7.32617 6.66602 7.19727 6.62305 7.09961 6.53711C7.00586 6.45117 6.95898 6.33203 6.95898 6.17969C6.95898 6.03516 7.00586 5.91992 7.09961 5.83398C7.19727 5.74414 7.32422 5.69922 7.48047 5.69922H10.2227C10.4062 5.69922 10.5508 5.74609 10.6562 5.83984C10.7617 5.93359 10.8145 6.08398 10.8145 6.29102V9.00977C10.8145 9.16602 10.7695 9.29492 10.6797 9.39648C10.5938 9.49414 10.4785 9.54297 10.334 9.54297Z"})})},89036:(e,t,n)=>{n.d(t,{v:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("folder",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.4082 14.3672H13.7627C15.0684 14.3672 15.8271 13.6084 15.8271 12.1455V5.11816C15.8271 3.65527 15.0615 2.89648 13.585 2.89648H7.22754C6.73535 2.89648 6.44824 2.78027 6.07227 2.47266L5.67578 2.1582C5.19727 1.76172 4.8418 1.63184 4.13086 1.63184H2.19629C0.917969 1.63184 0.166016 2.37695 0.166016 3.8125V12.1455C0.166016 13.6084 0.931641 14.3672 2.4082 14.3672ZM1.50586 3.92871C1.50586 3.2998 1.84766 2.97168 2.46289 2.97168H3.77539C4.26074 2.97168 4.54102 3.08105 4.92383 3.39551L5.32031 3.7168C5.79199 4.10645 6.16113 4.23633 6.87207 4.23633H13.5098C14.1387 4.23633 14.4873 4.56445 14.4873 5.23438V5.63086H1.50586V3.92871ZM2.49023 13.0273C1.85449 13.0273 1.50586 12.6992 1.50586 12.0361V6.81348H14.4873V12.0361C14.4873 12.6992 14.1387 13.0273 13.5098 13.0273H2.49023Z"})})},519981:(e,t,n)=>{n.d(t,{V:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("handWave",{viewBox:"0 0 14 15",svg:(0,i.jsx)("path",{d:"M12.223 12.396c.888-.893 1.406-1.886 1.551-2.98.15-1.098-.08-2.288-.69-3.568l-1.552-3.275a2.264 2.264 0 00-.417-.594 1.28 1.28 0 00-.95-.404c-.36 0-.677.135-.95.404a1.211 1.211 0 00-.335.628c-.05.247-.023.502.082.766l.383.91c.013.031.011.056-.007.074-.023.019-.048.016-.075-.006L5.537.625C5.232.32 4.897.167 4.532.167c-.36-.005-.688.144-.984.444a1.115 1.115 0 00-.219.308 1.13 1.13 0 00-.096.349c-.291-.2-.59-.288-.895-.26-.3.023-.574.157-.82.403a1.278 1.278 0 00-.397.827c-.023.306.057.6.24.882a.876.876 0 00-.602.287c-.278.274-.415.584-.41.93.004.346.148.66.43.943l.458.458a.877.877 0 00-.348.09 1.115 1.115 0 00-.308.218 1.32 1.32 0 00-.37.615 1.29 1.29 0 00.021.684 1.6 1.6 0 00.397.635l4.231 4.232c.78.775 1.6 1.294 2.461 1.559.866.264 1.72.28 2.564.047.843-.232 1.622-.706 2.338-1.421zm-.841-.793c-.579.58-1.197.957-1.853 1.135-.651.178-1.317.15-1.996-.082-.674-.228-1.335-.663-1.982-1.305L1.497 7.297a.452.452 0 01-.143-.308.38.38 0 01.13-.3.403.403 0 01.3-.137c.119 0 .223.045.315.136l2.495 2.489a.45.45 0 00.355.15.476.476 0 00.342-.15.478.478 0 00.164-.349.461.461 0 00-.15-.362l-3.733-3.74a.446.446 0 01-.143-.3.38.38 0 01.13-.301.425.425 0 01.307-.137.45.45 0 01.315.137l3.48 3.486c.104.1.225.148.361.144a.476.476 0 00.342-.15c.1-.1.153-.22.157-.356a.47.47 0 00-.143-.362L2.283 2.799a.477.477 0 01-.143-.315.41.41 0 01.136-.307.39.39 0 01.301-.123c.119.004.223.05.315.136l4.04 4.034a.434.434 0 00.348.15.5.5 0 00.349-.15c.1-.1.153-.22.157-.356a.46.46 0 00-.137-.355L4.218 2.08a.425.425 0 01-.137-.308c0-.113.041-.216.123-.307a.41.41 0 01.308-.123c.114 0 .218.045.314.136L9.64 6.292c.136.141.282.212.437.212a.577.577 0 00.403-.178.71.71 0 00.192-.342c.032-.136.011-.298-.062-.485L9.748 3.25a.52.52 0 01-.014-.37.42.42 0 01.22-.232.362.362 0 01.32 0c.1.05.185.149.253.294l1.586 3.377c.52 1.121.702 2.108.547 2.96-.155.853-.58 1.627-1.278 2.325z"})})},180920:(e,t,n)=>{n.d(t,{X:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("integrationSecurity",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.996 16c.152 0 .37-.056.59-.16C13.407 13.481 15 12.242 15 9.38V3.421c0-.927-.38-1.263-1.205-1.59-.919-.36-4.03-1.408-4.931-1.696A3.17 3.17 0 0 0 7.996 0c-.278 0-.59.064-.86.136-.91.272-4.012 1.335-4.93 1.695C1.378 2.151 1 2.495 1 3.422V9.38c0 2.863 1.66 3.99 6.414 6.461.22.112.439.16.582.16Zm-.936-4.398c-.32 0-.573-.128-.817-.424L4.178 8.796a.86.86 0 0 1-.228-.568c0-.408.346-.744.775-.744.262 0 .464.096.683.352l1.627 1.96 3.481-5.294c.185-.272.421-.416.683-.416.421 0 .809.28.809.696 0 .184-.101.383-.22.56l-3.952 5.836a.915.915 0 0 1-.776.424Z"})})},343121:(e,t,n)=>{n.d(t,{f:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("key",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M14.757 4A5.724 5.724 0 009 9.748c0 2.364 1.389 4.456 3.586 5.335V23.6c0 .255.079.483.272.676l1.53 1.477a.578.578 0 00.808-.009l2.769-2.768a.598.598 0 000-.87l-1.591-1.574 2.232-2.232a.602.602 0 00-.017-.861l-2.171-2.18c2.628-1.116 4.087-3.13 4.087-5.511A5.733 5.733 0 0014.757 4zm0 5.344a1.55 1.55 0 01-1.547-1.547c0-.861.685-1.547 1.547-1.547a1.55 1.55 0 011.547 1.547 1.55 1.55 0 01-1.547 1.547z"})})},322962:(e,t,n)=>{n.d(t,{O:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("mention",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M1 9.86523C1 15.2939 4.72705 18.6807 9.98975 18.6807C11.3511 18.6807 12.4634 18.5312 13.1606 18.2905C13.6919 18.1079 13.8828 17.8174 13.8828 17.4521C13.8828 17.0537 13.6089 16.7715 13.1523 16.7715C13.0195 16.7715 12.8784 16.7881 12.6958 16.8213C11.9238 16.9873 11.2266 17.1118 10.2637 17.1118C5.74805 17.1118 2.74316 14.4058 2.74316 9.91504C2.74316 5.56543 5.61523 2.56055 9.88184 2.56055C13.7417 2.56055 16.7383 4.97607 16.7383 9.11816C16.7383 11.3511 15.9995 12.8452 14.8125 12.8452C14.0239 12.8452 13.5757 12.3472 13.5757 11.4839V6.44531C13.5757 5.84766 13.252 5.49072 12.6709 5.49072C12.0981 5.49072 11.7578 5.84766 11.7578 6.44531V7.10107H11.6333C11.21 6.09668 10.2305 5.49072 9.01855 5.49072C6.90186 5.49072 5.43262 7.28369 5.43262 9.89844C5.43262 12.5547 6.91846 14.3892 9.11816 14.3892C10.3799 14.3892 11.3013 13.7417 11.7578 12.6045H11.8823C12.1147 13.7168 13.0942 14.3809 14.4307 14.3809C16.8877 14.3809 18.3984 12.1895 18.3984 8.96045C18.3984 4.1626 14.8706 1 9.89014 1C4.66064 1 1 4.56104 1 9.86523ZM9.5415 12.7207C8.26318 12.7207 7.46631 11.6499 7.46631 9.92334C7.46631 8.21338 8.27148 7.14258 9.5498 7.14258C10.8364 7.14258 11.6582 8.20508 11.6582 9.89844C11.6582 11.625 10.8281 12.7207 9.5415 12.7207Z"})})},128495:(e,t,n)=>{n.d(t,{v:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("personCircle",{viewBox:"0 0 18 17",svg:(0,i.jsx)("path",{d:"M8.99219 16.6797C10.0964 16.6797 11.1354 16.4688 12.1094 16.0469C13.0833 15.6302 13.9427 15.0495 14.6875 14.3047C15.4323 13.5599 16.0156 12.7005 16.4375 11.7266C16.8594 10.7526 17.0703 9.71354 17.0703 8.60938C17.0703 7.50521 16.8594 6.46615 16.4375 5.49219C16.0156 4.51823 15.4323 3.66146 14.6875 2.92188C13.9427 2.17708 13.0833 1.59375 12.1094 1.17188C11.1354 0.75 10.0938 0.539062 8.98438 0.539062C7.88021 0.539062 6.84115 0.75 5.86719 1.17188C4.89844 1.59375 4.04167 2.17708 3.29688 2.92188C2.55729 3.66146 1.97656 4.51823 1.55469 5.49219C1.13281 6.46615 0.921875 7.50521 0.921875 8.60938C0.921875 9.71354 1.13281 10.7526 1.55469 11.7266C1.97656 12.7005 2.55729 13.5599 3.29688 14.3047C4.04167 15.0495 4.90104 15.6302 5.875 16.0469C6.84896 16.4688 7.88802 16.6797 8.99219 16.6797ZM8.99219 15.0859C8.09635 15.0859 7.25521 14.9193 6.46875 14.5859C5.6875 14.2526 5 13.7891 4.40625 13.1953C3.81771 12.6016 3.35677 11.9141 3.02344 11.1328C2.6901 10.3516 2.52344 9.51042 2.52344 8.60938C2.52344 7.71354 2.6901 6.875 3.02344 6.09375C3.35677 5.30729 3.81771 4.61719 4.40625 4.02344C4.99479 3.42969 5.67969 2.96615 6.46094 2.63281C7.2474 2.29948 8.08854 2.13281 8.98438 2.13281C9.88542 2.13281 10.7266 2.29948 11.5078 2.63281C12.2943 2.96615 12.9844 3.42969 13.5781 4.02344C14.1719 4.61719 14.6354 5.30729 14.9688 6.09375C15.3021 6.875 15.4688 7.71354 15.4688 8.60938C15.4688 9.51042 15.3021 10.3516 14.9688 11.1328C14.6354 11.9141 14.1719 12.6016 13.5781 13.1953C12.9844 13.7891 12.2969 14.2526 11.5156 14.5859C10.7344 14.9193 9.89323 15.0859 8.99219 15.0859ZM14.2031 13.7656L14.1719 13.6328C14.0052 13.2474 13.6849 12.8776 13.2109 12.5234C12.7422 12.1641 12.1484 11.8724 11.4297 11.6484C10.7161 11.4193 9.90365 11.3047 8.99219 11.3047C8.09115 11.3047 7.28125 11.4193 6.5625 11.6484C5.84375 11.8724 5.2474 12.1641 4.77344 12.5234C4.30469 12.8776 3.98698 13.2448 3.82031 13.625L3.78906 13.7656C4.27865 14.2188 4.83333 14.599 5.45312 14.9062C6.07292 15.2188 6.69271 15.4557 7.3125 15.6172C7.9375 15.7786 8.4974 15.8594 8.99219 15.8594C9.49219 15.8594 10.0521 15.7786 10.6719 15.6172C11.2917 15.4557 11.9115 15.2188 12.5312 14.9062C13.151 14.599 13.7083 14.2188 14.2031 13.7656ZM8.99219 10.0156C9.4974 10.0208 9.95312 9.89583 10.3594 9.64062C10.7656 9.38021 11.0885 9.02604 11.3281 8.57812C11.5677 8.125 11.6875 7.61979 11.6875 7.0625C11.6875 6.54167 11.5651 6.0625 11.3203 5.625C11.0807 5.18229 10.7578 4.82812 10.3516 4.5625C9.95052 4.29688 9.4974 4.16406 8.99219 4.16406C8.49219 4.16406 8.03646 4.29688 7.625 4.5625C7.21875 4.82812 6.89583 5.18229 6.65625 5.625C6.41667 6.0625 6.29948 6.54167 6.30469 7.0625C6.3099 7.61979 6.42969 8.1224 6.66406 8.57031C6.90365 9.01302 7.22656 9.36458 7.63281 9.625C8.03906 9.88021 8.49219 10.0104 8.99219 10.0156Z"})})},276927:(e,t,n)=>{n.d(t,{p:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("playCircle",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M9.99316 17.126C9.02702 17.126 8.11784 16.9414 7.26562 16.5723C6.41341 16.2077 5.66146 15.6995 5.00977 15.0479C4.36263 14.3962 3.85449 13.6442 3.48535 12.792C3.11621 11.9398 2.93164 11.0306 2.93164 10.0645C2.93164 9.09831 3.11621 8.18913 3.48535 7.33691C3.85449 6.4847 4.36263 5.73503 5.00977 5.08789C5.66146 4.4362 6.41113 3.92578 7.25879 3.55664C8.111 3.1875 9.02018 3.00293 9.98633 3.00293C10.957 3.00293 11.8685 3.1875 12.7207 3.55664C13.5729 3.92578 14.3249 4.4362 14.9766 5.08789C15.6283 5.73503 16.1387 6.4847 16.5078 7.33691C16.877 8.18913 17.0615 9.09831 17.0615 10.0645C17.0615 11.0306 16.877 11.9398 16.5078 12.792C16.1387 13.6442 15.6283 14.3962 14.9766 15.0479C14.3249 15.6995 13.5729 16.2077 12.7207 16.5723C11.8685 16.9414 10.9593 17.126 9.99316 17.126ZM8.7627 12.8535L12.707 10.5293C12.821 10.4564 12.8962 10.363 12.9326 10.249C12.9736 10.1305 12.9736 10.012 12.9326 9.89355C12.8962 9.77507 12.821 9.68392 12.707 9.62012L8.7627 7.28223C8.63965 7.20931 8.51204 7.17969 8.37988 7.19336C8.25228 7.20703 8.14518 7.25488 8.05859 7.33691C7.97201 7.41439 7.92871 7.52376 7.92871 7.66504V12.4707C7.92871 12.612 7.97201 12.7259 8.05859 12.8125C8.14518 12.8945 8.25 12.9424 8.37305 12.9561C8.50065 12.9652 8.63053 12.931 8.7627 12.8535Z"})})},761361:(e,t,n)=>{n.d(t,{E:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("plusThicker",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.13477 8.06445C2.13477 8.63867 2.59961 9.10352 3.17383 9.10352H6.96777V12.8975C6.96777 13.4648 7.42578 13.9365 8 13.9365C8.57422 13.9365 9.03906 13.4648 9.03906 12.8975V9.10352H12.833C13.4004 9.10352 13.8652 8.63867 13.8652 8.06445C13.8652 7.49707 13.4004 7.03223 12.833 7.03223H9.03906V3.23828C9.03906 2.6709 8.57422 2.19922 8 2.19922C7.42578 2.19922 6.96777 2.6709 6.96777 3.23828V7.03223H3.17383C2.59961 7.03223 2.13477 7.49707 2.13477 8.06445Z"})})},479198:(e,t,n)=>{n.d(t,{n:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("refresh",{viewBox:"0 0 24 20",svg:(0,i.jsx)("path",{d:"M0.19663 9.99023C-0.184229 10.5273-0.00844799 11.0059 0.694677 11.0059L2.04233 11.0059C2.56968 15.9766 6.85679 19.9219 11.9447 19.9219C14.9232 19.9219 17.6185 18.5645 19.4544 16.4551C19.8158 16.0352 19.7669 15.5078 19.3861 15.2344C19.0052 14.9609 18.5365 15.0586 18.224 15.4199C16.7103 17.168 14.4642 18.2617 11.9447 18.2617C7.68686 18.2617 4.22007 15.1074 3.72202 11.0059L5.1771 11.0059C5.87046 11.0059 6.04624 10.5273 5.67515 10L3.48765 6.88477C3.17515 6.43555 2.7064 6.42578 2.38413 6.88477ZM4.44468 3.4668C4.07358 3.88672 4.12241 4.4043 4.51304 4.67773C4.8939 4.95117 5.35288 4.86328 5.67515 4.50195C7.19858 2.76367 9.44468 1.66016 11.9447 1.66016C16.1927 1.66016 19.6595 4.81445 20.1673 8.92578L18.7123 8.92578C18.0189 8.92578 17.8431 9.39453 18.2142 9.93164L20.4017 13.0469C20.7142 13.4961 21.183 13.5059 21.5052 13.0469L23.683 9.94141C24.0736 9.39453 23.888 8.92578 23.1849 8.92578L21.847 8.92578C21.3099 3.95508 17.0326 0 11.9447 0C8.96616 0 6.28061 1.34766 4.44468 3.4668Z"})})},418101:(e,t,n)=>{n.d(t,{b:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("reopen",{viewBox:"0 0 14 14",svg:(0,i.jsx)("path",{d:"M1.64844 7.88477C1.64844 10.791 3.98047 13.1289 6.88086 13.1289C9.78125 13.1289 12.1133 10.791 12.1133 7.88477C12.1133 7.53906 11.873 7.29297 11.5273 7.29297C11.1934 7.29297 10.9707 7.53906 10.9707 7.88477C10.9707 10.1582 9.14844 11.9805 6.88086 11.9805C4.61328 11.9805 2.79688 10.1582 2.79688 7.88477C2.79688 5.59961 4.60156 3.78906 6.86328 3.78906C7.25 3.78906 7.60742 3.81836 7.90625 3.88281L6.3125 5.46484C6.20703 5.57617 6.1543 5.69922 6.1543 5.85156C6.1543 6.17383 6.39453 6.41992 6.71094 6.41992C6.875 6.41992 7.00977 6.36719 7.10938 6.26172L9.51758 3.83594C9.64062 3.71289 9.69922 3.57227 9.69922 3.41406C9.69922 3.26172 9.63477 3.10938 9.51758 2.99219L7.10938 0.548828C7.00977 0.4375 6.875 0.378906 6.71094 0.378906C6.39453 0.378906 6.1543 0.636719 6.1543 0.953125C6.1543 1.10547 6.20703 1.24023 6.30664 1.3457L7.72461 2.74609C7.4668 2.69336 7.16797 2.66406 6.86328 2.66406C3.96875 2.66406 1.64844 4.98438 1.64844 7.88477Z"})})},172263:(e,t,n)=>{n.d(t,{_:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("settingsUpgrade",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M9.969 17.938c4.36 0 7.969-3.618 7.969-7.97C17.938 5.61 14.32 2 9.96 2 5.609 2 2 5.61 2 9.969c0 4.351 3.617 7.969 7.969 7.969zm0-1.329a6.609 6.609 0 01-6.633-6.64 6.602 6.602 0 016.625-6.64 6.627 6.627 0 016.648 6.64 6.61 6.61 0 01-6.64 6.64zm0-2.734a.562.562 0 00.586-.586V9.383l-.063-1.656.797.945.922.937a.52.52 0 00.414.172c.32 0 .57-.242.57-.562a.566.566 0 00-.164-.406L10.43 6.219c-.149-.149-.29-.227-.461-.227-.164 0-.297.07-.453.227l-2.61 2.593a.555.555 0 00-.148.407c0 .32.242.562.562.562a.572.572 0 00.414-.172l.93-.937.781-.938-.062 1.649v3.906c0 .344.25.586.586.586z"})})},359584:(e,t,n)=>{n.d(t,{r:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("settingsUpgradeFilled",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M10 19c4.935 0 9.009-4.073 9.009-9 0-4.926-4.082-9-9.018-9C5.065 1 1 5.074 1 10c0 4.927 4.074 9 9 9zm0-4.422c-.47 0-.818-.33-.818-.8v-4.23l.087-1.863-.81 1.01-1 1.053a.762.762 0 01-.558.235c-.435 0-.757-.314-.757-.74 0-.218.07-.392.218-.549l2.994-3.029c.2-.217.4-.313.644-.313.261 0 .461.104.662.313l2.976 3.03a.73.73 0 01.227.548c0 .426-.322.74-.758.74a.73.73 0 01-.557-.235l-.992-1.045-.818-1.027.087 1.871v4.23c0 .47-.348.801-.827.801z"})})},150226:(e,t,n)=>{n.d(t,{I:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("sidebarTemplates",{viewBox:"0 0 14 15",svg:(0,i.jsx)("g",{children:(0,i.jsx)("path",{d:"M.11 5.918c0 2.367 1.628 4.348 3.837 4.916v1.412c0 1.283.686 1.969 1.987 1.969h5.97c1.295 0 1.987-.686 1.987-1.969V6.24c0-1.289-.692-1.969-1.987-1.969H10.07A5.112 5.112 0 005.23.85C2.4.85.11 3.117.11 5.918zm1.247 0c0-2.11 1.729-3.826 3.873-3.826a3.87 3.87 0 013.493 2.18h-2.79c-1.3 0-1.986.68-1.986 1.968v3.293a3.83 3.83 0 01-2.59-3.615zm4.688 6.99c-.516 0-.791-.258-.791-.797V6.375c0-.54.275-.797.79-.797h5.749c.516 0 .791.258.791.797v5.736c0 .54-.275.797-.791.797H6.045z"})})})},301763:(e,t,n)=>{n.d(t,{V:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("tag",{viewBox:"0 0 17 17",svg:(0,i.jsx)("path",{d:"M9.49219 15.4951C8.47363 16.5205 7.40039 16.5273 6.36133 15.4883L2 11.1406C0.960938 10.1084 0.981445 9.02148 1.99316 8.00977L8.70605 1.31055C9.23926 0.777344 9.54688 0.71582 10.3193 0.71582H12.917C13.6689 0.71582 13.9219 0.900391 14.4756 1.44727L16.041 3.0127C16.5947 3.56641 16.7725 3.81934 16.7725 4.57129V7.16895C16.7725 7.94141 16.7178 8.25586 16.1846 8.78906L9.49219 15.4951ZM8.62402 14.4697L15.248 7.83887C15.3779 7.70215 15.4531 7.57227 15.4531 7.34668V4.57812C15.4531 4.37305 15.3779 4.23633 15.2412 4.09961L13.3887 2.24707C13.2588 2.11035 13.1152 2.03516 12.9102 2.03516H10.1484C9.92285 2.03516 9.79297 2.11035 9.65625 2.25391L3.02539 8.87109C2.57422 9.32227 2.56055 9.80078 3.03223 10.2725L7.22266 14.4629C7.69434 14.9277 8.16602 14.9209 8.62402 14.4697ZM12.0693 6.40332C11.5088 6.40332 11.0918 5.96582 11.0918 5.41895C11.0918 4.87207 11.5088 4.44141 12.0693 4.44141C12.6299 4.44141 13.0469 4.87207 13.0469 5.41895C13.0469 5.96582 12.6299 6.40332 12.0693 6.40332Z"})})},163048:(e,t,n)=>{n.d(t,{C:()=>a});n(667294);var s=n(745238),i=n(785893);const a=(0,s.IU)("thinPlus",{viewBox:"0 0 14 14",svg:(0,i.jsx)("path",{d:"M 7.75 0L 6.25 0L 6.25 6.25L 0 6.25L 0 7.75L 6.25 7.75L 6.25 14L 7.75 14L 7.75 7.75L 14 7.75L 14 6.25L 7.75 6.25L 7.75 0Z"})})}}]);