"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[35413],{520993:(e,n,t)=>{t.d(n,{Z:()=>h,a:()=>f});var a=t(730120),o=t(667294),s=t(886628),i=t(724405),r=t(960897),l=t(709291),c=t(137810),u=t(135253),d=t(91376),p=t(772770),m=t(421051),y=t(170060),b=t(88893),v=t(301978),g=t(785893);function f(e){const{legacyColor:n}=e,t=(0,i.yK)((e=>({bannerContent:{alignItems:"center",display:"flex",flexWrap:"wrap",gap:6,justifyContent:"space-between",padding:"12px 6px",whiteSpace:"normal",width:"100%",lineHeight:1.35},callToAction:{cursor:"pointer",fontWeight:c.Z.fontWeight.semibold}})),[]),a=(0,s.VK)((()=>(0,y.$V)()),[]),o=(0,g.jsx)(l.FormattedMessage,{id:"app.banner.trial_subscription.add_payment_method",defaultMessage:"Add a payment method to continue using your free trial. You will not be charged until the end of your trial period."}),r=(0,g.jsx)(l.FormattedMessage,{id:"app.banner.trial_subscription.add_payment_method.call_to_action",defaultMessage:"Add payment method"});return a?(0,g.jsx)(v.j,{label:o,display:"full-width",actions:[{label:r,onClick:()=>{d.r$({currentTab:"billing"})}}],tint:(0,p.X)(n)}):(0,g.jsxs)("div",{style:t.bannerContent,children:[(0,g.jsx)("div",{children:o}),(0,g.jsx)("div",{style:t.callToAction,onClick:()=>d.r$({currentTab:"billing"}),children:r})]})}function h(e){const{subscriptionDataStore:n}=e,{showBanner:t}=(0,s.VK)((()=>{const e=b.XX(n.state);return e&&e.trialEnd?r.Sf.includes(e.plan)||e.paymentMethodType?{showBanner:!1}:{showBanner:a.ou.now()>a.ou.fromSeconds(e.trialEnd).minus({days:15})}:{showBanner:!1}}),[n]);return o.useEffect((()=>(t?u.Bw({bannerStore:m.Z,id:"SubscriptionTrialAddPaymentMethodBanner",contentKey:"subscription_trial_add_payment_method",styleKey:p.v.Yellow,prepend:!0}):u.qL({bannerStore:m.Z,id:"SubscriptionTrialAddPaymentMethodBanner"}),()=>{u.qL({bannerStore:m.Z,id:"SubscriptionTrialAddPaymentMethodBanner"})})),[t]),null}},915328:(e,n,t)=>{t.d(n,{J:()=>A,Z:()=>K});var a=t(667294),o=t(800480),s=t(886628),i=t(724405),r=t(292595),l=t(709291),c=t(401898),u=t(137810),d=t(135253),p=t(91376),m=t(301978),y=(t(95477),t(730459)),b=t(772770),v=t(548779),g=t(660606),f=t(421051),h=t(170060),w=t(785893);const _={updatePaymentMethod:(0,w.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.update_payment_method",defaultMessage:"View unpaid invoice"}),viewWorkspaceOwner:(0,w.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.view_workspace_owner",defaultMessage:"View workspace owner"}),confirmPayment:(0,w.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.confirm_payment",defaultMessage:"Confirm payment"})};function x(){return()=>{p.r$()}}function T(e){if(void 0!==e)return()=>{e&&window.open(e,"_blank")}}function k(e){const{messageType:n,overdueInvoiceCount:t=1}=e;switch(n){case"past_due_owner":return(0,w.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.payment_failed.past_due.workspace_owner",defaultMessage:"We couldn’t process {overdueInvoiceCount, plural, one {your last payment} other {{overdueInvoiceCount} payments}}. Please update your payment method or you may lose access to Notion soon.",values:{overdueInvoiceCount:t}});case"past_due_member":return(0,w.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.payment_failed.past_due.member",defaultMessage:"Please contact a workspace owner to update your payment method or you may lose access to Notion soon."});case"unpaid_owner":return(0,w.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.payment_failed.unpaid.workspace_owner",defaultMessage:"Access to Notion is limited to viewing because we couldn’t process {overdueInvoiceCount, plural, one {your last payment} other {{overdueInvoiceCount} payments}}. Update your payment information to restore full access.",values:{overdueInvoiceCount:t}});case"unpaid_member":return(0,w.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.payment_failed.unpaid.member",defaultMessage:"Access to Notion is limited to viewing. Contact a workspace owner to update your workspace’s payment method."});default:(0,c.t1)(n)}}function C(e){const{messageType:n,overdueInvoiceCount:t=1}=e;switch(n){case"past_due_owner":return(0,w.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.confirmation_required.past_due.workspace_owner",defaultMessage:"Please confirm {overdueInvoiceCount, plural, one {your subscription payment} other {{overdueInvoiceCount} payments}} or you may lose access to Notion soon.",values:{overdueInvoiceCount:t}});case"unpaid_owner":return(0,w.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.confirmation_required.unpaid.workspace_owner",defaultMessage:"Access to Notion is limited to viewing. Confirm {overdueInvoiceCount, plural, one {your subscription payment} other {{overdueInvoiceCount} payments}} to restore full access.",values:{overdueInvoiceCount:t}});case"unpaid_member":return(0,w.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.confirmation_required.unpaid.member",defaultMessage:"Access to Notion is limited to viewing. Contact a workspace owner to update your workspace’s payment method."});default:(0,c.t1)(n)}}function j(e){if(!e.data)return;const{isWorkspaceOwner:n}=e,{invoiceHostedUrl:t,overdueInvoiceCount:a,bannerKey:o}=e.data;switch(o){case"past_due":return function(e){const{isWorkspaceOwner:n,invoiceHostedUrl:t,overdueInvoiceCount:a}=e,o=b.v.Yellow;return n?{bannerStyleKey:o,messageType:"past_due_owner",messageText:k({overdueInvoiceCount:a,messageType:"past_due_owner"}),callToActionText:_.updatePaymentMethod,callToActionHandler:T(t)}:{bannerStyleKey:o,messageType:"past_due_member",messageText:k({overdueInvoiceCount:a,messageType:"past_due_member"}),callToActionText:_.viewWorkspaceOwner,callToActionHandler:x()}}({isWorkspaceOwner:n,invoiceHostedUrl:t,overdueInvoiceCount:a});case"unpaid":return function(e){const{isWorkspaceOwner:n,invoiceHostedUrl:t,overdueInvoiceCount:a}=e,o=b.v.LightRed;return n?{bannerStyleKey:o,messageType:"unpaid_owner",messageText:k({overdueInvoiceCount:a,messageType:"unpaid_owner"}),callToActionText:_.updatePaymentMethod,callToActionHandler:T(t)}:{bannerStyleKey:o,messageType:"unpaid_member",messageText:k({overdueInvoiceCount:a,messageType:"unpaid_member"}),callToActionText:_.viewWorkspaceOwner,callToActionHandler:x()}}({isWorkspaceOwner:n,invoiceHostedUrl:t,overdueInvoiceCount:a});default:(0,c.t1)(o)}}function S(e){if(!e.data)return;const{isWorkspaceOwner:n}=e,{invoiceHostedUrl:t,bannerKey:a}=e.data;switch(a){case"past_due":return function(e,n,t){if(e)return{bannerStyleKey:b.v.Yellow,messageType:"past_due_owner",messageText:C({overdueInvoiceCount:t,messageType:"past_due_owner"}),callToActionText:_.confirmPayment,callToActionHandler:T(n)}}(n,t);case"unpaid":return function(e,n,t){const a=b.v.LightRed;return e?{bannerStyleKey:a,messageType:"unpaid_owner",messageText:C({overdueInvoiceCount:t,messageType:"unpaid_owner"}),callToActionText:_.confirmPayment,callToActionHandler:T(n)}:{bannerStyleKey:a,messageType:"unpaid_member",messageText:C({overdueInvoiceCount:t,messageType:"unpaid_member"}),callToActionText:_.viewWorkspaceOwner,callToActionHandler:x()}}(n,t);default:(0,c.t1)(a)}}function I(e){if(void 0===(null==e?void 0:e.data))return;const{overdueReason:n}=e.data;if(n)switch(n){case"payment_failed":return j(e);case"confirmation_required":return S(e);default:(0,c.t1)(n)}}function M(e){if(!(0,h.u6)())return;const n=g.Z.state,t=(0,v.Fn)(e);return n&&n.data?{...n,isWorkspaceOwner:t}:void 0}function K(){const e=(0,o.O7)(),n=(0,s.VK)((()=>M(e)),[e]),t=(0,a.useMemo)((()=>I(n)),[n]);return a.useEffect((()=>(["local","development","staging"].includes("production")&&(0,r.exposeDebugValue)("billingStatus",n),null!=n&&n.data&&t?(d.Bw({bannerStore:f.Z,id:"BillingSubscriptionBanner",contentKey:"billing_subscription_status",styleKey:t.bannerStyleKey,prepend:!0}),(0,y.j)({environment:e,event:{eventName:"billing_subscription_banner_displayed",eventProperties:{isWorkspaceOwner:n.isWorkspaceOwner,...n.data}}})):d.qL({bannerStore:f.Z,id:"BillingSubscriptionBanner"}),()=>{d.qL({bannerStore:f.Z,id:"BillingSubscriptionBanner"})})),[e,n,t]),null}function A(e){const{legacyColor:n}=e,t=(0,s.VK)((()=>(0,h.$V)()),[]),r=(0,o.O7)(),l=(0,s.VK)((()=>M(r)),[r]),c=(0,a.useMemo)((()=>I(l)),[l]),d=null==c?void 0:c.callToActionText,p=null==c?void 0:c.callToActionHandler,v=(0,i.yK)((e=>({bannerContent:{alignItems:"center",display:"flex",flexWrap:"wrap",gap:6,justifyContent:"space-between",padding:"12px 6px",whiteSpace:"normal",width:"100%",lineHeight:1.35},callToAction:{cursor:"pointer",fontWeight:u.Z.fontWeight.semibold}})),[]),g=(0,a.useCallback)((e=>{void 0!==p&&p(e),null!=l&&l.data&&(0,y.j)({environment:r,event:{eventName:"billing_subscription_banner_action",eventProperties:{isWorkspaceOwner:l.isWorkspaceOwner,...l.data}}})}),[r,p,l]);return c?t?(0,w.jsx)(m.j,{label:c.messageText,display:"full-width",actions:[{label:d,onClick:e=>g(e)}],tint:(0,b.X)(n)}):(0,w.jsxs)("div",{style:v.bannerContent,children:[(0,w.jsx)("div",{children:c.messageText}),void 0!==p?(0,w.jsx)("div",{style:v.callToAction,onClick:g,children:d}):null]}):null}},367181:(e,n,t)=>{t.d(n,{T:()=>_,Z:()=>x});var a=t(667294),o=t(800480),s=t(886628),i=t(724405),r=t(709291),l=t(401898),c=t(286572),u=t(135253),d=t(301978),p=t(772770),m=t(100859),y=t(883165),b=t(80444),v=t(880148),g=t(421051),f=t(206258),h=t(170060),w=t(785893);function _(e){const{legacyColor:n}=e,t=(0,s.VK)((()=>(0,h.$V)()),[]),a=(0,o.O7)(),c=(0,s.VK)((()=>a.currentUser.id),[a]),u=(0,i.yK)((e=>({bannerContent:{alignItems:"center",display:"flex",flexWrap:"wrap",gap:6,justifyContent:"space-between",padding:"12px 6px",whiteSpace:"normal",width:"100%",lineHeight:1.35}})),[]),b=(0,m.r)(),g=(0,y.r_)(b),_=(0,s.VK)((()=>v.Z.state.visible_banners),[]),x=(0,s.VK)((()=>{if(!b||!c||!g)return null;if(_&&_.length>0){const e=_[0],n=f.$I.createChildStore(b,{id:e,table:"subscription_banner",spaceId:b.id});if(!n.isDefined())return null;const t=n.getBannerText();if(t)return(0,w.jsx)("span",{children:t});const a=Boolean(null==g?void 0:g.isWorkspaceOwner());return function(e,n){switch(e){case"uncollectible_past_due":return n?(0,w.jsx)(r.FormattedMessage,{id:"subscription.payment_uncollectible.past_due.workspace_owner",defaultMessage:"Your workspace may lose editing capabilities soon due to past-due invoices. Please remit payment to avoid losing access to Notion. If you have any questions, please reach out to billing@makenotion.com."}):(0,w.jsx)(r.FormattedMessage,{id:"subscription.payment_uncollectible.past_due.member",defaultMessage:"Your workspace may lose editing capabilities soon due to past-due invoices. Please remit payment to avoid losing access to Notion. If you have any questions, please reach out to billing@makenotion.com."});case"uncollectible_unpaid":return n?(0,w.jsx)(r.FormattedMessage,{id:"subscription.payment_uncollectible.unpaid.workspace_owner",defaultMessage:"Your workspace is unable to edit due to past-due invoices. Please remit payment to avoid losing access to Notion. If you have any questions, please reach out to billing@makenotion.com."}):(0,w.jsx)(r.FormattedMessage,{id:"subscription.payment_uncollectible.unpaid.member",defaultMessage:"Your workspace is unable to edit due to past-due invoices. Please remit payment to avoid losing access to Notion. If you have any questions, please reach out to billing@makenotion.com."});default:(0,l.t1)(e)}}(n.getBannerKey(),a)}return null}),[c,b,g,_]);return x?t?(0,w.jsx)(d.j,{label:x,display:"full-width",actions:[],tint:(0,p.X)(n)}):(0,w.jsx)("div",{style:u.bannerContent,children:(0,w.jsx)("div",{children:x})}):null}function x(){const e=(0,o.O7)(),n=(0,s.VK)((()=>b.default.state.currentSpaceStore),[]),t=(0,s.VK)((()=>v.Z.state.visible_banners),[]),[i,r,d,m,y]=(0,s.VK)((()=>{if(!n)return[];if(t&&t.length>0){const e=t[0],a=f.$I.createChildStore(n,{id:e,table:"subscription_banner",spaceId:n.id});if(!a.isDefined())return[];const o=a.getBannerKey(),s=a.getAudience(),i=a.getBannerText();switch(o){case"uncollectible_past_due":return[e,p.v.Yellow,o,s,i];case"uncollectible_unpaid":return[e,p.v.LightRed,o,s,i];default:(0,l.t1)(o)}}return[]}),[n,t]);return a.useEffect((()=>{if(i&&r){if(u.Bw({bannerStore:g.Z,id:"SubscriptionUncollectibleBanner",contentKey:"subscription_uncollectible",styleKey:r,prepend:!0}),d&&m){const n={banner:d,audience:m,text:""};y&&(n.text=y),c.j(e,{name:"subscription_uncollectible_banner_displayed",args:n})}}else u.qL({bannerStore:g.Z,id:"SubscriptionUncollectibleBanner"});return()=>{u.qL({bannerStore:g.Z,id:"SubscriptionUncollectibleBanner"})}}),[e,i,r,d,m,y]),null}},159260:(e,n,t)=>{t.d(n,{U:()=>T,Z:()=>k});var a=t(730120),o=t(667294),s=t(800480),i=t(886628),r=t(724405),l=t(841892),c=t(937850),u=t(401898),d=t(454642),p=t(135253),m=(t(547307),t(568785)),y=t(301978),b=(t(95477),t(772770)),v=t(80444),g=t(421051),f=t(897630),h=t(170060),w=t(88893),_=t(288280),x=t(785893);function T(e){const{legacyColor:n}=e,{testClock:t,billingInterval:p}=(0,i.VK)((()=>{const e=_.subscriptionDataStoreInstance.state,n=w.aS(e);return n?{testClock:n.testClock,billingInterval:n.interval}:{testClock:void 0,billingInterval:void 0}}),[]),g=(0,i.VK)((()=>{var e;return null===(e=v.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),[T,k]=(0,o.useState)(1),[j,S]=(0,o.useState)("second"),[I,M]=(0,o.useState)(!1),K=(0,s.O7)(),A=(0,r.yK)((e=>({bannerContent:{alignItems:"center",display:"flex",gap:6,justifyContent:"space-between",padding:"12px 6px",whiteSpace:"normal",width:"100%",lineHeight:1.35},message:{flexGrow:1,textWrap:"wrap"}})),[]),B=(0,i.VK)((()=>(0,h.$V)()),[]);if(!t||!p||!g)return null;const W=a.ou.fromSeconds(t.frozen_time),O=async()=>{const e=a.nL.fromObject({[j]:T}),n=function(e){switch(e){case"month":return a.nL.fromObject({months:2});case"year":return a.nL.fromObject({years:2});default:(0,u.t1)(e)}}(p);if(e>n)return void C(`Cannot advance test clock by more than two billing intervals. The current billing interval is ${p}.`);M(!0);"success"===(await d.stripeAdvanceTestClock(K,{spaceId:g,epochSeconds:W.plus(e).toSeconds()})).type?await async function(e,n){let t=await d.stripeGetTestClock(e,{spaceId:n});for(;"success"===t.type&&"advancing"===t.data.status;)await(0,c.Vs)(1e3),t=await d.stripeGetTestClock(e,{spaceId:n});if("failed"===t.type)return void C("Test clock poll request failed. Refresh page to see updated time.");switch(t.data.status){case"ready":await f.bi(e);break;case"advancing":C("Test clock still advancing");break;case"internal_failure":C("Test clock internal failure");break;case void 0:C("Test clock undefined");break;default:(0,u.t1)(t.data.status)}}(K,g):C("Failed to advance test clock. Check server logs for details."),M(!1)},V=(0,x.jsxs)("div",{style:A.message,children:["The clock time is currently frozen at ",W.toLocaleString(a.ou.DATETIME_FULL)]}),Z=[{label:(0,x.jsx)("input",{disabled:I,type:"number",value:T,style:{width:75,textAlign:"right"},onChange:e=>k(parseInt(e.target.value))}),onClick:()=>{}},{label:(0,x.jsxs)("select",{disabled:I,value:j,onChange:e=>{S(e.target.value)},children:[(0,x.jsx)("option",{value:"seconds",children:"seconds"}),(0,x.jsx)("option",{value:"minutes",children:"minutes"}),(0,x.jsx)("option",{value:"hours",children:"hours"}),(0,x.jsx)("option",{value:"days",children:"days"}),(0,x.jsx)("option",{value:"months",children:"months"}),(0,x.jsx)("option",{value:"years",disabled:"year"!==p,children:"years"})]}),onClick:()=>{}},{label:"Advance clock",onClick:()=>O()},{label:I?(0,x.jsx)("img",{src:l.Z.images.clubPenguinDanceGif,alt:"loading...",style:{width:48}}):(0,x.jsx)("div",{style:{width:48}}),onClick:()=>{}}];return B?(0,x.jsx)(y.j,{label:V,display:"full-width",actions:Z,tint:(0,b.X)(n)}):(0,x.jsxs)("div",{style:A.bannerContent,children:[(0,x.jsxs)("div",{style:A.message,children:["The clock time is currently frozen at ",W.toLocaleString(a.ou.DATETIME_FULL),I?(0,x.jsx)(m.Z,{}):null]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("input",{disabled:I,type:"number",value:T,style:{width:75,textAlign:"right"},onChange:e=>k(parseInt(e.target.value))}),(0,x.jsxs)("select",{disabled:I,value:j,onChange:e=>{S(e.target.value)},children:[(0,x.jsx)("option",{value:"seconds",children:"seconds"}),(0,x.jsx)("option",{value:"minutes",children:"minutes"}),(0,x.jsx)("option",{value:"hours",children:"hours"}),(0,x.jsx)("option",{value:"days",children:"days"}),(0,x.jsx)("option",{value:"months",children:"months"}),(0,x.jsx)("option",{value:"years",disabled:"year"!==p,children:"years"})]}),(0,x.jsx)("button",{disabled:I,onClick:O,children:"Advance clock"})]})]})}function k(){const e=(0,i.VK)((()=>{const e=_.subscriptionDataStoreInstance.state,n=w.aS(e);return w.DB(e)&&Boolean(null==n?void 0:n.testClock)}),[]);return o.useEffect((()=>(e?p.Bw({bannerStore:g.Z,id:"TestClockBanner",contentKey:"test_clock",styleKey:b.v.Yellow,prepend:!0}):p.qL({bannerStore:g.Z,id:"TestClockBanner"}),()=>{p.qL({bannerStore:g.Z,id:"TestClockBanner"})})),[e]),null}function C(e){}}}]);