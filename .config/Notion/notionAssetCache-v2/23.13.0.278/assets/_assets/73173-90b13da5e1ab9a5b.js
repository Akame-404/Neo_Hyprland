"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[73173],{54814:(e,t,o)=>{o.d(t,{nc:()=>l,rG:()=>s});o(757658);var i=o(606287),n=o(798165),r=o(206258),a=o(454642);async function s(e){let{environment:t,spaceId:o,databaseType:n,parentStore:s}=e;if(!o)return;const l=await a.getTypedDatabases(t,{spaceId:o,databaseType:n});return"success"===l.type?l.data.result.map((e=>r.NW.createChildStore(s,{table:i.vF,id:e.collectionId}))):void 0}async function l(e){let{environment:t,spaceId:o,databaseTypes:i,parentStore:r,teamId:a}=e;const l=[];return await Promise.all(i.map((async e=>{const i=await async function(e){let{environment:t,spaceId:o,databaseType:i,parentStore:r,teamId:a}=e;const l=await s({spaceId:o,environment:t,databaseType:i,parentStore:r});if(!l)return!1;for(const s of l){const e=n.VP(s);if(e&&e.id===a)return!0}return!1}({environment:t,spaceId:o,databaseType:e,parentStore:r,teamId:a});i&&l.push(e)}))),l}},668155:(e,t,o)=>{o.d(t,{Z:()=>s});o(667294);var i=o(709291),n=o(362896),r=o(110906),a=o(785893);const s=function(e){let{collectionViewName:t,collectionViewType:o}=e;return t?(0,a.jsx)(n.Z,{children:t}):"page"===o?(0,a.jsx)(i.FormattedMessage,{id:"database.collectionView.untitledName.untitled",defaultMessage:"Untitled"}):(0,a.jsx)(i.FormattedMessage,{...r.b1[o]})}},103392:(e,t,o)=>{o.d(t,{Z:()=>B});var i=o(667294),n=o(800480),r=o(886628),a=o(724405),s=o(375071),l=o(269246),d=o(709291),c=o(653965),p=o(401898),u=o(889858),m=o(164921),g=o(655118),y=o(825777),v=o(314694),b=o(843250),f=o(35026),S=o(361673),I=o(981829),h=o(80444),x=o(990827),T=o(587244),V=o(966324),j=o(224646),C=o(658929),K=o(785893);const w=i.memo((e=>{const{disabled:t,childStores:o,areChildrenLoading:a,itemDepth:s,type:d}=e,c=(0,n.O7)(),u=c.device,m=(0,r.VK)((()=>{const e=(0,x.wY)();return(0,p.$K)(e)?o.filter((t=>!e.includes(t.id))):o}),[o]),g=(0,r.VK)((()=>I.PT()),[]),v=m.map(((t,o)=>{const n=S.io(t.id,g);return n?(0,K.jsx)(T.N,{step:n,children:(0,i.createElement)(P,{...e,key:t.id,store:t,index:o})},t.id):(0,i.createElement)(P,{...e,key:t.id,store:t,index:o})})),V=(0,r.VK)((()=>h.default.state.currentSpaceViewStore),[]),C=(0,r.VK)((()=>(0,j.BH)(c)),[c]),w=(0,r.VK)((()=>void 0!==V&&(0,f.Wu)({spaceViewStore:V})),[V]),Z=0===s,B=0===v.length,L=(B||e.isHeaderless||u.isMobile)&&Z&&("private"===d||"workspace"===d)&&!t,O=B&&!L&&!Z,A={offline:b.blN,bookmarks:b.fe0,workspace:b.BEs,shared:b.JkF,private:b.q1J,team:b.l24,[l.PT]:void 0,[l.cz]:void 0,[l.mu]:void 0,[l.kg]:void 0,[l.g$]:void 0}[e.type];return(0,K.jsxs)(y.Z,{id:e.id,"aria-labelledby":e["aria-labelledby"],role:Z?"tree":"group",style:e.style,innerStyle:C?{display:"flex",flexDirection:"column",gap:1}:{},className:A,loaded:!a,showSpinnerTimeout:3e3,spinnerSize:"1em",children:[C?(0,K.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:1},children:v}):v,B&&Z&&!("private"===d&&w)&&(0,K.jsx)(D,{type:e.type,parentStore:e.parentStore}),L&&(0,K.jsx)(k,{type:e.type,from:"main_sidebar"}),O&&(0,K.jsx)(M,{itemStyle:e.itemStyle})]})}));function M(e){const t=(0,n.Fy)(),o=(0,n.O7)(),i=(0,r.VK)((()=>(0,j.BH)(o)),[o]),s=(0,a.yK)((e=>({placeholder:{color:e.lightTextColor,paddingLeft:i?16:12,...t.isMobile&&{display:"flex",alignItems:"center",height:32}}})),[t,i]);return(0,K.jsx)(v.Z,{role:"treeitem",style:e.itemStyle,children:(0,K.jsx)("div",{style:s.placeholder,children:(0,K.jsx)(d.FormattedMessage,{defaultMessage:"No pages inside",id:"outliner.NoPagesInside.placeholder"})})})}function k(e){const{type:t,from:o}=e,i=(0,n.O7)(),{currentSpaceStore:s,currentSpaceViewStore:l}=(0,r.VK)((()=>{const{currentSpaceStore:e,currentSpaceViewStore:t}=h.default.state;return{currentSpaceStore:e,currentSpaceViewStore:t}}),[]),c=(0,r.VK)((()=>(0,j.BH)(i)),[i]),p=i.device.isMobile,g=(0,a.yK)((e=>({sidebarItem:{color:c?e.newSidebarSecondaryColor:e.mediumTextColor},hovered:{background:e.sidebarItemSelectedBackground}})),[c]),y=(0,j.hr)();if(!s||!l)return null;return(0,K.jsx)(m.Z,{style:y.baseSidebarItem,hoveredStyle:c?g.hovered:void 0,mobileFeedback:p,onClick:async()=>{if("team"===t)return;await u.kC({environment:i,spaceStore:s,spaceViewStore:l,type:t,outlinerItemFrom:o,prepend:!1,shouldPersistToggleState:!0})&&p&&V.close()},children:(0,K.jsx)(v.Z,{style:g.sidebarItem,left:(0,K.jsx)(Z,{}),disableMobileBorder:!0,children:(0,K.jsx)(d.FormattedMessage,{defaultMessage:"Add a page",id:"sidebar.addAWorkspaceOrPrivatePage.tooltip"})})})}w.displayName="Outliner";const P=i.memo((e=>{const{store:t,index:o}=e;return(0,K.jsx)(C.ZP,{type:e.type,from:"main_sidebar",variant:"primary",store:t,style:e.itemStyle,toggleStyle:e.itemToggleStyle,itemIndex:o,itemDepth:e.itemDepth,itemOpenByDefault:e.itemOpenByDefault,parentStore:t.getRecordStoreUIParent(),onNavigate:e.onNavigate,disabled:e.disabled},t.id)}));function D(e){const t=(0,n.O7)(),{type:o,parentStore:i}=e,r=c.oA(["OutlinerItem",o,null==i?void 0:i.id]).join("_");return(0,K.jsx)(g.G,{dropTargetKey:r,canDropBelow:!0,onSelectableDrop:async e=>{await u.NP({dropArgs:e,environment:t,type:o,isTopLevel:!0,parentStore:i})},shouldShowDropZone:!0,canAcceptDrop:e=>{const{currentSpaceStore:o}=h.default.state;return!!o&&(0,f.Pl)({environment:t,draggingStores:e.draggingStores,parentStore:i,currentSpaceStore:o})}})}function Z(){const e=(0,n.O7)(),t=(0,r.VK)((()=>(0,j.BH)(e)),[e]),o=(0,a.yK)((e=>({icon:{fill:t?e.newSidebarSecondaryColor:e.mediumIconColor,width:16,height:16},iconContainer:{display:"flex",alignItems:"center",justifyContent:"center"}})),[t]);return(0,K.jsx)("div",{style:o.iconContainer,children:(0,s.f)(o.icon)})}P.displayName="PageItem";const B=w},658929:(e,t,o)=>{o.d(t,{gZ:()=>me,aZ:()=>ge,ZP:()=>ye});var i=o(667294),n=o(800480),r=o(706740),a=o(797511),s=o(533125),l=o(886628),d=o(724405),c=o(541432),p=o(915157),u=o(401898),m=o(889858),g=o(279954),y=o(119037),v=o(35026),b=o(52315),f=o(681844),S=o(480796),I=o(206258),h=o(226664),x=o(224646),T=o(421202),V=o(137810),j=o(838745),C=o(940663),K=o(584076),w=o(568785),M=o(776798),k=o(164369),P=o(314694),D=o(484210),Z=o(950659),B=o(798165),L=o(195697),O=o(816402),A=o(591948),_=o(361673),F=o(981829),N=o(823376),E=o(116746),R=o(80444),H=o(453730),G=o(709291),$=o(709953),z=o(210228),W=o(731278),Q=o(526388),U=o(394841),Y=o(825464),q=o(785893);function J(e){const{targetStore:t,canEditItem:o}=e,i=(0,G.useIntl)(),r=(0,n.O7)(),{isMobile:a}=r.device,s=(0,l.VK)((()=>t.getIcon()),[t]),c=(0,l.VK)((()=>!a&&o&&!t.isNonEditableState()&&!(0,U.Kj)(t.id)),[a,o,t]),p=(0,l.VK)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.table}),[t]),u=(0,l.VK)((()=>(0,x.BH)(r)),[r]),m=(0,d.yK)((e=>({pageIcon:{fill:u?e.newSidebarSecondaryColor:e.mediumIconColor}})),[u]),g=e=>{const o=t.getIconStore();o&&z.createAndCommit({userAction:"OutlinerItem.handleRecordIconChange",environment:r,perform:t=>{$.sO({store:o,value:e,transaction:t})}})};return(0,q.jsx)(Q.Z,{renderTooltip:()=>(0,q.jsx)(G.FormattedMessage,{defaultMessage:"Change icon",id:"sidebarItem.changeIconButton.tooltip"}),placement:Y.u.Bottom,render:e=>{var o;return c?(0,q.jsx)(W.Z,{bucket:"secure",disabled:!0,icon:s,store:t,title:void 0,isEmptyPage:t.isEmptyPage(),size:a?24:20,onChange:g,pageIconStyle:m.pageIcon,...e,largeIcon:!0,iconLoggingData:{recordTable:p,source:"sidebar",block_type:t.getType(),collection_id:"collection"===p?null===(o=t.getIconStore())||void 0===o?void 0:o.id:void 0},label:i.formatMessage({defaultMessage:"Change page icon",id:"sidebarItem.changeIconButton.buttonLabel"})}):(0,q.jsx)(W.Z,{disabled:!0,icon:s,title:void 0,isEmptyPage:t.isEmptyPage(),size:a?24:20,pageIconStyle:m.pageIcon,largeIcon:!0,label:i.formatMessage({defaultMessage:"Page icon",id:"sidebarItem.changeIconButton.disabledLabel"})})}})}var X=o(605210);function ee(e){const{store:t,from:o,targetStore:i,type:r,itemIndex:a,itemDepth:s,isOpen:c,onToggle:p}=e,u=(0,n.O7)(),{isMobile:m}=u.device,g=(0,l.VK)((()=>{if((0,L.ku)()){const e=Boolean(null==i?void 0:i.isCollectionView()),o=v.Yz(t).length>0;return e||o}return!0}),[t,i]),y=(0,d.yK)((e=>({hiddenToggle:{width:(0,X.q)({isMobile:m,isSidebar:!0})},toggle:{color:e.lightIconColor}})),[m]);if(!g)return(0,q.jsx)("div",{style:y.hiddenToggle});return(0,q.jsx)(X.Z,{isSidebar:!0,fill:!0,icon:"chevron",open:c,color:y.toggle.color,onClick:()=>{const e=0===s,i=B.VP(t);j.t8(u,{teamStore:i,type:e?"top_level":"nested",is_toggled:!c,outliner_type:r,outliner_position:a,outliner_depth:s,outliner_location:"main_sidebar"===o?"sidebar":"pane"}),p(),v.Ps({store:t,toOpen:!c,environment:u,isTopLevelItem:e})},"aria-describedby":e["aria-describedby"],"aria-controls":e["aria-controls"]})}var te=o(910009);function oe(e){const{store:t,from:o,variant:i,style:r,targetStore:a,itemDepth:s,type:c,nestedOutlinerAriaId:p,titleAriaId:u,isOpen:m,onFocus:g,onBlur:y,onMouseMove:b,onMouseLeave:f}=e,S=(0,n.O7)(),I=S.device.isMobile,h=(0,l.VK)((()=>(0,x.BH)(S)),[S]),T=(0,l.VK)((()=>"copy_indicator"===t.getType()),[t]),V=(0,l.VK)((()=>function(e){const{targetStore:t,type:o,from:i}=e;if(!t)return;const n=(0,v.N)({type:o,from:i});if(t.isNavigableBlock())return(0,D.ZP)({store:t,fullyQualified:!1,pageVisitSource:n});{const e=B.Dg(t);if(e)return(0,D.ZP)({store:e,scrollToBlockId:t.id,fullyQualified:!1,pageVisitSource:n})}}({targetStore:a,type:c,from:o})),[o,a,c]),C=(0,l.VK)((()=>T&&H.transactionQueue.isPendingTransactionForRecord(t.pointer)),[T,t]),M=(0,l.VK)((()=>{const{mainEditorCurrentBlockStore:e}=R.default.state;return e&&t.id===e.id}),[t]),k=(0,l.VK)((()=>"secondary_sidebar"===o?"peek"===E.Z.state.mode&&E.Z.isVisible():E.Z.isVisible()),[o]),L=(0,l.VK)((()=>(0,Z.G$)({isMobile:I,environment:S})),[I,S]),O=(0,l.VK)((()=>(0,Z.Z3)({isMobile:I,environment:S})),[I,S]),G=(0,l.VK)((()=>F.PT()),[]),$=(0,x.hr)(),z=(0,d.yK)((e=>({sidebarItem:{...!I&&{paddingLeft:5},...M&&$.currentSelectedSidebarItem,...O,...r,..."secondary"===i&&{padding:8,height:"unset"}},children:{display:"flex",alignItems:"center"},loadingSpinner:{marginLeft:6},moveOrDuplicateProgress:{flex:1,marginLeft:I?10:6,marginRight:I?12:void 0},link:{width:"100%"},sidebarItemHovered:{background:e.sidebarItemSelectedBackground}})),[I,M,$.currentSelectedSidebarItem,O,r,i]),W={role:"treeitem","aria-current":M?"page":void 0,"aria-expanded":!!m,"aria-owns":p,"aria-labelledby":u};if(T)return C?(0,q.jsxs)(P.Z,{style:z.sidebarItem,childrenStyle:z.children,onFocus:g,onBlur:y,onMouseMove:b,onMouseLeave:f,children:[(0,q.jsx)(w.Z,{style:z.loadingSpinner}),(0,q.jsx)(A.Z,{targetRecordId:t.id,style:z.moveOrDuplicateProgress})]}):null;if(V){const o=o=>{e.onNavigate&&e.onNavigate(t);const i=o.metaKey||o.ctrlKey;k&&!i&&N.TN({environment:S,skipAnimation:!0});const n=B.VP(t);j.Yg(S,{teamStore:n,type:0===s?"top_level":"nested",outliner_type:e.type,outliner_position:e.itemIndex,outliner_depth:s}),_.OA({blockId:t.id,existingTemplateIdsByChecklistItem:G,environment:S})};return(0,q.jsx)(K.Z,{onFocus:g,onBlur:y,style:z.link,href:V,onClick:o,innerStyle:L,hoveredStyle:h?z.sidebarItemHovered:void 0,...W,children:(0,q.jsx)(ie,{...e,sidebarItemStyle:z.sidebarItem,sidebarItemChildrenStyle:z.children,titleAriaId:u,nestedOutlinerAriaId:p})})}return(0,q.jsx)(ie,{...e,onFocus:g,onBlur:y,sidebarItemStyle:z.sidebarItem,sidebarItemChildrenStyle:z.children,titleAriaId:u,nestedOutlinerAriaId:p,...W})}function ie(e){const{store:t,variant:o,from:i,parentStore:r,targetStore:a,itemDepth:s,type:p,onFocus:u,onBlur:m,onMouseMove:g,onMouseLeave:y,onToggle:v,titleAriaId:b,nestedOutlinerAriaId:f,isOpen:S,isHovered:h,isFocused:j}=e,K=(0,l.VK)((()=>function(e){const{store:t,parentStore:o,isTopLevelItem:i,type:n}=e;if(t.isDefined()&&(0,C.h7)(t))return!1;if(t.isCollectionView()&&!(0,L.bq)())return!t.getCollectionViewSourceCollectionStore();if("block"===(null==o?void 0:o.table)){if(I.G.createChildStore(o,{table:T.iU,id:o.id,spaceId:t.getSpaceId()}).isType("collection_view_page"))return!1}if(t.isDefined()&&t.getType()===c.Ti.alias)return!0;if(i&&"team"!==n)return!1;if(!o)return!1;if(t.isDefined())return t.getParentId()!==o.id;return!1}({store:t,parentStore:r,isTopLevelItem:0===s,type:p})),[t,r,s,p]),w=(0,n.O7)(),D=(0,l.VK)((()=>(0,x.BH)(w)),[w]),B=(0,n.Fy)().isMobile,A=(0,l.VK)((()=>{const e=t.getLastEditedTime();return(0,O.IS)(e,{useLowercase:!1,useCompactFormat:!0})}),[t]),_=h||j,F=(0,d.yK)((t=>({iconContainer:{display:"grid"},toggle:{gridColumn:1,gridRow:1,zIndex:1,opacity:_?1:0,order:_?1:0,transition:`opacity ${Z.PP}`},itemIcon:{gridColumn:1,gridRow:1,opacity:_?0:1,transition:`opacity ${Z.PP}`,order:_?0:1,..."secondary"===o&&{marginTop:-6}},rightIcons:{...!B&&{opacity:_?1:0,transition:`opacity ${Z.PP}`}},childrenStyle:{...e.sidebarItemChildrenStyle,..."secondary"===o&&{display:"flex",flexDirection:"column",alignItems:"flex-start"}},title:{fontWeight:V.Z.fontWeight.medium,..."secondary"===o&&{width:"100%"}},subtitle:{marginTop:2}})),[B,e.sidebarItemChildrenStyle,_,o]);return(0,q.jsxs)(P.Z,{role:e.role,"aria-current":e["aria-current"],"aria-expanded":e["aria-expanded"],"aria-owns":e["aria-owns"],"aria-labelledby":e["aria-labelledby"],style:e.sidebarItemStyle,childrenStyle:F.childrenStyle,left:D&&!B?void 0:(0,q.jsx)(ee,{store:t,from:i,targetStore:a,type:p,itemIndex:e.itemIndex,itemDepth:s,"aria-controls":f,"aria-describedby":b,onToggle:v,isOpen:S}),icon:D&&!B?(0,q.jsxs)("div",{style:F.iconContainer,children:[(0,q.jsx)("div",{style:F.toggle,children:(0,q.jsx)(ee,{store:t,from:i,targetStore:a,type:p,itemIndex:e.itemIndex,itemDepth:s,"aria-controls":f,"aria-describedby":b,onToggle:v,isOpen:S})}),(0,q.jsx)("div",{style:F.itemIcon,children:a&&(0,q.jsx)(J,{targetStore:a,canEditItem:e.canEditItem})})]}):a&&(0,q.jsx)(J,{targetStore:a,canEditItem:e.canEditItem}),right:(0,q.jsx)("div",{style:F.rightIcons,children:(0,q.jsx)(te.ZP,{store:t,from:i,type:p,itemIndex:e.itemIndex,itemDepth:s,canEditItem:e.canEditItem,onToggle:v,isHovered:h,isFocused:j})}),onFocus:u,onBlur:m,onMouseMove:g,onMouseLeave:y,isAlias:K,children:[(0,q.jsx)(M.Z,{id:b,store:t,style:F.title}),"secondary"===o&&(0,q.jsx)(k.Z,{isSmall:!0,isSecondaryColor:!0,style:F.subtitle,children:A})]})}var ne=o(212534),re=o(668155),ae=o(103392);function se(e){const{store:t,collectionViewStore:o,onNavigate:r,type:a,from:s}=e,c=(0,n.O7)(),p=(0,l.VK)((()=>t.getCollectionViewStores().some((e=>"page"===e.getType()))),[t]),u=(0,l.VK)((()=>(0,x.BH)(c)),[c]),m=(0,l.VK)((()=>{const{mainEditorCurrentBlockStore:e,currentCollectionViewStore:i}=R.default.state;return!p&&Boolean(e&&t.id===e.id&&i&&i.id===o.id)}),[o.id,t.id,p]),g=(0,x.hr)(),y=(0,d.yK)((t=>({initialIcon:{fontSize:12,fontWeight:500,marginLeft:5,color:t.mediumTextColor},sidebarItem:{...m&&g.currentSelectedSidebarItem,borderRadius:u?6:void 0,...e.style},hoveredItem:{background:t.sidebarItemSelectedBackground}})),[m,g.currentSelectedSidebarItem,u,e.style]),f=(0,l.VK)((()=>(0,D.ZP)({store:t,fullyQualified:!1,collectionViewId:o.id,pageVisitSource:(0,v.N)({type:a,from:s})})),[o.id,s,t,a]),S=(0,l.VK)((()=>({ready:o.isReady(),type:o.getType(),pagePointer:o.getFormat().page_pointer,name:o.getName()})),[o]),h=(0,l.VK)((()=>{if("page"!==S.type||!S.pagePointer)return null;const e=I.G.createChildStore(t,{table:S.pagePointer.table,id:S.pagePointer.id}),o=(0,v.Q2)(e);return{pageStore:e,ready:(0,b.b)(e),outlinerItems:o}}),[S,t]),T=(0,l.VK)((()=>t.getContentStore()),[t]),V=(0,i.useCallback)((()=>{r&&r(t)}),[t,r]),j=(0,l.VK)((()=>(0,Z.G$)({isMobile:c.device.isMobile,environment:c})),[c]);if(!S.ready)return null;if("page"===S.type&&h){const{ready:t,outlinerItems:o}=h;return(0,q.jsx)(ae.Z,{type:e.type,childStores:o,areChildrenLoading:!t,itemDepth:e.itemDepth+1,parentStore:T,itemStyle:y.sidebarItem,itemToggleStyle:e.itemToggleStyle,onNavigate:e.onNavigate,disabled:e.disabled})}return p?null:(0,q.jsx)(K.Z,{href:f,style:{width:"100%"},hoveredStyle:u?y.hoveredItem:void 0,innerStyle:j,onClick:V,role:"treeitem","aria-current":m?"step":void 0,children:(0,q.jsx)(P.Z,{icon:(0,q.jsx)("div",{style:y.initialIcon,children:"•"}),style:y.sidebarItem,children:(0,q.jsx)(re.Z,{collectionViewName:S.name,collectionViewType:S.type??"table"})})})}function le(e){const{store:t,from:o}=e,i=(0,l.VK)((()=>t.getCollectionViewStores()),[t]);return(0,q.jsx)("div",{role:"group",id:e.id,"aria-labelledby":e["aria-labelledby"],onContextMenu:e=>{e.preventDefault(),(0,ne.ZP)({event:e,context:ne.Af.EditorContextMenu,callback:()=>{}})},children:i.map((i=>(0,q.jsx)(se,{store:t,from:o,collectionViewStore:i,style:e.itemStyle,onNavigate:e.onNavigate,type:e.type,itemDepth:e.itemDepth,disabled:e.disabled,childStores:e.childStores},i.id)))})}function de(e){const{disabled:t,store:o,from:i,style:r,targetStore:a,itemDepth:s,nestedOutlinerAriaId:c,titleAriaId:p}=e,{isMobile:u}=(0,n.Fy)(),m=(0,l.VK)((()=>!(0,b.b)(o)),[o]),g=(0,l.VK)((()=>a.isCollectionView()?a:null),[a]),y=(0,l.VK)((()=>(0,v.Yz)(o)),[o]),f=(0,l.VK)((()=>a.getContentStore()),[a]),S=(0,d.yK)((()=>{const e="number"==typeof(null==r?void 0:r.paddingLeft)?r.paddingLeft:u?me:5,t=u?ge:8;return{item:{...r,paddingLeft:e+t}}}),[r,u]);return g?(0,q.jsx)(le,{store:g,from:i,itemStyle:S.item,onNavigate:e.onNavigate,type:e.type,childStores:y,areChildrenLoading:!1,itemDepth:s+1,parentStore:f,itemToggleStyle:e.toggleStyle,disabled:t,id:c,"aria-labelledby":p}):(0,q.jsx)(ae.Z,{type:e.type,childStores:y,areChildrenLoading:m,itemDepth:s+1,parentStore:f,itemStyle:S.item,itemToggleStyle:e.toggleStyle,onNavigate:e.onNavigate,disabled:t,id:c,"aria-labelledby":p})}function ce(e){return`Outliner-${e.id}`}function pe(e){let{store:t,type:o,isTopLevelItem:i}=e;return e=>{const n=t.getRecordStoreUIParent();null!=n&&n.valueIs(h.i)&&m.A5({...e,type:o,targetStore:t,targetParentStore:n,isTopLevelItem:i})}}function ue(e){let{environment:t,store:o,parentStore:i,type:n,isTopLevelItem:r}=e;return async e=>{const{droppedDirection:a,droppedStores:s,duplicate:l}=e;i&&await m.v9({environment:t,type:n,targetParentStore:i,targetStore:o,isTopLevelItem:r,droppedDirection:a,droppedStores:s,duplicate:l})}}const me=6,ge=22,ye=function(e){const{store:t,itemIndex:o,parentStore:d,type:v,itemDepth:b,disabled:h,from:T,variant:V}=e,j=(0,n.O7)(),C=(0,a.l)(),K=function(e){return 0===e}(b),[w,M]=(0,i.useState)((()=>{if((0,u.$K)(e.itemOpenByDefault))return e.itemOpenByDefault;if(K){const e=p.Z.get({userId:j.currentUser.id,key:ce(t)});if((0,u.$K)(e))return e}return!1})),[k,P]=(0,i.useState)(!1),[D,Z]=(0,i.useState)(!1),B=(0,i.useId)(),L=(0,i.useId)(),O=(0,l.VK)((()=>function(e){if(e.getType()===c.Ti.alias){const t=e.getAliasTargetStore();return t instanceof I.G?t:void 0}return e}(t)),[t]),A=(0,l.VK)((()=>x.Bb(t)),[t]),_=0===o,F=(0,l.VK)((()=>!h&&(0,y.J5S)({environment:j,blocks:[t],publicEditMode:C&&C.publicEditModeStore.state})),[h,C,j,t]),N=(0,l.VK)((()=>F&&!t.isLinkedCollectionView()),[t,F]),E=(0,l.VK)((()=>x.BH(j)),[j]),R=(0,i.useRef)(null);(0,s.c)(f.Z,(()=>({store:t,parentStore:d,type:v,isTopLevelItem:K,getNode:()=>R.current})),[t,d,v,K]);const H=A&&d?{onInsertBelow:e=>m.LR({...e,environment:j,store:t,parentStore:d,before:!0,type:v}),onInsertAbove:e=>m.LR({...e,environment:j,store:t,parentStore:d,before:!1,type:v})}:{},G=(0,i.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,r.E)(t)&&Z(!0)}),[]),$=(0,i.useCallback)((()=>{Z(!1)}),[]),z=(0,i.useCallback)((()=>{S.Z.state.isDragging||P(!0)}),[]),W=(0,i.useCallback)((()=>{P(!1)}),[]),Q=(0,i.useCallback)((e=>{M(void 0!==e?e:e=>!e)}),[]);return O?(0,q.jsxs)(g.Z,{analyticsName:"outliner_item",actionSectionGroupKey:"sidebar_outliner",contextMenuAndDragStores:[t],canDrag:A,canDropAbove:_,canDropBelow:A,canDropOnto:N,canInsertBelow:A,canInsertAbove:A,canSelect:A,canTriggerContextMenu:!0,onRemove:pe({store:t,type:v,isTopLevelItem:K}),onSelectableDrop:ue({environment:j,store:t,parentStore:d,type:v,isTopLevelItem:K}),shouldShowDropZone:!0,showBlockMenuInput:!1,store:t,...H,ref:R,style:E?{display:"flex",flexDirection:"column",gap:1,paddingBottom:w&&"secondary"===V?8:0}:{},children:[(0,q.jsx)(oe,{variant:V,from:T,store:t,style:e.style,parentStore:d,type:v,itemIndex:e.itemIndex,itemDepth:e.itemDepth,onNavigate:e.onNavigate,targetStore:O,canEditItem:F,nestedOutlinerAriaId:B,titleAriaId:L,onFocus:G,onBlur:$,onMouseMove:z,onMouseLeave:W,onToggle:Q,isHovered:k,isFocused:D,isOpen:w}),w&&(0,q.jsx)(de,{...e,targetStore:O,nestedOutlinerAriaId:B,titleAriaId:L})]}):null}},910009:(e,t,o)=>{o.d(t,{ZP:()=>H,Pr:()=>Y,nW:()=>q});o(252262),o(324506);var i=o(667294),n=o(800480),r=o(886628),a=o(724405),s=o(356666),l=o(375071),d=o(269246),c=o(213493),p=o(249902),u=o(709291),m=o(106404),g=o(889858),y=o(524677),v=o(210228),b=o(710274),f=o(164921),S=o(552275),I=o(231945),h=o(478140),x=o(632163),T=o(840721),V=o(731278),j=o(776798),C=o(672495),K=o(526388),w=o(433929),M=o(460709),k=o(98742),P=o(35026),D=o(798165),Z=o(475024),B=o(825464),L=o(80444),O=o(206258),A=o(897630),_=o(340215),F=o(966324),N=o(224646);const E=(0,u.defineMessages)({addAPageInside:{defaultMessage:"Add a page inside",id:"sidebarItem.addAPageInside.tooltip"}});var R=o(785893);function H(e){const{store:t,from:o,type:i,canEditItem:a,itemDepth:s,isHovered:l,isFocused:c,onToggle:p}=e,{isMobile:u}=(0,n.Fy)(),m=u||l||c,g=(0,r.VK)((()=>{var e;const o=Boolean(t.getAppContainerBlockStore()),i=null===(e=t.getCollectionViewCollectionStore())||void 0===e?void 0:e.isSyncedCollection();return Boolean(t.getType()&&a&&!o&&!i)}),[t,a]),y=q({showRightIcons:m});return i===d.g$?null:(0,R.jsxs)("div",{style:y.iconContainer,children:[(0,R.jsx)(Q,{store:t,from:o,type:e.type,itemIndex:e.itemIndex,itemDepth:s}),g&&(0,R.jsx)(G,{store:t,onToggle:p,isTopLevelItem:0===s,from:o,type:i})]})}function G(e){const{store:t,onToggle:o,isTopLevelItem:i,from:a,type:s}=e,l=(0,n.O7)(),{isMobile:d}=l.device,p=(0,r.VK)((()=>t.isCollectionView()),[t]),u=(0,r.VK)((()=>t.getLinkedViewCollectionBlockStores()),[t]),m=(0,r.VK)((()=>{var e;const o=null===(e=t.getCollectionViewStores().at(0))||void 0===e?void 0:e.id;if(!o)return;const i=O.Xr.createChildStore(t,{table:c.np,id:o});return null==i?void 0:i.getFormatStore().getValue()}),[t]),g=(0,r.VK)((()=>{const e=null==m?void 0:m.collection_view_source;if("typed"===(null==e?void 0:e.type))return null==e?void 0:e.databaseType}),[m]),y=w.default.formatMessage(E.addAPageInside);return p&&!m&&0===u.length?(0,R.jsx)(z,{disabled:!0,events:{}}):p&&g?(0,R.jsx)($,{store:t,databaseType:g}):u.length<=1?(0,R.jsx)(K.Z,{renderTooltip:()=>y,placement:B.u.Bottom,render:e=>{const n={...e,onClick:e=>{U({store:t,onToggle:o,event:e,sourceStore:u[0]??t,shouldNavigateToSource:!1,environment:l,isTopLevelItem:i,from:a,type:s})}};return(0,R.jsx)(z,{events:n})}}):(0,R.jsx)(K.Z,{renderTooltip:()=>y,placement:B.u.Bottom,render:e=>(0,R.jsx)(I.ZP,{popupType:d?I.Z4.SlideUp:I.Z4.Popup,renderOrigin:t=>(0,R.jsx)(z,{events:(0,k.Z)(e,t)}),render:e=>(0,R.jsx)(W,{store:t,onToggle:o,parent:e,isTopLevelItem:i,from:a,type:s})})})}function $(e){const{store:t,databaseType:o}=e,a=(0,n.O7)(),s=(0,r.VK)((()=>L.default.state.currentSpaceViewStore),[]),l=(0,r.VK)((()=>L.default.state.currentSpaceStore),[]),d=(0,r.VK)((()=>null==s?void 0:s.getTeamsStores().map((e=>e.id))),[s]),c=(0,_.F)({environment:a,spaceStore:l,parentStore:l,joinedTeamIds:d??[],moveToTargets:[],overrideDatabaseType:o}),p=(0,r.VK)((()=>{if(c.success)return c.typedDatabases}),[c]),u=(0,i.useCallback)((e=>{p&&b.rm({store:t,event:e,typedDatabases:p,environment:a})}),[a,p,t]),m=w.default.formatMessage(E.addAPageInside);return c.success&&0!==(null==p?void 0:p.length)?(0,R.jsx)(K.Z,{renderTooltip:()=>m,placement:B.u.Bottom,render:e=>{const t={...e,onClick:u};return(0,R.jsx)(z,{events:t})}}):(0,R.jsx)(z,{disabled:!0,events:{}})}function z(e){const{isMobile:t}=(0,n.Fy)(),o=Y();return(0,R.jsx)(f.Z,{ariaLabel:w.default.formatMessage(E.addAPageInside),mobileFeedback:t,style:o.button,disabled:e.disabled,disabledFeedback:e.disabled,...e.events,children:(0,l.f)(o.buttonIcon)})}function W(e){const{store:t,onToggle:o,parent:i,isTopLevelItem:s,from:l,type:d}=e,c=(0,n.O7)(),{isMobile:p}=c.device,m=(0,r.VK)((()=>t.getLinkedViewCollectionBlockStores()),[t]),g=(0,a.yK)((()=>({menuItem:{display:"flex",alignItems:"center",whiteSpace:"pre"}})),[]),y={menuType:p?M.og.Modal:M.og.Popup,right:p?(0,R.jsx)(T.DoneMenuText,{}):void 0},v={key:"collections",render:e=>(0,R.jsx)(C.Z,{...e,title:(0,R.jsx)(u.FormattedMessage,{defaultMessage:"Add to",id:"sidebarItem.addAPageInside.popup.addTo"})}),items:m.map((e=>({key:e.id,render:t=>(0,R.jsx)(S.Z,{...t,title:(0,R.jsx)("div",{style:g.menuItem,children:(0,R.jsx)(j.Z,{store:e})}),icon:(0,R.jsx)(V.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:14})}),action:t=>{U({store:e,event:t.event,onToggle:o,sourceStore:e,shouldNavigateToSource:!0,environment:c,isTopLevelItem:s,from:l,type:d})}})))};return(0,R.jsx)(h.Z,{...y,children:(0,R.jsx)(x.Z,{type:x.i.Vertical,onAccept:i.close,initialFocus:void 0,sections:[v]})})}function Q(e){const{store:t,from:o,type:i,itemDepth:r,itemIndex:a,iconStyle:l}=e,d=(0,u.useIntl)(),c=(0,n.O7)(),{isMobile:p}=c.device,g=Y(),v=e=>{const n=D.VP(t);y.Ys({environment:c,store:t}),m.Qn({environment:c,stores:[t],left:e.clientX,top:e.clientY,showInput:!1,actionSectionGroupKey:"sidebar_outliner",analyticsFrom:"sidebar_more_menu",optionalAnalyticsProperties:{teamStore:n,type:0===r?"top_level":"nested",outliner_type:i,outliner_position:a,outliner_depth:r,outliner_location:"main_sidebar"===o?"sidebar":"pane"}})},b="bookmarks"===i?d.formatMessage({defaultMessage:"Remove, rename, and more…",id:"sidebarItem.favoritedPageMenuButton.tooltip"}):d.formatMessage({defaultMessage:"Delete, duplicate, and more…",id:"sidebarItem.pageMenuButton.tooltip"});return(0,R.jsx)(K.Z,{renderTooltip:()=>b,placement:B.u.Bottom,render:e=>(0,R.jsx)(f.Z,{ariaLabel:b,mobileFeedback:p,style:g.button,onClick:v,...e,children:(0,s.o)({...g.buttonIcon,...l})})})}function U(e){const{store:t,sourceStore:o,shouldNavigateToSource:i,environment:n,isTopLevelItem:r,onToggle:a,event:s,from:l,type:d}=e;A.M_(n)&&(n.device.isMobile&&F.close(),v.createAndCommit({userAction:"OutlinerItem.createdPage",environment:n,perform:e=>g.D0({environment:n,event:s,store:o,transaction:e,navigateToParent:i,from:l})}),p.j({name:"page_created",args:{type:d,from:l}}),t.isCollectionView()||(a(!0),P.Ps({store:t,toOpen:!0,environment:n,isTopLevelItem:r})))}function Y(){const e=(0,n.O7)(),t=e.device.isMobile,o=(0,r.VK)((()=>(0,N.BH)(e)),[e]);return(0,a.yK)((e=>({button:t?{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,borderRadius:4,marginLeft:0}:{display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:4,marginLeft:4},buttonIcon:t?{fill:e.lightIconColor,width:18}:{fill:o?e.mediumIconColor:e.sidebarTextColor,width:14}})),[t,o])}function q(e){const{showRightIcons:t}=e;return(0,a.yK)((()=>({iconContainer:{display:"flex",paddingLeft:3,...t?{}:{...Z.jy,display:"block"}}})),[t])}},862395:(e,t,o)=>{o.d(t,{n:()=>i});const i=o(749085).default.createValue(void 0,{name:"CachedTypedDatabasesStore"})},340215:(e,t,o)=>{o.d(t,{F:()=>v});var i=o(886628),n=o(494714),r=o(559054),a=o(606287),s=o(54814),l=o(123924),d=o(296994),c=o(277907),p=o(675822),u=o(862395),m=o(319385),g=o(242330),y=o(206258);function v(e){let{environment:t,spaceStore:o,joinedTeamIds:v,parentStore:b,moveToTargets:f,overrideDatabaseType:S}=e;const I=(0,i.VK)((()=>{const e=null==o?void 0:o.id;if(e)return function(e){if(!u.n.state)return;if(e!==u.n.state.spaceId)return;return u.n.state.typedDatabases}(e)}),[null==o?void 0:o.id]),h=(0,i.VK)((()=>m.default.checkGate({gateName:"typed_move_to_improved_default_results"})),[]),x=(0,c.XJ)(d.FF.searchActions),[{value:T,status:V}]=(0,r.r5)((async()=>{if(I)return I;if(!o||!b)return;const e=g.ZP.getTargetsDatabaseType()??S;if(!e)return;if("resolved"!==x.status)return;const i=x.value;let r=[];if(h){const n=((await i.searchCollectionsWithRecents({environment:t,query:"",limit:20,databaseType:[e],spaceStore:o,parentStore:o,collectionViewBlockStore:void 0,searchSessionId:g.ZP.state.isOpen?g.ZP.state.flowId:void 0})).results||[]).map((e=>y.NW.createChildStore(b,{table:a.vF,id:e})));r=(0,l.qJ)({typedDatabases:n,blocksToFilterParents:f})}else{const i=await s.rG({environment:t,spaceId:o.id,databaseType:e,parentStore:b})??[];r=(0,l.mL)({environment:t,typedDatabases:i,spaceStore:o,joinedTeamIds:v})}return u.n.setState({typedDatabases:r,spaceId:o.id}),g.ZP.setState({...g.ZP.state,variant:n.ii}),r}),[I,o,h,t,f,S,b,v,x.status,x.value],{debounce:p.vp,throttle:p.vp});return I?{success:!0,typedDatabases:I}:"resolved"===V&&T?{success:!0,typedDatabases:T}:{success:!1}}}}]);