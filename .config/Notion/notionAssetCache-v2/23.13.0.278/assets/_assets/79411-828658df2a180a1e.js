"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[79411],{453365:(e,t,r)=>{r.d(t,{$_:()=>d,lV:()=>c});var a=r(336769),s=r(44317),n=r(401898),l=r(80444),o=r(521273),i=r(88893);const u=1;function c(e){const{currentUserSettingsStore:t,currentSpaceStore:r}=l.default.state,a=null==t?void 0:t.getSettings();return!(!a||!r)&&(!e.device.isMobile&&(!!o.Z.showAssistantNotionAiCopy()&&(!!o.Z.isAiEnabled()&&(!!d(e,r.id)&&(!(0,n.$K)(a.ai_sales_assisted_extra_notification_seen_at)&&!("tooltip"!==a.ai_assistant_onboarding_phase||(0,n.$K)(a.ai_assistant_onboarding_phase_last_set_at)&&(0,s.O5)(a.ai_assistant_onboarding_phase_last_set_at)<u))))))}const _={isSalesAssisted:void 0};function d(e,t){return _.isSalesAssisted??(0,i.ro)(e,t)}(0,a.exposeDebugEnvironmentValue)("getAssistantOnboardingDebugInfo",(e=>()=>{const{currentUserSettingsStore:t,currentSpaceStore:r}=l.default.state,a=null==t?void 0:t.getSettings();if(!a||!r)return;const{ai_qna_intro_onboarding_phase:s,ai_assistant_onboarding_phase:n,ai_assistant_onboarding_phase_last_set_at:o,ai_assistant_tooltips_onboarding_phase:i,ai_sales_assisted_extra_notification_seen_at:u,last_exposed_to_ai_qna_at:c,qna_reminders_shown_at:_}=a;return{isSalesAssisted:d(e,r.id),relevantUserSettings:{ai_qna_intro_onboarding_phase:s,ai_assistant_onboarding_phase:n,ai_assistant_tooltips_onboarding_phase:i,ai_assistant_onboarding_phase_last_set_at:o,ai_sales_assisted_extra_notification_seen_at:u,last_exposed_to_ai_qna_at:c,qna_reminders_shown_at:_}}}))},969098:(e,t,r)=>{r.d(t,{j:()=>c,o:()=>a});var a={};r.r(a),r.d(a,{showAsyncModal:()=>d,showAsyncModalComponent:()=>h,testOnly:()=>m});var s=r(667294),n=r(886628),l=r(749085);class o extends l.default{getInitialState(){return{asyncModals:[]}}}const i=new o;var u=r(785893);const c=s.memo((function(e){const{store:t=i}=e,r=(0,n.VK)((()=>t.state.asyncModals),[t]);return(0,u.jsx)(u.Fragment,{children:r.map((e=>{const{id:t,internalRenderModal:r,isOpen:a}=e,n=r(a);return(0,u.jsx)(s.Fragment,{children:n},t)}))})}));var _=r(471924);function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;return new Promise(((r,a)=>{try{f({asyncModal:T({renderModal:e,promiseResolve:r,promiseReject:a,store:t}),store:t})}catch(s){a(s)}}))}function h(e){return d((t=>s.createElement(e,t)),arguments.length>1&&void 0!==arguments[1]?arguments[1]:i)}function f(e){const{asyncModal:t,store:r=i}=e;r.update((e=>({asyncModals:[...e.asyncModals,t]})))}function E(e){const{id:t,promiseResolve:r,store:a=i}=e;return e=>{const s=C({id:t,store:a});null!=s&&s.isOpen&&(O({id:t,store:a,update:{isOpen:!1}}),r(e))}}function v(e){const{id:t,promiseResolve:r,store:a=i}=e;return()=>{const e=C({id:t,store:a});null!=e&&e.isOpen&&(O({id:t,store:a,update:{isOpen:!1}}),r())}}function g(e){const{id:t,store:r=i}=e;return()=>{r.update((e=>({asyncModals:e.asyncModals.filter((e=>e.id!==t))})))}}function T(e){const{renderModal:t,promiseResolve:r,promiseReject:a,store:s=i}=e,n=_.Il(),l=g({id:n,store:s}),o=v({id:n,promiseResolve:r,store:s}),u=E({id:n,promiseResolve:r,store:s});return{id:n,internalRenderModal:e=>{try{return t({isOpen:e,onClosed:l,onDismiss:o,resolve:u})}catch(r){throw a(r),r}},isOpen:!0}}function C(e){const{id:t,store:r=i}=e;return r.state.asyncModals.find((e=>e.id===t))}function O(e){const{id:t,update:r,store:a=i}=e;a.update((e=>({asyncModals:e.asyncModals.map((e=>e.id!==t?e:{...e,...r}))})))}const m={addAsyncModal:f,createAsyncModal:T,createOnClosed:g,createOnDismiss:v,createResolve:E,getAsyncModal:C,updateAsyncModal:O}},327340:(e,t,r)=>{r.d(t,{y:()=>o});var a=r(653965),s=r(401898),n=r(847882);function l(e){let t=0,r=Number.MAX_SAFE_INTEGER;for(const s of e){if(!s)continue;const e=(0,n.r)(s),l=(0,a.uZ)(e.max,0,Number.MAX_SAFE_INTEGER),o=(0,a.uZ)(e.min,0,l);t=Math.max(t,o),r=Math.min(r,l)}const l=function(e){let t;for(const r of e){const e=null==r?void 0:r.scroll;switch(e){case"disallow":return"disallow";case"allow":t="allow";break;case void 0:break;default:(0,s.t1)(e)}}return t}(e);return{type:"range",min:(0,a.uZ)(t,0,r),max:r,scroll:l}}function o(e){const t=e.filter(Boolean);return{width:l(t.map((e=>null==e?void 0:e.width))),height:l(t.map((e=>null==e?void 0:e.height)))}}},983420:(e,t,r)=>{r.d(t,{TL:()=>_,nc:()=>c,ue:()=>u});var a=r(266897),s=r(554368),n=r(177420),l=r(519889),o=r(401898),i=r(206258);function u(e){const{parentStore:t,pointer:r}=e,s=(0,i.Kv)(t,r).getValue();if(s)return(0,a.LU)({table:r.table,value:s})}function c(e){const{parentStore:t,pointer:r}=e;return r.table===n.cZ?i.Qx.createChildStore(t,r):r.table===l.KJ?i.U6.createChildStore(t,r):r.table===s.y0?i.fg.createChildStore(t,r):void(0,o.t1)(r)}function _(e){return e.table===n.cZ?(0,a.ON)(e.getValue()):e.table===l.KJ?(0,a.m3)(e.getValue()):e.table===s.y0?(0,a.I4)(e.getValue()):void(0,o.t1)(e)}},525286:(e,t,r)=>{r.d(t,{Y:()=>$,f:()=>Z});var a=r(421202),s=r(145366),n=r(492338),l=r(653965),o=r(307032),i=r(401898),u=r(619584),c=r(730459),_=r(897638),d=(r(757658),r(971384)),h=r(80444);class f{constructor(e,t,r){var a;this.featuresets=void 0,this.queryLower=void 0,this.userId=void 0,this.spaceId=void 0,this.currentTimeMs=void 0,this.pageSignals=void 0,this.resultsFeatureMetadata={},this.featuresets=e,this.queryLower=r.toLowerCase(),this.userId=t.currentUser.id,this.spaceId=null===(a=h.default.state.currentSpaceStore)||void 0===a?void 0:a.id,this.currentTimeMs=Date.now(),this.pageSignals=d.Z.getPageSignals({spaceId:this.spaceId,userId:this.userId})}extractFeatureGroup(e){const t=[];for(const r of this.featuresets){const a={groupName:r.name,features:[]};for(const t of r.features)a.features.push(t({result:e,featureExtractor:this}));t.push(a)}return t}}var E=r(319385),v=r(826842),g=r(155320),T=r(629026),C=r(88893),O=r(343759);function m(e){return Number.isFinite(e)?e:0}const p={name:"CLIENT_FEATURESET_RELEVANCY_MODEL",features:[function(e){let{result:t,featureExtractor:r}=e;return{name:"TIME_SINCE_LAST_EDIT",value:r.currentTimeMs-t.block.blockModel.last_edited_time}},function(e){let{result:t,featureExtractor:r}=e;return{name:"IS_LAST_EDITED_BY_ME",value:r.userId&&t.block.blockModel.last_edited_by_id===r.userId?1:0}},function(e){let{result:t,featureExtractor:r}=e;return{name:"IS_CREATED_BY_ME",value:r.userId&&t.block.blockModel.created_by_id===r.userId?1:0}},...n.ik.map((e=>t=>{let{result:r}=t;return{name:`BLOCK_SOURCE_${e}`,value:r.block.source.has(e)?1:0}})),function(e){var t;let{result:r,featureExtractor:a}=e;return{name:"PAGE_AUTHORITY_V1",value:a.pageSignals?null===(t=a.pageSignals[r.block.blockModel.id])||void 0===t?void 0:t.pageAuthorityV1:void 0}},function(e){let{result:t}=e;return{name:"TITLE_LENGTH",value:t.block.text.length}},function(e){let{result:{terms:t},featureExtractor:{queryLower:r}}=e;return{name:"TERMS_COUNT_NORMALIZED",value:m(t.length/(0,O.pv)(r).length)}},function(e){let{result:{terms:t},featureExtractor:{queryLower:r}}=e;const a=(0,O.pv)(r),s=new Set(t);return{name:"FULL_MATCH_TERM_COUNT_NORMALIZED",value:m(a.filter((e=>s.has(e))).length/a.length)}},function(e){let{result:{terms:t,block:{text:r}}}=e;const a=(0,O.pv)(r.toLowerCase());return{name:"MATCHING_PERCENTAGE_OF_TITLE",value:m(t.length/a.length)}}]};r(21703);function S(e,t){return R(e,t,0)}function R(e,t,r){const a=t[r];if("value"in a)return a.value;const{feature:s,threshold:n,left:l,right:o}=a;return e[s]<=n?R(e,t,o):R(e,t,l)}const I=[{feature:"NUMBER_OF_BLOCK_SOURCES",threshold:.9803883731365204,left:1,right:64},{feature:"NUMBER_OF_BLOCK_SOURCES",threshold:-.02051524817943573,left:2,right:33},{feature:"TITLE_LENGTH",threshold:-.9804741442203522,left:3,right:18},{feature:"BLOCK_SOURCE_frecencyStore",threshold:.5,left:4,right:11},{feature:"PAGE_AUTHORITY_V1",threshold:.9929431676864624,left:5,right:8},{feature:"BLOCK_SOURCE_recentVisit",threshold:.5,left:6,right:7},{value:.055661729574773056},{value:.11489805030510493},{feature:"IS_LAST_EDITED_BY_ME",threshold:.5,left:9,right:10},{value:.1303473491773309},{value:.2761679479597871},{feature:"PAGE_AUTHORITY_V1",threshold:.7070983946323395,left:12,right:15},{feature:"BLOCK_SOURCE_recentVisit",threshold:.5,left:13,right:14},{value:.15403218305273927},{value:.2901420576840293},{feature:"BLOCK_SOURCE_recentVisit",threshold:.5,left:16,right:17},{value:.3969548667754214},{value:.5434689507494647},{feature:"BLOCK_SOURCE_frecencyStore",threshold:.5,left:19,right:26},{feature:"PAGE_AUTHORITY_V1",threshold:-9373319335297929e-20,left:20,right:23},{feature:"BLOCK_SOURCE_recentVisit",threshold:.5,left:21,right:22},{value:.019246861924686193},{value:.0422577337207315},{feature:"MATCHING_PERCENTAGE_OF_TITLE",threshold:.38750000298023224,left:24,right:25},{value:.04463445567238064},{value:.08163417730973187},{feature:"PAGE_AUTHORITY_V1",threshold:.9430259466171265,left:27,right:30},{feature:"BLOCK_SOURCE_recentVisit",threshold:.5,left:28,right:29},{value:.04921499627799959},{value:.11522081288769559},{feature:"BLOCK_SOURCE_recentVisit",threshold:.5,left:31,right:32},{value:.15812057498390902},{value:.26642904878592116},{feature:"TITLE_LENGTH",threshold:-.8644499182701111,left:34,right:49},{feature:"PAGE_AUTHORITY_V1",threshold:.7071063816547394,left:35,right:42},{feature:"TIME_SINCE_LAST_EDIT",threshold:-.9999998509883881,left:36,right:39},{feature:"MATCHING_PERCENTAGE_OF_TITLE",threshold:.7386363744735718,left:37,right:38},{value:.5046524356869184},{value:.6139737991266375},{feature:"MATCHING_PERCENTAGE_OF_TITLE",threshold:.9545454680919647,left:40,right:41},{value:.35265916931762176},{value:.4631217838765009},{feature:"IS_LAST_EDITED_BY_ME",threshold:.5,left:43,right:46},{feature:"BLOCK_SOURCE_teamPage",threshold:.5,left:44,right:45},{value:.5826717293752157},{value:.3459669582118562},{feature:"MATCHING_PERCENTAGE_OF_TITLE",threshold:.9285714328289032,left:47,right:48},{value:.6696084874659657},{value:.7931906286870049},{feature:"PAGE_AUTHORITY_V1",threshold:.7071079015731812,left:50,right:57},{feature:"TIME_SINCE_LAST_EDIT",threshold:-.7071194350719452,left:51,right:54},{feature:"TITLE_LENGTH",threshold:.0027717105112969875,left:52,right:53},{value:.3084340622029064},{value:.20221830985915493},{feature:"TITLE_LENGTH",threshold:.0014528378378599882,left:55,right:56},{value:.19599360481519798},{value:.12874983418294833},{feature:"BLOCK_SOURCE_frecencyStore",threshold:.5,left:58,right:61},{feature:"MATCHING_PERCENTAGE_OF_TITLE",threshold:.3484848588705063,left:59,right:60},{value:.1674727932285369},{value:.2761101463656661},{feature:"MATCHING_PERCENTAGE_OF_TITLE",threshold:.3229166716337204,left:62,right:63},{value:.31311018131101814},{value:.4333284274045184},{feature:"TITLE_LENGTH",threshold:-.8199742436408997,left:65,right:96},{feature:"PAGE_AUTHORITY_V1",threshold:.9987315237522125,left:66,right:81},{feature:"TIME_SINCE_LAST_EDIT",threshold:-.7075438499450684,left:67,right:74},{feature:"TERMS_COUNT_NORMALIZED",threshold:.7859025001525879,left:68,right:71},{feature:"NUMBER_OF_BLOCK_SOURCES",threshold:1.0080004930496216,left:69,right:70},{value:.6666666666666666},{value:.5572065378900446},{feature:"MATCHING_PERCENTAGE_OF_TITLE",threshold:.8090909123420715,left:72,right:73},{value:.730962836028703},{value:.82483781278962},{feature:"TERMS_COUNT_NORMALIZED",threshold:.7750000059604645,left:75,right:78},{feature:"BLOCK_SOURCE_defaultRecordCache",threshold:.5,left:76,right:77},{value:.5598243688254665},{value:.3112244897959184},{feature:"BLOCK_SOURCE_frecencyStore",threshold:.5,left:79,right:80},{value:.48986486486486486},{value:.6522655426765016},{feature:"TIME_SINCE_LAST_EDIT",threshold:-.9759486615657806,left:82,right:89},{feature:"IS_CREATED_BY_ME",threshold:.5,left:83,right:86},{feature:"BLOCK_SOURCE_frecencyStore",threshold:.5,left:84,right:85},{value:.7596830985915493},{value:.8754666411409974},{feature:"TERMS_COUNT_NORMALIZED",threshold:.7750000059604645,left:87,right:88},{value:.8577648766328012},{value:.9412431085265464},{feature:"TERMS_COUNT_NORMALIZED",threshold:.9000000059604645,left:90,right:93},{feature:"MATCHING_PERCENTAGE_OF_TITLE",threshold:.7083333432674408,left:91,right:92},{value:.7364085667215815},{value:.4639175257731959},{feature:"BLOCK_SOURCE_frecencyStore",threshold:.5,left:94,right:95},{value:.7003610108303249},{value:.8495272810115048},{feature:"PAGE_AUTHORITY_V1",threshold:.9999995827674866,left:97,right:112},{feature:"TITLE_LENGTH",threshold:1.0038834810256958,left:98,right:105},{feature:"BLOCK_SOURCE_frecencyStore",threshold:.5,left:99,right:102},{feature:"BLOCK_SOURCE_recentVisit",threshold:.5,left:100,right:101},{value:.18298261665141813},{value:.34929850024189646},{feature:"TIME_SINCE_LAST_EDIT",threshold:-.7071070969104767,left:103,right:104},{value:.5148422178641469},{value:.42366514623021195},{feature:"NUMBER_OF_BLOCK_SOURCES",threshold:1.3351261019706726,left:106,right:109},{feature:"TITLE_LENGTH",threshold:1.4187065362930298,left:107,right:108},{value:.2810958904109589},{value:.14157014157014158},{feature:"BLOCK_SOURCE_frecencyStore",threshold:.5,left:110,right:111},{value:.19499105545617174},{value:.40776554596846176},{feature:"BLOCK_SOURCE_frecencyStore",threshold:.5,left:113,right:120},{feature:"PAGE_AUTHORITY_V1",threshold:1.4150558710098267,left:114,right:117},{feature:"TITLE_LENGTH",threshold:.09616653248667717,left:115,right:116},{value:.5727355901189387},{value:.4002079002079002},{feature:"TITLE_LENGTH",threshold:.36996421217918396,left:118,right:119},{value:.3089700996677741},{value:.10194174757281553},{feature:"PAGE_AUTHORITY_V1",threshold:1.000001072883606,left:121,right:124},{feature:"MATCHING_PERCENTAGE_OF_TITLE",threshold:.22649572789669037,left:122,right:123},{value:.6954795357361027},{value:.7911777488048675},{feature:"TITLE_LENGTH",threshold:-.2670345604419708,left:125,right:126},{value:.7278492480521833},{value:.5908471377647305}],L=["PAGE_AUTHORITY_V1"],M=["TIME_SINCE_LAST_EDIT"],A=["TIME_SINCE_LAST_EDIT","PAGE_AUTHORITY_V1","TITLE_LENGTH","NUMBER_OF_BLOCK_SOURCES"];class U extends Error{constructor(e,t){super(e),this.name="MathError",this.cause=void 0,this.cause=t}}function b(e){if(0===e.length)throw new Error("Can't compute std of an empty array.");const t=(0,l.J6)(e),r=(0,l.Sm)(e.map((e=>Math.pow(e-t,2))))/e.length;return Math.sqrt(r)}const N=[function(e){return{name:"NUMBER_OF_BLOCK_SOURCES",value:e.reduce(((e,t)=>{let{name:r,value:a}=t;return void 0!==a&&r.startsWith("BLOCK_SOURCE")?e+a:e}),0)}}];function G(e){return[...e,...N.map((t=>t(e)))]}const y={TIME_SINCE_LAST_EDIT:-.17725330223424154,IS_LAST_EDITED_BY_ME:.16176141450635628,IS_CREATED_BY_ME:.0593282388860205,BLOCK_SOURCE_spacePage:-.1800298837847493,BLOCK_SOURCE_recentVisit:.38019907955270416,BLOCK_SOURCE_bookmarkedPage:.2273554336295929,BLOCK_SOURCE_sharedPage:-.11405912441003871,BLOCK_SOURCE_frecencyStore:.7303811564943883,BLOCK_SOURCE_teamPage:-.3886937481702676,BLOCK_SOURCE_defaultRecordCache:-.08630181620439217,BLOCK_SOURCE_similarUser1dRecentPages:.1516065982402135,BLOCK_SOURCE_topPages7dPageView:.04024980669809112,BLOCK_SOURCE_editedPages1d:-.12760596916369363,BLOCK_SOURCE_similarUsersEditedPages1d:-.209104241796053,BLOCK_SOURCE_unknown:0,PAGE_AUTHORITY_V1:.4303514640388112,TITLE_LENGTH:-.4316382562266375,TERMS_COUNT_NORMALIZED:-.1032745452783248,FULL_MATCH_TERM_COUNT_NORMALIZED:.18313025417928205,MATCHING_PERCENTAGE_OF_TITLE:1.0003388486917193,NUMBER_OF_BLOCK_SOURCES:.7940652678793755},B=-2.48072057;function K(e){const t=e.map((e=>{let{name:t,value:r}=e;return y[t]*(r??0)}));return r=(0,l.Sm)([B,...t]),1/(1+Math.exp(-r/2));var r}function w(e){if(e.some((e=>{let{value:t}=e;return void 0===t})))return 0;const t=(0,u.m8)(e.map((e=>{let{name:t,value:r}=e;return[t,r]}))),r=[I].map((e=>S(t,e)));return(0,l.J6)([...r,K(e)])}const k=1.25,x=[p],D=0;function P(e){const{results:t,featureGroups:r}=e,a=t.map(((e,t)=>{const{block:a,score:s,personalizationBoost:l,rendered:o,terms:i}=e;return{sources:[n.vp.Local],id:a.blockModel.id,spaceId:a.blockModel.space_id,score:s,localSource:a.source,personalizationBoost:l,terms:i,highlight:{text:o},featureGroups:r[t]}})),s=function(e){const t=x.map(((t,r)=>{const a=e.map((e=>{var t;let{featureGroups:a}=e;return null===(t=a[r])||void 0===t?void 0:t.features}));if(a.some((e=>void 0===e)))return;return function(e){const t=(0,l.Xh)(e);for(const n of t)for(const e of n)(0,i.DE)(L,e.name)?e.value??=0:(0,i.DE)(M,e.name)&&(e.value=Math.log(e.value??1));const r=new Map,a=new Map,s=new Map;for(const n of t)for(const e of n)if(void 0!==e.value&&(0,i.DE)(A,e.name)){r.has(e.name)||r.set(e.name,[]);const t=r.get(e.name);t&&t.push(e.value)}for(const[n,o]of r.entries())a.set(n,(0,l.J6)(o)),s.set(n,b(o));for(const n of t)for(const e of n)if((0,i.DE)(A,e.name)){const t=a.get(e.name),r=s.get(e.name);if(void 0===e.value||void 0===t||void 0===r)throw new U(`Couldn't scale feature ${e.name}`);e.value=0===r?0:(e.value-t)/r}return t}(a.map(G)).map(w)}));if(!t.some((e=>void 0===e)))return(0,l.Ri)(t.filter(i.$K))}(a);return a.map(((e,t)=>({...e,localRelevancies:void 0!==s?s[t]:void 0})))}function H(e,t,r){const a=e=>r.matches(e.block),n=(0,s.wS)(t);if(1===n.length)return e.search(t,{filter:a,prefix:!0,fields:["text","inits"]});const l=e.search(t,{filter:a,combineWith:"AND",fields:["text"]});if(l.length>0)return l;const o=n.filter((e=>e.length>=O.Qu)),i=(u=o.length,Math.round(.6*u+.5));var u;return e.search(t,{filter:e=>e.queryTerms.length>=i&&a(e)})}function V(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function F(e){const{block:t,score:r,terms:a}=e,{source:s,text:l}=t,o=a.map(V).join("|"),i=new RegExp(o,"ig");var u;return{block:t,rendered:a.length>0?l.replaceAll(i,`${n.Um}$&${n.dK}`):l,score:r,personalizationBoost:(u=s).has("recentVisit")||u.has("frecencyStore")||u.has("bookmarkedPage")||u.has("defaultRecordCache")?k:1,terms:a}}function Y(e,t,r){const{blocks:a,getAllBlocks:s}=e,n=r.text.trim(),l=(0,o.nv)(n),i=l.length>0?l.join(" "):n,u=new _.uL(t);return i.length>0?function(e){const{blocksIndex:t,queryString:r,filterMatcher:a}=e;return H(t,r,a).map((e=>{const t=(0,O.RA)(r,e.block.text);return{...e,score:e.score*t}})).map(F)}({blocksIndex:a,queryString:i,filterMatcher:u}):s().filter((e=>u.matches(e.block))).map(F)}const q=(0,l.Ds)(((e,t)=>{t[0].featureGroups.forEach(((r,a)=>{let{groupName:s}=r;const n=t.map((e=>({features:e.featureGroups[a].features,id:e.id})));(0,c.K4)(e,"search_local_result_features",{search_session_id:g.default.state.sessionId,group_name:s,results_features:n})}))}),1e3,{leading:!1,trailing:!0});function Z(e){let{query:t,localCachedPages:r,userId:a,includeRecordMap:s,environment:n,shouldUseNewRerankerDebugOverrideEnabled:o}=e;const{query:i,limit:u}=t,{filters:c,sort:d}=i,h=Y(r,c,i);if(0===h.length)return;const v=function(e,t){const{field:r}=e,a="relevance"===r||"desc"===e.direction?-1:1;switch(r){case"lastEdited":case"scroll":return(0,l.MR)(t,(e=>{let{block:{blockModel:t}}=e;return a*(t.last_edited_time||0)}));case"created":return(0,l.MR)(t,(e=>{let{block:{blockModel:t}}=e;return a*(t.created_time||0)}));default:return(0,l.MR)(t,(e=>{let{score:t}=e;return a*t}))}}(d,h),g=function(e,t,r,a){const s=new f(t,e,r);return a.map((e=>s.extractFeatureGroup(e)))}(n,x,t.query.text,v),C="relevance"===d.field,O=P({results:v,featureGroups:g}),m=O.every((e=>{let{localRelevancies:t}=e;return void 0!==t&&t.length>0&&void 0!==t[D]}))&&(o||"on"===E.default.getEligibleGroup({experimentId:"search-use-local-reranker-layered",parameter:"shouldUseLocalReranker",defaultGroup:"control"}));var p;const S=(C?m?(p=D,O.sort(((e,t)=>{let{localRelevancies:r}=e,{localRelevancies:a}=t;return(a??[])[p]-(r??[])[p]}))):(0,_.YB)({sort:d,currentUserId:a,unsorted:O,batchSize:T.Xv}):O).slice(0,u);return{total:h.length,results:S,recordMap:s??1?r.recordMap.toJson({allowVersionDowngrade:!1}):{},trackEventProperties:void 0}}function $(e){let{query:t,localCachedPages:r,parentStore:s,isOnline:o,environment:d,shouldLimitLocalResultsWhenOnline:h,canUseLtr:f,shouldUseNewRerankerDebugOverrideEnabled:T,maxLocalResultsDebugOverride:O}=e;const m=Z({query:t,localCachedPages:r,userId:d.currentUser.id,environment:d,shouldUseNewRerankerDebugOverrideEnabled:T});if(!m)return;if(0===m.results.length)return{error:n.Ix.NoResults};const p=m.results.map(((e,t)=>({...e,originalPosition:t,store:v.G.createChildStore(s,{table:a.iU,id:e.id}),serverEventProperties:void 0}))),S=o&&h,R=(S?e=>(0,_.g8)(d,e,O):e=>e)(p);if(0===R.length)return{error:n.Ix.NoResults};const I=p.map((e=>{let{localRelevancies:t}=e;return t})),L=(0,l.Ri)(I.filter(i.$K)),M=L.map(l.J6),A=(0,l.Ri)(R.map((e=>{let{localRelevancies:t}=e;return t})).filter(i.$K)).map(l.J6),U=I.some(i.$K)?{...(0,u.m8)(L.map(((e,t)=>[`result_relevancies_${t}`,e]))),result_relevancies_means:M,visible_result_relevancy_means:A}:{},b=t.query.text.length>1&&f;return(0,c.K4)(d,"search_local_recall_results",{num_visible_members:(0,C.qX)(),results:p.map(z),search_session_id:g.default.state.sessionId,num_local_results:R.length,are_results_limited:S,...U}),b&&(q(d,R),E.default.logEvent("visible_local_search_results",R.length,{resultRelevancyV1:M[0],visibleResultRelevancyV1:A[0]})),{value:{total:p.length,results:R,debugInfo:void 0}}}function z(e){const{id:t,localSource:r}=e;return{id:t,localSource:[...r??[]]}}},591190:(e,t,r)=>{r.d(t,{C:()=>n,E:()=>s});var a=r(61766);const s=new a.Z,n=new a.Z},833110:(e,t,r)=>{r.d(t,{Z:()=>n});var a=r(749085);class s extends a.default{getInitialState(){return{tabs:[]}}}const n=new s},114581:(e,t,r)=>{r.d(t,{h:()=>a});const a=(0,r(745238).CZ)("exclamationMarkTriangle",{default:{loader:()=>r.e(15187).then(r.bind(r,15187)),size:20},small:{loader:()=>r.e(79250).then(r.bind(r,979250)),size:16},mini:{loader:()=>r.e(93173).then(r.bind(r,793173)),size:14},large:{loader:()=>r.e(43339).then(r.bind(r,343339)),size:24}})},145366:(e,t,r)=>{r.d(t,{wS:()=>n});var a=r(653965);const s=/[-./\\()"'’‘”“，。、·～；,;<>~!@#$%^&*|+=[\]{}`~?:\s]/u;function n(e){return(0,a.oA)(e.split(s))}}}]);