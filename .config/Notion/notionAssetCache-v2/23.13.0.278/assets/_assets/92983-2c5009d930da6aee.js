"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[92983],{692983:(e,t,o)=>{o.r(t);o(757658);var n=o(336769),i=o(421202),s=o(933709),r=o(76233),a=o(182798),c=o(653965),u=o(709953),d=o(210228),l=o(80444),f=o(206258),g=o(617707),S=o(601600);function p(e){const t=[],o=[e,...e.getContentStores()];for(;o.length>0;){const e=o.pop();for(const o of(null==e?void 0:e.getDiscussionStores())??[])"suggestion"===o.getType()&&t.push(o);if(null==e||!e.isNavigableBlock())for(const t of(null==e?void 0:e.getContentStores())??[])o.push(t)}return t}(0,n.exposeDebugEnvironmentValue)("getAllSuggestionsOnMainEditor",(e=>()=>{if(l.default.state.mainEditorCurrentBlockStore)return p(l.default.state.mainEditorCurrentBlockStore)})),(0,n.exposeDebugEnvironmentValue)("updateAllSuggestionContextsOnMainEditor",(e=>()=>{l.default.state.mainEditorCurrentBlockStore&&p(l.default.state.mainEditorCurrentBlockStore).forEach((t=>{t.isDefined()&&d.createAndCommit({userAction:"ConsoleHelpers.updateAllSuggestionContextsOnMainEditor",environment:e,perform:o=>{(0,S.vh)({environment:e,transaction:o,discussionStore:t})}})}))})),(0,n.exposeDebugEnvironmentValue)("updateSuggestionDiscussionSnapshot",(e=>(t,o)=>{if(!l.default.state.currentSpaceStore)return;const n=f.jQ.createChildStore(l.default.state.currentSpaceStore,{table:s.qF,id:t,spaceId:l.default.state.currentSpaceStore.id});d.createAndCommit({userAction:"ConsoleHelpers.updateSuggestionDiscussionSnapshot",environment:e,perform:t=>{(0,S.vh)({environment:e,transaction:t,discussionStore:n,addModifiedBlockIdsAfter:o})}})})),(0,n.exposeDebugEnvironmentValue)("forceReopenSuggestionDiscussion",(e=>(t,o)=>{if(!l.default.state.currentSpaceStore)return;const n=f.jQ.createChildStore(l.default.state.currentSpaceStore,{table:s.qF,id:t,spaceId:l.default.state.currentSpaceStore.id});n.isDefined()&&d.createAndCommit({userAction:"ConsoleHelpers.forceReopenSuggestionDiscussion",environment:e,perform:t=>{const i=(0,a.TO)(n.getSuggestionRawContextStore());u.sW({store:n,data:{resolved:!1},transaction:t}),u.sO({store:i,value:{...i.getValue(),rejected:!1,resolvedBy:void 0},transaction:t}),(0,S.vh)({environment:e,transaction:t,discussionStore:n,addModifiedBlockIdsAfter:o})}})})),(0,n.exposeDebugEnvironmentValue)("fixBlockSuggestionDiscussionMismatch",(e=>t=>{if(!l.default.state.currentSpaceStore)return;const o=l.default.state.currentSpaceStore,n=f.G.createChildStore(o,{table:i.iU,id:t}),a=n.getModel();if(!a||!n.isDefined())return;const u=c.jj([...a.getAllBlockSuggestions().map((e=>e.discussionId)),...(0,r.llS)(n.getTitleValue())]),p=a.getDiscussionPointers().map((e=>e.id));c.zu(u,...p).forEach((t=>d.createAndCommit({userAction:"ConsoleHelpers.fixBlockSuggestionDiscussionMismatch.addDiscussionToBlockStore",environment:e,perform:e=>{(0,g.tR)({transaction:e,blockStore:n,discussionId:t})}})));c.jj([...u,...p]).forEach((t=>{const i=f.jQ.createChildStore(o,{table:s.qF,id:t,spaceId:o.id});if(i.isDefined()){(i.getSuggestModifiedBlockIds()??[]).includes(n.id)||d.createAndCommit({userAction:"ConsoleHelpers.fixBlockSuggestionDiscussionMismatch.addDiscussionToBlockStore",environment:e,perform:t=>{(0,S.vh)({environment:e,transaction:t,discussionStore:i,addModifiedBlockIdsAfter:[n.id]})}})}}))})),(0,n.exposeDebugEnvironmentValue)("findAllBlocksInMainEditorWithDanglingSuggestions",(e=>()=>{const e=[];if(!l.default.state.mainEditorCurrentBlockStore)return;const t=l.default.state.mainEditorCurrentBlockStore;if(!t.isDefined())return;const o=l.default.state.currentSpaceStore;if(!o)return;const n=[t,...t.getContentStores()];for(;n.length>0;){const t=n.pop();if(!t||!t.isDefined())continue;if(t.isType("table")||t.isType("table_row"))continue;const i=c.jj([...t.getAllBlockSuggestions().map((e=>e.discussionId)),...(0,r.llS)(t.getTitleValue())]).map((e=>f.jQ.createChildStore(o,{table:s.qF,id:e,spaceId:o.id}))).filter((e=>e.isDefined()&&!(e.getSuggestModifiedBlockIds()??[]).includes(t.id)));if(i.length>0&&e.push({blockStore:t,discussionStores:i}),!t.isNavigableBlock())for(const e of t.getContentStores()??[])n.push(e)}return e}))}}]);