"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[44832],{4827:(e,t,o)=>{o.d(t,{Z:()=>Yi});var n=o(667294),r=o(533125),i=o(886628),l=o(566890),s=o(311368),a=o(358299),u=o(800480),c=o(724405),d=o(990559),p=o(180951),y=o(939694),m=o(165473),f=o(508606),h=o(278030),S=o(753876),x=o(177722),v=o(785893);const b=n.memo((0,n.forwardRef)((function(e,t){const{store:o,collectionStore:r,buttonStyle:l,onContextMenu:s,quickActionButtons:a,property:u}=e,{baseStyles:d}=(0,n.useContext)(f.O),p=(0,i.VK)((()=>o.getPropertyValue(u)),[u,o]),y=(0,c.yK)((()=>({buttonStyle:{...d.buttonStyle,...l},buttonPressedStyle:d.buttonPressedStyle??{},buttonHoveredStyle:d.buttonHoveredStyle??{}})),[d.buttonHoveredStyle,d.buttonPressedStyle,d.buttonStyle,l]);return(0,v.jsx)(m.Z,{ref:t,style:y.buttonStyle,hoveredStyle:y.buttonHoveredStyle,pressedStyle:y.buttonPressedStyle,onContextMenu:s,quickActionButtons:a,editButtonClickProps:void 0,children:(0,v.jsx)(x.Y,{fontColor:"light",children:(0,v.jsx)(g,{propertyValue:p,collectionStore:r})})})})));function g(e){const{propertyValue:t,collectionStore:o}=e,n=(0,i.VK)((()=>{var e;const n=null==o||null===(e=o.getRecordKeyStore())||void 0===e?void 0:e.getRecordKey(),r=(0,p.ah)(t);return void 0===r?"...":(0,d.wf)(n,r)}),[o,t]);return(0,v.jsx)(v.Fragment,{children:n})}const C=(0,n.forwardRef)((function(e,t){const{store:o,collectionStore:r,property:l,format:s}=e,a=(0,i.VK)((()=>r.getSchema()),[r]),u=(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Page].text}})),[]),d=(0,n.useMemo)((()=>(0,v.jsx)(y.Z,{store:o,schema:a,property:l,format:s})),[s,l,a,o]),p=T(e,t,u);return(0,v.jsx)(b,{...p,quickActionButtons:d})})),k=(0,n.forwardRef)((function(e,t){const{store:o,collectionStore:r,property:l,format:s}=e,{isMobile:a}=(0,u.Fy)(),d=(0,i.VK)((()=>r.getSchema()),[r]),p=(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Table].text}})),[]),m=(0,n.useMemo)((()=>{if(!a)return(0,v.jsx)(y.Z,{store:o,schema:d,property:l,format:s},"copy")}),[s,a,l,d,o]),f=T(e,t,p);return(0,v.jsx)(b,{...f,quickActionButtons:m})})),w=(0,n.forwardRef)((function(e,t){const{store:o,collectionStore:r,property:l,format:s}=e,a=(0,u.Fy)(),d=(0,i.VK)((()=>r.getSchema()),[r]),p=(0,i.VK)((()=>a.isMobile),[a.isMobile]),m=T(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.CompactPage].text}})),[])),f=(0,n.useMemo)((()=>{if(!p)return(0,v.jsx)(y.Z,{store:o,schema:d,property:l,format:s},"copy")}),[s,p,l,d,o]);return(0,v.jsx)(b,{...m,quickActionButtons:f})})),P=(0,n.forwardRef)((function(e,t){const o=T(e,t);return(0,v.jsx)(b,{...o})})),j=(0,n.forwardRef)((function(e,t){const o=T(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Board].text}})),[]));return(0,v.jsx)(b,{...o})})),_=(0,n.forwardRef)((function(e,t){const o=T(e,t);return(0,v.jsx)(b,{...o})})),R=(0,n.forwardRef)((function(e,t){const o=T(e,t);return(0,v.jsx)(b,{...o})})),M=(0,n.forwardRef)((function(e,t){const o=T(e,t);return(0,v.jsx)(b,{...o})})),B=(0,n.forwardRef)((function(e,t){const o=T(e,t);return(0,v.jsx)(b,{...o})})),V=(0,n.forwardRef)((function(e,t){const o=T(e,t);return(0,v.jsx)(b,{...o})}));function T(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l}=e;return{ref:t,store:n,collectionStore:r,property:i,onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle}}var O=o(798963),A=o(709291),I=o(531701),E=o(793174),K=o(849117),F=o(433929),Z=o(206258),H=o(27755),L=o(863296);const N=n.memo((0,n.forwardRef)((function(e,t){const{store:o,property:r,collectionStore:l,buttonStyle:s,innerButtonStyle:a,onContextMenu:d,disabled:p}=e,y=(0,u.O7)(),{baseStyles:h,propertySchema:S,collectionContextStore:x}=(0,n.useContext)(f.O),b=S,g=(null==h?void 0:h.sizing)??"default",{buttonColors:C}=(0,c.yK)((e=>({buttonColors:(0,I.p6)("default",e)})),[]),k=(0,i.VK)((()=>{const e=y.currentUser.id;if(!x||"button"!==(null==b?void 0:b.type)||!b.automation_id)return;const t=Z.Mz.createChildStore(l,{table:O.cv,id:b.automation_id,spaceId:l.getSpaceId()});return{type:"button_property",persisted:!0,automationStore:t,collectionContextStore:x,propertyId:r,propertySchema:b,intl:F.default.getIntl(),parentRecordStore:t,currentUserId:e,pageStore:o}}),[x,l,y.currentUser.id,r,b,o]),w=(0,n.useCallback)((async()=>{if(!k)return;const{automationExecutionActions:e}=await E._1.load();await e.executeClientAutomation({environment:y,store:o,clientContext:k})}),[k,y,o]),P=(0,i.VK)((()=>(null==k?void 0:k.automationStore.getNameStore().getValue())??(null==b?void 0:b.name)),[null==k?void 0:k.automationStore,null==b?void 0:b.name]),j=(0,i.VK)((()=>{const e=k&&"sufficient"===(0,K.Gb)(k).state.executionPermissionStatus;return p||!e||!o.canEdit()}),[p,k,o]),_=!P||0===P.length,R=(0,c.yK)((e=>({textStyle:{...h.textStyle,color:e.lightTextColor},buttonStyle:{...h.buttonStyle,...s},buttonPressedStyle:h.buttonPressedStyle??{},buttonHoveredStyle:h.buttonHoveredStyle??{},innerButtonStyle:{pointerEvents:"auto",overflow:"hidden",height:"small"===g?20:24,...a},innerButtonLabelStyle:{overflow:"hidden",textOverflow:"ellipsis",color:_?e.lightTextColor:void 0},innerButtonLabelPlaceholderStyle:{color:e.lightTextColor}})),[h.buttonHoveredStyle,h.buttonPressedStyle,h.buttonStyle,h.textStyle,s,a,_,g]);return(0,v.jsx)(m.Z,{ref:t,style:R.buttonStyle,hoveredStyle:R.buttonHoveredStyle,pressedStyle:R.buttonPressedStyle,editButtonClickProps:void 0,onContextMenu:d,children:(0,v.jsx)(L.Z,{backgroundColor:C.background,disabled:j,disabledFeedback:!0,hoveredBackgroundColor:C.hoveredBackground,isSmall:!0,onClick:w,pressedBackgroundColor:C.pressedBackground,style:R.innerButtonStyle,children:(0,v.jsx)("span",{style:R.innerButtonLabelStyle,children:_?(0,v.jsx)(A.FormattedMessage,{...H.y.buttonPlaceholder}):P})})})}))),D=(0,n.forwardRef)((function(e,t){const o=X(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Table].button},innerButtonStyle:{maxWidth:"100%"}})),[]));return(0,v.jsx)(N,{...o})})),U=(0,n.forwardRef)((function(e,t){const o=X(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Page].button}})),[]));return(0,v.jsx)(N,{...o})})),W=(0,n.forwardRef)((function(e,t){const o=X(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.CompactPage].button}})),[]));return(0,v.jsx)(N,{...o})})),z=(0,n.forwardRef)((function(e,t){const o=X(e,t);return(0,v.jsx)(N,{...o})})),q=(0,n.forwardRef)((function(e,t){const o=X(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Board].button}})),[]));return(0,v.jsx)(N,{...o})})),$=(0,n.forwardRef)((function(e,t){const o=X(e,t);return(0,v.jsx)(N,{...o})})),Q=(0,n.forwardRef)((function(e,t){const o=X(e,t);return(0,v.jsx)(N,{...o})})),G=(0,n.forwardRef)((function(e,t){const o=X(e,t,(0,c.yK)((()=>({buttonStyle:{maxWidth:200}})),[]));return(0,v.jsx)(N,{...o})})),Y=(0,n.forwardRef)((function(e,t){const o=X(e,t,(0,c.yK)((()=>({buttonStyle:{height:void 0}})),[]));return(0,v.jsx)(N,{...o})})),J=(0,n.forwardRef)((function(e,t){const o=X(e,t);return(0,v.jsx)(N,{...o})}));function X(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:s}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,onContextMenu:s,buttonStyle:null==o?void 0:o.buttonStyle,innerButtonStyle:null==o?void 0:o.innerButtonStyle}}var ee=o(598953),te=o(108406),oe=o(551365),ne=o(210228),re=o(849616),ie=o(824118),le=o(469823);const se=n.memo(n.forwardRef((function(e,t){const{store:o,property:r,enablePointerEventsForInteractiveTypes:l,editButtonClickProps:s,onClick:a,onContextMenu:d,buttonStyle:y,showLabel:h,disabled:S}=e,x=(0,u.O7)(),b=(0,i.VK)((()=>p.Ml(o.getPropertyValue(r))),[r,o]),{baseStyles:g,propertySchema:C,format:k,collectionContextStore:w}=(0,n.useContext)(f.O),P=ae(o,r,S),j=C,_=(0,n.useCallback)((()=>{const e=o.getPropertyStore(r);e&&w&&(ne.createAndCommit({userAction:"BlockPropertyValue.handleEditButtonClick",environment:x,perform:e=>{oe.vO({stores:[o],property:r,transaction:e})}}),te.rv({environment:x,collectionContextStore:w,block_id:e.id,property:r,property_type:"checkbox",from:(0,re.Sy)(k),isFromBulkActionsToolbar:!1})),a&&a()}),[w,x,k,a,r,o]),R=(0,c.yK)((()=>({buttonStyle:{...g.buttonStyle,...y},buttonPressedStyle:g.buttonPressedStyle??{},buttonHoveredStyle:g.buttonHoveredStyle??{}})),[g,y]);return(0,v.jsx)(m.Z,{ref:t,onContextMenu:d,editButtonClickProps:s,style:R.buttonStyle,hoveredStyle:R.buttonHoveredStyle,pressedStyle:R.buttonPressedStyle,children:(0,v.jsx)(le.n,{propertyLabel:h?null==j?void 0:j.name:void 0,checked:b,enablePointerEventsForInteractiveTypes:l,onClick:_,disabled:P})})})));function ae(e,t,o){return(0,i.VK)((()=>o||!e.canEdit()||(0,ee.w)(t)||e.isNonEditableState()),[o,t,e])}const ue=n.forwardRef((function(e,t){const o=be(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Table].checkbox}})),[]));return(0,v.jsx)(se,{...o,showLabel:!1})})),ce=n.forwardRef((function(e,t){const o=be(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Page].checkbox}})),[]));return(0,v.jsx)(se,{...o,showLabel:!1})})),de=n.forwardRef((function(e,t){const o=be(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.CompactPage].checkbox}})),[]));return(0,v.jsx)(se,{...o,showLabel:!0})})),pe=n.forwardRef((function(e,t){const o=be(e,t);return(0,v.jsx)(se,{...o,showLabel:!1})})),ye=n.forwardRef((function(e,t){const o=be(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Board].checkbox}})),[]));return(0,v.jsx)(se,{...o,showLabel:!0})})),me=n.forwardRef((function(e,t){const o=be(e,t);return(0,v.jsx)(se,{...o,showLabel:!0})})),fe=n.forwardRef((function(e,t){const o=be(e,t);return(0,v.jsx)(se,{...o,showLabel:!0})})),he=n.forwardRef((function(e,t){const o=be(e,t);return(0,v.jsx)(se,{...o,showLabel:!1})})),Se=n.forwardRef((function(e,t){const o=be(e,t);return(0,v.jsx)(se,{...o,showLabel:!1})})),xe=n.forwardRef((function(e,t){const o=be(e,t);return(0,v.jsx)(se,{...o,showLabel:!1})})),ve=n.forwardRef((function(e,t){const o=be(e,t);return(0,v.jsx)(se,{...o,showLabel:!1})}));function be(e,t,o){const{store:n,disabled:r,collectionStore:i,property:l,enablePointerEventsForInteractiveTypes:s,onClick:a,onContextMenu:u}=e;return{ref:t,store:n,disabled:r,collectionStore:i,property:l,editButtonClickProps:(0,ie.Am)(e),enablePointerEventsForInteractiveTypes:s,onClick:a,onContextMenu:u,buttonStyle:null==o?void 0:o.buttonStyle}}var ge=o(477729),Ce=o(177866);const ke=n.memo(n.forwardRef((function(e,t){const{onContextMenu:o,editButtonClickProps:r,property:l,store:s,buttonStyle:a,EmptyComponent:u,quickActionButtons:d=[],showIfEmpty:p}=e,{propertySchema:y,isEmpty:h,baseStyles:S}=(0,n.useContext)(f.O),b=y,g=(0,i.VK)((()=>s.getPropertyValue(l)),[l,s]),C=(0,i.VK)((()=>!(!b||"url"!==b.type)&&!b.show_full_url),[b]),k=(0,c.yK)((()=>({buttonStyle:{...S.buttonStyle,...a},buttonPressedStyle:S.buttonPressedStyle??{},buttonHoveredStyle:S.buttonHoveredStyle??{}})),[S.buttonHoveredStyle,S.buttonPressedStyle,S.buttonStyle,a]);return h&&void 0===u?null:(0,v.jsx)(m.Z,{ref:t,editButtonClickProps:r,onContextMenu:o,style:k.buttonStyle,pressedStyle:k.buttonPressedStyle,hoveredStyle:k.buttonHoveredStyle,quickActionButtons:d,children:h&&void 0!==u?(0,v.jsx)(u,{}):b?(0,v.jsx)(x.Y,{children:(0,v.jsx)(ge.t,{type:b.type,textValue:g,useShortenedUrl:C,disableLinkify:p})}):null})}))),we=n.forwardRef((function(e,t){const{store:o,property:r,format:l,collectionStore:s}=e,{isMobile:a}=(0,u.Fy)(),d=(0,i.VK)((()=>s.getSchema()),[s]),p=(0,n.useMemo)((()=>{if(!a)return(0,v.jsx)(y.Z,{store:o,schema:d,property:r,format:l},"copy")}),[l,a,r,d,o]),m=Ie(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Table].text}})),[]));return(0,v.jsx)(ke,{...m,EmptyComponent:Ce.q8,quickActionButtons:p})})),Pe=n.forwardRef((function(e,t){const{store:o,property:r,format:l,collectionStore:s}=e,a=(0,i.VK)((()=>s.getSchema()),[s]),u=(0,n.useMemo)((()=>(0,v.jsx)(y.Z,{store:o,schema:a,property:r,format:l},"copy")),[l,r,a,o]),d=Ie(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Page].text}})),[]));return(0,v.jsx)(ke,{...d,EmptyComponent:Ce.T$,quickActionButtons:u})})),je=n.forwardRef((function(e,t){const o=Ie(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.CompactPage].text}})),[]));return(0,v.jsx)(ke,{...o,EmptyComponent:Ce.T$})})),_e=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Ie(e,t);return(0,v.jsx)(ke,{...n,EmptyComponent:o?Ce.s3:void 0})})),Re=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Ie(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Board].text}})),[]));return(0,v.jsx)(ke,{...n,EmptyComponent:o?Ce.s3:void 0})})),Me=n.forwardRef((function(e,t){const o=Ie(e,t);return(0,v.jsx)(ke,{...o})})),Be=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Ie(e,t);return(0,v.jsx)(ke,{...n,EmptyComponent:o?Ce.s3:void 0})})),Ve=n.forwardRef((function(e,t){const o=Ie(e,t);return(0,v.jsx)(ke,{...o})})),Te=n.forwardRef((function(e,t){const o=Ie(e,t);return(0,v.jsx)(ke,{...o})})),Oe=n.forwardRef((function(e,t){const o=Ie(e,t);return(0,v.jsx)(ke,{...o})})),Ae=n.forwardRef((function(e,t){const o=Ie(e,t);return(0,v.jsx)(ke,{...o,EmptyComponent:Ce.zX,showIfEmpty:!0})}));function Ie(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,ie.Am)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle}}var Ee=o(253877),Ke=o(842875),Fe=o(481381),Ze=o(69582);const He=n.memo((0,n.forwardRef)((function(e,t){const{store:o,onContextMenu:r,editButtonClickProps:l,quickActionButtons:s,EmptyComponent:a,buttonStyle:u,property:d}=e,{isEmpty:y,baseStyles:h,templateVariableContext:S,propertySchema:b,propertyFormat:g}=(0,n.useContext)(f.O),C=b,k=function(e,t,o){return(0,i.VK)((()=>{switch(t){case"created_time":const t=e.getCreatedTime();return t?Ee.CQ(t,(0,Ke.r)()):void 0;case"last_edited_time":const n=e.getLastEditedTime();return n?Ee.CQ(n,(0,Ke.r)()):void 0;default:const r=e.getPropertyValue(o);return(0,p.Gl)(r)}}),[o,e,t])}(o,null==C?void 0:C.type,d),w=(0,c.yK)((e=>({buttonStyle:{...h.buttonStyle,...u},buttonPressedStyle:h.buttonPressedStyle??{},buttonHoveredStyle:h.buttonHoveredStyle??{}})),[h.buttonHoveredStyle,h.buttonPressedStyle,h.buttonStyle,u]);if(y&&void 0===a&&void 0===S)return null;let P;if(S)P=(0,v.jsx)(Ze.P,{templateVariableType:S.templateVariable});else if(y&&void 0!==a)P=(0,v.jsx)(a,{});else{const e=(null==g?void 0:g.date_format)??(null==C?void 0:C.date_format),t=(null==g?void 0:g.time_format)??(null==C?void 0:C.time_format);P=(0,v.jsx)(x.Y,{children:(0,v.jsx)(Fe.z,{dateValue:k,dateFormat:e,timeFormat:t})})}return(0,v.jsx)(m.Z,{ref:t,style:w.buttonStyle,hoveredStyle:w.buttonHoveredStyle,pressedStyle:w.buttonPressedStyle,onContextMenu:r,editButtonClickProps:l,quickActionButtons:s,children:P})})));const Le=(0,n.forwardRef)((function(e,t){const{store:o,collectionStore:r,property:l,format:s}=e,{isMobile:a}=(0,u.Fy)(),d=(0,i.VK)((()=>r.getSchema()),[r]),p=(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Page].text}})),[]),m=(0,n.useMemo)((()=>{if(!a)return(0,v.jsx)(y.Z,{store:o,schema:d,property:l,format:s},"copy")}),[s,a,l,d,o]),f=Je(e,t,p);return(0,v.jsx)(He,{...f,EmptyComponent:Ce.T$,quickActionButtons:m})})),Ne=(0,n.forwardRef)((function(e,t){const{store:o,collectionStore:r,property:l,format:s}=e,{isMobile:a}=(0,u.Fy)(),d=(0,i.VK)((()=>r.getSchema()),[r]),p=(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Table].text}})),[]),m=(0,n.useMemo)((()=>{if(!a)return(0,v.jsx)(y.Z,{store:o,schema:d,property:l,format:s},"copy")}),[s,a,l,d,o]),f=Je(e,t,p);return(0,v.jsx)(He,{...f,EmptyComponent:Ce.q8,quickActionButtons:m})})),De=(0,n.forwardRef)((function(e,t){const o=Je(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.CompactPage].text}})),[]));return(0,v.jsx)(He,{...o,EmptyComponent:Ce.T$})})),Ue=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Je(e,t);return(0,v.jsx)(He,{...n,EmptyComponent:o?Ce.s3:void 0})})),We=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Je(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Board].text}})),[]));return(0,v.jsx)(He,{...n,EmptyComponent:o?Ce.s3:void 0})})),ze=(0,n.forwardRef)((function(e,t){const o=Je(e,t);return(0,v.jsx)(He,{...o})})),qe=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Je(e,t);return(0,v.jsx)(He,{...n,EmptyComponent:o?Ce.s3:void 0})})),$e=(0,n.forwardRef)((function(e,t){const o=Je(e,t);return(0,v.jsx)(He,{...o})})),Qe=(0,n.forwardRef)((function(e,t){const o=Je(e,t);return(0,v.jsx)(He,{...o})})),Ge=(0,n.forwardRef)((function(e,t){const o=Je(e,t);return(0,v.jsx)(He,{...o})})),Ye=(0,n.forwardRef)((function(e,t){const o=Je(e,t);return(0,v.jsx)(He,{...o,EmptyComponent:Ce.zX})}));function Je(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,ie.Am)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle}}var Xe=o(296994),et=o(279954),tt=o(679074),ot=o(983559);const nt=n.memo(n.forwardRef((function(e,t){const{store:o,EmptyComponent:r,onContextMenu:l,buttonStyle:s,selectableStyle:a,property:d,editButtonClickProps:y}=e,h=(0,u.O7)(),{baseStyles:S,collectionContextStore:x,isReadOnly:b}=(0,n.useContext)(f.O),[g,C]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{C(o.clone())}),[o]);const k=(0,n.useCallback)((e=>{oe.bA({environment:h,blockPropertyValueOverlayStore:y.blockPropertyValueOverlayStore,store:o,property:d,format:y.format,uploadFiles:e.files,disableHorizontalEdgeScroll:y.disableHorizontalEdgeScroll,collectionContextStore:x})}),[x,y.blockPropertyValueOverlayStore,y.disableHorizontalEdgeScroll,y.format,h,d,o]),w=(0,i.VK)((()=>{const e=o.getPropertyValue(d);return p.g(e)}),[o,d]),P=(0,c.yK)((()=>{var e;return{buttonStyle:{...S.buttonStyle,...s},buttonPressedStyle:S.buttonPressedStyle??{},buttonHoveredStyle:S.buttonHoveredStyle??{},selectableStyle:{display:"inherit",borderRadius:null===(e=S.buttonStyle)||void 0===e?void 0:e.borderRadius,...a}}}),[S.buttonHoveredStyle,S.buttonPressedStyle,S.buttonStyle,s,a]),j=!w||0===w.length,_=(0,n.useMemo)((()=>(0,v.jsx)(ot.K,{children:w.map(((e,t)=>(0,v.jsx)(tt.e,{linkValue:e,permissionRecord:o.pointer},e.url+t)))})),[w,o.pointer]);return!g||j&&void 0===r?null:(0,v.jsx)(et.Z,{store:g,canNativeDropOnto:!b,onNativeDrop:k,analyticsName:"file_property",shouldShowDropZone:!b,style:P.selectableStyle,children:(0,v.jsx)(m.Z,{ref:t,onContextMenu:l,editButtonClickProps:y,style:P.buttonStyle,pressedStyle:P.buttonPressedStyle,hoveredStyle:P.buttonHoveredStyle,children:j&&void 0!==r?(0,v.jsx)(r,{}):_})})}))),rt=n.forwardRef((function(e,t){const o=ft(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Table].button,height:"100%"},selectableStyle:{width:"100%"}})),[]));return(0,v.jsx)(nt,{...o,EmptyComponent:Ce.q8})})),it=n.forwardRef((function(e,t){const o=ft(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Page].button,width:"100%"},selectableStyle:{width:"100%"}})),[]));return(0,v.jsx)(nt,{...o,EmptyComponent:Ce.T$})})),lt=n.forwardRef((function(e,t){const o=ft(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.CompactPage].button}})),[]));return(0,v.jsx)(nt,{...o,EmptyComponent:Ce.T$})})),st=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=ft(e,t);return(0,v.jsx)(nt,{...n,EmptyComponent:o?Ce.s3:void 0})})),at=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=ft(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Board].button,width:"100%"},selectableStyle:{width:"100%"}})),[]));return(0,v.jsx)(nt,{...n,EmptyComponent:o?Ce.s3:void 0})})),ut=n.forwardRef((function(e,t){const o=ft(e,t);return(0,v.jsx)(nt,{...o})})),ct=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=ft(e,t);return(0,v.jsx)(nt,{...n,EmptyComponent:o?Ce.s3:void 0})})),dt=n.forwardRef((function(e,t){const o=ft(e,t);return(0,v.jsx)(nt,{...o})})),pt=n.forwardRef((function(e,t){const o=ft(e,t);return(0,v.jsx)(nt,{...o})})),yt=n.forwardRef((function(e,t){const o=ft(e,t);return(0,v.jsx)(nt,{...o})})),mt=n.forwardRef((function(e,t){return(0,v.jsx)(Xe.pt,{...e})}));function ft(e,t,o){const{store:n,onContextMenu:r,property:i}=e;return{ref:t,store:n,property:i,editButtonClickProps:(0,ie.Am)(e),onContextMenu:r,buttonStyle:null==o?void 0:o.buttonStyle,selectableStyle:null==o?void 0:o.selectableStyle}}var ht=o(630752),St=o(230694);const xt=n.memo(n.forwardRef((function(e,t){const{store:o,EmptyComponent:r,onContextMenu:l,buttonStyle:s}=e,{baseStyles:a,collectionContextStore:u}=(0,n.useContext)(f.O),d=(0,i.VK)((()=>o.getAssociatedCollectionStore()),[o]),p=(0,c.yK)((()=>({buttonStyle:{...a.buttonStyle,minWidth:32,...s},buttonPressedStyle:a.buttonPressedStyle??{},buttonHoveredStyle:a.buttonHoveredStyle??{}})),[a.buttonHoveredStyle,a.buttonPressedStyle,a.buttonStyle,s]),y=!d||!u;return y&&void 0===r?null:(0,v.jsx)(m.Z,{ref:t,onContextMenu:l,editButtonClickProps:void 0,style:p.buttonStyle,pressedStyle:p.buttonPressedStyle,hoveredStyle:p.buttonHoveredStyle,tooltipPropertyValue:(0,v.jsx)(St.L,{collectionForLocationStore:d,collectionContextStore:u}),children:y&&void 0!==r?(0,v.jsx)(r,{}):(0,v.jsx)(St.Z,{collectionContextStore:u,collectionForLocationStore:d})})}))),vt=n.forwardRef((function(e,t){const o=Mt(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Table].text}})),[]));return(0,v.jsx)(xt,{...o,EmptyComponent:Ce.q8})})),bt=n.forwardRef((function(e,t){const o=Mt(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Page].text}})),[]));return(0,v.jsx)(xt,{...o,EmptyComponent:Ce.T$})})),gt=n.forwardRef((function(e,t){const o=Mt(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.CompactPage].text}})),[]));return(0,v.jsx)(xt,{...o,EmptyComponent:Ce.T$})})),Ct=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Mt(e,t);return(0,v.jsx)(xt,{...n,EmptyComponent:o?Ce.s3:void 0})})),kt=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Mt(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Board].text}})),[]));return(0,v.jsx)(xt,{...n,EmptyComponent:o?Ce.s3:void 0})})),wt=n.forwardRef((function(e,t){const o=Mt(e,t);return(0,v.jsx)(xt,{...o})})),Pt=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Mt(e,t);return(0,v.jsx)(xt,{...n,EmptyComponent:o?Ce.s3:void 0})})),jt=n.forwardRef((function(e,t){const o=Mt(e,t);return(0,v.jsx)(xt,{...o})})),_t=n.forwardRef((function(e,t){const o=Mt(e,t);return(0,v.jsx)(xt,{...o})})),Rt=n.forwardRef((function(e,t){const o=Mt(e,t);return(0,v.jsx)(xt,{...o})}));function Mt(e,t,o){const{store:n,onContextMenu:r}=e;return{ref:t,store:n,onContextMenu:r,buttonStyle:null==o?void 0:o.buttonStyle}}var Bt=o(984619),Vt=o(825464),Tt=o(526388),Ot=o(399036),At=o(920669),It=o(772899),Et=o(319124),Kt=o(785957),Ft=o(679576),Zt=o(619671),Ht=o(813023),Lt=o(896026),Nt=o(573063);function Dt(e){const{href:t,icon:o,iconStyle:n,tooltip:r,externalLink:i,onClick:l}=e;return(0,v.jsx)(Tt.Z,{renderTooltip:()=>r,render:e=>(0,v.jsx)(Nt.Z,{ariaLabel:r,icon:o,iconStyle:n,href:t,onClick:l,hasBackground:!0,showShadow:!0,external:i,...e})})}function Ut(e){const{store:t,property:o,openOverlay:r}=e,l=(0,u.O7)(),s=(0,c.Fg)(),{propertySchema:a,format:d,collectionContextStore:p,isEmpty:y,isReadOnly:m}=(0,n.useContext)(f.O),h=(0,n.useCallback)((async()=>{if(!a)return;if(r){const e=(0,Kt.wq)(t)?Ht.Z:Zt.Z;oe.bA({blockPropertyValueOverlayStore:e,collectionContextStore:p,format:d,environment:l,store:t,property:o,readOnly:!0})}const e=Ft.W.setIsWriting({propertySchema:a,stores:[t]}),{propertyCompletionsActions:n}=await It.aiDependency.load();n.autofillPropertyForBlocks({environment:l,stores:[t],property:o,propertySchema:a,userEventForAnalytics:"generate_from_action_button",collectionContextStore:p,sessionIdForAnalytics:e,from:re.Sy(d)})}),[p,l,d,r,o,a,t]);return(0,i.VK)((()=>!m&&(!l.device.isMobile||y)&&(0,Et.RT)(Lt.Z.getMode(l,t),t)&&a&&(0,Ot.qQ)(a)&&(0,Ot.q3)(a)&&("text"===a.type||(0,Et.KZ)())),[l,m,y,a,t])?(0,v.jsx)(Dt,{icon:At.y,iconStyle:{fill:s.aiPurpleColor},tooltip:F.default.formatMessage(Wt.update),onClick:h}):null}const Wt=(0,A.defineMessages)({update:{defaultMessage:"Update",id:"database.editButton.autofillWithAiTooltip"}});var zt=o(388071),qt=o(244731);const $t=n.memo((0,n.forwardRef)((function(e,t){const{buttonStyle:o,editButtonClickProps:r,property:l,EmptyComponent:s,onContextMenu:a,tokenLimit:u,store:d}=e,{propertySchema:y,isEmpty:h,baseStyles:S}=(0,n.useContext)(f.O),x=(null==S?void 0:S.tokenFormat)??Bt.lo.Medium,b=y,g=(0,i.VK)((()=>(null==b?void 0:b.options)??[]),[b]),C=(0,i.VK)((()=>null==b?void 0:b.type),[b]),[k,w]=(0,i.VK)((()=>{const e=d.getPropertyValue(l);let t=[];if("select"===C){const o=p.P4(e,g);t=o?[o]:[]}else t=p.ib(e,g);return[u?t.slice(0,u):t,u?t.slice(u):[]]}),[d,l,C,u,g]),P=(0,c.yK)((e=>({buttonStyle:{...S.buttonStyle,...o},buttonPressedStyle:S.buttonPressedStyle??{},buttonHoveredStyle:S.buttonHoveredStyle??{},overflowIndicator:{marginRight:4,color:e.mediumTextColor},tooltip:{padding:8},remainderPropertiesContainer:{display:"flex",flexWrap:"wrap",fontWeight:"normal",width:"max-content",maxWidth:"240px",gap:4},selectToken:{margin:0},moreToken:{margin:0}})),[S.buttonHoveredStyle,S.buttonPressedStyle,S.buttonStyle,o]),j=(0,n.useMemo)((()=>(0,v.jsx)(Ut,{store:d,property:l,openOverlay:!0},"autofill")),[l,d]);return h&&void 0===s?null:(0,v.jsx)(m.Z,{ref:t,editButtonClickProps:r,onContextMenu:a,style:P.buttonStyle,hoveredStyle:P.buttonHoveredStyle,pressedStyle:P.buttonPressedStyle,quickActionButtons:j,children:h&&void 0!==s?(0,v.jsx)(s,{}):(0,v.jsx)(Qt,{shownOptions:k,hiddenOptions:w,tokenLimit:u,tokenFormat:x,styles:P})})})));function Qt(e){let{shownOptions:t,hiddenOptions:o,tokenLimit:n,styles:r,tokenFormat:i}=e;return(0,v.jsxs)(ot.K,{children:[t.map((e=>(0,v.jsx)(qt.J,{type:"select",value:e.value,color:e.color,shouldShrink:!!n},e.id))),o.length>0&&(0,v.jsx)(Tt.Z,{style:r.tooltip,renderTooltip:()=>(0,v.jsx)("div",{style:r.remainderPropertiesContainer,children:o.map((e=>(0,v.jsx)(qt.J,{type:"select",value:e.value,color:e.color,shouldShrink:!1},e.id)))}),isLightBackground:!0,textWrap:!0,alignment:Vt.v.Center,placement:Vt.u.Bottom,render:e=>(0,v.jsx)("div",{...e,children:(0,v.jsx)(zt.Z,{count:o.length,format:i,fixedHeight:!1,style:r.moreToken,isCompact:!0})})})]})}const Gt=(0,n.forwardRef)((function(e,t){const o=so(e,t);return(0,v.jsx)($t,{...o,EmptyComponent:Ce.q8})})),Yt=(0,n.forwardRef)((function(e,t){const o=so(e,t);return(0,v.jsx)($t,{...o,EmptyComponent:Ce.T$})})),Jt=(0,n.forwardRef)((function(e,t){const o=so(e,t);return(0,v.jsx)($t,{...o,EmptyComponent:Ce.T$,tokenLimit:2})})),Xt=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=so(e,t);return(0,v.jsx)($t,{...n,EmptyComponent:o?Ce.s3:void 0})})),eo=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=so(e,t);return(0,v.jsx)($t,{...n,EmptyComponent:o?Ce.s3:void 0})})),to=(0,n.forwardRef)((function(e,t){const o=so(e,t);return(0,v.jsx)($t,{...o})})),oo=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=so(e,t);return(0,v.jsx)($t,{...n,EmptyComponent:o?Ce.s3:void 0})})),no=(0,n.forwardRef)((function(e,t){const o=so(e,t);return(0,v.jsx)($t,{...o})})),ro=(0,n.forwardRef)((function(e,t){const o=so(e,t);return(0,v.jsx)($t,{...o})})),io=(0,n.forwardRef)((function(e,t){const o=so(e,t);return(0,v.jsx)($t,{...o})})),lo=(0,n.forwardRef)((function(e,t){const o=so(e,t);return(0,v.jsx)($t,{...o,EmptyComponent:Ce.zX,tokenLimit:1})}));function so(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,ie.Am)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle}}var ao=o(59580);const uo=n.memo((0,n.forwardRef)((function(e,t){var o,r;const{store:l,buttonStyle:s,onContextMenu:a,editButtonClickProps:u,quickActionButtons:d,EmptyComponent:y,isRightAligned:h,property:S}=e,{isEmpty:b,baseStyles:g,propertySchema:C,shouldRenderTooltip:k}=(0,n.useContext)(f.O),w=C,P=(0,i.VK)((()=>{const e=l.getPropertyValue(S);return p.VY(e)}),[S,l]),j=(0,re.X7)({numberValue:P,numberFormat:null==w?void 0:w.number_format,numberShowAs:null==w?void 0:w.show_as}),_=(0,c.yK)((()=>({buttonStyle:{...g.buttonStyle,...s},buttonPressedStyle:g.buttonPressedStyle??{},buttonHoveredStyle:g.buttonHoveredStyle??{}})),[g.buttonHoveredStyle,g.buttonPressedStyle,g.buttonStyle,s]);if(b&&void 0===y)return null;const R="bar"===(null==w||null===(o=w.show_as)||void 0===o?void 0:o.type)||"ring"===(null==w||null===(r=w.show_as)||void 0===r?void 0:r.type);return(0,v.jsx)(m.Z,{ref:t,style:_.buttonStyle,hoveredStyle:_.buttonHoveredStyle,pressedStyle:_.buttonPressedStyle,onContextMenu:a,editButtonClickProps:u,quickActionButtons:d,quickActionButtonsAlign:h?"left":void 0,tooltipPropertyValue:k?j:void 0,children:b&&void 0!==y?(0,v.jsx)(y,{}):R?(0,v.jsx)(ot.K,{isRightAligned:h,children:(0,v.jsx)(ao.A,{numberValue:P,isRightAligned:h})}):(0,v.jsx)(x.Y,{isRightAligned:h,children:(0,v.jsx)(ao.A,{numberValue:P,isRightAligned:h})})})}))),co=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:l,collectionStore:s}=e,a=Co(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Page].text}})),[])),u=(0,i.VK)((()=>s.getSchema()),[s]),d=(0,n.useMemo)((()=>(0,v.jsx)(y.Z,{store:o,schema:u,property:r,format:l},"copy")),[l,r,u,o]);return(0,v.jsx)(uo,{...a,EmptyComponent:Ce.T$,quickActionButtons:d})})),po=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:l,collectionStore:s}=e,{isMobile:a}=(0,u.Fy)(),d=Co(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Table].text}})),[])),p=(0,i.VK)((()=>s.getSchema()),[s]),m=(0,n.useMemo)((()=>{if(!a)return(0,v.jsx)(y.Z,{store:o,schema:p,property:r,format:l},"copy")}),[l,a,r,p,o]);return(0,v.jsx)(uo,{...d,EmptyComponent:Ce.q8,quickActionButtons:m,isRightAligned:!0})})),yo=(0,n.forwardRef)((function(e,t){const o=Co(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.CompactPage].text}})),[]));return(0,v.jsx)(uo,{...o,EmptyComponent:Ce.T$})})),mo=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Co(e,t);return(0,v.jsx)(uo,{...n,EmptyComponent:o?Ce.s3:void 0})})),fo=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Co(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Board].text}})),[]));return(0,v.jsx)(uo,{...n,EmptyComponent:o?Ce.s3:void 0})})),ho=(0,n.forwardRef)((function(e,t){const o=Co(e,t);return(0,v.jsx)(uo,{...o})})),So=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Co(e,t);return(0,v.jsx)(uo,{...n,EmptyComponent:o?Ce.s3:void 0})})),xo=(0,n.forwardRef)((function(e,t){const o=Co(e,t);return(0,v.jsx)(uo,{...o})})),vo=(0,n.forwardRef)((function(e,t){const o=Co(e,t);return(0,v.jsx)(uo,{...o})})),bo=(0,n.forwardRef)((function(e,t){const o=Co(e,t);return(0,v.jsx)(uo,{...o})})),go=(0,n.forwardRef)((function(e,t){const o=Co(e,t);return(0,v.jsx)(uo,{...o,EmptyComponent:Ce.zX})}));function Co(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,ie.Am)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle}}o(21703);var ko=o(266897),wo=o(76233),Po=o(401898),jo=o(93044),_o=o(311061),Ro=o(818417);const Mo=n.memo(n.forwardRef((function(e,t){const{buttonStyle:o,onContextMenu:r,editButtonClickProps:i,property:l,store:s,EmptyComponent:a,tokenLimit:u}=e,{propertySchema:d,isEmpty:p,baseStyles:y,templateVariableContext:h}=(0,n.useContext)(f.O),S=(null==y?void 0:y.tokenFormat)??Bt.lo.Medium,x=Vo({store:s,property:l,propertySchema:d}),b=(0,c.yK)((()=>({buttonStyle:{...y.buttonStyle,...o},buttonPressedStyle:y.buttonPressedStyle??{},buttonHoveredStyle:y.buttonHoveredStyle??{},tokensContainer:{...S===Bt.lo.Inline?{gap:0}:{}},actorTokenOverlap:{...S===Bt.lo.Inline?{margin:jo.wS[S].margin}:{}},moreToken:{margin:0}})),[y.buttonHoveredStyle,y.buttonPressedStyle,y.buttonStyle,o,S]);return p&&void 0===a?null:(0,v.jsx)(m.Z,{ref:t,editButtonClickProps:i,onContextMenu:r,style:b.buttonStyle,pressedStyle:b.buttonPressedStyle,hoveredStyle:b.buttonHoveredStyle,tooltipHide:S===Bt.lo.Inline,children:p&&void 0!==a&&!h?(0,v.jsx)(a,{}):(0,v.jsx)(Bo,{values:x,tokenLimit:u,tokenFormat:S,styles:b})})})));function Bo(e){let{values:t,tokenLimit:o,tokenFormat:n,styles:r}=e;const i=t.slice(0,o);return(0,v.jsxs)(ot.K,{style:r.tokensContainer,children:[i.map(((e,o)=>(0,ko.Wk)(e)?(0,v.jsx)(Ro.H,{actorPointer:e,style:o<t.length-1?r.actorTokenOverlap:void 0},e.id):(0,wo.D4X)(e)?(0,v.jsx)(Ze.w,{templateVariableType:e},`person-property-value-${e}`):void(0,Po.t1)(e))),o&&t.length>o&&(0,v.jsx)(zt.Z,{count:t.length-o,format:n,style:r.moreToken,fixedHeight:!0,isCompact:!0})]})}function Vo(e){let{property:t,store:o,propertySchema:n}=e;return(0,i.VK)((()=>{const e=null==n?void 0:n.type;switch(e){case"created_by":{const e=o.getCreatedByPointer();if(e)return[e];break}case"last_edited_by":{const e=o.getLastEditedByPointer();if(e)return[e];break}case"person":return(0,p.BW)({value:o.getPropertyValue(t),isTemplatePage:o.isTemplate(),propertySchema:n,blockCreatorPointer:o.getCreatedByPointer()});case void 0:return[];default:(0,Po.t1)(e)}return[]}),[t,n,o])}const To=n.forwardRef((function(e,t){const o=Uo(e,t);return(0,v.jsx)(Mo,{...o,EmptyComponent:Ce.q8})})),Oo=n.forwardRef((function(e,t){const{store:o,property:n,collectionStore:r}=e,i=Uo(e,t);return(0,v.jsx)(_o.O,{store:o,property:n,collectionStore:r,children:(0,v.jsx)(Mo,{...i,EmptyComponent:Ce.T$})})})),Ao=n.forwardRef((function(e,t){const o=Uo(e,t);return(0,v.jsx)(Mo,{...o,EmptyComponent:Ce.T$,tokenLimit:1})})),Io=n.forwardRef((function(e,t){const o=Uo(e,t);return(0,v.jsx)(Mo,{...o,EmptyComponent:Ce.zX,tokenLimit:1})})),Eo=n.forwardRef((function(e,t){const{store:o,property:r}=Uo(e,t),{propertySchema:i,propertyModule:l}=(0,n.useContext)(f.O),s=i,a=Vo({store:o,property:r,propertySchema:s});let u;if(!l||"property_person"!==l.type&&"property_created_by"!==l.type&&"property_last_edited_by"!==l.type)throw new Error("Expected to find a property_person module.");return u=l,(0,v.jsx)(Xe.rA,{store:o,property:r,propertyValues:a,propertySchema:s,module:u})})),Ko=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Uo(e,t);return(0,v.jsx)(Mo,{...n,EmptyComponent:o?Ce.s3:void 0})})),Fo=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Uo(e,t);return(0,v.jsx)(Mo,{...n,EmptyComponent:o?Ce.s3:void 0})})),Zo=n.forwardRef((function(e,t){const o=Uo(e,t);return(0,v.jsx)(Mo,{...o})})),Ho=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Uo(e,t);return(0,v.jsx)(Mo,{...n,EmptyComponent:o?Ce.s3:void 0})})),Lo=n.forwardRef((function(e,t){const o=Uo(e,t);return(0,v.jsx)(Mo,{...o})})),No=n.forwardRef((function(e,t){const o=Uo(e,t);return(0,v.jsx)(Mo,{...o})})),Do=n.forwardRef((function(e,t){const o=Uo(e,t);return(0,v.jsx)(Mo,{...o})}));function Uo(e,t,o){const{store:n,property:r,onContextMenu:i}=e;return{ref:t,store:n,property:r,editButtonClickProps:(0,ie.Am)(e),onContextMenu:i,buttonStyle:null==o?void 0:o.buttonStyle}}o(757658);var Wo=o(494714),zo=o(137810),qo=o(431869),$o=o(614473),Qo=o(229798),Go=o(985526),Yo=o(164921),Jo=o(632163),Xo=o(672495),en=o(297820),tn=o(152247),on=o(790692);const nn=n.memo((0,n.forwardRef)((function(e,t){const{collectionStore:o,buttonStyle:r,editButtonClickProps:l,property:s,EmptyComponent:a,onContextMenu:u,blockPropertyValueOverlayStore:d,store:y,format:h,renderAs:S}=e,{propertySchema:x,isReadOnly:b,baseStyles:g}=(0,n.useContext)(f.O),C=x,k=(null==g?void 0:g.tokenFormat)??Bt.lo.Medium,w=(0,i.qz)(void 0,Qo.Z),P=(0,i.VK)((()=>{const e=y.getPropertyValue(s);return C?p.j$({relationValue:p.rq(e),propertySchema:C,getRecordModel:y.getRecordModel}):void 0}),[y,s,C]),j=(0,n.useMemo)((()=>{const e=C?Ot.j0(C):void 0;return e?Z.NW.createChildStore(y,e):void 0}),[C,y]),_=(0,i.VK)((()=>{const e=null!=C&&C.limit&&P?P.slice(0,C.limit):P;return e?e.map((e=>{const t=Z.G.createChildStore(y,e),o=t.getAssociatedCollectionStore();if(!o)return;const n=o.id;return C&&n===Ot.F0(C)?{pointer:e,pageStore:t}:void 0})).filter(Po.$K):[]}),[C,P,y]),R=0===_.length,M="rows"===S&&!R,B=(0,c.yK)((e=>({buttonStyle:{...g.buttonStyle,...r,...M&&{padding:0}},buttonPressedStyle:g.buttonPressedStyle??{},buttonHoveredStyle:g.buttonHoveredStyle??{},overflowIndicator:{marginRight:4,color:e.mediumTextColor}})),[g.buttonHoveredStyle,g.buttonPressedStyle,g.buttonStyle,r,M]),V=(0,n.useMemo)((()=>j?"rows"===S?C&&P&&(0,v.jsx)(rn,{relationItemPointers:_,relationValue:P,collectionStore:o,menuListStore:w,store:y,targetCollectionStore:j,property:s,disabled:b,buttonContainerRef:t,blockPropertyValueOverlayStore:d,format:h,propertySchema:C}):"inline"===S?(0,v.jsx)(ln,{relationItemPointers:_,store:y,tokenFormat:k}):void(0,Po.t1)(S):null),[d,o,h,b,w,s,C,t,_,P,S,y,j,k]);return R&&void 0===a?null:(0,v.jsx)(m.Z,{ref:t,editButtonClickProps:M?void 0:l,onContextMenu:u,style:B.buttonStyle,hoveredStyle:B.buttonHoveredStyle,pressedStyle:B.buttonPressedStyle,children:R&&void 0!==a?(0,v.jsx)(a,{}):V})})));function rn(e){const{collectionStore:t,targetCollectionStore:o,relationItemPointers:r,relationValue:s,property:a,store:d,disabled:p,menuListStore:y,buttonContainerRef:m,blockPropertyValueOverlayStore:f,format:h,propertySchema:S}=e,x=(0,l.Y$)(),b=(0,u.O7)(),g=(0,n.useCallback)(((e,t)=>{oe.bA({environment:b,blockPropertyValueOverlayStore:f,store:d,property:a,rect:null==t?void 0:t.getBoundingClientRect(),format:h,mode:e,collectionContextStore:x})}),[f,x,b,h,a,d]),C=(0,n.useCallback)(((e,t)=>{if(!x)return;const o=e.filter((e=>e.id!==t.id));ne.createAndCommit({userAction:"RelationBlockPropertyValue.handleRemoveRelationClick",environment:b,perform:e=>{qo.sf({store:d,propertyId:a,value:o,environment:b,relatedPageId:t.id,propertySchema:S,transaction:e,collectionContextStore:x,analyticsData:{isFromBulkActionsToolbar:re.VM(f),analyticsFrom:re.Sy(h)},isUnthrottled:!1})}})}),[f,x,b,h,a,S,d]),k=(0,i.VK)((()=>o.getFormatStore().getKeyStore("app_config_uri").getValue()===Wo.p$),[o]),w=(0,c.yK)((()=>({moreMenuItem:{width:"100%",display:"flex",alignItems:"center",justifyItems:"center",borderRadius:4,fontSize:14,minHeight:32,margin:0,padding:"6px 8px"},moreMenuItemLabel:{lineHeight:"normal",margin:0}})),[]),P=r.slice(0,5).map(((e,n)=>{let{pageStore:r}=e;return{key:r.id,render:e=>{let{ref:i,...l}=e;return(0,v.jsx)(Xe.aJ,{...l,canDrag:!1,collectionStore:t,targetCollectionStore:o,relatedPageStore:r,disabled:p,isSelected:!0,pageStore:d,property:a,rowType:"inline",onActionButtonClick:()=>{C(s,r)},onMouseLeave:()=>y.unsetFocus(),onSecondaryButtonClick:e=>{g({type:k?"view":"add",index:n+1},e)},onOpenPageButtonClick:()=>{$o.O(s,r,b,"relation_property")}})},action:()=>{}}}));return r.length>5&&P.push({key:"add",render:e=>(0,v.jsx)(Yo.Z,{...e,style:w.moreMenuItem,onClick:e=>g({type:"view"},m&&"current"in m?m.current:void 0),children:(0,v.jsx)(zt.Z,{style:w.moreMenuItemLabel,count:r.length-5,format:Bt.lo.Medium,fixedHeight:!1,isCompact:!1})}),action:()=>{g({type:"add",index:s.length},void 0)}}),(0,v.jsx)(Jo.Z,{type:Jo.i.Vertical,store:y,initialFocus:void 0,disableKeyboard:!0,style:{width:"100%"},sections:[{key:"results",render:e=>(0,v.jsx)(Xo.Z,{...e,disableDesktopPadding:!0,disableMobileBorders:!0,children:e.children}),items:P}]})}function ln(e){const{relationItemPointers:t,store:o,tokenFormat:n}=e,r=(0,c.yK)((()=>({moreToken:{margin:0}})),[]),i=t.slice(0,10).map((e=>{let{pointer:t}=e;return(0,v.jsx)(on.Z,{recordPointer:t,parentStore:o},t.id)}));return t.length>10&&i.push((0,v.jsx)(zt.Z,{style:r.moreToken,count:t.length-10,format:n,fixedHeight:!1,isCompact:!0})),(0,v.jsx)(ot.K,{children:i})}const sn=(0,n.forwardRef)((function(e,t){const o=bn(e,t);return(0,v.jsx)(nn,{...o,EmptyComponent:Ce.q8,renderAs:"inline"})})),an=(0,n.forwardRef)((function(e,t){const{store:o,property:n,collectionStore:r}=e,i=bn(e,t);return(0,v.jsx)(_o.O,{store:o,property:n,collectionStore:r,children:(0,v.jsx)(nn,{...i,EmptyComponent:Ce.T$,renderAs:"rows"})})})),un=(0,n.forwardRef)((function(e,t){const o=bn(e,t);return(0,v.jsx)(nn,{...o,EmptyComponent:Ce.T$,renderAs:"rows"})})),cn=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=bn(e,t);return(0,v.jsx)(nn,{...n,EmptyComponent:o?Ce.s3:void 0,renderAs:"inline"})})),dn=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=bn(e,t);return(0,v.jsx)(nn,{...n,EmptyComponent:o?Ce.s3:void 0,renderAs:"inline"})})),pn=(0,n.forwardRef)((function(e,t){const o=bn(e,t);return(0,v.jsx)(nn,{...o,renderAs:"inline"})})),yn=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=bn(e,t);return(0,v.jsx)(nn,{...n,EmptyComponent:o?Ce.s3:void 0,renderAs:"inline"})})),mn=(0,n.forwardRef)((function(e,t){const o=bn(e,t);return(0,v.jsx)(nn,{...o,renderAs:"inline"})})),fn=(0,n.forwardRef)((function(e,t){const o=bn(e,t);return(0,v.jsx)(nn,{...o,renderAs:"inline"})})),hn=(0,n.forwardRef)((function(e,t){const o=bn(e,t);return(0,v.jsx)(nn,{...o,renderAs:"inline"})}));function Sn(){}const xn=(0,n.forwardRef)((function(e,t){const{store:o,collectionStore:r,property:l,blockPropertyValueOverlayStore:s,isInPeekRenderer:a}=bn(e,t),{isReadOnly:u}=(0,n.useContext)(f.O),d=(0,i.VK)((()=>o.isNonEditableState()),[o]),p=(0,n.useMemo)((()=>new Go.p),[]),y=(0,i.VK)((()=>o.getSchema()),[o]),m=(0,i.VK)((()=>r.getFormat()),[r]),h=(0,i.VK)((()=>y[l]),[l,y]),S=(0,c.yK)((e=>({propertyName:{color:e.mediumTextColor,fontSize:zo.Z.fontSize.UISmall.desktop,fontWeight:zo.Z.fontWeight.medium,padding:6}})),[]);if(!h)return null;const x=(0,v.jsx)(en.Z,{propertySchema:h,showIcon:!1,style:S.propertyName,property:l,badge:(0,v.jsx)(en.o,{propertySchema:h})});return(0,v.jsx)(tn.Z,{store:o,collectionStore:r,disabled:u,locked:d,property:l,schema:y,handleMouseMove:Sn,handleMouseLeave:Sn,handleContextMenu:Sn,blockPropertyValueOverlayStore:s,format:m,visibility:"section_show",isInPeekRenderer:Boolean(a),topBorder:!1,showIcon:!1,propertyRowName:x,pagePropertiesStore:p})})),vn=(0,n.forwardRef)((function(e,t){const o=bn(e,t);return(0,v.jsx)(nn,{...o,EmptyComponent:Ce.zX,renderAs:"inline"})}));function bn(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,blockPropertyValueOverlayStore:s,format:a,isInPeekRenderer:u}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,ie.Am)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,blockPropertyValueOverlayStore:s,format:a,isInPeekRenderer:u}}var gn=o(435011),Cn=o(334299),kn=o(407057),wn=o(335102),Pn=o(484682),jn=o(882883),_n=o(989470),Rn=o(653965),Mn=o(816187),Bn=o(573807),Vn=o(725651),Tn=o(743664),On=o(128651);const An=(0,A.defineMessages)({rollup:{defaultMessage:"Configure rollup",id:"database.editButton.configureRollupTooltip"}});function In(e){const{type:t,editButtonClickProps:o}=e,r=(0,u.O7)(),{isMobile:l}=(0,u.Fy)(),{containerRef:s,collectionContextStore:a,isReadOnly:c}=(0,n.useContext)(f.O),d=(0,i.qz)(void 0,On.Z),p=(0,n.useMemo)((()=>F.default.formatMessage(An[t])),[t]),y=(0,n.useCallback)((async e=>{if(void 0===o)return;const{onClick:t,store:n,property:i,format:l,collectionStore:u,blockPropertyValueOverlayStore:c,disableHorizontalEdgeScroll:p}=o;await Tn.z({element:s&&"current"in s&&(null==s?void 0:s.current)||void 0,environment:r,onClick:t,store:n,property:u.getMappedProperty(i),format:l,collectionStore:u,blockPropertyValueOverlayStore:c,disableHorizontalEdgeScroll:p,collectionContextStore:a,mouseStore:d})}),[a,s,o,r,d]);return c||l?null:(0,v.jsx)(Dt,{icon:Vn.R,tooltip:p,onClick:y})}var En=o(219629);const Kn=n.memo(n.forwardRef((function(e,t){const{store:o,property:r,EmptyComponent:l,collectionStore:s,onContextMenu:a,editButtonClickProps:d,checkboxButtonStyle:y,textButtonStyle:h,buttonButtonStyle:b,quickActionButtons:g,numberRightAlign:C}=e,{baseStyles:k,collectionContextStore:w}=(0,n.useContext)(f.O),P=(0,i.VK)((()=>{var e;return null==w||null===(e=w.collectionStore())||void 0===e?void 0:e.getSchema()}),[w]),j=(0,i.VK)((()=>o.getModel()),[o]),_=(0,Bn._)(),R=(0,i.VK)((()=>{if(void 0!==P)return(0,Cn.gT)({property:r,schema:P,getRecordModel:s.getRecordModel})}),[P,r,s.getRecordModel]),{propertySchema:M,targetPropertySchema:B}=R||{},V=function(e){var t;const{block:o,schema:n,property:r,store:l,propertySchema:s,targetPropertySchema:a,numberRightAlign:u,clientFormulaTimeoutMs:c}=e,{rollupAggregationValue:d,numberFormat:p}=(0,i.VK)((()=>{if(!(null!=s&&s.aggregation&&"show_unique"!==s.aggregation&&o&&null!=a&&a.type&&n))return{rollupAggregationValue:void 0,numberFormat:void 0};const e=(0,Cn.O0)({block:o,property:r,schema:n,getRecordModel:l.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,Ke.r)(),depth:0,intl:F.default.getIntl(),visitedProperties:new Set,resultCache:new Map,formulaTimeoutTimestampMs:Date.now()+c}});if(!e)return{rollupAggregationValue:void 0,numberFormat:void 0};const t=(0,Mn.SD)(s.aggregation,"formula"===(null==a?void 0:a.type)||"number"===(null==a?void 0:a.type)?a.number_format:void 0);if(t){const o=void 0===(null==e?void 0:e.value)||"number"!=typeof e.value?void 0:Rn.NM(e.value,3);if(void 0!==o&&!isNaN(o))return{rollupAggregationValue:o,numberFormat:t}}const i=(0,Mn.Ol)({numberFormat:void 0,dateFormat:a&&"date_format"in a?a.date_format:void 0,aggregationType:s.aggregation,value:e,userTimeZone:(0,Ke.r)(),roundDecimal:3});return void 0===i||""===i?{rollupAggregationValue:void 0,numberFormat:void 0}:{rollupAggregationValue:i,numberFormat:void 0}}),[o,r,s,n,l.getRecordModel,a,c]);return(0,i.VK)((()=>{if(void 0===d)return null;if(p){var e,t;return"bar"===(null==s||null===(e=s.show_as)||void 0===e?void 0:e.type)||"ring"===(null==s||null===(t=s.show_as)||void 0===t?void 0:t.type)?(0,v.jsx)(ot.K,{isRightAligned:u,children:(0,v.jsx)(ao.A,{numberFormat:p,numberValue:d,isRightAligned:u})}):(0,v.jsx)(x.Y,{isRightAligned:u,children:(0,v.jsx)(ao.A,{numberFormat:p,numberValue:d,isRightAligned:u})})}return(0,v.jsx)(x.Y,{children:d})}),[u,p,null==s||null===(t=s.show_as)||void 0===t?void 0:t.type,d])}({store:o,block:j,schema:P,property:r,propertySchema:M,targetPropertySchema:B,numberRightAlign:C,clientFormulaTimeoutMs:_}),T=function(e){const{block:t,store:o,rollupPropertyData:r,numberRightAlign:l,clientFormulaTimeoutMs:s}=e,{propertySchema:a,relationPropertySchema:c,targetPropertySchema:d,targetProperty:y,targetCollectionModel:m}=r||{},{collectionContextStore:h}=(0,n.useContext)(f.O),S=(0,i.VK)((()=>{if(void 0!==(null==a?void 0:a.aggregation)&&"show_unique"!==(null==a?void 0:a.aggregation)||!a||!c||!d||!m||!t||void 0===(null==a?void 0:a.relation_property))return[];return p.j$({relationValue:p.rq(p.wS(t,a.relation_property)),getRecordModel:o.getRecordModel,propertySchema:c}).map((e=>Z.G.createChildStore(o,e))).filter((e=>{var t;return(null===(t=e.getAssociatedCollectionStore())||void 0===t?void 0:t.id)===m.id}))}),[a,c,d,m,t,o]),x=(0,u.O7)(),b=(0,i.VK)((()=>{if(void 0===c||void 0===d||void 0===y||void 0===a)return[];const e=null==h?void 0:h.collectionViewBlockStore(),t=c.collection_pointer;if(void 0===t||void 0===e)return[];const o=Z.NW.createChildStore(e,t),n=[],r=new Map;for(const i of S){const e=i.getPropertyValue(y);if(void 0===e&&!["status","person","checkbox","formula","last_edited_time","last_edited_by","created_time","created_by","title"].includes(d.type))continue;const t=Zn({textValue:e,blockStore:i,targetCollectionStore:o,targetPropertySchema:d,targetProperty:y,currentUserId:x.currentUser.id,clientFormulaTimeoutMs:s,resultCache:r}).map((e=>[e,i]));n.push(...t)}return"show_unique"===a.aggregation?Rn.mN(n,(e=>{let[t,o]=e;return t.id})):n}),[S,h,c,a,y,d,x.currentUser.id,s]);return(0,i.VK)((()=>{if(null==b||!b.length||!a)return null;const e=b[0][0].type,t=(0,En.vQ)(e,a);return(0,v.jsx)(En.E1,{propertyType:e,rootPropertySchema:a,numberRightAlign:l,children:b.map(((e,o)=>{let[n,r]=e;return(0,v.jsx)(En.gZ,{token:n,targetPropertySchema:d,blockStore:r,withComma:t&&o<b.length-1,numberRightAlign:l},`${n.id}-${o}`)}))})}),[l,a,b,d])}({block:j,store:o,rollupPropertyData:R,numberRightAlign:C,clientFormulaTimeoutMs:_}),O=!V&&!T,A=(0,i.VK)((()=>O||void 0===R?"text":void 0!==(null==M?void 0:M.aggregation)&&"show_unique"!==M.aggregation?void 0!==(0,Mn.SD)(M.aggregation,"number")?"number":"text":null!=R&&R.targetPropertySchema?function(e){if("formula"===e.type){if(e.formula2){const t=(0,wn.aL)(e.formula2.result_type).type;return"block"===t?"relation":"unknown"===t||"array"===t?"text":t}return"text"}return"rollup"===e.type?"text":e.type}(R.targetPropertySchema):"text"),[O,null==M?void 0:M.aggregation,R]),I=(0,c.yK)((e=>({buttonStyle:{...k.buttonStyle,..."checkbox"===A?y:{},..."title"!==A&&(0,S.A2)(A)?h:{},...(0,S.e4)(A)?b:{}},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{}})),[k.buttonHoveredStyle,k.buttonPressedStyle,k.buttonStyle,b,y,A,h]);if(O&&void 0===l)return null;const E=!0===C&&"number"===A;return(0,v.jsx)(m.Z,{ref:t,onContextMenu:a,editButtonClickProps:d,style:I.buttonStyle,pressedStyle:I.buttonPressedStyle,hoveredStyle:I.buttonHoveredStyle,quickActionButtons:g?(0,v.jsx)(Fn,{buttons:g,editButtonClickProps:d}):void 0,quickActionButtonsAlign:E?"left":void 0,children:O?l?(0,v.jsx)(l,{}):null:V??T})})));function Fn(e){let{buttons:t,editButtonClickProps:o}=e;const n=t.map((e=>{if("edit"===e)return(0,v.jsx)(In,{type:"rollup",editButtonClickProps:o},e);(0,Po.t1)(e)})).filter(Po.K0);return n?(0,v.jsx)(v.Fragment,{children:n}):null}function Zn(e){var t;const{textValue:o,blockStore:n,targetCollectionStore:r,targetPropertySchema:i,targetProperty:l,clientFormulaTimeoutMs:s,resultCache:a}=e,{type:u}=i;switch(u){case"auto_increment_id":if(void 0===o)return[];const y=null===(t=r.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey(),m=(0,d.wf)(y,p.ah(o));return m?[{id:m,type:"text",value:[[m]]}]:[];case"button":case"rollup":case"location":case"verification":return[];case"checkbox":{const e=p.Ml(o);return[{id:e,type:"checkbox",value:e}]}case"date":{const e=p.Gl(o);if(void 0===e)return[];return[{id:kn.ZV({allowRelativeDates:!1,value:e,userTimeZone:(0,Ke.r)(),intl:F.default.getIntl()}),type:"date",value:e}]}case"email":case"phone_number":case"url":return void 0===o?[]:[{id:(0,wo.Jcv)(o),type:u,value:o}];case"file":return p.g(o).map((e=>({id:e.url,type:"file",value:e})));case"formula":{const e=n.getModel();if(void 0===e)return[];const t=F.default.getIntl(),o=(0,Ke.r)();if("v2"===i.version){var c;if(null===(c=i.formula2)||void 0===c||!c.code)return[];const r=(0,gn.EC)({block:e,property:l,formulaCode:i.formula2.code,getRecordModel:n.getRecordModel,intl:t,userTimeZone:o,depth:0,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+s,resultCache:a});return r?(0,ht.$I)(r,n.getRecordModel,o):[]}{const r=(0,Pn.AH)({property:l,schema:n.getSchema(),block:e,getRecordModel:n.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:o,depth:0,intl:t,resultCache:a,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+s}});return(0,ht.tT)(r)}}case"select":{const e=p.Sj(o,i.options??[]);if(!i.options||!e)return[];return[{id:e,type:"select",value:e,color:(0,p.wI)(i.options??[],e)}]}case"multi_select":return p.uP(o,i.options??[]).map((e=>({id:e,type:"select",value:e,color:(0,p.wI)(i.options??[],e)})));case"number":{const e=p.VY(o);return void 0===e?[]:[{id:e,type:"number",value:e}]}case"person":return p.DW({textValue:o,propertySchema:i,blockCreatorPointer:n.getCreatedByPointer()}).map((e=>({id:e.id,type:"person",value:e})));case"title":if(void 0===r)return[];return[{id:(0,jn.X)({textValue:o,getRecordModel:n.getRecordModel,deterministic:!0,userTimeZone:(0,Ke.r)(),intl:F.default.getIntl()}),type:"relation",value:{id:n.id,table:"block",spaceId:r.getSpaceId()}}];case"relation":if(void 0===r)return[];return p.j$({relationValue:p.rq(o),getRecordModel:n.getRecordModel,propertySchema:i}).map((e=>({id:e.id,type:"relation",value:e})));case"status":{const e=p.ZG(o,i),{options:t,groups:n}=i,r=null==t?void 0:t.find((t=>t.value===e));if(void 0===e||void 0===r)return[];const l=null==n?void 0:n.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(r.id)}));return[{id:e,type:"select",value:e,color:r.color,groupColor:(null==l?void 0:l.color)??"default"}]}case"text":if(void 0===o)return[];const f=(0,jn.X)({textValue:o,getRecordModel:n.getRecordModel,deterministic:!0,userTimeZone:(0,Ke.r)(),intl:F.default.getIntl()});return 0===f.length?[]:[{id:f,type:"text",value:o}];case"created_by":const h=n.getCreatedByPointer();return h?[{id:h.id,type:"person",value:h}]:[];case"created_time":{const e=n.getCreatedTime();return[{id:e,type:"date",value:(0,Ee.CQ)(e,(0,Ke.r)())}]}case"last_edited_by":{const e=n.getLastEditedByPointer();return e?[{id:e.id,type:"person",value:e}]:[]}case"last_edited_time":{const e=n.getLastEditedTime();return[{id:e,type:"date",value:(0,Ee.CQ)(e,(0,Ke.r)())}]}case"last_visited_time":{const{currentUserId:t}=e;if(!t)return[];const o=(0,_n.Pv)({parent_id:n.id,user_id:t}),r=Z.H8.createChildStore(n,{table:_n.UI,id:o,spaceId:n.getSpaceId()}).getModel(),i=null==r?void 0:r.getVisitedAt();if(!i)return[];return[{id:i,type:"date",value:(0,Ee.CQ)(i,(0,Ke.r)())}]}default:(0,Po.t1)(u)}}const Hn=["edit"],Ln=n.forwardRef((function(e,t){const o=Jn(e,t,(0,c.yK)((()=>({checkboxButtonStyle:{padding:S.sf[h.C.Table].checkbox},textButtonStyle:{padding:S.sf[h.C.Table].text},buttonButtonStyle:{padding:S.sf[h.C.Table].button}})),[]));return(0,v.jsx)(Kn,{...o,numberRightAlign:!0,EmptyComponent:Ce.q8,quickActionButtons:Hn})})),Nn=["edit"],Dn=n.forwardRef((function(e,t){const o=Jn(e,t,(0,c.yK)((()=>({checkboxButtonStyle:{padding:S.sf[h.C.Page].checkbox},textButtonStyle:{padding:S.sf[h.C.Page].text},buttonButtonStyle:{padding:S.sf[h.C.Page].button}})),[]));return(0,v.jsx)(Kn,{...o,quickActionButtons:Nn,EmptyComponent:Ce.T$})})),Un=n.forwardRef((function(e,t){const o=Jn(e,t,(0,c.yK)((()=>({checkboxButtonStyle:{padding:S.sf[h.C.CompactPage].checkbox},textButtonStyle:{padding:S.sf[h.C.CompactPage].text},buttonButtonStyle:{padding:S.sf[h.C.CompactPage].button}})),[]));return(0,v.jsx)(Kn,{...o,EmptyComponent:Ce.T$})})),Wn=n.forwardRef((function(e,t){const o=Jn(e,t);return(0,v.jsx)(Kn,{...o})})),zn=n.forwardRef((function(e,t){const o=Jn(e,t,(0,c.yK)((()=>({checkboxButtonStyle:{padding:S.sf[h.C.Board].checkbox},textButtonStyle:{padding:S.sf[h.C.Board].text},buttonButtonStyle:{padding:S.sf[h.C.Board].button}})),[]));return(0,v.jsx)(Kn,{...o})})),qn=n.forwardRef((function(e,t){const o=Jn(e,t);return(0,v.jsx)(Kn,{...o})})),$n=n.forwardRef((function(e,t){const o=Jn(e,t);return(0,v.jsx)(Kn,{...o})})),Qn=n.forwardRef((function(e,t){const o=Jn(e,t);return(0,v.jsx)(Kn,{...o})})),Gn=n.forwardRef((function(e,t){const o=Jn(e,t);return(0,v.jsx)(Kn,{...o})})),Yn=n.forwardRef((function(e,t){const o=Jn(e,t);return(0,v.jsx)(Kn,{...o})}));function Jn(e,t,o){const{store:n,onContextMenu:r,property:i,collectionStore:l}=e;return{ref:t,store:n,property:i,collectionStore:l,editButtonClickProps:(0,ie.Am)(e),onContextMenu:r,checkboxButtonStyle:null==o?void 0:o.checkboxButtonStyle,textButtonStyle:null==o?void 0:o.textButtonStyle,buttonButtonStyle:null==o?void 0:o.buttonButtonStyle}}const Xn=(0,n.forwardRef)((function(e,t){return(0,v.jsx)(Gt,{...e,ref:t})})),er=(0,n.forwardRef)((function(e,t){return(0,v.jsx)(Yt,{...e,ref:t})})),tr=(0,n.forwardRef)((function(e,t){return(0,v.jsx)(Jt,{...e,ref:t})})),or=(0,n.forwardRef)((function(e,t){return(0,v.jsx)(Xt,{...e,ref:t})})),nr=(0,n.forwardRef)((function(e,t){return(0,v.jsx)(eo,{...e,ref:t})})),rr=(0,n.forwardRef)((function(e,t){return(0,v.jsx)(to,{...e,ref:t})})),ir=(0,n.forwardRef)((function(e,t){return(0,v.jsx)(oo,{...e,ref:t})})),lr=(0,n.forwardRef)((function(e,t){return(0,v.jsx)(no,{...e,ref:t})})),sr=(0,n.forwardRef)((function(e,t){return(0,v.jsx)(ro,{...e,ref:t})})),ar=(0,n.forwardRef)((function(e,t){return(0,v.jsx)(io,{...e,ref:t})})),ur=(0,n.forwardRef)((function(e,t){return(0,v.jsx)(lo,{...e,ref:t})})),cr=n.memo(n.forwardRef((function(e,t){const{store:o,onContextMenu:r,property:l,disabled:s,enablePointerEventsForInteractiveTypes:a,editButtonClickProps:u,selectButtonStyle:d,checkboxButtonStyle:y,checkboxShowLabel:h,EmptyComponent:S}=e,{baseStyles:x,propertyFormat:b,propertySchema:g,shouldRenderTooltip:C,isEmpty:k}=(0,n.useContext)(f.O),w=g,P=(null==x?void 0:x.tokenFormat)??Bt.lo.Medium,j=(0,i.VK)((()=>o.getPropertyValue(l)),[l,o]),_=(0,n.useMemo)((()=>w?p.ZG(j,w)??"":""),[j,w]),R=(null==b?void 0:b.statusShowAs)??"select",M=(0,c.yK)((()=>({buttonStyle:{...x.buttonStyle,..."select"===R?d:y},buttonPressedStyle:x.buttonPressedStyle??{},buttonHoveredStyle:x.buttonHoveredStyle??{}})),[x.buttonHoveredStyle,x.buttonPressedStyle,x.buttonStyle,d,y,R]);return k&&void 0===S?null:(0,v.jsx)(m.Z,{ref:t,onContextMenu:r,editButtonClickProps:u,style:M.buttonStyle,pressedStyle:M.buttonPressedStyle,hoveredStyle:M.buttonHoveredStyle,tooltipPropertyValue:C&&"checkbox"===R?_:void 0,children:"checkbox"===R?(0,v.jsx)(pr,{enablePointerEventsForInteractiveTypes:a,showLabel:h,propertyName:null==w?void 0:w.name,propertyValue:j,statusValue:_,editButtonClickProps:u,containerRef:t,store:o,property:l,disabled:s}):k&&void 0!==S?(0,v.jsx)(S,{}):(0,v.jsx)(dr,{statusValue:_,tokenFormat:P})})})));function dr(e){const{statusValue:t}=e,{propertySchema:o}=(0,n.useContext)(f.O),r=o,{foundOption:i,foundGroup:l}=(0,n.useMemo)((()=>{const e=(null==r?void 0:r.options)??[],o=e.find((e=>e.value===t)),n=(null==r?void 0:r.groups)??[],i=o&&n.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(o.id)}));return{options:e,foundOption:o,foundGroup:i}}),[r,t]);return i?(0,v.jsx)(ot.K,{children:(0,v.jsx)(qt.J,{type:"status",value:i.value,color:i.color,groupColor:null==l?void 0:l.color})}):null}function pr(e){const{propertyName:t,propertyValue:o,statusValue:r,showLabel:i,enablePointerEventsForInteractiveTypes:l,editButtonClickProps:s,containerRef:a,store:c,property:d,disabled:y}=e,{propertySchema:m,shouldRenderTooltip:h}=(0,n.useContext)(f.O),S=m,x=ae(c,d,y),b=(0,u.O7)(),g=(0,n.useMemo)((()=>!!S&&p.rO(o,S,F.default.getIntl())),[o,S]),C=(0,n.useCallback)((async e=>{const t=e.altKey;await Tn.z({...s,element:a&&"current"in a?(null==a?void 0:a.current)??void 0:void 0,environment:b,statusSetCheckbox:!t})}),[a,s,b]);return(0,v.jsx)(le.n,{onClick:C,propertyLabel:i?t:void 0,checked:g,enablePointerEventsForInteractiveTypes:l,tooltip:h?void 0:r,disabled:x})}const yr=(0,n.forwardRef)((function(e,t){const o=wr(e,t,(0,c.yK)((()=>({checkboxButtonStyle:{padding:S.sf[h.C.Table].checkbox}})),[]));return(0,v.jsx)(cr,{...o,checkboxShowLabel:!1,EmptyComponent:Ce.q8})})),mr=(0,n.forwardRef)((function(e,t){const{store:o,property:n,collectionStore:r}=e,i=wr(e,t,(0,c.yK)((()=>({checkboxButtonStyle:{padding:S.sf[h.C.Page].checkbox}})),[]));return(0,v.jsx)(_o.O,{store:o,property:n,collectionStore:r,children:(0,v.jsx)(cr,{...i,checkboxShowLabel:!1,EmptyComponent:Ce.T$})})})),fr=(0,n.forwardRef)((function(e,t){const o=wr(e,t,(0,c.yK)((()=>({checkboxButtonStyle:{padding:S.sf[h.C.CompactPage].checkbox}})),[]));return(0,v.jsx)(cr,{...o,checkboxShowLabel:!1,EmptyComponent:Ce.T$})})),hr=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=wr(e,t,(0,c.yK)((()=>({checkboxButtonStyle:{minWidth:"fit-content"}})),[]));return(0,v.jsx)(cr,{...n,checkboxShowLabel:!1,EmptyComponent:o?Ce.s3:void 0})})),Sr=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=wr(e,t,(0,c.yK)((()=>({checkboxButtonStyle:{padding:S.sf[h.C.Board].checkbox}})),[]));return(0,v.jsx)(cr,{...n,checkboxShowLabel:!0,EmptyComponent:o?Ce.s3:void 0})})),xr=(0,n.forwardRef)((function(e,t){const o=wr(e,t);return(0,v.jsx)(cr,{...o,checkboxShowLabel:!0})})),vr=(0,n.forwardRef)((function(e,t){const o=wr(e,t);return(0,v.jsx)(cr,{...o,checkboxShowLabel:!0})})),br=(0,n.forwardRef)((function(e,t){const o=wr(e,t);return(0,v.jsx)(cr,{...o,checkboxShowLabel:!1})})),gr=(0,n.forwardRef)((function(e,t){const o=wr(e,t);return(0,v.jsx)(cr,{...o,checkboxShowLabel:!1})})),Cr=(0,n.forwardRef)((function(e,t){const o=wr(e,t);return(0,v.jsx)(cr,{...o,checkboxShowLabel:!1})})),kr=(0,n.forwardRef)((function(e,t){const o=wr(e,t);return(0,v.jsx)(cr,{...o,checkboxShowLabel:!1,EmptyComponent:Ce.zX})}));function wr(e,t,o){const{store:r,disabled:i,property:l,onContextMenu:s,enablePointerEventsForInteractiveTypes:a}=e,{propertyFormat:u}=(0,n.useContext)(f.O),c="checkbox"===(null==u?void 0:u.statusShowAs),d=(0,ie.Am)(e,{isStatusCheckbox:c});return{ref:t,store:r,disabled:i,property:l,selectButtonStyle:null==o?void 0:o.selectButtonStyle,checkboxButtonStyle:null==o?void 0:o.checkboxButtonStyle,editButtonClickProps:d,onContextMenu:s,enablePointerEventsForInteractiveTypes:a}}var Pr=o(137231),jr=o(374194),_r=o(618746);const Rr=n.memo((0,n.forwardRef)(((e,t)=>{const{store:o,buttonStyle:r,onContextMenu:l,editButtonClickProps:s,quickActionButtons:a=[],EmptyComponent:u,property:d}=e,{isEmpty:p,baseStyles:y}=(0,n.useContext)(f.O),h=(0,i.VK)((()=>o.getPropertyValue(d)),[d,o]),S=(0,c.yK)((()=>({buttonStyle:{...y.buttonStyle,...r},buttonPressedStyle:y.buttonPressedStyle??{},buttonHoveredStyle:y.buttonHoveredStyle??{}})),[y.buttonHoveredStyle,y.buttonPressedStyle,y.buttonStyle,r]);return p&&void 0===u?null:(0,v.jsx)(m.Z,{ref:t,style:S.buttonStyle,hoveredStyle:S.buttonHoveredStyle,pressedStyle:S.buttonPressedStyle,onContextMenu:l,editButtonClickProps:s,quickActionButtons:a,children:p&&void 0!==u?(0,v.jsx)(u,{}):(0,v.jsx)(x.Y,{children:(0,v.jsx)(_r.A,{textValue:h,parentStore:o})})})}))),Mr=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:l,collectionStore:s}=e,a=(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Page].text}})),[]),u=(0,i.VK)((()=>s.getSchema()),[s]),d=(0,n.useMemo)((()=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(Ut,{store:o,property:r,openOverlay:!0},"autofill"),(0,v.jsx)(y.Z,{store:o,schema:u,property:r,format:l},"copy")]})),[l,r,u,o]),p=Nr(e,t,a);return(0,v.jsx)(Rr,{...p,EmptyComponent:Ce.T$,quickActionButtons:d})})),Br=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:l,collectionStore:s}=e,{isMobile:a}=(0,u.Fy)(),d=(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Table].text}})),[]),p=(0,i.VK)((()=>s.getSchema()),[s]),m=(0,n.useMemo)((()=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(Ut,{store:o,property:r,openOverlay:!0},"autofill"),a?void 0:(0,v.jsx)(y.Z,{store:o,schema:p,property:r,format:l},"copy")]})),[l,a,r,p,o]),f=Nr(e,t,d);return(0,v.jsx)(Rr,{...f,EmptyComponent:Ce.q8,quickActionButtons:m})})),Vr=(0,n.forwardRef)((function(e,t){const o=Nr(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.CompactPage].text,maxWidth:"300px"}})),[]));return(0,v.jsx)(Rr,{...o,EmptyComponent:Ce.T$})})),Tr=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Nr(e,t);return(0,v.jsx)(Rr,{...n,EmptyComponent:o?Ce.s3:void 0})})),Or=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Nr(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Board].text}})),[]));return(0,v.jsx)(Rr,{...n,EmptyComponent:o?Ce.s3:void 0})})),Ar=(0,n.forwardRef)((function(e,t){const o=Nr(e,t);return(0,v.jsx)(Rr,{...o})})),Ir=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Nr(e,t);return(0,v.jsx)(Rr,{...n,EmptyComponent:o?Ce.s3:void 0})})),Er=(0,n.forwardRef)((function(e,t){const o=Nr(e,t);return(0,v.jsx)(Rr,{...o})})),Kr=(0,n.forwardRef)((function(e,t){const o=Nr(e,t);return(0,v.jsx)(Rr,{...o})})),Fr=(0,n.forwardRef)((function(e,t){const o=Nr(e,t);return(0,v.jsx)(Rr,{...o})})),Zr=(0,n.forwardRef)((function(e,t){const o=Nr(e,t);return(0,v.jsx)(Rr,{...o,EmptyComponent:Ce.zX})})),Hr=(0,n.forwardRef)((function(e,t){const o=(0,A.useIntl)(),n=(0,u.O7)(),r=Nr(e,t);return(0,v.jsx)("div",{style:{margin:-16,padding:16,cursor:"default"},children:(0,v.jsx)(jr.Z,{placeholder:o.formatMessage({id:"questionTitle.answer.placeholder",defaultMessage:"Type your answer here"}),style:r.disabled?{marginTop:8,background:"none",padding:"9px 10px",fontSize:16,borderRadius:6,cursor:"default"}:{padding:"4px 10px",fontSize:16,lineHeight:1.75,maxWidth:400,borderRadius:6,background:"none",marginTop:12},disabled:r.disabled,onChange:e=>{ne.createAndCommit({userAction:"FormTextProperty.handleTextQuestionEdit",environment:n,perform:t=>{Pr.sO({environment:n,store:r.store.getNormalizedPropertyStore(r.property),value:(0,wo.TPx)(e.target.value),transaction:t})}})}})})})),Lr=(0,n.forwardRef)((function(e,t){throw new Error("Unsupported form property type")}));function Nr(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:s}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,editButtonClickProps:(0,ie.Am)(e),onContextMenu:s,buttonStyle:null==o?void 0:o.buttonStyle}}var Dr=o(568626),Ur=o(654497),Wr=o(23867),zr=o(218265),qr=o(709953),$r=o(524677),Qr=o(898104),Gr=o(710274),Yr=o(360682),Jr=o(214976),Xr=o(623879),ei=o(277181),ti=o(341232),oi=o(861931),ni=o(519511),ri=o(469316),ii=o(620362),li=o(731278),si=o(776798),ai=o(965187),ui=o(244831),ci=o(241137),di=o(436610),pi=o(368585);function yi(e){const{store:t}=e,o=(0,u.O7)(),r=(0,l.DK)(),i=(0,n.useCallback)((()=>{const e=t.getBlockTitleStore();Gr.Z5({store:t}),$r.eP({environment:o,store:t}),Qr.NX({store:e}),di.sd(o,"list_item_edit_mode_enter",{...(0,pi.Pn)(r),block_id:t.id,from:"click",view_type:"list"})}),[t,o,r]),s=(0,c.yK)((e=>({buttonStyle:{color:e.mediumTextColor,fill:e.mediumTextColor,height:24,width:30},iconStyle:{color:e.mediumTextColor,fill:e.mediumTextColor}})),[]);return(0,v.jsx)(Tt.Z,{renderTooltip:()=>(0,v.jsx)(A.FormattedMessage,{defaultMessage:"Edit",id:"collectionViewItem.edit.tooltip"}),render:e=>(0,v.jsx)(Nt.Z,{icon:Vn.R,ariaLabel:"edit",onClick:i,hasBackground:!0,showShadow:!0,style:s.buttonStyle,iconStyle:s.iconStyle,...e})})}var mi=o(815145),fi=o(680310),hi=o(307032),Si=o(608055),xi=o(110906),vi=o(484210),bi=o(212534),gi=o(80444),Ci=o(188923);const ki=(0,A.defineMessages)({openAsPageTitle:{defaultMessage:"Open",id:"database.actionButton.openAsPageTitle"}});function wi(e){const{store:t,handleOpenPeekPage:o,showLabel:r,showIcon:s}=e,a=(0,u.O7)(),d=(0,l.DK)(),{peekModeProps:p}=(0,i.VK)((()=>{const e=void 0!==d?xi.kr(d):"full_page";return{peekModeProps:(0,re.X9)(e,!1)}}),[d],{useDeepEqual:!0}),y=(0,i.VK)((()=>(0,vi.ZP)({store:t,fullyQualified:!1,pageVisitSource:mi.tY.LinkInPage})),[t]),m=(0,i.VK)((()=>(null==d?void 0:d.isInlineViewStore.state)&&(null==d?void 0:d.isUnlistedViewStore.state)),[d]),f=(0,n.useCallback)((()=>{const e=null==d?void 0:d.collectionViewStore();if(m){const o="/chat",n={[fi.UJ]:hi.cj(t.id),pm:(0,Ci.getUrlParamFromPeekMode)("center_peek"),v:e?hi.cj(e.id):void 0};return zr.bf({url:o,query:n})}const{mainEditorCurrentBlockStore:o}=gi.default.state;return xi.mb({store:t,mainEditorCurrentBlockStore:o,collectionContextStore:d,fullyQualified:!1})}),[d,m,t]),h=(0,n.useCallback)((e=>{if(e.metaKey||e.ctrlKey)Si.c4({environment:a,url:y,openInNew:"tab"});else{const e=f();e&&(o&&o(),Si.c4({environment:a,url:e}))}}),[a,f,y,o]),S=(0,n.useCallback)((e=>{1===e.button&&Si.c4({environment:a,url:y,openInNew:"tab"})}),[a,y]),x=(0,n.useCallback)((e=>{(0,bi.ZP)({event:e,context:bi.Af.EditorMouseDown,callback:()=>{e.preventDefault()}})}),[]),b=(0,c.yK)((e=>({buttonStyle:{color:e.mediumTextColor,fill:e.mediumTextColor,...!r&&{width:30,height:24},background:e.whiteButtonBackground,boxShadow:e.lightBoxShadow,border:void 0,fontSize:12,fontWeight:zo.Z.fontWeight.medium,textTransform:"uppercase",letterSpacing:.5},buttonHoveredStyle:{background:e.whiteButtonHoveredBackground},buttonPressedStyle:{background:e.whiteButtonPressedBackground},iconStyle:{color:e.mediumTextColor,fill:e.mediumTextColor}})),[r]);return(0,v.jsx)(Tt.Z,{renderTooltip:()=>p.tooltip,render:e=>(0,v.jsx)("div",{onAuxClick:S,onMouseDown:x,children:(0,v.jsx)(L.Z,{onClick:h,icon:s?p.icon:void 0,ariaLabel:p.tooltip,isSmall:!0,style:b.buttonStyle,iconStyle:b.iconStyle,hoveredStyle:b.buttonHoveredStyle,pressedStyle:b.buttonPressedStyle,...e,children:r?F.default.formatMessage(ki.openAsPageTitle):void 0})})})}var Pi=o(76485);const ji=n.memo((0,n.forwardRef)((function(e,t){const{store:o,collectionStore:r,buttonStyle:l,textStyle:s,recordIconStyle:a,format:d,editButtonClickProps:p,onContextMenu:y,quickActionButtons:h,quickActionButtonsStyle:S,onTab:x,onUntab:b,forceMouseEntered:g,iconActionFrom:C,iconSize:k,showIcon:w,titlePropertyType:P,property:j,linkifyText:_,width:R,commentsIndicatorStyle:M}=e,B=(0,u.O7)(),V=(0,c.Fg)(),{baseStyles:T,collectionContextStore:O,isReadOnly:A,propertySchema:I}=(0,n.useContext)(f.O),E=(0,i.VK)((()=>(0,Xr.JI)(o)),[o],{useDeepEqual:!0}),{collectionViewBlockId:K,collectionViewId:Z}=(0,i.VK)((()=>{var e,t;return{collectionViewId:null==O||null===(e=O.collectionViewStore())||void 0===e?void 0:e.id,collectionViewBlockId:null==O||null===(t=O.collectionViewBlockStore())||void 0===t?void 0:t.id}}),[O]),H=(0,i.VK)((()=>{if("inlineEditable"!==P)return;const e=ni.Z.state;return Boolean(e.isActive&&e.store.id===o.id)}),[o.id,P]),{icon:L,iconStore:N,isEmptyPage:D,recordTable:U,blockType:W,hasError:z}=(0,i.VK)((()=>{var e;return{icon:o.getIcon(),iconStore:o.getIconStore(),isEmptyPage:o.isEmptyPage(),recordTable:null===(e=o.getIconStore())||void 0===e?void 0:e.table,blockType:o.getType(),hasError:o.hasError()}}),[o],{useDeepEqual:!0}),q=(0,Ot.us)(j),$=(0,i.VK)((()=>{if(!q)return _?re.Hw({store:o,propertySchema:I,property:j}):void 0;const e=o.getFormatStore().getKeyStore("uri").getValue(),t=e&&zr.Nm({str:e,allowNoProtocol:!1});return t&&(0,ti.pI)(t,o.pointer.spaceId)}),[q,o,_,I,j]),Q=(0,c.yK)((()=>({textStyle:{...T.textStyle,display:"inline",fontWeight:zo.Z.fontWeight.medium,...s,marginRight:B.device.isMobile?3:5},buttonStyle:{...T.buttonStyle,...l},quickActionButtonsStyle:{...S},buttonPressedStyle:{...T.buttonPressedStyle,background:"none"},buttonHoveredStyle:{...T.buttonHoveredStyle,background:"none"},recordIconStyle:{display:"inline-flex",verticalAlign:"text-top",...a},link:{display:"inline"},subitemCountIndicator:{display:"inline-flex",alignItems:"center",verticalAlign:"text-top"},parentItemIndicator:{display:"inline-flex",alignItems:"center",verticalAlign:"text-top"},discussionIndicator:{display:"inline-flex",alignItems:"center",color:V.lightTextColor,fontSize:12,fontWeight:zo.Z.fontWeight.medium,verticalAlign:"text-top"},errorIcon:{display:"inline-block",verticalAlign:"text-top",marginLeft:1,marginRight:7,paddingBottom:4,width:16,fill:V.accentColors.orange[500]}})),[T.buttonHoveredStyle,T.buttonPressedStyle,T.buttonStyle,T.textStyle,l,S,a,s,V,B.device.isMobile]),G=(0,n.useCallback)((()=>{O&&q&&te.YU({environment:B,collectionContextStore:O,block_id:o.id,property:j,from:re.Sy(d),is_external_title_property_id:!0})}),[O,B,d,j,o.id,q]),Y=(0,n.useCallback)((e=>{N&&ne.createAndCommit({userAction:"TitleProperty.handleRecordIconChange",environment:B,perform:t=>{qr.sO({store:N,value:e,transaction:t})}})}),[B,N]),J=(0,n.useCallback)((e=>{"Enter"!==(null==e?void 0:e.key)&&(O&&te.rv({environment:B,collectionContextStore:O,block_id:o.id,property:"title",property_type:"text",from:"list"}),Gr.IH({store:o}))}),[B,o,O]),X=(0,n.useCallback)((()=>{ni.Z.setState({isActive:!1}),Qr.ZH({debug:{userAction:"TitleProperty.unselectItem"},environment:B}),$r.Ys({environment:B,store:o})}),[o,B]),{isInPageFindOpen:ee,inPageFindQuery:oe}=(0,i.VK)((()=>({isInPageFindOpen:ri.Z.state.open,inPageFindQuery:ri.Z.state.findQuery})),[]),ie=(0,n.useMemo)((()=>({type:"page_property_value_match",collectionViewBlockId:K,collectionViewId:Z,propertyId:"title"})),[K,Z]),le=(0,i.VK)((()=>{var e;switch(P){case"inlineEditable":const t=H?F.default.formatMessage(Vi.typeAName):F.default.formatMessage(Vi.untitledBlock);return(0,v.jsx)(ai.Z,{onBlur:e=>{e.target.scrollLeft=0},store:E,disabled:!H,disableSlashCommands:!0,disableEmojiCommands:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableEmbedMenu:!0,disableShiftEnter:!0,onEnter:X,onEsc:X,onTab:x,onUntab:b,onChange:J,placeholder:t,style:Q.textStyle,disableSelectAllBlocks:!0,pasteBehavior:"inline",inPageFind:ie});case"hidePlaceholderText":let n=null===(e=o.getTitleStore())||void 0===e?void 0:e.getValue();o.isType("external_object_instance_page")&&(n=o.getPropertyValue(j)),ee&&n&&(n=Jr.cD({textValue:n,blockId:o.id,textProps:ie,find:oe}));const r=Jr.IY({environment:B,textValue:n&&{value:n,spaceId:(0,Wr.C)(o.pointer.spaceId)},parentStore:o,disableHover:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!0,disabled:!0,theme:V,emojiType:(0,Yr.e_)(B),katex:B.KatexStore.getKatex(),formulaValueTypes:[]});return(0,v.jsx)("span",{style:Q.textStyle,children:r});case"showPlaceholderAsTitle":return(0,v.jsx)(si.Z,{style:Q.textStyle,store:o});default:(0,Po.t1)(P)}}),[P,H,E,X,x,b,J,Q.textStyle,ie,o,ee,B,V,j,oe]),se=(0,n.useMemo)((()=>z?(0,Ur.t)(Q.errorIcon):"never"===w||"withContent"===w&&void 0===L&&D?null:A?(0,v.jsx)(li.Z,{disabled:!0,icon:L,isEmptyPage:D,size:k,style:Q.recordIconStyle}):(0,v.jsx)(li.Z,{disabled:!1,bucket:"secure",store:o,icon:L,isEmptyPage:D,size:k,iconLoggingData:{collection_id:r.id,recordTable:U,source:C,block_type:W},style:Q.recordIconStyle,onChange:Y})),[W,r.id,Y,z,L,C,D,A,k,U,w,o,Q.errorIcon,Q.recordIconStyle]),ae=(0,i.VK)((()=>O&&(0,ei.Cr)({collectionContextStore:O,blockId:o.id,blockStore:o})&&(0,v.jsx)("span",{style:Q.parentItemIndicator,children:(0,v.jsx)(ui.O,{blockStore:o,collectionContextStore:O,columnWidth:R})})),[O,o,Q.parentItemIndicator,R]),ue=(0,i.VK)((()=>O&&(0,ei.wI)({collectionContextStore:O,blockStore:o})&&(0,v.jsx)("span",{style:Q.subitemCountIndicator,children:(0,v.jsx)(ci.B,{blockStore:o,collectionContextStore:O})})),[O,o,Q.subitemCountIndicator]);return(0,v.jsxs)(m.Z,{ref:t,editButtonClickProps:p,onContextMenu:y,style:Q.buttonStyle,pressedStyle:Q.buttonPressedStyle,hoveredStyle:Q.buttonHoveredStyle,quickActionButtons:h,quickActionButtonsStyle:Q.quickActionButtonsStyle,quickActionButtonsForceVisible:B.device.isMobile?void 0:g,tooltipHide:!0,children:[se,!H&&$?(0,v.jsx)(ii.Z,{href:$,external:q,onClick:G,style:Q.link,children:le}):le,ae,ue,(0,v.jsx)(Pi.s,{store:o,iconStyle:Q.discussionIndicator,buttonStyle:M})]})}))),_i=(0,n.forwardRef)((function(e,t){const{store:o,handleOpenPeekPage:r,width:l}=e,{isMobile:s}=(0,u.Fy)(),{collectionContextStore:a,isReadOnly:d}=(0,n.useContext)(f.O),p=(0,c.yK)((e=>({buttonStyle:{padding:S.sf[h.C.Table].text},textStyle:{...re.z0(e)},recordIconStyle:{height:22,width:22,margin:"-2px 3px 0px -2px"},dbCommentButton:{position:"relative",top:2,marginTop:-2.8}})),[]),y=(0,i.VK)((()=>(null==a?void 0:a.shouldShowPageIcon())??!0),[a]),m=(0,n.useMemo)((()=>(0,v.jsx)(wi,{handleOpenPeekPage:r,store:o,showLabel:s||void 0===l||l>100,showIcon:!s})),[r,s,o,l]),x=Bi(e,t,p);return(0,v.jsx)(ji,{...x,iconActionFrom:"collection_table_view",showIcon:y?"withContent":"never",iconSize:20,titlePropertyType:"hidePlaceholderText",quickActionButtons:m,linkifyText:d,commentsIndicatorStyle:p.dbCommentButton})})),Ri=(0,n.forwardRef)((function(e,t){const{store:o}=e,{isReadOnly:r}=(0,n.useContext)(f.O),{isPhone:l,isMobile:s}=(0,u.Fy)(),a=(0,i.VK)((()=>{const e=ni.Z.state;return Boolean(e.isActive&&e.store.id===o.id)}),[o]),{collectionContextStore:d}=(0,n.useContext)(f.O),p=(0,i.VK)((()=>!!d&&d.isInHomeWidgetStore.state),[d]),y=(0,c.yK)((e=>({buttonStyle:{marginLeft:0,marginRight:"auto",maxWidth:p?"100%":"max(75%, 400px)",minWidth:l?void 0:240,padding:0,paddingLeft:p?oi.A5/2:void 0,flex:p?2:void 0},textStyle:{fontSize:p?14:16,whiteSpace:a?"pre":"nowrap",pointerEvents:a?void 0:"none",cursor:a?"text":void 0,width:"auto",textOverflow:a?void 0:"ellipsis"},recordIconStyle:{marginRight:5},actionButton:{marginLeft:10,marginRight:1,order:3}})),[a,l,p]),m=(0,i.VK)((()=>(null==d?void 0:d.shouldShowPageIcon())??!0),[d]),h=(0,n.useMemo)((()=>!s&&(!r&&!a?(0,v.jsx)(yi,{store:o}):(0,v.jsx)(wi,{store:o,showLabel:!1,showIcon:!0}))),[a,s,r,o]),S=Bi(e,t,y);return(0,v.jsx)(ji,{...S,iconActionFrom:"collection_list_view",showIcon:m?"always":"never",iconSize:p?16:22,editButtonClickProps:void 0,quickActionButtonsStyle:y.actionButton,quickActionButtons:h,titlePropertyType:p?"showPlaceholderAsTitle":"inlineEditable"})})),Mi=(0,n.forwardRef)((function(e,t){Dr.log({level:"error",from:"BlockPropertyValue",type:"BlockPropertyValue.InvalidTitlePropertyFormat"});const o=Bi(e,t);return(0,v.jsx)(ji,{...o,iconActionFrom:"collection_table_view",showIcon:"always",iconSize:20,titlePropertyType:"hidePlaceholderText"})}));function Bi(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:s,format:a,onTab:u,onUntab:c,forceMouseEntered:d,width:p}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,editButtonClickProps:(0,ie.Am)(e),onContextMenu:s,buttonStyle:null==o?void 0:o.buttonStyle,textStyle:null==o?void 0:o.textStyle,recordIconStyle:null==o?void 0:o.recordIconStyle,quickActionButtonsStyle:null==o?void 0:o.quickActionButtonsStyle,format:a,onTab:u,onUntab:c,forceMouseEntered:d,width:p}}const Vi=(0,A.defineMessages)({untitledBlock:{defaultMessage:"Untitled",id:"collectionViewItemTitle.untitledBlock"},typeAName:{defaultMessage:"Type a name",id:"collectionViewItemTitle.itemName.placeholder"}});var Ti=o(604308),Oi=o(111028),Ai=o(958230);const Ii=n.memo(n.forwardRef((function(e,t){var o;const{property:r,collectionStore:l,store:s,buttonStyle:a,editButtonClickProps:u,EmptyComponent:d}=e,{isReadOnly:y,propertySchema:h,baseStyles:S}=(0,n.useContext)(f.O),x=h,b=(0,i.VK)((()=>l.getSchema()),[l]),g=(0,i.VK)((()=>!!x&&Xr._W(x,s,b)),[x,b,s]),C=y||!g,k=(0,c.yK)((e=>({buttonStyle:{...S.buttonStyle,...a,cursor:C?"text":"pointer"},buttonPressedStyle:S.buttonPressedStyle??{},buttonHoveredStyle:S.buttonHoveredStyle??{},secondaryTooltipText:{color:e.mediumInvertedTextColor}})),[S.buttonHoveredStyle,S.buttonPressedStyle,S.buttonStyle,a,C]),w=(0,i.VK)((()=>{const e=s.getPropertyValue(r);return(0,p._w)(e)}),[r,s]),P=(0,n.useMemo)((()=>(0,Ti.WN)(w)),[w]),j=(0,n.useMemo)((()=>{if("none"!==P.type)return(0,v.jsx)(Ai.Z,{verificationState:P,blockStore:s})}),[s,P]),_=(0,n.useMemo)((()=>{var e;if(!!g)return;const t=null==x?void 0:x.verifier_property,o=t?null===(e=b[t])||void 0===e?void 0:e.name:void 0;return(0,v.jsx)(Ei,{verifierPropertyName:o})}),[g,b,x]),R="none"===P.type;return R&&void 0===d?null:(0,v.jsx)(m.Z,{ref:t,editButtonClickProps:C?void 0:u,style:k.buttonStyle,hoveredStyle:k.buttonHoveredStyle,pressedStyle:k.buttonPressedStyle,tooltipPropertyValue:j,tooltipPropertyCaption:_,children:R&&void 0!==d?(0,v.jsx)(d,{}):(0,v.jsx)(Oi.z,{verificationValue:w,fontSize:null===(o=S.buttonStyle)||void 0===o?void 0:o.fontSize})})})));function Ei(e){const{verifierPropertyName:t}=e;return t?(0,v.jsx)(A.FormattedMessage,{defaultMessage:"Only people listed in {verifierPropertyName} can verify this page",id:"VerificationPropertyButton.tooltip.editRestrictedToVerifier",values:{verifierPropertyName:(0,v.jsx)("span",{style:{fontWeight:zo.Z.fontWeight.bold},children:t})}}):(0,v.jsx)(A.FormattedMessage,{defaultMessage:"Only page owners can verify this page",id:"VerificationPropertyButton.tooltip.editRestrictedToOwner"})}const Ki=n.forwardRef((function(e,t){const o=qi(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Table].text}})),[]));return(0,v.jsx)(Ii,{...o,EmptyComponent:Ce.q8})})),Fi=n.forwardRef((function(e,t){const o=qi(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Page].text}})),[]));return(0,v.jsx)(Ii,{...o,EmptyComponent:Ce.T$})})),Zi=n.forwardRef((function(e,t){const o=qi(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.CompactPage].text}})),[]));return(0,v.jsx)(Ii,{...o,EmptyComponent:Ce.T$})})),Hi=n.forwardRef((function(e,t){const{collectionStore:o,store:r,showIfEmpty:l}=e,{propertySchema:s}=(0,n.useContext)(f.O),a=s,u=(0,i.VK)((()=>o.getSchema()),[o]),c=(0,i.VK)((()=>!!a&&Xr._W(a,r,u)),[a,u,r]),d=qi(e,t);return(0,v.jsx)(Ii,{...d,EmptyComponent:l&&c?Ce.s3:void 0})})),Li=n.forwardRef((function(e,t){const{collectionStore:o,store:r,showIfEmpty:l}=e,{propertySchema:s}=(0,n.useContext)(f.O),a=s,u=(0,i.VK)((()=>o.getSchema()),[o]),d=(0,i.VK)((()=>!!a&&Xr._W(a,r,u)),[a,u,r]),p=qi(e,t,(0,c.yK)((()=>({buttonStyle:{padding:S.sf[h.C.Board].text}})),[]));return(0,v.jsx)(Ii,{...p,EmptyComponent:l&&d?Ce.s3:void 0})})),Ni=n.forwardRef((function(e,t){const o=qi(e,t);return(0,v.jsx)(Ii,{...o})})),Di=n.forwardRef((function(e,t){const o=qi(e,t);return(0,v.jsx)(Ii,{...o})})),Ui=n.forwardRef((function(e,t){const o=qi(e,t);return(0,v.jsx)(Ii,{...o})})),Wi=n.forwardRef((function(e,t){const o=qi(e,t);return(0,v.jsx)(Ii,{...o})})),zi=n.forwardRef((function(e,t){const o=qi(e,t);return(0,v.jsx)(Ii,{...o})}));function qi(e,t,o){const{store:n,collectionStore:r,property:i,onClick:l,onContextMenu:s}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,ie.Am)(e),onClick:l,onContextMenu:s,buttonStyle:null==o?void 0:o.buttonStyle}}function $i(e){const{property:t,collectionStore:o,format:u}=e,c=function(e,t){return(0,i.VK)((()=>e.getMappedProperty(t)),[e,t],{debugName:"useMappedProperty"})}(o,t),d=function(e,t){const o=(0,l.DK)();return(0,i.VK)((()=>e.getSchema()[t]??(null==o?void 0:o.normalizedSchemaStore.state[t])),[o,e,t],{debugName:"usePropertySchema"})}(o,c),p=(0,n.useContext)(s.Ue),y=(0,n.useRef)(null);if((0,r.c)(a.Z,(()=>({getNode:()=>{const{current:e}=y;return e?"getNode"in e?e.getNode():e:null},getProps:()=>({...e,property:c}),getContextHorizontalScroller:()=>null==p?void 0:p.horizontalScroller,getContextVerticalScroller:()=>null==p?void 0:p.verticalScroller})),[e]),null==d||!d.type)return null;const m=Gi[u][null==d?void 0:d.type];return null===m?null:(0,v.jsx)(f.Z,{...e,property:c,unmappedProperty:t,propertySchema:d,containerRef:y,children:(0,v.jsx)(m,{ref:y,...e,property:c})})}const Qi=null,Gi={[h.C.Table]:{checkbox:ue,created_by:To,created_time:Ne,date:Ne,email:we,file:rt,formula:ht.n8,last_edited_by:To,last_edited_time:Ne,last_visited_time:Ne,location:vt,multi_select:Gt,number:po,person:To,phone_number:we,relation:sn,rollup:Ln,select:Xn,status:yr,text:Br,title:_i,url:we,verification:Ki,auto_increment_id:k,button:D},[h.C.Board]:{checkbox:ye,created_by:Fo,created_time:We,date:We,email:Re,file:at,formula:ht.mm,last_edited_by:Fo,last_edited_time:We,last_visited_time:We,location:kt,multi_select:eo,number:fo,person:Fo,phone_number:Re,relation:dn,rollup:zn,select:nr,status:Sr,text:Or,title:Mi,url:Re,verification:Li,auto_increment_id:j,button:q},[h.C.Calendar]:{checkbox:me,created_by:Zo,created_time:ze,date:ze,email:Me,file:ut,formula:ht.yJ,last_edited_by:Zo,last_edited_time:ze,last_visited_time:ze,location:wt,multi_select:to,number:ho,person:Zo,phone_number:Me,relation:pn,rollup:qn,select:rr,status:xr,text:Ar,title:Mi,url:Me,verification:Ni,auto_increment_id:_,button:$},[h.C.ListView]:{checkbox:pe,created_by:Ko,created_time:Ue,date:Ue,email:_e,file:st,formula:ht.p5,last_edited_by:Ko,last_edited_time:Ue,last_visited_time:Ue,location:Ct,multi_select:Xt,number:mo,person:Ko,phone_number:_e,relation:cn,rollup:Wn,select:or,status:hr,text:Tr,title:Ri,url:_e,verification:Hi,auto_increment_id:P,button:z},[h.C.GalleryView]:{checkbox:fe,created_by:Ho,created_time:qe,date:qe,email:Be,file:ct,formula:ht.tD,last_edited_by:Ho,last_edited_time:qe,last_visited_time:qe,location:Pt,multi_select:oo,number:So,person:Ho,phone_number:Be,relation:yn,rollup:$n,select:ir,status:vr,text:Ir,title:Mi,url:Be,verification:Di,auto_increment_id:R,button:Q},[h.C.Timeline]:{checkbox:he,created_by:Lo,created_time:$e,date:$e,email:Ve,file:dt,formula:ht.uS,last_edited_by:Lo,last_edited_time:$e,last_visited_time:$e,location:jt,multi_select:no,number:xo,person:Lo,phone_number:Ve,relation:mn,rollup:Qn,select:lr,status:br,text:Er,title:Mi,url:Ve,verification:Ui,auto_increment_id:M,button:G},[h.C.Page]:{checkbox:ce,created_by:Oo,created_time:Le,date:Le,email:Pe,file:it,formula:ht.wC,last_edited_by:Oo,last_edited_time:Le,last_visited_time:Le,location:bt,multi_select:Yt,number:co,person:Oo,phone_number:Pe,relation:an,rollup:Dn,select:er,status:mr,text:Mr,title:Mi,url:Pe,verification:Fi,auto_increment_id:C,button:U},[h.C.CompactPage]:{checkbox:de,created_by:Ao,created_time:De,date:De,email:je,file:lt,formula:ht.lE,last_edited_by:Ao,last_edited_time:De,last_visited_time:De,location:gt,multi_select:Jt,number:yo,person:Ao,phone_number:je,relation:un,rollup:Un,select:tr,status:fr,text:Vr,title:Mi,url:je,verification:Zi,auto_increment_id:w,button:W},[h.C.Relation]:{checkbox:Se,created_by:No,created_time:Qe,date:Qe,email:Te,file:pt,formula:ht.eQ,last_edited_by:No,last_edited_time:Qe,last_visited_time:Qe,location:_t,multi_select:ro,number:vo,person:No,phone_number:Te,relation:fn,rollup:Gn,select:sr,status:gr,text:Kr,title:Mi,url:Te,verification:Wi,auto_increment_id:B,button:Y},[h.C.RelationSection]:{checkbox:xe,created_by:Do,created_time:Ge,date:Ge,email:Oe,file:yt,formula:ht.CJ,last_edited_by:Do,last_edited_time:Ge,last_visited_time:Ge,location:Rt,multi_select:io,number:bo,person:Do,phone_number:Oe,relation:hn,rollup:Yn,select:ar,status:Cr,text:Fr,title:Mi,url:Oe,verification:zi,auto_increment_id:V,button:J},[h.C.Mini]:{checkbox:ve,created_by:Qi,created_time:Qi,date:Ye,email:Ae,file:Qi,formula:Qi,last_edited_by:Qi,last_edited_time:Qi,last_visited_time:Qi,location:Qi,multi_select:lo,number:go,person:Io,phone_number:Ae,relation:vn,rollup:Qi,select:ur,status:kr,text:Zr,title:Mi,url:Ae,verification:Qi,auto_increment_id:Qi,button:Qi},[h.C.PropertyModule]:{checkbox:ce,created_by:Eo,created_time:Le,date:Le,email:Pe,file:mt,formula:ht.wC,last_edited_by:Eo,last_edited_time:Le,last_visited_time:Le,location:bt,multi_select:Yt,number:co,person:Eo,phone_number:Pe,relation:xn,rollup:Dn,select:er,status:mr,text:Mr,title:Mi,url:Pe,verification:Fi,auto_increment_id:C,button:U},[h.C.Form]:{text:Hr,title:Hr,select:Hr,checkbox:Lr,created_by:Lr,created_time:Lr,date:Lr,email:Lr,file:Lr,formula:Lr,last_edited_by:Lr,last_edited_time:Lr,last_visited_time:Lr,location:Lr,multi_select:Lr,number:Lr,person:Lr,phone_number:Lr,relation:Lr,rollup:Lr,status:Lr,url:Lr,verification:Lr,auto_increment_id:Lr,button:Lr}};const Yi=n.memo($i)},396310:(e,t,o)=>{o.d(t,{Z:()=>n});const n=32},711977:(e,t,o)=>{o.d(t,{Z:()=>qe});o(252262),o(324506),o(757658);var n=o(667294),r=o(883355),i=o(701302),l=o(800480),s=o(724405),a=o(371663),u=o(541432),c=o(598953),d=o(399036),p=o(180951),y=o(516691),m=o(640506),f=o(293824),h=o(920669),S=o(421202),x=o(606287),v=o(803791),b=o(76233),g=o(95371),C=o(709291),k=o(653965),w=o(401898),P=o(137810),j=o(619584),_=o(436610),R=o(108406),M=o(757549),B=o(554564),V=o(551365),T=o(498834),O=o(119785),A=o(709953),I=o(879978),E=o(137231),K=o(210228),F=o(644866),Z=o(493911),H=o(710274),L=o(110906),N=o(566890),D=o(27105),U=o(296994),W=o(628020),z=o(849616),q=o(368585),$=o(319124),Q=o(249394),G=o(488804),Y=o(292283),J=o(277907),X=o(318245),ee=o(401018),te=o(679576),oe=o(319385),ne=o(869454),re=o(206258),ie=o(27724),le=o(288280),se=o(973420),ae=o(256940),ue=o(203386),ce=o(291839),de=o(489728),pe=o(953437),ye=o(164369),me=o(122301),fe=o(872589),he=o(735229),Se=o(418145),xe=o(317293),ve=o(915595),be=o(556633),ge=o(256596),Ce=o(965187),ke=o(868750),we=o(423512),Pe=o(205691),je=o(374194),_e=o(683197),Re=o(785893);function Me(e){const{disabled:t,value:o,insertChar:r,format:i,onChange:l,isTable:a}=e,[u,c]=(0,n.useState)(""),d=(0,C.useIntl)(),p=(0,n.useCallback)((e=>{let t=(0,Pe.m)(e,d);return"percent"===i&&void 0!==t&&(t/=100),t}),[d,i]),y=(0,n.useRef)(!1);(0,n.useEffect)((()=>{y.current||(c(we.uf(o,i,d)||""),y.current=!0)}),[i,d,o]),(0,n.useEffect)((()=>{r&&(c(r),l(p(r)))}),[r,l,p]);const m=(0,n.useCallback)((e=>{const t=e.target.value;c(t),l(p(t))}),[l,p]),f=(0,s.yK)((()=>({input:{textAlign:a?"right":"left"},inputContainer:{..._e.F,display:"block"}})),[a]);return(0,Re.jsx)(ue.Z,{debugName:"NumberPropertyValue",capture:!t,onDelete:k.yR,onSpace:k.yR,onBackspace:k.yR,onLeft:k.yR,onRight:k.yR,onUp:k.yR,onDown:k.yR,onSelectAll:k.yR,onRedo:k.yR,onUndo:k.yR,onCut:k.yR,onCopy:k.yR,onPaste:k.yR,onKeypress:k.yR,children:(0,Re.jsx)(je.Z,{style:f.inputContainer,value:u,format:je.B.Transparent,onChange:m,inputStyle:f.input,focus:!t,disabled:t})})}const Be=n.memo(Me),Ve=n.memo((function(e){const{disabled:t,inputType:o,onChange:n,value:r}=e;return(0,Re.jsx)(ue.Z,{debugName:"URLPropertyValue",capture:!t,onDelete:k.yR,onSpace:k.yR,onBackspace:k.yR,onLeft:k.yR,onRight:k.yR,onUp:k.yR,onDown:k.yR,onSelectAll:k.yR,onRedo:k.yR,onUndo:k.yR,onCut:k.yR,onCopy:k.yR,onPaste:k.yR,onKeypress:k.yR,children:(0,Re.jsx)(je.Z,{type:o,style:{..._e.F,display:"block"},value:r,format:je.B.Transparent,onChange:e=>function(e){const{onChange:t,e:o}=e,n=o.target.value;t(n)}({e,onChange:n}),focus:!t,disabled:t})})}));var Te=o(278030),Oe=o(886628),Ae=o(164964),Ie=o(616859),Ee=o(668709),Ke=o(824118);function Fe(e,t){const o=(0,l.O7)(),r=(0,C.useIntl)(),[i,s]=(0,n.useState)(),[a,u]=(0,n.useState)(!1),c=(0,Oe.VK)((()=>{const n=t&&d.qQ(t)?d.q3(t):void 0;return!(0,Ke.bb)({store:e.store,schema:e.store.getSchema(),property:e.property,userId:o.currentUser.id})&&(null==n?void 0:n.auto_update_on_edit)&&!a}),[e.property,e.store,t,a,o]),p=(0,n.useCallback)((()=>{s(void 0)}),[]),y=(0,Oe.VK)((()=>{var t;return null===(t=e.store)||void 0===t||null===(t=t.getFormat())||void 0===t||null===(t=t.ai_property_inference_map)||void 0===t||null===(t=t[e.property])||void 0===t?void 0:t.inference_id}),[e]),m=(0,n.useCallback)((e=>{F.submitFeedbackForAiAutofill({environment:o,inferenceId:y,feedbackType:e.type,userContent:e.userContent,shareWithNotion:e.shareWithNotion}),u(!0),Ae.oV({label:r.formatMessage({id:"database.propertyValues.submitAIAutofillFeedbackThanks",defaultMessage:"Thank you for making Notion better!"})})}),[o,r,y]);return{feedbackState:i,setFeedbackState:s,handleFeedbackButtonDismiss:p,handleFeedbackButtonSubmit:m,shouldDisplayFeedbackButtons:Boolean(c)}}function Ze(e){let{autofillBlockPropertyValueFeedbackButtonsState:t}=e;const o=(0,l.O7)(),r=(0,s.yK)((()=>({iconButtonStyles:{height:o.device.isMobile?24:28,width:o.device.isMobile?24:28}})),[o.device.isMobile]);return(0,Re.jsxs)(n.Fragment,{children:[(0,Re.jsx)(Ie.d,{type:"thumbsup",ariaLabel:"thumbs-up",onClick:()=>{t.setFeedbackState({type:"thumbsup",userContent:"",shareWithNotion:!0})},feedbackState:t.feedbackState,onDismiss:t.handleFeedbackButtonDismiss,onSubmit:t.handleFeedbackButtonSubmit,onUpdate:t.setFeedbackState,showShareDataPopup:!1,onDataShareSubmit:k.ZT,userOptIn:!1,iconButtonStyles:r.iconButtonStyles}),(0,Re.jsx)(Ie.d,{type:"thumbsdown",ariaLabel:"thumbs-down",onClick:()=>{t.setFeedbackState({type:"thumbsdown",userContent:"",shareWithNotion:!0})},feedbackState:t.feedbackState,onDismiss:t.handleFeedbackButtonDismiss,onSubmit:t.handleFeedbackButtonSubmit,onUpdate:t.setFeedbackState,showShareDataPopup:!1,onDataShareSubmit:k.ZT,userOptIn:!1,iconButtonStyles:r.iconButtonStyles})]})}function He(e){let{overlayState:t,theme:o,propertySchema:n}=e;const r=(0,Oe.VK)((()=>te.W.isWriting()),[]),i=(0,l.O7)(),s=Fe(t,n);return i.device.isMobile||r?null:(0,Re.jsx)(Ee.p,{allowSelectionWithin:!1,children:(0,Re.jsxs)("div",{style:{position:"absolute",top:-36,right:0,borderRadius:5,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",background:o.popoverBackground,boxShadow:o.mediumBoxShadow,zIndex:-1,padding:2},children:[(0,Re.jsx)(Le,{overlayState:t,propertySchema:n}),s.shouldDisplayFeedbackButtons&&(0,Re.jsx)(Ze,{autofillBlockPropertyValueFeedbackButtonsState:s})]})})}function Le(e){let{overlayState:t,propertySchema:o}=e;const n=(0,l.O7)(),r=(0,s.yK)((e=>({buttonStyle:{display:"flex",height:28},iconStyle:{height:16,width:16,fill:e.aiPurpleColor},updateTextStyle:{fontWeight:500,color:e.aiPurpleColor}})),[]);return(0,Re.jsx)(de.Z,{style:r.buttonStyle,onClick:()=>{o&&F.autofillPropertyForBlocks({environment:n,stores:[t.store],property:t.property,propertySchema:o,userEventForAnalytics:"generate_from_overlay_button",collectionContextStore:t.collectionContextStore,from:z.Sy(t.format)})},children:(0,Re.jsxs)(se.X2,{gap:4,children:[(0,h.y)(r.iconStyle),(0,Re.jsx)("span",{style:r.updateTextStyle,children:(0,Re.jsx)(C.FormattedMessage,{defaultMessage:"Update",id:"database.propertyValues.reGenerateAiAutofill"})})]})})}function Ne(e){let{overlayState:t,propertySchema:o,showSeparator:n}=e;const r=Fe(t,o),i=(0,s.yK)((e=>({dot:{color:e.lightTextColor}})),[]);return r.shouldDisplayFeedbackButtons?(0,Re.jsxs)(Re.Fragment,{children:[n?(0,Re.jsx)("div",{style:i.dot,children:""}):null,(0,Re.jsx)(Ze,{autofillBlockPropertyValueFeedbackButtonsState:r})]}):null}var De=o(854428);const Ue={..._e.F,fontWeight:P.Z.fontWeight.medium};class We extends r.Z{constructor(){super(...arguments),this.previousPopupProps=void 0,this.renderOverlay=()=>{const e=this.props.store.state;if(e.isOpen)return(0,Re.jsx)(ue.Z,{debugName:"BlockPropertyValueOverlay",capture:!0,onTab:e=>at(e,this.props.store,this.environment),onUntab:e=>ut(e,this.props.store,this.environment),onEnter:()=>ct(this.props.store,this.environment),onDelete:k.yR,onBackspace:k.yR,children:(0,Re.jsxs)(N.L1,{value:e.collectionContextStore,children:[this.renderAutofillUpdateButton(e),(0,Re.jsx)("div",{style:{display:"flex",flexDirection:"column",overflowY:"auto",flexGrow:1,height:"100%"},children:this.renderOverlayContent(e)})]})},`${e.store.id}${e.property}`)},this.renderTitle=(e,t)=>{const{clonedStore:o}=e;return(0,Re.jsx)(ae.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>(0,Re.jsx)("div",{style:Ue,children:(0,Re.jsx)(Ce.Z,{store:o.getTitleStore()||o.getPropertyStore(e.property),disableSlashCommands:!0,onEnter:()=>ct(this.props.store,this.environment),onEsc:()=>st(this.props.store,this.environment),onTab:e=>at(e,this.props.store,this.environment),onUntab:e=>ut(e,this.props.store,this.environment),disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableShiftEnter:!0,onChange:()=>mt(e,t,this.environment,this.props.store),disabled:it(e,this.environment),pasteBehavior:"inline",inPageFind:Q.B3.none})})})},this.aiAutofillExplanationTextIfAIProperty=e=>{var t;const o=Xe(e),n=o&&d.qQ(o)&&("text"===o.type||(0,$.KZ)())?(0,d.q3)(o):void 0;if(!(0,$.Zt)(this.environment))return!1;if(te.W.isWriting())return(0,Re.jsxs)(ye.Z,{isSecondaryColor:!0,style:{fontSize:12,color:this.theme.aiPurpleColor,display:"flex",alignItems:"inline",fontWeight:500,marginTop:6,marginBottom:2},isSmall:!0,isMultiline:!0,children:[(0,Re.jsx)(C.FormattedMessage,{defaultMessage:"AI is writing",id:"BlockPropertyValueOverlay.AIActionText.overlay"}),(0,Re.jsx)("div",{style:{marginLeft:4},children:(0,Re.jsx)(ce.Z,{})})]});const r=(0,$.RT)(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state,e.store);return null!=n&&n.auto_update_on_edit?(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:6,marginBottom:2},children:[(0,Re.jsx)(ye.Z,{isSecondaryColor:!0,style:{fontSize:12},isSmall:!0,isMultiline:!0,children:(0,Re.jsx)(C.FormattedMessage,{defaultMessage:"Auto-updated by AI",id:"BlockPropertyValueOverlay.helpText.overlay"})}),this.environment.device.isMobile&&r&&(0,Re.jsxs)("div",{style:{paddingLeft:2,display:"flex",alignItems:"center"},children:[(0,Re.jsx)("div",{style:{color:this.theme.lightTextColor},children:""}),(0,Re.jsx)(ze,{overlayState:e,propertySchema:o,style:{paddingLeft:2,paddingRight:2}}),(0,Re.jsx)(Ne,{overlayState:e,propertySchema:o,showSeparator:!0})]})]}):this.environment.device.isMobile&&n&&r?(0,Re.jsx)(ze,{overlayState:e,propertySchema:o,style:{marginTop:6,marginBottom:2}}):void 0},this.bulkAutofillButton=e=>{var t;const{store:o}=e,n=Xe(e),r=null==n?void 0:n.name;if(n&&(0,$.RT)(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state,o)&&d.qQ(n)&&(0,d.q3)(n)){var i,l;const t=Math.max((null===(i=e.collectionsBulkActionsToolbarStore)||void 0===i?void 0:i.getNumberOfTextStoresBeingEdited())??0,ie.default.state.stores.length);if(0===t)return;const o=(null===(l=le.subscriptionDataStoreInstance.state)||void 0===l?void 0:l.addOns)??[],n=(0,v.de)(o)||t<=5;return(0,Re.jsx)(de.Z,{style:{width:"100%",height:"auto",borderTop:`1px solid ${this.theme.regularDividerColor}`},onClick:()=>function(e,t,o){const{collectionsBulkActionsToolbarStore:n}=e;if(!n)return;if(t){let t=n.state.textStoresBeingEdited;if(0===t.length&&(t=ie.default.state.stores),!(0,w.Of)(t))return;const r=Xe(e);if(!r)return;F.autofillPropertyForBlocks({environment:o,stores:t,property:e.property,propertySchema:r,userEventForAnalytics:"generate_from_overlay_button",isBulkAction:!0,from:z.Sy(e.format),collectionContextStore:e.collectionContextStore})}else F.triggerAiAutofillUpsell({environment:o,from:"ai_autofill_bulk_fill"})}(e,n,this.environment),children:(0,Re.jsxs)(se.X2,{gap:8,padding:8,alignItems:"start",children:[(0,h.y)({width:18,fill:this.theme.aiPurpleColor}),(0,Re.jsxs)(se.sg,{gap:4,children:[(0,Re.jsx)("div",{style:{fontSize:14,whiteSpace:"normal"},children:r?(0,Re.jsx)(C.FormattedMessage,{defaultMessage:'Update "{propertyName}" with AI',id:"BlockPropertyValueOverlay.bulkAiAutofillButton.titleWithPropertyName",values:{propertyName:r}}):(0,Re.jsx)(C.FormattedMessage,{defaultMessage:"Update with AI",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.title"})}),(0,Re.jsx)("div",{style:{fontSize:12,color:this.theme.mediumTextColor,whiteSpace:"normal",lineHeight:"1.4em"},children:n?(0,Re.jsx)(C.FormattedMessage,{defaultMessage:"{numPages, select, 1 {Update {numPages} page} other {Update {numPages} pages}}",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.countAndDescription",values:{numPages:t}}):(0,Re.jsx)(C.FormattedMessage,{defaultMessage:"Get the AI add-on to update more than {maxItems} pages at once",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.largeBulkFillUpsellMessage",values:{maxItems:5}})})]})]})})}},this.renderText=(e,t)=>{var o;const{clonedStore:n}=e,r=Xe(e);let i;return"text"===(null==r?void 0:r.type)&&null!==(o=r.ai_inference)&&void 0!==o&&o.auto_update_on_edit&&(i="Empty"),(0,Re.jsx)(ae.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsxs)("div",{style:_e.F,children:[(0,Re.jsx)(Ce.Z,{store:n.getPropertyStore(e.property),disableSlashCommands:!0,onEnter:()=>ct(this.props.store,this.environment),onEsc:()=>st(this.props.store,this.environment),onTab:e=>at(e,this.props.store,this.environment),onUntab:e=>ut(e,this.props.store,this.environment),disableSelectAllBlocks:!0,disableSelectionDrag:!0,onChange:()=>mt(e,t,this.environment,this.props.store),disabled:it(e,this.environment),pasteBehavior:"inline",placeholder:i,inPageFind:Q.B3.none}),this.aiAutofillExplanationTextIfAIProperty(e)]}),this.bulkAutofillButton(e)]})})},this.renderURL=(e,t)=>{const o=b.Jcv(Ge(e));let n="url";return"phone_number"===t?n="tel":"email"===t&&(n="email"),(0,Re.jsx)(Ve,{value:o,inputType:n,disabled:it(e,this.environment),onChange:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleURLValueChange,onDismiss:()=>lt(this.props.store,this.environment)})},this.renderNumber=e=>{const t=e.format===Te.C.Table,o=p.VY(Ge(e)),n=Xe(e);if(n&&"number"===n.type)return(0,Re.jsx)(Be,{value:o,isTable:t,format:n.number_format||"number",disabled:it(e,this.environment),insertChar:e.insertChar,onChange:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleNumberValueChange})},this.renderSelect=e=>{const t=$e(e),o=Qe(e),n=Xe(e);if(!o||!n||"select"!==n.type)return;const r=n.options||[],i=p.Sj(Ge(e),r),l=oe.default.checkGate({gateName:"functional_select_property_menu"})?ve.Z:xe.Z;return(0,Re.jsx)(l,{allowMultiple:!1,value:i?[i]:[],property:e.property,collectionId:o.id,schema:t,disabled:it(e,this.environment),canConfigureCollection:tt(e),onChange:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleSelectPropertyMenuUpdate,analyticsFrom:Ye(e),insertChar:e.insertChar,onAccept:e=>dt(e,this.props.store,this.environment),onDismiss:()=>lt(this.props.store,this.environment),blockStore:e.store,autofillExplanation:this.renderAutofillExplanation(e),bulkAutofillButton:this.bulkAutofillButton(e)})},this.renderAutofillExplanation=e=>{const t=this.aiAutofillExplanationTextIfAIProperty(e);return t?(0,Re.jsx)("div",{style:{paddingLeft:9,paddingBottom:6},children:t}):null},this.renderMultiSelect=e=>{const t=$e(e),o=Qe(e),n=Xe(e);if(!o||!n||"multi_select"!==n.type)return;const r=n.options||[],i=p.uP(Ge(e),r),l=oe.default.checkGate({gateName:"functional_select_property_menu"})?ve.Z:xe.Z;return(0,Re.jsx)(l,{allowMultiple:!0,value:i,property:e.property,collectionId:o.id,schema:t,disabled:it(e,this.environment),canConfigureCollection:tt(e),onChange:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleSelectPropertyMenuUpdate,analyticsFrom:Ye(e),insertChar:e.insertChar,onAccept:e=>dt(e,this.props.store,this.environment),onDismiss:()=>lt(this.props.store,this.environment),blockStore:e.store,autofillExplanation:this.renderAutofillExplanation(e),bulkAutofillButton:this.bulkAutofillButton(e)})},this.renderStatus=e=>{const t=Xe(e);if(!t||"status"!==t.type)return;const o={initialValue:p.ZG(Ge(e),t),property:e.property,propertySchema:t,disabled:it(e,this.environment),onDismiss:()=>lt(this.props.store,this.environment),onChange:(e,o)=>{e?yt({type:"selectPropertyMenuUpdateReplaceOptions",options:[e]},this.environment,this.props.store):o?function(e,t,o){const n=o.state;if(!n.isOpen)return;K.createAndCommit({userAction:"BlockPropertyValueOverlay.handleStatusGroupPropertyMenuUpdate",environment:t,perform:r=>{if(e.groupType){for(const o of Je(n)){var i;const l=o.getAssociatedCollectionStore();if(!l)continue;const s=l.getSchema(),a=l.getMappedProperty(n.property),u=s[a];if("status"!==(null==u?void 0:u.type))continue;const c=(u.groups??[]).find((t=>{var o;return t.name.toLowerCase()===(null===(o=e.groupType)||void 0===o?void 0:o.toLowerCase())})),d=null==c||null===(i=c.optionIds)||void 0===i?void 0:i.at(0);if(!d)continue;const p=(u.options??[]).find((e=>e.id===d));if(!p)continue;const y=o.getNormalizedPropertyStore(a);E.sO({environment:t,store:y,value:[[p.value]],transaction:r})}pt(n,t,o)}}})}({groupType:o},this.environment,this.props.store):t.defaultOption?yt({type:"selectPropertyMenuUpdateReplaceOptions",options:[t.defaultOption]},this.environment,this.props.store):yt({type:"selectPropertyMenuUpdateReplaceOptions",options:[]},this.environment,this.props.store)},onAccept:e=>dt(e,this.props.store,this.environment),blockPropertyValueOverlayStore:this.props.store};return e.property===a.b0.StatusV2?(0,Re.jsx)(be.G,{...o}):(0,Re.jsx)(ge.x,{...o})},this.renderPerson=e=>{const t=$e(e),o=Xe(e);if(!o||"person"!==o.type)return;const n=e.store.isTemplate(),r=Ge(e),i=p.BW({value:r,isTemplatePage:n,propertySchema:o,blockCreatorPointer:e.store.getCreatedByPointer()}),l=(0,w.$K)(o.default)&&!r&&1===i.length;return(0,Re.jsx)(he.Z,{value:i,valueIsUnpersistedDefaultValue:l,propertySchema:o,schema:t,disabled:it(e,this.environment),onChange:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePersonPropertyMenuUpdate,insertChar:e.insertChar,onDismiss:()=>lt(this.props.store,this.environment),parentStore:e.store,isTemplatePage:n})},this.renderRelation=e=>{const t=$e(e),o=p.rq(Ge(e)),n=Qe(e);if(n)return(0,Re.jsx)(De.D,{blockPointers:o,property:e.property,collectionStore:n,schema:t,isDisabled:it(e,this.environment),canConfigureCollection:tt(e),onChange:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleRelationPropertyMenuUpdate,analyticsFrom:Ye(e),onDismiss:()=>lt(this.props.store,this.environment),blockStore:e.store,blockPropertyValueOverlayStore:this.props.store,overlayMode:e.mode,insertChar:e.insertChar,children:(0,Re.jsx)(ee.ev,{})})},this.renderRollup=e=>{const t=$e(e);return(0,Re.jsx)(Se.Z,{context:Se.t.BlockPropertyOverlay,property:e.property,schema:t,disabled:it(e,this.environment)||!tt(e)||this.isTypedPropertyStore.state,onChange:e=>function(e,t,o){const n=t.state;if(!n.isOpen)return;K.createAndCommit({userAction:"BlockPropertyValueOverlay.handleRollupPropertyMenuUpdate",environment:o,perform:r=>{!function(e,t,o,n){const r=o.state;if(!r.isOpen)return;if(r.isOpen){const o=Qe(r);o&&H.xO({environment:n,collectionStore:o,update:e,transaction:t})}}({[n.property]:e.propertySchema},r,t,o)}})}(e,this.props.store,this.environment),parentStore:e.store,analyticsFrom:Ye(e),onDismiss:()=>lt(this.props.store,this.environment)})},this.renderDate=e=>{const t=Xe(e);if(!t||"date"!==t.type)return;const o=p.Gl(Ge(e));return(0,Re.jsx)(J.ev,{dependency:U.FF.menus,children:n=>{let{DatePropertyMenu:r}=n;return(0,Re.jsx)(r,{firstDayOfWeek:W.AK.state,value:o,onChangeValue:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDatePropertyValueChange,dateFormat:t.date_format,onChangeDateFormat:e=>function(e,t,o){const n=t.state;if(!n.isOpen)return;const r=Xe(n);if(!r||"date"!==r.type)return;const i=$e(n),l={...r,date_format:e},s={...i,[n.property]:l};if(K.createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyDateFormatChange",environment:o,perform:e=>{rt(s,e,t,o)}}),l){var a;Ye(n),_.$q(o,{property_type:l.type,action:"date_change_format",from:Ye(n),collection_id:null===(a=Qe(n))||void 0===a?void 0:a.id})}}(e,this.props.store,this.environment),timeFormat:t.time_format,disabled:it(e,this.environment),canConfigureCollection:tt(e),onChangeTimeFormat:e=>function(e,t,o){const n=t.state;if(!n.isOpen)return;const r=Xe(n);if(!r||"date"!==r.type)return;const i=$e(n),l={...r,time_format:e},s={...i,[n.property]:l};if(K.createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyTimeFormatChange",environment:o,perform:e=>{rt(s,e,t,o)}}),l){var a;Ye(n),_.$q(o,{property_type:l.type,action:"date_change_format",from:Ye(n),collection_id:null===(a=Qe(n))||void 0===a?void 0:a.id})}}(e,this.props.store,this.environment),onDismiss:()=>lt(this.props.store,this.environment),shouldShowReminder:!0,isTemplatePage:e.store.isTemplate()})}})},this.renderFile=e=>{const t=$e(e),o=p.g(Ge(e));return(0,Re.jsx)(me.Z,{store:e.store,value:o,property:e.property,schema:t,onDismiss:()=>lt(this.props.store,this.environment),uploadFiles:e.uploadFiles,disabled:it(e,this.environment),onChange:t=>{K.createAndCommit({userAction:"BlockPropertyValueOverlay.renderFile",environment:this.environment,perform:o=>{if(j.z4(t.schema)||rt(t.schema,o,this.props.store,this.environment),!j.z4(t.value)){const n=p.CC(t.value);for(const t of et(e))E.sO({environment:this.environment,store:t,value:n,transaction:o});pt(e,this.environment,this.props.store)}}})}})},this.renderFormula=e=>{const{store:t}=e,o=t.getModel(),n=Qe(e),r=Xe(e),i=it(e,this.environment)||!tt(e)||this.isTypedPropertyStore.state;if(o&&n&&r&&"formula"===r.type)return(0,Re.jsx)(J.ev,{dependency:U.FF.formulas,children:o=>(0,Re.jsx)(fe.Z,{handleClose:()=>lt(this.props.store,this.environment),property:e.property,getRecordModel:t.getRecordModel,propertySchema:r,collectionStore:n,handleSave:e=>function(e,t){const{newValue:o,newType:n,propertySchema:r,property:i,collectionStore:l}=e,s=o?{...r,formula2:{code:o,result_type:n},version:"v2"}:{...r,formula2:void 0,version:"v2"};K.createAndCommit({userAction:"CollectionSettingsFormulaOptions.handleFormulaChange",environment:t,perform:e=>{H.xO({environment:t,collectionStore:l,update:{[i]:s},transaction:e})}})}(e,this.environment),formulas:o,disabled:i,blockStore:t,analyticsFrom:Ye(e)})})},this.renderVerificationOverlay=e=>{const t=Xe(e);if("verification"!==(null==t?void 0:t.type))return;const o=p._w(Ge(e));return(0,Re.jsx)(ke.O,{propertyName:t.name,onChange:t=>{K.createAndCommit({userAction:"BlockPropertyValueOverlay.verification",environment:this.environment,perform:o=>{const n=p.Tp(t.value);for(const t of et(e))E.sO({environment:this.environment,store:t,value:n,transaction:o});pt(e,this.environment,this.props.store)}}),lt(this.props.store,this.environment)},verificationValue:o,getRecordModel:e.store.getRecordModel,blockId:e.store.id,onClose:()=>lt(this.props.store,this.environment)})},this.isTypedPropertyStore=this.createComputedStore((()=>{var e;const t=this.props.store.state;if(!t.isOpen)return!1;const o=null===(e=t.collectionContextStore)||void 0===e?void 0:e.collectionStore();if(!o)return!1;const n=t.property;return Boolean(o.getDatabaseType()&&o.isTypedProperty(n))})),this.renderFunctions={title:this.renderTitle,text:this.renderText,relation:this.renderRelation,rollup:this.renderRollup,select:this.renderSelect,multi_select:this.renderMultiSelect,status:this.renderStatus,person:this.renderPerson,number:this.renderNumber,date:this.renderDate,file:this.renderFile,url:this.renderURL,phone_number:this.renderURL,email:this.renderURL,formula:this.renderFormula,checkbox:void 0,created_by:void 0,created_time:void 0,last_edited_by:void 0,last_edited_time:void 0,last_visited_time:void 0,button:void 0,auto_increment_id:void 0,location:void 0,verification:this.renderVerificationOverlay},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleSelectPropertyMenuUpdate=e=>yt(e,this.environment,this.props.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePersonPropertyMenuUpdate=e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;K.createAndCommit({userAction:"BlockPropertyValueOverlay.handlePersonPropertyMenuUpdate",environment:t,perform:r=>{if(j.z4(e.schema)||rt(e.schema,r,o,t),"personPropertyMenuUpdateAddPerson"===e.type){for(const t of et(n))for(const o of e.newValues)K.applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"addPersonAfter",args:{pointer:o}}});pt(n,t,o)}else if("personPropertyMenuUpdateRemovePerson"===e.type){for(const t of et(n))K.applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"removePerson",args:{pointer:e.removedValue}}});pt(n,t,o)}else if("personPropertyMenuUpdateReplacePerson"===e.type){const i=p.BY([e.newValue]);for(const e of et(n))E.sO({environment:t,store:e,value:i,transaction:r});pt(n,t,o)}else(0,w.t1)(e)}})}(e,this.environment,this.props.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleRelationPropertyMenuUpdate=e=>async function(e,t,o){const n=o.state;if(!n.isOpen)return;const r=Xe(n);if(!r||"relation"!==r.type)return;const i="relation"===r.type&&d.F0(r),l=i&&new re.NW(t,{table:x.vF,id:i});l&&await l.load();K.createAndCommit({userAction:"BlockPropertyValueOverlay.handleRelationPropertyMenuUpdate",environment:t,perform:r=>{if(e.newPage&&i&&l){const o=b.TPx(e.newPage.name),i=l.getRootPagePointer()??l.pointer,s=A.j4({environment:t,id:e.newPage.id,type:u.Ti.page,properties:{title:o},spaceId:e.newPage.spaceId,inMemoryRecordCache:n.store.inMemoryRecordCache,transaction:r,useCrdt:i.table===S.iU?new re.G(t,i).useCrdt():i.table===x.vF?(0,D.S9)("collection_unknown_view"):(0,w.t1)(i)});if(i.table===S.iU){const e=new re.G(t,i);O.jG({parentStore:e,childStore:s,transaction:r})}else i.table===x.vF?O.zw({parentStore:l,childStore:s,transaction:r}):(0,w.t1)(i);const a=l.getDefaultTemplatePageStore();a&&T.ob({title:{text:o},environment:t,store:re.G.createChildStore(l,s.pointer),templateStore:a,isKeyboard:!1,isCreateIn:!1,transaction:r,from:"relation_property_menu_update"})}const s=e.newValues,a=e.oldValues,c=(0,f.q)(a.map(y.dn),s.map(y.dn)),d=k.oA(Array.from(c.removeOps).map((e=>{if(!s.find((t=>(0,y.dn)(t)===e)))return a.find((t=>(0,y.dn)(t)===e))}))),p=[];for(const e in c.beforeOps){const t=s.find((t=>(0,y.dn)(t)===e));if(!t)continue;const o=c.beforeOps[e];if(!o){p.push({relationToAdd:t});continue}const n=s.find((e=>(0,y.dn)(e)===o));p.push({relationToAdd:t,before:n})}for(const e of Je(n)){for(const o of d)I.VG({environment:t,store:e,propertyId:n.property,id:o.id,transaction:r});for(const o of p)o.before?I.Hi({environment:t,store:e,propertyId:n.property,id:o.relationToAdd.id,position:{type:"before",before:o.before.id},transaction:r}):I.Hi({environment:t,store:e,propertyId:n.property,id:o.relationToAdd.id,position:{type:"after"},transaction:r})}pt(n,t,o)}})}(e,this.environment,this.props.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDatePropertyValueChange=e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;K.createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyValueChange",environment:t,perform:r=>{for(const i of Je(n))!e||m.U3(e)?(Z.xD({environment:t,store:i,type:"dateValue",dateValue:e,propertyId:n.property,transaction:r}),e||lt(o,t)):(A.sW({store:i.getPropertiesStore(),transaction:r,data:{[n.property]:[b.YCD(b.WBu({type:e}))]}}),lt(o,t)),pt(n,t,o)}})}(e,this.environment,this.props.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleNumberValueChange=e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;const r=p.eP(e);K.createAndCommit({userAction:"BlockPropertyValueOverlay.handleNumberValueChange",environment:t,perform:e=>{for(const o of et(n))E.sO({environment:t,store:o,value:r,transaction:e})}}),pt(n,t,o)}(e,this.environment,this.props.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleURLValueChange=e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;const r=p.iD(e);K.createAndCommit({userAction:"BlockPropertyValueOverlay.handleURLValueChange",environment:t,perform:e=>{for(const o of et(n))E.sO({environment:t,store:o,value:r,transaction:e})}}),pt(n,t,o),M.bO(t,{pastedText:e,source:"url_property"})}(e,this.environment,this.props.store)}UNSAFE_willMount(e){super.UNSAFE_willMount(e),nt({isFirstRender:!0},this.props.store,this.environment)}UNSAFE_willUpdate(e){super.UNSAFE_willUpdate(e),nt({isFirstRender:!1},this.props.store,this.environment)}renderComponent(){const{device:e}=this.environment,t=this.props.store.state;let o,n,r,i=pe.ZP.Placement.Bottom;if(t.isOpen){const a=t.format===Te.C.Page,u=Xe(t),c=u?u.type:void 0,y=t.store.canEdit();let m=t.rect.top,f=t.rect.left,h=t.rect.width,S=t.rect.height;if(a?(f-=1,h+=1):(m-=1,f-=1,h+=1,S+=2),("number"===c||p.TN(c))&&e.isMobile){const e=ne.Z.mobileNativeBottomPadding(this.environment)+24;r={overflowY:"auto",WebkitOverflowScrolling:"touch",width:Math.max(240,h),maxHeight:`calc(100vh - ${e}px)`},i=pe.ZP.Placement.Top}if("number"===c)n={width:Math.max(240,h)};else if("date"===c)m+=S-1,n={};else if("relation"===c){const e=ee.NW;n={width:Math.max(e,h),minHeight:y?65:void 0,overflow:"hidden"}}else if("person"===c)n={width:Math.max(240,h),minHeight:y?100:void 0};else if("formula"===c)m+=S-1,n={borderRadius:12};else if("select"===c||"multi_select"===c)n={width:Math.max(300,h),overflow:"visible"};else if("rollup"===c)m+=S-1,n={};else if("file"===c)n={minWidth:Math.max(240,h)};else if("verification"===c)n={width:k.uZ(h,265,365)};else{const e=24+(this.shouldShowAutofillUpdateButton(t)?28:0);n={width:Math.max(240,h),minHeight:Math.min(S,window.innerHeight-e),maxHeight:window.innerHeight-e,overflow:"visible",display:"flex",flexDirection:"column"},"status"===c&&z.aJ({store:t.store,additionalStores:t.additionalStores,collectionContextStore:t.collectionContextStore})&&(m+=S-1)}const x=t.collectionContextStore;if(x){var l,s;const e=x.subitemTreeStore.state,o=(0,g.DY)(e.children,(e=>e.value.store===t.store)),r=null==o?void 0:o.length,i=null===(l=x.formatStore())||void 0===l||null===(l=l.getFormat())||void 0===l||null===(l=l.table_properties)||void 0===l?void 0:l.filter((e=>e.visible)),a=i&&(null===(s=i[0])||void 0===s?void 0:s.property)===t.property;r&&a&&(n={...n,...c&&d.Yl(c)&&{width:Math.max(90,h)}})}o=new DOMRect(f,m,h,0)}if(t.isOpen||!this.previousPopupProps){const l=function(e,t){const{device:o}=t;if(o.isMobile){const t=e.state;if(!t.isOpen)return pe.kQ.SlideUp;const o=Xe(t);return o?_e.m[o.type]:pe.kQ.SlideUp}return pe.kQ.Popup}(this.props.store,this.environment),s=!e.isMobile||l===pe.kQ.Popup,a={key:ot(this.props.store),popupType:l,open:t.isOpen,originRect:o,style:e.isMobile?{width:n?n.width:void 0,...r}:n,alignmentToOrigin:pe.ZP.Alignment.Start,placementToOrigin:i,preventScaleTransition:s,preventOpacityTransition:s,render:this.renderOverlay,onDismiss:()=>{return e=this.props.store,t=this.environment,B.LZ(),void V.fG({environment:t,blockPropertyValueOverlayStore:e});var e,t}};return this.previousPopupProps=a,(0,Re.jsx)(pe.ZP,{...a})}{const e={...this.previousPopupProps,open:!1};return(0,Re.jsx)(pe.ZP,{...e})}}shouldShowAutofillUpdateButton(e){var t;const{store:o}=e,n=Xe(e);return n&&(0,$.RT)(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state,o)&&d.qQ(n)&&d.q3(n)&&("text"===n.type||(0,$.KZ)())&&!e.collectionsBulkActionsToolbarStore}renderAutofillUpdateButton(e){if(this.shouldShowAutofillUpdateButton(e))return(0,Re.jsx)(He,{theme:this.theme,propertySchema:Xe(e),overlayState:e})}renderOverlayContent(e){const t=Xe(e);if(!t)return;const o=this.renderFunctions[t.type];return o?o(e,t.type):void 0}}function ze(e){let{overlayState:t,propertySchema:o,style:n}=e;const r=(0,l.O7)(),i=(0,s.yK)((e=>({linkStyle:{color:e.aiPurpleColor,fontSize:12,...n}})),[n]);return(0,Re.jsx)("div",{style:i.linkStyle,onClick:()=>{o&&F.autofillPropertyForBlocks({environment:r,stores:[t.store],property:t.property,propertySchema:o,userEventForAnalytics:"generate_from_overlay_button",collectionContextStore:t.collectionContextStore,from:z.Sy(t.format)})},children:(0,Re.jsx)(C.FormattedMessage,{defaultMessage:"Update",id:"database.propertyValues.reGenerateAiAutofill"})})}We.displayName="BlockPropertyValueOverlay";const qe=We;function $e(e){const{store:t,additionalStores:o,collectionContextStore:n}=e;return n&&z.aJ({store:t,additionalStores:o,collectionContextStore:n})?n.normalizedSchemaStore.state:t.getSchema()||{}}function Qe(e){if(!z.aJ({store:e.store,additionalStores:e.additionalStores,collectionContextStore:e.collectionContextStore}))return e.store.getAssociatedCollectionStore()}function Ge(e){return e.store.getPropertyValue(e.property)}function Ye(e){return z.Sy(e.format)}function Je(e){return[e.store,...e.additionalStores]}function Xe(e){const t=Qe(e),o=t?t.getMappedProperty(e.property):e.property;return $e(e)[o]}function et(e){return Je(e).map((t=>{const o=t.getAssociatedCollectionStore(),n=o?o.getMappedProperty(e.property):e.property;return t.getNormalizedPropertyStore(n)}))}function tt(e){const t=Qe(e),o=null==t?void 0:t.getParentBlockStore();return L.eD({collectionStore:t,collectionViewBlockStore:o,checkNavigableAncestorLocked:!1})}function ot(e){const t=e.state;if(!t.isOpen)return"ignore";const o=Xe(t);return o?o.type:"ignore"}function nt(e,t,o){let{isFirstRender:n}=e;const r=t.state;if(!r.isOpen||!r.collectionContextStore)return;const i=X.default.mark("collections.block_property_value_overlay_render");X.default.measureAfterNextFlush(i,{environment:o,getData:()=>{var e;return{...q.vS(r.collectionContextStore),is_first_render:n,property_type:null===(e=Xe(r))||void 0===e?void 0:e.type,from:z.Sy(r.format)}}})}function rt(e,t,o,n){const r=o.state;if(r.isOpen&&r.isOpen){const o=Qe(r);o&&H.Rm({environment:n,collectionStore:o,update:{schema:e},transaction:t})}}function it(e,t){const o=Xe(e),n=o&&d.qQ(o)&&("text"===o.type||(0,$.KZ)())&&(0,d.q3)(o);if(n&&n.auto_update_on_edit&&(0,$.Zt)(t))return!0;const r=Qe(e);return!(null==r||!r.isExternallyImportedAndSyncedCollection()||!(0,Y.K6)())||(e.readOnly||(0,G.N)(t,e.store)||(0,c.w)(e.property))}function lt(e,t){V.xv({environment:t,blockPropertyValueOverlayStore:e})}function st(e,t){V.i2({environment:t,blockPropertyValueOverlayStore:e})}function at(e,t,o){e.preventDefault(),V.$o({environment:o,blockPropertyValueOverlayStore:t})}function ut(e,t,o){e.preventDefault(),V.RX({environment:o,blockPropertyValueOverlayStore:t})}function ct(e,t){V.gT({environment:t,blockPropertyValueOverlayStore:e})}function dt(e,t,o){const n=t.state;if(!n.isOpen)return;const r=Xe(n);!r||"select"!==r.type&&"status"!==r.type||i.default.afterNextFlush((()=>{e?V.gT({environment:o,blockPropertyValueOverlayStore:t}):V.i2({environment:o,blockPropertyValueOverlayStore:t})}))}function pt(e,t,o){const n=e.store.getType(),r=e.store.getAssociatedCollectionId(),i=Xe(e),{collectionContextStore:l}=e;if(n&&i&&l){const n=Ye(e);R.rv({environment:t,collectionContextStore:l,block_id:e.store.id,property:e.property,property_type:i.type,from:n,collection_id:r,isFromBulkActionsToolbar:z.VM(o)})}}function yt(e,t,o){const n=o.state;n.isOpen&&K.createAndCommit({userAction:"BlockPropertyValueOverlay.handleSelectPropertyMenuUpdate",environment:t,perform:r=>{if(j.z4(e.schemaOperations)||function(e,t,o,n){const r=o.state;if(r.isOpen&&r.isOpen){const o=Qe(r);if(o){const r=o.getSchema();for(const n of e)K.applyOperation({store:(0,re.Kv)(o,n.pointer),operation:n,transaction:t});const i=o.getSchema();H.C_({environment:n,collectionStore:o,oldSchema:r,newSchema:i,transaction:t})}}}(e.schemaOperations,r,o,t),"selectPropertyMenuUpdateReplaceOptions"===e.type){const i=p.zq(e.options);for(const e of et(n))E.sO({environment:t,store:e,value:i,transaction:r});pt(n,t,o)}else if("selectPropertyMenuUpdateAddOptions"===e.type){for(const t of et(n))for(const o of e.addOptions)K.applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"addSelectOptionAfter",args:{option:o}}});pt(n,t,o)}else if("selectPropertyMenuUpdateRemoveOption"===e.type){for(const t of et(n))K.applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"removeSelectOption",args:{option:e.removeOption}}});pt(n,t,o)}else"selectPropertyMenuUpdateSchema"===e.type||(0,w.t1)(e)}})}function mt(e,t,o,n){!function(e,t,o){const n=X.default.mark("collections.property_overlay_typing_lag");X.default.measureAfterNextFlush(n,{environment:o,getData:()=>({...q.vS(e.collectionContextStore),property_type:t,from:z.Sy(e.format)})})}(e,t,o);const{store:r,property:i,additionalStores:l}=e,s=r.getNormalizedPropertyStore(i).getValue();K.createAndCommit({userAction:"BlockPropertyValueOverlay.handleTextChange",environment:o,perform:e=>{for(const t of l)E.sO({environment:o,store:t.getNormalizedPropertyStore(i),value:s,transaction:e})}}),pt(e,o,n)}},854428:(e,t,o)=>{o.d(t,{D:()=>l,m:()=>i});var n=o(667294),r=o(785893);const i=(0,n.createContext)({blockPointers:[],collectionStore:void 0,property:"",schema:{},analyticsFrom:void 0,isDisabled:!0,canConfigureCollection:!1,onChange:()=>{},onDismiss:()=>{},blockStore:void 0,blockPropertyValueOverlayStore:void 0,overlayMode:void 0,insertChar:void 0});function l(e){const{children:t,blockPointers:o,collectionStore:l,property:s,schema:a,analyticsFrom:u,isDisabled:c,canConfigureCollection:d,blockStore:p,blockPropertyValueOverlayStore:y,overlayMode:m,insertChar:f,onChange:h,onDismiss:S}=e,x=(0,n.useMemo)((()=>({blockPointers:o,collectionStore:l,property:s,schema:a,analyticsFrom:u,isDisabled:c,canConfigureCollection:d,blockStore:p,blockPropertyValueOverlayStore:y,overlayMode:m,insertChar:f,onChange:h,onDismiss:S})),[o,l,s,a,u,c,d,p,y,m,f,h,S]);return(0,r.jsx)(i.Provider,{value:x,children:t})}i.displayName="BlockPropertyValueOverlayContext"},683197:(e,t,o)=>{o.d(t,{F:()=>i,m:()=>r});var n=o(953437);const r={title:n.kQ.Popup,text:n.kQ.Popup,number:n.kQ.Popup,url:n.kQ.Popup,phone_number:n.kQ.Popup,email:n.kQ.Popup,relation:n.kQ.SlideUp,rollup:n.kQ.SlideUp,select:n.kQ.SlideUp,multi_select:n.kQ.SlideUp,status:n.kQ.SlideUp,person:n.kQ.SlideUp,date:n.kQ.SlideUp,file:n.kQ.SlideUp,formula:n.kQ.SlideUp,checkbox:n.kQ.SlideUp,created_by:n.kQ.SlideUp,created_time:n.kQ.SlideUp,last_edited_by:n.kQ.SlideUp,last_edited_time:n.kQ.SlideUp,last_visited_time:n.kQ.SlideUp,button:n.kQ.SlideUp,auto_increment_id:n.kQ.Popup,location:n.kQ.Popup,verification:n.kQ.SlideUp},i=Object.freeze({paddingLeft:9,paddingRight:9,paddingTop:6,paddingBottom:6,fontSize:14,minHeight:34,display:"flex",height:"100%",flexDirection:"column",justifyContent:"space-between",flexGrow:1})},76485:(e,t,o)=>{o.d(t,{s:()=>m});var n=o(667294),r=o(800480),i=o(886628),l=o(724405),s=o(405829),a=o(554564),u=o(165598),c=o(305971),d=o(524229),p=o(489728),y=o(785893);function m(e){let{store:t,iconStyle:o,size:m,buttonStyle:f}=e;const h=(0,r.O7)(),S=(0,i.VK)((()=>u.Xp(t,{recursivelyLoadAllDiscussions:!1})),[t]),x=(0,n.useRef)(null),v=(0,l.yK)((e=>({iconStyle:{fill:e.mediumIconColor}})),[]),b=!(0,c.E)("db_comments"),{menuOpen:g,menuStoreId:C}=(0,i.VK)((()=>{const e=d.Z.state.open;return{menuOpen:e,menuStoreId:e?d.Z.state.blockStore.id:void 0}}),[]),k=(0,n.useCallback)((()=>{var e;g&&C===t.id?a.LZ():(a.LZ(),a.Ib({environment:h,blockStore:t,shouldFocusDiscussion:!0,analyticsFrom:"db_page_comments",rect:null===(e=x.current)||void 0===e?void 0:e.getBoundingClientRect(),recursivelyLoadAllDiscussions:!1}))}),[g,C,h,t]);if(0===S)return null;return(0,y.jsx)(p.Z,{"aria-label":"Open comments",ref:x,isSmall:!0,style:f,onClick:k,disabled:b,disabledFeedback:!b&&void 0,children:(0,y.jsxs)("div",{style:o,children:[(0,s.s)({width:m||14,height:m||14,marginRight:3,fill:v.iconStyle.fill}),S]},"discussion-indicator")})}},177866:(e,t,o)=>{o.d(t,{T$:()=>y,q8:()=>m,s3:()=>f,zX:()=>h});var n=o(667294),r=o(886628),i=o(724405),l=o(10070),s=o(12396),a=o(709291),u=o(508606),c=o(177722),d=o(785893);const p="20px";function y(){return(0,d.jsx)(c.Y,{fontColor:"light",style:{lineHeight:p},children:(0,d.jsx)(a.FormattedMessage,{defaultMessage:"Empty",id:"database.pageProperty.emptyTitle"})})}function m(){return null}function f(){const e=(0,i.Fg)(),{store:t,property:o,collectionContextStore:p}=(0,n.useContext)(u.O),y=(0,r.VK)((()=>{const e=null==p?void 0:p.normalizedSchemaStore.state,n=null==t?void 0:t.getAssociatedCollectionStore();if(!e||!n||!o)return;return e["collectionTypedView"===p.contextType?l.aQ.derivePropertyUri(o,n.getPropertyMapping())??o:o]}),[p,o,t]),m=(0,i.yK)((()=>({textContainer:{display:"inline-flex",alignItems:"center"},propertyIcon:{marginRight:6}})),[]);return y?(0,d.jsxs)(c.Y,{fontColor:"light",style:m.textContainer,children:[(0,d.jsx)(s.ZP,{type:y.type,icon:y.icon,size:14,theme:e,style:m.propertyIcon}),(0,d.jsx)(a.FormattedMessage,{defaultMessage:"Add {propertyName}",id:"database.boardProperty.fillProperty",values:{propertyName:y.name}})]}):null}function h(){const e=(0,i.Fg)(),{propertySchema:t,baseStyles:o}=(0,n.useContext)(u.O),r=(0,i.yK)((e=>({container:{...null==o?void 0:o.textStyle,display:"inline-flex",alignItems:"center",overflow:"hidden",color:e.lightTextColor},text:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},icon:{marginRight:6}})),[o]);return t?(0,d.jsxs)("div",{style:r.container,children:[(0,d.jsx)(s.ZP,{type:t.type,icon:t.icon,size:14,theme:e,style:r.icon}),(0,d.jsx)("div",{style:r.text,children:t.name})]}):null}},630752:(e,t,o)=>{o.d(t,{$I:()=>G,CJ:()=>q,eQ:()=>z,lE:()=>H,mm:()=>N,n8:()=>K,p5:()=>L,tD:()=>U,tT:()=>Q,uS:()=>W,wC:()=>Z,yJ:()=>D});o(21703);var n=o(667294),r=o(800480),i=o(886628),l=o(724405),s=o(14577),a=o(435011),u=o(640506),c=o(407057),d=o(672158),p=o(484682),y=o(842875),m=o(882883),f=o(709291),h=o(653965),S=o(940470),x=o(401898),v=o(296994),b=o(433929),g=o(573807),C=o(277907),k=o(939694),w=o(165473),P=o(508606),j=o(278030),_=o(824118),R=o(753876),M=o(219629),B=o(177722),V=o(177866),T=o(785893);const O=(()=>{try{return"true"===new URLSearchParams(window.location.search).get("disableFormulas")}catch(e){return!1}})(),A=n.memo(n.forwardRef((function(e,t){var o,r;const{store:u,property:c,EmptyComponent:m,collectionStore:h,onContextMenu:x,editButtonClickProps:b,checkboxButtonStyle:k,textButtonStyle:j,quickActionButtons:_,checkboxShowLabel:R}=e,{baseStyles:V,propertySchema:A,format:E}=(0,n.useContext)(P.O),K=A,F=(0,i.VK)((()=>"v2"===(null==K?void 0:K.version)),[null==K?void 0:K.version])?null==K||null===(o=K.formula2)||void 0===o?void 0:o.result_type.type:null==K||null===(r=K.formula)||void 0===r?void 0:r.result_type,Z=!0===e.numberRightAlign&&"number"===(0,a.r9)(K),H=function(e){const{store:t,collectionStore:o,property:r,formulas:l,checkboxShowLabel:u,numberRightAlign:c}=e,m=(0,f.useIntl)(),h=(0,i.VK)((()=>o.getSchema()),[o]),{propertySchema:x}=(0,n.useContext)(P.O),v=x,b=(0,g._)(),C=(0,i.VK)((()=>{var e;const n=t.getModel(),i=o.getModel();if(O||!i)return;const u=i.getNormalizedSchema()[r],c=null==u||null===(e=u.formula2)||void 0===e?void 0:e.code;if(!(n&&l&&i&&c))return;const p=(0,a.cO)(n,i,r);if(p)return p;const f=new s.Z((()=>{const e=(0,a.NM)({block:n,property:r,formulaCode:c,getRecordModel:t.getRecordModel,intl:m,userTimeZone:(0,y.r)(),depth:0,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+b,resultCache:new Map});return!e||S.x.isFail(e)?{error:{type:d.FY.UnexpectedError,error:new Error("Something went wrong in formula evaluation.")}}:{value:e.value}}),{debugName:`${Math.random()}`});return(0,a.HU)(n,i,r,(()=>f.getState())),f.getState()}),[o,l,m,r,t,b]),k=(0,i.VK)((()=>{const e=C;return!e||S.x.isFail(e)?{type:"undefined"}:e.value}),[C]),w=null==v?void 0:v.formula,j=(0,i.VK)((()=>{if("v2"===(null==v?void 0:v.version)){var e;if(void 0===k)return[[],"formula"];const o=G(k,t.getRecordModel,(0,y.r)());return[o,(null===(e=o[0])||void 0===e?void 0:e.type)??"text"]}if(!t.isDefined())return[[],"formula"];return[Q((0,p.AH)({property:r,schema:h,block:t.getModel(),getRecordModel:t.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,y.r)(),depth:0,intl:m,resultCache:new Map,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+b}})),(null==w?void 0:w.result_type)??"text"]}),[null==w?void 0:w.result_type,k,null==v?void 0:v.version,m,r,h,t,b]);return(0,i.VK)((()=>{const[e,o]=j;if(0===e.length)return null;const n=u&&"checkbox"===(0,a.mm)(v)&&1===e.length?null==v?void 0:v.name:void 0,r=!!v&&(0,M.vQ)(o,v);return v&&(0,T.jsx)(M.E1,{propertyType:o,rootPropertySchema:v,numberRightAlign:c,children:e.map(((o,i)=>(0,T.jsx)(M.gZ,{token:o,targetPropertySchema:v,blockStore:t,checkboxPropertyLabel:n,withComma:r&&i<e.length-1,numberRightAlign:c},`${o.id}-${i}`)))})}),[u,v,j,c,t])}({store:u,collectionStore:h,property:c,numberRightAlign:Z,checkboxShowLabel:R,formulas:(0,C.XJ)(v.FF.formulas)}),L=(0,l.yK)((e=>({buttonStyle:{...V.buttonStyle,..."checkbox"===F?k:{},..."number"===F||"date"===F||"text"===F?j:{}},buttonPressedStyle:V.buttonPressedStyle??{},buttonHoveredStyle:V.buttonHoveredStyle??{}})),[V.buttonHoveredStyle,V.buttonPressedStyle,V.buttonStyle,k,F,j]);if(O)return(0,T.jsx)("div",{style:{padding:"5px 8px"},children:(0,T.jsx)(B.Y,{fontColor:"light",children:(0,T.jsx)(f.FormattedMessage,{defaultMessage:"Disabled",id:"database.pageProperty.disableFormulas"})})});const N=null===H;return N&&void 0===m?null:(0,T.jsx)(w.Z,{ref:t,onContextMenu:x,editButtonClickProps:b,style:L.buttonStyle,pressedStyle:L.buttonPressedStyle,hoveredStyle:L.buttonHoveredStyle,quickActionButtons:_?(0,T.jsx)(I,{buttons:_,store:u,collectionStore:h,property:c,format:E,isEmpty:N}):void 0,quickActionButtonsAlign:Z?"left":void 0,children:N?m?(0,T.jsx)(m,{}):null:H})})));function I(e){const{buttons:t,store:o,collectionStore:n,property:r,format:l,isEmpty:s}=e,a=(0,i.VK)((()=>n.getSchema()),[n]);if(s)return null;const u=t.map((e=>{if("copy"===e)return(0,T.jsx)(k.Z,{store:o,schema:a,property:r,format:l},"copy");(0,x.t1)(e)})).filter(x.K0);return u?(0,T.jsx)(T.Fragment,{children:u}):null}const E=["copy"],K=n.forwardRef((function(e,t){const{isMobile:o}=(0,r.Fy)(),n=$(e,t,(0,l.yK)((()=>({checkboxButtonStyle:{padding:R.sf[j.C.Table].checkbox},textButtonStyle:{padding:R.sf[j.C.Table].text}})),[]));return(0,T.jsx)(A,{...n,numberRightAlign:!0,EmptyComponent:V.q8,quickActionButtons:o?void 0:E})})),F=["copy"],Z=n.forwardRef((function(e,t){const o=$(e,t,(0,l.yK)((()=>({checkboxButtonStyle:{padding:R.sf[j.C.Page].checkbox},textButtonStyle:{padding:R.sf[j.C.Page].text}})),[]));return(0,T.jsx)(A,{...o,EmptyComponent:V.T$,quickActionButtons:F})})),H=n.forwardRef((function(e,t){const o=$(e,t,(0,l.yK)((()=>({checkboxButtonStyle:{padding:R.sf[j.C.CompactPage].checkbox},textButtonStyle:{padding:R.sf[j.C.CompactPage].text}})),[]));return(0,T.jsx)(A,{...o,EmptyComponent:V.T$})})),L=n.forwardRef((function(e,t){const o=$(e,t);return(0,T.jsx)(A,{...o})})),N=n.forwardRef((function(e,t){const o=$(e,t,(0,l.yK)((()=>({checkboxButtonStyle:{padding:R.sf[j.C.Board].checkbox},textButtonStyle:{padding:R.sf[j.C.Board].text}})),[]));return(0,T.jsx)(A,{...o,checkboxShowLabel:!0})})),D=n.forwardRef((function(e,t){const o=$(e,t);return(0,T.jsx)(A,{...o,checkboxShowLabel:!0})})),U=n.forwardRef((function(e,t){const o=$(e,t);return(0,T.jsx)(A,{...o,checkboxShowLabel:!0})})),W=n.forwardRef((function(e,t){const o=$(e,t);return(0,T.jsx)(A,{...o})})),z=n.forwardRef((function(e,t){const o=$(e,t);return(0,T.jsx)(A,{...o})})),q=n.forwardRef((function(e,t){const o=$(e,t);return(0,T.jsx)(A,{...o})}));function $(e,t,o){const{store:n,onContextMenu:r,property:i,collectionStore:l}=e;return{ref:t,store:n,property:i,collectionStore:l,editButtonClickProps:(0,_.Am)(e),onContextMenu:r,checkboxButtonStyle:null==o?void 0:o.checkboxButtonStyle,textButtonStyle:null==o?void 0:o.textButtonStyle}}function Q(e){if(void 0===e)return[];if("string"==typeof e)return 0===e.length?[]:[{id:e,type:"text",value:[[e]]}];if("number"==typeof e)return[{id:e,type:"number",value:e}];if((0,u.U3)(e)){return[{id:c.ZV({allowRelativeDates:!1,value:e,userTimeZone:(0,y.r)(),intl:b.default.getIntl()}),type:"date",value:e}]}if("boolean"==typeof e)return[{id:e,type:"checkbox",value:e}];(0,x.t1)(e)}function G(e,t,o){switch(e.type){case"text":const n=(0,m.X)({textValue:e.value,getRecordModel:t,userTimeZone:o,intl:b.default.getIntl(),deterministic:!0});return 0===n.length?[]:[{id:n,type:"text",value:e.value}];case"block":return[{id:e.value.id,type:"relation",value:e.value}];case"date":return[{id:c.ZV({allowRelativeDates:!1,value:e.value,userTimeZone:(0,y.r)(),intl:b.default.getIntl()}),type:"date",value:e.value}];case"checkbox":return[{id:e.value,type:"checkbox",value:e.value}];case"number":return[{id:e.value,type:"number",value:e.value}];case"person":return[{id:e.value.id,type:"person",value:e.value}];case"array":return h.Ar(e.values.map((e=>G(e,t,o))));case"undefined":case"function":return[];default:(0,x.t1)(e)}}},469823:(e,t,o)=>{o.d(t,{n:()=>a});var n=o(667294),r=o(724405),i=o(260458),l=o(508606),s=o(785893);const a=n.memo((function(e){const{propertyLabel:t,checked:o,enablePointerEventsForInteractiveTypes:a,onClick:u,disabled:c,tooltip:d,withComma:p}=e,{baseStyles:y}=(0,n.useContext)(l.O),m=(null==y?void 0:y.sizing)??"default",f=(0,r.yK)((()=>({cardCheckboxWrapStyle:{display:"flex",alignItems:"center"},cardCheckboxNameStyle:{marginLeft:"small"===m?5:6,marginRight:2}})),[m]),h={checked:o,disabled:c,style:{...a&&{pointerEvents:"auto"}},onClick:u,..."small"===m?{size:14,checkSize:10}:{size:16,checkSize:12},tooltipHeader:d,withComma:p};return t?(0,s.jsxs)("div",{style:f.cardCheckboxWrapStyle,children:[(0,s.jsx)(i.Z,{...h}),(0,s.jsx)("div",{style:f.cardCheckboxNameStyle,children:t})]}):(0,s.jsx)(i.Z,{...h})}))},477729:(e,t,o)=>{o.d(t,{t:()=>p});var n=o(667294),r=o(886628),i=o(724405),l=o(180951),s=o(76233),a=o(849616),u=o(584076),c=o(508606),d=o(785893);const p=n.memo((function(e){const{textValue:t,type:o,useShortenedUrl:p,disableLinkify:m,withComma:f}=e,h=(0,i.yK)((e=>({linkBoxStyle:{pointerEvents:"all",display:"inline",background:void 0,...(0,a.z0)(e)},hoveredLinkBoxStyle:{background:void 0,...(0,a.z0)(e)},pressedLinkBoxStyle:{background:void 0,...(0,a.z0)(e)}})),[]),{collectionContextStore:S}=(0,n.useContext)(c.O),x=(0,r.VK)((()=>null==S?void 0:S.searchQueryStore.state),[null==S?void 0:S.searchQueryStore]),v=(0,r.VK)((()=>{if(!x||!t)return!1;const e=(0,s.Jcv)(t);return null==e?void 0:e.toLowerCase().includes(x.toLowerCase())}),[x,t]),b=(0,l.Hw)(o,t);let g;return g=t&&"url"===o&&(p||v)?(0,d.jsx)(y,{textValue:t,searchQuery:x}):(0,s.Jcv)(t),!b||m?(0,d.jsx)(d.Fragment,{children:g}):(0,d.jsxs)(u.Z,{href:b,onClick:e=>{(e.metaKey||e.ctrlKey)&&window.open(b,"_blank")},style:h.linkBoxStyle,hoveredStyle:h.hoveredLinkBoxStyle,pressedStyle:h.pressedLinkBoxStyle,external:!0,children:[g,f?", ":null]})}));function y(e){let{textValue:t,searchQuery:o}=e;const n=(0,i.yK)((e=>({restOfUrl:{color:e.lightTextColor}})),[]),{domain:r,restOfUrl:l}=(0,a.AF)(t);if(!r)return(0,d.jsx)(d.Fragment,{children:(0,s.Jcv)(t)});const u=function(e,t,o){if(!t)return;let n=t,r=!1;if(t&&o){const i=null==t?void 0:t.toLowerCase().indexOf(o.toLowerCase()),l=`${e}${t}`.toLowerCase().indexOf(o.toLowerCase());if(i>=0){let e="";i>0&&(e=`${t.slice(0,1)}`),i>1&&(e+="");let l="";i+o.length<t.length&&(l=""),n=`${e}${t.slice(i,i+o.length)}${l}`,r=!0}else if(l>=0&&l+o.length>e.length){const i=l+o.length-e.length;n=t.slice(0,i),i<t.length&&(n+=""),r=!0}}!r&&t&&t.length>12&&(n=`${t.slice(0,4)}${t.slice(-6)}`);return n}(r,l,o);return(0,d.jsxs)(d.Fragment,{children:[r,u?(0,d.jsx)("span",{style:n.restOfUrl,children:u}):null]})}},481381:(e,t,o)=>{o.d(t,{z:()=>u});var n=o(667294),r=o(724405),i=o(640506),l=o(289845),s=o(508606),a=o(785893);const u=n.memo((function(e){const{dateValue:t,dateFormat:o,timeFormat:u,withComma:c}=e,{baseStyles:d,shouldRenderTooltip:p}=(0,n.useContext)(s.O),y=(0,r.yK)((()=>({dateBox:{...d.textStyle,display:"inline"}})),[d.textStyle]);return(0,a.jsx)(l.Z,{value:t,dateFormat:o??i.sF,timeFormat:u??i.c_,style:y.dateBox,disableTooltip:p||"relative"!==o,withComma:c,displayInUserTimezone:!0})}))},679074:(e,t,o)=>{o.d(t,{e:()=>y});var n=o(667294),r=o(800480),i=o(724405),l=o(895538),s=o(137810),a=o(99813),u=o(954604),c=o(81865),d=o(508606),p=o(785893);const y=n.memo((function(e){const{linkValue:t,permissionRecord:o}=e,{url:y,name:m}=t,{baseStyles:f}=(0,n.useContext)(d.O),h=(0,r.O7)(),S=n.createRef(),x=(null==f?void 0:f.sizing)??"default",v=(0,i.yK)((e=>({fileTextStyle:{display:"inline-block",height:"small"===x?20:24,lineHeight:"small"===x?"20px":"24px",borderRadius:4,background:e.legacyDefaultSelectColor,padding:"0px 6px",maxWidth:120,cursor:"zoom-in",...s.Z.textOverflowStyle},fileImageStyle:{maxHeight:"small"===x?20:24,borderRadius:4,cursor:"zoom-in"}})),[x]),b=(0,n.useCallback)(((e,t)=>{if(t){const e=e=>{e.stopPropagation(),e.preventDefault();const t=S.current.getBoundingClientRect(),n=t.width/t.height;u.ui({environment:h,renderFullScreenNode:()=>(0,p.jsx)(c.Z,{url:y,isAuthenticated:!0,permissionRecord:o,width:window.innerWidth,render:(e,t)=>(0,p.jsx)("img",{src:t,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",margin:0,alignSelf:"center",width:"100%"}})}),fullScreenNodeRect:t,contentAspectRatio:n,imageUrl:y})};return(0,p.jsx)("img",{ref:S,src:t,style:v.fileImageStyle,onClick:e},y)}}),[h,S,o,v.fileImageStyle,y]);if((0,l.SR)({url:y}))return(0,p.jsx)(c.Z,{url:y,isAuthenticated:!0,permissionRecord:o,width:20,render:b},y);return(0,p.jsx)("span",{style:v.fileTextStyle,onClick:e=>{e.stopPropagation(),a.Wl(h,{url:y,type:"file",from:"view_original",downloadName:m,permissionRecord:o})},children:m},y)}))},790692:(e,t,o)=>{o.d(t,{Z:()=>u});var n=o(667294),r=o(724405),i=o(984619),l=o(125845),s=o(508606),a=o(785893);const u=n.memo((function(e){const{recordPointer:t,parentStore:o,linkify:u,withComma:c}=e,{isReadOnly:d,shouldWrap:p,baseStyles:y,containerRef:m}=(0,n.useContext)(s.O),f=(null==y?void 0:y.tokenFormat)??i.lo.Medium,h=(0,r.yK)((()=>({relationToken:{margin:0}})),[]);return(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)(l.Z,{blockId:t.id,isSingle:!1,parentStore:o,shouldWrap:p,format:f,style:h.relationToken,containingParentRef:m,clickTitleBehavior:u||d?"peek":void 0},t.id),c?", ":""]})}))},59580:(e,t,o)=>{o.d(t,{A:()=>u});var n=o(667294),r=o(724405),i=o(423512),l=o(56247),s=o(508606),a=o(785893);function u(e){var t;const{numberValue:o,numberFormat:u,withComma:c,isRightAligned:d}=e,{baseStyles:p,propertySchema:y,shouldRenderTooltip:m,shouldWrap:f}=(0,n.useContext)(s.O),h=y,S=(0,r.yK)((()=>{var e,t,o;const n="bar"===(null==h||null===(e=h.show_as)||void 0===e?void 0:e.type)||"ring"===(null==h||null===(t=h.show_as)||void 0===t?void 0:t.type);return{style:{...!n&&{display:void 0},..."bar"===(null==h||null===(o=h.show_as)||void 0===o?void 0:o.type)?{flex:"1 0 auto",justifyContent:d?"flex-end":void 0}:{},...!f&&{display:n?"inline-flex":"inline",textWrap:"nowrap"}},barStyle:"small"===(null==p?void 0:p.sizing)?{flexGrow:1,minWidth:48,maxWidth:120}:{flexGrow:1,minWidth:48,maxWidth:160}}}),[null==p?void 0:p.sizing,d,null==h||null===(t=h.show_as)||void 0===t?void 0:t.type,f]);return(0,a.jsx)(l.b,{style:S.style,barStyle:S.barStyle,progressSize:p.textLineHeight,numberValue:o,numberFormat:u||"number"===(null==h?void 0:h.type)&&(null==h?void 0:h.number_format)||i.dk,numberShowAs:null==h?void 0:h.show_as,shouldRenderTooltip:!m,withComma:c})}},818417:(e,t,o)=>{o.d(t,{H:()=>d});var n=o(667294),r=o(886628),i=o(724405),l=o(266897),s=o(984619),a=o(992864),u=o(508606),c=o(785893);const d=n.memo((function(e){var t;const{actorPointer:o,style:d,shouldShrink:p,withComma:y}=e,{store:m,baseStyles:f,shouldRenderTooltip:h,propertySchema:S}=(0,n.useContext)(u.O),x=(null==f?void 0:f.tokenFormat)??s.lo.Medium,v=(0,i.yK)((()=>({actorStyle:{margin:0,...d,...(null==f?void 0:f.tokenFormat)===s.lo.Inline&&{pointerEvents:"auto"}}})),[null==f?void 0:f.tokenFormat,d]),b=(0,r.VK)((()=>{const e=null==m?void 0:m.getRecordModel;if(e)return(0,l.Hl)({pointer:o,getRecordModel:e})}),[o,null==m?void 0:m.getRecordModel]);return void 0===b?null:(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(a.ZP,{actor:b,showRemoveButton:!1,format:x,isSingle:!1,shouldShrink:p,style:v.actorStyle,hasTooltip:!h||x===s.lo.Inline,tooltipHeader:null==S?void 0:S.name},null===(t=b.asActor)||void 0===t?void 0:t.id),y?", ":""]})}))},219629:(e,t,o)=>{o.d(t,{E1:()=>P,eL:()=>k,gZ:()=>w,vQ:()=>j});var n=o(667294),r=o(423512),i=o(709291),l=o(401898),s=o(825464),a=o(526388),u=o(508606),c=o(753876),d=o(469823),p=o(477729),y=o(481381),m=o(679074),f=o(790692),h=o(59580),S=o(818417),x=o(244731),v=o(177722),b=o(618746),g=o(983559),C=o(785893);const k={id:"empty",type:"empty",value:[["Empty"]]};function w(e){const{token:t,targetPropertySchema:o,blockStore:n,checkboxPropertyLabel:u,withComma:c,numberRightAlign:v}=e,{type:g,value:k}=t;switch(g){case"url":case"email":case"phone_number":return(0,C.jsx)(p.t,{textValue:k,type:g,useShortenedUrl:!1,withComma:c});case"checkbox":return(0,C.jsx)(d.n,{checked:k,propertyLabel:u,disabled:!0,withComma:c});case"number":return(0,C.jsx)(h.A,{numberValue:k,numberFormat:o&&"number_format"in o?null==o?void 0:o.number_format:r.dk,withComma:c,isRightAligned:v});case"date":return(0,C.jsx)(y.z,{dateValue:k,dateFormat:o&&"date_format"in o?o.date_format:void 0,timeFormat:o&&"time_format"in o?o.time_format:void 0,withComma:c});case"file":return(0,C.jsx)(m.e,{linkValue:k,permissionRecord:n.pointer});case"person":return(0,C.jsx)(S.H,{actorPointer:k,shouldShrink:!1,withComma:c});case"relation":return(0,C.jsx)(f.Z,{recordPointer:k,parentStore:n,linkify:!0,withComma:c});case"select":return(0,C.jsx)(x.J,{type:t.groupColor?"status":"select",value:k,groupColor:t.groupColor,color:t.color});case"text":return(0,C.jsx)(b.A,{textValue:k,parentStore:n,withComma:c,linkifyUrls:!0});case"empty":return(0,C.jsx)(a.Z,{render:e=>(0,C.jsx)("div",{style:{opacity:.8,cursor:"help"},...e,children:(0,C.jsx)(b.A,{textValue:k,parentStore:n,withComma:c,linkifyUrls:!0})}),renderTooltip:()=>(0,C.jsx)(i.FormattedMessage,{id:"propertyValueToken.emptyValueTooltip",defaultMessage:"Empty values aren't displayed but affect formula calculations."}),placement:s.u.Top,alignment:s.v.Center});default:return(0,l.t1)(g)}}function P(e){let{children:t,propertyType:o,rootPropertySchema:r,numberRightAlign:i}=e;const{shouldWrap:l}=(0,n.useContext)(u.O),s="number"===o&&i;return j(o,r)?(0,C.jsx)(v.Y,{style:l?{display:"flex",flexWrap:"wrap"}:void 0,isRightAligned:s,children:t}):(0,C.jsx)(g.K,{isRightAligned:s,children:t})}function j(e,t){var o,n;return void 0!==e&&"title"!==e&&(!!(0,c.A2)(e)&&("number"!==e||"bar"!==(null==t||null===(o=t.show_as)||void 0===o?void 0:o.type)&&"ring"!==(null==t||null===(n=t.show_as)||void 0===n?void 0:n.type)))}},244731:(e,t,o)=>{o.d(t,{J:()=>p});var n=o(667294),r=o(724405),i=o(984619),l=o(531701),s=o(137810),a=o(362896),u=o(685567),c=o(508606),d=o(785893);const p=n.memo((function(e){const{value:t,color:o,shouldShrink:p,type:y}=e,m="status"===y?e.groupColor??"default":void 0,f=(0,r.Fg)(),{baseStyles:h}=(0,n.useContext)(c.O),S=(null==h?void 0:h.tokenFormat)??i.lo.Medium,x=(0,r.yK)((()=>({token:{margin:0,...s.Z.textOverflowStyle}})),[]);if(!t)return null;const{textColor:v,backgroundColor:b}=(0,l.KR)(f,o??m),g="status"===y?o&&"default"!==o?o:m??"gray":void 0;return(0,d.jsx)(u.Z,{format:S,value:(0,d.jsx)(a.Z,{children:t}),color:v,backgroundColor:b,showRemoveButton:!1,shouldShrink:p,isRound:"status"===y,isSingle:!1,showColoredDot:g,style:x.token,showFullValueTooltip:!1})}))},69582:(e,t,o)=>{o.d(t,{P:()=>h,w:()=>S});o(667294);var n=o(724405),r=o(984619),i=o(569651),l=o(222686),s=o(733653),a=o(76233),u=o(709291),c=o(401898),d=o(93044),p=o(177722),y=o(785893);const m="20px",f=(0,u.defineMessages)({me:{id:"templateVariablePropertyValueComponent.templateVariables.text.me",defaultMessage:"Person who duplicated page"},now:s.o.nowText,today:s.o.todayText});function h(e){const t=(0,n.yK)((e=>({textWrapper:{lineHeight:m}})),[]);return(0,y.jsx)(p.Y,{fontColor:"light",style:t.textWrapper,children:(0,y.jsx)(S,{templateVariableType:e.templateVariableType})})}function S(e){const{templateVariableType:t,showRemoveButton:o,onRemove:s,style:p}=e,m=(0,u.useIntl)(),f=(0,n.yK)((e=>({uiToken:{background:e.outlineBlueButtonPressedBackground,color:e.blueColor,padding:"2px 4px",width:"max-content",...p||{}}})),[p]);return(0,y.jsx)(d.ZP,{format:r.lo.Medium,isSingle:!0,title:x(t,m),renderAvatar:()=>function(e){let t;(0,a.pJX)(e)?t=l.f:(0,a.tXA)(e)?t=i.C:(0,c.t1)(e);return t}(t)({width:12,height:12,marginRight:4}),shouldShrink:!0,onClickRemove:s,showRemoveButton:Boolean(o),style:f.uiToken})}function x(e,t){let o;return"me"===e?o=t.formatMessage(f.me):"now"===e?o=t.formatMessage(f.now):"today"===e?o=t.formatMessage(f.today):(0,c.t1)(e),o}},618746:(e,t,o)=>{o.d(t,{A:()=>v});var n=o(667294),r=o(800480),i=o(886628),l=o(724405),s=o(180951),a=o(512549),u=o(23867),c=o(76233),d=o(360682),p=o(849616),y=o(214976),m=o(319385),f=o(469316),h=o(316354),S=o(508606),x=o(785893);const v=n.memo((function(e){const{parentStore:t,withComma:o,linkifyUrls:v}=e;let{textValue:b}=e;const g=(0,r.O7)(),C=(0,l.Fg)(),k=(0,d.kw)();(0,n.useEffect)((()=>{void 0!==b&&g.KatexStore.loadIfNeeded((()=>b))}),[g.KatexStore,b]);const{collectionContextStore:w,property:P}=(0,n.useContext)(S.O),{collectionViewBlockId:j,collectionViewId:_}=(0,i.VK)((()=>{var e,t;return{collectionViewId:null==w||null===(e=w.collectionViewStore())||void 0===e?void 0:e.id,collectionViewBlockId:null==w||null===(t=w.collectionViewBlockStore())||void 0===t?void 0:t.id}}),[w]),R=(0,i.VK)((()=>m.default.checkGate({gateName:"native-find-in-page"})),[]),{isInPageFindOpen:M,inPageFindQuery:B}=(0,i.VK)((()=>({isInPageFindOpen:f.Z.state.open,inPageFindQuery:f.Z.state.findQuery})),[]),V=(0,i.VK)((()=>{if(!(R&&M&&P&&b))return b;return y.cD({textValue:b,blockId:e.parentStore.id,textProps:{type:"page_property_value_match",collectionViewBlockId:j,collectionViewId:_,propertyId:P},find:B})}),[R,M,P,b,e.parentStore.id,j,_,B]);b=V;const T=(0,i.VK)((()=>g.KatexStore.getKatex()),[g.KatexStore]),O=(0,i.VK)((()=>void 0===b?null:y.IY({environment:g,textValue:b&&{value:b,spaceId:(0,u.C)(t.pointer.spaceId)},parentStore:t,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disabled:!0,theme:C,emojiType:k,katex:T,formulaValueTypes:[],stopLinkPropagation:!0,linkTargetBlank:!0})),[k,g,T,t,b,C]),A=(0,n.useMemo)((()=>{if(!v||void 0===b)return null;const e=(0,c.Jcv)(b);return(0,a.Z)(e)?(0,s.zB)(b):null}),[v,b]);return(0,x.jsxs)("span",{children:[A?(0,x.jsx)(h.Z,{href:A,style:{display:"inline",pointerEvents:"auto",...(0,p.z0)(C)},external:!0,onClick:e=>e.stopPropagation(),children:O}):O,o?", ":null]})}))},177722:(e,t,o)=>{o.d(t,{Y:()=>s});var n=o(667294),r=o(724405),i=o(508606),l=o(785893);const s=n.forwardRef((function(e,t){let{children:o,fontColor:s,style:a,isRightAligned:u}=e;const{baseStyles:c}=(0,n.useContext)(i.O),d=(0,r.yK)((e=>({textStyle:{...c.textStyle,...a,...u?{justifyContent:"right",textAlign:"right"}:{},..."light"===s?{color:e.lightTextColor}:{}}})),[c.textStyle,a,u,s]);return(0,l.jsx)("div",{ref:t,style:d.textStyle,children:o})}))},983559:(e,t,o)=>{o.d(t,{K:()=>s});var n=o(667294),r=o(724405),i=o(508606),l=o(785893);const s=n.forwardRef((function(e,t){let{children:o,style:s,isRightAligned:a}=e;const{baseStyles:u}=(0,n.useContext)(i.O),c=(0,r.yK)((()=>({tokenWrapStyle:{...u.tokenWrapStyle,...a?{justifyContent:"end"}:void 0,...s}})),[u.tokenWrapStyle,s,a]);return(0,l.jsx)("div",{ref:t,style:c.tokenWrapStyle,children:o})}))},165473:(e,t,o)=>{o.d(t,{Z:()=>E});var n=o(667294),r=o(800480),i=o(886628),l=o(724405),s=o(743664),a=o(691851),u=o(128651),c=o(212534),d=o(80444),p=o(164921),y=o(636596),m=o(785893);function f(){const e=(0,l.yK)((e=>({outer:{display:"inline-flex",overflow:"hidden",position:"relative",width:"100%"},inner:{width:"60%",height:10,borderRadius:12,backgroundColor:e.lightDividerColor}})),[]);return(0,m.jsx)("div",{style:e.outer,children:(0,m.jsx)(y.Z,{style:{...e.inner}})})}var h=o(222491),S=o(151454),x=o(508606),v=o(278030);const b=6;function g(e){const{style:t,children:o,align:n,sticky:r}=e,i=(0,l.yK)((()=>({buttonWrapperStyle:{display:"flex",justifyContent:"right"===n?"end":"start",position:"absolute",top:4,right:0,left:0,zIndex:S.XP,margin:`0 ${b}px`,pointerEvents:"none",...t},innerWrapperStyle:{display:"flex",gap:"4px",pointerEvents:"auto"},stickyStyle:{position:"sticky",right:b}})),[n,t]);return o?(0,m.jsx)("div",{style:i.buttonWrapperStyle,children:(0,m.jsx)("div",{...(0,h.iv)(i.innerWrapperStyle,r&&i.stickyStyle),children:o})}):null}function C(e){const{format:t,align:o}=e;switch(t){case v.C.Table:return(0,m.jsx)(_,{...e,align:o??"right"});case v.C.Page:return(0,m.jsx)(w,{...e,align:o??"right"});case v.C.Board:return(0,m.jsx)(k,{...e,align:o??"right"});case v.C.GalleryView:return(0,m.jsx)(P,{...e,align:o??"right"});case v.C.ListView:return(0,m.jsx)(j,{...e,align:o??"right"});default:return(0,m.jsx)(g,{...e,align:o??"right"})}}function k(e){const t=(0,l.yK)((()=>({buttonWrapperStyle:{top:0,...e.style}})),[e.style]);return(0,m.jsx)(g,{...e,style:t.buttonWrapperStyle})}function w(e){const t=(0,l.yK)((()=>({buttonWrapperStyle:{top:5,...e.style}})),[e.style]);return(0,m.jsx)(g,{...e,style:t.buttonWrapperStyle})}function P(e){const t=(0,l.yK)((()=>({buttonWrapperStyle:{top:-1,...e.style}})),[e.style]);return(0,m.jsx)(g,{...e,style:t.buttonWrapperStyle})}function j(e){const t=(0,l.yK)((()=>({buttonWrapperStyle:{position:void 0,...e.style}})),[e.style]);return(0,m.jsx)(g,{...e,style:t.buttonWrapperStyle})}function _(e){const{align:t="right"}=e,{isMobile:o}=(0,r.Fy)(),{shouldWrap:i,propertyFormat:s}=(0,n.useContext)(x.O),a=null==s?void 0:s.width,u=(0,n.useMemo)((()=>a&&a<50?2:a&&a<=32?0:b),[a]),c=(0,l.yK)((()=>({buttonWrapperStyle:{...e.style,...o&&i?{position:"sticky",float:t,marginRight:0,marginLeft:2,right:u}:{margin:`0 ${u}px`}}})),[t,u,o,e.style,i]);return(0,m.jsx)(g,{...e,style:c.buttonWrapperStyle,sticky:!0})}var R=o(709291),M=o(825464),B=o(526388);function V(e){const{propertyValue:t,propertyCaption:o,render:r}=e,{propertySchema:s,format:a,shouldRenderTooltip:u,isExternallyImportedAndSyncedPage:c,collectionContextStore:d}=(0,n.useContext)(x.O),p=(0,i.VK)((()=>{var e;const t=null==d||null===(e=d.collectionStore())||void 0===e?void 0:e.getFormat();return null==t?void 0:t.external_collection_type}),[d]),y=null==s?void 0:s.name,f=!u,h=a===v.C.Board||a===v.C.GalleryView,S=(null==y?void 0:y.length)&&!f,b=void 0!==t,g=void 0!==o,C=S||b||g,k=(0,l.yK)((e=>({value:{color:S?e.mediumInvertedTextColor:void 0},caption:{color:S||b?e.mediumInvertedTextColor:void 0}})),[S,b]),w=(0,n.useCallback)((()=>c&&a===v.C.Page&&p?(0,m.jsx)(R.FormattedMessage,{defaultMessage:"Data synced from {integration} cannot be edited",id:"BlockPropertyButtonTooltip.externalImportAndSync.title",values:{integration:p}}):(0,m.jsxs)(m.Fragment,{children:[S&&(0,m.jsx)("div",{children:y}),b&&(0,m.jsx)("div",{style:k.value,children:t}),g&&(0,m.jsx)("span",{style:k.caption,children:o})]})),[g,S,b,o,y,t,k.caption,k.value,c,p,a]);return C?(0,m.jsx)(B.Z,{renderTooltip:w,render:e=>r(e),placement:h?M.u.Left:M.u.Bottom}):r()}var T=o(311061);const O=n.memo((0,n.forwardRef)((function(e,t){const{tooltipPropertyValue:o,tooltipPropertyCaption:n,tooltipHide:r}=e,i=o=>(0,m.jsx)(I,{ref:t,...e,tooltipEvents:o});return r?i():(0,m.jsx)(V,{propertyValue:o,propertyCaption:n,render:i})})));function A(e){if(null==e||!e.padding)return;if("number"==typeof e.padding)return`${e.padding}px ${e.padding}px ${e.padding}px 0`;const t=e.padding.split(" ");if(1===t.length){const e=t[0].replace("px","");return`${e}px ${e}px ${e}px 0`}if(2===t.length){const e=t[0].replace("px","");return`${e}px ${t[1].replace("px","")}px ${e}px 0`}if(3===t.length){return`${t[0].replace("px","")}px ${t[1].replace("px","")}px ${t[2].replace("px","")}px 0`}if(4===t.length){return`${t[0].replace("px","")}px ${t[1].replace("px","")}px ${t[2].replace("px","")}px 0`}return e.padding}const I=(0,n.forwardRef)((function(e,t){const o=(0,r.O7)(),{device:y}=o,h=(0,i.qz)(void 0,u.Z),{style:S,quickActionButtons:v,quickActionButtonsAlign:b,quickActionButtonsForceVisible:g,editButtonClickProps:k}=e,{collectionContextStore:w,format:P,isReadOnly:j,store:_,propertyIndex:R,shouldShowMultiSelectCheckbox:M}=(0,n.useContext)(x.O),{tooltipPhase:B,nextTooltipPhase:V}=(0,n.useContext)(T.J),O=(0,i.VK)((()=>{var e,t;const o=null==w?void 0:w.collectionStore(),n=null==o?void 0:o.isSyncedCollection();return Boolean(n&&!(null!=_&&null!==(e=_.getFormat())&&void 0!==e&&null!==(e=e.attributes)&&void 0!==e&&e.length)&&!(null!=_&&null!==(t=_.getFormat())&&void 0!==t&&t.error))}),[w,_]),I=(0,l.yK)((()=>({buttonStyle:{position:"relative",...S,...0===R&&M?{padding:A(S)}:{}}})),[S,R,M]),E=(0,i.VK)((()=>h.state.mouseEntered),[h]),K=(0,n.useCallback)((()=>{h.setState({...h.state,mouseEntered:!0})}),[h]),F=(0,n.useCallback)((()=>{h.setState({...h.state,mouseEntered:!1})}),[h]),Z=(0,n.useRef)(null),H=e=>{Z.current=e,"function"==typeof t?t(e):t&&(t.current=e)},L=(0,i.VK)((()=>({...e.quickActionButtonsStyle,..."list"===(null==w?void 0:w.getViewType())?{margin:0}:{}})),[e.quickActionButtonsStyle,w]),N=(0,n.useMemo)((()=>{if(!v)return null;return(void 0!==g?g:E||y.isMobile)?(0,m.jsx)(C,{align:b,style:L,format:P,containerRef:Z,children:v}):void 0}),[v,g,E,y.isMobile,b,L,P]);return O?(0,m.jsx)("div",{style:I.buttonStyle,children:(0,m.jsx)(f,{})}):j||void 0===k?(0,m.jsxs)("div",{ref:H,style:I.buttonStyle,onMouseMove:K,onMouseLeave:F,...e.tooltipEvents,children:[N,e.children]}):(0,m.jsxs)(p.Z,{ref:H,hoveredStyle:e.hoveredStyle,pressedStyle:e.pressedStyle,style:I.buttonStyle,onMouseMove:K,onMouseLeave:F,onContextMenu:t=>{const{onContextMenu:o}=e;y.isAndroid&&y.isPhone?t.preventDefault():o&&(0,c.ZP)({event:t,context:c.Af.EditorContextMenu,callback:()=>{o(t)}})},onClick:async e=>{if(void 0===k)return;const{onClick:t,store:n,property:r,format:i,collectionStore:l,blockPropertyValueOverlayStore:u,disableHorizontalEdgeScroll:c,isStatusCheckbox:p}=k;await s.z({element:Z.current??void 0,environment:o,onClick:t,store:n,property:l.getMappedProperty(r),format:i,collectionStore:l,blockPropertyValueOverlayStore:u,disableHorizontalEdgeScroll:c,collectionContextStore:w,mouseStore:h,statusSetCheckbox:p?!e.altKey:void 0});const{currentUserSettingsStore:y,currentSpaceStore:m}=d.default.state;void 0!==y&&void 0!==m&&void 0!==B&&void 0!==V&&a.uR({environment:o,requiredCurrPhase:B,nextPhase:V,currentUserSettingsStore:y,currentSpaceStore:m})},testId:"property-value",...e.tooltipEvents,children:[N,e.children]})})),E=O},311061:(e,t,o)=>{o.d(t,{J:()=>m,O:()=>y});var n=o(667294),r=o(800480),i=o(886628),l=o(371663),s=o(940663),a=o(80444),u=o(791007),c=o(508606),d=o(785893);const p={[l.Es.Assign]:"assign_to_someone",[l.Es.Status]:"change_task_status",[l.Es.TaskToProjectRelation]:"select_a_project"};function y(e){const{store:t,collectionStore:o,property:y,children:m}=e,{isReadOnly:h}=(0,n.useContext)(c.O),S=(0,r.O7)(),x=(0,i.VK)((()=>{if(S.device.isMobile||t.pathIsDead()||h||o.getFormatStore().getKeyStore("app_config_uri").getValue()!==l.iS)return;const e=(0,s.jH)(a.default.state.currentUserSettingsStore,a.default.state.currentSpaceStore);return void 0===p[y]||p[y]!==e||t.getFormat().app_config_uri?void 0:e}),[S.device.isMobile,t,h,o,y]);return void 0!==x?(0,d.jsx)(f,{tooltipPhase:x,collectionStore:o,children:(0,d.jsx)(u.Z,{store:t,origin:m,isFirstTooltip:!1,phase:x})}):m}const m=(0,n.createContext)({tooltipPhase:void 0,nextTooltipPhase:void 0});function f(e){const{tooltipPhase:t,collectionStore:o,children:n}=e,r=(0,i.VK)((()=>{var e;const n=null===(e=o.getFormat().app_uri_map)||void 0===e?void 0:e[l.Es.TaskToProjectRelation],r=Boolean(n&&!o.getDeletedSchema()[n]);return(0,s.$j)(t,r)}),[o,t]);return(0,d.jsx)(m.Provider,{value:{tooltipPhase:t,nextTooltipPhase:r},children:n})}m.displayName="BlockPropertyIntroTourTooltipContext"},508606:(e,t,o)=>{o.d(t,{O:()=>v,Z:()=>b});var n=o(667294),r=o(800480),i=o(886628),l=o(598953),s=o(399036),a=o(180951),u=o(842875),c=o(76233),d=o(653965),p=o(566890),y=o(433929),m=o(60217),f=o(278030),h=o(824118),S=o(753876),x=o(785893);const v=(0,n.createContext)({collectionContextStore:void 0,propertySchema:void 0,property:void 0,propertyFormat:void 0,isEmpty:!1,isReadOnly:!0,shouldRenderTooltip:!1,shouldWrap:!1,baseStyles:{},format:0,containerRef:null,store:void 0,templateVariableContext:void 0,shouldShowMultiSelectCheckbox:void 0,propertyIndex:void 0});function b(e){const{format:t,children:o,disabled:b,store:C,tableWrap:k,collectionStore:w,property:P,unmappedProperty:j,propertySchema:_,shouldSetCellHeight:R,isLast:M,locked:B,containerRef:V,showIfEmpty:T,shouldShowMultiSelectCheckbox:O,propertyIndex:A,propertyModule:I}=e,E=(0,p.DK)(),K=(0,i.VK)((()=>!!E&&E.isInHomeWidgetStore.state),[E]),F=function(e,t,o,n){const l=(0,r.O7)();return(0,i.VK)((()=>{if(!e.isDefined())return!1;const r=t.getSchema(),i=null==n?void 0:n.type;return"checkbox"!==i&&"button"!==i&&"created_time"!==i&&"created_by"!==i&&"last_edited_time"!==i&&"last_edited_by"!==i&&"formula"!==i&&"rollup"!==i&&"auto_increment_id"!==i&&(0,a.wV)({block:e.getModel(),property:o,schema:r,getRecordModel:e.getRecordModel,userTimeZone:(0,u.r)(),intl:y.default.getIntl(),userId:l.currentUser.id})}),[t,l.currentUser.id,o,null==n?void 0:n.type,e],{debugName:"BlockPropertyValueContext.useIsEmpty"})}(C,w,P,_),Z=function(e,t,o,n,r,s){return(0,i.VK)((()=>n||!e.canEdit()||(0,l.w)(o)||(0,h.Sm)(s)||(0,h.M$)({collectionStore:t,property:o,propertySchema:s})||e.isNonEditableState()||r===f.C.Calendar||r===f.C.Timeline||(0,a.f0)(e.getModel(),o,e.getRecordModel)||(0,a.A0)(s)||t.isExternallyImportedAndSyncedCollection()),[n,r,o,s,e,t],{debugName:"BlockPropertyValueContext.useIsReadOnly"})}(C,w,P,b,t,_),H=(0,i.VK)((()=>null==E?void 0:E.getPropertyFormat(j??P)),[E,P,j]),L=function(e,t){return e===f.C.Page||e===f.C.CompactPage||e===f.C.Table&&t||e===f.C.Board&&t||e===f.C.GalleryView&&t}(t,k),N=(0,S.uo)({shouldSetCellHeight:R,format:t,shouldWrap:L,isLast:M,locked:B,disabled:b,showIfEmpty:T,isInHomeWidget:K}),D=function(e,t,o){return(0,i.VK)((()=>{if(!e.isDefined())return;if(!e.isTemplate())return;const n=null==o?void 0:o.type;if((0,s.fc)(n)){const o=e.getPropertyValue(t),n=d.Ps(o);if(n&&c.km_(n)){const e=c.QGY(c.hn0(n)),t=e&&c.fsE(e);return t&&{templateVariable:t.type}}}}),[t,o,e],{debugName:"BlockPropertyValueContext.useTemplateVariableContext"})}(C,P,_),U=(0,m.L2)(C),W=(0,n.useMemo)((()=>({store:C,collectionContextStore:E,property:P,propertySchema:_,propertyFormat:H,isEmpty:F,isReadOnly:Z,shouldRenderTooltip:g(t,U,F),shouldWrap:L,baseStyles:N,format:t,containerRef:V,templateVariableContext:D,shouldShowMultiSelectCheckbox:O,propertyIndex:A,isExternallyImportedAndSyncedPage:U,propertyModule:I})),[C,E,P,_,H,F,Z,t,U,L,N,V,D,O,A,I]);return(0,x.jsx)(v.Provider,{value:W,children:o})}function g(e,t,o){return!![f.C.Board,f.C.GalleryView,f.C.ListView,f.C.Relation,f.C.RelationSection].includes(e)||(e===f.C.Mini?!o:!(!t||!f.C.Page))}v.displayName="BlockPropertyValueContext"},278030:(e,t,o)=>{o.d(t,{C:()=>n});let n=function(e){return e[e.Table=0]="Table",e[e.Board=1]="Board",e[e.Calendar=2]="Calendar",e[e.ListView=3]="ListView",e[e.GalleryView=4]="GalleryView",e[e.Timeline=5]="Timeline",e[e.Page=6]="Page",e[e.CompactPage=7]="CompactPage",e[e.Relation=8]="Relation",e[e.RelationSection=9]="RelationSection",e[e.Mini=10]="Mini",e[e.PropertyModule=11]="PropertyModule",e[e.Form=12]="Form",e}({})},388071:(e,t,o)=>{o.d(t,{Z:()=>a});o(667294);var n=o(724405),r=o(984619),i=o(709291),l=o(785893);const s={[r.lo.ExtraSmall]:{height:14,fontSize:12,margin:"0 4px 0 0"},[r.lo.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0"},[r.lo.Medium]:{height:21,fontSize:14,margin:"0 12px 6px 0"},[r.lo.Inline]:{height:21,fontSize:14,margin:"0 12px 0 0"},[r.lo.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0"}};const a=function(e){const{count:t,format:o,fixedHeight:r,style:a,isCompact:u}=e,{margin:c,height:d,fontSize:p}=s[o],y=(0,n.yK)((e=>({wrapper:{display:"flex",alignItems:"center",lineHeight:1.2,borderRadius:4,fontSize:p,margin:c,color:e.mediumTextColor,...r&&{height:d},...a},compact:{whiteSpace:"nowrap"}})),[p,d,r,c,a]);return(0,l.jsx)("div",{style:y.wrapper,children:u?(0,l.jsx)("span",{style:y.compact,children:(0,l.jsx)(i.FormattedMessage,{defaultMessage:"+{thinSpace}{moreItemsCount}",id:"database.tokens.moreItems.message",values:{moreItemsCount:t,thinSpace:(0,l.jsx)("span",{children:""})}})}):(0,l.jsx)("span",{children:(0,l.jsx)(i.FormattedMessage,{defaultMessage:"{relationMoreItemsCount} more",id:"database.relationPropertyValue.moreItems.message",values:{relationMoreItemsCount:t}})})})}},939694:(e,t,o)=>{o.d(t,{Z:()=>v});var n=o(667294),r=o(800480),i=o(724405),l=o(318955),s=o(875553),a=o(709291),u=o(743664),c=o(680402),d=o(559183),p=o(566890),y=o(433929),m=o(573063),f=o(526388),h=o(508606),S=o(278030),x=o(785893);function v(e){const{store:t,schema:o,property:a,style:v,format:g}=e,C=(0,r.O7)(),k=(0,i.Fg)(),w=(0,p.DK)(),{isEmpty:P,propertySchema:j,isReadOnly:_}=(0,n.useContext)(h.O);if(void 0===j||P||C.device.isMobile&&!1===_||"checkbox"===(0,l.z6)(j))return null;const R=g===S.C.Table,M=y.default.formatMessage(b.copy);return(0,x.jsx)(f.Z,{renderTooltip:()=>M,render:e=>(0,x.jsx)("div",{onClick:()=>{let e;R&&(e=d.Z.getState(),c.MO()),u.r({environment:C,theme:k,store:t,schema:o,property:a,collectionContextStore:w}),R&&e&&d.Z.setState(e)},style:v,...e,children:(0,x.jsx)(m.Z,{ariaLabel:M,hasBackground:!0,icon:s.U,showShadow:!0})})})}const b=(0,a.defineMessages)({copy:{defaultMessage:"Copy to Clipboard",id:"database.copyButton.copyToClipboard"}})},824118:(e,t,o)=>{o.d(t,{Ae:()=>u,Am:()=>f,M$:()=>y,Sm:()=>c,bb:()=>m});var n=o(667294),r=o(371663),i=o(435011),l=o(180951),s=o(842875),a=o(433929);const u=["last_edited_by","created_by","last_edited_time","created_time","auto_increment_id","location"];function c(e){return!e||u.includes(e.type)}r.b0.Dates;const d={[r.b0.Dates]:{propertyId:r.b0.Dates,validationCheck:e=>{const{collectionStore:t}=e,o=t.getPropertyMapping(),n=null==o?void 0:o[r.b0.StatusV2];return Boolean(n)}}},p={date:[r.b0.Dates]};function y(e){const{collectionStore:t,property:o,propertySchema:n}=e;if(!n)return!0;const r=p[n.type]??[];for(const i of r){const e=d[i];if(!e.validationCheck({collectionStore:t}))continue;const n=t.getPropertyMapping(),r=null==n?void 0:n[e.propertyId];if(o===e.propertyId||o===r)return!0}return!1}function m(e){const{store:t,schema:o,property:n,userId:r}=e,u=o[n],c=null==u?void 0:u.type;return"checkbox"!==c&&"button"!==c&&"checkbox"!==(0,i.mm)(u)&&(!t.isDefined()||l.wV({block:t.getModel(),property:n,schema:o,getRecordModel:t.getRecordModel,userId:r,userTimeZone:(0,s.r)(),intl:a.default.getIntl()}))}function f(e,t){let{store:o,property:r,format:i,onClick:l,collectionStore:s,blockPropertyValueOverlayStore:a,disableHorizontalEdgeScroll:u}=e;return(0,n.useMemo)((()=>({store:o,property:r,format:i,onClick:l,collectionStore:s,blockPropertyValueOverlayStore:a,disableHorizontalEdgeScroll:u,isStatusCheckbox:null==t?void 0:t.isStatusCheckbox})),[a,s,u,i,null==t?void 0:t.isStatusCheckbox,l,r,o])}},753876:(e,t,o)=>{o.d(t,{A2:()=>P,Ac:()=>c,RQ:()=>R,ch:()=>g,e4:()=>_,sf:()=>k,uo:()=>M,z6:()=>a});var n=o(667294),r=o(800480),i=o(984619),l=o(401898),s=o(278030);const a="14px",u="12px",c=1.5,d=21,p=18,y=32,m=34,f=30,h=28,S=30,x=32,v=24,b=24,g=24,C=30,k={[s.C.Table]:{default:"6px 8px",text:"5px 8px",checkbox:"8px",button:"4px 8px"},[s.C.Page]:{default:"7px 8px",text:"6px 8px",checkbox:"9px 8px",button:"5px 8px"},[s.C.CompactPage]:{default:"5px 6px",text:"4px 8px",token:"5px 6px",checkbox:"7px 6px",button:"3px 6px"},[s.C.Board]:{default:"5px",text:"5px",checkbox:"5px",button:"4px"}},w=["title","text","email","phone_number","number","url","date","created_time","last_edited_time","auto_increment_id"];function P(e){return"empty"===e||w.includes(e)}const j=["button","file"];function _(e){return j.includes(e)}const R={[i.lo.Small]:{columnGap:6,rowGap:4},[i.lo.Medium]:{columnGap:8,rowGap:6},[i.lo.Inline]:{columnGap:6,rowGap:4}};function M(e){let{shouldSetCellHeight:t,format:o,shouldWrap:w,isLast:P,disabled:j,locked:_,showIfEmpty:M,isInHomeWidget:B}=e;const{isPhone:V}=(0,r.Fy)();return(0,n.useMemo)((()=>{switch(o){case s.C.Table:return{buttonStyle:{display:"block",fontSize:a,overflow:"clip",width:"100%",whiteSpace:w?"normal":"nowrap",height:t?y:void 0,minHeight:y,cursor:j||_?"default":"pointer",padding:k[s.C.Table].default},buttonHoveredStyle:{background:"unset"},buttonPressedStyle:{background:"unset"},textStyle:{lineHeight:c,whiteSpace:w?"pre-wrap":"nowrap",wordBreak:w?"break-word":"normal"},tokenWrapStyle:{display:"flex",flexWrap:w?"wrap":"nowrap",...R[i.lo.Medium]},textLineHeight:d,sizing:"default",tokenFormat:i.lo.Medium};case s.C.GalleryView:return{buttonStyle:{display:"flex",overflow:"hidden",alignItems:"center",borderRadius:5,margin:"0 6px 2px 6px",padding:"0 5px",fontSize:V?a:u,minHeight:b,whiteSpace:w?"normal":"nowrap",minWidth:M?"auto":"fit-content",width:M?"auto":"fit-content"},textStyle:{lineHeight:c,whiteSpace:w?"pre-wrap":"nowrap",wordBreak:w?"break-word":"normal",overflow:"hidden"},tokenWrapStyle:{display:"flex",minWidth:0,flexShrink:0,flexWrap:w?"wrap":"nowrap",width:w?"100%":void 0,...R[V?i.lo.Medium:i.lo.Small]},textLineHeight:V?d:p,sizing:V?"default":"small",tokenFormat:V?i.lo.Medium:i.lo.Small};case s.C.Board:return{buttonStyle:{display:"flex",overflow:"hidden",alignItems:"center",borderRadius:5,fontSize:u,margin:"0 6px 2px 6px",padding:k[s.C.Board].default,minHeight:h,whiteSpace:w?"normal":"nowrap",width:M?"auto":"fit-content"},textStyle:{lineHeight:c,whiteSpace:w?"pre-wrap":"nowrap",wordBreak:w?"break-word":"normal"},tokenWrapStyle:{display:"flex",flexWrap:w?"wrap":"nowrap",...R[i.lo.Small]},textLineHeight:p,sizing:"small",tokenFormat:i.lo.Small};case s.C.RelationSection:return{buttonStyle:{display:"inline-flex",fontSize:u,overflow:"hidden",alignItems:"center",marginLeft:0,minHeight:x,padding:"0 8px",borderRadius:5},tokenWrapStyle:{display:"flex",minWidth:0,...R[i.lo.Small]},textLineHeight:p,sizing:"small",tokenFormat:i.lo.Small};case s.C.Relation:return{buttonStyle:{fontSize:u,overflow:"hidden",alignItems:"center",padding:"0 4px",borderRadius:5,display:"flex",marginLeft:V?0:8,marginRight:V?8:0,height:v,minWidth:20},textStyle:{lineHeight:c,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},tokenWrapStyle:{display:"flex",minWidth:0,...R[i.lo.Small]},textLineHeight:p,sizing:"small",tokenFormat:i.lo.Small};case s.C.ListView:return{buttonStyle:{fontSize:u,overflow:"hidden",alignItems:"center",padding:"0 6px 0 8px",borderRadius:5,display:"flex",marginLeft:V?0:2,marginRight:V?2:0,minHeight:S,minWidth:20,...B?{maxWidth:"fit-content",flex:1}:{}},textStyle:{lineHeight:c,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},tokenWrapStyle:{display:"flex",minWidth:0,...R[i.lo.Inline]},textLineHeight:p,sizing:"small",tokenFormat:i.lo.Inline};case s.C.Page:return{buttonStyle:{fontSize:a,overflow:"hidden",display:"inline-block",borderRadius:4,width:"100%",minHeight:m,padding:k[s.C.Page].default},textStyle:{lineHeight:c,wordBreak:"break-word",whiteSpace:"pre-wrap"},tokenWrapStyle:{display:"flex",flexWrap:"wrap",...R[i.lo.Medium]},textLineHeight:d,sizing:"default",tokenFormat:i.lo.Medium};case s.C.Timeline:return{buttonStyle:{display:"flex",alignItems:"center",fontSize:u,marginRight:P?0:10},buttonHoveredStyle:{background:"unset"},buttonPressedStyle:{background:"unset"},textStyle:{lineHeight:c,wordBreak:"break-word",whiteSpace:"nowrap"},tokenWrapStyle:{display:"flex",minWidth:0,...R[i.lo.Small]},textLineHeight:p,sizing:"small",tokenFormat:i.lo.Inline};case s.C.Calendar:return{buttonStyle:{fontSize:u,display:"flex",alignItems:"center",height:g,whiteSpace:"nowrap",width:"100%"},textStyle:{lineHeight:c,whiteSpace:"nowrap",overflow:"hidden"},tokenWrapStyle:{display:"flex",flexShrink:0,flexWrap:"nowrap",...R[i.lo.Small]},textLineHeight:p,sizing:"small",tokenFormat:i.lo.Small};case s.C.CompactPage:return{buttonStyle:{fontSize:a,overflow:"hidden",alignItems:"center",borderRadius:4,display:"flex",width:"100%",minHeight:f,padding:k[s.C.CompactPage].default},textStyle:{lineHeight:c,wordBreak:"break-word",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},tokenWrapStyle:{display:"flex",flexWrap:"nowrap",overflow:"hidden",alignItems:"center",...R[i.lo.Medium]},textLineHeight:d,sizing:"default",tokenFormat:i.lo.Medium};case s.C.Mini:return{buttonStyle:{fontSize:a,overflow:"hidden",alignItems:"center",borderRadius:4,display:"flex",padding:"0 6px",minWidth:0,height:C},textStyle:{lineHeight:c,wordBreak:"break-word",whiteSpace:"nowrap",textOverflow:"ellipsis"},tokenWrapStyle:{display:"flex",flexWrap:"nowrap",overflow:"hidden",alignItems:"center",...R[i.lo.Medium]},textLineHeight:d,sizing:"default",tokenFormat:i.lo.Medium};case s.C.PropertyModule:return{buttonStyle:{fontSize:a,overflow:"hidden",display:"inline-block",borderRadius:4,width:"100%",minHeight:m,padding:k[s.C.Page].default},textStyle:{lineHeight:c,wordBreak:"break-word",whiteSpace:"pre-wrap"},tokenWrapStyle:{display:"flex",flexWrap:"wrap",...R[i.lo.Medium]},textLineHeight:d,sizing:"default",tokenFormat:i.lo.Medium};case s.C.Form:return{};default:(0,l.t1)(o)}}),[j,o,B,P,V,_,t,w,M])}}}]);