"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[65670],{115100:(e,t,i)=>{i.d(t,{Sl:()=>w,TA:()=>F,Zg:()=>S,a2:()=>x,eT:()=>M,mk:()=>y});i(21703),i(757658),i(667294);var s=i(145953),r=i(421202),a=i(709291),n=i(937850),o=i(454642),l=i(547307),d=i(296994),c=i(457345),u=i(28578),h=i(788632),p=i(206258),b=i(629026),f=i(461175),m=i(363815),g=i(785893);const v=50;function S(e){m.Z.resetSitesForSpace(e.id)}async function y(e,t){const{spaceStore:i,currentUserId:a,limit:l}=t;if(!i.id)return;const[d]=await Promise.all([o.getPublishedPagesForUser(e,{spaceId:i.id,limit:l||v,fetchPublishedMetadata:!0}),(0,n.Vs)(1500)]);if("failed"===d.type)throw new Error("Failed to fetch published pages.");if(d.data.recordMap){const e=[],t=s.PF.create(d.data.recordMap),n=d.data.publishedEdits;for(const{model:s}of t)if(s&&s.table===r.iU){const t=p.G.createChildStore(i,{table:r.iU,id:s.id}),a=n[t.id],o=a&&a.authors?a.authors[0]:void 0,l={publishedTime:null==a?void 0:a.timestamp,publishedBy:o};e.push({store:t,publishedMetadata:l})}let o=e;return a&&(o=f.S(e,a)),m.Z.initializeSiteResultsForSpace(i.id,o),o}}async function w(e,t){const{spaceStore:i}=t,s=e.currentUser.id,r=await y(e,{spaceStore:i,currentUserId:s});return r?r.filter((e=>e.publishedMetadata.publishedBy===s)):[]}function F(e){c.lG(e),u.ZP.setState({...u.ZP.state,display:u.wV.Publish,tab:u.XF.Publish})}async function M(e){return new Promise(((t,i)=>{l.showDialog({message:(0,g.jsx)("div",{style:{textAlign:"center"},children:(0,g.jsx)(a.FormattedMessage,{id:"sites.confirmUnpublish.title",defaultMessage:"Unpublish this site?"})}),description:(0,g.jsx)("div",{style:{textAlign:"center"},children:(0,g.jsx)(a.FormattedMessage,{id:"sites.confirmUnpublish.caption",defaultMessage:"{pageTitle} will no longer be live on the web.",values:{pageTitle:e}})}),keepFocus:!0,items:[{label:(0,g.jsx)(a.FormattedMessage,{id:"sites.confirmUnpublish.confirm",defaultMessage:"Unpublish"}),color:"red",onAccept:()=>t(!0)}],showCancel:!0})}))}async function x(e,t){if(!h.Z.state.online)return[];const i=await d.FF.searchActions.load();return await i.searchPublicPages({environment:t,query:e,source:"public_home_page_menu",limit:b.Xv})}},864302:(e,t,i)=>{i.r(t),i.d(t,{default:()=>u});i(667294);var s=i(800480),r=i(886628),a=i(791754),n=i(772770),o=i(170060),l=i(461175),d=i(759475),c=i(785893);function u(e){const{blockStore:t}=e,i=(0,s.O7)(),u=(0,r.VK)((()=>(0,l.N)({environment:i,store:t})),[i,t]),h=(0,r.VK)((()=>(0,o.$V)()),[]);if(!u)return(0,c.jsx)(c.Fragment,{});const p=(0,c.jsx)(d.Z,{blockStore:t,legacyColor:n.v.LightBlue});return h?(0,c.jsx)("div",{style:{position:"sticky",left:0,right:"100%",width:"100%"},children:p}):(0,c.jsx)("div",{style:{position:"sticky",left:0,right:"100%",width:"100%"},children:(0,c.jsx)(a.Z,{styleKey:n.v.LightBlue,shouldUseDivider:!1,isMobile:!1,children:(0,c.jsx)(d.Z,{blockStore:t,legacyColor:n.v.LightBlue})})})}},461175:(e,t,i)=>{i.d(t,{N:()=>n,S:()=>a});var s=i(772141),r=i(367669);function a(e,t){return e.sort(((e,i)=>{const s=e.store.canAdmin();if(s===i.store.canAdmin()){var r,a;const s=null===(r=e.publishedMetadata.publishedBy)||void 0===r?void 0:r.id,n=e.publishedMetadata.publishedTime,o=null===(a=i.publishedMetadata.publishedBy)||void 0===a?void 0:a.id,l=i.publishedMetadata.publishedTime;if(t){if(s===t&&o===t&&n&&l)return l-n;if(s===t)return-1;if(o===t)return 1}return n&&l?l-n:0}return s?-1:1}))}function n(e){const{environment:t,store:i}=e;if(!i.pathIsAccessibleAndAlive())return!1;return!!r.YO(i).find((e=>(0,s.$D)(e.permissionItem)&&"none"!==e.permissionItem.role))&&!r.IJ(t,i)}},363815:(e,t,i)=>{i.d(t,{Z:()=>l});var s=i(749085),r=i(76233),a=i(653965),n=i(206258);class o extends s.default{getInitialState(){return{sites:{},sortAscending:!0,sortColumn:void 0}}initializeSiteResultsForSpace(e,t){this.state.sites[e]=t,this.emit()}getSortedSitesForSpace(e,t){const{sortAscending:i,sortColumn:s}=this.state,o=this.state.sites[e];if(o)switch(s){case"page":return a.Xo(o,(e=>r.QaF(e.store.getTitleValue()).toLowerCase()),i?"asc":"desc");case"published-by":return a.Xo(o,(e=>{const i=e.publishedMetadata.publishedBy,s=i?n.t1.createChildStore(e.store,i):void 0;return null==s?void 0:s.getDisplayName(t).toLowerCase()}),i?"asc":"desc");case"published-date":return a.Xo(o,(e=>e.publishedMetadata.publishedTime),i?"asc":"desc");default:return o}}removeSiteFromSpace(e,t){const i=this.state.sites[e];i&&(this.state.sites[e]=i.filter((e=>e.store.id!==t)),this.emit())}resetSitesForSpace(e){this.state.sites[e]=void 0}}const l=new o}}]);