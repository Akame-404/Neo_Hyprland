"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[67197],{982119:(e,t,o)=>{o.r(t),o.d(t,{default:()=>de,propertiesWidth:()=>ne,scrollArrowLeftOffset:()=>oe,scrollArrowLeftOffsetAnimatePx:()=>re});var r=o(667294),n=o(883355),i=o(800480),s=o(886628),l=o(724405),a=o(815145),c=o(576205),d=o(654497),u=o(151454),h=o(709291),p=o(653965),g=o(137810),S=o(42239),m=o(524677),y=o(210228),f=o(110906),v=o(4827),x=o(396310),b=o(278030),C=o(244831),k=o(241137),P=o(584076),M=o(731278),D=o(776798),w=o(279954),R=o(965187),V=o(843250),I=o(397004),T=o(277181),O=o(484210),j=o(249394),L=o(268056),N=o(305971),F=o(95802),_=o(80444),E=o(319385),A=o(896049),B=o(924666),K=o(429657),H=o(504430),$=o(343350),Z=o(706685),z=o(177546),q=o(785893);const W=24;function U(e){const{store:t,schema:o,timelineState:n,dateValueStore:a,collectionContextStore:c,isFullScreen:d,isRootChild:u}=e,h=(0,r.useRef)(null),[p,g]=(0,r.useState)(!1),S=(0,i.O7)(),m=(0,s.VK)((()=>{const e=n.drawState.state;if(e)return e.startStore===t}),[t,n.drawState]),f=(0,s.VK)((()=>!m&&n.hoveredItem.state===t&&!A.Z.state),[m,t,n.hoveredItem]),v=(0,s.VK)((()=>(0,H.H5)(c)),[c]),x=(0,r.useCallback)((e=>{if(e.preventDefault(),!n.scrollLeft.state||!h.current)return;const r=(0,z.VW)(h.current);K.J4({timelineState:n,store:t,startX:e.startX,startY:e.startY,schema:o,collectionContextStore:c,verticalScroller:r}),g(!1)}),[c,o,t,n]),b=(0,r.useCallback)((e=>{if(!h.current)return;const t=(0,z.VW)(h.current);K.mz({timelineState:n,currentX:e.currentX,currentY:e.currentY,verticalScroller:t})}),[n]),C=(0,r.useCallback)((()=>{y.createAndCommit({userAction:"TimelineItemDependencyDrawHandle.handleDraggableDragEnd",environment:S,perform:e=>{K.$o({timelineState:n,environment:S,transaction:e,collectionContextStore:c,isFullScreen:d,isRootChild:u})}})}),[S,n,c,d,u]),k=(0,r.useCallback)((e=>{K.x({timelineState:n,environment:S})}),[S,n]),P=(0,r.useCallback)((()=>{g(!0)}),[g]),M=(0,r.useCallback)((()=>{g(!1)}),[g]),D=(0,l.yK)((e=>({draggableStyle:{position:"absolute",top:0,right:-W,width:W,height:"100%",zIndex:1},draggableSvgStyle:{position:"absolute",left:0,cursor:"pointer"},svgPathStyle:{stroke:v?e.collectionValidDependencyArrow:e.collectionUnsetDependencyArrow,strokeWidth:H.lf},svgCircleFill:{color:e.white}})),[v]),w=(0,r.useCallback)((e=>{if(!a.state)return;return(0,q.jsx)("div",{ref:h,style:D.draggableStyle,...e,children:f&&(0,q.jsx)(q.Fragment,{children:(0,q.jsx)("div",{style:D.draggableSvgStyle,children:(0,q.jsxs)("svg",{style:{width:22,height:30},onMouseMove:P,onMouseLeave:M,children:[(0,q.jsx)($.Z,{startPoint:{x:0,y:14},endPoint:{x:10,y:14},style:D.svgPathStyle,showArrowHead:p}),(0,q.jsx)("circle",{cx:p?10+H.S7:10,cy:14,r:p?H.S7:H.Wk,style:D.svgPathStyle,fill:D.svgCircleFill.color})]})})})})}),[a,M,P,f,D.draggableStyle,D.draggableSvgStyle,D.svgCircleFill.color,D.svgPathStyle,p]);return(0,q.jsx)(Z.Z,{render:w,onDraggableDragStart:x,onDraggableDragMove:b,onDraggableDragEnd:C,onDraggableDragCancel:k})}var X=o(926249),Y=o(436610);const Q={position:"absolute",top:0,right:-6,width:8,height:"100%",zIndex:1,cursor:"col-resize"},G={position:"absolute",top:0,left:-6,width:8,height:"100%",zIndex:1,cursor:"col-resize"};function J(e){let{type:t,store:o,query:n,schema:a,timelineState:c,dateValueStore:d,collectionContextStore:u,isInPeekRenderer:p,isFullScreen:g,isRootChild:S}=e;const m=(0,i.O7)(),f=(0,h.useIntl)(),[v,b]=(0,r.useState)(!1),C=(0,s.VK)((()=>{const e=c.dragState.state;return e?e.stores[0]===o&&("left"===t?e.type===H.px.LeftResizer:e.type===H.px.RightResizer):v&&!A.Z.state}),[v,o,c,t]),k=(0,s.VK)((()=>d.state),[d]),P=(0,s.VK)((()=>c.zoomLevel.state),[c]),M=(0,l.yK)((e=>{const t={position:"absolute",top:6,borderRadius:3,width:3,bottom:6,background:e.regularTextColor},o={fontSize:12,position:"absolute",width:200,lineHeight:`${x.Z}px`,pointerEvents:"none"};return{leftDraggableIndicator:{...t,left:Math.ceil(3.5)+1},rightDraggableIndicator:{...t,left:Math.floor(.5)},leftDraggableLabel:{...o,right:12,textAlign:"right"},rightDraggableLabel:{...o,left:12},timelineBackground:{background:p?e.peekTimelineBackground:e.timelineBackground,padding:4,borderRadius:4}}}),[p]),D=(0,r.useCallback)((()=>b(!0)),[]),w=(0,r.useCallback)((()=>b(!1)),[]),R=(0,r.useCallback)((e=>{K.td({timelineState:c,currentX:e.currentX})}),[c]),V=(0,r.useCallback)((()=>{y.createAndCommit({userAction:"TimelineItemResizer.handleDraggableDragEnd",environment:m,perform:e=>{K.fX({timelineState:c,collectionContextStore:u,query:n,schema:a,intl:f,environment:m,transaction:e})}}),Y.ne(m,{...(0,H.Ii)({environment:m,collectionContextStore:u,timelineState:c,isFullScreen:g,isRootChild:S}),type:t})}),[u,m,f,g,S,n,a,c,t]),I=(0,r.useCallback)((e=>{e.preventDefault(),K.f$({timelineState:c,store:o,startX:e.startX,type:"left"===t?H.px.LeftResizer:H.px.RightResizer,query:n,schema:a,intl:f,environment:m})}),[m,f,n,a,o,c,t]),T=(0,r.useCallback)((()=>{K.cQ({timelineState:c,environment:m})}),[m,c]),O=(0,r.useCallback)((e=>{const o="left"===t;if(k)return(0,q.jsx)("div",{style:o?G:Q,onMouseMove:D,onMouseLeave:w,...e,children:C&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("div",{style:o?M.leftDraggableIndicator:M.rightDraggableIndicator}),(0,q.jsx)("span",{style:o?M.leftDraggableLabel:M.rightDraggableLabel,children:(0,q.jsx)("span",{style:M.timelineBackground,children:o?(0,H.yk)(k,P):(0,H.fc)(k,P)})})]})})}),[k,P,w,D,C,M,t]);return(0,q.jsx)(Z.Z,{render:O,onDraggableDragStart:I,onDraggableDragMove:R,onDraggableDragEnd:V,onDraggableDragCancel:T})}const ee=r.memo(J,X.Z),te=(0,h.defineMessages)({typeAName:{defaultMessage:"Type a nameâ€¦",id:"timelineItem.itemName.placeholder"}}),oe=21,re=48,ne=800,ie=400,se=4;var le=function(e){return e[e.Absolute=0]="Absolute",e[e.Sticky=1]="Sticky",e}(le||{});class ae extends n.Z{constructor(){super(...arguments),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderProperty=(e,t)=>(0,q.jsx)(De,{showProperties:this.props.showProperties,store:this.props.store,disabled:this.props.disabled,blockPropertyValueOverlayStore:this.props.blockPropertyValueOverlayStore,clonedStore:this.props.clonedStore,collectionContextStore:this.props.collectionContextStore,parentStore:this.props.parentStore,editingTitle:this.editingTitleStore.state,property:e,index:t},e),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDateRangeButtonMouseMove=()=>ke(this.environment,this.props.store,this.props.timelineState,this.isDrawingDependencyStore.state),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDateRangeButtonMouseLeave=()=>Pe(this.props.timelineState,this.isDrawingDependencyStore.state),this.handleAnimationStateChange=()=>{var e;const t=null===(e=this.props.propertiesWrapElementRef)||void 0===e?void 0:e.current,o=this.animationStateStore.state;t&&o&&(t.style.position=o.position===le.Absolute?"absolute":"sticky",t.style.left=`${o.left}px`)},this.pageURLStore=this.createComputedStore((()=>{const{store:e}=this.props;if(e)return(0,O.ZP)({store:e,fullyQualified:!1,pageVisitSource:a.tY.LinkInPage})})),this.peekURLStore=this.createComputedStore((()=>{const{store:e,collectionContextStore:t}=this.props,{mainEditorCurrentBlockStore:o}=_.default.state;if(e&&o)return f.mb({store:e,mainEditorCurrentBlockStore:o,collectionContextStore:t,fullyQualified:!1})})),this.isHoveredStore=this.createComputedStore((()=>{const{store:e,timelineState:t}=this.props;return t.hoveredItem.state===e})),this.isDrawingDependencyStore=this.createComputedStore((()=>{const{store:e,timelineState:t}=this.props,o=t.drawState.state;return o&&o.startStore!==e})),this.editingTitleStore=this.createComputedStore((()=>{var e;const{store:t}=this.props,o=B.default.state;if("editing"!==o.mode)return!1;const r=null===(e=(0,L.QY)(o.multiSelection))||void 0===e?void 0:e.store;return t&&r&&r===t.getBlockTitleStore()})),this.animationStateStore=this.createComputedStore((()=>{const{timelineState:e,scrollerLeftOffset:t,itemPositionStore:o}=this.props,r=o.state;if(r){const{left:o,right:n}=r,i=n-o;if(!((0,H.Tp)(this.environment)&&i>50))return{position:le.Absolute,left:o};{const r=e.scrollLeft.state;if(void 0!==r){const e=r+t-o+oe;if(e<0)return{position:le.Absolute,left:o};if(e>i)return{position:le.Absolute,left:n};if(e>0)return{position:le.Sticky,left:t+oe}}}}})),this.passesFilterStore=this.createComputedStore((()=>{var e,t;const o=this.props.parentStore,r=(0,I.m1)({collectionContextStore:this.props.collectionContextStore,collectionStore:o,environment:this.environment}),n=null===(e=this.props.store)||void 0===e?void 0:e.getModel(),i=null===(t=this.props.store)||void 0===t?void 0:t.getRecordModel;if(!r||!n||!i)return!0;const s=E.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs");return(0,c.q)(r)({block:n,getRecordModel:i,propertyMapping:null==o?void 0:o.getPropertyMapping(),formulaTimeoutTimestampMs:Date.now()+s,resultCache:new Map})})),this.shouldShowHighlightHaloStore=this.createComputedStore((()=>!!this.props.store&&f.Sc(this.props.store))),this.isTypedMSVCollectionStore=this.createComputedStore((()=>"collectionTypedView"===this.props.collectionContextStore.contextType))}didMount(){super.didMount(),this.animationStateStore.addListener(this.handleAnimationStateChange),this.handleAnimationStateChange()}willUnmount(){super.willUnmount(),this.animationStateStore.removeListener(this.handleAnimationStateChange)}UNSAFE_willUpdate(){this.animationStateStore.enqueueRecompute()}renderComponent(){const{itemPositionStore:e,store:t,timelineState:o,query:r,schema:n,dateValueStore:i,disabled:s,isDraggingViaTimelineItemStore:l,collectionContextStore:a,isFullScreen:c,isRootChild:d}=this.props,u=e.state;if(!u)return;const h=(0,H.H5)(a),{left:p,right:g,maskPercent:S}=u,m=this.isHoveredStore.state,y=this.pageURLStore.state,v=this.peekURLStore.state,x=!s&&(null==t?void 0:t.canEdit()),b=this.environment.device.isPhone,C=x&&!b&&(h||a.permissionScopesStore.state.canConfigureBlock)&&!this.isTypedMSVCollectionStore.state,k=a.currentSubitemFormatStoreForUiDisplayStore.state?42:10,M=Math.max(g-p,k)+1,D=l.state,R=(0,q.jsx)(ge,{collectionContextStore:this.props.collectionContextStore,toggleButton:this.props.toggleButton,itemPositionStore:this.props.itemPositionStore}),I=this.passesFilterStore.state,T=a.isInHomeWidgetStore.state;return t&&!u.isPlaceholder?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(w.Z,{style:Se(p,M,D,u,I,this.props.isInPeekRenderer,this.theme),haloStyle:(O=this.theme,j=this.shouldShowHighlightHaloStore,{borderRadius:se,...f.pB(j.state,O)}),className:V.ovr,store:t,canSelect:!0,shouldShowHalo:!T,shouldForceRenderSelectionHalo:this.shouldShowHighlightHaloStore.state,canDrag:x,analyticsName:"timeline",onDraggableDragStart:me,onDraggableDragMove:e=>fe(e,this.props.store,this.props.timelineState,this.props.query,this.props.schema,this.props.intl,this.environment),onDraggableDragEnd:()=>ve(this.props.timelineState,this.props.collectionContextStore,this.props.query,this.props.schema,this.props.intl,this.environment),onDraggableDragCancel:()=>xe(this.props.timelineState,this.environment),canTriggerContextMenu:x,getGhostElement:ye,disableScrollToReveal:!0,onMouseMove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDateRangeButtonMouseMove,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDateRangeButtonMouseLeave,showBlockMenuInput:!0,children:[R,(0,q.jsx)(P.Z,{style:ue(),innerStyle:he(),onClick:this.props.handleOpenPeekPage,href:y,metaHref:v,hovered:m,ignoreLocalHoverState:!0}),C&&this.props.store&&(0,q.jsx)(U,{store:this.props.store,isFullScreen:this.props.isFullScreen,isRootChild:this.props.isRootChild,schema:this.props.schema,timelineState:this.props.timelineState,dateValueStore:this.props.dateValueStore,collectionContextStore:this.props.collectionContextStore}),x&&!b&&(0,q.jsx)(ee,{type:"left",store:t,query:r,schema:n,timelineState:o,dateValueStore:i,collectionContextStore:a,isFullScreen:c,isInPeekRenderer:this.props.isInPeekRenderer,isRootChild:d}),x&&!b&&(0,q.jsx)(ee,{type:"right",store:t,query:r,schema:n,timelineState:o,dateValueStore:i,collectionContextStore:a,isFullScreen:c,isInPeekRenderer:this.props.isInPeekRenderer,isRootChild:d})]}),this.renderProperties(S,D,I)]}):(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("div",{style:Se(p,M,D,u,I,this.props.isInPeekRenderer,this.theme),className:V.ovr}),this.renderProperties(S,D,I)]});var O,j}renderProperties(e,t,o){const{showProperties:r}=this.props;return(0,q.jsx)("div",{style:Ce(e,t,o,this.isHoveredStore),children:(0,q.jsx)("div",{style:pe(this.props.collectionContextStore,this.props.toggleButton),ref:this.props.propertiesWrapElementRef,className:V.z_z,children:r.map(this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderProperty)})})}}function ce(e){const{timelineState:t,scrollerLeftOffset:o,itemPositionStore:n,store:d,query:p,schema:g,dateValueStore:S,disabled:m,isDraggingViaTimelineItemStore:y,collectionContextStore:v,isFullScreen:b,isRootChild:C,parentStore:k,toggleButton:M,isInPeekRenderer:D,handleOpenPeekPage:R,showProperties:T,clonedStore:j,blockPropertyValueOverlayStore:N,propertiesWrapElementRef:F}=e,A=(0,i.O7)(),K=(0,h.useIntl)(),$=(0,s.VK)((()=>n.state),[n]),Z=(0,s.VK)((()=>{if($){const{left:e,right:r}=$,n=r-e;if(!((0,H.Tp)(A)&&n>50))return{position:le.Absolute,left:e};{const i=t.scrollLeft.state;if(void 0!==i){const t=i+o-e+oe;if(t<0)return{position:le.Absolute,left:e};if(t>n)return{position:le.Absolute,left:r};if(t>0)return{position:le.Sticky,left:o+oe}}}}}),[A,$,o,t.scrollLeft]),z=(0,s.VK)((()=>{var e;const t=B.default.state;if("editing"!==t.mode)return!1;const o=null===(e=(0,L.QY)(t.multiSelection))||void 0===e?void 0:e.store;return d&&o&&o===d.getBlockTitleStore()}),[d]),W=(0,s.VK)((()=>(0,H.H5)(v)),[v]),X=(0,s.VK)((()=>t.hoveredItem.state===d),[d,t.hoveredItem]),Y=(0,s.VK)((()=>{const{mainEditorCurrentBlockStore:e}=_.default.state;if(d&&e)return f.mb({store:d,mainEditorCurrentBlockStore:e,collectionContextStore:v,fullyQualified:!1})}),[v,d]),Q=(0,s.VK)((()=>{if(d)return(0,O.ZP)({store:d,fullyQualified:!1,pageVisitSource:a.tY.LinkInPage})}),[d]),G=(0,s.VK)((()=>!m&&(null==d?void 0:d.canEdit())),[m,d]),J=(0,i.MO)(),te=(0,s.VK)((()=>"collectionTypedView"===v.contextType),[v]),re=(0,s.VK)((()=>G&&!J&&(W||v.permissionScopesStore.state.canConfigureBlock)&&!te),[G,v.permissionScopesStore,J,te,W]),ie=(0,s.VK)((()=>v.currentSubitemFormatStoreForUiDisplayStore.state),[v]),ae=ie?42:10,ce=$?Math.max($.right-$.left,ae)+1:ae+1,de=(0,s.VK)((()=>y.state),[y]),pe=(0,s.VK)((()=>{const e=k,t=(0,I.m1)({collectionContextStore:v,collectionStore:e,environment:A}),o=null==d?void 0:d.getModel(),r=null==d?void 0:d.getRecordModel;if(!t||!o||!r)return!0;const n=E.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs");return(0,c.q)(t)({block:o,getRecordModel:r,propertyMapping:null==e?void 0:e.getPropertyMapping(),formulaTimeoutTimestampMs:Date.now()+n,resultCache:new Map})}),[v,A,k,d]),Se=(0,s.VK)((()=>v.isInHomeWidgetStore.state),[v.isInHomeWidgetStore]),be=(0,s.VK)((()=>!!d&&f.Sc(d)),[d]),Ce=(0,s.VK)((()=>{const e=t.drawState.state;return e&&e.startStore!==d}),[d,t.drawState]),Me=(0,r.useMemo)((()=>(0,q.jsx)(ge,{collectionContextStore:v,toggleButton:M,itemPositionStore:n})),[v,n,M]),we=(0,l.yK)((e=>({container:{position:"absolute",left:null==$?void 0:$.left,marginTop:1,marginBottom:1,width:ce,height:x.Z-2,borderRadius:se,display:"flex",...null!=$&&$.isExistingSubitemPlaceholder?void 0:{..."light"===e.mode?{background:null!=$&&$.isPlaceholder?e.buttonHoveredBackground:e.contentBackground,boxShadow:null!=$&&$.isPlaceholder?void 0:e.buttonBoxShadow}:{background:D?e.calendarItemBackground:e.popoverBackground,boxShadow:null!=$&&$.isPlaceholder?void 0:e.lightBoxShadow}},...(null==$?void 0:$.isPlaceholder)&&{cursor:"crosshair"},...de&&{display:"none"},...!pe&&{opacity:.5},zIndex:u.ov},halo:{borderRadius:se,...f.pB(be,e)},propertiesContainer:{width:"100%",WebkitMaskImage:null!=$&&$.maskPercent&&(null==$?void 0:$.maskPercent)<1&&X?`linear-gradient(90deg, rgba(0,0,0,1) ${100*$.maskPercent}%, rgba(0,0,0,0.4) ${100*$.maskPercent}%)`:void 0,pointerEvents:"none",...de&&{display:"none"},zIndex:u.ov,opacity:pe?1:.5},propertiesWrapInnerStyle:{display:"flex",height:x.Z-2+1,paddingLeft:ie&&Me?24:6,width:ne,overflow:"hidden"}})),[de,X,D,pe,$,be,ie,Me,ce]),Re=(0,r.useCallback)((()=>{const e=null==F?void 0:F.current,t=Z;e&&t&&(e.style.position=t.position===le.Absolute?"absolute":"sticky",e.style.left=`${t.left}px`)}),[Z,F]),Ve=(0,r.useCallback)((()=>(0,q.jsx)("div",{style:we.propertiesContainer,children:(0,q.jsx)("div",{style:we.propertiesWrapInnerStyle,ref:F,className:V.z_z,children:T.map(((e,t)=>(0,q.jsx)(De,{showProperties:T,store:d,disabled:m,blockPropertyValueOverlayStore:N,clonedStore:j,collectionContextStore:v,parentStore:k,editingTitle:z,property:e,index:t},e)))})})),[N,j,v,m,z,k,F,T,d,we]);return(0,r.useEffect)((()=>{Re()}),[Z,Re]),$?!d||null!=$&&$.isPlaceholder?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("div",{style:we.container,className:V.ovr}),Ve()]}):(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(w.Z,{style:we.container,haloStyle:we.halo,className:V.ovr,store:d,canSelect:!0,shouldShowHalo:!Se,shouldForceRenderSelectionHalo:be,canDrag:G,analyticsName:"timeline",onDraggableDragStart:me,onDraggableDragMove:e=>fe(e,d,t,p,g,K,A),onDraggableDragEnd:()=>ve(t,v,p,g,K,A),onDraggableDragCancel:()=>xe(t,A),canTriggerContextMenu:G,getGhostElement:ye,disableScrollToReveal:!0,onMouseMove:()=>ke(A,d,t,Ce),onMouseLeave:()=>Pe(t,Ce),showBlockMenuInput:!0,children:[Me,(0,q.jsx)(P.Z,{style:ue(),innerStyle:he(),onClick:R,href:Q,metaHref:Y,hovered:X,ignoreLocalHoverState:!0}),re&&d&&(0,q.jsx)(U,{store:d,isFullScreen:b,isRootChild:C,schema:g,timelineState:t,dateValueStore:S,collectionContextStore:v}),G&&!J&&(0,q.jsx)(ee,{type:"left",store:d,query:p,schema:g,timelineState:t,dateValueStore:S,collectionContextStore:v,isFullScreen:b,isInPeekRenderer:D,isRootChild:C}),G&&!J&&(0,q.jsx)(ee,{type:"right",store:d,query:p,schema:g,timelineState:t,dateValueStore:S,collectionContextStore:v,isFullScreen:b,isInPeekRenderer:D,isRootChild:C})]}),Ve()]}):null}ae.displayName="TimelineItemDateRangeClass";const de=r.memo((function(e){return(0,N.E)("timeline_item_date_range_functional")?(0,q.jsx)(ce,{...e}):(0,q.jsx)(ae,{...e})}));function ue(){return{width:"100%",height:"100%",borderRadius:se}}function he(){return{width:"100%",height:"100%",display:"flex",paddingLeft:6,paddingRight:6,borderRadius:se}}function pe(e,t){const o=e.currentSubitemFormatStoreForUiDisplayStore.state;return{display:"flex",height:x.Z-2+1,paddingLeft:o&&t?24:6,width:ne,overflow:"hidden"}}function ge(e){let{collectionContextStore:t,toggleButton:o,itemPositionStore:r}=e;const n=(0,s.VK)((()=>t.currentSubitemFormatStoreForUiDisplayStore.state),[t]),i=(0,s.VK)((()=>r.state),[r]);return!n||!o||null!=i&&i.isExistingSubitemPlaceholder?null:(0,q.jsx)("span",{style:{zIndex:1,paddingTop:3},children:o})}function Se(e,t,o,r,n,i,s){const l=s.mode;return{position:"absolute",left:e,marginTop:1,marginBottom:1,width:t,height:x.Z-2,borderRadius:se,display:"flex",...r.isExistingSubitemPlaceholder?void 0:{..."light"===l?{background:r.isPlaceholder?s.buttonHoveredBackground:s.contentBackground,boxShadow:r.isPlaceholder?void 0:s.buttonBoxShadow}:{background:i?s.calendarItemBackground:s.popoverBackground,boxShadow:r.isPlaceholder?void 0:s.lightBoxShadow}},...r.isPlaceholder&&{cursor:"crosshair"},...o&&{display:"none"},...!n&&{opacity:.5},zIndex:u.ov}}function me(e){e.preventDefault()}function ye(e){const t=F.C.findSelectablesFromStore(e),o=p.oA(t.map((e=>e.getNode()))),r=p.oA(o.map((e=>e.closest(`.${V.o4s}`))))[0];if(r){const e=S.eN(r),t=e.cloned.querySelector(`.${V.ovr}`),o=e.cloned.querySelector(`.${V.z_z}`);return t&&o&&"sticky"===o.style.position&&(o.style.position="absolute",o.style.left=t.style.left),[e]}return o.map(S.eN)}function fe(e,t,o,r,n,i,s){t&&(o.dragState.state||K.f$({timelineState:o,store:t,startX:e.startX,type:H.px.ItemDrag,query:r,schema:n,intl:i,environment:s}),K.td({timelineState:o,currentX:e.currentX}))}function ve(e,t,o,r,n,i){y.createAndCommit({userAction:"TimelineItemDateRange.handleSelectableDragEnd",environment:i,perform:s=>{K.fX({timelineState:e,collectionContextStore:t,query:o,schema:r,intl:n,environment:i,transaction:s})}})}function xe(e,t){K.cQ({timelineState:e,environment:t})}function be(e,t){e&&m.Ys({environment:t,store:e})}function Ce(e,t,o,r){return{width:"100%",WebkitMaskImage:e<1&&r.state?`linear-gradient(90deg, rgba(0,0,0,1) ${100*e}%, rgba(0,0,0,0.4) ${100*e}%)`:void 0,pointerEvents:"none",...t&&{display:"none"},zIndex:u.ov,opacity:o?1:.5}}function ke(e,t,o,r){const n=o.dragState.state;(A.Z.state||n)&&!r||e.device.isPhone||o.hoveredItem.setState(t)}function Pe(e,t){const o=e.dragState.state;(A.Z.state||o)&&!t||e.hoveredItem.setState(void 0)}function Me(e){let{isLast:t,store:o,collectionContextStore:r,parentStore:n,editingTitle:a}=e;const c=(0,l.Fg)(),u=(0,i.O7)(),S=(0,h.useIntl)(),m=(0,s.VK)((()=>null==o?void 0:o.getIcon()),[o]),y=(0,s.VK)((()=>null==r?void 0:r.shouldShowPageIcon()),[r]),f=(0,s.VK)((()=>null==o?void 0:o.hasError()),[o]),v=(0,s.VK)((()=>!o||o.isEmptyPage()),[o]),x=(0,s.VK)((()=>r.currentSubitemFormatStoreForUiDisplayStore.state),[r]),b=(0,s.VK)((()=>{var e;return x&&n?null===(e=n.getSchema()[x.property])||void 0===e?void 0:e.name:""}),[n,x]),P=(0,s.VK)((()=>null==o?void 0:o.getBlockTitleStore()),[o]),w=(0,s.VK)((()=>o&&(0,T.Cr)({collectionContextStore:r,blockId:o.id,blockStore:o})),[r,o]),V=(0,s.VK)((()=>o&&(0,T.wI)({collectionContextStore:r,blockStore:o})),[r,o]);return(0,q.jsxs)("div",{style:{display:"flex",marginRight:t?0:10,fontSize:14,fontWeight:g.Z.fontWeight.medium,alignItems:"center"},children:[y&&m&&!f&&(0,q.jsx)(M.Z,{disabled:!0,icon:m,isEmptyPage:v,size:20,style:{marginLeft:2,marginRight:6}}),f&&(0,d.t)({display:"inline-block",verticalAlign:"text-top",marginLeft:4,marginRight:7,width:16,fill:c.accentColors.orange[500]}),o&&!a&&(0,q.jsx)(D.Z,{style:{whiteSpace:"nowrap",maxWidth:ie},store:o}),a&&o&&P&&(0,q.jsx)(R.Z,{store:P,style:{whiteSpace:u.device.isFirefox?"pre":"nowrap"},disabled:!1,disableSlashCommands:!0,disableEmojiCommands:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableEmbedMenu:!0,onEnter:()=>be(o,u),onEsc:()=>be(o,u),onTab:p.yR,placeholder:S.formatMessage(te.typeAName),disableSelectAllBlocks:!0,pasteBehavior:"inline",inPageFind:j.B3.none}),o&&w&&(0,q.jsx)("div",{style:{paddingTop:2,paddingLeft:4},children:(0,q.jsx)(C.O,{blockStore:o,collectionContextStore:r})}),o&&V&&(0,q.jsx)("div",{style:{paddingTop:2,paddingLeft:8,color:c.lightTextColor},children:(0,q.jsx)(k.B,{blockStore:o,collectionContextStore:r})}),!o&&(0,q.jsx)("span",{children:n&&b?(0,q.jsx)(h.FormattedMessage,{defaultMessage:"New page in {propertyName}",id:"timeline.itemPlaceholder.nest.addSubitemWithPropertyName",values:{propertyName:b}}):(0,q.jsx)(h.FormattedMessage,{id:"timeline.itemPlaceholder.newPage",defaultMessage:"New page"})})]},"title")}function De(e){let{property:t,index:o,showProperties:r,store:n,disabled:i,blockPropertyValueOverlayStore:l,clonedStore:a,collectionContextStore:c,parentStore:d,editingTitle:u}=e;const h=o===r.length-1,p=(0,s.VK)((()=>null==n?void 0:n.getAssociatedCollectionStore()),[n]),g=(0,s.VK)((()=>null==n?void 0:n.canEdit()),[n]),S=(0,s.VK)((()=>c.collectionViewStore()),[c]);return p?"title"===t?(0,q.jsx)(Me,{store:n,collectionContextStore:c,parentStore:d,editingTitle:u,isLast:h}):n&&a?(0,q.jsx)(v.Z,{store:a,property:t,disabled:i||!g,locked:!1,format:b.C.Timeline,tableWrap:!1,isLast:h,blockPropertyValueOverlayStore:l,enablePointerEventsForInteractiveTypes:!0,collectionStore:p,collectionViewStore:S},t):null:null}},343350:(e,t,o)=>{o.d(t,{Z:()=>s});o(667294);var r=o(504430);o(757658);var n=o(785893);const i=16;function s(e){const{startPoint:t,endPoint:o,style:i,showArrowHead:s,useRightAngles:c,cornerRadiusOverride:d,handleMouseMove:u,handleMouseLeave:h}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a,{startPoint:t,startCurvePoint:c?void 0:{x:t.x+r.i2,y:t.y},endPoint:s?{x:o.x-1.5,y:o.y}:o,endCurvePoint:c?void 0:{x:o.x-r.i2,y:o.y},cornerRadiusOverride:d,style:i,handleMouseMove:u,handleMouseLeave:h,children:e.children}),s&&(0,n.jsx)(l,{endPoint:o,style:i})]})}function l(e){const{endPoint:t,style:o}=e;return(0,n.jsx)("polyline",{points:`${t.x-5},${t.y-6} ${t.x},${t.y} ${t.x-5},${t.y+6}`,style:o,fill:"transparent"})}function a(e){const{startPoint:t,startCurvePoint:o,endPoint:r,endCurvePoint:s,style:l,cornerRadiusOverride:a,handleMouseMove:c,handleMouseLeave:d}=e;let u="";u=o&&s?`M ${t.x} ${t.y} L ${o.x} ${o.y} L ${s.x} ${s.y} L ${r.x} ${r.y}`:`M ${t.x} ${t.y} L ${t.x} ${r.y} L ${r.x} ${r.y}`;const h=function(e,t){function o(e,t,o){const n=t.x-e.x,i=t.y-e.y,s=Math.sqrt(n*n+i*i);return r(e,t,Math.min(1,o/s))}function r(e,t,o){return{x:e.x+(t.x-e.x)*o,y:e.y+(t.y-e.y)*o}}function n(e,t){e.length>2&&(e[e.length-2]=t.x.toString(),e[e.length-1]=t.y.toString())}function i(e){return{x:parseFloat(e[e.length-2]),y:parseFloat(e[e.length-1])}}const s=e.split(/[,\s]/).reduce(((e,t)=>{const o=t.match("([a-zA-Z])(.+)");return o?(e.push(o[1]),e.push(o[2])):e.push(t),e}),[]).reduce((function(e,t){return!isNaN(parseFloat(t))&&e.length?e[e.length-1].push(t):e.push([t]),e}),[]);let l=[];if(s.length>1){const e=i(s[0]);let a=null;"Z"===s[s.length-1][0]&&s[0].length>2&&(a=["L",e.x.toString(),e.y.toString()],s[s.length-1]=a),l.push(s[0]);for(let c=1;c<s.length;c++){const e=l[l.length-1],d=s[c],u=d===a?s[1]:s[c+1];if(u&&e&&e.length>2&&"L"===d[0]&&u.length>2&&"L"===u[0]){const s=i(e),a=i(d),c=i(u),h=o(a,s,t),p=o(a,c,t);n(d,h),l.push(d);const g=r(h,a,.5),S=r(a,p,.5),m=["C",g.x.toString(),g.y.toString(),S.x.toString(),S.y.toString(),p.x.toString(),p.y.toString()];l.push(m)}else l.push(d)}if(a){const e=i(l[l.length-1]);l.push(["Z"]),n(l[0],e)}}else l=s;return l.reduce((function(e,t){return`${e}${t.join(" ")} `}),"")}(u,a||i);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:h,style:l,fill:"transparent"}),(c||d)&&(0,n.jsxs)("g",{onMouseMove:c,onMouseLeave:d,children:[(0,n.jsx)("path",{d:h,style:{strokeOpacity:0,strokeWidth:16,pointerEvents:"stroke",cursor:"default"},fill:"transparent"}),e.children]})]})}}}]);