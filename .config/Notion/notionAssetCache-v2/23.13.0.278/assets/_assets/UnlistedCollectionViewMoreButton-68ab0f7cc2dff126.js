"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[80582],{595193:(e,t,o)=>{o.d(t,{F:()=>a,U:()=>r});var i=o(800480),n=o(886628),l=o(460709);function r(e){return e.device.isPhone||"actionSheet"===e.tabletBehavior&&e.device.isTablet?{menuType:l.og.ActionSheet}:{menuType:l.og.Popup,maxHeight:e.maxHeight,maxWidth:e.maxWidth,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,width:e.width,minWidth:e.minWidth}}function a(e){const t=(0,i.Fy)();return(0,n.VK)((()=>r({device:t,maxHeight:null==e?void 0:e.maxHeight,maxWidth:null==e?void 0:e.maxWidth,paddingTop:null==e?void 0:e.paddingTop,paddingBottom:null==e?void 0:e.paddingBottom,width:null==e?void 0:e.width,minWidth:null==e?void 0:e.minWidth,tabletBehavior:null==e?void 0:e.tabletBehavior})),[t,null==e?void 0:e.maxHeight,null==e?void 0:e.maxWidth,null==e?void 0:e.paddingTop,null==e?void 0:e.paddingBottom,null==e?void 0:e.width,null==e?void 0:e.minWidth,null==e?void 0:e.tabletBehavior])}},435294:(e,t,o)=>{o.d(t,{d:()=>r});var i=o(800480),n=o(886628),l=o(953437);function r(e){const t=(0,i.Fy)();return(0,n.VK)((()=>t.isPhone||"slideUp"===(null==e?void 0:e.tabletBehavior)&&t.isTablet?l.kQ.SlideUp:l.kQ.Popup),[t,null==e?void 0:e.tabletBehavior])}},169258:(e,t,o)=>{o.r(t),o.d(t,{default:()=>F});var i=o(667294),n=o(800480),l=o(886628),r=o(724405),a=o(815145),c=o(509999),d=o(356666),s=o(747453),u=o(709291),m=o(401898),p=o(211302),h=o(608055),g=o(421202),v=o(213493),b=o(815047),x=o(709953),C=o(210228);var f=o(81598),y=o(595193),w=o(435294),S=o(484210),_=o(960709),k=o(552275),B=o(573063),T=o(478140),V=o(632163),I=o(953437),R=o(731278),W=o(776798),j=o(672495),M=o(888077),A=o(785893);const Z=(0,u.defineMessages)({moreButtonAriaLabel:{id:"unlistedCollectionView.moreButton.icon",defaultMessage:"More"}});function F(e){const{collectionContextStore:t}=e,o=(0,u.useIntl)(),n=i.useRef(null),[a,c]=i.useState(!1),s=(0,l.VK)((()=>t.isInHomeWidgetStore.state),[t]),m=i.useCallback((()=>{c(!a)}),[a]),p=(0,w.d)(),h=(0,r.yK)((e=>({icon:{width:18,height:void 0,fill:e.mediumIconColor},button:(0,M.C)({theme:e,isInHomeWidget:s})})),[s]);return(0,A.jsx)(I.ZP,{popupType:p,alignmentToOrigin:_.lU.End,placementToOrigin:_.Iw.Bottom,open:a,onDismiss:m,origin:(0,A.jsx)(B.Z,{ref:n,icon:d.o,ariaLabel:o.formatMessage(Z.moreButtonAriaLabel),onClick:m,iconStyle:h.icon,style:h.button}),render:()=>{var e;return(0,A.jsx)(H,{collectionContextStore:t,originRect:null===(e=n.current)||void 0===e?void 0:e.getBoundingClientRect()})}})}function H(e){const{collectionContextStore:t,originRect:o}=e,l=(0,n.O7)(),[r,a]=i.useState("origin"),c=i.useCallback((e=>{K({environment:l,blockStore:e})}),[l]),d=i.useCallback((()=>{a("copy");const e=function(e){const{environment:t,collectionContextStore:o}=e,i=t.currentUser.id,n=o.collectionViewStore(),l=o.collectionStore(),r=o.collectionViewBlockStore();if(!(i&&n&&r&&l))return;const a=l.getSpaceId(),c=n.getFormat(),d=n.getRawQuery(),s=l.pointer;return C.createAndCommit({environment:t,userAction:"copyCollectionViewToNewLinkedDatabase",perform:e=>{const o=x.j4({environment:t,transaction:e,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,type:"collection_view",useCrdt:r.useCrdt()}),n=x.ae({environment:t,table:v.np,value:{type:"table",parent_id:o.id,parent_table:g.iU,alive:!0,space_id:a,format:{table_properties:c.table_properties,timeline_arrows_by:void 0,table_subitem_toggle_column:"title",property_filters:c.property_filters,collection_pointer:s},query2:d},transaction:e,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache});return x.sW({store:o,data:{alive:!1,parent_id:a,parent_table:b.bx,view_ids:[n.id],permissions:[{type:"user_permission",role:"editor",user_id:i}]},transaction:e}),o}}).performResult}({environment:l,collectionContextStore:t});e&&p.bA({environment:l,blocks:[e],originRect:o,moveToContext:"ai_ephemeral_view",isAddTo:!0,isDefaultPrivateLocation:!0,forceShowPrivatePageOption:!0,onAccept:()=>{c(e)}})}),[l,t,o,c]);return"origin"===r?(0,A.jsx)(P,{collectionContextStore:t,onAddViewToClick:d}):"copy"===r?null:(0,m.t1)(r)}function P(e){const{collectionContextStore:t,onAddViewToClick:o}=e,{isMobile:i}=(0,n.Fy)(),a=(0,n.O7)(),d=(0,l.VK)((()=>t.collectionStore()),[t]),m=(0,l.VK)((()=>null==d?void 0:d.getIcon()),[d]),p=(0,l.VK)((()=>t.collectionViewBlockStore()),[t]),h=(0,r.yK)((e=>({icon:{color:e.regularIconColor,width:12,height:12},title:{display:"flex",alignItems:"center"},collectionIcon:{marginLeft:4,marginRight:2}})),[]),g=(0,y.F)({maxWidth:250}),v={key:"options",render:e=>(0,A.jsx)(j.Z,{...e}),items:[{key:"save",render:e=>(0,A.jsx)(k.Z,{...e,icon:(0,s.R)(h.icon),title:(0,A.jsx)(u.FormattedMessage,{id:"unlistedCollectionView.moreButton.save",defaultMessage:"Save as view inâ€¦"})}),action:()=>{o()}},{key:"open",render:e=>(0,A.jsx)(k.Z,{...e,icon:(0,c.J)(h.icon),title:(0,A.jsx)("div",{style:h.title,children:(0,A.jsx)(u.FormattedMessage,{id:"unlistedCollectionView.moreButton.open",defaultMessage:"Open {databaseName}",values:{databaseName:(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(R.Z,{isEmptyPage:!1,size:i?18:16,disabled:!0,icon:m,style:h.collectionIcon}),d&&(0,A.jsx)(W.Z,{store:d})]})}})})}),action:()=>{K({environment:a,blockStore:p})}}]};return(0,A.jsx)(T.Z,{...g,children:(0,A.jsx)(V.Z,{type:V.i.Vertical,initialFocus:0,sections:[v]})})}async function K(e){const{environment:t,blockStore:o}=e;if(!o)return;const i=(0,S.ZP)({store:o,pageVisitSource:a.tY.AIEphemeralView});h.c4({environment:t,url:i});const{modalOverlayCollectionListViewStore:n,assistantMenuActions:l}=await f.assistantDependency.load();n.close(),await l.closeAssistantRightHandSideMenu({environment:t})}},888077:(e,t,o)=>{o.d(t,{C:()=>n});var i=o(137810);function n(e){const{theme:t,isInHomeWidget:o}=e;return{display:"flex",alignItems:"center",fontSize:14,padding:6,...o?{height:24,width:24,color:t.lightTextColor,fill:t.lightIconColor}:{height:28,width:28,color:t.mediumIconColor,fill:t.mediumIconColor},fontWeight:i.Z.fontWeight.regular,lineHeight:1,borderRadius:4}}}}]);