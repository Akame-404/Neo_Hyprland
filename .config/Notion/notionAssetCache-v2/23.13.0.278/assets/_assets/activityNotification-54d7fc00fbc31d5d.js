"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[6215,72510],{948298:(e,t,i)=>{i.d(t,{Vy:()=>S,YN:()=>b,fJ:()=>y,kj:()=>M,mY:()=>x});i(252262),i(324506);var o=i(458129),s=i(815047),n=i(519889),r=i(653965),a=i(891219),d=i(781918),l=i(454642),c=i(476464),u=i(709953),m=i(210228),g=i(215010),p=i(893586),h=i(206258),v=i(598905),f=i(897630);async function b(e){const{environment:t,store:i,status:o,requests:s}=e,a=t.currentUser.id;d.VM(t,{status:o,user_count:s.length,from:e.from,request_type:"member"});const l=await Promise.all(s.map((e=>A(t,{id:e.getForActorId(),table:n.KJ})))).then((e=>(0,r.oA)(e)));if("approved"===o){const e=l.map((e=>({type:"existingUser",value:e.__IM_SORRY__getValue(),spaceRole:"read_and_write"})));if(!(await c.n_({environment:t,store:i,inviteTargets:e,inviteRole:"read_and_write",isOnboarding:!1,invite:{inviteOrigin:"membership_request"}})).success)return{failedUsers:l,resolvedUsers:[]}}return m.createAndCommit({userAction:"accessRequestActions.resolveMembershipRequests",environment:t,perform:e=>{s.map((i=>{const s=new h.oK(t,i.pointer);u.sW({store:s,transaction:e,data:{granted_time:Date.now(),granted_by_table:n.KJ,granted_by_id:a,resolved_time:Date.now(),resolved_by_table:n.KJ,resolved_by_id:a,status:o}})}))}}),{failedUsers:[],resolvedUsers:l}}async function y(e){const{environment:t,store:i,status:o,requests:s}=e,l=t.currentUser.id;d.VM(t,{status:o,user_count:s.length,from:e.from,request_type:"member"});const g=await Promise.all(s.map((e=>A(t,{id:e.getForActorId(),table:n.KJ})))).then((e=>(0,r.oA)(e)));if("approved"===o){const e=g.map((e=>({type:"existingUser",value:e.__IM_SORRY__getValue(),spaceRole:"read_and_write"})));if(!(await c.n_({environment:t,store:i,inviteTargets:e,inviteRole:"read_and_write",isOnboarding:!1,invite:{inviteOrigin:"membership_request"}})).success)return{failedUsers:g,resolvedUsers:[]};const o=i.id,s=await p.Z.awaitData(t,{spaceId:o}),n=s?s.map((e=>e.url)):[];a.oI(t,{invite_flow_id:void 0,invite_origin:"membership_request",user_ids:g.map((e=>e.id)),internal_domains:n})}return m.createAndCommit({userAction:"accessRequestActions.resolveMembershipRequests",environment:t,perform:e=>{s.map((i=>{const s=new h.oK(t,i.pointer);u.sW({store:s,transaction:e,data:{granted_time:Date.now(),granted_by_table:n.KJ,granted_by_id:l,resolved_time:Date.now(),resolved_by_table:n.KJ,resolved_by_id:l,status:o,type:"space_membership_request"}})}))}}),{failedUsers:[],resolvedUsers:g}}async function x(e){const{environment:t,status:i,requests:o,from:s}=e;d.VM(t,{status:i,user_count:o.length,from:s,request_type:"guest"});const c=await Promise.all(o.map((async e=>{var o,r,c;const u=await A(t,{id:e.getForActorId(),table:n.KJ});if(!u)return{type:"failed",user:void 0};if(!e.isGuestInviteRequest())return{type:"failed",user:u};const m=await l.resolveAccessRequest(t,{accessRequestId:e.id,status:i,spaceId:e.getParentId()}),p=null===(o=e.getAttributes().permission_records_and_roles.at(0))||void 0===o?void 0:o.role,h=null===(r=e.getAttributes().permission_records_and_roles.at(0))||void 0===r?void 0:r.id,v=(null===(c=e.getAttributes().invite_message)||void 0===c?void 0:c.length)??0;return"success"===m.type&&"approved"===i&&a.jB(t,{role:p,is_space:!1,invite_targets:[{type:"existingUser",value:{id:u.id,version:0,email:u.getEmail()},spaceRole:"none"}],is_onboarding:!1,invite_origin:"guest_invite_request",permission_items:[{type:"user_permission",role:p,user_id:u.id}],invite_message_length:v,domainType:(0,g.JF)()}),"success"===m.type&&d.Cg(t,{status:i,request_id:e.id,for_actor_id:e.getForActorId(),created_by_id:e.getCreatedById(),requested_page_id:h,requested_role:p,from:s}),{type:m.type,user:u}})));await f.bi(t);const u=c.filter((e=>"failed"===e.type)).map((e=>e.user)),m=c.filter((e=>"success"===e.type)).map((e=>e.user));return{failedUsers:(0,r.oA)(u),resolvedUsers:(0,r.oA)(m)}}async function M(e){if(v.Z.reset(),!e.canAdmin)return;const{environment:t,spaceId:i}=e,o=await l.getUnreadAccessRequestCount(t,{parentTable:s.bx,parentId:i,size:1});"success"===o.type&&v.Z.setState({spaceId:i,count:o.data.count})}async function S(e,t,i){const s=function(e){return Object.values((0,r.vM)(e,(e=>function(e){if(e.isGuestInviteRequest()){const t=e.getAttributes().permission_records_and_roles[0];return`guest_invite_${e.getForActorId()}:${null==t?void 0:t.id}:${e.getCreatedById()}`}return e.isSpaceMembershipRequest()?`space_membership_${e.getForActorId()}:${e.getCreatedById()}}`:e.isTeamMembershipRequest()?void 0:void e.isPageAccessRequest()}(e)))).map((e=>(0,r.MR)(e,(e=>e.getCreatedTime()))[0]))}(await Promise.all(i.map((async t=>{const i=o.J8,s=new h.oK(e,{table:i,id:t});return await s.load(),s.getModel()}))).then((e=>(0,r.oA)(e)))),a=await function(e,t){const i=Object.values((0,r.vM)(t,(e=>function(e){if(e.isGuestInviteRequest()){const t=e.getAttributes().permission_records_and_roles[0];return`guest_invite_${e.getForActorId()}:${null==t?void 0:t.id}:${null==t?void 0:t.role}`}return e.isSpaceMembershipRequest()?`space_membership_${e.getForActorId()}`:e.isTeamMembershipRequest()?void 0:void e.isPageAccessRequest()}(e))));return Promise.all(i.map((async t=>{const i=(0,r.MR)(t,(e=>e.getCreatedTime())),o=i[0];return{createdByActorsWithReason:await Promise.all(i.map((async t=>{const i=await A(e,{id:t.created_by_id,table:n.KJ});if(i)return{actor:i,reason:t.message}}))).then((e=>(0,r.oA)(e))),accessRequest:o}})))}(e,s);return Promise.all(a.map((async t=>{const i=await A(e,{id:t.accessRequest.getForActorId(),table:n.KJ});if(i)return{forActor:i,...t}}))).then((e=>(0,r.oA)(e)))}async function A(e,t){const i=new h.U6(e,t);return await i.load(),i.getModel()}},333241:(e,t,i)=>{i.d(t,{M:()=>p,d:()=>g});i(667294);var o=i(724405),s=i(882855),n=i(186517),r=i(361220),a=i(815047),d=i(709291),l=i(531701),c=i(401898),u=i(489728),m=i(785893);function g(e){let{type:t,role:i,events:n,disabled:r,buttonStyle:a,buttonContents:l,icon:c,table:g,isRemovable:h,isCurrentUser:v}=e;const f=(0,o.yK)((e=>({button:{marginRight:8,...a},icon:{width:10,marginLeft:4,fill:e.lightIconColor},label:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}})),[a]),b=c||!r&&s.E;return(0,m.jsxs)(u.Z,{...n,disabled:r,style:f.button,children:[l||(0,m.jsx)("span",{className:"notranslate",style:f.label,children:(0,m.jsx)(d.FormattedMessage,{...p({type:t,role:i,table:g,isRemovable:h,isCurrentUser:v}).label})}),b&&b(f.icon)]})}function p(e){let{type:t,role:i,table:o,isRemovable:s,isCurrentUser:d}=e;if("access"===i)return{label:n.mq.canAccessLabel};if("limited"===i)return{label:n.mq.limitedAccessLabel};if((0,n.oF)(i))return(0,n.Gx)(i,o);switch(i){case"editor":return o===a.bx||o===r.V7?{label:n.mq.workspaceOwnerLabel,caption:n.mq.workspaceOwnerCaption}:{label:n.mq.fullAccessLabel,caption:n.mq.fullAccessCaption};case"membership_admin":return o===a.bx||o===r.V7?{label:n.mq.membershipAdminLabel,caption:n.mq.membershipAdminCaption}:{label:n.mq.canEditLabel,caption:n.mq.canEditCaption};case"read_and_write":return o===a.bx||o===r.V7?{label:n.mq.memberLabel,caption:n.mq.memberCaption}:{label:n.mq.canEditLabel,caption:n.mq.canEditCaption};case"content_only_editor":return{label:n.mq.canEditContentLabel,caption:n.mq.canEditContentCaption};case"reader":return{label:n.mq.canReadLabel,caption:n.mq.canReadCaption};case"comment_only":return{label:n.mq.canCommentLabel,caption:n.mq.canCommentCaption};case"none":return"public_permission"===t?{label:n.mq.unpublishPageLabel,caption:n.mq.unpublishPageCaption}:s?o===a.bx||o===r.V7?d?{label:n.mq.leaveWorkspaceLabel,style:{color:l.ZP.red}}:{label:n.mq.removeFromWorkspaceLabel,style:{color:l.ZP.red}}:{label:n.mq.removeWorkspaceLabel,style:{color:l.ZP.red}}:{label:n.mq.noAccessLabel,style:{color:l.ZP.red}};default:(0,c.t1)(i)}}},207567:(e,t,i)=>{i.d(t,{ZP:()=>G});i(757658),i(667294);var o=i(800480),s=i(886628),n=i(724405),r=i(841892),a=i(536591),d=i(186517),l=i(772141),c=i(361220),u=i(815047),m=i(647425),g=i(709291),p=i(401898),h=i(91536),v=i(547307),f=i(95477),b=i(843250),y=i(433929),x=i(460709),M=i(98742),S=i(367669),A=i(918514),j=i(825464),k=i(61766),C=i(960709),_=i(44041),R=i(854669),w=i(170060),I=i(88893),F=i(535057),B=i(552275),K=i(231945),T=i(478140),V=i(828992),O=i(632163),P=i(174136),Z=i(672495),U=i(526388),q=i(164369),L=i(484015),N=i(942402),D=i(333241),W=i(760442),E=i(785893);const z=(0,g.defineMessages)({fullAccessTeamGuestsDisabledMessage:{id:"permissionRoleSelect.teamGuestPermissionItem.disabledPermissionitem.tooltip",defaultMessage:"Teamspace guests can't have full access."}});const G=function(e){let{isUserPermission:t,type:i,table:n,role:r,isInvite:a,availableRoleItems:m,blockType:p,onClick:h,origin:v,isMenuItem:f,isRemovableOverride:M,disabled:A,buttonContents:j,buttonPopupStore:_,buttonStyle:R,placementToOrigin:w,alignmentToOrigin:I,upgradeButtonName:F,onUpgradeButtonClick:P,onChange:U,onRemoveMemberClick:q,header:N,footer:W,showPermissionOverrideWarning:G}=e;const H=(0,o.O7)(),Q=(0,s.qz)(_,k.Z),{device:ee}=H,te=!!t,ie=(0,s.VK)((()=>function(e,t,i,o,s,n){if(s&&s.length>0)return s;if(t===c.V7){let e=l.an.map((e=>({role:e})));return o&&(e=e.filter((e=>"none"!==e.role))),e}const r=[];"explicit_team_guest_permission"===e?r.push({role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:y.default.formatMessage(z.fullAccessTeamGuestsDisabledMessage)}}):"bot_permission"!==e&&"public_permission"!==e&&r.push({role:"editor"});"space"===t&&(0,S.U7)()&&r.push({role:"membership_admin"});r.push({role:"read_and_write"}),"collection_view"!==n&&"collection_view_page"!==n||"bot_permission"===e&&"content_only_editor"!==i||"public_permission"===e||r.push({role:"content_only_editor"});t!==u.bx&&("bot_permission"!==e&&r.push({role:"comment_only"}),"bot_permission"===e&&"reader"!==i||r.push({role:"reader"}));o||r.push({role:"none"});return r}(i,n,r,a,m,p)),[i,n,r,a,m,p]);return(0,E.jsx)(K.ZP,{onClick:e=>{e.preventDefault(),e.stopPropagation(),h&&h()},popupType:ee.isMobile?K.Z4.SlideUp:K.Z4.Popup,buttonPopupStore:Q,renderOrigin:e=>v||(f?(0,E.jsx)(B.Z,{...e,title:(0,E.jsx)(g.FormattedMessage,{...(0,D.M)({type:i,role:r,table:n,isRemovable:J(i,M),isCurrentUser:te}).label}),focused:!1,showExtensionArrow:!0}):(0,E.jsx)(D.d,{type:i,role:r,events:e,disabled:A,buttonContents:j,buttonStyle:R,table:n,isRemovable:J(i,M),isCurrentUser:te})),placementToOrigin:w||C.Iw.Bottom,alignmentToOrigin:I,render:e=>{let o,s;return o=(0,d.oF)(r)?[{key:"mixed_role_section",render:e=>(0,E.jsx)(Z.Z,{...e,topBorder:!1}),items:[{key:"mixed_role_description",render:()=>(0,E.jsx)(L._,{role:r}),action:()=>{}}]},{key:"bot_capabilities_warning",render:e=>(0,E.jsx)(Z.Z,{...e,topBorder:!0}),items:[{key:"warning_details",render:e=>(0,E.jsx)(V.Z,{...e,shouldWrapCaption:!0,caption:"Integration permissions cannot be changed on a page. You can manage integrations in settings."}),action:()=>{}}]},{key:"remove_bot",render:e=>(0,E.jsx)(Z.Z,{...e,topBorder:!0}),items:[{key:"none",render:e=>(0,E.jsx)($,{role:r,upgradeButtonName:F,onUpgradeButtonClick:P,focused:e.focused,props:e,availableRole:{role:"none"},isCurrentUser:!!t,isRemovableOverride:M,table:n,type:i}),action:()=>{Y("none",n,r,i,F,H,ie,U,P,t,q),e.close()}}]}]:[{key:"roles",render:e=>(0,E.jsx)(Z.Z,{...e,topBorder:0!==e.index}),items:ie.map((o=>({key:o.role,render:e=>(0,E.jsx)($,{role:r,upgradeButtonName:F,onUpgradeButtonClick:P,focused:e.focused,props:e,availableRole:o,isCurrentUser:!!t,isRemovableOverride:M,table:n,type:i}),action:()=>{Y(o.role,n,r,i,F,H,ie,U,P,t,q),e.close()}})))}],s=ee.isMobile?{menuType:x.og.Modal,title:(0,E.jsx)(g.FormattedMessage,{id:"userPermissionsMenu.mobile.title",defaultMessage:"Select role"}),right:(0,E.jsx)(g.FormattedMessage,{id:"userPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:x.og.Popup,width:264},(0,E.jsx)(T.Z,{className:b.a6i,header:N,footer:(0,E.jsxs)(E.Fragment,{children:[W,G&&(0,E.jsx)(X,{})]}),...s,children:(0,E.jsx)(O.Z,{type:O.i.Vertical,initialFocus:void 0,sections:o})})}})};function H(e,t,i){const o=t===c.V7?"enterprise":(0,F.zt)();if((0,m.QM)(o)){if((t===u.bx?l.RN(e):l.J5(e)&&!l.zz(e))&&"public_permission"!==i&&"bot_permission"!==i)return t===u.bx?(0,E.jsx)(W.Z,{imageURL:r.Z.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,E.jsx)(g.FormattedMessage,{defaultMessage:"Members cannot change workspace settings or invite new members.",id:"permissionRoleSelect.spaceReadAndWriteUpgradeTooltip.caption"}),title:(0,E.jsx)(g.FormattedMessage,{defaultMessage:"Upgrade to add non-admin members",id:"permissionRoleSelect.spaceReadAndWriteUpgradeTooltip.title"})}):(0,E.jsx)(W.Z,{imageURL:r.Z.images.tooltips.upsells.userReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,E.jsx)(g.FormattedMessage,{defaultMessage:"Users with edit access can edit a page but not share it with others.",id:"permissionRoleSelect.userReadAndWriteUpgradeTooltip.caption"}),title:(0,E.jsx)(g.FormattedMessage,{defaultMessage:"Upgrade to add editors",id:"permissionRoleSelect.userReadAndWriteUpgradeTooltip.title"})})}return!1}function J(e,t){if(void 0!==t)return t;switch(e){case"user_permission":case"bot_permission":case"group_permission":return!0;case"space_permission":case"explicit_team_permission":case"team_permission":case"team_owner_permission":case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"public_permission":case"trusted_domain_permission":case"exclusive_user_permission":return!1;default:(0,p.t1)(e)}}async function Y(e,t,i,o,s,n,r,a,l,m,p){if(i===e)return;const b=()=>{a&&a(e)};if(h.Mv({newRole:e,availableRoles:r}),H(e,t,o)&&!f.default.isAdminMode)_.y(n,{from:s,for:I.M9(n)||"plus"}),l&&l();else if(function(e,t,i){return i&&(0,d.nl)(t,e)===t&&"none"===e}(e,i,m))v.showDialog({showCancel:!0,keepFocus:!1,message:t===u.bx||t===c.V7?(0,E.jsx)(g.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeSelfFromWorkspace.confirmationMessage",defaultMessage:"Are you sure you want to remove your own access? You will lose access to the workspace, and any private pages will be lost."}):(0,E.jsx)(g.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeSelfFromPage.confirmationMessage",defaultMessage:"Are you sure you want to remove your own access?"}),items:[{label:(0,E.jsx)(g.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeSelfButton.label",defaultMessage:"Remove"}),color:"red",onAccept:b}]});else if(function(e,t,i){return i&&(0,d.nl)(t,e)===t}(e,i,m))v.showDialog({showCancel:!0,keepFocus:!1,message:(0,E.jsx)(g.FormattedMessage,{id:"userPermissionsMenu.downgradePermissionsModal.downgradeSelfFromWorkspaceOrPage.confirmationMessage",defaultMessage:"Are you sure you want to downgrade your own access?"}),items:[{label:(0,E.jsx)(g.FormattedMessage,{id:"userPermissionsMenu.downgradePermissionsModal.downgradeSelfButton.label",defaultMessage:"Downgrade"}),color:"red",onAccept:b}]});else if(function(e,t){return(t===u.bx||t===c.V7)&&"none"===e}(e,t))if(p)p();else{await async function(e){const{message:t}=e;return new Promise((e=>{v.showDialog({showCancel:!0,keepFocus:!1,handleCancel:()=>e(!1),message:t,items:[{label:(0,E.jsx)(g.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeUserButton.label",defaultMessage:"Remove"}),color:"red",onAccept:()=>e(!0)}]})}))}({message:(y=!0,y&&(0,F.wP)()?(0,E.jsx)(g.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeUserFromWorkspace.enterprise.confirmationMessage",defaultMessage:"If you remove this member, they will lose workspace access. After their removal, you may transfer their private pages to another member. <transferpagelink>Learn more</transferpagelink>.",values:{transferpagelink:e=>(0,E.jsx)(N.Z,{href:(0,A.UY)("guides.transferContent"),external:!0,children:e})}}):y?(0,E.jsx)(g.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeUserFromWorkspace.confirmationMessage",defaultMessage:"Are you sure you want to remove this person? They will lose access to the workspace, and any private pages will be lost."}):(0,E.jsx)(g.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeUserFromPage.confirmationMessage",defaultMessage:"Are you sure you want to remove this person?"}))})&&b()}else if(function(e,t){return"public_permission"===e&&"none"===t}(o,e)){await async function(){return new Promise((e=>{v.showDialog({showCancel:!0,keepFocus:!1,handleCancel:()=>e(!1),description:(0,E.jsx)(g.FormattedMessage,{id:"permissionRoleSelect.unpublishConfirmation.description",defaultMessage:"Removing access will unpublish this page from the web."}),message:(0,E.jsx)(g.FormattedMessage,{id:"permissionRoleSelect.unpublishConfirmation.message",defaultMessage:"Are you sure you want to remove access?"}),items:[{label:(0,E.jsx)(g.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.unpublishAction.label",defaultMessage:"Remove access"}),color:"red",onAccept:()=>e(!0)}]})}))}()&&b()}else b();var y}function $(e){const{availableRole:t,isCurrentUser:i,role:r,table:d,type:l,isRemovableOverride:c,upgradeButtonName:u,onUpgradeButtonClick:m}=e,{label:p,caption:h}=(0,D.M)({type:l,role:t.role,table:d,isRemovable:J(l,c),isCurrentUser:i}),v=(0,n.Fg)(),f=(0,o.O7)(),{device:b}=f,{onClick:y,key:x,...S}=e.props,A=t.disabledInfo,k=(0,s.VK)((()=>H(t.role,d,l)),[t,d,l]),C=(0,s.VK)((()=>f.device.isMobile&&w.bQ()),[f]),_=Boolean(k),F=(0,s.VK)((()=>_&&I.M9(f)),[f,_]),K=_&&!C;return A&&A.isDisabled?(0,E.jsx)(U.Z,{delayThreshold:0,renderTooltip:e=>(0,E.jsx)("div",{...e,children:A.disabledMessage}),placement:j.u.Right,textWrap:!0,render:i=>(0,E.jsx)(B.Z,{...i,focused:e.focused,disabled:!0,disabledFeedback:!0,right:r===t.role?(0,E.jsx)("div",{style:{width:b.isMobile?16:14},children:(0,a.e)()}):void 0,title:(0,E.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,E.jsx)("div",{style:{...e.style,marginRight:k?6:0},children:(0,E.jsx)(g.FormattedMessage,{...p})})}),caption:h&&(0,E.jsx)("span",{style:{color:v.mediumTextColor},children:(0,E.jsx)(g.FormattedMessage,{...h})}),shouldWrapCaption:!0})}):(0,E.jsx)(R.Z,{requireUpgradeToTier:F,analyticsName:u,renderUpgradeTooltip:()=>k,tooltipPlacement:j.u.Left,onClick:y,onUpgradeClick:m,render:(i,o)=>{const{focused:s,...n}=(0,M.Z)(S,i);return(0,E.jsx)(B.Z,{...n,focused:s||e.focused,right:r===t.role?(0,E.jsx)("div",{style:{width:b.isMobile?16:14},children:(0,a.e)()}):void 0,title:(0,E.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,E.jsx)("div",{style:{...e.style,marginRight:k?6:0},children:(0,E.jsx)(g.FormattedMessage,{...p})}),o,e.availableRole.tag&&(0,E.jsx)(P.Z,{desktopStyle:{marginLeft:7},children:e.availableRole.tag})]}),caption:h&&(0,E.jsx)("span",{style:{color:v.mediumTextColor},children:(0,E.jsx)(g.FormattedMessage,{...h})}),shouldWrapCaption:!0,disabled:K})}})}function X(){const e=(0,n.Fg)(),t=(0,o.O7)(),{device:i}=t;return(0,E.jsx)(q.Z,{style:{padding:12,backgroundColor:e.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${e.regularDividerColor}`,marginTop:i.isMobile?28:1},isMultiline:!0,isSmall:!0,children:(0,E.jsx)(g.FormattedMessage,{id:"permissionRoleSelect.overrideMessage.caption",defaultMessage:"Youâ€™ll override permissions from the parent page if you change this role."})})}},293963:(e,t,i)=>{i.d(t,{z:()=>a});i(667294);var o=i(724405),s=i(709291),n=i(785893);const r=8;function a(e){let{color:t,size:i,style:a}=e;const d=(0,s.useIntl)(),l=(0,o.yK)((e=>({dot:{height:i||r,width:i||r,background:t||e.blueColor,flexShrink:0,borderRadius:"100%",pointerEvents:"none",...a}})),[i,t,a]);return(0,n.jsx)("div",{role:"img","aria-label":d.formatMessage({id:"statusDot.ariaLabel",defaultMessage:"New"}),style:l.dot})}},393524:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Ho});var o=i(667294),s=i(883355),n=i(340902),r=i(568626),a=i(933709),d=i(401898),l=i(361927),c=(i(252262),i(324506),i(800480)),u=i(886628),m=i(724405),g=i(151744),p=i(815145),h=i(458129),v=i(421202),f=i(815047),b=i(429369),y=i(519889),x=i(709291),M=i(137810),S=i(948298),A=i(78730),j=i(433929),k=i(28092),C=i(641549),_=i(206258),R=i(407057),w=i(924211),I=i(569651),F=i(108504),B=i(653965),K=i(717659),T=i(937834),V=i(210228),O=i(843250),P=i(973744),Z=i(212534),U=i(98742),q=i(195697),L=i(816402),N=i(370345),D=i(448451),W=i(895285),E=i(823376),z=i(116746),G=i(825464),H=i(319385),J=i(304761),Y=i(411066),$=i(231945),X=i(573063),Q=i(731278),ee=i(186176),te=i(776798),ie=i(526388),oe=i(50116),se=i(167706),ne=i(32469),re=i(293963),ae=i(785893);const de=o.createContext((()=>{}));function le(e){const{disabled:t=!1,children:i}=e,s=(0,o.useContext)(de),n=(0,o.useCallback)((()=>{t||s(!0)}),[s,t]),r=(0,o.useCallback)((()=>{t||s(!1)}),[s,t]);return(0,ae.jsx)("div",{style:{display:"contents"},onMouseEnter:n,onMouseLeave:r,children:i})}de.displayName="NestedNotificationButtonContext";const ce=0,ue=24,me=24+ue+8,ge="150ms ease";function pe(e){const{notification:t,prominentTitleLink:i,children:s,rootStore:n,icon:r,isPrivate:a,onArchiveClicked:d,onUnarchiveClicked:l,onMarkAsReadClicked:g,onMarkAsUnreadClicked:p,onNotificationBodyClicked:h,navigableBlockId:f,url:b,showSnapshotButton:y,hidePageTitle:x,header:M,isFirst:S,isLast:A}=e,j=(0,c.O7)(),k=(0,c.Fy)(),C=parseInt(t.end_time),R=(0,u.VK)((()=>{const e=t.navigable_block_id;if(e)return _.t1.createChildStore(n,{table:v.iU,id:e,spaceId:n.id})}),[n,t.navigable_block_id]),w=(0,u.VK)((()=>z.Z.isPeekDismissableState()),[]),[I,F]=(0,o.useState)(!1),[B,T]=(0,o.useState)(!1),P=(0,o.useRef)(null),U=(0,N.Z)({onLongPress:()=>{var e;return null===(e=P.current)||void 0===e?void 0:e.setOpen(!0)}}),[q,L]=(0,o.useState)(!1),D=I&&!B&&!q,G=(0,u.VK)((()=>"mentions"===J.ZP.state.currentTab),[]),H=!t||t.read,X=k.isMobile,Q=(0,u.VK)((()=>{const e=j.WindowSizeStore.state;return{left:e.paddingLeftCSS,right:e.paddingRightCSS}}),[j.WindowSizeStore]),ee=(0,m.yK)((e=>({article:{display:"flex",flexDirection:"column"},mainClickTargetButton:{display:"flex",flexDirection:"column",gap:8,paddingTop:14-ce,paddingBottom:14-ce,paddingLeft:X?Q.left:0,paddingRight:X?Q.right:0,marginTop:S?0:ce,marginBottom:A?0:ce,marginLeft:ce,marginRight:ce,transition:`background ${ge}`},mainClickTargetButtonHovered:{background:e.state.hover},headerAndAvatar:{display:"flex",paddingLeft:8-ce,paddingRight:20-ce,gap:8,maxWidth:"100%"},avatarAndStatusDot:{display:"flex",gap:8,alignItems:"center",height:ue},statusDotSpacer:{width:8,flexShrink:0},privatePageBadge:{marginTop:1,marginBottom:4,marginLeft:8},children:{paddingLeft:me-ce,paddingRight:20-ce},divider:{height:1,backgroundColor:e.stroke.deemphasized}})),[S,A,Q,X]),te=(0,o.useCallback)((e=>{t&&(q||(!b&&t.read||h(),(0,Z.ZP)({event:e,context:Z.Af.NotificationClick,callback:()=>{!w||e.metaKey||e.ctrlKey||E.TN({environment:j}),t.read||V.createAndCommit({userAction:"ActivityNotificationSection.handleMarkAsRead",environment:j,perform:e=>{K.$h({notification:t,rootStore:n,transaction:e,read:!0})}})}})))}),[j,q,t,h,w,n,b]),ie=(0,o.useCallback)((e=>{t&&(0,Z.ZP)({event:e,context:Z.Af.NotificationClick,callback:()=>{t.read?p():g(),V.createAndCommit({userAction:"InboxActionsMenu.toggleNotificationReadStatus",environment:j,perform:e=>{K.$h({notification:t,rootStore:n,transaction:e,read:!t.read})}})}})}),[j,t,g,p,n]),oe=(0,o.useCallback)((e=>{t&&(0,Z.ZP)({event:e,context:Z.Af.NotificationClick,callback:()=>{d(),V.createAndCommit({userAction:"InboxActionsMenu.handleArchive",environment:j,perform:e=>{K.aZ({notification:t,rootStore:n,transaction:e})}})}})}),[j,t,d,n]),se=(0,o.useCallback)((e=>{t&&(0,Z.ZP)({event:e,context:Z.Af.NotificationClick,callback:()=>{l(),V.createAndCommit({userAction:"Activity.handleUnarchive",environment:j,perform:e=>{K.E1({notificationId:t.id,visited:!1,rootStore:n,transaction:e})}})}})}),[j,t,l,n]),le=(0,o.useCallback)((()=>F(!0)),[]),pe=(0,o.useCallback)((()=>F(!1)),[]),he=(0,o.useId)(),ve=(0,W.aE)();return(0,ae.jsx)($.ZP,{ref:P,disabled:!k.isMobile,style:ve.popup,popupType:k.isTablet?$.Z4.Popup:$.Z4.SlideUp,render:e=>(0,ae.jsx)(W.PQ,{blockStore:R,notification:t,handlers:{handleUnarchive:se,handleArchive:oe,toggleNotificationReadStatus:ie},closePopup:()=>e.close()}),renderOrigin:()=>(0,ae.jsx)("div",{...k.isMobile&&U,children:(0,ae.jsx)("article",{style:ee.article,onMouseOver:le,onMouseLeave:pe,"aria-labelledby":he,tabIndex:0,children:(0,ae.jsxs)(de.Provider,{value:T,children:[(0,ae.jsx)(be,{notification:t,rootStore:n,isMobile:X,isHovered:I,isFirst:S,onMouseEnter:()=>L(!0),onMouseLeave:()=>L(!1),onArchiveClicked:d,onUnarchiveClicked:l,onMarkAsReadClicked:g,onMarkAsUnreadClicked:p}),(0,ae.jsxs)(Y.Z,{href:b,hovered:D,ignoreLocalHoverState:!0,style:ee.mainClickTargetButton,onClick:te,hoveredStyle:ee.mainClickTargetButtonHovered,disabled:!Boolean(b),children:[(0,ae.jsxs)("div",{style:ee.headerAndAvatar,children:[(0,ae.jsxs)("div",{className:O.FoE,style:ee.avatarAndStatusDot,children:[G&&!H?(0,ae.jsx)(re.z,{size:8}):(0,ae.jsx)("div",{style:ee.statusDotSpacer}),r]}),(0,ae.jsx)(Se,{blockStore:R,timestamp:C,header:M,hidePageTitle:Boolean(x),prominentTitleLink:i,hasChildren:Boolean(s),titleAriaId:he}),y&&f&&(0,ae.jsx)(Ae,{timestamp:C,navigableBlockId:f,rootStore:n}),a&&!t&&(0,ae.jsx)(ne.Z,{style:ee.privatePageBadge})]}),s&&(0,ae.jsx)("div",{style:ee.children,className:O.nU_,children:s})]}),!A&&(0,ae.jsx)("div",{style:ee.divider})]})})})},t.id)}const he=12-ce,ve=14-ce,fe="100ms ease-out";function be(e){const{notification:t,rootStore:i,isMobile:o,isHovered:s,isFirst:n,onArchiveClicked:r,onUnarchiveClicked:a,onMarkAsReadClicked:d,onMarkAsUnreadClicked:l,onMouseEnter:c,onMouseLeave:u}=e,g=(0,m.yK)((()=>({container:{display:"flex",alignItems:"flex-start",position:"relative"},body:{transition:`opacity ${fe}`,opacity:o||s?1:0,position:"absolute",right:he,top:ve+(o?-3:0)+(n?0:ce),zIndex:1}})),[o,s,n]);return t?(0,ae.jsx)("div",{style:g.container,onMouseEnter:c,onMouseLeave:u,children:(0,ae.jsx)("div",{style:g.body,children:(0,ae.jsx)(D.lD,{notification:t,rootStore:i,onArchiveClicked:r,onUnarchiveClicked:a,onMarkAsReadClicked:d,onMarkAsUnreadClicked:l,useInboxRedesign:!0})})}):null}const ye=14,xe=12,Me=3;function Se(e){const{blockStore:t,timestamp:i,hidePageTitle:s,prominentTitleLink:n,header:r,hasChildren:a,titleAriaId:d}=e,l=(0,c.Fy)().isMobile,g=!s,[p,h]=(0,o.useState)(!1),[v,f]=(0,o.useState)(!1),b=(0,L.IS)(i,{useUltraCompactFormat:!0}),y=(0,L.uy)(i),x=(0,u.VK)((()=>{var e;if(t)return null===(e=t.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:t.getRecordModel})}),[t]),S=(0,u.VK)((()=>!!t&&t.isEmptyPage()),[t]),A=(0,u.VK)((()=>H.default.checkGate({gateName:"page_preview_hover_in_inbox_notifs"})),[]),j=(0,u.VK)((()=>{if(!t)return!1;if(A)return!0;const e=(0,q.bq)();return(0,ee.c7)(t,!1).filter((t=>{if(t instanceof _.G||t instanceof _.zX&&e)return!0})).length>0}),[t,A]),k=(0,o.useCallback)((()=>{h(!0),f(!1)}),[]),C=B.P2((()=>{f(!0)}),200,{leading:!0}),R=(0,o.useCallback)((()=>{h(!1),f(!1),P.ZV(window,"scroll",C,!0)}),[C]),w=(0,o.useCallback)((e=>(0,ae.jsx)(oe.E5,{store:t,events:e})),[t]);(0,o.useEffect)((()=>{if(A)return P.lj(window,"scroll",C,!0),()=>P.ZV(window,"scroll",C,!0)}),[A,C]);const F=(0,m.yK)((e=>({container:{display:"flex",flexDirection:"row",minWidth:0,width:"100%",marginTop:2},headerMobile:{fontSize:ye,minWidth:0},header:{display:"inline-grid",gridAutoFlow:"column",justifyContent:"space-between",fontSize:ye,minWidth:0},headlineMobile:{paddingTop:2,display:"inline",whiteSpace:"pre-wrap",wordBreak:"break-word"},headline:{flexShrink:2,whiteSpace:"pre-wrap",wordBreak:"break-word"},title:{fontSize:ye,marginTop:4,marginBottom:a?8:4},time:{display:"flex",fontSize:xe,color:e.lightTextColor,whiteSpace:"nowrap",...l&&{display:"inline"},paddingLeft:6,marginTop:ye-xe},headerAndPageTitle:{display:"flex",flex:1,flexDirection:"column",gap:Me,minWidth:0},pageTitleMockedButton:{maxWidth:"fit-content",display:"flex",alignItems:"center",gap:4,borderRadius:3,paddingTop:2,paddingBottom:2,paddingLeft:3,paddingRight:5,marginTop:-2,marginBottom:-2,marginLeft:-3,marginRight:-5,background:p&&j?e.state.hover:void 0},recordTitle:{fontSize:14,fontWeight:M.Z.fontWeight.medium},recordPath:{color:e.regularInvertedTextColor}})),[a,l,p,j]),K=(!A||!0!==v)&&void 0;return(0,ae.jsxs)("div",{style:F.container,children:[(0,ae.jsxs)("div",{style:F.headerAndPageTitle,children:[(0,ae.jsxs)("div",{style:l?F.headerMobile:F.header,children:[(0,ae.jsx)("div",{style:l?F.headlineMobile:F.headline,className:O.NFf,id:d,children:r}),(0,ae.jsx)("div",{style:F.time,className:O.CZG,children:(0,ae.jsx)(se.Z,{text:b,tooltipText:y,icon:I.C})})]}),t&&g&&(0,ae.jsx)(le,{disabled:!j,children:(0,ae.jsx)(ie.Z,{originGap:3,disableTooltip:!j,alignment:G.v.Start,placement:A?G.u.Bottom:G.u.Top,renderTooltip:A?w:()=>(0,ae.jsx)(ee.ZP,{store:t,textColor:F.recordPath.color}),...A&&{closeDelay:0,noStyle:!0,textWrap:!0},forceVisibleState:K,render:e=>(0,ae.jsxs)("div",{style:F.pageTitleMockedButton,...(0,U.Z)(e,{onMouseEnter:k,onMouseLeave:R}),children:[(0,ae.jsx)(Q.Z,{disabled:!0,icon:x,isEmptyPage:S,size:16}),(0,ae.jsx)(te.Z,{store:t,style:F.recordTitle,underline:!0})]})})})]}),l&&(0,ae.jsx)("div",{style:{width:W.b8-he,flexShrink:0}}),n&&(0,ae.jsx)("div",{style:F.title,children:n})]})}function Ae(e){const{timestamp:t,navigableBlockId:i,rootStore:o}=e,s=(0,c.O7)();if(t<new Date("2018-10-26").getTime())return null;const n=j.default.getIntl().formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"}),r=()=>{const e=_.G.createChildStore(o,{table:v.iU,id:i});T.jN({environment:s,blockStore:e,openSnapshotNearTimestamp:t.toString(),from:"activity"})};return(0,ae.jsx)(ie.Z,{renderTooltip:()=>n,render:e=>(0,ae.jsx)(X.Z,{ariaLabel:n,onClick:r,icon:F.J,...e})})}function je(e){const{children:t}=e,i=(0,m.yK)((e=>({container:{borderRadius:"100%",display:"flex",flexShrink:0,justifyContent:"center",alignItems:"center",height:ue,width:ue,backgroundColor:e.surface.elevated,borderWidth:1,borderStyle:"solid",borderColor:e.stroke.deemphasized},icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,ae.jsx)("div",{style:i.container,children:t})}const ke=o.memo(pe);var Ce=i(462385),_e=i(164369),Re=i(949204);const we=function(e){const{accessRequestStore:t,teamStore:i,useInboxRedesign:o}=e,s=(0,c.O7)(),n=(0,x.useIntl)(),{isRequestResolved:r,resolvedStatus:a,resolvedTime:d}=(0,u.VK)((()=>({isRequestResolved:t.isResolvedTeamMembershipRequest(),resolvedStatus:t.getStatus(),resolvedTime:t.getResolvedTime()})),[t]),l=(0,u.VK)((()=>{const e=t.getResolvedById();if(!e)return;const i=_.U6.createChildStore(t,{table:y.KJ,id:e});return i?i.getDisplayName(n):void 0}),[t,n]),g=async e=>{await Re.ow({environment:s,teamStore:i,accessRequestStore:t,status:e})},p=(0,m.yK)((e=>({container:{display:"flex",alignItems:"center"},redesignedContainer:{display:"flex",alignItems:"center",fontSize:14,color:e.mediumTextColor},approveButton:{height:26,paddingLeft:8,paddingRight:8,fontSize:12,marginRight:10,fontWeight:500,boxShadow:e.plainButtonBoxShadow,color:e.regularTextColor},declineButton:{height:26,paddingLeft:8,paddingRight:8,color:e.regularTextColor}})),[]);return(0,ae.jsx)("div",{style:p.container,children:r?e.useInboxRedesign?(0,ae.jsx)("div",{style:p.redesignedContainer,children:"approved"===a?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Approved by {grantedBy} on {resolvedTime}",id:"approveTeamMembershipActivityButton.requestApprovedWithTime.title",values:{grantedBy:l,resolvedTime:(0,R.Yx)(Math.min(d??0,Date.now()),"medium_with_time",(0,w.E2)(n))}}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Denied by {grantedBy} on {resolvedTime}",id:"approveTeamMembershipActivityButton.requestDeniedWithTime.title",values:{grantedBy:l,resolvedTime:(0,R.Yx)(Math.min(d??0,Date.now()),"medium_with_time",(0,w.E2)(n))}})}):(0,ae.jsxs)("div",{children:[(0,ae.jsx)(_e.Z,{isSecondaryColor:!0,children:"approved"===a?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Approved by {grantedBy}",id:"approveTeamMembershipActivityButton.requestApproved.title",values:{grantedBy:l}}):o?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Denied by {grantedBy}",id:"approveTeamMembershipActivityButton.requestDenied.title",values:{grantedBy:l}}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Declined by {grantedBy}",id:"approveTeamMembershipActivityButton.requestDeclined.title",values:{grantedBy:l}})}),(0,ae.jsx)(_e.Z,{isSmall:!0,isSecondaryColor:!0,children:(0,R.Yx)(Math.min(d??0,Date.now()),"medium_with_time",(0,w.E2)(n))})]}):(0,ae.jsxs)("div",{children:[(0,ae.jsx)(le,{children:(0,ae.jsx)(Ce.Z,{style:p.approveButton,onClick:()=>g("approved"),children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Approve",id:"approveTeamMembershipActivityButton.approveButton.label"})})}),(0,ae.jsx)(le,{children:(0,ae.jsx)(Ce.Z,{style:o?p.approveButton:p.declineButton,onClick:()=>g("rejected"),children:e.useInboxRedesign?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Deny",id:"approveTeamMembershipActivityButton.denyButton.label"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Decline",id:"approveTeamMembershipActivityButton.declineButton.label"})})})]})})};var Ie=i(266897),Fe=i(177420),Be=i(91536),Ke=i(91376),Te=i(64404),Ve=i(661519);const Oe=function(e){let{accessRequestStore:t,effectiveAccessRequestType:i,onApprove:o,onReject:s,spaceStore:n,useInboxRedesign:r}=e;const a=(0,m.Fg)(),d=(0,c.O7)(),l=(0,u.VK)((()=>t.isDefined()),[t]),g=(0,u.VK)((()=>t.getModel()),[t]),p=(0,u.VK)((()=>n.canAdmin()),[n]),h=(0,u.VK)((()=>n.canEditMembership()),[n]),v=(0,u.VK)((()=>null==g?void 0:g.isResolved()),[g]),f=(0,u.VK)((()=>null==g?void 0:g.isGuestInviteRequest()),[g]),b="space_membership_request"===i;return l?v?(0,ae.jsx)(qe,{accessRequestStore:t,spaceStore:n,useInboxRedesign:r}):f&&!p||b&&!h?null:(0,ae.jsxs)("div",{style:{display:"flex",alignItems:"center",...r&&{gap:10}},children:[(0,ae.jsx)(le,{children:(0,ae.jsx)(Ce.Z,{onClick:o,style:Pe(r,a),children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Approve",id:"approveSpaceMembershipActivityAction.approveButton.label"})})}),(0,ae.jsx)(le,{children:(0,ae.jsx)(Ce.Z,{onClick:s,style:{height:r?28:26,paddingLeft:8,paddingRight:8},children:r?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Deny",id:"approveSpaceMembershipActivityAction.denyButton.label"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Decline",id:"approveSpaceMembershipActivityAction.declineButton.label"})})}),!d.device.isMobile&&(0,ae.jsxs)(ae.Fragment,{children:[!r&&(0,ae.jsx)(Ve.Z,{size:1,vertical:!0,style:{height:26,paddingLeft:8,paddingRight:8}}),(0,ae.jsx)(le,{children:(0,ae.jsx)(Ce.Z,{onClick:()=>{Be.E5(d,{disable_membership_requests:n.getDisableMembershipRequests()}),Ke.r$({currentTab:"members",subtab:Te.Q.Requests})},style:{height:26,paddingLeft:8,paddingRight:8},children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"View all requests",id:"approveSpaceMembershipActivityAction.viewAllRequests.label"})})})]})]}):null};function Pe(e,t){return{height:e?28:26,paddingLeft:8,paddingRight:8,boxShadow:t.plainButtonBoxShadow,fontSize:12,...!e&&{marginRight:10},color:t.regularTextColor,fontWeight:500}}function Ze(e,t,i){if(e===y.KJ){const o=i.getRecordValue({table:e,id:t});if(o)return(0,Ie.dp)(o)}if(e===Fe.cZ){const o=i.getRecordValue({table:e,id:t});if(o)return(0,Ie.D$)(o)}}function Ue(e){let{pointer:t,accessRequestStore:i,useInboxRedesign:o}=e;const{table:s,id:n}=t,r=(0,u.VK)((()=>B.oA([Ze(s,n,i)])),[s,n,i]),a=(0,u.VK)((()=>(0,l.XW)(r,{...(0,C.h_)({useInboxRedesign:o})})),[r,o]);return(0,ae.jsx)(ae.Fragment,{children:a})}function qe(e){let{accessRequestStore:t,spaceStore:i,useInboxRedesign:o}=e;const s=(0,x.useIntl)(),n=(0,m.Fg)(),r=(0,u.VK)((()=>t.getModel()),[t]),a=(0,u.VK)((()=>t.getStatus()),[t]),d=(0,u.VK)((()=>t.getResolvedTime()),[t]),{isResolved:l,resolveByPointer:c}=(0,u.VK)((()=>({isResolved:(null==r?void 0:r.isResolved())??!1,resolveByPointer:null==r?void 0:r.getResolvedByPointer(i.id)})),[r,i.id]);if(!r)return null;const g=l&&c&&(0,ae.jsx)(Ue,{accessRequestStore:t,useInboxRedesign:o,pointer:c});return o?(0,ae.jsx)("div",{style:{fontSize:14,color:n.mediumTextColor},children:"approved"===a?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Approved by {grantedBy} on {resolvedTime}",id:"approveSpaceMembershipActivityAction.requestApprovedWithTime.title",values:{grantedBy:g,resolvedTime:(0,R.Yx)(Math.min(d??1/0,Date.now()),"medium_with_time",(0,w.E2)(s))}}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Denied by {grantedBy} on {resolvedTime}",id:"approveSpaceMembershipActivityAction.requestDenied.title",values:{grantedBy:g,resolvedTime:(0,R.Yx)(Math.min(d??1/0,Date.now()),"medium_with_time",(0,w.E2)(s))}})}):(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(_e.Z,{isSecondaryColor:!0,children:"approved"===a?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Approved by {grantedBy}",id:"approveSpaceMembershipActivityAction.requestApproved.title",values:{grantedBy:g}}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Declined by {grantedBy}",id:"approveSpaceMembershipActivityAction.requestDeclined.title",values:{grantedBy:g}})}),(0,ae.jsx)(_e.Z,{isSmall:!0,isSecondaryColor:!0,children:(0,R.Yx)(Math.min(d??1/0,Date.now()),"medium_with_time",(0,w.E2)(s))})]})}var Le=i(749085),Ne=i(772141),De=i(554368),We=i(519719),Ee=i(476464),ze=i(709953),Ge=i(367669),He=i(417311),Je=i(88893),Ye=i(288280),$e=i(207567);const Xe=Le.default.createClass(void 0,{name:"RoleStore"});const Qe=function(e){let{accessRequestStore:t,useInboxRedesign:i,targetBlockStore:o,notification:s,initialRole:n,rootStore:r}=e;const a=(0,u.qz)(void 0,Xe),d=(0,u.VK)((()=>t.getValue()),[t]),l=(0,u.VK)((()=>o.canAdmin()),[o]);return d?(0,h.Kc)(d)?(0,ae.jsx)(ut,{accessRequestStore:t,useInboxRedesign:i,accessRequestValue:d}):l?(0,ae.jsx)(ct,{accessRequestStore:t,notification:s,targetBlockStore:o,useInboxRedesign:i,initialRole:n,roleStore:a,accessRequestValue:d,rootStore:r}):null:null};function et(){const e=(0,m.yK)((e=>({banner:{borderRadius:He.Z.borderRadius,padding:"5px 8px",background:e.accentColors.yellow[50],marginBottom:12,fontSize:M.Z.fontSize.UISmall.desktop,lineHeight:M.Z.lineHeight.UISmall.desktop,fontWeight:M.Z.fontWeight.regular,color:e.accentColors.yellow[500]}})),[]);return(0,ae.jsx)("div",{style:e.banner,children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Make sure you trust this external user before sharing any content",id:"grantPageAccessActivityAction.externalWarning"})})}function tt(e,t){const i=e.getValue();if(!i)return;const o=t.getPermissionItems();for(const s of o){if(i.for_actor_table===y.KJ&&(0,Ne.jg)(s)&&s.user_id===i.for_actor_id)return s;if(i.for_actor_table===Fe.cZ&&(0,Ne.FB)(s)&&s.bot_id===i.for_actor_id)return s}}function it(e){return{tab:We.Jn(),activityId:null==e?void 0:e.activity_id,notificationId:null==e?void 0:e.id}}function ot(e,t){const i={height:26,paddingLeft:8,paddingRight:8,boxShadow:t.plainButtonBoxShadow,fontSize:12,marginRight:10};return e?i:{...i,color:t.regularTextColor,fontWeight:500}}function st(e){let{notification:t,accessRequestStore:i,useInboxRedesign:o}=e;const s=(0,c.O7)();return t?t.visited?null:(0,ae.jsx)(le,{children:(0,ae.jsx)(Ce.Z,{onClick:e=>function(e,t,i,o){o&&(0,Z.ZP)({event:e,context:Z.Af.NotificationClick,callback:()=>{V.createAndCommit({userAction:"GrantPageAccessActivityAction.handleArchive",environment:i,perform:e=>{K.aZ({notification:o,rootStore:t,transaction:e})}});const e=t.id,s=it(o);Be.cO(i,{...s,requestId:e})}})}(e,i,s,t),style:{height:26,paddingLeft:8,paddingRight:8},children:o?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Deny",id:"grantPageAccessActivityAction.ignoreButton.label.deny"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Ignore",id:"grantPageAccessActivityAction.ignoreButton.label"})})}):null}function nt(e,t,i,o){const s=tt(e,t),n=s&&s.role;return o.state||n||i}function rt(e,t,i,o){const s=function(e,t,i,o){const s=e.getValue();if(s)return s.for_actor_table===y.KJ?{type:"user_permission",user_id:s.for_actor_id,role:nt(e,t,i,o)}:s.for_actor_table===Fe.cZ?{type:"bot_permission",bot_id:s.for_actor_id,role:nt(e,t,i,o)}:void(s.for_actor_table!==De.y0&&(0,d.t1)(s.for_actor_table))}(e,t,i,o);if(!s)return{};if(tt(e,t))return{permissionItem:s};const n=Ye.subscriptionDataStoreInstance.state;if("user_permission"===s.type){const t=e.getRecordValue({table:y.KJ,id:s.user_id}),i=n?Je.CM(n):[],o=i&&i.some((e=>e.userId===s.user_id));return t&&!o?{type:"existingUser",value:t,permissionItem:s}:{permissionItem:s}}if("bot_permission"===s.type){const t=e.getRecordValue({table:Fe.cZ,id:s.bot_id}),i=(n?Je.NM(n):[]).some((e=>e.botId===s.bot_id));return t&&!i?{type:"bot",value:t,permissionItem:s}:{permissionItem:s}}(0,d.t1)(s)}function at(e,t,i){if(e===y.KJ){const o=i.getRecordValue({table:e,id:t});if(o)return(0,Ie.dp)(o)}if(e===Fe.cZ){const o=i.getRecordValue({table:e,id:t});if(o)return(0,Ie.D$)(o)}}async function dt(e,t,i,o,s,n,r,a){if(o.getKeyStore("for_actor_table").getValue()!==y.KJ)return;const l=o.getKeyStore("for_actor_id").getValue(),c=(0,Ge.Dt)({userId:l,store:i}).role,u=rt(o,i,s,n);if(!("permissionItem"in u))return;a&&(u.permissionItem.role=a);const m=t.currentUser.id;if(m){if("type"in u&&!a){let e;if("existingUser"===u.type){e=(await Ee.n_({environment:t,store:i,inviteTargets:[u],inviteRole:u.permissionItem.role,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else if("bot"===u.type){e=(await Ee.n_({environment:t,store:i,inviteTargets:[u],inviteRole:void 0,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else(0,d.t1)(u);if(!e)return}(0,Z.ZP)({event:e,context:Z.Af.NotificationClick,callback:()=>{V.createAndCommit({userAction:"GrantPageAccessActivityAction.handleGrantPageAccess",environment:t,perform:e=>{"type"in u||Ee.l3({environment:t,transaction:e,store:i,permissionItems:[u.permissionItem]}),r&&K.$h({notification:r,rootStore:i,transaction:e,read:!0}),ze.sW({store:o,transaction:e,data:{granted_time:Date.now(),granted_by_table:y.KJ,granted_by_id:m,resolved_time:Date.now(),resolved_by_table:y.KJ,resolved_by_id:m,status:"approved"}})}});const e=o.isDefined(),s=o.getKeyStore("id").getValue(),n=o.getKeyStore("created_time").getValue(),a=o.getKeyStore("resolved_time").getValue(),d=e&&n&&a?a-n:void 0;Be.nC(t,{requestId:s,timeElapsedSinceRequest:d,newAccessLevel:u.permissionItem.role,prevAccessLevel:c,...it(r)})}})}}function lt(e){let{table:t,id:i,accessRequestStore:o,useInboxRedesign:s}=e;const n=(0,u.VK)((()=>{const e=B.oA([at(t,i,o)]);return(0,l.XW)(e,{...(0,C.h_)({useInboxRedesign:s})})}),[t,i,o,s]);return(0,ae.jsx)(ae.Fragment,{children:n})}function ct(e){let{accessRequestValue:t,accessRequestStore:i,notification:s,targetBlockStore:n,useInboxRedesign:r,initialRole:a,roleStore:d,rootStore:l}=e;const g=(0,m.Fg)(),p=(0,c.O7)(),b=(0,o.useCallback)((e=>function(e,t,i,o,s){const n=i.id,r=o.state;o.setState(e),Be.If(t,{requestId:n,previousAccessLevel:r,newAccessLevel:e,...it(s)})}(e,p,i,d,s)),[p,i,d,s]),M=t.parent_table===f.bx,S=(0,u.VK)((()=>tt(i,n)),[i,n]),j=(0,u.VK)((()=>nt(i,n,a,d)),[i,n,a,d]),k=(0,h.b5)(t),C=(0,u.VK)((()=>(0,A.B)(t,l)),[t,l]),_=(0,u.VK)((()=>n.getType()),[n]);if(S&&!M){const e=(0,ae.jsx)(lt,{accessRequestStore:i,useInboxRedesign:r,table:t.for_actor_table,id:t.for_actor_id}),o=S.role===j;if(!k||k&&(0,Ne.J5)(S.role))return(0,ae.jsxs)(ae.Fragment,{children:[k?(0,ae.jsx)(_e.Z,{isSecondaryColor:!0,isMultiline:!0,style:{marginBottom:6},children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{requestingUser} already has edit access.",id:"grantPageAccessActivityAction.alreadyHasEditAccess.label",values:{requestingUser:e}})}):(0,ae.jsx)(_e.Z,{isSecondaryColor:!0,isMultiline:!0,style:{marginBottom:6},children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{requestingUser} already has access.",id:"grantPageAccessActivityAction.alreadyHasAccess.label",values:{requestingUser:e}})}),(0,ae.jsx)(le,{children:(0,ae.jsx)($e.ZP,{upgradeButtonName:"user_permission_item",role:j,table:v.iU,blockType:_,type:t.for_actor_table===y.KJ?"user_permission":"bot_permission",onChange:b,isInvite:!0,buttonStyle:ot(!0,g)})}),(0,ae.jsx)(le,{children:(0,ae.jsx)(Ce.Z,{onClick:e=>dt(e,p,n,i,a,d,s),style:ot(o,g),children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Change",id:"grantPageAccessActivityAction.changePermissionButton.label"})})}),(0,ae.jsx)(st,{notification:s,accessRequestStore:i,useInboxRedesign:r})]})}return(0,ae.jsxs)(ae.Fragment,{children:[C&&(0,ae.jsx)(et,{}),(0,ae.jsx)(le,{children:!k&&(0,ae.jsx)($e.ZP,{upgradeButtonName:"user_permission_item",role:j,table:v.iU,blockType:_,type:t.for_actor_table===y.KJ?"user_permission":"bot_permission",onChange:b,isInvite:!0,buttonStyle:ot(!1,g)})}),(0,ae.jsx)(le,{children:k?(0,ae.jsx)(Ce.Z,{onClick:e=>dt(e,p,n,i,a,d,s,"read_and_write"),style:ot(!1,g),children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Approve",id:"grantPageAccessActivityAction.grantEditAccessButton.label.approve"})}):(0,ae.jsx)(Ce.Z,{onClick:e=>dt(e,p,n,i,a,d,s),style:ot(!1,g),children:r?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Approve",id:"grantPageAccessActivityAction.grantAccessButton.label.approve"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Grant access",id:"grantPageAccessActivityAction.grantAccessButton.label"})})}),(0,ae.jsx)(st,{notification:s,accessRequestStore:i,useInboxRedesign:r})]})}function ut(e){let{accessRequestValue:t,accessRequestStore:i,useInboxRedesign:o}=e;const s=(0,x.useIntl)(),n=(0,m.Fg)(),r=(0,ae.jsx)(lt,{accessRequestStore:i,useInboxRedesign:o,table:t.granted_by_table,id:t.granted_by_id}),a=(0,R.Yx)(Math.min(t.granted_time,Date.now()),"medium_with_time",(0,w.E2)(s));return o?(0,ae.jsx)("div",{style:{fontSize:12,color:n.text.secondary},children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Approved by {grantedBy} on {time}",id:"grantPageAccessActivityAction.accessGrantedWithTime.title",values:{grantedBy:r,time:a}})}):(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(_e.Z,{isSecondaryColor:!0,children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Approved by {grantedBy}",id:"grantPageAccessActivityAction.accessGranted.title",values:{grantedBy:r,time:a}})}),(0,ae.jsx)(_e.Z,{isSmall:!0,isSecondaryColor:!0,children:a})]})}var mt=i(574970),gt=i(917022),pt=i(912472),ht=i(722649),vt=i(78976);const ft=16,bt=12;function yt(e){const[t,i]=(0,o.useState)(!1),[s,n]=(0,o.useState)(!1),{notification:r,prominentTitleLink:a,children:d,rootStore:l,icon:g,isPrivate:p,isLast:h,onBacklinkClicked:v,onArchiveClicked:f,onUnarchiveClicked:b,onNotificationFrameClicked:y,onMarkAsReadClicked:x,onMarkAsUnreadClicked:M,showRecordPath:S,navigableBlockId:A,showSnapshotButton:j,timestamp:k,header:C}=e,_=(0,c.O7)(),R=(0,u.VK)((()=>"mentions"===J.ZP.state.currentTab),[]),w=!r||r.read,I=_.device.isMobile,F=(0,u.VK)((()=>{const e=_.WindowSizeStore.state;return{left:e.paddingLeftCSS,right:e.paddingRightCSS}}),[_.WindowSizeStore]),B=(0,m.yK)((e=>({container:{paddingTop:bt,paddingBottom:d?12:8,paddingLeft:I?F.left:0,paddingRight:I?F.right:0},headerAndAvatar:{display:"flex",paddingLeft:ft,paddingRight:ft},avatarAndStatusDot:{display:"flex",alignItems:"flex-start",position:"relative"},statusDot:{position:"absolute",opacity:1,left:-7,top:10},statusDotWrapper:{marginRight:I?3:2},privatePageBadge:{marginTop:1,marginBottom:4,marginLeft:8},divider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[d,F,I]),T=(0,o.useCallback)((e=>{r&&!r.read&&(s||(0,Z.ZP)({event:e,context:Z.Af.NotificationClick,callback:()=>{y(),V.createAndCommit({userAction:"ActivityNotificationSection.handleMarkAsRead",environment:_,perform:e=>{K.$h({notification:r,rootStore:l,transaction:e,read:!0})}})}}))}),[_,s,r,y,l]),P=(0,o.useCallback)((()=>i(!0)),[]),U=(0,o.useCallback)((()=>i(!1)),[]),q=(0,o.useId)();return(0,ae.jsxs)("article",{onMouseOver:P,onMouseLeave:U,onClick:T,"aria-labelledby":q,tabIndex:0,children:[(0,ae.jsx)(xt,{notification:r,rootStore:l,isMobile:I,isHovered:t,isMentionsTab:R,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onArchiveClicked:f,onUnarchiveClicked:b,onMarkAsReadClicked:x,onMarkAsUnreadClicked:M}),(0,ae.jsxs)("div",{style:B.container,children:[(0,ae.jsxs)("div",{style:B.headerAndAvatar,children:[(0,ae.jsxs)("div",{className:O.FoE,style:B.avatarAndStatusDot,children:[(0,ae.jsx)("div",{style:{marginRight:4},children:R&&(0,ae.jsx)("div",{style:B.statusDotWrapper,children:!w&&(0,ae.jsx)(re.z,{style:B.statusDot})})}),g]}),(0,ae.jsx)(Mt,{timestamp:k,header:C,prominentTitleLink:a,hasChildren:Boolean(d),navigableBlockId:A,rootStore:l,onBacklinkClick:v,showRecordPath:S,titleAriaId:q}),j&&A&&(0,ae.jsx)(St,{timestamp:k,navigableBlockId:A,rootStore:l}),p&&!r&&(0,ae.jsx)(ne.Z,{style:B.privatePageBadge})]}),d&&(0,ae.jsx)("div",{className:O.nU_,children:d})]}),!h&&(0,ae.jsx)("div",{style:B.divider})]})}function xt(e){const{notification:t,rootStore:i,isMobile:o,isHovered:s,isMentionsTab:n,onArchiveClicked:r,onUnarchiveClicked:a,onMarkAsReadClicked:d,onMarkAsUnreadClicked:l,onMouseEnter:c,onMouseLeave:u}=e,g=(0,m.yK)((()=>({container:{display:"flex",alignItems:"flex-start",position:"relative"},body:{transition:"opacity 100ms ease-out",opacity:o||s?1:0,position:"absolute",right:ft,top:bt,zIndex:1}})),[o,s]);return n&&t?t.visited?null:(0,ae.jsx)("div",{style:g.container,onMouseEnter:c,onMouseLeave:u,children:(0,ae.jsx)("div",{style:g.body,children:(0,ae.jsx)(D.lD,{notification:t,rootStore:i,onArchiveClicked:r,onUnarchiveClicked:a,onMarkAsReadClicked:d,onMarkAsUnreadClicked:l,useInboxRedesign:!1})})}):null}function Mt(e){const{timestamp:t,prominentTitleLink:i,header:o,hasChildren:s,navigableBlockId:n,rootStore:r,showRecordPath:a,onBacklinkClick:d,titleAriaId:l}=e,u=(0,L.IS)(t,{useUltraCompactFormat:!0}),g=(0,c.O7)().device.isMobile,p=(0,L.uy)(t),h=(0,m.yK)((e=>({container:{width:"100%"},header:{width:g?"calc(100% - 98px)":"100%",fontSize:14,lineHeight:1.4,minWidth:0,minHeight:g?28:void 0,display:"flex",alignItems:"baseline",justifyContent:"space-between"},flatIndentHeader:{width:g?"calc(100% - 98px)":"100%",fontSize:14,lineHeight:1.4,minWidth:0,minHeight:g?28:void 0,display:"flex",justifyContent:"space-between",alignItems:"baseline"},title:{fontSize:14,marginTop:4,marginBottom:s?8:4},time:{fontSize:12,color:e.lightTextColor,whiteSpace:"nowrap",display:"inline",paddingLeft:6},path:{marginTop:4,marginBottom:4},separatorDot:{fontSize:12,color:e.lightTextColor,marginLeft:4,marginRight:4}})),[s,g]);return(0,ae.jsxs)("div",{style:h.container,children:[(0,ae.jsxs)("div",{className:O.NFf,style:h.header,children:[(0,ae.jsx)("span",{id:l,children:o}),(0,ae.jsx)("div",{style:h.time,className:O.CZG,children:(0,ae.jsx)(se.Z,{text:u,tooltipText:p,icon:I.C})})]}),a&&n&&r&&(0,ae.jsx)("div",{style:h.path,children:(0,ae.jsx)(ee.ZP,{isLink:!0,store:_.G.createChildStore(r,{table:v.iU,id:n}),onClick:d})}),i&&(0,ae.jsx)("div",{style:h.title,children:i})]})}function St(e){const{timestamp:t,navigableBlockId:i,rootStore:o}=e,s=(0,c.O7)();if(t<new Date("2018-10-26").getTime())return null;const n=j.default.getIntl().formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"}),r=()=>{const e=_.G.createChildStore(o,{table:v.iU,id:i});T.jN({environment:s,blockStore:e,openSnapshotNearTimestamp:t.toString(),from:"activity"})};return(0,ae.jsx)(ie.Z,{renderTooltip:()=>n,render:e=>(0,ae.jsx)(X.Z,{ariaLabel:n,onClick:r,icon:F.J,...e})})}const At=o.memo(yt);function jt(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:n,useInboxRedesign:r}=e,{notification:a,tab:d,source:g}=o,f=(0,c.O7)(),b=(0,c.Fy)(),M=(0,u.VK)((()=>t.getEdits()),[t]),S=M[0],j=b.isMobile,k=(0,m.yK)((()=>({message:{paddingLeft:r?void 0:(0,ht.c3)({source:g,isMobile:j}),paddingRight:r?0:16,marginTop:r?0:8,marginBottom:8},messageLabel:{whiteSpace:"pre-wrap"},titleStyle:{fontSize:14,display:"flex"}})),[g,j,r]),R=(0,u.VK)((()=>_.oK.createChildStore(i,{table:h.J8,id:t.access_request_id})),[t,i]),w=(0,u.VK)((()=>R.getModel()),[R]),I=(0,u.VK)((()=>Boolean(w&&(0,A.B)(w,i))),[w,i]),F=w&&(0,ae.jsx)(kt,{activity:t,accessRequest:w,rootStore:i,tabArgs:o,useInboxRedesign:r}),B=S.message,K=(0,u.VK)((()=>(0,l.P6)({edits:M,rootStore:i})),[M,i]),T=(0,u.VK)((()=>{if(!w)return;const e=w.getForActorPointer(i.id),t=e.table===y.KJ?_.U6.createChildStore(i,e):void 0,o=null==t?void 0:t.getModel();return null==o?void 0:o.getEmail()}),[w,i]),V=(0,u.VK)((()=>I&&T?T:(0,l.XW)(K,{...(0,C.h_)({useInboxRedesign:r})})),[K,r,I,T]),O=(0,u.VK)((()=>parseInt(t.end_time)),[t]),P=(0,u.VK)((()=>{if(null!=w&&w.isGuestInviteRequest()){const e=w.getAttributes().permission_records_and_roles[0],s=e&&_.G.createChildStore(i,{table:v.iU,id:e.id}),n=e.role;if(r&&s.isDefined())return;return(0,ae.jsx)(vt.Z,{titledRecordStore:s,activity:t,tabArgs:o,getRecordModel:i.getRecordModel,permissionRole:n,shouldRenderEmpty:!0})}}),[o,w,t,i,r]),Z=(0,u.VK)((()=>{if(t.navigable_block_id)return _.G.createChildStore(i,{table:v.iU,id:t.navigable_block_id})}),[t,i]),U=(0,u.VK)((()=>{if(!Z)return;const e=Z.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,discussionId:t.discussion_id,pageVisitSource:p.tY.Notification}):void 0}),[Z,i,t]);return F?r?(0,ae.jsxs)(ke,{header:(0,ae.jsx)("span",{children:F}),isFirst:s,isLast:n,isPrivate:!1,rootStore:i,notification:a,icon:(0,ae.jsx)(mt.BE,{authors:K,size:ue,style:{marginTop:0,marginRight:0},iconStyle:{right:-3},showAvatarShadow:!1,showWarningIcon:I}),showSnapshotButton:!1,url:U,...(0,gt.JJ)({notification:a,activity:t,environment:f,tab:d}),children:[B&&(0,ae.jsx)("div",{style:k.message,children:(0,ae.jsx)(_e.Z,{isMultiline:!0,style:k.messageLabel,children:B})}),P&&(0,ae.jsx)("div",{style:k.titleStyle,children:P}),(0,ae.jsx)(It,{activity:t,accessRequestStore:R,rootStore:i,source:g,notification:a,useInboxRedesign:!0})]}):(0,ae.jsxs)(At,{timestamp:O,header:(0,ae.jsx)("span",{children:F}),isLast:n,isPrivate:!1,rootStore:i,showRecordPath:!1,notification:a,icon:(0,ae.jsx)(mt.BE,{authors:K,size:24,showWarningIcon:I}),showSnapshotButton:!1,prominentTitleLink:P,...(0,gt.h9)({notification:a,activity:t,environment:f,tab:d}),children:[B&&(0,ae.jsxs)("div",{style:k.message,children:[(0,ae.jsx)(_e.Z,{isSmall:!0,children:(0,ae.jsx)(x.FormattedMessage,{id:"activity.accessRequested.messageLabel",defaultMessage:"Message from {author}",values:{author:V}})}),(0,ae.jsx)(_e.Z,{isMultiline:!0,style:k.messageLabel,children:B})]}),(0,ae.jsx)(It,{activity:t,accessRequestStore:R,rootStore:i,source:g,notification:a,useInboxRedesign:!1}),(0,ae.jsx)(pt.Z,{tabArgs:o,activity:t,isMobile:f.device.isMobile,environment:f,rootStore:i})]}):null}function kt(e){const{activity:t,accessRequest:i,rootStore:o,tabArgs:s,useInboxRedesign:n}=e,r=(0,k.v)({spaceStore:o,request:i});if(!r)return null;switch(r){case"guest_invite_request":return(0,ae.jsx)(Rt,{activity:t,accessRequest:i,rootStore:o,useInboxRedesign:n});case"space_membership_request":return(0,ae.jsx)(_t,{activity:t,accessRequest:i,rootStore:o,useInboxRedesign:n});case"team_membership_request":return(0,ae.jsx)(wt,{activity:t,rootStore:o,tabArgs:s,useInboxRedesign:n});case"page_access_request":return(0,ae.jsx)(Ct,{activity:t,tabArgs:s,rootStore:o,useInboxRedesign:n,accessRequest:i});default:(0,d.t1)(r)}}function Ct(e){const{activity:t,rootStore:i,tabArgs:o,useInboxRedesign:s,accessRequest:n}=e,r=(0,u.VK)((()=>t.getEdits()),[t]),a=(0,u.VK)((()=>{const e=n.getForActorPointer(i.id),t=e.table===y.KJ?_.U6.createChildStore(i,e):void 0,o=null==t?void 0:t.getModel();return null==o?void 0:o.getEmail()}),[n,i]),d=(0,u.VK)((()=>Boolean(n&&(0,A.B)(n,i))),[n,i]),c=(0,u.VK)((()=>(0,l.P6)({edits:r,rootStore:i})),[r,i]),m=(0,u.VK)((()=>d&&a?(0,l.m4)(a,(0,C.h_)({useInboxRedesign:s})):(0,l.XW)(c,{...(0,C.h_)({useInboxRedesign:s})})),[d,a,c,s]),g=(0,u.VK)((()=>{if(t.navigable_block_id)return _.G.createChildStore(i,{table:v.iU,id:t.navigable_block_id})}),[t,i]),p=(0,u.VK)((()=>n.isEditPageAccessRequest()),[n]);return g?p?s?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested edit access to} other {{authorOrAuthors} requested edit access to}}",values:{numberOfAuthors:c.length,authorOrAuthors:m},id:"activity.editAccessRequested.header.short"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested edit access to {pageName}} other {{authorOrAuthors} requested edit access to {pageName}}}",values:{numberOfAuthors:c.length,authorOrAuthors:m,pageName:(0,ae.jsx)(vt.Z,{titledRecordStore:g,activity:t,tabArgs:o,getRecordModel:i.getRecordModel})},id:"activity.editAccessRequested.header"}):s?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested access to} other {{authorOrAuthors} requested access to}}",values:{numberOfAuthors:c.length,authorOrAuthors:m},id:"activity.accessRequested.header.short"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested access to {pageName}} other {{authorOrAuthors} requested access to {pageName}}}",values:{numberOfAuthors:c.length,authorOrAuthors:m,pageName:(0,ae.jsx)(vt.Z,{titledRecordStore:g,activity:t,tabArgs:o,getRecordModel:i.getRecordModel})},id:"activity.accessRequested.header"}):null}function _t(e){const{activity:t,accessRequest:i,rootStore:o,useInboxRedesign:s}=e,n=(0,u.VK)((()=>t.getEdits()),[t]),r=(0,m.yK)((()=>({inviteePhrase:{fontWeight:M.Z.fontWeight.semibold}})),[]),a=(0,u.VK)((()=>i.getForActorPointer(o.id)),[i,o.id]),d=a.table===y.KJ?_.U6.createChildStore(o,a):void 0,c=(0,u.VK)((()=>null==d?void 0:d.getModel()),[d]),g=(0,u.VK)((()=>null==c?void 0:c.getEmail()),[c]),p=(0,u.VK)((()=>i.getForActorId()===i.getCreatedById()),[i]),h=(0,u.VK)((()=>(0,l.P6)({edits:n,rootStore:o})),[n,o]),v=(0,u.VK)((()=>(0,l.XW)(h,{...(0,C.h_)({useInboxRedesign:s})})),[h,s]),f=(0,u.VK)((()=>{if(!p)return g;const e=null==c?void 0:c.getFullName(j.default.getIntl());return e?`${e} (${g})`:g}),[p,c,g]);return c&&a.table===y.KJ?p?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{invitee} requested to become a workspace member",values:{invitee:(0,ae.jsx)("span",{style:r.inviteePhrase,children:f})},id:"activity.accessRequestedMembershipFromGuest.header"}):s?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested to add {invitee} as a workspace member} other {{authorOrAuthors} requested to add {invitee} as a workspace member}}",values:{numberOfAuthors:h.length,authorOrAuthors:v,invitee:(0,ae.jsx)("span",{style:r.inviteePhrase,children:f})},id:"activity.accessRequestedMembership.header.short"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested {invitee} to become a workspace member} other {{authorOrAuthors} requested {invitee} to become a workspace member}}",values:{numberOfAuthors:h.length,authorOrAuthors:v,invitee:(0,ae.jsx)("span",{style:r.inviteePhrase,children:f})},id:"activity.accessRequestedMembership.header"}):null}function Rt(e){const{activity:t,accessRequest:i,rootStore:o,useInboxRedesign:s}=e,n=(0,u.VK)((()=>t.getEdits()),[t]),r=(0,m.yK)((()=>({inviteePhrase:{fontWeight:M.Z.fontWeight.semibold}})),[]),a=(0,u.VK)((()=>i.getForActorPointer(o.id)),[i,o.id]),d=a.table===y.KJ?_.U6.createChildStore(o,a):void 0,c=(0,u.VK)((()=>null==d?void 0:d.getModel()),[d]),g=(0,u.VK)((()=>null==c?void 0:c.getEmail()),[c]),p=(0,u.VK)((()=>(0,l.P6)({edits:n,rootStore:o})),[n,o]),h=(0,u.VK)((()=>(0,l.XW)(p,{...(0,C.h_)({useInboxRedesign:s})})),[p,s]);return(0,u.VK)((()=>i.isGuestInviteRequest()),[i])&&c&&a.table===y.KJ?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{requestorsPhrase} requested inviting {guestEmail} as a guest",values:{requestorsPhrase:h,guestEmail:(0,ae.jsx)("span",{style:r.inviteePhrase,children:g})},id:"activity.guestInviteRequest.header.short"}):null}function wt(e){const{activity:t,rootStore:i,tabArgs:o,useInboxRedesign:s}=e,n=(0,u.VK)((()=>t.getEdits()),[t]),r=(0,u.VK)((()=>(0,l.P6)({edits:n,rootStore:i})),[n,i]),a=(0,u.VK)((()=>(0,l.XW)(r,{...(0,C.h_)({useInboxRedesign:s})})),[r,s]),d=(0,u.VK)((()=>{if(t.team_id)return _.zX.createChildStore(i,{table:b.e0,id:t.team_id})}),[t,i]);return n&&d?s?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{user} requested to join {teamName}",values:{user:(0,ae.jsx)("span",{style:{fontWeight:M.Z.fontWeight.semibold},children:a}),teamName:(0,ae.jsx)(vt.Z,{titledRecordStore:d,getRecordModel:i.getRecordModel,activity:t,tabArgs:o})},id:"activity.teamAccessRequest.header.short"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{user} requested to become a member of {teamName}",values:{user:(0,ae.jsx)("span",{style:{fontWeight:M.Z.fontWeight.semibold},children:a}),teamName:(0,ae.jsx)(vt.Z,{titledRecordStore:d,getRecordModel:i.getRecordModel,activity:t,tabArgs:o})},id:"activity.teamAccessRequest.header"}):null}function It(e){const{activity:t,accessRequestStore:i,rootStore:s,source:n,notification:r,useInboxRedesign:a}=e,l=(0,c.O7)(),p=(0,u.VK)((()=>t.getEdits()),[t])[0],h=(0,u.VK)((()=>i.getParentTable()),[i]),y=(0,u.VK)((()=>i.getParentId()),[i]),x=(0,u.VK)((()=>i.getModel()),[i]),M=(0,u.VK)((()=>x&&(0,g.Z)(x)),[x]),A=(0,k.v)({spaceStore:s,request:x}),j=(0,u.VK)((()=>{if("page_access_request"===M){var e;const t=null==x||null===(e=x.getAttributes())||void 0===e||null===(e=e.permission_records_and_roles)||void 0===e||null===(e=e.at(0))||void 0===e?void 0:e.role;if(t)return t}return"reader"}),[x,M]),C=(0,o.useCallback)((async()=>{if(M&&A&&x)if("space_membership_request"===A&&"space_membership_request"===M)await S.YN({status:"approved",environment:l,requests:[x],store:s,from:"notification"});else if("space_membership_request"===A&&"guest_invite_request"===M)await S.fJ({status:"approved",environment:l,store:s,requests:[x],from:"notification"});else{if("guest_invite_request"!==M)return;await S.mY({status:"approved",environment:l,requests:[x],from:"notification"})}}),[l,x,s,A,M]),R=(0,o.useCallback)((async()=>{if(M&&x)if("space_membership_request"===M)await S.YN({status:"rejected",environment:l,requests:[x],store:s,from:"notification"});else if("guest_invite_request"===M)await S.mY({status:"rejected",environment:l,requests:[x],from:"notification"});else{if("team_membership_request"===M||"page_access_request"===M)return;(0,d.t1)(M)}}),[l,x,s,M]),w=l.device.isMobile,I=(0,m.yK)((e=>({actionPrimaryContainer:{paddingLeft:a?void 0:(0,ht.c3)({source:n,isMobile:w}),paddingTop:a?4:12,paddingBottom:a?0:8,paddingRight:a?0:16},actionButton:(0,ht.b9)(e)})),[n,w,a]),F=y?_.G.createChildStore(s,{table:v.iU,id:y}):void 0,B=(0,u.VK)((()=>h===v.iU&&Boolean(null==F?void 0:F.canAdmin())),[h,F]);if(!(h&&y&&A&&p))return null;if("page_access_request"===A)return B&&F?(0,ae.jsx)("div",{style:I.actionPrimaryContainer,children:(0,ae.jsx)(Qe,{accessRequestStore:i,targetBlockStore:F,initialRole:j,buttonStyle:I.actionButton,notification:r,useInboxRedesign:a,rootStore:s})}):null;if("space_membership_request"===A||"guest_invite_request"===A){const e=_.H2.createChildStore(s,{table:f.bx,id:y});return(0,ae.jsx)("div",{style:I.actionPrimaryContainer,children:(0,ae.jsx)(Oe,{effectiveAccessRequestType:A,accessRequestStore:i,spaceStore:e,initialRole:"reader",buttonStyle:I.actionButton,notification:r,useInboxRedesign:a,onApprove:C,onReject:R})})}if("team_membership_request"===A){const e=_.zX.createChildStore(s,{table:b.e0,id:y});return(0,ae.jsx)("div",{style:I.actionPrimaryContainer,children:(0,ae.jsx)(we,{accessRequestStore:i,teamStore:e,useInboxRedesign:a})})}(0,d.t1)(A)}const Ft=o.memo(jt);function Bt(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:n,useInboxRedesign:r}=e,{notification:a,tab:d}=o,m=(0,c.O7)(),g=(0,u.VK)((()=>t.getEdits()),[t]),f=(0,u.VK)((()=>_.oK.createChildStore(i,{table:h.J8,id:t.access_request_id})),[t,i]),b=(0,u.VK)((()=>{const e=f.getModel();return e&&e.isGuestInviteRequest()&&e.isResolved()||e&&e.isEditPageAccessRequest()&&e.isApproved()?e:void 0}),[f]),y=(0,u.VK)((()=>Boolean(null==b?void 0:b.isEditPageAccessRequest())),[b]),x=(0,u.VK)((()=>{var e;if(!b)return;return null===(e=b.getAttributes().permission_records_and_roles[0])||void 0===e?void 0:e.role}),[b]),M=(0,u.VK)((()=>(0,l.P6)({edits:g,rootStore:i})),[g,i]),S=(0,u.VK)((()=>{if(t.navigable_block_id)return _.G.createChildStore(i,{table:v.iU,id:t.navigable_block_id})}),[t,i]),A=b&&(0,ae.jsx)(Kt,{activity:t,accessRequest:b,rootStore:i,useInboxRedesign:r,isEditAccessRequest:y}),j=S&&(0,ae.jsx)(vt.Z,{titledRecordStore:S,activity:t,tabArgs:o,getRecordModel:i.getRecordModel,permissionRole:x,shouldRenderEmpty:!0}),k=(0,u.VK)((()=>parseInt(t.end_time)),[t]),C=(0,u.VK)((()=>{if(!S)return;const e=S.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,discussionId:t.discussion_id,pageVisitSource:p.tY.Notification}):void 0}),[S,i,t]);return A&&S?r?(0,ae.jsx)(ke,{header:(0,ae.jsx)("span",{children:A}),isFirst:s,isLast:n,isPrivate:!1,rootStore:i,notification:a,icon:(0,ae.jsx)(mt.BE,{authors:M,size:ue,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:C,...(0,gt.JJ)({notification:a,activity:t,environment:m,tab:d})}):(0,ae.jsx)(At,{timestamp:k,header:(0,ae.jsx)("span",{children:A}),isLast:n,isPrivate:!1,rootStore:i,showRecordPath:!1,notification:a,icon:(0,ae.jsx)(mt.BE,{authors:M,size:24}),showSnapshotButton:!1,prominentTitleLink:j,...(0,gt.h9)({notification:a,activity:t,environment:m,tab:d}),children:(0,ae.jsx)(pt.Z,{tabArgs:o,activity:t,isMobile:m.device.isMobile,environment:m,rootStore:i})}):null}function Kt(e){const{accessRequest:t,rootStore:i,useInboxRedesign:o,isEditAccessRequest:s}=e,n=(0,m.yK)((()=>({inviteePhrase:{fontWeight:o?M.Z.fontWeight.medium:M.Z.fontWeight.semibold}})),[o]),r=(0,u.VK)((()=>i.getRecordModel({id:t.getForActorId(),table:t.getForActorTable()})),[t,i]),a=(0,u.VK)((()=>null==r?void 0:r.getEmail()),[r]),c=(0,u.VK)((()=>{const e=(null==r?void 0:r.isUser())&&(null==r?void 0:r.getFullName(j.default.getIntl()));return e?`${e} (${a})`:a}),[r,a]),g=(0,u.VK)((()=>i.getRecordModel({id:t.getResolvedById(),table:t.getResolvedByTable()})),[t,i]),p=(0,u.VK)((()=>g&&(0,l.XW)([g],{fontWeight:o?M.Z.fontWeight.medium:M.Z.fontWeight.semibold})),[g,o]),h=(0,u.VK)((()=>t.getStatus()),[t]);return p&&c?s?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{resolverPhrase} approved your request to edit the page",values:{resolverPhrase:p},id:"activity.EditAccessRequestResolvedMembership.approved.header.short"}):"approved"===h?o?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{resolverPhrase} approved your request to invite {invitee} as a guest",values:{resolverPhrase:p,invitee:(0,ae.jsx)("span",{style:n.inviteePhrase,children:c})},id:"activity.AccessRequestResolvedMembership.approved.header.short"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{resolverName} approved your request to invite {invitee} as a guest",values:{resolverName:p,invitee:(0,ae.jsx)("span",{style:n.inviteePhrase,children:c})},id:"activity.AccessRequestResolvedMembership.approved.header.long"}):"rejected"===h?o?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{resolverPhrase} denied your request to invite {invitee} as a guest",values:{resolverPhrase:p,invitee:(0,ae.jsx)("span",{style:n.inviteePhrase,children:c})},id:"activity.AccessRequestResolvedMembership.rejected.header.short"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{resolverName} rejected your request to invite {invitee} as a guest",values:{resolverName:p,invitee:(0,ae.jsx)("span",{style:n.inviteePhrase,children:c})},id:"activity.AccessRequestResolvedMembership.rejected.header.long"}):void(0,d.t1)(h):null}const Tt=o.memo(Bt);var Vt=i(541432),Ot=i(89101),Pt=i(399108),Zt=i(584076),Ut=i(363381),qt=i(813658);function Lt(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:n,useInboxRedesign:r}=e,{tab:a,notification:d,source:m}=o,g=(0,u.VK)((()=>(0,Pt.hI)(t.getEdits())),[t]),h=g.length>0,f=(0,u.VK)((()=>_.G.createChildStore(i,{table:v.iU,id:g[0].navigable_block_id})),[i,g]),b=(0,u.VK)((()=>{const e=f.getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:p.tY.Notification})}),[f,i]),y=(0,u.VK)((()=>(0,l.P6)({edits:g,rootStore:i})),[g,i]),M=(0,c.O7)(),S=(0,u.VK)((()=>(0,l.XW)(y,{...(0,C.h_)({useInboxRedesign:r})})),[y,r]),A=(0,u.VK)((()=>(0,l.jC)({recordId:f.id,recordType:"block",tab:a,rootStore:i,environment:M})),[f,a,i,M]),j=(0,u.VK)((()=>f.isDefined()),[f]),k=(0,u.VK)((()=>parseInt(t.end_time)),[t]);if(!j||!h)return null;const R=(0,ae.jsx)(vt.Z,{titledRecordStore:f,getRecordModel:i.getRecordModel,activity:t,tabArgs:o}),w=new Set;return g.forEach((e=>{Object.keys(e.property_updates).forEach((e=>{w.add(e)}))})),r?(0,ae.jsx)(ke,{header:w.size>1?(0,ae.jsx)("span",{children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated properties} other {{authorOrAuthors} updated properties}}",id:"activity.blockEdited.standardizedHeader.multiple",values:{numberOfAuthors:y.length,authorOrAuthors:S}})}):(0,ae.jsx)("span",{children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated a property} other {{authorOrAuthors} updated a property}}",id:"activity.blockEdited.standardizedHeader.single",values:{numberOfAuthors:y.length,authorOrAuthors:S}})}),isFirst:s,isLast:n,isPrivate:A,rootStore:i,navigableBlockId:f.id,notification:d,icon:(0,ae.jsx)(mt.BE,{authors:y,size:ue,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:b,...(0,gt.JJ)({notification:d,activity:t,environment:M,tab:a}),children:(0,ae.jsx)(qt.Z,{visible:5,items:g.map(((e,t)=>(0,ae.jsx)(Ut.Z,{edit:e,rootStore:i},t)))})}):(0,ae.jsxs)(At,{timestamp:k,header:(0,ae.jsx)("span",{children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated {pageTitle}} other {{authorOrAuthors} updated {pageTitle}}}",id:"activity.blockEdited.standardizedHeader",values:{numberOfAuthors:y.length,authorOrAuthors:S,pageTitle:R}})}),isLast:n,isPrivate:A,rootStore:i,navigableBlockId:f.id,notification:d,icon:(0,ae.jsx)(mt.BE,{authors:y,size:24}),showSnapshotButton:!1,showRecordPath:!0,...(0,gt.h9)({notification:d,activity:t,environment:M,tab:a}),children:[(0,ae.jsx)(qt.Z,{visible:5,items:g.map(((e,s)=>(0,ae.jsx)(Nt,{edit:e,rootStore:i,onClick:()=>(0,gt.dG)({environment:M,activity:t,...o}),source:m,isMobile:M.device.isMobile},s)))}),(0,ae.jsx)(pt.Z,{tabArgs:o,activity:t,isMobile:M.device.isMobile,environment:M,rootStore:i})]})}function Nt(e){const{rootStore:t,edit:i,onClick:o,source:s,isMobile:n}=e,r=(0,u.VK)((()=>function(e,t){const i=t.getRecordModel({table:v.iU,id:e.block_id}),o=(null==i?void 0:i.getType())===Vt.Ti.tableRow?t.getRecordModel({table:v.iU,id:i.getParentId()}):i;return null==o?void 0:o.getRenderUrl({getRecordModel:t.getRecordModel,pageVisitSource:p.tY.Notification})}(i,t)||Ot._j.root),[i,t]);return(0,ae.jsx)(Zt.Z,{href:r,onClick:o,innerStyle:(0,ht.OD)({source:s,isMobile:n}),children:(0,ae.jsx)(Ut.Z,{edit:i,rootStore:t})})}var Dt=i(371663),Wt=i(180951),Et=i(750571),zt=i(698519),Gt=i(23867),Ht=i(744805),Jt=i(133767),Yt=i(95306),$t=i(360682),Xt=i(214976),Qt=i(798165),ei=i(165598),ti=i(398530),ii=i(670301),oi=i(45653),si=i(297820),ni=i(392559);function ri(e){const{activity:t,tabArgs:i,rootStore:s,isFirst:n,isLast:g,useInboxRedesign:h}=e,{source:f,tab:b,notification:y}=i,S=(0,u.VK)((()=>t.getEdits()),[t]);let A=S.filter((e=>{switch(e.type){case"comment-changed":return!1;case"comment-created":case"comment-deleted":case"suggestion-created":return!0;default:(0,d.t1)(e)}}));const j=(0,u.VK)((()=>"suggestion-created"===S[0].type),[S]);0===A.length&&0!==S.length&&(A=S);const k=A.length>0,C=(0,c.O7)(),R=(0,u.VK)((()=>{const e=s.getRecordStore(s,{table:a.qF,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,s]),w=(0,u.VK)((()=>R?R.getCommentStores():[]),[R]),I=(0,u.VK)((()=>{const e=null==R?void 0:R.getParentPointer();if(e)return _.G.createChildStore(s,e)}),[R,s]),F=(0,u.VK)((()=>Boolean(I&&I.isDefined())),[I]),K=(0,u.VK)((()=>{const e=null==I?void 0:I.getNavigableBlockStore();return(null==e?void 0:e.id)||t.navigable_block_id}),[t,I]),T=_.G.createChildStore(s,{table:v.iU,id:K}),V=(0,u.VK)((()=>T.isDefined()),[T]),O=(0,u.VK)((()=>Boolean(I&&(0,Qt.fl)((0,Qt.qA)(I)))),[I]),P=(0,u.VK)((()=>H.default.checkGate({gateName:"prevent_edits_trash"})?T.canComment()&&O:T.canComment()),[O,T]),Z=(0,u.VK)((()=>{var e;if(I)return null===(e=I.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:s.getRecordModel,discussionId:t.discussion_id,pageVisitSource:p.tY.Notification})}),[I,s,t]),U=(0,u.VK)((()=>(0,l.P6)({edits:A,rootStore:s})),[A,s]),q=(0,u.VK)((()=>(0,l.XW)(U)),[U]),L=(0,u.VK)((()=>(0,B.mN)(w.map((e=>e.getCreatedByPointer())).filter(d.$K),"id").map((e=>_.t1.createChildStore(s,e)))),[w,s]),N=(0,u.VK)((()=>L.map((e=>e.getModel())).filter(d.$K)),[L]),{backActorStore:D,frontActorStore:W}=(0,u.VK)((()=>{const e=C.currentUser.id;if(!e)return{backActorStore:void 0,frontActorStore:void 0};const t=L.some((t=>t.id===e)),i=L.sort(((t,i)=>(t.id===e?1:0)-(i.id===e?1:0))),o=i.at(0);return{backActorStore:i.at(Math.max(1,i.length-(t?2:1))),frontActorStore:o}}),[C.currentUser.id,L]),E=O,z=(0,m.yK)((()=>({flex:{display:"flex"}})),[]),G=(0,o.useCallback)((e=>{if((0,gt.dG)({...i,environment:C,activity:t,mightCloseTab:E}),!O&&I&&R){var o;const s=e.target;Yt.oK({environment:C,discussionStore:R,rect:s.getBoundingClientRect(),blockStore:I,discussionLocation:pi({forReplyMenu:!0,source:i.source}),activityId:t.id,notificationId:null===(o=i.notification)||void 0===o?void 0:o.id})}}),[t,O,I,R,C,i,E]),J=(0,o.useCallback)((e=>{"Removed"===e?(0,gt.Tq)({...i,environment:C,activity:t,mightCloseTab:E}):"Added"===e?(0,gt.Z5)({...i,environment:C,activity:t,mightCloseTab:E}):(0,d.t1)(e)}),[i,C,t,E]),Y=(0,ae.jsx)(vt.Z,{titledRecordStore:T,getRecordModel:s.getRecordModel,activity:t,tabArgs:i}),$=(0,u.VK)((()=>(0,l.jC)({recordId:K,recordType:v.iU,tab:b,rootStore:s,environment:C})),[K,b,s,C]),X=C.device.isMobile,Q=(0,u.VK)((()=>pi({source:f,forReplyMenu:!1})),[f]),ee=(0,u.VK)((()=>{const e=null==R?void 0:R.getModel();if(e)return(0,l.Pq)(e)}),[R]),te=(0,u.VK)((()=>{const e=T.getAssociatedCollectionStore();return null==e?void 0:e.getDatabaseType()}),[T]),ie=(0,u.VK)((()=>parseInt(t.end_time)),[t]);if(!(k&&V&&F&&R))return r.log({level:"warning",from:"CommentActivityNotification",type:"invalidNotificationData",data:{ids:[(null==y?void 0:y.id)??"unknown"]}}),null;const oe=!ee,se=(0,ae.jsxs)("div",{style:z.flex,children:[oe&&(0,ae.jsx)(ni.Z,{}),Y]}),ne=function(e){let{databaseType:t,authorCount:i,authorPhrase:o}=e;switch(t){case Dt.iS:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a task} other {{authorOrAuthors} commented on a task}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentTaskActivity.standardizedHeader"});case Dt.wW:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a project} other {{authorOrAuthors} commented on a project}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentProjectActivity.standardizedHeader"});case Dt.zU:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a document} other {{authorOrAuthors} commented on a document}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentDocActivity.standardizedHeader"});case Dt.GZ:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a wiki page} other {{authorOrAuthors} commented on a wiki page}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentWikiActivity.standardizedHeader"});case Dt.Fi:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a meeting note} other {{authorOrAuthors} commented on a meeting note}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentMeetingActivity.standardizedHeader"});case Dt.nG:case Dt.Be:case Dt.p$:case void 0:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a page} other {{authorOrAuthors} commented on a page}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentPageActivity.standardizedHeader"});default:(0,d.t1)(t)}}({authorCount:U.length,authorPhrase:q,databaseType:te});return h?(0,ae.jsxs)(ke,{header:(0,ae.jsx)(hi,{authorCount:U.length,authorPhrase:(0,ae.jsx)(ji,{authorsLength:L.length,frontActorStore:W,backActorStore:D,authorTextStyle:{fontWeight:M.Z.fontWeight.medium}}),isSuggestionCreatedActivity:j}),isFirst:n,isLast:g,isPrivate:$,rootStore:s,prominentTitleLink:void 0,navigableBlockId:K,notification:y,icon:W&&D?(0,ae.jsx)(Ai,{frontActorStore:W,backActorStore:D}):N.length>0?(0,ae.jsx)(mt.BE,{authors:N,size:ue,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}):(0,ae.jsx)(ki,{}),showSnapshotButton:!1,url:Z,...(0,gt.JJ)({notification:y,environment:C,tab:b,activity:t}),children:[R&&ee&&(0,ae.jsx)(li,{discussionStore:R,url:Z,onClick:G,rootStore:s,source:f,useInboxRedesign:h,isSuggestionCreatedActivity:j}),R&&(0,ae.jsx)(yi,{discussionStore:R,discussionLocation:Q,onReactionToggle:J}),P&&(0,ae.jsx)(mi,{activity:t,rootStore:s,tabArgs:i,useInboxRedesign:h,isSuggestionCreatedActivity:j}),R&&(0,ae.jsx)(di,{discussionStore:R})]}):(0,ae.jsxs)(At,{timestamp:ie,header:(0,ae.jsx)("span",{children:ne}),isLast:g,isPrivate:$,rootStore:s,prominentTitleLink:se,navigableBlockId:K,notification:y,icon:(0,ae.jsx)(mt.BE,{authors:U,size:24}),showSnapshotButton:!1,showRecordPath:!0,...(0,gt.h9)({notification:y,environment:C,tab:b,activity:t}),children:[R&&ee&&(0,ae.jsx)(li,{discussionStore:R,url:Z,onClick:G,rootStore:s,source:f,useInboxRedesign:!1,isSuggestionCreatedActivity:j}),(0,ae.jsx)(qt.Z,{visible:5,items:A.map(((e,t,i)=>(0,ae.jsx)(Zt.Z,{onClick:G,href:Z,innerStyle:(0,ht.OD)({source:f,isMobile:X}),children:(0,ae.jsx)(Ut.Z,{edit:e,rootStore:s,type:"comment-edit",discussionLocation:Q,highlightCurrentUser:!0,onReactionToggle:J,hideAuthorName:1===A.length})},t)))}),P&&(0,ae.jsx)(mi,{activity:t,rootStore:s,tabArgs:i,useInboxRedesign:h,isSuggestionCreatedActivity:j})]})}const ai=8;function di(e){const{discussionStore:t}=e,i=(0,u.VK)((()=>t.getResolved()),[t]),o=(0,m.yK)((e=>({container:{display:"flex",alignItems:"center",gap:4,fontSize:12,color:e.text.secondary,marginTop:ai},icon:{height:12,width:12}})),[]);return i?(0,ae.jsxs)("div",{style:o.container,children:[(0,zt.k)(o.icon),(0,ae.jsx)(x.FormattedMessage,{id:"activity.commentActivity.commentStatusResolved",defaultMessage:"Resolved on the page"})]}):null}function li(e){const{url:t,onClick:i,discussionStore:o,rootStore:s,source:n,useInboxRedesign:r,isSuggestionCreatedActivity:a}=e,d=(0,c.O7)().device.isMobile,l=(0,m.yK)((e=>({linkbox:{...!r&&(0,ht.OD)({source:n,isMobile:d}),display:"flex",alignItems:"center",fontSize:13,color:e.mediumTextColor,paddingTop:2,paddingBottom:r?8:6,marginBottom:0}})),[d,n,r]),g=(0,u.VK)((()=>o.getType()),[o]);return(0,ae.jsx)(Zt.Z,{href:t,onClick:i,innerStyle:l.linkbox,disabled:r,children:"suggestion"===g?!a&&(0,ae.jsx)(Jt.LazySuggestionContext,{discussionStore:o,collapsed:!1}):(0,ae.jsx)(ci,{rootStore:s,discussionStore:o})})}function ci(e){const t=(0,c.O7)(),i=(0,m.Fg)(),{rootStore:o,discussionStore:s}=e,n=(0,u.VK)((()=>{const e=s.getModel();if(e)return(0,l.Pq)(e)}),[s]),r=(0,u.VK)((()=>{var e;const t=null==s||null===(e=s.getParentStore())||void 0===e?void 0:e.getParentStore();if(!t||"collection"!==t.table)return;const i=t.getSchema(),o=s.getPropertyId();return void 0!==o?(0,Wt.Qm)({schema:i,property:o}):void 0}),[s]),a=(0,u.VK)((()=>(0,Xt.IY)({environment:t,textValue:n?{value:n,spaceId:o.id}:void 0,parentStore:o,disableHover:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!0,disabled:!0,highlightDiscussionId:s.id,theme:i,emojiType:(0,$t.e_)(t),katex:t.KatexStore.getKatex(),formulaValueTypes:[]})),[t,n,o,s.id,i]);return n?(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(ni.Z,{}),r&&(0,ae.jsxs)("div",{style:{display:"inline-flex"},children:[(0,ae.jsx)(si.Z,{propertySchema:r,showIcon:!0,style:{fontSize:13,fill:"dark"},iconSize:12}),(0,ae.jsx)("span",{style:{marginLeft:1,marginRight:4},children:":"})]}),(0,ae.jsx)("div",{style:M.Z.textOverflowStyle,children:a})]}):null}const ui=8;function mi(e){const{activity:t,rootStore:i,tabArgs:s,useInboxRedesign:n,isSuggestionCreatedActivity:r}=e,{source:d,notification:l,tab:g}=s,p=(0,u.VK)((()=>{const e=i.getRecordStore(i,{table:a.qF,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,i]),h=(0,c.O7)(),f=h.device.isMobile,b=(0,u.VK)((()=>_.t1.createChildStore(i,{table:a.qF,id:t.discussion_id,spaceId:(0,Gt.C)(i.pointer.spaceId)})),[t,i]),y=(0,u.VK)((()=>null==p?void 0:p.getParentId()),[p]),M=(0,o.useCallback)((e=>{(0,Z.ZP)({event:e,context:Z.Af.NotificationClick,callback:()=>{if(!y)return;const o=_.G.createChildStore(i,{table:v.iU,id:y}),s=e.target,n=null==l?void 0:l.id;Yt.oK({environment:h,discussionStore:b,rect:s.getBoundingClientRect(),blockStore:o,discussionLocation:pi({forReplyMenu:!0,source:d}),activityId:t.id,notificationId:n}),"notifications_tab"===d&&We.gY({environment:h,notificationId:n,alreadyRead:Boolean(null==l?void 0:l.read),activity:t,tab:g})}})}),[t,b,h,l,y,i,d,g]),S=(0,m.yK)((e=>({container:{paddingLeft:n?void 0:(0,ht.c3)({source:d,isMobile:f}),paddingTop:n?ui:12,paddingBottom:n?0:4},actionButton:(0,ht.b9)(e)})),[f,d,n]),A=Boolean(null==l?void 0:l.visited)&&!n;return!p||r?null:(0,ae.jsxs)("div",{style:S.container,children:[(0,ae.jsx)(le,{children:(0,ae.jsx)(Ce.Z,{onClick:M,style:S.actionButton,children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Reply",id:"activity.replyButton.label"})})}),A&&(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(gi,{}),(0,ae.jsx)(pt.D,{tabArgs:s,environment:h,rootStore:i,activity:t})]})]})}function gi(){return(0,ae.jsx)("div",{style:{width:5,display:"inline-block"}})}function pi(e){const{forReplyMenu:t,source:i}=e;if("updates_sidebar"===i)return t?"reply_menu_updates_sidebar":"updates_sidebar";return`${t?"reply_menu_":"updates_menu_"}${We.Jn()}`}function hi(e){const{authorCount:t,authorPhrase:i,isSuggestionCreatedActivity:o}=e;return o?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} suggested in} other {{authorOrAuthors} suggested in}}",values:{numberOfAuthors:t,authorOrAuthors:i},id:"activity.commentActivity.standardizedHeader.suggestion"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented in} other {{authorOrAuthors} commented in}}",values:{numberOfAuthors:t,authorOrAuthors:i},id:"activity.commentActivity.standardizedHeader"})}const vi=2,fi=10,bi=4;function yi(e){const{discussionStore:t,discussionLocation:i,onReactionToggle:s}=e,n=(0,c.O7)(),[r,a]=(0,o.useState)(!1),d=(0,u.VK)((()=>{if(!t)return[];const e=t.getCommentStores();return"suggestion"===t.getType()?e.slice(1):e}),[t]),l=d.length-vi,g=l>0,p=1===d.length,h=(0,o.useCallback)((e=>{(0,Z.ZP)({event:e,context:Z.Af.NotificationClick,callback:()=>{a(!r),We.EH(n,{expand:!r,comments_count:d.length,discussion_id:t.id})}})}),[n,r,d.length,t.id]),v=(0,m.yK)((e=>({discussion:{display:"flex",flexDirection:"column",gap:fi},truncateRepliesButton:{display:"flex",gap:8,padding:4,marginLeft:-4,borderRadius:4},avatars:{display:"flex"},truncationText:{display:"flex",alignItems:"center",color:e.lightTextColor,fontSize:12},expandButton:{display:"flex",justifyContent:"start",alignItems:"center",gap:14,borderRadius:6,fontSize:12,padding:6,marginLeft:-6,marginTop:bi-fi,marginBottom:bi-fi,color:e.mediumTextColor,maxWidth:"fit-content",maxHeight:26},divider:{width:20,flexGrow:2,color:e.stroke.deemphasized}})),[]);if(p){const e=d[0];return(0,ae.jsx)("div",{style:v.discussion,children:(0,ae.jsx)(xi,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:s,maxLines:4,showAuthor:!1},e.id)})}return(0,ae.jsxs)("div",{style:v.discussion,children:[d.slice(0,1).map((e=>(0,ae.jsx)(xi,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:s,maxLines:3},e.id))),g&&(0,ae.jsx)(le,{children:(0,ae.jsx)(Y.Z,{style:v.expandButton,onClick:h,children:r?(0,ae.jsx)(x.FormattedMessage,{id:"CommentGroupingActivity.discussionThread.hidePreviousRepliesCount",defaultMessage:"Hide {previousRepliesCount} {previousRepliesCount, plural, one {comment} other {comments}}",values:{previousRepliesCount:l}}):(0,ae.jsx)(x.FormattedMessage,{id:"CommentGroupingActivity.discussionThread.showPreviousRepliesCount",defaultMessage:"{previousRepliesCount} {previousRepliesCount, plural, one {more comment} other {more comments}}",values:{previousRepliesCount:l}})})}),r&&d.slice(1,-1).map((e=>(0,ae.jsx)(xi,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:s,maxLines:3},e.id))),d.slice(-1).map((e=>(0,ae.jsx)(xi,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:s,maxLines:3},e.id)))]})}function xi(e){const{commentStore:t,discussionStore:i,discussionLocation:s,onReactionToggle:n,maxLines:r=3,showAuthor:a=!0}=e,l=(0,c.Fy)(),g=(0,x.useIntl)(),[p,h]=(0,o.useState)(!1),f=(0,u.VK)((()=>{const e=t.getCreatedByPointer();if(e)return _.t1.createChildStore(t,e)}),[t]),b=(0,u.VK)((()=>f?f.getDisplayName(g):(0,ae.jsx)(x.FormattedMessage,{id:"CommentGroupingActivity.discussionThreadComment.unknownAuthorLabel",defaultMessage:"Unknown author"})),[f,g]),y=(0,u.VK)((()=>{const e=t.getContent(),i=0===e.length;if(e||!i)return e.map((e=>{const i=_.t1.createChildStore(t,{table:v.iU,id:e,spaceId:t.getSpaceId()}).getValue();if(i)return(0,ae.jsx)(ti.ZP,{blockValue:i,rootStore:t},e)})).filter(d.$K)}),[t]),S=(0,u.VK)((()=>_.bh.getUserVisibleReactions(t).length>0),[t]),A=(0,u.VK)((()=>t.getLastEditedTime()>t.getCreatedTime()+100),[t]),j=!S&&l.isMobile,k=!j,C=(0,o.useCallback)((e=>{l.isMobile?e.preventDefault():h(!0)}),[l.isMobile]),R=(0,o.useCallback)((e=>{l.isMobile?e.preventDefault():h(!1)}),[l.isMobile]),w=(0,m.yK)((e=>({avatarCommentReactionBarContainer:{...!S&&!l.isMobile&&{position:"relative"}},avatarAndCommentContainer:{display:"flex",flexDirection:"column"},commentContainer:{display:"flex",justifyContent:"space-between",gap:6,overflow:"hidden",flexGrow:1},commentClampContainer:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:r,verticalAlign:"top",textAlign:"left",lineHeight:M.Z.lineHeight.UIRegular.desktop,...M.Z.textOverflowStyle,color:e.accentColors.gray[500]},fullName:{fontWeight:M.Z.fontWeight.regular,fontSize:12,lineHeight:"22px",marginRight:8,color:e.mediumTextColor},editedBadge:{fontSize:13,color:e.mediumTextColor,paddingLeft:4},reactionBarMobile:{...S&&{marginTop:4}},reactionBar:{...!S&&{position:"absolute",top:-2,right:0,opacity:p?1:0,transition:`opacity ${fe}`},...S&&{marginTop:4}},newReaction:{borderWidth:1,borderStyle:"solid",borderColor:l.isMobile?"transparent":e.stroke.regular,borderRadius:6,boxShadow:"0px 2px 4px 0px rgba(22, 29, 27, 0.02)"}})),[l,S,p,r]);return(0,ae.jsx)("div",{children:(0,ae.jsxs)("div",{style:w.avatarCommentReactionBarContainer,onMouseEnter:C,onMouseLeave:R,children:[(0,ae.jsxs)("div",{style:w.avatarAndCommentContainer,children:[a&&(0,ae.jsx)("div",{style:w.fullName,children:b}),(0,ae.jsxs)("div",{style:w.commentContainer,children:[(0,ae.jsxs)("span",{style:w.commentClampContainer,children:[(0,ae.jsx)(Mi,{discussionStore:i,commentStore:t}),y,A&&(0,ae.jsx)("span",{style:w.editedBadge,children:(0,ae.jsx)(x.FormattedMessage,{id:"CommentGroupingActivity.discussionThreadComment.editedBadge",defaultMessage:"(edited)"})})]}),j&&(0,ae.jsx)("div",{style:l.isMobile?w.reactionBarMobile:w.reactionBar,children:(0,ae.jsx)(le,{children:(0,ae.jsx)(Jt.LazyReactionBar,{parentStore:t,discussionLocation:s,onReactionToggle:n,newReactionStyle:w.newReaction})})})]})]}),k&&(0,ae.jsx)("div",{style:l.isMobile?w.reactionBarMobile:w.reactionBar,children:(0,ae.jsx)(le,{children:(0,ae.jsx)(Jt.LazyReactionBar,{parentStore:t,discussionLocation:s,onReactionToggle:n,newReactionStyle:w.newReaction})})})]})})}function Mi(e){const{discussionStore:t,commentStore:i}=e,o=(0,c.O7)(),s=(0,m.Fg)(),n=(0,u.VK)((()=>ei.zP(i).getValue()),[i]),r=(0,u.VK)((()=>i.getSpaceId()),[i]),a=(0,u.VK)((()=>{if(!n||!r)return null;const e=(0,Ht.H4)({textValue:n,currentUserId:o.currentUser.id,getRecordModel:t.getRecordModel,highlightStyle:"text_only"});return(0,Xt.IY)({environment:o,textValue:{value:e,spaceId:r},parentStore:t,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableHover:!0,disabled:!0,theme:s,emojiType:(0,$t.e_)(o),katex:o.KatexStore.getKatex(),formulaValueTypes:[]})}),[o,t,s,n,r]),d=(0,m.yK)((e=>({commentText:{whiteSpace:"pre-wrap",wordBreak:"break-word",display:"inline",fontSize:14,color:e.regularTextColor,lineHeight:"22px"}})),[]);return(0,ae.jsx)("span",{style:d.commentText,children:a})}const Si=20;function Ai(e){const{frontActorStore:t,backActorStore:i}=e,o=(0,m.yK)((()=>({container:{display:"grid",height:ue,width:ue},back:{gridColumn:1,gridRow:1,marginLeft:-3,marginTop:-3,maxWidth:Si,minWidth:Si},front:{gridColumn:1,gridRow:1,marginLeft:7,marginTop:7,maxWidth:Si,minWidth:Si}})),[]);return(0,ae.jsxs)("div",{style:o.container,children:[(0,ae.jsx)("div",{style:o.back,children:(0,ae.jsx)(Ci,{size:Si,actorStore:i,avatar:void 0})}),(0,ae.jsx)("div",{style:o.front,children:(0,ae.jsx)(Ci,{size:Si,actorStore:t,avatar:void 0})})]})}function ji(e){const{authorsLength:t,frontActorStore:i,backActorStore:o,authorTextStyle:s}=e,n=(0,c.O7)(),r=(0,x.useIntl)(),a=n.currentUser.id,d=(0,u.VK)((()=>{if(i)return i.getDisplayName(r)}),[i,r]),l=(0,u.VK)((()=>{if(o)return o.getDisplayName(r)}),[o,r]),m={fontWeight:M.Z.fontWeight.semibold,...s};return 0===t?(0,ae.jsx)("span",{style:m,children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"<b>Nobody</b>",id:"activitySection.authorPhraseInboxRedesign.forNoAuthors.label",values:{b:e=>(0,ae.jsx)("span",{style:m,children:e})}})}):1===t&&i?i.id===a?(0,ae.jsx)("span",{children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"<b>You</b>",id:"activitySection.authorPhraseInboxRedesign.forOneAuthorCurrentUser.label",values:{b:e=>(0,ae.jsx)("span",{style:m,children:e})}})}):(0,ae.jsx)("span",{children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"<b>{author}</b>",id:"activitySection.authorPhraseInboxRedesign.forOneAuthor.label",values:{author:d,b:e=>(0,ae.jsx)("span",{style:m,children:e})}})}):2===t?o&&o.id===a?(0,ae.jsx)("span",{children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"<b>{frontActorName} and You</b>",id:"activitySection.authorPhraseInboxRedesign.forTwoAuthorsCurrentUser.label",values:{frontActorName:d,b:e=>(0,ae.jsx)("span",{style:m,children:e})}})}):(0,ae.jsx)("span",{children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"<b>{frontActorName} and {backActorName}</b>",id:"activitySection.authorPhraseInboxRedesign.forTwoAuthors.label",values:{frontActorName:d,backActorName:l,b:e=>(0,ae.jsx)("span",{style:m,children:e})}})}):t>2?(0,ae.jsx)("span",{children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"<b>{frontActorName} and {numberOfOtherAuthors} others</b>",id:"activitySection.authorPhraseInboxRedesign.forMoreThanTwoAuthors.label",values:{frontActorName:d,numberOfOtherAuthors:t-1,b:e=>(0,ae.jsx)("span",{style:m,children:e})}})}):null}function ki(){const e=(0,m.yK)((e=>({icon:{height:14,width:14,fill:e.icon.secondary}})),[]);return(0,ae.jsx)(je,{children:(0,Et.S)(e.icon)})}function Ci(e){const{actorStore:t,avatar:i}=e,o=e.size??28;return t?t.table===Fe.cZ?(0,ae.jsx)(ii.Z,{botStore:t,size:o}):t.table===y.KJ?(0,ae.jsx)(oi.Z,{userStore:t,size:o}):t.table===De.y0?(0,ae.jsx)(oi.Z,{userStore:void 0,size:o}):void(0,d.t1)(t):i?(0,ae.jsx)(oi.Z,{avatar:i,size:o}):(0,ae.jsx)(oi.Z,{userStore:void 0,size:o})}const _i=o.memo(ri);const Ri=function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:n,useInboxRedesign:r}=e,{tab:a,notification:d}=o,m=(0,c.O7)(),g=(0,u.VK)((()=>(0,Pt.hI)(t.getEdits())),[t]),p=(0,u.VK)((()=>(0,l.P6)({edits:g,rootStore:i})),[g,i]),h=(0,u.VK)((()=>(0,l.XW)(p,{...(0,C.h_)({useInboxRedesign:r})})),[p,r]),{oldEmail:v,newEmail:f}=(0,u.VK)((()=>{const e=g[0];return{oldEmail:e?e.old_email:"",newEmail:e?e.new_email:""}}),[g]),b=(0,u.VK)((()=>parseInt(t.end_time)),[t]);return r?(0,ae.jsx)(ke,{header:(0,ae.jsx)("span",{children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"You updated your email to {newEmail}",values:{newEmail:f},id:"activity.emailEdited.header.short"})}),isFirst:s,isLast:n,isPrivate:!1,rootStore:i,notification:d,icon:(0,ae.jsx)(mt.BE,{authors:p,size:ue,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:void 0,...(0,gt.JJ)({notification:d,activity:t,environment:m,tab:a})}):(0,ae.jsx)(At,{timestamp:b,header:(0,ae.jsx)("span",{children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} changed email from {oldEmail} to {newEmail}} other {{authorOrAuthors} changed email from {oldEmail} to {newEmail}}}",values:{numberOfAuthors:p.length,authorOrAuthors:h,oldEmail:v,newEmail:f},id:"activity.emailEdited.header"})}),isLast:n,isPrivate:!1,rootStore:i,showRecordPath:!1,notification:d,icon:(0,ae.jsx)(mt.BE,{authors:p,size:24}),showSnapshotButton:!1,...(0,gt.h9)({notification:d,activity:t,environment:m,tab:a})})};var wi=i(130134),Ii=i(629551);function Fi(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:n,useInboxRedesign:r}=e,{tab:a,notification:d,source:l}=o,g=(0,c.O7)(),p=g.device.isMobile,{activityEndTimestamp:h,edits:v}=(0,u.VK)((()=>({activityEndTimestamp:parseInt(t.end_time),edits:t.getEdits()})),[t]),f=Boolean(null==d?void 0:d.visited),b=(0,m.yK)((e=>({container:{paddingLeft:(0,ht.c3)({source:l,isMobile:p}),paddingTop:12,paddingBottom:4},newContainer:{paddingTop:12,paddingBottom:4},actionButton:(0,ht.b9)(e)})),[p,l]),y=(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Your workspace export is ready",id:"activity.exportCompleted.header"}),M=(0,ae.jsx)(Ii.gq,{style:{fontSize:12},children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"The download link will expire in 7 days.",id:"activity.exportCompleted.downloadLink"})}),S=()=>{window.open(v[0].link,"_blank")};return r?(0,ae.jsxs)(ke,{header:y,isFirst:s,isLast:n,isPrivate:!0,rootStore:i,notification:d,icon:(0,ae.jsx)(Bi,{}),showSnapshotButton:!1,url:void 0,...(0,gt.JJ)({notification:d,activity:t,environment:g,tab:a}),children:[M,(0,ae.jsx)("div",{style:b.newContainer,children:(0,ae.jsx)(Ce.Z,{onClick:S,style:b.actionButton,children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Download",id:"activity.actions.exportCompleted.download"})})})]}):(0,ae.jsxs)(At,{timestamp:h,header:y,isLast:n,isPrivate:!0,rootStore:i,notification:d,icon:(0,ae.jsx)(mt.Hy,{}),showRecordPath:!0,showSnapshotButton:!1,...(0,gt.h9)({notification:d,activity:t,environment:g,tab:a}),children:[(0,ae.jsx)(Ii.gq,{style:{paddingLeft:(0,ht.c3)({source:l,isMobile:!1})},children:M}),(0,ae.jsxs)("div",{style:b.container,children:[(0,ae.jsx)(Ce.Z,{onClick:S,style:b.actionButton,children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Download",id:"activity.actions.exportCompleted.download"})}),f&&(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(Ki,{}),(0,ae.jsx)(pt.D,{tabArgs:o,environment:g,rootStore:i,activity:t})]})]})]})}function Bi(){const e=(0,m.yK)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,ae.jsx)(je,{children:(0,wi.c)(e.icon)})}function Ki(){return(0,ae.jsx)("div",{style:{width:5,display:"inline-block"}})}var Ti=i(654584);function Vi(e){const{activity:t,rootStore:i,isFirst:o,isLast:s,tabArgs:n,useInboxRedesign:r}=e,{tab:a,notification:d,source:m}=n,g=(0,c.O7)(),h=(0,u.VK)((()=>t.getEdits()),[t]),f=h.length>0,b=h[0],y=_.G.createChildStore(i,{table:v.iU,id:b.navigable_block_id}),M=(0,u.VK)((()=>y.isDefined()),[y]),S=(0,u.VK)((()=>{const e=_.G.createChildStore(i,{table:v.iU,id:t.mentioned_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:p.tY.Notification})}),[t,i]),A=(0,u.VK)((()=>i.getModel()),[i]),k=(0,u.VK)((()=>(0,Ti.QH)(j.default.getIntl(),A,t.mentioned_group_id)),[A,t]),R=(0,u.VK)((()=>(0,l.P6)({edits:t.getEdits(),rootStore:i})),[t,i]),w=(0,u.VK)((()=>(0,l.XW)(R,{...(0,C.h_)({useInboxRedesign:r})})),[R,r]),I=g.device.isMobile,F=(0,u.VK)((()=>(0,l.jC)({recordId:y.id,recordType:v.iU,tab:a,rootStore:i,environment:g})),[y,a,i,g]),B=(0,u.VK)((()=>parseInt(t.end_time)),[t]);if(!f||!M||!S)return null;const K=(0,ae.jsx)(vt.Z,{titledRecordStore:y,activity:t,tabArgs:n,getRecordModel:i.getRecordModel});return r?(0,ae.jsx)(ke,{header:(0,ae.jsx)("span",{children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned your group} other {{authorOrAuthors} mentioned your group}}",values:{numberOfAuthors:R.length,authorOrAuthors:w},id:"activity.groupMentionActivity.standardizedHeader.short"})}),isFirst:o,isLast:s,isPrivate:F,rootStore:i,navigableBlockId:y.id,notification:d,icon:(0,ae.jsx)(mt.BE,{authors:R,size:ue,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:S,...(0,gt.JJ)({notification:d,activity:t,environment:g,tab:a}),children:(0,ae.jsx)(Ut.Z,{edit:b,rootStore:i,highlightCurrentUser:!0,highlightCurrentUserStyle:"text_only"})}):(0,ae.jsxs)(At,{timestamp:B,header:(0,ae.jsx)("span",{children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned {groupName} in a page} other {{authorOrAuthors} mentioned {groupName} in a page}}",values:{numberOfAuthors:R.length,authorOrAuthors:w,groupName:k},id:"activity.groupMentionActivity.standardizedHeader"})}),isLast:s,isPrivate:F,rootStore:i,prominentTitleLink:K,navigableBlockId:y.id,showRecordPath:!0,notification:d,icon:(0,ae.jsx)(mt.BE,{authors:R,size:24}),showSnapshotButton:!1,...(0,gt.h9)({notification:d,activity:t,environment:g,tab:a}),children:[(0,ae.jsx)(Zt.Z,{href:S,onClick:()=>(0,gt.dG)({environment:g,activity:t,...n}),innerStyle:(0,ht.OD)({source:m,isMobile:I}),children:(0,ae.jsx)(Ut.Z,{edit:b,rootStore:i,highlightCurrentUser:!0})}),(0,ae.jsx)(pt.Z,{tabArgs:n,activity:t,isMobile:I,environment:g,rootStore:i})]})}var Oi=i(401800),Pi=i(582356),Zi=i(123925),Ui=i(475024),qi=i(30397),Li=i(274016),Ni=i(224646),Di=i(562820),Wi=i(109867);function Ei(e){const{titledRecordStore:t,rootStore:i,activity:s,tabArgs:n,useInboxRedesign:r}=e,a=i.getRecordModel,l=(0,u.VK)((()=>t.getModel()),[t]),g=(0,c.O7)(),h=(0,u.VK)((()=>null==l?void 0:l.getRenderIcon({getRecordModel:a})),[l,a]),S=(0,m.yK)((e=>({container:r?{display:"block",borderWidth:1,borderStyle:"solid",borderColor:e.tint.regular,borderRadius:8,marginTop:r?0:12,padding:12,background:e.contentBackground,boxShadow:"0px 1px 2px 0px "+("light"===e.mode?"rgba(0, 0, 0, 0.03)":"rgba(0, 0, 0, 0.12)"),transition:`background ${ge}`}:{...ht.lS,display:"block",border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,marginTop:8,padding:10},icon:{...ht.e9,marginRight:10},activityTitle:{fontSize:14,marginRight:void 0!==h?3:0,display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,verticalAlign:"top",textAlign:"left",lineHeight:M.Z.lineHeight.UIRegular.desktop,...M.Z.textOverflowStyle,whiteSpace:"normal",...ht.nP},flexRow:{display:"flex",alignItems:"center"},title:{maxWidth:"80%"},spacer:{flexGrow:1},subtitle:{fontSize:12,color:e.lightTextColor},avatarContainer:{display:"flex",flexDirection:"row",justifyContent:"start",overflow:"hidden",paddingRight:2,alignItems:"center"},overlappingAvatar:{marginRight:-5,position:"relative"},rightmostAvatar:{position:"relative"},remainderCount:{paddingLeft:2,color:e.lightTextColor}})),[h,r]),A=(0,u.VK)((()=>{if(l&&l.table!==b.e0)return l.getRenderUrl({getRecordModel:a,pageVisitSource:p.tY.Notification})}),[l,a]),k=(0,o.useCallback)((e=>{const i=t.table;switch(i){case v.iU:case f.bx:(0,gt.V3)({environment:g,activity:s,...n});break;case b.e0:(0,gt.dG)({environment:g,activity:s,...n}),Wi.hI({environment:g,teamStore:t,shouldScroll:!0}),Di.Z.setState({...Di.Z.state,open:!1});break;default:(0,d.t1)(i)}}),[s,g,n,t]),C=(0,u.VK)((()=>{const e=t.table;switch(e){case"space":const i=t.getPublicSpaceData();return i&&"none"!==i.role?(0,ae.jsx)("div",{children:(0,ae.jsx)(x.FormattedMessage,{id:"activity.titleCard.spaceSubtitle",defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}} Â· {planType}",values:{numberOfWorkspaceMembers:j.default.formatNumber(i.memberCount),planType:j.default.formatMessage((0,Ni.em)(i.subscriptionTier))}})}):null;case"block":return(0,ae.jsx)(ee.ZP,{store:t});case"team":const o=t.getNumberOfMembersOrZero((0,Je.Io)()),s=t.getTeamAccessLevel();return(0,ae.jsx)("div",{children:(0,ae.jsx)(x.FormattedMessage,{id:"activity.titleCard.teamSubtitle",defaultMessage:"{accessLevel} Â· {numberOfTeamMembers, plural, one {{numberOfTeamMembers} member} other {{numberOfTeamMembers} members}}",values:{accessLevel:s,numberOfTeamMembers:o}})});default:(0,d.t1)(e)}}),[t]),R=(0,u.VK)((()=>{const e=t.table,i=(0,Je.Io)();let o=[];switch(e){case"space":if(!t.getModel())break;o=i.map((e=>e.userId));break;case"block":const s=t.getCreatedByPointer();(null==s?void 0:s.table)===y.KJ&&(o=[s.id]);break;case"team":o=t.getNonGuestUserIdsInTeamUsingSpaceMembers((0,Je.Io)())??[];break;default:(0,d.t1)(e)}const s=Math.max(0,o.length-3),n=Math.min(o.length,3);return(0,ae.jsxs)("div",{style:S.avatarContainer,children:[o.slice(0,3).map(((e,i)=>{const o=_.U6.createChildStore(t,{table:y.KJ,id:e}),s=i===n-1;if(o)return(0,ae.jsx)(oi.Z,{userStore:o,size:24,avatarShouldShowShadow:!1,style:s?S.rightmostAvatar:S.overlappingAvatar,isOffline:!1,hasTooltip:!g.device.isMobile},e)})),s>0&&(0,ae.jsx)("div",{style:S.remainderCount,children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{remainingAvatarCount, plural, one {+{remainingAvatarCount}} other {+{remainingAvatarCount}}}",id:"activity.titleCard.members.otherCount.message",values:{remainingAvatarCount:s}})})]})}),[g.device.isMobile,S,t]);return l?(0,ae.jsx)(Zt.Z,{href:A,onClick:k,external:!1,innerStyle:S.container,inline:!0,children:(0,ae.jsxs)("div",{style:S.flexRow,children:[h&&(0,ae.jsx)(Q.Z,{disabled:!0,icon:h,isEmptyPage:!1,size:25,style:S.icon}),(0,ae.jsxs)("div",{style:S.title,children:[(0,ae.jsx)(te.Z,{store:t,style:S.activityTitle}),!r&&(0,ae.jsx)("div",{style:S.subtitle,children:C})]}),(0,ae.jsx)("div",{style:S.spacer}),(0,ae.jsx)("div",{children:R})]})}):null}const zi=o.memo(Ei);function Gi(e){var t;const{activity:i,rootStore:o,tabArgs:s,isFirst:n,isLast:r,useInboxRedesign:a}=e,{tab:d,notification:l,source:g}=s,h=(0,c.O7)(),{activityEndTimestamp:f,edits:b}=(0,u.VK)((()=>({activityEndTimestamp:parseInt(i.end_time),edits:i.getEdits()})),[i]),y=null===(t=b[0])||void 0===t?void 0:t.teamspace_id,M=(0,u.VK)((()=>qi.Z.state.teams.find((e=>e.id===y))),[y]),S=(0,u.VK)((()=>null==M?void 0:M.getName()),[M]),A=h.device.isMobile,j=(0,m.yK)((e=>({linkbox:{...(0,ht.OD)({source:g,isMobile:A}),display:"flex",alignItems:"center",fontSize:Ui.yv(h,"UIRegular"),paddingTop:2,paddingBottom:6,marginBottom:0,width:"100%"},newContainerLinkBox:{...(0,ht.OD)({source:g,isMobile:A}),display:"flex",alignItems:"center",fontSize:Ui.yv(h,"UIRegular"),paddingTop:2,paddingBottom:6,marginBottom:0,paddingLeft:0,width:"100%"}})),[A,g,h]),k=Boolean(null==l?void 0:l.visited),C=(0,m.yK)((e=>({container:{paddingLeft:(0,ht.c3)({source:g,isMobile:A}),paddingTop:12,paddingBottom:4},newContainer:{paddingLeft:(0,ht.c3)({source:g,isMobile:A}),paddingTop:12,paddingBottom:4},actionButton:(0,ht.b9)(e)})),[A,g]);if(!b.length)return(0,ae.jsx)(ae.Fragment,{});const{import_source:R,import_status:w,landing_page:I,collection_page_ids:F}=b[0],B=(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Your {importSource} import has failed",id:"activity.importFailed.header",values:{importSource:R,importStatus:w}}),K=(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Your {importSource} import was successful",id:"activity.importSuccess.header",values:{importSource:R,importStatus:w}}),T=(0,ae.jsx)(Ii.gq,{style:{fontSize:Ui.yv(h,"UISmall")},children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"View projects and tasks in Notion",id:"activity.importCompleted.projects.redirect"})}),V=(0,ae.jsx)(Ii.gq,{style:{fontSize:Ui.yv(h,"UISmall")},children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"View import logs",id:"activity.importCompleted.loggerPage.redirect"})}),O=(0,Oi.Z)({pageId:I,pageVisitSource:p.tY.Import});let P="successful"===w?K:B,Z=(0,ae.jsx)(Ii.gq,{children:(0,ae.jsx)(Zt.Z,{href:O,innerStyle:a?j.newContainerLinkBox:j.linkbox,children:"successful"===w?T:V})});const U="Jira"===R?(0,ae.jsx)(Ji,{}):(0,ae.jsx)(Hi,{}),q="Jira"===R?(0,ae.jsx)(mt.yI,{}):(0,ae.jsx)(mt._c,{}),L=null==F?void 0:F[0];if("Jira"===R){const{headerComponent:e,bodyComponent:t}=(()=>{let e,t;if(M&&"successful"===w&&(e=(0,ae.jsxs)("div",{children:[(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Your Jira projects and tasks have been synced to",id:"activity.importCompleted.jira.success.header"})," ",(0,ae.jsx)("div",{style:{display:"inline-block",position:"relative"},children:(0,ae.jsx)(Li.p,{disabled:!0,store:M,size:20})})," ",(0,ae.jsx)("span",{children:S})]})),L){const e=_.G.createChildStore(o,{id:L.projectCollectionPageId,spaceId:o.id,table:v.iU}),n=_.G.createChildStore(o,{id:L.taskCollectionPageId,spaceId:o.id,table:v.iU});t=(0,ae.jsxs)("div",{style:{paddingRight:12},children:[(0,ae.jsx)(zi,{titledRecordStore:e,rootStore:o,activity:i,tabArgs:s,useInboxRedesign:!0}),(0,ae.jsx)("div",{style:{height:6}}),(0,ae.jsx)(zi,{titledRecordStore:n,rootStore:o,activity:i,tabArgs:s,useInboxRedesign:!0})]})}return{headerComponent:e,bodyComponent:t}})();t&&(Z=t),e&&(P=e)}return a?(0,ae.jsx)(ke,{url:void 0,header:P,isPrivate:!0,isFirst:n,isLast:r,rootStore:o,notification:l,icon:U,showSnapshotButton:!1,...(0,gt.JJ)({notification:l,activity:i,environment:h,tab:d}),children:Z}):(0,ae.jsxs)(At,{timestamp:f,header:P,isLast:r,isPrivate:!0,rootStore:o,notification:l,icon:q,showRecordPath:!0,showSnapshotButton:!1,...(0,gt.h9)({notification:l,activity:i,environment:h,tab:d}),children:[Z,(0,ae.jsx)("div",{style:C.container,children:k&&(0,ae.jsx)(pt.D,{tabArgs:s,environment:h,rootStore:o,activity:i})})]})}function Hi(){const e=(0,m.yK)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,ae.jsx)(je,{children:(0,Pi.l)(e.icon)})}function Ji(){const e=(0,c.O7)(),t=(0,u.VK)((()=>"dark"===e.ThemeStore.state.mode),[e]),i=(0,m.yK)((e=>({icon:{height:18,width:18,marginTop:2,marginRight:2,fill:t?e.primaryBlack:e.blueColor}})),[t]);return(0,ae.jsx)(je,{children:(0,Zi.k)(i.icon)})}var Yi=i(701302),$i=i(53196),Xi=i(665422),Qi=i(798963),eo=i(937850),to=i(805149),io=i(608055),oo=i(110906),so=i(484210),no=i(460709),ro=i(223196),ao=i(61766),lo=i(164921),co=i(478140),uo=i(840721),mo=i(953437);function go(e){const{activity:t,useInboxRedesign:i,tabArgs:o}=e,{tab:s,notification:n}=o,r=(0,c.O7)(),a=(0,u.VK)((()=>t.getEdits()),[t]),d=a.length>0,l={tab:s,notificationId:null==n?void 0:n.id,environment:r,alreadyRead:Boolean(null==n?void 0:n.read),activity:t},g=(0,m.yK)((e=>({notificationContainer:{...i&&{paddingBlock:"8px 4px"},display:"flex",flexDirection:"column",rowGap:8}})),[i]);return d?(0,ae.jsx)(Ao,{analyticsInfo:l,children:(0,ae.jsx)(ho,{...e,edits:a,style:g.notificationContainer})}):null}const po=1;function ho(e){const{rootStore:t,useInboxRedesign:i,activity:s,isLast:n,tabArgs:r,edits:a,style:g,isFirst:h}=e,{tab:f,notification:b,source:y}=r,x=(0,c.O7)(),{isMobile:S}=(0,c.Fy)(),A=a.at(0),{activityEndTimestamp:j}=(0,u.VK)((()=>({activityEndTimestamp:parseInt(s.end_time,10)})),[s]),[k,C]=(0,o.useState)(null),R=(0,o.useMemo)((()=>k&&k.scrollHeight>k.clientHeight),[k]),w=(0,u.VK)((()=>{if(!A)return;const e=_.G.createChildStore(t,{table:v.iU,id:A.navigable_block_id});return(0,d.$K)(e)?e:void 0}),[A,t]),I=(0,u.VK)((()=>{const e=null==w?void 0:w.getModel();if(e)return e.getRenderUrl({getRecordModel:t.getRecordModel,pageVisitSource:p.tY.Notification})}),[t,w]),F=(0,u.VK)((()=>(0,l.jC)({recordId:null==w?void 0:w.id,recordType:v.iU,tab:f,rootStore:t,environment:x})),[w,f,t,x]),B=(0,m.yK)((e=>({formattedTitleStyle:{fontSize:M.Z.fontSize.UISmall.desktop,marginInlineStart:i?0:(0,ht.c3)({source:y,isMobile:S}),color:e.lightTextColor},oldContainer:{paddingInlineStart:(0,ht.c3)({source:y,isMobile:S}),paddingBlock:4,display:"flex",flexDirection:"row",columnGap:1.5*Number((0,ht._W)(e).paddingLeft),alignItems:"center"},unarchiveButton:{marginLeft:-1*Number((0,ht._W)(e).paddingLeft)}})),[y,S,i]),K=(0,o.useMemo)((()=>new Set(a.map((e=>e.automation_id)))),[a]),T=1===K.size;if(!(0,d.$K)(w)||!(0,d.$K)(A))return null;const V=(0,ae.jsx)(yo,{rootStore:t,uniqueAutomations:K,firstEdit:A,spaceId:s.spaceId,environment:x,shortened:!1,titleStyle:{fontWeight:M.Z.fontWeight.semibold}}),O=Boolean(null==b?void 0:b.visited),P=(0,ae.jsxs)("div",{style:g,children:[a.slice(-1*po).map(((i,o)=>(0,ae.jsxs)("div",{children:[!T&&(0,ae.jsx)(yo,{rootStore:t,firstEdit:i,uniqueAutomations:new Set([i.automation_id]),shortened:!0,spaceId:i.space_id,environment:x,titleStyle:B.formattedTitleStyle}),(0,ae.jsx)(bo,{...e,edit:i,isViewAllMenu:!1,source:y,isLast:a.length>po?o===a.length-1-po:o===a.length-1,clampedMessageContainerRef:C})]},o))),(0,ae.jsxs)("div",{style:B.oldContainer,children:[!i&&(R||a.length>po)&&(0,ae.jsx)(vo,{edits:a,useInboxRedesign:i,rootStore:t,activity:s,navigableBlockStore:w,source:y}),!i&&O&&(0,ae.jsx)("div",{style:{marginLeft:-8},children:(0,ae.jsx)(pt.D,{tabArgs:r,environment:x,rootStore:t,activity:s})})]})]}),Z=(0,ae.jsx)(vt.Z,{titledRecordStore:w,activity:s,tabArgs:r,getRecordModel:t.getRecordModel});return i?(0,ae.jsx)(ke,{header:V,isFirst:h,isLast:n,isPrivate:F,rootStore:t,navigableBlockId:w.id,notification:b,icon:(0,ae.jsx)(Mo,{useInboxRedesign:i}),showSnapshotButton:!1,url:I,...(0,gt.JJ)({notification:b,activity:s,environment:x,tab:f}),children:P}):(0,ae.jsx)(At,{timestamp:j,header:V,isLast:n,isPrivate:!0,rootStore:t,notification:b,icon:(0,ae.jsx)(Mo,{useInboxRedesign:i}),navigableBlockId:w.id,showRecordPath:!0,prominentTitleLink:Z,showSnapshotButton:!1,...(0,gt.h9)({notification:b,activity:s,environment:x,tab:f}),children:P})}function vo(e){const{edits:t,useInboxRedesign:i,rootStore:s,activity:n,navigableBlockStore:r,source:a}=e,d=(0,c.Fy)(),l=(0,c.O7)(),{handleAnalyticsForPopupMenu:g}=(0,o.useContext)(So),p=(0,u.qz)(void 0,ao.Z),h=(0,o.useCallback)((()=>p.reset()),[p]),v=(0,o.useMemo)((()=>(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numNotifications, plural, one {View more} other {View {numRemainingNotifications} more}}",id:"inAppNotificationAutomationActionTriggeredActivity.renderViewAllNotificationsButton.buttonLabel",values:{numNotifications:t.length,numRemainingNotifications:t.length-po}})),[t.length]);let f;f=d.isMobile?{menuType:no.og.Modal,title:v,right:(0,ae.jsx)(uo.DoneMenuText,{}),onClickRight:h,whiteBackground:!0}:{menuType:no.og.Popup,width:420,maxWidth:d.isMobileBrowser?"80vw":"100%"};const b=(0,m.yK)((e=>({actionButton:(0,ht.b9)(e),divider:{borderBlockEnd:`1px solid ${e.regularDividerColor}`},viewAllMenuNotificationContainer:{display:"flex",flexDirection:"column",padding:12},viewAllMenuHeaderContainer:{display:"flex",flexDirection:"row"},popupMenu:{marginInlineStart:-2,fontSize:ye}})),[]),y=(0,o.useId)();return(0,ae.jsx)($.ZP,{buttonPopupStore:p,popupType:d.isMobile?ro.k.SlideUp:ro.k.Popup,placementToOrigin:mo.ZP.Placement.Bottom,alignmentToOrigin:mo.ZP.Alignment.Center,originGap:4,onClick:()=>!p.state.open&&g(),renderOrigin:e=>(0,ae.jsx)(Ce.Z,{...e,style:b.actionButton,children:v}),render:()=>(0,ae.jsx)(co.Z,{...f,children:(0,ae.jsx)("div",{style:b.popupMenu,children:t.map(((o,d)=>(0,ae.jsxs)("div",{children:[(0,ae.jsxs)("div",{style:b.viewAllMenuNotificationContainer,children:[(0,ae.jsxs)("div",{style:b.viewAllMenuHeaderContainer,children:[(0,ae.jsx)(Mo,{useInboxRedesign:i}),(0,ae.jsx)(Mt,{timestamp:o.timestamp,prominentTitleLink:void 0,titleAriaId:y,onBacklinkClick:()=>null,hasChildren:!0,header:(0,ae.jsx)(yo,{rootStore:s,uniqueAutomations:new Set([o.automation_id]),firstEdit:o,spaceId:n.spaceId,environment:l,closeViewAllMenu:h,shortened:!0,titleStyle:{fontWeight:M.Z.fontWeight.semibold}}),rootStore:s,navigableBlockId:r.id,showRecordPath:!1})]}),(0,ae.jsx)(bo,{...e,edit:o,isViewAllMenu:!0,source:a,isLast:d===t.length-1},d)]}),d!==t.length-1&&(0,ae.jsx)("div",{style:b.divider})]},d)))})})})}const fo=4;function bo(e){const{edit:t,rootStore:i,useInboxRedesign:o,source:s,isViewAllMenu:n,clampedMessageContainerRef:r}=e,a=(0,m.Fg)(),d=(0,c.O7)(),l=(0,c.Fy)(),{isMobile:g}=l,p=(0,u.VK)((()=>d.KatexStore.getKatex()),[d]),h=(0,$t.kw)(),v=(0,u.VK)((()=>(0,ae.jsx)("div",{children:(0,Xt.IY)({environment:d,textValue:t.message.value?{value:t.message.value,spaceId:t.space_id}:void 0,parentStore:i,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disabled:!1,theme:a,emojiType:h,katex:p,parentBlockId:void 0,renderedPageBlockId:void 0,formulaValueTypes:[],stopLinkPropagation:!0})})),[d,h,p,a,t.message.value,i,t.space_id]),f=(0,m.yK)((e=>({oldContainer:{paddingInlineStart:n?32:(0,ht.c3)({source:s,isMobile:g}),paddingBlockEnd:4},messageContainer:{position:"relative",display:"flex",justifyContent:"space-between",alignItems:"center"},clampedMessageContainer:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:n?void 0:fo,verticalAlign:"top",textAlign:"left",lineHeight:M.Z.lineHeight.UIRegular.desktop,...M.Z.textOverflowStyle},messageContent:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:ye,lineHeight:(0,Ui.Dp)({device:l},"UIRegular"),paddingInlineEnd:8}})),[g,s,l,n]);return(0,ae.jsx)(ae.Fragment,{children:(0,ae.jsx)("div",{style:{...!o&&f.oldContainer,...f.messageContainer},children:(0,ae.jsx)("div",{ref:r,style:f.clampedMessageContainer,children:(0,ae.jsx)("div",{style:f.messageContent,children:v})})})})}function yo(e){const{rootStore:t,spaceId:i,environment:o,closeViewAllMenu:s,shortened:n,titleStyle:r,firstEdit:a,uniqueAutomations:l}=e,c=(0,x.useIntl)(),m=1===l.size,g=(0,u.VK)((()=>!_.Mz.createChildStore(t,{table:Qi.cv,id:a.automation_id,spaceId:t.getSpaceId()}).getAlive()),[t,a]),h=(0,u.VK)((()=>{const e=new _.G(o,{id:a.automation_navigable_block_id,table:v.iU}).getRole();return!e||!(0,Ne.YX)(e)}),[a,o]),f=(0,u.VK)((()=>{if(!(g&&m||h))return()=>{const e=a.automation_navigable_block_id,i=a.automation_id,n=_.G.createChildStore(t,{table:v.iU,id:e});if(!n)return;s&&s();const r=(0,so.ZP)({store:n,preferPublicLink:!1,pageVisitSource:p.tY.Notification});io.c4({environment:o,url:r,callback:async()=>await async function(e){const{automationNavigableBlockStore:t,automationId:i}=e;await Yi.default.afterNextFlush();const o=await async function(e,t){const i=Date.now(),o=async()=>{const s=e();if(void 0!==s)return s;return Date.now()-i>=t?void 0:(await(0,eo.Vs)(10),await o())};return await o()}((()=>(0,oo.fm)(t)),2e3);if(!o)return;const s=o.settingsStore;if(!s)return;to.r$({collectionContextStore:o,collectionSettingsStore:s}),i?to.wl({collectionSettingsStore:s,item:{type:"automationEditSettings",automationId:i,source:"in_app_notification"}}):to.wl({collectionSettingsStore:s,item:{type:"automationSettings",source:"in_app_notification"}})}({automationNavigableBlockStore:n,automationId:m?i:void 0})})}}),[o,m,a,t,s,g,h]),b=(0,u.VK)((()=>[...l].map((e=>{const o=t.getRecordStore(t,{table:Qi.cv,id:e,spaceId:i}),s=o.getRole();return(0,d.$K)(s)&&(0,Ne.YX)(s)?o.getAlive()?o.getNameWithDefault(c):c.formatMessage($i.pQ.automationDeletedName):c.formatMessage($i.pQ.automationPrivateName)}))),[c,t,i,l]);return n?(0,ae.jsx)("div",{style:{...r,display:"inline-flex"},children:(0,ae.jsx)(xo,{handleAutomationNavigate:f,automationNames:b})}):(0,ae.jsx)(x.FormattedMessage,{id:"inAppNotificationAutomationActionTriggeredActivity.formattedHeaderMessage.automationTitle",defaultMessage:"{automationNameWrappedHeader} sent you a message",values:{automationNameWrappedHeader:(0,ae.jsx)("div",{style:{...r,display:"inline-flex"},children:(0,ae.jsx)(xo,{handleAutomationNavigate:f,automationNames:b})})}})}function xo(e){const{automationNames:t,handleAutomationNavigate:i}=e,o=(0,x.useIntl)(),s=t.at(0),n=t.length,r=n-2,a=o.formatList([...t.slice(0,2),r>0?o.formatMessage({defaultMessage:"{numRemainingAutomations} more",id:"inAppNotificationAutomationActionTriggeredActivity.wrappedAutomationName.tooltipNumRemainingAutomations"},{numRemainingAutomations:r}):void 0].filter(d.$K),{style:"long",type:"conjunction"}),l={defaultMessage:"{numAutomations, plural, one {{firstAutomationName}} other {{numAutomations} automations}}",values:{firstAutomationName:s,numAutomations:n},id:"inAppNotificationAutomationActionTriggeredActivity.wrappedAutomationName.automationName",description:"The display name for an automation."},c=e=>i?(0,ae.jsx)(lo.Z,{...e,onClick:i,children:(0,ae.jsx)(x.FormattedMessage,{...l})}):(0,ae.jsx)("div",{...e,children:(0,ae.jsx)(x.FormattedMessage,{...l,...e})});return 1===n?c():(0,ae.jsx)(ie.Z,{renderTooltip:e=>(0,ae.jsx)("div",{...e,children:a}),render:e=>c(e)})}function Mo(e){const{useInboxRedesign:t}=e,i=(0,m.yK)((e=>({icon:{height:12,width:12,fill:e.icon.secondary}})),[]);return t?(0,ae.jsx)(je,{children:(0,Xi.K)(i.icon)}):(0,ae.jsx)(mt.jr,{})}const So=(0,o.createContext)({handleAnalyticsForPopupMenu:()=>{}});function Ao(e){const{analyticsInfo:t,children:i}=e,s=(0,o.useCallback)((()=>We.hI(t)),[t]);return(0,ae.jsx)(So.Provider,{value:{handleAnalyticsForPopupMenu:s},children:i})}So.displayName="InAppNotificationAutomationActionTriggeredAnalyticsContext";const jo=function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:n,useInboxRedesign:r}=e,{tab:a,notification:d}=o,m=(0,c.O7)(),g=(0,u.VK)((()=>t.getEdits()),[t]),p=(0,u.VK)((()=>(0,l.P6)({edits:g,rootStore:i})),[g,i]),h=(0,u.VK)((()=>(0,l.XW)(p,{...(0,C.h_)({useInboxRedesign:r})})),[p,r]),f=(0,u.VK)((()=>{const e=_.G.createChildStore(i,{table:v.iU,id:t.navigable_block_id});if(e.isDefined())return e}),[t,i]),b=(0,u.VK)((()=>Boolean(f&&(0,l.jC)({recordId:f.id,recordType:v.iU,tab:a,rootStore:i,environment:m}))),[f,a,i,m]),M=(0,u.VK)((()=>parseInt(t.end_time)),[t]),S=g[0],A=(0,u.VK)((()=>(0,l.N8)(S.from_user_id,i)),[S,i]),k=(0,u.VK)((()=>(0,l.N8)(S.to_user_id,i)),[S,i]);if(!(g.length>0&&A&&k&&f))return null;const R=(0,Ie.$4)(j.default.getIntl(),(0,Ie.LU)({table:y.KJ,value:A})),w=(0,ae.jsx)(vt.Z,{titledRecordStore:f,activity:t,tabArgs:o,getRecordModel:i.getRecordModel});return r?(0,ae.jsx)(ke,{header:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{authorPhrase} transferred {fromUserName}{fromUserNameEndsWithS, select, true {â€™} other {â€™s}} private pages to you",values:{authorPhrase:h,fromUserName:R,fromUserNameEndsWithS:"s"===R.slice(-1).toLowerCase()},id:"activity.privateContentTransferred.standardizedHeader.short"}),prominentTitleLink:w,isPrivate:b,rootStore:i,notification:o.notification,isFirst:s,isLast:n,icon:(0,ae.jsx)(mt.BE,{authors:p,size:ue,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:void 0,...(0,gt.JJ)({notification:d,activity:t,environment:m,tab:a})}):(0,ae.jsx)(At,{timestamp:M,header:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{authorPhrase} transferred private content from {fromUserName} to you",values:{authorPhrase:h,fromUserName:R},id:"activity.privateContentTransferred.standardizedHeader"}),isLast:n,prominentTitleLink:w,isPrivate:b,rootStore:i,notification:o.notification,icon:(0,ae.jsx)(mt.BE,{authors:p,size:24}),showSnapshotButton:!1,showRecordPath:!1,...(0,gt.h9)({notification:d,activity:t,environment:m,tab:a})})};var ko=i(136700);function Co(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:n,useInboxRedesign:r}=e,{notification:a,tab:d,source:m}=o,g=(0,c.O7)(),h=(0,u.VK)((()=>t.getEdits()),[t]),f=h.length>0,b=_.G.createChildStore(i,{table:v.iU,id:h[0].navigable_block_id}),y=(0,u.VK)((()=>b.isDefined()),[b]),S=(0,u.VK)((()=>{const e=_.G.createChildStore(i,{table:v.iU,id:t.reminder_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:p.tY.Notification})}),[t,i]),A=(0,u.VK)((()=>(0,l.jC)({recordId:b.id,recordType:v.iU,tab:d,rootStore:i,environment:g})),[b,d,i,g]),j=(0,u.VK)((()=>parseInt(t.end_time)),[t]);if(!f||!y||!S)return null;const k=g.device.isMobile,C=(0,ae.jsx)(vt.Z,{titledRecordStore:b,getRecordModel:i.getRecordModel,activity:t,tabArgs:o});return r?(0,ae.jsx)(ke,{header:(0,ae.jsx)("span",{style:{fontWeight:M.Z.fontWeight.medium},children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Reminder",id:"activity.reminderInActivity.header.short"})}),isFirst:s,isLast:n,isPrivate:A,rootStore:i,navigableBlockId:b.id,notification:a,icon:(0,ae.jsx)(_o,{}),showSnapshotButton:!1,url:S,...(0,gt.JJ)({notification:a,activity:t,environment:g,tab:d}),children:(0,ae.jsx)(Ut.Z,{edit:h[0],rootStore:i})}):(0,ae.jsx)(At,{timestamp:j,header:(0,ae.jsx)("span",{children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Reminder in {pageTitle}",id:"activity.reminderInActivity.header",values:{pageTitle:C}})}),isLast:n,isPrivate:A,rootStore:i,navigableBlockId:b.id,showRecordPath:!0,notification:a,icon:(0,ae.jsx)(mt.hZ,{}),showSnapshotButton:!1,...(0,gt.h9)({notification:a,activity:t,environment:g,tab:d}),children:(0,ae.jsx)(Zt.Z,{href:S,onClick:()=>(0,gt.dG)({environment:g,activity:t,...o}),innerStyle:(0,ht.OD)({source:m,isMobile:k}),children:(0,ae.jsx)(Ut.Z,{edit:h[0],rootStore:i})})})}function _o(){const e=(0,m.yK)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,ae.jsx)(je,{children:(0,ko.m)(e.icon)})}function Ro(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:n,useInboxRedesign:r}=e,{notification:a,tab:d}=o,m=(0,c.O7)(),g=(0,u.VK)((()=>t.getEdits()),[t]),p=g.length>0,h=(0,u.VK)((()=>(0,l.P6)({edits:g,rootStore:i})),[g,i]),v=(0,u.VK)((()=>(0,l.XW)(h,{...(0,C.h_)({useInboxRedesign:r})})),[h,r]),f=g[0],y=_.zX.createChildStore(i,{table:b.e0,id:f.team_id}),M=(0,u.VK)((()=>y.isDefined()),[y]),S=(0,u.VK)((()=>parseInt(t.end_time)),[t]);return p&&M?r?(0,ae.jsx)(ke,{header:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a teamspace} other {{authorOrAuthors} invited you to a teamspace}}",values:{numberOfAuthors:h.length,authorOrAuthors:v},id:"activity.userInvitedToTeamActivity.standardizedHeader"}),isFirst:s,isLast:n,isPrivate:!1,rootStore:i,notification:a,icon:(0,ae.jsx)(mt.BE,{authors:h,size:ue,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:void 0,...(0,gt.JJ)({notification:a,activity:t,environment:m,tab:d}),children:(0,ae.jsx)(le,{children:(0,ae.jsx)(zi,{titledRecordStore:y,rootStore:i,activity:t,tabArgs:o,useInboxRedesign:!0})})}):(0,ae.jsx)(At,{timestamp:S,header:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a teamspace} other {{authorOrAuthors} invited you to a teamspace}}",values:{numberOfAuthors:h.length,authorOrAuthors:v},id:"activity.userInvitedToTeamActivity.standardizedHeader"}),prominentTitleLink:(0,ae.jsx)(zi,{titledRecordStore:y,rootStore:i,activity:t,tabArgs:o,useInboxRedesign:!1}),isLast:n,isPrivate:!1,rootStore:i,notification:a,showRecordPath:!1,icon:(0,ae.jsx)(mt.BE,{authors:h,size:24}),showSnapshotButton:!1,...(0,gt.h9)({notification:a,activity:t,environment:m,tab:d})}):null}var wo=i(755061),Io=i(584683),Fo=i(994044),Bo=i(619584),Ko=i(536081);function To(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:n,useInboxRedesign:r}=e,{notification:a,tab:d}=o,m=(0,c.O7)(),g=(0,u.VK)((()=>t.getEdits()),[t]),h=g[0],v=Uo({rootStore:i,edit:h}),f=function(e){let{data:t,tab:i,rootStore:o}=e;const s=(0,c.O7)();return(0,u.VK)((()=>{if("block"!==(null==t?void 0:t.type))return!1;const e=t.blockStore.id;return(0,l.jC)({recordId:e,recordType:"block",tab:i,rootStore:o,environment:s})}),[t,s,o,i])}({data:v,tab:d,rootStore:i}),b=(0,u.VK)((()=>(0,l.P6)({edits:g,rootStore:i})),[g,i]),y=(0,u.VK)((()=>{if("block"===(null==v?void 0:v.type))return v.blockStore}),[v]),x=(0,u.VK)((()=>{if(!y)return;const e=y.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:p.tY.Notification}):void 0}),[y,i.getRecordModel]),M=(0,u.VK)((()=>parseInt(t.end_time)),[t]),S=(0,u.VK)((()=>t.navigable_block_id),[t]);if(0===g.length||!v)return null;const A=0===b.filter(Ie.uC).length,j=A?void 0:r?(0,ae.jsx)(mt.BE,{authors:b,size:ue,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}):(0,ae.jsx)(mt.BE,{authors:b,size:24});return r?(0,ae.jsxs)(ke,{header:(0,ae.jsx)("span",{children:(0,ae.jsx)(Po,{data:v,authors:b,isFromBot:A})}),hidePageTitle:!0,isFirst:s,isLast:n,isPrivate:f,rootStore:i,navigableBlockId:S,notification:a,icon:j,showSnapshotButton:!1,url:x,...(0,gt.JJ)({notification:a,environment:m,tab:d,activity:t}),children:[(0,ae.jsx)(Zo,{...e,edit:h}),(0,ae.jsx)(Vo,{data:v,rootStore:i,activity:t,tabArgs:o,useInboxRedesign:!0})]}):(0,ae.jsx)(At,{timestamp:M,header:(0,ae.jsx)("span",{children:(0,ae.jsx)(Oo,{data:v,authors:b,isFromBot:A,spaceId:h.space_id})}),prominentTitleLink:(0,ae.jsx)(Vo,{data:v,rootStore:i,activity:t,tabArgs:o,useInboxRedesign:!1}),isLast:n,isPrivate:f,rootStore:i,navigableBlockId:S,showRecordPath:!1,notification:a,icon:j,showSnapshotButton:!1,...(0,gt.h9)({notification:a,environment:m,tab:d,activity:t}),children:(0,ae.jsx)(Zo,{...e,edit:h})})}function Vo(e){var t;let{data:i,rootStore:o,activity:s,tabArgs:n,useInboxRedesign:r}=e;const a=(0,m.yK)((e=>({group:{color:e.mediumTextColor,fontSize:14},titleCardWrapper:{display:"contents",pointerEvents:"none"}})),[]);switch(i.type){case"block":return(0,ae.jsx)(le,{children:(0,ae.jsx)("div",{style:r?a.titleCardWrapper:void 0,children:(0,ae.jsx)(zi,{tabArgs:n,titledRecordStore:i.blockStore,rootStore:o,activity:s,useInboxRedesign:r})})});case"group":return r?(0,ae.jsx)("div",{style:a.group,children:(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"You will now get notifications when @{groupName} is mentioned",id:"activity.userInvitedActivity.groupInviteExplanation",values:{groupName:null===(t=i.group)||void 0===t?void 0:t.name}})}):null;case"space":return(0,ae.jsx)(le,{children:(0,ae.jsx)("div",{style:r?a.titleCardWrapper:void 0,children:(0,ae.jsx)(zi,{tabArgs:n,titledRecordStore:i.spaceStore,rootStore:o,activity:s,useInboxRedesign:r})})});default:(0,d.t1)(i)}}function Oo(e){let{data:t,authors:i,isFromBot:o,spaceId:s}=e;const n=(0,u.VK)((()=>(0,l.XW)(i)),[i]),r=(0,u.VK)((()=>{var e;return"block"===t.type?null===(e=t.blockStore.getAssociatedCollectionStore())||void 0===e?void 0:e.getDatabaseType():void 0}),[t]);switch(t.type){case"block":if(o)switch(r){case Dt.wW:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"You were added to a project",id:"activity.userInvitedActivityProjectByBot.standardizedHeader"});case Dt.iS:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"You were added to a task",id:"activity.userInvitedActivityTaskByBot.standardizedHeader"});case Dt.zU:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"You were added to a document",id:"activity.userInvitedActivityDocByBot.standardizedHeader"});case Dt.Fi:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"You were added to a meeting",id:"activity.userInvitedActivityMeetingByBot.standardizedHeader"});case Dt.p$:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"You were added to a sprint",id:"activity.userInvitedActivitySprintByBot.standardizedHeader"});case Dt.GZ:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"You were added to a wiki",id:"activity.userInvitedActivityWikiByBot.standardizedHeader"});default:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"You were added to a page",id:"activity.userInvitedActivityNavigableBlockByBot.standardizedHeader"})}else switch(r){case Dt.wW:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a project} other {{authorOrAuthors} added you to a project}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivityProject.standardizedHeader"});case Dt.iS:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a task} other {{authorOrAuthors} added you to a task}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivityTask.standardizedHeader"});case Dt.zU:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a document} other {{authorOrAuthors} added you to a document}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivityDoc.standardizedHeader"});case Dt.Fi:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a meeting} other {{authorOrAuthors} added you to a meeting}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivityMeeting.standardizedHeader"});case Dt.p$:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a sprint} other {{authorOrAuthors} added you to a sprint}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivitySprint.standardizedHeader"});case Dt.GZ:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a wiki} other {{authorOrAuthors} added you to a wiki}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivityWiki.standardizedHeader"});default:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a page} other {{authorOrAuthors} added you to a page}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivityNavigableBlock.standardizedHeader"})}case"group":const e=(0,ae.jsx)(Ko.Z,{permissionGroup:t.group,spaceId:s});return o?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"You were added to group {groupName}",values:{groupName:e},id:"activity.userInvitedActivityGroupIdByBot.standardizedHeader"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to group {groupName}} other {{authorOrAuthors} added you to group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:n,groupName:e},id:"activity.userInvitedActivityGroupId.standardizedHeader"});case"space":return o?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"You were added to a workspace",id:"activity.userInvitedActivityOtherInviteByBot.standardizedHeader"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a workspace} other {{authorOrAuthors} added you to a workspace}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivityOtherInvite.standardizedHeader"});default:(0,d.t1)(t)}}function Po(e){var t,i;let{data:o,authors:s,isFromBot:n}=e;const r=(0,u.VK)((()=>(0,l.XW)(s,{...(0,C.h_)({useInboxRedesign:!0})})),[s]);switch(o.type){case"block":return n?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"You were invited to a page",id:"activity.userInvitedActivityByBot.standardizedHeader.redesign"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a page} other {{authorOrAuthors} invited you to a page}}",values:{numberOfAuthors:s.length,authorOrAuthors:r},id:"activity.userInvitedActivity.standardizedHeader.redesign"});case"group":return n?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"You were added to @{groupName}",values:{groupName:null===(t=o.group)||void 0===t?void 0:t.name},id:"activity.userInvitedActivityGroupIdByBot.standardizedHeader.redesign"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to @{groupName}} other {{authorOrAuthors} added you to @{groupName}}}",values:{numberOfAuthors:s.length,authorOrAuthors:r,groupName:null===(i=o.group)||void 0===i?void 0:i.name},id:"activity.userInvitedActivityGroupId.standardizedHeader.redesign"});case"space":return n?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"You were invited to a workspace",id:"activity.userInvitedActivityOtherInviteByBot.standardizedHeader.redesign"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a workspace} other {{authorOrAuthors} invited you to a workspace}}",values:{numberOfAuthors:s.length,authorOrAuthors:r},id:"activity.userInvitedActivityOtherInvite.standardizedHeader.redesign"});default:(0,d.t1)(o)}}function Zo(e){let{edit:t,activity:i,rootStore:o,tabArgs:s,useInboxRedesign:n}=e;const r=(0,c.O7)(),{isMobile:a}=r.device,{source:d}=s,l=(0,m.yK)((()=>({redesignedInviteMessage:{fontSize:14,paddingTop:8,paddingBottom:8},inviteMessage:{paddingLeft:(0,ht.c3)({source:d,isMobile:a}),paddingTop:8,paddingBottom:8,paddingRight:12,fontSize:14}})),[a,d]),g=Uo({rootStore:o,edit:t}),h=(0,u.VK)((()=>parseInt(i.end_time)),[i]),v=(0,u.VK)((()=>{if("block"!==(null==g?void 0:g.type))return;const e=g.blockStore;return null!=e&&e.isDefined()?e.getModel():void 0}),[g]),f=(0,u.VK)((()=>{if(v)return(0,gt.ME)(v.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:p.tY.Notification}))}),[v,o.getRecordModel]),b=(0,u.VK)((()=>{if(!v)return{isValid:!1};const e=v&&(0,Fo.$e)(v,i);if(!e)return{isValid:!1};const t=o.getRecordModel({table:Io.Tu,id:e,spaceId:i.space_id});return t&&t.getMessage()&&t.getCreatedTime()<=h+5*Bo.hM?{isValid:!0,message:t.getMessage()}:{isValid:!1}}),[i,h,v,o]);return null!=b&&b.isValid?n?(0,ae.jsx)("div",{style:l.redesignedInviteMessage,children:b.message}):(0,ae.jsx)(Zt.Z,{href:f,onClick:()=>(0,gt.dG)({...s,environment:r,activity:i,mightCloseTab:!0}),innerStyle:l.inviteMessage,children:b.message}):null}function Uo(e){let{rootStore:t,edit:i}=e;return(0,u.VK)((()=>{if(i)return i.navigable_block_id?{type:"block",blockStore:_.G.createChildStore(t,{table:v.iU,id:i.navigable_block_id})}:i.permission_group_id?{type:"group",group:(0,wo.Bg)({spaceId:i.space_id,permissionGroupId:i.permission_group_id,getRecordValue:t.getRecordValue})}:{type:"space",spaceStore:_.H2.createChildStore(t,{table:f.bx,id:i.space_id})}}),[i,t])}const qo=o.memo(To);var Lo=i(570921);function No(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:n,useInboxRedesign:r}=e,{source:a,tab:d,notification:m}=o,g=(0,c.O7)(),h=(0,u.VK)((()=>t.getEdits()),[t]),f=h.length>0,b=h[0],y=_.G.createChildStore(i,{table:v.iU,id:b.navigable_block_id}),M=(0,u.VK)((()=>y.isDefined()),[y]),S=(0,u.VK)((()=>_.WJ.createChildStore(i,{table:Lo.TY,id:t.id,spaceId:t.space_id}).getStandardizedMentionedPropertyURI()),[t,i]),A=(0,u.VK)((()=>{const e=_.G.createChildStore(i,{table:v.iU,id:t.mentioned_block_id}).getModel();return null==e?void 0:e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:p.tY.Notification})}),[t,i]),j=(0,u.VK)((()=>(0,l.P6)({edits:h,rootStore:i})),[h,i]),k=(0,u.VK)((()=>(0,l.XW)(j,{...(0,C.h_)({useInboxRedesign:r})})),[j,r]),R=(0,u.VK)((()=>(0,l.jC)({recordId:y.id,recordType:"block",tab:d,rootStore:i,environment:g})),[y,d,i,g]),w=(0,u.VK)((()=>parseInt(t.end_time)),[t]);if(!f||!M||!A)return null;const I=g.device.isMobile,F=(0,ae.jsx)(vt.Z,{titledRecordStore:y,getRecordModel:i.getRecordModel,activity:t,tabArgs:o}),B=function(e,t,i,o){switch(e){case Dt.Es.Assign:return(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} assigned you a task} other {{authorOrAuthors} assigned you a task}}",values:{numberOfAuthors:i.length,authorOrAuthors:t},id:"activity.mentionTaskActivity.standardizedHeader"});case Dt.zI.People:return o?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in} other {{authorOrAuthors} mentioned you in}}",values:{numberOfAuthors:i.length,authorOrAuthors:t},id:"activity.mentionProjectActivity.standardizedHeader.short"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in a project} other {{authorOrAuthors} mentioned you in a project}}",values:{numberOfAuthors:i.length,authorOrAuthors:t},id:"activity.mentionProjectActivity.standardizedHeader"});default:return o?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in} other {{authorOrAuthors} mentioned you in}}",values:{numberOfAuthors:i.length,authorOrAuthors:t},id:"activity.mentionActivity.standardizedHeader.short"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in a page} other {{authorOrAuthors} mentioned you in a page}}",values:{numberOfAuthors:i.length,authorOrAuthors:t},id:"activity.mentionActivity.standardizedHeader"})}}(S,k,j,r);return r?(0,ae.jsx)(ke,{header:(0,ae.jsx)("span",{children:B}),isFirst:s,isLast:n,isPrivate:R,rootStore:i,navigableBlockId:y.id,notification:m,icon:(0,ae.jsx)(mt.BE,{authors:j,size:ue,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:A,...(0,gt.JJ)({notification:m,activity:t,environment:g,tab:d}),children:(0,ae.jsx)(Ut.Z,{edit:b,rootStore:i,highlightCurrentUser:!0,highlightCurrentUserStyle:"text_only"})}):(0,ae.jsxs)(At,{timestamp:w,header:(0,ae.jsx)("span",{children:B}),isLast:n,isPrivate:R,rootStore:i,navigableBlockId:y.id,prominentTitleLink:F,notification:m,icon:(0,ae.jsx)(mt.BE,{authors:j,size:24}),showRecordPath:!0,showSnapshotButton:!1,...(0,gt.h9)({notification:m,activity:t,environment:g,tab:d}),children:[(0,ae.jsx)(Zt.Z,{href:A,onClick:()=>(0,gt.dG)({environment:g,activity:t,...o}),innerStyle:(0,ht.OD)({source:a,isMobile:I}),children:(0,ae.jsx)(Ut.Z,{edit:b,rootStore:i,highlightCurrentUser:!0})}),(0,ae.jsx)(pt.Z,{tabArgs:o,activity:t,isMobile:I,environment:g,rootStore:i})]})}var Do=i(394308),Wo=i(606287);function Eo(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:n,useInboxRedesign:r}=e,{tab:a,source:d,notification:g}=o,h=(0,c.O7)(),f=h.device.isMobile,b=(0,u.VK)((()=>_.G.createChildStore(i,{table:v.iU,id:t.navigable_block_id})),[t,i]),y=(0,u.VK)((()=>b.isDefined()),[b]),S=(0,u.VK)((()=>{const e=b.getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:p.tY.Notification})}),[b,i]),A=(0,u.VK)((()=>_.NW.createChildStore(i,{table:Wo.vF,id:t.collection_id,spaceId:t.space_id})),[t,i]),j=(0,u.VK)((()=>A.isDefined()),[A]),k=(0,u.VK)((()=>{const e=A.getSchema(),t=Object.keys(e).find((t=>{var i;return"verification"===(null===(i=e[t])||void 0===i?void 0:i.type)}));let o=(0,ae.jsx)(x.FormattedMessage,{id:"Activity.author.unknown",defaultMessage:"Unknown"});if(t){const e=b.getPropertyValue(t),s=Wt._w(e);if(s){const e=s[0],t=(0,l.uA)(e,i);t&&t.asActor&&(o=(0,l.XW)([t],{...(0,C.h_)({useInboxRedesign:r})}))}}return o}),[b,A,i,r]),R=(0,u.VK)((()=>(0,l.jC)({recordId:b.id,recordType:"block",tab:a,rootStore:i,environment:h})),[b,a,i,h]),{activityStartTimestamp:w,activityEndTimestamp:I}=(0,u.VK)((()=>({activityStartTimestamp:parseInt(t.start_time),activityEndTimestamp:parseInt(t.end_time)})),[t]),F=(0,m.yK)((e=>({verificationMessage:{fontSize:14,...!r&&(0,ht.OD)({source:d,isMobile:f}),...r&&{color:e.mediumTextColor}}})),[f,d,r]);if(!y||!j)return null;const B=(0,ae.jsx)(vt.Z,{titledRecordStore:b,getRecordModel:i.getRecordModel,activity:t,tabArgs:o}),K=r?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"<medium>Wiki verification</medium> expired",id:"activity.verificationExpired.header.short",values:{medium:e=>(0,ae.jsx)("span",{style:{fontWeight:M.Z.fontWeight.medium},children:e})}}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Verification expired for <boldtext>{pageTitle}</boldtext>",values:{pageTitle:B,boldtext:e=>(0,ae.jsx)("span",{style:{fontWeight:500},children:e})},id:"activity.verificationExpired.header"}),T=(0,ae.jsx)("div",{style:F.verificationMessage,children:w&&I?(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Last verified by {person} from {startDate} to {endDate}",values:{person:k,startDate:(0,L.gs)(w),endDate:(0,L.gs)(I)},id:"activity.verificationExpired.contentWithTimestamp"}):(0,ae.jsx)(x.FormattedMessage,{defaultMessage:"Last verified by {person}",values:{person:k},id:"activity.verificationExpired.contentWithoutTimestamp"})});return r?(0,ae.jsx)(ke,{header:K,isFirst:s,isLast:n,isPrivate:R,rootStore:A,navigableBlockId:b.id,notification:g,icon:(0,ae.jsx)(zo,{}),showSnapshotButton:!1,url:S,...(0,gt.JJ)({notification:g,activity:t,environment:h,tab:a}),children:T}):(0,ae.jsxs)(At,{timestamp:I,header:K,isLast:n,isPrivate:R,rootStore:A,navigableBlockId:b.id,notification:g,icon:(0,ae.jsx)(mt.of,{}),showRecordPath:!0,showSnapshotButton:!1,...(0,gt.h9)({notification:g,activity:t,environment:h,tab:a}),children:[T,(0,ae.jsx)(pt.Z,{tabArgs:o,activity:t,isMobile:h.device.isMobile,environment:h,rootStore:i})]})}function zo(){const e=(0,m.yK)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,ae.jsx)(je,{children:(0,Do.f)(e.icon)})}class Go extends s.Z{UNSAFE_willMountOrUpdate(){!function(e,t){if("commented"===e.type){const o=function(e,t){return t.getRecordStore(t,e)}({table:a.qF,id:e.discussion_id,spaceId:e.space_id},t);if(o.isDefined()){const e=o.getCommentStores();for(const t of e){var i;null===(i=t.getCreatedByStore())||void 0===i||i.load()}}}}(this.props.activity,this.props.rootStore),this.environment.KatexStore.loadIfNeeded((()=>function(e,t){const i=(0,l.cr)({activity:e,rootStore:t});if(!i)return;return i.context}(this.props.activity,this.props.rootStore)))}renderComponent(){const e=this.renderActivityNotification();return null===e?null:(0,ae.jsx)("div",{children:e})}renderActivityNotification(){const{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a}=this.props,l=e.type;if(!n.n_(l))return r.log({level:"error",from:"ActivityNotification",type:"unsupportedActivityType",data:{message:`Activity type ${l} is not supported for ActivityNotification`}}),null;switch(l){case"block-property-edited":return(0,ae.jsx)(Lt,{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a});case"user-mentioned":return(0,ae.jsx)(No,{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a});case"commented":return(0,ae.jsx)(_i,{activity:e,tabArgs:i,rootStore:t,isFirst:o,isLast:s,useInboxRedesign:a});case"user-invited":return(0,ae.jsx)(qo,{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a});case"reminder":return(0,ae.jsx)(Co,{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a});case"email-edited":return(0,ae.jsx)(Ri,{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a});case"access-requested":return(0,ae.jsx)(Ft,{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a});case"access-request-resolved":return(0,ae.jsx)(Tt,{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a});case"team-membership-edited":return(0,ae.jsx)(Ro,{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a});case"private-content-transferred":return(0,ae.jsx)(jo,{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a});case"permission-group-mentioned":return(0,ae.jsx)(Vi,{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a});case"verification-expired":return(0,ae.jsx)(Eo,{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a});case"export-completed":return(0,ae.jsx)(Fi,{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a});case"import-completed":return(0,ae.jsx)(Gi,{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a});case"in-app-notification-automation-action-triggered":return(0,ae.jsx)(go,{activity:e,rootStore:t,tabArgs:i,isFirst:o,isLast:s,useInboxRedesign:a});default:(0,d.t1)(l)}}}Go.displayName="ActivityNotification";const Ho=Go},78730:(e,t,i)=>{i.d(t,{B:()=>l,U:()=>d});var o=i(959753),s=i(947969),n=i(519889),r=i(209309),a=i(304708);function d(e,t){return e.getKeyStore("settings").getKeyStore("seen_guest_membership_requests").getValue()&&(0,a.Ye)(t)}function l(e,t){const i=o.kk.fromAccessRequest(e);if(!i.isPageAccessRequest())return!1;const a=i.getForActorPointer(t.id);return a.table===n.KJ&&!r.y.createChildStore(t,s.v8({userId:a.id,spaceId:t.id})).isMember()}},983420:(e,t,i)=>{i.d(t,{TL:()=>u,nc:()=>c,ue:()=>l});var o=i(266897),s=i(554368),n=i(177420),r=i(519889),a=i(401898),d=i(206258);function l(e){const{parentStore:t,pointer:i}=e,s=(0,d.Kv)(t,i).getValue();if(s)return(0,o.LU)({table:i.table,value:s})}function c(e){const{parentStore:t,pointer:i}=e;return i.table===n.cZ?d.Qx.createChildStore(t,i):i.table===r.KJ?d.U6.createChildStore(t,i):i.table===s.y0?d.fg.createChildStore(t,i):void(0,a.t1)(i)}function u(e){return e.table===n.cZ?(0,o.ON)(e.getValue()):e.table===r.KJ?(0,o.m3)(e.getValue()):e.table===s.y0?(0,o.I4)(e.getValue()):void(0,a.t1)(e)}},28092:(e,t,i)=>{i.d(t,{v:()=>p,E:()=>h});i(252262),i(324506);var o=i(800480),s=i(886628),n=i(151744),r=i(519889),a=i(653965),d=i(667294),l=i(376719);var c=i(206258),u=i(250557),m=i(288280),g=i(883165);function p(e){var t;let{spaceStore:i,request:n}=e;const d=(0,o.O7)(),l=(0,s.VK)((()=>{if(n)return new c.U6(d,{id:n.getForActorId(),table:r.KJ}).getModel()}),[n,d]),u=n&&l?{accessRequest:n,forActor:l}:void 0;return null===(t=h({spaceStore:i,requests:(0,a.oA)([u])}))||void 0===t?void 0:t.at(0)}function h(e){let{spaceStore:t,requests:i}=e;const r=function(e){let{spaceStore:t,requests:i}=e;const n=(0,o.O7)(),r=function(e){const t=(0,l.U)(e);return(0,d.useCallback)((e=>t.memberEmails.has(e)?"member":t.guestEmails.has(e)?"guest":void 0),[t])}(m.subscriptionDataStoreInstance),a=(0,s.VK)((()=>null==i?void 0:i.map((e=>({email:e.forActor.email,currentRole:r(e.forActor.email)})))),[i,r]),c=n.currentUser.id,p=c?(0,g.VK)(t,c):void 0;return(0,u.WT)({space:t,spaceUser:p,team:void 0,optimism:"optimistic",invitees:a??[]})}({spaceStore:t,requests:i});return(0,s.VK)((()=>null==i?void 0:i.map((e=>{var t;const i=(0,n.Z)(e.accessRequest),o=null==r||null===(t=r[e.forActor.email])||void 0===t?void 0:t.type;return"guest_invite_request"!==i?i:"cannot_add"===o?"space_membership_request":"guest_invite_request"}))),[i,r])}},370345:(e,t,i)=>{i.d(t,{Z:()=>n});var o=i(667294),s=i(800480);function n(e){const t=(0,s.O7)(),{onLongPress:i,hapticsEnabled:n=!0,timeout:r=300}=e,a=(0,o.useCallback)((()=>{var e,o,s;n&&(null!==(e=t.mobileNative)&&void 0!==e&&e.buzz?t.mobileNative.buzz():null===(o=(s=window.navigator).vibrate)||void 0===o||o.call(s,20));i()}),[t.mobileNative,n,i]),d=(0,o.useRef)(),l=(0,o.useRef)(0),c=(0,o.useRef)(0),u=(0,o.useCallback)((()=>clearTimeout(d.current)),[]);(0,o.useEffect)((()=>u),[u]);return{onTouchStart:(0,o.useCallback)((()=>{clearTimeout(d.current),d.current=setTimeout(a,r)}),[r,a]),onTouchMove:(0,o.useCallback)((e=>{const t=e.touches[0].clientX,i=e.touches[0].clientY;(Math.abs(t-l.current)>50||Math.abs(i-c.current)>50)&&clearTimeout(d.current)}),[]),onTouchEnd:u,onTouchCancel:u}}},895285:(e,t,i)=>{i.d(t,{PQ:()=>U,ZP:()=>L,aE:()=>q,b8:()=>P});var o=i(667294),s=i(800480),n=i(886628),r=i(724405),a=i(552867),d=i(890334),l=i(670753),c=i(261248),u=i(698519),m=i(355863),g=i(755061),p=i(421202),h=i(709291),v=i(401898),f=i(137810),b=i(519719),y=i(717659),x=i(210228),M=i(552275),S=i(231945),A=i(573063),j=i(478140),k=i(632163),C=i(672495),_=i(526388),R=i(164369),w=i(212534),I=i(460709),F=i(98742),B=i(424764),K=i(157538),T=i(206258),V=i(785893);const O=(0,h.defineMessages)({changePageNotificationSettings:{defaultMessage:"Change page notification settings",id:"inboxActionsMenu.notificationSettings.tooltipMessage"},markUnread:{defaultMessage:"Mark this notification as unread",id:"inboxActionsMenu.markNotificationAsUnread.tooltipMessage"},markRead:{defaultMessage:"Mark this notification as read",id:"inboxActionsMenu.markNotificationAsRead.tooltipMessage"},archive:{defaultMessage:"Archive this notification",id:"inboxActionsMenu.handleArchive.tooltipMessage"},unarchive:{defaultMessage:"Unarchive",id:"inboxActionsMenu.handleUnarchive.tooltipMessage"}}),P=96;function Z(e){const{notification:t,rootStore:i,onArchiveClicked:u,onUnarchiveClicked:v,onMarkAsReadClicked:M,onMarkAsUnreadClicked:j,useInboxRedesign:k}=e,C=(0,s.O7)(),R=(0,s.Fy)(),I=(0,h.useIntl)(),P=(0,n.VK)((()=>!!t&&(0,g.$2)(t.type)),[t]),Z=(0,n.VK)((()=>{const e=null==t?void 0:t.navigable_block_id;if(e)return T.G.createChildStore(i,{table:p.iU,id:e})}),[i,t]),L=(0,n.VK)((()=>null==Z?void 0:Z.getFollowSettingsKey()),[Z]),N=(0,n.VK)((()=>{if(!L)return[];if(!Z)return[];return B.Z({followSettingsKey:L,environment:C,blockStore:Z,from:"inbox"})}),[L,C,Z]),D=(0,n.VK)((()=>P&&N.length>0),[P,N]),W=(0,o.useCallback)((e=>{t&&(0,w.ZP)({event:e,context:w.Af.NotificationClick,callback:()=>{u(),x.createAndCommit({userAction:"InboxActionsMenu.handleArchive",environment:C,perform:e=>{y.aZ({notification:t,rootStore:i,transaction:e})}})}})}),[C,t,u,i]),E=(0,o.useCallback)((e=>{t&&(0,w.ZP)({event:e,context:w.Af.NotificationClick,callback:()=>{v(),x.createAndCommit({userAction:"Activity.handleUnarchive",environment:C,perform:e=>{y.E1({notificationId:t.id,visited:!1,rootStore:i,transaction:e})}})}})}),[C,t,v,i]),z=(0,o.useCallback)((e=>{t&&(0,w.ZP)({event:e,context:w.Af.NotificationClick,callback:()=>{t.read?j():M(),x.createAndCommit({userAction:"InboxActionsMenu.toggleNotificationReadStatus",environment:C,perform:e=>{y.$h({notification:t,rootStore:i,transaction:e,read:!t.read})}})}})}),[C,t,M,j,i]),G=(0,o.useCallback)((()=>{L&&Z&&t&&b.Z8({environment:C,notificationId:t.id,pageId:Z.pointer.id,isCurrentlyFollowing:(0,K.Z)(L).following,from:"inbox"})}),[C,Z,L,t]),H=(0,r.yK)((e=>({container:{...k?{display:"flex",height:"min-content",padding:2,borderWidth:R.isMobile?0:1,borderStyle:"solid",borderColor:e.stroke.regular,background:e.buttonGroupBackground,borderRadius:6,boxShadow:R.isMobile?void 0:"0px 2px 4px 0px rgba(22, 29, 27, 0.02)"}:{display:"flex",height:"min-content",background:e.buttonGroupBackground,boxShadow:e.lightBoxShadow,borderRadius:4,padding:2}},button:{...k&&{height:R.isMobile?30:22,width:R.isMobile?30:22}},inboxIconBase:{fill:e.icon.secondary},iconStyle:{fill:e.mediumIconColor,padding:R.isMobile?1:2},readIcon:{width:R.isMobile?22+(k?5:0):22,height:R.isMobile?22+(k?5:0):22},archiveIcon:{width:R.isMobile?22+(k?5:0):22,height:R.isMobile?22+(k?5:0):22},ellipsisIcon:{width:R.isMobile?22+(k?5:0):22,height:R.isMobile?22+(k?5:0):22},headerLabel:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:f.Z.fontWeight.semibold}})),[R,k]),J=q();if(k&&t.visited)return(0,V.jsx)("div",{style:H.container,children:(0,V.jsx)(_.Z,{renderTooltip:()=>I.formatMessage(O.unarchive),render:e=>(0,V.jsx)(A.Z,{ariaLabel:I.formatMessage(O.unarchive),style:H.button,icon:m.s,iconStyle:{...H.iconStyle,...H.inboxIconBase},onClick:E,...e})})});const Y=(0,V.jsx)(_.Z,{renderTooltip:()=>I.formatMessage(t.read?O.markUnread:O.markRead),render:e=>(0,V.jsx)(A.Z,{ariaLabel:I.formatMessage(t.read?O.markUnread:O.markRead),style:H.button,icon:t.read?c.F:l.F,iconStyle:{...H.iconStyle,...H.readIcon,...k&&{height:22,width:22,...H.inboxIconBase}},onClick:z,...e})},"markUnread"),$=(0,V.jsx)(_.Z,{renderTooltip:()=>I.formatMessage(O.archive),render:e=>(0,V.jsx)(A.Z,{ariaLabel:I.formatMessage(O.archive),style:H.button,icon:a.H,iconStyle:{...H.iconStyle,...H.archiveIcon,...k&&{height:22,width:22,...H.inboxIconBase}},onClick:W,...e})},"archive"),X=D?(0,V.jsx)(_.Z,{renderTooltip:()=>(0,V.jsx)(h.FormattedMessage,{...O.changePageNotificationSettings}),render:e=>(0,V.jsx)(S.ZP,{style:J.popup,popupType:R.isMobile?S.Z4.SlideUp:S.Z4.Popup,alignmentToOrigin:S.vR.Start,placementToOrigin:S.pO.Bottom,render:e=>(0,V.jsx)(U,{blockStore:Z,notification:t,handlers:{handleUnarchive:E,handleArchive:W,toggleNotificationReadStatus:z},closePopup:()=>e.close()}),renderOrigin:t=>(0,V.jsx)(A.Z,{ariaLabel:I.formatMessage(O.changePageNotificationSettings),style:H.button,icon:d.O,iconStyle:{...H.iconStyle,...H.archiveIcon,...k&&{height:18,width:18,...H.inboxIconBase}},...e,...(0,F.Z)(t,{onClick:()=>G()})})})},"pageNotificationSettings"):void 0;return(0,V.jsx)("div",{style:H.container,children:[Y,$,X]})}function U(e){const{blockStore:t,notification:i,handlers:o,closePopup:d}=e,{handleArchive:g,handleUnarchive:p,toggleNotificationReadStatus:f}=o,b=(0,s.O7)(),y=(0,s.Fy)(),x=(0,h.useIntl)(),S=(0,n.VK)((()=>null==t?void 0:t.getFollowSettingsKey()),[t]),A=(0,n.VK)((()=>{if(!S)return[];if(!t)return[];return B.Z({followSettingsKey:S,environment:b,blockStore:t,from:"inbox"})}),[S,b,t]),_=q(),w=(0,r.yK)((()=>({iconContainer:{display:"flex",justifyContent:"center",alignItems:"center",..._.icon},icon:{height:24,width:24}})),[_.icon]);return(0,V.jsx)(j.Z,{menuType:I.og.Popup,height:y.isMobile?"50vh":void 0,minWidth:250,maxWidth:y.isMobile?"100vw":void 0,scrollerStyle:_.menuScroller,header:!y.isMobile&&(0,V.jsx)(R.Z,{style:_.header,isSmall:!y.isMobile,isSecondaryColor:!y.isMobile,children:(0,V.jsx)(h.FormattedMessage,{id:"UpdateSidebarTabUpdatesHeader.pageNotificationSettings.label",defaultMessage:"Page notification settings"})}),children:(0,V.jsx)(k.Z,{type:k.i.Vertical,sections:[...y.isMobile?[{key:"Actions title",render:()=>(0,V.jsx)(R.Z,{style:_.header,isSmall:!y.isMobile,isSecondaryColor:!y.isMobile,children:(0,V.jsx)(h.FormattedMessage,{id:"inbox.actionsSectionTitle.label",defaultMessage:"Actions"})}),items:[]},{key:"Actions",render:e=>(0,V.jsx)(C.Z,{...e,topBorder:!1,style:_.sectionMenuItem}),items:["markAsReadOrUnread","archive"].map(((e,t)=>{const o=t===A.length-1,s=y.isMobile&&o;return{key:e,render:t=>"archive"===e?(0,V.jsx)(M.Z,{...t,style:{..._.buttonMenuItem,...s&&_.transparentButtonMenuItemBorder},pressedStyle:_.buttonMenuItemPressed,icon:i.visited?(0,m.s)(_.icon):(0,a.H)(_.icon),title:x.formatMessage(i.visited?O.unarchive:O.archive),titleStyle:_.title}):"markAsReadOrUnread"===e?(0,V.jsx)(M.Z,{...t,style:{..._.buttonMenuItem,...s&&_.transparentButtonMenuItemBorder},pressedStyle:_.buttonMenuItemPressed,icon:i.read?(0,V.jsx)("div",{style:w.iconContainer,children:(0,c.F)(w.icon)}):(0,V.jsx)("div",{style:w.iconContainer,children:(0,l.F)(w.icon)}),title:x.formatMessage(i.read?O.markUnread:O.markRead),titleStyle:_.title}):void(0,v.t1)(e),action:t=>{let{event:o}=t;"markAsReadOrUnread"===e?f(o):"archive"===e?i.visited?p(o):g(o):(0,v.t1)(e),d()}}}))}]:[],...y.isMobile?[{key:"Page notification settings title",render:()=>(0,V.jsx)(R.Z,{style:_.subheader,isSmall:!y.isMobile,isSecondaryColor:!y.isMobile,children:(0,V.jsx)(h.FormattedMessage,{id:"inbox.notifyMeForSectionTitle.label",defaultMessage:"Notify me for"})}),items:[]}]:[],{key:"Page notification settings",render:e=>(0,V.jsx)(C.Z,{...e,topBorder:!1,style:_.sectionMenuItem}),items:A.map(((e,t)=>{const i=t===A.length-1,o=y.isMobile&&i;return{key:e.action.analyticsName,render:t=>(0,V.jsx)(M.Z,{...t,style:{..._.buttonMenuItem,...o&&_.transparentButtonMenuItemBorder},pressedStyle:_.buttonMenuItemPressed,title:e.title,titleStyle:_.title,right:e.isSelectedOption?(0,u.k)(_.checkIcon):void 0}),action:()=>{e.action.action({environment:b,blocks:[],lazyDependencies:{markdownLinkifyIt:void 0,tinyMceMicrosoftWordPasteFilter:void 0},publicEditMode:void 0}),d()}}}))}],initialFocus:void 0,onAccept:()=>d()})})}function q(){const e=(0,s.Fy)();return(0,r.yK)((t=>({popup:{...e.isMobile&&{borderTopLeftRadius:12,borderTopRightRadius:12,overflow:"hidden"}},menuScroller:e.isMobile?{background:t.surface.wash}:{},header:e.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:f.Z.fontWeight.semibold,background:t.surface.wash,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:f.Z.fontWeight.semibold},subheader:e.isMobile?{display:"flex",justifyContent:"start",alignItems:"center",fontSize:15,fontWeight:f.Z.fontWeight.medium,background:t.surface.wash,height:45,color:t.text.secondary,paddingLeft:16,paddingRight:16}:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:f.Z.fontWeight.semibold},sectionMenuItem:e.isMobile?{overflow:"hidden",background:t.buttonBackground,borderRadius:12,marginLeft:16,marginRight:16,marginBottom:16,borderWidth:1,borderStyle:"solid",borderColor:t.stroke.deemphasized,padding:void 0}:{},buttonMenuItem:e.isMobile?{backgroundColor:t.surface.elevated,paddingTop:12,paddingBottom:12,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:t.stroke.deemphasized}:{},buttonMenuItemPressed:{background:t.buttonPressedBackground},transparentButtonMenuItemBorder:{borderBottomColor:"transparent"},title:e.isMobile?{fontSize:16}:{},icon:{...e.isMobile?{height:24,width:24}:{height:20,width:20}},checkIcon:{...e.isMobile?{height:20,width:20}:{height:16,width:16}}})),[e])}const L=o.memo(Z)},424764:(e,t,i)=>{i.d(t,{t:()=>S,Z:()=>x});i(667294);var o=i(371663),s=i(698519),n=i(709291),r=i(401898),a=i(62967),d=i(57883),l=i(519719),c=i(709953),u=i(210228);function m(e){const{environment:t,key:i,selectedKey:o,following:s,followSettings:n,navigableBlockId:r,userId:a,spaceId:m,from:g}=e;u.createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{c.Ue({environment:e.environment,table:d.t0,args:{following:s,followSettings:n,navigableBlockId:r,userId:a,spaceId:m},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),s?l.RJ(t,{from:"page_updates"}):l.ub(t,{from:"page_updates"}),o!==i&&l.kL(t,{from:g,navigableBlockId:r,oldSetting:o,newSetting:i})}var g=i(164964),p=i(693405),h=i(164369),v=i(80444),f=i(157538),b=i(785893);const y=(0,n.defineMessages)({repliesAndMentions:{id:"pageNotificationSettings.repliesAndMentions.displayName",defaultMessage:"Mentions"},comments:{id:"pageNotificationSettings.comments.displayName",defaultMessage:"Comments"},allUpdates:{id:"pageNotificationSettings.allUpdates.displayName",defaultMessage:"All"},importantUpdates:{id:"pageNotificationSettings.importantUpdates.displayName",defaultMessage:"Important"}});function x(e){const{followSettingsKey:t,environment:i,blockStore:s,from:r}=e,a=M({key:"none",selectedKey:t,title:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.repliesAndMentions.label",defaultMessage:"Replies and @mentions"}),displayName:y.repliesAndMentions,environment:i,blockStore:s,from:r}),d=M({key:"comments",selectedKey:t,title:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.allComments.label",defaultMessage:"All comments"}),displayName:y.comments,environment:i,blockStore:s,from:r}),l=M({key:"all",selectedKey:t,title:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.allUpdates.label",defaultMessage:"All updates"}),caption:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.simpleAllUpdates.caption",defaultMessage:"All comments and property changes"}),displayName:y.allUpdates,environment:i,blockStore:s,from:r}),c=s.getAssociatedCollectionStore();if(!c)return[d,a];const u=c.getDatabaseType();if(u===o.iS){return[l,M({key:"important",selectedKey:t,title:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesTasks.label",defaultMessage:"Important updates"}),caption:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesTasks.caption",defaultMessage:"All comments and changes to Status, Assignee, or Due Date"}),displayName:y.importantUpdates,environment:i,blockStore:s,from:r}),a]}if(u===o.wW){return[l,M({key:"important",selectedKey:t,title:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesProjects.label",defaultMessage:"Important updates"}),caption:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesProjects.caption",defaultMessage:"All comments and changes to Status or Date"}),displayName:y.importantUpdates,environment:i,blockStore:s,from:r}),a]}return[l,M({key:"comments",selectedKey:t,title:(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.onlyCommentsAllComments.label",defaultMessage:"All comments"}),displayName:y.comments,environment:i,blockStore:s,from:r}),a]}function M(e){const{key:t,title:i,caption:o,selectedKey:n,environment:r,blockStore:d,from:l,displayName:c}=e,u=S({key:t,userSelectedKey:n}),y={icon:{width:14,height:14},rightWrapper:o?{alignSelf:"flex-start",paddingTop:2}:{}};return{action:(0,a.cN)({key:t,displayName:c,analyticsName:t,validators:[],closeParentMenu:!0,action:()=>{const{currentUserRootStore:e}=v.default.state;if(e){const{following:i,followSettings:o}=(0,f.Z)(t),s=e.id,a=d.id,c=d.getSpaceId();m({environment:r,following:i,followSettings:o,navigableBlockId:a,spaceId:c,userId:s,from:l,key:t,selectedKey:n}),"inbox"!==l&&"more_menu"!==l||g.d4({item:{label:A(t)},undoFunc:()=>{const{following:e,followSettings:i}=(0,f.Z)(n);m({environment:r,following:e,followSettings:i,navigableBlockId:a,spaceId:c,userId:s,from:l,key:t,selectedKey:n})}})}},render:e=>(0,b.jsx)(p.Z,{...e,title:(0,b.jsx)(h.Z,{children:i}),caption:o,shouldWrapCaption:!0,right:u?(0,s.k)(y.icon):(0,b.jsx)("div",{style:y.icon}),rightStyle:y.right})}),title:i,isSelectedOption:u}}function S(e){const{key:t,userSelectedKey:i}=e;return"important"===i||"comments"===i?"important"===t||"comments"===t:t===i}function A(e){switch(e){case"none":return(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.subscribedRepliesAndMentionsSuccess.snackbarMessage",defaultMessage:"Subscribed to replies and @mentions"});case"comments":return(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllCommentsSuccess.snackbarMessage",defaultMessage:"Subscribed to all comments"});case"important":return(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.subscribedImportantUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to important updates"});case"all":return(0,b.jsx)(n.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to all updates"});default:(0,r.t1)(e)}}},157538:(e,t,i)=>{i.d(t,{Z:()=>n});var o=i(57883),s=i(401898);function n(e){switch(e){case"all":return{following:!0,followSettings:(0,o.yI)({explicitly_set_by_user:!0})};case"important":return{following:!0,followSettings:(0,o.GC)({explicitly_set_by_user:!0})};case"comments":return{following:!0,followSettings:(0,o.r$)({explicitly_set_by_user:!0})};case"none":return{following:!1,followSettings:(0,o.vU)({explicitly_set_by_user:!0})};default:(0,s.t1)(e)}}},448451:(e,t,i)=>{i.d(t,{$H:()=>a,$q:()=>m,LV:()=>d,QU:()=>u,VO:()=>c,Xm:()=>n,co:()=>g,hR:()=>h,k2:()=>p,lD:()=>l,tY:()=>r});var o=i(296994),s=i(277907);const n=(0,s.kF)(o.FF.notifications,(e=>e.GetNotifiedFor)),r=(0,s.kF)(o.FF.notifications,(e=>e.TopbarUpdatesMenu)),a=(0,s.kF)(o.FF.notifications,(e=>e.UpdateSidebar)),d=(0,s.kF)(o.FF.notifications,(e=>e.MobileInboxPopup)),l=(0,s.kF)(o.FF.notifications,(e=>e.InboxActionsMenu)),c=(0,s.kF)(o.FF.notifications,(e=>e.InboxFilterForUnreadButton)),u=((0,s.kF)(o.FF.notifications,(e=>e.InboxMentionsActionButtons)),(0,s.kF)(o.FF.notifications,(e=>e.InboxModalHeader))),m=(0,s.kF)(o.FF.notifications,(e=>e.InboxNotificationSettingsButton)),g=(0,s.kF)(o.FF.notifications,(e=>e.InboxRefreshAllTabButton)),p=((0,s.kF)(o.FF.notifications,(e=>e.NotificationGroupActionsMenu)),(0,s.kF)(o.FF.notifications,(e=>e.UnreadMentionsBadge))),h=(0,s.kF)(o.FF.notifications,(e=>e.NotificationInboxPanelContent))},376719:(e,t,i)=>{i.d(t,{U:()=>l});var o=i(800480),s=i(886628),n=i(519889),r=i(401898),a=i(206258),d=i(88893);function l(e){const t=(0,o.O7)();return(0,s.VK)((()=>{const i=e.state;if(!i)return{memberEmails:new Set,guestEmails:new Set};const o=d.hn(i),s=d.ND(i),l=e=>new a.U6(t,{table:n.KJ,id:e.userId}).getEmail();return{memberEmails:new Set(o.map(l).filter(r.$K)),guestEmails:new Set(s.map(l).filter(r.$K))}}),[t,e])}},893586:(e,t,i)=>{i.d(t,{Z:()=>n});var o=i(292595);const s=new(i(551444).q)((e=>{let{spaceId:t}=e;return t}),(async function(e,t){let{spaceId:o}=t;const s=await Promise.resolve().then(i.bind(i,454642)),n=await s.getInternalDomains(e,{spaceId:o});return"success"===n.type?n.data.internalDomains:void 0}));o.exposeDebugValue("InternalDomainsStore",s);const n=s},598905:(e,t,i)=>{i.d(t,{Z:()=>n});var o=i(749085);class s extends o.default{getInitialState(){return{count:0}}}const n=new s},887199:(e,t,i)=>{i.d(t,{h:()=>n,k:()=>s});var o=i(709291);const s=(0,o.defineMessages)({paymentMethodUnverified:{id:"subscriptions.paymentMethodUnverified",defaultMessage:"Your payment is being processed. Please try again when your payment has completed."},otherPaymentMethod:{id:"subscriptions.otherPaymentMethod",defaultMessage:"Other"},adminOnlyAction:{id:"subscriptions.adminOnlyAction",defaultMessage:"Only workspace owners can perform this action."},iosSubscriptionRestriction:{id:"subscriptions.iosSubscriptionRestriction",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."}}),n=(0,o.defineMessages)({trialTitle:{id:"nudges.trial.title",defaultMessage:"Notion for collaboration"},trialDescription:{id:"nudges.trial.description",defaultMessage:"Get 14 days of unlimited content creation with others"},trialCta:{id:"nudges.trial.cta",defaultMessage:"Try it for free"},trialTooltip:{id:"nudges.trial.tooltip",defaultMessage:"Use Notion as much as you want, with as many people as you like. Youâ€™ll receive a reminder when your trial is ending, and can cancel anytime."},approachingBlockLimitTitle:{id:"nudges.approachingBlockLimit.title",defaultMessage:"Upgrade to go unlimited"},approachingBlockLimitDescription:{id:"nudges.approachingBlockLimit.description",defaultMessage:"Continue using Notion to collaborate with others"},approachingBlockLimitTooltip:{id:"nudges.approachingBlockLimit.tooltip",defaultMessage:"Youâ€™re reaching the maximum number of free blocks given on your plan ({percentageUsed}). You wonâ€™t be able to create more content unless you upgrade to the Plus plan."},reachedBlockLimitTitle:{id:"nudges.reachedBlockLimit.title",defaultMessage:"Keep using Notion"},reachedBlockLimitDescription:{id:"nudges.reachedBlockLimit.description",defaultMessage:"{spaceName} has used 100% of the free blocks in the workspace"},reachedBlockLimitCta:{id:"nudges.reachedBlockLimit.cta",defaultMessage:"Upgrade plan"},reachedBlockLimitTooltip:{id:"nudges.reachedBlockLimit.tooltip",defaultMessage:"Youâ€™ve reached the maximum number of free blocks for your plan (100%). You wonâ€™t be able to create more content unless you upgrade to the Plus plan."}})},44041:(e,t,i)=>{i.d(t,{y:()=>S});i(667294);var o=i(647425),s=i(709291),n=i(286572),r=i(547307),a=i(296994),d=i(433929),l=i(352533),c=i(80444),u=i(992083),m=i(739343),g=i(887199),p=i(735993),h=i(170060),v=i(88893),f=i(535057),b=i(288280),y=i(897630),x=i(864891),M=i(785893);async function S(e,t){var i;n.sA(e,{from:t.from,for_subscription_tier:t.for,addOnFeature:t.addOnFeature});if((0,f.QM)()&&["block_limit_sidebar","block_limit_settings","block_limit_banner"].includes(t.from)&&!t.addOnFeature){if(e.device.isMobileBrowser){const i=await a.FF.payments.load();return void(await i.plans.showPlans({environment:e,from:t.from}))}return(0,h.iZ)(e)?void(0,p.a)({openedFrom:t.from}):void u.Z.setState({open:!0,openedFrom:"upsell",currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0})}if(!t.addOnFeature&&(0,o.QM)(t.for))return;const S=(0,l.S$)({environment:e})&&"personal"===t.for;if(e.device.isMobileNative){if("ai"===t.addOnFeature){const t=(0,l.Y2)({environment:e})?(0,M.jsx)(s.FormattedMessage,{id:"upsellActions.noIAPForAIWithExternalPurchaseOption",defaultMessage:"Your workspace does not have unlimited AI. Visit on desktop to purchase Notion AI and go unlimited."}):(0,M.jsx)(s.FormattedMessage,{id:"upsellActions.noIAPForAIWithoutExternalPurchaseOption",defaultMessage:"Your workspace does not have unlimited AI. Unfortunately, unlimited AI cannot be purchased on mobile."});return void r.showErrorMessage(t)}if(!S)return}const A=c.default.state.currentSpaceStore;if(!A)return;if(!A.canAdmin())return;await y.bi(e);const j=b.subscriptionDataStoreInstance.state;if(!j)return;if("unsubscribed_admin"!==j.type&&"subscribed_admin"!==j.type)return void(t.dontOpenPlansOnCancel||u.Z.setState({open:!0,openedFrom:"upsell",currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0}));if(v.ri(j))return void r.showErrorMessage(d.default.formatMessage(g.k.paymentMethodUnverified));if(v.ff(j)){const e=(0,M.jsx)(s.FormattedMessage,{id:"upsellActions.referToSalesRep",defaultMessage:"This workspace is part of a managed account. Please contact your account representative to discuss any changes to your subscription."});return void r.showErrorMessage(e)}if(S)return void(e.mobileNative&&A.id&&e.mobileNative.openUpgradeModal(A.id));if("revenueCat"===(null===(i=j.customerData)||void 0===i?void 0:i.activeSubscriptionPlatform)){const e=(0,M.jsx)(s.FormattedMessage,{id:"upsellActions.switchPlanFromInAppPurchase",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."});return void r.showErrorMessage(e)}const k=v.XX(j);if(t.addOnFeature&&(0,m.Fk)(k)){const e=(0,M.jsx)(s.FormattedMessage,{id:"upsellActions.noAddOnPurchaseDuringFreeTrial",defaultMessage:"Unfortunately, additional {addOn, select, ai {AI responses} other {features}} cannot be purchased while a workspace is on a free trial.",values:{addOn:t.addOnFeature}});r.showErrorMessage(e)}else{if(k&&v.MM(j))return t.addOnFeature?void x.af({environment:e,from:t.from,view:"add_ons",addOnFeature:t.addOnFeature,billingInterval:k.interval,pageSection:t.pageSection}):void x.af({environment:e,from:t.from,view:"plans",temporarySubscriptionTier:t.for,billingInterval:k.interval,pageSection:t.pageSection});{const i=(0,h.px)(e,t.for)?"ai_fifty_percent":void 0;y.I0(e,{subscriptionTier:t.for,from:t.from,addOnFeature:t.addOnFeature,coupon:i,isTrial:t.isTrial,dismissMobilePlansModal:t.dismissMobilePlansModal})}}}},735993:(e,t,i)=>{i.d(t,{X:()=>a,a:()=>r});var o=i(471924),s=i(286572),n=i(868187);function r(e){const{openedFrom:t}=e,i=o.Il();n.Z.open({modalId:i,openedFrom:t})}function a(e,t){s.LY(e,{modal_id:t,modal_type:"contextual"}),n.Z.setState({open:!1})}},868187:(e,t,i)=>{i.d(t,{Z:()=>n});var o=i(749085);class s extends o.default{getInitialState(){return{open:!1}}open(e){this.setState({open:!0,...e})}}const n=new s},891694:(e,t,i)=>{i.d(t,{Z:()=>v});i(667294);var o=i(800480),s=i(886628),n=i(724405),r=i(647425),a=i(709291),d=i(531701),l=i(401898),c=i(137810),u=i(174136),m=i(526388),g=i(825464),p=i(44041),h=i(785893);const v=function(e){let{subscriptionTier:t,mobileStyle:i,desktopStyle:v,analyticsName:f,onClick:b}=e;const y=(0,n.Fg)(),x=(0,o.O7)(),{device:M}=x,S=M.isIOS&&M.isNative,A=(0,s.VK)((()=>function(e,t){switch(e){case"plus":case"business":case"enterprise":return{color:t.blueColor,background:"light"===t.mode?d.ZP.diffBackground:"rgba(35, 131, 226, 0.2)",fontWeight:c.Z.fontWeight.medium};default:return{}}}(t,y)),[t,y]);if(S)return null;let j;return"personal"===t?j=(0,h.jsx)(a.FormattedMessage,{defaultMessage:"Personal Pro",id:"upgradeButton.personal.text"}):(0,r.eR)(t)?j=(0,h.jsx)(a.FormattedMessage,{defaultMessage:"Plus â†—",id:"upgradeButton.plus.textWithArrow"}):(0,r.NG)(t)?j=(0,h.jsx)(a.FormattedMessage,{defaultMessage:"Business â†—",id:"upgradeButton.business.textWithArrow"}):(0,r.wP)(t)?j=(0,h.jsx)(a.FormattedMessage,{defaultMessage:"Enterprise â†—",id:"upgradeButton.enterprise.textWithArrow"}):(0,l.t1)(t),M.isMobile?(0,h.jsx)(u.Z,{mobileStyle:i,children:j}):(0,h.jsx)(m.Z,{delayThreshold:120,placement:g.u.Bottom,renderTooltip:()=>(0,h.jsxs)("div",{style:{maxWidth:500},children:[(0,h.jsx)(a.FormattedMessage,{defaultMessage:"Upgrade to use this feature.",id:"upgradeButton.upgrade.tooltip"}),(0,h.jsx)("br",{}),(0,h.jsx)(a.FormattedMessage,{defaultMessage:"Click to learn more.",id:"upgradeButton.learnMore.tooltip"})]}),originGap:6,render:e=>(0,h.jsx)(u.Z,{desktopStyle:v,innerStyle:A,onClick:e=>function(e,t,i,o,s){p.y(o,{from:t,for:i}),s&&s(e)}(e,f,t,x,b),...e,children:j})})}},854669:(e,t,i)=>{i.d(t,{Z:()=>l});i(667294);var o=i(800480),s=i(526388),n=i(98742),r=i(44041),a=i(891694),d=i(785893);const l=function(e){const t=(0,o.O7)(),{render:i,requireUpgradeToTier:l,analyticsName:c,renderUpgradeTooltip:u,onUpgradeClick:m,alwaysAllowClick:g,tooltipPlacement:p,upgradeButtonDesktopStyle:h,upgradeButtonMobileStyle:v}=e;let f,{onClick:b,renderTooltip:y}=e;return l&&(f=(0,d.jsx)(a.Z,{subscriptionTier:l,analyticsName:c,desktopStyle:{display:"inline-block",pointerEvents:"none",...h},mobileStyle:{display:"inline-block",pointerEvents:"none",...v}}),g||(b=e=>{r.y(t,{from:c,for:l}),m&&m(e)},y=u)),(0,d.jsx)(s.Z,{renderTooltip:y||(()=>null),render:e=>i((0,n.Z)(e,{onClick:b}),f),disableTooltip:!y,placement:p})}},673254:(e,t,i)=>{i.d(t,{V5:()=>o.V5,VX:()=>h,oo:()=>v,eB:()=>f});var o=i(883817),s=i(288280),n=i(170060),r=i(800480),a=i(886628),d=i(815047),l=i(947969),c=i(635150),u=i(206258);function m(e,t){const{name:i,spaceId:o,spaceUserId:s}=t,n=(0,r.O7)();return(0,a.VK)((()=>{if(!o||!s)return;const r=c.Z.getData(n,{spaceId:o});if(!r)return;const a=new u.H2(n,{table:d.bx,id:o}),m=new u.y3(n,{table:l.WU,spaceId:o,id:s}),g=e[i]({environment:n,spaceId:o});return{...t,scope:{type:"space",billingData:r,premiumFeatureOverrides:a.getSettings().premium_feature_overrides??{}},actor:{isSpaceAdmin:(null==m?void 0:m.isWorkspaceOwner())??!1},data:g}}),[n,i,t,e,o,s])}var g=i(88893);const p={guests:e=>{const t=s.subscriptionDataStoreInstance.state;return{current:t?(0,g.lk)(t):0}},internal_guests:e=>{const t=s.subscriptionDataStoreInstance.state;return{current:t?(0,g.lk)(t):0,hasLowGuestLimit:(0,n.fc)()}},non_admin_members:e=>{}};function h(e){const t=m(p,e);return!!t&&(0,o.KQ)(t)}function v(e){const t=m(p,e);if(t)return(0,o.$W)(t)}function f(e){const t=m(p,e);if(!t)return;const i=e.state;return(0,o.lJ)({...t,state:i})}},250557:(e,t,i)=>{i.d(t,{AW:()=>l,WT:()=>c});var o=i(800480),s=i(886628),n=i(24433),r=i(893586),a=i(281236),d=i(673254);function l(e){let{space:t,team:i,spaceUser:a,invitees:l}=e;const c=(0,d.oo)({name:"internal_guests",spaceId:null==t?void 0:t.id,spaceUserId:null==a?void 0:a.id,amount:0}),p=(0,d.oo)({name:"guests",spaceId:null==t?void 0:t.id,spaceUserId:null==a?void 0:a.id,amount:0}),h=u(t),v=m(a),f=g(v,i),b=(0,o.O7)();return(0,s.VK)((()=>{if(!(h&&v&&p&&c))return;const e=h.id,t=r.Z.getData(b,{spaceId:e})??[];return(0,n.CR)({space:h,domains:t,team:f,spaceUser:v,invitees:l,internalGuestFeatureAvailability:c,guestFeatureAvailability:p})}),[h,f,c,p,v,l,b])}function c(e){let{space:t,team:i,spaceUser:a,invitees:l,optimism:c="pessimistic"}=e;const p=(0,d.oo)({name:"internal_guests",spaceId:null==t?void 0:t.id,spaceUserId:null==a?void 0:a.id,amount:0}),h=(0,d.oo)({name:"guests",spaceId:null==t?void 0:t.id,spaceUserId:null==a?void 0:a.id,amount:0}),v=(0,o.O7)(),f=u(t),b=m(a),y=g(b,i);return(0,s.VK)((()=>{if(!(f&&b&&h&&p))return;const e=f.id,t=r.Z.getData(v,{spaceId:e})??[];return(0,n.Lw)({space:f,domains:t,team:y,spaceUser:b,invitees:l,optimism:c,guestFeatureAvailability:h,internalGuestFeatureAvailability:p})}),[f,b,v,y,l,h,p,c])}function u(e){const t=(0,o.O7)(),i=(0,s.VK)((()=>null==e?void 0:e.getModel()),[e]),n=(0,s.VK)((()=>{if(null==e||!e.id)return;const i=a.Z.getData(t,{spaceId:e.id});return i?{id:i.id,disable_guests:i.disableGuests,getSettings:()=>({disable_membership_requests:!1,enable_guest_invite_requests:i.enableGuestInviteRequest})}:void 0}),[e,t]);return i??n}function m(e){return(0,s.VK)((()=>null==e?void 0:e.getModel()),[e])??{isMember:()=>!1,isWorkspaceOwner:()=>!1}}function g(e,t){const i=(0,s.VK)((()=>null==t?void 0:t.getModel()),[t]);return(0,s.VK)((()=>null==e?void 0:e.isMember()),[e])?i:{getDisableGuests:()=>!1}}},949204:(e,t,i)=>{i.d(t,{Id:()=>S,Ng:()=>A,Px:()=>x,ow:()=>M,t_:()=>y,um:()=>b});var o=i(815145),s=i(519889),n=i(709291),r=i(117224),a=i(454642),d=i(709953),l=i(164964),c=i(29974),u=i(210228),m=i(433929),g=i(548779),p=i(80444),h=i(109867),v=i(228517);const f=(0,n.defineMessages)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function b(e){let{environment:t,userId:i,teamStore:o,user:s}=e;const n=o.getSpaceId();if(!n)return;await h.Cj({environment:t,teamId:o.id,spaceId:n,teamMemberInfos:s,isSettingDefaultTeam:!1,inviterId:i})&&(r.UD(t,{store:o,joined_role:"member",from:"team_invite_link"}),await y({environment:t,userId:i,teamStore:o}),l.oV({label:m.default.formatMessage(f.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function y(e){let{environment:t,userId:i,teamStore:s}=e;const n=p.default.state.currentUserRootStore,r=s.getSpaceId();if(!r||!n)return;const a=n.getSpaceViewStores().filter((e=>e.getSpaceId()===r))[0];await c.y3({environment:t,spaceViewStore:a,userSettingsStore:void 0,userRootStore:n,pageVisitSource:o.tY.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await v.I({environment:t,spaceId:r,userId:i}),h.hI({environment:t,teamStore:s,shouldScroll:!0})}async function x(e){let{environment:t,teamId:i,message:o}=e;if(!t.currentUser.id)return;"success"===(await a.requestAccess(t,{type:"current-actor-to-team",teamId:i,message:o})).type?(r.LB(t,{teamId:i}),await S({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{l.oV({label:m.default.formatMessage(f.requestTeamSuccessMessage)})}))):l.oV({label:m.default.formatMessage(f.requestTeamFailureMessage)})}async function M(e){let{environment:t,teamStore:i,accessRequestStore:o,status:n}=e;const a=o.getForActorId();if(!a)return;const l=o.getRecordModel({table:s.KJ,id:a});if(l){if("approved"===n){const e=[{type:"member",entity_type:"user",user_id:l.id}];if(!(await h.Uj({environment:t,teamStore:i,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}u.createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,perform:e=>{d.sW({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:s.KJ,resolved_by_id:t.currentUser.id,status:n}})}}),r.co(t,{store:i,resolution:n})}}async function S(e){let{environment:t}=e;const{lastVisitedSpaceView:i,userRootStore:s,userSettingsStore:n}=await(0,g.iX)({environment:t,disableRedirectUrl:!1});i?await c.y3({environment:t,spaceViewStore:i,userRootStore:s,userSettingsStore:n,pageVisitSource:o.tY.BackForward,navigationType:"switchingToOrLoadingSpace"}):await c.L5({environment:t,userRootStore:s,userSettingsStore:n,pageVisitSource:o.tY.BackForward})}async function A(e){let{environment:t,teamId:i}=e;const o=await a.getTeamAccessRequestMetadata(t,{teamId:i});if("success"===o.type)return o.data}},739343:(e,t,i)=>{i.d(t,{Fk:()=>a,U6:()=>l,nx:()=>d});var o=i(730120),s=i(313991),n=i(407057),r=i(95477);function a(e){return!(null==e||!e.trialEnd)&&e.trialEnd>=o.ou.now().toSeconds()}function d(e){const t=function(e){if(!a(e))return;const t=1e3*(null==e?void 0:e.trialEnd);return null!=e&&e.periodEnd&&e.periodEnd>=o.ou.now().toSeconds()&&e.periodEnd<t?e.periodEnd:t}(e);return t?(0,n.Yx)(t,"long",s.SP):void 0}function l(e){return e?r.default.trials[e.id].duration:r.default.trials.default.duration}},151744:(e,t,i)=>{i.d(t,{Z:()=>s});var o=i(401898);function s(e){return e.isGuestInviteRequest()?"guest_invite_request":e.isPageAccessRequest()?"page_access_request":e.isSpaceMembershipRequest()?"space_membership_request":e.isTeamMembershipRequest()?"team_membership_request":void(0,o.t1)(e)}},552867:(e,t,i)=>{i.d(t,{H:()=>n});i(667294);var o=i(745238),s=i(785893);const n=(0,o.IU)("archive",{viewBox:"0 0 20 20",svg:(0,s.jsx)("path",{d:"M6.247 16.456c-.706 0-1.246-.182-1.62-.547-.37-.364-.554-.9-.554-1.606V7.07h1.34v7.212c0 .287.075.508.226.663.155.15.376.226.663.226h7.39c.282 0 .498-.075.649-.226.155-.155.232-.376.232-.663V7.07h1.347v7.233c0 .702-.187 1.235-.56 1.6-.374.368-.912.553-1.614.553H6.247Zm1.545-5.94a.538.538 0 0 1-.554-.568V9.73c0-.168.05-.303.15-.403a.56.56 0 0 1 .404-.15h4.416c.164 0 .296.05.396.15.105.1.158.235.158.403v.22a.538.538 0 0 1-.554.567H7.792Zm-3.26-2.79c-.466 0-.828-.136-1.088-.41-.255-.278-.382-.647-.382-1.107v-.998c0-.465.132-.834.396-1.107.264-.274.622-.41 1.073-.41H15.47c.46 0 .818.136 1.073.41.26.273.39.642.39 1.107v.998c0 .46-.13.83-.39 1.107-.255.274-.613.41-1.073.41H4.53ZM4.79 6.49h10.418c.16 0 .273-.036.342-.11.068-.077.102-.193.102-.348V5.39c0-.16-.034-.276-.102-.349-.069-.073-.183-.11-.342-.11H4.791c-.16 0-.276.037-.349.11-.068.073-.102.19-.102.349v.642c0 .155.034.271.102.349.073.073.19.11.349.11Z"})})},882855:(e,t,i)=>{i.d(t,{E:()=>n});i(667294);var o=i(745238),s=i(785893);const n=(0,o.IU)("chevronDownRounded",{viewBox:"0 0 15 9",svg:(0,s.jsx)("path",{d:"M7.92188 8.65625C8.19531 8.64844 8.44531 8.54688 8.64844 8.32812L14.5859 2.25C14.7578 2.07812 14.8516 1.85938 14.8516 1.60156C14.8516 1.08594 14.4453 0.671875 13.9297 0.671875C13.6797 0.671875 13.4375 0.773438 13.2578 0.953125L7.92969 6.42969L2.58594 0.953125C2.40625 0.78125 2.17188 0.671875 1.91406 0.671875C1.39844 0.671875 0.992188 1.08594 0.992188 1.60156C0.992188 1.85938 1.08594 2.07812 1.25781 2.25L7.20312 8.32812C7.41406 8.54688 7.64844 8.65625 7.92188 8.65625Z"})})},40462:(e,t,i)=>{i.d(t,{o:()=>n});i(667294);var o=i(745238),s=i(785893);const n=(0,o.IU)("globe2",{viewBox:"0 0 16 16",svg:(0,s.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM3.88477 3.76465C4.56836 3.11523 5.39551 2.61621 6.31836 2.34277C5.83301 2.82812 5.42285 3.51172 5.11523 4.3457C4.63672 4.19531 4.22656 3.99707 3.88477 3.76465ZM9.68848 2.34961C10.6045 2.62305 11.4316 3.11523 12.1084 3.76465C11.7734 4.00391 11.3633 4.19531 10.8848 4.35254C10.5771 3.51172 10.167 2.82812 9.68848 2.34961ZM8.47852 2.56836C9.0459 2.8418 9.56543 3.58008 9.93457 4.58496C9.4834 4.66699 8.99805 4.71484 8.47852 4.73535V2.56836ZM6.06543 4.58496C6.44141 3.58008 6.9541 2.8418 7.52148 2.56836V4.73535C7.00195 4.71484 6.5166 4.66699 6.06543 4.58496ZM2.05273 7.58594C2.14844 6.42383 2.58594 5.35059 3.25586 4.46875C3.67285 4.77637 4.21289 5.04297 4.8418 5.24121C4.66406 5.95215 4.54785 6.74512 4.51367 7.58594H2.05273ZM11.4863 7.58594C11.4521 6.74512 11.3359 5.95215 11.1582 5.24121C11.7871 5.04297 12.3271 4.7832 12.7373 4.46875C13.4141 5.35059 13.8516 6.42383 13.9473 7.58594H11.4863ZM5.49121 7.58594C5.52539 6.84082 5.62793 6.12988 5.78516 5.4873C6.33203 5.59668 6.91309 5.66504 7.52148 5.69238V7.58594H5.49121ZM8.47852 7.58594V5.69238C9.08691 5.66504 9.66797 5.59668 10.2148 5.4873C10.3721 6.12988 10.4746 6.84082 10.5088 7.58594H8.47852ZM2.05273 8.54297H4.51367C4.54785 9.39746 4.66406 10.1973 4.8418 10.915C4.21973 11.1133 3.68652 11.373 3.27637 11.6807C2.59277 10.792 2.14844 9.71191 2.05273 8.54297ZM5.49121 8.54297H7.52148V10.4707C6.91992 10.498 6.33203 10.5664 5.79199 10.6689C5.62793 10.0195 5.51855 9.29492 5.49121 8.54297ZM8.47852 10.4707V8.54297H10.5088C10.4814 9.29492 10.3721 10.0195 10.208 10.6689C9.66797 10.5664 9.08691 10.498 8.47852 10.4707ZM11.1582 10.915C11.3428 10.1973 11.4521 9.39746 11.4863 8.54297H13.9473C13.8516 9.71191 13.4072 10.792 12.7236 11.6807C12.3135 11.373 11.7803 11.1133 11.1582 10.915ZM8.47852 11.4277C8.99121 11.4482 9.47656 11.4961 9.9209 11.5781C9.55176 12.5625 9.03906 13.2939 8.47852 13.5605V11.4277ZM6.0791 11.5781C6.52344 11.4961 7.00879 11.4482 7.52148 11.4277V13.5605C6.96094 13.2939 6.44824 12.5625 6.0791 11.5781ZM3.90527 12.3848C4.24023 12.1523 4.65039 11.9609 5.12207 11.8105C5.42969 12.6309 5.83301 13.3008 6.30469 13.7793C5.40234 13.5059 4.58203 13.0205 3.90527 12.3848ZM10.8779 11.8105C11.3496 11.9609 11.7598 12.1523 12.0947 12.3848C11.418 13.0205 10.5977 13.5059 9.69531 13.7793C10.167 13.3008 10.5703 12.6309 10.8779 11.8105Z"})})},670753:(e,t,i)=>{i.d(t,{F:()=>n});i(667294);var o=i(745238),s=i(785893);const n=(0,o.IU)("notificationRead",{viewBox:"0 0 16 16",svg:(0,s.jsx)("path",{d:"M4.44922 13.248C3.81641 13.248 3.33789 13.0859 3.01367 12.7617C2.68945 12.4414 2.52734 11.9688 2.52734 11.3438V4.21289C2.52734 3.58398 2.68945 3.10938 3.01367 2.78906C3.33789 2.46875 3.81641 2.30859 4.44922 2.30859H11.5449C12.1777 2.30859 12.6562 2.46875 12.9805 2.78906C13.3047 3.10938 13.4668 3.58398 13.4668 4.21289V11.3438C13.4668 11.9688 13.3047 12.4414 12.9805 12.7617C12.6562 13.0859 12.1777 13.248 11.5449 13.248H4.44922ZM4.51953 12.0938H11.4746C11.7441 12.0938 11.9512 12.0234 12.0957 11.8828C12.2402 11.7422 12.3125 11.5293 12.3125 11.2441V4.30664C12.3125 4.02539 12.2402 3.81445 12.0957 3.67383C11.9512 3.5332 11.7441 3.46289 11.4746 3.46289H4.51953C4.24609 3.46289 4.03711 3.5332 3.89258 3.67383C3.75195 3.81445 3.68164 4.02539 3.68164 4.30664V11.2441C3.68164 11.5293 3.75195 11.7422 3.89258 11.8828C4.03711 12.0234 4.24609 12.0938 4.51953 12.0938ZM7.37305 10.5527C7.26367 10.5527 7.16602 10.5293 7.08008 10.4824C6.99414 10.4316 6.91016 10.3574 6.82812 10.2598L5.44531 8.57227C5.34375 8.44336 5.29297 8.3125 5.29297 8.17969C5.29297 8.03516 5.3418 7.91211 5.43945 7.81055C5.54102 7.70508 5.66211 7.65234 5.80273 7.65234C5.89258 7.65234 5.97266 7.67188 6.04297 7.71094C6.11719 7.74609 6.18945 7.81055 6.25977 7.9043L7.34961 9.28711L9.66406 5.57812C9.78516 5.37891 9.9375 5.2793 10.1211 5.2793C10.2578 5.2793 10.3809 5.32422 10.4902 5.41406C10.5996 5.50391 10.6543 5.62109 10.6543 5.76562C10.6543 5.83203 10.6387 5.90039 10.6074 5.9707C10.5801 6.03711 10.5469 6.09961 10.5078 6.1582L7.88867 10.2539C7.76367 10.4531 7.5918 10.5527 7.37305 10.5527Z"})})},261248:(e,t,i)=>{i.d(t,{F:()=>n});i(667294);var o=i(745238),s=i(785893);const n=(0,o.IU)("notificationUnread",{viewBox:"0 0 20 20",svg:(0,s.jsx)("path",{d:"M3.622 12.683v-5.25c0-.62.05-1.172.15-1.655.105-.483.333-.9.684-1.25.351-.352.768-.58 1.251-.684a7.906 7.906 0 0 1 1.654-.157h4.69a2.893 2.893 0 0 0-.185 1.086 1.325 1.325 0 0 0-.007.13l.014.13H7.204c-.36 0-.697.032-1.012.096-.314.064-.567.189-.758.376a1.514 1.514 0 0 0-.376.759c-.06.31-.09.645-.09 1.005v5.605c0 .355.03.688.09.998.063.305.189.554.376.745.191.187.442.315.752.383.314.064.649.096 1.004.096h5.62c.35 0 .68-.032.99-.096.315-.064.566-.191.753-.383.191-.191.319-.44.382-.745.064-.31.096-.643.096-.998V8.191l.123.014c.046 0 .091-.002.137-.007.191.01.378-.002.56-.034.183-.036.356-.087.52-.15v4.669c0 .629-.052 1.184-.157 1.668-.1.483-.324.9-.67 1.25-.356.351-.777.58-1.265.684a7.944 7.944 0 0 1-1.66.157H7.374c-.624 0-1.18-.052-1.668-.157a2.478 2.478 0 0 1-1.25-.683 2.411 2.411 0 0 1-.685-1.251c-.1-.484-.15-1.04-.15-1.668Zm11.56-5.408a2.26 2.26 0 0 1-1.19-.32 2.455 2.455 0 0 1-.854-.862 2.27 2.27 0 0 1-.322-1.183c0-.433.107-.827.322-1.182.214-.36.499-.648.854-.862a2.26 2.26 0 0 1 1.19-.321c.423 0 .813.107 1.169.321.36.214.647.502.86.862.215.355.322.75.322 1.182 0 .429-.107.823-.321 1.183-.214.36-.501.647-.861.861a2.223 2.223 0 0 1-1.17.321Z"})})},750571:(e,t,i)=>{i.d(t,{S:()=>n});i(667294);var o=i(745238),s=i(785893);const n=(0,o.IU)("personBadgeQuestionMark",{viewBox:"0 0 15 14",svg:(0,s.jsx)("path",{d:"M12.4551 5.41699C12.8037 5.41699 13.0088 5.19824 13.0088 4.93164V4.84961C13.0088 4.45996 13.2344 4.2207 13.7061 3.90625C14.3691 3.46875 14.8408 3.07227 14.8408 2.25195C14.8408 1.11719 13.8291 0.501953 12.667 0.501953C11.498 0.501953 10.7256 1.0625 10.5342 1.69141C10.5 1.80078 10.4795 1.91016 10.4795 2.02637C10.4795 2.33398 10.7188 2.49805 10.9443 2.49805C11.1836 2.49805 11.3271 2.38867 11.4502 2.22461L11.5732 2.06055C11.8125 1.66406 12.1748 1.43164 12.626 1.43164C13.248 1.43164 13.6514 1.78711 13.6514 2.30664C13.6514 2.77148 13.3643 2.99707 12.7695 3.41406C12.2773 3.75586 11.915 4.11816 11.915 4.78809V4.87695C11.915 5.23242 12.1064 5.41699 12.4551 5.41699ZM5.79004 6.99609C7.25293 6.99609 8.52441 5.68359 8.52441 3.97461C8.52441 2.28613 7.25293 1.03516 5.79004 1.03516C4.32715 1.03516 3.05566 2.31348 3.05566 3.98828C3.05566 5.68359 4.32031 6.99609 5.79004 6.99609ZM12.4414 7.4541C12.8379 7.4541 13.1797 7.13965 13.1797 6.74316C13.1797 6.34668 12.8447 6.03223 12.4414 6.03223C12.0381 6.03223 11.7031 6.35352 11.7031 6.74316C11.7031 7.13281 12.0449 7.4541 12.4414 7.4541ZM1.20312 13.3262H10.3701C11.1016 13.3262 11.5391 12.9844 11.5391 12.417C11.5391 10.6533 9.33105 8.21973 5.7832 8.21973C2.24219 8.21973 0.0341797 10.6533 0.0341797 12.417C0.0341797 12.9844 0.47168 13.3262 1.20312 13.3262Z"})})},24433:(e,t,i)=>{i.d(t,{CR:()=>a,I2:()=>g,Lw:()=>d,tV:()=>m,tX:()=>u});var o=i(653965),s=i(401898),n=i(133728),r=i(125829);function a(e){let{space:t,domains:i,team:n,spaceUser:r,invitees:a,internalGuestFeatureAvailability:l,guestFeatureAvailability:u}=e;const m=d({domains:i,internalGuestFeatureAvailability:l,guestFeatureAvailability:u,invitees:a,space:t,spaceUser:r,team:n}),g=c({domains:i,internalGuestFeatureAvailability:l,guestFeatureAvailability:u,invitees:a,space:t,spaceUser:r,team:n}),h=a.some((e=>{const t=g[e.email],i=m[e.email];return"can_autojoin"!==t.type&&p(i)}));return(0,o.Pe)(a.map((e=>{const{email:t,currentRole:i}=e,o=g[t].type,n=m[t].type;return"member"===i?[t,{type:"member_page_add"}]:"guest"===i&&"can_add"===n?[t,{type:"guest_page_add"}]:"can_autojoin"===o?[t,{type:"member",reason:"autojoin_domain"}]:"cannot_add"===(r=m[t]).type&&"over_general_guest_limit"===r.reason?[t,{type:"none",reason:"must_upgrade"}]:"can_add"===o&&h?[t,{type:"member",reason:"over_internal_guest_limit"}]:"can_add"===n?[t,{type:"guest"}]:"can_request"===n?[t,{type:"guest_request"}]:"can_add"===o?[t,{type:"member",reason:"guests_disabled"}]:"can_request"===o?[t,{type:"member_request"}]:"cannot_add"===n||"cannot_add"===o?[t,{type:"none",reason:"other"}]:(0,s.t1)(o)&&(0,s.t1)(n);var r})))}function d(e){let{space:t,domains:i,team:s,internalGuestFeatureAvailability:n,guestFeatureAvailability:a,optimism:d="pessimistic",spaceUser:c,invitees:m}=e;const p=u({space:t,team:s,spaceUser:c}),h=l(d,a,g(m)),v=function(e,t){return e.filter((e=>(0,r.is)(e.email,t)&&!e.currentRole)).length}(m,i),f=l(d,n,v);return(0,o.Pe)(m.map((e=>{const t=(0,r.is)(e.email,i),o=void 0!==e.currentRole;let s;return s=o||h?!t||o||f?"cannot_add"===p.type?{type:"cannot_add",reason:"disabled_by_admins"}:p:{type:"cannot_add",reason:"over_internal_guest_limit"}:{type:"cannot_add",reason:"over_general_guest_limit"},[e.email,s]})))}function l(e,t,i){const o=t.limit,s="unlimited"===o.total?"unlimited":o.total-o.current;return"optimistic"===e?"unlimited"===s||s>=1:"unlimited"===s||s>=i}function c(e){let{space:t,team:i,domains:r,spaceUser:a,invitees:l,internalGuestFeatureAvailability:c,guestFeatureAvailability:u}=e;const g=m({space:t,domains:r,spaceUser:a}),h=d({space:t,domains:r,internalGuestFeatureAvailability:c,guestFeatureAvailability:u,team:i,spaceUser:a,invitees:l}),v=!a.isMember();return(0,o.Pe)(l.map((e=>{const t=(0,n.Gd)(e.email);if(!t)return[e.email,{type:"cannot_add",reason:"invalid_email"}];const i=p(h[e.email]),o=g.autojoinDomains;let r;return o.includes(t)?r={type:"can_autojoin"}:"can_add"===g.type?r={type:"can_add"}:"can_request"===g.type||i&&!v?r={type:"can_request"}:o.length>0?r={type:"cannot_add",reason:"not_authorized_domain"}:"cannot_add"===g.type?r={type:"cannot_add",reason:"disabled_by_admins"}:(0,s.t1)(g),[e.email,r]})))}function u(e){let{space:t,team:i,spaceUser:o}=e;const s=o.isWorkspaceOwner(),n=function(e){let t,i,{space:o,team:s}=e;t=s&&s.getDisableGuests()?"cannot_add":s&&!s.getDisableGuests()?"can_add":void 0;const n=o.disable_guests,r=o.getSettings().enable_guest_invite_requests;i=r?"can_request":n?"cannot_add":"can_add";return"can_request"===i?{type:"can_request"}:void 0!==t?{type:t}:{type:i}}({space:t,team:i});return s&&"can_request"===n.type?{type:"can_add"}:n}function m(e){let{space:t,domains:i,spaceUser:o}=e;const s=!o.isMember(),n=function(e){let{space:t,domains:i}=e;const o=i.filter((e=>e.isAutojoinable)).map((e=>e.url));return t.getSettings().disable_membership_requests?{type:"cannot_add",autojoinDomains:o}:{type:"can_request",autojoinDomains:o}}({space:t,domains:i});return s?{type:"cannot_add",autojoinDomains:[]}:o.isWorkspaceOwner()?{...n,type:"can_add"}:n}function g(e){return e.filter((e=>!e.currentRole)).length}function p(e){return"cannot_add"===e.type&&"over_internal_guest_limit"===e.reason}},125829:(e,t,i)=>{i.d(t,{TC:()=>r,dr:()=>s,is:()=>n});var o=i(133728);function s(e,t){return!!e&&n(e.getEmail(),t)}function n(e,t){return void 0!==r(e,t)}function r(e,t){if(!e)return;const i=(0,o.Gd)(e);return t.find((e=>e.url===i))}},490814:(e,t,i)=>{i.d(t,{$W:()=>d,Ay:()=>m,KQ:()=>r,Kz:()=>u,V5:()=>c,_e:()=>l,lJ:()=>a,t:()=>s});var o=i(401898),s=i(212847),n=i(909182);function r(e,t,i){return l(d(e,t,i))}function a(e,t,i){const o=i.state,s=i.scope.billingData,n={trialEnd:o.trialEnd,items:o.items};return d(e,t,{...i,scope:{...i.scope,billingData:{...s,subscription:n}}})}function d(e,t,i){const{name:s,scope:r,actor:a}=i,d={...i,billingData:r.billingData},l=r.premiumFeatureOverrides,c=s in l?function(e,t,i){const s={type:"contact_account_manager"},n=e[t.name].type;if("check"===n){const e={type:"none"};return!0===i?{type:"available",limit:e}:{type:"upsell",upsell:s,limit:e}}if("per_use"===n){const e=t.amount,o={type:"per_use",amount:i};return"unlimited"===i||i>e?{type:"available",limit:o}:{type:"upsell",upsell:s,limit:o}}if("cumulative"===n){const e=t.amount,o=t.data.current,n={type:"cumulative",current:o,total:i};return"unlimited"===i||i>=o+e?{type:"available",limit:n}:{type:"upsell",upsell:s,limit:n}}(0,o.t1)(n)}(e,i,l[s]):t[s](d);if("upsell"!==c.type)return c;const u=(0,n.Rd)(r.billingData.subscription),m=a.isSpaceAdmin,g=u?{type:"contact_account_manager"}:c.upsell,p=m?"upsell":"blocked";return{...c,type:p,upsell:g}}function l(e){return"available"===e.type}function c(e,t){const{available:i}=t;let s,n;return"unavailable"in t?(s=t.unavailable,n=t.unavailable):(s=t.blocked,n=t.upsell),"available"===e.type?i():"upsell"===e.type?n(e):"blocked"===e.type?s(e):(0,o.t1)(e)}function u(e,t){if(void 0!==e)return c(e,{available:()=>{},blocked:t,upsell:()=>{}})}function m(e){return s.object({required:e,optional:{}})}},883817:(e,t,i)=>{i.d(t,{$W:()=>l,II:()=>m,KQ:()=>d,V5:()=>s.V5,lJ:()=>c});var o=i(909182),s=i(490814),n=i(647425);const r={guests:{type:"cumulative",data:(0,s.Ay)({current:s.t.number()})},internal_guests:{type:"cumulative",data:(0,s.Ay)({current:s.t.number(),hasLowGuestLimit:s.t.boolean()})},non_admin_members:{type:"check",data:s.t.isUndefined()}},a={guests:e=>{let{amount:t,billingData:i,data:{current:o}}=e;return u({billingData:i,amount:t,current:o,limits:{free:10,personal:"unlimited",student:"unlimited",plus:"unlimited",business:"unlimited",enterprise:"unlimited"},upsellMap:{free:"plus"}})},internal_guests:e=>{let{amount:t,billingData:i,data:{current:o,hasLowGuestLimit:s}}=e;return u({billingData:i,amount:t,current:o,limits:(0,n.gp)({hasLowGuestLimit:s}),upsellMap:{free:"plus",student:"business",personal:"business",plus:"business"}})},non_admin_members:e=>{let{billingData:t}=e;return function(e){let{billingData:t,minimumTier:i}=e;const s=o.zt(t.subscription),r={type:"none"};return(0,n.$V)(s,i)?{type:"available",limit:r}:{type:"upsell",limit:r,upsell:{type:"product",product:i,limit:r}}}({billingData:t,minimumTier:"plus"})}};function d(e){return(0,s.KQ)(r,a,e)}function l(e){return(0,s.$W)(r,a,e)}function c(e){return(0,s.lJ)(r,a,e)}function u(e){let{billingData:t,amount:i,current:s,limits:n,upsellMap:r}=e;const a=o.zt(t.subscription),d=n[a],l={current:s,total:d,type:"cumulative"},c=r[a],u=c?n[c]:void 0;if(d&&("unlimited"===d||i+s<=d))return{type:"available",limit:l};if(c&&u){return{type:"upsell",limit:l,upsell:{type:"product",product:c,limit:{type:"cumulative",current:s,total:u}}}}return{type:"upsell",limit:l,upsell:{type:"contact_sales"}}}function m(e){return((null==e?void 0:e.items)??[]).filter((e=>"sites_custom_hostnames"===o.tw(e))).reduce(((e,t)=>e+t.quantity),0)}}}]);