"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[58799],{358188:(e,t,o)=>{o.d(t,{Lg:()=>g,N:()=>p,aG:()=>u});var i=o(213493),n=o(429369),r=o(210228),s=o(710274),a=(o(296994),o(396691)),l=o(830806),c=o(344496),d=o(80444);o(472711);function u(e){const{environment:t,currentSpaceViewStore:o,...i}=e;if(!o.getModel())return;const n=!(0,c.q)(o)[e.feature];r.createAndCommit({userAction:"userHomeActions.toggleHomeFeature",environment:t,perform:t=>{r.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","personal_home","enabled_features"],command:"update",args:{[e.feature]:n}},transaction:t})}}),(0,l.cY)({environment:t,show:n,...i})}function p(e){let{environment:t,option:o,from:i,userAction:n}=e;const s=d.default.state.currentSpaceViewStore;if(!s)return!1;const c=s.getOnAppStartStore().getValue();return r.createAndCommit({userAction:n,environment:t,perform:e=>{r.applyOperation({store:s,operation:{pointer:s.pointer,path:["settings","on_app_start"],command:"set",args:o},transaction:e})}}),(0,a.pJ)({spaceView:s.getModel(),preference:o}),(0,l.BX)({environment:t,oldValue:c,newValue:o,from:i}),!0}function g(e){const{environment:t,selectedStore:o,currentSpaceViewStore:a,collectionContextStore:c}=e,d=c.collectionViewStore(),u=c.collectionStore(),p=c.collectionViewBlockStore();if(!(u&&d&&p&&a))return;const g=a.getTeamsStores(),m=o.table===n.e0?g.indexOf(o)+1:0,f=o.table===n.e0?o.id:void 0;r.createAndCommit({environment:t,userAction:"PersonalHomeTrendingPanel.setCollectionViewSourceTeamId",perform:e=>{r.applyOperation({store:d,operation:{pointer:{id:d.id,table:i.np},path:["format","collection_view_source","teamId"],command:"set",args:f},transaction:e}),s.mc({environment:t,collectionViewBlockStore:p,collectionViewStore:d,collectionStore:u,collectionContextStore:c,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1,collectionViewModuleContextType:void 0})}}),(0,l.Ay)({environment:t,teamId:f,index:m})}},268305:(e,t,o)=>{o.d(t,{tA:()=>v});o(21703);var i=o(143690),n=o(842875),r=o(600606),s=o(421202),a=o(940470),l=o(401898),c=o(628020),d=o(433929),u=o(319385),p=o(437598),g=o(206258),m=o(454642);const f=1e3;class S extends Error{constructor(e,t){super(t),this.type=e}}class y extends S{constructor(){super("query_collection_limit_outside_range",`Query collection limit must be between 0 and ${f}`)}}class h extends S{constructor(e){super("query_collection_failed",`Query collection failed: ${e.reason}`),this.data=e}}class x extends S{constructor(){super("query_collection_too_many_items","Query collection updating too many items")}}async function v(e,t){const{source:o,parentRecordStore:S,collectionPointer:v,filter:C,sort:b,limit:j,vectorSearch:w}=t,M=j??f;if(M<0||M>f)return{error:new y};const _=g.NW.createChildStore(S,v);await _.load();const k=_.getModel();if(!k)return{error:new h({reason:"no collection value"})};const V=_.getParentBlockStore();if(!V)return{error:new h({reason:"no collection parent"})};await V.load();const T=V.getCollectionViewStores()[0],P=T.getSpaceId();if(!T||!P)return{error:new h({reason:"no first collection view"})};const I="results",F={[I]:{type:"results",limit:M}},Z=Object.keys(t.aggregations??{});for(const i of Z){var A;if(i===I)return{error:new h({reason:`${I} is a reserved reducer keyword.`})};const e=null===(A=t.aggregations)||void 0===A?void 0:A[i];if(!e)return{error:new h({reason:`no aggregation provided for ${i}.`})};e&&(F[i]={type:"aggregation",aggregation:e})}const B=_.getSchema(),K={filter:C&&i.Ih(C,B),sort:b&&i.zh(b,B),userId:e.currentUser.id,userTimeZone:(0,n.r)(),searchQuery:void 0,vectorSearch:w,reducers:F},O=await m.queryCollection(e,{source:{type:"collection",id:v.id,spaceId:v.spaceId},collectionView:{id:T.id,spaceId:P},loader:K},void 0,{src:o});if("failed"===O.type)return{error:new h({reason:"server query failed",cause:O.error})};const L=O.data.result.reducerResults[I];if(!L||"results"!==L.type)return{error:new h({reason:"unexpected server result"})};if(L.blockIds.length===f&&L.hasMore)return{error:new x};const{groupsReducerIds:R,reducerIdsWithNoGroupDependencies:D}=i.x3(K.reducers,K.reducerDependencies),z=u.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),N=Date.now(),E={pageSort:[],schema:B,loader:K,userId:e.currentUser.id,userStartOfWeek:c.AK.state,currentTime:N,getRecordModel:S.getRecordModel,intl:d.default.getIntl(),isSorted:!1,visibleProperties:void 0,relativeVariableResult:null==O?void 0:O.data.relativeVariableResult,currentPageInRelatedCollection:void 0,isSprintPlanningView:!1,collectionSourceType:"collection",groupsReducerIds:R,reducerIdsWithNoGroupDependencies:D,formulaTimeoutMs:z,resultCache:new Map},H=i.fk(E);for(const n of L.blockIds){var U;const e=g.G.createChildStore(S,{table:s.iU,id:n}),t=null===(U=e.getAssociatedCollectionStore())||void 0===U?void 0:U.pointer;if(!(t&&r.dr.isEqualIdTable(t,_.pointer)))continue;const o=S.getRecordModel(e);o&&i.BW(o,k,E,H)}const W=p.Z.getEditedBlocksForCollection(k.id),G=new Set(L.blockIds);for(const n of W){if(G.has(n))continue;const e=S.getRecordModel({table:s.iU,id:n});e&&i.BW(e,k,E,H)}const{result:$}=i.kk(E,H),q=i.aW({result:$}),Q={};for(const n of Z){var X;const e=i.Oi({expectedAggregator:null===(X=t.aggregations)||void 0===X||null===(X=X[n])||void 0===X?void 0:X.aggregator,aggregationReducerResult:O.data.result.reducerResults[n]});if(a.x.isFail(e)){const t="no aggregation provided"===e.error?`no aggregation provided for ${n}`:"unexpected response returned for aggregation"===e.error?`unexpected response returned for aggregation ${n}`:(0,l.t1)(e.error);return{error:new h({reason:t})}}Q[n]=e.value}return{value:{blockIds:q,...Q}}}},272467:(e,t,o)=>{o.d(t,{B4:()=>f,OO:()=>u,ad:()=>S,dr:()=>m,my:()=>g,rc:()=>p});var i=o(494714),n=o(351259),r=o(841892),s=o(253877),a=o(842875),l=o(709291),c=o(433929);const d=(0,l.defineMessages)({aiSummaryName:{id:"feature.ai_summary.name",defaultMessage:"AI summary"},aiSummaryDescription:{id:"feature.ai_summary.description",defaultMessage:"Summarize pages with AI"},aiAutofillName:{id:"feature.ai_autofill.name",defaultMessage:"Custom AI autofill"},aiAutofillDescription:{id:"feature.ai_autofill.description",defaultMessage:"Autofill properties with AI"},aiTranslationName:{id:"feature.ai_translation.name",defaultMessage:"AI translation"},aiTranslationDescription:{id:"feature.ai_translation.description",defaultMessage:"Translate pages with AI"},aiKeywordsName:{id:"feature.ai_keywords.name",defaultMessage:"AI keywords"},aiKeywordsDescription:{id:"feature.ai_keywords.description",defaultMessage:"Extract keywords with AI"}}),u=[{uri:n.S7.priorityHmlFeature,name:"Priority",dependencies:[{uri:n.ti.priorityHmlProperty,type:"property",collectionUri:i.br,name:"Priority",description:"High, medium, or low",icon:r.Z.images.appPackages.featurePrioritySvg,propertySchema:{type:"select",name:"Priority",options:[{id:"priority_low",value:"Low",color:"green"},{id:"priority_medium",value:"Medium",color:"yellow"},{id:"priority_high",value:"High",color:"red"}]}}],collectionUri:i.br},{uri:n.S7.progressBarFeature,collectionUri:i.br,name:"Progress Bar",description:"Visual representation of progress",icon:r.Z.images.appPackages.featureStatusSvg,dependencies:[{uri:n.ti.progressBarCurrentProperty,type:"property",collectionUri:i.br,name:"Progress Bar Current",propertySchema:{type:"number",name:"Current"}},{uri:n.ti.progressBarTargetProperty,type:"property",collectionUri:i.br,name:"Progress Bar Target",propertySchema:{type:"number",name:"Target"}},{uri:n.ti.progressBarFormulaProperty,type:"property",collectionUri:i.br,name:"Progress Bar Progress Formula",propertySchema:{type:"formula",name:"Progress bar",formula2:{code:[["‣",[["fpp",{property:n.ti.progressBarCurrentProperty,collection:{id:i.br,table:"collection"}}]]],["/"],["‣",[["fpp",{property:n.ti.progressBarTargetProperty,collection:{id:i.br,table:"collection"}}]]]],result_type:{type:"number"}},show_as:{type:"bar",color:"green",maxValue:1,showValue:!1},version:"v2"}}]},{uri:n.S7.ganttChartFeature,collectionUri:i.br,name:"Gantt Chat",description:"Chart to show progress of a project's tasks over time.",icon:r.Z.images.appPackages.featureGanttSvg,dependencies:[{uri:n.ti.ganttInitiativeProperty,type:"property",collectionUri:i.br,name:"Initiative",description:"Initiatives associated with a specific project",icon:r.Z.images.appPackages.featurePrioritySvg,propertySchema:{type:"select",name:"Initiative",options:[{id:"initiative_a",value:"Initiative A",color:"purple"},{id:"initiative_b",value:"Initiative B",color:"green"},{id:"initiative_c",value:"Initiative C",color:"blue"}]}},{uri:n.ti.ganttDueDateProperty,type:"property",collectionUri:i.br,name:"Due Date",description:"When a project is due.",icon:r.Z.images.appPackages.featurePrioritySvg,propertySchema:{type:"date",name:"Due Date"}},{uri:n.ti.ganttTimelineView,type:"collection_view",collectionUri:i.br,description:"GANTT chart timeline view of projects",value:{type:"timeline",name:"Timeline",format:{collection_view_icon:"/icons/timeline_gray.svg",timeline_show_table:!0,timeline_table_properties:[{width:171,visible:!0,property:"title"},{width:200,visible:!0,property:n.ti.ganttInitiativeProperty}],timeline_preference:{zoomLevel:"month",centerTimestamp:(0,s.uO)((0,s.Lg)((0,a.r)()),(0,a.r)())},collection_group_by:{sort:{type:"manual"},type:"multi_select",property:n.ti.ganttInitiativeProperty,hideEmptyGroups:!0}},query2:{timeline_by:n.ti.ganttDueDateProperty}},collectionViewBlockUri:i.Sc}]}],p=[g(),m(),f(),S()];function g(){return{uri:n.S7.aiSummaryFeature,collectionUri:i.br,name:c.default.formatMessage(d.aiSummaryName),description:c.default.formatMessage(d.aiSummaryDescription),icon:r.Z.images.appPackages.featureAiSummarizeSvg,tooltipImage:{img:r.Z.images.tooltips.properties.aiAutofillSummaryPng,scale:.5},isAi:!0,dependencies:[{uri:n.ti.aiSummaryProperty,type:"property",collectionUri:i.br,name:c.default.formatMessage(d.aiSummaryName),propertySchema:{type:"text",name:c.default.formatMessage(d.aiSummaryName),ai_inference:{type:"summarize",auto_update_on_edit:!0}}}]}}function m(){return{uri:n.S7.aiCustomAutofillFeature,collectionUri:i.br,name:c.default.formatMessage(d.aiAutofillName),description:c.default.formatMessage(d.aiAutofillDescription),icon:r.Z.images.appPackages.featureAiSummarizeSvg,tooltipImage:{img:r.Z.images.tooltips.properties.aiCustomAutofillPng,scale:.5},isAi:!0,dependencies:[{uri:n.ti.aiCustomAutofillProperty,type:"property",collectionUri:i.br,name:c.default.formatMessage(d.aiAutofillName),propertySchema:{name:c.default.formatMessage(d.aiAutofillName),type:"text",ai_inference:{type:"custom",prompt:"",auto_update_on_edit:!0}}}]}}function f(){return{uri:n.S7.aiTranslationFeature,collectionUri:i.br,name:c.default.formatMessage(d.aiTranslationName),description:c.default.formatMessage(d.aiTranslationDescription),icon:r.Z.images.appPackages.featureAiSummarizeSvg,tooltipImage:{img:r.Z.images.tooltips.properties.aiTranslationPng,scale:.5},isAi:!0,dependencies:[{uri:n.ti.aiTranslationProperty,type:"property",collectionUri:i.br,name:c.default.formatMessage(d.aiTranslationName),propertySchema:{name:c.default.formatMessage(d.aiTranslationName),type:"text",ai_inference:{type:"custom",prompt:"",auto_update_on_edit:!0}}}]}}function S(){return{uri:n.S7.aiKeywordsFeature,collectionUri:i.br,name:c.default.formatMessage(d.aiKeywordsName),description:c.default.formatMessage(d.aiKeywordsDescription),icon:r.Z.images.appPackages.featureAiSummarizeSvg,isAi:!0,dependencies:[{uri:n.ti.aiKeywordsProperty,type:"property",collectionUri:i.br,name:c.default.formatMessage(d.aiKeywordsName),propertySchema:{type:"multi_select",name:c.default.formatMessage(d.aiKeywordsName),select_ai_inference:{type:"multi_select",add_options:!0,auto_update_on_edit:!1}}}]}}},409015:(e,t,o)=>{o.d(t,{Z:()=>s});var i=o(667294),n=o(74404);const r=(0,i.createContext)({automationContextStore:void 0,automationStore:void 0,collectionStore:void 0,currentDraggingActionId:void 0,disabled:!0,maybePersistedTransactionActions:{createAndCommit:n.U},editorPlacement:{type:"inline"},editorWidth:300,suppressActionErrors:[]});r.displayName="AutomationEditorContext";const s=r},595193:(e,t,o)=>{o.d(t,{F:()=>a,U:()=>s});var i=o(800480),n=o(886628),r=o(460709);function s(e){return e.device.isPhone||"actionSheet"===e.tabletBehavior&&e.device.isTablet?{menuType:r.og.ActionSheet}:{menuType:r.og.Popup,maxHeight:e.maxHeight,maxWidth:e.maxWidth,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,width:e.width,minWidth:e.minWidth}}function a(e){const t=(0,i.Fy)();return(0,n.VK)((()=>s({device:t,maxHeight:null==e?void 0:e.maxHeight,maxWidth:null==e?void 0:e.maxWidth,paddingTop:null==e?void 0:e.paddingTop,paddingBottom:null==e?void 0:e.paddingBottom,width:null==e?void 0:e.width,minWidth:null==e?void 0:e.minWidth,tabletBehavior:null==e?void 0:e.tabletBehavior})),[t,null==e?void 0:e.maxHeight,null==e?void 0:e.maxWidth,null==e?void 0:e.paddingTop,null==e?void 0:e.paddingBottom,null==e?void 0:e.width,null==e?void 0:e.minWidth,null==e?void 0:e.tabletBehavior])}},74404:(e,t,o)=>{o.d(t,{U:()=>h,$:()=>x});o(21703);var i=o(667294),n=o(800480),r=o(886628),s=o(798963),a=o(401898),l=o(210228),c=o(718844),d=o(653965),u=o(206258);function p(e,t){var o,i;const n=null==e?void 0:e.getModel(),r=null==t?void 0:t.getModel();if(!t||!r)return!0;return!(!n||(null===(o=n.getProperties())||void 0===o?void 0:o.name)===(null===(i=r.getProperties())||void 0===i?void 0:i.name))||(!!function(e,t){const o=null==e?void 0:e.getModel(),i=t.getModel();if(!i)return!0;if((0,a.$K)(o)){if(o.isEventType()&&i.isEventType()||o.isNotificationType()&&i.isNotificationType()){const e=o.getEventConfiguration(),t=i.getEventConfiguration();return!(0,d.Xy)(e,t)}if(o.isRecurrenceType()&&i.isRecurrenceType()){const e=o.getRecurrence(),t=i.getRecurrence();return!(0,d.Xy)(e,t)}return!o.isButtonType()||!i.isButtonType()}if(i.isEventType()||i.isNotificationType()){const e=i.getEventConfiguration();return!1!==e.pagesAdded||"none"!==e.pagePropertiesEdited.type}if(i.isRecurrenceType())return!0;if(i.isButtonType())return!1;if(i.isAssistantType())return!1;(0,a.t1)(i)}(e,t)||!!function(e,t){const o=t.getSpaceId();if(!o)return!1;if((0,a.$K)(e)){const i=e.getActionIds(),n=t.getActionIds();return i.length!==n.length||!(0,d.Xy)(i,n)||i.some((i=>{const n={id:i,spaceId:o,table:c.Xj},r=u.zq.createChildStore(e,n).getModel(),s=u.zq.createChildStore(t,n).getModel();return!(0,a.$K)(r)||!(0,a.$K)(s)||!(0,d.Xy)(r.getConfig(),s.getConfig())}))}return t.getActionIds().length>0}(e,t))}var g=o(628020),m=o(503932),f=o(484398),S=o(582787),y=o(80444);function h(e){const t=new m.Y({deadlockTimeoutMs:l.DEADLOCK_WARNING_TIMEOUT_MS});return{performResult:e.perform(t),serverCommitResult:Promise.resolve()}}function x(e){const{automationId:t,spaceId:o,defaultValue:c,persist:d}=e,m=(0,n.O7)(),h=(0,r.VK)((()=>{var e;return null===(e=y.default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]),x=(0,i.useMemo)((()=>{if(t&&o&&h)return{id:t,table:s.cv,spaceId:o}}),[t,o,h]),v=(0,f.$)("useUnpersistedAutomationStore",{cacheFallback:m.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0}),C=(0,i.useMemo)((()=>{if(!x)return;const e=v.getEntry({pointer:x,userId:h});if(!(0,a.$K)(e)&&h){if(!c)throw new Error("create is true but no defaultValue provided");v.setRecord({pointer:x,userId:h},{role:"editor",value:c})}return new u.Mz(m,x,{inMemoryRecordCache:v})}),[c,m,x,v,h]),b=(0,r.VK)((()=>{const e=g.np();if(x&&e)return u.Mz.createChildStore(e,x)}),[x]),j=d?b:C,w=(0,r.VK)((()=>!d&&p(b,C)),[d,b,C]),{createAndCommit:M}=(0,S.Z)({unpersistedInMemoryRecordCache:v}),_=(0,i.useCallback)((e=>d?l.createAndCommit({...e,environment:m}):M(e)),[M,m,d]);return{maybePersistedTransactionActions:{createAndCommit:_},maybePersistedAutomationStore:j,hasUnpersistedChanges:w}}},39779:(e,t,o)=>{o.d(t,{E:()=>n,Y:()=>r});o(21703);var i=o(667294);const n=(0,i.createContext)(null);function r(){const e=(0,i.useContext)(n);if(!e)throw new Error("useFormLayoutEditorContext must be used inside FormLayoutEditorContext.Provider");return(0,i.useMemo)((()=>e),[e])}n.displayName="FormLayoutEditorContext"},42550:(e,t,o)=>{o.d(t,{O:()=>P});var i=o(667294),n=o(724405),r=o(222491),s=o(653965),a=o(401898),l=o(504430),c=o(343350);o(21703);class d{constructor(){this.stiffness=50,this.damping=10,this.precision=.001,this.currentValue=0,this.endValue=0,this.velocity=0}isAtRest(){return Math.abs(this.endValue-this.currentValue)<=this.precision}setEndValue(e){this.endValue=e;const t=this.isAtRest();return t&&this.setAtRest(),t}jumpToEnd(){this.currentValue=this.endValue}step(e){let t=e;do{let e;t>d.timestep?(t-=d.timestep,e=d.timestep):(e=t,t=0);const[o,i]=this.rk4(this.currentValue,this.velocity,e);this.velocity=i,this.currentValue=o}while(t>0);const o=this.isAtRest();return o&&this.setAtRest(),o}setAtRest(){this.currentValue=this.endValue,this.velocity=0}rk4(e,t,o){const i=e,n=t,r=this.computeAccel(i,n,0),s=e+.5*n*o,a=t+.5*r*o,l=this.computeAccel(s,a,o/2),c=e+.5*a*o,d=t+.5*l*o,u=this.computeAccel(c,d,o/2),p=e+d*o,g=t+u*o;return[e+o/6*(n+2*a+2*d+g),t+o/6*(r+2*l+2*u+this.computeAccel(p,g,o))]}computeAccel(e,t,o){return this.stiffness*d.stiffnessMultiplier*(this.endValue-e)-this.damping*d.dampingMultiplier*t}}d.stiffnessMultiplier=1e-5,d.dampingMultiplier=.005,d.timestep=1e3/60;const u=d;function*p(e,t){const o=new u;for(o.currentValue=e,o.endValue=t,o.stiffness=35;;){const e=yield o.currentValue;if(o.step(e)){yield o.currentValue;break}}}function*g(e,t,o){let i=0;for(;i<o;){i+=(yield e+i/o*(t-e))}}function*m(e){for(const[t,o]of s.$R(e,e.slice(1)))(0,a.$K)(t)&&(0,a.$K)(o)&&(yield*p(t,o))}function*f(e,t){let o=0;for(;!(0,a.$K)(t)||o<t;){o+=(yield e)}}function*S(e){let t=0;for(;;){const o={};for(const i of(0,a.Yd)(e)){const n=e[i].next(t);if(n.done)return;o[i]=n.value}t=yield o}}var y=o(628267),h=o(785893);const x="inactive-task-filter",v="active-task-filter",C="mouse-cursor-filter",b=80,j=24,w=8,M=10,_=264,k=110,V=b/2;function*T(e){yield*S({x:e,opacity:f(1)})}function P(e){const{mode:t}=e,o=(0,n.yK)((e=>({wrap:{margin:"0px 10px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:"center",position:"relative",height:k+2}})),[1]),r=(0,i.useRef)(null),s=(0,y.X)(r),a=s?s.width-2:_;return(0,h.jsx)("div",{style:o.wrap,ref:r,children:(0,h.jsx)(I,{mode:t,sceneWidth:a})})}function I(e){const{mode:t,sceneWidth:o}=e,d=(0,n.yK)((e=>({svgArrowTheme:{stroke:e.collectionValidDependencyArrow,strokeWidth:l.lf},invalidArrow:{stroke:e.collectionInvalidDependencyArrow},svgContainer:{position:"absolute",width:"100%",height:"100%",backgroundColor:e.accentColors.gray[30]}})),[]),u=(0,i.useMemo)((()=>({none:function*(){for(;;)yield*T(m([o/2,o/2+b/2+b/4,o/2-b/2-b/4,o/2]))},preserve_gap:function*(){for(;;)yield*T(m([o/2,o/2+b/2,o/2-b/2,o/2]))},consume_gap:function*(){for(;;){yield*T(m([o/2,o/2-b/2,o/2+b/2,o/2+b]));const e=500;yield*S({x:f(o/2+b),opacity:g(1,0,e)}),yield*S({x:f(o/2),opacity:g(0,1,e)})}}})),[o]),{x:p,opacity:y}=function(e){const t=(0,i.useMemo)((()=>e()),[e]),[o,n]=(0,i.useState)((()=>{const e=t.next(0);if(e.done)throw new Error("Generator must provide at least one result");return e.value}));return(0,i.useEffect)((()=>{const e=t.next(0);e.done||n(e.value);let o=Date.now(),i=0;return i=requestAnimationFrame((function e(){i=requestAnimationFrame(e);const r=Date.now(),s=r-o;o=r;const a=t.next(s);a.done||n(a.value)})),()=>cancelAnimationFrame(i)}),[t]),o}(u[t??"none"]),x={x:o/2-2*b,y:M},v={x:p-b/2,y:M+j+w},C={x:o/2+b,y:M+2*(j+w)},_={x:v.x+b/2,y:v.y+j/2};return(0,a.$K)(t)&&("consume_gap"===t?(x.x=Math.min(x.x,v.x-b),C.x=Math.max(C.x,v.x+b)):"preserve_gap"===t?(x.x=x.x+p-o/2,C.x=C.x+p-o/2):(0,a.t1)(t)),(0,h.jsxs)("svg",{style:d.svgContainer,children:[s.w6(o/2-2*b,o,V).map(((e,t)=>(0,h.jsx)(Z,{startPoint:{x:e,y:0},endPoint:{x:e,y:k}},t))),(0,h.jsx)(c.Z,{startPoint:{x:v.x+b,y:v.y+j/2},endPoint:{x:C.x-2,y:C.y+j/2},...(0,r.iv)(d.svgArrowTheme,v.x+b>C.x?d.invalidArrow:void 0,{opacity:y}),showArrowHead:!0}),(0,h.jsx)(c.Z,{startPoint:{x:x.x+b,y:x.y+j/2},endPoint:{x:v.x-2,y:v.y+j/2},...(0,r.iv)(d.svgArrowTheme,v.x<x.x+b?d.invalidArrow:void 0,{opacity:y}),showArrowHead:!0}),(0,h.jsx)(F,{point:x,opacity:y}),(0,h.jsx)(F,{point:v,active:!0,opacity:y}),(0,h.jsx)(F,{point:C,opacity:y}),(0,h.jsx)(A,{point:_,opacity:y}),(0,h.jsx)(B,{})]})}function F(e){const{point:t,active:o,opacity:i}=e,r=(0,n.Fg)(),s=o?"dark"===r.mode?"#28456C":"#E7F3F8":r.buttonBackground;return(0,h.jsx)("g",{transform:`translate(${t.x-4},${t.y-2})`,opacity:i,children:(0,h.jsx)("rect",{filter:`url(#${o?v:x})`,width:b,height:j,x:"4",y:"2",fill:s,rx:"3"})})}function Z(e){const{startPoint:t,endPoint:o}=e,i=(0,n.Fg)(),r="dark"===i.mode?i.accentColors.gray[300]:"#E3E2E0";return(0,h.jsx)("line",{x1:t.x,y1:t.y,x2:o.x,y2:o.y,stroke:r,strokeDasharray:"3 4"})}function A(e){const{point:t,opacity:o}=e;return(0,h.jsxs)("g",{filter:`url(#${C})`,transform:`translate(${t.x},${t.y})`,opacity:o,children:[(0,h.jsx)("path",{fill:"#32302C",d:"M14 12.25h-3.334l2.193 5.294-2.309.956-2.194-5.294L6 15.563l-.75-.75V3.94l1.06-.44L14 11.19v1.06z"}),(0,h.jsx)("path",{stroke:"#fff",fill:"#32302C",strokeWidth:"0.5",d:"M14 12.5h.25v-1.413l-.073-.073-7.69-7.69-.12-.12-.154.065-1.059.44L5 3.775v11.142l.073.073.75.75.177.177.177-.177 2.092-2.091 2.05 4.948.096.23.23-.095 2.31-.956.231-.096-.096-.231-2.05-4.948H14z"})]})}function B(){return(0,h.jsxs)("defs",{children:[(0,h.jsxs)("filter",{id:x,width:b+8,height:j+8,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,h.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_637_7659"}),(0,h.jsx)("feOffset",{}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,h.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_7659"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feOffset",{dy:"2"}),(0,h.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,h.jsx)("feBlend",{in2:"effect1_dropShadow_637_7659",result:"effect2_dropShadow_637_7659"}),(0,h.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_7659",result:"shape"})]}),(0,h.jsxs)("filter",{id:v,width:b+8,height:j+8,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,h.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_637_5084"}),(0,h.jsx)("feOffset",{}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.2 0 0 0 0 0.494118 0 0 0 0 0.662745 0 0 0 0.2 0"}),(0,h.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_5084"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feOffset",{dy:"2"}),(0,h.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,h.jsx)("feBlend",{in2:"effect1_dropShadow_637_5084",result:"effect2_dropShadow_637_5084"}),(0,h.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_5084",result:"shape"})]}),(0,h.jsxs)("filter",{id:C,width:"17.75",height:"24.244",x:"0.75",y:"0.91",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,h.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feOffset",{dy:"2"}),(0,h.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.2 0"}),(0,h.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_4925"}),(0,h.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_637_4925",result:"shape"})]})]})}},507443:(e,t,o)=>{o.d(t,{$z:()=>A,Fz:()=>O,PC:()=>L,Tg:()=>E,Yi:()=>Z,kJ:()=>K,pK:()=>N,zk:()=>F});var i=o(667294),n=o(800480),r=o(886628),s=o(724405),a=o(399036),l=o(252936),c=o(418442),d=o(937612),u=o(709291),p=o(215828),g=o(401898),m=o(137810),f=o(108406),S=o(316956),y=o(805149),h=o(547307),x=o(709953),v=o(210228),C=o(504430),b=o(710274),j=o(164921),w=o(158297),M=o(672495),_=o(886825),k=o(981166),V=o(694166),T=o(42550),P=o(295314),I=o(785893);const F="consume_gap",Z=!0;function A(e){var t;const{currentConfig:o,onConfigChange:a,disabled:l,collectionContextStore:c}=e,d=(0,r.VK)((()=>c.databaseType),[c]),p=(0,n.O7)(),m=null===(t=o.configWithoutDates)||void 0===t?void 0:t.mode,[S,y]=(0,i.useState)((0,g.$K)(o.configWithoutDates)?Boolean(o.configWithoutDates.avoid_weekends):Z),h=(0,g.$K)(o.configWithoutDates)?Boolean(o.configWithoutDates.avoid_weekends):S;(0,i.useEffect)((()=>{if((0,g.$K)(o.configWithoutDates)){const e=Boolean(o.configWithoutDates.avoid_weekends);e!==S&&y(e)}}),[o,S]);const x=(0,s.yK)((()=>({dateShiftContainer:{marginLeft:4},previewContainer:{marginLeft:4},previewTitle:{paddingLeft:10}})),[]),v=(0,i.useCallback)((e=>{(0,g.$K)(o.configWithoutDates)&&(a({...o,configWithoutDates:{...o.configWithoutDates,avoid_weekends:e}}),f.wd({environment:p,collectionContextStore:c,action:"update_dependency_date_shift_avoid_weekends",new_avoid_weekends:e}))}),[c,o,p,a]),C=(0,i.useCallback)((e=>{(0,g.$K)(e)?a({...o,configWithoutDates:{...o.configWithoutDates,mode:e,avoid_weekends:S}}):a({...o,configWithoutDates:void 0}),f.wd({environment:p,collectionContextStore:c,action:"update_dependency_date_shift_mode",new_date_shift_mode:e??"none"})}),[c,o,p,S,a]);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(M.Z,{title:(0,I.jsx)(u.FormattedMessage,{...k.dH.dateShiftingSectionCaption}),disableMobileBorders:!0,style:x.previewContainer,desktopTitleStyle:x.previewTitle,children:(0,I.jsx)(T.O,{mode:m})}),(0,I.jsx)(M.Z,{disableMobileBorders:!0,style:x.dateShiftContainer,children:(0,I.jsx)(D,{currentMode:m,onModeChange:C,databaseType:d,disabled:l})}),(0,I.jsxs)(M.Z,{children:[(0,I.jsx)(R,{currentValue:h,databaseType:d,onChange:v,disabled:l||!(0,g.$K)(o.configWithoutDates)}),(0,I.jsx)(B,{...e})]})]})}function B(e){const{collectionContextStore:t,currentConfig:o,onConfigChange:n,disabled:s}=e,l=(0,r.VK)((()=>{const e=t.normalizedSchemaStore.state;return Object.keys(e).filter((t=>{const o=e[t];return o&&(0,a.Lt)(o)}))}),[t]),c=l.length,d=o.datePropertyId?l.find((e=>e!==o.datePropertyId)):void 0,p="string"==typeof o.datePropertyId&&(0,g.$K)(o.endDatePropertyId),m=(0,i.useCallback)(((e,t)=>{const i={[e]:t};if(p&&(0,g.$K)(o.datePropertyId)){const n="datePropertyId"===e?"endDatePropertyId":"datePropertyId";o[n]===t&&(i[n]=l.find((e=>e!==t)))}n({...o,...i})}),[o,l,n,p]);return!(0,g.$K)(o.configWithoutDates)||c<=1?null:(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(P.A,{collectionContextStore:t,currentPropertyId:o.datePropertyId,title:p?(0,I.jsx)(u.FormattedMessage,{...k.dH.startDate}):(0,I.jsx)(u.FormattedMessage,{...k.dH.datePropertyPickerTitle}),onPropertyChanged:e=>m("datePropertyId",e),disabled:s}),(0,g.$K)(d)&&"string"==typeof o.datePropertyId&&(0,I.jsxs)(I.Fragment,{children:[(0,g.$K)(o.endDatePropertyId)&&(0,I.jsx)(P.A,{collectionContextStore:t,currentPropertyId:o.endDatePropertyId,title:(0,I.jsx)(u.FormattedMessage,{...k.dH.endDate}),onPropertyChanged:e=>m("endDatePropertyId",e),disabled:s}),(0,I.jsx)(_.Z,{title:(0,I.jsx)(u.FormattedMessage,{id:"database.viewSettings.relationFeatures.datePropertyPicker.separateStartEnd",defaultMessage:"Separate start and end dates"}),focused:!1,on:p,disabled:s,disabledFeedback:!0,onClick:()=>{n({...o,endDatePropertyId:p?void 0:d})}})]})]})}function K(e){const{collectionSettingsStore:t,feature:o,permissionScopes:i}=e,n=!i.canConfigureCollection&&!i.canConfigureBlock;return(0,I.jsx)(V.Z,{icon:c.H,showChevron:!0,disabled:n,title:(0,I.jsx)(u.FormattedMessage,{...k.dH.advancedSettings}),onClick:()=>{y.H4({collectionSettingsStore:t,item:{type:"relationFeaturesAdvancedSettings",feature:o}})}})}function O(e){const{feature:t,handleAddRelation:o,databaseType:i,permissionScopes:n}=e,r=(0,s.yK)((e=>({button:{width:"100%"},buttonWrap:{margin:"0px 12px 4px 12px"}})),[]);if(!n.canConfigureBlock||!n.canConfigureCollection)return null;const a=(0,k.Tq)({feature:t,databaseType:i});return(0,I.jsx)(M.Z,{disableMobileBorders:!0,children:(0,I.jsx)("div",{style:r.buttonWrap,children:(0,I.jsx)(w.Z,{style:r.button,onClick:o,isLarge:!0,children:(0,I.jsx)(u.FormattedMessage,{...a})})})})}function L(e){const{feature:t,permissionScopes:o,propertyName:i,relationPropertyId:a,inversePropertyName:l,collectionContextStore:c,collectionSettingsStore:p,handleDefaultPropertySelect:g,databaseType:x,clearCollectionViewSubitemDisplayMode:b}=e,j=(0,n.O7)(),w=(0,s.yK)((e=>({modalTitle:{fontWeight:m.Z.fontWeight.semibold,fontSize:18},modalInnerStyle:{textAlign:"center"},modalPropertyName:{color:e.darkTextColor,fontWeight:m.Z.fontWeight.semibold}})),[]),M=(0,r.VK)((()=>c.currentSubitemFormatStoreForCollectionStore.state),[c]),_=(0,r.VK)((()=>(0,C._e)(c)),[c]);if(!(o.canConfigureCollection&&o.canConfigureBlock&&i&&l))return null;const T=(0,k.nB)({feature:t,databaseType:x}),P=(0,k.OH)({feature:t,databaseType:x}),F=(null==M?void 0:M.inverse)===a||(null==M?void 0:M.property)===a,Z=(null==_?void 0:_.inverse)===a||(null==_?void 0:_.property)===a,A=F&&Z,B={label:(0,I.jsx)(u.FormattedMessage,{...k.dH.turnOffAndDelete}),color:"red",onAccept:async()=>{a&&(await async function(e){const{environment:t,collectionContextStore:o,propertyId:i,feature:n}=e,r=o.normalizedSchemaStore.state,s=o.collectionStore();if(!s)return;await v.createAndCommitAsync({environment:t,userAction:"CollectionSettingsViewRelationFeatures.handleTurnOffFeatureAndDeleteAccept",waitForServerCommit:!1,perform:e=>S.yV({environment:t,collectionStore:s,schema:r,property:i,transaction:e})});const a=r[i];a&&f.y9({environment:t,collectionContextStore:o,property_type:a.type,from:n,property:i})}({environment:j,propertyId:a,collectionContextStore:c,feature:t}),g(void 0),null==b||b(),y.wl({collectionSettingsStore:p,item:{type:"main"}}))}},K={label:(0,I.jsx)(u.FormattedMessage,{...k.dH.turnOffFeature}),color:"red",onAccept:()=>{a&&(g(void 0),null==b||b(),y.wl({collectionSettingsStore:p,item:{type:"main"}}))}};return(0,I.jsx)(V.Z,{icon:d.y,title:(0,I.jsx)(u.FormattedMessage,{...T}),isRed:!0,onClick:()=>{h.showDialog({description:(0,I.jsx)(u.FormattedMessage,{...k.dH.turnOffFeatureDeletedProperties,values:{span:e=>(0,I.jsx)("span",{style:w.modalPropertyName,children:e}),propertyName:i,inversePropertyName:l}}),message:(0,I.jsx)("div",{style:w.modalTitle,children:(0,I.jsx)(u.FormattedMessage,{...P})}),innerStyle:w.modalInnerStyle,showCancel:!0,keepFocus:!0,items:A?[B,K]:[B]})}})}function R(e){const{currentValue:t,onChange:o,disabled:i,databaseType:n}=e;return(0,I.jsx)(_.Z,{title:(0,I.jsx)(u.FormattedMessage,{...k.dH.avoidWeekendsSwitcherTitle}),caption:(0,I.jsx)(u.FormattedMessage,{...(0,k.Bq)(n)}),shouldWrapCaption:!0,shouldWrapTitle:!0,focused:!1,on:t,disabled:i,disabledFeedback:!0,onClick:()=>o(!t)})}function D(e){const{currentMode:t,onModeChange:o,disabled:i,databaseType:n}=e,r=(0,s.yK)((e=>({wrap:{display:"flex",flexDirection:"column",rowGap:8,marginLeft:12,marginRight:12}})),[]);return(0,I.jsx)("div",{style:r.wrap,children:[...l.Bp,void 0].map((e=>(0,I.jsx)(z,{dateShiftingMode:e,databaseType:n,onClick:()=>o(e),active:e===t,disabled:i},e??"none")))})}function z(e){const{dateShiftingMode:t,onClick:o,active:i,disabled:r,databaseType:a}=e,l=(0,n.Fy)(),c=(0,s.yK)((e=>({buttonStyles:{fontSize:l.isMobile?m.Z.fontSize.UISmall.mobile:m.Z.fontSize.UISmall.desktop,fontWeight:m.Z.fontWeight.medium,borderRadius:4,width:"100%",padding:"8px 8px",boxShadow:`0 0 0 1px ${e.regularDividerColor}`,color:e.darkTextColor,fill:e.mediumTextColor,...i&&{boxShadow:`0 0 0 2px ${e.blueColor}`,color:e.blueColor,fill:e.blueColor},...r&&{opacity:.65}},icon:{width:20,height:20,marginRight:6},buttonContentWrap:{display:"flex",alignItems:"center"}})),[i,l,r]),d=(0,k.W3)({dateShiftingMode:t,databaseType:a}),p=(0,k.l7)(t);return(0,I.jsx)(j.Z,{style:c.buttonStyles,onClick:o,disabled:r,children:(0,I.jsxs)("div",{style:c.buttonContentWrap,children:[(0,I.jsx)("div",{children:p(c.icon)}),(0,I.jsx)("div",{children:(0,I.jsx)(u.FormattedMessage,{...d})})]})})}function N(e){const{environment:t,newConfig:o,collectionStore:i,transaction:n,intl:r}=e;let s;if((0,g.$K)(o.configWithoutDates))if(o.datePropertyId)s={...o.configWithoutDates,date_property:o.datePropertyId,end_date_property:o.endDatePropertyId};else{const e=(0,p.ZP)(),a={name:r.formatMessage(k.dH.newDateProperty),type:"date"};b.xO({environment:t,collectionStore:i,update:{[e]:a},transaction:n}),s={...o.configWithoutDates,date_property:e,end_date_property:void 0}}x.sW({store:i.getFormatStore(),data:{dependency_date_shifting_config:s??null},transaction:n})}function E(e){const{viewType:t,feature:o}=e;return"timeline_arrows_by"===o?"timeline"===t:"subitem"===o||void(0,g.t1)(o)}},337137:(e,t,o)=>{o.d(t,{Ld:()=>y,Xy:()=>x,he:()=>h,t6:()=>v});var i=o(667294),n=o(800480),r=o(886628),s=o(709291),a=o(401898),l=o(108406),c=o(316956),d=o(431869),u=o(730188),p=o(496802),g=o(210228),m=o(429657),f=o(729376),S=o(507443);function y(e){const{collectionContextStore:t,feature:o}=e,i=(0,s.useIntl)();return{initialPropertyName:(0,r.VK)((()=>{const e=t.collectionStore();if(null!=e&&e.isDefined()){const n=t.normalizedSchemaStore.state;return f.m8(i,{targetCollectionStore:e,isSelfRelation:!0,sourceSchema:n,createUnique:!0,from:o})}return i.formatMessage({id:"database.viewSettings.relationsPropertyTab.initialPropertyName.placeholder",defaultMessage:"Related to target"})}),[t,i,o])}}function h(e){const{feature:t,collectionContextStore:o,onPropertySelect:h}=e,x=(0,n.O7)(),v=(0,s.useIntl)(),{initialPropertyName:C}=y({collectionContextStore:o,feature:t}),b=(0,i.useCallback)((e=>{const{collectionViewStore:o,newProperty:i,transaction:n}=e;"timeline_arrows_by"===t&&m.tF({collectionViewStore:o,newProperty:i,transaction:n})}),[t]),j=(0,r.VK)((()=>o.normalizedSchemaStore.state),[o]),w=(0,i.useCallback)((()=>f.ND(o,j)),[o,j]),M=(0,i.useCallback)((e=>{const{relationPropertyId:i,transaction:n}=e;"subitem"===t?u.km({environment:x,collectionContextStore:o,relationPropertyId:i,transaction:n}):"timeline_arrows_by"===t?m._p({collectionContextStore:o,relationPropertyId:i,transaction:n}):(0,a.t1)(t)}),[o,x,t]),_=(0,i.useCallback)((e=>{const{featureType:t,from:i}=e,n=o.collectionStore(),r=n,s=o.collectionViewStore();if(!n||!r)return;const{performResult:u}=g.createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:x,perform:i=>{const a=c.G3({environment:x,collectionStore:n,collectionViewArgs:s?{collectionViewStore:s,format:s.getFormat(),formatKey:"collection_page_properties"}:void 0,propertyType:"relation",transaction:i});return d.n7({environment:x,collectionContextStore:o,collectionStore:n,property:a,propertyName:C,targetCollectionStore:r,hasInverseRelation:!0,inverseName:void 0,autoRelate:{enabled:!1},propertyLimit:"no_limit",intl:v,transaction:i,from:t}),s&&(b({collectionViewStore:s,newProperty:a,transaction:i}),M({relationPropertyId:a,transaction:i})),"timeline_arrows_by"===t&&(0,S.pK)({environment:x,intl:v,collectionStore:n,transaction:i,newConfig:e.dateShiftingConfig}),a}});let p;"subitem"===t?p="notion://tasks/sub_task_feature":"timeline_arrows_by"===t?p="notion://tasks/task_dependencies_feature":(0,a.t1)(t),l._H({environment:x,collectionContextStore:o,from:t,property_type:"relation",feature:{id:u,from:i,type:p}})}),[o,x,C,v,M,b]),k=(0,i.useCallback)((e=>{const i=o.collectionViewStore();if(!i)return;let n;g.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handleDefaultPropertySelect",environment:x,perform:t=>{b({collectionViewStore:i,newProperty:e,transaction:t}),M({relationPropertyId:e,transaction:t})}}),h(e),"subitem"===t?n="update_default_subitem":"timeline_arrows_by"===t?n="update_default_timeline_arrows_by":(0,a.t1)(t),l.wd({action:n,original_view_type:void 0,property_type:e?"relation":void 0,environment:x,collectionContextStore:o})}),[o,x,h,t,b,M]);return{handlePropertySelect:(0,i.useCallback)((e=>{const i=o.collectionViewStore();if(!i)return;let n;g.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handlePropertySelect",environment:x,perform:t=>{b({collectionViewStore:i,newProperty:e,transaction:t})}}),h(e),"subitem"===t?n="update_subitem":"timeline_arrows_by"===t?n="update_timeline_arrows_by":(0,a.t1)(t),l.wd({action:n,original_view_type:void 0,property_type:e?"relation":void 0,environment:x,collectionContextStore:o})}),[o,x,h,t,b]),handleDefaultPropertySelect:k,handleAddRelation:_,getProperties:w,clearCollectionViewSubitemDisplayMode:(0,i.useCallback)((()=>{const e=o.collectionViewStore();e&&g.createAndCommit({userAction:"actionRegistry.clearCollectionViewSubitemDisplayMode",environment:x,perform:t=>{p.FH({stores:[e],update:{subitem_display_mode:void 0},transaction:t})}})}),[o,x])}}function x(e){const{feature:t,collectionContextStore:o}=e;let i,n;var r,s;if("subitem"===t)n=null===(r=o.collectionStore())||void 0===r?void 0:r.getFormatStore().getKeyStore("subitem_property").getValue(),i="flattened"===(null===(s=o.collectionViewStore())||void 0===s?void 0:s.getFormat().subitem_display_mode)?void 0:n;else if("timeline_arrows_by"===t){var l;i=o.currentArrowsByFormatStore.state,n=null===(l=o.collectionStore())||void 0===l?void 0:l.getFormatStore().getKeyStore("collection_default_arrows_by").getValue()}else(0,a.t1)(t);const c=o.normalizedSchemaStore.state,d=f.NA(o,c);(0,a.$K)(i)&&!d.includes(i)&&(i=void 0),(0,a.$K)(n)&&!d.includes(n)&&(n=void 0);const u=i??n;if(u){var p;const e=Boolean(i),r="hidden"!==(null===(p=o.collectionViewStore())||void 0===p?void 0:p.getFormat().subitem_display_mode),s="subitem"===t?r:e;return{property:u,isDefault:u===n,enabledOnView:e,enabledOnCollection:Boolean(n),supportedInView:(0,S.Tg)({feature:t,viewType:o.getViewType()}),isVisibleInView:s}}}function v(e){const{feature:t,collectionContextStore:o}=e;return(0,r.VK)((()=>x({feature:t,collectionContextStore:o})),[o,t])}},295314:(e,t,o)=>{o.d(t,{A:()=>E,I:()=>N});var i=o(667294),n=o(800480),r=o(886628),s=o(724405),a=o(492607),l=o(709291),c=o(401898),d=o(137810),u=o(231945),p=o(478140),g=o(953437),m=o(460709),f=o(981166),S=o(61766),y=(o(757658),o(443261)),h=o.n(y),x=o(406695),v=o(295519),C=o(356666),b=o(653965),j=o(73657),w=o(552275),M=o(268894),_=o(632163),k=o(672495),V=o(69872),T=o(623879),P=o(433929),I=o(229798),F=o(785893);const Z=2,A=(0,l.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.propertySelect.inputPlaceholder"}});function B(e){const{currentProperty:t,getGroupedProperties:o,onAccept:a,renderProperty:d,inputPlaceholder:u,schema:p,format:g,defaultShowPropertyGroupCount:m}=e,f=(0,n.Fy)(),S=(0,r.qz)(void 0,I.Z),y=(0,r.VK)((()=>o()),[o]),[_,V]=(0,i.useState)(!1),[B,L]=(0,i.useState)(""),R=(0,v.i)(g,p,void 0,x.j5.Page).collection_page_properties||[],D=(0,i.useCallback)((e=>{L(e.target.value),S.setState({...S.state,focus:{section:0,indexLocal:0,indexGlobal:0}}),V(!1)}),[S]),z=(0,s.yK)((e=>({dotsIcon:{width:16,fill:e.mediumTextColor,marginLeft:4,marginRight:2},showMoreButton:{color:e.mediumTextColor}})),[]),N=b.MR(y,(e=>Math.min(...e.map((e=>R.findIndex((t=>t.property===e))))))),E=[{key:"input",comp:(0,F.jsx)(k.Z,{children:(0,F.jsx)(M.ZP,{focusInitial:!f.isMobile||void 0,focus:!f.isMobile||void 0,value:B,onChange:D,placeholder:u||P.default.formatMessage(A.inputPlaceholder)})})}];if(B){const e=N.map((e=>e.filter((e=>{const t=p[e],o=t?`${t.name} ${T.SO[t.type]}`:"";return Boolean(h().match(B,o))})))).filter((e=>e.length>0));if(0===e.length)E.push({key:"noResults",comp:(0,F.jsx)(j.Z,{caption:(0,F.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.propertySelect.noResultsTitle"})})});else{const o=[{key:"results",render:e=>(0,F.jsx)(k.Z,{...e}),items:e.flat().map((e=>O({onAccept:a,property:e,schema:p,currentProperty:t,renderProperty:d}))).filter(c.$K)}];E.push(K({sections:o,menuListStore:S}))}}else{const e=m||Z;let o,i;if(!_&&N.length>e){o=N.slice(0,e);const t=b.Sm(N.slice(e).map((e=>e.length)));i={key:"show_more",render:e=>(0,F.jsx)(w.Z,{...e,icon:(0,C.o)(z.dotsIcon),style:z.showMoreButton,title:(0,F.jsx)(l.FormattedMessage,{defaultMessage:"{moreCount} more",id:"database.viewSettings.propertySelect.showMoreTitle",values:{moreCount:t}})}),action:()=>{V(!0)}}}else o=N;const n=o.map(((e,n)=>({key:e.join("-"),render:e=>(0,F.jsx)(k.Z,{...e,topBorder:0!==n}),items:e.map((e=>O({onAccept:a,property:e,schema:p,currentProperty:t,renderProperty:d}))).concat(n===o.length-1?[i]:[]).filter(c.$K)})));E.push(K({sections:n,menuListStore:S}))}return(0,F.jsx)(F.Fragment,{children:E.map((e=>{let{key:t,comp:o}=e;return(0,F.jsx)(i.Fragment,{children:o},t)}))})}function K(e){const{menuListStore:t,sections:o}=e;return{key:"properties",comp:(0,F.jsx)(_.Z,{type:_.i.Vertical,initialFocus:0,sections:o,store:t})}}function O(e){const{schema:t,currentProperty:o,onAccept:i,renderProperty:n,property:r}=e,s=t[r];if(!s)return;return{key:r,render:e=>{const t=r===o;return n?n(e,r,t,s):(0,F.jsx)(V.Z,{...e,propertySchema:s,format:V.L.Name,checkState:t})},action:()=>{i(r)}}}var L=o(694166),R=o(657410),D=o(690716),z=o(337137);function N(e){const{currentPropertyId:t,feature:o,collectionContextStore:i,permissionScopes:n,onPropertySelect:s,buttonPopupStore:d,disabled:u}=e,p=(0,l.useIntl)(),g=(0,r.VK)((()=>{var e,t;return"subitem"===o?null===(e=i.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.subitem_property:"timeline_arrows_by"===o?null===(t=i.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by:void(0,c.t1)(o)}),[o,i]),m=(0,r.VK)((()=>i.databaseType),[i]),{handleDefaultPropertySelect:S,handlePropertySelect:y,getProperties:h}=(0,z.he)({collectionContextStore:i,feature:o,onPropertySelect:s}),x=(0,f.g3)({feature:o,databaseType:m});return(0,F.jsx)(H,{intl:p,icon:a.v,caption:(0,F.jsx)(l.FormattedMessage,{...x}),collectionContextStore:i,buttonPopupStore:d,shouldGroupProperties:!0,getGroupedProperties:h,currentProperty:t,disabled:u,onAccept:n.canConfigureBlock&&n.canConfigureCollection?y:()=>{},renderProperty:(e,t,n,r)=>(0,F.jsx)(D.Z,{version:"v2",feature:o,menuProps:e,property:t,defaultProperty:g,checkState:n,propertySchema:r,collectionContextStore:i,handleDefaultPropertySelect:S,handlePropertySelect:y})})}function E(e){const{currentPropertyId:t,collectionContextStore:o,onPropertyChanged:n,disabled:s,title:a}=e,d=(0,l.useIntl)(),u=(0,r.qz)(void 0,S.Z),p=(0,r.VK)((()=>o.normalizedSchemaStore.state),[o]),g=(0,i.useCallback)((()=>Object.keys(p).filter((e=>{const t=p[e];return"date"===(null==t?void 0:t.type)})).filter(c.$K)),[p]);return(0,F.jsx)(H,{intl:d,buttonPopupStore:u,title:a,collectionContextStore:o,shouldGroupProperties:!1,getProperties:g,currentProperty:t,disabled:s,onAccept:e=>{e&&n(e),u.setState({open:!1})}})}function H(e){const{currentProperty:t,icon:o,caption:i,buttonPopupStore:a,collectionContextStore:c,disabled:f,title:S,shouldGroupProperties:y}=e,h=(0,n.Fy)(),x=(0,r.VK)((()=>{var e;return(null===(e=c.collectionStore())||void 0===e?void 0:e.getFormat())??{}}),[c]),v=(0,r.VK)((()=>c.normalizedSchemaStore.state),[c]),C=(0,s.yK)((e=>({caption:{fontSize:h.isMobile?d.Z.fontSize.UISmall.mobile:d.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,margin:"0 12px 12px 14px"}})),[h]),b=(0,r.VK)((()=>a.state.open),[a]),j=(0,r.VK)((()=>h.isPhone?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:300}),[h.isPhone]);return(0,F.jsxs)(F.Fragment,{children:[i&&(0,F.jsx)("div",{style:C.caption,children:i}),(0,F.jsx)(u.ZP,{popupType:h.isPhone?g.kQ.SlideUp:g.kQ.Popup,alignmentToOrigin:u.vR.End,placementToOrigin:u.pO.Bottom,disabled:f,originGap:0,renderOrigin:e=>{var i;return(0,F.jsx)(L.Z,{title:S??(0,F.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationFeatures.propertyPicker.default.title",defaultMessage:"Property"}),showChevron:!0,right:t?(0,F.jsx)("span",{style:d.Z.textOverflowStyle,children:null===(i=v[t])||void 0===i?void 0:i.name}):void 0,rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},rotateChevron:b,disabled:f,icon:o,...e})},render:t=>(0,F.jsx)(p.Z,{...j,children:y?(0,F.jsx)(B,{...e,getGroupedProperties:e.getGroupedProperties,format:x,schema:v}):(0,F.jsx)(R.Z,{getProperties:e.getProperties,currentProperty:e.currentProperty,onAccept:e.onAccept,format:x,schema:v})}),buttonPopupStore:a})]})}},17570:(e,t,o)=>{o.r(t),o.d(t,{ChartSettingsMain:()=>Hp.Z,CollectionSettings:()=>tp,CollectionSettingsButtonOptions:()=>zp});var i=o(667294),n=o(800480),r=o(886628),s=o(307032),a=o(436610),l=o(805149),c=o(496802),d=o(210228),u=o(638086),p=o(374194),g=o(203386),m=(o(757658),o(730120)),f=o(724405),S=o(841892),y=o(559054),h=o(605336),x=o(569651),v=o(745238),C=o(785893);const b=(0,v.IU)("checkboxSquareCheckedDotted",{viewBox:"0 0 16 16",svg:(0,C.jsx)("path",{d:"M3.243 2.712a.648.648 0 00.465.191.664.664 0 00.478-.191.636.636 0 00.199-.465.652.652 0 00-.199-.479.652.652 0 00-.478-.198.636.636 0 00-.465.198.664.664 0 00-.191.479.65.65 0 00.19.465zm2.14 0a.656.656 0 00.471.191c.183 0 .34-.064.472-.191a.626.626 0 00.205-.465.641.641 0 00-.205-.479.644.644 0 00-.472-.198.664.664 0 00-.663.677c0 .178.064.332.192.465zm2.14 0A.664.664 0 008 2.903c.182 0 .34-.064.471-.191a.636.636 0 00.199-.465.652.652 0 00-.199-.479A.644.644 0 008 1.57a.664.664 0 00-.67.677c0 .178.064.332.191.465zm2.146 0c.132.127.29.191.471.191a.641.641 0 00.472-.191.637.637 0 00.198-.465.652.652 0 00-.198-.479.63.63 0 00-.472-.198.644.644 0 00-.471.198.652.652 0 00-.199.479.64.64 0 00.199.465zm2.14 0a.68.68 0 00.478.191.633.633 0 00.465-.191.636.636 0 00.198-.465.652.652 0 00-.198-.479.622.622 0 00-.465-.198.652.652 0 00-.479.198.652.652 0 00-.198.479c0 .178.066.332.198.465zm1.476 1.47a.65.65 0 00.472.198.63.63 0 00.471-.199.644.644 0 00.199-.471.644.644 0 00-.199-.472.63.63 0 00-.471-.198.644.644 0 00-.472.198.656.656 0 00-.191.472c0 .182.063.34.19.471zm0 2.139c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.471.63.63 0 00-.471-.199.644.644 0 00-.472.199.656.656 0 00-.191.471c0 .183.063.34.19.472zm0 2.146c.132.133.29.199.472.199a.63.63 0 00.471-.199.644.644 0 00.199-.471.652.652 0 00-.199-.479.63.63 0 00-.471-.198.634.634 0 00-.472.205.656.656 0 00-.191.472c0 .182.063.34.19.471zm0 2.147c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.471.62.62 0 00-.471-.205.634.634 0 00-.472.205.656.656 0 00-.191.471c0 .183.063.34.19.472zm0 2.14c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.472.63.63 0 00-.471-.198.644.644 0 00-.472.198.656.656 0 00-.191.472c0 .182.063.34.19.472zm-1.477 1.476a.667.667 0 00.479.198.622.622 0 00.465-.198.636.636 0 00.198-.465.652.652 0 00-.198-.478.622.622 0 00-.465-.198.652.652 0 00-.479.198.652.652 0 00-.198.478c0 .178.066.333.198.465zm-2.14 0a.667.667 0 00.48.198.622.622 0 00.464-.198.637.637 0 00.198-.465.652.652 0 00-.198-.478.622.622 0 00-.465-.198.652.652 0 00-.478.198.652.652 0 00-.199.478c0 .178.067.333.199.465zm-2.146 0a.66.66 0 00.486.198.622.622 0 00.464-.198.637.637 0 00.199-.465.652.652 0 00-.199-.478.636.636 0 00-.464-.198.664.664 0 00-.677.677c0 .177.064.332.191.464zm-2.14 0c.133.132.29.198.472.198a.652.652 0 00.479-.198.637.637 0 00.198-.465.652.652 0 00-.198-.478.652.652 0 00-.479-.198.664.664 0 00-.663.677c0 .177.064.332.192.464zm-2.14 0c.133.132.29.198.473.198.182 0 .34-.066.471-.198a.637.637 0 00.199-.465.652.652 0 00-.199-.478.644.644 0 00-.471-.198.664.664 0 00-.663.677c0 .177.063.332.19.464zm-1.476-1.476a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.472.622.622 0 00-.465-.198.644.644 0 00-.472.198.644.644 0 00-.198.472c0 .182.064.34.191.472zm0-2.14a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.471.612.612 0 00-.465-.205.634.634 0 00-.472.205.644.644 0 00-.198.471c0 .183.064.34.191.472zm0-2.147a.652.652 0 00.479.199.622.622 0 00.465-.199.644.644 0 00.198-.471.652.652 0 00-.198-.479.622.622 0 00-.465-.198.634.634 0 00-.472.205.644.644 0 00-.198.472c0 .182.064.34.191.471zm0-2.146a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.471.622.622 0 00-.465-.199.644.644 0 00-.472.199.644.644 0 00-.198.471c0 .183.064.34.191.472zm0-2.14a.652.652 0 00.479.199.622.622 0 00.465-.199.644.644 0 00.198-.471.63.63 0 00-.198-.472.622.622 0 00-.465-.198.644.644 0 00-.472.198.644.644 0 00-.198.472c0 .182.064.34.191.471zm5.161 6.973a.7.7 0 00.342.082c.255 0 .456-.116.602-.349l3.056-4.778a1.27 1.27 0 00.116-.219.587.587 0 00.054-.239.506.506 0 00-.191-.41.661.661 0 00-.43-.157c-.215 0-.393.116-.534.348l-2.7 4.327L5.97 8.146a.713.713 0 00-.252-.225.567.567 0 00-.28-.069.568.568 0 00-.425.185.599.599 0 00-.17.43c0 .155.059.308.177.458l1.614 1.97c.095.113.193.2.293.259z",clipRule:"evenodd"})}),j=(0,v.IU)("cursorArrowClickRays",{viewBox:"0 0 16 16",svg:(0,C.jsx)("path",{d:"M7.997 3.766a.604.604 0 01-.595-.595V1.175c0-.322.274-.595.595-.595.328 0 .602.273.602.595V3.17a.606.606 0 01-.602.595zM4.948 4.955a.594.594 0 01-.84 0L2.705 3.54a.607.607 0 010-.84.607.607 0 01.84.006l1.402 1.408a.594.594 0 010 .841zm6.023.068a.607.607 0 010-.84l1.422-1.415a.598.598 0 01.834 0 .602.602 0 010 .847l-1.409 1.408a.602.602 0 01-.847 0zm-3.514 7.725l.062-5.462c.006-.253.266-.349.437-.17l3.74 3.834c.184.198.054.445-.199.458l-1.476.062 1.23 2.843a.241.241 0 01-.11.329l-.683.266c-.123.055-.26-.013-.314-.137l-1.17-2.891-1.038 1.046c-.178.17-.486.089-.479-.178zM3.779 7.997a.606.606 0 01-.601.595H1.175a.604.604 0 01-.595-.595c0-.321.274-.595.595-.595h2.003c.328 0 .601.274.601.595zm8.45 0c0-.321.273-.595.594-.595h1.996c.329 0 .602.274.602.595a.606.606 0 01-.602.595h-1.996a.604.604 0 01-.595-.595zm-7.212 2.98a.594.594 0 010 .841l-1.409 1.409a.616.616 0 01-.847-.007.614.614 0 01.007-.841l1.408-1.402c.232-.225.622-.225.84 0z"})}),w=(0,v.IU)("database",{viewBox:"0 0 20 20",svg:(0,C.jsx)("path",{d:"M16.25 5v1.25c0 1.381-2.797 2.5-6.25 2.5s-6.25-1.119-6.25-2.5V5c0-1.381 2.797-2.5 6.25-2.5s6.25 1.119 6.25 2.5zM10 14.375c-2.784 0-4.744-.569-5.963-1.378-.187.237-.287.49-.287.753V15c0 1.381 2.797 2.5 6.25 2.5s6.25-1.119 6.25-2.5v-1.25c0-.262-.103-.516-.287-.753-1.22.806-3.179 1.378-5.963 1.378zM10 10c-2.784 0-4.744-.569-5.963-1.378-.187.237-.287.49-.287.753v1.25c0 1.381 2.797 2.5 6.25 2.5s6.25-1.119 6.25-2.5v-1.25c0-.262-.103-.516-.287-.753C14.742 9.428 12.784 10 10 10z"})});var M=o(584169),_=o(253523);const k=(0,v.IU)("rightArrowEmpty",{viewBox:"0 0 22 18",svg:(0,C.jsx)("path",{d:"M21.582 8.955c0-.332-.117-.693-.498-1.055L13.379.693C12.86.205 12.539 0 12.06 0c-.683 0-1.171.537-1.171 1.191v3.692h-7.92c-1.543 0-2.442.879-2.442 2.392v3.37c0 1.513.899 2.392 2.442 2.392h7.92v3.73c0 .655.488 1.143 1.152 1.143.479 0 .87-.195 1.338-.635L21.084 10c.371-.352.498-.723.498-1.045zm-1.758 0c0 .059-.02.107-.097.186l-6.963 6.582a.219.219 0 01-.166.087c-.079 0-.137-.058-.137-.146v-3.78c0-.224-.098-.322-.322-.322h-9.15c-.626 0-.987-.36-.987-.996V7.354c0-.635.361-.997.986-.997h9.15c.225 0 .323-.097.323-.322V2.158c0-.078.059-.137.146-.137.059 0 .118.04.166.079l6.954 6.67c.068.068.097.126.097.185z"})});var V=o(733507),T=o(937612),P=o(709291),I=o(137810),F=o(547307),Z=o(595193),A=o(497372),B=o(694166),K=o(916694),O=o(125811),L=o(552275),R=o(231945),D=o(316354),z=o(478140),N=o(632163),E=o(953437),H=o(158297),U=o(672495),W=o(886825),G=o(179122);function $(e){const{collectionContextStore:t,collectionSettingsStore:o,from:i}=e,{sprintSettingsConfig:n,currentSprintDateRange:r,sprintSettingsPermissionsContext:s,sprintSettingsConfigUpdater:a,turnOffSprints:l,turnOnSprints:c,automaticSprintCompletionEnabled:d,canManageSprintFromThisView:u,manageSprintFromThisView:p}=(0,O.Z)({collectionContextStore:t,collectionSettingsStore:o,from:i});if(!s||!s.canEdit||!n)return null;let g;return g=s.sprintsEnabled?(0,C.jsx)(q,{...e,updateSprintSettingsConfig:a,onTurnOffSprints:l,automaticSprintCompletionEnabled:d,currentSprintDateRange:r,canManageSprintFromThisView:u,onManageSprintFromThisView:p,sprintSettingsConfig:n}):(0,C.jsx)(Q,{...e,onTurnOnSprints:c}),g}function q(e){const{sprintSettingsConfig:t,automaticSprintCompletionEnabled:o,currentSprintDateRange:i,canManageSprintFromThisView:n,updateSprintSettingsConfig:r,collectionContextStore:s,onTurnOffSprints:a,onManageSprintFromThisView:l}=e,c=de(),d=[];return d.push((0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(U.Z,{topBorder:!0,disableMobileBorders:!0,children:[n&&(0,C.jsx)(ie,{automaticSprintCompletionEnabled:o,manageSprintFromThisView:l}),(0,C.jsx)(oe,{turnOffSprints:a,collectionContextStore:s})]},"turn-off-sprints-section"),(0,C.jsx)(U.Z,{topBorder:!0,children:(0,C.jsx)(D.Z,{href:G.Iq,external:!0,children:(0,C.jsx)(B.Z,{icon:M.m,iconStyle:c.icon,title:(0,C.jsx)(P.FormattedMessage,{...G.BX.learnSprintsTitle}),isGray:!0})})})]})),(0,C.jsxs)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{...G.BX.sprintsMenuTitle}),footer:d,children:[(0,C.jsx)(X,{automaticSprintCompletionEnabled:o,currentSprintDateRange:i}),(0,C.jsxs)(U.Z,{children:[(0,C.jsx)(re,{onChange:r.handleSprintDurationChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t}),(0,C.jsx)(se,{onChange:r.handleSprintStartWeekdayChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t}),(0,C.jsx)(ae,{onChange:r.handleSprintRemainingTasksBehaviorChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t})]}),(0,C.jsx)(U.Z,{topBorder:!0,children:(0,C.jsx)(ne,{onChange:r.handleSprintAutoCompleteChange,sprintSettingsConfig:t})})]})}function Q(e){const{onTurnOnSprints:t}=e,o=de(),i=[];return i.push((0,C.jsx)(U.Z,{disableMobileBorders:!0,children:(0,C.jsx)("div",{style:o.buttonWrap,children:(0,C.jsx)(H.Z,{style:o.button,onClick:async()=>{await t()},isLarge:!0,children:(0,C.jsx)(P.FormattedMessage,{...G.BX.turnOnSprints})})})},"turn-on-sprints-section")),(0,C.jsx)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{...G.BX.setupSprintsTitle}),footer:i,children:(0,C.jsxs)(U.Z,{disableMobileBorders:!0,children:[(0,C.jsx)(Y,{}),(0,C.jsx)(J,{}),(0,C.jsx)(ee,{})]})})}function X(e){const{automaticSprintCompletionEnabled:t,currentSprintDateRange:o}=e,i=de();if(!o)return null;const n=m.ou.fromISO(o.end_date).plus({days:1});return(0,C.jsx)(K.P,{style:i.sprintStartDateHeader,children:(0,C.jsxs)("div",{style:i.sprintStartDateHeaderWrap,children:[k(i.sprintStartDateHeaderIcon),(0,C.jsx)(ce,{nextSprintStartDate:n,automaticSprintCompletionEnabled:t})]})})}function Y(){const e=de();return(0,C.jsx)("div",{style:{...e.menuDescriptionContainer,...e.menuDescriptionText},children:(0,C.jsx)(P.FormattedMessage,{...G.BX.setupSprintsCaption})})}function J(){const e=de();return(0,C.jsx)("div",{style:e.mediaWrap,children:(0,C.jsx)("img",{src:S.Z.images.appPackages.sprintsTurnOnPreviewPng,style:e.media})})}function ee(){const e=de(),t=t=>(0,C.jsx)("span",{style:e.boldText,children:t});return(0,C.jsxs)("div",{style:e.disclaimerWrap,children:[(0,C.jsx)("div",{children:(0,C.jsx)(P.FormattedMessage,{...G.BX.setupSprintsTeamspaceStatement})}),(0,C.jsx)(te,{text:(0,C.jsx)(P.FormattedMessage,{...G.BX.setupSprintsSprintBoardPageStatement,values:{bold:t}}),icon:V.L}),(0,C.jsx)(te,{text:(0,C.jsx)(P.FormattedMessage,{...G.BX.setupSprintsSprintsDatabaseStatement,values:{bold:t}}),icon:w})]})}function te(e){const{text:t,icon:o}=e,i=de();return(0,C.jsxs)("div",{style:i.disclaimerSubitem,children:[(0,C.jsx)("div",{children:o(i.disclaimerSubitemIcon)}),(0,C.jsx)("div",{children:t})]})}function oe(e){const{collectionContextStore:t,turnOffSprints:o}=e,i=(0,n.O7)(),s=(0,r.VK)((()=>t.sprintSettingsContextStore.state),[t.sprintSettingsContextStore]),[{value:a}]=(0,y.r5)((async()=>{if(null==s||!s.taskCollectionStore||null==s||!s.taskCollectionViewBlockStore)return;return await(0,G._3)({environment:i,collectionStore:s.taskCollectionStore,collectionViewBlockStore:s.taskCollectionViewBlockStore})}),[i,null==s?void 0:s.taskCollectionStore,null==s?void 0:s.taskCollectionViewBlockStore]),l=de();return(0,C.jsx)(B.Z,{icon:T.y,title:(0,C.jsx)(P.FormattedMessage,{...G.BX.turnOffSprints}),isRed:!0,iconStyle:l.icon,onClick:()=>{F.showDialog({description:(0,C.jsx)(G.w2,{numOfSprintBoards:a?a.length:0}),message:(0,C.jsx)("div",{style:l.modalTitle,children:(0,C.jsx)(P.FormattedMessage,{...G.BX.turnOffSprintsModalTitle})}),innerStyle:l.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,C.jsx)(P.FormattedMessage,{...G.BX.turnOffAndDeleteModalButton}),color:"red",onAccept:async()=>{await o(a??[])}}]})}})}function ie(e){const{automaticSprintCompletionEnabled:t,manageSprintFromThisView:o}=e,i=de();return(0,C.jsx)(B.Z,{icon:j,title:(0,C.jsx)(P.FormattedMessage,{...G.BX.manageSprintFromThisView}),iconStyle:i.icon,onClick:()=>{F.showDialog({description:(0,C.jsx)(G.ZI,{automaticSprintCompletionEnabled:t}),message:(0,C.jsx)("div",{style:i.modalTitle,children:(0,C.jsx)(P.FormattedMessage,{...G.BX.manageSprintFromThisViewModalTitle})}),innerStyle:i.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,C.jsx)(P.FormattedMessage,{...G.BX.manageSprintFromThisViewModalButton}),color:"blue",onAccept:o}]})}})}function ne(e){const{onChange:t,sprintSettingsConfig:o}=e,i=de();return(0,C.jsx)(W.Z,{title:(0,C.jsx)(P.FormattedMessage,{...G.BX.automatedSprintsToggleTitle}),caption:(0,C.jsx)(P.FormattedMessage,{...G.BX.automatedSprintsToggleCaption}),focused:!1,on:o.autoCompleteSprints,onClick:()=>{t(!o.autoCompleteSprints)},style:{alignItems:void 0},icon:(0,_.N)(i.icon),shouldWrapCaption:!0})}function re(e){const{onChange:t,sprintSettingsConfig:o,disabled:i}=e,n=(0,G.gV)(o.recurrenceConfig.interval),r=G.fq.map((e=>(0,G.gV)(e)));return(0,C.jsx)(le,{title:(0,C.jsx)(P.FormattedMessage,{...G.BX.duration}),right:(0,C.jsx)(G.AV,{sprintDurationValue:n.value}),icon:h.r,getMenuItems:e=>r.map((o=>{const r={key:o.key,render:e=>(0,C.jsx)(L.Z,{...e,disabled:i,title:(0,C.jsx)(G.AV,{sprintDurationValue:o.value}),checkState:o.key===n.key}),action:()=>{t(o.value),e.close()}};return r})),showChevron:!0})}function se(e){const{onChange:t,sprintSettingsConfig:o,disabled:i}=e,n=o.recurrenceConfig.weekdays[0],r=["SU","MO","TU","WE","TH","FR","SA"];return(0,C.jsx)(le,{title:(0,C.jsx)(P.FormattedMessage,{...G.BX.startOn}),icon:x.C,right:(0,C.jsx)(G.vA,{weekday:n}),getMenuItems:e=>r.map((o=>{const r={key:o,render:e=>(0,C.jsx)(L.Z,{...e,disabled:i,title:(0,C.jsx)(G.vA,{weekday:o}),checkState:o===n}),action:()=>{t(o),e.close()}};return r})),showChevron:!0})}function ae(e){const{onChange:t,sprintSettingsConfig:o,disabled:i}=e,n=o.actionConfig.complete_sprint_action,r=["complete_sprint_and_move_incomplete_tasks_to_next_sprint","complete_sprint_and_move_incomplete_tasks_to_backlog","complete_sprint"];return(0,C.jsx)(le,{title:(0,C.jsx)(P.FormattedMessage,{...G.BX.incompleteTasks}),right:(0,C.jsx)(G.Q8,{completeSprintAction:n}),icon:b,getMenuItems:e=>r.map((o=>{const r={key:o,render:e=>(0,C.jsx)(L.Z,{...e,disabled:i,title:(0,C.jsx)(G.Uj,{completeSprintAction:o}),checkState:o===n}),action:()=>{t(o),e.close()}};return r})),showChevron:!0})}function le(e){const{getMenuItems:t}=e,o=(0,n.Fy)(),i=de(),r=(0,Z.F)({width:250});return(0,C.jsx)(R.ZP,{popupType:o.isMobile?E.kQ.SlideUp:E.kQ.Popup,alignmentToOrigin:R.vR.End,placementToOrigin:R.pO.Bottom,renderOrigin:t=>(0,C.jsx)(B.Z,{...e,iconStyle:i.icon,...t}),render:e=>(0,C.jsx)(z.Z,{...r,children:(0,C.jsx)(N.Z,{type:N.i.Vertical,sections:[{key:0,render:e=>(0,C.jsx)(U.Z,{enableActionSheetTitle:!0,...e}),items:t(e)}],initialFocus:0})})})}function ce(e){const{nextSprintStartDate:t,automaticSprintCompletionEnabled:o}=e,i=m.ou.local().startOf("day"),n=t.diff(i,"days").days,r=t.toLocaleString({weekday:"short",month:"short",day:"numeric"}),s=e=>(0,C.jsx)("time",{dateTime:t.toISODate(),children:e});return o?0===n?(0,C.jsx)("div",{children:(0,C.jsx)(P.FormattedMessage,{...G.BX.sprintStartDateToday,values:{time:s}})}):(0,C.jsx)("div",{children:(0,C.jsx)(P.FormattedMessage,{...G.BX.sprintStartDateFuture,values:{time:s,days:n,formattedDate:r}})}):n<0?(0,C.jsx)("div",{children:(0,C.jsx)(P.FormattedMessage,{...G.BX.sprintStartDateShouldStartPast,values:{time:s,days:Math.abs(n),formattedDate:r}})}):0===n?(0,C.jsx)("div",{children:(0,C.jsx)(P.FormattedMessage,{...G.BX.sprintStartDateShouldStartToday,values:{time:s}})}):(0,C.jsx)("div",{children:(0,C.jsx)(P.FormattedMessage,{...G.BX.sprintStartDateShouldStartFuture,values:{time:s,days:n,formattedDate:r}})})}function de(){const e=(0,n.Fy)();return(0,f.yK)((t=>({icon:{width:16,height:"auto"},menuDescriptionContainer:{margin:"0px 12px"},menuDescriptionText:{fontSize:e.isMobile?I.Z.fontSize.UISmall.mobile:I.Z.fontSize.UISmall.desktop,color:t.mediumTextColor,fontWeight:I.Z.fontWeight.regular,marginLeft:14},button:{width:"100%"},buttonWrap:{margin:"0px 12px"},disclaimerWrap:{margin:"0px 12px",fontSize:e.isMobile?I.Z.fontSize.UIRegular.mobile:I.Z.fontSize.UIRegular.desktop,color:t.mediumTextColor,fontWeight:I.Z.fontWeight.regular},disclaimerSubitem:{display:"flex",padding:"0px 10px",margin:"7px 0px",gap:7},disclaimerSubitemIcon:{color:t.lightIconColor,width:20,height:20,marginTop:e.isMobile?3:1},boldText:{color:t.regularTextColor,fontWeight:I.Z.fontWeight.semibold},mediaWrap:{margin:"0px 12px"},media:{margin:"15px 0px 10px 0px",width:"100%",height:116,border:`1px solid ${t.accentColors.washGlass[0]}`,borderRadius:"5px"},mediaIcon:{width:40,height:40,color:t.lightIconColor},modalTitle:{fontWeight:I.Z.fontWeight.semibold,fontSize:18},modalInnerStyle:{textAlign:"center"},modalReferencedPageName:{color:t.darkTextColor,fontWeight:I.Z.fontWeight.semibold},sprintStartDateHeaderWrap:{display:"flex",flexDirection:"row",alignItems:"start",gap:"8px",color:t.mediumTextColor},sprintStartDateHeaderIcon:{width:16,height:"auto",marginBlockStart:3},sprintStartDateHeader:{background:t.surface.wash}})),[e])}var ue=o(277907),pe=o(568785);function ge(e){const{shouldShowSpinner:t,collectionSettingsEditAutomationViewProps:o}=e;return(0,C.jsx)(A.ZP,{collectionSettingsStore:o.collectionSettingsStore,fullHeight:!0,children:t&&(0,C.jsx)("div",{style:{display:"flex",justifyContent:"center",overflow:"hidden"},children:(0,C.jsx)(pe.Z,{})})})}const me=new ue.Ss("database-automations",(()=>Promise.all([o.e(62743),o.e(52774),o.e(5242),o.e(71891),o.e(84885),o.e(16732),o.e(30433),o.e(99417),o.e(84654),o.e(86467),o.e(44500),o.e(52193),o.e(83264),o.e(24207),o.e(55461),o.e(87266),o.e(43627),o.e(47687),o.e(40071),o.e(7688),o.e(47957),o.e(31655)]).then(o.bind(o,378310)))),fe=(0,ue.kF)(me,(e=>e.CollectionSettingsCreateAutomationView),{renderLoading:(e,t)=>(0,C.jsx)(ge,{shouldShowSpinner:e,collectionSettingsEditAutomationViewProps:t})}),Se=(0,ue.kF)(me,(e=>e.CollectionSettingsEditAutomationView),{renderLoading:(e,t)=>(0,C.jsx)(ge,{shouldShowSpinner:e,collectionSettingsEditAutomationViewProps:t})}),ye=(0,ue.kF)(me,(e=>e.CollectionSettingsAutomationsView)),he=new ue.Ss("CollectionSettingsCustomizeMenu",(()=>Promise.resolve().then(o.bind(o,641037)))),xe=(0,ue.kF)(he,(e=>e.CollectionSettingsCustomizeMenu)),ve=new ue.Ss("CustomizeMenuConnectionsSettings",(()=>o.e(8872).then(o.bind(o,44987)))),Ce=(0,ue.kF)(ve,(e=>e.CustomizeMenuConnectionsSettings));var be=o(212534),je=o(330117),we=o(434859),Me=o(658421),_e=o(319385),ke=o(636857),Ve=(o(252262),o(324506),o(701302)),Te=o(239132),Pe=o(561061),Ie=o(844495),Fe=o(95371),Ze=o(401898),Ae=o(316956),Be=o(730188),Ke=o(51592),Oe=o(110906),Le=o(661519),Re=o(164369),De=o(566890),ze=o(730459),Ne=o(397004);var Ee=o(277181),He=o(981166),Ue=o(729376),We=o(61766),Ge=o(18533),$e=o(784242),qe=o(308505),Qe=o(605210);function Xe(e){const{propertyName:t,newDesign:o,subitemsDisplayMode:i,inversePropertyName:n}=e,r=(0,f.yK)((e=>({togglePreviewParentIcon:{color:e.regularIconColor},togglePreviewChildIcon:{color:e.mediumIconColor,marginLeft:"24px"},togglePreviewRowWithDivider:{padding:"4px",margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center",borderBottom:`1px solid ${e.regularDividerColor}`},togglePreviewRow:{padding:"4px",margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center"},togglePreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:"4px",alignItems:"center",...o?{fontWeight:I.Z.fontWeight.medium,backgroundColor:e.accentColors.gray[30],padding:"9px 0"}:{}},parentItemIcon:{color:e.mediumIconColor,width:14,height:14,marginRight:4},parentWrapper:{paddingLeft:8,display:"inline-flex",alignItems:"center"},parentTitle:{textOverflow:"ellipsis",overflow:"hidden",color:e.lightTextColor,fontWeight:I.Z.fontWeight.medium,fontSize:I.Z.fontSize.UISmall.desktop,whiteSpace:"nowrap"},subItemIcon:{color:e.mediumIconColor,width:14,height:14,marginRight:4},subItemWrapper:{display:"inline-flex",alignItems:"center",paddingLeft:8,paddingRight:4,verticalAlign:"text-top"},numSubitemsSpan:{color:e.lightTextColor,fontWeight:I.Z.fontWeight.medium,fontSize:I.Z.fontSize.UISmall.desktop}})),[o]),s=(0,C.jsx)("span",{children:"🐔"}),a=(0,C.jsx)("span",{children:"🐣"}),l={show:[s,a,a],hidden:[s,(0,C.jsx)("span",{children:"🐮"}),(0,C.jsx)("span",{children:"🐷"})],flattened:[s,a,a]},c={show:[n,t,t],hidden:[n,n,n],flattened:[n,t,t]};function d(e){return(0,C.jsxs)("span",{style:r.subItemWrapper,children:[(0,qe.S)(r.subItemIcon),(0,C.jsx)("span",{style:r.numSubitemsSpan,children:e})]})}function u(){return(0,C.jsxs)("span",{style:r.parentWrapper,children:[(0,$e.v)(r.parentItemIcon),(0,C.jsx)("span",{style:r.parentTitle,children:n})]})}function p(e,t,o){return(0,C.jsxs)("div",{style:2===t?{...r.togglePreviewRow}:{...r.togglePreviewRowWithDivider},children:["show"===e&&(0,C.jsx)(Qe.Z,{isSidebar:!1,open:!1,fill:!0,onClick:()=>{},style:0===t?r.togglePreviewParentIcon:r.togglePreviewChildIcon,disabled:!0}),(i=c[e][t],n=l[e][t],(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)("span",{style:{marginRight:"5px"},children:[" ",n]}),i]})),o]});var i,n}function g(e){return"flattened"===e?(0,C.jsxs)(C.Fragment,{children:[p(e,0),p(e,1,u()),p(e,2,u())]}):"hidden"===e?(0,C.jsxs)(C.Fragment,{children:[p(e,0,d(2)),p(e,1),p(e,2,d(1))]}):(0,C.jsxs)(C.Fragment,{children:[p("show",0),p("show",1),p("show",2)]})}return m=i,(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(U.Z,{disableMobileBorders:!0,children:(0,C.jsx)("div",{style:r.togglePreviewOutsideBorder,children:g(m)})})});var m}var Ye=o(42550),Je=o(507443),et=o(337137);function tt(e){const{collectionContextStore:t,collectionSettingsStore:o,feature:s,from:a}=e,c=(0,P.useIntl)(),d=(0,n.Fy)(),u=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t]),p=(0,r.VK)((()=>t.databaseType),[t]),g=(0,r.VK)((()=>t.collectionStore()),[t]),m=(0,et.t6)({collectionContextStore:t,feature:s}),S=null==m?void 0:m.property,y=(0,i.useMemo)((()=>Oe.HI(u)),[u]),h=(0,r.VK)((()=>t.permissionScopesStore.state),[t]),x=(0,r.VK)((()=>{var e;return S&&(null===(e=u[S])||void 0===e?void 0:e.name)}),[u,S]),v=(0,r.VK)((()=>t.collectionViewStore()),[t]),b=(0,r.VK)((()=>null==v?void 0:v.getFormat()),[v]),j=(null==b?void 0:b.subitem_display_mode)??"show",w=(0,r.VK)((()=>{const e=S&&u[S];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=u[o])||void 0===t?void 0:t.name:void 0}}),[S,u]),M=(0,r.VK)((()=>{const e=t.collectionStore();return null!=e&&e.isDefined()?Ue.aI(c,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:s}):c.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[t,c,s]),_=(0,r.VK)((()=>Boolean(g&&function(e){const{collectionContextStore:t,collectionStore:o}=e,i=o.getFormat().collection_default_arrows_by,n=t.currentArrowsByFormatStore.state;return!(0,Ze.$K)(n)||n===i}({collectionContextStore:t,collectionStore:g}))),[t,g]),k=(0,r.qz)(void 0,We.Z),V=(0,i.useCallback)((e=>{e&&k.setState({open:!1})}),[k]),{initialPropertyName:T}=(0,et.Ld)({collectionContextStore:t,feature:s}),F=(0,et.he)({collectionContextStore:t,onPropertySelect:V,feature:s}),{handleAddRelation:Z,handleDefaultPropertySelect:B,clearCollectionViewSubitemDisplayMode:K}=F,O=(0,f.yK)((e=>({container:{marginLeft:12,marginRight:12},captionText:{fontSize:d.isMobile?I.Z.fontSize.UISmall.mobile:I.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,fontWeight:I.Z.fontWeight.regular,marginLeft:14},subitemsPreviewContainer:{marginBottom:6,marginLeft:2}})),[d]);if(!g)return null;let L;if("subitem"===s)if(m)L=(0,C.jsxs)(U.Z,{disableMobileBorders:!0,children:[(0,C.jsx)("div",{style:O.subitemsPreviewContainer,children:(0,C.jsx)(Xe,{propertyName:x||T,inversePropertyName:w||M,newDesign:!0,subitemsDisplayMode:j})}),(0,C.jsx)(ct,{databaseType:p,permissionScopes:h}),(0,C.jsx)(Le.Z,{size:12,style:{marginTop:4,marginBottom:4}}),(0,C.jsx)(Je.kJ,{collectionSettingsStore:o,feature:s,permissionScopes:h}),(0,C.jsx)(Je.PC,{feature:s,databaseType:p,permissionScopes:h,propertyName:x,relationPropertyId:S,collectionContextStore:t,collectionSettingsStore:o,handleDefaultPropertySelect:B,inversePropertyName:w,clearCollectionViewSubitemDisplayMode:K})]});else{const e=()=>{Z({featureType:"subitem",from:a}),l.z$({collectionSettingsStore:o}),Ve.default.afterNextFlush((()=>{const e=t.subitemTreeStore.getState(),o=t.resultsInViewOrder(1).at(0),i=(0,Fe.DY)(e.children,(e=>e.value.store===o));if(i){const e=i.map((e=>e.value.store.pointer)),o=(0,Ee.Af)(e);Be.rT({collectionContextStore:t,pathKey:o})}}))};L=(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Xe,{propertyName:x||T,inversePropertyName:w||M,newDesign:!0,subitemsDisplayMode:j}),(0,C.jsx)(Je.Fz,{feature:s,permissionScopes:h,databaseType:p,handleAddRelation:e})]})}else"timeline_arrows_by"===s?L=m?(0,C.jsxs)(C.Fragment,{children:[_?(0,C.jsx)(it,{collectionContextStore:t,firstDatePropertyId:y,permissionScopes:h}):(0,C.jsx)(ot,{collectionContextStore:t,databaseType:p}),(0,C.jsxs)(U.Z,{topBorder:!0,children:[(0,C.jsx)(Je.kJ,{collectionSettingsStore:o,feature:s,permissionScopes:h}),(0,C.jsx)(rt,{feature:s,databaseType:p,featuredRelationProperty:m,actions:F,permissionScopes:h}),(0,C.jsx)(Je.PC,{feature:s,databaseType:p,permissionScopes:h,relationPropertyId:S,propertyName:x,inversePropertyName:w,collectionContextStore:t,collectionSettingsStore:o,handleDefaultPropertySelect:B})]})]}):(0,C.jsx)(nt,{databaseType:p,collectionContextStore:t,firstDatePropertyId:y,handleAddRelation:Z,permissionScopes:h,from:a}):(0,Ze.t1)(s);const R=(0,He.Gt)({feature:s,databaseType:p}),D=(0,He.qi)({feature:s,databaseType:p});return(0,C.jsxs)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{...R}),children:[(0,C.jsx)(U.Z,{disableMobileBorders:!0,children:(0,C.jsx)("div",{style:{...O.container,...O.captionText},children:(0,C.jsx)(P.FormattedMessage,{...D})})}),L]})}function ot(e){const{collectionContextStore:t,databaseType:o}=e,i=(0,n.MO)(),s=(0,f.yK)((e=>({wrap:{boxShadow:e.plainButtonBoxShadow,...i?{backgroundColor:e.sidebarBackground,margin:void 0,borderRadius:void 0}:{background:"rgba(196, 196, 196, 0.13)",marginTop:14,marginBottom:20}},iconWithMessage:{display:"flex",gap:8},icon:{width:14,height:14,position:"relative",top:1,color:e.mediumTextColor}})),[i]),a=(0,r.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getNormalizedDependencyDateShiftingConfig()}),[t]),l=(0,He.uM)({currentDateShiftConfig:a,databaseType:o});return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(U.Z,{title:(0,C.jsx)(P.FormattedMessage,{...He.dH.dateShiftingSectionCaption}),children:(0,C.jsx)(Ye.O,{mode:null==a?void 0:a.mode})}),(0,C.jsx)(K.P,{style:s.wrap,showCloseButton:!1,children:(0,C.jsxs)("div",{style:s.iconWithMessage,children:[(0,Ie.D)(s.icon),(0,C.jsx)(Re.Z,{isSmall:!0,isMultiline:!0,children:(0,C.jsx)(P.FormattedMessage,{...l})})]})})]})}function it(e){const{collectionContextStore:t,firstDatePropertyId:o,permissionScopes:s}=e,a=(0,n.O7)(),l=(0,P.useIntl)(),c=(0,r.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getNormalizedDependencyDateShiftingConfig()}),[t]),u=(0,i.useCallback)((e=>{const o=t.collectionStore();o&&d.createAndCommit({userAction:"FeatureEnabledDependenciesSection.handleConfigChange",environment:a,perform:t=>{(0,Je.pK)({collectionStore:o,environment:a,intl:l,newConfig:e,transaction:t})}})}),[t,a,l]),p=(0,i.useMemo)((()=>({configWithoutDates:c,...c?{datePropertyId:c.date_property,endDatePropertyId:c.end_date_property}:{datePropertyId:o}})),[c,o]);return(0,C.jsx)(Je.$z,{collectionContextStore:t,currentConfig:p,disabled:!s.canConfigureBlock||!s.canConfigureCollection,onConfigChange:u})}function nt(e){const{collectionContextStore:t,handleAddRelation:o,firstDatePropertyId:n,permissionScopes:s,databaseType:a,from:c}=e,[d,u]=(0,i.useState)({datePropertyId:n,configWithoutDates:{mode:Je.zk,avoid_weekends:Je.Yi}}),p=(0,r.VK)((()=>t.settingsStore),[t]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Je.$z,{collectionContextStore:t,currentConfig:d,disabled:!s.canConfigureBlock||!s.canConfigureCollection,onConfigChange:u}),(0,C.jsx)(Je.Fz,{feature:"timeline_arrows_by",permissionScopes:s,databaseType:a,handleAddRelation:()=>{o({featureType:"timeline_arrows_by",dateShiftingConfig:d,from:c}),l.z$({collectionSettingsStore:p})}})]})}function rt(e){const{feature:t,featuredRelationProperty:o,actions:i,permissionScopes:r,databaseType:s}=e,a=(0,n.Fy)(),l=(0,f.yK)((()=>({eyeHideIcon:{width:20,height:a.isMobile?24:12,marginLeft:3}})),[a]);if(!o.supportedInView)return null;const c=o.enabledOnView,d=o.isVisibleInView,u=d?{icon:Pe.B,iconStyle:l.eyeHideIcon}:{icon:Te.c};return(0,C.jsx)(B.Z,{...u,onClick:()=>{i.handlePropertySelect(c?void 0:o.property)},title:(0,C.jsx)(P.FormattedMessage,{...(0,He.cn)({feature:t,isOn:d,databaseType:s})}),disabled:!r.canConfigureBlock})}function st(e){const{subitemDisplayMode:t,collectionViewType:o,intl:i,databaseType:n}=e;if("show"===t)switch(o){case"board":case"calendar":case"gallery":return i.formatMessage({id:"getTitleForSubitemDisplayModeMenuItem.onCard",defaultMessage:"Card property"});case"table":case"list":case"timeline":case"page":return i.formatMessage({id:"getTitleForSubitemDisplayModeMenuItem.nestedInToggle",defaultMessage:"Nested in toggle"})}else{if("hidden"===t)return i.formatMessage({id:"subitemDisplayModeMenuItemTitle.hideSubitems",defaultMessage:"Parents only"},{items:(0,Ke.Q_)(n,!0)});if("flattened"===t)return i.formatMessage({id:"subitemDisplayModeMenuItemTitle.flattenedList",defaultMessage:"Flattened list"});(0,Ze.t1)(t)}}const at=["show","hidden","flattened"];function lt(e){const{intl:t,collectionViewType:o,databaseType:i}=e;return at.map((e=>({key:e,title:st({intl:t,collectionViewType:o,subitemDisplayMode:e,databaseType:i})})))}function ct(e){const{databaseType:t,permissionScopes:o}=e,s=(0,P.useIntl)(),a=(0,De.Y$)(),l=(0,r.VK)((()=>a.collectionViewStore()),[a]),u=(0,r.VK)((()=>null==l?void 0:l.getFormat()),[l]),p=(null==u?void 0:u.subitem_display_mode)??"show",g="show"===p,m=(0,n.O7)(),f=i.useCallback((e=>{const t=a.getPropertyFormatKey(),o=(0,Ee.wf)(a),i=null==o?void 0:o.property,n=null==o?void 0:o.inverse;l&&t&&i&&n&&e&&e!==p&&d.createAndCommit({userAction:"actionRegistry.updateCollectionViewSubitemDisplayMode",environment:m,perform:o=>{const r=l.getType(),s="board"===r||"gallery"===r||"calendar"===r;if(Ae.er({formatStore:l,formatKey:t,property:i,update:{visible:s&&"show"===e},transaction:o}),"hidden"===p){var a;const e=null==u||null===(a=u.property_filters)||void 0===a?void 0:a.filter((e=>e.id!==Ne.OC));c.FH({stores:[l],update:{property_filters:e},transaction:o})}if("hidden"===e){const e={property:n,filter:{operator:"is_empty"}},t=(null==u?void 0:u.property_filters)||[];c.FH({stores:[l],update:{property_filters:[...t,{id:Ne.OC,filter:e}]},transaction:o})}c.FH({stores:[l],update:{subitem_display_mode:e},transaction:o})}})}),[a,l,m,u,p]);(0,i.useEffect)((()=>{ze.K4(m,"configure_subitem_display_mode",{userAction:g?"CollectionSettingsViewRelationFeatures.configureSubitemDisplayMode.flattened":"CollectionSettingsViewRelationFeatures.configureSubitemDisplayMode.show"})}),[g,m]);const S=(0,r.VK)((()=>(null==l?void 0:l.getType())??"table"),[l]);return"chart"===S||"form_editor"===S?(0,C.jsx)(C.Fragment,{}):(0,C.jsx)(Ge.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Show as",id:"SubitemDisplayModeMenuItem.menuItemTitle"}),collectionContextStore:a,selectedKey:p,options:lt({collectionViewType:S,intl:s,databaseType:t}),onChange:e=>f(e),disabled:!o.canConfigureBlock})}var dt=o(500091),ut=o(108406),pt=o(680402),gt=o(824006),mt=o(467263);const ft="box1-filter",St="box2-filter";function yt(e){const{propertyName:t,inversePropertyName:o}=e,i=(0,f.Fg)(),n=(0,f.yK)((e=>({svgWrap:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:"center",position:"relative",height:112,backgroundColor:e.accentColors.gray[30],display:"flex",justifyContent:"center"}})),[]);return(0,C.jsx)(U.Z,{disableMobileBorders:!0,children:(0,C.jsx)("div",{style:n.svgWrap,children:(0,C.jsxs)("svg",{width:"266",height:"116",fill:"none",children:[(0,C.jsx)("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M124 20h.426c7.703 0 17.307-.002 25.029 1.93 3.979.994 8.078 2.638 11.248 5.575C164.082 30.635 166 34.868 166 40c0 8.001-6.095 12.917-11.524 15.932-5.553 3.086-12.74 5.481-19.23 7.644l-.349.116c-6.919 2.307-13.074 4.381-17.546 6.866C112.655 73.166 112 75 112 76c0 1.868.582 2.885 1.453 3.692 1.08 1.001 2.981 1.982 6.002 2.737C125.59 83.963 132.773 84 141 84"}),(0,C.jsx)("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M125 32c8.227 0 15.41.037 21.545 1.57 3.021.756 4.922 1.737 6.002 2.738.871.807 1.453 1.824 1.453 3.692 0 .999-.655 2.834-5.351 5.443-4.472 2.484-10.627 4.558-17.546 6.865l-.349.116c-6.49 2.163-13.677 4.558-19.23 7.644C106.095 63.084 100 67.998 100 76c0 5.132 1.918 9.365 5.297 12.495 3.17 2.937 7.269 4.581 11.248 5.576C124.267 96 133.871 96 141.574 96H142"}),(0,C.jsx)("path",{fill:i.accentColors.gray[30],d:"M157 27h16v18h-16zM92 70h16v18H92z"}),(0,C.jsx)("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M136 88l5-4-5-4"}),(0,C.jsx)("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M130 36l-5-4 5-4"}),(0,C.jsxs)("g",{filter:`url(#${ft})`,children:[(0,C.jsx)("rect",{width:"100",height:"28",x:"24",y:"12",fill:i.buttonBackground,rx:"3"}),(0,C.jsx)("text",{x:"67",y:"31",fill:"#000",children:"🌱"})]}),(0,C.jsxs)("g",{filter:`url(#${St})`,children:[(0,C.jsx)("rect",{width:"100",height:"28",x:"142",y:"76",fill:i.buttonBackground,rx:"3"}),(0,C.jsx)("text",{x:"185",y:"95",fill:"#000",children:"🌳"})]}),(0,C.jsx)(ht,{x:"161",y:"26",width:"100",height:"16",textStyles:{fontSize:12,fontWeight:590,color:i.regularTextColor},children:t}),(0,C.jsx)(ht,{x:"15",y:"69",width:"90",height:"16",textStyles:{color:i.lightTextColor,fontSize:12,fontWeight:500,textAlign:"right"},children:o}),(0,C.jsxs)("defs",{children:[(0,C.jsxs)("filter",{id:ft,width:"108",height:"36",x:"20",y:"10",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,C.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,C.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,C.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_1034_52436"}),(0,C.jsx)("feOffset",{}),(0,C.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,C.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,C.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1034_52436"}),(0,C.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,C.jsx)("feOffset",{dy:"2"}),(0,C.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,C.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,C.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,C.jsx)("feBlend",{in2:"effect1_dropShadow_1034_52436",result:"effect2_dropShadow_1034_52436"}),(0,C.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1034_52436",result:"shape"})]}),(0,C.jsxs)("filter",{id:St,width:"108",height:"36",x:"138",y:"74",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,C.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,C.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,C.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_1034_52436"}),(0,C.jsx)("feOffset",{}),(0,C.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,C.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,C.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1034_52436"}),(0,C.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,C.jsx)("feOffset",{dy:"2"}),(0,C.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,C.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,C.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,C.jsx)("feBlend",{in2:"effect1_dropShadow_1034_52436",result:"effect2_dropShadow_1034_52436"}),(0,C.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1034_52436",result:"shape"})]})]})]})})})}function ht(e){const{children:t,textStyles:o,...i}=e;return(0,C.jsx)("foreignObject",{...i,children:(0,C.jsx)("div",{style:{...I.Z.textOverflowStyle,...i.width?{width:Number(i.width)}:{},...o},children:t})})}var xt=o(295314);function vt(e){var t;const{collectionContextStore:o,feature:n}=e,s=(0,P.useIntl)(),a=(0,r.VK)((()=>o.collectionStore()),[o]),l=(0,r.VK)((()=>o.normalizedSchemaStore.state),[o]),c=(0,r.VK)((()=>o.permissionScopesStore.state),[o]),d=null===(t=(0,et.t6)({collectionContextStore:o,feature:n}))||void 0===t?void 0:t.property,u=(0,r.VK)((()=>{var e;return d&&(null===(e=l[d])||void 0===e?void 0:e.name)}),[d,l]),p=(0,r.VK)((()=>{var e;return"table"===(null===(e=o.collectionViewStore())||void 0===e?void 0:e.getType())}),[o]),g=(0,r.VK)((()=>{const e=d&&l[d];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=l[o])||void 0===t?void 0:t.name:void 0}}),[d,l]),m=(0,r.VK)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?Ue.aI(s,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:n}):s.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[o,s,n]),S=(0,r.qz)(void 0,We.Z),{initialPropertyName:y}=(0,et.Ld)({collectionContextStore:o,feature:n}),h=(0,i.useCallback)((e=>{e&&S.setState({open:!1})}),[S]),x=(0,f.yK)((()=>({previewContainer:{marginLeft:2}})),[]);if(!a)return null;let v;return"subitem"===n?v=(0,C.jsx)(Xe,{propertyName:u||y,inversePropertyName:g||m,newDesign:!0,subitemsDisplayMode:"show"}):"timeline_arrows_by"===n?v=(0,C.jsx)(yt,{propertyName:u||y,inversePropertyName:g||m}):(0,Ze.t1)(n),(0,C.jsxs)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{...He.dH.advancedSettings}),children:[(0,C.jsx)("div",{style:x.previewContainer,children:v}),(0,C.jsxs)(U.Z,{disableMobileBorders:!0,children:[(0,C.jsx)(xt.I,{currentPropertyId:d,feature:n,onPropertySelect:h,buttonPopupStore:S,collectionContextStore:o,permissionScopes:c,disabled:!c.canConfigureCollection}),"subitem"===n&&p&&(0,C.jsx)(Ct,{collectionContextStore:o,permissionScopes:c})]})]})}function Ct(e){const{collectionContextStore:t,permissionScopes:o}=e,s=(0,P.useIntl)(),a=(0,n.O7)(),l=(0,r.VK)((()=>"title"===t.normalizedFormatStore.state.table_subitem_toggle_column),[t]),c=!o.canConfigureBlock,d=(0,i.useCallback)((()=>{const e=t.collectionViewStore();e&&(pt.d1({environment:a,collectionViewStore:e,currentValue:t.normalizedFormatStore.state.table_subitem_toggle_column}),ut.wd({environment:a,collectionContextStore:t,action:"toggle_table_subitem_toggle_on_title"}))}),[t,a]);return(0,C.jsx)(mt.Z,{showImage:o.canConfigureBlock,caption:s.formatMessage(He.dH.toggleNestingOnTitleMenuItemTooltip),tooltipImage:S.Z.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>(0,C.jsx)(B.Z,{...e,icon:e=>(0,dt.L)({width:11,height:11,marginRight:5,marginLeft:6,transform:"rotateZ(180deg)"}),onClick:d,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),right:(0,C.jsx)(gt.Z,{disallowTabbing:!0,on:l,disabled:c,onClick:d}),disabled:c})})}var bt=o(247025),jt=o(164945),wt=o(866196),Mt=o(713498),_t=o(396451),kt=o(44643),Vt=o(484199),Tt=o(155159),Pt=o(653965),It=o(709953),Ft=o(740040),Zt=o(82902),At=o(183357),Bt=o(675529),Kt=o(304361);function Ot(e){let{collectionViewStore:t,chartConfig:o,disabled:s}=e;const a=(0,n.O7)(),l=(0,r.VK)((()=>{var e;return(null==o||null===(e=o.chartFormat)||void 0===e?void 0:e.weightColorValue)??!1}),[o]),c=(0,i.useCallback)((()=>{var e;const i=Pt.Xh(o);i.chartFormat||(i.chartFormat={weightColorValue:!1}),i.chartFormat.weightColorValue=!(null!==(e=o.chartFormat)&&void 0!==e&&e.weightColorValue),d.createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,perform:e=>{It.sW({store:t.getFormatStore().getKeyStore("chart_config"),data:i,transaction:e})}})}),[o,t,a]);return(0,C.jsx)(Kt.Z,{title:(0,C.jsx)(P.FormattedMessage,{...At.OV.chartWeightColorValue}),showChevron:!1,switcherProps:{on:l},icon:Tt.J,onClick:c,disabled:s})}function Lt(e){let{collectionViewStore:t,chartConfig:o,disabled:s}=e;const a=(0,n.O7)(),l=(0,r.VK)((()=>{var e;const t=null==o||null===(e=o.chartFormat)||void 0===e?void 0:e.axisGroupStyle;return t||bt.UJ.normal}),[o]),c=(0,i.useCallback)((e=>{const i=Pt.Xh(o);i.chartFormat||(i.chartFormat={axisGroupStyle:bt.UJ.normal}),i.chartFormat.axisGroupStyle=e,d.createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,perform:e=>{It.sW({store:t.getFormatStore(),data:{chart_config:i},transaction:e})}})}),[o,t,a]),u=(0,f.yK)((()=>({menuItem:{...I.Z.textOverflowStyle}})),[]),p=(0,i.useMemo)((()=>Object.entries(At.E4).map((e=>{let[t,o]=e;return{key:t,title:(0,C.jsx)("div",{style:u.menuItem,children:(0,C.jsx)(P.FormattedMessage,{...o})})}}))),[u.menuItem]);return(0,C.jsx)(Ge.Z,{title:(0,C.jsx)(P.FormattedMessage,{...At.OV.chartGroupStyle}),selectedKey:l,options:p,icon:wt.B,onChange:c,disabled:s})}function Rt(e){let{collectionViewStore:t,chartConfig:o,disabled:s}=e;const a=(0,n.O7)(),l=(0,r.VK)((()=>{var e;const t=null==o||null===(e=o.chartFormat)||void 0===e?void 0:e.axisGridLine;return t||"horizontal"}),[o]),c=(0,i.useCallback)((e=>{const i=Pt.Xh(o);i.chartFormat||(i.chartFormat={axisGridLine:bt.Xm.horizontal}),i.chartFormat.axisGridLine=e,d.createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,perform:e=>{It.sW({store:t.getFormatStore(),data:{chart_config:i},transaction:e})}})}),[o,t,a]),u=(0,f.yK)((()=>({menuItem:{...I.Z.textOverflowStyle}})),[]),p=(0,i.useMemo)((()=>Object.entries(At.s8).map((e=>{let[t,o]=e;return{key:t,title:(0,C.jsx)("div",{style:u.menuItem,children:(0,C.jsx)(P.FormattedMessage,{...o})})}}))),[u.menuItem]);return(0,C.jsx)(Ge.Z,{title:(0,C.jsx)(P.FormattedMessage,{...At.OV.chartGridLine}),selectedKey:l,options:p,icon:Mt.a,onChange:c,disabled:s})}function Dt(e){let{collectionViewStore:t,chartConfig:o,disabled:s}=e;const a=(0,n.O7)(),l=(0,r.VK)((()=>{var e;const t=null==o||null===(e=o.chartFormat)||void 0===e?void 0:e.axisLabel;return t||bt.Xg.none}),[o]),c=(0,i.useCallback)((e=>{const i=Pt.Xh(o);i.chartFormat||(i.chartFormat={axisLabel:bt.Xg.none}),i.chartFormat.axisLabel=e,d.createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,perform:e=>{It.sW({store:t.getFormatStore(),data:{chart_config:i},transaction:e})}})}),[o,t,a]),u=(0,f.yK)((()=>({menuItem:{...I.Z.textOverflowStyle}})),[]),p=(0,i.useMemo)((()=>Object.entries(At.li).map((e=>{let[t,o]=e;return{key:t,title:(0,C.jsx)("div",{style:u.menuItem,children:(0,C.jsx)(P.FormattedMessage,{...o})})}}))),[u.menuItem]);return(0,C.jsx)(Ge.Z,{title:(0,C.jsx)(P.FormattedMessage,{...At.OV.chartAxisName}),selectedKey:l,options:p,icon:wt.B,onChange:c,disabled:s})}function zt(e){var t;let{collectionViewStore:o,chartConfig:r,disabled:s}=e;const a=(0,n.O7)(),l=(0,i.useMemo)((()=>{var e;return!(null!=r&&null!==(e=r.chartFormat)&&void 0!==e&&e.hideLineFillArea)}),[null==r||null===(t=r.chartFormat)||void 0===t?void 0:t.hideLineFillArea]),c=(0,i.useCallback)((()=>{var e;const t=Pt.Xh(r);t.chartFormat||(t.chartFormat={hideLineFillArea:!1}),t.chartFormat.hideLineFillArea=!(null!==(e=r.chartFormat)&&void 0!==e&&e.hideLineFillArea),d.createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,perform:e=>{It.sW({store:o.getFormatStore().getKeyStore("chart_config"),data:t,transaction:e})}})}),[r,o,a]);return(0,C.jsx)(Kt.Z,{title:(0,C.jsx)(P.FormattedMessage,{...At.OV.chartLineFillArea}),showChevron:!1,switcherProps:{on:l},icon:Vt.N,onClick:c,disabled:s})}function Nt(e){var t;let{collectionViewStore:o,chartConfig:r,disabled:s}=e;const a=(0,n.O7)(),l=(0,i.useMemo)((()=>{var e;return!(null!=r&&null!==(e=r.chartFormat)&&void 0!==e&&e.donutHideValue)}),[null==r||null===(t=r.chartFormat)||void 0===t?void 0:t.donutHideValue]),c=(0,i.useCallback)((()=>{var e;const t=Pt.Xh(r);t.chartFormat||(t.chartFormat={donutHideValue:!1}),t.chartFormat.donutHideValue=!(null!==(e=r.chartFormat)&&void 0!==e&&e.donutHideValue),d.createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,perform:e=>{It.sW({store:o.getFormatStore().getKeyStore("chart_config"),data:t,transaction:e})}})}),[r,o,a]);return(0,C.jsx)(Kt.Z,{title:(0,C.jsx)(P.FormattedMessage,{...At.OV.chartShowDonutValue}),showChevron:!1,switcherProps:{on:l},icon:_t.k,onClick:c,disabled:s})}function Et(e){let{collectionViewStore:t,chartConfig:o,disabled:s}=e;const a=(0,n.O7)(),l=(0,Zt.bc)(o),c=(0,r.VK)((()=>{var e;return!(null!=o&&null!==(e=o.chartFormat)&&void 0!==e&&e.hideLegend||l)}),[o,l]),u=s||l,p=(0,i.useCallback)((()=>{var e;const i=Pt.Xh(o);i.chartFormat||(i.chartFormat={hideLegend:!1}),i.chartFormat.hideLegend=!(null!==(e=o.chartFormat)&&void 0!==e&&e.hideLegend),d.createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,perform:e=>{It.sW({store:t.getFormatStore().getKeyStore("chart_config"),data:i,transaction:e})}})}),[o,t,a]);return(0,C.jsx)(Kt.Z,{title:(0,C.jsx)(P.FormattedMessage,{...At.OV.chartLegend}),showChevron:!1,switcherProps:{on:c},icon:Vt.N,onClick:p,disabled:u})}function Ht(e){let{collectionViewStore:t,chartConfig:o,disabled:s}=e;const a=(0,n.O7)(),l=(0,r.VK)((()=>{var e;return Boolean(null==o||null===(e=o.chartFormat)||void 0===e?void 0:e.axisHideEmptyGroups)}),[o]),c=(0,i.useCallback)((()=>{const e=Pt.Xh(o);e.chartFormat={...e.chartFormat,axisHideEmptyGroups:!l},d.createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,perform:o=>{It.sW({store:t.getFormatStore().getKeyStore("chart_config"),data:e,transaction:o})}})}),[o,t,a,l]);return(0,C.jsx)(Kt.Z,{title:(0,C.jsx)(P.FormattedMessage,{...At.OV.chartHideEmptyGroups}),showChevron:!1,switcherProps:{on:l},onClick:c,icon:kt.L,disabled:s})}const Ut=function(e){var t;const{collectionContextStore:o}=e,i=(0,r.VK)((()=>_e.default.checkGate({gateName:"charts_next"})),[]),n=(0,r.VK)((()=>o.collectionViewStore()),[o]),s=(0,r.VK)((()=>o.normalizedFormatStore.state.chart_config),[o]),a=(0,r.VK)((()=>o.permissionScopesStore.state),[o.permissionScopesStore]);if("placeholder"===s.type)return null;const l=!s||!a.canConfigureBlock;return(0,C.jsxs)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{...At.OV.chartStyleTitle}),footer:(0,C.jsx)("div",{style:{marginBottom:8}}),children:[i?null:(0,C.jsx)(Bt.b,{collectionViewStore:n,chartConfig:s,disabled:l}),"line"===s.type&&(0,C.jsx)(zt,{collectionViewStore:n,chartConfig:s,disabled:l}),"donut"===s.type&&(0,C.jsx)(Nt,{collectionViewStore:n,chartConfig:s,disabled:l}),(0,Ft.GL)((null===(t=s.chartFormat)||void 0===t?void 0:t.colorTheme)||"auto")&&"line"!==s.type&&(0,C.jsx)(Ot,{collectionViewStore:n,chartConfig:s,disabled:l}),(0,jt.u)(s)&&"groups_reducer"===s.dataConfig.type&&s.dataConfig.aggregationConfig.stackOptions&&(0,C.jsx)(Lt,{collectionViewStore:n,chartConfig:s,disabled:l}),(0,jt.u)(s)&&(0,C.jsx)(Rt,{collectionViewStore:n,chartConfig:s,disabled:l}),(0,jt.u)(s)&&(0,C.jsx)(Dt,{collectionViewStore:n,chartConfig:s,disabled:l}),(0,C.jsx)(Et,{collectionViewStore:n,chartConfig:s,disabled:l}),(0,jt.u)(s)&&!i?(0,C.jsx)(Ht,{collectionViewStore:n,chartConfig:s,disabled:l}):null]})};var Wt=o(747453),Gt=o(389475),$t=o(526388),qt=o(98742),Qt=o(825464),Xt=o(530874);function Yt(e){const{integration:t,collectionSettingsStore:o,collectionContextStore:i,onAccountSelect:s}=e,a=(0,f.yK)((()=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"}})),[]),c=(0,n.O7)(),d=(0,r.VK)((()=>{var e;return null===(e=i.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[i]),u=(0,r.VK)((()=>{const e=Xt.Z.state;return e.loaded?e.externalAuthentications.filter((e=>e.integration_id===t.id)):[]}),[t]);return t&&d?(0,C.jsx)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Choose an account",id:"collectionSettingsAccountPicker.title"}),footer:Jt({environment:c,integration:t,spaceId:d}),children:(0,C.jsx)("div",{style:a.settingsMenu,children:(0,C.jsx)(N.Z,{type:N.i.Vertical,initialFocus:0,sections:[{key:"externalAuthentications",items:u.map((e=>{const i={key:e.id,render:o=>(0,C.jsx)($t.Z,{renderTooltip:()=>(0,C.jsx)("span",{children:e.account_name}),placement:Qt.u.Left,textWrap:!0,render:i=>(0,C.jsx)(L.Z,{...(0,qt.Z)(i||{},o),title:e.account_name,icon:(0,C.jsx)("img",{style:{width:18},src:t.info.icon}),focused:o.focused})}),action:()=>{l.z$({collectionSettingsStore:o}),s(e)}};return i})),render:e=>(0,C.jsx)(U.Z,{...e})}]})})}):null}function Jt(e){const t=e.environment.device.isMobileBrowser;return(0,C.jsx)(U.Z,{topBorder:!0,children:t?void 0:eo(e)})}function eo(e){return(0,C.jsx)(B.Z,{...e,icon:Wt.R,title:(0,C.jsx)(P.FormattedMessage,{id:"collectionSettingsAccountPicker.addAccount",defaultMessage:"Connect another account"}),isGray:!0,onClick:async()=>{await Gt.hM({...e,from:"source_picker_connect_another_account"})}})}var to=o(158573),oo=o(520270),io=o(435840),no=o(531701),ro=o(218265),so=o(757549),ao=o(454642),lo=o(800893),co=o(61202),uo=o(45257),po=o(268894),go=o(953336),mo=o(970764),fo=o(368585),So=o(433929),yo=o(80444);function ho(e){const{onClick:t,integration:o,accountName:i}=e,n=(0,f.yK)((e=>({accountSelection:{padding:"8px",borderTop:`1px solid ${e.regularDividerColor}`,cursor:"pointer"},accountSelectionLabel:{fontWeight:I.Z.fontWeight.medium,paddingLeft:4,paddingTop:4}})),[]);return(0,C.jsx)("div",{style:n.accountSelection,children:(0,C.jsxs)("div",{onClick:t,children:[(0,C.jsx)(Re.Z,{isSecondaryColor:!0,isSmall:!0,style:n.accountSelectionLabel,children:(0,C.jsx)(P.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.currentAccountSection.label",defaultMessage:"Connected to {integration}",values:{integration:o.name}})}),(0,C.jsx)($t.Z,{renderTooltip:()=>(0,C.jsx)("span",{children:i}),placement:Qt.u.Left,textWrap:!0,render:t=>(0,C.jsx)(L.Z,{showExtensionArrow:!0,focused:!1,...(0,qt.Z)(t||{},e),title:i,icon:(0,C.jsx)("img",{style:{width:18},src:o.info.icon})})})]})})}var xo=o(997466);function vo(e,t){const{r:o,g:i,b:n}=(null==e?void 0:e.info.accent_color)||{r:0,g:0,b:0},r=`rgba(${o},${i},${n},${"dark"===t?.6:1})`;return{background:r,hoveredBackground:(0,xo._j)(r,.4),pressedBackground:(0,xo._j)(r,.9)}}var Co=o(489728),bo=o(731278),jo=o(1634);function wo(e){const{collectionContextStore:t,integration:o}=e,i=(0,f.Fg)(),s=(0,r.VK)((()=>t.collectionStore()),[t]),a=(0,r.VK)((()=>null==s?void 0:s.getIcon()),[s]),l=(0,n.O7)(),c=(0,r.VK)((()=>{var e;return null===(e=yo.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),d=(0,f.yK)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"},authenticationBody:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",padding:"0px 16px 16px 16px",textAlign:"center"},settingsMenuSubHeading:{display:"inline",fontSize:14,margin:"4px 20px 20px 20px",color:e.mediumTextColor,textAlign:"center"},settingsMenuAuthenticationButton:{fontSize:14,height:32,color:e.regularInvertedTextColor}})),[]),{background:u,hoveredBackground:p,pressedBackground:g}=vo(o,i.mode);return(0,C.jsx)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Connect to {integration}",id:"collectionSettingsCreateExternalViewPicker.authenticateHeader.title",values:{integration:o.name}}),children:(0,C.jsx)("div",{style:d.settingsMenu,children:(0,C.jsxs)("div",{style:d.authenticationBody,children:[(0,C.jsx)(bo.Z,{disabled:!0,bucket:"secure",store:s,icon:a,size:40,isEmptyPage:!1,style:{marginBottom:6}}),(0,C.jsx)("div",{style:d.settingsMenuSubHeading,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Link your {integration} account for richer content previews and seamless imports.",id:"collectionSettingsCreateExternalViewPicker.authenticateBody.title",values:{integration:o.name}})}),(0,C.jsx)(Co.Z,{onClick:()=>{c&&(Gt.hM({environment:l,integration:o,spaceId:c,from:"placeholder_root_external_collection_view_block"}),jo.Z.reset())},style:{background:u,...d.settingsMenuAuthenticationButton},hoveredStyle:{background:p},pressedStyle:{background:g},children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Connect to {integration}",id:"collectionSettingsCreateExternalViewPicker.authenticateButton.title",values:{integration:o.name}})})]})})})}function Mo(e){const{collectionSettingsStore:t,collectionContextStore:o,externalAuthentication:i}=e,n=(0,r.VK)((()=>o.collectionStore()),[o]),s=(0,r.VK)((()=>{if(!n)return;const e=n.getFormat().integration_id;return Xt.Z.integrations.state.find((t=>t.id===e))}),[n]),a=(0,r.VK)((()=>!!s&&(0,mo.NP)(s.id).length>0),[s]),l=(0,r.VK)((()=>{var e;return null===(e=yo.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]);return n&&l&&s?(0,C.jsx)(C.Fragment,{children:a?(0,C.jsx)(Vo,{...e,collectionContextStore:o,collectionSettingsStore:t,integration:s,externalAuthentication:i}):(0,C.jsx)(wo,{...e,collectionContextStore:o,collectionSettingsStore:t,integration:s})}):null}function _o(e){var t;return null===(t=e.integration.info)||void 0===t||null===(t=t.original_url_patterns)||void 0===t?void 0:t.filter((e=>{var t;return null===(t=e.additional_types)||void 0===t?void 0:t.collection})).find((t=>{let{regex:o}=t;return new RegExp(o).test(e.url)}))}const ko=(0,P.defineMessages)({all:{id:"collectionSettingsCreateExternalViewPicker.filters.all",defaultMessage:"All"},issues:{id:"collectionSettingsCreateExternalViewPicker.filters.issues",defaultMessage:"Issues"},pull_requests:{id:"collectionSettingsCreateExternalViewPicker.filters.pullRequests",defaultMessage:"Pull Requests"},board:{id:"collectionSettingsCreateExternalViewPicker.filters.boards",defaultMessage:"Boards"},project:{id:"collectionSettingsCreateExternalViewPicker.filters.projects",defaultMessage:"Projects"},Releases:{id:"collectionSettingsCreateExternalViewPicker.filters.releases",defaultMessage:"Releases"},"Pull Request":{id:"collectionSettingsCreateExternalViewPicker.filters.PullRequests",defaultMessage:"Pull Requests"},Issues:{id:"collectionSettingsCreateExternalViewPicker.filters.Issues",defaultMessage:"Issues"}});function Vo(e){const{integration:t,collectionContextStore:o,collectionSettingsStore:s,externalAuthentication:a}=e,[c,d]=(0,i.useState)(""),u=(0,r.VK)((()=>{const e=Xt.Z.state;return e.loaded?e.externalAuthentications.filter((e=>e.integration_id===t.id)):[]}),[t]),p=(0,r.VK)((()=>a||(u.length?u[0]:null)),[u,a]),[g,m]=(0,i.useState)(!1),[S,h]=(0,i.useState)(null),x=(0,f.yK)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px"},settingsMenuSearchBox:{background:e.contentBackground,marginBottom:10},syncSourceButton:{width:"100%",display:"flex",justifyContent:"center"},noResults:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.mediumTextColor},suggestionBox:{display:"flex",alignItems:"center",fontSize:12,color:no.ZP.white,background:no.ZP.blue,borderRadius:6,padding:10,boxShadow:e.largeLightBoxShadow,alignSelf:"center",maxWidth:"80%"},errorMessage:{alignSelf:"center",padding:10,fontSize:14,color:e.errorText},syncingData:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.mediumTextColor},filterContainer:{position:"relative",flexGrow:0,overflow:"hidden"},filterContainerScroller:{display:"flex",alignItems:"center",padding:"8px 12px"}})),[]),v=(0,r.VK)((()=>o.collectionStore()),[o]),b=(0,r.VK)((()=>o.collectionViewBlockStore()),[o]),j=(0,n.O7)(),[{value:w,status:M}]=(0,y.r5)((async()=>{if(!p)return;const e=p.parent_id;return ao.listExternalCollections(j,{bot_id:e})}),[j,p]),_="success"===(null==w?void 0:w.type)&&"data"in w.data?w.data.data:[],k="success"===(null==w?void 0:w.type)&&"error"in w.data?w.data.error:null,V=_.filter((e=>!S||e.type===S)),T=V.length?(0,to.ZP)(c,V,(e=>e.title)):[],I=Array.from(new Set(_.map((e=>e.type)))),Z=_o({integration:t,url:c}),B=async e=>{if(m(!0),!v||!b)return;const i=e||c,n=_o({integration:t,url:i});if(!n)return m(!1),void F.showDialog({items:[{label:(0,C.jsx)(P.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.copyDebuggingInformation",defaultMessage:"Copy debugging information"}),color:"blue",onAccept:()=>{lo.RD({environment:j,stringValue:JSON.stringify({botId:null==p?void 0:p.parent_id,url:i},null,2),copiedMessage:lo.tq.copiedToClipboard})}},{label:(0,C.jsx)(P.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.closeButton",defaultMessage:"Close"}),onAccept:()=>{}}],showCancel:!1,keepFocus:!1,message:(0,C.jsx)(P.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.title",defaultMessage:"This source is currently not supported. Please try a different source."})});const r=(0,mo.NP)(t.id);await co.UY({environment:j,url:i,botIds:r.map((e=>e.id)),externalCollectionStore:v,externalCollectionViewBlockStore:b});const{host:a}=(0,ro.Qc)(i);so.Mp(j,{...(0,fo.Pn)(o),integrationId:t.id,type:"collection",entity:n.name,domain:a||"",from:"external_picker_settings"}),l.wl({collectionSettingsStore:s,item:{type:"shareSyncedView",integrationName:t.name,integrationIcon:t.info.icon}}),m(!1)};if(!v||!b)return null;const K=I.length>1?(0,C.jsx)("div",{style:x.filterContainer,children:(0,C.jsxs)(go.Z,{type:we.Z.X,style:x.filterContainerScroller,showLeftRightOverlay:!1,children:[(0,C.jsx)(uo.Z,{title:(0,C.jsx)("span",{children:So.default.formatMessage(ko.all)}),on:!(0,Ze.K0)(S),hideChevron:!0,onClick:e=>{(0,be.ZP)({event:e,context:be.Af.CollectionSettingsClick,callback:()=>{h(null)}})}},"all"),I.map((e=>(0,C.jsx)(uo.Z,{title:(0,C.jsx)("span",{children:So.default.formatMessage(ko[e])}),on:S===e,hideChevron:!0,onClick:t=>{(0,be.ZP)({event:t,context:be.Af.CollectionSettingsClick,callback:()=>{h((t=>t===e?null:e))}})}},e)))]})}):null,O=Z?(0,C.jsx)("div",{style:x.syncSourceButton,children:(0,C.jsx)(H.Z,{isLarge:!0,onClick:e=>{(0,be.ZP)({event:e,context:be.Af.CollectionSettingsClick,callback:()=>{B()}})},disabled:!1,children:(0,C.jsx)(P.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.syncSourceButton.label",defaultMessage:"Sync Source"})})}):null,R=Z||_.length&&T.length?null:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:x.noResults,children:(0,C.jsx)(P.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.noResults.text",defaultMessage:"No results"})}),(0,C.jsxs)("div",{style:x.suggestionBox,children:[(0,Ie.D)({marginRight:8,width:14,height:14}),(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Try different search or paste any {integration} URL",id:"collectionSettingsCreateExternalViewPicker.noResults.help",values:{integration:t.name}})]})]}),D=_.length&&T.length?(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(N.Z,{type:N.i.Vertical,initialFocus:0,sections:[{key:"collections",items:T.map((e=>{const t={key:e.url,render:t=>(0,C.jsx)($t.Z,{renderTooltip:()=>(0,C.jsx)("span",{children:e.title}),placement:Qt.u.Left,textWrap:!0,render:o=>(0,C.jsx)(L.Z,{...(0,qt.Z)(o||{},t),title:e.title,icon:(0,C.jsx)("img",{style:{width:18},src:e.icon}),caption:e.parent.title})}),action:t=>{"stopPropagation"in t.event&&t.event.stopPropagation(),B(e.url)}};return t})),render:e=>(0,C.jsx)(U.Z,{...e,disableMobilePadding:!0})}]})}):null,z="pending"===M||"idle"===M||g;if(!p||k&&(k.status===oo.mQ.UNAUTHORIZED||k.status===oo.mQ.FORBIDDEN))return(0,C.jsx)(wo,{collectionContextStore:o,collectionSettingsStore:s,integration:t});const E="rejected"===M||"failed"===(null==w?void 0:w.type)||k,W=(0,C.jsx)(ho,{onClick:()=>{l.H4({collectionSettingsStore:s,item:{type:"selectAccountForExternalSource",integration:t,onAccountSelect:e=>{l.H4({collectionSettingsStore:s,item:{type:"createSyncedViewSource",externalAuthentication:e}})}}})},integration:t,accountName:p.account_name});return(0,C.jsx)(A.ZP,{...e,footer:O||g?null:W,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Select from {integration}",id:"collectionSettingsCreateExternalViewPicker.title",values:{integration:t.name}}),header:!z&&"resolved"===M&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(po.ZP,{inputLeft:(0,C.jsx)(po.f_,{icon:io.R}),onSubmit:()=>{Z&&B()},style:x.settingsMenuSearchBox,focusInitial:!0,value:c,onChange:e=>{d(e.target.value)},placeholder:"Search source or paste a link..."}),Z?null:K]}),children:(0,C.jsxs)("div",{style:x.settingsMenu,children:[E&&(0,C.jsx)("div",{style:x.errorMessage,children:(0,C.jsx)(P.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.error.unknown",defaultMessage:"Something went wrong.",values:{integration:t.name}})}),z&&(g?(0,C.jsxs)("div",{style:x.syncingData,children:[(0,C.jsx)("span",{children:(0,C.jsx)(P.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.settingUpSync",defaultMessage:"Setting up sync..."})}),(0,C.jsx)(pe.Z,{style:{alignSelf:"center"}})]}):(0,C.jsxs)("div",{style:x.syncingData,children:[(0,C.jsx)("span",{children:(0,C.jsx)(P.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.loadingData",defaultMessage:"Loading available sources..."})}),(0,C.jsx)(pe.Z,{style:{alignSelf:"center"}})]})),!z&&"resolved"===M&&(0,C.jsxs)(C.Fragment,{children:[O,R,D]})]})})}var To=o(379362),Po=o(710274),Io=o(820616),Fo=o(171214),Zo=o(733732),Ao=o(813796);const Bo=function(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,i=(0,P.useIntl)(),s=(0,f.Fg)(),a=(0,n.O7)(),{device:c}=a,u=(0,r.VK)((()=>t.collectionViewStore()),[t]),p=(0,r.VK)((()=>null==u?void 0:u.isDefined()),[u]),g=(0,r.VK)((()=>null==u?void 0:u.getFormat().collection_view_icon),[u]),m=(0,r.VK)((()=>null==u?void 0:u.getType()),[u]);return u&&p?(0,C.jsxs)(A.ZP,{...e,collectionSettingsStore:o,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.title"}),desktopWidth:290,children:[(0,C.jsx)(U.Z,{children:(0,C.jsx)(Fo.I,{initialValue:"",placeholder:i.formatMessage(Ao.L.viewNamePlaceholderMessage),focusInitial:!c.isMobile||void 0,onBlur:e=>Ko(e,a,t),iconButton:{icon:e=>(0,C.jsx)(Io.F,{color:"gray",viewIcon:g,viewType:m,style:{marginRight:6}}),iconStyle:{fill:To.Lr[s.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o){const i=t.collectionViewStore();if(!i||!i.isDefined())return;d.createAndCommit({userAction:"CollectionSettingsCreateView.handleViewIconSubmit",environment:e,perform:e=>{Po.Uy({collectionViewStore:i,icon:o,transaction:e})}}),ut.wd({environment:e,collectionContextStore:t,action:"change_icon",icon:o})}(a,t,e)},onSubmit:e=>function(e,t,o,i){Ko(e,t,i),l.wl({collectionSettingsStore:o,item:{type:"main"}}),ut.wd({environment:t,collectionContextStore:i,action:"rename"})}(e,a,o,t)})}),(0,C.jsx)(Zo.Z,{collectionContextStore:t,collectionSettingsStore:o,showDoneButton:!c.isMobile})]}):null};function Ko(e,t,o){const i=o.collectionViewStore();i&&i.isDefined()&&i.getName()!==e&&d.createAndCommit({userAction:"CollectionSettingsCreateView.handleViewNameBlur",environment:t,perform:t=>{Po.iG({collectionViewStore:i,update:{name:e},transaction:t})}})}var Oo=o(134464),Lo=o(399036),Ro=o(12396),Do=o(355863),zo=o(798963),No=o(926249),Eo=o(793174),Ho=o(573063),Uo=o(828992),Wo=o(966603),Go=o(206258);const $o=(0,P.defineMessages)({delete:{defaultMessage:"Delete",id:"database.deletedProperties.delete"},undo:{defaultMessage:"Undo",id:"database.deletedProperties.undo"}});function qo(e){let{collectionSettingsStore:t,collectionContextStore:o,timelineViewTab:s}=e;const a=(0,n.O7)(),c=(0,f.Fg)(),u=(0,r.VK)((()=>o.normalizedDeletedSchemaStore.state),[o]),p=(0,i.useCallback)((()=>{const e=Object.entries(u).map((e=>{let[t,o]=e;if(o)return{propertyId:t,propertySchema:o}})).filter(Ze.$K);return 0===e.length?(0,C.jsx)(U.Z,{children:(0,C.jsx)(Uo.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.deletedPropertiesTab.noResults"})})}):(0,C.jsx)(U.Z,{children:e.map((e=>{let{propertyId:i,propertySchema:n}=e;return(0,C.jsx)(Uo.Z,{title:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,C.jsx)(Ro.ZP,{type:n.type,icon:n.icon,size:16,theme:c,style:{fill:c.regularIconColor}}),(0,C.jsx)("span",{style:{marginLeft:6,maxWidth:200,...I.Z.textOverflowStyle},children:n.name})]}),right:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Ho.Z,{icon:Do.s,iconStyle:{marginRight:2},ariaLabel:So.default.formatMessage($o.undo),onClick:()=>{!function(e,t,o,i,n){const r=o.collectionStore(),s=(0,Wo.jI)({timelineViewTab:i,collectionContextStore:o});if(r){const o=Oe.D8({deletedSchema:r.getDeletedSchema(),property:e});if(o){var a;if("verification"===(null===(a=r.getDeletedSchema()[e])||void 0===a?void 0:a.type)){const e=r.getSchema(),t=Object.keys(e).some((t=>{var o;return"verification"===(null===(o=e[t])||void 0===o?void 0:o.type)}));if(t)return void F.showDialog({message:(0,C.jsx)(P.FormattedMessage,{id:"database.deletedPropertiesTab.cannotRestoreDuplicateProperty.modal.verification",defaultMessage:"You can only have one verification property."}),showCancel:!1,keepFocus:!0,items:[{label:(0,C.jsx)(P.FormattedMessage,{id:"database.deletedPropertiesTab.cannotRestoreDuplicateProperty.modal.dismissButton",defaultMessage:"Dismiss"}),onAccept:()=>{}}]})}d.createAndCommit({userAction:"CollectionSettingsDeletedProperties.handleRestoreDeletedPropertyClick",environment:n,perform:e=>{Po.xO({environment:n,collectionStore:r,update:o.updateSchema,transaction:e}),Po.$N({collectionStore:r,update:o.updateDeletedSchema,transaction:e})}}),l.z$({collectionSettingsStore:t}),l.H4({collectionSettingsStore:t,item:{type:"property",property:e,formatKey:s}})}}}(i,t,o,s,a)}}),(0,C.jsx)(Ho.Z,{icon:T.y,ariaLabel:So.default.formatMessage($o.delete),onClick:()=>{!async function(e,t,o){const{automationActions:i}=await Eo._1.load();F.showDialog({message:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.deletedPropertiesTab.permanentlyDeleteProperty.modal.prompt",defaultMessage:"Are you sure you want to delete this property?"}),showCancel:!0,keepFocus:!0,items:[{label:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:()=>{const n=t.collectionStore();if(n){const t=function(e,t){const o=e.getDeletedSchema(),i=o[t];if((0,Ze.$K)(i)&&(0,Lo.D1)(i)&&i.automation_id)return Go.Mz.createChildStore(e,{id:i.automation_id,spaceId:e.getSpaceId(),table:zo.cv})}(n,e);d.createAndCommit({userAction:"CollectionSettingsDeletedProperties.handlePermanentlyDeleteDeletedPropertyClick",environment:o,perform:r=>{Po.$N({collectionStore:n,update:{[e]:null},transaction:r}),t&&i.deleteAutomation({automationStore:t,environment:o,transaction:r})}})}}}]})}(i,o,a)}})]})},i)}))})}),[o,t,u,a,c,s]);return(0,C.jsx)(A.ZP,{collectionSettingsStore:t,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Deleted properties",id:"database.viewSettings.propertyTab.deletedTitle"}),children:p()})}const Qo=i.memo(qo,No.Z);var Xo=o(543696),Yo=o(126263),Jo=o(612183),ei=o(184747),ti=o(81234),oi=o(356666),ii=o(668155),ni=o(73657),ri=o(623879),si=o(889014),ai=o(229798);const li=(0,P.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a view…",id:"database.viewSettings.duplicateExistingViewTab.inputPlaceholder"}}),ci=7;function di(e){const{collectionSettingsStore:t,collectionName:o,inputValue:i,menuListItems:r,showMore:s,initialViewType:a,menuListStore:l,onNewEmptyViewClick:c,onBackArrowClick:d,onInputValueChange:u}=e,p=(0,n.O7)(),{device:g}=p,m=(0,f.yK)((e=>({plusIconStyle:{color:e.mediumIconColor}})),[]),S=a?ri.Bh[a].toLocaleLowerCase():void 0,y=S?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"New {viewType} view",id:"database.viewSettings.createViewTab.newView1",values:{viewType:S}}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView2"}),h={key:"emptyViewSection",items:[{key:"emptyViewMenuItem",render:e=>(0,C.jsx)(B.Z,{...e,icon:Wt.R,iconStyle:m.plusIconStyle,title:y}),action:c}],render:e=>(0,C.jsx)(U.Z,{topBorder:i.length>0,...e})},x=(0,C.jsx)(P.FormattedMessage,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"});return(0,C.jsxs)(A.ZP,{collectionSettingsStore:t,title:x,handleBackArrowClick:d,children:[(s>0||i)&&(0,C.jsx)(U.Z,{children:(0,C.jsx)(po.ZP,{focusInitial:!g.isMobile||void 0,value:i,onChange:e=>{u(e.target.value)},placeholder:So.default.formatMessage(li.inputPlaceholder),showClearButton:!0})}),(0,C.jsx)(N.Z,{type:N.i.Vertical,initialFocus:0,sections:Pt.oA([i.length?void 0:h,{key:"results",render:e=>0===r.length?(0,C.jsx)(ni.Z,{caption:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.duplicateExistingViewTab.noResultsTitle"})}):(0,C.jsx)(U.Z,{title:o?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Views on {collectionName}",id:"database.viewSettings.duplicateExistingViewTab.viewsTitle",values:{collectionName:o}}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Existing views",id:"database.viewSettings.duplicateExistingViewTab.viewsTitleExistingViews"}),...e}),items:r},i.length?h:void 0]),store:l})]})}function ui(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,s=(0,n.O7)(),a=(0,i.useMemo)((()=>new Yo.Z({name:"CollectionSettingsDuplicateExistingView"})),[]),c=(0,r.qz)(void 0,ai.Z),[d,u]=(0,i.useState)(""),[p,g]=(0,i.useState)(!0),m=(0,i.useRef)({lastDuplicatedViewId:void 0,didAccept:!1,wentBack:!1,initialViewType:void 0,preselectedViewPointer:void 0}),S=(0,i.useCallback)(((e,o)=>{if(e.id===m.current.lastDuplicatedViewId&&o)return;m.current.lastDuplicatedViewId=e.id;const i=t.collectionViewStore();if(!i)return;let n=i;o&&(n=i.clone(a)),(0,Xo.Vz)({viewToDuplicateStore:e,collectionContextStore:t,collectionViewStore:i,environment:s,temporaryStore:n})}),[t,s,a]);(0,ei.Z)((()=>{const e=t.collectionViewStore();if(!e)return;const o=(0,si.x)(e.id);m.current.preselectedViewPointer=null==o?void 0:o.viewPointer,s.defaultRecordCache.inMemoryRecordCache.addCacheOverride(a),m.current.initialViewType=e.getType()})),(0,ti.L)((()=>{const e=m.current;if(s.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(a),!e.didAccept&&!e.wentBack){const{viewStores:o}=pi(t,d,p),i=o.find((t=>t.id===e.lastDuplicatedViewId));if(!i)return;S(i,!1)}}));const y=(0,i.useCallback)((e=>{e?S(e,!0):(m.current.lastDuplicatedViewId=void 0,a.clearCache())}),[S,a]),h=(0,Jo.y)(y,500);(0,r.VK)((()=>{const e=c.state,{device:o}=s;if(void 0===e.focus.indexLocal||o.isMobile)return;const i=d.length>0;if(!i&&0===e.focus.section||i&&1===e.focus.section)return void h(void 0);const n=pi(t,d,p).viewStores[e.focus.indexLocal];n&&h(n)}),[t,s,h,d,p,c]);const x=(0,i.useCallback)((e=>{s.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(a),ut.wd({environment:s,collectionContextStore:t,action:"click_duplicate_view"}),S(e,!1),l.wl({collectionSettingsStore:o,item:{type:"main",selectViewNameInitial:!0}}),m.current.didAccept=!0}),[t,o,S,s,a]),v=(0,i.useCallback)((()=>{ut.wd({environment:s,collectionContextStore:t,action:"click_new_empty_view"}),l.E3({collectionSettingsStore:o}),l.H4({collectionSettingsStore:o,item:{type:"createView"}}),m.current.didAccept=!0}),[t,o,s]),{viewStores:b,showMore:j}=(0,r.VK)((()=>pi(t,d,p)),[t,d,p]),w=(0,f.Fg)(),M=(0,r.VK)((()=>{var e;return function(e){const{theme:t,viewStores:o,showMore:i,preselectedViewPointerId:n,onDuplicateViewAccept:r,onShowMore:s}=e,a=Pt.oA(o.map((e=>{const t=e.getType(),o=e.getFormat().collection_view_icon;if(!t||"page"===t)return;const i=e.getName(),s=e.id,a={key:s,render:e=>(0,C.jsx)(L.Z,{...e,title:(0,C.jsx)(ii.Z,{collectionViewType:t,collectionViewName:i}),icon:(0,C.jsx)(Io.F,{color:"regular",viewIcon:o,viewType:t,style:{marginRight:4,marginLeft:2}}),checkState:n===s}),action:()=>{r(e)}};return a})));if(i>0){const e={key:"showMore",render:e=>(0,C.jsx)(L.Z,{...e,icon:(0,oi.o)({width:16,height:16,color:t.mediumTextColor}),style:{color:t.mediumTextColor},title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Show {showMore} more",id:"database.viewSettings.duplicateExistingViewTab.showMore.title",values:{showMore:i}})}),action:()=>{s()}};a.push(e)}return a}({viewStores:b,showMore:j,preselectedViewPointerId:null===(e=m.current.preselectedViewPointer)||void 0===e?void 0:e.id,onDuplicateViewAccept:x,onShowMore:()=>g(!1),theme:w})}),[x,j,w,b]),_=(0,r.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getName()}),[t]);return(0,C.jsx)(di,{collectionSettingsStore:o,collectionName:_,inputValue:d,onInputValueChange:e=>{u(e),c.setState({focus:{section:0,indexLocal:0,indexGlobal:0}}),g(!0)},menuListItems:M,showMore:j,initialViewType:m.current.initialViewType,menuListStore:c,onNewEmptyViewClick:v,onBackArrowClick:()=>{m.current.wentBack=!0,l.z$({collectionSettingsStore:o})}})}function pi(e,t,o){const i=e.collectionViewBlockStore(),n=e.collectionStore(),r=e.collectionViewStore();if(!i||!n||!r)return{viewStores:[],showMore:0};const s=n.getParentBlockStore();if(!i||!s)return{viewStores:[],showMore:0};let a=(0,Xo.gL)({collectionStore:n,sourceCollectionViewBlockStore:s,currentCollectionViewBlockStore:i,currentCollectionViewStore:r,constraints:(0,si.x)(r.id)}),l=0;return t?a=a.filter((e=>(0,Oe.D)(e,t))):o&&(l=a.length-ci,a=a.slice(0,ci)),{viewStores:a,showMore:l}}var gi=o(371663),mi=o(606906),fi=o(977657),Si=o(732566),yi=o(177420),hi=o(940470),xi=o(164921),vi=o(260458),Ci=o(863296),bi=o(170289),ji=o(243224),wi=o(292283),Mi=o(121039),_i=o(992083),ki=o(535057),Vi=o(317693);function Ti(e){const{title:t,items:o,handleSelect:r,isSelectAll:s,sectionCallout:a,selectAllTooltipContent:l,isSectionItemsLoading:c}=e,[d,u]=i.useState(!0),{isMobile:p}=(0,n.Fy)(),g=(0,f.yK)((e=>({sectionMargin:{margin:"0px 14px"},sectionTitleContainer:{display:"flex",padding:2,borderRadius:4,gap:2,alignItems:"center"},sectionMenuDesktopTitleStyle:{padding:0,margin:0,alignItems:"center"},arrow:{width:p?14:12,height:p?14:12,transition:"transform 200ms ease-out",transform:`rotateZ(${d?0:-90}deg)`,fill:"inherit",opacity:1,marginTop:2},menuList:{paddingTop:0,paddingBottom:0}})),[p,d]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(U.Z,{style:{...g.sectionMargin},desktopTitleStyle:g.sectionMenuDesktopTitleStyle,title:(0,C.jsxs)(xi.Z,{style:g.sectionTitleContainer,onClick:()=>u(!d),children:[t,(0,Vi.A)(g.arrow),c&&(0,C.jsx)(pe.Z,{style:{alignSelf:"right"}})]}),right:o.length&&d&&!c&&(0,C.jsx)($t.Z,{renderTooltip:e=>(0,C.jsx)("div",{...e,style:ji.F6,children:l}),render:e=>(0,C.jsx)("div",{...e,children:(0,C.jsx)(Pi,{onClick:r,isSelectAll:s})}),disableTooltip:!l})}),d&&(0,C.jsxs)(C.Fragment,{children:[a,(0,C.jsx)(N.Z,{style:g.menuList,type:N.i.Vertical,initialFocus:0,sections:[{key:"collapsableSectionMenuList",render:e=>(0,C.jsx)(U.Z,{topBorder:!1,...e}),items:o}]})]})]})}function Pi(e){return(0,C.jsx)(Co.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:I.Z.fontSize.UISmall.desktop,height:"fit-content"},onClick:e.onClick,children:e.isSelectAll?(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collapsableSection.selectAll",defaultMessage:"Select all"}):(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collapsableSection.unselectAll",defaultMessage:"Unselect all"})})}const Ii=(0,P.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a project...",id:"database.viewSettings.collectionSettingsExternalListProjects.inputPlaceholder"}});function Fi(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,[s,a]=i.useState(""),[c,d]=i.useState(!1),[u,p]=i.useState([]),[g,m]=i.useState(!1),[S,h]=i.useState(0),[x,v]=i.useState(!1),[b,j]=i.useState([]),[w,_]=i.useState([]),[k,V]=i.useState([]),[T,Z]=i.useState(!1),[B,K]=i.useState(!1),[O,R]=i.useState(""),D=(0,n.O7)(),z=(0,r.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[t]),N=(0,r.VK)((()=>yo.default.state.currentSpaceStore),[]),E=(0,r.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().bot_id}),[t]),[{value:H}]=(0,y.r5)((async()=>{if(E&&z)return ao.getExternalConnectionMetaInfo(D,{botId:E,spaceId:z})}),[D,E,z]);(0,i.useEffect)((()=>{"success"===(null==H?void 0:H.type)&&"data"in H&&R(H.data.email)}),[H]);const U=(0,r.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().synced_collection_external_url}),[t]),W=(0,r.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.external_collection_type}),[t]),G=(0,r.VK)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat();return Boolean(null==o?void 0:o.sync_state)}),[t]),$=(0,r.VK)((()=>Mi.Z.state),[]),{projectCollectionPointer:q,taskCollectionPointer:Q}=(0,r.VK)((()=>Bi(t.collectionStore())),[t]),X=(0,r.VK)((()=>{if(E&&N){return Go.Qx.createChildStore(N,{table:yi.cZ,id:E,spaceId:N.id}).getLastEditedById()}return null}),[E,N]),Y=(0,r.VK)((()=>(null==N?void 0:N.userId)===X),[X,N]),[{value:J}]=(0,y.r5)((async()=>z&&E&&q?(Z(!0),ao.getProjectsForJiraSite(D,{botId:E,spaceId:z,projectCollectionPointer:q})):null),[D,q,z,E]),ee=(0,r.VK)((()=>ki.QM()),[]);(0,i.useEffect)((()=>{m(!!(ee&&S>100))}),[ee,S]);const te=(0,i.useCallback)((e=>{const{jiraProjects:t,permittedProjects:o,existingImportedProjectKeys:i}=e;V(i);const n=o.map((e=>e.key));j(n);const r=[...t.filter((e=>{let{isPrivate:t}=e;return!t})).sort(((e,t)=>{var o,i;return null!==(o=t.insight)&&void 0!==o&&o.lastIssueUpdateTime&&null!==(i=e.insight)&&void 0!==i&&i.lastIssueUpdateTime?new Date(t.insight.lastIssueUpdateTime).getTime()-new Date(e.insight.lastIssueUpdateTime).getTime():t.insight.totalIssueCount-e.insight.totalIssueCount})),...t.filter((e=>{let{isPrivate:t}=e;return t})).sort(((e,t)=>{const o=n.includes(e.key),i=n.includes(t.key);return o&&i?0:o?-1:1}))];let s=0;r.forEach((e=>{i.includes(e.key)&&(s+=e.insight.totalIssueCount)})),_(r),h(s);const a=Pt.jj([...i,...$?$.projectKeys:[]]);i.length&&d(!0),a&&p(a)}),[$]);(0,i.useEffect)((()=>{if("success"!==(null==J?void 0:J.type)&&"failed"!==(null==J?void 0:J.type)||(Z(!1),"failed"===(null==J?void 0:J.type)&&K(!0)),"success"===(null==J?void 0:J.type)&&"data"in J)if("code"in J.data){if(!Y){const{code:e}=J.data;"NO_USER_BOT_FOUND"!==e&&"INVALID_BOT"!==e||v(!0)}}else te(J.data)}),[J,Y,te]);const oe=(0,f.yK)((e=>({fetchingProjects:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.mediumTextColor},settingsMenu:{padding:"8px"},projectIcon:{width:20,height:20,borderRadius:4,marginBottom:14},connectAccountWrapper:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",margin:12,padding:12,flexDirection:"column",gap:8},connectAccountCTA:{borderRadius:6},connectAccountDescription:{fontSize:I.Z.fontSize.UIRegular.desktop,textAlign:"center",color:e.v2.text.secondary},errorMessage:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",color:no.ZP.red},permittedProjectItemTitle:{fontSize:I.Z.fontSize.UISmall.desktop,fontWeight:I.Z.fontWeight.medium},permittedProjectItemCaption:{fontSize:I.Z.fontSize.UISmall.desktop,color:To.Lr.dark.gray,fontWeight:I.Z.fontWeight.regular},disabledItem:{color:e.mediumTextColor,fill:e.mediumIconColor,opacity:.4},sectionMargin:{margin:"0px 14px"},projectVisibilityCallout:{fontSize:I.Z.fontSize.UISmall.desktop,backgroundColor:no.ZP.EmailLinkBackground,padding:"6px 8px",marginBottom:6,borderRadius:6,color:e.v2.text.secondary},privateProjectCallout:{width:"100%",padding:"0px 16px",color:e.v2.text.secondary},helpIcon:{width:12,height:12,display:"inline-block"}})),[]);if(!E||!z)return null;const ie=W?bi.I[W]:"",ne=w.length?(0,to.ZP)(s,w,(e=>e.name)):[],re=e=>{const t=e.key;u.includes(t)?(p(u.filter((e=>e!==t))),h(S-e.insight.totalIssueCount)):(p([...u,t]),h(S+e.insight.totalIssueCount))},se=()=>{const e=w.filter((e=>ce(e.key)));if(u.length===e.length)p([]),h(0),so.KL(D,{import_source:"jira",spaceId:z,userId:D.currentUser.id,action:"projects_deselect_all",collectionId:null==Q?void 0:Q.id,botId:E,site:U});else{let e=0;p(w.filter((e=>ce(e.key))).map((t=>(e+=t.insight.totalIssueCount,t.key)))),h(e),so.KL(D,{import_source:"jira",spaceId:z,userId:D.currentUser.id,action:"projects_select_all",collectionId:null==Q?void 0:Q.id,botId:E,site:U})}},ae=()=>{let e=0;const t=w.filter((e=>!k.includes(e.key)&&ce(e.key))).map((t=>(e+=t.insight.totalIssueCount,t.key))),o=u.filter((e=>!t.includes(e)));if(t.every((e=>u.includes(e))))p(o),h(S-e),so.KL(D,{import_source:"jira",spaceId:z,userId:D.currentUser.id,action:"unsynced_projects_deselect_all",collectionId:null==Q?void 0:Q.id,botId:E,site:U});else{p([...o,...t]);let e=0;for(const t of u){const o=w.find((e=>e.key===t));o&&(e+=o.insight.totalIssueCount)}h(e),so.KL(D,{import_source:"jira",spaceId:z,userId:D.currentUser.id,action:"unsynced_projects_select_all",collectionId:null==Q?void 0:Q.id,botId:E,site:U})}},le=()=>{const e=u.filter((e=>!k.includes(e)));k.every((e=>u.includes(e)))?(p(e),so.KL(D,{import_source:"jira",spaceId:z,userId:D.currentUser.id,action:"synced_projects_deselect_all",collectionId:null==Q?void 0:Q.id,botId:E,site:U})):(p([...e,...k]),so.KL(D,{import_source:"jira",spaceId:z,userId:D.currentUser.id,action:"synced_projects_select_all",collectionId:null==Q?void 0:Q.id,botId:E,site:U}));let t=0;for(const o of u){const e=w.find((e=>e.key===o));e&&(t+=e.insight.totalIssueCount)}h(t)},ce=e=>b.includes(e),de=U&&(0,mi.Z)((0,wi.jh)(U)),ue=ne.map((e=>({key:e.id,render:()=>(0,C.jsx)($t.Z,{disableTooltip:ce(e.key),renderTooltip:e=>(0,C.jsx)("div",{...e,style:ji.F6,children:he}),render:t=>(0,C.jsx)(L.Z,{...t,style:{paddingTop:"0px",paddingBottom:"0px"},focused:!1,buttonStyle:ce(e.key)?{}:oe.disabledItem,disabled:!ce(e.key),onClick:()=>{re(e)},title:(0,C.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,C.jsx)("div",{children:(0,C.jsx)(vi.Z,{size:14,disabled:!ce(e.key),checked:u.includes(e.key),onClick:()=>{re(e)},style:{borderRadius:2,marginBottom:14}})}),icon:(0,C.jsx)("img",{src:e.avatarUrls["48x48"],style:oe.projectIcon}),desktopIconStyle:{alignSelf:"center"},caption:(0,C.jsx)("div",{children:e.isPrivate?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}} (Private)",id:"database.viewSettings.collectionSettingsExternalListProjects.allProjectsIssueCountPrivate",values:{issues:e.insight.totalIssueCount}}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.allProjectsIssueCountNotPrivate",values:{issues:e.insight.totalIssueCount}})})})}),action:()=>{}}))),ge=ne.filter((e=>k.includes(e.key))).map((e=>({key:e.id,render:()=>(0,C.jsx)($t.Z,{disableTooltip:ce(e.key),renderTooltip:e=>(0,C.jsx)("div",{...e,style:ji.F6,children:he}),render:t=>(0,C.jsx)(L.Z,{...t,style:{paddingTop:"0px",paddingBottom:"0px"},focused:!1,buttonStyle:ce(e.key)?{}:oe.disabledItem,disabled:!ce(e.key),onClick:()=>{re(e)},title:(0,C.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,C.jsx)("div",{children:(0,C.jsx)(vi.Z,{size:14,disabled:!ce(e.key),checked:u.includes(e.key),onClick:()=>{re(e)},style:{borderRadius:2,marginBottom:14}})}),icon:(0,C.jsx)("img",{src:e.avatarUrls["48x48"],style:oe.projectIcon}),desktopIconStyle:{alignSelf:"center"},caption:(0,C.jsx)("div",{children:e.isPrivate?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}} (Private)",id:"database.viewSettings.collectionSettingsExternalListProjects.syncedProjectsIssueCountPrivate",values:{issues:e.insight.totalIssueCount}}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.syncedProjectsIssueCountNotPrivate",values:{issues:e.insight.totalIssueCount}})})})}),action:()=>{}}))),me=ne.filter((e=>!k.includes(e.key))).map((e=>({key:e.id,render:()=>(0,C.jsx)($t.Z,{disableTooltip:ce(e.key),renderTooltip:e=>(0,C.jsx)("div",{...e,style:ji.F6,children:he}),render:t=>(0,C.jsx)(L.Z,{...t,style:{paddingTop:"0px",paddingBottom:"0px"},focused:!1,buttonStyle:ce(e.key)?{}:oe.disabledItem,disabled:!ce(e.key),onClick:()=>{re(e)},title:(0,C.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,C.jsx)("div",{children:(0,C.jsx)(vi.Z,{size:14,disabled:!ce(e.key),checked:u.includes(e.key),onClick:()=>{re(e)},style:{borderRadius:2,marginBottom:14}})}),desktopIconStyle:{alignSelf:"center"},icon:(0,C.jsx)("img",{src:e.avatarUrls["48x48"],style:oe.projectIcon}),caption:(0,C.jsx)("div",{children:e.isPrivate?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}} (Private)",id:"database.viewSettings.collectionSettingsExternalListProjects.unsyncedProjectsIssueCountPrivate",values:{issues:e.insight.totalIssueCount}}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.unsyncedProjectsIssueCountNotPrivate",values:{issues:e.insight.totalIssueCount}})})})}),action:()=>{}}))),fe=(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:oe.permittedProjectItemTitle,children:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.userTooltipTitleForPrivatePages",defaultMessage:"Only some private projects can be synced to Notion"})}),(0,C.jsx)("div",{style:oe.permittedProjectItemCaption,children:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.userTooltipCaptionForPrivatePages",defaultMessage:"{site} {connection} was set up by {email}. You can only sync private projects that you and {email} have access to",values:{email:O,connection:W?`${W} sync`:"connection",site:de||"This"}})})]}),Se=()=>(0,C.jsxs)("div",{style:{...oe.sectionMargin,...oe.projectVisibilityCallout},children:[(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.projectVisibilityCallout",defaultMessage:"Syncing these projects will make them visible to everyone with access to this database "}),(0,C.jsx)($t.Z,{renderTooltip:e=>(0,C.jsxs)("div",{...e,style:ji.F6,children:[(0,C.jsx)("div",{style:oe.permittedProjectItemTitle,children:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.projectVisibilityCalloutTooltip.title",defaultMessage:"To restrict access, create a new Jira sync database"})}),(0,C.jsx)("div",{style:oe.permittedProjectItemCaption,children:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.projectVisibilityCalloutTooltip.description",defaultMessage:"Use the Share menu to choose who can access the database, then sync your private projects"})})]}),alignment:Qt.v.Start,render:e=>(0,C.jsx)("div",{...e,style:{display:"inline",position:"relative",top:2},children:(0,C.jsx)("span",{children:(0,M.m)(oe.helpIcon)})})})]}),ye=()=>(0,C.jsx)($t.Z,{renderTooltip:e=>(0,C.jsx)("div",{...e,style:ji.F6,children:fe}),render:e=>(0,C.jsxs)(Co.Z,{...e,style:oe.privateProjectCallout,children:[(0,M.m)({...oe.helpIcon,marginRight:6}),(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects..privateProjectNotFound",defaultMessage:"Can't find a private project?"})]})}),he=Y?(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.tooltipMessageForPrivatePages",defaultMessage:"You don't have access to this project in Jira"}):fe;async function xe(){const e=Xt.Z.integrations.state.find((e=>{let{id:t}=e;return t===fi.mC}));if(!e||!z)return;const t=await Gt.hM({environment:D,integration:e,spaceId:z,from:"connected_apps_settings"});if(v(!1),hi.x.isSuccess(t)){var o;if(!E||!q)return;Z(!0);const e=await ao.getProjectsForJiraSite(D,{botId:E,spaceId:z,projectCollectionPointer:q,userBotId:null===(o=t.value.externalAuthentication)||void 0===o?void 0:o.id});Z(!1),"success"===e.type?"code"in e.data?"SITE_NOT_FOUND"===e.data.code?(v(!0),F.showDialog({message:(0,C.jsx)(Ki,{site:U,integrationIconUrl:ie,connectAccount:xe}),showCancel:!1,keepFocus:!0,innerStyle:{width:320},items:[]})):K(!0):te(e.data):K(!0)}else K(!0)}return(0,C.jsx)(A.ZP,{...e,title:(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{title}",id:"database.viewSettings.collectionSettingsExternalListProjects.title",values:{title:G?"Synced projects":"Select projects"}})}),header:!T&&!x&&!B&&(0,C.jsx)(Zi,{inputValue:s,onChange:a}),handleClose:()=>{Mi.Z.setState({...$,projectKeys:[]}),l.E3({collectionSettingsStore:o})},footer:!T&&!x&&!B&&(0,C.jsx)(Ai,{onActionButtonClick:()=>{const e={};w.forEach((t=>{u.includes(t.key)&&(e[t.key]=t.insight.totalIssueCount)})),l.H4({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_task_properties",action:Lo.K6.SyncProjects,selectedProjectKeys:u,projectIssueCounts:e}}),Mi.Z.setState({...Mi.Z.state,projectKeys:[]}),so.KL(D,{import_source:"jira",spaceId:z,userId:D.currentUser.id,action:"list_properties_via_project",collectionId:null==Q?void 0:Q.id,botId:E,site:U})},disabled:!c&&0===u.length,selectedProjectKeysLength:u.length,isSetupComplete:G,shouldShowUpgradePlan:g}),fullHeight:!0,menuScrollerStyle:{...x||B?{height:"100%"}:{}},children:T?(0,C.jsxs)("div",{style:oe.fetchingProjects,children:[(0,C.jsx)("span",{children:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.loadingData",defaultMessage:"Loading projects from Jira..."})}),(0,C.jsx)(pe.Z,{style:{alignSelf:"center"}})]}):B?(0,C.jsx)("div",{style:oe.errorMessage,children:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.errorMessage",defaultMessage:"Something went wrong"})}):x?(0,C.jsxs)("div",{style:oe.connectAccountWrapper,children:[(0,C.jsxs)(Ci.Z,{onClick:xe,style:oe.connectAccountCTA,children:[(0,C.jsx)("img",{style:{width:14,height:15,marginRight:8},src:ie}),(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.connectAccountCTA",defaultMessage:"Connect to Jira"})]}),(0,C.jsx)("div",{style:oe.connectAccountDescription,children:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.connectAccountDescription",defaultMessage:"Connect your Jira account to view and sync private projects"})})]}):c?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Ti,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{existingSyncedProjectsCount} synced projects",id:"database.viewSettings.collectionSettingsExternalListProjects.syncedProjectsTitle",values:{existingSyncedProjectsCount:k.length}}),isSelectAll:!k.every((e=>u.includes(e))),items:ge,handleSelect:le},"syncedProjects"),(0,C.jsx)(Ti,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{unsyncedProjectsCount} unsynced projects",id:"database.viewSettings.collectionSettingsExternalListProjects.unsyncedProjectsTitle",values:{unsyncedProjectsCount:(w.length-k.length).toString()}}),isSelectAll:!w.filter((e=>!k.includes(e.key))).map((e=>e.key)).every((e=>u.includes(e))),sectionCallout:Se(),items:me,handleSelect:ae},"unsyncedProjects"),!Y&&ye()]}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Ti,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{buttonText}",id:"database.viewSettings.collectionSettingsExternalListProjects.selectedProjectsTitleForInitialSync",values:{buttonText:u.length===w.length?`All ${w.length} Projects`:`${u.length.toString()} of ${w.length.toString()} projects`}}),handleSelect:se,items:ue,sectionCallout:Se(),isSelectAll:u.length!==w.length},"allProjects"),!Y&&ye()]})})}function Zi(e){const{isMobile:t}=(0,n.Fy)();return(0,C.jsxs)(U.Z,{children:[(0,C.jsx)(Re.Z,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?I.Z.fontSize.UISmall.mobile:I.Z.fontSize.UISmall.desktop},children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Whenever a synced project is updated in Jira, those updates will appear in Notion",id:"database.viewSettings.collectionSettingsExternalListProjects.description"})}),(0,C.jsx)(po.ZP,{focusInitial:!0,value:e.inputValue,onChange:t=>{e.onChange(t.target.value)},placeholder:So.default.formatMessage(Ii.inputPlaceholder)})]})}function Ai(e){const t=(0,f.yK)((e=>({wrapper:{paddingBottom:12},wrapperInner:{marginLeft:14,marginRight:14,marginTop:12,borderColor:"none"},button:{width:"100%",border:"none",fontWeight:I.Z.fontWeight.medium},syncDescription:{fontSize:14,color:e.mediumTextColor,marginBottom:8,textAlign:"center"}})),[]);return(0,C.jsx)("div",{style:t.wrapper,children:(0,C.jsx)("div",{style:t.wrapperInner,children:e.shouldShowUpgradePlan?(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{style:t.syncDescription,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Your Free Notion plan allows up to 100 synced issues. Choose fewer projects or upgrade to sync unlimited issues.",id:"database.viewSettings.collectionSettingsExternalListProjects.upgradePlanContext"})}),(0,C.jsx)(H.Z,{style:t.button,onClick:()=>{_i.Z.setState({open:!0,openedFrom:"jira_sync_2",currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0})},disabled:e.disabled,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Upgrade",id:"database.viewSettings.collectionSettingsExternalListProjects.Upgrade"})})]}):(0,C.jsxs)(C.Fragment,{children:[!e.isSetupComplete&&(0,C.jsx)("div",{style:t.syncDescription,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{projects} projects will be synced",id:"database.viewSettings.collectionSettingsExternalListProjects.projectsToBeSynced",values:{projects:e.selectedProjectKeysLength}})}),(0,C.jsxs)(H.Z,{style:t.button,onClick:e.onActionButtonClick,disabled:e.disabled,children:[(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Select properties to sync ",id:"database.viewSettings.collectionSettingsExternalListProjects.selectProperties"}),(0,Si.k)({width:14,height:14,marginLeft:6})]})]})})})}function Bi(e){let t=null,o=null;if(!e)return{projectCollectionPointer:t,taskCollectionPointer:o};const i=e.getFormat();if(i.app_config_uri===gi.wW){t=e.pointer;const i=e.getSchema()[gi.zI.ProjectToTaskRelation];i&&(0,Lo.p_)(i)&&i.collection_pointer&&(o=i.collection_pointer)}else if(i.app_config_uri===gi.iS){o=e.pointer;const i=e.getSchema()[gi.Es.TaskToProjectRelation];i&&(0,Lo.p_)(i)&&i.collection_pointer&&(t=i.collection_pointer)}return{projectCollectionPointer:t,taskCollectionPointer:o}}function Ki(e){const{isMobile:t}=(0,n.Fy)(),o=(0,f.yK)((e=>({title:{fontWeight:I.Z.fontWeight.medium,marginRight:4,marginBottom:6},caption:{marginBottom:24},tryAgainCTA:{width:"100%",marginBottom:8},cancelCTA:{width:"100%",justifyContent:"center",color:e.lightTextColor,fontWeight:I.Z.fontWeight.medium},siteButtonContainer:{gap:2,borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:e.stroke.deemphasized,marginBottom:24},siteButton:{padding:"4px 30px 4px 8px",borderRadius:4,gap:8,display:"flex"},siteButtonTextContainer:{gap:8,display:"flex"},siteNameText:{fontSize:t?I.Z.fontSize.UIRegular.mobile:I.Z.fontSize.UIRegular.desktop,fontWeight:I.Z.fontWeight.regular,lineHeight:"18px",letterSpacing:"0.15px",color:e.text.primary},siteNameSecondaryText:{fontSize:t?I.Z.fontSize.UISmall.mobile:I.Z.fontSize.UISmall.desktop,color:e.text.secondary,fontWeight:I.Z.fontWeight.regular,textAlign:"left",lineHeight:t?I.Z.lineHeight.UISmall.mobile:I.Z.lineHeight.UISmall.desktop},logo:{width:20,height:20,marginTop:6},siteWrapper:{display:"flex",flexFlow:"column",gap:1,alignItems:"flex-start"}})),[t]);return(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{style:o.title,children:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.title",defaultMessage:"Oauth Failed"})}),(0,C.jsx)(Re.Z,{isSecondaryColor:!0,isMultiline:!0,style:o.caption,children:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.description",defaultMessage:"If you have multiple Jira sites, make sure you’re authenticating into this one:"})}),(0,C.jsx)("div",{style:o.siteButtonContainer,children:(0,C.jsx)(xi.Z,{style:o.siteButton,disallowTabbing:!0,disabled:!0,children:(0,C.jsxs)("div",{style:o.siteButtonTextContainer,children:[(0,C.jsx)("img",{style:o.logo,src:e.integrationIconUrl}),(0,C.jsxs)("div",{style:o.siteWrapper,children:[(0,C.jsx)("span",{style:o.siteNameText,children:(0,mi.Z)((0,wi.jh)(e.site||""))}),(0,C.jsx)("span",{style:o.siteNameSecondaryText,children:e.site})]})]})})}),(0,C.jsx)(H.Z,{style:{width:"100%",marginBottom:8},onClick:()=>{e.connectAccount(),F.dismissDialog()},children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Try again",id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.tryAgainCTA"})}),(0,C.jsx)(Co.Z,{onClick:()=>{F.dismissDialog()},style:{width:"100%",justifyContent:"center"},children:(0,C.jsx)(Re.Z,{isSecondaryColor:!0,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Cancel",id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.cancenCTA"})})})]})}const Oi=new Map([[gi.Es.Status,"status"],["title","title"],[gi.Es.Priority,"priority"],[gi.Es.Tags,"tags"],[gi.Es.Assign,"assignee"],[gi.Es.DueDate,"duedate"],[gi.Es.SubTaskRelation,"subtasks"],[gi.Es.ParentTaskRelation,"parent_task"],[gi.Es.BlockingRelation,"blocking_tasks"],[gi.Es.BlockedRelation,"blocked_by_tasks"],[gi.Es.TaskToProjectRelation,"task_to_project"]]);new Map([[gi.zI.Status,"status"],["title","title"],[gi.zI.Priority,"priority"],[gi.zI.Collaborators,"collaborators"],[gi.zI.CompletionRollup,"completion_rollup"],[gi.zI.People,"people"],[gi.zI.ProjectDates,"project_dates"],[gi.zI.ProjectToTaskRelation,"project_to_task"]]);var Li=o(164964),Ri=o(180951),Di=o(431869),zi=o(772141),Ni=o(776798),Ei=o(334017);function Hi(e){const{temporaryAutoRelateState:t,handleAutoRelateToggle:o,collectionContextStore:i,targetCollectionStore:n,autoRelate:s,hasInverseRelation:a}=e,l=(0,r.VK)((()=>i.collectionStore()),[i]),c=(0,r.VK)((()=>Boolean(null==l?void 0:l.isSyncedCollection())),[l]),d=(0,r.VK)((()=>(null==l?void 0:l.getFormat().bot_id)||n.getFormat().bot_id),[l,n]),u=(0,r.VK)((()=>!!d&&(c||!c&&a)),[d,c,a]),p=(0,f.yK)((e=>({errorLabel:{margin:"0px 14px",color:e.errorText},helpIcon:{width:16,fill:e.lightIconColor,marginLeft:6}})),[]),g=(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",whiteSpace:"pre"},children:[(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Automatically Relate",id:"database.viewSettings.setupRelationTab.autoRelate.title"}),(0,C.jsx)($t.Z,{render:e=>(0,C.jsx)("div",{...e,children:(0,M.m)(p.helpIcon)}),style:{width:200},placement:Qt.u.Bottom,textWrap:!0,renderTooltip:()=>(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Relations will automatically populate based on links found in page properties.",id:"database.viewSettings.setupRelationTab.autoRelateTooltip"})})]});return u?(0,C.jsx)(W.Z,{title:g,on:t?t.enabled:!!s&&(null==s?void 0:s.enabled),focused:!1,onClick:()=>o(d),textWrapperStyle:{opacity:1}}):null}const Ui=(0,v.IU)("collectionRelationArrow",{viewBox:"-1 -1 136 22",svg:(0,C.jsx)("path",{d:"M129.646 21.854a.501.501 0 00.708 0l3.182-3.182a.5.5 0 00-.708-.707L130 20.793l-2.828-2.828a.501.501 0 00-.708.707l3.182 3.182zM1 21.5V6H0v15.5h1zm4.5-20H125v-1H5.5v1zm124 4.5v15.5h1V6h-1zM125 1.5a4.5 4.5 0 014.5 4.5h1A5.5 5.5 0 00125 .5v1zM1 6a4.5 4.5 0 014.5-4.5v-1A5.5 5.5 0 000 6h1z"})}),Wi=(0,v.IU)("collectionRelationSmallArrowRight",{viewBox:"0 0 33 8",svg:(0,C.jsx)("path",{d:"M32.3536 4.35355C32.5488 4.15829 32.5488 3.84171 32.3536 3.64645L29.1716 0.464466C28.9763 0.269204 28.6597 0.269204 28.4645 0.464466C28.2692 0.659728 28.2692 0.976311 28.4645 1.17157L31.2929 4L28.4645 6.82843C28.2692 7.02369 28.2692 7.34027 28.4645 7.53553C28.6597 7.7308 28.9763 7.7308 29.1716 7.53553L32.3536 4.35355ZM0 4.5H32V3.5H0V4.5Z"})}),Gi=(0,v.IU)("collectionSelfRelationArrow",{viewBox:"-1 -1 139 22",svg:(0,C.jsx)("path",{d:"M4.146 21.854a.5.5 0 00.708 0l3.182-3.182a.5.5 0 10-.708-.707L4.5 20.793l-2.828-2.828a.5.5 0 10-.708.707l3.182 3.182zm129.5 0a.501.501 0 00.708 0l3.182-3.182a.5.5 0 00-.708-.707L134 20.793l-2.828-2.828a.501.501 0 00-.708.707l3.182 3.182zM5 21.5V6H4v15.5h1zm4.5-20H129v-1H9.5v1zm124 4.5v15.5h1V6h-1zM129 1.5a4.5 4.5 0 014.5 4.5h1A5.5 5.5 0 00129 .5v1zM5 6a4.5 4.5 0 014.5-4.5v-1A5.5 5.5 0 004 6h1z"})});var $i=o(742696);function qi(e){const{collectionContextStore:t,targetCollectionStore:o,propertySchema:i,propertyName:n,temporaryInverseState:s,hasInverseRelation:a,inverseRelationName:l,isInitialPropertyName:c}=e,d=(0,P.useIntl)(),u=(0,r.VK)((()=>t.collectionStore()),[t]),p=s?s.hasInverseRelation:a,g=(0,r.VK)((()=>Boolean(u&&o.id===u.id)),[u,o]),m=(0,r.VK)((()=>{const e=s?s.inverseName:l;return e||(null!=u&&u.isDefined()?Ue.aI(d,{sourceCollection:u.getModel(),isSelfRelation:g,targetCollectionStore:o,createUnique:!0}):"")}),[u,d,l,g,s,o]),S=(0,r.VK)((()=>null!=u&&u.isDefined()?m===Ue.aI(d,{sourceCollection:u.getModel(),isSelfRelation:g,targetCollectionStore:o,createUnique:!1}):void 0),[u,d,m,g,o]),y=Boolean(!g&&c&&(!p||p&&S)),h=(0,f.yK)((e=>({preview:{background:e.inputBackground,marginLeft:14,marginRight:14,padding:y?"42px 12px":12,boxShadow:e.inputBoxShadow,borderRadius:4,display:"flex",flexDirection:"column",justifyContent:"center",position:"relative"},condensedView:{height:22,display:"flex",justifyContent:"center",alignItems:"center"},condensedProperties:{width:33,height:p?20:10,margin:"0px 12px",display:"flex",flexDirection:"column",justifyContent:"center"},databasesRow:{height:22}})),[y,p]);return u?(0,C.jsx)(U.Z,{title:(0,C.jsx)(Re.Z,{isSmall:!0,isSecondaryColor:!0,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Preview",id:"database.viewSettings.setupRelationTab.relationVisualizer.title"})}),disableMobileBorders:!0,children:(0,C.jsx)("div",{style:h.preview,children:y?(0,C.jsxs)("div",{style:h.condensedView,children:[(0,C.jsx)(Xi,{collectionStore:u,condensedView:!0}),(0,C.jsxs)("div",{style:h.condensedProperties,children:[(0,C.jsx)(Qi,{propertyName:n||(null==i?void 0:i.name),condensedView:!0}),p&&(0,C.jsx)(Qi,{propertyName:m,condensedView:!0,isInverse:!0})]}),(0,C.jsx)(Xi,{collectionStore:o,condensedView:!0,isTarget:!0})]}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Qi,{propertyName:n||(null==i?void 0:i.name),bidirectional:g&&!p}),(0,C.jsxs)("div",{style:h.databasesRow,children:[(0,C.jsx)(Xi,{collectionStore:u}),(0,C.jsx)(Xi,{collectionStore:o,isTarget:!0})]}),p&&(0,C.jsx)(Qi,{propertyName:m,isInverse:!0})]})})}):null}function Qi(e){const{propertyName:t,bidirectional:o,isInverse:i,condensedView:n}=e,r=(0,f.yK)((e=>({propertyLabel:{fontSize:12,wordBreak:"break-word",...I.Z.textOverflowStyle,maxWidth:200,alignSelf:"center",color:e.mediumTextColor,fill:e.mediumIconColor},arrow:{width:136,height:25,alignSelf:"center",transform:i?"rotate(180deg)":void 0,margin:i?"6px 12px 0px 6px":"0px 6px 6px 6px",opacity:.3,fill:e.regularIconColor},smallArrow:{height:8,paddingLeft:1,marginTop:i?2:void 0,display:"inherit",transform:i?"rotate(180deg)":void 0,opacity:.3,fill:e.regularIconColor}})),[i]),s=(0,C.jsx)("div",{style:r.propertyLabel,children:t||""});return(0,C.jsxs)(C.Fragment,{children:[!i&&!n&&s,n?Wi(r.smallArrow):o?Gi(r.arrow):Ui(r.arrow),i&&!n&&s]})}function Xi(e){const{collectionStore:t,condensedView:o,isTarget:i}=e,n=(0,r.VK)((()=>t.getIcon()),[t]),s=(0,f.yK)((e=>({wrapper:{display:"flex",alignItems:"center",padding:2,color:e.mediumTextColor,fill:e.mediumIconColor,position:o?void 0:"absolute",left:o?void 0:i?"72%":"28%",transform:o?void 0:"translate(-50%, 0)",width:"fit-content"},icon:{marginRight:4,width:12,height:12},title:{fontSize:12,wordBreak:"break-word",...I.Z.textOverflowStyle,maxWidth:100}})),[o,i]);return(0,C.jsxs)("div",{style:s.wrapper,children:[n?(0,C.jsx)(bo.Z,{icon:n,isEmptyPage:!1,size:12,disabled:!0,style:s.icon}):(0,$i.t)(s.icon),(0,C.jsx)(Ni.Z,{store:t,style:s.title})]})}function Yi(e){const{collectionContextStore:t,property:o,propertyName:s,targetCollectionStore:a,onSubmit:l,buttonContents:c,isInitialPropertyName:d,temporaryInverseState:u,setTemporaryInverseState:p,from:g}=e,m=(0,n.O7)(),S=(0,r.VK)((()=>o?Ue.KV(t,o):void 0),[t,o]),y=(0,r.VK)((()=>t.collectionStore()),[t]),h=(0,r.VK)((()=>Boolean(y&&y.id===a.id)),[y,a]),x=(0,r.VK)((()=>Boolean(o?Ue.OP(t,o,a):void 0)),[t,o,a]),v=(0,r.VK)((()=>{if("relation"!==(null==S?void 0:S.type))return"";const e=S.property;if(!e||e===o)return"";const t=a.getRole();if(!t||!zi.YX(t))return"";const i=a.getSchema()[e];return(null==i?void 0:i.name)||""}),[a,o,S]),b=(0,r.VK)((()=>"relation"===(null==S?void 0:S.type)&&S.autoRelate?S.autoRelate:{enabled:!1}),[S]),j=(0,r.VK)((()=>Boolean(Ue.gZ(a))),[a]),w=(0,r.VK)((()=>Boolean((null==y?void 0:y.getDatabaseType())&&o&&(null==y?void 0:y.isTypedProperty(o)))),[y,o]),_=(0,r.VK)((()=>t.contextType),[t]),k=(0,f.yK)((e=>({errorLabel:{margin:"0px 14px",color:e.errorText},helpIcon:{width:16,fill:e.lightIconColor,marginLeft:6}})),[]),V=(0,i.useMemo)((()=>u?u.hasInverseRelation:x),[u,x]),T=(0,i.useMemo)((()=>u?u.inverseName:v),[u,v]),I=(0,i.useMemo)((()=>u?u.autoRelate:b),[u,b]),F=(0,i.useCallback)((()=>{const e=null!=y&&y.isSyncedCollection()?I:V?{enabled:!1}:I;p({hasInverseRelation:!V,inverseName:V?void 0:T,autoRelate:e}),o&&ut.$q({environment:m,collectionContextStore:t,property:o,from:"collectionPage"===_?"page_properties":"view_settings",action:V?"relation_toggle_inverse_off":"relation_toggle_inverse_on",is_self_relation:h})}),[p,V,T,I,t,y,o,_,h,m]),Z=(0,i.useCallback)((e=>{p({hasInverseRelation:!0,inverseName:e.target.value,autoRelate:I})}),[p,I]),A=(0,i.useCallback)((e=>{const i=null!=I&&I.enabled?{enabled:!1}:{enabled:!0,bot_id:e};p({hasInverseRelation:V,inverseName:T,autoRelate:i}),o&&ut.$q({environment:m,collectionContextStore:t,property:o,from:"collectionPage"===_?"page_properties":"view_settings",action:i.enabled?"auto_relation_toggle_on":"auto_relation_toggle_off"})}),[o,p,t,_,T,V,I,m]),B=(0,i.useCallback)((e=>{(0,be.ZP)({event:e,context:be.Af.CollectionSettingsClick,callback:l})}),[l]),K=(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",whiteSpace:"pre"},children:[h?(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.setupRelationTab.selfRelation.reverse",defaultMessage:"Separate directions"}):(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.setupRelationTab.relation.reverse",defaultMessage:"Show on {databaseName}",values:{databaseName:(0,C.jsx)(Ni.Z,{style:{display:"inline"},store:a})}}),(0,C.jsx)($t.Z,{render:e=>(0,C.jsx)("div",{...e,children:(0,M.m)(k.helpIcon)}),style:{width:200},placement:Qt.u.Bottom,textWrap:!0,renderTooltip:()=>!j||w?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Cannot edit target database.",id:"database.viewSettings.setupRelationTab.inverseDisabledWarning.title"}):h?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Create separate properties for each direction of a two-way relation. Useful for modeling Parent task/Sub-tasks, Blocked by/Blocking, and more.",id:"database.viewSettings.setupRelationTab.inverseRelationTooltip.selfRelation"}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Create a property on {databaseName} showing backlinks to the current database",id:"database.viewSettings.setupRelationTab.inverseRelationTooltip",values:{databaseName:(0,C.jsx)(Ni.Z,{style:{display:"inline"},store:a})}})})]}),O=(0,r.VK)((()=>Ei.Z.state.isOpen),[]);return(0,C.jsxs)(C.Fragment,{children:[!(h&&x)&&!g&&!O&&(0,C.jsx)(W.Z,{title:K,on:V,focused:!1,onClick:F,disabled:!j||h&&x||w,textWrapperStyle:{opacity:1}}),(0,C.jsx)(Ji,{collectionContextStore:t,targetCollectionStore:a,isSelfRelation:h,temporaryInverseState:u,hasInverseRelation:x,inverseRelationName:v,disabled:!j||w,onChange:Z,from:g}),(0,C.jsx)(Hi,{handleAutoRelateToggle:A,temporaryAutoRelateState:null==u?void 0:u.autoRelate,collectionContextStore:t,autoRelate:b,targetCollectionStore:a,hasInverseRelation:V}),(()=>{if("relation"!==(null==S?void 0:S.type))return!0;if(u){if(u.hasInverseRelation!==x)return!0;if(u.inverseName&&u.inverseName!==v)return!0;if(u.autoRelate&&u.autoRelate.enabled!==b.enabled)return!0}return!1})()&&(0,C.jsx)(U.Z,{children:(0,C.jsx)(H.Z,{style:{display:"flex",margin:"6px 12px 0px 12px"},onClick:B,children:c})}),"subitem"!==g&&"timeline_arrows_by"!==g&&(0,C.jsx)(qi,{propertySchema:S,propertyName:s,collectionContextStore:t,targetCollectionStore:a,temporaryInverseState:u,hasInverseRelation:x,inverseRelationName:v,isInitialPropertyName:d})]})}function Ji(e){const{collectionContextStore:t,targetCollectionStore:o,isSelfRelation:i,temporaryInverseState:n,hasInverseRelation:s,inverseRelationName:a,disabled:l,onChange:c,from:d}=e,u=(0,P.useIntl)(),p=(0,r.VK)((()=>{const e=t.collectionStore();return null!=e&&e.isDefined()?Ue.aI(u,{sourceCollection:e.getModel(),isSelfRelation:i,targetCollectionStore:o,createUnique:!0,from:d}):u.formatMessage({id:"database.viewSettings.setupRelationTab.inverseRelationName.placeholder",defaultMessage:"Related to target"})}),[t,u,i,o,d]);return(n?n.hasInverseRelation:s)?(0,C.jsx)(U.Z,{title:!d&&(0,C.jsx)(Re.Z,{isSmall:!0,isSecondaryColor:!0,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Related property on {databaseName}",id:"database.viewSettings.setupRelationTab.inverseRelationNameInput.title",values:{databaseName:(0,C.jsx)(Ni.Z,{style:{display:"inline"},store:o})}})}),children:(0,C.jsx)(po.ZP,{value:"subitem"!==d&&"timeline_arrows_by"!==d?(null==n?void 0:n.inverseName)||a:p,placeholder:p,onChange:c,onBlur:Pt.yR,onSubmit:Pt.yR,focusInitial:!1,selectAll:!1,disabled:l})}):null}function en(e,t,o){return"1"===e?"relation"===t?o&&!0===o?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"1 item",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne.connectedRelation"}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"1 page",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne.relation"}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"1 {type}",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne",values:{type:ri.SO[t]}}):"no_limit"===e?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"No limit",id:"database.viewSettings.collectionPropertyLimitHelpers.noLimit"}):void 0}function tn(e,t,o){return{key:e,title:en(e,t,o)}}function on(e){const{property:t,propertySchema:o,collectionContextStore:r}=e,s=(0,n.O7)(),a=(0,i.useCallback)((e=>{const i=r.collectionStore();if(!i||!(0,Lo.en)(o))return;const n={...o,limit:Number(e)?1:void 0};d.createAndCommit({userAction:"CollectionSettingsLimitOptions.handleLimitChange",environment:s,perform:e=>{Po.xO({environment:s,collectionStore:i,update:{[t]:n},transaction:e})}});const a=Number(e)?`${o.type}_toggle_limit_on`:`${o.type}_toggle_limit_off`;ut.$q({environment:s,collectionContextStore:r,property:t,from:"view_settings",action:a})}),[r,s,t,o]);return(0,Lo.en)(o)?"relation"===o.type&&o.connectedRelation?(0,C.jsx)(nn,{propertyType:o.type,connectedRelation:!0,selectedKey:o.limit?"1":"no_limit",onChange:a}):(0,C.jsx)(nn,{propertyType:o.type,selectedKey:o.limit?"1":"no_limit",onChange:a}):null}function nn(e){const{propertyType:t,selectedKey:o,connectedRelation:i,onChange:n}=e;return(0,C.jsx)(Ge.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Limit",id:"database.viewSettings.collectionPropertyLimitHelpers.limit"}),selectedKey:o,popupStyle:{minWidth:190},options:[tn("1",t,i),tn("no_limit",t)],onChange:n})}var rn=o(815145),sn=o(584076),an=o(484210);function ln(e){const{isSelfRelation:t,collectionStore:o,showAs:i,disabled:s,onClick:a}=e,l=(0,r.VK)((()=>Boolean(o)),[o]),c=(0,r.VK)((()=>null==o?void 0:o.getIcon()),[o]),d=(0,r.VK)((()=>{if(t)return;const e=null==o?void 0:o.getParentBlockStore();return e&&(0,an.ZP)({store:e,pageVisitSource:rn.tY.LinkInPage})}),[o,t]),u=(0,n.Fy)(),p=(0,f.yK)((e=>({linkBox:{display:"flex",alignItems:"center"},linkTitle:{color:e.regularTextColor,fontWeight:I.Z.fontWeight.semibold,fontSize:14,marginLeft:4*(u.isRetina?.5:1),wordBreak:"break-word",...I.Z.textOverflowStyle},chevronTitle:{display:"inline",wordBreak:"break-word",...I.Z.textOverflowStyle}})),[u]),g=(0,C.jsx)(bo.Z,{icon:c,isEmptyPage:!1,size:20,disabled:!0});return(0,C.jsx)(B.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Related to",id:"database.viewSettings.editRelation.targetLink.title"}),showChevron:"chevron"===i,onClick:a,disabled:s,right:t?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"This database",id:"database.viewSettings.editRelation.selfRelationTarget.title"}):"link"===i&&d?(0,C.jsxs)(sn.Z,{href:d,innerStyle:p.linkBox,children:[g,(0,C.jsx)(Ni.Z,{store:o,underline:!0,style:p.linkTitle,maxLength:15})]}):l?(0,C.jsxs)(C.Fragment,{children:[g,(0,C.jsx)(Ni.Z,{store:o,style:p.chevronTitle})]}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"No target",id:"database.viewSettings.editRelation.noTarget.title"}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0}})}function cn(e){const{collectionContextStore:t,property:o}=e,s=(0,n.O7)(),a=(0,P.useIntl)(),[l,c]=(0,i.useState)(void 0),u=(0,r.VK)((()=>t.collectionStore()),[t]),p=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t]),g=(0,r.VK)((()=>Ue.KV(t,o)),[t,o]),m=g&&(0,Lo.NK)(g)?g.connectedRelation:void 0,f=(0,r.VK)((()=>dn(t.collectionViewBlockStore(),g)),[t,g]),S=Boolean(f&&(null==u?void 0:u.id)===f.id),y=(0,r.VK)((()=>Boolean(f&&(null==g?void 0:g.name)===Ue.m8(a,{targetCollectionStore:f,isSelfRelation:S,sourceSchema:p,createUnique:!1}))),[g,a,f,S,p]),h=(0,r.VK)((()=>t.contextType),[t]),x=(0,i.useCallback)((()=>{if(!l)return;const{hasInverseRelation:e,inverseName:i,autoRelate:n}=l;d.createAndCommit({userAction:"CollectionSettingsRelationOptions.handleEditRelation",environment:s,perform:r=>{Di.gy({environment:s,collectionContextStore:t,property:o,hasInverseRelation:e,inverseName:i,autoRelate:n,intl:a,transaction:r})}}),ut.$q({environment:s,collectionContextStore:t,property:o,from:"collectionPage"===h?"page_properties":"view_settings",action:"relation_edit",is_self_relation:S,has_inverse:e,auto_relate:null==n?void 0:n.enabled}),c(void 0)}),[l,s,t,o,h,S,a]);if(!f)return null;const v=g&&!(0,Ri.gg)(g)&&!(0,Ri.ic)(g);return(0,C.jsxs)(C.Fragment,{children:[v&&(0,C.jsx)(ln,{isSelfRelation:S,collectionStore:f,showAs:"link",disabled:!0}),v&&(0,C.jsx)(on,{collectionContextStore:t,propertySchema:g,property:o}),!Boolean(m)&&(0,C.jsx)(Yi,{collectionContextStore:t,targetCollectionStore:f,property:o,buttonContents:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Update relation",id:"database.viewSettings.editRelation.updateButton.title"}),temporaryInverseState:l,setTemporaryInverseState:c,isInitialPropertyName:y,onSubmit:x})]})}function dn(e,t){if("relation"!==(null==t?void 0:t.type))return;const o=null==t?void 0:t.collection_pointer;return o&&e?Go.NW.createChildStore(e,o):void 0}const un=(0,P.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a property...",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.inputPlaceholder"}}),pn=Oi,gn=["attachment"],mn=["description","comment"],fn=["updated","labels","issuelinks","creator","subtasks","reporter","issuetype","watches","created"],Sn=new Map([["user","person"],["attachment","file"],["array","multi_select"],["option","select"],["option-with-child","select"],["number","number"],["datetime","date"],["date","date"],["priority","select"],["issuetype","select"],["string","text"],["default","text"]]);function yn(e){const{collectionSettingsStore:t,collectionContextStore:o,action:a,selectedProjectKeys:c}=e,[d,u]=i.useState(""),[p,g]=i.useState([]),m=(0,f.Fg)(),[S,h]=i.useState(!1),x=(0,n.O7)(),v=(0,r.VK)((()=>o.collectionStore()),[o]),b=(0,r.VK)((()=>null==v?void 0:v.getFormat()),[v]),j=(0,r.VK)((()=>null==v?void 0:v.getSchema()),[v]),w=(0,r.VK)((()=>{const e=o.collectionViewBlockStore();return"notion://projects_collection"===(null==b?void 0:b.app_config_uri)?dn(e,null==j?void 0:j["notion://projects/project_to_task_relation"]):v}),[o,j,b,v]),M=(0,r.VK)((()=>null==w?void 0:w.getSchema()),[w]),_=(0,r.VK)((()=>null==v?void 0:v.getSpaceId()),[v]),k=(0,r.VK)((()=>{var e;return null==v||null===(e=v.getFormat())||void 0===e?void 0:e.synced_collection_external_url}),[v]),V=(0,r.VK)((()=>null==v?void 0:v.getFormat().bot_id),[v]),T=(0,r.VK)((()=>p.filter((e=>e.isSelected)).length),[p]),I=(0,r.VK)((()=>{const e=null==v?void 0:v.getFormat();return Boolean(null==e?void 0:e.sync_state)}),[v]),[{value:F}]=(0,y.r5)((async()=>_&&k?await ao.getFieldsForJiraIssues(x,{spaceId:_,site:k}):null),[x,_,k]);if(!S&&"success"===(null==F?void 0:F.type)&&"data"in F){const e=F.data.fields.sort(((e,t)=>{var o,i,n,r,s;return null!==(o=e.schema)&&void 0!==o&&o.customId&&null!==(i=t.schema)&&void 0!==i&&i.customId||!(null!==(n=e.schema)&&void 0!==n&&n.customId||null!==(r=t.schema)&&void 0!==r&&r.customId)?e.name.toLocaleLowerCase()>t.name.toLocaleLowerCase()?1:-1:null!==(s=e.schema)&&void 0!==s&&s.customId?1:-1})).filter((e=>!p.find((t=>t.id===e.id))&&!mn.includes(e.id))).filter((e=>{let{schema:t}=e;return Boolean(t)})).map((e=>{var t,o;const i=gn.includes(e.id),n=(0,s.Ul)(`${null==w?void 0:w.id}:${e.id}`),r=Boolean(null==M?void 0:M[n]);return{id:e.id,name:e.name,isSelected:i||r,isRequired:i,currentlySyncing:i||r,type:Sn.get((null==e||null===(t=e.schema)||void 0===t?void 0:t.type)??"default"),isProjectLevel:"PROJECT"===(null===(o=e.scope)||void 0===o?void 0:o.type),isPopular:fn.includes(e.id)}}));h(!0),g((t=>[...t,...e]))}(0,i.useEffect)((()=>{const e=[];M&&Object.entries(M).forEach((t=>{let[o,i]=t;if(("relation"!==(null==i?void 0:i.type)||null==i||!i.connectedRelation)&&(null!=i&&i.derived_property_record_metadata||pn.has(o))){var n;const t="title"===o?"Task Name (Summary)":(null==i?void 0:i.name)??pn.get(o)??"",r=(null==i||null===(n=i.derived_property_record_metadata)||void 0===n?void 0:n.external_object_attribute)??pn.get(o)??"";e.push({id:r,name:t,isSelected:!0,currentlySyncing:!0,isRequired:pn.has(o)||gn.includes(r),type:null==i?void 0:i.type})}})),g((t=>[...t,...e]))}),[M]);const Z=(0,f.yK)((e=>({settingsMenu:{padding:8},disabledItem:{color:e.mediumTextColor,fill:e.mediumIconColor,opacity:.4},snackbarCta:{color:e.regularInvertedTextColor,marginLeft:16}})),[]),B=p.length?(0,to.ZP)(d,p,(e=>e.name)):[],K=e=>{g(p.map((t=>t.id===e.id?{id:e.id,name:e.name,isRequired:e.isRequired,isSelected:!e.isSelected,currentlySyncing:e.currentlySyncing,type:e.type,isPopular:e.isPopular,isProjectLevel:e.isProjectLevel}:t)))},O=B.filter((e=>e.isRequired||e.isPopular)).map((e=>({key:e.id,render:()=>(0,C.jsx)(L.Z,{focused:!1,style:e.isRequired?Z.disabledItem:{},onClick:()=>{K(e)},disabled:e.isRequired,title:(0,C.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,C.jsx)("div",{children:(0,C.jsx)(vi.Z,{size:14,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{K(e)},style:{borderRadius:2}})}),icon:(0,C.jsx)(Ro.ZP,{type:e.type??"text",icon:void 0,size:16,theme:m})}),action:()=>{}}))),R=B.filter((e=>!e.isRequired&&e.isProjectLevel)),D=B.filter((e=>!(e.isProjectLevel||e.isPopular||e.isRequired))),z=R.map((e=>({key:e.id,render:()=>(0,C.jsx)(L.Z,{focused:!1,onClick:()=>{K(e)},title:(0,C.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,C.jsx)("div",{children:(0,C.jsx)(vi.Z,{size:14,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{K(e)},style:{borderRadius:2}})}),icon:(0,C.jsx)(Ro.ZP,{type:e.type??"text",icon:void 0,size:16,theme:m})}),action:()=>{}}))),N=D.map((e=>({key:e.id,render:()=>(0,C.jsx)(L.Z,{focused:!1,onClick:()=>{K(e)},title:(0,C.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,C.jsx)("div",{children:(0,C.jsx)(vi.Z,{size:14,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{K(e)},style:{borderRadius:2}})}),icon:(0,C.jsx)(Ro.ZP,{type:e.type??"text",icon:void 0,size:16,theme:m})}),action:()=>{}})));return(0,C.jsx)(A.ZP,{...e,title:(0,C.jsx)(C.Fragment,{children:I?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{title}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.titleForSyncedPropertiesTab",values:{title:"Synced task properties"}}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{title}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.titleForSelectPropertiesTab",values:{title:"Select task properties"}})}),header:(0,C.jsx)(hn,{inputValue:d,onChange:u}),handleClose:()=>{l.E3({collectionSettingsStore:t})},footer:(0,C.jsx)(xn,{action:a,onSubmit:async()=>{if(!(v&&V&&_))return;const{projectCollectionPointer:o,taskCollectionPointer:i}=Bi(v);if(!o||!i)return;const n=t.state.stack.find((e=>"externalProjectsSyncSettings"===e.type&&"external_list_projects"===e.source)),r=p.filter((e=>e.isSelected)).map((e=>e.id));gn.forEach((e=>{r.includes(e)||r.push(e)})),Li.oV({label:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Started syncing from Jira. You’ll be notified when the sync is complete",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.snackbar.title"}),right:(0,C.jsx)(Co.Z,{onClick:Li.rN,style:Z.snackbarCta,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Close",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.snackbar.close"})}),position:"bottom"}),await ao.syncJiraProjects(x,{botId:V,projectKeys:c,projectIssueCounts:e.projectIssueCounts,spaceId:_,properties:r,projectCollectionPointer:o,taskCollectionPointer:i,onlyUpdateProperties:!n}),so.KL(x,{action:n?"sync_projects":"sync_properties",import_source:"jira",spaceId:_,userId:x.currentUser.id,collectionId:null==w?void 0:w.id,botId:V,site:k}),l.E3({collectionSettingsStore:t})},isSetupComplete:I,selectedPropertiesCount:T}),fullHeight:!0,children:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Ti,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{standardPropertyCount} standard properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.standardPropertiesTitle",values:{standardPropertyCount:p.filter((e=>e.isRequired||e.isPopular)).length}}),isSelectAll:!p.filter((e=>e.isPopular||e.isRequired)).every((e=>e.isSelected)),items:O,handleSelect:()=>{p.filter((e=>e.isPopular||e.isRequired)).every((e=>e.isSelected))?(g(p.map((e=>e.isPopular&&!e.isRequired?{...e,isSelected:!1}:e))),so.KL(x,{action:"standard_properties_deselect_all",import_source:"jira",spaceId:_,userId:x.currentUser.id,collectionId:null==w?void 0:w.id,botId:V,site:k})):(g(p.map((e=>e.isPopular&&!e.isRequired?{...e,isSelected:!0}:e))),so.KL(x,{action:"standard_properties_select_all",import_source:"jira",spaceId:_,userId:x.currentUser.id,collectionId:null==w?void 0:w.id,botId:V,site:k}))},isSectionItemsLoading:!S},"requiredProperties"),(0,C.jsx)(Ti,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{projectLevelOptionalPropertyCount} project properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.projectLevelOptionalPropertiesTitle",values:{projectLevelOptionalPropertyCount:z.length.toString()}}),handleSelect:()=>{p.filter((e=>e.isProjectLevel&&!e.isPopular&&!e.isRequired)).every((e=>e.isSelected))?(g(p.map((e=>!e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!1}))),so.KL(x,{action:"project_level_properties_deselect_all",import_source:"jira",spaceId:_,userId:x.currentUser.id,collectionId:null==w?void 0:w.id,botId:V,site:k})):(g(p.map((e=>!e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!0}))),so.KL(x,{action:"project_level_properties_select_all",import_source:"jira",spaceId:_,userId:x.currentUser.id,collectionId:null==w?void 0:w.id,botId:V,site:k}))},items:z,isSelectAll:!p.filter((e=>e.isProjectLevel&&!e.isPopular&&!e.isRequired)).every((e=>e.isSelected)),selectAllTooltipContent:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Syncing all properties may lead to worst performance. Try syncing only properties that are in use",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.warningMessageForProjectLevelProperties"}),isSectionItemsLoading:!S},"projectProperties"),(0,C.jsx)(Ti,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{siteLevelPropertiesCount} site properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.siteLevelPropertiesTitle",values:{siteLevelPropertiesCount:N.length.toString()}}),items:N,handleSelect:()=>{p.filter((e=>!(e.isProjectLevel||e.isPopular||e.isRequired))).every((e=>e.isSelected))?(g(p.map((e=>e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!1}))),so.KL(x,{action:"site_level_properties_deselect_all",import_source:"jira",spaceId:_,userId:x.currentUser.id,collectionId:null==w?void 0:w.id,botId:V,site:k})):(g(p.map((e=>e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!0}))),so.KL(x,{action:"site_level_properties_select_all",import_source:"jira",spaceId:_,userId:x.currentUser.id,collectionId:null==w?void 0:w.id,botId:V,site:k}))},isSelectAll:!p.filter((e=>!(e.isProjectLevel||e.isPopular||e.isRequired))).every((e=>e.isSelected)),selectAllTooltipContent:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Syncing all properties may lead to worst performance. Try syncing only properties that are in use",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.warningMessageForProjectLevelProperties"}),isSectionItemsLoading:!S},"siteProperties")]})})}function hn(e){const{isMobile:t}=(0,n.Fy)();return(0,C.jsxs)(U.Z,{children:[(0,C.jsx)(Re.Z,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?I.Z.fontSize.UISmall.mobile:I.Z.fontSize.UISmall.desktop},children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Select which Jira issue properties are synced as Notion properties in Issues",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.description"})}),(0,C.jsx)(po.ZP,{focusInitial:!0,value:e.inputValue,onChange:t=>{e.onChange(t.target.value)},placeholder:So.default.formatMessage(un.inputPlaceholder)})]})}function xn(e){const t=(0,f.yK)((e=>({wrapper:{marginLeft:14,marginRight:14,marginTop:12,borderColor:"none",paddingBottom:12},button:{width:"100%",border:"none",fontWeight:I.Z.fontWeight.medium},syncDescription:{paddingTop:8,fontSize:14,color:e.mediumTextColor,marginBottom:8,textAlign:"center"}})),[]),o=e.selectedPropertiesCount>100,i=e.action===Lo.K6.SyncProjects?(0,C.jsx)("div",{style:t.wrapper,children:(0,C.jsx)(H.Z,{style:t.button,onClick:e.onSubmit,disabled:o,children:e.isSetupComplete?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{title}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.syncProjectsButton",values:{title:"Sync projects"}}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{title}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.startJiraSyncButton",values:{title:"Start Jira sync"}})})}):(0,C.jsx)("div",{style:t.wrapper,children:(0,C.jsx)(H.Z,{style:t.button,onClick:e.onSubmit,disabled:o,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Sync additional properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.syncAdditionalProperties"})})});return(0,C.jsxs)(C.Fragment,{children:[!e.isSetupComplete&&!o&&(0,C.jsx)("div",{style:t.syncDescription,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{propertiesCount} properties will be synced",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.selectProperties",values:{propertiesCount:e.selectedPropertiesCount}})}),o&&(0,C.jsx)("div",{style:t.syncDescription,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"You've reached the maximum of 100 synced properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.propertiesLimit"})}),i]})}var vn=o(16184),Cn=o(286793),bn=o(959960),jn=o(918514),wn=o(548779);const Mn=(0,P.defineMessages)({CollectionSettingsExternalSourceTitle:{defaultMessage:"Select data to sync",id:"database.viewSettings.collectionSettingsExternalSource.tabTitle"},CollectionSettingsExternalSourceDescription:{id:"database.viewSettings.collectionSettingsExternalSource.description",defaultMessage:"To set up a Jira synced database, you’ll need to choose a Jira site and projects to sync"},importInProgressToolTip:{id:"database.viewSettings.collectionSettingsExternalSource.tooltipForInProgressImport",defaultMessage:"Cannot be edited while sync is in progress"},accountDisconnectedTooltip:{id:"database.viewSettings.collectionSettingsExternalSource.accountDisconnectedTooltip",defaultMessage:"Account has been disconnected"},sourceDisabledTooltip:{id:"database.viewSettings.collectionSettingsExternalSource.sourceDisabledTooltip",defaultMessage:"Workspace owner has disabled edits for this Jira site"}}),_n=12;function kn(e){var t,o;const{collectionSettingsStore:i,collectionContextStore:s}=e,a=(0,P.useIntl)(),{isMobile:c}=(0,n.Fy)(),d=(0,n.O7)(),u=(0,r.VK)((()=>s.collectionStore()),[s]),p=(0,r.VK)((()=>null==u?void 0:u.getFormat()),[u]),g=(0,r.VK)((()=>null==u?void 0:u.getSchema()),[u]),m=(0,r.VK)((()=>{var e;return null==u||null===(e=u.getFormat())||void 0===e?void 0:e.external_collection_type}),[u]),S=m?bi.I[m]:"",y=(0,r.VK)((()=>dn(s.collectionViewBlockStore(),(null==p?void 0:p.app_config_uri)===gi.wW?null==g?void 0:g[gi.zI.ProjectToTaskRelation]:null==g?void 0:g[gi.Es.TaskToProjectRelation])),[s,g,p]),h=(0,f.yK)((e=>({collectionSettingsExternalSourceTitle:{marginLeft:12,fontSize:c?I.Z.fontSize.UISmall.mobile:I.Z.fontSize.UISmall.desktop,color:e.text.secondary},preview:{padding:"12px 36px 12px 30px",background:e.v2.surface.wash,display:"flex",justifyContent:"flex-start",marginLeft:14,marginRight:14,borderRadius:4},container:{marginLeft:12,marginRight:12},lastSyncText:{fontSize:c?I.Z.fontSize.UISmall.mobile:I.Z.fontSize.UISmall.desktop,color:e.text.secondary,fontWeight:I.Z.fontWeight.regular,textAlign:"left",marginLeft:14,lineHeight:I.Z.lineHeight.UISmall.desktop},captionText:{fontSize:c?I.Z.fontSize.UISmall.mobile:I.Z.fontSize.UISmall.desktop,color:e.text.secondary,fontWeight:I.Z.fontWeight.regular,textAlign:"left",marginLeft:14},sourceSectionTitle:{textAlign:"left",color:e.text.secondary},siteButtonContainer:{margin:"6px 14px 6px 14px",gap:2,borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:e.stroke.deemphasized},siteButton:{padding:"4px 8px",borderRadius:4,gap:8,display:"flex",justifyContent:"space-between"},siteButtonTextContainer:{gap:8,display:"flex"},siteNameText:{fontSize:c?I.Z.fontSize.UIRegular.mobile:I.Z.fontSize.UIRegular.desktop,fontWeight:I.Z.fontWeight.regular,lineHeight:I.Z.lineHeight.UIRegular.desktop,letterSpacing:"0.15px",color:e.text.primary},siteNameSecondaryText:{fontSize:c?I.Z.fontSize.UISmall.mobile:I.Z.fontSize.UISmall.desktop,color:e.text.secondary,fontWeight:I.Z.fontWeight.regular,textAlign:"left",lineHeight:c?I.Z.lineHeight.UISmall.mobile:I.Z.lineHeight.UISmall.desktop},lockedIcon:{width:14,height:14,color:e.v2.icon.secondary},emptyViewWrap:{paddingBlockEnd:42,paddingInline:12},wrap:{display:"flex",flexDirection:"column"},showMoreButtonContainer:{marginLeft:12,marginBottom:12,marginRight:"auto"},showMoreButtonContent:{fontSize:12},noResultsTitle:{color:e.text.secondary,fontSize:12,margin:0}})),[c]);if(!u||!y)return null;const x=(null==p?void 0:p.app_config_uri)===gi.wW,v=Boolean(null==p?void 0:p.sync_state);return(0,C.jsxs)(A.ZP,{collectionSettingsStore:i,title:a.formatMessage(Mn.CollectionSettingsExternalSourceTitle),fullHeight:!0,handleClose:()=>{Mi.Z.setState({...Mi.Z.state,projectKeys:[]}),l.E3({collectionSettingsStore:i})},children:[(0,C.jsx)(U.Z,{disableMobileBorders:!0,children:(0,C.jsx)("div",{style:h.collectionSettingsExternalSourceTitle,children:(0,C.jsx)(P.FormattedMessage,{...Mn.CollectionSettingsExternalSourceDescription})})}),(0,C.jsx)("div",{style:h.preview,children:Vn({projectCollectionStore:x?u:y,taskCollectionStore:x?y:u,integrationIconUrl:S})}),(0,C.jsxs)(U.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Source",id:"database.viewSettings.collectionSettingsExternalSource.sourceSite"}),style:h.sourceSectionTitle,children:[(null==p||null===(t=p.sync_state)||void 0===t?void 0:t.last_synced_at)&&(0,C.jsx)("div",{style:h.lastSyncText,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{lastSyncedAt}",id:"database.viewSettings.collectionSettingsExternalSource.lastSynced",values:{lastSyncedAt:`Last synced at ${new Date(null==p||null===(o=p.sync_state)||void 0===o?void 0:o.last_synced_at).toLocaleString()}`}})}),(0,C.jsx)("div",{style:h.siteButtonContainer,children:(0,C.jsxs)(xi.Z,{style:h.siteButton,disallowTabbing:!0,disabled:!0,children:[(0,C.jsxs)("div",{style:h.siteButtonTextContainer,children:[Tn({iconStyle:{width:15,height:15,marginTop:6},srcUrl:S}),(0,C.jsxs)("div",{style:{display:"flex",flexFlow:"column",gap:1},children:[(0,C.jsx)("span",{style:h.siteNameText,children:(0,mi.Z)((0,wi.jh)((null==p?void 0:p.synced_collection_external_url)||""))}),(0,C.jsx)("span",{style:h.siteNameSecondaryText,children:null==p?void 0:p.synced_collection_external_url})]})]}),(0,C.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,vn.Q)(h.lockedIcon)})]})})]}),Pn({taskCollectionStore:x?y:u,collectionSettingsStore:i,isSetupComplete:v}),(0,C.jsx)(Le.Z,{size:1,style:{marginTop:16,marginBottom:16}}),(0,C.jsx)(D.Z,{style:{display:"flex",marginLeft:14,marginRight:14},className:"notion-print-ignore",href:(0,jn.UY)("guides.externalImportAndSync"),external:!0,onClick:()=>{so.KL(d,{import_source:"jira",userId:d.currentUser.id,spaceId:u.getSpaceId(),action:"learn_more",collectionId:x?y.id:u.id,botId:null==p?void 0:p.bot_id,site:null==p?void 0:p.synced_collection_external_url})},children:(0,C.jsx)(Co.Z,{icon:M.m,isLightGray:!0,style:{width:"100%"},children:(0,C.jsx)(P.FormattedMessage,{id:"externalSync.helpCenter",defaultMessage:"Learn about Jira sync"})})})]})}function Vn(e){const{projectCollectionStore:t,taskCollectionStore:o,integrationIconUrl:i}=e,s=(0,n.O7)(),a=(0,r.VK)((()=>"dark"===s.ThemeStore.state.mode),[s]),l=(0,f.yK)((e=>({iconContainer:{display:"flex",alignItems:"center"},sourceIcon:{width:26,height:26,padding:5,borderRadius:6,gap:10,borderColor:e.stroke.regular,borderStyle:"solid",borderWidth:1,boxShadow:"0px 2px 4px 0px #161D1B05",...!a&&{background:`linear-gradient(0deg, ${e.text.contrast}, ${e.text.contrast})`}},taskArrow:{width:87,height:26,top:26},projectArrow:{width:87,height:26,top:2,border:1},arrowContainer:{display:"flex",flexFlow:"column",justifyContent:"center"},collectionIconContainer:{display:"flex",flexFlow:"column",justifyContent:"space-around",gap:12},collectionIcon:{width:88,padding:"4px 6px 6px 6px",borderRadius:6,gap:6,display:"flex",alignItems:"center",borderColor:e.stroke.regular,borderWidth:1,borderStyle:"solid",...!a&&{background:`linear-gradient(0deg, ${e.text.contrast}, ${e.text.contrast})`}},title:{fontSize:_n,fontWeight:I.Z.fontWeight.medium,lineHeight:I.Z.lineHeight.UISmall.desktop,letterSpacing:0,color:e.text.primary}})),[a]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:l.iconContainer,children:Tn({iconStyle:l.sourceIcon,srcUrl:i})}),(0,C.jsxs)("div",{style:l.arrowContainer,children:[Tn({iconStyle:l.projectArrow,srcUrl:S.Z.images.externalIntegrations.externalAppToProjectsArrowPng}),Tn({iconStyle:l.taskArrow,srcUrl:S.Z.images.externalIntegrations.externalAppToTasksArrowPng})]}),(0,C.jsxs)("div",{style:l.collectionIconContainer,children:[(0,C.jsxs)("div",{style:l.collectionIcon,children:[In(Cn.D,i),(0,C.jsx)(Ni.Z,{store:t,style:l.title})]}),(0,C.jsxs)("div",{style:l.collectionIcon,children:[In(bn.w,i),(0,C.jsx)(Ni.Z,{store:o,style:l.title})]})]})]})}function Tn(e){const{iconStyle:t,srcUrl:o,altString:i}=e;return(0,C.jsx)("img",{style:t,src:o,alt:i})}function Pn(e){let{taskCollectionStore:t,collectionSettingsStore:o,isSetupComplete:i}=e;const s=(0,n.O7)(),a=(0,r.VK)((()=>t.getSchema()),[t]),c=(0,r.VK)((()=>{var e;return null===(e=t.getFormat().sync_state)||void 0===e?void 0:e.syncing}),[t]),d=(0,r.VK)((()=>yo.default.state.currentSpaceStore),[]),u=(0,r.VK)((()=>t.getFormat().bot_id),[t]),p=(0,r.VK)((()=>t.getFormat().synced_collection_external_url),[t]),g=(0,r.VK)((()=>(0,wn.lQ)(d)),[d]),m=(0,r.VK)((()=>(0,wi.Eg)()),[])&&!g,f=(0,r.VK)((()=>{if(u&&d){const e=Go.Qx.createChildStore(d,{table:yi.cZ,id:u,spaceId:d.id});return Boolean(e.getAlive())}return!0}),[u,d]);let S=0;for(const n in a){var y;null!==(y=a[n])&&void 0!==y&&y.derived_property_record_metadata&&S++}let h=So.default.formatMessage(Mn.accountDisconnectedTooltip);return Boolean(c)?h=So.default.formatMessage(Mn.importInProgressToolTip):m&&(h=So.default.formatMessage(Mn.sourceDisabledTooltip)),i?(0,C.jsx)(U.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Data synced from jira",id:"database.viewSettings.collectionSettingsExternalSource.titleStringForSyncedData"}),children:(0,C.jsx)($t.Z,{disableTooltip:!Boolean(c)&&f&&!m,renderTooltip:e=>(0,C.jsx)("div",{...e,style:ji.F6,children:h}),render:e=>(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(B.Z,{...e,icon:Cn.D,disabled:Boolean(c)||!f||m,onClick:()=>{so.KL(s,{import_source:"jira",userId:s.currentUser.id,spaceId:null==d?void 0:d.id,action:"list_projects",collectionId:t.id,botId:u,site:p}),l.H4({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_projects"}})},right:(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalSource.projectsSettings",defaultMessage:"Settings"})}),showChevron:!0,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Projects",id:"database.viewSettings.collectionSettingsExternalSource.projects"})}),(0,C.jsx)(B.Z,{...e,icon:Vt.N,disabled:Boolean(c)||!f||m,onClick:()=>{so.KL(s,{import_source:"jira",userId:s.currentUser.id,spaceId:null==d?void 0:d.id,action:"list_properties_via_source",collectionId:t.id,botId:u,site:p}),l.H4({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_task_properties",action:Lo.K6.SyncAdditionalProperties,selectedProjectKeys:[],projectIssueCounts:{}}})},right:(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalSource.syncedPropertiesCount",defaultMessage:"{syncedPropertiesCountString}",values:{syncedPropertiesCountString:S.toString()}})}),showChevron:!0,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Task Properties",id:"database.viewSettings.collectionSettingsExternalSource.taskProperties"})})]})})}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(U.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Step 1",id:"database.viewSettings.collectionSettingsExternalSource.setupProjects"}),children:(0,C.jsx)("div",{style:{margin:"6px 14px 0px"},children:(0,C.jsx)(H.Z,{style:{width:"100%"},onClick:()=>{l.H4({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_projects"}})},disabled:m,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Select projects to sync",id:"database.viewSettings.collectionSettingsExternalSource.syncProjectsButton"})})})}),(0,C.jsx)(U.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Step 2",id:"database.viewSettings.collectionSettingsExternalSource.setupProperties"}),children:(0,C.jsx)("div",{style:{margin:"6px 14px 0px"},children:(0,C.jsx)(H.Z,{style:{width:"100%"},disabled:!0,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Select properties to sync",id:"database.viewSettings.collectionSettingsExternalSource.syncPropertiesButton"})})})})]})}function In(e,t){const o=(0,n.O7)(),i=(0,r.VK)((()=>"dark"===o.ThemeStore.state.mode),[o]),s=(0,f.yK)((e=>({sourceIcon:{width:10,height:10,padding:2,borderRadius:3,gap:10,position:"absolute",borderColor:e.stroke.regular,borderStyle:"solid",borderWidth:1,right:-3,bottom:-3,boxShadow:"0px 2px 4px 0px #161D1B05",...!i&&{background:`linear-gradient(0deg, ${e.text.contrast}, ${e.text.contrast})`},display:"flex",alignItems:"center",justifyContent:"center"},baseIcon:{height:14,width:14,color:e.v2.icon.secondary}})),[i]);return(0,C.jsxs)("div",{style:{position:"relative"},children:[e(s.baseIcon),(0,C.jsx)("div",{style:s.sourceIcon,children:Tn({iconStyle:{height:5,width:5},srcUrl:t})})]})}function Fn(e){const{collectionSettingsStore:t,collectionContextStore:o,tabSettings:{source:i}}=e;if("external_source"===i)return(0,C.jsx)(kn,{collectionSettingsStore:t,collectionContextStore:o});if("external_list_projects"===i)return(0,C.jsx)(Fi,{collectionSettingsStore:t,collectionContextStore:o});if("external_list_task_properties"===i){const{action:i,selectedProjectKeys:n,projectIssueCounts:r}=e.tabSettings;return(0,C.jsx)(yn,{collectionSettingsStore:t,collectionContextStore:o,action:i,selectedProjectKeys:n,projectIssueCounts:r})}return(0,C.jsx)(C.Fragment,{})}var Zn=o(416732),An=o(132662),Bn=o(212205),Kn=o(756373),On=o(606287);const Ln=(0,P.defineMessages)({autoIncrementIdPrefixPlaceholder:{defaultMessage:"Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixPlaceholder"},duplicatePrefixNameError:{defaultMessage:"{prefixName} isn't available for use.",id:"database.viewSettings.propertyTab.duplicatePrefixNameError"}});function Rn(e){const{uniqueIdProperty:t,prefixValue:o,collectionContextStore:s}=e,a=(0,n.O7)(),l=(0,r.VK)((()=>s.collectionStore()),[s]),[c,u]=(0,i.useState)(o??""),[p,g]=(0,i.useState)(!0),[m,S]=(0,i.useState)(),h=(0,i.useCallback)((()=>{g(!0),S(void 0)}),[g,S]),x=(0,i.useCallback)((e=>{g(!0),S(So.default.formatMessage(Ln.duplicatePrefixNameError,{prefixName:`"${e}"`}))}),[]),v=(0,i.useCallback)(((e,t,o)=>{const i=o.collectionStore();i&&(g(!1),ao.setRecordKey(a,{spaceId:i.getSpaceId(),table:i.table,key:e,id:i.id}).then((i=>{g(!0),200!==i.status?x(e):ut.$q({environment:a,collectionContextStore:o,property:t,from:"view_settings",action:"unique_id_change_collection_key"})})).catch((()=>x(e))))}),[a,x]),b=(0,i.useCallback)((async e=>{if(!l)return!1;const t=await ao.isRecordKeyAvailable(a,{spaceId:l.getSpaceId(),table:l.table,key:e.trim()});return"success"===t.type&&t.data.isAvailable}),[l,a]),j=(0,Jo.v)((e=>{b(e).then((t=>{t||x(e),g(!0)})).catch((()=>x(e)))}),500),[w]=(0,y.r5)((async()=>{if(l)return ao.suggestRecordKey(a,{spaceId:l.getSpaceId(),table:On.vF,id:l.id,shouldSetSuccessfullySuggestedRecord:!1})}),[l,a]);(0,i.useEffect)((()=>{var e;if(!o&&"resolved"===w.status)return"success"===(null===(e=w.value)||void 0===e?void 0:e.type)&&w.value.data?(S(void 0),void u(w.value.data.key)):void 0}),[o,w]),(0,i.useEffect)((()=>()=>{j.cancel()}),[j]);const M=(0,i.useCallback)((e=>{const t=e.target.value.toUpperCase();u(t),h(),t&&t!==o&&((0,Kn.k5)(t)||S(So.default.formatMessage(Kn.sY.prefixInvalidError)),g(!1),j(t))}),[h,o,j]),_=(0,i.useCallback)((()=>{j.flush()}),[j]),k=(0,i.useCallback)((e=>{const i=null==l?void 0:l.getRecordKeyStore();e!==o&&!m&&i&&l&&null!=t&&t.propertySchema?v(e,null==t?void 0:t.propertyId,s):g(!0)}),[l,o,m,t,v,s]),V=(0,i.useCallback)((()=>{const e=s.collectionStore();e&&d.createAndCommit({userAction:"CollectionSettingsAutoIncrementIdPropertyCreateNewIdProperty",environment:a,perform:t=>{const o=Ae.G3({environment:a,collectionStore:e,collectionViewArgs:void 0,propertyType:"auto_increment_id",transaction:t});v(c,o,s)}})}),[s,a,c,v]),T=(0,i.useCallback)((e=>{if(!l)return;const t=[{label:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.propertyTab.autoIncrementIdPrefixSubmit",defaultMessage:"Update ID Prefix"}),color:"red",onAccept:()=>k(e)}];F.showDialog({message:(0,C.jsx)("span",{children:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.propertyTab.changePrefixConfirmationMessage",defaultMessage:"Updating the prefix will stop 3rd party automations that rely on this ID (e.g., GitHub PR status automation).",values:{databaseName:(0,C.jsx)(Ni.Z,{style:{display:"inline",fontWeight:I.Z.fontWeight.medium},shouldWrap:!0,store:l})}})}),showCancel:!0,keepFocus:!0,items:t})}),[l,k]),Z=(0,i.useCallback)((e=>{o?T(e):k(e)}),[o,k,T]),A=(0,i.useCallback)((()=>t?t&&!o?(0,C.jsxs)(C.Fragment,{children:[(0,Wt.R)({width:14,height:14}),(0,C.jsx)(An.Z,{size:4}),(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Add ID prefix",id:"database.viewSettings.propertyTab.autoIncrementIdCreatePrefix"})]}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Update ID Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixSubmit"}):(0,C.jsxs)(C.Fragment,{children:[(0,Wt.R)({width:14,height:14}),(0,C.jsx)(An.Z,{size:4}),(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Add ID property",id:"database.viewSettings.propertyTab.autoIncrementIdCreateProperty"})]})),[o,t]),B=(0,f.yK)((e=>({prefixInputOuterStyle:{color:void 0===o?e.lightTextColor:e.regularTextColor}})),[o]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(po.ZP,{left:(0,C.jsx)(Re.Z,{style:{marginLeft:4,marginRight:7},children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefix"})}),value:c,inputOuterStyle:B.prefixInputOuterStyle,onChange:M,onBlur:_,placeholder:Ln.autoIncrementIdPrefixPlaceholder.defaultMessage,onSubmit:()=>Z(c.trim()),focusInitial:!1,selectAll:!1,disabled:!1}),m||!p?(0,C.jsx)(Dn,{prefixName:c,hasRequestCompleted:p,errorMessage:m}):(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(Re.Z,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:16,marginLeft:16},children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{prefixWithHyphen}1, {prefixWithHyphen}2, {prefixWithHyphen}3, ...",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixPreview",values:{prefixWithHyphen:c?`${c}-`:""}})})}),(0,C.jsx)(H.Z,{isLarge:!0,style:{margin:"8px 16px",width:"90%"},onClick:()=>{t?Z(c.trim()):V()},disabled:c===o||Boolean(m)||!p,children:A()})]})}function Dn(e){const{errorMessage:t,hasRequestCompleted:o}=e;return(0,C.jsx)(Re.Z,{isMultiline:!0,style:{paddingTop:12,marginLeft:16,marginRight:16,...o?{color:no.ZP.red}:{},...e.styles},isSecondaryColor:!o,children:o&&t?t:(0,C.jsx)("div",{style:{paddingTop:3,paddingBottom:3},children:(0,C.jsx)(pe.Z,{style:{width:14,height:14}})})})}var zn=o(984619),Nn=o(212847);const En={pull_request_review_edited:!0,pull_request_review_submitted:!0,pull_request_review_requested:!0,pull_request_review_request_removed:!0,pull_request_closed:!0,pull_request_opened:!0,pull_request_reopened:!0,pull_request_converted_to_draft:!0,pull_request_edited:!0,pull_request_assigned:!0,pull_request_labeled:!0,pull_request_unlabeled:!0},Hn={pull_request_review_comment_created:!0,issue_comment_created:!0},Un={installation_deleted:!0,installation_suspend:!0,installation_unsuspend:!0,...En,...Hn},Wn={pull_request_opened:!0,pull_request_review_requested:!0,pull_request_review_submitted:!0,pull_request_closed:!0};(0,Ze.AO)((e=>{const t=(0,Ze.Yd)(Un);return(0,Ze.DE)(t,e)?{true:e}:{false:e}}));Nn.literals(...(0,Ze.Yd)({pull_request:!0,pull_request_review:!0,pull_request_review_comment:!0,installation:!0,issue_comment:!0})),Nn.literals(...(0,Ze.Yd)(Un)),Nn.literals(...(0,Ze.Yd)(Hn)),Nn.literals(...(0,Ze.Yd)(En));var Gn=o(733907),$n=o(396525),qn=o(840721),Qn=o(287968),Xn=o(122084),Yn=o(460709);const Jn=14,er=(0,P.defineMessages)({autoUpdate:{defaultMessage:"Auto-update",id:"collectionSettingsGithubAutomationConfig.statusPicker.autoUpdate"},when:{defaultMessage:"when PR is",id:"collectionSettingsGithubAutomationConfig.statusPicker.when"},addStatusDescription:{defaultMessage:"Add a status property to set up automations.",id:"collectionSettingsGithubAutomationConfig.addStatusDescription"},addStatusButton:{defaultMessage:"Add status property",id:"collectionSettingsGithubAutomationConfig.statusPicker.addStatusButton"},newStatusPropertyButton:{defaultMessage:"New status",id:"collectionSettingsGithubAutomationConfig.statusPicker.newStatusPropertyButton"},pull_request_opened:{defaultMessage:"Opened",id:"collectionSettingsGithubAutomationConfig.pullRequestOpened"},pull_request_review_requested:{defaultMessage:"Review requested",id:"collectionSettingsGithubAutomationConfig.pullRequestReviewRequested"},pull_request_review_submitted:{defaultMessage:"Approved",id:"collectionSettingsGithubAutomationConfig.pullRequestApproved"},pull_request_closed:{defaultMessage:"Merged",id:"collectionSettingsGithubAutomationConfig.pullRequestMerged"},noAutomations:{defaultMessage:"None",id:"collectionSettingsGithubAutomationConfig.noAutomation"},removeStatusOption:{defaultMessage:"Clear",id:"collectionSettingsGithubAutomationConfig.removeStatusOption"},linkBackToggle:{defaultMessage:"Enable Linkbacks to the linked page on GitHub",id:"collectionSettingsGithubAutomationConfig.linkBackToggle"},activityCommentsToggle:{defaultMessage:"Show GitHub activity on the linked page",id:"collectionSettingsGithubAutomationCofnig.activityToggle"}}),tr={pull_request_opened:So.default.formatMessage(er.pull_request_opened),pull_request_review_requested:So.default.formatMessage(er.pull_request_review_requested),pull_request_review_submitted:So.default.formatMessage(er.pull_request_review_submitted),pull_request_closed:So.default.formatMessage(er.pull_request_closed)},or=So.default.formatMessage(er.noAutomations),ir={pull_request_opened:null,pull_request_review_requested:null,pull_request_review_submitted:null,pull_request_closed:null},nr={github_linkbacks:!0,activity_comments:!1};function rr(e){const{gitHubProperty:t,selectedStatusProperty:o,setSelectedStatusProperty:s,intl:a}=e,l=(0,n.O7)(),c=(0,De.Y$)(),u=(0,n.Fy)(),p=cr(),g=(0,r.VK)((()=>_e.default.checkGate({gateName:"show_github_connected_property_settings"})),[]),m=(0,r.VK)((()=>{const e=(0,Ue.KV)(c,t);if(e&&(0,Lo.NK)(e))return e}),[c,t]),f=(0,r.VK)((()=>{const e=c.normalizedSchemaStore.state;return(0,Ze.qP)(e).flatMap((e=>{let[t,o]=e;return o&&(0,Lo.gB)(o)?[{id:t,schema:o}]:[]}))}),[c.normalizedSchemaStore]),S=(0,r.VK)((()=>m&&(0,Lo.NK)(m)&&(0,Ze.$K)(m.connectedRelation.automationSettings)?m.connectedRelation.automationSettings:nr),[m]);(0,i.useEffect)((()=>{v(S)}),[S]),(0,i.useEffect)((()=>{if(!o&&f.length>0){if(null!=m&&m.connectedRelation.automation)for(const t of f)if(m.connectedRelation.automation[t.id])return void s(t);const e=f[0];s(e)}}),[f,m,o,s]);const[y,h]=(0,i.useState)(ir),[x,v]=(0,i.useState)(nr),b=(0,i.useCallback)((e=>{const i=c.collectionStore();if(!(i&&o&&m&&(0,Lo.p_)(m)))return;const n=m.connectedRelation;n.automationSettings=e;const r={...m,connectedRelation:{...n}};d.createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomation",environment:l,perform:e=>{Po.xO({environment:l,collectionStore:i,update:{[t]:r},transaction:e})}}),v(e)}),[c,l,t,m,o]);(0,i.useEffect)((()=>{var e,t;o&&m&&(0,Lo.NK)(m)&&null!==(e=m.connectedRelation.automation)&&void 0!==e&&e[o.id]?h(null===(t=m.connectedRelation.automation)||void 0===t?void 0:t[o.id]):h(ir)}),[m,o]);const j=(0,i.useCallback)((e=>{const i=c.collectionStore();if(!(i&&o&&m&&(0,Lo.p_)(m)))return;const n=m.connectedRelation;if(!n||!o.id)return;n.automation={...n.automation,...e};const r={...m,connectedRelation:{...n}};ut.$q({environment:l,collectionContextStore:c,property:o.id,from:"github_pull_requests_property",action:"configure_github_pr_automation",githubAutomationConfigured:e}),d.createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomation",environment:l,perform:e=>{Po.xO({environment:l,collectionStore:i,update:{[t]:r},transaction:e})}})}),[c,o,m,l,t]),w=(0,r.VK)((()=>o&&o.schema.options?o.schema.options:[]),[o]),M=(0,r.VK)((()=>{const e={};return w.forEach((t=>{e[t.id]=t})),e}),[w]),_=(0,r.VK)((()=>{var e,t;const i=null==o||null===(e=o.schema)||void 0===e?void 0:e.groups,n=null==o||null===(t=o.schema)||void 0===t?void 0:t.options;return i&&n?i.map((e=>{const t=n.filter((t=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));if(0!==t.length)return{group:e,groupOptions:t}})).filter(Ze.$K):[]}),[o]);function k(e,t){const i=_.map((t=>{let{group:i,groupOptions:n}=t;const r=n.map((t=>({key:t.id,render:e=>(0,C.jsx)(L.Z,{...e,focused:e.focused,isTokenTitle:!0,title:(0,C.jsx)(Xn.F,{format:zn.lo.Small,value:t.value,color:t.color,showRemoveButton:!1,groupColor:i.color,isSingle:!0})}),action:()=>{const i={...y,[e]:t.id};o&&(j({[o.id]:i}),h(i))}}))).filter(Ze.$K);return{key:i.name,render:e=>(0,C.jsx)(U.Z,{...e,title:i.name,topBorder:e.index>0}),items:r}}));if(y[e]){function n(){const i={...y,[e]:null};o&&(j({[o.id]:i}),h(i)),t.close()}const r={key:"removeOptionSection",render:e=>(0,C.jsx)(U.Z,{...e,topBorder:!0}),items:[{key:"removeOptionButton",render:e=>(0,C.jsx)(L.Z,{...e,focused:!1,title:a.formatMessage(er.removeStatusOption),left:(0,T.y)({width:12}),onClick:n}),action:e=>{n()}}]};i.push(r)}return i}return o?(0,C.jsxs)(U.Z,{topBorder:!1,disableDesktopPadding:!0,disableMobilePadding:!0,title:(0,C.jsx)(ar,{selectedStatusProperty:o,setSelectedStatusProperty:s,existingStatusProperties:f,intl:a}),children:[(0,Ze.Yd)(Wn).map((e=>(0,C.jsx)($n.Z,{focused:!1,placementToOrigin:R.pO.Top,alignmentToOrigin:R.vR.End,popupType:u.isMobile?R.Z4.SlideUp:R.Z4.Popup,render:t=>{const o=u.isMobile?{menuType:Yn.og.Modal,right:(0,C.jsx)(qn.DoneMenuText,{}),onClickRight:t.close}:{menuType:Yn.og.Popup,width:150};return(0,C.jsx)(z.Z,{...o,children:(0,C.jsx)(N.Z,{type:N.i.Vertical,sections:k(e,t),initialFocus:void 0,onAccept:t.close})})},renderOrigin:t=>{const i=y[e];let n=(0,C.jsx)("div",{style:p.noneText,children:or});if(i){const e=M[i];if(e){var r;const t=null==o||null===(r=o.schema)||void 0===r||null===(r=r.groups)||void 0===r||null===(r=r.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(i)})))||void 0===r?void 0:r.color;n=(0,C.jsx)(Xn.F,{format:zn.lo.Small,showRemoveButton:!1,isSingle:!0,value:e.value,color:e.color,groupColor:t})}}return(0,C.jsx)(B.Z,{...t,focused:!1,icon:()=>(0,C.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap"},children:[tr[e],(0,C.jsx)(An.Z,{size:8}),(0,Gn.n)(p.automationMenuItemArrow)]}),title:(0,C.jsx)("div",{style:{width:"100%",display:"inline-flex",justifyContent:"flex-end"},children:n}),showChevron:!0,chevronStyle:{margin:0}})}},e))),(0,C.jsx)(Le.Z,{size:"100%",innerStyle:{borderColor:p.addStatusDivider.borderColor}}),g&&[{property:"github_linkbacks",setting:(0,C.jsx)(Qn.Z,{title:"Linkbacks in GitHub",subtitle:a.formatMessage(er.linkBackToggle),on:x.github_linkbacks,onChange:()=>{b({...x,github_linkbacks:!x.github_linkbacks})}})},{property:"activity_comments",setting:(0,C.jsx)(Qn.Z,{title:"Activity Comments",subtitle:a.formatMessage(er.activityCommentsToggle),on:x.activity_comments,onChange:()=>b({...x,activity_comments:!x.activity_comments})})}].map((e=>(0,C.jsx)("div",{style:p.otherAutomationsSettings,children:e.setting},e.property)))]}):(0,C.jsx)(sr,{setSelectedStatusProperty:s,intl:a})}function sr(e){const{setSelectedStatusProperty:t,intl:o}=e,i=(0,n.O7)(),r=(0,De.Y$)(),s=cr();return(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,C.jsx)(Le.Z,{size:"100%",innerStyle:s.addStatusDivider}),(0,C.jsx)("div",{style:s.addStatusDescription,children:o.formatMessage(er.addStatusDescription)}),(0,C.jsxs)(H.Z,{style:s.addStatusButton,onClick:e=>{e.stopPropagation(),lr(i,r,t)},children:[(0,Wt.R)({width:14}),(0,C.jsx)(An.Z,{size:4}),o.formatMessage(er.addStatusButton)]}),(0,C.jsx)(An.Z,{size:4})]})}function ar(e){const{selectedStatusProperty:t,setSelectedStatusProperty:o,existingStatusProperties:i,intl:r}=e,s=(0,n.O7)(),a=(0,De.Y$)(),l=(0,n.Fy)(),c=cr(),d=(0,f.Fg)(),u=i.map((e=>{const{id:t,schema:i}=e;return{key:t,action:()=>{o(e)},render:t=>(0,C.jsx)(L.Z,{...t,icon:(0,C.jsx)(Ro.ZP,{size:Jn,theme:d,icon:e&&e.schema.icon,type:"status"}),title:i.name})}})).filter(Ze.$K),p={key:"newStatusProperty",action:()=>{lr(s,a,o)},render:e=>(0,C.jsx)(L.Z,{...e,icon:(0,Wt.R)(c.statusPickerIcon),title:r.formatMessage(er.newStatusPropertyButton)})};return(0,C.jsxs)("div",{style:c.statusPickerWrapper,children:[(0,C.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[r.formatMessage(er.autoUpdate),l.isMobile&&(0,C.jsx)(An.Z,{size:4}),(0,C.jsx)(R.ZP,{placementToOrigin:R.pO.Bottom,alignmentToOrigin:R.vR.Start,popupType:l.isMobile?R.Z4.SlideUp:R.Z4.Popup,renderOrigin:e=>(0,C.jsx)(L.Z,{...e,title:t.schema.name,focused:!1,style:c.statusPickerButtonCore,textWrapperStyle:c.statusPickerButtonTextWrapper,left:(0,C.jsx)(Ro.ZP,{size:Jn,theme:d,icon:t.schema.icon,type:"status"}),leftStyle:{marginLeft:2},showExtensionArrow:!0,extensionArrowStyle:c.statusPickerExtensionArrow}),render:e=>{const t=l.isMobile?{menuType:Yn.og.ActionSheet}:{menuType:Yn.og.Popup,width:150};return(0,C.jsx)(z.Z,{...t,children:(0,C.jsx)(N.Z,{type:N.i.Vertical,sections:[{key:0,render:e=>(0,C.jsx)(U.Z,{...e}),items:[...u,p]}],initialFocus:0,onAccept:e.close})})}})]}),l.isMobile&&(0,C.jsx)(An.Z,{size:4}),r.formatMessage(er.when)]})}function lr(e,t,o){const i=t.collectionStore();i&&d.createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomationCreateNewStatusProperty",environment:e,perform:n=>{const r=Ae.G3({environment:e,collectionStore:i,collectionViewArgs:void 0,propertyType:"status",transaction:n}),s=(0,Ue.KV)(t,r);s&&(0,Lo.gB)(s)&&o({id:r,schema:s})}})}function cr(){const e=(0,n.Fy)().isMobile;return(0,f.yK)((t=>({addStatusDivider:{borderColor:t.tableDividerColor},addStatusDescription:{width:"calc(100% - 24px)",padding:e?"16px 8px":"14px 0px",fontSize:e?16:12,color:t.lightTextColor},addStatusButton:{width:"calc(100% - 24px)",display:"inline-flex",alignItems:"center",justifyContent:"center"},noneText:{color:t.lightTextColor},automationMenuItemArrow:{width:12,fill:t.lightIconColor,stroke:t.lightIconColor,strokeOpacity:.5,strokeWidth:2},statusPickerWrapper:{display:"inline-flex",alignItems:"center",flexWrap:"wrap",rowGap:2,marginBottom:e?10:void 0},statusPickerButtonTextWrapper:{margin:"0px 4px",fontSize:12},statusPickerButtonCore:{minHeight:e?28:20,borderRadius:5,maxWidth:e?150:100},statusPickerIcon:{width:Jn,height:Jn},statusPickerExtensionArrow:{transform:"rotate(180deg)",marginRight:2},otherAutomationsSettings:{padding:e?"0px 8px":"4px 14px"}})),[e])}var dr=o(464155);const ur=(0,P.defineMessages)({tabTitle:{defaultMessage:"GitHub Pull Requests",id:"database.viewSettings.githubConfigTab.tabTitle"},connect:{defaultMessage:"Connect to GitHub (Workspace)",id:"database.viewSettings.githubConfigTab.connect"},connectDescriptionAdmin:{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) connection.",id:"database.viewSettings.githubConfigTab.connectDescriptionAdmin"},authError:{defaultMessage:"Auth failed. Please try again or contact Notion support.",id:"database.viewSettings.githubConfigTab.authError"},tabDescriptionNoIdPrefix:{defaultMessage:"This feature requires a prefixed ID property to link GitHub PRs to Notion {pluralItemName}.",id:"database.viewSettings.githubConfigTab.tabDescriptionNoIdPrefix"},tabDescriptionNoStatus:{defaultMessage:"Link PRs by adding the {singleItemName} ID to the PR title.",id:"database.viewSettings.githubConfigTab.tabDescriptionNoStatus"},tabDescription:{defaultMessage:"Link PRs by adding the {singleItemName} ID to the PR title. Set up automated status updates in Notion based on PR status changes.",id:"database.viewSettings.githubConfigTab.tabDescription"}});function pr(e){let{collectionContextStore:t,intl:o}=e;const i=vr(),{hoveredBackground:s,pressedBackground:a}=xr(),l=(0,Bn.J)(),c=(0,n.O7)(),d=hr(),u=function(e){return(0,r.VK)((()=>{var t;return null===(t=e.collectionStore())||void 0===t?void 0:t.getSpaceId()}),[e])}(t);return(0,C.jsxs)(U.Z,{disableMobileBorders:!0,mobileStyle:i.previewContentContainer,style:i.previewContentContainer,children:[(0,C.jsx)("img",{src:"/images/external_integrations/github-icon.png",style:{width:36,height:36}}),(0,C.jsx)("p",{style:i.connectDescription,children:l?(0,Zn.GT)().description:o.formatMessage(ur.connectDescriptionAdmin)}),(0,C.jsx)(Co.Z,{style:i.connectButton,hoveredStyle:{background:s},pressedStyle:{background:a},disabled:!l,disabledFeedback:!l,onClick:async e=>{if(e.preventDefault(),u&&d)try{await Gt.hM({environment:c,spaceId:u,integration:d,from:"connected_relation_property_menu"})}catch(t){const e=o.formatMessage(ur.authError);F.showErrorMessage(e)}},children:o.formatMessage(ur.connect)}),(0,C.jsx)(An.Z,{size:4})]})}function gr(e){let{collectionContextStore:t}=e;const o=vr(),{isMobile:i}=(0,n.Fy)(),r=yr(t);return(0,C.jsxs)(U.Z,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:o.previewContentContainer,style:o.previewContentContainer,children:[(0,C.jsx)(An.Z,{size:i?16:8}),(0,C.jsx)(dr.Z,{width:"calc(100% - 24px)",uniqueIdPrefix:null==r?void 0:r.prefix})]})}function mr(e){let{collectionContextStore:t,intl:o,selectedStatusProperty:i}=e;const n=(0,r.VK)((()=>t.databaseType),[t]),s=yr(t),a=vr(),l=(0,Ke.sN)(n),c=(0,Ke.Q_)(n);let d;return d=s&&s.prefix?i?o.formatMessage(ur.tabDescription,{singleItemName:l}):o.formatMessage(ur.tabDescriptionNoStatus,{singleItemName:l}):o.formatMessage(ur.tabDescriptionNoIdPrefix,{pluralItemName:c}),(0,C.jsx)(U.Z,{disableMobileBorders:!0,disableMobilePadding:!0,mobileStyle:a.tabDescription,style:a.tabDescription,children:d})}function fr(e){let{collectionContextStore:t}=e;const o=yr(t);return o&&o.prefix?null:(0,C.jsx)(Rn,{collectionContextStore:t,uniqueIdProperty:o&&{propertyId:o.id,propertySchema:o.schema},prefixValue:null==o?void 0:o.prefix})}function Sr(e){let{collectionContextStore:t,selectedStatusProperty:o,setSelectedStatusProperty:i,property:n,intl:r}=e;const s=yr(t);return s&&s.prefix?(0,C.jsx)(rr,{selectedStatusProperty:o,setSelectedStatusProperty:i,gitHubProperty:n,intl:r}):null}function yr(e){return(0,r.VK)((()=>{var t,o;const i=null===(t=e.collectionStore())||void 0===t||null===(t=t.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey(),n=null===(o=e.collectionStore())||void 0===o?void 0:o.getSchema(),r=n&&(0,Ze.qP)(n).find((e=>{let[,t]=e;return t&&"auto_increment_id"===t.type}));if(r){const[e,t]=r;if(t&&"auto_increment_id"===t.type)return{id:e,schema:t,prefix:i}}}),[e])}function hr(){return(0,r.VK)((()=>Xt.Z.integrations.state.find((e=>e.id===fi.U9))),[])}function xr(){const e=hr(),t=(0,f.Fg)();return(0,r.VK)((()=>vo(e,t.mode)),[e,t.mode])}function vr(){const{isMobile:e}=(0,n.Fy)(),{background:t}=xr();return(0,f.yK)((o=>({previewContentContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},connectButton:{fontSize:14,maxWidth:"calc(100% - 24px)",height:void 0,color:o.regularInvertedTextColor,background:t,whiteSpace:"normal",padding:8,textAlign:"center"},connectDescription:{maxWidth:"calc(100% - 24px)",color:o.lightTextColor,fontSize:14,textAlign:"center"},tabDescription:{padding:e?18:14,fontSize:e?16:12,color:o.lightTextColor}})),[e,t])}const Cr=(0,P.injectIntl)((function(e){const{collectionContextStore:t,property:o,intl:n}=e,[s,a]=(0,i.useState)(void 0);return(0,r.VK)((()=>{const e=Xt.Z.bots.state.find((e=>e.integration_id===fi.U9));return Boolean(e)}),[])?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(gr,{collectionContextStore:t}),(0,C.jsx)(mr,{collectionContextStore:t,intl:n,selectedStatusProperty:s}),(0,C.jsx)(fr,{collectionContextStore:t}),(0,C.jsx)(Sr,{collectionContextStore:t,selectedStatusProperty:s,setSelectedStatusProperty:a,property:o,intl:n})]}):(0,C.jsx)(pr,{collectionContextStore:t,intl:n})}));o(21703);var br=o(973935),jr=o(883355),wr=o(749085),Mr=o(605257),_r=o(388437),kr=o(755964),Vr=o(519889),Tr=o(803791),Pr=o(413182),Ir=o(10910),Fr=o(287085),Zr=o(416536),Ar=o(940663),Br=o(143627),Kr=o(830905);function Or(e){let{setAiInference:t,aiInference:o,disabled:n}=e;const r=(0,i.useRef)((0,s.ZP)()),a=()=>{if(!o)return;const e={...o,add_options:!o.add_options};t(e)};return(0,C.jsx)($t.Z,{renderTooltip:()=>(0,C.jsx)(P.FormattedMessage,{id:"collectionSettingsAiAutofillAddOptionsToggle.title.description",defaultMessage:"New options are created based on property name & page details"}),placement:Qt.u.Bottom,render:e=>(0,C.jsx)(B.Z,{title:(0,C.jsx)(P.FormattedMessage,{id:"collectionSettingsAiAutofillAddOptionsToggle.title.text",defaultMessage:"Generate new options"}),showChevron:!1,right:(0,C.jsx)(gt.Z,{inputId:r.current,on:!(null==o||!o.add_options),onClick:a,disabled:!1,noColor:!1}),onClick:a,disabled:Boolean(n),textWrapperStyle:{minWidth:"auto"},...e})})}const Lr=i.memo(Or);var Rr=o(974420),Dr=o(418145),zr=o(599417),Nr=o(319124),Er=o(177546),Hr=o(394841),Ur=o(67695),Wr=o(896026),Gr=o(288280),$r=o(217095),qr=o(127871),Qr=o(313991),Xr=o(640506),Yr=o(111843);const Jr=function(e){let{collectionContextStore:t,property:o}=e;const i=(0,P.useIntl)(),s=(0,n.O7)(),a=(0,r.VK)((()=>es(t,o)),[t,o]),l=(0,r.VK)((()=>t.getPropertyFormat(o)),[t,o]);if(!a)return null;const c=(null==l?void 0:l.date_format)||a.date_format||Xr.sF,u=function(e){const t=ts();for(const o in t)if(t[o]===e)return o;return"12h"}((null==l?void 0:l.time_format)||a.time_format||Xr.c_);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Ge.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Date format",id:"database.viewSettings.dateOptions.dateFormat"}),selectedKey:c,popupStyle:{minWidth:190},options:Xr.Zy.map((e=>({key:e,title:i.formatMessage(Xr.fy[e])}))),onChange:e=>function(e,t,o,i){const n="collectionTypedView"===o.contextType;if(n){const n=o.formatStore();if(!n)return;const r=o.getPropertyFormatKey();if(!r)return;d.createAndCommit({userAction:"CollectionSettingsDateOptions.handleMsvDateFormatChange",environment:t,perform:t=>{Ae.er({formatStore:n,formatKey:r,property:i,update:{date_format:e},transaction:t})}})}else{const n=o.collectionStore(),r=es(o,i);if(!n||!r)return;const s={...r,date_format:e};d.createAndCommit({userAction:"CollectionSettingsDateOptions.handleDateFormatChange",environment:t,perform:e=>{Po.xO({environment:t,collectionStore:n,update:{[i]:s},transaction:e})}})}ut.$q({environment:t,collectionContextStore:o,property:i,from:"view_settings",action:"date_change_format"})}(e,s,t,o)}),(0,C.jsx)(Ge.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Time format",id:"database.viewSettings.dateOptions.timeFormat"}),selectedKey:u,popupStyle:{minWidth:190},options:Xr.L7.map((e=>({key:e,title:i.formatMessage(Xr.Fi[e])}))),onChange:e=>function(e,t,o,i){const n=ts()[e],r="collectionTypedView"===o.contextType;if(r){const e=o.formatStore();if(!e)return;const r=o.getPropertyFormatKey();if(!r)return;d.createAndCommit({userAction:"CollectionSettingsDateOptions.handleMsvClockFormatChange",environment:t,perform:t=>{Ae.er({formatStore:e,formatKey:r,property:i,update:{time_format:n},transaction:t})}})}else{const e=o.collectionStore(),r=es(o,i);if(!e||!r)return;const s={...r,time_format:n};d.createAndCommit({userAction:"CollectionSettingsDateOptions.handleClockFormatChange",environment:t,perform:o=>{Po.xO({environment:t,collectionStore:e,update:{[i]:s},transaction:o})}})}ut.$q({environment:t,collectionContextStore:o,property:i,from:"view_settings",action:"date_change_time_format"})}(e,s,t,o)})]})};function es(e,t){const o=e.normalizedSchemaStore.state[t];if(o)return"date"===o.type||"created_time"===o.type||"last_edited_time"===o.type||"last_visited_time"===o.type?o:void 0}function ts(){return(0,Yr.E)(Qr.SP).time}var os=o(222686);function is(e){const{collectionContextStore:t,property:o,propertySchema:r}=e,s=(0,n.O7)(),a=(0,i.useCallback)((e=>{const i={...r,default:"created_by"===e?"created_by":void 0},n=t.collectionStore();n&&(Po.HW({environment:s,collectionStore:n,performTransaction:t=>{d.applyOperation({store:(0,Go.Kv)(n,n.pointer),operation:{pointer:n.pointer,command:"update",path:["schema",o],args:{default:e}},transaction:t})}}),d.createAndCommit({userAction:"CollectionSettingsDefaultPersonPicker.handleChange",environment:s,perform:e=>{Po.xO({environment:s,collectionStore:n,update:{[o]:i},transaction:e})}}))}),[t,s,o,r]);return(0,C.jsx)(Ge.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Default",id:"CollectionSettingsDefaultPersonPicker.default.title"}),selectedKey:r.default?"created_by":"no_default",popupStyle:{minWidth:190},options:[{key:"no_default",title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"No default",id:"CollectionSettingsDefaultPersonPicker.options.noDefault"})},{key:"created_by",title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Created by",id:"CollectionSettingsDefaultPersonPicker.options.creator"}),icon:(0,os.f)({width:16})}],onChange:a})}var ns=o(872589),rs=o(296994);function ss(e){let{collectionContextStore:t,collectionSettingsStore:o,property:s}=e;const a=(0,n.O7)(),l=(0,r.qz)(void 0,We.Z),c=(0,i.useCallback)((e=>{const i=t.collectionStore();if(!i)return null;const n=t.normalizedSchemaStore.state[s];if("formula"!==(null==n?void 0:n.type))return;const r=Boolean(i.getDatabaseType()&&i.isTypedProperty(s)),l=null==o?void 0:o.getState().fromBlockStore;return(0,C.jsx)(ue.ev,{dependency:rs.FF.formulas,children:t=>(0,C.jsx)(ns.Z,{handleClose:e.close,property:s,getRecordModel:i.getRecordModel,propertySchema:n,collectionStore:i,handleSave:e=>function(e,t){const{newValue:o,newType:i,propertySchema:n,property:r,collectionStore:s}=e,a=o?{...n,formula2:{code:o,result_type:i},version:"v2"}:{...n,formula2:void 0,version:"v2"};d.createAndCommit({userAction:"CollectionSettingsFormulaOptions.handleFormulaChange",environment:t,perform:e=>{Po.xO({environment:t,collectionStore:s,update:{[r]:a},transaction:e})}})}(e,a),formulas:t,disabled:r,blockStore:l,analyticsFrom:"view_settings"})})}),[t,o,a,s]);return(0,C.jsx)(R.ZP,{popupType:a.device.isMobile?E.kQ.SlideUp:E.kQ.Popup,alignmentToOrigin:R.vR.End,renderOrigin:e=>(0,C.jsx)(B.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Formula",id:"database.viewSettings.formulaOptions.title"}),right:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Edit",id:"database.viewSettings.formulaOptions.edit"}),showChevron:!0,rotateChevron:l.state.open,...e}),render:c,buttonPopupStore:l})}const as=i.memo(ss,No.Z);var ls=o(373590),cs=o(435011),ds=o(334299),us=o(335102),ps=o(542853),gs=o(423512),ms=o(385248),fs=o(278942),Ss=o(915157);const ys="LastUsedCurrency",hs=wr.default.createClass("",{name:"NumberFormatFilterStore"});const xs=function(e){let{collectionStore:t,property:o,schema:s,onClose:a}=e;const l=(0,n.O7)(),c=(0,r.qz)(void 0,ai.Z),u=(0,r.qz)(void 0,hs),p=(0,i.useCallback)((e=>function(e,t,o){t.setState(e.target.value),o.setState({...o.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}(e,u,c)),[u,c]),g=(0,r.VK)((()=>u.state),[u]),m=(0,r.VK)((()=>function(e,t,o,i,n,r){const s=Ss.Z.get({userId:e.currentUser.id,key:ys}),a=(0,to.ZP)(n.state,(0,gs.jD)(s),(e=>e));return a.map((n=>{const s={key:n,render:e=>(0,C.jsx)(vs,{name:n,props:e}),action:()=>function(e,t,o,i,n,r){const s=i[o];if(!s)return;if("number"!==s.type&&"formula"!==s.type)return;const a={...s,number_format:e,..."percent"===e&&void 0!==(null==s?void 0:s.show_as)?{show_as:{...null==s?void 0:s.show_as,maxValue:1}}:{}};"number"===s.type&&(0,gs.b3)(e)&&Ss.Z.set({userId:n.currentUser.id,key:ys,value:e});d.createAndCommit({userAction:"NumberFormatMenu.handleNumberFormatChange",environment:n,perform:e=>{Po.xO({environment:n,collectionStore:t,update:{[o]:a},transaction:e})}}),null==r||r()}(n,t,o,i,e,r)};return s}))}(l,t,o,s,u,a)),[l,t,o,s,u,a]),{device:f}=l;let S;S=f.isMobile?{menuType:Yn.og.ActionSheet}:{menuType:Yn.og.Popup};const y=!f.isMobile&&(0,C.jsx)(U.Z,{isInput:!0,children:(0,C.jsx)(po.ZP,{value:g,onChange:p,focus:!0,focusAfterAnimation:!0,placeholder:So.default.getIntl().formatMessage({defaultMessage:"Filter formats…",id:"blockPropertyValue.filterForNumberFormats.placeholder"}),preventCaptureDeleteWhenEmpty:!0})});return(0,C.jsx)(z.Z,{...S,header:y,children:(0,C.jsx)(N.Z,{type:N.i.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,C.jsx)(U.Z,{...e}),items:m}],store:c})})};function vs(e){let{name:t,props:o}=e;return(0,C.jsx)(L.Z,{...o,title:(0,gs.Bo)(So.default.getIntl(),t)})}var Cs=o(409050),bs=o(816187);function js(e){let{collectionContextStore:t,property:o}=e;const{propertySchema:i,numberFormat:n}=(0,r.VK)((()=>{const e=t.collectionStore(),i=t.normalizedSchemaStore.state[o];if(!i||!e)return{};if("number"===i.type)return{propertySchema:i,numberFormat:i.number_format??gs.dk};if("formula"===i.type)return"number"===(0,cs.mm)(i)||i.formula2&&"number"===(0,us.aL)(i.formula2.result_type).type?{propertySchema:i,numberFormat:i.number_format??gs.dk}:{};if("rollup"===i.type){var n;if(i.aggregation&&"show_unique"!==i.aggregation){var r;const n=null===(r=(0,ds.gT)({property:o,schema:t.normalizedSchemaStore.state,getRecordModel:e.getRecordModel}))||void 0===r?void 0:r.targetPropertySchema;if(void 0===(null==n?void 0:n.type))return{};const s=(0,bs.SD)(i.aggregation,(0,bs.SD)(i.aggregation,"number_format"in n?n.number_format:void 0));return s?{propertySchema:i,numberFormat:s}:{}}const s=null===(n=(0,ds.gT)({property:o,schema:t.normalizedSchemaStore.state,getRecordModel:e.getRecordModel}))||void 0===n?void 0:n.targetPropertySchema;if("number"===(null==s?void 0:s.type)||"formula"===(null==s?void 0:s.type)&&"number"===(0,cs.r9)(s))return{propertySchema:i,numberFormat:s.number_format??gs.dk}}return{}}),[t,o]);if(!i)return null;const s="rollup"!==i.type;return(0,C.jsxs)(C.Fragment,{children:[s?(0,C.jsx)(ws,{numberFormat:n,property:o}):null,(0,C.jsx)(Ms,{property:o,propertySchema:i,numberFormat:n})]})}function ws(e){let{numberFormat:t,property:o}=e;const i=(0,De.Y$)(),s=(0,r.qz)(void 0,We.Z),a=(0,P.useIntl)(),l=(0,n.O7)();return(0,C.jsx)(R.ZP,{popupType:l.device.isMobile?E.kQ.SlideUp:E.kQ.Popup,alignmentToOrigin:R.vR.End,renderOrigin:e=>(0,C.jsx)(B.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Number format",id:"database.viewSettings.numberOptions.numberFormat"}),right:(0,C.jsx)("span",{style:{...I.Z.textOverflowStyle},children:(0,gs.Bo)(a,gs.dX.find((e=>e===t))??gs.dk)}),showChevron:!0,rotateChevron:s.state.open,...e}),render:e=>{const t=i.collectionStore(),n=i.normalizedSchemaStore.state;if(t)return(0,C.jsx)(xs,{collectionStore:t,property:o,schema:n,onClose:e.close})},buttonPopupStore:s})}function Ms(e){let{property:t,propertySchema:o,numberFormat:s}=e;const{show_as:a}=o,l=(0,De.Y$)(),c=(0,n.O7)(),u=(0,f.Fg)(),g=i.useRef({color:(null==a?void 0:a.color)??"green",maxValue:(null==a?void 0:a.maxValue)??100,showValue:(null==a?void 0:a.showValue)??!0}),m=(0,r.VK)((()=>Ei.Z.state.isOpen),[]),S={type:(null==a?void 0:a.type)??"number",color:(null==a?void 0:a.color)??g.current.color,maxValue:(null==a?void 0:a.maxValue)??g.current.maxValue,showValue:(null==a?void 0:a.showValue)??g.current.showValue},y=(0,f.yK)((e=>({card:{boxSizing:"content-box",height:36,flex:1,margin:1,boxShadow:`0 0 0 1px ${e.regularDividerColor}`,color:e.mediumTextColor,borderRadius:4,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",paddingLeft:12,paddingRight:12,paddingTop:6,paddingBottom:6,cursor:"pointer"},selectedCard:{boxShadow:`0 0 0 2px ${e.blueColor}`,color:e.blueColor},cardVisual:{height:20,marginBottom:4,width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},cardText:{lineHeight:1,fontSize:12},progressBar:{width:"100%"},showAsTypeOption:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginLeft:16,marginRight:16,marginTop:6,gap:12},extraOptionStyle:{display:"flex",flexDirection:"row",alignItems:"center",paddingLeft:16,paddingRight:16,gap:16,height:28,width:"100%"}})),[]),h=(0,i.useCallback)((e=>{const i=l.collectionStore();o&&i&&(d.createAndCommit({userAction:"CollectionSettingsProperty.handleNumberShowAsChange",environment:c,perform:n=>{Po.xO({environment:c,collectionStore:i,update:{[t]:{...o,show_as:e}},transaction:n})}}),ut.$q({environment:c,collectionContextStore:l,property:t,from:"view_settings",action:"number_change_show_as",number_show_as:(null==e?void 0:e.type)??"number"}))}),[l,c,t,o]),x=[{key:"number",visual:(0,C.jsx)("div",{style:{fontSize:16,fontWeight:I.Z.fontWeight.medium},children:"42"}),text:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Number",id:"database.viewSettings.numberOptions.showAsNumber"})},{key:"bar",visual:(0,C.jsx)(ms.k,{percentage:50,filledColor:"bar"===S.type?u.blueColor:u.regularDividerColor,unfilledColor:"bar"===S.type?u.accentColors.blue[50]:u.regularDividerColor,style:{width:"100%"}}),text:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Bar",id:"database.viewSettings.numberOptions.showAsBar"})},{key:"ring",visual:(0,C.jsx)(fs.e,{size:20,percentage:40,filledColor:"ring"===S.type?u.blueColor:u.regularDividerColor,unfilledColor:"ring"===S.type?u.accentColors.blue[50]:u.accentColors.gray[100],style:{width:"100%"}}),text:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Ring",id:"database.viewSettings.numberOptions.showAsRing"})}],v=(0,C.jsx)("div",{style:y.showAsTypeOption,children:x.map((e=>{const t=S.type===e.key;return(0,C.jsxs)(xi.Z,{onClick:()=>{const t="number"===e.key?void 0:{type:e.key,color:S.color,maxValue:"percent"===s?1:S.maxValue,showValue:S.showValue};void 0!==t&&(g.current=t),h(t)},style:{...y.card,...t?y.selectedCard:{}},children:[(0,C.jsx)("div",{style:y.cardVisual,children:e.visual}),(0,C.jsx)("div",{style:y.cardText,children:e.text})]},e.key)}))}),b=e=>{const t="number"!==S.type?{...S,type:S.type,...e}:void 0;void 0!==t&&(g.current=t),h(t)},j="number"!==S.type?(0,C.jsxs)("div",{style:y.extraOptionStyle,children:[(0,C.jsx)("div",{style:{flex:6,fontSize:14},children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Color",id:"database.viewSettings.numberOptions.color"})}),(0,C.jsx)("div",{style:{display:"flex",flexWrap:"wrap",flex:6,gap:7},children:(0,C.jsx)(R.ZP,{popupType:c.device.isMobile?R.Z4.SlideUp:R.Z4.Popup,renderOrigin:e=>(0,C.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"end"},...e,children:(0,C.jsx)(Cs.Z,{color:S.color,focused:!1,buttonStyle:{width:"auto",marginLeft:0,marginRight:0,borderRadius:4,color:u.lightTextColor},style:{minHeight:36},right:(0,ps.i)({width:12,height:12})})}),render:e=>{const t=no.AP.map((t=>(0,C.jsx)(Cs.Z,{color:t,checkState:t===S.color,focused:!1,style:{width:"100%"},onClick:()=>{b({color:t}),e.close()}},t)));return(0,C.jsx)("div",{style:{minWidth:150,paddingTop:8,paddingBottom:8},children:t})}})})]}):null,w="number"!==S.type?"percent"!==s&&(0,C.jsxs)("div",{style:y.extraOptionStyle,children:[(0,C.jsx)("div",{style:{flex:6,fontSize:14},children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Divide by",id:"database.viewSettings.numberOptions.divideBy"})}),(0,C.jsx)("div",{style:{flex:6},children:(0,C.jsx)(p.Z,{value:S.maxValue.toString(),onChange:e=>{const t=e.target.value.replace(/[^0-9]/g,""),o=parseFloat(t);!isNaN(o)&&o>0&&b({maxValue:o})},inputStyle:{textAlign:"right"}})})]}):null,M="number"!==S.type?(0,C.jsxs)("div",{style:y.extraOptionStyle,children:[(0,C.jsx)("div",{style:{flex:6,fontSize:14},children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Show number",id:"database.viewSettings.numberOptions.showValue"})}),(0,C.jsx)("div",{style:{flex:6,display:"flex",justifyContent:"flex-end"},children:(0,C.jsx)(gt.Z,{on:S.showValue,onClick:()=>{b({showValue:!S.showValue})},disabled:!1})})]}):null,_=Boolean(j||w||M),k=(0,C.jsxs)("div",{style:{backgroundColor:u.accentColors.gray[30],borderRadius:5,marginTop:_?12:0,marginLeft:_?14:0,marginRight:_?14:0,paddingTop:_?12:0,paddingBottom:_?12:0,maxHeight:_?1e3:0,transition:"max-height 0.5s ease-in-out",overflow:"hidden",display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[j,w,M]});return(0,C.jsxs)(U.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Show as",id:"database.viewSettings.numberPercentOptions.showAs"}),topBorder:!0,disableMobileBorders:!0,children:[v,k,!m&&(0,C.jsx)("div",{style:{marginTop:12,marginLeft:18,marginRight:18,fontSize:12,color:u.lightTextColor},children:(0,C.jsx)(P.FormattedMessage,{id:"database.CollectionSettings.NumberOptions.applyAllViews",defaultMessage:"Changes apply to all views showing this property."})})]})}var _s=o(627948),ks=o(215828),Vs=o(374617),Ts=o(279131),Ps=o(492658),Is=o(873456);function Fs(e){var t;const o=(0,n.O7)(),s=(0,f.Fg)(),{isMobile:a}=(0,n.Fy)(),{property:l,option:c,statusGroup:u,propertySchema:p,isDefault:g,disabled:m}=e,S=(0,De.Y$)(),y=(0,r.VK)((()=>{var e;return null===(e=S.collectionStore())||void 0===e?void 0:e.id}),[S]),h=(0,r.qz)(void 0,We.Z),x=(0,r.VK)((()=>h.state.open),[h]),v=(0,i.useCallback)((()=>{h.setState({open:!0})}),[h]),b=(0,i.useCallback)((()=>{h.setState({open:!1})}),[h]),j=(0,i.useCallback)((e=>{const t=S.collectionStore();t&&Po.HW({environment:o,collectionStore:t,performTransaction:o=>{for(const i of e)d.applyOperation({store:(0,Go.Kv)(t,i.pointer),operation:i,transaction:o})}})}),[S,o]),w=(0,f.yK)((()=>({defaultText:{fontSize:12,fontWeight:500,textTransform:"uppercase"}})),[]);return y?(0,C.jsx)(Is.Z,{open:x,origin:(0,C.jsx)($t.Z,{renderTooltip:e=>(0,C.jsxs)("div",{...e,style:ji.F6,children:[(0,C.jsx)("div",{children:c.value}),(0,C.jsx)("div",{style:{color:s.mediumInvertedTextColor},children:c.description})]}),placement:Qt.u.Left,disableTooltip:!(null!==(t=c.description)&&void 0!==t&&t.length),render:e=>{var t,o;return(0,C.jsx)(B.Z,{...e,showDragHandle:!0,showChevron:!0,disabled:m,rotateChevron:x,title:"status"===p.type?(0,C.jsx)(Xn.F,{format:a?zn.lo.Large:zn.lo.Medium,value:c.value,color:c.color,hideTooltip:!(null===(t=c.description)||void 0===t||!t.length),tooltipPlacement:Qt.u.Left,showRemoveButton:!1,isSingle:!0,groupColor:null==u?void 0:u.color}):(0,C.jsx)(Xn.a,{format:a?zn.lo.Large:zn.lo.Medium,value:c.value,color:c.color,hideTooltip:!(null===(o=c.description)||void 0===o||!o.length),tooltipPlacement:Qt.u.Left,showRemoveButton:!1,isSingle:!0}),right:g?(0,C.jsx)("span",{style:w.defaultText,children:(0,C.jsx)(P.FormattedMessage,{id:"database.statusProperty.default",defaultMessage:"Default"})}):void 0,onClick:v})}}),option:c,property:l,propertySchema:p,statusGroup:u,collectionId:y,analyticsFrom:"view_settings",alignmentToOrigin:Qt.v.End,onChange:j,onClose:b}):null}const Zs=wr.default.createClass(void 0,{name:"InputGroupIndexStore"});const As=function(e){let{collectionContextStore:t,property:o,disabled:i,aIAutofillOption:s}=e;const a=(0,n.O7)(),l=(0,r.qz)(void 0,Zs),c=(0,r.qz)(void 0,Ps.Z),u=(0,r.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),p=(0,r.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().app_config_uri}),[t]),g=(0,r.VK)((()=>Os(t,o)),[t,o]),m=(0,r.VK)((()=>c.state),[c]),f=(0,r.VK)((()=>l.state),[l]);if(!u||!g)return null;if("status"===g.type){const e=g.groups??[];if(0===e.length)return null;const n=g.options??[],r=e.map((e=>{const t=n.filter((t=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return{group:e,groupOptions:t}})),s=g.defaultOption,d=[...r[0].groupOptions.map((e=>e.value))];for(const{group:t,groupOptions:o}of r.slice(1))d.push({key:`group-header-${t.name}`,draggable:!1}),d.push(...o.map((e=>e.value)));const S=(0,Ar.Hw)(p,u,o)?{tooltipCaption:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"These options are core to the property and cannot be changed.",id:"database.viewSettings.selectOptions.disabledGroupMessage"})}:void 0,y=(a,d)=>{if(a.startsWith("group-header-")){const e=a.substring(13),n=r.findIndex((t=>{let{group:o}=t;return o.name===e})),{group:s,groupOptions:d}=r[n];return(0,C.jsxs)(Bs,{title:(0,C.jsx)(Vs.r_,{disableGroup:S,group:s,showIcon:!1}),right:!m.focus&&(0,C.jsx)(Ls,{collectionContextStore:t,property:o,onClick:()=>Ds(c,l,n)}),disabled:i,children:[f===n&&(0,C.jsx)(Ns,{collectionContextStore:t,property:o,inputStore:c,inputGroupIndexStore:l}),!m.focus&&0===d.length&&(0,C.jsx)(Es,{inputStore:c,inputGroupIndexStore:l,groupIndex:n})]})}{const t=n.find((e=>e.value===a));if(!t)return null;const r=e.find((e=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return(0,C.jsx)(Fs,{option:t,statusGroup:r,propertySchema:g,property:o,isDefault:t.value===s,disabled:i},t.value)}};return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(Bs,{title:(0,C.jsx)(Vs.r_,{disableGroup:S,group:r[0].group}),right:!m.focus&&(0,C.jsx)(Ls,{collectionContextStore:t,property:o,onClick:()=>Ds(c,l,0)}),disabled:i,children:[0===f&&(0,C.jsx)(Ns,{collectionContextStore:t,property:o,inputStore:c,inputGroupIndexStore:l}),!m.focus&&0===r[0].groupOptions.length&&(0,C.jsx)(Es,{inputStore:c,inputGroupIndexStore:l,groupIndex:0})]}),(0,C.jsx)(Ts.ZP,{direction:"vertical",keys:d,renderKey:y,onDrop:e=>Rs(e,a,o,t),disabled:i})]})}{const e=g.options??[],n=e.map((e=>e.value)),r=g.auto_sort_options||"manual";return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Ge.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Sort",id:"database.viewSettings.selectOptions.autoSort"}),selectedKey:r,options:[{key:"manual",title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Manual",id:"database.viewSettings.selectOptions.autoSort.none"})},{key:"alphabetical",title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Alphabetical",id:"database.viewSettings.selectOptions.autoSort.alphabetical"})},{key:"reverse_alphabetical",title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Reverse alphabetical",id:"database.viewSettings.selectOptions.autoSort.reverseAlphabetical"})}],onChange:e=>function(e,t,o,i){const n=o.collectionStore(),r=o.normalizedSchemaStore.state,s=Os(o,i);if(!n||!s)return;if(!(0,Lo.cu)(s))return;const a=[{pointer:n.pointer,command:"update",path:["schema",i],args:{auto_sort_options:e}}];"alphabetical"!==e&&"reverse_alphabetical"!==e||a.push(...(0,Oe.L5)({collectionId:n.id,property:i,propertySchema:s,schema:r,isAscending:"alphabetical"===e})||[]);Po.HW({environment:t,collectionStore:n,performTransaction:e=>{for(const t of a)d.applyOperation({store:(0,Go.Kv)(n,t.pointer),operation:t,transaction:e})}}),ut.$q({environment:t,collectionContextStore:o,property:i,from:"view_settings",action:"select_change_auto_sort_options"})}(e,a,t,o),popupStyle:{minWidth:190}},"autoSortMenuItem"),s,(0,C.jsx)(Bs,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Options",id:"database.viewSettings.selectOptions.title"}),right:!m.focus&&n.length>0&&(0,C.jsx)(Ls,{collectionContextStore:t,property:o,onClick:()=>Ds(c,l)}),disabled:i,children:(0,C.jsx)(Ns,{collectionContextStore:t,property:o,inputStore:c,inputGroupIndexStore:l})},"sectionHeader"),n.length>0&&(0,C.jsx)(Ts.ZP,{direction:"vertical",keys:n,renderKey:t=>{const n=e.find((e=>e.value===t));return n?(0,C.jsx)(Fs,{option:n,property:o,propertySchema:g,isDefault:!1,statusGroup:void 0,disabled:i},n.value):null},onDrop:e=>Rs(e,a,o,t)}),!m.focus&&0===n.length&&(0,C.jsx)(Es,{inputStore:c,inputGroupIndexStore:l})]})}};function Bs(e){let{title:t,right:o,children:i,disabled:n,overrideStyle:r}=e;return(0,C.jsx)(U.Z,{topBorder:!0,title:t,desktopTitleStyle:{height:20},right:!n&&o,style:{width:"100%",paddingBottom:0,...r},children:!n&&i})}function Ks(){return(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Option already exists.",id:"database.optionExistsAlreadyError.message"})}function Os(e,t){const o=e.normalizedSchemaStore.state[t];if(o&&((0,Lo.cu)(o)||"status"===o.type))return o}function Ls(e){let{onClick:t,collectionContextStore:o,property:i}=e;const n=(0,P.useIntl)();return(0,r.VK)((()=>Os(o,i)),[o,i])?(0,C.jsx)(Ho.Z,{icon:Wt.R,onClick:t,style:{width:20,height:20},ariaLabel:n.formatMessage({defaultMessage:"Add an option",id:"database.viewSettings.selectOptions.addOption"})}):null}function Rs(e,t,o,i){const n=i.normalizedSchemaStore.state,r=i.collectionStore();if(!r)return;const s=n[o];let a;if("status"===(null==s?void 0:s.type)){a=[[]];for(const t of e)t.startsWith("group-header-")?a.push([]):a[a.length-1].push(t)}else a=e;const l=(0,Oe.YL)({newOptions:a,collectionId:r.id,property:o,schema:n});if(l){if(s&&(0,Lo.cu)(s)){"manual"!==(s.auto_sort_options||"manual")&&l.push({pointer:r.pointer,command:"update",path:["schema",o],args:{auto_sort_options:"manual"}})}Po.HW({environment:t,collectionStore:r,performTransaction:e=>{for(const t of l)d.applyOperation({store:(0,Go.Kv)(r,t.pointer),operation:t,transaction:e})}})}ut.$q({environment:t,collectionContextStore:i,property:o,from:"view_settings",action:"select_options_reorder"})}function Ds(e,t,o){e.setState({focus:!0,inputValue:""}),void 0!==o&&t.setState(o)}function zs(e,t){const o=e.device.isPhone?t.state.inputValue:"";t.setState({focus:!1,inputValue:o})}function Ns(e){let{collectionContextStore:t,property:o,inputStore:s,inputGroupIndexStore:a}=e;const l=(0,n.O7)(),c=(0,P.useIntl)(),u=(0,i.useCallback)((()=>function(e,t,o,i,n){const r=t.collectionStore(),s=Os(t,o);if(!s||!r)return;const a=s.options||[],l=i.state.inputValue.trim();if(l){let t=(0,Lo.TL)(a);if("status"===s.type){const e=n.state;if(void 0!==e){var c;const o=null===(c=s.groups)||void 0===c||null===(c=c[e])||void 0===c?void 0:c.color;o&&(t=o)}}if(a.find((e=>e.value===l)))return F.showErrorMessage((0,C.jsx)(Ks,{})),void zs(e,i);const p={id:(0,ks.ZP)(),value:l,color:t};let g,m;if("status"===s.type){const e=n.state;let t;if(void 0!==e&&(m={pointer:r.pointer,command:"listBefore",path:["schema",o,"groups",e,"optionIds"],args:{id:p.id}}),void 0!==e&&(t=a.find((t=>{var o;return null===(o=s.groups)||void 0===o||null===(o=o[e].optionIds)||void 0===o?void 0:o.includes(t.id)}))),void 0===e||void 0!==t)g={pointer:r.pointer,command:"keyedObjectListBefore",path:["schema",o,"options"],args:{value:p,before:t}};else{let t;for(let o=e-1;o>=0;o--){var u;const e=null===(u=s.groups)||void 0===u?void 0:u[o];if(e&&(t=a.find((t=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)})),void 0!==t))break}g={pointer:r.pointer,command:"keyedObjectListAfter",path:["schema",o,"options"],args:{value:p,after:t}}}}else g=!(0,Lo.cu)(s)||"alphabetical"!==s.auto_sort_options&&"reverse_alphabetical"!==s.auto_sort_options?{pointer:r.pointer,command:"keyedObjectListBefore",path:["schema",o,"options"],args:{value:p}}:(0,Lo.Ch)({collectionId:r.id,property:o,propertySchema:s,newOption:p,isAscending:"alphabetical"===s.auto_sort_options});Po.HW({environment:e,collectionStore:r,performTransaction:e=>{d.applyOperation({store:(0,Go.Kv)(r,g.pointer),operation:g,transaction:e}),m&&d.applyOperation({store:(0,Go.Kv)(r,m.pointer),operation:m,transaction:e})}})}i.setState({focus:!0,inputValue:""}),ut.$q({environment:e,collectionContextStore:t,property:o,from:"view_settings",action:"select_add_option"})}(l,t,o,s,a)),[l,t,o,s,a]),p=(0,i.useCallback)((e=>function(e,t){const o=e.target.value.replace(/,/g,"");t.setState({focus:!0,inputValue:o})}(e,s)),[s]),m=(0,i.useCallback)((()=>zs(l,s)),[l,s]),f=(0,r.VK)((()=>s.state),[s]);return f.focus?(0,C.jsx)(g.Z,{debugName:"CollectionSettingsSelectOptions",capture:!0,onEsc:m,children:(0,C.jsx)(po.ZP,{value:f.inputValue,focus:!0,placeholder:c.formatMessage({defaultMessage:"Type a new option…",id:"database.viewSettings.selectOptions.newSelectOption.inputPlaceholder"}),style:{marginTop:2,marginBottom:8},onChange:p,onBlur:m,onSubmit:u,mobileKeyboardOnDismiss:u})}):null}function Es(e){let{groupIndex:t,inputStore:o,inputGroupIndexStore:i}=e;return(0,C.jsx)(L.Z,{icon:(0,Wt.R)({width:14}),focused:!1,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Add an option",id:"database.viewSettings.selectOptions.noOptions"}),style:{width:"100%"},onClick:()=>Ds(o,i,t)})}var Hs=o(742283),Us=o(753866);const Ws=(0,P.defineMessages)({statusShowAsLabel:{id:"database.viewSettings.statusOptions.showAs",defaultMessage:"Show as"},statusCheckboxLabel:{id:"database.viewSettings.statusOptions.showAs.checkbox",defaultMessage:"Checkbox"},statusSelectLabel:{id:"database.viewSettings.statusOptions.showAs.select",defaultMessage:"Select"}});function Gs(e){let{collectionContextStore:t,property:o,disabled:i}=e;const s=(0,n.O7)(),a=(0,f.yK)((e=>({icon:{width:16,height:16,fill:e.mediumIconColor}})),[]),[l,c]=(0,r.VK)((()=>{var e;return[$s(t,o),(null===(e=t.getPropertyFormat(o))||void 0===e?void 0:e.statusShowAs)??"select"]}),[t,o]);if(!l)return null;const u=[{key:"checkbox",title:So.default.formatMessage(Ws.statusCheckboxLabel),icon:(0,Hs.r)(a.icon)},{key:"select",title:So.default.formatMessage(Ws.statusSelectLabel),icon:(0,Us.w)(a.icon)}];return(0,C.jsx)(Ge.Z,{title:So.default.formatMessage(Ws.statusShowAsLabel),selectedKey:c,popupStyle:{minWidth:190},options:u,onChange:e=>function(e,t,o,i){const n=o.formatStore();if(!n)return;const r=o.getPropertyFormatKey();if(!r)return;d.createAndCommit({userAction:"CollectionSettingsStatusOptions.handleShowAsChange",environment:t,perform:t=>{Ae.er({formatStore:n,formatKey:r,property:i,update:{statusShowAs:e,visible:!0},transaction:t})}}),ut.$q({environment:t,collectionContextStore:o,property:i,from:"view_settings",action:"status_change_format"})}(e,s,t,o),disabled:i})}function $s(e,t){const o=e.normalizedSchemaStore.state[t];if(o&&"status"===o.type)return o}function qs(e){let{collectionContextStore:t,property:o,propertySchema:i}=e;const r=(0,n.O7)();return(0,C.jsx)(Kt.Z,{title:(0,C.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Show full URL",id:"database.viewSettings.propertyTab.toggleShowFullUrl"})}),showChevron:!1,switcherProps:{on:Boolean(i.show_full_url),noColor:!1},onClick:()=>function(e,t,o,i){const n=t.collectionStore();if(!i||!n||"url"!==i.type)return;const r=!Boolean(i.show_full_url);d.createAndCommit({userAction:"CollectionSettingsProperty.handleNumberShowAsChange",environment:e,perform:t=>{Po.xO({environment:e,collectionStore:n,update:{[o]:{...i,show_full_url:r}},transaction:t})}}),ut.$q({environment:e,collectionContextStore:t,property:o,from:"view_settings",action:r?"url_toggle_show_full_on":"url_toggle_show_full_off"})}(r,t,o,i)})}var Qs=o(23159);class Xs extends jr.Z{constructor(){super(...arguments),this.storeTypes={inputStore:wr.default.createClass("",{name:"inputStore"}),propertyTypeButtonPopupStore:We.Z,showPropertyDescriptionStore:wr.default.createClass(!1,{name:"showPropertyDescriptionStore"})},this.handlePropertyTypeClick=()=>{const{collectionSettingsStore:e,collectionContextStore:t}=this.props,o=ca(this.props.collectionContextStore,this.props.property);t.collectionStore()&&l.H4({collectionSettingsStore:e,item:{type:"propertyType",propertySchema:o,onAccept:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePropertyTypeAccept}})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePropertyNameSubmit=e=>function(e,t,o,i,n){if(_a(o,i,n))return;const r=Js(i);if(!r)return;const s=r.getSchema()[o];if(!s)return;if(s.name===e)return;d.createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyNameSubmit",environment:t,perform:t=>{Ae.Bv({collectionStore:r,property:o,name:e,transaction:t})}}),ut.$q({environment:t,collectionContextStore:i,property:o,from:"view_settings",action:"rename"})}(e,this.environment,this.props.property,this.props.collectionContextStore,this.stores.inputStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePropertyDescriptionSubmit=e=>function(e,t,o,i){var n;const r=o.collectionStore(),s=null==r||null===(n=r.getSchema())||void 0===n?void 0:n[i];if(!r||void 0===s||e===s.description)return;d.createAndCommit({userAction:"CollectionSettingsProperty.handleDescriptionChange",environment:t,perform:o=>{Po.xO({environment:t,collectionStore:r,update:{[i]:{...s,description:e}},transaction:o})}}),ut.$q({environment:t,collectionContextStore:o,property:i,from:"view_properties",action:"set_description"})}(e,this.environment,this.props.collectionContextStore,this.props.property),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleTogglePropertyWrapClick=()=>ka(this.environment,this.props.collectionContextStore,this.props.formatKey,this.props.property,this.wrapPropertyStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePropertyTypeAccept=e=>function(e,t,o,i,n,r,s){const a=Js(i);if(!a)return;ut.$q({environment:t,collectionContextStore:i,property:o,new_property_type:(0,Lo.TN)(e),from:"view_settings",action:"change_type"}),"relation"===e?l.H4({collectionSettingsStore:n,item:{type:"selectRelationSource",property:o,formatKey:r}}):(d.createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyTypeAccept",environment:t,perform:i=>{Ae.LC({environment:t,collectionStore:a,property:o,type:e,transaction:i})}}),l.z$({collectionSettingsStore:n}),(0,Lo.XU)(e)&&Fr.K7({propertyType:e,propertyId:o,collectionContextStore:i}));s.reset()}(e,this.environment,this.props.property,this.props.collectionContextStore,this.props.collectionSettingsStore,this.props.formatKey,this.stores.propertyTypeButtonPopupStore),this.wrapPropertyStore=this.createComputedStore((()=>{var e;const{collectionContextStore:t}=this.props,o=t.collectionViewStore();return!!o&&(Boolean((null===(e=ia(this.props.property,this.props.formatKey,this.props.collectionContextStore))||void 0===e?void 0:e.wrap)||o.getFormat().table_wrap)&&"timeline"!==o.getType())})),this.disableEditDescriptionStore=this.createComputedStore((()=>{var e;const t=null===(e=this.props.collectionContextStore.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!t&&(0,Hr.Kj)(t)}))}didMount(){Ve.default.afterNextFlush((()=>{Ve.default.afterNextFlush((()=>{!function(e,t,o){const i=t.collectionViewStore();if(!i||"table"!==i.getType())return;const n=Ur.Z.findTableHeaderCell(t,e);if(!n)return;const r=n.getNode(),s=br.findDOMNode(o);if(!r||!s)return;const a=(0,Er.xH)(r);if(!a)return;const l=s.getBoundingClientRect(),c=r.getBoundingClientRect().right+20-l.left;a.scrollLeft=a.scrollLeft+c}(this.props.property,this.props.collectionContextStore,this)}))}))}renderComponent(){const{theme:e}=this,{property:t,collectionContextStore:o,selectNameInitial:i,formatKey:n}=this.props,r=ca(o,t),s=ia(t,n,o);if(!r)return;const a=o.collectionStore(),l="collectionTypedView"===o.contextType,c=a&&a.getDatabaseType(),u=Boolean(c&&a&&a.isTypedProperty(t)),p=this.createComputedStore((()=>Boolean(a&&c&&Ar.cR((0,Zr.appConfigs)(),c,t,a)))),g=!(0,Ri.Kp)(r),m=l,f=l||(0,Ri.sh)({propertySchema:r,isTypedProperty:u}),S="collectionViewBlock"===o.contextType,y=this.stores.showPropertyDescriptionStore.state,h=r.description;return(0,C.jsxs)(A.ZP,{...this.props,title:a?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Edit property",id:"database.viewSettings.propertyTab.title"}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"View property",id:"database.viewSettings.propertyTab.title.viewProperty"}),footer:(0,C.jsx)(Va,{collectionContextStore:this.props.collectionContextStore,formatKey:this.props.formatKey,property:this.props.property,collectionSettingsStore:this.props.collectionSettingsStore,wrapPropertyStore:this.wrapPropertyStore,propertySchema:r,propertyFormat:s,isRequiredTypedProperty:p.state,databaseType:c}),unconstrainedWidth:S,children:[(0,C.jsxs)(U.Z,{children:[(0,C.jsx)(Fo.I,{disabled:m,initialValue:r.name||"",placeholder:So.default.formatMessage(_s.Z.inputPlaceholder),onBlur:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePropertyNameSubmit,onSubmit:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePropertyNameSubmit,focusInitial:i,selectAll:i,inputStore:this.stores.inputStore,inputOuterStyle:S?{background:e.contentBackground}:void 0,iconButton:{icon:t=>(0,C.jsx)(Ro.ZP,{type:r.type,icon:r.icon,size:16,theme:e,style:t}),iconStyle:{fill:To.Lr[e.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o,i){const n=Js(o);if(!n)return;d.createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyIconSubmit",environment:e,perform:e=>{Ae.OK({collectionStore:n,property:t,icon:i,transaction:e})}}),ut.$q({environment:e,collectionContextStore:o,property:t,icon:i,from:"view_settings",action:"change_icon"})}(this.environment,this.props.property,this.props.collectionContextStore,e)},inputRightButton:this.disableEditDescriptionStore.state?null:(0,C.jsx)($r.l,{description:h,showTooltip:!y,onClick:()=>{this.stores.showPropertyDescriptionStore.setState(!y)},addDescriptionText:this.props.intl.formatMessage(ji.aB.addPropertyDescriptionTooltip),editDescriptionText:this.props.intl.formatMessage(ji.aB.editPropertyDescriptionTooltip)})}),_a(this.props.property,this.props.collectionContextStore,this.stores.inputStore)&&(0,C.jsx)(Qs.Z,{propertyName:this.stores.inputStore.state})]}),y&&(0,C.jsx)(qr.i,{initialDescription:h,handleSaveDescription:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePropertyDescriptionSubmit}),(0,C.jsxs)(U.Z,{children:[g&&this.renderPropertyTypeMenuItem(f,u,c),l?(0,C.jsxs)(C.Fragment,{children:["status"===r.type&&(0,C.jsx)(ra,{collectionSettingsStore:this.props.collectionSettingsStore,collectionContextStore:this.props.collectionContextStore,property:this.props.property}),("date"===r.type||"created_time"===r.type||"last_edited_time"===r.type)&&(0,C.jsx)(aa,{collectionContextStore:this.props.collectionContextStore,property:this.props.property})]}):(0,C.jsx)(Ta,{collectionContextStore:this.props.collectionContextStore,property:this.props.property,propertySchema:r})]})]})}renderPropertyTypeMenuItem(e,t,o){const{propertyTypeButtonPopupStore:i}=this.stores,n=this.props.collectionContextStore.collectionViewBlockStore(),r=ca(this.props.collectionContextStore,this.props.property),s=dn(n,r);if(!r)return;const a=null==s?void 0:s.getIcon(),{theme:l}=this,c=(0,Ri.gg)(r)||(0,Ri.ic)(r);return(0,C.jsx)($t.Z,{placement:Qt.u.Left,disableTooltip:!e,renderTooltip:e=>t?(0,C.jsx)(P.FormattedMessage,{...e,defaultMessage:"{type} type is required for this property in {databaseType}.",id:"database.viewSettings.propertyTab.restrictedProperty",description:"A tooltip to educate the users on why they can't change the type of this property.",values:{type:ri.SO[r.type],databaseType:(0,Ke.Mn)(o)}}):(0,C.jsx)(P.FormattedMessage,{...e,defaultMessage:"{type}'s type cannot be changed.",id:"database.viewSettings.propertyTab.untypedRestrictedProperty",description:"A tooltip to educate the users on why they can't change the type of this property.",values:{type:ri.SO[r.type]}}),render:t=>(0,C.jsx)(B.Z,{...t,disabled:e,rotateChevron:i.state.open,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Type",id:"database.viewSettings.propertyTab.propertyType"}),showChevron:!0,right:(0,C.jsxs)(C.Fragment,{children:[e?(0,C.jsx)("div",{...t,children:(0,vn.Q)({width:14,fill:l.regularIconColor})}):(0,C.jsx)(Ro.ZP,{type:r.type,icon:void 0,size:16,theme:l}),(0,C.jsx)(An.Z,{size:4}),c?(0,C.jsxs)("div",{style:{color:e?l.darkTextColor:void 0,display:"flex",alignItems:"center"},children:[(0,C.jsx)(bo.Z,{icon:a,isEmptyPage:!1,size:20,disabled:!0}),(0,C.jsx)(Ni.Z,{store:s,style:{display:"inline",wordBreak:"break-word",...I.Z.textOverflowStyle}})]}):(0,C.jsx)("span",{style:{color:e?l.darkTextColor:void 0},children:ri.SO[r.type]})]}),onClick:this.handlePropertyTypeClick})})}}Xs.displayName="CollectionSettingsProperty";const Ys=(0,P.injectIntl)(Xs);function Js(e){if(e.collectionViewBlockStore())return e.collectionStore()}function ea(e,t){if(!e)return[];return t.normalizedFormatStore.state[e]||[]}function ta(e){const t=e.getViewType();if(!t)throw new Error("View type was not defined.");return t}function oa(e){const t=Js(e);return t?t.getSchema():e.normalizedSchemaStore.state||{}}function ia(e,t,o){const i=ea(t,o);return null==i?void 0:i.find((t=>t.property===e))}function na(e,t,o){const i=ea(t,o);if(0===i.length)return-1;return i.filter((e=>e.visible)).findIndex((t=>t.property===e))}function ra(e){let{collectionSettingsStore:t,collectionContextStore:o,property:i}=e;const n=(0,r.VK)((()=>{var e;return Ar.Hw(null===(e=o.collectionStore())||void 0===e?void 0:e.getDatabaseType(),o.normalizedSchemaStore.state,i)}),[o,i]);return(0,C.jsxs)(C.Fragment,{children:[n?null:(0,C.jsx)(Gs,{collectionContextStore:o,property:i,disabled:n}),(0,C.jsx)(As,{collectionSettingsStore:t,collectionContextStore:o,property:i,disabled:n,aIAutofillOption:null})]})}function sa(e){let{collectionContextStore:t,collectionSettingsStore:o,property:i}=e;return(0,C.jsx)(as,{collectionContextStore:t,collectionSettingsStore:o,property:i})}function aa(e){let{collectionContextStore:t,property:o}=e;return(0,C.jsx)(Jr,{collectionContextStore:t,property:o})}function la(e){let{collectionContextStore:t,property:o}=e;return(0,r.VK)((()=>{const e=t.normalizedSchemaStore.state[o];return(0,Ri.Kp)(e)}),[t,o])?(0,C.jsx)(Cr,{collectionContextStore:t,property:o}):(0,C.jsx)(cn,{collectionContextStore:t,property:o})}function ca(e,t){return oa(e)[t]}function da(e){let{collectionContextStore:t,property:o}=e;const i=(0,r.VK)((()=>ca(t,o)),[t,o]);return i&&("number"===i.type||"formula"===i.type||"rollup"===i.type)?(0,C.jsx)(js,{collectionContextStore:t,property:o}):null}function ua(e){let{collectionContextStore:t,property:o}=e;const i=(0,r.VK)((()=>ca(t,o)),[t,o]),n=(0,r.VK)((()=>Js(t)),[t]);return i&&"url"===i.type&&n?(0,C.jsx)(qs,{collectionContextStore:t,property:o,propertySchema:i}):null}function pa(e){let{collectionContextStore:t,property:o}=e;const i=(0,r.VK)((()=>ca(t,o)),[t,o]);return i&&"person"===i.type?(0,C.jsx)(is,{collectionContextStore:t,propertySchema:i,property:o}):null}function ga(e){let{collectionContextStore:t,property:o}=e;const i=(0,r.VK)((()=>ca(t,o)),[t,o]);return i&&"button"===i.type?(0,C.jsx)(Pr.fq,{collectionContextStore:t,propertySchema:i,propertyId:o}):null}function ma(e){let{collectionContextStore:t,property:o}=e;const i=(0,r.VK)((()=>ca(t,o)),[t,o]);return i?(0,C.jsx)(on,{collectionContextStore:t,propertySchema:i,property:o}):null}function fa(e){let{collectionContextStore:t,property:o}=e;const i=(0,r.VK)((()=>ca(t,o)),[t,o]),n=(0,r.VK)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e?void 0:e.getRecordKeyStore();return null==o?void 0:o.getRecordKey()}),[t]);return i&&"auto_increment_id"===i.type?(0,C.jsx)(Rn,{uniqueIdProperty:{propertyId:o,propertySchema:i},prefixValue:n,collectionContextStore:t}):null}function Sa(e){let{collectionContextStore:t,property:o}=e;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ma,{collectionContextStore:t,property:o}),(0,C.jsx)(pa,{collectionContextStore:t,property:o})]})}function ya(e){const{environment:t,property:o,propertySchema:n,collectionSettingsStore:s,collectionStore:a}=e,c=(0,r.VK)((()=>(0,Lo.q3)(n)),[n]),u=(0,r.VK)((()=>(0,Nr.mX)(t,Wr.Z.getMode(t,a),a)),[t,a]),p=(0,i.useMemo)((()=>{const e=n.name.trim(),t=ri.SO[n.type],o=new RegExp(`${t}(?:\\s?\\d+)?`);return!e||o.test(e)}),[n.name,n.type]),g=(0,i.useCallback)((()=>{if(!a||!n||!(0,Lo.cu)(n))return;const e=(0,Lo.xo)(n);if(!e)return;const i=[];if(c)Ir._e(t,{type:"remove_ai_inference",ai_inference_type:c.type,collection_id:a.id}),i.push({pointer:a.pointer,command:"set",path:["schema",o,e],args:void 0});else{const r={type:n.type,auto_update_on_edit:!1,add_options:!1};Ir._e(t,{type:"set_ai_inference",ai_inference_type:r.type,collection_id:a.id}),i.push({pointer:a.pointer,command:"set",path:["schema",o,e],args:r})}Po.HW({environment:t,collectionStore:a,performTransaction:e=>{for(const t of i)d.applyOperation({store:(0,Go.Kv)(a,t.pointer),operation:t,transaction:e})}})}),[c,a,t,o,n]),m=(0,i.useCallback)((e=>{if(!n||!a||!(0,Lo.qQ)(n))return;const i=(0,Lo.xo)(n);if(!i)return;const r={pointer:a.pointer,command:"set",path:["schema",o,i],args:e};Po.HW({environment:t,collectionStore:a,performTransaction:e=>{d.applyOperation({store:(0,Go.Kv)(a,r.pointer),operation:r,transaction:e})}})}),[a,t,o,n]);return(0,r.VK)((()=>u&&(0,Nr.KZ)()),[u])?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Bs,{disabled:!0,overrideStyle:{marginTop:6,paddingTop:6}},"aiSectionHeader"),(0,C.jsx)($t.Z,{disableTooltip:!p,placement:Qt.u.Left,renderTooltip:e=>(0,C.jsx)(P.FormattedMessage,{...e,defaultMessage:"Update the property name to use AI Autofill",id:"database.collectionsettings.autofilloptions.disableswitch.tooltip",description:"User needs to change the property name from the default name to turn on autofill"}),render:e=>(0,C.jsx)(Kt.Z,{...e,title:(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,C.jsx)(P.FormattedMessage,{defaultMessage:"AI Autofill",id:"database.viewSettings.propertyTab.aiAutofill.open"}),(0,C.jsx)(Rr.Z,{style:{display:"inline-block"}})]}),showChevron:!1,switcherProps:{on:Boolean(c),noColor:!1},onClick:g,disabled:!u||p}),style:{whiteSpace:"break-spaces"}}),c&&!p&&("select"===c.type||"multi_select"===c.type)&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Lr,{setAiInference:m,aiInference:c,disabled:!u}),(0,C.jsx)(B.Z,{title:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",lineHeight:1.2,color:no.ZP.uiGray},children:[(0,C.jsx)(P.FormattedMessage,{id:"database.collectionsettings.aiAutofillOptions.more",defaultMessage:"More"}),(0,Mr.o)({fill:no.ZP.uiGray,width:12,height:12,marginLeft:4})]}),disabled:!1,onClick:()=>{l.H4({collectionSettingsStore:s,item:{type:"propertyAiAutofill",propertySchema:n,property:o}})}})]})]}):null}function ha(e){const{environment:t,property:o,propertySchema:i,collectionContextStore:n,collectionStore:s}=e,a=(0,r.VK)((()=>{var e;const t=(null===(e=Gr.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,Tr.de)(t)}),[]),l=(0,r.VK)((()=>{const e=n.collectionStore();return e&&(0,Nr.mX)(t,Wr.Z.getMode(t,e),e)}),[t,n]);return(0,r.VK)((()=>(0,Lo.cu)(i)&&(0,Nr.KZ)()&&i.select_ai_inference),[i])?(0,C.jsx)(Kr.TB,{environment:t,collectionContextStore:n,collectionStore:s,property:o,propertySchema:i,doesUserHaveAIAddOn:a,isAutofillSetupEnabled:Boolean(l)}):null}function xa(e){let{propertySchema:t,collectionSettingsStore:o,collectionContextStore:i,property:s}=e;const a=(0,n.O7)(),l=(0,r.VK)((()=>i.collectionStore()),[i]);return l?(0,C.jsx)(As,{collectionSettingsStore:o,collectionContextStore:i,property:s,disabled:!1,aIAutofillOption:(0,C.jsx)(ya,{environment:a,collectionStore:l,collectionSettingsStore:o,property:s,propertySchema:t})}):null}function va(e){let{collectionContextStore:t,property:o}=e;const i=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t])[o];let n;return n=(0,Ri.Kp)(i)?(0,C.jsx)(ls.Z,{href:(0,jn.UY)("guides.githubRelation"),title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Learn about GitHub Pull Requests",id:"database.viewSettings.propertyTab.githubPrRelation.learnMoreButton.title"}),analyticsFrom:"view_settings_property_github_pr_relation"}):(0,C.jsx)(ls.Z,{href:(0,jn.UY)("guides.relations"),title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Learn about relations",id:"database.viewSettings.propertyTab.relations.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"}),(0,C.jsx)(U.Z,{topBorder:!0,children:n})}function Ca(e,t,o,i){const n=ia(i,o,t),r=t.collectionViewStore(),s=t.normalizedFormatStore.state,a=ca(t,i);if(!a)return;if(!(n&&r&&o&&a))return;const l=ea(o,t).map((e=>e.property===n.property?{...n,visible:!n.visible}:e)),c={...s,[o]:l};d.createAndCommit({userAction:"CollectionSettingsProperty.handleToggleVisibilityClick",environment:e,perform:s=>{Po.iG({collectionViewStore:r,update:{format:c},transaction:s});const a=na(i,o,t);pt.oz({environment:e,collectionContextStore:t,currentIndex:a,entrypoint:"CollectionSettingsProperty",transaction:s,propertyAction:n.visible?"hide":"show"})}}),ut.wd({environment:e,collectionContextStore:t,action:"toggle_property_visibility",original_view_type:r.getType(),property_type:a.type})}async function ba(e,t,o,i,n,r){await Ae.TI({environment:e,collectionContextStore:o,property:i,handleDeleteAccept:()=>function(e,t,o,i,n){const r=ca(o,t),s=oa(o),a=Js(o);r&&(a&&d.createAndCommitAsync({environment:e,userAction:"CollectionSettingsProperty.handleDeleteAccept",waitForServerCommit:!1,perform:async i=>{await Ae.yV({environment:e,collectionStore:a,schema:s,property:t,transaction:i});const r=na(t,n,o);pt.oz({environment:e,collectionContextStore:o,currentIndex:r,entrypoint:"CollectionSettingsProperty",transaction:i,propertyAction:"delete"})}}),l.z$({collectionSettingsStore:i}),ut.wd({environment:e,collectionContextStore:o,action:"delete_property",property_type:null==r?void 0:r.type}),ut.y9({environment:e,collectionContextStore:o,property_type:r.type,from:"view_settings",property:t}))}(e,i,o,n,r),theme:t,from:"view_settings"})}function ja(e){let{collectionContextStore:t,property:o,collectionSettingsStore:i}=e;const n=(0,r.VK)((()=>ca(t,o)),[t,o]);if(!n||"text"!==n.type)return null;const s=(0,Lo.q3)(n);let a;return s&&(0,Lo.MD)(s.type)?"summarize"===s.type?a=zr.Dr.autofillSummary:"extract"===s.type?a=zr.Dr.autofillExtract:"custom"===s.type?a=zr.Dr.autofillCustom:"translate"===s.type?a=zr.Dr.autofillTranslate:(0,Ze.t1)(s):a=_s.Z.autofillOffLabel,(0,C.jsx)(B.Z,{title:(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,C.jsx)(P.FormattedMessage,{defaultMessage:"AI Autofill",id:"database.viewSettings.propertyTab.aiAutofill.open"}),(0,C.jsx)(Rr.Z,{style:{display:"inline-block"}})]}),showChevron:!0,right:So.default.formatMessage(a),onClick:()=>function(e,t,o){const i=ca(t,o);t.collectionStore()&&i&&l.H4({collectionSettingsStore:e,item:{type:"propertyAiAutofill",propertySchema:i,property:o}})}(i,t,o)})}function wa(e){let{property:t,collectionContextStore:o}=e;const i=(0,n.O7)(),s=(0,r.VK)((()=>Js(o)),[o]),a=(0,r.VK)((()=>oa(o)),[o]),l=(0,r.VK)((()=>Boolean((null==s?void 0:s.getDatabaseType())&&(null==s?void 0:s.isTypedProperty(t)))),[s,t]);return s?(0,C.jsx)(Dr.Z,{disabled:l,context:Dr.t.ViewSettings,property:t,schema:a,analyticsFrom:"view_settings",parentStore:s,onChange:e=>function(e,t,o,i){const n=Js(i);n&&d.createAndCommit({userAction:"CollectionSettingsProperty.handleRollupPropertyMenuChange",environment:t,perform:i=>{Po.xO({environment:t,collectionStore:n,update:{[o]:e.propertySchema},transaction:i})}})}(e,i,t,o)}):null}function Ma(e){let{isRequiredTypedProperty:t,databaseType:o,collectionContextStore:i,property:r,collectionSettingsStore:s,formatKey:a}=e;const l=(0,f.Fg)(),c=(0,n.O7)();return(0,C.jsx)($t.Z,{disableTooltip:!t,placement:Qt.u.Left,renderTooltip:e=>(0,Ke.A7)(o,e),render:e=>(0,C.jsx)(B.Z,{...e,isRed:!0,disabled:t,onClick:()=>ba(c,l,i,r,s,a),icon:()=>t?(0,C.jsx)("div",{...e,style:{display:"inline-flex"},children:(0,vn.Q)({width:14,marginLeft:4,marginRight:4})}):(0,T.y)({width:14,marginLeft:4,marginRight:4}),title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Delete property",id:"database.viewSettings.propertyTab.deleteButton.title"}),caption:c.device.isMobile&&t?(0,Ke.A7)(o):null})})}function _a(e,t,o){const i=oa(t),n=o.state,r=Object.keys(i).find((t=>{var o;return t!==e&&(null===(o=i[t])||void 0===o?void 0:o.name)===n}));return Boolean(r)}function ka(e,t,o,i,n){const r=ia(i,o,t),s=t.collectionViewStore(),a=t.normalizedFormatStore.state,l=ca(t,i);l&&r&&s&&o&&l&&(pt.K4({currentValue:n.state,environment:e,property:i,collectionViewStore:s,format:a,formatKey:o}),ut.wd({environment:e,collectionContextStore:t,action:"toggle_property_wrap",original_view_type:s.getType(),property_type:l.type}))}function Va(e){let{propertySchema:t,propertyFormat:o,isRequiredTypedProperty:s,databaseType:a,collectionContextStore:u,formatKey:p,property:g,collectionSettingsStore:m,wrapPropertyStore:f}=e;const S=(0,n.O7)(),y=(0,i.useCallback)((()=>ka(S,u,p,g,f)),[S,u,p,g,f]),h=(0,r.VK)((()=>u.collectionStore()),[u]),x=(0,r.VK)((()=>Ei.Z.state.isOpen),[]),v=(0,r.VK)((()=>p&&("title"!==g||(0,Oe.XO)({viewType:ta(u),format:u.normalizedFormatStore.state}))),[p,g,u]),b=(0,r.VK)((()=>p&&(0,Oe.w0)({viewType:ta(u),property:g})),[p,g,u]),j=ri.Tr.includes(t.type)&&!(0,Lo.dx)(t)&&h&&!x,w=ri.Tr.includes(t.type)&&h&&!x,M=(0,r.VK)((()=>f.state),[f]);return(0,C.jsxs)(C.Fragment,{children:[b&&o&&(0,C.jsx)(U.Z,{topBorder:!0,children:(0,C.jsx)(Kt.Z,{isPadded:!0,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Wrap in view",id:"database.viewSettings.propertyTab.wrapInViewButton.title"}),switcherProps:{on:M,disallowTabbing:!0},onClick:y})}),(v||j||w)&&(0,C.jsxs)(U.Z,{topBorder:!0,children:[h&&(0,C.jsx)(ha,{environment:S,collectionStore:h,collectionContextStore:u,property:g,propertySchema:t}),v&&o&&(null!=o&&o.visible?(0,C.jsx)(B.Z,{icon:kt.L,isPadded:!0,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Hide in view",id:"database.viewSettings.propertyTab.hideInViewButton.title"}),onClick:()=>Ca(S,u,p,g)}):(0,C.jsx)(B.Z,{icon:kr.N,isPadded:!0,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Show in view",id:"database.viewSettings.propertyTab.showInViewButton.title"}),onClick:()=>Ca(S,u,p,g)})),j&&(0,C.jsx)(B.Z,{icon:_r.a,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Duplicate property",id:"database.viewSettings.propertyTab.duplicateButton.title"}),onClick:()=>async function(e,t,o,i,n){const r=ea(n,o),s=oa(o),a=Js(o),u=o.collectionViewStore(),p=null==a?void 0:a.getSpaceId();if(!a||!u||!p)return;const g=ca(o,t);if(!g)return;const m=await(0,Oe.xy)({environment:e,schema:s,property:t,properties:r,parentStore:a,spaceId:p});if(!m)return;const f=e.currentUser.id,S=f?{id:f,table:Vr.KJ}:void 0;d.createAndCommit({userAction:"CollectionSettingsProperty.handleDuplicateClick",environment:e,perform:i=>{(0,Ze.$K)(m.automationUpdate)&&Br.duplicateAutomation({actorPointer:S,environment:e,sourceAutomationStore:m.automationUpdate.sourceAutomationStore,targetAutomationId:m.automationUpdate.targetAutomationId,transaction:i}),Po.xO({environment:e,collectionStore:a,update:{[m.newProperty]:m.newPropertySchema},transaction:i});const r=na(t,n,o);pt.oz({environment:e,collectionContextStore:o,currentIndex:r,entrypoint:"CollectionSettingsProperty",transaction:i,propertyAction:"duplicate"}),n&&c.FH({stores:[u],update:{[n]:m.newProperties},transaction:i})}}),l.FK({collectionSettingsStore:i,item:{type:"property",property:m.newProperty,formatKey:n}}),ut.wd({environment:e,collectionContextStore:o,action:"duplicate_property",original_view_type:null==u?void 0:u.getType(),property_type:g.type})}(S,g,u,m,p)}),w&&(0,C.jsx)(Ma,{collectionContextStore:u,property:g,collectionSettingsStore:m,formatKey:p,isRequiredTypedProperty:s,databaseType:a})]}),"formula"===t.type&&(0,C.jsx)(U.Z,{topBorder:!0,children:(0,C.jsx)(ls.Z,{href:(0,jn.UY)("guides.formulas"),title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Learn about formulas",id:"database.viewSettings.propertyTab.formulas.learnMoreButton.title"}),analyticsFrom:"view_settings_property_formula"})}),"relation"===t.type&&(0,C.jsx)(va,{collectionContextStore:u,property:g}),"rollup"===t.type&&(0,C.jsx)(U.Z,{topBorder:!0,children:(0,C.jsx)(ls.Z,{href:(0,jn.UY)("guides.relations"),title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Learn about rollups",id:"database.viewSettings.propertyTab.rollups.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"})})]})}function Ta(e){let{property:t,propertySchema:o,collectionContextStore:i}=e;const s=(0,n.O7)(),a=i.settingsStore,l=(0,r.VK)((()=>(0,Nr.Zt)(s)),[s]);return(0,C.jsxs)(C.Fragment,{children:[l&&"text"===o.type&&(0,C.jsx)(ja,{collectionContextStore:i,property:t,collectionSettingsStore:a}),(0,Lo.cu)(o)&&(0,C.jsx)(xa,{collectionSettingsStore:a,collectionContextStore:i,property:t,propertySchema:o}),"status"===o.type&&(0,C.jsx)(ra,{collectionSettingsStore:a,collectionContextStore:i,property:t}),"formula"===o.type&&(0,C.jsx)(sa,{collectionContextStore:i,collectionSettingsStore:a,property:t}),"rollup"===o.type&&(0,C.jsx)(wa,{property:t,collectionContextStore:i}),("date"===o.type||"created_time"===o.type||"last_edited_time"===o.type)&&(0,C.jsx)(aa,{collectionContextStore:i,property:t}),"relation"===o.type&&(0,C.jsx)(la,{collectionContextStore:i,property:t}),"person"===o.type&&(0,C.jsx)(Sa,{collectionContextStore:i,property:t}),(0,C.jsx)(da,{collectionContextStore:i,property:t}),(0,C.jsx)(ua,{collectionContextStore:i,property:t}),"auto_increment_id"===o.type&&(0,C.jsx)(fa,{collectionContextStore:i,property:t}),"button"===o.type&&(0,C.jsx)(ga,{collectionContextStore:i,property:t})]})}var Pa=o(628410),Ia=o(920669),Fa=o(471924),Za=o(79474),Aa=o(452423),Ba=o(644866),Ka=o(973420),Oa=o(291839),La=o(628020),Ra=o(152840);const Da=(0,P.defineMessages)({autoUpdateExplanationMessage:{defaultMessage:"Keep values updated with the latest edits to pages",id:"database.CollectionSettingsPropertyAiAutofill.autoUpdateExplanationMessage"},onlyWithAiAddOnMessage:{defaultMessage:"Only with Notion AI add-on",id:"database.CollectionSettingsPropertyAiAutofill.onlyWithAiAddOnMessage"},updateOnPageEdits:{defaultMessage:"Auto-update on page edits",id:"database.viewSettings.propertyTab.aiAutofill.updateOnPageEdits"}});function za(e){let{collectionContextStore:t,environment:o,setAiInference:n,aiInference:r,doesUserHaveAIAddOn:s}=e;const a=(0,i.useRef)(Fa.Il()),l=(0,i.useCallback)((()=>{if(!t.collectionStore())return;if(!r)return;if(!(s||null!=r&&r.auto_update_on_edit))return void Ba.triggerAiAutofillUpsell({environment:o,from:"ai_autofill_on_page_edit"});const e={...r,auto_update_on_edit:!r.auto_update_on_edit};n(e)}),[t,r,s,n,o]);return r?(0,C.jsx)($t.Z,{renderTooltip:()=>(0,C.jsxs)("div",{style:{width:159},children:[(0,C.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,C.jsx)(P.FormattedMessage,{...Da.autoUpdateExplanationMessage})}),!s&&(0,C.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:(0,C.jsx)(P.FormattedMessage,{...Da.onlyWithAiAddOnMessage})})]}),render:e=>(0,C.jsx)(Kt.Z,{title:(0,C.jsx)(P.FormattedMessage,{...Da.updateOnPageEdits}),showChevron:!1,switcherProps:{inputId:a.current,on:!!r.auto_update_on_edit,noColor:!1},onClick:l,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})}):null}var Na=o(654497),Ea=o(301743);const Ha=(0,P.defineMessages)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},extractPromptSectionTitle:{defaultMessage:"What key info to extract?",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptSectionTitle"},customPromptSectionTitle:{defaultMessage:"What to generate?",id:"database.viewSettings.propertyTab.aiAutofill.customPromptSectionTitle"},extractPromptInputPlaceholder:{defaultMessage:"e.g. “Key topics in bullets” or “People mentioned on the page”",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptInputPlaceholder"},customPromptInputPlaceholder:{defaultMessage:"Tell AI what to generate from page content and properties…",id:"database.viewSettings.propertyTab.aiAutofill.customPromptInputPlaceholder"}});function Ua(e){var t;let{environment:o,aiInference:n,setAiInference:s,collectionContextStore:a,isAutofillSetupEnabled:l,shouldShowUserPromptIsInvalidError:c,setShouldShowUserPromptIsInvalidError:d}=e;const u=function(e){if(!e)return;switch(e.type){case"summarize":case"translate":return;case"extract":return{aiInferenceType:e.type,sectionTitle:Ha.extractPromptSectionTitle,inputPlaceholder:Ha.extractPromptInputPlaceholder,value:e.prompt};case"custom":case"select":case"multi_select":return{aiInferenceType:e.type,sectionTitle:Ha.customPromptSectionTitle,inputPlaceholder:Ha.customPromptInputPlaceholder,value:e.prompt};default:(0,Ze.t1)(e)}}(n),p=(0,r.VK)((()=>(0,ri.k4)()),[]),g=(0,i.useCallback)((e=>{if(a.collectionStore()&&u)switch(e.target.value&&e.target.value.length<=Pa.Th?d(!1):e.target.value.length>Pa.Th&&d(!0),u.aiInferenceType){case"extract":case"custom":s({type:u.aiInferenceType,prompt:e.target.value,auto_update_on_edit:(null==n?void 0:n.auto_update_on_edit)??p});break;case"select":case"multi_select":s({type:u.aiInferenceType,prompt:e.target.value,auto_update_on_edit:(null==n?void 0:n.auto_update_on_edit)??p,add_options:((null==n?void 0:n.type)===u.aiInferenceType&&(null==n?void 0:n.add_options))??!1});break;case"summarize":case"translate":return;default:(0,Ze.t1)(u.aiInferenceType)}}),[n,a,p,u,s,d]);return u?(0,C.jsxs)(U.Z,{title:So.default.formatMessage(u.sectionTitle),isInput:!0,style:{marginTop:-4},children:[(0,C.jsx)(Ea.Z,{debugName:"CollectionSettingsAiAutofillPromptInput",capture:!0,allowEsc:!0,children:(0,C.jsx)(po.ZP,{inputOuterStyle:{margin:o.device.isMobile?"8px 0":0,border:c?"1px solid red":void 0},type:"text",value:u.value||"",onChange:g,placeholder:So.default.formatMessage(u.inputPlaceholder),textarea:!0,disabled:!l,autosize:!0,autosizeMinHeight:100,autosizeMaxHeight:600},u.aiInferenceType)}),c&&(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingLeft:12,fontSize:12},children:[(0,Na.t)({width:12,height:12,fill:"#D34F43"}),(0,C.jsx)("div",{style:{color:"#D34F43",paddingLeft:4},children:((null===(t=u.value)||void 0===t?void 0:t.length)??0)>Pa.Th?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Instruction is too long",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.exceedsMaxLength"}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Required",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.required"})})]})]}):null}function Wa(e){const{collectionContextStore:t,isAutofillSetupEnabled:o,draftAiInference:i,setDraftAiInference:n,environment:r,shouldShowUserPromptIsInvalidError:s,setShouldShowUserPromptIsInvalidError:a,doesUserHaveAIAddOn:l}=e;return i?"select"!==i.type&&"multi_select"!==i.type?null:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(U.Z,{style:{marginBottom:10},children:[(0,C.jsx)(za,{collectionContextStore:t,environment:r,setAiInference:n,aiInference:i,doesUserHaveAIAddOn:l}),(0,C.jsx)(Lr,{setAiInference:n,aiInference:i})]}),i&&(0,C.jsx)(U.Z,{topBorder:!0,children:(0,C.jsx)(Ua,{environment:r,aiInference:i,setAiInference:n,collectionContextStore:t,isAutofillSetupEnabled:o,shouldShowUserPromptIsInvalidError:s,setShouldShowUserPromptIsInvalidError:a})})]}):null}o(430541);var Ga=o(687205),$a=o(743765);const qa=new We.Z,Qa=(0,P.defineMessages)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},whatToTranslate:{defaultMessage:"What to translate?",id:"CollectionSettingsPropertyAiAutofill.translateProperty.propertySelector"},translateTo:{defaultMessage:"Translate to",id:"CollectionSettingsPropertyAiAutofill.translateProperty.languageSelector"},selectorSearchPlaceholder:{defaultMessage:"Search",id:"CollectionSettingsPropertyAiAutofill.selectorOption.searchbar.placeholder"},allProperties:{defaultMessage:"All properties",id:"CollectionSettingsPropertyAiAutofill.selectorOption.allProperties.checkbox"},noAiAutofillSelected:{defaultMessage:"Select an option",id:"database.CollectionSettingsPropertyAiAutofill.noAiAutofillSelected"}});function Xa(e){const{collectionContextStore:t,propertySchema:o,previousPromptByAiInferenceType:n,isAutofillSetupEnabled:r,draftAiInference:s,setDraftAiInference:a,environment:l,propertyId:c,collectionSchema:d,shouldShowUserPromptIsInvalidError:u,setShouldShowUserPromptIsInvalidError:p,doesUserHaveAIAddOn:g}=e,m=(0,f.Fg)(),S=(0,i.useMemo)((()=>[new We.Z,new We.Z]),[]),y=(0,i.useMemo)((()=>function(e){var t;let{environment:o,aiInference:i,collectionSchema:n,setAiInference:r,property:s,theme:a,optionsButtonPopupStores:l}=e;if(!i||!(0,Lo.MD)(i.type))return[];switch(i.type){case"summarize":case"extract":case"custom":return[];case"translate":const e=Pt.oA((0,Ze.Yd)(n).map((e=>{if(e===s)return;const t=n[e];if(t&&(0,Ga.K9)(t)){var o;if("text"===t.type&&"translate"===(null===(o=t.ai_inference)||void 0===o?void 0:o.type))return;return{id:e,option:t.name,icon:(0,C.jsx)(Ro.ZP,{icon:t.icon,type:t.type,theme:a,size:16})}}}))),o=e.findIndex((e=>"title"===e.id));if(o&&o>0){const t=e[o];e.splice(o,1),e.unshift(t)}for(;l.length<2;)l.push(new We.Z);return[{type:"multi",options:e,selectedIds:(null===(t=i.targetProperties)||void 0===t?void 0:t.length)>0?i.targetProperties:["title"],setSelectedIds:e=>{r({...i,targetProperties:e})},selectorTitle:Qa.whatToTranslate,selectAllTitle:Qa.allProperties,buttonPopupStore:l[0]},{type:"single",options:Ga.nI.map((e=>{let{key:t,name:o}=e;return{id:t,option:So.default.formatMessage(o)}})),selectedId:i.toLanguage,onSelect:e=>{r({...i,toLanguage:e})},selectorTitle:Qa.translateTo,buttonPopupStore:l[1]}];default:(0,Ze.t1)(i)}}({environment:l,aiInference:s,collectionSchema:d,setAiInference:a,property:c,theme:m,optionsButtonPopupStores:S})),[l,s,d,a,c,m,S]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(U.Z,{style:{marginBottom:10},children:[(0,C.jsx)(Ya,{propertySchema:o,previousPromptByAiInferenceType:n,draftAiInference:s,setDraftAiInference:a,environment:l}),(0,Lo.by)(s,"text")&&(0,C.jsx)(za,{collectionContextStore:t,environment:l,setAiInference:a,aiInference:s,doesUserHaveAIAddOn:g})]}),(0,Lo.by)(s,"text")&&(0,C.jsxs)(U.Z,{topBorder:!0,children:[(0,C.jsx)(Ua,{environment:l,aiInference:s,setAiInference:a,collectionContextStore:t,isAutofillSetupEnabled:r,shouldShowUserPromptIsInvalidError:u,setShouldShowUserPromptIsInvalidError:p}),(0,C.jsx)(el,{environment:l,optionProps:y})]})]})}function Ya(e){let{propertySchema:t,previousPromptByAiInferenceType:o,draftAiInference:n,setDraftAiInference:s,environment:a}=e;const l=(0,r.VK)((()=>(0,ri.k4)()),[]),c=(0,i.useCallback)((e=>{var i,n,r,a,c,d,u,p;if(!t||!(0,Lo.qQ)(t)||!e)return;let g;switch(e){case"summarize":g={type:e,auto_update_on_edit:l};break;case"translate":g={type:e,auto_update_on_edit:l,targetProperties:(null===(i=t.ai_inference)||void 0===i?void 0:i.type)===e?null===(n=t.ai_inference)||void 0===n?void 0:n.targetProperties:["title"],toLanguage:(null===(r=t.ai_inference)||void 0===r?void 0:r.type)===e?null===(a=t.ai_inference)||void 0===a?void 0:a.toLanguage:"english"};break;case"extract":g={type:e,prompt:(null===(c=t.ai_inference)||void 0===c?void 0:c.type)===e?null===(d=t.ai_inference)||void 0===d?void 0:d.prompt:o[e]??"",auto_update_on_edit:l};break;case"custom":g={type:e,prompt:(null===(u=t.ai_inference)||void 0===u?void 0:u.type)===e?null===(p=t.ai_inference)||void 0===p?void 0:p.prompt:o[e]??"",auto_update_on_edit:l};break;default:(0,Ze.t1)(e)}s(g)}),[l,o,t,s]),d=(0,f.Fg)();return t&&(0,Lo.qQ)(t)?(0,C.jsx)(R.ZP,{popupType:a.device.isMobile?R.Z4.SlideUp:R.Z4.Popup,buttonPopupStore:qa,render:e=>{const t={key:"section",render:e=>(0,C.jsx)(U.Z,{...e}),items:Pt.oA(Object.keys(zr.OE.text).map((t=>{if((0,Lo.MD)(t))return{key:t,render:e=>{const o=zr.OE.text[t];return(0,C.jsx)(L.Z,{focused:!1,onClick:e.onClick,icon:o.svg({height:20,width:24,fill:d.aiPurpleColor}),title:So.default.formatMessage(o.name),checkState:(null==n?void 0:n.type)===t})},action:()=>{e.close(),c(t)}}})))};return(0,C.jsx)(z.Z,{menuType:Yn.og.Popup,minWidth:260,maxWidth:"100vw",children:(0,C.jsx)(N.Z,{type:N.i.Vertical,initialFocus:void 0,sections:[t]})})},renderOrigin:e=>{let{onClick:t}=e;return(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:14,marginLeft:4,marginRight:4,marginTop:8,paddingLeft:12,paddingRight:12,cursor:"pointer",height:28},onClick:t,children:[(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Fill with",id:"CollectionSettingsPropertyAiAutofill.ClosedSelector.Title"}),(0,C.jsx)(Ja,{aiActionType:null==n?void 0:n.type})]})}}):null}function Ja(e){let{aiActionType:t}=e;const o=(0,f.Fg)(),i=t&&(0,Lo.MD)(t)?zr.OE.text[t]:{name:Qa.noAiAutofillSelected,svg:()=>null};return(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:14,paddingLeft:15,paddingBottom:0},children:[(0,C.jsx)("div",{style:{color:o.lightIconColor},children:i.svg({height:16,width:16,marginRight:2})}),(0,C.jsx)("div",{style:{color:o.lightTextColor,paddingLeft:4},children:(0,C.jsx)(P.FormattedMessage,{...i.name})}),(0,C.jsx)("div",{style:{color:o.lightIconColor,paddingLeft:4},children:(0,Mr.o)({height:12,width:12})})]})}function el(e){let{environment:t,optionProps:o}=e;return o&&o.length>0?(0,C.jsx)(U.Z,{title:So.default.formatMessage(Qa.optionsSectionTitle),isInput:!0,style:{marginTop:-4},children:o.map(((e,o)=>"multi"===e.type?(0,C.jsx)(tl,{environment:t,options:e.options,selectedIds:e.selectedIds,setSelectedIds:e.setSelectedIds,selectorTitle:e.selectorTitle,selectAllTitle:e.selectAllTitle,buttonPopupStore:e.buttonPopupStore},o):(0,C.jsx)(ol,{environment:t,options:e.options,selectedId:e.selectedId,onSelect:e.onSelect,selectorTitle:e.selectorTitle,buttonPopupStore:e.buttonPopupStore},o)))}):null}function tl(e){let{environment:t,options:o,selectedIds:n,setSelectedIds:s,selectorTitle:a,selectAllTitle:l,buttonPopupStore:c}=e;const[d,u]=(0,i.useState)(""),p=(0,f.Fg)(),g=o.filter((e=>n.includes(e.id))),m=(0,r.VK)((()=>Pt.jj(Pt.MR(o.map((e=>e.id)))).join(",")===Pt.jj(Pt.MR(n)).join(",")),[o,n]),S=e=>{n.includes(e)?s(n.filter((t=>t!==e))):s(Pt.jj([...n,e]))},y=()=>{n.length<o.length?s(o.map((e=>e.id))):s(["title"])},h=(0,C.jsx)(U.Z,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,C.jsx)(po.ZP,{focusInitial:!t.device.isMobile||void 0,focus:!t.device.isMobile||void 0,value:d,onChange:e=>{u(e.target.value)},placeholder:So.default.formatMessage(Qa.selectorSearchPlaceholder)})});return(0,C.jsx)(R.ZP,{popupType:t.device.isMobile?R.Z4.SlideUp:R.Z4.Popup,buttonPopupStore:c,render:e=>{const t=o.filter((e=>{var t;const o=null===(t=e.option)||void 0===t?void 0:t.toLowerCase();return-1!==(null==o?void 0:o.indexOf(d.toLowerCase()))})).map((e=>{let{id:t,option:o,icon:i}=e;return{key:t,render:e=>(0,C.jsx)(L.Z,{focused:!1,onClick:e.onClick,left:(0,C.jsx)(vi.Z,{checked:n.includes(t),size:14,checkSize:8,onClick:e=>{S(t)}}),icon:i,title:o}),action:()=>{S(t)}}})),i={key:"section",render:e=>(0,C.jsx)(U.Z,{...e,topBorder:!0}),items:t},r={key:"all-items",render:e=>(0,C.jsx)(U.Z,{...e}),items:[{key:"all-items",render:e=>(0,C.jsx)(L.Z,{focused:!1,onClick:()=>{y()},left:(0,C.jsx)(vi.Z,{checked:m,size:14,checkSize:8,onClick:()=>{y()}}),title:So.default.formatMessage(l)}),action:()=>{y()}}]};return(0,C.jsxs)(z.Z,{menuType:Yn.og.Popup,minWidth:260,maxWidth:"100vw",children:[h,0===t.length?(0,C.jsx)(U.Z,{children:(0,C.jsx)($a.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"No results",id:"CollectionSettingsPropertyAiAutofill.searchBar.noResults.label"})})}):(0,C.jsx)(N.Z,{type:N.i.Vertical,initialFocus:void 0,sections:[r,i]})]})},renderOrigin:e=>(0,C.jsx)(B.Z,{title:So.default.formatMessage(a),showChevron:!0,right:(0,C.jsx)("div",{style:{color:p.lightTextColor,paddingLeft:4,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%"},children:Pt.oA(g.map((e=>{let{id:t,option:o,icon:i}=e;return o}))).join(", ")}),rightStyle:{flexShrink:1},rotateChevron:c.state.open,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})})}function ol(e){let{environment:t,options:o,selectedId:n,onSelect:r,selectorTitle:s,buttonPopupStore:a}=e;const[l,c]=(0,i.useState)(""),d=o.find((e=>e.id===n)),u=(0,f.Fg)(),p=(0,C.jsx)(U.Z,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,C.jsx)(po.ZP,{focusInitial:!t.device.isMobile||void 0,focus:!t.device.isMobile||void 0,value:l,onChange:e=>{c(e.target.value)},placeholder:So.default.formatMessage(Qa.selectorSearchPlaceholder)})});return(0,C.jsx)(R.ZP,{popupType:t.device.isMobile?R.Z4.SlideUp:R.Z4.Popup,buttonPopupStore:a,render:e=>{const t=o.filter((e=>{var t;return-1!==(null===(t=e.option)||void 0===t?void 0:t.toLowerCase().indexOf(l.toLowerCase()))})).map((t=>{let{id:o,option:i,icon:s}=t;return{key:o,render:e=>(0,C.jsx)(L.Z,{focused:!1,onClick:e.onClick,icon:s,title:i,checkState:o===n}),action:()=>{e.close(),r(o)}}})),i={key:"section",render:e=>(0,C.jsx)(U.Z,{...e}),items:t};return(0,C.jsxs)(z.Z,{menuType:Yn.og.Popup,minWidth:260,maxWidth:"100vw",children:[p,0===t.length?(0,C.jsx)(U.Z,{children:(0,C.jsx)($a.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"No results",id:"CollectionSettingsPropertyAiAutofill.searchBar.noResults.label"})})}):(0,C.jsx)(N.Z,{type:N.i.Vertical,initialFocus:void 0,sections:[i]})]})},renderOrigin:e=>(0,C.jsx)(B.Z,{title:So.default.formatMessage(s),showChevron:!0,right:d&&(0,C.jsxs)(C.Fragment,{children:[d.icon,(0,C.jsx)("div",{style:{color:u.lightTextColor,paddingLeft:4,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%"},children:d.option})]}),rightStyle:{flexShrink:1},rotateChevron:a.state.open,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})})}const il=(0,P.defineMessages)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},removeAutofillButton:{defaultMessage:"Turn off AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.removeAutofillButton"},toggleFillWithAiSectionLabel:{defaultMessage:"Actions",id:"database.viewSettings.propertyTab.aiAutofill.actionsSectionLabel"},confirmOverwriteExistingPropertyValues:{defaultMessage:"Filling “{propertyName}” with AI will overwrite any existing values of the property. Are you sure you want to continue?",id:"database.viewSettings.propertyTab.aiAutofill.confirmOverwriteModal"},noAiAutofillSelected:{defaultMessage:"Select an option",id:"database.CollectionSettingsPropertyAiAutofill.noAiAutofillSelected"}});function nl(e){const{property:t,collectionContextStore:o,collectionSettingsStore:s}=e,a=(0,r.VK)((()=>o.normalizedSchemaStore.state[t]),[t,o.normalizedSchemaStore]),c=(0,r.VK)((()=>o.collectionStore()),[o]),u=(0,r.VK)((()=>o.normalizedSchemaStore.getState()),[o]),p=a&&(0,Lo.qQ)(a)?(0,Lo.q3)(a):void 0,m=(0,n.O7)(),f=sl(),S=(0,r.VK)((()=>{const e=o.collectionStore();return e&&(0,Nr.mX)(m,Wr.Z.getMode(m,e),e)}),[m,o]),y=wr.default.createValue({stage:"not_started"},{name:"tryAutofillStore"});(0,i.useEffect)((()=>{var e,i;if("page"===o.getViewType())return;if(!1!==(null===(e=o.getPropertyFormat(t))||void 0===e?void 0:e.visible))return;const n=new Yo.Z({name:"CollectionSettingsPropertyAiAutofill"});m.defaultRecordCache.inMemoryRecordCache.addCacheOverride(n);const r=null===(i=o.formatStore())||void 0===i?void 0:i.clone(n),s=o.getPropertyFormatKey();return r&&s&&d.createAndCommit({userAction:"CollectionSettingsPropertyAiAutofill.open",environment:m,perform:e=>{Ae.er({formatStore:r,formatKey:s,property:t,update:{visible:!0},transaction:e})}}),()=>{m.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(n)}}),[o,m,t]);const h=(0,i.useRef)({}),x=(0,r.VK)((()=>(0,ri.k4)()),[]),[v,b]=(0,i.useState)(a&&Ba.getDefaultAiInference(a,x)),[j,w]=(0,i.useState)(!1),M=(0,i.useCallback)((()=>{const e=o.collectionStore();if(!e||!a||!(0,Lo.qQ)(a))return;const i=(0,Lo.q3)(a);i&&"prompt"in i&&(h.current={...h.current,[i.type]:i.prompt}),Ba.saveOrRemovePropertyAiInference({environment:m,propertySchema:a,collectionStore:e,property:t,draftAiInference:v})}),[o,a,v,t,m]),_=(0,r.VK)((()=>{var e;return(null===(e=o.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString())||""}),[o]),k=(0,i.useCallback)((async()=>{if(a&&(0,Lo.qQ)(a)&&Pt.Xy(v,(0,Lo.q3)(a)))l.E3({collectionSettingsStore:s});else if(v){var e;if("prompt"in v)if((0,Lo.DS)(v)&&0===(null===(e=v.prompt)||void 0===e?void 0:e.length)||(0,Ze.$K)(v.prompt)&&v.prompt.length>Pa.Th)return void w(!0);(null==p||!p.auto_update_on_edit)&&null!=v&&v.auto_update_on_edit&&x&&a?await Za.r({sourceAction:"auto_update",propertyName:a.name,collectionName:_})&&M():M()}}),[_,s,p,v,M,x,a]),V=(0,i.useCallback)((()=>{const e=o.collectionStore();e&&p&&a&&(Ba.saveOrRemovePropertyAiInference({environment:m,propertySchema:a,collectionStore:e,property:t,draftAiInference:null}),l.z$({collectionSettingsStore:s}))}),[o,p,m,a,t,s]),I=a&&(0,Lo.qQ)(a)&&Pt.Xy(v,(0,Lo.q3)(a)),Z=(0,i.useCallback)((async()=>new Promise((e=>{F.showDialog({showCancel:!1,keepFocus:!1,message:(0,C.jsxs)(Ka.sg,{alignItems:"center",gap:8,children:[(0,Ia.y)(f.confirmDiscardChangesDialogIconStyle),(0,C.jsx)("div",{style:f.confirmDiscardChangesDialogMessageStyle,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Do you want to discard changes for AI autofill?",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.message"})})]}),items:[{label:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Discard",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.acceptLabel"}),color:"red",onAccept:()=>e(!0)},{label:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Continue editing",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.cancelLabel"}),onAccept:()=>e(!1)}]})}))),[f]),K=(0,i.useCallback)((async()=>{(I||await Z())&&l.z$({collectionSettingsStore:s})}),[I,s,Z]),O=(0,i.useCallback)((async()=>{(I||await Z())&&l.E3({collectionSettingsStore:s})}),[I,s,Z]),L=(0,r.VK)((()=>{var e;const t=(null===(e=Gr.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,Tr.de)(t)}),[]);return a&&(0,Lo.qQ)(a)&&c?(0,C.jsx)(g.Z,{debugName:"CollectionSettingsPropertyAiAutofill",capture:!0,onEsc:O,children:(0,C.jsxs)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Fill “{propertyName}” with AI",id:"database.viewSettings.propertyTab.aiAutofill.title",values:{propertyName:a.name}}),handleBackArrowClick:K,handleClose:O,children:[!S&&(0,C.jsx)(U.Z,{style:f.menuItemStyle,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"You don't have permission to set up AI autofill on this database.",id:"database.viewSettings.propertyTab.aiAutofill.noSetupPermission"})}),"text"===a.type&&(0,C.jsx)(Xa,{collectionContextStore:o,propertySchema:a,previousPromptByAiInferenceType:h.current,isAutofillSetupEnabled:Boolean(S),draftAiInference:v,setDraftAiInference:b,environment:m,propertyId:t,collectionSchema:u,shouldShowUserPromptIsInvalidError:j,setShouldShowUserPromptIsInvalidError:w,doesUserHaveAIAddOn:L}),(0,Lo.cu)(a)&&(0,C.jsx)(Wa,{collectionContextStore:o,isAutofillSetupEnabled:Boolean(S),draftAiInference:v,setDraftAiInference:b,environment:m,shouldShowUserPromptIsInvalidError:j,setShouldShowUserPromptIsInvalidError:w,doesUserHaveAIAddOn:L}),(0,Lo.by)(v,a.type)&&(0,C.jsxs)(U.Z,{children:[(0,C.jsx)(rl,{environment:m,isAutofillSetupEnabled:S,collectionContextStore:o,tryAutofillStore:y,propertySchema:a,property:t,aiInference:v}),(0,C.jsx)(H.Z,{style:{...f.buttonStyle,margin:"8px 12px 12px 12px",display:I?"none":"flex"},onClick:k,disabled:!S,children:I?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Done",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonAllSaved"}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Save changes",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonWithChanges"})})]}),(0,C.jsxs)(U.Z,{topBorder:!0,title:m.device.isMobile&&So.default.formatMessage(il.toggleFillWithAiSectionLabel),children:[(0,Lo.by)(p,a.type)&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Kr.TB,{environment:m,collectionContextStore:o,collectionStore:c,property:t,propertySchema:a,doesUserHaveAIAddOn:L,isAutofillSetupEnabled:Boolean(S)}),(0,C.jsx)(B.Z,{icon:T.y,isRed:!0,focused:!1,title:So.default.formatMessage(il.removeAutofillButton),onClick:V,disabled:!S})]}),(0,C.jsx)(ls.Z,{href:(0,jn.UY)("guides.aiAutofill"),title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Learn about AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.learnMoreLink"}),analyticsFrom:"collection_ai_autofill_menu"})]})]})}):null}function rl(e){let{environment:t,isAutofillSetupEnabled:o,collectionContextStore:n,tryAutofillStore:s,propertySchema:a,property:l,aiInference:c}=e;const[d,u]=(0,i.useState)(Fa.Il()),p=(0,i.useRef)(Fa.Il()),g=(0,r.VK)((()=>s.state.stage),[s]),m=(0,r.VK)((()=>{const e=n.contextType;if("collectionPage"===e)return{type:"page",candidateBlockStores:Pt.oA([(0,La.np)()])};if("collectionTypedView"===e||"collectionView"===e)return{type:"collection",candidateBlockStores:n.resultsInViewOrder(5)};throw new Error(`Unexpected context type: ${e}`)}),[n]),f=(0,i.useCallback)((()=>{var e;Ir.qG(t,{ai_inference_type:c.type,type:"undo_from_collection_settings",inference_id:d,collection_id:null===(e=n.collectionStore())||void 0===e?void 0:e.id,session_id:p.current}),"not_started"!==g&&(Aa.Yw(t,!1),s.setState({stage:"not_started"}))}),[t,c,d,n,g,s]),S=(0,Ze.Of)(m.candidateBlockStores),y=sl({isTryAutofillEnabled:o&&S}),h=Boolean((0,i.useContext)(Ra.eK));if(t.device.isMobile||h)return null;let x;return x=S?"collection"===m.type?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Updates the first {maxPages} pages. You can undo changes anytime.",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollectionDescription",values:{maxPages:5}}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:'Updates "{propertyName}" on this page. You can undo changes anytime.',id:"database.viewSettings.propertyTab.aiAutofill.tryOnPageDescription",values:{propertyName:a.name}}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Add more pages or remove filters to try AI on this view.",id:"database.viewSettings.propertyTab.tryAutofillDisabledDescription"}),(0,C.jsx)(i.Fragment,{children:(0,C.jsx)("div",{style:{margin:"8px 12px"},children:(0,C.jsxs)(Ka.X2,{gap:8,children:[(0,C.jsx)(Co.Z,{disabled:!o||!S,style:{...y.buttonStyle,...y.undoButtonStyle,..."not_started"===g&&{display:"none"}},onClick:f,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Undo",id:"database.viewSettings.propertyTab.aiAutofill.undoButton"})}),(0,C.jsx)($t.Z,{renderTooltip:()=>(0,C.jsx)("div",{children:x}),render:e=>(0,C.jsx)(Co.Z,{...e,disabled:!o||!S,style:{...y.buttonStyle,...y.tryButtonStyle},hoveredStyle:y.tryButtonHoveredStyle,pressedStyle:y.tryButtonPressedStyle,onClick:async()=>{if((0,Ze.Of)(m.candidateBlockStores)){const e=Fa.Il();u(e),s.setState({stage:"in_progress"}),await Ba.autofillPropertyForBlocks({environment:t,stores:m.candidateBlockStores,property:l,propertySchema:a,aiInferenceOverride:c,userEventForAnalytics:"generate_from_try_on_view_button",sessionIdForAnalytics:p.current,collectionContextStore:n,from:"ai_autofill_settings"}),s.setState({stage:"complete"})}},children:"in_progress"===g?(0,C.jsx)(Oa.Z,{}):(0,C.jsxs)(C.Fragment,{children:[(0,Ia.y)({width:16,..."not_started"!==g&&{display:"none"}}),"not_started"!==g?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Try again",id:"database.viewSettings.propertyTab.aiAutofill.tryAgain"}):"collection"===m.type?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Try on this view",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollection"}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Try on this page",id:"database.viewSettings.propertyTab.aiAutofill.tryOnPage"})]})})})]})})})}function sl(e){const t=(0,f.Fg)();return(0,f.yK)((()=>({buttonStyle:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"center",gap:8},menuItemStyle:{fontSize:13,borderRadius:6,background:t.accentColors.purple[50],color:t.accentColors.purple[500],margin:"8px 12px",padding:"8px 12px"},undoButtonStyle:{border:`1px solid ${t.accentColors.gray[100]}`,flex:1},tryButtonStyle:{fontWeight:500,flex:1,background:null!=e&&e.isTryAutofillEnabled?"light"===t.mode?t.accentColors.purple[50]:t.accentColors.purple[200]:t.accentColors.gray[50],color:null!=e&&e.isTryAutofillEnabled?t.aiPurpleColor:t.accentColors.gray[400]},fillAllPagesWandIconStyle:{fill:t.aiPurpleColor},tryButtonHoveredStyle:{background:t.accentColors.purple[100]},tryButtonPressedStyle:{background:t.accentColors.purple[200]},confirmDiscardChangesDialogIconStyle:{width:32,height:32,fill:t.aiPurpleColor,paddingTop:8},confirmDiscardChangesDialogMessageStyle:{textAlign:"center",fontWeight:500}})),[t,null==e?void 0:e.isTryAutofillEnabled])}var al=o(629551),ll=o(305971),cl=o(282356);function dl(e){let{active:t,caption:o,onClick:i,icon:n}=e;const r=ul({active:t});return(0,C.jsxs)("div",{onClick:i,style:r.container,children:[n,(0,C.jsx)("span",{style:r.caption,children:o})]})}function ul(e){let{active:t}=e;return(0,f.yK)((e=>({container:{cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:6},outerRect:{fill:e.contentBackground,x:1,y:1,width:112,height:48,rx:6,stroke:t?e.accentColors.blue[400]:e.accentColors.gray[100],strokeWidth:t?2:1},caption:{fontSize:10,fontWeight:t?I.Z.fontWeight.semibold:I.Z.fontWeight.regular,color:t?e.darkTextColor:e.lightTextColor}})),[t])}function pl(){const{layoutStore:e,currentModuleSelection:t}=(0,Ra.J9)(),o=(0,ll.E)("page_layouts"),i=(0,r.VK)((()=>{if("existing_module"===(null==t?void 0:t.type))return e.getModuleById(t.moduleId)}),[t,e]);if(!o||!i)return null;switch(i.type){case"property_person":case"property_created_by":case"property_last_edited_by":return(0,C.jsx)(gl,{module:i});default:return null}}function gl(e){let{module:t}=e;const o=(0,n.O7)(),{layoutStore:s}=(0,Ra.J9)(),a=(0,ll.E)("page_layouts"),l=(0,r.VK)((()=>{if("property_person"===(null==t?void 0:t.type)||"property_created_by"===(null==t?void 0:t.type)||"property_last_edited_by"===(null==t?void 0:t.type))return t.style}),[t]),c=(0,i.useCallback)((e=>{if(!t)return;const i=s.getModel(),n=null==i?void 0:i.getRawPageModuleAreaById(t.id);if(!n||!i)return;const r=i.updatePageModuleWithId({area:n,moduleId:t.id,fn:o=>"property"!==o.type?o:{...o,config:{[t.type]:{style:e}}}});d.createAndCommit({environment:o,perform(e){(0,cl.JH)({transaction:e,rawModules:r,layoutStore:s,area:n})},userAction:"BuilderLayoutModules.togglePersonDisplay"})}),[o,s,t]),u=(0,f.yK)((e=>{const t={width:112,height:80,minHeight:80,borderRadius:6},o=e.accentColors.gray[100],i=e.stroke.uiBlue;return{smallOption:{...t,border:`2px solid ${"compact"===l?i:o}`},mediumOption:{...t,border:`2px solid ${"large"===l?i:o}`},container:{margin:"10px 16px"},label:{fontSize:I.Z.fontSize.UISmall.desktop,fontWeight:I.Z.fontWeight.medium,margin:0,marginBottom:6,color:e.text.secondary}}}),[l]);return t&&a?(0,C.jsxs)("div",{style:u.container,children:[(0,C.jsx)("p",{style:u.label,children:(0,C.jsx)(P.FormattedMessage,{id:"PropertyTypeSpecificModuleConfiguration.person.display.title",defaultMessage:"Style"})}),(0,C.jsxs)(al.gq,{gap:10,children:[(0,C.jsx)(dl,{icon:(0,C.jsx)("img",{src:S.Z.images.layouts.configuration.personCompactPng,style:u.smallOption}),active:"compact"===l,onClick:()=>c("compact"),caption:(0,C.jsx)(P.FormattedMessage,{id:"PropertyTypeSpecificModuleConfiguration.person.display.compact",defaultMessage:"Compact"})}),(0,C.jsx)(dl,{icon:(0,C.jsx)("img",{src:S.Z.images.layouts.configuration.personMediumPng,style:u.mediumOption}),active:"large"===l,onClick:()=>c("large"),caption:(0,C.jsx)(P.FormattedMessage,{id:"PropertyTypeSpecificModuleConfiguration.person.display.large",defaultMessage:"Large"})})]})]}):null}const ml=i.memo((function(e){const{collectionContextStore:t,collectionSettingsStore:o,formatKey:s,property:a,selectNameInitial:l}=e,[c,u]=(0,i.useState)(!1),[p,g]=(0,i.useState)(""),m=(0,n.O7)(),S=(0,i.useRef)(null),y=(0,P.useIntl)(),h=(0,f.Fg)(),{collectionStore:x,databaseType:v,isCollectionViewBlockContext:b,isMultiSourceView:j}=(0,r.VK)((()=>({collectionStore:t.collectionStore(),databaseType:t.databaseType,isCollectionViewBlockContext:"collectionViewBlock"===t.contextType,isMultiSourceView:"collectionTypedView"===t.contextType})),[t]),w=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t.normalizedSchemaStore]),M=(0,r.VK)((()=>Boolean(null==x?void 0:x.isTypedProperty(a))),[x,a]),_=(0,r.VK)((()=>(0,Ri.Qm)({schema:w,property:a})),[a,w]),k=(0,r.VK)((()=>Cl({property:a,formatKey:s,collectionContextStore:t})),[t,s,a]),V=(0,r.VK)((()=>jl({property:a,collectionContextStore:t,inputValue:p})),[t,p,a]),T=(0,r.VK)((()=>{var e;const o=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!o&&(0,Hr.Kj)(o)}),[t]),I=(0,r.VK)((()=>Boolean(x&&v&&Ar.cR((0,Zr.appConfigs)(),v,a,x))),[x,v,a]),F=(0,r.VK)((()=>{var e;const o=t.collectionViewStore();return!!o&&(Boolean((null===(e=Cl({property:a,formatKey:s,collectionContextStore:t}))||void 0===e?void 0:e.wrap)||o.getFormat().table_wrap)&&"timeline"!==o.getType())}),[t,s,a]),Z=(0,r.qz)(void 0,We.Z),B=(0,r.VK)((()=>Ei.Z.state.isOpen),[]);(0,i.useEffect)((()=>{!function(e,t,o){const i=t.collectionViewStore();if(!i||"table"!==i.getType())return;const n=Ur.Z.findTableHeaderCell(t,e);if(!n)return;const r=n.getNode();if(!r||!o)return;const s=(0,Er.xH)(r);if(!s)return;const a=o.getBoundingClientRect(),l=r.getBoundingClientRect().right+20-a.left;s.scrollLeft=s.scrollLeft+l}(a,t,S.current),_&&g(_.name||"")}),[]);const K=(0,i.useCallback)((e=>{!function(e){const{name:t,environment:o,property:i,collectionContextStore:n,inputValue:r}=e;if(jl({property:i,collectionContextStore:n,inputValue:r}))return;const s=n.collectionStore();if(!s)return;const a=s.getSchema(),l=a[i];if(!l)return;if(l.name===t)return;d.createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyNameSubmit",environment:o,perform:e=>{Ae.Bv({collectionStore:s,property:i,name:t,transaction:e})}}),ut.$q({environment:o,collectionContextStore:n,property:i,from:"view_settings",action:"rename"})}({collectionContextStore:t,environment:m,inputValue:p,name:e,property:a})}),[t,m,p,a]),O=(0,i.useCallback)((e=>{u(!c),e.stopPropagation()}),[c]),L=(0,i.useCallback)((e=>{!function(e){var t;const{description:o,environment:i,collectionContextStore:n,property:r}=e,s=n.collectionStore(),a=null==s||null===(t=s.getSchema())||void 0===t?void 0:t[r];if(!s||void 0===a||o===a.description)return;d.createAndCommit({userAction:"CollectionSettingsProperty.handleDescriptionChange",environment:i,perform:e=>{Po.xO({environment:i,collectionStore:s,update:{[r]:{...a,description:o}},transaction:e})}}),ut.$q({environment:i,collectionContextStore:n,property:r,from:"view_properties",action:"set_description"})}({collectionContextStore:t,description:e,environment:m,property:a})}),[t,m,a]),R=(0,i.useCallback)((e=>{g(e)}),[]);if(!_)return null;const D=!(0,Ri.Kp)(_),z=j,N=j||(0,Ri.sh)({propertySchema:_,isTypedProperty:M}),E=_.description;return(0,C.jsxs)(A.ZP,{...e,title:x?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Edit property",id:"database.viewSettings.propertyTab.title"}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"View property",id:"database.viewSettings.propertyTab.title.viewProperty"}),footer:(0,C.jsx)(Hl,{collectionContextStore:t,formatKey:s,property:a,collectionSettingsStore:o,wrapProperty:F,propertySchema:_,propertyFormat:k,isRequiredTypedProperty:I,databaseType:v}),unconstrainedWidth:b,ref:S,children:[(0,C.jsxs)(U.Z,{children:[(0,C.jsx)(Fo.I,{disabled:z,initialValue:_.name||"",placeholder:So.default.formatMessage(_s.Z.inputPlaceholder),onBlur:K,onSubmit:K,focusInitial:l,selectAll:l,inputOuterStyle:b?{background:h.contentBackground}:void 0,iconButton:{icon:e=>(0,C.jsx)(Ro.ZP,{type:_.type,icon:_.icon,size:16,theme:h,style:e}),iconStyle:{fill:To.Lr[h.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o,i){const n=o.collectionStore();if(!n)return;d.createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyIconSubmit",environment:e,perform:e=>{Ae.OK({collectionStore:n,property:t,icon:i,transaction:e})}}),ut.$q({environment:e,collectionContextStore:o,property:t,icon:i,from:"view_settings",action:"change_icon"})}(m,a,t,e)},inputRightButton:T?null:(0,C.jsx)($r.l,{description:E,showTooltip:!c,onClick:O,addDescriptionText:y.formatMessage(ji.aB.addPropertyDescriptionTooltip),editDescriptionText:y.formatMessage(ji.aB.editPropertyDescriptionTooltip)}),onChange:R}),V&&(0,C.jsx)(Qs.Z,{propertyName:p})]}),c&&(0,C.jsx)(qr.i,{initialDescription:E,handleSaveDescription:L}),B?(0,C.jsx)(pl,{}):null,(0,C.jsxs)(U.Z,{children:[D&&(0,C.jsx)(wl,{disabled:N,isTypedProperty:M,collectionUri:v,collectionContextStore:t,formatKey:s,propertyTypeButtonPopupStore:Z,property:a}),j?(0,C.jsxs)(C.Fragment,{children:["status"===_.type&&(0,C.jsx)(Ml,{collectionSettingsStore:o,collectionContextStore:t,property:a}),("date"===_.type||"created_time"===_.type||"last_edited_time"===_.type)&&(0,C.jsx)(kl,{collectionContextStore:t,property:a})]}):(0,C.jsx)(Ul,{collectionContextStore:t,property:a,propertySchema:_})]})]})}));function fl(e,t,o,i){const n=Cl({property:i,formatKey:o,collectionContextStore:t}),r=t.collectionViewStore(),s=t.normalizedFormatStore.state,a=Tl({collectionContextStore:t,property:i});if(!a)return;if(!(n&&r&&o&&a))return;const l=hl({formatKey:o,collectionContextStore:t}).map((e=>e.property===n.property?{...n,visible:!n.visible}:e)),c={...s,[o]:l};d.createAndCommit({userAction:"CollectionSettingsProperty.handleToggleVisibilityClick",environment:e,perform:s=>{Po.iG({collectionViewStore:r,update:{format:c},transaction:s});const a=bl({property:i,formatKey:o,collectionContextStore:t});pt.oz({environment:e,collectionContextStore:t,currentIndex:a,entrypoint:"CollectionSettingsProperty",transaction:s,propertyAction:n.visible?"hide":"show"})}}),ut.wd({environment:e,collectionContextStore:t,action:"toggle_property_visibility",original_view_type:r.getType(),property_type:a.type})}async function Sl(e,t,o,i,n,r){await Ae.TI({environment:e,collectionContextStore:o,property:i,handleDeleteAccept:()=>function(e,t,o,i,n){const r=o.normalizedSchemaStore.state,s=o.collectionStore(),a=(0,Ri.Qm)({schema:r,property:t});a&&(s&&d.createAndCommitAsync({environment:e,userAction:"CollectionSettingsProperty.handleDeleteAccept",waitForServerCommit:!1,perform:async i=>{await Ae.yV({environment:e,collectionStore:s,schema:r,property:t,transaction:i});const a=bl({property:t,formatKey:n,collectionContextStore:o});pt.oz({environment:e,collectionContextStore:o,currentIndex:a,entrypoint:"CollectionSettingsProperty",transaction:i,propertyAction:"delete"})}}),l.z$({collectionSettingsStore:i}),ut.wd({environment:e,collectionContextStore:o,action:"delete_property",property_type:null==a?void 0:a.type}),ut.y9({environment:e,collectionContextStore:o,property_type:a.type,from:"view_settings",property:t}))}(e,i,o,n,r),theme:t,from:"view_settings"})}function yl(e){const{collectionContextStore:t,collectionSettingsStore:o,environment:i,formatKey:n,property:r,propertySchema:s,propertyTypeButtonPopupStore:a}=e;t.collectionStore()&&l.H4({collectionSettingsStore:o,item:{type:"propertyType",propertySchema:s,onAccept:e=>function(e){const{collectionContextStore:t,collectionSettingsStore:o,environment:i,formatKey:n,property:r,propertyTypeButtonPopupStore:s,type:a}=e,c=t.collectionStore();if(!c)return;ut.$q({environment:i,collectionContextStore:t,property:r,new_property_type:(0,Lo.TN)(a),from:"view_settings",action:"change_type"}),"relation"===a?l.H4({collectionSettingsStore:o,item:{type:"selectRelationSource",property:r,formatKey:n}}):(d.createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyTypeAccept",environment:i,perform:e=>{Ae.LC({environment:i,collectionStore:c,property:r,type:a,transaction:e})}}),l.z$({collectionSettingsStore:o}),(0,Lo.XU)(a)&&Fr.K7({propertyType:a,propertyId:r,collectionContextStore:t}));s.reset()}({collectionContextStore:t,collectionSettingsStore:o,environment:i,formatKey:n,property:r,propertyTypeButtonPopupStore:a,type:e})}})}function hl(e){const{formatKey:t,collectionContextStore:o}=e;if(!t)return[];var i;if("collection_page_properties"===t)return(null===(i=o.collectionStore())||void 0===i?void 0:i.getFormat().collection_page_properties)??[];return o.normalizedFormatStore.state[t]||[]}function xl(e){const t=e.getViewType();if(!t)throw new Error("View type was not defined.");return t}function vl(e){const t=e.collectionStore();return t?t.getSchema():e.normalizedSchemaStore.state||{}}function Cl(e){const{collectionContextStore:t,formatKey:o,property:i}=e,n=hl({formatKey:o,collectionContextStore:t});return null==n?void 0:n.find((e=>e.property===i))}function bl(e){const{collectionContextStore:t,formatKey:o,property:i}=e,n=hl({formatKey:o,collectionContextStore:t});if(0===n.length)return-1;return n.filter((e=>e.visible)).findIndex((e=>e.property===i))}function jl(e){const{collectionContextStore:t,inputValue:o,property:i}=e,n=vl(t),r=Object.keys(n).find((e=>{var t;return e!==i&&(null===(t=n[e])||void 0===t?void 0:t.name)===o}));return Boolean(r)}function wl(e){const{collectionContextStore:t,collectionUri:o,disabled:s,formatKey:a,isTypedProperty:l,property:c,propertyTypeButtonPopupStore:d}=e,u=(0,f.Fg)(),p=(0,n.O7)(),g=(0,r.VK)((()=>t.collectionViewBlockStore()),[t]),m=(0,r.VK)((()=>Tl({property:c,collectionContextStore:t})),[t,c]),S=dn(g,m),y=(0,r.VK)((()=>null==S?void 0:S.getIcon()),[S]),h=t.settingsStore,x=(0,i.useCallback)((()=>{m&&yl({collectionContextStore:t,collectionSettingsStore:h,environment:p,formatKey:a,property:c,propertySchema:m,propertyTypeButtonPopupStore:d})}),[t,h,p,a,c,m,d]);if(!m)return null;const v=(0,Ri.gg)(m)||(0,Ri.ic)(m);return(0,C.jsx)($t.Z,{placement:Qt.u.Left,disableTooltip:!s,renderTooltip:e=>l?(0,C.jsx)(P.FormattedMessage,{...e,defaultMessage:"{type} type is required for this property in {databaseType}.",id:"database.viewSettings.propertyTab.restrictedProperty",description:"A tooltip to educate the users on why they can't change the type of this property.",values:{type:ri.SO[m.type],databaseType:(0,Ke.Mn)(o)}}):(0,C.jsx)(P.FormattedMessage,{...e,defaultMessage:"{type}'s type cannot be changed.",id:"database.viewSettings.propertyTab.untypedRestrictedProperty",description:"A tooltip to educate the users on why they can't change the type of this property.",values:{type:ri.SO[m.type]}}),render:e=>(0,C.jsx)(B.Z,{...e,disabled:s,rotateChevron:d.state.open,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Type",id:"database.viewSettings.propertyTab.propertyType"}),showChevron:!0,right:(0,C.jsxs)(C.Fragment,{children:[s?(0,C.jsx)("div",{...e,children:(0,vn.Q)({width:14,fill:u.regularIconColor})}):(0,C.jsx)(Ro.ZP,{type:m.type,icon:void 0,size:16,theme:u}),(0,C.jsx)(An.Z,{size:4}),v?(0,C.jsxs)("div",{style:{color:s?u.darkTextColor:void 0,display:"flex",alignItems:"center"},children:[(0,C.jsx)(bo.Z,{icon:y,isEmptyPage:!1,size:20,disabled:!0}),(0,C.jsx)(Ni.Z,{store:S,style:{display:"inline",wordBreak:"break-word",...I.Z.textOverflowStyle}})]}):(0,C.jsx)("span",{style:{color:s?u.darkTextColor:void 0},children:ri.SO[m.type]})]}),onClick:x})})}function Ml(e){let{collectionSettingsStore:t,collectionContextStore:o,property:i}=e;const n=(0,r.VK)((()=>{var e;return Ar.Hw(null===(e=o.collectionStore())||void 0===e?void 0:e.getDatabaseType(),o.normalizedSchemaStore.state,i)}),[o,i]);return(0,C.jsxs)(C.Fragment,{children:[n?null:(0,C.jsx)(Gs,{collectionContextStore:o,property:i,disabled:n}),(0,C.jsx)(As,{collectionSettingsStore:t,collectionContextStore:o,property:i,disabled:n,aIAutofillOption:null})]})}function _l(e){let{collectionContextStore:t,collectionSettingsStore:o,property:i}=e;return(0,C.jsx)(as,{collectionContextStore:t,collectionSettingsStore:o,property:i})}function kl(e){let{collectionContextStore:t,property:o}=e;return(0,C.jsx)(Jr,{collectionContextStore:t,property:o})}function Vl(e){let{collectionContextStore:t,property:o}=e;return(0,r.VK)((()=>{const e=t.normalizedSchemaStore.state[o];return(0,Ri.Kp)(e)}),[t,o])?(0,C.jsx)(Cr,{collectionContextStore:t,property:o}):(0,C.jsx)(cn,{collectionContextStore:t,property:o})}function Tl(e){let{collectionContextStore:t,property:o}=e;return vl(t)[o]}function Pl(e){let{collectionContextStore:t,property:o}=e;const i=(0,r.VK)((()=>Tl({collectionContextStore:t,property:o})),[t,o]);return i&&("number"===i.type||"formula"===i.type||"rollup"===i.type)?(0,C.jsx)(js,{collectionContextStore:t,property:o}):null}function Il(e){let{collectionContextStore:t,property:o}=e;const i=(0,r.VK)((()=>Tl({collectionContextStore:t,property:o})),[t,o]),n=(0,r.VK)((()=>t.collectionStore()),[t]);return i&&"url"===i.type&&n?(0,C.jsx)(qs,{collectionContextStore:t,property:o,propertySchema:i}):null}function Fl(e){let{collectionContextStore:t,property:o}=e;const i=(0,r.VK)((()=>Tl({collectionContextStore:t,property:o})),[t,o]);return i&&"person"===i.type?(0,C.jsx)(is,{collectionContextStore:t,propertySchema:i,property:o}):null}function Zl(e){let{collectionContextStore:t,property:o}=e;const i=(0,r.VK)((()=>Tl({collectionContextStore:t,property:o})),[t,o]);return i&&"button"===i.type?(0,C.jsx)(Pr.fq,{collectionContextStore:t,propertySchema:i,propertyId:o}):null}function Al(e){let{collectionContextStore:t,property:o}=e;const i=(0,r.VK)((()=>Tl({collectionContextStore:t,property:o})),[t,o]);return i?(0,C.jsx)(on,{collectionContextStore:t,propertySchema:i,property:o}):null}function Bl(e){let{collectionContextStore:t,property:o}=e;const i=(0,r.VK)((()=>Tl({collectionContextStore:t,property:o})),[t,o]),n=(0,r.VK)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e?void 0:e.getRecordKeyStore();return null==o?void 0:o.getRecordKey()}),[t]);return i&&"auto_increment_id"===i.type?(0,C.jsx)(Rn,{uniqueIdProperty:{propertyId:o,propertySchema:i},prefixValue:n,collectionContextStore:t}):null}function Kl(e){let{collectionContextStore:t,property:o}=e;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Al,{collectionContextStore:t,property:o}),(0,C.jsx)(Fl,{collectionContextStore:t,property:o})]})}function Ol(e){const{environment:t,property:o,propertySchema:n,collectionSettingsStore:s,collectionStore:a}=e,c=(0,r.VK)((()=>(0,Lo.q3)(n)),[n]),u=(0,r.VK)((()=>(0,Nr.mX)(t,Wr.Z.getMode(t,a),a)),[t,a]),p=(0,i.useMemo)((()=>{const e=n.name.trim(),t=ri.SO[n.type],o=new RegExp(`${t}(?:\\s?\\d+)?`);return!e||o.test(e)}),[n.name,n.type]),g=(0,i.useCallback)((()=>{if(!a||!n||!(0,Lo.cu)(n))return;const e=(0,Lo.xo)(n);if(!e)return;const i=[];if(c)Ir._e(t,{type:"remove_ai_inference",ai_inference_type:c.type,collection_id:a.id}),i.push({pointer:a.pointer,command:"set",path:["schema",o,e],args:void 0});else{const r={type:n.type,auto_update_on_edit:!1,add_options:!1};Ir._e(t,{type:"set_ai_inference",ai_inference_type:r.type,collection_id:a.id}),i.push({pointer:a.pointer,command:"set",path:["schema",o,e],args:r})}Po.HW({environment:t,collectionStore:a,performTransaction:e=>{for(const t of i)d.applyOperation({store:(0,Go.Kv)(a,t.pointer),operation:t,transaction:e})}})}),[c,a,t,o,n]),m=(0,i.useCallback)((e=>{if(!n||!a||!(0,Lo.qQ)(n))return;const i=(0,Lo.xo)(n);if(!i)return;const r={pointer:a.pointer,command:"set",path:["schema",o,i],args:e};Po.HW({environment:t,collectionStore:a,performTransaction:e=>{d.applyOperation({store:(0,Go.Kv)(a,r.pointer),operation:r,transaction:e})}})}),[a,t,o,n]);return(0,r.VK)((()=>u&&(0,Nr.KZ)()),[u])?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Bs,{disabled:!0,overrideStyle:{marginTop:6,paddingTop:6}},"aiSectionHeader"),(0,C.jsx)($t.Z,{disableTooltip:!p,placement:Qt.u.Left,renderTooltip:e=>(0,C.jsx)(P.FormattedMessage,{...e,defaultMessage:"Update the property name to use AI Autofill",id:"database.collectionsettings.autofilloptions.disableswitch.tooltip",description:"User needs to change the property name from the default name to turn on autofill"}),render:e=>(0,C.jsx)(Kt.Z,{...e,title:(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,C.jsx)(P.FormattedMessage,{defaultMessage:"AI Autofill",id:"database.viewSettings.propertyTab.aiAutofill.open"}),(0,C.jsx)(Rr.Z,{style:{display:"inline-block"}})]}),showChevron:!1,switcherProps:{on:Boolean(c),noColor:!1},onClick:g,disabled:!u||p}),style:{whiteSpace:"break-spaces"}}),c&&!p&&("select"===c.type||"multi_select"===c.type)&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Lr,{setAiInference:m,aiInference:c,disabled:!u}),(0,C.jsx)(B.Z,{title:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",lineHeight:1.2,color:no.ZP.uiGray},children:[(0,C.jsx)(P.FormattedMessage,{id:"database.collectionsettings.aiAutofillOptions.more",defaultMessage:"More"}),(0,Mr.o)({fill:no.ZP.uiGray,width:12,height:12,marginLeft:4})]}),disabled:!1,onClick:()=>{l.H4({collectionSettingsStore:s,item:{type:"propertyAiAutofill",propertySchema:n,property:o}})}})]})]}):null}function Ll(e){const{environment:t,property:o,propertySchema:i,collectionContextStore:n,collectionStore:s}=e,a=(0,r.VK)((()=>{var e;const t=(null===(e=Gr.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,Tr.de)(t)}),[]),l=(0,r.VK)((()=>{const e=n.collectionStore();return e&&(0,Nr.mX)(t,Wr.Z.getMode(t,e),e)}),[t,n]);return(0,r.VK)((()=>(0,Lo.cu)(i)&&(0,Nr.KZ)()&&i.select_ai_inference),[i])?(0,C.jsx)(Kr.TB,{environment:t,collectionContextStore:n,collectionStore:s,property:o,propertySchema:i,doesUserHaveAIAddOn:a,isAutofillSetupEnabled:Boolean(l)}):null}function Rl(e){let{propertySchema:t,collectionSettingsStore:o,collectionContextStore:i,property:s}=e;const a=(0,n.O7)(),l=(0,r.VK)((()=>i.collectionStore()),[i]);return l?(0,C.jsx)(As,{collectionSettingsStore:o,collectionContextStore:i,property:s,disabled:!1,aIAutofillOption:(0,C.jsx)(Ol,{environment:a,collectionStore:l,collectionSettingsStore:o,property:s,propertySchema:t})}):null}function Dl(e){let{collectionContextStore:t,property:o}=e;const i=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t])[o];let n;return n=(0,Ri.Kp)(i)?(0,C.jsx)(ls.Z,{href:(0,jn.UY)("guides.githubRelation"),title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Learn about GitHub Pull Requests",id:"database.viewSettings.propertyTab.githubPrRelation.learnMoreButton.title"}),analyticsFrom:"view_settings_property_github_pr_relation"}):(0,C.jsx)(ls.Z,{href:(0,jn.UY)("guides.relations"),title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Learn about relations",id:"database.viewSettings.propertyTab.relations.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"}),(0,C.jsx)(U.Z,{topBorder:!0,children:n})}function zl(e){let{collectionContextStore:t,property:o,collectionSettingsStore:i}=e;const n=(0,r.VK)((()=>Tl({collectionContextStore:t,property:o})),[t,o]);if(!n||"text"!==n.type)return null;const s=(0,Lo.q3)(n);let a;return s&&(0,Lo.MD)(s.type)?"summarize"===s.type?a=zr.Dr.autofillSummary:"extract"===s.type?a=zr.Dr.autofillExtract:"custom"===s.type?a=zr.Dr.autofillCustom:"translate"===s.type?a=zr.Dr.autofillTranslate:(0,Ze.t1)(s):a=_s.Z.autofillOffLabel,(0,C.jsx)(B.Z,{title:(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,C.jsx)(P.FormattedMessage,{defaultMessage:"AI Autofill",id:"database.viewSettings.propertyTab.aiAutofill.open"}),(0,C.jsx)(Rr.Z,{style:{display:"inline-block"}})]}),showChevron:!0,right:So.default.formatMessage(a),onClick:()=>function(e,t,o){const i=Tl({collectionContextStore:t,property:o});t.collectionStore()&&i&&l.H4({collectionSettingsStore:e,item:{type:"propertyAiAutofill",propertySchema:i,property:o}})}(i,t,o)})}function Nl(e){let{property:t,collectionContextStore:o}=e;const i=(0,n.O7)(),s=(0,r.VK)((()=>o.collectionStore()),[o]),a=(0,r.VK)((()=>vl(o)),[o]),l=(0,r.VK)((()=>Boolean((null==s?void 0:s.getDatabaseType())&&(null==s?void 0:s.isTypedProperty(t)))),[s,t]);return s?(0,C.jsx)(Dr.Z,{disabled:l,context:Dr.t.ViewSettings,property:t,schema:a,analyticsFrom:"view_settings",parentStore:s,onChange:e=>function(e,t,o,i){const n=i.collectionStore();n&&d.createAndCommit({userAction:"CollectionSettingsProperty.handleRollupPropertyMenuChange",environment:t,perform:i=>{Po.xO({environment:t,collectionStore:n,update:{[o]:e.propertySchema},transaction:i})}})}(e,i,t,o)}):null}function El(e){let{isRequiredTypedProperty:t,databaseType:o,collectionContextStore:i,property:r,collectionSettingsStore:s,formatKey:a}=e;const l=(0,f.Fg)(),c=(0,n.O7)();return(0,C.jsx)($t.Z,{disableTooltip:!t,placement:Qt.u.Left,renderTooltip:e=>(0,Ke.A7)(o,e),render:e=>(0,C.jsx)(B.Z,{...e,isRed:!0,disabled:t,onClick:()=>Sl(c,l,i,r,s,a),icon:()=>t?(0,C.jsx)("div",{...e,style:{display:"inline-flex"},children:(0,vn.Q)({width:14,marginLeft:4,marginRight:4})}):(0,T.y)({width:14,marginLeft:4,marginRight:4}),title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Delete property",id:"database.viewSettings.propertyTab.deleteButton.title"}),caption:c.device.isMobile&&t?(0,Ke.A7)(o):null})})}function Hl(e){let{propertySchema:t,propertyFormat:o,isRequiredTypedProperty:s,databaseType:a,collectionContextStore:u,formatKey:p,property:g,collectionSettingsStore:m,wrapProperty:f}=e;const S=(0,n.O7)(),y=(0,i.useCallback)((()=>function(e,t,o,i,n){const r=Cl({property:i,formatKey:o,collectionContextStore:t}),s=t.collectionViewStore(),a=t.normalizedFormatStore.state,l=Tl({collectionContextStore:t,property:i});l&&r&&s&&o&&l&&(pt.K4({currentValue:n,environment:e,property:i,collectionViewStore:s,format:a,formatKey:o}),ut.wd({environment:e,collectionContextStore:t,action:"toggle_property_wrap",original_view_type:s.getType(),property_type:l.type}))}(S,u,p,g,f)),[S,u,p,g,f]),h=(0,r.VK)((()=>u.collectionStore()),[u]),x=(0,r.VK)((()=>Ei.Z.state.isOpen),[]),v=(0,r.VK)((()=>p&&("title"!==g||(0,Oe.XO)({viewType:xl(u),format:u.normalizedFormatStore.state}))),[p,g,u]),b=(0,r.VK)((()=>p&&(0,Oe.w0)({viewType:xl(u),property:g})),[p,g,u]),j=ri.Tr.includes(t.type)&&!(0,Lo.dx)(t)&&h&&!x,w=ri.Tr.includes(t.type)&&h&&!x;return(0,C.jsxs)(C.Fragment,{children:[b&&o&&(0,C.jsx)(U.Z,{topBorder:!0,children:(0,C.jsx)(Kt.Z,{isPadded:!0,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Wrap in view",id:"database.viewSettings.propertyTab.wrapInViewButton.title"}),switcherProps:{on:f,disallowTabbing:!0},onClick:y})}),(v||j||w)&&(0,C.jsxs)(U.Z,{topBorder:!0,children:[h&&(0,C.jsx)(Ll,{environment:S,collectionStore:h,collectionContextStore:u,property:g,propertySchema:t}),v&&o&&(null!=o&&o.visible?(0,C.jsx)(B.Z,{icon:kt.L,isPadded:!0,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Hide in view",id:"database.viewSettings.propertyTab.hideInViewButton.title"}),onClick:()=>fl(S,u,p,g)}):(0,C.jsx)(B.Z,{icon:kr.N,isPadded:!0,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Show in view",id:"database.viewSettings.propertyTab.showInViewButton.title"}),onClick:()=>fl(S,u,p,g)})),j&&(0,C.jsx)(B.Z,{icon:_r.a,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Duplicate property",id:"database.viewSettings.propertyTab.duplicateButton.title"}),onClick:()=>async function(e,t,o,i,n){const r=hl({formatKey:n,collectionContextStore:o}),s=o.normalizedSchemaStore.state,a=o.collectionStore(),u=null==a?void 0:a.getSpaceId();if(!a||!u)return;const p=(0,Ri.Qm)({schema:s,property:t});if(!p)return;const g=await(0,Oe.xy)({environment:e,schema:s,property:t,properties:r,parentStore:a,spaceId:u});if(!g)return;const m=e.currentUser.id,f=m?{id:m,table:Vr.KJ}:void 0,S=o.collectionViewStore();d.createAndCommit({userAction:"CollectionSettingsProperty.handleDuplicateClick",environment:e,perform:i=>{(0,Ze.$K)(g.automationUpdate)&&Br.duplicateAutomation({actorPointer:f,environment:e,sourceAutomationStore:g.automationUpdate.sourceAutomationStore,targetAutomationId:g.automationUpdate.targetAutomationId,transaction:i});const r={...a.getFormat(),collection_page_properties:g.newProperties};Po.Rm({environment:e,collectionStore:a,update:{schema:{...s,[g.newProperty]:g.newPropertySchema},format:r},transaction:i});const l=bl({property:t,formatKey:n,collectionContextStore:o});pt.oz({environment:e,collectionContextStore:o,currentIndex:l,entrypoint:"CollectionSettingsProperty",transaction:i,propertyAction:"duplicate"}),n&&S&&c.FH({stores:[S],update:{[n]:g.newProperties},transaction:i})}}),l.E3({collectionSettingsStore:i}),ut.wd({environment:e,collectionContextStore:o,action:"duplicate_property",original_view_type:null==S?void 0:S.getType(),property_type:p.type})}(S,g,u,m,p)}),w&&(0,C.jsx)(El,{collectionContextStore:u,property:g,collectionSettingsStore:m,formatKey:p,isRequiredTypedProperty:s,databaseType:a})]}),"formula"===t.type&&(0,C.jsx)(U.Z,{topBorder:!0,children:(0,C.jsx)(ls.Z,{href:(0,jn.UY)("guides.formulas"),title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Learn about formulas",id:"database.viewSettings.propertyTab.formulas.learnMoreButton.title"}),analyticsFrom:"view_settings_property_formula"})}),"relation"===t.type&&(0,C.jsx)(Dl,{collectionContextStore:u,property:g}),"rollup"===t.type&&(0,C.jsx)(U.Z,{topBorder:!0,children:(0,C.jsx)(ls.Z,{href:(0,jn.UY)("guides.relations"),title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Learn about rollups",id:"database.viewSettings.propertyTab.rollups.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"})})]})}function Ul(e){let{property:t,propertySchema:o,collectionContextStore:i}=e;const s=(0,n.O7)(),a=i.settingsStore,l=(0,r.VK)((()=>(0,Nr.Zt)(s)),[s]);return(0,C.jsxs)(C.Fragment,{children:[l&&"text"===o.type&&(0,C.jsx)(zl,{collectionContextStore:i,property:t,collectionSettingsStore:a}),(0,Lo.cu)(o)&&(0,C.jsx)(Rl,{collectionSettingsStore:a,collectionContextStore:i,property:t,propertySchema:o}),"status"===o.type&&(0,C.jsx)(Ml,{collectionSettingsStore:a,collectionContextStore:i,property:t}),"formula"===o.type&&(0,C.jsx)(_l,{collectionContextStore:i,collectionSettingsStore:a,property:t}),"rollup"===o.type&&(0,C.jsx)(Nl,{property:t,collectionContextStore:i}),("date"===o.type||"created_time"===o.type||"last_edited_time"===o.type)&&(0,C.jsx)(kl,{collectionContextStore:i,property:t}),"relation"===o.type&&(0,C.jsx)(Vl,{collectionContextStore:i,property:t}),"person"===o.type&&(0,C.jsx)(Kl,{collectionContextStore:i,property:t}),(0,C.jsx)(Pl,{collectionContextStore:i,property:t}),(0,C.jsx)(Il,{collectionContextStore:i,property:t}),"auto_increment_id"===o.type&&(0,C.jsx)(Bl,{collectionContextStore:i,property:t}),"button"===o.type&&(0,C.jsx)(Zl,{collectionContextStore:i,property:t})]})}var Wl=o(443261),Gl=o.n(Wl),$l=o(172111),ql=o(990559),Ql=o(10070),Xl=o(54119),Yl=o(915560),Jl=o(636596),ec=o(814871),tc=o(214976),oc=o(904850),ic=o(932363);const nc=[fi.U9,fi.f3,fi.mQ,fi.Dv,fi.Nw];var rc=o(833954);function sc(e){const{collectionContextStore:t,onAccept:o,propertySchema:s,disableSuggestions:a}=e,l=(0,n.Fy)(),[u,p]=i.useState(""),g=function(e){let{collectionContextStore:t,propertySchema:o,onAccept:s,searchInput:a,disableSuggestions:l}=e;const[u,p]=(0,i.useState)(!1),g=(0,P.useIntl)(),m=(0,n.O7)(),y=(0,r.VK)((()=>{const e=t.collectionStore();return Boolean(e&&(0,Nr.mX)(m,Wr.Z.getMode(m,e),e))}),[m,t]),h=(0,r.VK)((()=>{var e;if(!t)return;const o=null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.app_config_uri;return o?(0,Ar.YB)((0,Zr.appConfigs)(),o):void 0}),[t]),x=(0,r.VK)((()=>{var e,o;if(!y)return!1;if(void 0!==h)return!1;if(null===(e=t.collectionStore())||void 0===e||!e.getName())return!1;const i=null===(o=t.collectionStore())||void 0===o?void 0:o.getSchema();return!(i&&Object.keys(i).length>Lo.ci)&&(0,Nr.kL)()}),[y,h,t]),v=function(e){let{collectionContextStore:t,propertySchema:o,disableSuggestions:s,hasAiEnabled:a,showAiSuggestions:l,onAccept:u}=e;const p=(0,n.O7)(),g=(0,f.Fg)(),m=(0,P.useIntl)(),S=(0,r.VK)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.app_config_uri;return o?(0,Ar.YB)((0,Zr.appConfigs)(),o):void 0}),[t]),y=(0,r.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),h=(0,r.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat()}),[t]),x=function(e){let{collectionContextStore:t,showAiSuggestions:o}=e;const r=(0,n.O7)(),[s,a]=(0,i.useState)("loading");return(0,i.useEffect)((()=>{o&&"loading"===s&&(async()=>{const e=t.collectionStore(),o=null==e?void 0:e.getSchema(),i=o?Pt.oA(Object.values(o).map((e=>null==e?void 0:e.name.toLocaleLowerCase()))):[],n=null==e?void 0:e.getFormat(),s=null==e?void 0:e.getSpaceId(),l=null==e?void 0:e.id,u=[];if(null!=n&&n.ai_suggested_properties&&(null==n?void 0:n.ai_suggested_properties.length)>0)null==n||n.ai_suggested_properties.forEach((e=>u.push(e)));else if(s&&l&&e.getName()){const t=await ao.getAiSuggestedProperties(r,{spaceId:null==e?void 0:e.getSpaceId(),collectionId:null==e?void 0:e.id,schema:Pt.oA(Object.values(e.getSchema())),collectionName:(0,tc.Xh)(e.getName(),e),numSuggestion:lc});if("success"===t.type){const o=t.data.properties.filter((e=>!i.includes(e.name.toLocaleLowerCase())));u.push(...o),d.createAndCommit({environment:r,perform:t=>{c.FH({stores:[e],update:{ai_suggested_properties:o},transaction:t})},userAction:"propertyType.generateAiSuggestion"})}}const p=u.filter((e=>!i.includes(e.name.toLocaleLowerCase())));a(p)})()}),[t,r,s,o]),s}({collectionContextStore:t,showAiSuggestions:l}),v=(0,r.VK)((()=>(0,Nr.kL)()),[]),C=(0,r.VK)((()=>{if(o||s)return[];if(S){const e=gc({appConfig:S,collectionFormat:h,collectionSchema:y,hasAiEnabled:a});return(v?e.filter((e=>"notion://tasks/task_summary_feature"!==e.uri)):e).map((e=>({type:"typed",appConfigFeature:e})))}if(l)return"loading"===x?"loading":x.map((e=>({type:"ai_suggestion",propertySchema:e})));if(!v){return Sc((0,ri.W3)({environment:p,collectionContextStore:t}),y)}return[]}),[o,s,S,l,v,h,y,a,x,p,t]),b=(0,r.VK)((()=>"loading"===C?"loading":Object.fromEntries(C.map((e=>{switch(e.type){case"ai_suggestion":return[e.propertySchema.name.toLowerCase(),dc({collectionContextStore:t,propertyType:e.propertySchema.type,propertyName:e.propertySchema.name,disablePropertyTooltip:!0,intl:m,onAccept:u,isSuggestedProperty:!0})];case"typed":return[e.appConfigFeature.name.toLowerCase(),cc({appConfig:S,suggestedProperty:e.appConfigFeature,isDisabled:!1,environment:p,collectionContextStore:t,theme:g})];case"derived_ai_property":return[ri.SO[e.propertyType].toLowerCase(),dc({collectionContextStore:t,propertyType:e.propertyType,propertyName:ri.SO[e.propertyType],disablePropertyTooltip:!0,intl:m,iconFill:g.aiPurpleColor,onAccept:u,isSuggestedProperty:!0})]}})))),[S,t,p,m,C,g,u]);return b}({hasAiEnabled:y,showAiSuggestions:x,collectionContextStore:t,propertySchema:o,onAccept:s,disableSuggestions:l}),b=function(e){let{collectionContextStore:t,onAccept:o}=e;const i=(0,n.O7)(),s=(0,f.Fg)(),a=(0,P.useIntl)(),l=(0,r.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),c=(0,r.VK)((()=>(0,Nr.kL)()),[]),d=(0,r.VK)((()=>{if(c){return Sc((0,ri.W3)({environment:i,collectionContextStore:t}),l)}return[]}),[t,l,i,c]),u=(0,r.VK)((()=>Object.fromEntries(d.map((e=>[ri.SO[e.propertyType].toLowerCase(),dc({collectionContextStore:t,propertyType:e.propertyType,propertyName:ri.SO[e.propertyType],disablePropertyTooltip:!0,intl:a,iconFill:s.aiPurpleColor,onAccept:o,isSuggestedProperty:!0})])))),[t,a,o,s.aiPurpleColor,d]);return u}({collectionContextStore:t,onAccept:s}),j=function(e){let{collectionContextStore:t,propertySchema:o,onAccept:i,intl:n}=e;const s=(0,r.VK)((()=>Object.fromEntries((0,ri.TP)(t).map((e=>[ri.SO[e].toLowerCase(),dc({propertyType:e,propertyName:ri.SO[e],collectionContextStore:t,onAccept:i,intl:n,propertySchema:o,isSuggestedProperty:!1})])))),[t,n,i,o]);return s}({propertySchema:o,onAccept:s,intl:g,collectionContextStore:t}),w=function(e){let{collectionContextStore:t,propertySchema:o}=e;const s=(0,n.O7)(),a=(0,P.useIntl)(),l=(0,r.VK)((()=>Xt.Z.bots.state),[]),c=(0,r.VK)((()=>t.collectionStore()),[t]),d=(0,r.VK)((()=>(null==c?void 0:c.getSchema())??{}),[c]),u=(0,r.VK)((()=>!(null==c||!c.isPageTreeCollection())),[c]),p=(0,r.VK)((()=>t.databaseType),[t]),g=(0,r.VK)((()=>{var e;return null===(e=yo.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]),m=(0,r.VK)((()=>{if(void 0===o)return function(e,t){if(!e)return[];const o=_e.default.checkGate({gateName:"google_drive_connected_relation"}),i=_e.default.checkGate({gateName:"figma_connected_relation"}),n=_e.default.checkGate({gateName:"zendesk_connected_relation"}),r=_e.default.checkGate({gateName:"cron_connected_relation"}),s=_e.default.checkGate({gateName:"connected_relation"}),a=e.getDatabaseType()===gi.iS,l=Xt.Z.state;if(!l.loaded)return[];const c=l.integrations,d={};if(!a){const e=c.find((e=>e.id===fi.U9)),t=(0,Zn.GT)();var u;e&&(d[t.name]={name:t.name,pattern:oc.x,integration:e,tooltipImage:{img:S.Z.images.tooltips.properties.githubSyncPullStatusPng,scale:.5},description:t.description,canOnlyAdminAuth:{disabledPropertyTooltipMessage:null===(u=t.canOnlyAdminAuth)||void 0===u?void 0:u.disabledPropertyTooltipMessage}})}const p=[];if(t&&(o&&p.push(fi.f3),i&&p.push(fi.mQ),n&&p.push(fi.Nw)),r&&p.push(fi.Dv),p.forEach((e=>{const t=c.find((t=>t.id===e));if(null!=t&&t.info.original_url_patterns)for(const i of t.info.original_url_patterns){var o;null!==(o=i.additional_types)&&void 0!==o&&o.connectedRelation&&(d[i.name]||(d[i.name]={name:(0,ic.ni)({pattern:i,integration:t}),pattern:i,integration:t}))}})),!s)return Object.values(d);for(const m of c)if(m.info.original_url_patterns&&t&&![...nc,fi.Ff].includes(m.id))for(const e of m.info.original_url_patterns){var g;null!==(g=e.additional_types)&&void 0!==g&&g.connectedRelation&&(d[e.name]||(d[e.name]={name:(0,ic.ni)({pattern:e,integration:m}),pattern:e,integration:m}))}return Object.values(d)}(c,g)}),[c,o,g]),f=(0,r.VK)((()=>Boolean(null==c?void 0:c.isSyncedCollection())),[c]),y=(0,Bn.J)(),h=(0,r.VK)((()=>Ei.Z.state.isOpen),[]),x=(0,i.useMemo)((()=>{if(null!=m&&m.length&&!h)return Object.fromEntries(m.map((e=>{const{isDisabled:o,propertyDisabledTooltip:i}=function(e){let{propertyConfig:t,databaseType:o,bots:i,isSpaceAdmin:n,isMobile:r,isWikiCollection:s,isSyncedCollection:a,schema:l,intl:c}=e;const d="integration"in t?t.integration.id:t.integrationId;if(!d)return{isDisabled:!1};var u;if((0,Ri.gi)({isAuthed:Boolean(i.find((e=>e.integration_id===d))),isSpaceAdmin:n,isPropertyAdminAuthOnly:Boolean(t.canOnlyAdminAuth),isMobile:r}))return{isDisabled:!0,propertyDisabledTooltip:null===(u=t.canOnlyAdminAuth)||void 0===u?void 0:u.disabledPropertyTooltipMessage};if(d===fi.U9){if(mc(l,fi.U9))return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(yc.duplicateGithubPropertyTooltip)};if(s)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(yc.wikiGithubPropertyTooltip)};if(a)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(yc.syncedDatabaseGithubPropertyTooltip)}}else if(d===fi.Dv){if(mc(l,fi.Dv),o!==gi.Fi)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(yc.nonMeetingsCronPropertyTooltip)};if(mc(l,fi.Dv))return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(yc.duplicateCronEventPropertyTooltip)}}return{isDisabled:!1}}({propertyConfig:e,bots:l,isSpaceAdmin:y,environment:s,isWikiCollection:u,databaseType:p,isSyncedCollection:f,schema:d,intl:a,isMobile:s.device.isMobile});return[e.name.toLowerCase(),uc({connectedRelationProperty:e,isDisabled:o,propertyDisabledTooltip:i,environment:s,intl:a,collectionContextStore:t})]})).filter(Ze.$K))}),[m,h,l,y,s,u,p,f,d,a,t]);return x}({collectionContextStore:t,propertySchema:o}),M=a.length>0,_=(0,i.useMemo)((()=>Object.keys(v).splice(0,u?1/0:ac)),[u,v]),k=!u&&Object.keys(v).length>ac,V=(0,i.useMemo)((()=>"loading"===v?[]:Gl().filter(a,_).filter((e=>0===a.length||!j.hasOwnProperty(e.original)&&!(null!=w&&w.hasOwnProperty(e.original)))).flatMap((e=>v[e.original]))),[v,a,_,j,w]),T=(0,i.useMemo)((()=>Gl().filter(a,Object.keys(b)).flatMap((e=>b[e.original]))),[b,a]),I=(0,i.useMemo)((()=>Gl().filter(a,Object.keys(j)).flatMap((e=>j[e.original]))),[a,j]),F=(0,i.useMemo)((()=>w?Gl().filter(a,Object.keys(w)).flatMap((e=>w[e.original])):[]),[w,a]),Z=function(e){let{hasMoreSuggestions:t,filteredSuggestedPropertyItems:o,showAiSuggestions:n,setIsShowingMoreSuggestions:r,hasSearchInput:s,disableSuggestions:a,isLoading:l}=e;const c=(0,f.yK)((e=>({loadingShimmer:{height:10,borderRadius:4,margin:"12px 14px",backgroundColor:e.lightDividerColor},moreSuggestionsButtonContainer:{display:"flex",alignItems:"center",lineHeight:1.2,color:e.mediumTextColor,fontSize:12}})),[]),d=(0,i.useMemo)((()=>({key:"suggested",render:e=>(0,C.jsxs)(U.Z,{...e,title:So.default.formatMessage(yc.suggestedSectionTitle),disableMobileBorders:!0,children:[(0,C.jsx)(Jl.Z,{style:{width:"80%",...c.loadingShimmer}}),(0,C.jsx)(Jl.Z,{style:{width:"50%",...c.loadingShimmer}}),(0,C.jsx)(Jl.Z,{style:{width:"60%",...c.loadingShimmer}}),(0,C.jsx)(Jl.Z,{style:{width:"50%",...c.loadingShimmer}})]}),items:[]})),[c.loadingShimmer]),u=(0,i.useMemo)((()=>({key:"more-suggestions",render:e=>(0,C.jsx)(U.Z,{disableDesktopPadding:!0,disableMobilePadding:!0,children:(0,C.jsx)(L.Z,{...e,title:(0,C.jsxs)("div",{style:c.moreSuggestionsButtonContainer,children:[(0,C.jsx)(P.FormattedMessage,{id:"database.collectionsettings.propertySuggestions.more",defaultMessage:"More"}),(0,ps.i)({fill:no.ZP.uiGray,width:12,height:12,marginLeft:4})]})})}),action:e=>{r(!0),e.event&&"stopPropagation"in e.event&&e.event.stopPropagation()}})),[r,c.moreSuggestionsButtonContainer]),p=(0,i.useMemo)((()=>a?{key:"suggested",render:()=>(0,C.jsx)(C.Fragment,{}),items:[]}:o.length?{key:"suggested",render:e=>(0,C.jsx)(U.Z,{...e,title:So.default.formatMessage(yc.suggestedSectionTitle)}),items:t&&!s?[...o,u]:o}:l&&n&&!s?d:{key:"suggested",render:()=>(0,C.jsx)(C.Fragment,{}),items:[]}),[a,o,s,u,l,n,d,t]);return p}({hasMoreSuggestions:k,filteredSuggestedPropertyItems:V,hasSearchInput:M,showAiSuggestions:x,setIsShowingMoreSuggestions:p,disableSuggestions:Boolean(l||o),isLoading:"loading"===v}),A=function(e){let{filteredAiDerivedPropertyItems:t}=e;return(0,i.useMemo)((()=>t.length?{key:"autofill",render:e=>(0,C.jsx)(U.Z,{...e,title:So.default.formatMessage(yc.autofillSectionTitle)}),items:t}:{key:"autofill",render:()=>(0,C.jsx)(C.Fragment,{}),items:[]}),[t])}({filteredAiDerivedPropertyItems:T}),B=function(e){let{filteredStandardPropertyItems:t}=e;return(0,i.useMemo)((()=>t.length?{key:"standard",render:e=>(0,C.jsx)(U.Z,{...e,title:So.default.formatMessage(yc.typesSectionTitle)}),items:t}:{key:"standard",render:()=>(0,C.jsx)(C.Fragment,{}),items:[]}),[t])}({filteredStandardPropertyItems:I}),K=function(e){let{filteredConnectedPropertyItems:t}=e;const o=(0,i.useMemo)((()=>t.length?{key:"connected",render:e=>(0,C.jsx)(U.Z,{...e,title:So.default.formatMessage(yc.connectedRelationSectionTitle)}),items:t}:{key:"connected",render:()=>(0,C.jsx)(C.Fragment,{}),items:[]}),[t]);return o}({filteredConnectedPropertyItems:F}),O=(0,i.useMemo)((()=>o||!a.length||b.hasOwnProperty(a.toLowerCase())||null!=_&&_.includes(a.toLowerCase())||null!=j&&j.hasOwnProperty(a.toLowerCase())||null!=w&&w.hasOwnProperty(a.toLowerCase())?{key:"custom",render:()=>(0,C.jsx)(C.Fragment,{}),items:[]}:{key:"custom",render:e=>(0,C.jsx)(U.Z,{...e,title:So.default.formatMessage(yc.selectToAddNewProperty)}),items:[dc({collectionContextStore:t,onAccept:s,propertyType:"text",propertyName:a,disablePropertyTooltip:!0,intl:g,isSuggestedProperty:!1})]}),[o,a,b,_,j,w,t,s,g]),R=(0,i.useMemo)((()=>[Z,A,B,K,O]),[Z,A,B,K,O]);return R}({collectionContextStore:t,propertySchema:s,onAccept:o,disableSuggestions:a,searchInput:u}),m=(0,r.VK)((()=>{const e=null==t?void 0:t.collectionStore();if(e)return(0,tc.Xh)(e.getName(),e)}),[t]),y=(0,r.VK)((()=>t.permissionScopesStore.state),[t]);return null!=y&&y.isExternallyImportedAndSyncedCollection?null:(0,C.jsxs)(A.ZP,{...e,title:s?So.default.formatMessage(yc.changePropertyType):l.isDesktop&&m?So.default.formatMessage(yc.newPropertyWithDatabaseName,{databaseName:m}):So.default.formatMessage(yc.newProperty),children:[(0,C.jsx)(U.Z,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,C.jsx)(po.ZP,{focusInitial:!l.isMobile||void 0,focus:!l.isMobile||void 0,value:u,onChange:e=>{p(e.target.value)},placeholder:So.default.formatMessage(s?yc.searchToChangePlaceholder:yc.searchPlaceholder)})}),(0,C.jsx)(N.Z,{disableInitialScroll:!0,type:N.i.Vertical,initialFocus:0,sections:g,resetInitialFocusOnSectionChange:!0})]})}const ac=4,lc=10;function cc(e){let{appConfig:t,suggestedProperty:o,isDisabled:i,propertyDisabledTooltip:n,environment:r,collectionContextStore:s,theme:a}=e;const c=s.collectionStore(),d=Ql.aQ.derivePropertyUris((null==c?void 0:c.getSchema())??{},null==c?void 0:c.getPropertyMapping()),u=(e,t,o,n)=>{const r=o.dependencies.find((e=>{var t;return"property"===e.type&&e.collectionUri===(null==c||null===(t=c.getFormat())||void 0===t?void 0:t.app_config_uri)&&(0,$l.Pf)(e.uri)&&!d.has(e.uri)})),s=o.dependencies.find((e=>"property"===e.type&&(0,Lo.qQ)(e.propertySchema)&&(0,Lo.q3)(e.propertySchema)));if(r)return(0,C.jsx)(L.Z,{...e,disabled:i,disabledFeedback:i,title:(0,C.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[t,s?(0,C.jsx)(Xl.Z,{}):null,o.isNew?"notion://projects/tasks_with_sprints_feature"===o.uri&&(0,C.jsx)(Yl.Z,{}):null]}),icon:(0,C.jsx)(Ro.ZP,{type:r.propertySchema.type,theme:a,icon:n,size:16,style:{fill:a.regularIconColor}})})},p=new We.Z;return{key:o.name,render:e=>{var i,a;return(0,C.jsx)(mt.Z,{showImage:!n,caption:n??o.description,tooltipImage:n||null===(i=o.tooltipImage)||void 0===i?void 0:i.img,tooltipImageScale:null===(a=o.tooltipImage)||void 0===a?void 0:a.scale,render:i=>{if((0,Ar.BQ)(o))return u({...(0,qt.Z)(e,i)},o.name,o,o.icon);{const n=Pt.oA(o.variants.map((e=>{const o=null==t?void 0:t.allFeatures.find((t=>t.uri===e));if(o&&(0,Ar.BQ)(o))return o})));return(0,C.jsx)(ec.Z,{buttonPopupStore:p,items:n,getKey:e=>e.name,onSelect:async e=>{await Fr.G0({environment:r,feature:e,collectionContextStore:s,from:"new_property"}),l.E3({collectionSettingsStore:s.settingsStore})},selectedItem:void 0,renderOrigin:t=>u({focused:Boolean(e.focused),...(0,qt.Z)(Pt.CE(e,"onClick","focused"),(0,qt.Z)(i,t))},o.name,n[0],o.icon),renderItem:e=>(0,C.jsx)(L.Z,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0})})}}})},action:async()=>{(0,Ar.BQ)(o)?(await Fr.G0({environment:r,feature:o,collectionContextStore:s,from:"new_property"}),l.E3({collectionSettingsStore:s.settingsStore})):p.setState({open:!0})}}}function dc(e){let{collectionContextStore:t,propertySchema:o,propertyName:i,propertyType:n,disablePropertyTooltip:r,intl:s,onAccept:a,iconFill:l,isSuggestedProperty:c}=e;const d={key:i,render:e=>{const a=o&&(null==o?void 0:o.type)===n,c=function(e,t,o){if("auto_increment_id"===t){var i;if(null!=o&&o.type)return So.default.formatMessage(rc.zU.convert_to_auto_increment_id_property);const t=e.collectionStore();if(null==t?void 0:t.isPageTreeCollection())return So.default.formatMessage(rc.zU.wiki_forbidden_auto_increment_id_property);if(Boolean(null==t?void 0:t.isSyncedCollection()))return So.default.formatMessage(rc.zU.synced_database_forbidden_auto_increment_id_property);const n=t&&t.id,r=t&&t.getFormat(),s=t&&(null===(i=t.getSpaceStore())||void 0===i?void 0:i.id),a=t&&t.getSchema(),l=t&&t.getDeletedSchema();if(!(n&&r&&s&&a&&l))return;if(t&&(0,ql.cj)({id:n,format:r,space_id:s,schema:a,deleted_schema:l}))return So.default.formatMessage(rc.zU.duplicate_auto_increment_id_property)}}(t,n,o),d=void 0!==c,u=!r&&hc.hasOwnProperty(n)&&"on"===_e.default.getEligibleGroup({experimentId:"property_creation_tooltips_exp",defaultGroup:"control"})?s.formatMessage(hc[n]):void 0;return(0,C.jsx)(pc,{checkState:a,buttonMenuItemProps:e,propertyName:i,propertyType:n,isDisabled:d,tooltip:c??u,badge:"button"===n&&(0,C.jsx)(Rr.Z,{}),iconFill:l})},action:()=>{a(n,c,i)}};return d}function uc(e){let{connectedRelationProperty:t,isDisabled:o,propertyDisabledTooltip:i,environment:n,collectionContextStore:r,intl:s}=e;return{key:t.name,render:e=>(0,C.jsx)(pc,{buttonMenuItemProps:e,propertyName:t.name,propertyType:"relation",isDisabled:o,tooltip:i,icon:t.integration.info.icon}),action:async()=>{await Fr.Jw({environment:n,connectedRelationProperty:t,collectionContextStore:r,intl:s,from:"new_property"})}}}const pc=i.memo((function(e){let{buttonMenuItemProps:t,checkState:o,propertyName:n,propertyType:r,isDisabled:s,badge:a,tooltip:l,tooltipImage:c,tooltipImageScale:d,icon:u,iconFill:p}=e;const g=(0,f.Fg)(),m=(0,i.useCallback)((e=>(0,C.jsx)(L.Z,{...e?(0,qt.Z)(t,e):t,disabled:s,disabledFeedback:s,title:(0,C.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[n,a]}),checkState:o,icon:(0,C.jsx)(Ro.ZP,{type:r,theme:g,icon:u,size:16,style:{fill:p??g.regularIconColor}})})),[t,s,n,a,o,r,g,u,p]);return l?(0,C.jsx)(mt.Z,{showImage:!s,caption:l,tooltipImage:s?void 0:c,tooltipImageScale:d,render:e=>m(e)}):m(void 0)}));function gc(e){let{appConfig:t,collectionFormat:o,collectionSchema:i,hasAiEnabled:n}=e;if(!o||!i)return[];const r=e=>{const t=o.app_config_uri,r=Ql.aQ.derivePropertyUris(i??{},o.app_uri_map);if(e.collectionUri!==t)return!1;let s=!0;e.uri===(0,Zn.GT)().uri&&r.has(gi.Es.GithubPrsRelation)&&(s=!1);return e.dependencies.some((e=>"property"===e.type&&e.collectionUri===t&&(0,$l.Pf)(e.uri)&&!r.has(e.uri)))&&(!e.isAi||n)&&s},s={};t.allFeatures.forEach((e=>{(0,Ar.Dl)(e)&&e.variants.every((e=>Boolean(t.allFeatures.find((t=>t.uri===e&&(0,Ar.BQ)(t)&&r(t))))))&&(s[e.uri]=e.variants)}));const a=Object.values(s).flat();return t.allFeatures.filter((e=>(0,Ar.BQ)(e)&&!a.find((t=>t===e.uri))?r(e):!!(0,Ar.Dl)(e)&&Boolean(s[e.uri]))).sort(((e,t)=>(0,Ar.Dl)(e)?-1:(0,Ar.Dl)(t)?1:e.dependencies.length-t.dependencies.length))}function mc(e,t){for(const i in e){var o;const n=e[i];if(n&&"connectedRelation"in n&&(null===(o=n.connectedRelation)||void 0===o?void 0:o.integration_id)===t)return!0}return!1}const fc=["ai_summary"];function Sc(e,t){const o=t?function(e){const t=new Set;for(const i in e){const n=e[i];if(n&&"ai_inference"in n){var o;const e=null===(o=n.ai_inference)||void 0===o?void 0:o.type;if(e)switch(e){case"custom":t.add("ai_custom_prompt");break;case"summarize":t.add("ai_summary");break;case"extract":t.add("ai_extract");break;case"translate":t.add("ai_translate")}}else n&&"select_ai_inference"in n&&t.add("ai_keywords")}return t}(t):new Set;return e.map((e=>({type:"derived_ai_property",propertyType:e}))).filter((e=>!fc.includes(e.propertyType)||!o.has(e.propertyType)))}const yc=(0,P.defineMessages)({searchPlaceholder:{defaultMessage:"Search or add new property",id:"database.viewSettings.propertyTypeSelect.searchPlaceholder"},searchToChangePlaceholder:{defaultMessage:"Search for property type",id:"database.viewSettings.propertyTypeSelect.searchToChangePlaceholder"},suggestedSectionTitle:{defaultMessage:"Suggested",id:"database.viewSettings.propertyTypeSection.suggested"},connectedRelationSectionTitle:{defaultMessage:"Connections",id:"database.viewSettings.propertyTypeSection.connected"},typesSectionTitle:{defaultMessage:"Type",id:"database.viewSettings.propertyTab.propertyType"},autofillSectionTitle:{defaultMessage:"AI Autofill",id:"database.viewSettings.propertyTab.autofillProperties"},newProperty:{defaultMessage:"New property",id:"database.viewSettings.newProperty"},newPropertyWithDatabaseName:{defaultMessage:"New property on {databaseName}",id:"database.viewSettings.newPropertyOnDatabase"},changePropertyType:{defaultMessage:"Change property type",id:"database.viewSettings.changePropertyType"},selectToAddNewProperty:{defaultMessage:"Select to add",id:"database.viewSettings.selectToAdd"},newPill:{defaultMessage:"New",id:"database.viewSettings.newHighlightedFeature"},duplicateGithubPropertyTooltip:{defaultMessage:"A database can only have one GitHub Pull Requests property",id:"database.viewSettings.propertyTab.duplicateGithubProperty.tooltip"},wikiGithubPropertyTooltip:{defaultMessage:"A wiki cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.wikiGithubProperty.tooltip"},syncedDatabaseGithubPropertyTooltip:{defaultMessage:"A synced database cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.syncedDatabaseGithubProperty.tooltip"},nonMeetingsCronPropertyTooltip:{defaultMessage:"The Cron Calendar property can only be added to a Meetings database",id:"database.viewSettings.propertyTab.nonMeetingsCronProperty.tooltip"},duplicateCronEventPropertyTooltip:{defaultMessage:"A database can only have one Cron Calendar event property",id:"database.viewSettings.propertyTab.duplicateCronEventProperty.tooltip"}}),hc=(0,P.defineMessages)({text:{defaultMessage:"Add text that can be formatted. Great for summaries, notes, or descriptions.",id:"database.viewSettings.propertyTab.textProperty.tooltip"},number:{defaultMessage:"Accepts numbers. These can also be formatted as currency or progress bars. Useful for tracking counts, prices, and completion.",id:"database.viewSettings.propertyTab.numberProperty.tooltip"},select:{defaultMessage:"Select one option from a list of tags. Useful for categorization.",id:"database.viewSettings.propertyTab.selectProperty.tooltip"},multi_select:{defaultMessage:"Select one or more options from a list of tags. Useful for tagging items across multiple categories.",id:"database.viewSettings.propertyTab.multiSelectProperty.tooltip"},date:{defaultMessage:"Accepts a date or a date range (time optional). Useful for deadlines, especially with calendar and timeline views.",id:"database.viewSettings.propertyTab.dateProperty.tooltip"},formula:{defaultMessage:"Perform calculations based on other properties using Notion’s formula language.",id:"database.viewSettings.propertyTab.formulaProperty.tooltip"},relation:{defaultMessage:"Connect databases and mention database pages. Useful for connecting items across your workspace.",id:"database.viewSettings.propertyTab.relationProperty.tooltip"},rollup:{defaultMessage:"View and aggregate information about properties from relation properties. Useful for summarizing interconnected data.",id:"database.viewSettings.propertyTab.rollupProperty.tooltip"},person:{defaultMessage:"Tag anyone in your Notion workspace. Useful for assigning tasks or referencing relevant team members.",id:"database.viewSettings.propertyTab.personProperty.tooltip"},file:{defaultMessage:"Upload files and images for easy retrieval. Useful for storing documents and photos.",id:"database.viewSettings.propertyTab.filesProperty.tooltip"},checkbox:{defaultMessage:"Use a checkbox to indicate whether a condition is true or false. Useful for lightweight task tracking.",id:"database.viewSettings.propertyTab.checkboxProperty.tooltip"},url:{defaultMessage:"Accepts a link to a website and opens the link in a new tab when clicked.",id:"database.viewSettings.propertyTab.urlProperty.tooltip"},email:{defaultMessage:"Accepts an email address and launches your mail client when clicked.",id:"database.viewSettings.propertyTab.emailProperty.tooltip"},phone_number:{defaultMessage:"Accepts a phone number and prompts your device to call it when clicked.",id:"database.viewSettings.propertyTab.phoneNumberProperty.tooltip"},created_time:{defaultMessage:"Records the timestamp of an item's creation. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdTimeProperty.tooltip"},created_by:{defaultMessage:"Automatically records the person who created the item. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdByProperty.tooltip"},last_edited_time:{defaultMessage:"Records the timestamp of an item's last edit. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedTimeProperty.tooltip"},last_edited_by:{defaultMessage:"Records the person who edited the item last. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedByProperty.tooltip"},auto_increment_id:{defaultMessage:"Automatically creates a numerical ID for each item. IDs are unique and cannot be manually changed.",id:"database.viewSettings.propertyTab.uniqueIdProperty.tooltip"},status:{defaultMessage:"Track this item’s progress using status tags categorized by To-do, In progress, and Complete.",id:"database.viewSettings.propertyTab.statusProperty.tooltip"},verification:{defaultMessage:"Indicate whether a page has been verified by the page owner, with the option to set an expiration date.",id:"database.viewSettings.propertyTab.verificationProperty.tooltip"},button:{defaultMessage:"Trigger actions based on the item properties.",id:"database.viewSettings.propertyTab.buttonProperty.tooltip"},ai_summary:{defaultMessage:"Text property with AI summary set up for you. Generates a summary based on page content and properties.",id:"database.viewSettings.propertyTab.aiSummaryProperty.tooltip"},ai_translate:{defaultMessage:"Text property with AI translate set up for you. Translate a property to another language using AI. ",id:"database.viewSettings.propertyTab.aiTranslateProperty.tooltip"},ai_category:{defaultMessage:"Select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCategoryProperty.tooltip"},ai_keywords:{defaultMessage:"Multi-select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiKeywordsProperty.tooltip"},ai_custom_prompt:{defaultMessage:"Text property with a custom AI prompt. Generate content based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCustomPromptProperty.tooltip"},ai_extract:{defaultMessage:"Text property with a custom AI prompt. Extract key info based on the page content and properties.",id:"database.viewSettings.propertyTab.aiExtractProperty.tooltip"},title:{defaultMessage:"Add a title for your database item. This determines the page's title.",id:"database.viewSettings.propertyTab.titleProperty.tooltip"},location:{defaultMessage:"Display the location of which database this item belongs to.",id:"database.viewSettings.propertyTab.locationProperty.tooltip"},last_visited_time:{defaultMessage:"Records the timestamp of the last time you visited this page. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastVisitedTimeProperty.tooltip"}});var xc=o(332628);function vc(e){const{collectionContextStore:t,collectionSettingsStore:o,property:s,formatKey:a}=e,c=(0,n.O7)(),d=(0,i.useMemo)((()=>wr.default.createValue("")),[]),u=(0,i.useMemo)((()=>Fa.Il()),[]),p=(0,r.VK)((()=>t.collectionViewBlockStore()),[t]);return p?(0,C.jsx)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Related to",id:"database.viewSettings.selectNewRelationSourceTab.title"}),handleClose:()=>{ut.tW({environment:c,eventName:"abandoned_search",queryLength:d.state.length,sessionId:u,source:Wo.S7.Relation}),l.E3({collectionSettingsStore:o})},children:(0,C.jsx)(xc.ZP,{collectionContextStore:t,onAccept:e=>function(e,t,o,i,n,r){const s=o.collectionStore();if(!s)return;ut.wd({environment:t,collectionContextStore:o,action:"select_relation_source"});const{stack:a}=i.state,c=a[a.length-2];c&&"setupRelation"===c.type&&l.z$({collectionSettingsStore:i});l.FK({collectionSettingsStore:i,item:{type:"setupRelation",property:n,formatKey:r,targetCollectionPointer:e.pointer}})}(e,c,t,o,s,a),parentStore:p,context:Wo.S7.Relation,searchSessionId:u,inputStore:d})}):null}var Cc=o(429657);function bc(e){const{collectionContextStore:t,collectionSettingsStore:o,property:s,formatKey:a,targetCollectionPointer:u,from:p}=e,g=(0,r.VK)((()=>t.collectionStore()),[t]),m=(0,r.VK)((()=>{const e=t.collectionViewBlockStore();return function(e){const{targetCollectionPointer:t,collectionStore:o,collectionViewBlockStore:i}=e;if(!t)return;if(o&&o.pointer===t)return o;return i?Go.NW.createChildStore(i,t):void 0}({targetCollectionPointer:u,collectionStore:g,collectionViewBlockStore:e})}),[t,g,u]),f=(0,r.VK)((()=>s?Ue.KV(t,s):void 0),[t,s]),S=Boolean(g&&m&&g.id===m.id),y=Boolean("relation"===(null==f?void 0:f.type)&&f.connectedRelation),h=Boolean("subitem"===p),x=Boolean("timeline_arrows_by"===p),v=(0,r.VK)((()=>t.contextType),[t]),b=(0,n.O7)(),j=(0,P.useIntl)(),w=(0,r.VK)((()=>{const e=null==g?void 0:g.getSchema();return void 0===(null==f?void 0:f.name)&&m&&e?Ue.m8(j,{targetCollectionStore:m,isSelfRelation:S,sourceSchema:e,createUnique:!0,from:p}):(null==f?void 0:f.name)||""}),[g,null==f?void 0:f.name,m,j,S,p]),[M,_]=(0,i.useState)(w),[k,V]=(0,i.useState)("no_limit"),[T,I]=(0,i.useState)(h||x?{hasInverseRelation:!0,inverseName:void 0,autoRelate:{enabled:!1}}:{hasInverseRelation:!1,inverseName:void 0,autoRelate:{enabled:!1}}),F=M===w,Z=(0,i.useCallback)((()=>{l.H4({collectionSettingsStore:o,item:{type:"selectRelationSource",property:s,formatKey:a}})}),[o,s,a]),B=(0,i.useCallback)((()=>{if(!T)return;const{hasInverseRelation:e,inverseName:i,autoRelate:n}=T,r=t.collectionStore(),u=t.collectionViewStore();if(!r||!m)return;const{performResult:g}=d.createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:b,perform:o=>{const l=s??Ae.G3({environment:b,collectionStore:r,collectionViewArgs:u&&a?{collectionViewStore:u,format:u.getFormat(),formatKey:a}:void 0,propertyType:"relation",transaction:o});if(Di.n7({environment:b,collectionContextStore:t,collectionStore:r,property:l,propertyName:M,targetCollectionStore:m,hasInverseRelation:e,inverseName:i,autoRelate:n,propertyLimit:k,intl:j,transaction:o,from:p}),u){var d;const e=(null===(d=u.getFormat().table_properties)||void 0===d?void 0:d.find((e=>e.property===l)))??{property:l,visible:!0};c.FH({stores:[u],update:{table_properties:[...u.getFormat().table_properties??[],e]},transaction:o})}return"subitem"===p&&u?Be.km({environment:b,collectionContextStore:t,relationPropertyId:l,transaction:o}):"timeline_arrows_by"===p&&u&&(Cc.tF({collectionViewStore:u,newProperty:l,transaction:o}),Cc._p({collectionContextStore:t,relationPropertyId:l,transaction:o})),l}});"subitem"===p||"timeline_arrows_by"===p?(l.z$({collectionSettingsStore:o}),l.H4({collectionSettingsStore:o,item:{type:"main"}})):l.qU({collectionSettingsStore:o,property:g,formatKey:a}),ut._H({environment:b,collectionContextStore:t,from:"collectionPage"===v?"page_properties":"view_settings",property_type:"relation"})}),[T,t,m,b,o,s,a,v,M,k,j,p]);return(0,C.jsxs)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"New relation",id:"database.viewSettings.setupRelationTab.title"}),children:[(0,C.jsx)(U.Z,{children:(0,C.jsx)(po.ZP,{value:M||"",placeholder:"Property name",onChange:e=>_(e.target.value),onBlur:()=>{},onSubmit:()=>{},focusInitial:!0,selectAll:!1})}),(0,C.jsx)(ln,{isSelfRelation:S,collectionStore:m,showAs:"chevron",onClick:Z,disabled:h}),!p&&(0,C.jsx)(nn,{selectedKey:k,propertyType:"relation",onChange:e=>V(e)}),m&&!y&&(0,C.jsx)(Yi,{collectionContextStore:t,targetCollectionStore:m,property:s,propertyName:M,buttonContents:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Add relation",id:"database.viewSettings.setupRelationTab.addButton.title"}),temporaryInverseState:T,setTemporaryInverseState:I,isInitialPropertyName:F,onSubmit:B,from:p}),(0,C.jsx)(U.Z,{children:(0,C.jsx)(ls.Z,{href:(0,jn.UY)("guides.relations"),title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Learn about relations",id:"database.viewSettings.propertyTab.relations.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"})})]})}var jc=o(619584),wc=o(476464),Mc=o(346978),_c=o(367669),kc=o(88893);function Vc(e){let{collectionSettingsStore:t,collectionContextStore:o,integrationName:s,integrationIcon:c,fullHeight:u}=e;const p=(0,n.O7)(),g=(0,f.yK)((e=>({promptTitle:Pc(e)})),[]),[m,S]=(0,i.useState)(!1),y=(0,r.VK)((()=>o.collectionViewBlockStore()),[o]),{numberOfGuests:h,numberOfUsers:x,isPublic:v}=(0,r.VK)((()=>{const e=Gr.subscriptionDataStoreInstance.state?kc.CM(Gr.subscriptionDataStoreInstance.state):[],t=(0,jc.m8)(Pt.oA(e.map((e=>[e.userId,e.role]))));if(!y)return{numberOfGuests:void 0,numberOfUsers:void 0,isPublic:void 0};const o=(0,_c.YO)(y).map((e=>e.permissionItem));let i=!1,n=!1;for(const l of o)zi.$D(l)?i=!0:zi.Ir(l)&&!zi.Wi(l.role)&&(n=!0);const r=Pt.jj(Pt.oA([...o.map((e=>"user_permission"===e.type?e.user_id:void 0)),...n?Object.keys(t):[]])),s=r.filter((e=>"none"!==t[e])).length,a=r.filter((e=>{const i=t[e],n=Boolean(o.filter(zi.jg).find((t=>t.user_id===e)));return Boolean(i&&n&&!zi.YX(i))})).length;return{numberOfGuests:a,numberOfUsers:s+a,isPublic:i}}),[y]);(0,i.useEffect)((()=>{v||1!==x||l.E3({collectionSettingsStore:t})}),[t,v,x]);const b=(0,i.useCallback)((()=>{y&&(m&&function(e){const{environment:t,store:o}=e,i=t.currentUser.id;if(!i)return;d.createAndCommit({userAction:"CollectionSettingsSyncedContentShare.restrictAccessToSyncedContent",environment:t,perform:e=>{wc.Pk({environment:t,store:o,shouldInherit:!1,transaction:e,permissionItem:{type:"user_permission",user_id:i,role:"editor"}})}})}({environment:p,store:y}),a.KI(p,{type:m?"restrict":"share"}),l.E3({collectionSettingsStore:t}))}),[t,y,p,m]);if(!y)return null;const j=(0,C.jsx)("div",{style:g.promptTitle,children:(0,C.jsx)(P.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.header",defaultMessage:"Share synced content with"})}),w=(0,C.jsxs)(C.Fragment,{children:[0!==h?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(P.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithGuests",defaultMessage:"{numberOfUsers} people (including you {numberOfGuests, plural, one {and {numberOfGuests} guest} other {and {numberOfGuests} guests}})",values:{numberOfUsers:x,numberOfGuests:h}})," "]}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(P.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithoutGuests",defaultMessage:"{numberOfUsers} people (including you)",values:{numberOfUsers:x}})," "]}),v&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(P.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.sharedWithPublic",defaultMessage:"and those with the link"})," "]}),(0,C.jsx)(P.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.accessToIntegration",defaultMessage:"will get access to content synced from {integrationName}",values:{integrationName:s}})]}),M=(0,C.jsx)(al.gq,{style:{marginTop:10},children:(0,C.jsx)(H.Z,{style:{flex:"0 0 100%"},isLarge:!0,onClick:b,children:(0,C.jsx)(P.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.continueButton",defaultMessage:"Continue"})})}),_=(0,C.jsx)(al.gq,{style:{paddingBottom:24},alignItems:"center",justifyContent:"center",children:(0,C.jsx)("img",{style:{width:40},src:c})}),k=(0,C.jsx)(N.Z,{type:N.i.Vertical,initialFocus:void 0,sections:[{key:"grant_permissions",items:[{key:"allow",action:()=>null,render:e=>(0,C.jsx)(L.Z,{...e,textWrapperStyle:{textAlign:"left"},title:(0,C.jsx)(P.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.title",defaultMessage:"Anyone on this page"}),shouldWrapCaption:!0,caption:w,icon:(0,C.jsx)(Mc.Z,{isSelected:!m}),onClick:()=>{S(!1)}})},{key:"restrict",action:()=>null,render:e=>(0,C.jsx)(L.Z,{...e,textWrapperStyle:{textAlign:"left"},title:(0,C.jsx)(P.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.restrict.title",defaultMessage:"Only you"}),shouldWrapCaption:!0,caption:(0,C.jsx)(P.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.restrict.caption",defaultMessage:"You'll need to share with others using the share menu"}),icon:(0,C.jsx)(Mc.Z,{isSelected:m}),onClick:()=>{S(!0)}})}],render:e=>(0,C.jsx)(U.Z,{...e})}]});return(0,C.jsx)(A.ZP,{collectionSettingsStore:t,fullHeight:u,children:(0,C.jsxs)(al.gq,{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0px 16px 16px 16px"},flexDirection:"column",children:[_,(0,C.jsxs)("div",{children:[j,k]}),M]})})}const Tc=i.memo(Vc,No.Z);function Pc(e){return{color:e.regularTextColor,fontWeight:I.Z.fontWeight.semibold,fontSize:14}}var Ic=o(576205),Fc=o(821197),Zc=o(234993),Ac=o(657410);const Bc=(0,P.defineMessages)({inputPlaceholder:{defaultMessage:"Filter by…",id:"database.viewSettings.createFilterTab.inputPlaceholder"}});function Kc(e){var t;const{context:o,collectionSettingsStore:s,collectionContextStore:a}=e,c=(0,n.O7)(),d=(0,r.VK)((()=>a.normalizedSchemaStore.state),[a]),u=(0,r.VK)((()=>a.normalizedFormatStore.state),[a]),p=(0,r.VK)((()=>a.permissionScopesStore.state),[a]),g=(0,r.VK)((()=>function(e){return e.currentCombinatorFilterStore.state}(a)),[a]),m=(0,r.VK)((()=>{const e=a.collectionViewStore();return e?(0,Ne.qd)({schema:d,filters:Dc(a),getRecordModel:e.getRecordModel}):[]}),[a,d]),f=(0,i.useCallback)((e=>{if(!e)return;const t=a.collectionViewStore(),i=m.find((t=>t.property===e));if(!i||!t)return;const n={id:Fa.Il(),filter:i};Zc.iU({environment:c,collectionContextStore:a,temporaryState:{...a.temporaryStateStore.state,propertyFilters:{value:[...Dc(a),n]}}}),function(e,t,o,i,n){if(ut.wd({environment:n,collectionContextStore:t,action:"create_property_filter"}),o===Wo.HV.FilterBar||o===Wo.HV.TopbarFilterPopup){Lc(t,i);const o=t.getFilterBarItemSettingsStore(e);l.wl({collectionSettingsStore:o,item:{type:"filter"}})}else if(o===Wo.HV.ViewSettings){Rc(i);const o=t.getFilterOptionsItemSettingsStore(e);l.wl({collectionSettingsStore:o,item:{type:"filter"}})}}(n,a,o,s,c)}),[a,s,o,c,m]),S=(0,i.useCallback)((()=>{a.collectionViewStore()&&(g||Zc.iU({environment:c,collectionContextStore:a,temporaryState:{...a.temporaryStateStore.state,combinatorFilter:{value:Ic.TI}}}),zc(a,o,s,c))}),[a,s,g,o,c]);return(0,C.jsx)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Add filter",id:"database.viewSettings.createFilterTab.title"}),footer:p.canConfigureBlock&&(0,C.jsx)(U.Z,{topBorder:!0,children:(0,C.jsx)(B.Z,{icon:g?Fc.Q:Wt.R,isGray:!0,title:g?(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Advanced filter",id:"database.viewSettings.createFilterTab.advancedFilter.title"}):(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Add advanced filter",id:"database.viewSettings.createFilterTab.addAdvancedFilter.title"}),right:g&&(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{ruleCount, plural, one {{ruleCount} rule} other {{ruleCount} rules}}",id:"database.viewSettings.createFilterTab.advancedFilterRulesCount.title",values:{ruleCount:(null===(t=g.filters)||void 0===t?void 0:t.length)||1}}),onClick:S})}),children:(0,C.jsx)(Ac.Z,{schema:d,format:u,getProperties:()=>m.map((e=>e.property)),onAccept:f,inputPlaceholder:So.default.formatMessage(Bc.inputPlaceholder)})})}const Oc=i.memo(Kc,No.Z);function Lc(e,t){e.filtersBarOpenStore.setState(!0),l.z$({collectionSettingsStore:t})}function Rc(e){l.wl({collectionSettingsStore:e,item:{type:"main"}}),l.H4({collectionSettingsStore:e,item:{type:"filters"}})}function Dc(e){return e.currentPropertyFiltersStore.state}function zc(e,t,o,i){ut.wd({environment:i,collectionContextStore:e,action:"create_combinator_filter"}),t===Wo.HV.FilterBar||t===Wo.HV.TopbarFilterPopup?(Lc(e,o),l.wl({collectionSettingsStore:e.filterBarCombinatorFilterSettingsStore,item:{type:"filter"}})):t===Wo.HV.ViewSettings&&(Rc(o),l.wl({collectionSettingsStore:e.filterOptionsCombinatorFilterSettingsStore,item:{type:"filter"}}))}const Nc=(0,P.defineMessages)({inputPlaceholder:{defaultMessage:"Sort by…",id:"database.viewSettings.createSortTab.inputPlaceholder"}});const Ec=function(e){const{context:t,collectionContextStore:o,collectionSettingsStore:i}=e,s=(0,n.O7)(),a=(0,P.useIntl)(),c=(0,r.VK)((()=>o.normalizedSchemaStore.state),[o]),d=(0,r.VK)((()=>o.normalizedFormatStore.state),[o]),u=(0,r.VK)((()=>Hc(o)),[o]);return(0,C.jsx)(A.ZP,{...e,collectionSettingsStore:i,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"New sort",id:"database.viewSettings.createSortTab.title"}),children:(0,C.jsx)(Ac.Z,{schema:c,format:d,getProperties:()=>Object.entries(c).filter((e=>{let[t,o]=e;return!u.find((e=>e.property===t))&&(0,Ri.bA)(o)})).map((e=>{let[t]=e;return t})),onAccept:e=>function(e,t,o,i,n){var r;if(!e)return;const s=o.collectionViewStore(),a=o.normalizedSchemaStore.state;if(!s||!a)return;const c=null===(r=a[e])||void 0===r?void 0:r.type;ut.wd({environment:t,collectionContextStore:o,action:"create_sort_accept",original_view_type:s.getType(),property_type:c});const d={property:e,direction:"ascending"},u=[...Hc(o),d];if(Zc.iU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryStateStore.state,sorts:{value:u}}}),i===Wo.HV.TopbarSortPopup||i===Wo.HV.FilterBar){o.filtersBarOpenStore.setState(!0),l.z$({collectionSettingsStore:n});const{filterBarSortSettingsStore:e}=o;l.wl({collectionSettingsStore:e,item:{type:"sort"}})}else i===Wo.HV.ViewSettings&&(l.wl({collectionSettingsStore:n,item:{type:"main"}}),l.H4({collectionSettingsStore:n,item:{type:"sort"}}))}(e,s,o,t,i),inputPlaceholder:a.formatMessage(Nc.inputPlaceholder)})})};function Hc(e){return e.currentSortsStore.state}var Uc=o(806758),Wc=o(708982),Gc=o(318245);const $c=function(e){const{collectionContextStore:t,context:o,collectionSettingsStore:i}=e,s=(0,n.O7)(),a=(0,r.VK)((()=>t.collectionViewStore()),[t]),c=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t]),d=(0,r.VK)((()=>function(e){return e.currentCombinatorFilterStore.state}(t)),[t]),u=(0,r.VK)((()=>null==a?void 0:a.getType()),[a]);return a&&d&&u?(0,C.jsxs)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Advanced filter",id:"database.viewSettings.filterTab.title"}),unconstrainedWidth:!0,children:[(0,C.jsx)(Wc.D,{children:(0,C.jsx)(Uc.Pq,{index:0,level:0,combinatorFilter:d,schema:c,onChange:(e,o)=>function(e,t,o,i){var n;const r=null===(n=i.remoteResultStore.state)||void 0===n?void 0:n.sizeHint,s=Gc.default.mark("collections.update_filter_lag");Gc.default.measureAfterNextFlush(s,{environment:o,getData:()=>fo.Y5({from:"combinator_filter",collectionContextStore:i,sizeHintAtStart:r})}),Zc.iU({environment:o,collectionContextStore:i,temporaryState:{...i.temporaryStateStore.state,combinatorFilter:{value:t}}}),ut.wd({environment:o,collectionContextStore:i,action:"update_combinator_filter"})}(0,o,s,t),collectionContextStore:t,collectionViewType:u,collectionViewId:a.id,parentStore:a})}),(0,C.jsx)(U.Z,{topBorder:!0,children:(0,C.jsx)(B.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Delete filter",id:"database.viewSettings.filterTab.deleteFilterButton.title"}),isRed:!0,icon:T.y,onClick:()=>function(e,t,o,i){Zc.iU({environment:e,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,combinatorFilter:{value:void 0}}}),o===Wo.HV.FilterBar&&l.E3({collectionSettingsStore:i});ut.wd({environment:e,collectionContextStore:t,action:"delete_combinator_filter"})}(s,t,o,i)})})]}):null};var qc=o(720294),Qc=o(85125),Xc=o(401456),Yc=o(152387),Jc=o(205145),ed=o(586650);function td(e){const{collectionSettingsStore:t,collectionContextStore:o}=e,s=(0,n.O7)(),[a,c,d,u]=(0,r.VK)((()=>[o.currentPropertyFiltersStore.state,o.currentPropertyFiltersStore.state.map((e=>e.id)),o.permissionScopesStore.state,(0,Ne.yU)(o)]),[o]),p=(0,qc.k)(),g=(0,r.VK)((()=>d.canConfigureBlock?o.currentCombinatorFilterStore.state:void 0),[o,d]),m=(0,i.useCallback)((()=>{l.E3({collectionSettingsStore:o.filterOptionsCombinatorFilterSettingsStore}),a.forEach((e=>{const t=o.getFilterOptionsItemSettingsStore(e);l.E3({collectionSettingsStore:t})}))}),[o,a]);(0,i.useEffect)((()=>m()),[]);const S=(0,f.yK)((e=>({menuItem:{color:e.mediumTextColor},menuItemIcon:{width:14,marginLeft:4,marginRight:4,fill:e.mediumIconColor},mobile:{paddingTop:8,background:e.contentBackground}})),[]);return(0,C.jsx)("div",{onClick:e=>{(0,be.ZP)({event:e,context:be.Af.CollectionSettingsClick,callback:m})},children:(0,C.jsx)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Filters",id:"database.viewSettings.filtersTab.title"}),footer:u&&(0,C.jsx)(U.Z,{topBorder:!0,children:(0,C.jsx)(id,{collectionContextStore:o})}),unconstrainedWidth:!0,children:(0,C.jsxs)(U.Z,{children:[(c.length>0||g)&&(0,C.jsxs)("div",{style:s.device.isMobile?S.mobile:void 0,children:[g&&(0,C.jsx)(rd,{collectionContextStore:o}),nd(s)?(0,C.jsx)(Ts.ZP,{direction:"vertical",keys:c,renderKey:e=>{const t=c.indexOf(e);return(0,C.jsx)(sd,{collectionContextStore:o,filter:a[t],onClick:m})},onDrop:e=>function(e,t,o){const i=o.collectionViewBlockStore();if(!i)return;const n=o.currentPropertyFiltersStore.state,r=Pt.oA(e.map((e=>n.find((t=>t.id===e)))));Zc.iU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryStateStore.state,propertyFilters:{value:r}}}),ut.wd({environment:t,collectionContextStore:o,action:"reorder_filters"})}(e,s,o),onDragEnd:p,disabled:!d.canConfigureBlock}):c.map((e=>{const t=c.indexOf(e);return(0,C.jsx)(sd,{collectionContextStore:o,filter:a[t],onClick:m},e)}))]}),(0,C.jsx)(L.Z,{focused:!1,icon:(0,Wt.R)(S.menuItemIcon),style:S.menuItem,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Add filter",id:"database.viewSettings.filtersTab.newFilter.title"}),onClick:()=>{m(),function(e,t,o){ut.wd({environment:e,collectionContextStore:o,action:"click_new_filter"}),l.H4({collectionSettingsStore:t,item:{type:"createFilter"}}),o.filtersBarOpenStore.setState(!0)}(s,t,o)}})]})})})}const od=i.memo(td,No.Z);function id(e){let{collectionContextStore:t}=e;return(0,C.jsx)(ed.ZP,{context:ed.R1.SettingsFilters,collectionContextStore:t})}function nd(e){return!e.device.isMobile}function rd(e){let{collectionContextStore:t}=e;const o=(0,n.O7)();return(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 10px"},children:[nd(o)&&(0,C.jsx)(Jc.ZP,{iconSize:12,style:{marginLeft:6,marginRight:6,opacity:.4,cursor:void 0}}),(0,C.jsx)(Xc.B,{context:Qc.P.SettingsFilters,collectionContextStore:t,collectionSettingsStore:t.filterOptionsCombinatorFilterSettingsStore})]})}function sd(e){let{filter:t,collectionContextStore:o,onClick:i}=e;const s=(0,n.O7)(),a=(0,r.VK)((()=>o.getFilterOptionsItemSettingsStore(t)),[o,t]);return(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 10px"},children:[nd(s)&&(0,C.jsx)(Jc.ZP,{iconSize:12,style:{marginLeft:6,marginRight:6}}),(0,C.jsx)(Yc.Z,{id:t.id,context:Qc.P.SettingsFilters,collectionContextStore:o,collectionSettingsStore:a,onClick:i},t.id)]})}var ad=o(212347),ld=o(114714),cd=o(538769);const dd=Pt.Ds(((e,t)=>{void 0!==e&&t(e)}),300);function ud(e){let{value:t,onChange:o}=e;const n=(0,f.yK)((e=>({input:{background:e.contentBackground}})),[]),[r,s]=(0,i.useState)("");return(0,i.useEffect)((()=>{s(t.toString())}),[t]),(0,C.jsx)(p.Z,{type:"number",value:r,inputClassName:"input-hide-arrows",style:n.input,onChange:e=>{const t=e.target.value,i=parseFloat(t);isNaN(i)?dd(void 0,o):dd(i,o),s(t)}})}const pd=function(e){let{numberGroupBy:t,collectionContextStore:o,schema:i,onChange:n}=e;const s=(0,f.Fg)(),a=i[t.property];return(0,r.VK)((()=>o.collectionStore()),[o])&&a?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(U.Z,{topBorder:!1,disableMobileBorders:!0,title:(0,C.jsx)(P.FormattedMessage,{id:"database.groupMenu.numberGroupRange",defaultMessage:"Group range"}),isTitleUppercase:!1,children:(0,C.jsxs)("div",{style:{display:"flex",paddingLeft:14,paddingRight:14},children:[(0,C.jsx)(gd,{onChange:n,numberGroupBy:t,inputKey:"start"}),(0,C.jsx)("span",{style:{color:s.mediumTextColor,margin:"0 8px"},children:"–"}),(0,C.jsx)(gd,{onChange:n,numberGroupBy:t,inputKey:"end"})]})}),(0,C.jsx)(U.Z,{topBorder:!1,disableMobileBorders:!0,title:(0,C.jsx)(P.FormattedMessage,{id:"database.groupMenu.numberGroupSize",defaultMessage:"Group every"}),isTitleUppercase:!1,children:(0,C.jsxs)("div",{style:{paddingLeft:14,paddingRight:14},children:[(0,C.jsx)(gd,{onChange:n,numberGroupBy:t,inputKey:"size"}),(0,C.jsxs)("span",{style:{color:s.mediumTextColor,fontSize:12},children:[(0,C.jsx)(cd.Z,{disabled:!0,groupBy:t,groupFormat:{property:t.property,value:{type:"number",value:{type:"range",start:t.start,end:t.start+t.size}}},schema:i,currentGroups:[],isHiddenGroup:!1,style:{display:"inline",paddingRight:0,paddingLeft:0},collectionContextStore:o}),", ",(0,C.jsx)(cd.Z,{disabled:!0,groupBy:t,groupFormat:{property:t.property,value:{type:"number",value:{type:"range",start:t.start+t.size,end:t.start+2*t.size}}},schema:i,currentGroups:[],isHiddenGroup:!1,style:{display:"inline",paddingRight:0,paddingLeft:0},collectionContextStore:o}),", ..."]})]})})]}):null};function gd(e){let{numberGroupBy:t,inputKey:o,onChange:i}=e;return(0,C.jsx)(ud,{value:t[o],onChange:e=>{"size"===o&&e<=0&&(e=1),"start"===o&&e>t.end&&(e=t.end),"end"===o&&e<t.start&&(e=t.start),i({newNumberGroupBy:{...t,[o]:e}})}})}const md=function(e){return(0,C.jsx)(A.ZP,{...e,title:(0,C.jsx)(fd,{collectionSettingsStore:e.collectionSettingsStore,collectionContextStore:e.collectionContextStore}),children:(0,C.jsx)(Sd,{groupByKey:e.groupByKey,groupsFormatKey:e.groupsFormatKey,collectionContextStore:e.collectionContextStore})})};function fd(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const i=(0,r.VK)((()=>(0,Me.n)(t)),[t]),n=(0,r.VK)((()=>o.normalizedSchemaStore.state),[o]),s=(0,r.VK)((()=>o.normalizedFormatStore.state),[o]);if(!i||"groupByNumber"!==i.type||"chart_config"===i.groupByKey)return null;const a=s[i.groupByKey];return a?(0,ad.cR)({groupBy:a,schema:n})??null:null}function Sd(e){let{groupByKey:t,groupsFormatKey:o,collectionContextStore:i}=e;const s=(0,n.O7)(),a=(0,r.VK)((()=>i.collectionViewStore()),[i]),l=(0,r.VK)((()=>i.normalizedSchemaStore.state),[i]),u=(0,r.VK)((()=>i.normalizedFormatStore.state),[i]),p=(0,r.VK)((()=>(0,ld.b7)(u,t)),[u,t]);if(!p||!a)return null;const g=(0,ad.H5)(p);return g?(0,C.jsx)(pd,{numberGroupBy:g,schema:l,onChange:e=>{if("number"===p.type)d.createAndCommit({userAction:"CollectionSettingsViewGroupByNumber.renderContent",environment:s,perform:i=>{c.FH({stores:[a],update:{[t]:e.newNumberGroupBy,[o]:void 0},transaction:i})}});else if("formula"===p.type){const i=Pt.CE(e.newNumberGroupBy,"property"),n={...p,groupBy:i};d.createAndCommit({userAction:"CollectionSettingsViewGroupByNumber.renderContent",environment:s,perform:e=>{c.FH({stores:[a],update:{[t]:n,[o]:void 0},transaction:e})}})}ut.wd({environment:s,collectionContextStore:i,action:"group_by_number_update",original_view_type:void 0,property_type:p.type})},collectionContextStore:i}):null}var yd=o(892918);const hd=function(e){const{collectionContextStore:t,collectionSettingsStore:o,groupByKey:i,groupsFormatKey:s}=e,a=(0,n.O7)(),u=(0,r.VK)((()=>(0,Me.n)(o)),[o]),p=(0,r.VK)((()=>t.collectionViewBlockStore()),[t]),g=(0,r.VK)((()=>t.collectionViewStore()),[t]),m=(0,r.VK)((()=>null==g?void 0:g.getType()),[g]),f=(0,r.VK)((()=>(0,ld.b7)(t.normalizedFormatStore.state,i)),[t,i]),S=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t]),y=(0,r.VK)((()=>t.normalizedFormatStore.state),[t]),h=(0,r.VK)((()=>void 0!==m&&(0,yd._1)({viewType:m,groupByKey:i})),[i,m]),x=(0,r.VK)((()=>function(e){const t=e.normalizedSchemaStore.state,o=Object.entries(t).sort(xd).map((e=>e[0]));return o.filter((e=>{const o=t[e];return o&&(0,ld.LG)(o)}))}(t)),[t]);return p&&g&&u&&m&&"groupByProperty"===u.type?(0,C.jsx)(A.ZP,{...e,collectionSettingsStore:o,title:(0,ad.cE)(u.groupByKey,m),children:(0,C.jsx)(Ac.Z,{schema:S,format:y,currentProperty:null==f?void 0:f.property,showNoneOption:h,getProperties:()=>x,onAccept:e=>function(e,t,o,i,n,r){const s=o.collectionViewStore(),a=o.normalizedSchemaStore.state;if(!s)return;if(e){const i=a[e];if(!i||!(0,ld.LG)(i))return;const l=(0,ld.fw)(e,i,"collectionTypedView"===o.contextType);d.createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:t,perform:e=>{c.FH({stores:[s],update:{[n]:l,[r]:void 0},transaction:e})}}),ut.wd({environment:t,collectionContextStore:o,action:"group_by_property_accept",original_view_type:void 0,property_type:i.type})}else d.createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:t,perform:e=>{c.FH({stores:[s],update:{[n]:void 0,[r]:void 0},transaction:e})}}),ut.wd({environment:t,collectionContextStore:o,action:"group_by_property_accept"});l.wl({collectionSettingsStore:i,item:{type:"main"}}),l.H4({collectionSettingsStore:i,item:{type:"group",groupByKey:n,groupsFormatKey:r}})}(e,a,t,o,i,s)})}):null};function xd(e,t){var o,i;const n=null==e||null===(o=e[1])||void 0===o?void 0:o.name,r=null==t||null===(i=t[1])||void 0===i?void 0:i.name;return n&&r?n.localeCompare(r,void 0,{sensitivity:"base"}):n?1:r?-1:0}const vd=(0,P.injectIntl)((function(e){return(0,C.jsx)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Layout",id:"database.viewSettings.layoutTab.title"}),desktopWidth:290,children:(0,C.jsx)(Zo.Z,{...e})})}));var Cd=o(261495),bd=o(108306),jd=o(492607),wd=o(690716),Md=o(504430),_d=o(343350);const kd=110,Vd=210,Td=223,Pd=25,Id=87;function Fd(e){const{propertyName:t}=e,o=(0,f.Fg)(),i=(0,f.yK)((e=>({dependenciesPreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:"center",position:"relative",height:112,paddingLeft:19},svgContainer:{position:"absolute",width:"100%",height:"100%"},svgArrowTheme:{stroke:e.collectionValidDependencyArrow,strokeWidth:Md.lf},dependencyPropertyNamePreview:{fontSize:12,position:"absolute",background:e.buttonBackground,top:48,left:96},timelineItemPreview:{padding:4,margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center",borderRadius:5,background:e.cardBackground,boxShadow:e.buttonBoxShadow,width:100,justifyContent:"center"}})),[]);return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(U.Z,{children:(0,C.jsxs)("div",{style:i.dependenciesPreviewOutsideBorder,children:[(0,C.jsxs)("svg",{style:i.svgContainer,children:[(0,C.jsx)(_d.Z,{startPoint:{x:kd,y:Pd},endPoint:{x:kd,y:Id},style:i.svgArrowTheme,showArrowHead:!0}),(0,C.jsx)(_d.Z,{startPoint:{x:Vd,y:Id},endPoint:{x:Td,y:Id},style:i.svgArrowTheme,showArrowHead:!1}),(0,C.jsx)("circle",{cx:Td,cy:Id,r:Md.Wk,style:i.svgArrowTheme,fill:o.white})]}),(0,C.jsx)("div",{style:i.dependencyPropertyNamePreview,children:t}),(0,C.jsx)("div",{style:{...i.timelineItemPreview,marginTop:10,marginLeft:10},children:(0,C.jsx)("span",{children:"🌱"})}),(0,C.jsx)("div",{style:{...i.timelineItemPreview,marginTop:34,marginLeft:111},children:(0,C.jsx)("span",{children:"🌳"})})]})})})}const Zd=(0,P.defineMessages)({subitemInputPlaceholder:{defaultMessage:"Sub-tasks…",id:"database.viewSettings.relationsPropertyTab.subitemInputPlaceholder"},timelineArrowsByInputPlaceholder:{defaultMessage:"Dependencies…",id:"database.viewSettings.relationsPropertyTab.timelineArrowsByInputPlaceholder"}});const Ad=(0,P.injectIntl)((function(e,t){const{collectionContextStore:o,collectionSettingsStore:s,formatSetting:a}=e,u=(0,n.Fy)(),p=(0,P.useIntl)(),g=(0,n.O7)(),m="collection_page_properties",[y]=(0,i.useState)("no_limit"),h="subitem"===a,x="timeline_arrows_by"===a,v=(0,r.VK)((()=>o.databaseType),[o]),b=(0,r.VK)((()=>o.normalizedSchemaStore.state),[o]),j=(0,r.VK)((()=>o.collectionStore()),[o]),w=(0,r.VK)((()=>(null==j?void 0:j.getFormat())??{}),[j]),M=(0,r.VK)((()=>o.collectionViewStore()),[o]),_=(0,r.VK)((()=>null==M?void 0:M.getFormat()),[M]),k=(null==_?void 0:_.subitem_display_mode)??"show",V=(0,r.VK)((()=>{var e;return h?null===(e=o.currentSubitemFormatStoreForCollectionStore.state)||void 0===e?void 0:e.property:x?o.currentArrowsByFormatStore.state:void 0}),[o,h,x]),I=(0,r.VK)((()=>{var e,t;return h?null===(e=o.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.subitem_property:x?null===(t=o.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by:void 0}),[o,h,x]),F=(0,r.VK)((()=>o.permissionScopesStore.state),[o]),Z=(0,r.VK)((()=>Ue.NA(o,b)),[o,b]),K=(0,r.VK)((()=>o.normalizedSchemaStore.state),[o]),O=(0,r.VK)((()=>{var e;const t=o.currentSubitemFormatStoreForCollectionStore.state,i=o.currentArrowsByFormatStore.state;let n;return h?n=t?b[t.property]:void 0:x&&(n=i?b[i]:void 0),null===(e=n)||void 0===e?void 0:e.name}),[o,b,h,x]),L=(0,r.VK)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?Ue.m8(p,{targetCollectionStore:e,isSelfRelation:!0,sourceSchema:K,createUnique:!0,from:a}):p.formatMessage({id:"database.viewSettings.relationsPropertyTab.initialPropertyName.placeholder",defaultMessage:"Related to target"})}),[o,K,p,a]),[D,N]=(0,i.useState)(O||L),H=D===L,W=(0,r.VK)((()=>{const e=o.currentSubitemFormatStoreForCollectionStore.state,t=o.currentArrowsByFormatStore.state;let i;if(h?i=e?b[e.property]:void 0:x&&(i=t?b[t]:void 0),i&&"relation"===i.type){var n;const e=i.property;return e?null===(n=b[e])||void 0===n?void 0:n.name:void 0}}),[o,b,h,x]),G=(0,r.VK)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?Ue.aI(p,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:a}):p.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[o,p,a]),$=(0,r.VK)((()=>"title"===o.normalizedFormatStore.state.table_subitem_toggle_column),[o]),[q,Q]=(0,i.useState)({hasInverseRelation:!0,inverseName:W,autoRelate:{enabled:!1}}),[X,Y]=(0,i.useState)(0===Z.length),J=(0,r.qz)(void 0,We.Z),ee=(0,r.Kw)(J),te=(0,i.useCallback)((()=>Ue.NA(o,b)),[o,b]),oe=(0,i.useCallback)((e=>{if(e){const t=b[e];if(t&&"relation"===t.type){const e=t.property;if(e){const t=b[e];if(t&&q){const e=t.name;Q({hasInverseRelation:null==q?void 0:q.hasInverseRelation,inverseName:e,autoRelate:null==q?void 0:q.autoRelate})}}N(t.name)}}}),[b,q,N]),ie=(0,i.useCallback)((e=>{const{collectionViewStore:t,newProperty:o,transaction:i}=e;h?(0,Pt.o8)(t.getFormat().table_subitem_toggle_column)&&c.FH({stores:[t],update:{table_subitem_toggle_column:"title"},transaction:i}):x&&Cc.tF({collectionViewStore:t,newProperty:o,transaction:i})}),[h,x]),ne=(0,i.useCallback)((e=>{const{relationPropertyId:t,transaction:i}=e;h&&Be.km({environment:g,collectionContextStore:o,relationPropertyId:t,transaction:i}),x&&Cc._p({collectionContextStore:o,relationPropertyId:t,transaction:i})}),[h,x,g,o]),re=(0,i.useCallback)((e=>{const t=o.collectionViewStore();t&&(d.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handleDefaultPropertySelect",environment:g,perform:o=>{ie({collectionViewStore:t,newProperty:e,transaction:o}),ne({relationPropertyId:e,transaction:o})}}),oe(e),Y(!1),l.E3({collectionSettingsStore:s}),ut.wd({action:h?"update_default_subitem":"update_default_timeline_arrows_by",original_view_type:void 0,property_type:e?"relation":void 0,environment:g,collectionContextStore:o}))}),[o,g,Y,oe,s,h,ie,ne]),se=(0,i.useCallback)((e=>{const t=o.collectionViewStore();t&&(d.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handlePropertySelect",environment:g,perform:o=>{ie({collectionViewStore:t,newProperty:e,transaction:o})}}),oe(e),Y(!1),l.E3({collectionSettingsStore:s}),ut.wd({action:h?"update_subitem":"update_timeline_arrows_by",original_view_type:void 0,property_type:e?"relation":void 0,environment:g,collectionContextStore:o}))}),[o,g,oe,s,h,ie]),ae=(0,i.useCallback)((()=>{Ve.default.afterNextFlush((()=>{Y(!0),Q({hasInverseRelation:!0,inverseName:G,autoRelate:{enabled:!1}}),N(L)}))}),[G,L]),le=(0,i.useCallback)((()=>{if(!q)return;const{hasInverseRelation:e,inverseName:t,autoRelate:i}=q,n=o.collectionStore(),r=n,c=o.collectionViewStore();n&&r&&(d.createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:g,perform:s=>{const l=Ae.G3({environment:g,collectionStore:n,collectionViewArgs:c&&m?{collectionViewStore:c,format:c.getFormat(),formatKey:m}:void 0,propertyType:"relation",transaction:s});return Di.n7({environment:g,collectionContextStore:o,collectionStore:n,property:l,propertyName:D,targetCollectionStore:r,hasInverseRelation:e,inverseName:t,autoRelate:i,propertyLimit:y,intl:p,transaction:s,from:a}),c&&(ie({collectionViewStore:c,newProperty:l,transaction:s}),ne({relationPropertyId:l,transaction:s})),l}}),l.z$({collectionSettingsStore:s}),l.H4({collectionSettingsStore:s,item:{type:"main"}}),ut._H({environment:g,collectionContextStore:o,from:a,property_type:"relation"}))}),[o,g,s,m,p,y,D,q,a,ie,ne]),ce=(0,i.useCallback)((()=>{const e=o.collectionViewStore();e&&(pt.d1({environment:g,collectionViewStore:e,currentValue:o.normalizedFormatStore.state.table_subitem_toggle_column}),ut.wd({environment:g,collectionContextStore:o,action:"toggle_table_subitem_toggle_on_title"}))}),[o,g]),de=!F.canConfigureBlock,ue=(0,f.yK)((e=>({emptyStateText:{color:e.mediumTextColor,fontSize:14,margin:"0px 12px"},useExistingTitle:{fontSize:12,color:e.mediumTextColor,marginLeft:12,marginTop:12}})),[]);if(!j)return null;const pe=h&&F.canConfigureBlock&&O,ge=F.canConfigureCollection,me=(e,t,i,n)=>(0,C.jsx)(wd.Z,{version:"v1",menuProps:e,property:t,defaultProperty:I,checkState:i,propertySchema:n,collectionContextStore:o,handleDefaultPropertySelect:re,handlePropertySelect:se});return(0,C.jsxs)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{...(0,He.Gt)({feature:a,databaseType:v})}),footer:(0,C.jsxs)(U.Z,{topBorder:Z.length>0&&!X,children:[pe&&!X&&(0,C.jsx)(mt.Z,{showImage:!de,caption:So.default.formatMessage(He.dH.toggleNestingOnTitleMenuItemTooltip),tooltipImage:S.Z.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>(0,C.jsx)(Kt.Z,{...e,icon:e=>(0,dt.L)({width:11,height:11,marginRight:5,marginLeft:6,transform:"rotateZ(180deg)"}),title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),switcherProps:{disallowTabbing:!0,on:$},disabled:de,onClick:ce,isGray:!0})}),ge&&Z.length>0&&!X&&(0,C.jsx)(B.Z,{icon:Wt.R,title:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.subitemTab.newRelation",defaultMessage:"Create new relation"}),isGray:!0,onClick:ae}),!X&&(0,C.jsx)(C.Fragment,{children:F.canConfigureBlock&&!F.canConfigureCollection?(0,C.jsx)(B.Z,{title:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.removeSubitemRelation.removeSubitemButton.title",defaultMessage:"Turn off for this view"}),isRed:!0,onClick:()=>se(void 0)}):F.canConfigureBlock&&(0,C.jsx)(R.ZP,{popupType:u.isPhone?E.kQ.SlideUp:E.kQ.Popup,alignmentToOrigin:R.vR.End,placementToOrigin:R.pO.Bottom,originGap:0,renderOrigin:e=>(0,C.jsx)(C.Fragment,{children:!(!F.canConfigureBlock||!V)&&(0,C.jsx)(B.Z,{isGray:!0,icon:T.y,title:(0,C.jsx)(P.FormattedMessage,{...(0,He.nB)({feature:a,databaseType:v})}),isRed:!0,...e})}),render:e=>{let t;return t=u.isPhone?{menuType:Yn.og.ActionSheet}:{menuType:Yn.og.Popup,width:300},(0,C.jsx)(z.Z,{...t,footer:(0,C.jsxs)(U.Z,{topBorder:!0,children:[F.canConfigureBlock&&(0,C.jsx)(B.Z,{title:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.removeRelation.removeRelationButton.title",defaultMessage:"Turn off for this view"}),isRed:!0,onClick:()=>se(void 0)}),F.canConfigureCollection&&(0,C.jsx)(B.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Turn off for all new views",id:"database.viewSettings.relationsPropertyTab.removeRelation.removeAllDefaultButton.title"}),isRed:!0,onClick:()=>{re(void 0)}})]})})}})})]}),children:[h&&(0,C.jsx)(Xe,{propertyName:D||L,inversePropertyName:(null==q?void 0:q.inverseName)||G,newDesign:!1,subitemsDisplayMode:k}),x&&(0,C.jsx)(Fd,{propertyName:D||L}),!X&&(0,C.jsx)("div",{style:ue.useExistingTitle,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Use an existing relation",id:"database.viewSettings.relationsPropertyTab.useExistingRelation.title"})}),Z.length>0&&!X?(0,C.jsx)("div",{style:{paddingBottom:"6px"},children:(0,C.jsx)(U.Z,{children:(0,C.jsx)(R.ZP,{buttonPopupStore:J,render:e=>{let t;return t=u.isPhone?{menuType:Yn.og.ActionSheet}:{menuType:Yn.og.Popup,width:300},(0,C.jsx)(z.Z,{...t,footer:(0,C.jsx)(Ac.Z,{schema:b,format:w,getProperties:te,onAccept:F.canConfigureBlock&&!F.canConfigureCollection?se:()=>{},inputPlaceholder:So.default.formatMessage(h?Zd.subitemInputPlaceholder:Zd.timelineArrowsByInputPlaceholder),currentProperty:V,defaultShowPropertyCount:5,renderProperty:F.canConfigureBlock&&!F.canConfigureCollection?void 0:me})})},renderOrigin:e=>{var t;return(0,C.jsx)(B.Z,{title:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.existingRelation",defaultMessage:"Property"}),showChevron:!0,right:V?null===(t=b[V])||void 0===t?void 0:t.name:void 0,rotateChevron:ee.open,disabled:!1,icon:jd.v,...e})},popupType:u.isPhone?E.kQ.SlideUp:E.kQ.Popup,alignmentToOrigin:R.vR.End,placementToOrigin:R.pO.Bottom,originGap:0})})}):ge&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(U.Z,{children:(0,C.jsx)("div",{style:ue.emptyStateText,children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Rename (optional)",id:"database.viewSettings.relationsPropertyTab.emptyStateDescription"})})}),(0,C.jsx)(U.Z,{children:(0,C.jsx)(po.ZP,{value:D,placeholder:D,onChange:e=>N(e.target.value),onBlur:()=>{},onSubmit:()=>{},focusInitial:!0,selectAll:!1})}),(0,C.jsx)(Yi,{collectionContextStore:o,targetCollectionStore:j,property:void 0,buttonContents:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Create",id:"database.viewSettings.relationsPropertyTab.createButton.title"}),temporaryInverseState:q,setTemporaryInverseState:Q,isInitialPropertyName:H,onSubmit:le,from:a}),Z.length>0&&(0,C.jsx)("div",{style:{margin:"auto",textAlign:"center"},children:(0,C.jsx)(Co.Z,{onClick:()=>{Ve.default.afterNextFlush((()=>{Y(!1)}))},isGray:!0,style:{margin:"6px 12px 6px 12px",width:"auto"},children:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.newRelation",defaultMessage:"Use existing relation"})})})]})]})})),Bd=(0,v.IU)("collectionDeleteRule",{viewBox:"0 0 14 14",svg:(0,C.jsx)("path",{d:"M12 3.27273L10.7273 2L7 5.72727L3.27273 2L2 3.27273L5.72727 7L2 10.7273L3.27273 12L7 8.27273L10.7273 12L12 10.7273L8.27273 7L12 3.27273Z"})});var Kd=o(831339),Od=o(560246),Ld=o(177498),Rd=o(162045),Dd=o(750542);const zd=function(e){let{schema:t,sort:o,disabled:n,onChange:r,index:s,collectionViewType:a,collectionContextStore:l}=e;const c=t[o.property];return c?(0,C.jsxs)(i.Fragment,{children:[(0,C.jsx)(Ed,{disabled:n,schema:t,sort:o,onChange:r,index:s,collectionViewType:a,collectionContextStore:l,propertySchema:c}),(0,C.jsx)(Nd,{sort:o,index:s,onChange:r,collectionViewType:a,collectionContextStore:l,disabled:n})]}):null};function Nd(e){let{sort:t,index:o,onChange:i,collectionViewType:r,collectionContextStore:s,disabled:l}=e;const c=(0,n.O7)(),d=(0,P.useIntl)(),u=t.direction,p={ascending:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Ascending",id:"collectionSortMenuRow.sortDirectionSelectMenu.ascending"}),descending:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Descending",id:"collectionSortMenuRow.sortDirectionSelectMenu.descending"})},g={menuTitle:d.formatMessage({id:"collectionSortMenuRow.sortDirectionSelectMenu.title",defaultMessage:"Sort"}),items:[...Od.C6],getKey:e=>e,selectedItem:u,disabled:l,onSelect:e=>{const n={...t,direction:e};i(o,n),s?ut.wd({environment:c,action:"set_sort_direction",collectionContextStore:s}):r&&a.wd(c,{view_type:r,action:"set_sort_direction"})},renderItem:e=>(0,C.jsx)(L.Z,{title:p[e.value],...e}),renderOrigin:e=>(0,C.jsx)(Rd.Z,{...e,placeholder:d.formatMessage({id:"collectionSortMenuRow.sortDirectionSelectMenu.placeholder",defaultMessage:"Empty"}),title:u&&p[u],disabled:l,desktopStyle:{opacity:1}})};return(0,C.jsx)(ec.Z,{...g,mobileActionSheet:!0},"direction")}function Ed(e){let{propertySchema:t,disabled:o,schema:i,sort:r,onChange:s,index:l,collectionViewType:c,collectionContextStore:d}=e;const u=(0,n.O7)(),{device:p}=u;return(0,C.jsx)(R.ZP,{popupType:p.isMobile?R.Z4.SlideUp:R.Z4.Popup,renderOrigin:e=>(0,C.jsx)(Dd.Z,{...e,propertySchema:t,disabled:o,textWrapperStyle:{opacity:1}}),render:e=>(0,C.jsx)(Ld.Z,{isRelationProperty:!1,schema:i,onAccept:e=>function(e,t,o,i,n,r,s){i(n,{...o,property:e}),s?ut.wd({environment:t,action:"set_sort_property",collectionContextStore:s}):r&&a.wd(t,{view_type:r,action:"set_sort_property"})}(e,u,r,s,l,c,d),onClose:e.close,allowProperty:Ri.bA}),disabled:o})}const Hd=(0,P.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.collectionSortMenu.inputPlaceholder"},deleteButtonTooltip:{defaultMessage:"Remove sort rule",id:"database.sortMenu.deleteButtonTooltip"}});const Ud=function(e){let{schema:t,format:o,sorts:i,showDeleteAll:r,disabled:s,parentStore:a,collectionContextStore:l,onChange:c,onDeleteAll:d}=e;const u=(0,n.O7)(),{device:p}=u,g=!!Object.keys(t).some((e=>!i.find((t=>t.property===e)))),m=r&&i.length>0;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Xd,{sorts:i,schema:t,disabled:s,parentStore:a,collectionContextStore:l,onChange:c}),(g||m)&&(0,C.jsxs)(U.Z,{children:[g&&(0,C.jsx)(R.ZP,{popupType:p.isMobile?E.kQ.SlideUp:E.kQ.Popup,renderOrigin:e=>(0,C.jsx)(B.Z,{icon:Wt.R,isGray:!0,title:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.sortTab.newSort",defaultMessage:"Add sort"}),...e}),render:e=>{let n;return n=p.isMobile?{menuType:Yn.og.ActionSheet}:{menuType:Yn.og.Popup,width:280,height:287},(0,C.jsx)(z.Z,{...n,children:(0,C.jsx)(Ac.Z,{schema:t,format:o,getProperties:()=>Object.entries(t).filter((e=>{let[t,o]=e;return!i.find((e=>e.property===t))&&(0,Ri.bA)(o)})).map((e=>{let[t]=e;return t})),onAccept:o=>{!function(e,t,o,i,n,r){var s;if(!e)return;const a=null===(s=o[e])||void 0===s?void 0:s.type,l=[...i,{property:e,direction:"ascending"}];n(l),ut.wd({environment:t,action:"create_sort_accept",collectionContextStore:r,property_type:a})}(o,u,t,i,c,l),e.close()},inputPlaceholder:So.default.formatMessage(Hd.inputPlaceholder)})})}}),m&&(0,C.jsx)(B.Z,{icon:T.y,isRed:!0,isGray:!0,title:(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.sortTab.deleteAllSorts",defaultMessage:"Delete sort"}),onClick:()=>function(e,t,o,i){t([]),null==i||i(),ut.wd({environment:e,action:"delete_all_sorts",collectionContextStore:o})}(u,c,l,d)})]})]})};function Wd(e,t,o,i,n,r){i(n.map(((o,i)=>i===e?t:o))),ut.wd({environment:o,collectionContextStore:r,action:"update_sort"})}function Gd(e,t,o,i,n){o(i.filter(((t,o)=>o!==e))),ut.wd({environment:t,action:"delete_sort",collectionContextStore:n})}function $d(e){let{index:t,onChange:o,sorts:i,collectionContextStore:r}=e;const s=(0,n.O7)();return(0,C.jsx)(L.Z,{title:(0,C.jsx)("div",{style:{color:no.ZP.red},children:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Delete",id:"database.viewSettings.sortTab.mobileDeleteButtonTitle"})}),icon:(0,C.jsx)(Kd.Z,{icon:T.y,styles:{color:no.ZP.red}}),onClick:()=>Gd(t,s,o,i,r),focused:!1})}function qd(e){let{index:t,onChange:o,sorts:i,collectionContextStore:r}=e;const s=(0,P.useIntl)(),a=(0,n.O7)();return(0,C.jsx)($t.Z,{render:e=>(0,C.jsx)(Ho.Z,{ariaLabel:s.formatMessage(Hd.deleteButtonTooltip),icon:Bd,onClick:()=>Gd(t,a,o,i,r),style:{marginRight:-6},...e}),renderTooltip:()=>s.formatMessage(Hd.deleteButtonTooltip)})}function Qd(e){let{sort:t,index:o,schema:i,disabled:r,parentStore:s,collectionContextStore:a,onChange:l,sorts:c}=e;const d=(0,n.O7)(),{device:u}=d;return u.isMobile?(0,C.jsxs)(U.Z,{children:[(0,C.jsx)(zd,{index:o,sort:t,schema:i,parentStore:s,collectionContextStore:a,onChange:(e,t)=>Wd(e,t,d,l,c,a)}),!r&&(0,C.jsx)($d,{onChange:l,sorts:c,collectionContextStore:a,index:o})]}):(0,C.jsx)(U.Z,{extraTopPadding:!0,desktopStyle:{padding:"8px 0 0 8px",width:"100%"},children:(0,C.jsx)(Uo.Z,{showDragHandle:!u.isMobile&&!r,title:(0,C.jsx)("div",{style:{display:"flex",alignItems:"center",flexGrow:1,whiteSpace:"nowrap"},onMouseDown:be.$0,children:(0,C.jsx)(zd,{index:o,sort:t,schema:i,parentStore:s,collectionContextStore:a,onChange:(e,t)=>Wd(e,t,d,l,c,a)})}),right:!r&&(0,C.jsx)(qd,{onChange:l,sorts:c,collectionContextStore:a,index:o}),rightStyle:{marginRight:19}})})}function Xd(e){let{sorts:t,schema:o,disabled:i,parentStore:r,collectionContextStore:s,onChange:a}=e;const l=(0,n.O7)(),{device:c}=l;if(c.isMobile)return(0,C.jsx)(C.Fragment,{children:t.map(((e,n)=>(0,C.jsx)(Qd,{schema:o,disabled:i,parentStore:r,collectionContextStore:s,onChange:a,sorts:t,sort:e,index:n},n)))});{const e=t.map(((e,t)=>t.toString()));return e.length>0?(0,C.jsx)("div",{style:{marginBottom:2},children:(0,C.jsx)(Ts.ZP,{direction:"vertical",keys:e,renderKey:e=>(0,C.jsx)(Qd,{schema:o,disabled:i,parentStore:r,collectionContextStore:s,onChange:a,sorts:t,sort:t[parseInt(e)],index:parseInt(e)}),onDrop:e=>function(e,t,o,i,n){o(Pt.oA(e.map((e=>i[parseInt(e)])))),ut.wd({environment:t,action:"reorder_sorts",collectionContextStore:n})}(e,l,a,t,s)})}):null}}function Yd(e){let{context:t,collectionContextStore:o,collectionSettingsStore:i,fullHeight:s,hideDesktopHeader:a}=e;const c=(0,n.O7)(),[d,u,p,g,m,f]=(0,r.VK)((()=>[o.collectionViewStore(),(0,Ne.Mj)(o),o.normalizedSchemaStore.state,o.normalizedFormatStore.state,o.permissionScopesStore.state,Jd(o)]),[o]),S=t===Wo.HV.ViewSettings&&u;return d?(0,C.jsx)(A.ZP,{collectionSettingsStore:i,fullHeight:s,hideDesktopHeader:a,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Sort",id:"database.viewSettings.sortTab.title"}),footer:S&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:{paddingTop:24}}),(0,C.jsx)(U.Z,{topBorder:!0,children:(0,C.jsx)(eu,{collectionContextStore:o})})]}),unconstrainedWidth:!0,children:(0,C.jsx)(Ud,{collectionContextStore:o,schema:p,format:g,sorts:f,disabled:!m.canConfigureBlock,parentStore:d,onChange:e=>function(e,t,o){!function(e,t,o){const i=t.collectionViewStore();if(!i)return;Zc.iU({environment:o,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,sorts:{value:e}}})}(e,o,t)}(e,c,o),showDeleteAll:!0,onDeleteAll:()=>function(e,t){t===Wo.HV.FilterBar&&l.E3({collectionSettingsStore:e})}(i,t)})}):null}function Jd(e){return e.currentSortsStore.state}function eu(e){let{collectionContextStore:t}=e;return(0,C.jsx)(ed.ZP,{context:ed.R1.SettingsSort,collectionContextStore:t})}var tu=o(875553),ou=o(401436),iu=o(824039),nu=o(95477);const ru=2e4,su=100;var au=o(959753),lu=o(647425);var cu=o(475498);const du={type:"aggregation",filter:void 0,aggregation:{aggregator:"count",property:"title"}};function uu(e){let{collectionContextStore:t}=e;const o=(0,P.useIntl)(),{isMobile:s}=(0,n.Fy)(),a=(0,f.yK)((e=>({menuItem:{color:e.mediumTextColor,paddingLeft:s?4:8},warningIcon:{fill:(0,no.fi)("orange",e).fill,marginRight:14,width:12,alignSelf:"center"}})),[s]),l=(0,r.VK)((()=>{var e;return"row_limit_exceeded"===(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormatStore())||void 0===e?void 0:e.getKeyStore("sync_state").getKeyStore("syncing").getValue())}),[t]),c=(0,r.VK)((()=>yo.default.state.currentSpaceStore),[]),d=(0,r.VK)((()=>function(e){if(!e)return ru;const t=au.kk.fromSpace(e),o=t.getSetting("database_sync_row_limit");return void 0!==o?o:(0,lu.QM)(t.getSubscriptionTier())?su:ru}(null==c?void 0:c.getModel())),[c]),u=(0,r.VK)((()=>(0,lu.QM)(null==c?void 0:c.getSubscriptionTier())),[c]),p=(0,i.useMemo)((()=>(0,C.jsx)(cu.Z,{id:"table:uncategorized:title:count",collectionContextStore:t,reducer:du,render:e=>{const t=e.state;if(!t||"aggregation"!==t.type)return;if("number"!==t.aggregationResult.type)return;const i={...t.aggregationResult,value:t.aggregationResult.value&&Math.min(d,t.aggregationResult.value)};return(0,gs.uf)(i.value,"number_with_commas",o)}})),[t,o,d]);return(0,C.jsx)(Uo.Z,{title:(0,C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[l&&c&&u&&(0,C.jsx)($t.Z,{placement:Qt.u.Left,alignment:Qt.v.Center,renderTooltip:()=>(0,C.jsx)(P.FormattedMessage,{id:"database.viewSettings.syncedSourceTab.limitFree.toolTip",defaultMessage:"Free Plans are limited to 1 synced database with up to 100 rows."}),render:e=>(0,C.jsx)("div",{...e,children:(0,Na.t)(a.warningIcon)})}),(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Limit",id:"database.viewSettings.syncedSourceTab.limit"})]}),right:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{value}/{limit} rows",id:"database.viewSettings.syncedSourceTab.limitRows",values:{value:p,limit:(0,gs.uf)(d,"number_with_commas",o)}}),style:a.menuItem})}const pu=i.memo(uu,No.Z);var gu=o(660291),mu=o(769619),fu=o(816402);function Su(e){let{collectionContextStore:t}=e;const o=(0,n.O7)(),{isMobile:s}=o.device,a=(0,f.yK)((e=>({menuItem:{color:e.mediumTextColor,paddingLeft:s?4:8},menuItemIcon:{height:16,width:16,marginRight:2}})),[s]),c=(0,r.VK)((()=>t.collectionStore()),[t]),[d,u]=(0,r.VK)((()=>{const e=null==c?void 0:c.getFormatStore();return[null==e?void 0:e.getKeyStore("uri").getValue(),null==e?void 0:e.getKeyStore("bot_id").getValue()]}),[c]),p=(0,r.VK)((()=>yo.default.state.currentSpaceStore),[]),g=(0,r.VK)((()=>{var e;const o=t.numberChildrenUnfurledStore.state,i=t.numberChildrenReceivedStore.state,n=o/i,r=!0===(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat().sync_state)||void 0===e?void 0:e.syncing);return o&&i&&n<1&&!s||r&&s}),[t,s]),m=(0,r.VK)((()=>({defaultMessage:p&&(0,lu.QM)(p.getSubscriptionTier())?"Clear and sync database":"Sync database"})),[p]),[S,y]=(0,i.useState)(void 0);(0,i.useEffect)((()=>{if(d&&u){const e=`${u}:${d}`,t=Ss.Z.get({userId:o.currentUser.id,key:e});y(t)}}),[u,o,d]);const h=!S||S<Date.now();return d&&u?g?(0,C.jsx)(Uo.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Syncing",id:"database.viewSettings.syncedSourceTab.isSyncing"}),icon:(0,gu.b)(a.menuItemIcon,"sync-spinner"),style:a.menuItem}):h?(0,C.jsx)(B.Z,{isGray:!0,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"{message}",id:"database.viewSettings.syncedSourceTab.syncNow",values:{message:m.defaultMessage,description:m.description}}),icon:gu.b,onClick:async()=>{const e=null==c?void 0:c.id,t=!0===(null==c?void 0:c.getFormat().stale);e&&await l.R0({environment:o,uri:d,botId:u,collectionId:e,nextSync:S,setNextSync:y,isStale:t})}}):(0,C.jsx)(Uo.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Sync available in {timeToNextSync}",id:"database.viewSettings.syncedSourceTab.syncNow.disabled",values:{timeToNextSync:(0,fu.hH)(Date.now(),S)}}),icon:(0,mu.T)(a.menuItemIcon),style:a.menuItem}):null}const yu=i.memo(Su,No.Z);function hu(e){var t;let{collectionContextStore:o}=e;const i=(0,n.O7)(),{isMobile:s}=i.device,a=(0,f.yK)((()=>({menuItemTitle:{paddingLeft:s?4:8},menuItemIcon:{height:16,width:16,marginRight:2}})),[s]),l=(0,r.VK)((()=>o.collectionStore()),[o]),[c,d,u]=(0,r.VK)((()=>{const e=null==l?void 0:l.getFormatStore();return[null==e?void 0:e.getKeyStore("uri").getValue(),null==e?void 0:e.getKeyStore("bot_id").getValue(),null==e?void 0:e.getKeyStore("original_url").getValue()]}),[l]),p=null==l||null===(t=l.pointer)||void 0===t?void 0:t.spaceId,g=(0,r.VK)((()=>(0,ic.wY)(u,p)),[p,u]),m=(0,r.VK)((()=>o.collectionViewBlockStore()),[o]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(U.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Source database",id:"database.viewSettings.syncedSourceTab.sourceDatabase"}),children:(0,C.jsx)($t.Z,{placement:Qt.u.Left,alignment:Qt.v.Center,renderTooltip:()=>m&&(0,C.jsx)(iu.Z,{store:m,compactFormat:!0}),render:e=>(0,C.jsx)(Uo.Z,{...e,title:g,icon:(0,C.jsx)(bo.Z,{disabled:!0,icon:null==l?void 0:l.getIcon(),isEmptyPage:!1,size:20,style:a.menuItemIcon}),style:a.menuItemTitle})}),style:{paddingBottom:0}}),(0,C.jsx)(U.Z,{children:(0,C.jsx)(pu,{collectionContextStore:o})}),(0,C.jsxs)(U.Z,{topBorder:!0,children:[(0,C.jsx)(yu,{collectionContextStore:o}),(0,C.jsx)(B.Z,{isGray:!0,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Copy debugging information",id:"database.viewSettings.syncedSourceTab.copyDebugging"}),icon:tu.U,onClick:()=>{const e={uri:c,botId:d,spaceId:p};lo.RD({environment:i,stringValue:JSON.stringify(e,null,2),copiedMessage:lo.tq.copiedToClipboard})}}),(0,C.jsx)(D.Z,{href:`${nu.default.domainBaseUrl}?target=connected_apps`,children:(0,C.jsx)(B.Z,{icon:ou.g,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Manage my connections",id:"database.viewSettings.syncedSourceTab.manageConnections"}),isGray:!0})}),(0,C.jsx)(ls.Z,{href:(0,jn.UY)("guides.syncedDatabases"),title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Learn about synced databases",id:"database.viewSettings.syncedSourceTab.learnMoreButton.title."}),analyticsFrom:"view_settings_source"})]})]})}const xu=i.memo(hu,No.Z);function vu(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,s=(0,n.O7)(),a=(0,i.useRef)(Fa.Il()),[c,u]=(0,r.VK)((()=>{var e;return[t.collectionViewBlockStore(),Boolean(null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.getCollectionViewSourceCollectionStore())]}),[t]),p=(0,i.useMemo)((()=>wr.default.createValue("")),[]);return c?(0,C.jsx)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Source",id:"database.viewSettings.sourceTab.title"}),handleClose:()=>{ut.tW({environment:s,eventName:"abandoned_search",sessionId:a.current,source:Wo.S7.Source,queryLength:p.state.length}),l.E3({collectionSettingsStore:o})},children:u?(0,C.jsx)(xu,{collectionContextStore:t}):(0,C.jsx)(xc.ZP,{collectionContextStore:t,parentStore:c,onAccept:e=>function(e,t,o,i){d.createAndCommit({userAction:"CollectionSettingsViewSource.handleSourcePickerAccept",environment:t,perform:i=>{Po.yc({environment:t,collectionContextStore:o,collectionStore:e,transaction:i})}}),l.z$({collectionSettingsStore:i})}(e,s,t,o),context:Wo.S7.Source,searchSessionId:a.current,inputStore:p})}):null}const Cu=i.memo(vu);var bu=o(381726),ju=o(449953),wu=o(312775),Mu=o(446737),_u=o(183089),ku=o(89673);function Vu(e){const t=(0,P.useIntl)(),{moduleId:o,collectionSettingsStore:n}=e,[s,a]=(0,i.useState)(),l=function(e,t){const{layoutStore:o,collectionStore:i}=(0,Ra.J9)(),n=Tu({moduleId:e,collectionSettingsStore:t}),s=(0,r.VK)((()=>o.getFormQuestionsForFormLayout()),[o]),a=(0,r.VK)((()=>s.map((e=>{var t;return null===(t=e.getConfig())||void 0===t?void 0:t.propertyId})).filter(Ze.$K)),[s]);return(0,r.VK)((()=>{if(!i)return[];const e=i.getSchema();if(!o.getModel())return[];const t=(0,Ze.qP)(e).map((e=>{let[t,o]=e;if(o&&"text"===o.type&&!a.includes(t))return t})).filter(Ze.$K).map((t=>{const o=(0,Ri.Qm)({schema:e,property:t});if(o)return{key:t,keywords:[o.name],render:e=>{let{ref:o,...i}=e;return(0,C.jsx)(wu.R,{...i,propertyId:t})},action:()=>{n({type:"existingProperty",propertyId:t})}}})).filter(Ze.$K);return t}),[i,o,a,n])}(o,n),c=function(e,t){const o=Tu({moduleId:e,collectionSettingsStore:t}),i=(0,Mu.c)({actionHandler:e=>o({type:"newProperty",propertyType:e})});return(0,r.VK)((()=>["text","select"].map((e=>i(e))).filter(Ze.$K)),[i])}(o,n),d=e=>{let{key:t,title:o,items:i}=e;return{key:t,render:e=>(0,C.jsx)(U.Z,{title:o,...e,style:{display:"flex",flexDirection:"column",alignItems:"center",paddingLeft:"4px",paddingRight:"4px"},desktopTitleStyle:{alignSelf:"flex-start",paddingLeft:"8px"}}),items:i}},u=d({key:"existing-properties",title:(0,C.jsx)(P.FormattedMessage,{id:"formQuestionCreateSettings.existingPropertiesSectionTitle",defaultMessage:"Existing properties"}),items:l}),p=d({key:"new-properties",title:(0,C.jsx)(P.FormattedMessage,{id:"formQuestionCreateSettings.newPropertiesSectionTitle",defaultMessage:"New question"}),items:c}),g=(0,i.useCallback)((e=>a(e.target.value)),[]);return(0,C.jsxs)(U.Z,{children:[(0,C.jsx)(po.ZP,{focusInitial:!0,onChange:g,placeholder:t.formatMessage({id:"formQuestionCreateSettings.searchInput.placeholder",defaultMessage:"Search…"}),showClearButton:!0,value:s||""}),(0,C.jsx)(ju.f,{filterQuery:s,initialFocus:0,type:N.i.Vertical,sections:[...l.length>0?[u]:[],...c.length>0?[p]:[]]})]})}function Tu(e){const{moduleId:t,collectionSettingsStore:o}=e,r=(0,n.O7)(),{layoutStore:s,collectionStore:a}=(0,Ra.J9)();return(0,i.useCallback)((e=>{d.createAndCommit({userAction:"FormQuestionCreateSettings.createFormQuestion",environment:r,perform:i=>{if(!a)throw new Error("Collection store not found");const n=(()=>{if("existingProperty"===e.type)return e.propertyId;const t=e.propertyType;return Ae.G3({environment:r,collectionStore:a,collectionViewArgs:void 0,propertyName:ri.SO[t],propertyType:t,transaction:i})})(),{questionId:c}=(0,bu.Hz)({environment:r,transaction:i,layoutStore:s,collectionStore:a,moduleId:t,propertyId:n}),d=_u.Z.findModuleContainer({layoutStore:s,moduleId:t});l.FK({collectionSettingsStore:o,item:{type:"formQuestionEditSettings",formQuestionId:c,moduleId:t},ref:{current:(null==d?void 0:d.getNode())??null}})}})}),[o,a,r,s,t])}const Pu=function(e){const{moduleId:t,collectionSettingsStore:o}=e;return(0,u.$Z)()?(0,C.jsx)(ku.O,{children:(0,C.jsx)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{id:"formQuestionCreateSettings.menuTitle",defaultMessage:"New question"}),footer:(0,C.jsx)("div",{style:{marginBottom:8}}),children:(0,C.jsx)(Vu,{moduleId:t,collectionSettingsStore:o})})}):null},Iu=(0,v.IU)("asterisk",{viewBox:"0 0 12 13",svg:(0,C.jsx)("path",{d:"M5.95312 12.6172C5.15625 12.6172 4.89258 12.3945 4.89258 11.627V8.67383L2.34375 10.1445C2.0918 10.291 1.89258 10.3613 1.7168 10.3613C1.41797 10.3613 1.20117 10.1621 0.949219 9.72852L0.914062 9.6582C0.75 9.38281 0.667969 9.16016 0.667969 8.97266C0.667969 8.69141 0.849609 8.48047 1.24805 8.24609L3.80273 6.76953L1.24219 5.29883C0.84375 5.07031 0.662109 4.85352 0.662109 4.57812C0.662109 4.38477 0.744141 4.16211 0.914062 3.875L0.949219 3.81641C1.20703 3.38281 1.41797 3.17188 1.7168 3.17188C1.89258 3.17188 2.0918 3.24805 2.33789 3.38867L4.89258 4.87109V1.91797C4.89258 1.15039 5.15625 0.927734 5.95312 0.927734H6.0293C6.83203 0.927734 7.08984 1.15039 7.08984 1.91797V4.87109L9.65625 3.38867C9.90234 3.24805 10.1016 3.17188 10.2715 3.17188C10.5703 3.17188 10.7871 3.38281 11.0449 3.81641L11.0801 3.875C11.2441 4.16211 11.3262 4.38477 11.3262 4.57812C11.3262 4.85352 11.1504 5.07031 10.752 5.29883L8.19141 6.76953L10.7461 8.24609C11.1387 8.48047 11.3262 8.69141 11.3262 8.97266C11.3262 9.16016 11.2441 9.38281 11.0801 9.6582L11.0449 9.72852C10.7871 10.1621 10.5703 10.3613 10.2773 10.3613C10.1016 10.3613 9.90234 10.291 9.64453 10.1445L7.08984 8.67383V11.627C7.08984 12.3945 6.83203 12.6172 6.0293 12.6172H5.95312Z"})});var Fu=o(271800),Zu=o(593680);const Au=(0,v.IU)("collectionFormQuestionType",{viewBox:"0 0 14 14",svg:(0,C.jsx)("path",{d:"M3.25391 6.53809C1.59961 6.53809 0.25293 5.18457 0.25293 3.53711C0.25293 1.90332 1.59961 0.549805 3.25391 0.549805C4.90137 0.549805 6.24805 1.90332 6.24805 3.53711C6.24805 5.18457 4.90137 6.53809 3.25391 6.53809ZM10.7461 6.53809C9.08496 6.53809 7.74512 5.18457 7.74512 3.53711C7.74512 1.90332 9.08496 0.549805 10.7461 0.549805C12.3867 0.549805 13.7402 1.90332 13.7402 3.53711C13.7402 5.18457 12.3867 6.53809 10.7461 6.53809ZM3.25391 5.29395C4.23145 5.29395 5.00391 4.52832 5.00391 3.54395C5.00391 2.56641 4.23145 1.77344 3.25391 1.77344C2.2627 1.77344 1.49707 2.56641 1.49707 3.54395C1.49707 4.52832 2.2627 5.29395 3.25391 5.29395ZM10.7461 5.29395C11.7236 5.29395 12.4961 4.52832 12.4961 3.54395C12.4961 2.56641 11.7236 1.77344 10.7461 1.77344C9.75488 1.77344 8.98242 2.56641 8.98242 3.54395C8.98242 4.52832 9.75488 5.29395 10.7461 5.29395ZM3.25391 13.5791C1.59961 13.5791 0.25293 12.2256 0.25293 10.5781C0.25293 8.94434 1.59961 7.58398 3.25391 7.58398C4.90137 7.58398 6.24805 8.94434 6.24805 10.5781C6.24805 12.2256 4.90137 13.5791 3.25391 13.5791ZM10.7461 13.5791C9.08496 13.5791 7.74512 12.2256 7.74512 10.5781C7.74512 8.94434 9.08496 7.58398 10.7461 7.58398C12.3867 7.58398 13.7402 8.94434 13.7402 10.5781C13.7402 12.2256 12.3867 13.5791 10.7461 13.5791ZM3.25391 12.3281C4.23145 12.3281 5.00391 11.5625 5.00391 10.5781C5.00391 9.60059 4.23145 8.80762 3.25391 8.80762C2.2627 8.80762 1.49707 9.60059 1.49707 10.5781C1.49707 11.5625 2.2627 12.3281 3.25391 12.3281ZM10.7461 12.3281C11.7236 12.3281 12.4961 11.5625 12.4961 10.5781C12.4961 9.60059 11.7236 8.80762 10.7461 8.80762C9.75488 8.80762 8.98242 9.60059 8.98242 10.5781C8.98242 11.5625 9.75488 12.3281 10.7461 12.3281Z"})});var Bu=o(917948),Ku=o(505377),Ou=o(986488),Lu=o(794229),Ru=o(495097),Du=o(39779),zu=o(480608);function Nu(e){let{collectionContextStore:t,collectionSettingsStore:o,formQuestionStore:i,propertyType:n}=e;const s=(0,r.VK)((()=>ri.SO[n]),[n]);return(0,C.jsx)(B.Z,{icon:Au,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Question type",id:"formQuestionEditSettings.questionType.menuTitle"}),showChevron:!0,disabled:!0,right:s})}function Eu(e){let{collectionContextStore:t,collectionSettingsStore:o,formQuestionStore:i}=e;return(0,C.jsx)(Kt.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Required",id:"formQuestionEditSettings.isRequired.title"}),switcherProps:{on:!0},icon:Iu,disabled:!0})}function Hu(e){let{collectionContextStore:t,collectionSettingsStore:o,formQuestionStore:i}=e;return(0,C.jsx)(Kt.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Visible",id:"formQuestionEditSettings.isVisible.title"}),switcherProps:{on:!0},icon:Te.c,disabled:!0})}function Uu(e){let{}=e;return(0,C.jsx)(B.Z,{icon:Fu.N,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Max characters",id:"formQuestionEditSettings.maxCharacters.title"}),showChevron:!0,disabled:!0,right:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"None",id:"formQuestionEditSettings.maxCharacters.right"})})}function Wu(e){let{}=e;return(0,C.jsx)(B.Z,{icon:Bu.O,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Show options as",id:"formQuestionEditSettings.showOptionsAs.menuTitle"}),showChevron:!0,disabled:!0,right:"List"})}function Gu(e){let{}=e;return(0,C.jsx)(Kt.Z,{title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:'Allow "Other"',id:"formQuestionEditSettings.allowOther.title"}),switcherProps:{on:!1},icon:Ou.p,disabled:!0})}function $u(e){let{}=e;return(0,C.jsx)(B.Z,{icon:Lu.o,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Preselect",id:"formQuestionEditSettings.preselect.title"}),showChevron:!0,disabled:!0,right:"None"})}function qu(e){let{collectionContextStore:t,collectionSettingsStore:o,formQuestionStore:i}=e;const n=(0,r.VK)((()=>{var e;return null===(e=i.getConfig())||void 0===e?void 0:e.propertyId}),[i]),s=(0,r.VK)((()=>{if(!n)return;const e=t.normalizedSchemaStore.state[n];return e?e.name:void 0}),[t.normalizedSchemaStore,n]);return s?(0,C.jsx)(B.Z,{icon:w,title:(0,C.jsx)(P.FormattedMessage,{defaultMessage:"Linked property",id:"formQuestionEditSettings.linkedProperty.title"}),showChevron:!0,disabled:!0,right:s}):null}function Qu(e){let{collectionContextStore:t,collectionSettingsStore:o,moduleId:r}=e;const{layoutStore:s,sessionId:a}=(0,Ra.J9)(),l=(0,n.O7)(),c=(0,i.useCallback)((()=>{(0,bu.WH)({environment:l,moduleId:r,sessionId:a,layoutStore:s,collectionSettingsStore:o})}),[o,l,s,r,a]);return(0,C.jsx)(B.Z,{icon:T.y,title:(0,C.jsx)(P.FormattedMessage,{id:"formQuestionEditSettings.deleteQuestion.title",defaultMessage:"Delete question"}),onClick:c})}function Xu(e){let{collectionContextStore:t,collectionSettingsStore:o,moduleId:r,formQuestionStore:s}=e;const a=(0,n.O7)(),{autofocusedQuestionDescriptionStore:l}=(0,Du.Y)(),c=(0,i.useCallback)((()=>{(0,bu.K8)({environment:a,questionStore:s,autofocusedQuestionDescriptionStore:l})}),[l,a,s]);return(0,C.jsx)(B.Z,{icon:Zu.W,title:(0,C.jsx)(P.FormattedMessage,{id:"formQuestionEditSettings.addDescription.title",defaultMessage:"Add description"}),onClick:c})}function Yu(e){let{collectionContextStore:t,collectionSettingsStore:o,formQuestionStore:i}=e;return(0,C.jsx)(B.Z,{icon:Ku.y,title:(0,C.jsx)(P.FormattedMessage,{id:"formQuestionEditSettings.addImage.title",defaultMessage:"Add image"}),disabled:!0})}function Ju(e){let{collectionContextStore:t,collectionSettingsStore:o,formQuestionStore:i}=e;return(0,C.jsx)(B.Z,{icon:Ru.H,title:(0,C.jsx)(P.FormattedMessage,{id:"formQuestionEditSettings.addVideo.title",defaultMessage:"Add video"}),disabled:!0})}const ep=function(e){const{collectionContextStore:t,collectionSettingsStore:o,formQuestionId:s,moduleId:a}=e,l=(0,n.O7)(),c=(0,u.$Z)(),d=(0,r.VK)((()=>t.collectionViewStore()),[t]),p=(0,r.VK)((()=>{if(!d)throw new Error("no collectionViewStore found");const e=d.getSpaceId();if(!e)throw new Error("no spaceId found");return zu.c.createChildStore(d,{table:"form_question",id:s,spaceId:e})}),[d,s]),g=(0,r.VK)((()=>{var e;return(0,tc.Xh)(null===(e=p.getConfig())||void 0===e?void 0:e.name,p)??""}),[p]),m=(0,r.VK)((()=>t.permissionScopesStore.state),[t.permissionScopesStore]),f=(0,r.VK)((()=>{var e;return null===(e=p.getConfig())||void 0===e?void 0:e.propertyId}),[p]),S=(0,r.VK)((()=>{if(!f)return;return t.normalizedSchemaStore.state[f]}),[t.normalizedSchemaStore,f]),y=(0,r.VK)((()=>{if(S&&(0,u.s0)(S))return S.type}),[S]),h=(0,i.useCallback)((e=>{(0,bu.Hm)({environment:l,questionStore:p,newName:e})}),[l,p]);if(!c||!y)return null;const x=!m.canConfigureCollection,v={title:(0,C.jsx)(Uu,{}),text:(0,C.jsx)(Uu,{}),select:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Wu,{}),(0,C.jsx)(Gu,{}),(0,C.jsx)($u,{})]})};return(0,C.jsx)(ku.O,{children:(0,C.jsxs)(A.ZP,{...e,title:(0,C.jsx)(P.FormattedMessage,{id:"formQuestionEditSettings.menuTitle",defaultMessage:"Question options"}),footer:(0,C.jsx)("div",{style:{marginBottom:8}}),children:[(0,C.jsx)(U.Z,{children:(0,C.jsx)(po.ZP,{value:g,onChange:e=>h(e.target.value),disabled:x,focusInitial:!0})}),(0,C.jsx)(U.Z,{children:(0,C.jsx)(Nu,{collectionSettingsStore:o,collectionContextStore:t,formQuestionStore:p,propertyType:y})}),(0,C.jsxs)(U.Z,{topBorder:!0,children:[(0,C.jsx)(Eu,{collectionSettingsStore:o,collectionContextStore:t,formQuestionStore:p}),v[y],(0,C.jsx)(Hu,{collectionSettingsStore:o,collectionContextStore:t,formQuestionStore:p})]}),(0,C.jsxs)(U.Z,{topBorder:!0,children:[(0,C.jsx)(qu,{collectionSettingsStore:o,collectionContextStore:t,formQuestionStore:p}),(0,C.jsx)(Yu,{collectionSettingsStore:o,collectionContextStore:t,formQuestionStore:p}),(0,C.jsx)(Ju,{collectionSettingsStore:o,collectionContextStore:t,formQuestionStore:p}),(0,C.jsx)(Xu,{collectionSettingsStore:o,collectionContextStore:t,moduleId:a,formQuestionStore:p}),(0,C.jsx)(Qu,{collectionSettingsStore:o,collectionContextStore:t,moduleId:a})]})]})})};const tp=function(e){var t;const{collectionSettingsStore:o,collectionContextStore:s}=e,c=(0,n.O7)(),[d,u]=(0,i.useState)(),p=(0,r.VK)((()=>(0,Me.n)(o)),[o]),m=(0,r.VK)((()=>s.getViewType()),[s]);(0,je.Z)({capture:!0,preventType:we.Z.Y}),(0,i.useEffect)((()=>{var e,t,o,i,n,r,l;p&&d!==p&&("propertyType"===p.type?a.r5(c,{view_type:m,menu:p.type,is_database_name_empty:!Boolean(null==s||null===(e=s.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()),collection_id:null===(t=s.collectionStore())||void 0===t?void 0:t.id,collection_view_id:null===(o=s.collectionViewStore())||void 0===o?void 0:o.id,collection_view_block_id:null===(i=s.collectionViewBlockStore())||void 0===i?void 0:i.id,database_visit_id:s.visitSessionId}):a.r5(c,{view_type:m,menu:p.type,collection_id:null===(n=s.collectionStore())||void 0===n?void 0:n.id,collection_view_id:null===(r=s.collectionViewStore())||void 0===r?void 0:r.id,collection_view_block_id:null===(l=s.collectionViewBlockStore())||void 0===l?void 0:l.id,database_visit_id:s.visitSessionId}));u(p)}),[s,p,c,d,m]);const f=function(e){return{main:t=>(0,C.jsx)(op,{tab:t,...e}),source:()=>(0,C.jsx)(Cu,{...e}),createViewSource:()=>(0,C.jsx)(Oo.m,{...e}),createSyncedViewSource:t=>(0,C.jsx)(np,{tab:t,...e}),selectAccountForExternalSource:t=>(0,C.jsx)(rp,{tab:t,...e}),shareSyncedView:t=>(0,C.jsx)(sp,{tab:t,...e}),propertyType:t=>(0,C.jsx)(ap,{tab:t,...e}),propertyAiAutofill:t=>(0,C.jsx)(lp,{tab:t,...e}),createView:()=>(0,C.jsx)(Bo,{...e}),duplicateExistingView:()=>(0,C.jsx)(dp,{...e}),properties:t=>(0,C.jsx)(cp,{tab:t,...e}),property:t=>(0,C.jsx)(up,{tab:t,...e}),deletedProperties:t=>(0,C.jsx)(pp,{tab:t,...e}),selectRelationSource:t=>(0,C.jsx)(gp,{tab:t,...e}),setupRelation:t=>(0,C.jsx)(mp,{tab:t,...e}),layout:()=>(0,C.jsx)(vd,{...e}),group:t=>(0,C.jsx)(fp,{tab:t,...e}),groupByProperty:t=>(0,C.jsx)(Sp,{tab:t,...e}),subitem:t=>(0,C.jsx)(hp,{tab:t,...e}),arrowsBy:t=>(0,C.jsx)(vp,{tab:t,...e}),githubConfig:t=>(0,C.jsx)(jp,{tab:t,...e}),filters:()=>(0,C.jsx)(od,{...e}),groupByNumber:t=>(0,C.jsx)(yp,{tab:t,...e}),filter:t=>(0,C.jsx)(wp,{tab:t,...e}),createFilter:()=>(0,C.jsx)(Oc,{...e}),createSort:()=>(0,C.jsx)(Ec,{...e}),sort:()=>(0,C.jsx)(Yd,{...e}),page:()=>(0,C.jsx)(ip,{...e}),automationSettings:t=>(0,C.jsx)(Mp,{tab:t,...e}),externalProjectsSyncSettings:t=>(0,C.jsx)(_p,{tab:t,...e}),automationCreateSettings:t=>(0,C.jsx)(kp,{tab:t,...e}),automationEditSettings:t=>(0,C.jsx)(Vp,{tab:t,...e}),dependencies:t=>(0,C.jsx)(Cp,{tab:t,...e}),relationFeaturesAdvancedSettings:t=>(0,C.jsx)(bp,{tab:t,...e}),subitemV2:t=>(0,C.jsx)(xp,{tab:t,...e}),sprintSettings:t=>(0,C.jsx)(Tp,{tab:t,...e}),chartStyle:t=>(0,C.jsx)(Fp,{tab:t,...e}),customize:t=>(0,C.jsx)(Zp,{tab:t,...e}),connectionFeatures:t=>(0,C.jsx)(Ap,{tab:t,...e}),formQuestionEditSettings:t=>(0,C.jsx)(Pp,{tab:t,...e}),formQuestionCreateSettings:t=>(0,C.jsx)(Ip,{tab:t,...e})}}(e);return p?(0,C.jsx)(g.Z,{debugName:"CollectionSettings",capture:!0,onEsc:t=>function(e,t){(0,be.ZP)({event:e,context:be.Af.CollectionSettingsClick,callback:()=>{l.E3({collectionSettingsStore:t})}})}(t,e.collectionSettingsStore),children:null===(t=f[p.type])||void 0===t?void 0:t.call(f,p)}):null};function op(e){const{collectionContextStore:t,tab:o}=e,i=(0,r.VK)((()=>{var e;return null===(e=t.collectionViewStore())||void 0===e?void 0:e.id}),[t]),n=(0,r.VK)((()=>t.collectionViewStore()),[t]);return"main"===o.type&&n?(0,C.jsx)(Cd.ZP,{selectViewNameInitial:o.selectViewNameInitial,collectionViewStore:n,...e},i):null}function ip(e){const{collectionContextStore:t}=e,o=(0,n.O7)(),i=(0,r.VK)((()=>t.collectionViewStore()),[t]);return i?(0,C.jsx)(A.ZP,{...e,title:"Select page to display",children:(0,C.jsx)("div",{style:{margin:12},children:(0,C.jsx)(p.Z,{showClearButton:!0,placeholder:"Enter page ID",focusInitial:!0,onChange:e=>{ke.Z.setState({pageId:e.target.value})},onSubmit:()=>{const e=ke.Z.state.pageId;if(!e)return null;d.createAndCommit({userAction:"collectionSettings.pageView.selectPage",environment:o,perform:t=>{c.FH({stores:[i],update:{page_pointer:{id:(0,s.Mt)(e),spaceId:t.spaceId,table:"block"}},transaction:t})}})}})})}):null}function np(e){const{tab:t}=e;return"createSyncedViewSource"!==t.type?null:(0,C.jsx)(Mo,{...e,...t})}function rp(e){const{tab:t}=e;return"selectAccountForExternalSource"!==t.type?null:(0,C.jsx)(Yt,{...e,...t})}function sp(e){const{tab:t}=e;return"shareSyncedView"!==t.type?null:(0,C.jsx)(Tc,{...e,...t})}function ap(e){const{tab:t}=e;return"propertyType"!==t.type?null:(0,C.jsx)(sc,{...e,...t})}function lp(e){const{tab:t}=e;return"propertyAiAutofill"!==t.type?null:(0,C.jsx)(nl,{...e,...t})}function cp(e){const{tab:t}=e;return"properties"!==t.type?null:(0,C.jsx)(bd.Z,{...e,timelineViewTab:t.timelineViewTab})}function dp(e){return(0,r.VK)((()=>_e.default.checkGate({gateName:"functional_collection_settings_duplicate_view"})),[])?(0,C.jsx)(ui,{...e}):(0,C.jsx)(Xo.ZP,{...e})}function up(e){const{tab:t}=e,o=(0,r.VK)((()=>_e.default.checkGate({gateName:"functional_collection_settings_property"})),[]);return"property"!==t.type?null:o?(0,C.jsx)(ml,{...e,...t},t.property):(0,C.jsx)(Ys,{...e,...t},t.property)}function pp(e){const{tab:t}=e;return"deletedProperties"!==t.type?null:(0,C.jsx)(Qo,{...t,...e})}function gp(e){const{tab:t}=e;return"selectRelationSource"!==t.type?null:(0,C.jsx)(vc,{...e,...t})}function mp(e){const{tab:t}=e;return"setupRelation"!==t.type?null:(0,C.jsx)(bc,{...e,...t})}function fp(e){const{tab:t}=e;return"group"!==t.type?null:(0,C.jsx)(ad.ZP,{...e,...t})}function Sp(e){const{tab:t}=e;return"groupByProperty"!==t.type?null:(0,C.jsx)(hd,{...e,...t})}function yp(e){const{tab:t}=e;return"groupByNumber"!==t.type?null:(0,C.jsx)(md,{...e,...t})}function hp(e){const{tab:t}=e;return"subitem"!==t.type?null:(0,C.jsx)(Ad,{...e,...t,formatSetting:"subitem"})}function xp(e){const{tab:t}=e;return"subitemV2"!==t.type?null:(0,C.jsx)(tt,{...e,feature:"subitem",from:t.from})}function vp(e){const{tab:t}=e;return"arrowsBy"!==t.type?null:(0,C.jsx)(Ad,{...e,...t,formatSetting:"timeline_arrows_by"})}function Cp(e){const{tab:t}=e;return"dependencies"!==t.type?null:(0,C.jsx)(tt,{...e,feature:"timeline_arrows_by",from:t.from})}function bp(e){const{tab:t}=e;return"relationFeaturesAdvancedSettings"!==t.type?null:(0,C.jsx)(vt,{...e,feature:t.feature})}function jp(e){const{tab:t}=e;return"githubConfig"!==t.type?null:(0,C.jsx)(Cr,{...e,property:t.property})}function wp(e){const{tab:t}=e;return"filter"!==t.type?null:(0,C.jsx)($c,{...e})}function Mp(e){const{tab:t}=e;return"automationSettings"!==t.type?null:(0,C.jsx)(ye,{...e,tabSettings:t})}function _p(e){const{tab:t}=e;return"externalProjectsSyncSettings"!==t.type?null:(0,C.jsx)(Fn,{...e,tabSettings:t})}function kp(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:i,fullHeight:n}=e;return"automationCreateSettings"!==t.type?null:(0,C.jsx)(fe,{collectionContextStore:o,collectionSettingsStore:i,fullHeight:n,mode:"create",from:t.from})}function Vp(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:i,fullHeight:n}=e;if("automationEditSettings"!==t.type)return null;const{automationId:r}=t;return(0,C.jsx)(Se,{automationId:r,collectionContextStore:o,collectionSettingsStore:i,fullHeight:n,mode:"update",source:t.source})}function Tp(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:i}=e;return"sprintSettings"!==t.type?null:(0,C.jsx)($,{collectionContextStore:o,collectionSettingsStore:i,from:t.from})}function Pp(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:i}=e;const n=(0,u.$Z)();return"formQuestionEditSettings"===t.type&&n?(0,C.jsx)(ep,{collectionContextStore:o,collectionSettingsStore:i,formQuestionId:t.formQuestionId,moduleId:t.moduleId}):null}function Ip(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:i}=e;const n=(0,u.$Z)();return"formQuestionCreateSettings"===t.type&&n?(0,C.jsx)(Pu,{collectionContextStore:o,collectionSettingsStore:i,moduleId:t.moduleId}):null}function Fp(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:i}=e;const n=(0,r.VK)((()=>_e.default.checkGate({gateName:"charts_mvp"})),[]);return"chartStyle"===t.type&&n?(0,C.jsx)(Ut,{collectionContextStore:o,collectionSettingsStore:i}):null}function Zp(e){const{tab:t}=e;return"customize"!==t.type?null:(0,C.jsx)(xe,{...e})}function Ap(e){const{tab:t}=e;return"connectionFeatures"!==t.type?null:(0,C.jsx)(Ce,{...e})}var Bp=o(409015),Kp=o(417501),Op=o(100246),Lp=o(74404),Rp=o(168910);const Dp=(0,P.defineMessages)({inputPlaceholder:{defaultMessage:"Type a name for this button...",id:"database.buttonProperty.label.inputPlaceholder"}});function zp(e){const{collectionContextStore:t,propertySchema:o}=e,n=(0,r.VK)((()=>t.collectionStore()),[t]),s=(0,r.VK)((()=>null==n?void 0:n.getSpaceId()),[n]),a=(0,i.useMemo)((()=>{const e=o.automation_id;if(e&&s)return{id:e,spaceId:s,table:zo.cv}}),[o.automation_id,s]);return(0,Op.N)(n,a)?(0,C.jsx)(Np,{...e}):(0,C.jsx)(Ep,{})}function Np(e){const{collectionContextStore:t,propertySchema:o,propertyId:s}=e,a=(0,n.O7)().currentUser.id,[l,c]=(0,i.useState)([]),d=(0,r.VK)((()=>t.permissionScopesStore.state),[t]),u=(0,r.VK)((()=>t.collectionStore()),[t]),p=(0,r.VK)((()=>null==u?void 0:u.getSpaceId()),[u]),{maybePersistedAutomationStore:g,maybePersistedTransactionActions:m}=(0,Lp.$)({automationId:o.automation_id,spaceId:p,defaultValue:void 0,persist:!0}),f=(0,r.VK)((()=>null==g?void 0:g.getTrigger()),[g]),S=(0,i.useMemo)((()=>{if(g)return new Rp.L({type:"button_property",persisted:!0,automationStore:g,collectionContextStore:t,propertyId:s,propertySchema:o,intl:So.default.getIntl(),parentRecordStore:g,currentUserId:a})}),[s,o,g,t,a]),y=(0,Kp.C)({automationStore:g,propertyId:s,propertySchema:o}),h=(0,r.VK)((()=>{var e;return"sufficient"===(null==y||null===(e=y.state)||void 0===e?void 0:e.executionPermissionStatus)}),[y]),x=(0,r.VK)((()=>(null==g?void 0:g.getNameStore().getValue())??""),[g]),v=(0,i.useCallback)((e=>{if(!g)return;const t=e.currentTarget.value;m.createAndCommit({userAction:"CollectionSettingsButtonOptions.setName",perform:e=>{It.sO({store:g.getNameStore(),transaction:e,value:t})}})}),[g,m]),b=(0,i.useCallback)((e=>{c((t=>[...t,e.id]))}),[]);return u&&g&&f&&"button"===f.type&&S?(0,C.jsxs)(Bp.Z.Provider,{value:{automationContextStore:S,collectionStore:u,disabled:!h,editorPlacement:{type:"inline"},editorWidth:A.nJ,maybePersistedTransactionActions:m,onActionAdded:b,suppressActionErrors:l},children:[(0,C.jsx)(U.Z,{topBorder:!0,title:(0,C.jsx)(P.FormattedMessage,{id:"database.buttonProperty.label",defaultMessage:"Label"}),children:(0,C.jsx)(po.ZP,{disabled:!d.canConfigureCollection,placeholder:So.default.formatMessage(Dp.inputPlaceholder),value:x,onChange:v})}),(0,C.jsx)(U.Z,{style:{paddingInline:12},children:(0,C.jsx)(Eo.IQ,{areActionsEditable:!0,areTriggersEditable:!1})})]}):null}function Ep(){return(0,C.jsx)("div",{style:{alignItems:"center",display:"flex",justifyContent:"center",minHeight:200,overflow:"hidden"},children:(0,C.jsx)(pe.Z,{})})}var Hp=o(276368)},276368:(e,t,o)=>{o.d(t,{Z:()=>It});var i=o(667294),n=o(800480),r=o(886628),s=o(724405),a=o(974575),l=o(164945),c=o(44643),d=o(709291),u=o(358188),p=o(672495),g=o(566890),m=o(628020),f=o(33311),S=o(80444),y=o(319385),h=o(183357),x=(o(21703),o(745238)),v=o(785893);const C=(0,x.IU)("collectionChartDonutSelected",{viewBox:"0 0 24 24",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{d:"M22.328 13.9022C22.1304 13.9657 21.9195 14 21.7 14H20.7771C20.4098 15.6195 19.6057 17.0728 18.4945 18.2307C16.8557 19.9384 14.5524 21 12 21C7.02944 21 3 16.9706 3 12C3 7.71682 5.99202 4.13247 10 3.22301V2.29999C10 2.08048 10.0343 1.86948 10.0978 1.67186C5.2069 2.56685 1.5 6.85052 1.5 12C1.5 17.799 6.20101 22.5 12 22.5C14.9776 22.5 17.6668 21.2596 19.5768 19.2693C20.9699 17.8176 21.9504 15.965 22.328 13.9022Z",fill:"#C7C6C4"}),(0,v.jsx)("path",{d:"M10 5.86607C7.41679 6.70778 5.55 9.13588 5.55 12C5.55 15.5622 8.43776 18.45 12 18.45C13.7922 18.45 15.4148 17.7181 16.5829 16.5387C17.2814 15.8334 17.8186 14.9669 18.1337 14H17.75C17.3441 14 16.9702 13.8837 16.6561 13.6848C16.4095 14.3661 16.0175 14.9779 15.5171 15.4832C14.6192 16.3898 13.3757 16.95 12 16.95C9.26619 16.95 7.05 14.7338 7.05 12C7.05 9.85773 8.41088 8.03331 10.3153 7.34407C10.1163 7.02989 10 6.65601 10 6.24999V5.86607Z",fill:"#C7C6C4"}),(0,v.jsx)("path",{d:"M12.75 3.03079C17.1223 3.39148 20.6085 6.87768 20.9692 11.25H18.4069C18.0637 8.28709 15.7129 5.93628 12.75 5.59314V3.03079Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.9692 11.25C20.6085 6.87768 17.1223 3.39148 12.75 3.0308L12.75 5.59315C15.7129 5.93628 18.0637 8.28709 18.4069 11.25L20.9692 11.25ZM22.4999 11.9459C22.5021 12.3866 22.146 12.75 21.7 12.75L17.75 12.75C17.3019 12.75 16.9535 12.3866 16.9498 11.9562C16.9265 9.25722 14.7428 7.07349 12.0438 7.05019C11.6134 7.04647 11.25 6.69813 11.25 6.25L11.25 2.3C11.25 1.85404 11.6134 1.49791 12.0541 1.50013C17.8102 1.52919 22.4708 6.18979 22.4999 11.9459Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),b=(0,x.IU)("collectionChartDonutSelectedDark",{viewBox:"0 0 24 24",svg:(0,v.jsxs)("g",{children:[(0,v.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M22.328 13.902A2.049 2.049 0 0121.7 14h-.923a8.978 8.978 0 01-2.283 4.23A9 9 0 1110 3.223v-.922c0-.22.034-.43.098-.628C5.207 2.567 1.5 6.85 1.5 12c0 5.799 4.701 10.5 10.5 10.5 2.978 0 5.667-1.24 7.577-3.23a10.475 10.475 0 002.751-5.368z"}),(0,v.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M10 5.866A6.45 6.45 0 1018.134 14h-.384c-.406 0-.78-.116-1.094-.315A4.953 4.953 0 0112 16.95a4.95 4.95 0 01-1.685-9.606A2.034 2.034 0 0110 6.25v-.384z"}),(0,v.jsx)("path",{fill:"#2383E2",fillOpacity:"0.25",d:"M12.75 3.03a9.002 9.002 0 018.22 8.22h-2.563a6.453 6.453 0 00-5.657-5.657V3.031z"}),(0,v.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M20.97 11.25a9.002 9.002 0 00-8.22-8.22v2.563a6.453 6.453 0 015.657 5.657h2.562zm1.53.696a.8.8 0 01-.8.804h-3.95a.8.8 0 01-.8-.794 4.95 4.95 0 00-4.906-4.906.8.8 0 01-.794-.8V2.3a.8.8 0 01.804-.8c5.756.03 10.417 4.69 10.446 10.446z",clipRule:"evenodd"})]})}),j=(0,x.IU)("collectionChartDonutUnselected",{viewBox:"0 0 24 24",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{d:"M22.328 13.9022C22.1304 13.9657 21.9195 14 21.7 14H20.7771C20.4098 15.6195 19.6057 17.0728 18.4945 18.2307C16.8557 19.9384 14.5524 21 12 21C7.02944 21 3 16.9706 3 12C3 7.71682 5.99202 4.13247 10 3.22301V2.29999C10 2.08048 10.0343 1.86948 10.0978 1.67186C5.2069 2.56685 1.5 6.85052 1.5 12C1.5 17.799 6.20101 22.5 12 22.5C14.9776 22.5 17.6668 21.2596 19.5768 19.2693C20.9699 17.8176 21.9504 15.965 22.328 13.9022Z",fill:"#C7C6C4"}),(0,v.jsx)("path",{d:"M10 5.86607C7.41679 6.70778 5.55 9.13588 5.55 12C5.55 15.5622 8.43776 18.45 12 18.45C13.7922 18.45 15.4148 17.7181 16.5829 16.5387C17.2814 15.8334 17.8186 14.9669 18.1337 14H17.75C17.3441 14 16.9702 13.8837 16.6561 13.6848C16.4095 14.3661 16.0175 14.9779 15.5171 15.4832C14.6192 16.3898 13.3757 16.95 12 16.95C9.26619 16.95 7.05 14.7338 7.05 12C7.05 9.85773 8.41088 8.03331 10.3153 7.34407C10.1163 7.02989 10 6.65601 10 6.24999V5.86607Z",fill:"#C7C6C4"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.9692 11.25C20.6085 6.87768 17.1223 3.39148 12.75 3.0308L12.75 5.59315C15.7129 5.93628 18.0637 8.28709 18.4069 11.25L20.9692 11.25ZM22.4999 11.9459C22.5021 12.3866 22.146 12.75 21.7 12.75L17.75 12.75C17.3019 12.75 16.9535 12.3866 16.9498 11.9562C16.9265 9.25722 14.7428 7.07349 12.0438 7.05019C11.6134 7.04647 11.25 6.69813 11.25 6.25L11.25 2.3C11.25 1.85404 11.6134 1.49791 12.0541 1.50013C17.8102 1.52919 22.4708 6.18979 22.4999 11.9459Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),w=(0,x.IU)("collectionChartDonutUnselectedDark",{viewBox:"0 0 24 24",svg:(0,v.jsxs)("g",{children:[(0,v.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M22.328 13.902A2.049 2.049 0 0121.7 14h-.923a8.978 8.978 0 01-2.283 4.23A9 9 0 1110 3.223v-.922c0-.22.034-.43.098-.628C5.207 2.567 1.5 6.85 1.5 12c0 5.799 4.701 10.5 10.5 10.5 2.978 0 5.667-1.24 7.577-3.23a10.475 10.475 0 002.751-5.368z"}),(0,v.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M10 5.866A6.45 6.45 0 1018.134 14h-.384c-.406 0-.78-.116-1.094-.315A4.953 4.953 0 0112 16.95a4.95 4.95 0 01-1.685-9.606A2.034 2.034 0 0110 6.25v-.384z"}),(0,v.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M20.97 11.25a9.002 9.002 0 00-8.22-8.22v2.563a6.453 6.453 0 015.657 5.657h2.562zm1.53.696a.8.8 0 01-.8.804h-3.95a.8.8 0 01-.8-.794 4.95 4.95 0 00-4.906-4.906.8.8 0 01-.794-.8V2.3a.8.8 0 01.804-.8c5.756.03 10.417 4.69 10.446 10.446z",clipRule:"evenodd"})]})}),M=(0,x.IU)("collectionChartHorizontalBarSelected",{viewBox:"0 0 24 24",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 6L15.25 6V4L4.75 4V6ZM4.045 7.5C3.60594 7.5 3.25 7.14407 3.25 6.705L3.25 3.295C3.25 2.85593 3.60593 2.5 4.045 2.5L15.955 2.5C16.3941 2.5 16.75 2.85593 16.75 3.295V6.705C16.75 7.14407 16.3941 7.5 15.955 7.5L4.045 7.5Z",fill:"#C7C6C4"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 13H11.25V11H4.75V13ZM4.045 14.5C3.60594 14.5 3.25 14.1441 3.25 13.705L3.25 10.295C3.25 9.85593 3.60593 9.5 4.045 9.5H11.955C12.3941 9.5 12.75 9.85593 12.75 10.295V13.705C12.75 14.1441 12.3941 14.5 11.955 14.5H4.045Z",fill:"#C7C6C4"}),(0,v.jsx)("path",{d:"M20.25 20H4.75V18H20.25V20Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 20H20.25V18H4.75V20ZM4.05 21.5C3.60818 21.5 3.25 21.1418 3.25 20.7L3.25 17.3C3.25 16.8582 3.60817 16.5 4.05 16.5H20.95C21.3918 16.5 21.75 16.8582 21.75 17.3V20.7C21.75 21.1418 21.3918 21.5 20.95 21.5H4.05Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),_=(0,x.IU)("collectionChartHorizontalBarSelectedDark",{viewBox:"0 0 24 24",svg:(0,v.jsxs)("g",{children:[(0,v.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M4.75 6h10.5V4H4.75v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h11.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795H4.045zM4.75 13h6.5v-2h-6.5v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h7.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795h-7.91z",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#2383E2",fillOpacity:"0.25",d:"M20.25 20H4.75v-2h15.5v2z"}),(0,v.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M4.75 20h15.5v-2H4.75v2zm-.7 1.5a.8.8 0 01-.8-.8v-3.4a.8.8 0 01.8-.8h16.9a.8.8 0 01.8.8v3.4a.8.8 0 01-.8.8H4.05z",clipRule:"evenodd"})]})}),k=(0,x.IU)("collectionChartHorizontalBarUnselected",{viewBox:"0 0 24 24",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 6L15.25 6V4L4.75 4V6ZM4.045 7.5C3.60594 7.5 3.25 7.14407 3.25 6.705L3.25 3.295C3.25 2.85593 3.60593 2.5 4.045 2.5L15.955 2.5C16.3941 2.5 16.75 2.85593 16.75 3.295V6.705C16.75 7.14407 16.3941 7.5 15.955 7.5L4.045 7.5Z",fill:"#C7C6C4"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 13H11.25V11H4.75V13ZM4.045 14.5C3.60594 14.5 3.25 14.1441 3.25 13.705L3.25 10.295C3.25 9.85593 3.60593 9.5 4.045 9.5H11.955C12.3941 9.5 12.75 9.85593 12.75 10.295V13.705C12.75 14.1441 12.3941 14.5 11.955 14.5H4.045Z",fill:"#C7C6C4"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 20H20.25V18H4.75V20ZM4.05 21.5C3.60818 21.5 3.25 21.1418 3.25 20.7L3.25 17.3C3.25 16.8582 3.60817 16.5 4.05 16.5H20.95C21.3918 16.5 21.75 16.8582 21.75 17.3V20.7C21.75 21.1418 21.3918 21.5 20.95 21.5H4.05Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),V=(0,x.IU)("collectionChartHorizontalBarUnselectedDark",{viewBox:"0 0 24 24",svg:(0,v.jsxs)("g",{children:[(0,v.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M4.75 6h10.5V4H4.75v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h11.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795H4.045zM4.75 13h6.5v-2h-6.5v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h7.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795h-7.91z",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M4.75 20h15.5v-2H4.75v2zm-.7 1.5a.8.8 0 01-.8-.8v-3.4a.8.8 0 01.8-.8h16.9a.8.8 0 01.8.8v3.4a.8.8 0 01-.8.8H4.05z",clipRule:"evenodd"})]})}),T=(0,x.IU)("collectionChartLineSelected",{viewBox:"0 0 24 24",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.25 1.34999C2.66421 1.34999 3 1.68578 3 2.09999V21H21.9C22.3142 21 22.65 21.3358 22.65 21.75C22.65 22.1642 22.3142 22.5 21.9 22.5H2.4C1.90295 22.5 1.5 22.097 1.5 21.6V2.09999C1.5 1.68578 1.83579 1.34999 2.25 1.34999Z",fill:"#C7C6C4"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.282 8.82193C19.9925 9.39441 19.578 10.1448 19.073 10.8721C18.5636 11.606 17.9871 12.2798 17.3833 12.7313C16.7803 13.1822 16.2283 13.3564 15.7165 13.264C15.0386 13.1416 14.7238 12.6188 14.2275 11.6384C14.2133 11.6103 14.1988 11.5816 14.1841 11.5525C13.7578 10.7068 13.1391 9.47987 11.6666 9.21412C10.5932 9.02037 9.62328 9.43236 8.8352 10.0216C8.04796 10.6103 7.36417 11.4307 6.81155 12.2267C6.25441 13.0293 5.80504 13.8446 5.49617 14.4554C4.83609 15.7605 6.1888 16.4095 6.83472 15.1323C7.12425 14.5598 7.5388 13.8095 8.04375 13.0821C8.55321 12.3482 9.12966 11.6744 9.73347 11.2229C10.3364 10.7721 10.8884 10.5979 11.4002 10.6903C12.0781 10.8126 12.393 11.3355 12.8892 12.3158C12.9035 12.344 12.9179 12.3727 12.9326 12.4018C13.359 13.2474 13.9776 14.4744 15.4501 14.7401C16.5236 14.9339 17.4935 14.5219 18.2816 13.9326C19.0688 13.344 19.7526 12.5236 20.3052 11.7275C20.8623 10.925 21.3117 10.1096 21.6206 9.49889C22.2706 8.21371 20.8559 7.68723 20.282 8.82193Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),P=(0,x.IU)("collectionChartLineSelectedDark",{viewBox:"0 0 24 24",svg:(0,v.jsxs)("g",{children:[(0,v.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.25 1.35A.75.75 0 013 2.1V21h18.9a.75.75 0 010 1.5H2.4a.9.9 0 01-.9-.9V2.1a.75.75 0 01.75-.75z",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M20.282 8.822c-.29.572-.704 1.323-1.209 2.05-.51.734-1.086 1.408-1.69 1.86-.603.45-1.155.624-1.666.532-.678-.122-.993-.645-1.49-1.626l-.043-.085c-.426-.846-1.045-2.073-2.517-2.339-1.074-.194-2.044.218-2.832.808-.787.588-1.47 1.409-2.023 2.205a19.077 19.077 0 00-1.316 2.228c-.66 1.306.693 1.955 1.339.677.29-.572.704-1.322 1.209-2.05.51-.734 1.086-1.408 1.69-1.86.602-.45 1.154-.624 1.666-.532.678.123.993.646 1.49 1.626l.043.086c.426.845 1.045 2.072 2.517 2.338 1.074.194 2.044-.218 2.832-.807.787-.589 1.47-1.41 2.023-2.206A19.086 19.086 0 0021.621 9.5c.65-1.285-.765-1.812-1.339-.677z",clipRule:"evenodd"})]})}),I=(0,x.IU)("collectionChartLineUnselected",{viewBox:"0 0 24 24",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.25 1.34999C2.66421 1.34999 3 1.68578 3 2.09999V21H21.9C22.3142 21 22.65 21.3358 22.65 21.75C22.65 22.1642 22.3142 22.5 21.9 22.5H2.4C1.90295 22.5 1.5 22.097 1.5 21.6V2.09999C1.5 1.68578 1.83579 1.34999 2.25 1.34999Z",fill:"#C7C6C4"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.282 8.82193C19.9925 9.39441 19.578 10.1448 19.073 10.8721C18.5636 11.606 17.9871 12.2798 17.3833 12.7313C16.7803 13.1822 16.2283 13.3564 15.7165 13.264C15.0386 13.1416 14.7238 12.6188 14.2275 11.6384C14.2133 11.6103 14.1988 11.5816 14.1841 11.5525C13.7578 10.7068 13.1391 9.47987 11.6666 9.21412C10.5932 9.02038 9.62328 9.43236 8.8352 10.0216C8.04796 10.6103 7.36417 11.4307 6.81155 12.2267C6.25441 13.0293 5.80504 13.8446 5.49617 14.4554C4.83609 15.7605 6.1888 16.4095 6.83472 15.1323C7.12425 14.5598 7.5388 13.8095 8.04375 13.0821C8.55321 12.3482 9.12966 11.6744 9.73347 11.2229C10.3364 10.7721 10.8884 10.5979 11.4002 10.6903C12.0781 10.8126 12.393 11.3355 12.8892 12.3158C12.9035 12.344 12.9179 12.3727 12.9326 12.4018C13.359 13.2474 13.9776 14.4744 15.4501 14.7401C16.5236 14.9339 17.4935 14.5219 18.2816 13.9326C19.0688 13.344 19.7526 12.5236 20.3052 11.7275C20.8623 10.925 21.3117 10.1096 21.6206 9.49889C22.2706 8.21371 20.8559 7.68723 20.282 8.82193Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),F=(0,x.IU)("collectionChartLineUnselectedDark",{viewBox:"0 0 24 24",svg:(0,v.jsxs)("g",{children:[(0,v.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.25 1.35A.75.75 0 013 2.1V21h18.9a.75.75 0 010 1.5H2.4a.9.9 0 01-.9-.9V2.1a.75.75 0 01.75-.75z",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M20.282 8.822c-.29.572-.704 1.323-1.209 2.05-.51.734-1.086 1.408-1.69 1.86-.603.45-1.155.624-1.666.532-.678-.122-.993-.645-1.49-1.626l-.043-.085c-.426-.846-1.045-2.073-2.517-2.339-1.074-.194-2.044.218-2.832.808-.787.588-1.47 1.409-2.023 2.205a19.077 19.077 0 00-1.316 2.228c-.66 1.306.693 1.955 1.339.677.29-.572.704-1.322 1.209-2.05.51-.734 1.086-1.408 1.69-1.86.602-.45 1.154-.624 1.666-.532.678.123.993.646 1.49 1.626l.043.086c.426.845 1.045 2.072 2.517 2.338 1.074.194 2.044-.218 2.832-.807.787-.589 1.47-1.41 2.023-2.206A19.086 19.086 0 0021.621 9.5c.65-1.285-.765-1.812-1.339-.677z",clipRule:"evenodd"})]})}),Z=(0,x.IU)("collectionChartVerticalBarSelected",{viewBox:"0 0 24 24",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.75 9.75V20.25H5.25V9.75H2.75ZM1.25 9.045C1.25 8.60594 1.60593 8.25 2.045 8.25H5.955C6.39407 8.25 6.75 8.60593 6.75 9.045V20.955C6.75 21.3941 6.39407 21.75 5.955 21.75H2.045C1.60593 21.75 1.25 21.3941 1.25 20.955V9.045Z",fill:"#C7C6C4"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.75 13.75V20.25H13.25V13.75H10.75ZM9.25 13.045C9.25 12.6059 9.60593 12.25 10.045 12.25H13.955C14.3941 12.25 14.75 12.6059 14.75 13.045V20.955C14.75 21.3941 14.3941 21.75 13.955 21.75H10.045C9.60593 21.75 9.25 21.3941 9.25 20.955V13.045Z",fill:"#C7C6C4"}),(0,v.jsx)("path",{d:"M18.75 20.25V4.75H21.25V20.25H18.75Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.75 4.75V20.25H21.25V4.75H18.75ZM17.25 4.05C17.25 3.60818 17.6082 3.25 18.05 3.25H21.95C22.3918 3.25 22.75 3.60817 22.75 4.05V20.95C22.75 21.3918 22.3918 21.75 21.95 21.75H18.05C17.6082 21.75 17.25 21.3918 17.25 20.95V4.05Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),A=(0,x.IU)("collectionChartVerticalBarSelectedDark",{viewBox:"0 0 24 24",svg:(0,v.jsxs)("g",{children:[(0,v.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.75 9.75v10.5h2.5V9.75h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v11.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795V9.045zm9.5 4.705v6.5h2.5v-6.5h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v7.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795v-7.91z",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#2383E2",fillOpacity:"0.25",d:"M18.75 20.25V4.75h2.5v15.5h-2.5z"}),(0,v.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M18.75 4.75v15.5h2.5V4.75h-2.5zm-1.5-.7a.8.8 0 01.8-.8h3.9a.8.8 0 01.8.8v16.9a.8.8 0 01-.8.8h-3.9a.8.8 0 01-.8-.8V4.05z",clipRule:"evenodd"})]})}),B=(0,x.IU)("collectionChartVerticalBarUnselected",{viewBox:"0 0 24 24",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.75 9.75V20.25H5.25V9.75H2.75ZM1.25 9.045C1.25 8.60594 1.60593 8.25 2.045 8.25H5.955C6.39407 8.25 6.75 8.60593 6.75 9.045V20.955C6.75 21.3941 6.39407 21.75 5.955 21.75H2.045C1.60593 21.75 1.25 21.3941 1.25 20.955V9.045Z",fill:"#C7C6C4"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.75 13.75V20.25H13.25V13.75H10.75ZM9.25 13.045C9.25 12.6059 9.60593 12.25 10.045 12.25H13.955C14.3941 12.25 14.75 12.6059 14.75 13.045V20.955C14.75 21.3941 14.3941 21.75 13.955 21.75H10.045C9.60593 21.75 9.25 21.3941 9.25 20.955V13.045Z",fill:"#C7C6C4"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.75 4.75V20.25H21.25V4.75H18.75ZM17.25 4.05C17.25 3.60818 17.6082 3.25 18.05 3.25H21.95C22.3918 3.25 22.75 3.60817 22.75 4.05V20.95C22.75 21.3918 22.3918 21.75 21.95 21.75H18.05C17.6082 21.75 17.25 21.3918 17.25 20.95V4.05Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),K=(0,x.IU)("collectionChartVerticalBarUnselectedDark",{viewBox:"0 0 24 24",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.75 9.75v10.5h2.5V9.75h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v11.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795V9.045zm9.5 4.705v6.5h2.5v-6.5h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v7.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795v-7.91z",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M18.75 4.75v15.5h2.5V4.75h-2.5zm-1.5-.7a.8.8 0 01.8-.8h3.9a.8.8 0 01.8.8v16.9a.8.8 0 01-.8.8h-3.9a.8.8 0 01-.8-.8V4.05z",clipRule:"evenodd"})]})});var O=o(401898),L=o(164921),R=o(925130);const D={light:{column:{unselected:B,selected:Z},bar:{unselected:k,selected:M},line:{unselected:I,selected:T},donut:{unselected:j,selected:C}},dark:{column:{unselected:K,selected:A},bar:{unselected:V,selected:_},line:{unselected:F,selected:P},donut:{unselected:w,selected:b}}};function z(e){let{chartConfig:t,disabled:o}=e;const i=(0,n.MO)(),s=(0,r.VK)((()=>{if(!t)return;const e=t.type;if("placeholder"===e)throw new Error("Should not happen");return e}),[t]);return(0,v.jsx)("div",{style:{display:"flex",marginLeft:10,marginRight:10,...i?{marginTop:10}:{}},children:(0,O.Yd)(D.light).map((e=>(0,v.jsx)(N,{chartType:e,currentlySelectedChartType:s,disabled:o},e)))})}function N(e){let{chartType:t,currentlySelectedChartType:o,disabled:r}=e;const a=(0,g.Y$)(),l=(0,n.O7)(),c=(0,n.Fy)(),u=(0,d.useIntl)(),p=(0,s.Fg)(),[m]=(0,R.o$)(),f=(0,s.yK)((e=>({button:{display:"flex",flexDirection:"column",alignItems:"center",flexGrow:0,flexShrink:0,fontSize:11,borderRadius:4,margin:6,padding:6,boxShadow:`0 0 0 1px ${e.regularDividerColor}`,position:"relative",width:"calc(20% - 12px)",height:0,paddingTop:0,paddingBottom:"calc(20% - 12px)",...c.isMobile?{width:50,height:50,paddingBottom:void 0}:{},...c.isPhone?{background:e.popoverBackground}:{}},selectedButton:{...c.isPhone?{background:e.popoverBackground}:{},boxShadow:`0 0 0 2px ${e.blueColor}`},icon:{width:24,height:24,position:"absolute",top:8,...c.isMobile?{width:30,height:30}:{}},moreIcon:{width:18,height:18,position:"absolute",top:12,...c.isMobile?{width:26,height:26}:{},fill:e.lightIconColor}})),[c]),S=(0,i.useCallback)((e=>{const t=a.collectionViewStore(),o=null==t?void 0:t.getChartConfig();t&&o&&(0,h.N8)(e,o,l,t,a)}),[a,l]),y="dark"===p.mode?"dark":"light";let x=D[y][t].unselected(f.icon);return t===o&&(x=D[y][t].selected(f.icon)),(0,v.jsx)(L.Z,{ref:m,style:{...f.button,...t===o&&f.selectedButton},onClick:()=>{S(t)},disabled:r||t===o,disabledFeedback:r,ariaLabel:u.formatMessage(h.NV[t]),children:x},t)}o(757658);var E=o(107289),H=o(247025),U=o(202032),W=o(114714),G=o(180951),$=o(622771);const q=(0,x.IU)("pieChartSliceBy",{viewBox:"0 0 16 16",svg:(0,v.jsx)("path",{d:"M11.9102 12.8223L7.6377 8.65234C7.56934 8.58854 7.52148 8.52246 7.49414 8.4541C7.4668 8.38574 7.45312 8.30371 7.45312 8.20801V2.08301H8.54688V7.36719L13.0312 4.79688L13.585 5.74707L8.99121 8.37207L12.7373 12.0566L11.9102 12.8223ZM7.99316 15.126C7.02702 15.126 6.11784 14.9414 5.26562 14.5723C4.41341 14.2077 3.66146 13.6995 3.00977 13.0479C2.36263 12.3962 1.85449 11.6442 1.48535 10.792C1.11621 9.93978 0.931641 9.0306 0.931641 8.06445C0.931641 7.09831 1.11621 6.18913 1.48535 5.33691C1.85449 4.4847 2.36263 3.73503 3.00977 3.08789C3.66146 2.4362 4.41113 1.92578 5.25879 1.55664C6.111 1.1875 7.02018 1.00293 7.98633 1.00293C8.95703 1.00293 9.86849 1.1875 10.7207 1.55664C11.5729 1.92578 12.3249 2.4362 12.9766 3.08789C13.6283 3.73503 14.1387 4.4847 14.5078 5.33691C14.877 6.18913 15.0615 7.09831 15.0615 8.06445C15.0615 9.0306 14.877 9.93978 14.5078 10.792C14.1387 11.6442 13.6283 12.3962 12.9766 13.0479C12.3249 13.6995 11.5729 14.2077 10.7207 14.5723C9.86849 14.9414 8.95931 15.126 7.99316 15.126ZM7.99316 13.7314C8.78158 13.7314 9.51758 13.5856 10.2012 13.2939C10.8848 13.0023 11.4863 12.5967 12.0059 12.0771C12.5254 11.5576 12.931 10.9561 13.2227 10.2725C13.5143 9.58887 13.6602 8.85286 13.6602 8.06445C13.6602 7.2806 13.5143 6.54688 13.2227 5.86328C12.931 5.17513 12.5254 4.57129 12.0059 4.05176C11.4863 3.53223 10.8825 3.12663 10.1943 2.83496C9.51074 2.54329 8.77474 2.39746 7.98633 2.39746C7.20247 2.39746 6.46647 2.54329 5.77832 2.83496C5.09473 3.12663 4.49544 3.53223 3.98047 4.05176C3.46549 4.57129 3.06217 5.17513 2.77051 5.86328C2.47884 6.54688 2.33301 7.2806 2.33301 8.06445C2.33301 8.85286 2.47884 9.58887 2.77051 10.2725C3.06217 10.9561 3.46549 11.5576 3.98047 12.0771C4.5 12.5967 5.10156 13.0023 5.78516 13.2939C6.47331 13.5856 7.20931 13.7314 7.99316 13.7314Z"})}),Q=(0,x.IU)("pieChartSliceRepresents",{viewBox:"0 0 16 16",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.25 3.39946C3.95441 3.95981 2.25 6.0316 2.25 8.5C2.25 10.2655 3.12025 11.8278 4.46076 12.7815C5.31822 13.3915 6.36539 13.75 7.5 13.75C8.14111 13.75 8.75268 13.6357 9.3173 13.4273C10.9405 12.8284 12.1854 11.4498 12.6005 9.75H8.25C7.14543 9.75 6.25 8.85457 6.25 7.75V3.39946ZM1 8.5C1 5.16337 3.51407 2.41394 6.75126 2.04265C7.16277 1.99546 7.5 2.33578 7.5 2.75V7.75C7.5 8.16421 7.83579 8.5 8.25 8.5H13.25C13.6642 8.5 14.0046 8.837 13.9574 9.24852C13.6742 11.7184 12.0066 13.7674 9.75 14.6C9.0489 14.8587 8.29095 15 7.5 15C6.09723 15 4.79824 14.5556 3.73613 13.8C2.08017 12.6219 1 10.6871 1 8.5Z"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.75 2.39949V6.25H13.6005C13.1378 4.35519 11.6448 2.86215 9.75 2.39949ZM14.9573 6.75126C15.0045 7.16277 14.6642 7.5 14.25 7.5H9.25C8.83579 7.5 8.5 7.16421 8.5 6.75V1.75C8.5 1.33578 8.83723 0.995456 9.24874 1.04265C12.2403 1.38576 14.6142 3.75975 14.9573 6.75126Z"})]})});var X=o(654497),Y=o(653965),J=o(137810),ee=o(108406),te=o(709953),oe=o(210228),ie=o(526388),ne=o(368585),re=o(233312),se=o(825464),ae=o(18533);function le(e){const{title:t,icon:o,aggregationOptions:i,selectedAggregation:n,onChange:s,disabled:a}=e,l=(0,d.useIntl)(),c=(0,g.Y$)(),u=(0,r.VK)((()=>c.databaseType),[c]);if(!n||(0,U.HK)(n)||"unique"===n.aggregator)return null;const p=i.map((e=>{if((0,U.HK)(e))return;return{key:e,title:(0,v.jsx)("span",{style:J.Z.textOverflowStyle,children:(0,h.Hk)({aggregation:e,databaseType:u,intl:l})})}})).filter(O.$K);return(0,v.jsx)(ae.Z,{title:t,icon:o,disabled:a,collectionContextStore:c,selectedKey:n,options:p,onChange:e=>{e&&s(e)}})}const ce=(0,x.IU)("collectionHorizontalSegments",{viewBox:"0 0 16 16",svg:(0,v.jsx)("path",{d:"M8.15967 2.38428L8.15967 13.6362L6.84033 13.6362L6.84033 2.38428L8.15967 2.38428ZM11.6392 1.61865C12.3774 1.61865 12.9357 1.8055 13.314 2.1792C13.6922 2.55745 13.8813 3.11117 13.8813 3.84033L13.8813 12.1597C13.8813 12.8934 13.6922 13.4471 13.314 13.8208C12.9357 14.1945 12.3774 14.3813 11.6392 14.3813L3.36084 14.3813C2.62256 14.3813 2.06429 14.1945 1.68603 13.8208C1.30778 13.4471 1.11865 12.8934 1.11865 12.1597L1.11865 3.84033C1.11865 3.11116 1.30778 2.55745 1.68604 2.1792C2.06429 1.8055 2.62256 1.61865 3.36084 1.61865L11.6392 1.61865ZM11.5571 2.96533L3.44287 2.96533C3.12842 2.96533 2.88688 3.04736 2.71826 3.21143C2.54964 3.37549 2.46533 3.62386 2.46533 3.95654L2.46533 12.0503C2.46533 12.3784 2.54964 12.6245 2.71826 12.7886C2.88688 12.9526 3.12842 13.0347 3.44287 13.0347L11.5571 13.0347C11.8761 13.0347 12.1177 12.9526 12.2817 12.7886C12.4504 12.6245 12.5347 12.3784 12.5347 12.0503L12.5347 3.95654C12.5347 3.62386 12.4504 3.37549 12.2817 3.21143C12.1177 3.04736 11.8761 2.96533 11.5571 2.96533Z"})});var de=o(805149),ue=o(231945),pe=o(177498),ge=o(98742),me=o(61766),fe=o(694166),Se=o(212347);function ye(e){const{title:t,icon:o,iconStyle:i,rightStyle:s,selectedProperty:a,handlePropertySelect:l,isPropertyValid:c,disabled:d,...u}=e,p=(0,g.Y$)(),m=(0,n.Fy)(),f=(0,r.qz)(void 0,me.Z),S=(0,r.Kw)(f),y=(0,r.VK)((()=>p.normalizedSchemaStore.state),[p]),h=a?y[a]:void 0;return(0,v.jsx)(ue.ZP,{buttonPopupStore:f,popupType:m.isMobile?ue.Z4.SlideUp:ue.Z4.Popup,renderOrigin:e=>(0,v.jsx)(fe.Z,{title:t,icon:o,iconStyle:i,showChevron:!0,right:null==h?void 0:h.name,rotateChevron:S.open,disabled:d,rightStyle:s,...(0,ge.Z)(e,u)}),render:e=>(0,v.jsx)(pe.Z,{isRelationProperty:!1,schema:y,onAccept:e=>l(e),onClose:e.close,allowProperty:c,selectedProperty:a}),disabled:d})}function he(e){let{groupBy:t,propertySchema:o,onChange:n,disabled:s}=e;const a=(0,g.Y$)(),l=(0,r.VK)((()=>a.settingsStore),[a]),c=(0,r.VK)((()=>a.normalizedSchemaStore.state),[a]),u=(0,r.VK)((()=>(0,H.PL)(t)),[t]),p=(0,i.useMemo)((()=>(0,Se.cR)({groupBy:t,schema:c})),[c,t]);if(!o)return null;const m=o.type;return(0,H.f3)(o)&&(0,H.h_)(u)?(0,v.jsx)(ae.Z,{title:p,popupStyle:{minWidth:190},selectedKey:u,options:W.z8.map((e=>({key:e,title:(0,Se.Ko)(e)}))),icon:ce,onChange:n,disabled:s}):(0,W.H1)(m)&&(0,H.QJ)(u)?(0,v.jsx)(ae.Z,{title:p,popupStyle:{minWidth:190},selectedKey:u,options:W.vu.map((e=>({key:e,title:(0,Se.D$)(e)}))),icon:ce,onChange:n,disabled:s}):(0,H.Dv)(o)?(0,v.jsx)(fe.Z,{disabled:!0,icon:ce,title:p,showChevron:!0,right:(0,v.jsx)(d.FormattedMessage,{...h.wh.chartXAxisGroupByUnique}),onClick:()=>{de.H4({collectionSettingsStore:l,item:{type:"groupByNumber",groupByKey:"collection_group_by",groupsFormatKey:W.Uh}})}}):null}var xe=o(443261),ve=o.n(xe),Ce=o(12396),be=o(396451),je=o(698519),we=o(552275),Me=o(396525),_e=o(268894),ke=o(478140),Ve=o(632163),Te=o(743765),Pe=o(840721),Ie=o(842782),Fe=o(966603),Ze=o(433929),Ae=o(460709);const Be="search-item",Ke="default",Oe="aggregate",Le="distinct",Re="property-value",De={y_axis_property:[Ke,Re,Oe,Le],donut_slice_property:[Ke,Re,Oe,Le],y_axis_groups:[Ke]};function ze(e){if("none"===e.type||"record_count"===e.type)return e.type;if("property_group"===e.type){const t=e.groupByOption??"undefined",o=e.numberSection??"undefined";return`group:${e.property}-${t}-${o}`}return e.property}function Ne(e){const{collectionContextStore:t,selectedProperty:o,properties:a,callsite:l,handlePropertySelect:c,originProps:u,disabled:g,rightStyle:m,...f}=e,S=(0,n.O7)(),y=(0,n.Fy)(),x=(0,d.useIntl)(),[C,b]=i.useState(""),j=(0,r.qz)(void 0,me.Z),w=(0,r.Kw)(j),M=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t]),_=(0,r.VK)((()=>a.length>Fe.nt),[a.length]),k=(0,r.VK)((()=>{const e=Y.vM(a,(e=>e.sectionName));return De[l].map((t=>{const o=e[t]??[];return[...o.filter((e=>"none"===e.key.type)),...o.filter((e=>"none"!==e.key.type)).sort(((e,t)=>e.name<t.name?-1:e.name>t.name?1:0))]}))}),[a,l]),V=(0,r.VK)((()=>{if(C.length>0){return k.map((e=>ve().filter(C,e,{extract:e=>e.name}).map((e=>{let{original:t}=e;return t}))))}return k}),[C,k]),T=(0,s.yK)((e=>({propertyIcon:{theme:e,fill:e.regularIconColor}})),[]);function P(){if(!o)return(0,v.jsx)(d.FormattedMessage,{...h.s8.none});const e=e=>{for(let t=0;t<e.length;t++){const i=e[t];if(ze(i.key)===ze(o))return i}},t=e(a);if((null==t?void 0:t.sectionName)===Le){const e=x.formatMessage({id:"database.viewSettings.ChartSettingsPropertySearchMenuItem.right",defaultMessage:"Distinct {propertyName}"},{propertyName:null==t?void 0:t.name});return(0,v.jsx)("span",{style:J.Z.textOverflowStyle,children:e})}if(t)return(0,v.jsx)("span",{style:J.Z.textOverflowStyle,children:t.name});const i=(t=>{for(let o=0;o<t.length;o++){const i=t[o];if(i.subMenuItems){const t=e(i.subMenuItems);if(t)return{subMenuItem:t,menuItem:i}}}})(a);if(i){const e=x.formatMessage({id:"database.viewSettings.ChartSettingsPropertySearchMenuItem.subMenuItems.right",defaultMessage:"{propertyName} ({groupByOptionName})"},{propertyName:i.menuItem.name,groupByOptionName:i.subMenuItem.name});return(0,v.jsx)("span",{style:J.Z.textOverflowStyle,children:e})}return(0,v.jsx)(d.FormattedMessage,{...h.s8.none})}function I(e){const{key:t,name:i,subMenuItems:n}=e;let r;if("record_count"===t.type)r=(0,be.k)({width:16,height:16,marginRight:-2});else if("property_group"===t.type||"property_value"===t.type){const e=(0,G.Qm)({schema:M,property:t.property});r=e?(0,v.jsx)(Ce.ZP,{type:e.type,icon:e.icon,size:16,theme:T.propertyIcon.theme,style:{fill:T.propertyIcon.fill}}):void 0}if(n&&n.length>0){const e={key:i,render:(e,t)=>(0,v.jsx)(Ie.Z,{...e,onFocus:t.onFocus,renderOrigin:(e,t)=>(0,v.jsx)(we.Z,{...e,ref:t,title:i,icon:r}),renderExtension:e=>{let o;return o=y.isMobile?{menuType:Ae.og.ActionSheet}:{menuType:Ae.og.Popup,width:200},(0,v.jsx)(ke.Z,{...o,...e,children:(0,v.jsx)(Ve.Z,{type:Ve.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,v.jsx)(p.Z,{...e}),items:Y.oA(null==n?void 0:n.map(I))}],onAccept:t.onAccept})})}}),action:()=>null};return e}const s=o&&ze(o)===ze(t),a={key:i,render:(e,t)=>(0,v.jsx)(we.Z,{...e,title:i,icon:r,right:s?(0,je.k)({width:14,height:14}):void 0}),action:t=>{c(e)}};return a}return(0,v.jsx)(Me.Z,{focused:!1,buttonPopupStore:j,alignmentToOrigin:ue.vR.End,placementToOrigin:ue.pO.Bottom,popupType:y.isMobile?ue.Z4.SlideUp:ue.Z4.Popup,onClose:()=>{b((()=>""))},renderOrigin:e=>(0,v.jsx)(fe.Z,{...(0,ge.Z)(e,f),showChevron:!0,rotateChevron:w.open,icon:u.icon,title:u.title,right:P(),disabled:g,rightStyle:m}),render:e=>{const t=S.device.isMobile?{menuType:Ae.og.Modal,title:u.title,right:(0,v.jsx)(Pe.DoneMenuText,{}),onClickRight:e.close}:{menuType:Ae.og.Popup,width:250,maxHeight:400},o=[];if(_){const e={key:"search",items:[{key:Be,render:(e,t)=>(0,v.jsx)(_e.ZP,{...e,value:C,onChange:e=>{b((()=>e.target.value))},focusInitial:!0,placeholder:x.formatMessage({id:"database.viewSettings.ChartSettingsPropertySearchMenuItem.searchPlaceholder",defaultMessage:"Search properties..."})}),action:e=>{}}],showNoResultMessage:!0,render:e=>(0,v.jsx)(p.Z,{isInput:!0,...e})};o.push(e)}if(V.some((e=>e.length>0)))V.forEach((e=>{if(0===e.length)return;const t=e[0].sectionName,i={key:t,items:e.map(I).filter(O.$K),render:e=>{const o=function(e){if(e===Ke)return;if(e===Oe)return Ze.default.formatMessage(h.wh.chartAggregateSection);if(e===Le)return Ze.default.formatMessage(h.wh.chartDistinctSection);if(e===Re)return Ze.default.formatMessage(h.wh.chartPropertyValueSection);if(e===Re)return Ze.default.formatMessage(h.wh.chartPropertyValueSection);if(e===Re)return Ze.default.formatMessage(h.wh.chartPropertyValueSection)}(t);return(0,v.jsx)(p.Z,{title:o,...e})}};o.push(i)}));else{const e=x.formatMessage(h.wh.noResultsMenuItem),t={key:e,items:[{key:`${e}-item`,action:()=>{},render:e=>(0,v.jsx)(Te.Z,{title:(0,v.jsx)(d.FormattedMessage,{...h.wh.noResultsMenuItem})})}],render:e=>(0,v.jsx)(p.Z,{...e})};o.push(t)}return(0,v.jsx)(ke.Z,{...t,children:(0,v.jsx)(Ve.Z,{initialFocus:0,type:Ve.i.Vertical,sections:o,onAccept:(t,o,i)=>{t.key!==Be&&e.close()}})})}})}function Ee(e){let{chartConfig:t,chartError:o,disabled:l}=e;const c=(0,n.O7)(),u=(0,g.Y$)(),p=(0,s.yK)((e=>({errorIcon:(0,h.FV)(e)})),[]),m=(0,h.kM)(),f=(0,r.VK)((()=>u.collectionViewStore()),[u]),S=(0,r.VK)((()=>u.normalizedSchemaStore.state),[u]),y=(0,r.VK)((()=>null==t?void 0:t.dataConfig),[t]),x=(0,r.VK)((()=>"groups_reducer"===(null==y?void 0:y.type)?y.groupBy.property:"results_reducer"===(null==y?void 0:y.type)?y.nameProperty:void 0),[y]),C=(0,r.VK)((()=>{const e={icon:q};return o&&(0,a.Ib)(o)?{icon:X.t,iconStyle:p.errorIcon}:e}),[o,p.errorIcon]),b=i.useCallback((e=>{if(!t||!f)return;const o=S[e],i=(0,E.ib)({property:e,collectionSchema:S});if(!i)return;const n=Object.keys(S),r="results_reducer"===t.dataConfig.type?t.dataConfig.valueProperty:n.find((e=>{const t=S[e];return Boolean(t&&(0,E._i)(t))})),s=Y.Xh(t);if(o&&(0,E.HT)(o)&&r)s.dataConfig={type:"results_reducer",nameProperty:e,valueProperty:r};else if(i){const e="groups_reducer"===t.dataConfig.type?t.dataConfig.aggregationConfig.aggregation:{aggregator:"count"};s.dataConfig={type:"groups_reducer",groupBy:i,aggregationConfig:{aggregation:e}}}oe.createAndCommit({userAction:"chartSettings.setDonutGroupBy",environment:c,perform:e=>{te.sW({store:f.getFormatStore().getKeyStore("chart_config"),data:s,transaction:e})}}),ee.wd({environment:c,collectionContextStore:u,action:"charts_donut_property",charts_analytics_context:(0,ne.aL)(u)})}),[S,f,c,t,u]);return(0,v.jsx)(ie.Z,{textWrap:!0,placement:se.u.Left,disableTooltip:!o||!(0,a.Ib)(o),renderTooltip:e=>o?(0,v.jsx)("span",{...e,children:(0,re.e)(o)}):null,render:e=>(0,v.jsx)(ye,{...e,...C,title:(0,v.jsx)(d.FormattedMessage,{...h.wh.chartSliceDonutBy}),selectedProperty:x,handlePropertySelect:b,isPropertyValid:W.LG,disabled:l,rightStyle:m.donutSliceRightText})})}function He(e){let{chartConfig:t,disabled:o}=e;const s=(0,n.O7)(),a=(0,g.Y$)(),l=(0,r.VK)((()=>a.collectionViewStore()),[a]),c=(0,r.VK)((()=>a.normalizedSchemaStore.state),[a]),d=(0,r.VK)((()=>null==t?void 0:t.dataConfig),[t]),u=(0,r.VK)((()=>{if("groups_reducer"!==(null==d?void 0:d.type))return;const e=d?d.groupBy.property:void 0;return e&&c?c[e]:void 0}),[d,c],{useDeepEqual:!0}),p=(0,r.VK)((()=>{if("groups_reducer"===(null==d?void 0:d.type))return null==d?void 0:d.groupBy}),[d]),m=i.useCallback((e=>{if(!u||!l||!t)return;if("groups_reducer"!==t.dataConfig.type)return;const o=(0,H.qV)({property:t.dataConfig.groupBy.property,propertySchema:u,groupByOption:e});oe.createAndCommit({userAction:"chartSettings.setDonutGroups",environment:s,perform:e=>{if(o){const i=Y.Xh(t);if("groups_reducer"!==i.dataConfig.type)return;i.dataConfig.groupBy=o,te.sW({store:l.getFormatStore().getKeyStore("chart_config"),data:i,transaction:e}),ee.wd({environment:s,collectionContextStore:a,action:"charts_donut_groups",charts_analytics_context:(0,ne.aL)(a)})}}})}),[u,l,t,s,a]);return p?(0,v.jsx)(he,{groupBy:p,propertySchema:u,onChange:m,disabled:o}):null}function Ue(e){let{chartConfig:t,chartError:o,disabled:l}=e;const c=(0,d.useIntl)(),u=(0,n.O7)(),p=(0,g.Y$)(),m=(0,s.yK)((e=>({errorIcon:{...(0,h.FV)(e),width:18,height:18,marginLeft:4}})),[]),f=(0,h.kM)(),S=(0,r.VK)((()=>p.collectionViewStore()),[p]),y=(0,r.VK)((()=>p.databaseType),[p]),x=(0,r.VK)((()=>p.normalizedSchemaStore.state),[p]),C=(0,r.VK)((()=>null==t?void 0:t.dataConfig),[t]),b=(0,r.VK)((()=>{if(C)if("groups_reducer"===C.type){const e=null==C?void 0:C.aggregationConfig.aggregation;if(!e)return;if((0,U.HK)(e))return{type:"record_count"};if((0,U.pK)(e)){const t=(0,G.Qm)({schema:x,property:e.property});return t&&(0,H.Dv)(t)?"unique"===e.aggregator?{type:"property_group",property:e.property,numberSection:Le}:{type:"property_group",property:e.property,numberSection:Oe}:{type:"property_group",property:e.property}}}else if("results_reducer"===C.type&&C.valueProperty)return{type:"property_value",property:C.valueProperty}}),[x,C]),j=(0,r.VK)((()=>{if(C)return"groups_reducer"===C.type?C.groupBy.property:C.nameProperty}),[C]),w=(0,r.VK)((()=>j?x[j]:void 0),[j,x]),M=(0,r.VK)((()=>{if(!C||!w)return[];const e=[],t=[];(0,O.qP)(x).forEach((o=>{let[i,n]=o;if(!n||i===j)return;(0,E._i)(n)&&(0,E.HT)(w)&&e.push({key:{type:"property_value",property:i},name:n.name,sectionName:Re});switch((0,h.yx)(n)){case"aggregate_and_distinct":{const e={key:{type:"property_group",property:i,numberSection:Oe},name:n.name,sectionName:Oe},o={key:{type:"property_group",property:i,numberSection:Le},name:n.name,sectionName:Le};return t.push(e),void t.push(o)}case"distinct":{const e={key:{type:"property_group",property:i},name:n.name,sectionName:Le};t.push(e)}return;default:return}}));return[{key:{type:"record_count"},name:(0,h.Hk)({aggregation:{aggregator:"count"},databaseType:y,intl:c})||"",sectionName:"default"},...e,...t]}),[C,w,x,y,c,j]),_=(0,r.VK)((()=>o&&(0,a.lY)(o)?()=>(0,X.t)(m.errorIcon):Q),[o,m.errorIcon]),k=i.useCallback((e=>{const{key:o,sectionName:i}=e;if(!S||!t||!j)return;const n=(0,E.ib)({property:j,collectionSchema:x});if(!n)return;const r=Y.Xh(t);if("record_count"===o.type)r.dataConfig={type:"groups_reducer",groupBy:"groups_reducer"===t.dataConfig.type?t.dataConfig.groupBy:n,aggregationConfig:{aggregation:{aggregator:"count"}}};else if("property_group"===o.type){const{property:e}=o;i===Oe?r.dataConfig={type:"groups_reducer",groupBy:"groups_reducer"===t.dataConfig.type?t.dataConfig.groupBy:n,aggregationConfig:{aggregation:{aggregator:"sum",property:e}}}:i===Le&&(r.dataConfig={type:"groups_reducer",groupBy:"groups_reducer"===t.dataConfig.type?t.dataConfig.groupBy:n,aggregationConfig:{aggregation:{aggregator:"unique",property:e}}})}else if("property_value"===o.type){const{property:e}=o;r.dataConfig={type:"results_reducer",nameProperty:j,valueProperty:e}}else(0,O.t1)(o);oe.createAndCommit({userAction:"chartSettings.setXAxis",environment:u,perform:e=>{te.sW({store:S.getFormatStore().getKeyStore("chart_config"),data:r,transaction:e})}}),ee.wd({environment:u,collectionContextStore:p,action:"charts_donut_slice_value",charts_analytics_context:(0,ne.aL)(p)})}),[t,x,S,u,j,p]);return(0,v.jsx)(ie.Z,{textWrap:!0,placement:se.u.Left,disableTooltip:!o||!(0,a.lY)(o),renderTooltip:e=>o?(0,v.jsx)("span",{...e,children:(0,re.e)(o)}):null,render:e=>(0,v.jsx)(Ne,{...e,collectionContextStore:p,selectedProperty:o?void 0:b,properties:M,handlePropertySelect:k,originProps:{title:(0,v.jsx)("span",{style:J.Z.textOverflowStyle,children:(0,v.jsx)(d.FormattedMessage,{...h.wh.chartSliceDonutAggregation})}),icon:_},callsite:"donut_slice_property",disabled:l,rightStyle:f.donutSliceValueRightText})})}function We(e){let{chartConfig:t,chartError:o,disabled:s}=e;const l=(0,n.O7)(),c=(0,g.Y$)(),u=(0,r.VK)((()=>c.collectionViewStore()),[c]),p=(0,r.VK)((()=>c.normalizedSchemaStore.state),[c]),m=(0,r.VK)((()=>{var e,o;if("groups_reducer"===(null==t||null===(e=t.dataConfig)||void 0===e?void 0:e.type))return null==t||null===(o=t.dataConfig)||void 0===o?void 0:o.aggregationConfig.aggregation}),[t]),f=(0,r.VK)((()=>!m||(0,U.HK)(m)?[]:(0,H.II)({collectionSchema:p,property:m.property})),[p,m]),S=(0,r.VK)((()=>{const e=Boolean(o&&(0,a.lY)(o));return s||e}),[s,o]),y=i.useCallback((e=>{u&&t&&oe.createAndCommit({userAction:"chartSettings.setDonutSliceAggregateBy",environment:l,perform:o=>{const i=Y.Xh(t);"groups_reducer"===i.dataConfig.type&&(i.dataConfig.aggregationConfig.aggregation=e,te.sW({store:u.getFormatStore().getKeyStore("chart_config"),data:i,transaction:o}),ee.wd({environment:l,collectionContextStore:c,action:"charts_donut_aggregate_by",charts_analytics_context:(0,ne.aL)(c)}))}})}),[u,t,l,c]);return!m||(0,U.HK)(m)||"unique"===m.aggregator?null:(0,v.jsx)(ie.Z,{textWrap:!0,placement:se.u.Left,disableTooltip:!o||!(0,a.lY)(o),renderTooltip:e=>o?(0,v.jsx)("span",{...e,children:(0,re.e)(o)}):null,render:e=>(0,v.jsx)(le,{...e,title:(0,v.jsx)(d.FormattedMessage,{...h.wh.chartAggregateBy}),icon:()=>(0,$.J)({width:20,height:20,marginLeft:2}),aggregationOptions:f,selectedAggregation:m,onChange:y,disabled:S})})}var Ge=o(675529),$e=o(749085),qe=o(120394),Qe=o(435011),Xe=o(399036),Ye=o(193078);const Je=(0,x.IU)("collectionChartXAxis",{viewBox:"0 0 16 16",svg:(0,v.jsx)("path",{d:"M2.20831 11.2556L2.20782 2.77084C2.20782 2.62501 2.26023 2.49741 2.36505 2.38803C2.47443 2.27866 2.60659 2.22397 2.76154 2.22397C2.91193 2.22397 3.03953 2.27866 3.14435 2.38803C3.25372 2.49741 3.30841 2.62501 3.30841 2.77084L3.3089 10.5104C3.3089 10.638 3.3727 10.7018 3.50031 10.7018H12.3548C12.5052 10.7018 12.6351 10.7542 12.7444 10.8591C12.8538 10.9684 12.9085 11.0983 12.9085 11.2487C12.9085 11.4037 12.8538 11.5335 12.7444 11.6384C12.6351 11.7432 12.5052 11.7956 12.3548 11.7956H2.75519C2.59113 11.7956 2.45896 11.7455 2.3587 11.6452C2.25844 11.5495 2.20831 11.4196 2.20831 11.2556ZM9.40851 9.02458C9.40851 8.91065 9.43813 8.82406 9.49738 8.76482C9.56118 8.70102 9.64093 8.66684 9.73663 8.66228C9.83689 8.65772 9.93943 8.68507 10.0443 8.74431L13.5784 10.8635C13.6696 10.9181 13.7311 10.9911 13.763 11.0822C13.7995 11.1688 13.8017 11.2577 13.7698 11.3488C13.7425 11.4354 13.681 11.5083 13.5853 11.5676L10.0511 13.6867C9.94627 13.7505 9.84373 13.7801 9.74347 13.7756C9.64777 13.771 9.56801 13.7391 9.50421 13.6799C9.44041 13.6161 9.40851 13.5249 9.40851 13.4064V9.02458Z"})});var et=o(348190),tt=o(434709),ot=o(870890),it=o(20130);const nt=(0,d.defineMessages)({alphabetical:{defaultMessage:"{propertyName} A → Z",id:"charts.settings.sort.alphabetical"},reverseAlphabetical:{defaultMessage:"{propertyName} Z → A",id:"charts.settings.sort.reverseAlphabetical"},chronological:{defaultMessage:"Old → New",id:"charts.settings.sort.chronological"},reverseChronological:{defaultMessage:"New → Old",id:"charts.settings.sort.reverseChronological"},lowHigh:{defaultMessage:"{propertyName} Low → High",id:"charts.settings.sort.lowHigh"},highLow:{defaultMessage:"{propertyName} High → Low",id:"charts.settings.sort.highLow"},ascending:{defaultMessage:"{propertyName} Ascending",id:"charts.settings.sort.ascending"},descending:{defaultMessage:"{propertyName} Descending",id:"charts.settings.sort.descending"}});function rt(e,t){const o=null==e?void 0:e.type;if(!o)return t?nt.ascending:nt.descending;if(t)switch(o){case"formula":switch((0,Qe.mm)(e)){case"date":return nt.chronological;case"text":return nt.alphabetical;case"number":return nt.lowHigh;default:return nt.ascending}case"title":case"text":case"url":case"email":case"phone_number":case"relation":case"created_by":case"last_edited_by":return nt.alphabetical;case"date":case"created_time":case"last_edited_time":case"last_visited_time":return nt.chronological;case"number":return nt.lowHigh;default:return nt.ascending}switch(o){case"formula":switch((0,Qe.mm)(e)){case"date":return nt.reverseChronological;case"text":return nt.reverseAlphabetical;case"number":return nt.highLow;default:return nt.descending}case"title":case"text":case"url":case"email":case"phone_number":case"relation":case"created_by":case"last_edited_by":return nt.reverseAlphabetical;case"date":case"created_time":case"last_edited_time":case"last_visited_time":return nt.reverseChronological;case"number":return nt.highLow;default:return nt.descending}}var st=o(304361);function at(e){let{chartConfig:t,chartError:o,disabled:l}=e;const c=(0,n.O7)(),u=(0,g.Y$)(),p=(0,s.yK)((e=>({errorIcon:(0,h.FV)(e)})),[]),m=(0,h.kM)(),f=(0,r.VK)((()=>u.collectionViewStore()),[u]),S=(0,r.VK)((()=>u.normalizedSchemaStore.state),[u]),y=(0,r.VK)((()=>null==t?void 0:t.dataConfig),[t]),x=(0,r.VK)((()=>"groups_reducer"===(null==y?void 0:y.type)?y.groupBy.property:"results_reducer"===(null==y?void 0:y.type)?y.nameProperty:void 0),[y]),C=(0,r.VK)((()=>{const e={icon:Je};return o&&(0,a.Ib)(o)?{icon:X.t,iconStyle:p.errorIcon}:e}),[o,p.errorIcon]),b=i.useCallback((e=>{var o;if(!t||!f)return;const i=S[e],n=(0,E.ib)({property:e,collectionSchema:S});if(!i||!n)return;const r=Object.keys(S),s="results_reducer"===t.dataConfig.type?t.dataConfig.valueProperty:r.find((e=>{const t=S[e];return Boolean(t&&(0,E._i)(t))}));let a=Y.Xh(t);if((0,E.HT)(i)&&s)a=(0,H.T9)({chartConfig:a,xAxisPropertyId:e,newDataConfigType:"results_reducer",valueProperty:s,groupBy:n});else if(n){const t={aggregator:"count"};a=(0,H.T9)({chartConfig:a,xAxisPropertyId:e,newDataConfigType:"groups_reducer",groupBy:n,aggregation:t})}(0,h.$I)({environment:c,collectionContextStore:u,chartConfig:a,sort:null===(o=a.chartFormat)||void 0===o?void 0:o.axisSort}),oe.createAndCommit({userAction:"chartSettings.setXAxis",environment:c,perform:e=>{te.sW({store:f.getFormatStore().getKeyStore("chart_config"),data:a,transaction:e})}}),ee.wd({environment:c,collectionContextStore:u,action:"charts_x_axis_what_to_show",charts_analytics_context:(0,ne.aL)(u)})}),[t,f,S,c,u]);return(0,v.jsx)(ie.Z,{textWrap:!0,placement:se.u.Left,disableTooltip:!o||!(0,a.Ib)(o),renderTooltip:e=>o?(0,v.jsx)("span",{...e,children:(0,re.e)(o)}):null,render:e=>(0,v.jsx)(ye,{...e,...C,title:(0,v.jsx)("span",{style:J.Z.textOverflowStyle,children:(0,v.jsx)(d.FormattedMessage,{...h.wh.chartWhatToShow})}),selectedProperty:x,handlePropertySelect:b,isPropertyValid:W.LG,disabled:l,rightStyle:m.whatToShowRightText})})}function lt(e){let{chartConfig:t,disabled:o}=e;const s=(0,n.O7)(),a=(0,g.Y$)(),l=(0,r.VK)((()=>a.collectionViewStore()),[a]),c=(0,r.VK)((()=>a.normalizedSchemaStore.state),[a]),d=(0,r.VK)((()=>null==t?void 0:t.dataConfig),[t]),u=ut(t,c),p=(0,r.VK)((()=>{if("groups_reducer"===(null==d?void 0:d.type))return null==d?void 0:d.groupBy}),[d]),m=i.useCallback((e=>{var o;if(!u||!l||!t)return;if("groups_reducer"!==(null===(o=t.dataConfig)||void 0===o?void 0:o.type))return;const i=(0,H.qV)({property:t.dataConfig.groupBy.property,propertySchema:u,groupByOption:e});oe.createAndCommit({userAction:"chartSettings.setXAxisGroups",environment:s,perform:e=>{if(i){const o=Y.Xh(t);if("groups_reducer"!==o.dataConfig.type)return;o.dataConfig.groupBy=i,te.sW({store:l.getFormatStore().getKeyStore("chart_config"),data:o,transaction:e}),ee.wd({environment:s,collectionContextStore:a,action:"charts_x_axis_groupBy_option",charts_analytics_context:(0,ne.aL)(a)})}}})}),[u,l,t,s,a]);return p?(0,v.jsx)(he,{groupBy:p,propertySchema:u,onChange:m,disabled:o}):null}function ct(e){let{chartConfig:t,chartError:o,disabled:s}=e;const a=(0,n.O7)(),c=(0,g.Y$)(),u=(0,d.useIntl)(),p=(0,r.VK)((()=>c.collectionViewStore()),[c]),m=(0,r.VK)((()=>c.databaseType),[c]),f=(0,r.VK)((()=>"line"===(null==t?void 0:t.type)),[t]),S=(0,r.VK)((()=>"bar"===(null==t?void 0:t.type)),[t]),y=(0,tt.x)({chartConfig:t,chartError:o,collectionContextStore:c}),x=(0,r.VK)((()=>c.normalizedSchemaStore.state),[c]),C=ut(t,x),b=(0,r.VK)((()=>!C||"formula"!==C.type||(0,H.OY)(C)),[C]),j=(0,r.VK)((()=>{var e,o;if(null!=t&&null!==(e=t.chartFormat)&&void 0!==e&&e.axisSort)return t.chartFormat.axisSort;if("groups_reducer"===(null==t||null===(o=t.dataConfig)||void 0===o?void 0:o.type)){var i;const e=null==t||null===(i=t.dataConfig)||void 0===i?void 0:i.groupBy;return"formula"===e.type?"formula"===(null==C?void 0:C.type)&&(0,H.OY)(C)?(0,H.Kx)(e.groupBy.sort):(0,H.vx)():(0,H.Kx)(e.sort)}return(0,H.vx)()}),[t,C]),w=(0,r.VK)((()=>{const e=null==t?void 0:t.dataConfig;let o;if("groups_reducer"===(null==e?void 0:e.type)?o=e.aggregationConfig.aggregation.property:"results_reducer"===(null==e?void 0:e.type)&&(o=e.valueProperty),o)return(0,G.Qm)({schema:x,property:o})}),[t,x]),M=(0,r.VK)((()=>{var e;if("groups_reducer"===(null==t||null===(e=t.dataConfig)||void 0===e?void 0:e.type)){const e=null==t?void 0:t.dataConfig.aggregationConfig.aggregation;return(0,h.Hk)({aggregation:e,databaseType:m,intl:u})}return null==w?void 0:w.name}),[t,m,u,w]),_=(0,r.VK)((()=>c.currentSortsStore.state.length),[c]),k=(0,r.VK)((()=>c.settingsStore),[c]),V=(0,h.kM)(),T=i.useCallback(((e,o)=>{if(!(p&&t&&(0,l.u)(t)&&C&&b))return;const i=Y.Xh(t);if(i.chartFormat={...i.chartFormat,axisSort:e},"groups_reducer"===i.dataConfig.type&&i.dataConfig.groupBy){const t=i.dataConfig.groupBy;"formula"===t.type?t.groupBy.sort=pt(e):t.sort=pt(e)}(0,h.$I)({environment:a,collectionContextStore:c,chartConfig:i,sort:e}),oe.createAndCommit({userAction:"chartSettings.setXAxisSort",environment:a,perform:e=>{te.sW({store:p.getFormatStore().getKeyStore("chart_config"),data:i,transaction:e})}}),ee.wd({environment:a,collectionContextStore:c,action:"charts_x_axis_sort",charts_analytics_context:(0,ne.aL)(c)}),e!==H.hd.manual&&o&&o.close(),e===H.hd.resultsAdvanced&&(0===_?de.H4({collectionSettingsStore:k,item:{type:"createSort"}}):de.H4({collectionSettingsStore:k,item:{type:"sort"}}))}),[p,t,C,b,a,c,_,k]);if(!b||!C)return null;const P=[];S?(P.push({key:H.hd.xDescending,title:u.formatMessage(rt(C,!0),{propertyName:null==C?void 0:C.name})}),P.push({key:H.hd.xAscending,title:u.formatMessage(rt(C,!1),{propertyName:null==C?void 0:C.name})})):(P.push({key:H.hd.xAscending,title:u.formatMessage(rt(C,!0),{propertyName:null==C?void 0:C.name})}),P.push({key:H.hd.xDescending,title:u.formatMessage(rt(C,!1),{propertyName:null==C?void 0:C.name})}));const I=[];S?(I.push({key:H.hd.yAscending,title:u.formatMessage(nt.highLow,{propertyName:M})}),I.push({key:H.hd.yDescending,title:u.formatMessage(nt.lowHigh,{propertyName:M})})):(I.push({key:H.hd.yAscending,title:u.formatMessage(nt.lowHigh,{propertyName:M})}),I.push({key:H.hd.yDescending,title:u.formatMessage(nt.highLow,{propertyName:M})}));const F=[];return"groups_reducer"===(null==t?void 0:t.dataConfig.type)&&null!=C&&C.type&&(0,h.iT)(C)&&F.push({key:H.hd.manual,title:"Manual"}),C&&(0,Xe.Lt)(C)?F.push(...P):("checkbox"===(null==C?void 0:C.type)||"person"===(null==C?void 0:C.type)||"formula"===(null==C?void 0:C.type)&&("checkbox"===(0,Qe.mm)(C)||"person"===(0,Qe.mm)(C))||F.push(...P),f||F.push(...I)),"results_reducer"===(null==t?void 0:t.dataConfig.type)&&F.push({key:H.hd.resultsAdvanced,title:"Advanced"}),(0,v.jsx)(ae.Z,{title:(0,v.jsx)(d.FormattedMessage,{...h.wh.chartSortBy}),selectedKey:j,options:F,icon:Ye.O,onChange:T,disabled:s,disableParentClose:!0,rightStyle:V.sortByRightText,children:j===H.hd.manual&&y&&(0,v.jsx)(dt,{groupedChartReducer:y})})}function dt(e){let{groupedChartReducer:t}=e;const o=(0,r.VK)((()=>(0,ot.WT)()),[]),i=(0,r.VK)((()=>$e.default.createClass(o,{name:"GroupsLimitStore"})),[o]),n=(0,r.qz)(void 0,i),s=(0,g.Y$)(),a=(0,r.VK)((()=>(0,it.q)()),[]),l=(0,et.Z)({id:qe.FW,reducer:t,collectionContextStore:s,debounceWait:a}),c=(0,Se.Pz)({collectionContextStore:s,groupByKey:"chart_config",groupsFormatKey:"collection_groups",reducerResult:l,groupsLimit:o});return(0,v.jsx)(Se.y3,{collectionContextStore:s,groupsFormatKey:"collection_groups",groupByKey:"chart_config",groupsLimitStore:n,groupsDisplayState:c,disableHideAll:!0,disableLoadMore:!0})}function ut(e,t){const o=(0,r.VK)((()=>null==e?void 0:e.dataConfig),[e]);return(0,r.VK)((()=>{let e;if("groups_reducer"===(null==o?void 0:o.type)?e=o.groupBy.property:"results_reducer"===(null==o?void 0:o.type)&&(e=o.nameProperty),e&&t)return t[e]}),[o,t],{useDeepEqual:!0})}function pt(e){switch(e){case H.hd.manual:return{type:"manual"};case H.hd.xAscending:return{type:"ascending"};case H.hd.xDescending:return{type:"descending"};case H.hd.yAscending:case H.hd.yDescending:default:return{type:"ascending"}}}function gt(e){let{collectionViewStore:t,chartConfig:o,disabled:s}=e;const a=(0,n.O7)(),l=(0,g.Y$)(),u=(0,r.VK)((()=>{var e;return Boolean(null==o||null===(e=o.chartFormat)||void 0===e?void 0:e.axisHideEmptyGroups)}),[o]),p=i.useCallback((()=>{if(!o)return;const e=Y.Xh(o);e.chartFormat={...e.chartFormat,axisHideEmptyGroups:!u},oe.createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,perform:o=>{te.sW({store:t.getFormatStore().getKeyStore("chart_config"),data:e,transaction:o})}}),ee.wd({environment:a,collectionContextStore:l,action:"charts_x_axis_hide_empty_groups",charts_analytics_context:(0,ne.aL)(l)})}),[o,t,a,u,l]);return(0,v.jsx)(st.Z,{title:(0,v.jsx)(d.FormattedMessage,{...h.OV.chartHideEmptyGroups}),switcherProps:{on:u},onClick:p,icon:c.L,iconStyle:{height:20},disabled:s})}var mt=o(717187),ft=o.n(mt);const St=(0,x.IU)("collectionChartCumulative",{viewBox:"0 0 16 16",svg:(0,v.jsxs)("g",{children:[(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.25 8C1.25 7.44772 1.69772 7 2.25 7H3.75C4.30228 7 4.75 7.44772 4.75 8V12C4.75 12.5523 4.30228 13 3.75 13H2.25C1.69772 13 1.25 12.5523 1.25 12V8ZM3.75 8L2.25 8V12H3.75V8Z"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.25 6C6.25 5.44772 6.69772 5 7.25 5H8.75C9.30228 5 9.75 5.44772 9.75 6V12C9.75 12.5523 9.30228 13 8.75 13H7.25C6.69772 13 6.25 12.5523 6.25 12V6ZM8.75 6L7.25 6V12H8.75V6Z"}),(0,v.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.25 4C11.25 3.44772 11.6977 3 12.25 3H13.75C14.3023 3 14.75 3.44772 14.75 4V12C14.75 12.5523 14.3023 13 13.75 13H12.25C11.6977 13 11.25 12.5523 11.25 12V4ZM13.75 4L12.25 4V12H13.75V4Z"})]})}),yt=(0,x.IU)("collectionChartYAxis",{viewBox:"0 0 16 16",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{d:"M4.35184 13.3584L4.35184 4.92715C4.35184 4.77446 4.40671 4.64086 4.51645 4.52634C4.63097 4.41183 4.76935 4.35457 4.93158 4.35457C5.08904 4.35457 5.22264 4.41183 5.33239 4.52634C5.4469 4.64086 5.50416 4.77446 5.50416 4.92715V12.5783C5.50416 12.7119 5.57096 12.7787 5.70456 12.7787L13.1625 12.7792C13.3199 12.7792 13.4559 12.8341 13.5704 12.9438C13.6849 13.0583 13.7422 13.1943 13.7422 13.3518C13.7422 13.514 13.6849 13.65 13.5704 13.7598C13.4559 13.8695 13.3199 13.9244 13.1625 13.9244L4.92442 13.9239C4.75265 13.9239 4.61427 13.8714 4.5093 13.7664C4.40432 13.6662 4.35184 13.5302 4.35184 13.3584Z"}),(0,v.jsx)("path",{d:"M2.36568 6.57231C2.42771 6.63434 2.51837 6.66535 2.63766 6.66535L7.22548 6.66535C7.34954 6.66535 7.44497 6.63195 7.51177 6.56515C7.5738 6.49835 7.6072 6.41485 7.61197 6.31464C7.61674 6.20967 7.58573 6.10231 7.51893 5.99257L5.30017 2.29225C5.23814 2.19205 5.1618 2.12763 5.07114 2.099C4.97571 2.0656 4.88266 2.06799 4.792 2.10616C4.69657 2.13956 4.62023 2.20398 4.56297 2.29941L2.34421 5.99972C2.28218 6.10947 2.25355 6.21683 2.25832 6.3218C2.2631 6.422 2.29888 6.50551 2.36568 6.57231Z"})]})});var ht=o(638387),xt=o(82902);function vt(e){let{chartConfig:t,chartError:o,disabled:l}=e;const c=(0,d.useIntl)(),u=(0,n.O7)(),p=(0,g.Y$)(),m=(0,s.yK)((e=>({errorIcon:{...(0,h.FV)(e),width:18,height:18,marginLeft:4}})),[]),f=(0,h.kM)(),S=(0,r.VK)((()=>p.collectionViewStore()),[p]),y=(0,r.VK)((()=>p.databaseType),[p]),x=(0,r.VK)((()=>p.normalizedSchemaStore.state),[p]),C=(0,r.VK)((()=>null==t?void 0:t.dataConfig),[t]),b=(0,r.VK)((()=>{if(C)return"groups_reducer"===C.type?C.groupBy.property:C.nameProperty}),[C]),j=(0,r.VK)((()=>b?(0,G.Qm)({schema:x,property:b}):void 0),[b,x]),w=(0,r.VK)((()=>{if(C)if("groups_reducer"===C.type){const e=C.aggregationConfig.aggregation;if((0,U.HK)(e))return{type:"record_count"};if((0,U.pK)(e)){const t=(0,G.Qm)({schema:x,property:e.property});return t&&(0,H.Dv)(t)?"unique"===e.aggregator?{type:"property_group",property:e.property,numberSection:Le}:{type:"property_group",property:e.property,numberSection:Oe}:{type:"property_group",property:e.property}}}else if("results_reducer"===C.type&&C.valueProperty)return{type:"property_value",property:C.valueProperty}}),[x,C]),M=(0,r.VK)((()=>{if(!C||!j)return[];const e=(0,O.qP)(x),t=[],o=[];e.forEach((e=>{let[i,n]=e;if(!n||i===b)return;(0,E._i)(n)&&(0,E.HT)(j)&&t.push({key:{type:"property_value",property:i},name:n.name,sectionName:Re});switch((0,h.yx)(n)){case"aggregate_and_distinct":{const e={key:{type:"property_group",property:i,numberSection:Oe},name:n.name,sectionName:Oe},t={key:{type:"property_group",property:i,numberSection:Le},name:n.name,sectionName:Le};return o.push(e),void o.push(t)}case"distinct":{const e={key:{type:"property_group",property:i},name:n.name,sectionName:Le};o.push(e)}return;default:return}}));return[{key:{type:"record_count"},name:(0,h.Hk)({aggregation:{aggregator:"count"},databaseType:y,intl:c})||"",sectionName:"default"},...t,...o]}),[C,j,x,y,c,b]),_=(0,r.VK)((()=>o&&(0,a.lY)(o)?()=>(0,X.t)(m.errorIcon):yt),[o,m.errorIcon]),k=i.useCallback((e=>{var o;const{key:i,sectionName:n}=e;if(!S||!t||!b)return;let r=Y.Xh(t);if("property_value"===i.type){const e=(0,E.ib)({property:b,collectionSchema:x});if(!e)return;r=(0,H.T9)({chartConfig:r,xAxisPropertyId:b,newDataConfigType:"results_reducer",valueProperty:i.property,groupBy:e})}else{const e="groups_reducer"===r.dataConfig.type?r.dataConfig.groupBy:(0,E.ib)({property:b,collectionSchema:x});if(!e)return;let t;if("record_count"===i.type?t={aggregator:"count"}:"property_group"===i.type&&(n===Oe?t={aggregator:"sum",property:i.property}:n===Le&&(t={aggregator:"unique",property:i.property})),!t)return;r=(0,H.T9)({chartConfig:r,xAxisPropertyId:b,newDataConfigType:"groups_reducer",groupBy:e,aggregation:t})}(0,h.$I)({environment:u,collectionContextStore:p,chartConfig:r,sort:null===(o=r.chartFormat)||void 0===o?void 0:o.axisSort}),oe.createAndCommit({userAction:"chartSettings.setYAxis",environment:u,perform:e=>{r&&S&&te.sW({store:S.getFormatStore().getKeyStore("chart_config"),data:r,transaction:e})}}),ee.wd({environment:u,collectionContextStore:p,action:"charts_y_axis_what_to_show",charts_analytics_context:(0,ne.aL)(p)})}),[t,p,x,S,u,b]);return(0,v.jsx)(ie.Z,{textWrap:!0,placement:se.u.Left,disableTooltip:!o||!(0,a.lY)(o),renderTooltip:e=>o?(0,v.jsx)("span",{...e,children:(0,re.e)(o)}):null,render:e=>(0,v.jsx)(Ne,{...e,collectionContextStore:p,selectedProperty:o&&!(0,a.se)(o)?void 0:w,properties:M,handlePropertySelect:k,originProps:{title:(0,v.jsx)("span",{children:(0,v.jsx)(d.FormattedMessage,{...h.wh.chartWhatToShow})}),icon:_},callsite:"y_axis_property",disabled:l,rightStyle:f.whatToShowRightText})})}function Ct(e){let{chartConfig:t,chartError:o,disabled:s}=e;const l=(0,n.O7)(),c=(0,g.Y$)(),u=(0,r.VK)((()=>c.collectionViewStore()),[c]),p=(0,r.VK)((()=>c.normalizedSchemaStore.state),[c]),m=(0,r.VK)((()=>{var e;if("groups_reducer"===(null==t||null===(e=t.dataConfig)||void 0===e?void 0:e.type))return t.dataConfig.aggregationConfig}),[t]),f=(0,r.VK)((()=>!m||(0,U.HK)(m.aggregation)?[]:(0,H.II)({collectionSchema:p,property:m.aggregation.property})),[p,m]),S=null==m?void 0:m.aggregation,y=(0,r.VK)((()=>{const e=Boolean(o&&(0,a.lY)(o));return s||e}),[s,o]),x=i.useCallback((e=>{u&&t&&oe.createAndCommit({userAction:"chartSettings.setYAxis",environment:l,perform:o=>{var i;const n=Y.Xh(t);"groups_reducer"===(null==n||null===(i=n.dataConfig)||void 0===i?void 0:i.type)&&(n.dataConfig.aggregationConfig.aggregation=e,te.sW({store:u.getFormatStore().getKeyStore("chart_config"),data:n,transaction:o}),ee.wd({environment:l,collectionContextStore:c,action:"charts_y_axis_aggregate_by",charts_analytics_context:(0,ne.aL)(c)}))}})}),[l,t,u,c]);return!S||(0,U.HK)(S)||"unique"===S.aggregator?null:(0,v.jsx)(le,{...ft(),title:(0,v.jsx)(d.FormattedMessage,{...h.wh.chartAggregateBy}),icon:()=>(0,$.J)({width:20,height:20,marginLeft:2}),aggregationOptions:f,selectedAggregation:S,onChange:x,disabled:y})}function bt(e){let{chartConfig:t,chartError:o,disabled:l}=e;const c=(0,d.useIntl)(),u=(0,n.O7)(),p=(0,g.Y$)(),m=(0,s.yK)((e=>({errorIcon:{...(0,h.FV)(e),width:18,height:18,marginLeft:4}})),[]),f=(0,h.kM)(),S=(0,r.VK)((()=>p.normalizedSchemaStore.state),[p.normalizedSchemaStore]),y=(0,r.VK)((()=>p.collectionViewStore()),[p]),x=(0,r.VK)((()=>{var e,o,i,n,r;if(!t||"groups_reducer"!==(null===(e=t.dataConfig)||void 0===e?void 0:e.type))return;const s=t.dataConfig.aggregationConfig,a="formula"===(null===(o=s.stackOptions)||void 0===o?void 0:o.groupBy.type)?null===(i=s.stackOptions)||void 0===i?void 0:i.groupBy.groupBy:null===(n=s.stackOptions)||void 0===n?void 0:n.groupBy,l=null===(r=s.stackOptions)||void 0===r?void 0:r.groupBy.property;return a&&l?(0,W.TD)(a)||(0,W.ib)(a)?{type:"property_group",property:l,groupByOption:a.groupBy}:{type:"property_group",property:l}:{type:"none"}}),[t]),C=(0,r.VK)((()=>{const e=Object.keys(S),t=[],o={key:{type:"none"},name:Ze.default.formatMessage(h.wh.noneMenuItem),sectionName:Ke};return t.push(o),e.forEach((e=>{const o=(0,G.Qm)({schema:S,property:e});if(o)if((0,W.H1)(o.type))t.push({key:{type:"property_group",property:e},name:o.name,sectionName:Ke,subMenuItems:W.vu.map((t=>({key:{type:"property_group",property:e,groupByOption:t},name:c.formatMessage(Se.ci[t]),sectionName:Ke})))});else if((0,H.f3)(o))t.push({key:{type:"property_group",property:e},name:o.name,sectionName:Ke,subMenuItems:W.z8.map((t=>({key:{type:"property_group",property:e,groupByOption:t},name:c.formatMessage(Se.aK[t]),sectionName:Ke})))});else{if(!(0,W.LG)(o))return;t.push({key:{type:"property_group",property:e},name:o.name,sectionName:Ke})}})),t}),[S,c]),b=(0,r.VK)((()=>o&&(0,a.C)(o)?()=>(0,X.t)(m.errorIcon):ht.z),[o,m.errorIcon]),j=i.useCallback(((e,o)=>{var i;const n=(0,G.Qm)({schema:S,property:e});if(!y||!n||!t||"groups_reducer"!==(null===(i=t.dataConfig)||void 0===i?void 0:i.type))return;const r=(0,H.qV)({property:e,propertySchema:n,groupByOption:o});if(!r||!(0,W.sM)(r.type))return;const s=Y.Xh(t);if("groups_reducer"!==s.dataConfig.type)return;const a=t.dataConfig.aggregationConfig;s.dataConfig.aggregationConfig={...a,stackOptions:{groupBy:r}},oe.createAndCommit({userAction:"chartSettings.setYAxisStackBy",environment:u,perform:e=>{te.sW({store:y.getFormatStore().getKeyStore("chart_config"),data:s,transaction:e})}}),ee.wd({environment:u,collectionContextStore:p,action:"charts_y_axis_group_by",charts_analytics_context:(0,ne.aL)(p)})}),[S,t,y,u,p]),w=i.useCallback((()=>{var e;if(!t||"groups_reducer"!==(null===(e=t.dataConfig)||void 0===e?void 0:e.type))return;const o=t.dataConfig.aggregationConfig;y&&oe.createAndCommit({userAction:"chartSettings.clearYAxisStackBy",environment:u,perform:e=>{if(o){const i=Y.Xh(t);if("groups_reducer"!==i.dataConfig.type)return;i.dataConfig.aggregationConfig={...o,stackOptions:void 0},te.sW({store:y.getFormatStore().getKeyStore("chart_config"),data:i,transaction:e})}}})}),[y,t,u]),M=i.useCallback((e=>{const{key:t}=e;if("none"===t.type)w();else{const{property:e,groupByOption:o}=t;j(e,o)}}),[w,j]);return(0,v.jsx)(ie.Z,{textWrap:!0,placement:se.u.Left,disableTooltip:!o||!(0,a.C)(o),renderTooltip:e=>o?(0,v.jsx)("span",{...e,children:(0,re.e)(o)}):null,render:e=>(0,v.jsx)(Ne,{...e,collectionContextStore:p,selectedProperty:x,properties:C,handlePropertySelect:M,originProps:{title:(0,v.jsx)("span",{style:J.Z.textOverflowStyle,children:(0,v.jsx)(d.FormattedMessage,{...h.wh.chartGroupBy})}),icon:b},callsite:"y_axis_groups",disabled:l,rightStyle:f.groupByRightText})})}function jt(e){let{chartConfig:t,disabled:o}=e;const s=(0,n.O7)(),a=(0,g.Y$)(),l=(0,r.VK)((()=>a.collectionViewStore()),[a]),c=(0,r.VK)((()=>{var e;return Boolean(null==t||null===(e=t.chartFormat)||void 0===e?void 0:e.axisCumulative)}),[t]),u=(0,i.useCallback)((()=>{var e;if(!l||!t)return;const o=Y.Xh(t),i=null===(e=o.chartFormat)||void 0===e?void 0:e.axisCumulative;o.chartFormat={...o.chartFormat,axisCumulative:!i},oe.createAndCommit({userAction:"chartSettings.setCumulative",environment:s,perform:e=>{te.sW({store:l.getFormatStore().getKeyStore("chart_config"),data:o,transaction:e})}}),ee.wd({environment:s,collectionContextStore:a,action:"charts_y_axis_cumulative",charts_analytics_context:(0,ne.aL)(a)})}),[t,l,s,a]);return i.useEffect((()=>{if(l&&t&&!(0,xt.d)(t)){const e=Y.Xh(t);e.chartFormat={...e.chartFormat,axisCumulative:!1},oe.createAndCommit({userAction:"chartSettings.resetCumulative",environment:s,perform:t=>{te.sW({store:l.getFormatStore().getKeyStore("chart_config"),data:e,transaction:t})}})}}),[t,l,s,o]),t&&!(0,xt.d)(t)?null:(0,v.jsx)(st.Z,{title:(0,v.jsx)(d.FormattedMessage,{...h.wh.chartCumulative}),switcherProps:{on:c},onClick:u,icon:St,iconStyle:{height:18},disabled:o})}o(316354),o(95477);function wt(){(0,s.yK)((e=>({link:{color:e.accentColors.uiBlue[600],fontSize:12}})),[]);return null}var Mt=o(373590),_t=o(261495),kt=o(840814),Vt=o(47567),Tt=o(548323),Pt=o(494582);const It=function(e){let{collectionSettingsStore:t}=e;const o=(0,n.O7)(),i=(0,d.useIntl)(),s=(0,g.Y$)(),x=(0,r.VK)((()=>y.default.checkGate({gateName:"charts_mvp"})),[]),C=(0,r.VK)((()=>y.default.checkGate({gateName:"collections_new_settings_footer"})),[]),b=(0,r.VK)((()=>s.normalizedSchemaStore.state),[s.normalizedSchemaStore]),j=(0,r.VK)((()=>s.collectionViewStore()),[s]),w=(0,r.VK)((()=>s.normalizedFormatStore.state.chart_config),[s.normalizedFormatStore]),M=(0,r.VK)((()=>{const e=(0,a.SO)({chartConfig:w,collectionSchema:b}),t=j?s.chartErrorStore.getState().get(j.id):void 0;return e||t}),[w,s.chartErrorStore,b,j]),_=(0,r.VK)((()=>s.isInHomeWidgetStore.state),[s]),k=(0,r.VK)((()=>{var e;const t=null===(e=s.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!t&&(0,m.qG)(t)}),[s]),V=(0,r.VK)((()=>k?{feature:"tasks",from:"tasks_more_menu"}:{feature:"custom_db",from:"custom_db_more_menu"}),[k]),T=!(0,r.VK)((()=>s.permissionScopesStore.state),[s.permissionScopesStore]).canConfigureBlock,P=Ot(T);return x&&j&&b&&w&&"placeholder"!==w.type?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(p.Z,{children:(0,v.jsx)(_t.$$,{collectionContextStore:s,collectionSettingsStore:t})}),(0,v.jsx)(p.Z,{topBorder:!0,title:i.formatMessage(h.wh.chartType),right:(0,v.jsx)(wt,{}),mobileStyle:{boxShadow:"none"},desktopTitleStyle:P.disabled,mobileTitleStyle:P.disabled,children:(0,v.jsx)(z,{chartConfig:w,disabled:T})}),"donut"===w.type?(0,v.jsx)(Zt,{chartConfig:w,chartError:M,disabled:T}):null,(0,l.u)(w)?"bar"===w.type?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(Bt,{chartConfig:w,chartError:M,disabled:T,useXAxisLabel:!0}),(0,v.jsx)(At,{collectionViewStore:j,chartConfig:w,chartError:M,disabled:T,useYAxisLabel:!0})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(At,{collectionViewStore:j,chartConfig:w,chartError:M,disabled:T}),(0,v.jsx)(Bt,{chartConfig:w,chartError:M,disabled:T})]}):null,(0,v.jsx)(Kt,{collectionContextStore:s}),(0,v.jsx)(Ft,{collectionContextStore:s,collectionSettingsStore:t}),C?(0,v.jsx)(Tt.Z,{collectionContextStore:s,collectionSettingsStore:t}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(p.Z,{topBorder:!0,children:[(0,v.jsx)(kt.z,{collectionContextStore:s,collectionSettingsStore:t}),_&&(0,v.jsx)(fe.Z,{icon:c.L,isPadded:!0,title:i.formatMessage(f.Iu.hide),showChevron:!1,onClick:()=>{S.default.state.currentSpaceViewStore&&u.aG({environment:o,currentSpaceViewStore:S.default.state.currentSpaceViewStore,...V})}})]}),(0,v.jsx)(p.Z,{topBorder:!0,children:(0,v.jsx)(Mt.Z,{href:"",title:(0,v.jsx)(d.FormattedMessage,{...h.wh.chartHelp}),analyticsFrom:"view_settings_charts_help"})})]})]}):null};function Ft(e){const{collectionContextStore:t,collectionSettingsStore:o}=e;return(0,v.jsxs)(p.Z,{topBorder:!0,shouldShowBottomDivider:!0,style:{marginTop:8,marginBottom:8,paddingBottom:0},children:[(0,v.jsx)(Pt.Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,v.jsx)(Vt.Z,{collectionContextStore:t,collectionSettingsStore:o})]})}function Zt(e){var t;const o=Ot(e.disabled);return(0,v.jsxs)(p.Z,{title:(0,v.jsx)(d.FormattedMessage,{...h.wh.chartData}),desktopTitleStyle:o.disabled,mobileTitleStyle:o.disabled,children:[(0,v.jsx)(Ee,{...e}),"groups_reducer"===(null===(t=e.chartConfig)||void 0===t?void 0:t.dataConfig.type)&&(0,v.jsx)(He,{...e}),(0,v.jsx)(Ue,{...e}),(0,v.jsx)(We,{...e})]})}function At(e){const{collectionViewStore:t,useYAxisLabel:o,...i}=e,n=Ot(e.disabled);return(0,v.jsxs)(p.Z,{title:o?(0,v.jsx)(d.FormattedMessage,{...h.wh.chartYAxis}):(0,v.jsx)(d.FormattedMessage,{...h.wh.chartXAxis}),desktopTitleStyle:n.disabled,mobileTitleStyle:n.disabled,children:[(0,v.jsx)(at,{...i}),(0,v.jsx)(lt,{...i}),(0,v.jsx)(ct,{...i}),(0,v.jsx)(gt,{...e})]})}function Bt(e){var t;const{useXAxisLabel:o,disabled:i}=e,n=Ot(i);return(0,v.jsxs)(p.Z,{title:o?(0,v.jsx)(d.FormattedMessage,{...h.wh.chartXAxis}):(0,v.jsx)(d.FormattedMessage,{...h.wh.chartYAxis}),desktopTitleStyle:n.disabled,mobileTitleStyle:n.disabled,children:[(0,v.jsx)(vt,{...e}),(0,v.jsx)(Ct,{...e}),"groups_reducer"!==(null===(t=e.chartConfig)||void 0===t||null===(t=t.dataConfig)||void 0===t?void 0:t.type)?null:(0,v.jsx)(bt,{...e}),(0,v.jsx)(jt,{...e})]})}function Kt(e){let{collectionContextStore:t}=e;const{collectionViewStore:o,chartConfig:i}=(0,r.VK)((()=>{const e=t.collectionViewStore();return{collectionViewStore:e,chartConfig:null==e?void 0:e.getChartConfig()}}),[t]),n=(0,r.VK)((()=>t.permissionScopesStore.state),[t.permissionScopesStore]),s=(0,r.VK)((()=>!i||!n.canConfigureBlock),[i,n.canConfigureBlock]),a=Ot(s);return o&&i&&"placeholder"!==i.type?(0,v.jsxs)(p.Z,{title:(0,v.jsx)(d.FormattedMessage,{...h.wh.chartStyle}),desktopTitleStyle:a.disabled,mobileTitleStyle:a.disabled,children:[(0,v.jsx)(Ge.b,{collectionViewStore:o,chartConfig:i,disabled:s}),(0,v.jsx)(Ge.O,{collectionViewStore:o,chartConfig:i,disabled:s})]}):null}function Ot(e){return(0,s.yK)((()=>({disabled:{opacity:e?.4:void 0}})),[e])}},675529:(e,t,o)=>{o.d(t,{b:()=>W,O:()=>G});o(757658);var i=o(667294),n=o(800480),r=o(886628),s=o(724405),a=o(247025),l=o(164945),c=o(180951),d=o(866196),u=o(745238),p=o(785893);const g=(0,u.IU)("chartGradientArea",{viewBox:"0 0 16 16",svg:(0,p.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5085 2.89074C13.3432 2.05604 14.7705 2.64721 14.7705 3.82766V11.4739C14.7705 12.2057 14.1772 12.7989 13.4455 12.7989H2.52495C1.79317 12.7989 1.19995 12.2057 1.19995 11.4739L1.19995 8.34731C1.19995 7.9959 1.33955 7.65888 1.58804 7.41039L4.65782 4.34061C5.17527 3.82316 6.01421 3.82316 6.53165 4.34061L8.67142 6.48037C8.73976 6.54871 8.85056 6.54871 8.91891 6.48037L12.5085 2.89074ZM13.6205 3.82766C13.6205 3.67175 13.432 3.59367 13.3217 3.70391L9.73208 7.29354C9.21463 7.81099 8.37569 7.81099 7.85824 7.29354L5.71848 5.15378C5.65014 5.08544 5.53933 5.08544 5.47099 5.15378L2.40121 8.22356C2.36839 8.25638 2.34995 8.3009 2.34995 8.34731L2.34995 11.4739C2.34995 11.5706 2.4283 11.6489 2.52495 11.6489H13.4455C13.5421 11.6489 13.6205 11.5706 13.6205 11.4739L13.6205 3.82766Z"})});var m=o(713498);const f=(0,u.IU)("collectionChartColor",{viewBox:"0 0 20 20",svg:(0,p.jsx)("path",{d:"M10.5947 17.0645C9.24121 17.0645 8.01074 16.8981 6.90332 16.5654C5.7959 16.2327 4.83887 15.7588 4.03223 15.1436C3.23014 14.5329 2.61263 13.8037 2.17969 12.9561C1.74674 12.1038 1.53027 11.1582 1.53027 10.1191C1.53027 9.05273 1.75814 8.08203 2.21387 7.20703C2.67415 6.32747 3.32585 5.57096 4.16895 4.9375C5.0166 4.30404 6.02604 3.81641 7.19727 3.47461C8.37305 3.12826 9.67415 2.95508 11.1006 2.95508C12.2035 2.95508 13.2061 3.06901 14.1084 3.29688C15.0107 3.52018 15.7855 3.84147 16.4326 4.26074C17.0843 4.68001 17.5856 5.18132 17.9365 5.76465C18.292 6.34798 18.4697 6.9974 18.4697 7.71289C18.4697 8.19596 18.374 8.61068 18.1826 8.95703C17.9912 9.29883 17.7428 9.59277 17.4375 9.83887C17.1367 10.085 16.8177 10.2969 16.4805 10.4746C16.1432 10.6478 15.8219 10.8073 15.5166 10.9531C15.2158 11.099 14.9697 11.2471 14.7783 11.3975C14.5869 11.5433 14.4912 11.7096 14.4912 11.8965C14.4912 12.097 14.5482 12.277 14.6621 12.4365C14.7806 12.5915 14.9128 12.7533 15.0586 12.9219C15.209 13.0905 15.3411 13.291 15.4551 13.5234C15.5736 13.7513 15.6328 14.0407 15.6328 14.3916C15.6328 14.9202 15.4209 15.3851 14.9971 15.7861C14.5778 16.1872 13.9899 16.4993 13.2334 16.7227C12.4814 16.9505 11.6019 17.0645 10.5947 17.0645ZM10.5947 15.6221C11.6794 15.6221 12.5475 15.4922 13.1992 15.2324C13.8555 14.9727 14.1836 14.6263 14.1836 14.1934C14.1836 13.9837 14.1243 13.7992 14.0059 13.6396C13.8919 13.4756 13.7598 13.3115 13.6094 13.1475C13.459 12.9834 13.3245 12.7988 13.2061 12.5938C13.0921 12.3887 13.0352 12.138 13.0352 11.8418C13.0352 11.4954 13.1309 11.2061 13.3223 10.9736C13.5137 10.7412 13.762 10.5384 14.0674 10.3652C14.3727 10.1921 14.694 10.028 15.0312 9.87305C15.373 9.71354 15.6943 9.54036 15.9951 9.35352C16.3005 9.16667 16.5488 8.94336 16.7402 8.68359C16.9316 8.41927 17.0273 8.0957 17.0273 7.71289C17.0273 7.05208 16.7812 6.47331 16.2891 5.97656C15.8014 5.47526 15.1133 5.08561 14.2246 4.80762C13.3359 4.52962 12.2946 4.39062 11.1006 4.39062C9.87467 4.39062 8.7627 4.52734 7.76465 4.80078C6.7666 5.06966 5.90983 5.45703 5.19434 5.96289C4.47884 6.46875 3.92741 7.07259 3.54004 7.77441C3.15723 8.47624 2.96582 9.25781 2.96582 10.1191C2.96582 10.944 3.14583 11.6937 3.50586 12.3682C3.87044 13.0426 4.3877 13.6237 5.05762 14.1113C5.72754 14.5944 6.52962 14.9658 7.46387 15.2256C8.40267 15.4899 9.44629 15.6221 10.5947 15.6221ZM10.0068 14.0566C9.65592 14.0566 9.33464 13.9701 9.04297 13.7969C8.7513 13.6237 8.5166 13.3913 8.33887 13.0996C8.16569 12.8034 8.0791 12.4775 8.0791 12.1221C8.0791 11.7712 8.16569 11.4499 8.33887 11.1582C8.5166 10.8665 8.7513 10.6341 9.04297 10.4609C9.33464 10.2832 9.65592 10.1943 10.0068 10.1943C10.3623 10.1943 10.6859 10.2832 10.9775 10.4609C11.2692 10.6341 11.5016 10.8665 11.6748 11.1582C11.8525 11.4499 11.9414 11.7712 11.9414 12.1221C11.9414 12.4867 11.8548 12.8148 11.6816 13.1064C11.513 13.3981 11.2806 13.6305 10.9844 13.8037C10.6927 13.9723 10.3669 14.0566 10.0068 14.0566ZM10.0068 13.1611C10.2028 13.1611 10.3783 13.1156 10.5332 13.0244C10.6927 12.9333 10.818 12.8079 10.9092 12.6484C11.0003 12.4889 11.0459 12.3135 11.0459 12.1221C11.0459 11.8988 10.9958 11.7119 10.8955 11.5615C10.7952 11.4111 10.6654 11.2949 10.5059 11.2129C10.3464 11.1309 10.1755 11.0921 9.99316 11.0967C9.81543 11.0967 9.64909 11.14 9.49414 11.2266C9.33919 11.3086 9.21387 11.4248 9.11816 11.5752C9.02246 11.7256 8.97461 11.9079 8.97461 12.1221C8.97461 12.3135 9.02018 12.4889 9.11133 12.6484C9.20703 12.8079 9.33236 12.9333 9.4873 13.0244C9.64225 13.1156 9.81543 13.1611 10.0068 13.1611ZM5.25586 11.042C4.95052 11.042 4.6862 10.9303 4.46289 10.707C4.23958 10.4792 4.12793 10.2103 4.12793 9.90039C4.12793 9.58594 4.23958 9.31934 4.46289 9.10059C4.6862 8.87728 4.95052 8.76562 5.25586 8.76562C5.57031 8.76562 5.83691 8.87728 6.05566 9.10059C6.27441 9.31934 6.38379 9.58594 6.38379 9.90039C6.38379 10.2103 6.27441 10.4792 6.05566 10.707C5.83691 10.9303 5.57031 11.042 5.25586 11.042ZM7.7168 8.875C7.32031 8.875 6.98307 8.73828 6.70508 8.46484C6.43164 8.19141 6.29492 7.85417 6.29492 7.45312C6.29492 7.06576 6.43164 6.73763 6.70508 6.46875C6.98307 6.19531 7.32031 6.05859 7.7168 6.05859C8.10872 6.05859 8.44141 6.19531 8.71484 6.46875C8.99284 6.73763 9.13184 7.06576 9.13184 7.45312C9.13184 7.85417 8.99284 8.19141 8.71484 8.46484C8.44141 8.73828 8.10872 8.875 7.7168 8.875ZM11.1348 7.78809C10.8203 7.78809 10.5492 7.67643 10.3213 7.45312C10.098 7.22982 9.98633 6.96094 9.98633 6.64648C9.98633 6.33203 10.098 6.06315 10.3213 5.83984C10.5492 5.61654 10.8203 5.50488 11.1348 5.50488C11.4492 5.50488 11.7158 5.61654 11.9346 5.83984C12.1579 6.05859 12.2695 6.32747 12.2695 6.64648C12.2695 6.96094 12.1579 7.22982 11.9346 7.45312C11.7158 7.67643 11.4492 7.78809 11.1348 7.78809ZM14.2041 8.21875C13.9489 8.21875 13.7279 8.12988 13.541 7.95215C13.3587 7.76986 13.2676 7.54883 13.2676 7.28906C13.2676 7.03841 13.3587 6.82194 13.541 6.63965C13.7279 6.45736 13.9489 6.36621 14.2041 6.36621C14.4593 6.36621 14.6758 6.45736 14.8535 6.63965C15.0358 6.82194 15.127 7.03841 15.127 7.28906C15.127 7.54883 15.0358 7.76986 14.8535 7.95215C14.6758 8.12988 14.4593 8.21875 14.2041 8.21875Z"})}),S=(0,u.IU)("collectionChartStyle",{viewBox:"0 0 16 16",svg:(0,p.jsx)("path",{d:"M1.8491 15.1243C1.28739 14.5494 1.00437 13.9414 1.00005 13.3001C0.995729 12.6589 1.27011 12.0552 1.82318 11.4892C2.0133 11.2946 2.25527 11.0978 2.54909 10.8988C2.84723 10.6998 3.15833 10.5052 3.4824 10.3151C3.80646 10.1205 4.11325 9.93474 4.40274 9.75785C4.69656 9.58095 4.93637 9.41512 5.12217 9.26034L3.76758 7.88057C3.49536 7.60197 3.35709 7.30567 3.35277 6.99169C3.35277 6.67328 3.48672 6.37698 3.75461 6.1028L4.60367 5.23381C4.87156 4.95963 5.1589 4.82475 5.46568 4.82917C5.77679 4.82917 6.06844 4.96847 6.34066 5.24708L11.4933 10.534C11.7698 10.8126 11.9081 11.1089 11.9081 11.4228C11.9124 11.7324 11.7828 12.0265 11.5192 12.3051L10.6637 13.1807C10.4001 13.4505 10.1128 13.5832 9.80169 13.5787C9.49058 13.5787 9.20109 13.4394 8.93319 13.1608L7.58507 11.7744C7.42952 11.9646 7.26533 12.2078 7.09249 12.5041C6.91966 12.8004 6.73818 13.1166 6.54806 13.4527C6.36226 13.7888 6.17215 14.1072 5.97771 14.4079C5.78759 14.7131 5.59531 14.9629 5.40087 15.1575C4.8478 15.7236 4.258 16.0044 3.63147 15.9999C3.00494 15.9955 2.41082 15.7037 1.8491 15.1243ZM4.79811 6.82585C4.64255 6.98063 4.64255 7.13762 4.79811 7.29683L6.36659 8.89549C6.50053 9.02816 6.56103 9.17852 6.54806 9.34657C6.5351 9.51462 6.45732 9.67603 6.31474 9.83081C6.18943 9.96348 5.97987 10.1161 5.68605 10.2885C5.39223 10.461 5.05952 10.6534 4.68792 10.8656C4.32065 11.0779 3.95553 11.3057 3.59258 11.5489C3.22963 11.7921 2.92068 12.0442 2.66575 12.3051C2.36761 12.6058 2.21854 12.9309 2.21854 13.2802C2.22286 13.6296 2.37625 13.9613 2.67871 14.2752C2.9855 14.5848 3.3074 14.7396 3.64443 14.7396C3.98578 14.744 4.30553 14.5937 4.60367 14.2885C4.86292 14.0276 5.10921 13.7114 5.34254 13.3399C5.58019 12.9684 5.80271 12.5948 6.01011 12.2189C6.21752 11.8385 6.40547 11.5002 6.57399 11.2039C6.74682 10.9032 6.89589 10.6887 7.0212 10.5605C7.17243 10.4101 7.33014 10.3305 7.49434 10.3217C7.65853 10.3084 7.8076 10.3703 7.94155 10.5074L9.49707 12.1061C9.65262 12.2697 9.80601 12.2675 9.95724 12.0995L10.4498 11.5953C10.6011 11.4361 10.6032 11.2791 10.4563 11.1243L5.75086 6.31507C5.68173 6.23989 5.60827 6.20451 5.5305 6.20894C5.45272 6.20894 5.3771 6.24652 5.30365 6.3217L4.79811 6.82585ZM3.62499 14.1094C3.41326 14.1094 3.23179 14.032 3.08055 13.8772C2.92932 13.7225 2.85371 13.5367 2.85371 13.32C2.85371 13.1033 2.92932 12.9176 3.08055 12.7628C3.23179 12.608 3.41326 12.5306 3.62499 12.5306C3.83671 12.5306 4.01819 12.608 4.16942 12.7628C4.32065 12.9176 4.39626 13.1033 4.39626 13.32C4.39626 13.5367 4.32065 13.7225 4.16942 13.8772C4.01819 14.032 3.83671 14.1094 3.62499 14.1094ZM11.3183 11.3233L10.4757 10.4676L13.5284 7.34326C13.6494 7.21944 13.7099 7.08234 13.7099 6.93198C13.7099 6.78163 13.643 6.6379 13.509 6.50081L8.69338 1.57877C8.62857 1.51243 8.56159 1.47705 8.49246 1.47263C8.42765 1.46821 8.36715 1.49032 8.31098 1.53897C8.25913 1.58319 8.22024 1.65616 8.19432 1.75787C8.03877 2.34162 7.90698 2.84134 7.79896 3.25704C7.69094 3.67274 7.57859 4.04642 7.46193 4.3781C7.34527 4.70977 7.1962 5.03702 7.01472 5.35985C6.83756 5.67826 6.59775 6.03646 6.29529 6.43447L5.43976 5.55885C5.64284 5.26698 5.80919 5.01491 5.93882 4.80264C6.07277 4.58594 6.18511 4.37367 6.27585 4.16582C6.36659 3.95355 6.44868 3.71696 6.52214 3.45604C6.59991 3.1907 6.68201 2.8723 6.76843 2.50082C6.85485 2.12492 6.96071 1.66058 7.08601 1.10779C7.15083 0.82034 7.26749 0.588168 7.436 0.411276C7.60452 0.229961 7.79896 0.108347 8.01932 0.0464343C8.24401 -0.0154781 8.47086 -0.0154781 8.69986 0.0464343C8.92887 0.103924 9.13627 0.225538 9.32207 0.411276L14.4164 5.63182C14.8009 6.02983 14.9954 6.44774 14.9997 6.88555C15.0084 7.32336 14.8247 7.73464 14.4488 8.11938L11.3183 11.3233ZM10.2748 7.4494C10.197 7.37422 10.2035 7.29019 10.2943 7.19732C10.6572 6.82585 10.9726 6.419 11.2405 5.97676C11.5128 5.53453 11.6791 5.01933 11.7396 4.43116L13.1655 5.88389C13.0013 6.09617 12.7766 6.31286 12.4914 6.53398C12.2063 6.75067 11.9081 6.94525 11.597 7.11772C11.2902 7.28577 11.0137 7.40517 10.7674 7.47593C10.5254 7.54669 10.3612 7.53784 10.2748 7.4494Z"})});var y=o(396451),h=o(638387),x=o(128495),v=o(484199),C=o(698519),b=o(155159),j=o(709291),w=o(653965),M=o(401898),_=o(108406),k=o(709953),V=o(210228),T=o(552275),P=o(396525),I=o(478140),F=o(632163),Z=o(672495),A=o(824006),B=o(842782),K=o(566890),O=o(740040),L=o(82902),R=o(460709),D=o(223196),z=o(61766),N=o(183357),E=o(694166),H=o(18533),U=o(304361);function W(e){var t;let{collectionViewStore:o,chartConfig:r,disabled:l}=e;const c=(0,n.O7)(),d=(0,K.Y$)(),u=(0,s.Fg)(),g=(0,i.useCallback)((e=>{const t=(0,O.iM)(e,u);return{key:e,title:(0,p.jsx)(j.FormattedMessage,{...N.h5[e]}),caption:t?(0,p.jsx)("div",{style:{display:"flex"},children:null==t?void 0:t.map((e=>(0,p.jsx)("div",{style:{background:e,borderRadius:2,width:12,height:12,marginRight:3,marginTop:1}},e)))}):null,captionInline:!0,captionStyle:{marginLeft:"auto"},inlineSpacerStyle:{display:"none"}}}),[u]),m=(0,i.useMemo)((()=>[a.Gs.map(g),a.Fh.map(g)]),[g]),S=(null===(t=r.chartFormat)||void 0===t?void 0:t.colorTheme)||"auto";return(0,p.jsx)(H.Z,{disabled:l,title:(0,p.jsx)(j.FormattedMessage,{...N.OV.chartColor}),selectedKey:S,sections:m,icon:()=>f({height:20,paddingLeft:2}),hideCheck:!0,onChange:e=>{if(!e)return;const t=(0,w.Xh)(r);t.chartFormat||(t.chartFormat={}),t.chartFormat.colorTheme=e,(0,O.GL)(e)||(t.chartFormat.weightColorValue=!1),V.createAndCommit({userAction:"chartSettings.setChartConfig",environment:c,perform:e=>{k.sW({store:o.getFormatStore().getKeyStore("chart_config"),data:t,transaction:e})}}),_.wd({environment:c,collectionContextStore:d,action:"charts_style_color"})}})}function G(e){const t=(0,r.qz)(void 0,z.Z),o=(0,r.Kw)(t);return(0,p.jsx)(P.Z,{focused:!1,popupType:D.k.Popup,buttonPopupStore:t,renderOrigin:t=>(0,p.jsx)(E.Z,{...t,showChevron:!0,rotateChevron:o.open,title:(0,p.jsx)(j.FormattedMessage,{...N.wh.chartMoreStyle}),icon:S,disabled:e.disabled}),render:t=>(0,p.jsx)($,{parent:t,collectionViewStore:e.collectionViewStore,chartConfig:e.chartConfig,disabled:e.disabled})})}function $(e){const{collectionViewStore:t,chartConfig:o,disabled:i}=e,s=(0,K.Y$)(),d=(0,r.VK)((()=>s.normalizedSchemaStore.state),[s.normalizedSchemaStore]),u=(0,n.O7)(),g=(0,r.VK)((()=>{var e;if((0,l.u)(o))return"groups_reducer"===(null==o||null===(e=o.dataConfig)||void 0===e?void 0:e.type)?(0,c.Qm)({schema:d,property:o.dataConfig.groupBy.property}):void 0}),[o,d]),m=[],f={key:"default",items:[{key:"groupStyle",render:(e,n)=>(0,l.u)(o)&&"groups_reducer"===o.dataConfig.type&&o.dataConfig.aggregationConfig.stackOptions?(0,p.jsx)(q,{menuListItemProps:e,parent:n,collectionViewStore:t,chartConfig:o,disabled:i}):null,action:()=>{}},{key:"gridLine",render:(e,n)=>(0,l.u)(o)?(0,p.jsx)(Q,{menuListItemProps:e,parent:n,collectionViewStore:t,chartConfig:o,disabled:i}):null,action:()=>{}},{key:"axisLabel",render:(e,n)=>(0,l.u)(o)?(0,p.jsx)(Y,{menuListItemProps:e,parent:n,collectionViewStore:t,chartConfig:o,disabled:i}):null,action:()=>{}},{key:"axisAvatarStyle",render:(e,n)=>(0,l.u)(o)&&g&&(0,a.Sw)(g)?(0,p.jsx)(X,{menuListItemProps:e,parent:n,collectionViewStore:t,chartConfig:o,disabled:i}):null,action:()=>{}},{key:"donutValue",render:e=>"donut"!==o.type?null:(0,p.jsx)(te,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:i}),action:()=>{}},{key:"colorByValue",render:e=>{var n;const r=null===(n=o.chartFormat)||void 0===n?void 0:n.colorTheme;return"line"===o.type||!r||r&&!(0,O.GL)(r)?null:(0,p.jsx)(oe,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:i})},action:()=>{}},{key:"areaFill",render:e=>"line"!==o.type?null:(0,p.jsx)(ee,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:i}),action:()=>{}},{key:"legend",render:e=>(0,p.jsx)(ie,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:i}),action:()=>{}},{key:"dataLabels",render:e=>"bar"!==o.type&&"column"!==o.type||!(0,a.Vu)(o)?null:(0,p.jsx)(ne,{...e,collectionViewStore:t,chartConfig:o,disabled:i}),action:()=>{}}],render:e=>(0,p.jsx)(Z.Z,{...e})};m.push(f);const S=u.device.isMobile?{menuType:R.og.ActionSheet}:{menuType:R.og.Popup,width:250,maxHeight:400};return(0,p.jsx)(I.Z,{...S,children:(0,p.jsx)(F.Z,{initialFocus:void 0,type:F.i.Vertical,sections:m,resetFocusOnMouseOut:!0})})}function q(e){const{chartConfig:t,collectionViewStore:o}=e,s=(0,n.O7)(),l=(0,n.Fy)(),c=(0,r.VK)((()=>{var e;const o=null==t||null===(e=t.chartFormat)||void 0===e?void 0:e.axisGroupStyle;return o||a.UJ.normal}),[t]),d=(0,i.useCallback)((e=>{const i=(0,w.Xh)(t);i.chartFormat||(i.chartFormat={axisGroupStyle:a.UJ.normal}),i.chartFormat.axisGroupStyle=e,V.createAndCommit({userAction:"chartSettings.setChartConfig",environment:s,perform:e=>{k.sW({store:o.getFormatStore(),data:{chart_config:i},transaction:e})}})}),[t,o,s]),u=(0,i.useMemo)((()=>(0,M.qP)(N.E4).map((e=>{let[t,o]=e;const i=c===t;return{key:t,render:e=>(0,p.jsx)(T.Z,{...e,title:(0,p.jsx)(j.FormattedMessage,{...o}),right:i?(0,C.k)({width:14,height:14}):void 0}),action:()=>{d(t)}}}))),[c,d]);return(0,p.jsx)(B.Z,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:e=>(0,p.jsx)(E.Z,{...e,showChevron:!0,title:(0,p.jsx)(j.FormattedMessage,{...N.OV.chartGroupStyle}),icon:h.z,right:c?(0,p.jsx)(j.FormattedMessage,{...N.E4[c]}):null}),renderExtension:(t,o)=>{const i=J({title:(0,p.jsx)(j.FormattedMessage,{...N.OV.chartGroupStyle}),device:l,onClickRight:o.close,popupEvents:t});return(0,p.jsx)(I.Z,{...i,children:(0,p.jsx)(F.Z,{type:F.i.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"groupStyles",render:e=>(0,p.jsx)(Z.Z,{...e}),items:u}]})})}})}function Q(e){const t=(0,n.O7)(),o=(0,K.Y$)(),s=(0,n.Fy)(),l=(0,r.VK)((()=>{var t;const o=null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.axisGridLine;return o||"horizontal"}),[e.chartConfig]),c=(0,i.useCallback)((i=>{const n=(0,w.Xh)(e.chartConfig);n.chartFormat||(n.chartFormat={axisGridLine:a.Xm.horizontal}),n.chartFormat.axisGridLine=i,V.createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,perform:t=>{k.sW({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:n,transaction:t})}}),_.wd({environment:t,collectionContextStore:o,action:"charts_style_grid_line"})}),[e.chartConfig,t,e.collectionViewStore,o]),d=(0,i.useMemo)((()=>(0,M.qP)(N.s8).map((e=>{let[t,o]=e;const i=l===t;return{key:t,render:e=>(0,p.jsx)(T.Z,{...e,title:(0,p.jsx)(j.FormattedMessage,{...o}),right:i?(0,C.k)({width:14,height:14}):void 0}),action:()=>{c(t)}}}))),[l,c]);return(0,p.jsx)(B.Z,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,p.jsx)(E.Z,{...t,showChevron:!0,title:(0,p.jsx)(j.FormattedMessage,{...N.OV.chartGridLine}),right:l?(0,p.jsx)(j.FormattedMessage,{...N.s8[l]}):null,icon:m.a,iconStyle:{width:20,height:20,marginLeft:2,marginRight:0},disabled:e.disabled}),renderExtension:(t,o)=>{const i=J({title:(0,p.jsx)(j.FormattedMessage,{...N.OV.chartGridLine}),device:s,onClickRight:o.close,popupEvents:t});return(0,p.jsx)(I.Z,{...i,children:(0,p.jsx)(F.Z,{type:F.i.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"gridStyles",render:e=>(0,p.jsx)(Z.Z,{...e}),items:d}]})})}})}function X(e){const t=(0,n.O7)(),o=(0,n.Fy)(),s=(0,r.VK)((()=>{var t;return(null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.axisAvatar)||a.lr.avatar}),[e.chartConfig]),l=(0,i.useCallback)((o=>{const i=(0,w.Xh)(e.chartConfig);i.chartFormat||(i.chartFormat={axisAvatar:a.lr.avatar}),i.chartFormat.axisAvatar=o,V.createAndCommit({userAction:"chartSettings.updateAxisAvatarFormat",environment:t,perform:t=>{k.sW({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}})}),[e.chartConfig,e.collectionViewStore,t]),c=(0,i.useMemo)((()=>(0,M.qP)(N.oq).map((e=>{let[t,o]=e;const i=s===t;return{key:t,render:e=>(0,p.jsx)(T.Z,{...e,title:(0,p.jsx)(j.FormattedMessage,{...o}),right:i?(0,C.k)({width:14,height:14}):void 0}),action:()=>{l(t)}}}))),[s,l]);return(0,p.jsx)(B.Z,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,p.jsx)(E.Z,{...t,showChevron:!0,title:(0,p.jsx)(j.FormattedMessage,{...N.OV.chartAxisAvatarFormat}),right:s?(0,p.jsx)(j.FormattedMessage,{...N.oq[s]}):null,icon:x.v,iconStyle:{width:20,height:16,marginLeft:2,marginRight:0},disabled:e.disabled}),renderExtension:(t,i)=>{const n=J({title:(0,p.jsx)(j.FormattedMessage,{...N.OV.chartAxisName}),device:o,onClickRight:i.close,popupEvents:t});return(0,p.jsx)(I.Z,{...n,children:(0,p.jsx)(F.Z,{type:F.i.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"avatarStyles",render:e=>(0,p.jsx)(Z.Z,{...e}),items:c}]})})}})}function Y(e){const t=(0,n.O7)(),o=(0,K.Y$)(),s=(0,n.Fy)(),l=(0,r.VK)((()=>{var t;const o=null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.axisLabel;return o||a.Xg.none}),[e.chartConfig]),c=(0,i.useCallback)((i=>{const n=(0,w.Xh)(e.chartConfig);n.chartFormat||(n.chartFormat={axisLabel:a.Xg.none}),n.chartFormat.axisLabel=i,V.createAndCommit({userAction:"chartSettings.updateAxisLabel",environment:t,perform:t=>{k.sW({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:n,transaction:t})}}),_.wd({environment:t,collectionContextStore:o,action:"charts_style_axis_label"})}),[e.chartConfig,e.collectionViewStore,t,o]),u=(0,i.useMemo)((()=>(0,M.qP)(N.li).map((e=>{let[t,o]=e;const i=l===t;return{key:t,render:e=>(0,p.jsx)(T.Z,{...e,title:(0,p.jsx)(j.FormattedMessage,{...o}),right:i?(0,C.k)({width:14,height:14}):void 0}),action:()=>{c(t)}}}))),[l,c]);return(0,p.jsx)(B.Z,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,p.jsx)(E.Z,{...t,showChevron:!0,title:(0,p.jsx)(j.FormattedMessage,{...N.OV.chartAxisName}),right:l?(0,p.jsx)(j.FormattedMessage,{...N.li[l]}):null,icon:d.B,iconStyle:{width:20,height:20,marginLeft:2,marginRight:0},disabled:e.disabled}),renderExtension:(t,o)=>{const i=J({title:(0,p.jsx)(j.FormattedMessage,{...N.OV.chartAxisName}),device:s,onClickRight:o.close,popupEvents:t});return(0,p.jsx)(I.Z,{...i,children:(0,p.jsx)(F.Z,{type:F.i.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"gridStyles",render:e=>(0,p.jsx)(Z.Z,{...e}),items:u}]})})}})}function J(e){return e.device.isMobile?{menuType:R.og.ActionSheet,...e.popupEvents}:{menuType:R.og.Popup,width:200,...e.popupEvents}}function ee(e){const t=(0,n.O7)(),o=(0,K.Y$)(),r=(0,i.useMemo)((()=>{var t;return!(null!==(t=e.chartConfig)&&void 0!==t&&null!==(t=t.chartFormat)&&void 0!==t&&t.hideLineFillArea)}),[e.chartConfig]),s=(0,i.useCallback)((()=>{var i;const n=(0,w.Xh)(e.chartConfig);n.chartFormat||(n.chartFormat={hideLineFillArea:!1}),n.chartFormat.hideLineFillArea=!(null!==(i=e.chartConfig.chartFormat)&&void 0!==i&&i.hideLineFillArea),V.createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,perform:t=>{k.sW({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:n,transaction:t})}}),_.wd({environment:t,collectionContextStore:o,action:"charts_style_area_fill"})}),[t,e.chartConfig,e.collectionViewStore,o]);return(0,p.jsx)(U.Z,{...e.menuListItemProps,title:(0,p.jsx)(j.FormattedMessage,{...N.OV.chartLineFillArea}),showChevron:!1,switcherProps:{on:r},icon:g,onClick:s,disabled:e.disabled})}function te(e){var t;const o=(0,n.O7)(),r=(0,K.Y$)(),{collectionViewStore:s,chartConfig:a,disabled:l}=e,c=(0,i.useMemo)((()=>{var e;return!(null!=a&&null!==(e=a.chartFormat)&&void 0!==e&&e.donutHideValue)}),[null==a||null===(t=a.chartFormat)||void 0===t?void 0:t.donutHideValue]),d=(0,i.useCallback)((()=>{var e;const t=(0,w.Xh)(a);t.chartFormat||(t.chartFormat={donutHideValue:!1}),t.chartFormat.donutHideValue=!(null!==(e=a.chartFormat)&&void 0!==e&&e.donutHideValue),V.createAndCommit({userAction:"chartSettings.setChartConfig",environment:o,perform:e=>{k.sW({store:s.getFormatStore().getKeyStore("chart_config"),data:t,transaction:e})}}),_.wd({environment:o,collectionContextStore:r,action:"charts_style_donut_value"})}),[a,s,o,r]);return(0,p.jsx)(U.Z,{...e.menuListItemProps,title:(0,p.jsx)(j.FormattedMessage,{...N.OV.chartShowDonutValue}),showChevron:!1,switcherProps:{on:c},icon:y.k,onClick:d,disabled:l})}function oe(e){const t=(0,n.O7)(),o=(0,K.Y$)(),s=(0,r.VK)((()=>{var t;return(null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.weightColorValue)??!1}),[e.chartConfig]),a=(0,i.useCallback)((()=>{var i;const n=(0,w.Xh)(e.chartConfig);n.chartFormat||(n.chartFormat={weightColorValue:!1}),n.chartFormat.weightColorValue=!(null!==(i=e.chartConfig.chartFormat)&&void 0!==i&&i.weightColorValue),V.createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,perform:t=>{k.sW({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:n,transaction:t})}}),_.wd({environment:t,collectionContextStore:o,action:"charts_style_weight_color_value"})}),[t,e.chartConfig,e.collectionViewStore,o]);return(0,p.jsx)(U.Z,{...e.menuListItemProps,title:(0,p.jsx)(j.FormattedMessage,{...N.OV.chartWeightColorValue}),showChevron:!1,switcherProps:{on:s},icon:b.J,onClick:a,disabled:e.disabled})}function ie(e){const t=(0,n.O7)(),o=(0,K.Y$)(),s=(0,L.bc)(e.chartConfig),a=(0,r.VK)((()=>{var t;return!(null!==(t=e.chartConfig.chartFormat)&&void 0!==t&&t.hideLegend||s)}),[e.chartConfig,s]),l=(0,i.useCallback)((()=>{var i;const n=(0,w.Xh)(e.chartConfig);n.chartFormat||(n.chartFormat={hideLegend:!1}),n.chartFormat.hideLegend=!(null!==(i=e.chartConfig.chartFormat)&&void 0!==i&&i.hideLegend),V.createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,perform:t=>{k.sW({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:n,transaction:t})}}),_.wd({environment:t,collectionContextStore:o,action:"charts_style_legend_toggle"})}),[t,e.chartConfig,e.collectionViewStore,o]);return s?null:(0,p.jsx)(U.Z,{...e.menuListItemProps,title:(0,p.jsx)(j.FormattedMessage,{...N.OV.chartLegend}),showChevron:!1,switcherProps:{on:a},icon:v.N,onClick:l,disabled:e.disabled})}function ne(e){let{collectionViewStore:t,chartConfig:o,disabled:s}=e;const l=(0,n.O7)(),c=(0,K.Y$)(),d=(0,r.VK)((()=>(0,a.vi)(o)),[o]),u=(0,i.useCallback)((()=>{const e=(0,w.Xh)(o);e.chartFormat||(e.chartFormat={axisShowDataLabels:!0}),e.chartFormat.axisShowDataLabels=!d,V.createAndCommit({userAction:"chartSettings.setChartFormat.dataLabels",environment:l,perform:o=>{k.sW({store:t.getFormatStore().getKeyStore("chart_config"),data:e,transaction:o})}}),_.wd({environment:l,collectionContextStore:c,action:"charts_style_data_labels"})}),[o,t,l,d,c]);return(0,p.jsx)(E.Z,{title:(0,p.jsx)(j.FormattedMessage,{...N.OV.chartDataLabels}),showChevron:!1,right:(0,p.jsx)(A.Z,{on:d,onClick:u,disabled:s}),icon:()=>(0,y.k)({width:24,height:17,marginRight:-2}),onClick:u,disabled:s})}},464155:(e,t,o)=>{o.d(t,{Z:()=>d});o(667294);var i=o(800480),n=o(724405),r=o(841892),s=o(709291),a=o(137810),l=o(132662),c=o(785893);function d(e){const t=(0,s.useIntl)(),o=function(e){const{isMobile:t}=(0,i.Fy)(),o=t?18:14,r=1,s=6,l=20;return(0,n.yK)((t=>({githubContainer:{display:"flex",alignSelf:"center",flexDirection:"column",width:e||"90%",padding:l,border:`${r}px solid ${t.tableDividerColor}`,borderRadius:s,borderBottomRightRadius:4,cursor:"default"},githubPrTitleRow:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:`calc(100% + ${l}px)`,overflow:"hidden"},githubPrTitle:{display:"inline-flex",fontSize:o,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",background:t.whiteButtonBackground,padding:"2px 4px",borderTopLeftRadius:5,borderBottomLeftRadius:5,borderLeft:`2px solid ${t.blueColor}`,borderTop:`2px solid ${t.blueColor}`,borderBottom:`2px solid ${t.blueColor}`,width:"100%"},githubTask:{background:"light"===t.mode?t.accentColors.blue[50]:t.accentColors.blue[400]},githubPrInfoRow:{display:"inline-flex"},githubPrInfoPill:{display:"flex",flexDirection:"row",alignItems:"center",width:"fit-content",padding:"4px 10px",borderRadius:"2em",background:"#238636",flexShrink:0,...a.Z.textOverflowStyle},githubPrInfoOpenText:{color:"white",fontSize:o-2,fontWeight:500},githubPrInfoMergeInto:{display:"inline-flex",alignItems:"center",fontSize:o-2,color:t.lightTextColor,...a.Z.textOverflowStyle},githubPrInfoMain:{padding:"0px 4px",fontFamily:a.Z.baseFontFamily.githubMono,background:t.cardPressedBackground,borderRadius:s,color:t.regularTextColor,verticalAlign:"text-bottom",...a.Z.textOverflowStyle}})),[o,e])}(e.width),d=(0,c.jsx)("div",{id:"github-preview-github-pr-title-row",style:o.githubPrTitleRow,children:(0,c.jsxs)("div",{id:"github-preview-github-pr-title-wrapper",style:o.githubPrTitle,children:[(0,c.jsx)(l.Z,{size:2}),"[",(0,c.jsxs)("div",{id:"github-preview-github-pr-task",style:o.githubTask,children:[e.uniqueIdPrefix||t.formatMessage(u.idPrefix),e.uniqueIdValue?`-${e.uniqueIdValue}`:"-1"]}),"]",(0,c.jsx)(l.Z,{size:2}),t.formatMessage(u.prTitle)]})}),p=(0,c.jsxs)("div",{id:"github-preview-github-pr-info-row",style:o.githubPrInfoRow,children:[(0,c.jsxs)("div",{id:"github-preview-github-open-pr-pill",style:o.githubPrInfoPill,children:[(0,c.jsx)("img",{src:r.Z.images.externalIntegrations.githubPullOpenIconWhitePng,style:{width:16,height:16}}),(0,c.jsx)(l.Z,{size:2}),(0,c.jsx)("div",{style:o.githubPrInfoOpenText,children:t.formatMessage(u.open)})]}),(0,c.jsx)(l.Z,{size:8}),(0,c.jsx)("div",{id:"github-preview-github-merge-into-main",style:o.githubPrInfoMergeInto,children:(0,c.jsxs)("span",{style:o.githubPrInfoMergeInto,children:[t.formatMessage(u.mergeInto),(0,c.jsx)(l.Z,{size:4}),(0,c.jsx)("span",{style:o.githubPrInfoMain,children:t.formatMessage(u.main)})]})})]});return(0,c.jsxs)("div",{id:"github-preview-github-container",style:o.githubContainer,children:[d,(0,c.jsx)(l.Z,{size:12}),p]})}const u=(0,s.defineMessages)({dismissButtonAriaLabel:{defaultMessage:"A button to dismiss the user education preview.",id:"database.viewSettings.githubConfigTab.preview.dismissButtonAriaLabel"},idPrefix:{defaultMessage:"TASK",id:"database.viewSettings.githubConfigTab.preview.idPrefix"},prTitle:{defaultMessage:"GitHub PR Title",id:"database.viewSettings.githubConfigTab.preview.prTitle"},open:{defaultMessage:"Open",id:"database.viewSettings.githubConfigTab.preview.open"},mergeInto:{defaultMessage:"Merge into",id:"database.viewSettings.githubConfigTab.preview.mergeInto"},main:{defaultMessage:"main",id:"database.viewSettings.githubConfigTab.preview.main"}})},467263:(e,t,o)=>{o.d(t,{Z:()=>d});var i=o(667294),n=o(724405),r=o(531701),s=o(526388),a=o(760442),l=o(825464),c=o(785893);function d(e){const{render:t,showImage:o,caption:d,description:u,tooltipImage:p}=e,g=e.tooltipImageScale||1,[m,f]=i.useState(!1),[S,y]=i.useState({width:0,height:0});i.useEffect((()=>{if(p){const e=new Image;e.src=p,e.onload=()=>{y({width:e.width*g,height:e.height*g}),f(!0)}}}),[p,g]);const h=(0,n.yK)((()=>({tooltip:{whiteSpace:"break-spaces"},description:{fontWeight:"normal",color:r.ZP.uiLightGray}})),[]),x=(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{children:d}),u&&(0,c.jsx)("div",{style:h.description,children:u})]});return(0,c.jsx)(s.Z,{placement:l.u.Left,disableTooltip:void 0===d,style:h.tooltip,render:t,renderTooltip:()=>p&&m&&o?(0,c.jsx)(a.Z,{caption:x,imageURL:p,imageWidth:S.width,imageHeight:S.height}):x})}},916694:(e,t,o)=>{o.d(t,{P:()=>l});o(667294);var i=o(724405),n=o(964275),r=o(137810),s=o(164921),a=o(785893);function l(e){const{title:t,icon:o,style:l,children:c,right:d,showCloseButton:u,onClose:p}=e,g=(0,i.Fg)(),m=(0,a.jsx)(s.Z,{onClick:p,style:{display:"flex",alignItems:"center",justifyContent:"center",background:void 0,borderRadius:6,width:16,height:16},children:(0,n.D)({width:14,fill:g.mediumTextColor})});return(0,a.jsxs)("div",{style:{padding:"12px 16px",margin:"4px 12px",fontSize:12,background:g.accentColors.orange[50],borderRadius:6,...l},children:[t&&(0,a.jsxs)("div",{style:{display:"flex",marginBottom:2,alignItems:"center"},children:[o,(0,a.jsx)("div",{style:{fontWeight:r.Z.fontWeight.medium,flexGrow:1,...r.Z.textOverflowStyle},children:t}),u?m:d]}),c]})}},690716:(e,t,o)=>{o.d(t,{Z:()=>d});o(667294);var i=o(800480),n=o(886628),r=o(724405),s=o(698519),a=o(709291),l=(o(401898),o(231945),o(478140),o(672495),o(69872)),c=(o(460709),o(981166),o(694166),o(785893));function d(e){const{menuProps:t,property:o,defaultProperty:r,checkState:s,propertySchema:a,collectionContextStore:d,handleDefaultPropertySelect:p,handlePropertySelect:g,...m}=e,f=((0,i.MO)(),(0,n.VK)((()=>d.permissionScopesStore.state),[d]));return(0,c.jsx)(l.Z,{...t,disabled:!f.canConfigureBlock,propertySchema:a,format:l.L.Name,onClick:()=>p(o),right:(0,c.jsx)(u,{property:o,checkState:o===r,collectionContextStore:d,defaultProperty:void 0})})}function u(e){const{property:t,defaultProperty:o,checkState:l,collectionContextStore:d}=e,u=(0,i.MO)(),p=(0,n.VK)((()=>{var e;return null===(e=d.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()}),[d]),g=(0,r.yK)((e=>({defaultText:{color:e.mediumTextColor,fontSize:12,fontWeight:500,textTransform:"uppercase",marginRight:4}})),[]);return(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("div",{style:{...g.defaultText},children:t===o&&(0,c.jsx)(a.FormattedMessage,{defaultMessage:"Default",id:"database.viewSettings.setViewPropertyDefault.defaultProperty.tag",values:{databaseName:p}})}),l&&(0,c.jsx)("div",{style:{...u?{marginLeft:"auto",marginRight:20,minWidth:0,flexShrink:0}:{marginLeft:"auto",marginRight:12,minWidth:0,flexShrink:0},width:u?16:14,flexShrink:0},children:(0,s.k)()})]})}},261495:(e,t,o)=>{o.d(t,{aA:()=>ft,V4:()=>pt,$$:()=>vt,ZP:()=>lt});o(21703);var i=o(667294),n=o(800480),r=o(886628),s=o(724405),a=o(749085),l=o(371663),c=o(406695),d=o(12589),u=o(380881),p=o(44643),g=o(745238),m=o(785893);const f=(0,g.IU)("groupByHorizontal",{viewBox:"0 0 16 16",svg:(0,m.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H4.86914V13.1094H2.22363ZM6.18164 13.1094V3.02637H9.81152V13.1094H6.18164ZM13.7695 3.02637C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H11.124V3.02637H13.7695Z"})}),S=(0,g.IU)("groupByVertical",{viewBox:"0 0 16 16",svg:(0,m.jsx)("path",{d:"M0.952148 1.83008H15.041C15.3691 1.83008 15.5879 1.59082 15.5879 1.24219C15.5879 0.893555 15.3691 0.647461 15.041 0.647461H0.952148C0.624023 0.647461 0.405273 0.886719 0.405273 1.24219C0.405273 1.59082 0.624023 1.83008 0.952148 1.83008ZM1.875 7.44238H3.2832C4.26758 7.44238 4.75293 6.95703 4.75293 5.94531V4.58496C4.75293 3.57324 4.26758 3.09473 3.2832 3.09473H1.875C0.890625 3.09473 0.405273 3.57324 0.405273 4.58496V5.94531C0.405273 6.95703 0.890625 7.44238 1.875 7.44238ZM7.28906 7.44238H8.69727C9.68164 7.44238 10.167 6.95703 10.167 5.94531V4.58496C10.167 3.57324 9.68164 3.09473 8.69727 3.09473H7.28906C6.30469 3.09473 5.81934 3.57324 5.81934 4.58496V5.94531C5.81934 6.95703 6.30469 7.44238 7.28906 7.44238ZM12.71 7.44238H14.1182C15.1025 7.44238 15.5879 6.95703 15.5879 5.94531V4.58496C15.5879 3.57324 15.1025 3.09473 14.1182 3.09473H12.71C11.7188 3.09473 11.2402 3.57324 11.2402 4.58496V5.94531C11.2402 6.95703 11.7188 7.44238 12.71 7.44238ZM1.88184 6.31445C1.64258 6.31445 1.52637 6.19824 1.52637 5.94531V4.57812C1.52637 4.33887 1.64258 4.21582 1.88184 4.21582H3.26953C3.50879 4.21582 3.625 4.33887 3.625 4.57812V5.94531C3.625 6.19824 3.50879 6.31445 3.26953 6.31445H1.88184ZM7.30273 6.31445C7.05664 6.31445 6.94727 6.19824 6.94727 5.94531V4.57812C6.94727 4.33887 7.05664 4.21582 7.30273 4.21582H8.69043C8.92969 4.21582 9.0459 4.33887 9.0459 4.57812V5.94531C9.0459 6.19824 8.92969 6.31445 8.69043 6.31445H7.30273ZM12.7168 6.31445C12.4775 6.31445 12.3613 6.19824 12.3613 5.94531V4.57812C12.3613 4.33887 12.4775 4.21582 12.7168 4.21582H14.1045C14.3438 4.21582 14.46 4.33887 14.46 4.57812V5.94531C14.46 6.19824 14.3438 6.31445 14.1045 6.31445H12.7168ZM0.952148 9.82812H15.041C15.3691 9.82812 15.5879 9.58887 15.5879 9.24023C15.5879 8.8916 15.3691 8.64551 15.041 8.64551H0.952148C0.624023 8.64551 0.405273 8.88477 0.405273 9.24023C0.405273 9.5957 0.624023 9.82812 0.952148 9.82812ZM1.88184 15.4404H3.29004C4.27441 15.4404 4.75977 14.9619 4.75977 13.9434V12.583C4.75977 11.5713 4.27441 11.0928 3.29004 11.0928H1.88184C0.897461 11.0928 0.412109 11.5713 0.412109 12.583V13.9434C0.412109 14.9619 0.897461 15.4404 1.88184 15.4404ZM7.2959 15.4404H8.7041C9.68848 15.4404 10.1738 14.9619 10.1738 13.9434V12.583C10.1738 11.5713 9.68848 11.0928 8.7041 11.0928H7.2959C6.31152 11.0928 5.82617 11.5713 5.82617 12.583V13.9434C5.82617 14.9619 6.31152 15.4404 7.2959 15.4404ZM12.7168 15.4404H14.1182C15.1094 15.4404 15.5879 14.9619 15.5879 13.9434V12.583C15.5879 11.5713 15.1094 11.0928 14.1182 11.0928H12.7168C11.7256 11.0928 11.2471 11.5713 11.2471 12.583V13.9434C11.2471 14.9619 11.7256 15.4404 12.7168 15.4404ZM1.88867 14.3125C1.64941 14.3125 1.5332 14.1963 1.5332 13.9502V12.583C1.5332 12.3369 1.64941 12.2139 1.88867 12.2139H3.27637C3.51562 12.2139 3.63184 12.3369 3.63184 12.583V13.9502C3.63184 14.1963 3.51562 14.3125 3.27637 14.3125H1.88867ZM7.30957 14.3125C7.06348 14.3125 6.9541 14.1963 6.9541 13.9502V12.583C6.9541 12.3369 7.06348 12.2139 7.30957 12.2139H8.69727C8.93652 12.2139 9.05273 12.3369 9.05273 12.583V13.9502C9.05273 14.1963 8.93652 14.3125 8.69727 14.3125H7.30957ZM12.7236 14.3125C12.4844 14.3125 12.3682 14.1963 12.3682 13.9502V12.583C12.3682 12.3369 12.4844 12.2139 12.7236 12.2139H14.1113C14.3506 12.2139 14.4668 12.3369 14.4668 12.583V13.9502C14.4668 14.1963 14.3506 14.3125 14.1113 14.3125H12.7236Z"})});var y=o(584169);const h=(0,g.IU)("layoutPadded",{viewBox:"0 0 24 24",svg:(0,m.jsx)("path",{d:"M3.94727 11.832H10.2295C11.3574 11.832 11.9248 11.2715 11.9248 10.1504V7.30664C11.9248 6.18555 11.3574 5.625 10.2295 5.625H3.94727C2.81934 5.625 2.25195 6.18555 2.25195 7.30664V10.1504C2.25195 11.2715 2.81934 11.832 3.94727 11.832ZM15.6572 17.5811H20.0459C21.1738 17.5811 21.7412 17.0273 21.7412 15.8994V8.33203C21.7412 7.21094 21.1738 6.65723 20.0459 6.65723H15.6572C14.5361 6.65723 13.9688 7.21094 13.9688 8.33203V15.8994C13.9688 17.0273 14.5361 17.5811 15.6572 17.5811ZM4.11133 10.5469C3.73535 10.5469 3.53711 10.3486 3.53711 9.95898V7.49805C3.53711 7.10156 3.73535 6.91016 4.11133 6.91016H10.0586C10.4414 6.91016 10.6396 7.10156 10.6396 7.49805V9.95898C10.6396 10.3486 10.4414 10.5469 10.0586 10.5469H4.11133ZM15.8213 16.3027C15.4521 16.3027 15.2471 16.1045 15.2471 15.7148V8.52344C15.2471 8.12695 15.4521 7.93555 15.8213 7.93555H19.875C20.2578 7.93555 20.4561 8.12695 20.4561 8.52344V15.7148C20.4561 16.1045 20.2578 16.3027 19.875 16.3027H15.8213ZM5.66309 18.4629H10.9951C12.1162 18.4629 12.6904 17.9092 12.6904 16.7812V14.8535C12.6904 13.7324 12.1162 13.1787 10.9951 13.1787H5.66309C4.53516 13.1787 3.96777 13.7324 3.96777 14.8535V16.7812C3.96777 17.9092 4.53516 18.4629 5.66309 18.4629ZM5.82715 17.1846C5.45117 17.1846 5.25293 16.9863 5.25293 16.5967V15.0449C5.25293 14.6553 5.45117 14.4639 5.82715 14.4639H10.8242C11.2002 14.4639 11.4053 14.6553 11.4053 15.0449V16.5967C11.4053 16.9863 11.2002 17.1846 10.8242 17.1846H5.82715Z"})});var x=o(762208),v=o(612677),C=o(484199),b=o(418442),j=o(814601),w=o(733507),M=o(709291),_=o(401898),k=o(137810),V=o(765328),T=o(108406),P=o(805149),I=o(358188),F=o(210228),Z=o(940663),A=o(710274),B=o(890199),K=o(916694),O=o(164369);function L(e){const{style:t}=e,o=(0,s.Fg)(),i=(0,n.MO)(),r=(0,m.jsx)("div",{style:{marginTop:1},children:(0,B.b)({width:14,marginRight:8,height:void 0})}),a=(0,m.jsx)(O.Z,{style:{color:o.regularTextColor,lineHeight:k.Z.lineHeight.UISmall.desktop},isSmall:!0,children:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"You're a content editor",id:"database.viewSettings.mainTab.contentOnlyEditorPill.title"})});return(0,m.jsx)(K.P,{icon:r,title:a,style:i?{backgroundColor:o.sidebarBackground,boxShadow:o.plainButtonBoxShadow,margin:void 0,borderRadius:void 0,...t}:{background:"rgba(196, 196, 196, 0.13)",margin:"8px 14px",...t},showCloseButton:!1,children:(0,m.jsx)(O.Z,{style:{marginLeft:22},isSmall:!0,isMultiline:!0,children:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"})})})}var R=o(948838),D=o(213148),z=o(356666),N=o(959960),E=o(225888),H=o(547307),U=o(412714),W=o(691851),G=o(460709),$=o(394841),q=o(164921),Q=o(552275),X=o(231945),Y=o(573063),J=o(478140),ee=o(632163),te=o(672495),oe=o(483182);const ie=(0,M.defineMessages)({learn:{id:"CollectionTaskTypeBadge.MoreMenu.LearnMore.title",defaultMessage:"Learn more"}});function ne(e){const t=(0,n.MO)(),o=(0,s.yK)((e=>({homeIcon:{width:13,marginRight:8,...t?{width:16,marginRight:12}:{}},badgeTitle:{color:e.regularTextColor,lineHeight:k.Z.lineHeight.UISmall.desktop,fontWeight:k.Z.fontWeight.regular,fontSize:t?k.Z.fontSize.UIRegular.mobile:k.Z.fontSize.UIRegular.desktop,marginRight:5},badgeStyle:{background:"rgba(196, 196, 196, 0.13)",margin:"8px 14px",padding:"12px 14px"}})),[t]),{collectionContextStore:i}=e,a=(0,N.w)(o.homeIcon),l=(0,r.VK)((()=>i.permissionScopesStore.state.canConfigureCollection),[i]),c=(0,m.jsx)(O.Z,{style:o.badgeTitle,isSmall:!0,children:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"This is a task database",id:"CollectionTaskTypeBadge.title"})});return(0,m.jsx)(K.P,{icon:a,title:c,showCloseButton:!1,right:l?(0,m.jsx)(se,{collectionContextStore:i}):(0,m.jsx)(re,{}),style:o.badgeStyle,children:(0,m.jsx)(O.Z,{style:{marginLeft:t?28:22},isSmall:!0,isMultiline:!0,children:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"See your tasks in Home.",id:"CollectionTaskTypeBadge.description"})})})}function re(){const e=(0,M.useIntl)(),t=(0,n.O7)();return(0,m.jsx)(Y.Z,{icon:y.m,ariaLabel:e.formatMessage(ie.learn),onClick:()=>{E.Fs(t,{from:"view_settings_task_type_badge"}),U.D({environment:t,url:$.su})}})}function se(e){const{collectionContextStore:t}=e,o=(0,n.O7)(),r=(0,n.MO)(),a=(0,M.useIntl)(),l=(0,s.yK)((e=>({buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3,height:24,width:24},threeDotIcon:{width:r?16:12,height:r?16:12,fill:e.mediumIconColor},hideButtonIcon:{height:17,width:17},confirmationModalTitle:{fontWeight:500},confirmationModalDescription:{fontSize:12,display:"flex",textAlign:"center"}})),[r]),c=(0,i.useCallback)((()=>{F.createAndCommit({environment:o,userAction:"CollectionTaskTypeBadge.untypeDatabase",perform:e=>{W.RQ({environment:o,collectionContextStore:t,transaction:e})}})}),[o,t]),d=(0,m.jsx)("span",{style:l.confirmationModalDescription,children:(0,m.jsx)(M.FormattedMessage,{id:"CollectionTaskTypeBadge.MoreMenu.RemoveFromHome.description",defaultMessage:"Tasks from this database will no longer appear in Home or work with Sprints."})}),u=e=>[{key:"removeFromHome",render:e=>(0,m.jsx)(Q.Z,{...e,icon:(0,D.U)(l.hideButtonIcon),title:(0,m.jsx)(M.FormattedMessage,{id:"CollectionTaskTypeBadge.MoreMenu.RemoveFromHome.title",defaultMessage:"Undo task database"})}),action:()=>{const t=[{label:(0,m.jsx)(M.FormattedMessage,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.confirm",defaultMessage:"Remove"}),color:"red",onAccept:c}];H.showDialog({message:(0,m.jsx)("div",{style:{textAlign:"center"},children:(0,m.jsx)("span",{style:l.confirmationModalTitle,children:(0,m.jsx)(M.FormattedMessage,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.title",defaultMessage:"Undo Task Database?"})})}),description:d,showCancel:!0,keepFocus:!0,items:t}),e.close()}}],p=(0,m.jsx)(te.Z,{topBorder:!0,children:(0,m.jsx)(oe.Z,{href:$.su,title:a.formatMessage(ie.learn),analyticsFrom:"view_settings_task_type_badge"})});return(0,m.jsx)(X.ZP,{popupType:r?X.Z4.SlideUp:X.Z4.Popup,alignmentToOrigin:X.vR.Center,originGap:2,renderOrigin:e=>(0,m.jsx)(q.Z,{style:l.buttonStyle,...e,children:(0,z.o)(l.threeDotIcon)}),render:e=>{const t=[{key:"all",render:e=>(0,m.jsx)(te.Z,{...e}),items:u(e)}];return(0,m.jsxs)(J.Z,{menuType:r?G.og.ActionSheet:G.og.Popup,width:200,children:[(0,m.jsx)(ee.Z,{type:ee.i.Vertical,sections:t,initialFocus:void 0}),p]})}})}var ae=o(690403),le=o(974420),ce=o(158297),de=o(179122),ue=o(641037),pe=o(628020),ge=o(623879),me=o(103734),fe=o(311335),Se=o(433929),ye=o(637034),he=o(981166),xe=o(195697),ve=o(125811),Ce=o(830806),be=o(33311),je=o(861931),we=o(305933),Me=o(80444),_e=o(319385),ke=o(152489),Ve=o(337137),Te=o(276368),Pe=o(127871),Ie=o(240745),Fe=o(496802),Ze=o(18533);const Ae=function(e){let{collectionContextStore:t}=e;const o=(0,n.O7)(),i=(0,r.VK)((()=>t.normalizedFormatStore.state),[t]),s=(0,r.VK)((()=>t.isFullScreenStore.state),[t]),a=(0,r.VK)((()=>function(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}(t)),[t]),l=(0,r.VK)((()=>function(e){const t=e.normalizedFormatStore.state;return(0,c.rx)(t.inline_collection_first_load_limit,Boolean(t.collection_group_by))}(t)),[t]),d=(0,r.VK)((()=>t.permissionScopesStore.state),[t]);return i.collection_group_by||!s&&"calendar"!==a?(0,m.jsx)(Ze.Z,{title:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"Load limit",id:"database.viewSettings.layoutTab.firstLoadLimitSetting"}),selectedKey:l,popupStyle:{minWidth:190},options:c.jk.map((e=>({key:e,title:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"{limit} pages",values:{limit:e.limit},id:"database.viewSettings.layoutTab.limitPagesTitle"})}))),onChange:e=>function(e,t,o){const i=o.collectionViewStore();if(!i)return;F.createAndCommit({userAction:"CollectionSettingsFirstLoadLimit.handleFirstLoadLimitChange",environment:t,perform:t=>{Fe.FH({stores:[i],update:{inline_collection_first_load_limit:e},transaction:t})}}),o.groupsStore.resetAllLimits(),T.wd({environment:t,collectionContextStore:o,action:"set_first_load_limit"})}(e,o,t),disabled:!d.canConfigureBlock,icon:Ie.M}):null};var Be=o(497372),Ke=o(694166),Oe=o(212347),Le=o(840814),Re=o(226827),De=o(254405),ze=o(352120),Ne=o(47567),Ee=o(548323),He=o(813796),Ue=o(494582),We=(o(252262),o(324506),o(388437)),Ge=o(747453),$e=o(937612),qe=o(652136),Qe=o(912398),Xe=o(443119),Ye=o(638086),Je=o(152840),et=o(343882),tt=o(89673);function ot(){const{layoutStore:e}=(0,Je.J9)(),t=(0,r.VK)((()=>{var t;const o=e.getModules().form_layout_schema;if(!o||0===o.length)throw new Error("No modules found in form_layout_schema");const i=o.filter((e=>(0,Qe.s$)((0,qe.cm)(e))));if(0===i.length){var n;if(0===Xe.uE.form_layout_schema.length)throw new Error("Expected at least one non-configurable header module in form_layout_schema");return null===(n=o.at(-1))||void 0===n?void 0:n.id}return null===(t=i.at(-1))||void 0===t?void 0:t.id}),[e]),o=(0,et.G)({area:"form_layout_schema",afterModuleId:t});return(0,m.jsx)(Ke.Z,{icon:Ge.R,title:(0,m.jsx)(M.FormattedMessage,{id:"formEditSettings.newQuestion.title",defaultMessage:"New question"}),onClick:o})}function it(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;return(0,m.jsx)(Ke.Z,{icon:We.a,title:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"Duplicate form",id:"formEditSettings.duplicateForm.title"}),disabled:!0})}function nt(e){let{collectionContextStore:t,collectionSettingsStore:o,collectionViewStore:r,formBlockStore:s}=e;const a=(0,n.O7)(),l=(0,i.useCallback)((async()=>{await P.TT({environment:a,collectionContextStore:t,collectionViewStore:r,collectionSettingsStore:o,additionalBlocksToDelete:[s],from:"view_settings"})}),[a,t,r,o,s]);return(0,m.jsx)(Ke.Z,{icon:$e.y,title:(0,m.jsx)(M.FormattedMessage,{id:"formEditSettings.deleteForm.title",defaultMessage:"Delete form"}),onClick:l})}const rt=function(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,i=(0,Ye.$Z)(),n=(0,r.VK)((()=>t.collectionViewStore()),[t]),s=(0,r.VK)((()=>{if(!n)throw new Error("No CollectionViewStore found");return n.getFormBlockStore()}),[n]),a=(0,r.VK)((()=>{const e=t.collectionViewBlockStore();return!!e&&e.getCollectionViewIds().length>1}),[t]);return i&&n&&s?(0,m.jsxs)(tt.O,{children:[(0,m.jsx)(te.Z,{children:(0,m.jsx)(ot,{})}),(0,m.jsxs)(te.Z,{topBorder:!0,children:[(0,m.jsx)(it,{collectionSettingsStore:o,collectionContextStore:t}),a&&(0,m.jsx)(nt,{collectionSettingsStore:o,collectionContextStore:t,collectionViewStore:n,formBlockStore:s})]})]}):null};var st=o(271693);const at=a.default.createClass(!1,{name:"ShowViewDescriptionStore"});const lt=function(e){const{collectionContextStore:t,collectionViewStore:o,selectViewNameInitial:s,collectionSettingsStore:a}=e,l=(0,n.O7)(),c=(0,r.qz)(void 0,at),d=(0,r.VK)((()=>t.isInHomeWidgetStore.state),[t]),u=(0,r.VK)((()=>void 0!==t.collectionViewModuleContextStore.state),[t]),p=(0,r.VK)((()=>{var e;const o=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!o&&(0,pe.qG)(o)}),[t]),g=(0,i.useCallback)((e=>function(e,t,o,i){const n=null==i?void 0:i.getFormat().description;if(!i||e===n)return;F.createAndCommit({userAction:"CollectionSettingsViewMain.handleDescriptionChange",environment:t,perform:t=>{A.iG({collectionViewStore:i,update:{format:{...i.getFormat(),description:e}},transaction:t})}}),T.wd({environment:t,collectionContextStore:o,action:"set_description"})}(e,l,t,o)),[l,t,o]),f=(0,r.VK)((()=>t.collectionViewBlockStore()),[t]),S=(0,r.VK)((()=>o.isDefined()),[o]),{description:y}=(0,r.VK)((()=>o.getFormat()),[o]),h=(0,r.VK)((()=>o.getType()),[o]),x=(0,r.VK)((()=>c.state),[c]),v=(0,r.VK)((()=>"on"===_e.default.getEligibleGroup({experimentId:"feature_settings_experiment",defaultGroup:"control"})),[]);if(!S||!f)return null;const C=(0,m.jsx)(He.Z,{collectionViewStore:o,collectionContextStore:t,showViewDescriptionStore:c,selectViewNameInitial:s});if("page"===h)return(0,m.jsx)(Be.ZP,{...e,title:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"View options",id:"database.viewSettings.mainTab.title"}),children:C});if(u)return(0,m.jsx)(Zt,{collectionContextStore:t,collectionSettingsStore:a,viewNameInput:C});let b;if("chart"===h)b=(0,m.jsx)(Vt,{collectionContextStore:t,collectionSettingsStore:a});else if("form_editor"===h)b=(0,m.jsx)(rt,{collectionContextStore:t,collectionSettingsStore:a});else{if(d)return(0,m.jsx)(Ft,{collectionContextStore:t,collectionSettingsStore:a,viewNameInput:C});b=v?(0,m.jsx)(Pt,{collectionContextStore:t,collectionSettingsStore:a,isMyTasks:p}):(0,m.jsx)(Tt,{collectionContextStore:t,collectionSettingsStore:a,isMyTasks:p})}return(0,m.jsxs)(Be.ZP,{...e,title:"form_editor"===h?(0,m.jsx)(M.FormattedMessage,{defaultMessage:"Form options",id:"database.viewSettings.formTab.title"}):(0,m.jsx)(M.FormattedMessage,{defaultMessage:"View options",id:"database.viewSettings.mainTab.title"}),children:[(0,m.jsx)(pt,{collectionContextStore:t}),C,x&&(0,m.jsx)(Pe.i,{initialDescription:y,handleSaveDescription:g}),b]})};function ct(e){let t;return t=e?e.supportedInView&&e.isVisibleInView?he.dH.relationFeatureShownMessage:he.dH.relationFeatureHiddenMessage:he.dH.relationFeatureOffMessage,Se.default.formatMessage(t)}function dt(e,t){const o=t.permissionScopesStore.state,i=(0,_.$K)(e),n=o.canConfigureBlock;return i||n}function ut(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function pt(e){let{collectionContextStore:t}=e;return(0,r.VK)((()=>{const e=t.collectionViewBlockStore();return e&&"content_only_editor"!==e.getRole()}),[t])?null:(0,m.jsx)(L,{})}function gt(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const i=(0,r.VK)((()=>o.currentSubitemFormatStoreForCollectionStore.state),[o]),n=(0,r.VK)((()=>o.databaseType),[o]),s=(0,r.VK)((()=>(0,Ve.Xy)({feature:"subitem",collectionContextStore:o})),[o]),a=(0,r.VK)((()=>dt(i,o)),[o,i]),l=(0,r.VK)((()=>function(e){let t;return t=e?he.dH.relationFeatureOnMessage:he.dH.relationFeatureOffMessage,Se.default.formatMessage(t)}(s)),[s]);return(0,m.jsx)(Ke.Z,{icon:v.Y,title:(0,m.jsx)(M.FormattedMessage,{...(0,he.Gt)({feature:"subitem",databaseType:n})}),showChevron:!0,right:l,onClick:()=>{P.H4({collectionSettingsStore:t,item:{type:"subitemV2",from:"view_options"}})},disabled:!a})}function mt(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const i=(0,r.VK)((()=>o.currentArrowsByFormatStore.state),[o]),n=(0,r.VK)((()=>o.databaseType),[o]),s=(0,r.VK)((()=>(0,Ve.Xy)({feature:"timeline_arrows_by",collectionContextStore:o})),[o]),a=(0,r.VK)((()=>dt(i,o)),[o,i]);return(0,m.jsx)(Ke.Z,{title:(0,m.jsx)(M.FormattedMessage,{...(0,he.Gt)({feature:"timeline_arrows_by",databaseType:n})}),showChevron:!0,icon:u.I,right:ct(s),onClick:()=>{P.H4({collectionSettingsStore:t,item:{type:"dependencies",from:"view_options"}})},disabled:!a})}function ft(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const i=(0,r.VK)((()=>(0,fe.cB)(t)),[t]),n=(0,r.VK)((()=>t.aliveAutomationCountStore.state),[t]),s=(0,r.VK)((()=>(0,fe.Li)({collectionStore:t.collectionStore()})),[t]);return i?(0,m.jsx)(Ke.Z,{icon:d.M,onClick:()=>{const e=V.X(o);!s||n>0?P.H4({collectionSettingsStore:o,item:{source:"collection_view_settings",type:"automationSettings",from:e}}):P.H4({collectionSettingsStore:o,item:{type:"automationCreateSettings",from:e}})},right:n>0?n:(0,m.jsx)(M.FormattedMessage,{id:"database.viewSettings.mainTab.automations.none",defaultMessage:"None"}),showChevron:!0,title:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"Automations",id:"database.viewSettings.mainTab.automations.title"})}):null}function St(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const i=(0,r.VK)((()=>{const e=o.databaseType;return e===l.iS||e===l.p$}),[o]),{sprintSettingsPermissionsContext:n,automaticSprintCompletionEnabled:s}=(0,ve.Z)({collectionSettingsStore:t,collectionContextStore:o});let a;if(null!=n&&n.canEdit){a=n.sprintsEnabled?s?(0,m.jsx)(M.FormattedMessage,{...de.BX.automatic}):(0,m.jsx)(M.FormattedMessage,{...de.BX.manual}):(0,m.jsx)(M.FormattedMessage,{...de.BX.off})}return i&&a?(0,m.jsx)(Ke.Z,{icon:w.L,right:a,showChevron:!0,title:(0,m.jsx)(M.FormattedMessage,{...de.BX.sprintsMenuTitle}),onClick:()=>{P.H4({collectionSettingsStore:t,item:{type:"sprintSettings",from:"view_options"}})}}):null}function yt(e){let{collectionContextStore:t}=e;const o=(0,r.VK)((()=>t.collectionViewBlockStore()),[t]),i=(0,r.VK)((()=>null==o?void 0:o.getRole()),[o]);return(0,r.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getDatabaseType()}),[t])!==l.iS?null:o&&"content_only_editor"!==i?(0,m.jsx)(ne,{collectionContextStore:t}):null}function ht(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:i=!1}=e,s=(0,n.O7)(),a=(0,r.VK)((()=>ut(t)),[t]),l="board"===a?{groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}:{groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},c=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t]),d=(0,r.VK)((()=>t.normalizedFormatStore.state),[t])[l.groupByKey],u=(0,r.VK)((()=>t.permissionScopesStore.state),[t]);return"calendar"!==a?(0,m.jsx)(Ke.Z,{icon:"board"===a?f:S,title:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"Group",id:"database.viewSettings.mainTab.groupButton.title"}),showChevron:!0,right:(0,Oe.bc)(d?c[d.property]:void 0),onClick:()=>{var e;T.wd({environment:s,collectionContextStore:t,action:"click_group",original_view_type:a,property_type:d?null===(e=c[d.property])||void 0===e?void 0:e.type:void 0}),t.isLoadingStore.state||t.loadingDetailsStore.setState({type:"load_groups_menu"}),P.H4({collectionSettingsStore:o,item:d?{type:"group",...l}:{type:"groupByProperty",...l}})},disabled:i||!d&&!u.canConfigureBlock}):null}function xt(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:i=!1}=e,s=(0,n.O7)(),a=(0,r.VK)((()=>ut(t)),[t]),l=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t]),c=(0,r.VK)((()=>t.normalizedFormatStore.state),[t]).collection_group_by,d={groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},u=(0,r.VK)((()=>t.permissionScopesStore.state),[t]);return"board"===a?(0,m.jsx)(Ke.Z,{icon:S,title:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"Sub-group",id:"database.viewSettings.mainTab.subGroupButton.title"}),showChevron:!0,right:(0,Oe.bc)(c?l[c.property]:void 0),onClick:()=>{var e;T.wd({environment:s,collectionContextStore:t,action:"click_subgroup",original_view_type:a,property_type:c?null===(e=l[c.property])||void 0===e?void 0:e.type:void 0}),t.isLoadingStore.state||t.loadingDetailsStore.setState({type:"load_groups_menu"}),P.H4({collectionSettingsStore:o,item:c?{type:"group",...d}:{type:"groupByProperty",...d}})},disabled:i||!c&&!u.canConfigureBlock}):null}function vt(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:i=!1}=e,s=(0,n.O7)(),a=(0,r.VK)((()=>t.collectionViewStore()),[t]),l=(0,r.VK)((()=>null==a?void 0:a.getType()),[a]);return a&&l?(0,m.jsx)(Ke.Z,{disabled:i,icon:h,isPadded:!0,title:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"Layout",id:"database.viewSettings.mainTab.layoutButton.title"}),showChevron:!0,right:ge.Bh[l],onClick:()=>{T.wd({environment:s,collectionContextStore:t,action:"click_layout"}),P.H4({collectionSettingsStore:o,item:{type:"layout"}})}}):null}function Ct(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:i=!1}=e,s=(0,n.O7)(),a=(0,r.VK)((()=>t.normalizedFormatStore.state),[t]),l=(0,r.VK)((()=>ut(t)),[t]),d=(0,r.VK)((()=>(0,c.oz)(l)),[l]);if("chart"===l||"form_editor"===l)return(0,m.jsx)(m.Fragment,{});const u=((d?a[d]:void 0)||[]).filter((e=>Boolean(e.visible))).length;return(0,m.jsx)(Ke.Z,{icon:C.N,disabled:i,title:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"Properties",id:"database.viewSettings.mainTab.propertiesButton.title"}),showChevron:!0,right:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"{propertiesShown} shown",id:"database.viewSettings.mainTab.propertiesButton.propertiesShown.title",values:{propertiesShown:u}}),onClick:()=>{T.wd({environment:s,collectionContextStore:t,action:"click_properties"}),P.H4({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:"timeline"}})}})}function bt(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const i=(0,n.O7)(),s=(0,r.VK)((()=>t.currentSortsStore.state.length),[t]);return(0,m.jsx)(Ke.Z,{icon:j.j,isPadded:!0,title:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"Sort",id:"database.viewSettings.mainTab.sortButton.title"}),showChevron:!0,right:s>0?(0,m.jsx)(M.FormattedMessage,{defaultMessage:"{numberOfSorts, plural, one {{numberOfSorts} sort} other {{numberOfSorts} sorts}}",values:{numberOfSorts:s},id:"database.viewSettings.mainTab.sortButton.oneOrMoreSorts.title"}):(0,m.jsx)(M.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.mainTab.sortButton.noSorts.title"}),onClick:()=>{T.wd({environment:i,collectionContextStore:t,action:"click_sort"}),0===s?P.H4({collectionSettingsStore:o,item:{type:"createSort"}}):P.H4({collectionSettingsStore:o,item:{type:"sort"}})}})}function jt(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r.VK)((()=>t.collectionStore()),[t]),s=(0,r.VK)((()=>null==n?void 0:n.isSyncedCollection()),[n]),a=(0,r.VK)((()=>t.contextType),[t]);return s||"collectionTypedView"===a?null:(0,m.jsxs)(i.Fragment,{children:[(0,m.jsx)(gt,{collectionSettingsStore:o,collectionContextStore:t}),(0,m.jsx)(mt,{collectionSettingsStore:o,collectionContextStore:t})]})}function wt(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r.VK)((()=>t.permissionScopesStore.state),[t]),s=(0,r.VK)((()=>t.collectionStore()),[t]),a=(0,r.VK)((()=>null==s?void 0:s.isSyncedCollection()),[s]),l=(0,r.VK)((()=>t.contextType),[t]);return(0,r.VK)((()=>n.canConfigureCollection),[n])||a||"collectionTypedView"===l?null:(0,m.jsx)(i.Fragment,{children:(0,m.jsx)(gt,{collectionSettingsStore:o,collectionContextStore:t})})}function Mt(e){const t=(0,n.O7)(),o=(0,r.VK)((()=>{const e=Me.default.state.mainEditorCurrentBlockStore;return Boolean(e&&(0,pe.qG)(e.id))}),[]),i=(0,r.VK)((()=>{if(!(0,xe.QI)())return!1;const t=e.collectionContextStore.collectionViewBlockStore();return!(!t||!(0,pe.qG)(t.id))}),[e.collectionContextStore]),a=(0,s.yK)((e=>({icon:_t(e).iconStyles,title:_t(e).menuItemStyles})),[]);if(!i)return null;const l=o?"home_tasks":"home_tile_tasks";return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(R.default,{from:l}),(0,m.jsx)(Ke.Z,{showChevron:!1,icon:y.m,iconStyle:a.icon,title:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"Don't see your tasks?",id:"tasksEmptyState.noDatabases.title"}),textWrapperStyle:a.title,onClick:()=>{we.Z.setState(!0),(0,Ce.Aq)({environment:t,from:l})}})]})}function _t(e){const t=(0,je.$K)(e);return{menuItemStyles:{color:t.text},iconStyles:{width:16,marginLeft:4,marginRight:2,fill:t.icon}}}function kt(e){let{collectionContextStore:t}=e;const o=(0,M.useIntl)(),i=(0,n.O7)(),s=(0,n.MO)(),a=(0,r.VK)((()=>t.collectionStore()),[t]),c=(0,r.VK)((()=>{const e=t.collectionStore(),o=t.collectionViewBlockStore(),i=t.collectionViewStore();if(!e||!o||!i)return!1;if(e.isSyncedCollection())return!1;const n=o.getCollectionViewSourceCollectionStore();return!!t.permissionScopesStore.state.canConfigureBlock&&((null==n||!n.isTypedCollection())&&void 0!==n)}),[t]);return a&&c?(0,m.jsx)(te.Z,{topBorder:!0,style:{marginLeft:4},children:(0,m.jsx)(Ke.Z,{icon:()=>(0,x.z)({width:s?16:14,marginLeft:s?4:void 0}),title:(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:4},children:[(0,m.jsx)("div",{style:k.Z.textOverflowStyle,children:o.formatMessage(me.k.turnInto)}),(0,m.jsx)(le.Z,{})]}),caption:o.formatMessage(me.k.seeTasks),shouldWrapCaption:!0,showChevron:!1,onClick:()=>{ke.Z.setState({isModalOpen:!0,databaseType:l.iS,collectionContextStore:t}),T.gd({environment:i,database_type:l.iS,collectionContextStore:t})}})}):null}function Vt(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(Te.Z,{collectionSettingsStore:o})})}function Tt(e){let{collectionContextStore:t,collectionSettingsStore:o,isMyTasks:i}=e;const s=(0,n.O7)(),{device:a}=s,l=(0,r.VK)((()=>(0,xe.QI)()),[]),c=(0,r.VK)((()=>(0,Z.rm)()),[]),d=(0,r.VK)((()=>_e.default.checkGate({gateName:"collections_new_settings_footer"})),[]);return(0,m.jsxs)(m.Fragment,{children:[a.isMobile?(0,m.jsxs)(te.Z,{topBorder:!0,children:[(0,m.jsx)(vt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ct,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ne.Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(bt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(ht,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(xt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(jt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(St,{collectionSettingsStore:o,collectionContextStore:t}),(0,m.jsx)(Ae,{collectionContextStore:t}),(0,m.jsx)(ft,{collectionContextStore:t,collectionSettingsStore:o})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(te.Z,{children:(0,m.jsx)(vt,{collectionContextStore:t,collectionSettingsStore:o})}),(0,m.jsxs)(te.Z,{topBorder:!0,children:[(0,m.jsx)(Ct,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ne.Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(bt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(ht,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(xt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(jt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(St,{collectionSettingsStore:o,collectionContextStore:t}),(0,m.jsx)(Ae,{collectionContextStore:t}),(0,m.jsx)(ft,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ue.Z,{collectionContextStore:t,collectionSettingsStore:o})]})]}),l||c?(0,m.jsx)(kt,{collectionContextStore:t}):void 0,d?(0,m.jsx)(Ee.Z,{collectionContextStore:t,collectionSettingsStore:o}):(0,m.jsxs)(te.Z,{topBorder:!0,mobileStyle:l||c?{paddingTop:2}:{},children:[l||c?(0,m.jsx)(yt,{collectionContextStore:t}):void 0,(0,m.jsx)(Le.z,{collectionContextStore:t,collectionSettingsStore:o}),i&&(0,m.jsx)(Mt,{collectionContextStore:t})]})]})}function Pt(e){let{collectionContextStore:t,collectionSettingsStore:o,isMyTasks:i}=e;const s=(0,n.O7)(),{device:a}=s,l=(0,r.VK)((()=>_e.default.checkGate({gateName:"collections_new_settings_footer"})),[]);return(0,m.jsxs)(m.Fragment,{children:[a.isMobile?(0,m.jsxs)(te.Z,{topBorder:!0,children:[(0,m.jsx)(Ue.Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(vt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ct,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ne.Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(bt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(ht,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(xt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(wt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ae,{collectionContextStore:t})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(te.Z,{children:[(0,m.jsx)(Ue.Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(vt,{collectionContextStore:t,collectionSettingsStore:o})]}),(0,m.jsxs)(te.Z,{topBorder:!0,children:[(0,m.jsx)(Ct,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ne.Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(bt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(ht,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(xt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(wt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ae,{collectionContextStore:t})]})]}),(0,m.jsx)(It,{collectionContextStore:t,collectionSettingsStore:o}),l?(0,m.jsx)(Ee.Z,{collectionContextStore:t,collectionSettingsStore:o}):(0,m.jsxs)(te.Z,{topBorder:!0,children:[(0,m.jsx)(st.Z,{collectionContextStore:t}),(0,m.jsx)(Re.Z,{collectionContextStore:t}),(0,m.jsx)(ze.Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(De.Z,{collectionContextStore:t,collectionSettingsStore:o}),i&&(0,m.jsx)(Mt,{collectionContextStore:t})]})]})}function It(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const i=(0,n.O7)(),a=(0,M.useIntl)(),l=(0,n.MO)(),c=(0,r.VK)((()=>{const e=t.collectionStore();return null!=e&&e.getName()?(0,ye.vU)({environment:i,intl:a,store:e,untitledFallback:ue.customizeMenuMessages.databaseNamePlaceholder}):Se.default.formatMessage(ue.customizeMenuMessages.databaseNamePlaceholder)}),[i,a,t]),d=(0,s.yK)((e=>({menuItem:{marginLeft:4},icon:{width:l?16:14,marginLeft:l?4:void 0,marginRight:2},title:{display:"flex",alignItems:"center"}})),[l]),u=(0,r.VK)((()=>t.permissionScopesStore.state),[t]);return(0,m.jsx)(te.Z,{topBorder:!0,style:d.menuItem,children:(0,m.jsx)(Ke.Z,{icon:()=>(0,b.H)(d.icon),title:(0,m.jsxs)("div",{style:d.title,children:[(0,m.jsx)("div",{style:k.Z.textOverflowStyle,children:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"Customize {databaseName}",id:"database.viewSettings.mainTab.customizeButton.title",values:{databaseName:c}})}),(0,m.jsx)(le.Z,{})]}),caption:(0,m.jsx)("div",{children:(0,m.jsx)(M.FormattedMessage,{defaultMessage:"Change settings, add new features",id:"database.viewSettings.mainTab.customizeButton.caption"})}),shouldWrapCaption:!0,showChevron:!0,onClick:()=>{P.H4({collectionSettingsStore:o,item:{type:"customize"}})},disabled:!u.canConfigureCollection&&!u.canConfigureBlock})})}function Ft(e){let{collectionContextStore:t,collectionSettingsStore:o,viewNameInput:i}=e;const a=(0,n.O7)(),l=(0,M.useIntl)(),c=(0,s.yK)((()=>({container:{minWidth:Be.nJ},nameInput:{paddingBottom:0}})),[]),d=(0,r.VK)((()=>t.isEmptyStore.state),[t]),u=(0,r.VK)((()=>{var e;const o=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!o&&(0,pe.qG)(o)}),[t]),g=(0,r.VK)((()=>u?{feature:"tasks",from:"tasks_more_menu"}:{feature:"custom_db",from:"custom_db_more_menu"}),[u]);return d?null:(0,m.jsxs)("div",{style:c.container,children:[(0,m.jsx)(te.Z,{style:c.nameInput,children:i}),(0,m.jsx)(te.Z,{children:(0,m.jsx)(vt,{collectionContextStore:t,collectionSettingsStore:o})}),(0,m.jsxs)(te.Z,{topBorder:!0,children:[(0,m.jsx)(Ct,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ne.Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(bt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(ht,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(xt,{collectionContextStore:t,collectionSettingsStore:o})]}),(0,m.jsxs)(te.Z,{topBorder:!0,children:[!u&&(0,m.jsx)(Ue.Z,{collectionContextStore:t,collectionSettingsStore:o}),!u&&(0,m.jsx)(De.Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ke.Z,{icon:p.L,isPadded:!0,title:l.formatMessage(be.Iu.hide),showChevron:!1,onClick:()=>{Me.default.state.currentSpaceViewStore&&I.aG({environment:a,currentSpaceViewStore:Me.default.state.currentSpaceViewStore,...g})}}),u&&(0,m.jsx)(Mt,{collectionContextStore:t})]})]})}function Zt(e){let{collectionContextStore:t,collectionSettingsStore:o,viewNameInput:i}=e;const n=(0,s.yK)((()=>({container:{minWidth:Be.nJ},nameInput:{paddingBottom:0}})),[]),a=(0,r.VK)((()=>t.collectionViewModuleContextStore.canEditCollectionView()),[t]);return(0,m.jsxs)("div",{style:n.container,children:[(0,m.jsx)(te.Z,{style:n.nameInput,children:i}),(0,m.jsxs)(te.Z,{topBorder:!0,children:[(0,m.jsx)(vt,{disabled:!a,collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ct,{disabled:!a,collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(Ne.Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(bt,{collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(ht,{disabled:!a,collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(xt,{disabled:!a,collectionContextStore:t,collectionSettingsStore:o}),(0,m.jsx)(It,{collectionContextStore:t,collectionSettingsStore:o})]}),(0,m.jsx)(At,{collectionContextStore:t})]})}function At(e){const{collectionContextStore:t}=e,o=(0,s.yK)((e=>({buttonStyle:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"center",gap:8,margin:"8px 12px 12px 12px"},badge:{backgroundColor:e.accentColors.gray[200]}})),[]),a=(0,M.useIntl)(),l=(0,n.O7)(),c=(0,i.useCallback)((()=>{P.U7({environment:l,collectionContextStore:t,intl:a})}),[t,l,a]),d=(0,i.useCallback)((()=>{P.iu({environment:l,collectionContextStore:t})}),[t,l]),u=(0,r.VK)((()=>t.collectionViewModuleContextStore.type()),[t]),p=(0,i.useMemo)((()=>"pageWithLayoutModule"===u?c:"pageWithCustomizedModule"===u?d:void 0),[u,c,d]),g=(0,i.useMemo)((()=>"pageWithLayoutModule"===u?a.formatMessage({id:"database.viewSettings.mainTab.customizeViewButton.title",defaultMessage:"Customize this view"}):"pageWithCustomizedModule"===u?a.formatMessage({id:"database.viewSettings.mainTab.resetViewButton.title",defaultMessage:"Reset to default"}):void 0),[u,a]);return u&&"layoutBuilder"!==u?(0,m.jsx)(te.Z,{children:(0,m.jsxs)(ce.Z,{onClick:p,style:o.buttonStyle,children:[(0,m.jsx)(ae.Z,{style:o.badge,content:"DEV"}),g]})}):null}},840814:(e,t,o)=>{o.d(t,{z:()=>l});o(667294);var i=o(226827),n=o(254405),r=o(352120),s=o(271693),a=o(785893);function l(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.Z,{collectionContextStore:t}),(0,a.jsx)(i.Z,{collectionContextStore:t}),(0,a.jsx)(r.Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,a.jsx)(n.Z,{collectionContextStore:t,collectionSettingsStore:o})]})}},226827:(e,t,o)=>{o.d(t,{Z:()=>d});o(667294);var i=o(800480),n=o(727714),r=o(709291),s=o(108406),a=o(805149),l=o(694166),c=o(785893);const d=function(e){let{collectionContextStore:t}=e;const o=(0,i.O7)();return(0,c.jsx)(l.Z,{icon:n.N,title:(0,c.jsx)(r.FormattedMessage,{defaultMessage:"Copy link to view",id:"database.viewSettings.mainTab.copyLinkButton.title"}),onClick:()=>function(e,t){const o=t.collectionViewStore();o&&(a.Ol({environment:e,collectionContextStore:t,collectionViewStore:o}),s.wd({environment:e,collectionContextStore:t,action:"click_copy_link",original_view_type:o.getType()}))}(o,t)})}},254405:(e,t,o)=>{o.d(t,{Z:()=>u});o(667294);var i=o(800480),n=o(886628),r=o(937612),s=o(709291),a=o(108406),l=o(805149),c=o(694166),d=o(785893);const u=function(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const u=(0,i.O7)(),{collectionViewBlockStore:p,permissionScopes:g}=(0,n.VK)((()=>({collectionViewBlockStore:t.collectionViewBlockStore(),permissionScopes:t.permissionScopesStore.state})),[t]),m=(0,n.VK)((()=>{const e=1===(null==p?void 0:p.getCollectionViewIds().length),o=t.isEditableHomeCollectionStore.state;return!g.canConfigureBlock||"collectionTypedView"===t.contextType||e&&!o}),[t,p,g.canConfigureBlock]);return!p||m?null:(0,d.jsx)(c.Z,{icon:r.y,title:(0,d.jsx)(s.FormattedMessage,{defaultMessage:"Delete view",id:"database.viewSettings.mainTab.deleteButton.title"}),isRed:!0,onClick:()=>function(e,t,o){const i=t.collectionViewStore();i&&(l.TT({environment:e,collectionContextStore:t,collectionViewStore:i,collectionSettingsStore:o,from:"view_settings"}),a.wd({environment:e,collectionContextStore:t,action:"click_delete",original_view_type:i.getType()}))}(u,t,o)})}},352120:(e,t,o)=>{o.d(t,{Z:()=>u});o(667294);var i=o(800480),n=o(886628),r=o(388437),s=o(709291),a=o(108406),l=o(805149),c=o(694166),d=o(785893);const u=function(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const u=(0,i.O7)(),p=(0,s.useIntl)(),g=(0,n.VK)((()=>t.permissionScopesStore.state),[t]);return(0,n.VK)((()=>!g.canConfigureBlock||"collectionTypedView"===t.contextType),[t,g])?null:(0,d.jsx)(c.Z,{icon:r.a,title:(0,d.jsx)(s.FormattedMessage,{defaultMessage:"Duplicate view",id:"database.viewSettings.mainTab.duplicateButton.title"}),onClick:()=>function(e,t,o,i){const n=t.collectionViewStore();n&&(l.zt({environment:e,collectionContextStore:t,collectionViewStore:n,collectionSettingsStore:o,intl:i}),a.wd({environment:e,collectionContextStore:t,action:"click_duplicate",original_view_type:n.getType()}))}(u,t,o,p)})}},47567:(e,t,o)=>{o.d(t,{Z:()=>u});o(667294);var i=o(800480),n=o(886628),r=o(821197),s=o(709291),a=o(108406),l=o(805149),c=o(694166),d=o(785893);const u=function(e){let{collectionContextStore:t,collectionSettingsStore:o,disabled:u}=e;const p=(0,i.O7)(),g=(0,n.VK)((()=>t.permissionScopesStore.state),[t]),m=(0,n.VK)((()=>t.currentPropertyFiltersStore.state.length+(t.currentCombinatorFilterStore.state&&g.canConfigureBlock?1:0)),[t,g]);return(0,d.jsx)(c.Z,{disabled:u,icon:r.Q,title:(0,d.jsx)(s.FormattedMessage,{defaultMessage:"Filter",id:"database.viewSettings.mainTab.filterButton.title"}),showChevron:!0,right:m>0?(0,d.jsx)(s.FormattedMessage,{defaultMessage:"{numberOfFilters, plural, one {{numberOfFilters} filter} other {{numberOfFilters} filters}}",values:{numberOfFilters:m},id:"database.viewSettings.mainTab.filterButton.filters.title"}):(0,d.jsx)(s.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.mainTab.filterButton.noFilters.title"}),onClick:()=>{a.wd({environment:p,collectionContextStore:t,action:"click_filters"}),0===m?l.H4({collectionSettingsStore:o,item:{type:"createFilter"}}):l.H4({collectionSettingsStore:o,item:{type:"filters"}})}})}},548323:(e,t,o)=>{o.d(t,{Z:()=>z});o(757658);var i=o(667294),n=o(800480),r=o(886628),s=o(724405),a=o(107289),l=o(875553),c=o(356666),d=o(584169),u=o(727714),p=o(890199),g=o(660291),m=o(937612),f=o(537888),S=o(709291),y=o(531701),h=o(926249),x=o(108406),v=o(225888),C=o(805149),b=o(472711),j=o(709953),w=o(412714),M=o(210228),_=o(164921),k=o(552275),V=o(231945),T=o(478140),P=o(632163),I=o(953437),F=o(672495),Z=o(132662),A=o(966603),B=o(460709),K=o(925130),O=o(183357),L=o(785893);const R=(0,S.defineMessages)({link:{id:"collectionSettingsViewMainFooter.link",defaultMessage:"Link"},delete:{id:"collectionSettingsViewMainFooter.delete",defaultMessage:"Delete"},more:{id:"collectionSettingsViewMainFooter.more",defaultMessage:"More"}});function D(e){const t=(0,n.Fy)(),{collectionContextStore:o,collectionSettingsStore:i}=e,r=(0,s.yK)((e=>({desktopSection:{display:"flex",flexDirection:"row",justifyContent:"center",paddingTop:4,paddingBottom:2,width:"100%"},mobileSection:{display:"flex",flexDirection:"row",justifyContent:"center",paddingTop:0,paddingBottom:0,width:"100%",background:e.popoverBackground}})),[]);return(0,L.jsxs)(F.Z,{topBorder:!0,style:r.desktopSection,mobileStyle:r.mobileSection,shouldShowBottomDivider:t.isMobile,children:[(0,L.jsx)(N,{collectionContextStore:o}),(0,L.jsx)(E,{collectionContextStore:o,collectionSettingsStore:i}),(0,L.jsx)(H,{collectionContextStore:o,collectionSettingsStore:i})]})}const z=i.memo(D,h.Z);function N(e){const{collectionContextStore:t}=e,o=(0,S.useIntl)(),s=(0,n.O7)(),a=(0,r.VK)((()=>t.collectionViewStore()),[t]),l=i.useCallback((()=>{a&&(C.Ol({environment:s,collectionContextStore:t,collectionViewStore:a}),x.wd({environment:s,collectionContextStore:t,action:"click_copy_link",original_view_type:a.getType()}))}),[t,a,s]);return(0,L.jsx)(U,{onClick:l,label:o.formatMessage(R.link),icon:u.N})}function E(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,s=(0,S.useIntl)(),a=(0,n.O7)(),l=(0,r.VK)((()=>t.collectionViewStore()),[t]),c=(0,r.VK)((()=>{var e;const o=t.permissionScopesStore.state.canConfigureBlock,i="collectionTypedView"===t.contextType,n=1===(null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.getCollectionViewIds().length),r=t.isEditableHomeCollectionStore.state;return!o||i||n&&!r}),[t]),d=i.useCallback((()=>{l&&(C.TT({environment:a,collectionContextStore:t,collectionViewStore:l,collectionSettingsStore:o,from:"view_settings"}),x.wd({environment:a,collectionContextStore:t,action:"click_delete",original_view_type:l.getType()}))}),[t,o,l,a]);return(0,L.jsx)(U,{isRedOnHover:!0,onClick:d,label:s.formatMessage(R.delete),icon:m.y,disabled:c})}function H(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,i=(0,S.useIntl)(),r=(0,n.O7)(),s=(0,n.Fy)();return(0,L.jsx)(V.ZP,{popupType:I.kQ.Popup,alignmentToOrigin:V.vR.Center,placementToOrigin:V.pO.Top,originGap:4,renderOrigin:e=>(0,L.jsx)(U,{label:i.formatMessage(R.more),icon:c.o,...e}),render:e=>{let n;return n=s.isMobile?{menuType:B.og.ActionSheet}:{menuType:B.og.Popup,width:200},(0,L.jsx)(T.Z,{...n,children:(0,L.jsx)(P.Z,{type:P.i.Vertical,initialFocus:0,sections:[{key:"default",render:e=>(0,L.jsx)(F.Z,{enableActionSheetTitle:!0,...e}),items:W({environment:r,collectionContextStore:t,collectionSettingsStore:o,intl:i})}]})})}})}function U(e){const[t,o]=i.useState(!1),[r,a]=i.useState(!1),l=(0,n.Fy)(),[c]=(0,K.o$)(),d=(0,s.yK)((o=>{let i=o.lightDividerColor;t&&(i=o.buttonHoveredBackground),r&&(i=o.buttonPressedBackground);let n={fill:o.mediumIconColor,color:o.mediumTextColor};return t&&(n=e.isRedOnHover?{fill:y.ZP.red,color:y.ZP.red}:{fill:o.regularIconColor,color:o.regularTextColor}),{wrapper:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"none",borderRadius:4,fill:n.fill,color:n.color,...l.isMobile?{paddingTop:20,paddingBottom:20,width:90}:{paddingTop:16,paddingBottom:16,width:64}},button:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",borderRadius:"50%",background:i,...l.isMobile?{width:40,height:40}:{width:28,height:28}},icon:{...l.isMobile?{width:18,height:18}:{width:14,height:14}},label:{fontWeight:500,...l.isMobile?{fontSize:16}:{fontSize:12}}}}),[l.isMobile,t,r,e.isRedOnHover]);return(0,L.jsxs)(_.Z,{ref:c,onClick:e.onClick,ariaLabel:e.label,style:d.wrapper,hoveredStyle:d.wrapper,pressedStyle:d.wrapper,onMouseEnter:()=>o(!0),onMouseLeave:()=>{o(!1),a(!1)},onFocus:()=>o(!0),onBlur:()=>{o(!1),a(!1)},onMouseDown:()=>a(!0),onMouseUp:()=>a(!1),disabled:e.disabled,children:[(0,L.jsx)(_.Z,{disabled:!0,disallowTabbing:!0,hovered:t,pressed:r,style:d.button,hoveredStyle:d.button,pressedStyle:d.button,children:e.icon(d.icon)}),(0,L.jsx)(Z.Z,{size:6}),(0,L.jsx)("span",{style:d.label,children:e.label})]})}function W(e){const{environment:t,collectionContextStore:o,collectionSettingsStore:i,intl:n}=e,r=t.device.isMobile,s=r?{width:20,height:20}:{width:16,height:16},c=r?{paddingRight:6}:{},u=[],m=o.getViewType(),y=o.collectionViewStore(),h=o.collectionViewBlockStore(),_=o.normalizedSchemaStore.state;if(!h||!y||!_)return[];const V=Boolean(h.isLocked()),T=Boolean(h.getCollectionViewSourceCollectionStore()),P=h.isCollectionViewPageWithContent(),I={key:"lock",render:e=>(0,L.jsx)(k.Z,{...e,focused:e.focused,icon:V?(0,f.U)(s):(0,p.b)(s),style:c,title:(0,A.L2)(T,P,V)}),action:()=>{b.bo({environment:t,store:h,lock:!V}),x.wd({environment:t,collectionContextStore:o,action:"click_toggle_lock"})}},F={key:"duplicate",render:e=>(0,L.jsx)(k.Z,{...e,focused:e.focused,icon:(0,l.U)(s),style:c,title:(0,L.jsx)(S.FormattedMessage,{...O.wh.chartDuplicate})}),action:()=>{C.zt({environment:t,collectionContextStore:o,collectionViewStore:y,collectionSettingsStore:i,intl:n}),x.wd({environment:t,collectionContextStore:o,action:"click_duplicate",original_view_type:y.getType()})}},Z={key:"reset",render:e=>(0,L.jsx)(k.Z,{...e,focused:e.focused,icon:(0,g.b)(s),style:c,title:(0,L.jsx)(S.FormattedMessage,{...O.wh.chartReset})}),action:()=>{M.createAndCommit({userAction:"chartSettings.clearChartConfig",environment:t,perform:e=>{j.sW({store:y.getFormatStore(),data:{chart_config:(0,a.K0)({collectionSchema:_})},transaction:e})}})}},B={key:"learn",render:e=>(0,L.jsx)(k.Z,{...e,focused:e.focused,icon:(0,d.m)(s),style:c,title:(0,L.jsx)(S.FormattedMessage,{...O.wh.chartHelp})}),action:()=>{w.D({environment:t,url:""}),v.Fs(t,{from:"view_settings_charts_help"})}};return"chart"===m&&(u.push(I),u.push(F),u.push(Z),u.push(B)),u}},813796:(e,t,o)=>{o.d(t,{L:()=>b,Z:()=>w});o(667294);var i=o(800480),n=o(886628),r=o(724405),s=o(841892),a=o(379362),l=o(76233),c=o(709291),d=o(108406),u=o(496802),p=o(137231),g=o(210228),m=o(940663),f=o(710274),S=o(820616),y=o(672495),h=o(628020),x=o(217095),v=o(171214),C=o(785893);const b=(0,c.defineMessages)({viewNamePlaceholderMessage:{defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNamePlaceholder.title"},addDescriptionTooltip:{defaultMessage:"Add view description",id:"database.viewSettings.mainTab.addDescriptionTooltip.title"},editDescriptionTooltip:{defaultMessage:"Edit view description",id:"database.viewSettings.mainTab.editDescriptionTooltip.title"}});function j(e,t,o){const i=o.collectionViewBlockStore(),n=o.collectionViewStore();if(!i||!n||!n.isDefined())return;const r=(0,h.qG)(i.id);n.getName()!==e&&g.createAndCommit({userAction:"CollectionSettingsViewMain.handleViewNameSubmit",environment:t,perform:t=>{if(f.iG({collectionViewStore:n,update:{name:e},transaction:t}),r){const o=(0,l.TPx)(e);p.sO({environment:i.environment,store:i.getBlockTitleStore(),value:o,transaction:t})}}}),d.wd({environment:t,collectionContextStore:o,action:"rename",original_view_type:n.getType()})}const w=function(e){const{collectionViewStore:t,collectionContextStore:o,selectViewNameInitial:l,showViewDescriptionStore:p}=e,w=(0,i.O7)(),M=(0,c.useIntl)(),_=(0,r.Fg)(),k=(0,i.Fy)(),V=(0,n.VK)((()=>t.getType()),[t]),T=(0,n.VK)((()=>t.getName()),[t]),{description:P,collection_view_icon:I}=(0,n.VK)((()=>t.getFormat()),[t]),F=(0,n.VK)((()=>p.state),[p]),Z=(0,n.VK)((()=>o.permissionScopesStore.state),[o]),A=(0,n.VK)((()=>o.isEditableHomeCollectionStore.state),[o]),B=(0,n.VK)((()=>t.getAppConfigUri()),[t]),K=!B||(0,m.R8)(B);return(0,C.jsx)(y.Z,{title:k.isMobile&&(0,C.jsx)(c.FormattedMessage,{defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNameSection.title"}),children:(0,C.jsx)(v.I,{initialValue:T||"",placeholder:M.formatMessage(b.viewNamePlaceholderMessage),onBlur:e=>j(e,w,o),onSubmit:e=>j(e,w,o),focusInitial:l,selectAll:l,disabled:!Z.canConfigureBlock||!K,iconButton:{icon:e=>(0,C.jsx)(S.F,{color:"gray",viewIcon:I,viewType:V,style:{marginRight:6}}),iconStyle:{fill:a.Lr[_.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o){const i=t.collectionViewStore(),n=t.collectionViewBlockStore();if(!n||!i||!i.isDefined())return;const r=(0,h.qG)(n.id);g.createAndCommit({userAction:"CollectionSettingsViewMain.handleViewIconSubmit",environment:e,perform:e=>{if(r){const t=o||s.Z.images.appPackages.taskDbIconSvg;f.Uy({collectionViewStore:i,icon:t,transaction:e}),u.FH({stores:[n],update:{page_icon:t},transaction:e})}else f.Uy({collectionViewStore:i,icon:o,transaction:e})}}),d.wd({environment:e,collectionContextStore:t,action:"change_icon",icon:o})}(w,o,e)},inputRightButton:A||"form_editor"===V?null:(0,C.jsx)(x.l,{description:P,showTooltip:!F,onClick:()=>p.setState(!F),addDescriptionText:M.formatMessage(b.addDescriptionTooltip),editDescriptionText:M.formatMessage(b.editDescriptionTooltip),disabled:!Z.canConfigureBlock})})})}},494582:(e,t,o)=>{o.d(t,{Z:()=>h});o(667294);var i=o(800480),n=o(886628),r=o(89036),s=o(709291),a=o(653965),l=o(108406),c=o(757549),d=o(805149),u=o(731278),p=o(776798),g=o(170289),m=o(292283),f=o(694166),S=o(785893);function y(e){let{environment:t,collectionStore:o,collectionSettingsStore:i}=e;const l=(0,n.VK)((()=>null==o?void 0:o.getFormat()),[o]),u=null==l?void 0:l.external_collection_type,p=u?g.I[u]:"";return(0,S.jsx)(f.Z,{icon:r.v,onClick:()=>{c.KL(t,{import_source:"jira",action:"source_click",userId:t.currentUser.id,spaceId:o.getSpaceId(),botId:null==l?void 0:l.bot_id,site:null==l?void 0:l.synced_collection_external_url}),d.H4({collectionSettingsStore:i,item:{source:"external_source",type:"externalProjectsSyncSettings"}})},right:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("img",{style:{height:12,width:12,marginRight:6,display:"inline-flex",alignItems:"center"},src:p,alt:"External intergration icon"}),(0,S.jsx)(s.FormattedMessage,{id:"database.viewSettings.mainTab.source.sourceName",defaultMessage:"{integrationName}",values:{integrationName:(0,a.kC)(u)}})]}),showChevron:!0,title:(0,S.jsx)(s.FormattedMessage,{defaultMessage:"Source",id:"database.viewSettings.mainTab.source.title"})})}const h=function(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const a=(0,i.O7)(),c=(0,n.VK)((()=>t.collectionStore()),[t]),g=(0,n.VK)((()=>null==c?void 0:c.isExternalSyncedCollection()),[c]),h=(0,n.VK)((()=>t.permissionScopesStore.state),[t]),x=(0,n.VK)((()=>(0,m.K6)()),[]),v=(0,n.VK)((()=>t.collectionViewBlockStore()),[t]),C=(0,n.VK)((()=>{const e=t.collectionStore(),o=t.collectionViewBlockStore(),i=t.collectionViewStore();if(!e||!o||!i)return!1;if(e.isSyncedCollection())return!0;return void 0===o.getCollectionViewSourceCollectionStore()}),[t]),b=(0,n.VK)((()=>null==c?void 0:c.getIcon()),[c]);return x&&g&&c?(0,S.jsx)(y,{environment:a,collectionStore:c,collectionSettingsStore:o}):c&&v&&C?(0,S.jsx)(f.Z,{icon:r.v,title:(0,S.jsx)(s.FormattedMessage,{defaultMessage:"Source",id:"database.viewSettings.mainTab.sourceButton.title"}),showChevron:!0,right:(0,S.jsxs)(S.Fragment,{children:[b&&(0,S.jsx)(u.Z,{icon:b,isEmptyPage:!1,size:20,disabled:!0,style:{marginRight:4,opacity:.6}}),(0,S.jsx)(p.Z,{store:c})]}),textWrapperStyle:{flexShrink:0},rightStyle:{flexShrink:1},disabled:!h.canConfigureBlock,onClick:()=>{l.wd({environment:a,collectionContextStore:t,action:"click_source"}),d.H4({collectionSettingsStore:o,item:{type:"source"}})}}):null}},41162:(e,t,o)=>{o.d(t,{_:()=>r});o(667294);var i=o(724405),n=(o(709291),o(137810));o(164921),o(316354),o(95477),o(785893);function r(){(0,i.yK)((e=>({button:{maxWidth:50,marginLeft:12,lineHeight:"10px",textAlign:"center",textWrap:"wrap",borderRadius:4},link:{fontSize:10,fontWeight:n.Z.fontWeight.medium,color:e.blueColor}})),[]);return null}},89673:(e,t,o)=>{o.d(t,{O:()=>l});o(667294);var i=o(886628),n=o(39779),r=o(566890),s=o(152840),a=o(785893);function l(e){const{children:t}=e,o=(0,r.Y$)(),l=(0,i.VK)((()=>o.formsBaseLayoutEditorContextValueStore.state),[o]),c=(0,i.VK)((()=>o.formsSpecificLayoutEditorContextValueStore.state),[o]);return l&&c?(0,a.jsx)(s.Dt.Provider,{value:l,children:(0,a.jsx)(n.E.Provider,{value:c,children:t})}):null}},271693:(e,t,o)=>{o.d(t,{Z:()=>p});o(667294);var i=o(800480),n=o(886628),r=o(890199),s=o(537888),a=o(108406),l=o(472711),c=o(966603),d=o(694166),u=o(785893);function p(e){let{collectionContextStore:t}=e;const o=(0,i.O7)(),p=(0,n.VK)((()=>t.collectionViewBlockStore()),[t]),g=(0,n.VK)((()=>null==p?void 0:p.getCollectionViewSourceCollectionStore()),[p]),m=(0,n.VK)((()=>null==p?void 0:p.isLocked()),[p]),f=(0,n.VK)((()=>g?g.canEditCollection():null==p?void 0:p.canEditCollection()),[p,g]),S=(0,n.VK)((()=>null==p?void 0:p.isCollectionViewPageWithContent()),[p]);return p&&f?(0,u.jsx)(d.Z,{icon:m?s.U:r.b,title:(0,c.L2)(Boolean(g),S,m),onClick:()=>function(e,t){const o=t.collectionViewBlockStore();if(!o)return;l.bo({environment:e,store:o,lock:!o.isLocked()}),a.wd({environment:e,collectionContextStore:t,action:"click_toggle_lock"})}(o,t)}):null}},668155:(e,t,o)=>{o.d(t,{Z:()=>a});o(667294);var i=o(709291),n=o(362896),r=o(110906),s=o(785893);const a=function(e){let{collectionViewName:t,collectionViewType:o}=e;return t?(0,s.jsx)(n.Z,{children:t}):"page"===o?(0,s.jsx)(i.FormattedMessage,{id:"database.collectionView.untitledName.untitled",defaultMessage:"Untitled"}):(0,s.jsx)(i.FormattedMessage,{...r.b1[o]})}},760442:(e,t,o)=>{o.d(t,{Z:()=>s});o(667294);var i=o(137810),n=o(847853),r=o(785893);const s=function(e){let{imageURL:t,imageWidth:o,imageHeight:i,caption:s,title:l}=e;if(t){const e=(0,n.D)(t);return(0,r.jsxs)("div",{style:{width:o||200,marginTop:4,marginBottom:4},children:[(0,r.jsx)("div",{style:{width:"100%",height:i||100,borderRadius:4,backgroundImage:`url(${e})`,backgroundSize:"cover",marginBottom:6}}),(0,r.jsx)(a,{caption:s,title:l})]})}return(0,r.jsx)(a,{caption:s,title:l,style:{width:o}})};function a(e){let{style:t,caption:o,title:n}=e;return(0,r.jsxs)("div",{style:{whiteSpace:"normal",lineHeight:1.4,...t},children:[n&&(0,r.jsx)("header",{style:{fontWeight:i.Z.fontWeight.bold,marginBottom:4},children:n}),o]})}},721396:(e,t,o)=>{o.d(t,{Fg:()=>g,eP:()=>u,hj:()=>p});o(21703),o(667294);var i=o(724405),n=o(173110),r=o(849019),s=o(282447),a=o(526774),l=o(401898),c=o(93044),d=o(785893);function u(e){if(e.kind===n.yp.ContextValue)return e.name;if(e.kind===n.yp.Binding||e.kind===n.yp.ThisRow)throw new Error("Not implemented yet.");(0,l.t1)(e)}function p(e){return e.kind===n.yp.ContextValue?e.tooltipName||e.name:u(e)}function g(e){const{value:t}=e,o=(0,i.Fg)(),n=u(t);let l,p;if("date"===t.type.type?l=s.V:"person"===t.type.type?l=a.O:("block"===t.type.type||"array"===t.type.type&&"block"===t.type.of.type)&&(l=r.e),l){const e=l;p=()=>e({width:12,height:12,marginRight:4})}return(0,d.jsx)(c.ZP,{...e,title:n,renderAvatar:p,shouldShrink:!0,style:{background:o.outlineBlueButtonPressedBackground,color:o.blueColor,padding:"2px 4px"}})}},179122:(e,t,o)=>{o.d(t,{AV:()=>C,BX:()=>f,Iq:()=>u,Q8:()=>h,Uj:()=>y,ZI:()=>j,_3:()=>w,fq:()=>p,gV:()=>v,vA:()=>x,w2:()=>b});o(667294);var i=o(421202),n=o(815047),r=o(429369),s=o(709291),a=o(454642),l=o(940663),c=o(296994),d=o(785893);const u="https://www.notion.so/help/sprints",p=[1,2,3,4,5,6,7,8],g={1:{key:"one_week",value:1},2:{key:"two_weeks",value:2},3:{key:"three_weeks",value:3},4:{key:"four_weeks",value:4},5:{key:"five_weeks",value:5},6:{key:"six_weeks",value:6},7:{key:"seven_weeks",value:7},8:{key:"eight_weeks",value:8}},m={MO:"Monday",TU:"Tuesday",WE:"Wednesday",TH:"Thursday",FR:"Friday",SA:"Saturday",SU:"Sunday"},f=(0,s.defineMessages)({sprintsMenuTitle:{id:"sprintSettingsMenu.label",defaultMessage:"Sprints"},setupSprintsTitle:{id:"sprintSettingsMenu.setupSprints.label",defaultMessage:"Set up sprints"},setupSprintsCaption:{id:"sprintSettingsMenu.setupSprints.caption",defaultMessage:"Use sprints to regularly tackle a group of tasks in a recurring, set amount of time."},setupSprintsTeamspaceStatement:{id:"sprintSettingsMenu.setupSprintsTeamspaceStatement.caption",defaultMessage:"We'll also add to your teamspace:"},setupSprintsSprintBoardPageStatement:{id:"sprintSettingsMenu.setupSprintsSprintBoardPageStatement.caption",defaultMessage:"<bold>Sprint board</bold>: To manage tasks and plan your work"},setupSprintsSprintsDatabaseStatement:{id:"sprintSettingsMenu.setupSprintsSprintsDatabaseStatement.caption",defaultMessage:"<bold>Sprints database</bold>: To keep a historical record of what you accomplished"},manual:{id:"sprintSettingsMenu.manual.label",defaultMessage:"Manual"},automatic:{id:"sprintSettingsMenu.automatic.label",defaultMessage:"Auto"},off:{id:"sprintSettingsMenu.off.label",defaultMessage:"Off"},completeSprintNextSprintActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.moveToNextSprintOption.label",defaultMessage:"Move to next sprint"},completeSprintNextSprintActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.moveToNextSprintOption.selected.label",defaultMessage:"Next sprint"},completeSprintBacklogActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.moveToBacklogOption.label",defaultMessage:"Move to backlog"},completeSprintBacklogActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.moveToBacklogOption.selected.label",defaultMessage:"Backlog"},completeSprintKeepInCurrentSprintActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.keepInCurrentSprint.label",defaultMessage:"Keep in current sprint"},completeSprintKeepInCurrentSprintActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.keepInCurrentSprint.selected.label",defaultMessage:"Current sprint"},automatedSprintsToggleTitle:{id:"sprintSettingsMenu.automatedSprintsToggle.label",defaultMessage:"Automated sprints"},automatedSprintsToggleCaption:{id:"sprintSettingsMenu.automatedSprintsToggle.caption",defaultMessage:"Sprints complete automatically before the start of the next sprint."},duration:{id:"sprintSettingsMenu.duration.label",defaultMessage:"Duration"},durationMenuOptionText:{id:"sprintSettingsMenu.duration.option.label",defaultMessage:"{durationValue, plural, one {1 week} other {{durationValue} weeks}}"},startOn:{id:"sprintSettingsMenu.startOn.label",defaultMessage:"Start on"},weekdayOption:{id:"sprintSettings.weekdayOption.label",defaultMessage:"{weekdayName}s"},incompleteTasks:{id:"sprintSettingsMenu.incompleteTasks.label",defaultMessage:"Incomplete tasks"},turnOnSprints:{id:"sprintSettingsMenu.turnOnSprints.button.label",defaultMessage:"Turn on sprints"},turnOffSprints:{id:"sprintSettingsMenu.turnOffSprints.button.label",defaultMessage:"Turn off sprints"},turnOffSprintsModalTitle:{id:"sprintSettingsMenu.turnOffSprints.modal.title.label",defaultMessage:"Turn off sprints?"},turnOffSprintsModalNoSprintBoardsDescription:{id:"sprintSettingsMenu.turnOffSprints.modal.default.description",defaultMessage:"This will delete your sprints database and its linked views."},turnOffSprintsModalWithSprintBoardsDescription:{id:"sprintSettingsMenu.turnOffSprints.modal.withSprintBoards.description",defaultMessage:"This will delete your sprint board(s), sprints database and its linked views."},turnOffAndDeleteModalButton:{id:"sprintSettingsMenu.turnOffAndDeleteModal.button.label",defaultMessage:"Turn off and delete"},learnSprintsTitle:{id:"sprintSettingsMenu.learnSprints.button.label",defaultMessage:"Learn about sprints"},manageSprintFromThisView:{id:"sprintSettingsMenu.manageSprintFromThisView.label",defaultMessage:"Manage sprint from this view"},manageSprintFromThisViewModalTitle:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.title.label",defaultMessage:"Manage sprint from this view?"},manageSprintFromThisViewModalButton:{id:"sprintSettingsMenu.manageSprintFromThisView.button.label",defaultMessage:"Update view"},manageSprintFromThisViewModalAutomaticSprintCompletionDescription:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.automaticSprintCompletion.description",defaultMessage:"The view will be updated with filters for the current sprint."},manageSprintFromThisViewModalManualSprintCompletionDescription:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.manualSprintCompletion.description",defaultMessage:"The view will be updated with filters for the current sprint and a button to complete sprints will be displayed."},sprintStartDateToday:{id:"sprintSettingsMenu.sprintStartDateToday",defaultMessage:"Next sprint starts <time>today</time>}"},sprintStartDateFuture:{id:"sprintSettingsMenu.sprintStartDateFuture",defaultMessage:"Next sprint starts in {days} {days, plural, one {day} other {days}} <time>({formattedDate}</time>)"},sprintStartDateShouldStartPast:{id:"sprintSettingsMenu.sprintStartDateShouldStartPast",defaultMessage:"Next sprint should have started {days} {days, plural, one {day} other {days}} ago <time>({formattedDate})</time>"},sprintStartDateShouldStartToday:{id:"sprintSettingsMenu.sprintStartDateShouldStartToday",defaultMessage:"Next sprint should start <time>today</time>"},sprintStartDateShouldStartFuture:{id:"sprintSettingsMenu.sprintStartDateShouldStartFuture",defaultMessage:"Next sprint should start in {days} {days, plural, one {day} other {days}} <time>({formattedDate})</time>"}}),S={complete_sprint_and_move_incomplete_tasks_to_next_sprint:{menuOptionText:f.completeSprintNextSprintActionMenuOptionText,selectedText:f.completeSprintNextSprintActionSelectedText},complete_sprint_and_move_incomplete_tasks_to_backlog:{menuOptionText:f.completeSprintBacklogActionMenuOptionText,selectedText:f.completeSprintBacklogActionSelectedText},complete_sprint:{menuOptionText:f.completeSprintKeepInCurrentSprintActionMenuOptionText,selectedText:f.completeSprintKeepInCurrentSprintActionSelectedText}};function y(e){return(0,d.jsx)(s.FormattedMessage,{...S[e.completeSprintAction].menuOptionText})}function h(e){return(0,d.jsx)(s.FormattedMessage,{...S[e.completeSprintAction].selectedText})}function x(e){const{weekday:t}=e;return(0,d.jsx)(s.FormattedMessage,{...f.weekdayOption,values:{weekdayName:m[t]}})}function v(e){return g[e]}function C(e){const{sprintDurationValue:t}=e;return(0,d.jsx)(s.FormattedMessage,{...f.durationMenuOptionText,values:{durationValue:g[t].value}})}function b(e){const{numOfSprintBoards:t}=e;return t>0?(0,d.jsx)(s.FormattedMessage,{...f.turnOffSprintsModalWithSprintBoardsDescription}):(0,d.jsx)(s.FormattedMessage,{...f.turnOffSprintsModalNoSprintBoardsDescription})}function j(e){const{automaticSprintCompletionEnabled:t}=e;return t?(0,d.jsx)(s.FormattedMessage,{...f.manageSprintFromThisViewModalAutomaticSprintCompletionDescription}):(0,d.jsx)(s.FormattedMessage,{...f.manageSprintFromThisViewModalManualSprintCompletionDescription})}async function w(e){var t;const{environment:o,collectionStore:s,collectionViewBlockStore:d}=e,{appConfigs:u}=await c.FF.AppTemplates.load(),p=d.getSpaceId(),g=d.getParentStore(),m=null===(t=s.getFormat())||void 0===t?void 0:t.app_config_uri,f=m&&(0,l.YB)(u(),m);if(!g||g.table!==n.bx&&g.table!==i.iU&&g.table!==r.e0||!f)return;const S=await a.getSprintBoardViewBlocks(o,{spaceId:p,taskCollectionId:s.id,parentId:g.id,parentTable:g.table});return"success"===(null==S?void 0:S.type)?S.data.result:[]}},616924:(e,t,o)=>{o.d(t,{OV:()=>d,Sz:()=>l,gT:()=>c});var i=o(443261),n=o.n(i),r=(o(667294),o(709291)),s=o(164964),a=o(785893);function l(e,t){const o=new Map,i=t.map((e=>{const t=[e.name,e.description].join(" ");return o.set(e.name,t),t})),r=new Set(n().filter(e,i).map((e=>{let{original:t}=e;return t})));return t.filter((e=>{const t=o.get(e.name);return t&&r.has(t)}))}function c(e,t){const o=new Map,i=t.map((e=>{const t=[e.name,e.description].join(" ");return o.set(e.name,t),t})),r=new Set(n().filter(e,i).map((e=>{let{original:t}=e;return t})));return t.filter((e=>{const t=o.get(e.name);return t&&r.has(t)}))}function d(e){const{featureName:t}=e;s.oV({label:(0,a.jsx)(r.FormattedMessage,{id:"database.viewSettings.customizeMenu.successToastAfterFeatureAddition",defaultMessage:"Added {featureName} to this database.",values:{featureName:t}})})}},641037:(e,t,o)=>{o.r(t),o.d(t,{CollectionSettingsCustomizeMenu:()=>Ze,customizeMenuMessages:()=>Fe});var i=o(667294),n=o(800480),r=o(886628),s=o(724405),a=o(709291),l=o(497372),c=o(261495),d=o(41162),u=o(268894),p=o(672495),g=o(433929),m=o(637034),f=o(305971),S=o(616924),y=o(315468),h=o(805149),x=o(694166),v=o(785893);function C(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,i=(0,n.Fy)(),r=(0,s.yK)((()=>({header:{fontSize:i.isMobile?14:12},section:{marginBottom:6}})),[i]);return(0,v.jsxs)(p.Z,{topBorder:!0,title:(0,v.jsx)("div",{style:r.header,children:(0,v.jsx)(a.FormattedMessage,{id:"database.viewSettings.customizeMenu.advanced.title",defaultMessage:"Advanced"})}),style:r.section,children:[(0,v.jsx)(c.aA,{collectionContextStore:t,collectionSettingsStore:o}),(0,v.jsx)(b,{collectionContextStore:t,collectionSettingsStore:o})]})}function b(e){const{collectionSettingsStore:t}=e;return(0,v.jsx)(x.Z,{icon:y.L,onClick:()=>h.H4({collectionSettingsStore:t,item:{type:"connectionFeatures"}}),showChevron:!0,title:(0,v.jsx)(a.FormattedMessage,{defaultMessage:"Connections",id:"database.viewSettings.customizeMenu.connections.title"})})}var j=o(701302),w=o(605257),M=o(421202),_=o(815047),k=o(429369),V=o(531701),T=o(653965),P=o(401898),I=o(287085),F=o(691851),Z=o(940663),A=o(467263),B=o(710274),K=o(552275),O=o(632163),L=o(814871),R=o(98742),D=o(61766),z=o(80645),N=(o(757658),o(371663)),E=o(172111),H=o(10070),U=o(108406),W=o(210228),G=o(288833),$=o(416536),q=o(50570),Q=o(644539),X=o(218011),Y=o(388268),J=o(416732),ee=o(272467),te=o(337137),oe=o(195697),ie=o(80444),ne=o(801310),re=o(97842),se=o(191604);function ae(e){return(0,r.VK)((()=>{var t;if(!e)return;const o=null===(t=e.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.app_config_uri;return o?(0,Z.YB)((0,$.appConfigs)(),o):void 0}),[e])}function le(e){const{collectionFormat:t,feature:o}=e,i=t.app_config_uri;return o.collectionUri===i&&o.dependencies.some((e=>"property"===e.type&&e.collectionUri===i&&(0,E.Pf)(e.uri)))}function ce(e){const{environment:t,collectionStore:o,collectionFormat:i,collectionViewBlockStore:n,feature:r}=e;if(1!==r.dependencies.length||"collection_view"!==r.dependencies[0].type)return!1;const s=r.dependencies[0];return s.collectionViewBlockUri===n.getFormat().app_config_uri&&s.collectionUri===i.app_config_uri&&(0,Z.Ep)({environment:t,viewDependency:s,collectionStore:o})}function de(e){const t=(0,n.O7)(),o=ae(e),i=function(e){const t=(0,f.E)("untyped_features"),o=(0,re.x1)(e),i=ee.rc.map((e=>({type:"appConfig",...e})));return[{type:"appConfig",...(0,J.EG)()},{type:"appConfig",...(0,J.tQ)()},...t?ee.OO.map((e=>({type:"appConfig",...e}))):[],...i,...o]}(e);return(0,r.VK)((()=>{var n,r;const s=(0,oe.QI)()||(0,Z.rm)();if(!o){return he([...i,...s?[se.TS]:[]],N.br)}const a=null===(n=e.collectionStore())||void 0===n?void 0:n.getFormat(),l=null===(r=e.collectionStore())||void 0===r?void 0:r.getSchema(),c=e.collectionStore(),d=e.collectionViewBlockStore();if(!(a&&l&&c&&d))return[];const u={};o.allFeatures.forEach((e=>{(0,Z.Dl)(e)&&e.variants.every((e=>Boolean(o.allFeatures.find((t=>t.uri===e&&(0,Z.BQ)(t)&&le({collectionFormat:a,feature:t}))))))&&(u[e.uri]=e.variants)}));const p=Object.values(u).flat(),g=[];for(const e of o.allFeatures)if(!g.find((t=>t.uri===e.uri)))if(!p.find((t=>t===e.uri))&&(0,Z.BQ)(e)){const o=le({collectionFormat:a,feature:e}),i=ce({environment:t,collectionStore:c,collectionFormat:a,collectionViewBlockStore:d,feature:e});(o||i)&&g.push({type:"appConfig",...e})}else(0,Z.Dl)(e)&&Boolean(u[e.uri])&&g.push({type:"appConfig",...e});const m=[...i,...g];s&&a.app_config_uri===se.TS.collectionUri&&m.push(se.TS);return he(T.mN(m,"uri"),e.databaseType)}),[t,o,i,e])}const ue={[(0,J.EG)().uri]:1,[(0,J.tQ)().uri]:2,[se.TS.uri]:3,[(0,ee.my)().uri]:4,[(0,ee.B4)().uri]:5,[(0,ee.ad)().uri]:6,[(0,ee.dr)().uri]:7,[re.$e]:8,[re.yM]:9,[re.XR]:10},pe={[(0,J.Mh)().uri]:0,[(0,J.EG)().uri]:1,[(0,J.tQ)().uri]:2,[se.TS.uri]:3,[(0,J.PW)().uri]:4,[(0,J.FK)().uri]:5,[(0,J.bJ)().uri]:6,[(0,ee.my)().uri]:7,[(0,ee.B4)().uri]:8,[(0,ee.ad)().uri]:9,[(0,ee.dr)().uri]:10,[(0,J.yt)().uri]:11,[(0,J.jJ)().uri]:12,[(0,J.iB)().uri]:13,[(0,J.oK)().uri]:14,[(0,J.AE)().uri]:15,[re.$e]:16,[re.yM]:17,[re.XR]:18},ge={[(0,X.eh)().uri]:0,[(0,J.EG)().uri]:1,[(0,J.tQ)().uri]:2,[(0,X.LO)().uri]:3,[(0,ee.my)().uri]:4,[(0,ee.B4)().uri]:5,[(0,ee.ad)().uri]:6,[(0,ee.dr)().uri]:7,[(0,X.xU)().uri]:8,[(0,X.QN)().uri]:9,[(0,X.LM)().uri]:10,[(0,X.f3)().uri]:11,[(0,X.Np)().uri]:12,[re.$e]:13,[re.yM]:14,[re.XR]:15},me={[(0,Y.YI)().uri]:0,[(0,J.EG)().uri]:1,[(0,J.tQ)().uri]:2,[(0,X.LO)().uri]:3,[(0,ee.my)().uri]:4,[(0,ee.B4)().uri]:5,[(0,ee.ad)().uri]:6,[(0,ee.dr)().uri]:7,[(0,Y.Ez)().uri]:8,[re.$e]:9,[re.yM]:10,[re.XR]:11},fe={[(0,J.EG)().uri]:1,[(0,J.tQ)().uri]:2,[(0,Q.Gn)().uri]:3,[(0,Q.nt)().uri]:4,[(0,Q.Si)().uri]:5,[(0,Q.Lm)().uri]:6,[(0,Q.nt)().uri]:7,[(0,Q.Hs)().uri]:8,[(0,ee.my)().uri]:9,[(0,ee.B4)().uri]:10,[(0,ee.ad)().uri]:11,[(0,ee.dr)().uri]:12,[re.$e]:13,[re.yM]:14,[re.XR]:15},Se={[(0,J.EG)().uri]:1,[(0,J.tQ)().uri]:2,[(0,q.Tg)().uri]:3,[(0,q.ir)().uri]:4,[(0,ee.my)().uri]:7,[(0,ee.B4)().uri]:8,[(0,ee.ad)().uri]:9,[(0,ee.dr)().uri]:10,[re.$e]:11,[re.yM]:12,[re.XR]:13},ye={[N.br]:ue,[N.iS]:pe,[N.wW]:ge,[N.p$]:me,[N.Fi]:fe,[N.zU]:Se};function he(e,t){if(!t)return e;const o=ye[t];return o?e.filter((e=>void 0!==o[e.uri])).sort(((e,t)=>(o[e.uri]??1/0)-(o[t.uri]??1/0))):e}function xe(e){var t;const{collectionStore:o,feature:i,collectionContextStore:n,collectionViewBlockStore:r}=e,s=null==o||null===(t=o.getFormat())||void 0===t?void 0:t.app_config_uri;if(i.uri===(0,J.EG)().uri)return Boolean(n.currentSubitemFormatStoreForCollectionStore.state);if(i.uri===(0,J.tQ)().uri){const e=(0,te.Xy)({feature:"timeline_arrows_by",collectionContextStore:n});return Boolean(e)}if("notion://feature/turn_into_tasks_feature"===i.uri)return i.collectionUri===s;if("customizeMenu"===i.type){var a;if(0===i.dependencies.length)return!1;const e=null===(a=n.collectionStore())||void 0===a?void 0:a.getSchema();return Object.keys(e??{}).includes(i.dependencies[0].uri)}const l=H.aQ.derivePropertyUris((null==o?void 0:o.getSchema())??{},null==o?void 0:o.getPropertyMapping());return i.dependencies.some((e=>{const t="property"===e.type&&function(e){const{dependency:t,collectionUri:o,propertyUris:i}=e;if(t.collectionUri===o)return(0,E.Pf)(t.uri)&&i.has(t.uri);if((0,E.Tx)(t.collectionUri))return(0,E.ky)(t.uri)&&i.has(t.uri);return!1}({dependency:e,collectionUri:s,propertyUris:l}),o="collection_view"===e.type&&function(e){const{dependency:t,collectionUri:o,collectionViewBlockStore:i}=e;var n,r;return t.collectionUri===o?t.collectionViewBlockUri===i.getFormat().app_config_uri&&t.uri in((null===(n=i.getFormat())||void 0===n?void 0:n.app_uri_map)??{}):!!(0,E.Tx)(t.collectionUri)&&t.uri in((null===(r=i.getFormat())||void 0===r?void 0:r.app_uri_map)??{})}({dependency:e,collectionUri:s,collectionViewBlockStore:r});return t||o}))}function ve(e,t){return T.oA(e.variants.map((e=>{const o=null==t?void 0:t.find((t=>t.uri===e));if(o&&(0,Z.BQ)(o))return o})))}function Ce(e,t){const o=(0,n.O7)(),s=(0,a.useIntl)(),l=function(e){const t=(0,n.O7)(),o=ae(e),s=(0,r.VK)((()=>ie.default.state.currentSpaceViewStore),[]),a=(0,r.VK)((()=>e.collectionViewBlockStore()),[e]);return(0,i.useCallback)(((i,n)=>{if(!a||!o||!s)return;const r=a.getParentStore();if(!r||"block"!==r.table&&"space"!==r.table&&"team"!==r.table)return;if(1!==i.dependencies.length)return;const l=i.dependencies[0];W.createAndCommit({userAction:"CollectionViewSuggestedViews.createView",environment:t,perform:c=>{var d;G.applyTypedFeatures({environment:t,spaceViewStore:s,appParentStore:r,appUri:o.uri,features:[{type:"simple",featureUri:i.uri}],appCollectionViewBlockStores:[a],createOrModify:"modify",transaction:c});const u=((null===(d=a.getFormat())||void 0===d?void 0:d.app_uri_map)??{})[l.uri];B.f8({environment:t,collectionContextStore:e,collectionViewId:u,isFullScreen:e.isFullScreenStore.state,isRootChild:e.isRootChildStore.state,isInPeekRenderer:e.isInPeekRendererStore.state}),U.xb({environment:t,collectionContextStore:e,view_type:l.value.type,view_config_uri:i.uri,feature:{id:u,from:n,type:i.uri}})}})}),[a,o,s,t,e])}(e);return(0,i.useCallback)((async i=>{if("notion://tasks/sub_task_feature"===i.uri)h.H4({collectionSettingsStore:t,item:{type:"subitemV2",from:"customize_menu"}});else if("notion://tasks/task_dependencies_feature"===i.uri)h.H4({collectionSettingsStore:t,item:{type:"dependencies",from:"customize_menu"}});else if("notion://projects/tasks_with_sprints_feature"===i.uri)h.H4({collectionSettingsStore:t,item:{type:"sprintSettings",from:"customize_menu"}}),(0,S.OV)({featureName:i.name});else if("customizeMenu"===i.type)"notion://feature/turn_into_tasks_feature"===i.uri?(0,se.iB)({environment:o,collectionContextStore:e}):(0,re.u_)({environment:o,collectionContextStore:e,intl:s,feature:i});else{const t=i.dependencies[0];"collection_view"===t.type||"collection_view_block"===t.type||"sub_external_collection"===t.type?(l(i,"customize_menu"),ne.ZP.setState({...ne.ZP.state,shouldReset:!1}),(0,S.OV)({featureName:i.name})):(await I.G0({environment:o,feature:i,collectionContextStore:e,from:"customize_menu"}),(0,S.OV)({featureName:i.name}))}}),[o,s,e,t,l])}const be=4,je=4,we=(0,a.defineMessages)({addedTitle:{defaultMessage:"Settings",id:"database.viewSettings.customizeMenu.addedtitle"},unaddedTitle:{defaultMessage:"Suggested",id:"database.viewSettings.customizeMenu.unaddedtitle"},expandSuggested:{defaultMessage:"See all features",id:"database.viewSettings.customizeMenu.expandSuggested"},collapseSuggested:{defaultMessage:"See less",id:"database.viewSettings.customizeMenu.collapseSuggested"},expandAdded:{defaultMessage:"See more",id:"database.viewSettings.customizeMenu.expandAdded"},collapseAdded:{defaultMessage:"See less",id:"database.viewSettings.customizeMenu.collapseAdded"}});function Me(e){const{collectionContextStore:t,collectionSettingsStore:o,filteredFeatures:l,isUserSearching:c}=e,d=(0,n.O7)(),u=ae(t),f=(0,a.useIntl)(),[y,x]=(0,i.useState)(!1),[C,b]=(0,i.useState)(!1),N=(0,r.VK)((()=>t.permissionScopesStore.state),[t.permissionScopesStore]),E=(0,r.VK)((()=>!N.canConfigureCollection||!N.canConfigureBlock),[N]),{addedFeatures:H,suggestedFeatures:U}=function(e,t){const o=ae(e);return(0,r.VK)((()=>{const i=e.collectionStore(),n=e.collectionViewBlockStore(),r=[],s=[];if(!i||!n)return{addedFeatures:r,suggestedFeatures:s};for(const a of t){let t;if((0,Z.BQ)(a)||(0,Z.EU)(a))t=a;else{const e=ve(a,null==o?void 0:o.allFeatures);if(0===e.length){console.error(`FeatureWithVariants ${a.name} has no variants.`);continue}t={type:a.type,...e[0]}}(xe({collectionStore:i,feature:t,collectionContextStore:e,collectionViewBlockStore:n})?r:s).push(a)}return{addedFeatures:r,suggestedFeatures:s}}),[t,o,e])}(t,l),W=(0,r.VK)((()=>{const e=t.collectionStore();return null!=e&&e.getName()?(0,m.vU)({environment:d,intl:f,store:e,untitledFallback:Fe.databaseNamePlaceholder}):g.default.formatMessage(Fe.databaseNamePlaceholder)}),[d,f,t]),G=(0,r.VK)((()=>t.databaseType),[t]),$=Ce(t,o),q=(0,s.yK)((e=>({suggestedIconStyle:{width:14,height:14,fill:V.ZP.mediumIconColor},addedIconStyle:{width:12,fill:e.lightIconColor,marginLeft:6,transition:"transform 200ms ease-in-out"}})),[]),Q={key:"suggested",render:e=>(0,v.jsx)(p.Z,{...e,topBorder:H.length>0&&U.length>0,title:(0,v.jsx)(Te,{shouldShow:U.length>0,title:we.unaddedTitle})}),items:[...(C||c?U:U.slice(0,be)).map((e=>({key:e.uri,render:o=>{var i,n;const r=(0,z.fA)(e,G),s=(0,z.Ob)(e,W);return(0,v.jsx)(A.Z,{showImage:!0,caption:r,description:s,tooltipImage:null===(i=e.tooltipImage)||void 0===i?void 0:i.img,tooltipImageScale:null===(n=e.tooltipImage)||void 0===n?void 0:n.scale,render:i=>{if((0,Z.BQ)(e)||(0,Z.EU)(e))return(0,v.jsx)(z.Ny,{collectionContextStore:t,buttonMenuItemProps:{...(0,R.Z)(o,i)},feature:e,onClick:()=>$(e),isDisabled:E,right:(0,v.jsx)(_e,{focused:o.focused})});{const n=new D.Z,r=ve(e,null==u?void 0:u.allFeatures);return E?null:(0,v.jsx)(L.Z,{buttonPopupStore:n,items:r,getKey:e=>e.name,renderItem:e=>(0,v.jsx)(K.Z,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0}),onSelect:async e=>{await I.G0({environment:d,feature:e,collectionContextStore:t,from:"customize_menu"}),(0,S.OV)({featureName:e.name})},selectedItem:void 0,renderOrigin:r=>(0,v.jsx)(z.Ny,{collectionContextStore:t,buttonMenuItemProps:{focused:Boolean(o.focused),...(0,R.Z)(T.CE(o,"onClick","focused"),(0,R.Z)(i,r))},feature:e,onClick:()=>{n.setState({open:!0})},isDisabled:E,right:(0,v.jsx)(_e,{focused:o.focused})})})}}})},action:()=>{}}))),...U.length>be&&!c?[{key:"expand",render:e=>(0,v.jsx)(Ve,{menuListItemProps:e,isExpanded:C,expandTitle:we.expandSuggested,collapseTitle:we.collapseSuggested,onClick:()=>b(!C)}),action:()=>{}}]:[]]},X=(y||c?H:H.slice(0,je)).map((e=>{const i={key:e.uri,render:i=>{var n,r;const s=(0,z.fA)(e,G);return(0,v.jsx)(A.Z,{showImage:!0,caption:s,tooltipImage:null===(n=e.tooltipImage)||void 0===n?void 0:n.img,tooltipImageScale:null===(r=e.tooltipImage)||void 0===r?void 0:r.scale,render:n=>{const{onClick:r,isDisabled:s}=function(e){const{environment:t,feature:o,collectionContextStore:i,collectionSettingsStore:n,cannotEditSchema:r,appConfig:s}=e;if("notion://tasks/sub_task_feature"===o.uri)return{onClick:()=>h.H4({collectionSettingsStore:n,item:{type:"subitemV2",from:"customize_menu"}}),isDisabled:!1};if("notion://tasks/task_dependencies_feature"===o.uri)return{onClick:()=>h.H4({collectionSettingsStore:n,item:{type:"dependencies",from:"customize_menu"}}),isDisabled:!1};if("notion://projects/tasks_with_sprints_feature"===o.uri)return{onClick:()=>h.H4({collectionSettingsStore:n,item:{type:"sprintSettings"}}),isDisabled:r};if("notion://feature/turn_into_tasks_feature"===o.uri)return(0,se.bK)({environment:t,collectionContextStore:i,isDisabled:r});if((0,Z.BQ)(o)||(0,Z.EU)(o)){if(0===o.dependencies.length)return{onClick:()=>{console.error(`Feature ${o.name} has no dependencies.`)},isDisabled:!0};const e=o.dependencies[0],s=i.collectionStore();if(o.isAi)return{onClick:()=>{const t=e.uri,o=null==s?void 0:s.getSchema()[t],n=i.settingsStore;h.H4({collectionSettingsStore:n,item:{type:"property",property:t,formatKey:i.getPropertyFormatKey()}}),"text"===(null==o?void 0:o.type)&&h.H4({collectionSettingsStore:n,item:{type:"propertyAiAutofill",propertySchema:o,property:t}})},isDisabled:!1};if((0,Z.BQ)(o)&&("collection_view"===e.type||"collection_view_block"===e.type||"sub_external_collection"===e.type))return{onClick:async()=>{await async function(e){const{feature:t,collectionContextStore:o,environment:i,collectionSettingsStore:n}=e;if(1!==t.dependencies.length)return;const r=t.dependencies[0];if("collection_view"===r.type){const e=o.collectionViewStore(),t=o.collectionViewBlockStore();if(!e||!t)return;const s=null==t?void 0:t.getParentStore();if(!s||s.table!==_.bx&&s.table!==M.iU&&s.table!==k.e0)return;const a=(await(0,F.Q7)({environment:i,collectionViewBlockStore:t,appParentStore:s})).find((e=>{var t;return(null===(t=e.getFormat())||void 0===t?void 0:t.app_config_uri)===r.collectionViewBlockUri})),l=(0,Z.kB)({collectionViewBlockStore:a,dependencyUri:r.uri});if(!l)return;(0,B.f8)({environment:i,collectionContextStore:o,collectionViewId:l.id,isFullScreen:o.isFullScreenStore.state,isRootChild:o.isRootChildStore.state,isInPeekRenderer:o.isInPeekRendererStore.state}),j.default.afterNextFlush((()=>{h.r$({collectionContextStore:o,collectionSettingsStore:n})}))}}({feature:o,collectionContextStore:i,environment:t,collectionSettingsStore:n})},isDisabled:!1};if("property"===e.type){var a;const t=((null==s||null===(a=s.getFormat())||void 0===a?void 0:a.app_uri_map)??{})[e.uri]??e.uri;return{onClick:()=>{r||1===o.dependencies.length&&ke({collectionContextStore:i,property:t})},isDisabled:r}}return{onClick:()=>{console.error(`Feature ${o.name} has an unsupported dependency type: ${e.type}`)},isDisabled:!0}}if((0,Z.Dl)(o)){const e=ve(o,null==s?void 0:s.allFeatures);return 0===e.length?{onClick:()=>{console.error(`Feature ${o.name} has no variants.`)},isDisabled:!0}:{onClick:async()=>{await I.G0({environment:t,feature:e[0],collectionContextStore:i,from:"customize_menu"}),1===e[0].dependencies.length&&ke({collectionContextStore:i,property:e[0].dependencies[0].uri})},isDisabled:r}}(0,P.t1)(o)}({environment:d,feature:e,collectionContextStore:t,collectionSettingsStore:o,cannotEditSchema:E,appConfig:u});return(0,v.jsx)(z.Ny,{collectionContextStore:t,feature:e,buttonMenuItemProps:{...(0,R.Z)(i,n)},right:(0,w.o)(q.addedIconStyle),onClick:r,isDisabled:s})}})},action:()=>{}};return i})),Y={key:"added",render:e=>(0,v.jsx)(p.Z,{...e,title:(0,v.jsx)(Te,{shouldShow:H.length>0,title:we.addedTitle})}),items:[...X,...H.length>je&&!c?[{key:"expand",render:e=>(0,v.jsx)(Ve,{menuListItemProps:e,isExpanded:y,expandTitle:we.expandAdded,collapseTitle:we.collapseAdded,onClick:()=>x(!y)}),action:()=>{}}]:[]]},J=[...H.length>0?[Y]:[],...U.length>0?[Q]:[]];return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(O.Z,{disableInitialScroll:!0,type:O.i.Vertical,initialFocus:void 0,resetFocusOnMouseOut:!0,sections:J})})}function _e(e){const{focused:t}=e,o=(0,s.yK)((e=>({addButton:{fontSize:12,fontWeight:500,color:e.blueColor,background:t?V.ZP.diffBackground:e.accentColors.gray[50],padding:"3px 10px",borderRadius:16}})),[t]);return(0,v.jsx)("div",{style:o.addButton,children:(0,v.jsx)(a.FormattedMessage,{defaultMessage:"Add",id:"database.viewSettings.customizeMenu.addButton"})})}function ke(e){const{collectionContextStore:t,property:o}=e;h.H4({collectionSettingsStore:t.settingsStore,item:{type:"property",property:o,formatKey:t.getPropertyFormatKey()}})}function Ve(e){const{menuListItemProps:t,isExpanded:o,collapseTitle:i,expandTitle:r,onClick:a}=e,l=(0,n.Fy)(),c=(0,s.yK)((e=>({expandButton:{display:"flex",alignItems:"center",color:e.lightTextColor},expandButtonTitle:{fontSize:l.isMobile?14:12,padding:"2px 0"}})),[l]);return(0,v.jsx)(K.Z,{...t,style:c.expandButton,onClick:a,title:(0,v.jsx)("div",{style:c.expandButtonTitle,children:o?g.default.formatMessage(i):g.default.formatMessage(r)})})}function Te(e){const{shouldShow:t,title:o}=e,i=(0,n.Fy)(),r=(0,s.yK)((()=>({header:{fontSize:i.isMobile?14:12}})),[i]);return t?(0,v.jsx)("div",{style:r.header,children:g.default.formatMessage(o)}):null}var Pe=o(680714),Ie=o(110172);const Fe=(0,a.defineMessages)({databaseNamePlaceholder:{id:"customizeMenu.title.databaseNamePlaceholder",defaultMessage:"database"},searchPlaceholder:{defaultMessage:"Find or add features...",id:"database.viewSettings.customizeMenu.searchInputPlaceholder"},noResults:{defaultMessage:"No results",id:"database.viewSettings.customizeMenu.noResults"}});function Ze(e){return(0,f.E)("feature_settings_quality")?(0,v.jsx)(Be,{...e}):(0,v.jsx)(Ae,{...e})}function Ae(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,f=(0,n.O7)(),{isMobile:y}=(0,n.Fy)(),h=(0,a.useIntl)(),[x,b]=(0,i.useState)(""),j=(0,r.VK)((()=>{const e=t.collectionStore();return null!=e&&e.getName()?(0,m.vU)({environment:f,intl:h,store:e,untitledFallback:Fe.databaseNamePlaceholder}):g.default.formatMessage(Fe.databaseNamePlaceholder)}),[f,h,t]),w=(0,Ie.fX)(t),M=(0,r.VK)((()=>(0,S.Sz)(x,w)),[x,w]),_=(0,i.useCallback)((e=>b(e.target.value)),[]),k=(0,s.yK)((()=>({header:{display:"flex",alignItems:"center"},title:{maxWidth:"70%",overflow:"hidden",textOverflow:"ellipsis"},searchInput:{padding:4}})),[]);return(0,v.jsxs)(l.ZP,{...e,title:(0,v.jsxs)("div",{style:k.header,children:[(0,v.jsx)("div",{style:k.title,children:(0,v.jsx)(a.FormattedMessage,{defaultMessage:"Customize {databaseName}",id:"database.viewSettings.customizeMenu.title",values:{databaseName:j}})}),(0,v.jsx)(d._,{})]}),header:(0,v.jsx)(p.Z,{style:k.searchInput,children:(0,v.jsx)(u.ZP,{focusInitial:!y,onChange:_,placeholder:h.formatMessage(Fe.searchPlaceholder),showClearButton:!0,value:x})}),children:[(0,v.jsx)(c.V4,{collectionContextStore:t}),0===M.length&&x.length>0?(0,v.jsx)(Ke,{}):(0,v.jsx)(Pe.Z,{collectionContextStore:t,collectionSettingsStore:o,filteredFeatures:M,isUserSearching:x.length>0}),(0,v.jsx)(C,{collectionContextStore:t,collectionSettingsStore:o})]})}function Be(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,f=(0,n.O7)(),{isMobile:y}=(0,n.Fy)(),h=(0,a.useIntl)(),[x,b]=(0,i.useState)(""),j=(0,r.VK)((()=>{const e=t.collectionStore();return null!=e&&e.getName()?(0,m.vU)({environment:f,intl:h,store:e,untitledFallback:Fe.databaseNamePlaceholder}):g.default.formatMessage(Fe.databaseNamePlaceholder)}),[f,h,t]),w=de(t),M=(0,r.VK)((()=>(0,S.gT)(x,w)),[x,w]),_=(0,i.useCallback)((e=>b(e.target.value)),[]),k=(0,s.yK)((()=>({header:{display:"flex",alignItems:"center"},title:{maxWidth:"70%",overflow:"hidden",textOverflow:"ellipsis"},searchInput:{padding:4}})),[]);return(0,v.jsxs)(l.ZP,{...e,title:(0,v.jsxs)("div",{style:k.header,children:[(0,v.jsx)("div",{style:k.title,children:(0,v.jsx)(a.FormattedMessage,{defaultMessage:"Customize {databaseName}",id:"database.viewSettings.customizeMenu.title",values:{databaseName:j}})}),(0,v.jsx)(d._,{})]}),header:(0,v.jsx)(p.Z,{style:k.searchInput,children:(0,v.jsx)(u.ZP,{focusInitial:!y,onChange:_,placeholder:h.formatMessage(Fe.searchPlaceholder),showClearButton:!0,value:x})}),children:[(0,v.jsx)(c.V4,{collectionContextStore:t}),0===M.length&&x.length>0?(0,v.jsx)(Ke,{}):(0,v.jsx)(Me,{collectionContextStore:t,collectionSettingsStore:o,filteredFeatures:M,isUserSearching:x.length>0}),(0,v.jsx)(C,{collectionContextStore:t,collectionSettingsStore:o})]})}function Ke(){const e=(0,n.Fy)(),t=(0,s.yK)((t=>({empty:{padding:"12px 16px",fontSize:e.isMobile?14:13,fontWeight:500,color:t.mediumTextColor}})),[e]);return(0,v.jsx)("div",{style:t.empty,children:g.default.formatMessage(Fe.noResults)})}},80645:(e,t,o)=>{o.d(t,{Ny:()=>W,fA:()=>$,Ob:()=>q});o(667294);var i=o(800480),n=o(886628),r=o(724405),s=o(977657),a=o(709291),l=o(531701),c=o(401898),d=o(416732),u=o(940663),p=o(552275),g=o(433929),m=o(981166),f=o(172111),S=o(562760),y=o(188607),h=o(591856),x=o(605336),v=o(569651),C=o(760019),b=o(380881),j=o(917948),w=o(110405),M=o(629300),_=o(146392),k=o(612677),V=o(725651),T=o(128495),P=o(301763),I=o(742283),F=o(753866),Z=o(50570),A=o(644539),B=o(218011),K=o(634406),O=o(946113),L=o(97842),R=o(191604),D=o(785893);const z={[(0,d.oK)().uri]:w._,[(0,d.AE)().uri]:v.C,[(0,B.pc)().uri]:_.C,[(0,A.Lm)().uri]:F.w,[(0,A.nt)().uri]:j.O,[(0,A.Gn)().uri]:T.v,[(0,A.Hs)().uri]:v.C,[(0,A.Si)().uri]:P.V,[(0,A.hZ)().uri]:_.C,[(0,A.JD)().uri]:x.r,[(0,A.Iq)().uri]:x.r,[O.bw.uri]:V.R,[O.$m.uri]:y.Q,[O.DM.uri]:C.F,[O.eG.uri]:h.Y,[R.TS.uri]:I.r,[(0,d.EG)().uri]:k.Y,[(0,d.tQ)().uri]:b.I,[(0,Z.Tg)().uri]:T.v,[(0,Z.ir)().uri]:P.V};function N(e){const{feature:t}=e,o=(0,r.yK)((e=>{var o,i;return{featureIconWrapper:{height:28,width:28,padding:"6px 0px",backgroundColor:null===(o=E(t,e))||void 0===o?void 0:o[30],borderRadius:4},featureIcon:{width:16,height:16,alignItems:"center",margin:"auto",fill:null===(i=E(t,e))||void 0===i?void 0:i[400]}}}),[t]),i=(0,r.Fg)();if(!t.icon){const e=z[t.uri]??M.A;return(0,D.jsx)("div",{style:o.featureIconWrapper,children:e(o.featureIcon)})}return t.uri.startsWith(L.MG)||t.uri===(0,d.GT)().uri?(0,D.jsx)("div",{style:o.featureIconWrapper,children:(0,D.jsx)(K.Z,{style:o.featureIcon,src:t.icon})}):(0,D.jsx)("div",{style:o.featureIconWrapper,children:(0,D.jsx)(S.Z,{icon:t.icon,theme:i,size:16,style:o.featureIcon})})}function E(e,t){return e.isAi?t.accentColors.purple:e.uri.startsWith(L.MG)||e.uri===(0,d.GT)().uri?void 0:(0,f.Ao)(e.collectionUri,t)}const H=(0,a.defineMessages)({property:{id:"customizeMenu.propertyMetadataDescription",defaultMessage:"Adds {dependencyCount, plural, one {# property} other {# properties}} to {databaseName}"},view:{id:"customizeMenu.viewMetadataDescription",defaultMessage:"Adds {dependencyCount, plural, one {# view} other {# views}} to {databaseName}"}}),U={property:H.property,collection_view:H.view,collection:void 0,sub_external_collection:void 0,collection_view_block:void 0,page_template:void 0,block:void 0,database_template:void 0};function W(e){const{collectionContextStore:t,buttonMenuItemProps:o,feature:s,onClick:a,isDisabled:c,right:d}=e,u=(0,i.Fy)(),g=(0,n.VK)((()=>t.databaseType),[t]),m=(0,r.yK)((()=>({menuItem:{display:"flex",padding:u.isMobile?"12px 2px":"6px 2px",alignItems:"center",opacity:c?.4:void 0},featureName:{fontSize:u.isMobile?16:13},featureCaption:{fontSize:u.isMobile?14:12,overflow:"hidden",color:"gray",whiteSpace:"nowrap",textOverflow:"ellipsis"},featureTextWrapper:{lineHeight:u.isMobile?"20px":"18px"},iconStyle:{width:14,height:14,fill:l.ZP.mediumIconColor}})),[u,c]);return(0,D.jsx)(p.Z,{...o,style:m.menuItem,icon:(0,D.jsx)(N,{feature:s}),title:(0,D.jsxs)("div",{style:m.featureTextWrapper,children:[(0,D.jsx)("div",{style:m.featureName,children:G(s,g)}),(0,D.jsx)("div",{style:m.featureCaption,children:$(s,g)})]}),disabled:c,onClick:a,right:!c&&d})}function G(e,t){if("notion://tasks/sub_task_feature"===e.uri){const{values:e,...o}=(0,m.Gt)({feature:"subitem",databaseType:t});return g.default.formatMessage(o,e)}return e.name}function $(e,t){if(X[e.uri])return g.default.formatMessage(X[e.uri]);if("notion://tasks/sub_task_feature"===e.uri){const{values:e,...o}=(0,m.qi)({feature:"subitem",databaseType:t});return g.default.formatMessage(o,e)}return e.description}function q(e,t){if(e.uri!==(0,d.EG)().uri&&e.uri!==(0,d.tQ)().uri&&((0,u.BQ)(e)||(0,u.EU)(e))){const o={property:0,collection_view:0,collection:0,sub_external_collection:0,collection_view_block:0,page_template:0,block:0,database_template:0};for(const t of e.dependencies)t.type in o&&o[t.type]++;let i="";for(const e of(0,c.Yd)(U))if(o[e]>0){const n=U[e];if(!n)continue;i+=`${g.default.formatMessage(n,{dependencyCount:o[e],databaseName:t})}\n`}return i}}const Q=(0,a.defineMessages)({tasksTimelineViewDescription:{id:"customizeMenu.tasks.timelineViewDescription",defaultMessage:"Timeline of all tasks"},tasksMyTasksViewDescription:{id:"customizeMenu.tasks.myTasksViewDescription",defaultMessage:"Board of tasks assigned to me"},allTasksViewDescription:{id:"customizeMenu.tasks.allTasksViewDescription",defaultMessage:"Table of all tasks"},tasksCalendarViewDescription:{id:"customizeMenu.tasks.calendarViewDescription",defaultMessage:"Calendar of all tasks"},tasksNoGroupingFeatureDescription:{id:"customizeMenu.tasks.noGroupingFeatureDescription",defaultMessage:"Board of tasks"},tasksEstimatesFeatureDescription:{id:"customizeMenu.tasks.estimatesFeatureDescription",defaultMessage:"Size tasks by effort points or level"},tasksPriorityFeatureDescription:{id:"customizeMenu.tasks.priorityFeatureDescription",defaultMessage:"Triage tasks by priority"},tasksTagsFeatureDescription:{id:"customizeMenu.tasks.tagsFeatureDescription",defaultMessage:"Categorize tasks with tags"},tasksDescriptionFeatureDescription:{id:"customizeMenu.tasks.descriptionFeatureDescription",defaultMessage:"Describe task in more detail"},tasksProjectsFeatureDescription:{id:"customizeMenu.tasks.projectsFeatureDescription",defaultMessage:"Link tasks to projects"},tasksSprintsFeatureDescription:{id:"customizeMenu.tasks.sprintsFeatureDescription",defaultMessage:"Plan tasks in cycles with sprints"},projectsCollaboratorsFeatureDescription:{id:"customizeMenu.projects.collaboratorsFeatureDescription",defaultMessage:"Project team members"},projectsTasksFeatureDescription:{id:"customizeMenu.projects.tasksFeatureDescription",defaultMessage:"Link projects to tasks"},projectsTimelineViewDescription:{id:"customizeMenu.projects.timelineViewDescription",defaultMessage:"Timeline of projects"},projectsMyProjectsViewDescription:{id:"customizeMenu.projects.myProjectsViewDescription",defaultMessage:"Board of projects owned by viewer"},meetingsTagsFeatureDescription:{id:"customizeMenu.meetings.tagsFeatureDescription",defaultMessage:"Categorize meetings with tags"},googleDriveFeatureDescription:{id:"customizeMenu.googleDrive.featureDescription",defaultMessage:"Link Google Drive files"},figmaFeatureDescription:{id:"customizeMenu.figma.featureDescription",defaultMessage:"Link Figma pages"},zendeskFeatureDescription:{id:"customizeMenu.zendesk.featureDescription",defaultMessage:"Link Zendesk tickets"}}),X={"notion://tasks/tasks_timeline_feature":Q.tasksTimelineViewDescription,"notion://tasks/my_tasks_feature":Q.tasksMyTasksViewDescription,"notion://projects/task_table_feature":Q.allTasksViewDescription,"notion://tasks/tasks_calendar_feature":Q.tasksCalendarViewDescription,"notion://projects/task_board_no_grouping_feature":Q.tasksNoGroupingFeatureDescription,"notion://projects/estimates_feature":Q.tasksEstimatesFeatureDescription,"notion://projects/task_priority_feature":Q.tasksPriorityFeatureDescription,"notion://projects/tags_feature":Q.tasksTagsFeatureDescription,"notion://projects/task_description_feature":Q.tasksDescriptionFeatureDescription,"notion://projects/tasks_and_projects_feature":Q.tasksProjectsFeatureDescription,"notion://projects/tasks_with_sprints_feature":Q.tasksSprintsFeatureDescription,"notion://projects/project_collaborators_feature":Q.projectsCollaboratorsFeatureDescription,"notion://projects/projects_and_tasks_feature":Q.projectsTasksFeatureDescription,"notion://projects/project_timeline_feature":Q.projectsTimelineViewDescription,"notion://projects/my_projects_feature":Q.projectsMyProjectsViewDescription,"notion://meetings/meetings_tag_feature":Q.meetingsTagsFeatureDescription,[`notion://feature/connection_${s.f3}`]:Q.googleDriveFeatureDescription,[`notion://feature/connection_${s.mQ}`]:Q.figmaFeatureDescription,[`notion://feature/connection_${s.Nw}`]:Q.zendeskFeatureDescription}},680714:(e,t,o)=>{o.d(t,{Z:()=>R});var i=o(667294),n=o(701302),r=o(800480),s=o(886628),a=o(724405),l=o(605257),c=o(421202),d=o(815047),u=o(429369),p=o(709291),g=o(531701),m=o(653965),f=o(401898),S=o(805149),y=o(287085),h=o(691851),x=o(940663),v=o(467263),C=o(710274),b=o(552275),j=o(632163),w=o(672495),M=o(814871),_=o(433929),k=o(98742),V=o(637034),T=o(61766),P=o(616924),I=o(641037),F=o(80645),Z=o(110172),A=o(191604),B=o(785893);const K=4,O=4,L=(0,p.defineMessages)({addedTitle:{defaultMessage:"Settings",id:"database.viewSettings.customizeMenu.addedtitle"},unaddedTitle:{defaultMessage:"Suggested",id:"database.viewSettings.customizeMenu.unaddedtitle"},expandSuggested:{defaultMessage:"See all features",id:"database.viewSettings.customizeMenu.expandSuggested"},collapseSuggested:{defaultMessage:"See less",id:"database.viewSettings.customizeMenu.collapseSuggested"},expandAdded:{defaultMessage:"See more",id:"database.viewSettings.customizeMenu.expandAdded"},collapseAdded:{defaultMessage:"See less",id:"database.viewSettings.customizeMenu.collapseAdded"}});function R(e){const{collectionContextStore:t,collectionSettingsStore:o,filteredFeatures:R,isUserSearching:H}=e,U=(0,r.O7)(),W=(0,Z.MG)(t),G=(0,p.useIntl)(),[$,q]=(0,i.useState)(!1),[Q,X]=(0,i.useState)(!1),Y=(0,s.VK)((()=>t.permissionScopesStore.state),[t.permissionScopesStore]),J=(0,s.VK)((()=>!Y.canConfigureCollection||!Y.canConfigureBlock),[Y]),{addedFeatures:ee,suggestedFeatures:te}=(0,Z.Xf)(t,R),oe=(0,s.VK)((()=>{const e=t.collectionStore();return null!=e&&e.getName()?(0,V.vU)({environment:U,intl:G,store:e,untitledFallback:I.customizeMenuMessages.databaseNamePlaceholder}):_.default.formatMessage(I.customizeMenuMessages.databaseNamePlaceholder)}),[U,G,t]),ie=(0,s.VK)((()=>t.databaseType),[t]),ne=(0,Z.k3)(t,o),re=(0,a.yK)((e=>({suggestedIconStyle:{width:14,height:14,fill:g.ZP.mediumIconColor},addedIconStyle:{width:12,fill:e.lightIconColor,marginLeft:6,transition:"transform 200ms ease-in-out"}})),[]),se={key:"suggested",render:e=>(0,B.jsx)(w.Z,{...e,topBorder:ee.length>0&&te.length>0,title:(0,B.jsx)(E,{shouldShow:te.length>0,title:L.unaddedTitle})}),items:[...(Q||H?te:te.slice(0,K)).map((e=>({key:e.uri,render:o=>{var i,n;const r=(0,F.fA)(e,ie),s=(0,F.Ob)(e,oe);return(0,B.jsx)(v.Z,{showImage:!0,caption:r,description:s,tooltipImage:null===(i=e.tooltipImage)||void 0===i?void 0:i.img,tooltipImageScale:null===(n=e.tooltipImage)||void 0===n?void 0:n.scale,render:i=>{if((0,x.BQ)(e)||(0,x.EU)(e))return(0,B.jsx)(F.Ny,{collectionContextStore:t,buttonMenuItemProps:{...(0,k.Z)(o,i)},feature:e,onClick:()=>ne(e),isDisabled:J,right:(0,B.jsx)(D,{focused:o.focused})});{const n=new T.Z,r=(0,Z.ZJ)(e,null==W?void 0:W.allFeatures);return J?null:(0,B.jsx)(M.Z,{buttonPopupStore:n,items:r,getKey:e=>e.name,renderItem:e=>(0,B.jsx)(b.Z,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0}),onSelect:async e=>{await y.G0({environment:U,feature:e,collectionContextStore:t,from:"customize_menu"}),(0,P.OV)({featureName:e.name})},selectedItem:void 0,renderOrigin:r=>(0,B.jsx)(F.Ny,{collectionContextStore:t,buttonMenuItemProps:{focused:Boolean(o.focused),...(0,k.Z)(m.CE(o,"onClick","focused"),(0,k.Z)(i,r))},feature:e,onClick:()=>{n.setState({open:!0})},isDisabled:J,right:(0,B.jsx)(D,{focused:o.focused})})})}}})},action:()=>{}}))),...te.length>K&&!H?[{key:"expand",render:e=>(0,B.jsx)(N,{menuListItemProps:e,isExpanded:Q,expandTitle:L.expandSuggested,collapseTitle:L.collapseSuggested,onClick:()=>X(!Q)}),action:()=>{}}]:[]]},ae=($||H?ee:ee.slice(0,O)).map((e=>{const i={key:e.uri,render:i=>{var r,s;const a=(0,F.fA)(e,ie);return(0,B.jsx)(v.Z,{showImage:!0,caption:a,tooltipImage:null===(r=e.tooltipImage)||void 0===r?void 0:r.img,tooltipImageScale:null===(s=e.tooltipImage)||void 0===s?void 0:s.scale,render:r=>{const{onClick:s,isDisabled:a}=function(e){const{environment:t,feature:o,collectionContextStore:i,collectionSettingsStore:r,cannotEditSchema:s,appConfig:a}=e;if("notion://tasks/sub_task_feature"===o.uri)return{onClick:()=>S.H4({collectionSettingsStore:r,item:{type:"subitemV2",from:"customize_menu"}}),isDisabled:!1};if("notion://tasks/task_dependencies_feature"===o.uri)return{onClick:()=>S.H4({collectionSettingsStore:r,item:{type:"dependencies",from:"customize_menu"}}),isDisabled:!1};if("notion://projects/tasks_with_sprints_feature"===o.uri)return{onClick:()=>S.H4({collectionSettingsStore:r,item:{type:"sprintSettings"}}),isDisabled:s};if("notion://feature/turn_into_tasks_feature"===o.uri)return(0,A.bK)({environment:t,collectionContextStore:i,isDisabled:s});if((0,x.BQ)(o)||(0,x.EU)(o)){if(0===o.dependencies.length)return{onClick:()=>{console.error(`Feature ${o.name} has no dependencies.`)},isDisabled:!0};const e=o.dependencies[0],a=i.collectionStore();if(o.isAi)return{onClick:()=>{const t=e.uri,o=null==a?void 0:a.getSchema()[t],n=i.settingsStore;S.H4({collectionSettingsStore:n,item:{type:"property",property:t,formatKey:i.getPropertyFormatKey()}}),"text"===(null==o?void 0:o.type)&&S.H4({collectionSettingsStore:n,item:{type:"propertyAiAutofill",propertySchema:o,property:t}})},isDisabled:!1};if((0,x.BQ)(o)&&("collection_view"===e.type||"collection_view_block"===e.type||"sub_external_collection"===e.type))return{onClick:async()=>{await async function(e){const{feature:t,collectionContextStore:o,environment:i,collectionSettingsStore:r}=e;if(1!==t.dependencies.length)return;const s=t.dependencies[0];if("collection_view"===s.type){const e=o.collectionViewStore(),t=o.collectionViewBlockStore();if(!e||!t)return;const a=null==t?void 0:t.getParentStore();if(!a||a.table!==d.bx&&a.table!==c.iU&&a.table!==u.e0)return;const l=(await(0,h.Q7)({environment:i,collectionViewBlockStore:t,appParentStore:a})).find((e=>{var t;return(null===(t=e.getFormat())||void 0===t?void 0:t.app_config_uri)===s.collectionViewBlockUri})),p=(0,x.kB)({collectionViewBlockStore:l,dependencyUri:s.uri});if(!p)return;(0,C.f8)({environment:i,collectionContextStore:o,collectionViewId:p.id,isFullScreen:o.isFullScreenStore.state,isRootChild:o.isRootChildStore.state,isInPeekRenderer:o.isInPeekRendererStore.state}),n.default.afterNextFlush((()=>{S.r$({collectionContextStore:o,collectionSettingsStore:r})}))}}({feature:o,collectionContextStore:i,environment:t,collectionSettingsStore:r})},isDisabled:!1};if("property"===e.type){var l;const t=((null==a||null===(l=a.getFormat())||void 0===l?void 0:l.app_uri_map)??{})[e.uri]??e.uri;return{onClick:()=>{s||1===o.dependencies.length&&z({collectionContextStore:i,property:t})},isDisabled:s}}return{onClick:()=>{console.error(`Feature ${o.name} has an unsupported dependency type: ${e.type}`)},isDisabled:!0}}if((0,x.Dl)(o)){const e=(0,Z.ZJ)(o,null==a?void 0:a.allFeatures);return 0===e.length?{onClick:()=>{console.error(`Feature ${o.name} has no variants.`)},isDisabled:!0}:{onClick:async()=>{await y.G0({environment:t,feature:e[0],collectionContextStore:i,from:"customize_menu"}),1===e[0].dependencies.length&&z({collectionContextStore:i,property:e[0].dependencies[0].uri})},isDisabled:s}}(0,f.t1)(o)}({environment:U,feature:e,collectionContextStore:t,collectionSettingsStore:o,cannotEditSchema:J,appConfig:W});return(0,B.jsx)(F.Ny,{collectionContextStore:t,feature:e,buttonMenuItemProps:{...(0,k.Z)(i,r)},right:(0,l.o)(re.addedIconStyle),onClick:s,isDisabled:a})}})},action:()=>{}};return i})),le={key:"added",render:e=>(0,B.jsx)(w.Z,{...e,title:(0,B.jsx)(E,{shouldShow:ee.length>0,title:L.addedTitle})}),items:[...ae,...ee.length>O&&!H?[{key:"expand",render:e=>(0,B.jsx)(N,{menuListItemProps:e,isExpanded:$,expandTitle:L.expandAdded,collapseTitle:L.collapseAdded,onClick:()=>q(!$)}),action:()=>{}}]:[]]},ce=[...ee.length>0?[le]:[],...te.length>0?[se]:[]];return(0,B.jsx)(B.Fragment,{children:(0,B.jsx)(j.Z,{disableInitialScroll:!0,type:j.i.Vertical,initialFocus:void 0,resetFocusOnMouseOut:!0,sections:ce})})}function D(e){const{focused:t}=e,o=(0,a.yK)((e=>({addButton:{fontSize:12,fontWeight:500,color:e.blueColor,background:t?g.ZP.diffBackground:e.accentColors.gray[50],padding:"3px 10px",borderRadius:16}})),[t]);return(0,B.jsx)("div",{style:o.addButton,children:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Add",id:"database.viewSettings.customizeMenu.addButton"})})}function z(e){const{collectionContextStore:t,property:o}=e;S.H4({collectionSettingsStore:t.settingsStore,item:{type:"property",property:o,formatKey:t.getPropertyFormatKey()}})}function N(e){const{menuListItemProps:t,isExpanded:o,collapseTitle:i,expandTitle:n,onClick:s}=e,l=(0,r.Fy)(),c=(0,a.yK)((e=>({expandButton:{display:"flex",alignItems:"center",color:e.lightTextColor},expandButtonTitle:{fontSize:l.isMobile?14:12,padding:"2px 0"}})),[l]);return(0,B.jsx)(b.Z,{...t,style:c.expandButton,onClick:s,title:(0,B.jsx)("div",{style:c.expandButtonTitle,children:o?_.default.formatMessage(i):_.default.formatMessage(n)})})}function E(e){const{shouldShow:t,title:o}=e,i=(0,r.Fy)(),n=(0,a.yK)((()=>({header:{fontSize:i.isMobile?14:12}})),[i]);return t?(0,B.jsx)("div",{style:n.header,children:_.default.formatMessage(o)}):null}},946113:(e,t,o)=>{o.d(t,{$m:()=>f,DM:()=>S,Ex:()=>x,bw:()=>m,eG:()=>g,rc:()=>y});var i=o(371663),n=o(841892),r=o(399036),s=o(709291),a=o(108406),l=o(316956),c=o(210228),d=o(433929),u=o(616924);const p=(0,s.defineMessages)({aiSummaryName:{id:"feature.ai_summary.name",defaultMessage:"AI summary"},aiSummaryDescription:{id:"feature.ai_summary.description",defaultMessage:"Summarize pages with AI"},aiAutofillName:{id:"feature.ai_autofill.name",defaultMessage:"Custom AI autofill"},aiAutofillDescription:{id:"feature.ai_autofill.description",defaultMessage:"Autofill properties with AI"},aiTranslationName:{id:"feature.ai_translation.name",defaultMessage:"AI translation"},aiTranslationDescription:{id:"feature.ai_translation.description",defaultMessage:"Translate pages with AI"},aiKeywordsName:{id:"feature.ai_keywords.name",defaultMessage:"AI keywords"},aiKeywordsDescription:{id:"feature.ai_keywords.description",defaultMessage:"Extract keywords with AI"}}),g={type:"customizeMenu",uri:"notion://feature/ai_summary_feature",name:d.default.formatMessage(p.aiSummaryName),description:d.default.formatMessage(p.aiSummaryDescription),icon:"",isAi:!0,tooltipImage:{img:n.Z.images.tooltips.properties.aiAutofillSummaryPng,scale:.5},collectionUri:i.iS,dependencies:[{uri:"notion://feature/ai_summary_property",type:"property",name:d.default.formatMessage(p.aiSummaryName),collectionUri:i.iS,propertySchema:{name:d.default.formatMessage(p.aiSummaryName),type:"text",ai_inference:{type:"summarize",auto_update_on_edit:!0}}}]},m={type:"customizeMenu",uri:"notion://feature/ai_custom_autofill_feature",name:d.default.formatMessage(p.aiAutofillName),description:d.default.formatMessage(p.aiAutofillDescription),icon:"",isAi:!0,tooltipImage:{img:n.Z.images.tooltips.properties.aiCustomAutofillPng,scale:.5},collectionUri:i.iS,dependencies:[{uri:"notion://feature/ai_custom_autofill_property",type:"property",name:d.default.formatMessage(p.aiAutofillName),collectionUri:i.iS,propertySchema:{name:d.default.formatMessage(p.aiAutofillName),type:"text",ai_inference:{type:"custom",prompt:"",auto_update_on_edit:!0}}}]},f={type:"customizeMenu",uri:"notion://feature/ai_translation_feature",name:d.default.formatMessage(p.aiTranslationName),description:d.default.formatMessage(p.aiTranslationDescription),icon:"",isAi:!0,tooltipImage:{img:n.Z.images.tooltips.properties.aiTranslationPng,scale:.5},collectionUri:i.iS,dependencies:[{uri:"notion://feature/ai_translation_property",type:"property",name:d.default.formatMessage(p.aiTranslationName),collectionUri:i.iS,propertySchema:{name:d.default.formatMessage(p.aiTranslationName),type:"text",ai_inference:{type:"translate",targetProperties:["title"],toLanguage:"english",auto_update_on_edit:!0}}}]},S={type:"customizeMenu",uri:"notion://feature/ai_keywords_feature",name:d.default.formatMessage(p.aiKeywordsName),description:d.default.formatMessage(p.aiKeywordsDescription),icon:"",isAi:!0,tooltipImage:{img:n.Z.images.tooltips.properties.aiKeywordsPng,scale:.5},collectionUri:i.iS,dependencies:[{uri:"notion://feature/ai_keywords_property",type:"property",name:d.default.formatMessage(p.aiKeywordsName),collectionUri:i.iS,propertySchema:{name:d.default.formatMessage(p.aiKeywordsName),type:"multi_select",select_ai_inference:{type:"multi_select",add_options:!0,auto_update_on_edit:!1}}}]},y=[g,f,S,m],h={[g.uri]:"ai_summary",[f.uri]:"ai_translate",[S.uri]:"ai_keywords",[m.uri]:"ai_custom_prompt"};function x(e){const{environment:t,feature:o,collectionContextStore:i}=e,n=h[o.uri],s=i.collectionStore(),d=i.getPropertyFormatKey();if(!s||!d)return;if(0===o.dependencies.length)return;const p=i.collectionViewStore();c.createAndCommit({userAction:"collectionSettingsFeatureActions.handleAddAiFeature",environment:t,perform:e=>{const c=o.dependencies[0].uri;l.G3({environment:t,collectionStore:s,collectionViewArgs:p?{collectionViewStore:p,format:p.getFormat(),formatKey:d}:void 0,propertyName:o.name,propertyType:n,selectOptions:void 0,propertyId:c,transaction:e}),a._H({environment:t,collectionContextStore:i,from:"view_settings",property_type:(0,r.TN)(n),property:n,is_suggested_property:!0,feature:{id:c,from:"customize_menu",type:n}})}}),(0,u.OV)({featureName:o.name})}},97842:(e,t,o)=>{o.d(t,{$e:()=>m,MG:()=>g,XR:()=>S,u_:()=>x,x1:()=>h,yM:()=>f});var i=o(886628),n=o(371663),r=o(841892),s=o(977657),a=o(401898),l=o(287085),c=o(932363),d=o(80444),u=o(530874),p=o(616924);const g="notion://feature/connection_",m=`${g}${s.f3}`,f=`${g}${s.mQ}`,S=`${g}${s.Nw}`,y={[s.f3]:r.Z.images.tooltips.properties.googleDrivePng,[s.mQ]:r.Z.images.tooltips.properties.figmaPng,[s.Nw]:r.Z.images.tooltips.properties.zendeskPng};function h(e){const t=(0,i.VK)((()=>{var e;return null===(e=d.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]),o=(0,i.VK)((()=>u.Z.integrations.state),[]);return(0,i.VK)((()=>t?s.tO.map((t=>{var i;const r=o.find((e=>e.id===t));if(!r)return;return{type:"customizeMenu",uri:`${g}${t}`,name:r.name,description:r.info.description,icon:r.info.icon,tooltipImage:{img:y[t],scale:.5},collectionUri:n.iS,dependencies:[{uri:`${g}property_${t}`,type:"property",name:r.name,isConnectedRelation:!0,integrationId:r.id,collectionUri:n.iS,propertySchema:{name:r.name,type:"relation",collection_id:null===(i=e.collectionStore())||void 0===i?void 0:i.id,connectedRelation:{integration_id:r.id}}}]}})).filter(a.$K):[]),[e,t,o])}function x(e){var t;const{environment:o,collectionContextStore:i,feature:n,intl:r}=e;if(0===n.dependencies.length||"property"!==n.dependencies[0].type)return;const s=n.dependencies[0],a=u.Z.integrations.state.find((e=>e.id===s.integrationId)),d=null==a||null===(t=a.info.original_url_patterns)||void 0===t?void 0:t.find((e=>{var t;return null===(t=e.additional_types)||void 0===t?void 0:t.connectedRelation}));if(!a||!d)return;const g={name:(0,c.ni)({pattern:d,integration:a}),pattern:d,integration:a};l.Jw({environment:o,collectionContextStore:i,connectedRelationProperty:g,intl:r,from:"customize_menu",untypedFeatureArgs:{propertyId:s.uri}}),(0,p.OV)({featureName:n.name})}},110172:(e,t,o)=>{o.d(t,{MG:()=>A,Xf:()=>G,ZJ:()=>q,fX:()=>L,k3:()=>Q});o(757658);var i=o(667294),n=o(800480),r=o(886628),s=o(371663),a=o(172111),l=o(10070),c=o(709291),d=o(653965),u=o(108406),p=o(805149),g=o(287085),m=o(210228),f=o(288833),S=o(416536),y=o(50570),h=o(644539),x=o(218011),v=o(388268),C=o(416732),b=o(272467),j=o(940663),w=o(337137),M=o(710274),_=o(195697),k=o(305971),V=o(80444),T=o(801310),P=o(616924),I=o(946113),F=o(97842),Z=o(191604);function A(e){return(0,r.VK)((()=>{var t;if(!e)return;const o=null===(t=e.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.app_config_uri;return o?(0,j.YB)((0,S.appConfigs)(),o):void 0}),[e])}function B(e){const{collectionFormat:t,feature:o}=e,i=t.app_config_uri;return o.collectionUri===i&&o.dependencies.some((e=>"property"===e.type&&e.collectionUri===i&&(0,a.Pf)(e.uri)))}function K(e){const{environment:t,collectionStore:o,collectionFormat:i,collectionViewBlockStore:n,feature:r}=e;if(1!==r.dependencies.length||"collection_view"!==r.dependencies[0].type)return!1;const s=r.dependencies[0];return s.collectionViewBlockUri===n.getFormat().app_config_uri&&s.collectionUri===i.app_config_uri&&(0,j.Ep)({environment:t,viewDependency:s,collectionStore:o})}function O(){const e=[];for(const t of b.OO)e.push({type:"appConfig",...t});return e}function L(e){const t=(0,n.O7)(),o=A(e),i=(0,k.E)("untyped_features"),a=(0,F.x1)(e);return(0,r.VK)((()=>{var n,r;const l=[{type:"appConfig",...(0,C.EG)()},{type:"appConfig",...(0,C.tQ)()},...i?O():I.rc,...a],c=(0,_.QI)()||(0,j.rm)();if(!o){return W([...l,...c?[Z.TS]:[]],s.br)}const u=null===(n=e.collectionStore())||void 0===n?void 0:n.getFormat(),p=null===(r=e.collectionStore())||void 0===r?void 0:r.getSchema(),g=e.collectionStore(),m=e.collectionViewBlockStore();if(!(u&&p&&g&&m))return[];const f={};o.allFeatures.forEach((e=>{(0,j.Dl)(e)&&e.variants.every((e=>Boolean(o.allFeatures.find((t=>t.uri===e&&(0,j.BQ)(t)&&B({collectionFormat:u,feature:t}))))))&&(f[e.uri]=e.variants)}));const S=Object.values(f).flat(),y=[];for(const e of o.allFeatures)if(!y.find((t=>t.uri===e.uri)))if(!S.find((t=>t===e.uri))&&(0,j.BQ)(e)){const o=B({collectionFormat:u,feature:e}),i=K({environment:t,collectionStore:g,collectionFormat:u,collectionViewBlockStore:m,feature:e});(o||i)&&y.push({type:"appConfig",...e})}else(0,j.Dl)(e)&&Boolean(f[e.uri])&&y.push({type:"appConfig",...e});const h=[...l,...y];c&&u.app_config_uri===Z.TS.collectionUri&&h.push(Z.TS);return W(d.mN(h,"uri"),e.databaseType)}),[t,o,a,e,i])}const R={[(0,C.EG)().uri]:1,[(0,C.tQ)().uri]:2,[Z.TS.uri]:3,[I.eG.uri]:4,[I.$m.uri]:5,[I.DM.uri]:6,[I.bw.uri]:7,[F.$e]:8,[F.yM]:9,[F.XR]:10},D={[(0,C.Mh)().uri]:0,[(0,C.EG)().uri]:1,[(0,C.tQ)().uri]:2,[Z.TS.uri]:3,[(0,C.PW)().uri]:4,[(0,C.FK)().uri]:5,[(0,C.bJ)().uri]:6,[I.eG.uri]:7,[I.$m.uri]:8,[I.DM.uri]:9,[I.bw.uri]:10,[(0,C.yt)().uri]:11,[(0,C.jJ)().uri]:12,[(0,C.iB)().uri]:13,[(0,C.oK)().uri]:14,[(0,C.AE)().uri]:15,[F.$e]:16,[F.yM]:17,[F.XR]:18},z={[(0,x.eh)().uri]:0,[(0,C.EG)().uri]:1,[(0,C.tQ)().uri]:2,[(0,x.LO)().uri]:3,[I.eG.uri]:4,[I.$m.uri]:5,[I.DM.uri]:6,[I.bw.uri]:7,[(0,x.xU)().uri]:8,[(0,x.QN)().uri]:9,[(0,x.LM)().uri]:10,[(0,x.f3)().uri]:11,[(0,x.Np)().uri]:12,[F.$e]:13,[F.yM]:14,[F.XR]:15},N={[(0,v.YI)().uri]:0,[(0,C.EG)().uri]:1,[(0,C.tQ)().uri]:2,[(0,x.LO)().uri]:3,[I.eG.uri]:4,[I.$m.uri]:5,[I.DM.uri]:6,[I.bw.uri]:7,[(0,v.Ez)().uri]:8,[F.$e]:9,[F.yM]:10,[F.XR]:11},E={[(0,C.EG)().uri]:1,[(0,C.tQ)().uri]:2,[(0,h.Gn)().uri]:3,[(0,h.nt)().uri]:4,[(0,h.Si)().uri]:5,[(0,h.Lm)().uri]:6,[(0,h.nt)().uri]:7,[(0,h.Hs)().uri]:8,[I.eG.uri]:9,[I.$m.uri]:10,[I.DM.uri]:11,[I.bw.uri]:12,[F.$e]:13,[F.yM]:14,[F.XR]:15},H={[(0,C.EG)().uri]:1,[(0,C.tQ)().uri]:2,[(0,y.Tg)().uri]:3,[(0,y.ir)().uri]:4,[I.eG.uri]:7,[I.$m.uri]:8,[I.DM.uri]:9,[I.bw.uri]:10,[F.$e]:11,[F.yM]:12,[F.XR]:13},U={[s.br]:R,[s.iS]:D,[s.wW]:z,[s.p$]:N,[s.Fi]:E,[s.zU]:H};function W(e,t){if(!t)return e;const o=U[t];return o?e.filter((e=>void 0!==o[e.uri])).sort(((e,t)=>(o[e.uri]??1/0)-(o[t.uri]??1/0))):e}function G(e,t){const o=A(e);return(0,r.VK)((()=>{const i=e.collectionStore(),n=e.collectionViewBlockStore(),r=[],s=[];if(!i||!n)return{addedFeatures:r,suggestedFeatures:s};for(const a of t){let t;if((0,j.BQ)(a)||(0,j.EU)(a))t=a;else{const e=q(a,null==o?void 0:o.allFeatures);if(0===e.length){console.error(`FeatureWithVariants ${a.name} has no variants.`);continue}t={type:a.type,...e[0]}}($({collectionStore:i,feature:t,collectionContextStore:e,collectionViewBlockStore:n})?r:s).push(a)}return{addedFeatures:r,suggestedFeatures:s}}),[t,o,e])}function $(e){var t;const{collectionStore:o,feature:i,collectionContextStore:n,collectionViewBlockStore:r}=e,s=null==o||null===(t=o.getFormat())||void 0===t?void 0:t.app_config_uri;if(i.uri===(0,C.EG)().uri)return Boolean(n.currentSubitemFormatStoreForCollectionStore.state);if(i.uri===(0,C.tQ)().uri){const e=(0,w.Xy)({feature:"timeline_arrows_by",collectionContextStore:n});return Boolean(e)}if("notion://feature/turn_into_tasks_feature"===i.uri)return i.collectionUri===s;if("customizeMenu"===i.type){var c;if(0===i.dependencies.length)return!1;const e=null===(c=n.collectionStore())||void 0===c?void 0:c.getSchema();return Object.keys(e??{}).includes(i.dependencies[0].uri)}const d=l.aQ.derivePropertyUris((null==o?void 0:o.getSchema())??{},null==o?void 0:o.getPropertyMapping());return i.dependencies.some((e=>{const t="property"===e.type&&function(e){const{dependency:t,collectionUri:o,propertyUris:i}=e;if(t.collectionUri===o)return(0,a.Pf)(t.uri)&&i.has(t.uri);if((0,a.Tx)(t.collectionUri))return(0,a.ky)(t.uri)&&i.has(t.uri);return!1}({dependency:e,collectionUri:s,propertyUris:d}),o="collection_view"===e.type&&function(e){const{dependency:t,collectionUri:o,collectionViewBlockStore:i}=e;var n,r;return t.collectionUri===o?t.collectionViewBlockUri===i.getFormat().app_config_uri&&t.uri in((null===(n=i.getFormat())||void 0===n?void 0:n.app_uri_map)??{}):!!(0,a.Tx)(t.collectionUri)&&t.uri in((null===(r=i.getFormat())||void 0===r?void 0:r.app_uri_map)??{})}({dependency:e,collectionUri:s,collectionViewBlockStore:r});return t||o}))}function q(e,t){return d.oA(e.variants.map((e=>{const o=null==t?void 0:t.find((t=>t.uri===e));if(o&&(0,j.BQ)(o))return o})))}function Q(e,t){const o=(0,n.O7)(),s=(0,c.useIntl)(),a=function(e){const t=(0,n.O7)(),o=A(e),s=(0,r.VK)((()=>V.default.state.currentSpaceViewStore),[]),a=(0,r.VK)((()=>e.collectionViewBlockStore()),[e]);return(0,i.useCallback)(((i,n)=>{if(!a||!o||!s)return;const r=a.getParentStore();if(!r||"block"!==r.table&&"space"!==r.table&&"team"!==r.table)return;if(1!==i.dependencies.length)return;const l=i.dependencies[0];m.createAndCommit({userAction:"CollectionViewSuggestedViews.createView",environment:t,perform:c=>{var d;f.applyTypedFeatures({environment:t,spaceViewStore:s,appParentStore:r,appUri:o.uri,features:[{type:"simple",featureUri:i.uri}],appCollectionViewBlockStores:[a],createOrModify:"modify",transaction:c});const p=((null===(d=a.getFormat())||void 0===d?void 0:d.app_uri_map)??{})[l.uri];M.f8({environment:t,collectionContextStore:e,collectionViewId:p,isFullScreen:e.isFullScreenStore.state,isRootChild:e.isRootChildStore.state,isInPeekRenderer:e.isInPeekRendererStore.state}),u.xb({environment:t,collectionContextStore:e,view_type:l.value.type,view_config_uri:i.uri,feature:{id:p,from:n,type:i.uri}})}})}),[a,o,s,t,e])}(e);return(0,i.useCallback)((async i=>{if("notion://tasks/sub_task_feature"===i.uri)p.H4({collectionSettingsStore:t,item:{type:"subitemV2",from:"customize_menu"}});else if("notion://tasks/task_dependencies_feature"===i.uri)p.H4({collectionSettingsStore:t,item:{type:"dependencies",from:"customize_menu"}});else if("notion://projects/tasks_with_sprints_feature"===i.uri)p.H4({collectionSettingsStore:t,item:{type:"sprintSettings",from:"customize_menu"}}),(0,P.OV)({featureName:i.name});else if("customizeMenu"===i.type)"notion://feature/turn_into_tasks_feature"===i.uri?(0,Z.iB)({environment:o,collectionContextStore:e}):i.isAi?(0,I.Ex)({environment:o,feature:i,collectionContextStore:e,collectionSettingsStore:t}):(0,F.u_)({environment:o,collectionContextStore:e,intl:s,feature:i});else{const t=i.dependencies[0];"collection_view"===t.type||"collection_view_block"===t.type||"sub_external_collection"===t.type?(a(i,"customize_menu"),T.ZP.setState({...T.ZP.state,shouldReset:!1}),(0,P.OV)({featureName:i.name})):(await g.G0({environment:o,feature:i,collectionContextStore:e,from:"customize_menu"}),(0,P.OV)({featureName:i.name}))}}),[o,s,e,t,a])}},191604:(e,t,o)=>{o.d(t,{TS:()=>f,bK:()=>x,iB:()=>S});o(667294);var i=o(724405),n=o(371663),r=o(841892),s=o(709291),a=o(108406),l=o(547307),c=o(210228),d=o(691851),u=o(433929),p=o(152489),g=o(785893);const m=(0,s.defineMessages)({taskName:{id:"feature.turnIntoTasks.name",defaultMessage:"Tasks"},taskDescription:{id:"feature.turnIntoTasks.description",defaultMessage:"See your tasks in Home, manage tasks in sprints, and more"}}),f={type:"customizeMenu",uri:"notion://feature/turn_into_tasks_feature",name:u.default.formatMessage(m.taskName),description:u.default.formatMessage(m.taskDescription),tooltipImage:{img:r.Z.images.tooltips.collectionSettings.turnIntoTasksPng,scale:.5},icon:"",collectionUri:n.iS,dependencies:[]};function S(e){const{collectionContextStore:t,environment:o}=e;p.Z.setState({isModalOpen:!0,databaseType:n.iS,collectionContextStore:t}),a.gd({environment:o,database_type:n.iS,collectionContextStore:t})}function y(){const e=(0,i.yK)((e=>({confirmationModalDescription:{fontSize:12,display:"flex",textAlign:"center"}})),[]);return(0,g.jsx)("span",{style:e.confirmationModalDescription,children:(0,g.jsx)(s.FormattedMessage,{id:"CollectionTaskTypeBadge.MoreMenu.RemoveFromHome.description",defaultMessage:"Tasks from this database will no longer appear in Home or work with Sprints."})})}function h(){const e=(0,i.yK)((e=>({confirmationModalTitle:{fontWeight:500},wrapper:{textAlign:"center"}})),[]);return(0,g.jsx)("div",{style:e.wrapper,children:(0,g.jsx)("span",{style:e.confirmationModalTitle,children:(0,g.jsx)(s.FormattedMessage,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.title",defaultMessage:"Undo Task Database?"})})})}function x(e){const{environment:t,collectionContextStore:o,isDisabled:i}=e,n=[{label:(0,g.jsx)(s.FormattedMessage,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.confirm",defaultMessage:"Remove"}),color:"red",onAccept:()=>{c.createAndCommit({environment:t,userAction:"CollectionTaskTypeBadge.untypeDatabase",perform:e=>{d.RQ({environment:t,collectionContextStore:o,transaction:e})}})}}];return{onClick:()=>{i||l.showDialog({message:(0,g.jsx)(h,{}),description:(0,g.jsx)(y,{}),showCancel:!0,keepFocus:!0,items:n})},isDisabled:i}}},590683:(e,t,o)=>{o.d(t,{a:()=>l});o(667294);var i=o(266897),n=o(401898),r=o(670301),s=o(45653),a=o(785893);function l(e){const{actor:t}=e,o={size:e.size??14,style:{marginRight:2,...e.style}};return(0,i.YU)(t)?(0,a.jsx)(r.Z,{botValue:t.asActor,...o}):(0,i.$S)(t)?(0,a.jsx)(s.Z,{userValue:t.asActor,...o}):(0,i.Iq)(t)?(0,a.jsx)(s.Z,{userValue:void 0,...o}):void(0,n.t1)(t)}},170289:(e,t,o)=>{o.d(t,{I:()=>n});var i=o(841892);const n={[o(406695).Vj.Jira]:i.Z.images.externalIntegrations.jiraPng}},768657:(e,t,o)=>{o.d(t,{Cl:()=>g,NY:()=>m});var i=o(667294),n=o(800480),r=o(886628),s=o(471924),a=o(421202),l=(o(76233),o(653965)),c=o(307032),d=o(484398),u=o(319385),p=o(206258);function g(e){const{initialValue:t,onChange:o,source:u="title",parentCollectionStore:g}=e,m=(0,n.O7)(),f=(0,d.$)("formulaPrototypeHelpers.useMockTextStore",{isMockTextStore:!0,overrideDefaultRecordCache:!0}),S=function(e){const{initialValue:t,inMemoryRecordCache:o,source:r,parentCollectionStore:l}=e,d=(0,n.O7)(),u=(0,i.useMemo)((()=>t),[]);return(0,i.useMemo)((()=>{const e={id:s.Il(),table:a.iU};o.setRecord({pointer:e,userId:d.currentUser.id},{value:{alive:!0,id:e.id,parent_id:(null==l?void 0:l.id)??c._6,parent_table:"block",properties:{[r]:u},space_id:(null==l?void 0:l.getSpaceId())??c._6,type:"page",version:0},role:"editor"});const t=new p.ST({environment:d,path:["properties",r],pointer:e,recordStoreOptions:{inMemoryRecordCache:o,userId:d.currentUser.id}});return o.emitRecord(e,[]),t}),[d,o,u,l,r])}({initialValue:t,inMemoryRecordCache:f,source:u,parentCollectionStore:g}),y=(0,i.useRef)(t),h=(0,i.useCallback)((e=>{const t=m.currentUser.id,o=S.getRecordStoreAtRootPath();if(o instanceof p.G){const i=o.getValue();i&&(f.setRecord({pointer:S.pointer,userId:t},{role:"editor",value:{...i,properties:{...null==i?void 0:i.properties,[u]:e}}}),f.emitRecord(S.pointer,[]))}}),[m.currentUser.id,S,f,u]);return(0,r.VK)((()=>{const e=S.getValue();l.Xy(y.current,e)||(y.current=e,null==o||o(e))}),[S,o]),{store:S,setValue:h}}function m(){return u.default.checkGate({gateName:"formula_buttons"})}},125811:(e,t,o)=>{o.d(t,{Z:()=>y});var i=o(667294),n=o(800480),r=o(886628),s=o(371663),a=o(396367),l=o(421202),c=o(139927),d=o(76233),u=o(940470),p=o(401898),g=o(268305),m=o(436821),f=o(210228),S=o(206258);function y(e){var t;const{collectionContextStore:o,from:y}=e,h=(0,n.O7)(),x=(0,r.VK)((()=>o.sprintSettingsContextStore.state),[o.sprintSettingsContextStore]),v=(0,r.VK)((()=>null==x?void 0:x.permissionsContext),[x]),C=(0,r.VK)((()=>{var e;return Boolean(null==x||null===(e=x.automationContext)||void 0===e?void 0:e.automationStore.isActive())}),[null==x||null===(t=x.automationContext)||void 0===t?void 0:t.automationStore]),b=(0,r.VK)((()=>{var e;return o.collectionStore()===(null==x?void 0:x.taskCollectionStore)&&(null===(e=o.collectionViewStore())||void 0===e?void 0:e.getFormat().app_config_uri)!==s.g3}),[o,null==x?void 0:x.taskCollectionStore]),[j,w]=(0,i.useState)(void 0);(0,i.useEffect)((()=>{!async function(){if(w(void 0),!x)return;const{sprintCollectionViewBlockStore:e,sprintCollectionStore:t}=x;if(!e||!t)return;const o=t.getSchema(),i=a.qB[s.p$].current.reducer,n=await g.tA(h,{source:"automation",parentRecordStore:e,collectionPointer:t.getSpaceShardedPointer(),filter:i.getCombinatorFilter(o),limit:1});u.x.isFail(n)||w(n.value.blockIds[0])}()}),[h,x]);const M=(0,r.VK)((()=>{const e=null==x?void 0:x.sprintCollectionViewBlockStore;if(e&&j)return S.G.createChildStore(e,{id:j,table:l.iU,spaceId:e.getSpaceId()})}),[j,null==x?void 0:x.sprintCollectionViewBlockStore]),_=(0,r.VK)((()=>{if(!M)return;const e=M.getPropertyValue(s.b0.Dates);if(!e)return;const t=(0,d.nai)(e)[0];return t&&"daterange"===t.type?t:void 0}),[M]),k=(0,r.VK)((()=>{var e,t,o;if(!x)return;const i=(null===(e=x.automationContext)||void 0===e||null===(e=e.automationActionStore.getConfig())||void 0===e?void 0:e.complete_sprint_action)??c.iZ.actionConfig.complete_sprint_action,n=Boolean(null===(t=x.automationContext)||void 0===t?void 0:t.automationStore.isActive()),r=null===(o=x.automationContext)||void 0===o?void 0:o.automationStore.getRecurrence();return{autoCompleteSprints:n,actionConfig:{complete_sprint_action:i},recurrenceConfig:{interval:(null==r?void 0:r.interval)??c.iZ.recurrenceConfig.interval,weekdays:(null==r?void 0:r.weekdays)??c.iZ.recurrenceConfig.weekdays}}}),[x]),V=(0,r.VK)((()=>(0,p.$K)(M)&&(0,p.$K)(k)),[M,k]),T=i.useCallback((e=>{V&&f.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:h,perform:t=>{x&&x.sprintCollectionStore&&x.automationContext&&M&&m.KV({environment:h,transaction:t,automationStore:x.automationContext.automationStore,currentSprintBlockStore:M,newDuration:e})}})}),[V,M,h,x]),P=i.useCallback((e=>{V&&f.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:h,perform:t=>{x&&x.sprintCollectionStore&&x.automationContext&&M&&m.g9({environment:h,transaction:t,automationStore:x.automationContext.automationStore,currentSprintBlockStore:M,newWeekday:e})}})}),[V,M,h,x]),I=i.useCallback((e=>{V&&f.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:h,perform:t=>{x&&x.sprintCollectionStore&&x.automationContext&&M&&m.jc({environment:h,transaction:t,automationStore:x.automationContext.automationStore,actionStore:x.automationContext.automationActionStore,currentSprintBlockStore:M,newAutocompleteStatus:e})}})}),[V,M,h,x]),F=i.useCallback((e=>{V&&f.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:h,perform:t=>{x&&x.sprintCollectionStore&&x.automationContext&&m.U6({transaction:t,actionStore:x.automationContext.automationActionStore,newRemainingTasksBehavior:e})}})}),[V,h,x]),Z=i.useCallback((async()=>{await m.ys({environment:h,collectionContextStore:o,from:y})}),[h,o,y]),A=i.useCallback((async e=>{x&&await m.m8({environment:h,collectionContextStore:o,sprintSettingsContext:x,sprintBoardViewBlockIds:e})}),[o,h,x]),B=i.useCallback((()=>{x&&m.YD({environment:h,collectionContextStore:o,currentViewBlockStore:x.currentCollectionViewBlockStore,taskCollectionViewBlockStore:x.taskCollectionViewBlockStore})}),[o,h,x]);return{sprintSettingsConfig:k,sprintSettingsPermissionsContext:v,turnOnSprints:Z,turnOffSprints:A,automaticSprintCompletionEnabled:C,canManageSprintFromThisView:b,currentSprintDateRange:_,manageSprintFromThisView:B,sprintSettingsConfigUpdater:{canUpdateSprintSettingsConfig:V,handleSprintDurationChange:T,handleSprintStartWeekdayChange:P,handleSprintAutoCompleteChange:I,handleSprintRemainingTasksBehaviorChange:F}}}},484398:(e,t,o)=>{o.d(t,{$:()=>s});var i=o(667294),n=o(126263),r=o(800480);function s(e,t){const{cacheFallback:o,isMockTextStore:s,isTemporaryData:a,onOperationCallback:l,overrideDefaultRecordCache:c}=t??{},d=(0,r.O7)(),{inMemoryRecordCache:u}=d.defaultRecordCache,p=(0,i.useMemo)((()=>{const t=new n.Z({isTemporaryData:Boolean(a),name:e,onOperationCallback:l});return t.isMockTextStore=Boolean(s),o&&t.addCacheFallback(o),c&&u.addCacheOverride(t),t}),[o,u,s,a,e,l,c]);return(0,i.useEffect)((()=>function(){o&&p.removeCacheFallback(o),c&&u.removeCacheOverride(p)}),[o,u,p,c]),p}},212205:(e,t,o)=>{o.d(t,{J:()=>r});var i=o(886628),n=o(80444);function r(){const{currentSpaceStore:e}=(0,i.Kw)(n.default);return(0,i.VK)((()=>(null==e?void 0:e.canAdmin())??!1),[e])}},582787:(e,t,o)=>{o.d(t,{Z:()=>d});var i=o(667294),n=o(886628),r=o(433422),s=o(145953),a=o(210228),l=o(503932),c=o(80444);function d(e){let{unpersistedInMemoryRecordCache:t}=e;const o=(0,n.VK)((()=>{var e;return null===(e=c.default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]);return{createAndCommit:(0,i.useCallback)((e=>{let{perform:i}=e;const n=new l.Y({deadlockTimeoutMs:a.DEADLOCK_WARNING_TIMEOUT_MS}),c=i(n),d=s.Ak.create();n.stores.forEach((e=>{const t=e.getRecordModel(e.pointer);t&&d.addModel(t)})),(0,r.FS)({operations:n.operations,recordMap:d,updateOnly:!1});for(const r of d){const{model:e,pointer:i}=r;t.setModelAndRole({pointer:i,userId:o},e,"editor")}return t.emitAll(),{performResult:c,serverCommitResult:Promise.resolve()}}),[t,o])}}},287578:(e,t,o)=>{o.d(t,{s:()=>d});o(21703),o(252262),o(324506);var i=o(195586),n=o(652136),r=o(912398);var s=o(940470),a=o(401898),l=o(210228),c=o(571960);function d(e){var t;let{environment:o,transaction:d,layoutStore:u,position:p,module:g,sessionId:m}=e;const f=null===(t=u.getModules())||void 0===t?void 0:t[p.area];if(void 0===f)throw new Error("Expected area to be initialized.");const S=function(e){let{location:t,modulesInArea:o,area:i}=e;switch(t.type){case"end":return{command:"after",moduleToPositionRelativeTo:o[o.length-1]};case"start":return{moduleToPositionRelativeTo:o[0],command:"before"};case"afterIndex":return{moduleToPositionRelativeTo:o[t.index],command:"after"};case"afterModuleId":if(!t.moduleId)return{moduleToPositionRelativeTo:o.length>0?o.at(-1):void 0,command:"after"};const e=o.find((e=>e.id===t.moduleId));if(!e)throw new Error(`No module found with ID ${t.moduleId}`);return{moduleToPositionRelativeTo:e,command:"after"};case"endConfigurable":let s;for(const t of o)(0,r.s$)((0,n.cm)(t))&&(s=t);if(s)return{command:"after",moduleToPositionRelativeTo:s};if("page_main"===i)return{moduleToPositionRelativeTo:{id:"title_with_icon",type:"titleWithIcon"},command:"after"};if("page_details"===i||"form_layout_schema"===i)return{moduleToPositionRelativeTo:void 0,command:"after"};(0,a.t1)(i);break;default:(0,a.t1)(t)}}({location:p.location,modulesInArea:f,area:p.area}),y=function(e){let{moduleToAdd:t,addToPosition:o,existingModules:i,area:n}=e;const s=i.findIndex((e=>{var t;return e.id===(null===(t=o.moduleToPositionRelativeTo)||void 0===t?void 0:t.id)}));if("page_main"===n){if("cover"===t.type)return{error:new Error("Unable to add the cover module")};if("titleWithIcon"===t.type)return{error:new Error("Unable to add the title with icon module")};if("editor"===t.type)return{error:new Error("Unable to add the editor module")};if("discussions"===t.type)return{error:new Error("Unable to add the discussions module")};if("bottomControls"===t.type)return{error:new Error("Unable to add the bottom controls module")};if("expandedBacklinks"===t.type)return{error:new Error("Unable to add the backlinks module")};if((0,r.f)(t)&&s<2&&"before"===o.command)return{error:new Error("Can't add property module before cover or title with icon modules")}}return{value:!0}}({moduleToAdd:g,addToPosition:S,existingModules:f,area:p.area});if(!s.x.isSuccess(y))throw y.error;let h;if(S.moduleToPositionRelativeTo)"before"===S.command?h={command:"keyedObjectListBefore",pointer:u.pointer,path:["modules",(0,i.e)(p.area)],args:{value:(0,n.cm)(g),before:{id:S.moduleToPositionRelativeTo.id}}}:"after"===S.command?h={command:"keyedObjectListAfter",pointer:u.pointer,path:["modules",(0,i.e)(p.area)],args:{value:(0,n.cm)(g),after:{id:S.moduleToPositionRelativeTo.id}}}:(0,a.t1)(S);else{if(0!==f.length)throw new Error("Append operation should only be used in empty area");h={command:"keyedObjectListAfter",pointer:u.pointer,path:["modules",(0,i.e)(p.area)],args:{value:(0,n.cm)(g)}}}function x(e){l.applyOperation({transaction:e,store:u,operation:h})}d?x(d):l.createAndCommit({environment:o,perform(e){x(e)},userAction:"BuilderLayoutModules.add"}),c.Ry({environment:o,module:g,sessionId:m})}},152840:(e,t,o)=>{o.d(t,{Dt:()=>s,J9:()=>a,PP:()=>c,eK:()=>l});o(21703);var i=o(667294),n=o(886628),r=o(566890);const s=(0,i.createContext)(null);function a(){const e=(0,i.useContext)(s);if(!e)throw new Error("usePageLayoutEditorContext must be used inside BaseLayoutEditorContextProvider");return(0,i.useMemo)((()=>e),[e])}s.displayName="BaseLayoutEditorContext";const l=(0,i.createContext)(null);function c(){const e=(0,i.useContext)(l),t=(0,r.Y$)(),o=(0,n.VK)((()=>t.collectionStore()),[t]);if(!e)throw new Error("usePageLayoutEditorContext must be used inside PageLayoutEditorContextProvider");if(!o)throw new Error("Error opening PageLayoutEditor: Could not find collection");return(0,i.useMemo)((()=>({...e,collectionStore:o})),[e,o])}l.displayName="PageLayoutEditorContext"},6429:(e,t,o)=>{o.d(t,{K:()=>d});var i=o(667294),n=o(800480),r=o(886628),s=o(195586),a=o(287578),l=o(571960),c=o(152840);function d(){const{layoutStore:e,currentModuleSelection:t,setModuleSelection:o,sessionId:d}=(0,c.J9)(),u=(0,n.O7)(),p="form"===(0,r.VK)((()=>{var t;return null===(t=e.getModel())||void 0===t?void 0:t.getLayoutType()}),[e])?"form_layout_schema":"new_module"===(null==t?void 0:t.type)?t.area:void 0;return(0,i.useCallback)((t=>{const{layoutModule:i}=t;if(!e.getModel()||!p)return;const n=t.position??("page_layout_schema"===p?{area:"page_main",location:{type:"endConfigurable"}}:{area:(0,s.G)(p),location:{type:"end"}});(0,a.s)({environment:u,sessionId:d,layoutStore:e,position:n,module:i}),l.Ry({environment:u,module:i,sessionId:d}),o({type:"existing_module",moduleId:i.id,isDragging:!1})}),[p,u,e,d,o])}},343882:(e,t,o)=>{o.d(t,{G:()=>l});var i=o(667294),n=o(195586),r=o(215828),s=o(6429),a=o(152840);function l(e){const{setModuleSelection:t,layoutStore:o}=(0,a.J9)(),l=(0,s.K)();return(0,i.useCallback)((()=>{var i;"form"===(null===(i=o.getModel())||void 0===i?void 0:i.getLayoutType())?l({layoutModule:{type:"placeholder",id:(0,r.ZP)()},position:{area:(0,n.G)(e.area),location:{type:"afterModuleId",moduleId:e.afterModuleId}}}):t({type:"new_module",area:e.area,isDragging:!1})}),[l,e.area,o,t,e.afterModuleId])}},183154:(e,t,o)=>{o.d(t,{Z:()=>d});var i=o(667294),n=o(724405),r=o(356666),s=o(709291),a=o(164921),l=o(785893);function c(e){let{...t}=e;const o=(0,s.useIntl)(),i=(0,n.yK)((e=>({buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,height:24,width:24},threeDotIcon:{width:12,height:12,fill:e.mediumIconColor}})),[]),c=o.formatMessage({defaultMessage:"View options",id:"PersonalHomePanel.moreDropdownButton.tooltip"});return(0,l.jsx)(a.Z,{ariaLabel:c,style:i.buttonStyle,mobileFeedback:!1,...t,children:(0,r.o)(i.threeDotIcon)})}const d=i.memo(c)},33311:(e,t,o)=>{o.d(t,{Iu:()=>y,P2:()=>h,ZP:()=>v});var i=o(667294),n=o(724405),r=o(44643),s=o(709291),a=o(401898),l=o(552275),c=o(231945),d=o(478140),u=o(632163),p=o(672495),g=o(460709),m=o(861931),f=o(183154),S=o(785893);const y=(0,s.defineMessages)({hide:{id:"PersonalHomePanel.moreDropdown.hide.title",defaultMessage:"Hide from Home"}}),h=20;function x(e){let{actions:t}=e;const o=(0,n.yK)((e=>({hideButtonIcon:{height:h,width:h,fill:e.regularIconColor}})),[]),x=(0,s.useIntl)(),v=(0,i.useMemo)((()=>{const e={};return t.forEach((t=>{"custom"===t.type&&(e[t.item.key]=t.closeOnAccept)})),e}),[t]),C=[{key:"all",render:e=>(0,S.jsx)(p.Z,{...e}),items:t.map((e=>{switch(e.type){case"hide":return{key:"hide",render:e=>(0,S.jsx)(l.Z,{...e,icon:(0,r.L)(o.hideButtonIcon),title:x.formatMessage(y.hide),style:{borderRadius:m.bS}}),action:e.hide};case"custom":return e.item;default:(0,a.t1)(e)}}))}];return(0,S.jsx)(c.ZP,{popupType:c.Z4.Popup,alignmentToOrigin:c.vR.Center,originGap:2,renderOrigin:e=>(0,S.jsx)(f.Z,{...e}),render:e=>(0,S.jsx)(d.Z,{menuType:g.og.Popup,children:(0,S.jsx)(u.Z,{onAccept:t=>((e,t)=>{v[e.key]&&t.close()})(t,e),type:u.i.Vertical,sections:C,initialFocus:void 0})})})}const v=i.memo(x)},344496:(e,t,o)=>{o.d(t,{q:()=>n});const i={greeting:!0,tasks:!1,tips:!1,templates:!1,calendar:!1,custom_db:!1,checklist:!1};function n(e){const t=(null==e?void 0:e.getHomeEnabledFeatures())??{};return{...i,...t}}},183089:(e,t,o)=>{o.d(t,{Z:()=>r});var i=o(535431);class n extends i.Z{findModuleContainer(e){let{layoutStore:t,moduleId:o}=e;return this.find((e=>e.layoutStore===t&&e.moduleId===o))}}const r=new n},168910:(e,t,o)=>{o.d(t,{L:()=>u});var i=o(14577),n=o(335102),r=o(606287),s=o(653965),a=o(940470),l=o(401898),c=o(849117),d=o(206258);class u{constructor(e){this.context=void 0,this.compilationResultStore=new i.Z((()=>(0,c.pt)({context:this.context})),{useDeepEqual:!0,debugName:"compilationResultsStore"}),this.context=e}getAllContextValues(){const e=this.compilationResultStore.state;return a.x.isFail(e)?[]:s.d9(e.value.valueTypes)}getCollectionStore(){const e=this.context;if("button_block"===e.type)return e.pageStore.getAssociatedCollectionStore();if("button_property"===e.type)return e.collectionContextStore.collectionStore();if("event"===e.type)return d.NW.createChildStore(e.parentRecordStore,e.parentPointer);if("recurrence"!==e.type)if("assistant"===e.type){if(e.parentPointer.table===r.vF)return d.NW.createChildStore(e.parentRecordStore,e.parentPointer)}else(0,l.t1)(e)}getContextValuesForAction(e){const t=this.compilationResultStore.state;return a.x.isFail(t)?[]:t.value.actionInputValueTypes[e]??[]}getValidationErrorsForAction(e){const t=this.compilationResultStore.state;return a.x.isFail(t)?[]:t.value.actionValidationFailures[e]??[]}getContextValueForActionById(e,t){const o=this.getContextValuesForAction(e);return(0,n.vx)(o,t)}}},628410:(e,t,o)=>{o.d(t,{Th:()=>n,fJ:()=>s,mc:()=>a});var i=o(401898);const n=12e3,r=["development","exploratory","wild_west"],s=(0,i.AO)((e=>(0,i.DE)(r,e)?{true:e}:{false:e})),a=["openai-gpt-4t","openai-gpt-4o","anthropic-haiku","anthropic-sonnet","anthropic-opus"],l=["openai-1.1","openai-2","openai-4","openai-5","openai-6","openai-7","openai-8","openai-10","openai-11","openai-assistant-current","openai-12","openai-qna-enhanced-with-router","openai-assistant-with-router","openai-dedicated-base","openai-gpt-4t","openai-gpt-4o","gpt-3.5t-blended-recall"];const c=["anthropic-1","anthropic-2","anthropic-qa-alpha","anthropic-3","anthropic-haiku","anthropic-sonnet","anthropic-opus"]},37652:(e,t,o)=>{o.d(t,{V:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("arrowLeft",{viewBox:"0 0 30 30",svg:(0,n.jsx)("polygon",{points:"29 14 4.813 14 13.406 5.406 12 4 1 15 12 26 13.406 24.594 4.813 16 29 16"})})},622771:(e,t,o)=>{o.d(t,{J:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("arrowsConverging",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M4.47949 13.2667C4.27441 13.2667 4.11263 13.2006 3.99414 13.0684C3.88021 12.9408 3.82324 12.7881 3.82324 12.6104C3.82324 12.3552 3.9349 12.1569 4.1582 12.0157L4.70508 11.667C4.94206 11.5075 5.20866 11.2956 5.50488 11.0313C5.80566 10.7624 6.09277 10.4594 6.36621 10.1221C6.64421 9.78488 6.87207 9.42485 7.0498 9.04204C7.22754 8.65923 7.31641 8.27414 7.31641 7.88677V4.46196H8.67676V7.88677C8.67676 8.27414 8.76562 8.65923 8.94336 9.04204C9.12109 9.42485 9.34668 9.78716 9.62012 10.129C9.89355 10.4662 10.1807 10.767 10.4814 11.0313C10.7822 11.2956 11.0511 11.5075 11.2881 11.667L11.835 12.0157C12.0583 12.1569 12.1699 12.3552 12.1699 12.6104C12.1699 12.7972 12.1107 12.9522 11.9922 13.0752C11.8737 13.2028 11.7119 13.2667 11.5068 13.2667C11.3109 13.2667 11.1195 13.2051 10.9326 13.0821L10.5771 12.8428C10.3447 12.6879 10.0941 12.4942 9.8252 12.2618C9.56087 12.0248 9.30339 11.7741 9.05273 11.5098C8.80208 11.2455 8.58333 10.9903 8.39648 10.7442C8.20964 10.4981 8.07975 10.2839 8.00684 10.1016H7.98633C7.91341 10.2839 7.78125 10.5004 7.58984 10.751C7.40299 10.9971 7.18424 11.2523 6.93359 11.5167C6.68294 11.7764 6.42318 12.0248 6.1543 12.2618C5.88997 12.4942 5.64388 12.6879 5.41602 12.8428L5.06055 13.0821C4.8737 13.2051 4.68001 13.2667 4.47949 13.2667ZM6.29102 5.36431C6.02669 5.36431 5.86263 5.28228 5.79883 5.11821C5.73503 4.95415 5.77832 4.76502 5.92871 4.55083L7.5625 2.26079C7.68555 2.08306 7.83138 1.99647 8 2.00103C8.16862 2.00103 8.31445 2.08761 8.4375 2.26079L10.0576 4.55767C10.2126 4.7673 10.2559 4.95415 10.1875 5.11821C10.1237 5.28228 9.96191 5.36431 9.70215 5.36431H6.29102Z"})})},193078:(e,t,o)=>{o.d(t,{O:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("arrowsLeftRight",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M13.7791 3.59799C13.9305 3.74539 14.004 3.9196 13.9998 4.1206C13.9998 4.32607 13.9263 4.50251 13.7791 4.64992L10.5317 8.0268C10.3888 8.1742 10.2269 8.24791 10.0462 8.24791C9.84861 8.24791 9.68676 8.1809 9.56065 8.0469C9.43874 7.91736 9.37779 7.74986 9.37779 7.54439C9.37779 7.34785 9.44295 7.18481 9.57326 7.05528L10.9227 5.66834L11.8937 4.77722L10.5506 4.83082L2.66857 4.83082C2.4752 4.83082 2.31546 4.76382 2.18935 4.62982C2.06323 4.49581 2.00018 4.32831 2.00018 4.1273C2.00018 3.91736 2.06323 3.74539 2.18935 3.61139C2.31546 3.48185 2.4752 3.41708 2.66857 3.41708L10.5506 3.41709L11.8937 3.47069L10.9227 2.57286L9.57326 1.19263C9.44295 1.05863 9.37779 0.893355 9.37779 0.696817C9.37779 0.491345 9.43874 0.323841 9.56065 0.194305C9.68676 0.0647681 9.84861 -1.81463e-07 10.0462 -1.72827e-07C10.2269 -1.64925e-07 10.3888 0.0737017 10.5317 0.221105L13.7791 3.59799ZM2.21457 12.4087C2.06744 12.2568 1.99597 12.0804 2.00018 11.8794C2.00018 11.6784 2.07164 11.5042 2.21457 11.3568L5.47459 7.9799C5.61331 7.8325 5.77516 7.75879 5.96012 7.75879C6.1577 7.75879 6.31744 7.82356 6.43935 7.9531C6.56126 8.0871 6.62222 8.25684 6.62222 8.46231C6.62222 8.65438 6.55916 8.81742 6.43305 8.95142L5.08364 10.3317L4.10626 11.2295L5.44937 11.1759L13.3314 11.1759C13.5248 11.1759 13.6845 11.2429 13.8107 11.3769C13.9368 11.5109 13.9998 11.6784 13.9998 11.8794C13.9998 12.0849 13.9368 12.2546 13.8107 12.3886C13.6845 12.5226 13.5248 12.5896 13.3314 12.5896L5.44937 12.5896L4.10626 12.536L5.08364 13.4338L6.43305 14.8141C6.55916 14.9436 6.62222 15.1066 6.62222 15.3032C6.62222 15.5087 6.56126 15.6762 6.43935 15.8057C6.31744 15.9352 6.1577 16 5.96012 16C5.77516 16 5.61331 15.9285 5.47459 15.7856L2.21457 12.4087Z"})})},605336:(e,t,o)=>{o.d(t,{r:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("basicClock",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M4.541 7.919a.53.53 0 01-.39-.157.53.53 0 01-.157-.39c0-.155.053-.282.157-.383a.53.53 0 01.39-.157h2.905V2.895c0-.15.053-.278.158-.383a.521.521 0 01.382-.158.53.53 0 01.39.158.521.521 0 01.157.383v4.477a.53.53 0 01-.157.39.53.53 0 01-.39.157H4.541zm3.452 6.207a6.789 6.789 0 01-2.727-.554 7.124 7.124 0 01-2.256-1.524 7.277 7.277 0 01-1.525-2.256 6.788 6.788 0 01-.553-2.728c0-.966.184-1.875.553-2.727A7.241 7.241 0 015.258.557 6.788 6.788 0 017.987.003c.971 0 1.882.184 2.735.554.852.369 1.604.88 2.256 1.53a7.136 7.136 0 011.53 2.25c.37.852.555 1.761.555 2.727 0 .967-.185 1.876-.554 2.728a7.218 7.218 0 01-3.787 3.78 6.789 6.789 0 01-2.728.554zm0-1.395c.789 0 1.525-.145 2.208-.437a5.678 5.678 0 001.805-1.217 5.68 5.68 0 001.217-1.805c.291-.683.437-1.42.437-2.208a5.55 5.55 0 00-.437-2.2 5.66 5.66 0 00-3.029-3.029 5.567 5.567 0 00-2.208-.438c-.784 0-1.52.146-2.208.438A5.6 5.6 0 003.98 3.052a5.715 5.715 0 00-1.21 1.811 5.55 5.55 0 00-.437 2.201c0 .789.146 1.525.438 2.208a5.735 5.735 0 001.21 1.805 5.598 5.598 0 004.013 1.654z"})})},271800:(e,t,o)=>{o.d(t,{N:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("characterCursor",{viewBox:"0 0 16 15",svg:(0,n.jsx)("path",{d:"M1.67676 12.6641C1.44434 12.6641 1.25977 12.6003 1.12305 12.4727C0.990885 12.3451 0.924805 12.1696 0.924805 11.9463C0.924805 11.7913 0.954427 11.6364 1.01367 11.4814L4.04883 3.29883C4.24935 2.73372 4.64355 2.45117 5.23145 2.45117C5.54134 2.45117 5.79427 2.52181 5.99023 2.66309C6.1862 2.7998 6.33659 3.014 6.44141 3.30566L9.45605 11.4473C9.51986 11.625 9.55176 11.7868 9.55176 11.9326C9.55176 12.1559 9.48112 12.3337 9.33984 12.4658C9.19857 12.598 9.00716 12.6641 8.76562 12.6641C8.53776 12.6641 8.36003 12.6117 8.23242 12.5068C8.10482 12.4066 8.00456 12.238 7.93164 12.001L7.16602 9.88184H3.2832L2.52441 12.001C2.44694 12.238 2.3444 12.4066 2.2168 12.5068C2.08919 12.6117 1.90918 12.6641 1.67676 12.6641ZM3.67285 8.61035H6.79688L5.25195 4.18066H5.21094L3.67285 8.61035ZM10.5225 14.8174C10.1442 14.8174 9.95508 14.6579 9.95508 14.3389C9.95508 14.0199 10.1442 13.8604 10.5225 13.8604H11.9717V1.22754H10.5225C10.1442 1.22754 9.95508 1.06803 9.95508 0.749023C9.95508 0.43457 10.1442 0.277344 10.5225 0.277344H14.4941C14.877 0.277344 15.0684 0.43457 15.0684 0.749023C15.0684 1.06803 14.877 1.22754 14.4941 1.22754H13.0723V13.8604H14.4941C14.877 13.8604 15.0684 14.0199 15.0684 14.3389C15.0684 14.6579 14.877 14.8174 14.4941 14.8174H10.5225Z"})})},866196:(e,t,o)=>{o.d(t,{B:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("chartAxisName",{viewBox:"0 0 20 20",svg:(0,n.jsx)("g",{children:(0,n.jsx)("path",{d:"M2.71 12.742c-.417 0-.786-.078-1.106-.234a1.833 1.833 0 01-.756-.662 1.8 1.8 0 01-.276-.996c0-.555.205-.996.616-1.325.414-.332 1.001-.517 1.763-.556l1.817-.106v-.48c0-.383-.122-.684-.364-.903-.238-.222-.566-.334-.984-.334-.352 0-.647.075-.885.223-.234.149-.435.381-.603.697a.613.613 0 01-.217.2.61.61 0 01-.287.064.562.562 0 01-.387-.135.481.481 0 01-.146-.363c0-.066.007-.133.023-.2A1.53 1.53 0 011 7.422c.164-.379.467-.682.908-.908.442-.227.957-.34 1.547-.34.516 0 .961.088 1.336.263.379.176.67.422.873.739.207.316.31.69.31 1.119v3.838c0 .195-.054.348-.163.457a.57.57 0 01-.422.158.595.595 0 01-.422-.152.562.562 0 01-.164-.41v-.657h-.03a1.92 1.92 0 01-.498.65 2.32 2.32 0 01-.72.417c-.27.097-.551.146-.844.146zm.33-.932c.32 0 .608-.068.866-.205.262-.136.47-.32.627-.55.156-.235.235-.496.235-.785v-.592l-1.653.111c-.418.027-.74.133-.967.316a.855.855 0 00-.34.704c0 .3.114.543.34.726.23.184.528.275.891.275zm4.651.932a.578.578 0 01-.427-.158c-.106-.105-.159-.254-.159-.445V4.627a.63.63 0 01.165-.457.591.591 0 01.445-.176c.18 0 .324.059.433.176.114.113.17.266.17.457v2.889h.036c.18-.41.45-.735.814-.973a2.263 2.263 0 011.26-.357c.539 0 1.007.134 1.406.404.398.265.707.644.926 1.137.219.492.328 1.072.328 1.74 0 .668-.11 1.248-.328 1.74-.215.492-.524.871-.926 1.137-.402.265-.873.398-1.412.398-.488 0-.914-.117-1.277-.351a2.266 2.266 0 01-.827-.967h-.023v.715a.59.59 0 01-.17.445.598.598 0 01-.434.158zm2.403-1.002c.355 0 .664-.092.926-.275a1.75 1.75 0 00.603-.785c.14-.34.211-.744.211-1.213 0-.461-.072-.862-.217-1.201a1.743 1.743 0 00-.603-.786 1.522 1.522 0 00-.92-.28c-.348 0-.655.093-.92.28a1.878 1.878 0 00-.627.797c-.149.34-.223.737-.223 1.19 0 .46.074.861.223 1.201.152.34.361.604.627.791.265.188.572.281.92.281zm6.68 1.002c-.61 0-1.141-.133-1.594-.398a2.721 2.721 0 01-1.05-1.131c-.245-.492-.368-1.074-.368-1.746 0-.668.123-1.248.369-1.74a2.719 2.719 0 011.037-1.149c.45-.273.979-.41 1.588-.41.414 0 .795.068 1.142.205.352.137.653.324.903.563.25.238.426.507.527.808a.73.73 0 01.041.152c.012.051.018.1.018.147a.47.47 0 01-.147.363.547.547 0 01-.375.13.56.56 0 01-.316-.083.865.865 0 01-.235-.287c-.156-.332-.363-.582-.62-.75a1.608 1.608 0 00-.909-.252c-.535 0-.965.207-1.289.621-.324.41-.486.969-.486 1.676 0 .71.162 1.271.486 1.682.324.406.754.609 1.29.609.37 0 .683-.084.937-.252a1.77 1.77 0 00.603-.727.944.944 0 01.235-.298.539.539 0 01.334-.094.504.504 0 01.515.504.81.81 0 01-.017.158c-.012.055-.03.113-.053.176-.117.297-.303.56-.557.79-.254.231-.555.41-.902.54a3.129 3.129 0 01-1.108.193zM1.345 16.434a.718.718 0 01-.528-.217.721.721 0 01-.21-.522.721.721 0 01.738-.732.72.72 0 01.521.21.711.711 0 01.217.522.711.711 0 01-.217.522.711.711 0 01-.521.217zm2.888 0a.718.718 0 01-.527-.217.711.711 0 01-.217-.522.73.73 0 01.744-.732c.204 0 .375.07.516.21a.711.711 0 01.217.522.711.711 0 01-.217.522.692.692 0 01-.516.217zm2.883 0a.718.718 0 01-.527-.217.711.711 0 01-.217-.522.729.729 0 01.744-.732c.203 0 .375.07.516.21a.711.711 0 01.217.522.711.711 0 01-.217.522.692.692 0 01-.516.217zm2.883 0a.718.718 0 01-.527-.217.721.721 0 01-.211-.522.721.721 0 01.738-.732.72.72 0 01.521.21.711.711 0 01.217.522.711.711 0 01-.216.522.711.711 0 01-.522.217zm2.883 0a.711.711 0 01-.522-.217.711.711 0 01-.216-.522.71.71 0 01.216-.521.721.721 0 01.522-.211.72.72 0 01.521.21.711.711 0 01.217.522.711.711 0 01-.217.522.711.711 0 01-.521.217zm2.889 0a.718.718 0 01-.528-.217.711.711 0 01-.217-.522.728.728 0 01.744-.732c.2 0 .372.07.516.21a.711.711 0 01.217.522.711.711 0 01-.217.522.704.704 0 01-.515.217zm2.882 0a.73.73 0 01-.527-.217.71.71 0 01-.217-.522.71.71 0 01.217-.521.74.74 0 01.527-.211c.203 0 .375.07.516.21a.71.71 0 01.217.522.71.71 0 01-.217.522.692.692 0 01-.516.217z"})})})},713498:(e,t,o)=>{o.d(t,{a:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("chartGridLine",{viewBox:"0 0 20 20",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("circle",{cx:"4",cy:"10",r:"1"}),(0,n.jsx)("circle",{cx:"8",cy:"10",r:"1"}),(0,n.jsx)("circle",{cx:"12",cy:"10",r:"1"}),(0,n.jsx)("circle",{cx:"16",cy:"10",r:"1"})]})})},380881:(e,t,o)=>{o.d(t,{I:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("collectionDependenciesArrowRight",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{transform:"translate(3,3)",d:"M1.34.302a.701.701 0 00-.383.095.708.708 0 00-.24.253 1.074 1.074 0 00-.109.322 3.26 3.26 0 00-.054.465c-.01.173-.014.36-.014.56 0 1.609.353 2.791 1.06 3.548.71.752 1.857 1.128 3.438 1.128h4.525l1.634-.089L9.16 8.423 7.643 9.968a.798.798 0 00-.164.239.785.785 0 00-.055.294c0 .205.068.376.205.513a.736.736 0 00.533.205c.196 0 .378-.082.547-.246l4.498-4.485a.78.78 0 00.246-.567.743.743 0 00-.246-.56L8.695.854A.76.76 0 008.162.63a.736.736 0 00-.533.205.696.696 0 00-.205.513c0 .104.018.202.055.294a.715.715 0 00.164.232L9.16 3.419l2.037 1.852-1.634-.102h-4.43c-.76 0-1.366-.11-1.818-.328a1.94 1.94 0 01-.963-1.04c-.196-.473-.294-1.09-.294-1.852 0-.191.002-.358.006-.499.01-.141.014-.278.014-.41a.721.721 0 00-.205-.533.721.721 0 00-.533-.205z"})})},593680:(e,t,o)=>{o.d(t,{W:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("collectionFormAddDescription",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M7.58203 9.83472C7.72266 9.83472 7.84375 9.88354 7.94531 9.9812C8.04297 10.0828 8.0918 10.2058 8.0918 10.3503C8.0918 10.491 8.04297 10.6121 7.94531 10.7136C7.84375 10.8152 7.72266 10.866 7.58203 10.866L1.43945 10.866C1.29492 10.866 1.17188 10.8152 1.07031 10.7136C0.96875 10.6121 0.917969 10.491 0.917969 10.3503C0.917969 10.2058 0.96875 10.0828 1.07031 9.9812C1.17188 9.88354 1.29492 9.83472 1.43945 9.83472L7.58203 9.83472ZM8.58203 6.7644C8.72266 6.7644 8.84375 6.81323 8.94531 6.91089C9.04297 7.01245 9.0918 7.1355 9.0918 7.28003C9.0918 7.42456 9.04297 7.54565 8.94531 7.64331C8.84375 7.74487 8.72266 7.79565 8.58203 7.79565L1.43945 7.79565C1.29492 7.79565 1.17188 7.74487 1.07031 7.64331C0.968751 7.54565 0.917969 7.42456 0.917969 7.28003C0.917969 7.1355 0.968751 7.01245 1.07031 6.91089C1.17188 6.81323 1.29492 6.7644 1.43945 6.7644L8.58203 6.7644ZM12.4902 3.62964C12.6348 3.62964 12.7578 3.67847 12.8594 3.77612C12.957 3.87378 13.0059 3.99487 13.0059 4.1394C13.0059 4.28784 12.957 4.41089 12.8594 4.50854C12.7578 4.61011 12.6348 4.66089 12.4902 4.66089L1.43945 4.66089C1.29492 4.66089 1.17188 4.61011 1.07031 4.50854C0.968751 4.41089 0.91797 4.28784 0.91797 4.1394C0.91797 3.99487 0.968751 3.87378 1.07031 3.77612C1.17188 3.67847 1.29492 3.62964 1.43945 3.62964L12.4902 3.62964ZM12.9824 7.74487C13.3965 7.74487 13.7852 7.823 14.1484 7.97925C14.5117 8.1355 14.832 8.35229 15.1094 8.62964C15.3867 8.91089 15.6055 9.23315 15.7656 9.59644C15.9219 9.95972 16 10.3484 16 10.7625C16 11.1765 15.9219 11.5652 15.7656 11.9285C15.6055 12.2917 15.3867 12.6121 15.1094 12.8894C14.832 13.1707 14.5117 13.3894 14.1484 13.5457C13.7852 13.7019 13.3965 13.78 12.9824 13.78C12.5684 13.78 12.1797 13.7019 11.8164 13.5457C11.4531 13.3894 11.1328 13.1726 10.8555 12.8953C10.5781 12.6179 10.3613 12.2957 10.2051 11.9285C10.0449 11.5652 9.96484 11.1765 9.96484 10.7625C9.96484 10.3523 10.0449 9.96362 10.2051 9.59644C10.3613 9.23315 10.5801 8.91284 10.8613 8.6355C11.1387 8.35815 11.4609 8.1394 11.8281 7.97925C12.1914 7.823 12.5762 7.74487 12.9824 7.74487ZM12.9824 8.85229C12.8613 8.85229 12.7656 8.8894 12.6953 8.96362C12.6211 9.03784 12.584 9.13354 12.584 9.25073L12.584 10.364L11.4707 10.364C11.3535 10.364 11.2578 10.3992 11.1836 10.4695C11.1094 10.5437 11.0723 10.6414 11.0723 10.7625C11.0723 10.8835 11.1094 10.9792 11.1836 11.0496C11.2578 11.1238 11.3535 11.1609 11.4707 11.1609L12.584 11.1609L12.584 12.2742C12.584 12.3914 12.6211 12.4871 12.6953 12.5613C12.7656 12.6355 12.8613 12.6726 12.9824 12.6726C13.1035 12.6726 13.2012 12.6355 13.2754 12.5613C13.3457 12.4871 13.3809 12.3914 13.3809 12.2742L13.3809 11.1609L14.4941 11.1609C14.6113 11.1609 14.707 11.1238 14.7813 11.0496C14.8555 10.9792 14.8926 10.8835 14.8926 10.7625C14.8926 10.6414 14.8555 10.5437 14.7813 10.4695C14.707 10.3992 14.6113 10.364 14.4941 10.364L13.3809 10.364L13.3809 9.25073C13.3809 9.13354 13.3457 9.03784 13.2754 8.96362C13.2012 8.8894 13.1035 8.85229 12.9824 8.85229Z"})})},396451:(e,t,o)=>{o.d(t,{k:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("collectionNumberType",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{d:"M1.73457,9.90096 L1.73457,4.54339 L1.65064,4.54339 L0,5.68112 L0,4.37087 L1.73923,3.17252 L3.14274,3.17252 L3.14274,9.90096 L1.73457,9.90096 Z M3.59633,5.22882 C3.59633,3.90925 4.62215,3 6.0956,3 C7.52242,3 8.43633,3.82532 8.43633,4.96304 C8.43633,5.75106 8.09128,6.29195 6.97221,7.34108 L5.57337,8.64667 L5.57337,8.7306 L8.52959,8.7306 L8.52959,9.90096 L3.6756,9.90096 L3.6756,8.91711 L6.03498,6.66031 C6.87429,5.85364 7.05614,5.5459 7.05614,5.0936 C7.05614,4.55738 6.67379,4.13306 6.01633,4.13306 C5.3309,4.13306 4.90192,4.58536 4.90192,5.22882 L3.59633,5.22882 Z M10.4889,6.96805 L10.4889,5.93757 L11.3282,5.93757 C11.967,5.93757 12.4007,5.55988 12.4007,5.00967 C12.4007,4.50609 12.0043,4.12374 11.3469,4.12374 C10.6661,4.12374 10.2464,4.47345 10.1998,5.07495 L8.89888,5.07495 C8.94551,3.83464 9.90139,3 11.4168,3 C12.9089,3 13.7389,3.82532 13.7342,4.80917 C13.7296,5.62516 13.2166,6.16139 12.4939,6.33857 L12.4939,6.42717 C13.4311,6.56239 14,7.15923 14,8.05915 C14,9.23884 12.8903,10.0735 11.3702,10.0735 C9.8501,10.0735 8.81495,9.24351 8.75434,7.97056 L10.1019,7.97056 C10.1439,8.53942 10.6288,8.90312 11.3515,8.90312 C12.0649,8.90312 12.5639,8.51611 12.5639,7.93326 C12.5639,7.33642 12.0976,6.96805 11.3422,6.96805 L10.4889,6.96805 Z"})})},638387:(e,t,o)=>{o.d(t,{z:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("collectionVerticalSegments",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M2.38428 7.84033L13.6362 7.84033V9.15967L2.38428 9.15967V7.84033ZM1.61865 4.36084C1.61865 3.62256 1.8055 3.06429 2.1792 2.68604C2.55745 2.30778 3.11117 2.11865 3.84033 2.11865L12.1597 2.11865C12.8934 2.11865 13.4471 2.30778 13.8208 2.68604C14.1945 3.06429 14.3813 3.62256 14.3813 4.36084L14.3813 12.6392C14.3813 13.3774 14.1945 13.9357 13.8208 14.314C13.4471 14.6922 12.8934 14.8813 12.1597 14.8813L3.84033 14.8813C3.11117 14.8813 2.55745 14.6922 2.1792 14.314C1.8055 13.9357 1.61865 13.3774 1.61865 12.6392L1.61865 4.36084ZM2.96533 4.44287L2.96533 12.5571C2.96533 12.8716 3.04736 13.1131 3.21143 13.2817C3.37549 13.4504 3.62386 13.5347 3.95654 13.5347L12.0503 13.5347C12.3784 13.5347 12.6245 13.4504 12.7886 13.2817C12.9526 13.1131 13.0347 12.8716 13.0347 12.5571L13.0347 4.44287C13.0347 4.12386 12.9526 3.88232 12.7886 3.71826C12.6245 3.54964 12.3784 3.46533 12.0503 3.46533L3.95654 3.46533C3.62386 3.46533 3.37549 3.54964 3.21143 3.71826C3.04736 3.88232 2.96533 4.12386 2.96533 4.44287Z"})})},315468:(e,t,o)=>{o.d(t,{L:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("connections",{viewBox:"0 0 16 14",svg:(0,n.jsx)("g",{children:(0,n.jsx)("path",{d:"M2.825 5.581A2.32 2.32 0 112.832.939a2.32 2.32 0 01-.007 4.642zm10.343 0A2.32 2.32 0 1113.175.94a2.32 2.32 0 01-.007 4.641zM2.825 4.331c.609 0 1.073-.473 1.073-1.074 0-.602-.464-1.067-1.073-1.067a1.05 1.05 0 00-1.06 1.067c0 .601.465 1.073 1.06 1.073zm10.343 0c.608 0 1.066-.473 1.066-1.074 0-.602-.458-1.067-1.066-1.067-.595 0-1.066.465-1.066 1.067a1.06 1.06 0 001.066 1.073zm-6.89-.466a.595.595 0 110-1.19.595.595 0 010 1.19zm1.722 0a.595.595 0 110-1.19.595.595 0 010 1.19zm1.723 0a.595.595 0 010-1.19.6.6 0 01.594.596.6.6 0 01-.594.594zm1.675 3.131a.594.594 0 01-.595-.588c0-.328.266-.595.595-.595a.592.592 0 010 1.183zm-6.795 0a.594.594 0 01-.595-.588.595.595 0 011.19 0 .594.594 0 01-.595.588zm5.502 1.429a.595.595 0 010-1.19.6.6 0 01.595.595.6.6 0 01-.595.595zm-4.21 0a.595.595 0 010-1.19.6.6 0 01.594.595.6.6 0 01-.594.595zM8 13.196a2.327 2.327 0 01-2.317-2.33 2.32 2.32 0 014.642 0A2.328 2.328 0 018 13.195zm0-1.258c.608 0 1.066-.471 1.066-1.073 0-.595-.458-1.06-1.066-1.06a1.05 1.05 0 00-1.066 1.06A1.06 1.06 0 008 11.938z"})})})},629300:(e,t,o)=>{o.d(t,{A:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("cubeOutline",{viewBox:"0 0 14 16",svg:(0,n.jsx)("path",{d:"M1.01855 11.96C0.694987 11.7777 0.448893 11.568 0.280273 11.3311C0.116211 11.0895 0.0341797 10.7272 0.0341797 10.2441V4.7207C0.0341797 4.35612 0.104818 4.05306 0.246094 3.81152C0.38737 3.56543 0.610677 3.35579 0.916016 3.18262L5.72168 0.489258C6.14551 0.252279 6.57161 0.133789 7 0.133789C7.42839 0.133789 7.85221 0.252279 8.27148 0.489258L13.0771 3.18262C13.3825 3.35579 13.6058 3.56543 13.7471 3.81152C13.8883 4.05306 13.959 4.35612 13.959 4.7207V10.2441C13.959 10.7272 13.877 11.0895 13.7129 11.3311C13.5488 11.568 13.3027 11.7777 12.9746 11.96L7.68359 14.9268C7.22786 15.1774 6.76986 15.1774 6.30957 14.9268L1.01855 11.96ZM1.75684 10.9072L6.36426 13.5117V8.0293L1.25098 5.14453V10.1211C1.25098 10.2988 1.28743 10.4492 1.36035 10.5723C1.43783 10.6953 1.56999 10.807 1.75684 10.9072ZM12.2363 10.9072C12.4232 10.807 12.5531 10.6953 12.626 10.5723C12.7035 10.4492 12.7422 10.2988 12.7422 10.1211V5.14453L7.62891 8.0293V13.5117L12.2363 10.9072ZM7 6.9082L12.0518 4.07812L7.73145 1.64453C7.24837 1.36654 6.75846 1.36654 6.26172 1.64453L1.94824 4.07812L7 6.9082Z"})})},89036:(e,t,o)=>{o.d(t,{v:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("folder",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M2.4082 14.3672H13.7627C15.0684 14.3672 15.8271 13.6084 15.8271 12.1455V5.11816C15.8271 3.65527 15.0615 2.89648 13.585 2.89648H7.22754C6.73535 2.89648 6.44824 2.78027 6.07227 2.47266L5.67578 2.1582C5.19727 1.76172 4.8418 1.63184 4.13086 1.63184H2.19629C0.917969 1.63184 0.166016 2.37695 0.166016 3.8125V12.1455C0.166016 13.6084 0.931641 14.3672 2.4082 14.3672ZM1.50586 3.92871C1.50586 3.2998 1.84766 2.97168 2.46289 2.97168H3.77539C4.26074 2.97168 4.54102 3.08105 4.92383 3.39551L5.32031 3.7168C5.79199 4.10645 6.16113 4.23633 6.87207 4.23633H13.5098C14.1387 4.23633 14.4873 4.56445 14.4873 5.23438V5.63086H1.50586V3.92871ZM2.49023 13.0273C1.85449 13.0273 1.50586 12.6992 1.50586 12.0361V6.81348H14.4873V12.0361C14.4873 12.6992 14.1387 13.0273 13.5098 13.0273H2.49023Z"})})},727714:(e,t,o)=>{o.d(t,{N:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("link",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M7.69922 10.8945L8.73828 9.84863C7.91797 9.77344 7.34375 9.51367 6.91992 9.08984C5.76465 7.93457 5.76465 6.29395 6.91309 5.14551L9.18262 2.87598C10.3379 1.7207 11.9717 1.7207 13.127 2.87598C14.2891 4.04492 14.2822 5.67188 13.1338 6.82031L11.958 7.99609C12.1768 8.49512 12.2451 9.10352 12.1289 9.62988L14.0908 7.6748C15.7725 6 15.7793 3.62109 14.084 1.92578C12.3887 0.223633 10.0098 0.237305 8.33496 1.91211L5.95605 4.29785C4.28125 5.97266 4.26758 8.35156 5.96289 10.0469C6.36621 10.4434 6.90625 10.7441 7.69922 10.8945ZM8.30078 5.13184L7.26855 6.17773C8.08203 6.25293 8.66309 6.51953 9.08008 6.93652C10.2422 8.09863 10.2422 9.73242 9.08691 10.8809L6.81738 13.1504C5.66211 14.3057 4.03516 14.3057 2.87305 13.1504C1.71094 11.9883 1.71777 10.3545 2.87305 9.20605L4.04199 8.03027C3.83008 7.53125 3.75488 6.92969 3.87109 6.39648L1.91602 8.35156C0.234375 10.0264 0.227539 12.4121 1.92285 14.1074C3.61816 15.8027 5.99707 15.7891 7.67188 14.1143L10.0439 11.7354C11.7256 10.0537 11.7324 7.6748 10.0371 5.98633C9.64062 5.58301 9.10059 5.28223 8.30078 5.13184Z"})})},146392:(e,t,o)=>{o.d(t,{C:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("membersFilled",{viewBox:"0 0 30 30",svg:(0,n.jsx)("path",{d:"M20.31 14.731c2.22 0 4.097-1.967 4.097-4.513 0-2.485-1.887-4.391-4.098-4.391-2.2 0-4.097 1.937-4.087 4.411 0 2.526 1.866 4.493 4.087 4.493zm-11.725.233c1.937 0 3.57-1.724 3.57-3.935 0-2.17-1.653-3.823-3.57-3.823-1.917 0-3.57 1.683-3.56 3.844 0 2.19 1.633 3.914 3.56 3.914zm-5.588 9.21h7.606c-1.085-1.552.082-4.615 2.374-6.42-1.116-.72-2.566-1.248-4.392-1.248-4.533 0-7.464 3.337-7.464 6.085 0 1.004.507 1.582 1.876 1.582zm10.994-.01h12.637c1.673 0 2.251-.508 2.251-1.44 0-2.607-3.316-6.198-8.57-6.198-5.263 0-8.57 3.59-8.57 6.197 0 .933.578 1.44 2.252 1.44z"})})},612677:(e,t,o)=>{o.d(t,{Y:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("nest",{viewBox:"0 0 16 16",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{d:"M5.59375 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.59375C5.23145 3.22461 4.94434 3.51172 4.94434 3.87402C4.94434 4.23633 5.22461 4.52344 5.59375 4.52344ZM8 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H8C7.6377 7.42188 7.35059 7.70898 7.35059 8.07129C7.35059 8.43359 7.63086 8.7207 8 8.7207ZM10 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H10C9.6377 11.6191 9.35059 11.9062 9.35059 12.2686C9.35059 12.6309 9.63086 12.918 10 12.918Z"}),(0,n.jsx)("path",{d:"M1.66386 4.7627L0.898238 3.46387C0.713668 3.14941 0.829878 2.80762 1.19218 2.80762H2.85332C3.22929 2.80762 3.33867 3.14258 3.14726 3.46387L2.36113 4.7627C2.21074 5.01562 1.82109 5.02246 1.66386 4.7627Z"}),(0,n.jsx)("path",{d:"M3.85358 8.94885L3.08795 7.65002C2.90338 7.33557 3.01275 6.99377 3.3819 6.99377H5.03619C5.41217 6.99377 5.52838 7.32874 5.33014 7.65002L4.55084 8.94885C4.40045 9.20178 4.0108 9.20862 3.85358 8.94885Z"}),(0,n.jsx)("path",{d:"M6.90723 12.6377L5.6084 13.4033C5.29395 13.5878 4.95215 13.4716 4.95215 13.1093V11.4482C4.95215 11.0722 5.28711 10.9628 5.6084 11.1543L6.90723 11.9404C7.16016 12.0908 7.16699 12.4804 6.90723 12.6377Z"})]})})},128495:(e,t,o)=>{o.d(t,{v:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("personCircle",{viewBox:"0 0 18 17",svg:(0,n.jsx)("path",{d:"M8.99219 16.6797C10.0964 16.6797 11.1354 16.4688 12.1094 16.0469C13.0833 15.6302 13.9427 15.0495 14.6875 14.3047C15.4323 13.5599 16.0156 12.7005 16.4375 11.7266C16.8594 10.7526 17.0703 9.71354 17.0703 8.60938C17.0703 7.50521 16.8594 6.46615 16.4375 5.49219C16.0156 4.51823 15.4323 3.66146 14.6875 2.92188C13.9427 2.17708 13.0833 1.59375 12.1094 1.17188C11.1354 0.75 10.0938 0.539062 8.98438 0.539062C7.88021 0.539062 6.84115 0.75 5.86719 1.17188C4.89844 1.59375 4.04167 2.17708 3.29688 2.92188C2.55729 3.66146 1.97656 4.51823 1.55469 5.49219C1.13281 6.46615 0.921875 7.50521 0.921875 8.60938C0.921875 9.71354 1.13281 10.7526 1.55469 11.7266C1.97656 12.7005 2.55729 13.5599 3.29688 14.3047C4.04167 15.0495 4.90104 15.6302 5.875 16.0469C6.84896 16.4688 7.88802 16.6797 8.99219 16.6797ZM8.99219 15.0859C8.09635 15.0859 7.25521 14.9193 6.46875 14.5859C5.6875 14.2526 5 13.7891 4.40625 13.1953C3.81771 12.6016 3.35677 11.9141 3.02344 11.1328C2.6901 10.3516 2.52344 9.51042 2.52344 8.60938C2.52344 7.71354 2.6901 6.875 3.02344 6.09375C3.35677 5.30729 3.81771 4.61719 4.40625 4.02344C4.99479 3.42969 5.67969 2.96615 6.46094 2.63281C7.2474 2.29948 8.08854 2.13281 8.98438 2.13281C9.88542 2.13281 10.7266 2.29948 11.5078 2.63281C12.2943 2.96615 12.9844 3.42969 13.5781 4.02344C14.1719 4.61719 14.6354 5.30729 14.9688 6.09375C15.3021 6.875 15.4688 7.71354 15.4688 8.60938C15.4688 9.51042 15.3021 10.3516 14.9688 11.1328C14.6354 11.9141 14.1719 12.6016 13.5781 13.1953C12.9844 13.7891 12.2969 14.2526 11.5156 14.5859C10.7344 14.9193 9.89323 15.0859 8.99219 15.0859ZM14.2031 13.7656L14.1719 13.6328C14.0052 13.2474 13.6849 12.8776 13.2109 12.5234C12.7422 12.1641 12.1484 11.8724 11.4297 11.6484C10.7161 11.4193 9.90365 11.3047 8.99219 11.3047C8.09115 11.3047 7.28125 11.4193 6.5625 11.6484C5.84375 11.8724 5.2474 12.1641 4.77344 12.5234C4.30469 12.8776 3.98698 13.2448 3.82031 13.625L3.78906 13.7656C4.27865 14.2188 4.83333 14.599 5.45312 14.9062C6.07292 15.2188 6.69271 15.4557 7.3125 15.6172C7.9375 15.7786 8.4974 15.8594 8.99219 15.8594C9.49219 15.8594 10.0521 15.7786 10.6719 15.6172C11.2917 15.4557 11.9115 15.2188 12.5312 14.9062C13.151 14.599 13.7083 14.2188 14.2031 13.7656ZM8.99219 10.0156C9.4974 10.0208 9.95312 9.89583 10.3594 9.64062C10.7656 9.38021 11.0885 9.02604 11.3281 8.57812C11.5677 8.125 11.6875 7.61979 11.6875 7.0625C11.6875 6.54167 11.5651 6.0625 11.3203 5.625C11.0807 5.18229 10.7578 4.82812 10.3516 4.5625C9.95052 4.29688 9.4974 4.16406 8.99219 4.16406C8.49219 4.16406 8.03646 4.29688 7.625 4.5625C7.21875 4.82812 6.89583 5.18229 6.65625 5.625C6.41667 6.0625 6.29948 6.54167 6.30469 7.0625C6.3099 7.61979 6.42969 8.1224 6.66406 8.57031C6.90365 9.01302 7.22656 9.36458 7.63281 9.625C8.03906 9.88021 8.49219 10.0104 8.99219 10.0156Z"})})},484199:(e,t,o)=>{o.d(t,{N:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("properties",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M1.91602 4.83789C2.44238 4.83789 2.87305 4.40723 2.87305 3.87402C2.87305 3.34766 2.44238 2.91699 1.91602 2.91699C1.38281 2.91699 0.952148 3.34766 0.952148 3.87402C0.952148 4.40723 1.38281 4.83789 1.91602 4.83789ZM5.1084 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.1084C4.74609 3.22461 4.45898 3.51172 4.45898 3.87402C4.45898 4.23633 4.74609 4.52344 5.1084 4.52344ZM1.91602 9.03516C2.44238 9.03516 2.87305 8.60449 2.87305 8.07129C2.87305 7.54492 2.44238 7.11426 1.91602 7.11426C1.38281 7.11426 0.952148 7.54492 0.952148 8.07129C0.952148 8.60449 1.38281 9.03516 1.91602 9.03516ZM5.1084 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H5.1084C4.74609 7.42188 4.45898 7.70898 4.45898 8.07129C4.45898 8.43359 4.74609 8.7207 5.1084 8.7207ZM1.91602 13.2324C2.44238 13.2324 2.87305 12.8018 2.87305 12.2686C2.87305 11.7422 2.44238 11.3115 1.91602 11.3115C1.38281 11.3115 0.952148 11.7422 0.952148 12.2686C0.952148 12.8018 1.38281 13.2324 1.91602 13.2324ZM5.1084 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H5.1084C4.74609 11.6191 4.45898 11.9062 4.45898 12.2686C4.45898 12.6309 4.74609 12.918 5.1084 12.918Z"})})},986488:(e,t,o)=>{o.d(t,{p:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("squarePlus",{viewBox:"0 0 30 30",svg:(0,n.jsx)("path",{d:"M7.059 27.052H22.94c2.75 0 4.11-1.361 4.11-4.059V7.007c0-2.697-1.36-4.059-4.11-4.059H7.059c-2.736 0-4.111 1.349-4.111 4.059v15.986c0 2.71 1.375 4.06 4.11 4.06zm.026-2.108c-1.31 0-2.03-.694-2.03-2.055V7.112c0-1.362.72-2.056 2.03-2.056h15.83c1.296 0 2.029.694 2.029 2.056v15.777c0 1.361-.733 2.055-2.03 2.055H7.085zm7.895-3.758c.707 0 1.113-.484 1.113-1.243V16.08h4.111c.733 0 1.231-.392 1.231-1.086 0-.707-.471-1.113-1.23-1.113h-4.112V9.769c0-.759-.406-1.243-1.113-1.243-.694 0-1.073.51-1.073 1.243v4.112H9.822c-.773 0-1.257.405-1.257 1.112 0 .694.523 1.087 1.257 1.087h4.085v3.863c0 .733.38 1.243 1.073 1.243z"})})},301763:(e,t,o)=>{o.d(t,{V:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("tag",{viewBox:"0 0 17 17",svg:(0,n.jsx)("path",{d:"M9.49219 15.4951C8.47363 16.5205 7.40039 16.5273 6.36133 15.4883L2 11.1406C0.960938 10.1084 0.981445 9.02148 1.99316 8.00977L8.70605 1.31055C9.23926 0.777344 9.54688 0.71582 10.3193 0.71582H12.917C13.6689 0.71582 13.9219 0.900391 14.4756 1.44727L16.041 3.0127C16.5947 3.56641 16.7725 3.81934 16.7725 4.57129V7.16895C16.7725 7.94141 16.7178 8.25586 16.1846 8.78906L9.49219 15.4951ZM8.62402 14.4697L15.248 7.83887C15.3779 7.70215 15.4531 7.57227 15.4531 7.34668V4.57812C15.4531 4.37305 15.3779 4.23633 15.2412 4.09961L13.3887 2.24707C13.2588 2.11035 13.1152 2.03516 12.9102 2.03516H10.1484C9.92285 2.03516 9.79297 2.11035 9.65625 2.25391L3.02539 8.87109C2.57422 9.32227 2.56055 9.80078 3.03223 10.2725L7.22266 14.4629C7.69434 14.9277 8.16602 14.9209 8.62402 14.4697ZM12.0693 6.40332C11.5088 6.40332 11.0918 5.96582 11.0918 5.41895C11.0918 4.87207 11.5088 4.44141 12.0693 4.44141C12.6299 4.44141 13.0469 4.87207 13.0469 5.41895C13.0469 5.96582 12.6299 6.40332 12.0693 6.40332Z"})})},794229:(e,t,o)=>{o.d(t,{o:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("taskList",{viewBox:"0 0 18 17",svg:(0,n.jsx)("path",{d:"M3.48438 7.29688C5.35938 7.29688 6.92188 5.73438 6.92188 3.85938C6.92188 1.96875 5.35938 0.40625 3.48438 0.40625C1.59375 0.40625 0.0390625 1.96875 0.0390625 3.85938C0.0390625 5.73438 1.60156 7.29688 3.48438 7.29688ZM3.07031 5.70312C2.89844 5.70312 2.77344 5.61719 2.65625 5.47656L1.78125 4.42969C1.69531 4.32812 1.66406 4.23438 1.66406 4.10156C1.66406 3.85938 1.85156 3.67188 2.08594 3.67188C2.24219 3.67188 2.35156 3.73438 2.45312 3.875L3.05469 4.625L4.44531 2.39062C4.54688 2.23438 4.67969 2.15625 4.83594 2.15625C5.07031 2.15625 5.26562 2.33594 5.26562 2.55469C5.26562 2.66406 5.24219 2.76562 5.16406 2.88281L3.5 5.46875C3.39844 5.61719 3.25 5.70312 3.07031 5.70312ZM9.39844 4.54688H17.2578C17.6406 4.54688 17.9531 4.24219 17.9531 3.85938C17.9531 3.47656 17.6406 3.17188 17.2578 3.17188H9.39844C9.01562 3.17188 8.71875 3.47656 8.71875 3.85938C8.71875 4.24219 9.01562 4.54688 9.39844 4.54688ZM3.48438 16.3281C5.35938 16.3281 6.92188 14.7656 6.92188 12.8828C6.92188 10.9922 5.35938 9.4375 3.48438 9.4375C1.59375 9.4375 0.0390625 11 0.0390625 12.8828C0.0390625 14.7656 1.60156 16.3281 3.48438 16.3281ZM3.48438 15C2.32812 15 1.36719 14.0312 1.36719 12.8828C1.36719 11.7344 2.33594 10.7578 3.48438 10.7578C4.625 10.7578 5.60156 11.7344 5.60156 12.8828C5.60156 14.0312 4.625 15 3.48438 15ZM9.39844 13.5859H17.2578C17.6406 13.5859 17.9531 13.2812 17.9531 12.8984C17.9531 12.5156 17.6406 12.2109 17.2578 12.2109H9.39844C9.01562 12.2109 8.71875 12.5156 8.71875 12.8984C8.71875 13.2812 9.01562 13.5859 9.39844 13.5859Z"})})},537888:(e,t,o)=>{o.d(t,{U:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("unlocked",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M2.49023 14.7227H8.89551C9.94824 14.7227 10.4746 14.1963 10.4746 13.0479V8.20801C10.4746 7.22363 10.085 6.69727 9.29883 6.57422V4.83105C9.29883 3.22461 10.3174 2.35645 11.541 2.35645C12.7646 2.35645 13.79 3.22461 13.79 4.83105V6.28711C13.79 6.76562 14.0703 7.01855 14.4395 7.01855C14.8018 7.01855 15.082 6.7793 15.082 6.28711V4.96094C15.082 2.36328 13.3525 1.1123 11.541 1.1123C9.72949 1.1123 8 2.36328 8 4.96094V6.54004H2.49023C1.43066 6.54004 0.911133 7.06641 0.911133 8.20801V13.0479C0.911133 14.1963 1.43066 14.7227 2.49023 14.7227ZM2.68848 13.5059C2.3877 13.5059 2.2373 13.3623 2.2373 13V8.25586C2.2373 7.89355 2.3877 7.76367 2.68848 7.76367H8.7041C9.00488 7.76367 9.14844 7.89355 9.14844 8.25586V13C9.14844 13.3623 9.00488 13.5059 8.7041 13.5059H2.68848ZM7.99316 21.1123C6.5918 21.1123 5.2793 21.8779 4.75293 23.375L5.78516 24.4141C5.94922 23.0811 6.87891 22.3564 7.99316 22.3564C9.2168 22.3564 10.2422 23.2246 10.2422 24.8311V26.54H7.9248L9.1416 27.7637H11.0078C11.3086 27.7637 11.4521 27.8936 11.4521 28.2559V30.0742L12.7783 31.4072V28.208C12.7783 27.2031 12.3682 26.6768 11.541 26.5674V24.9609C11.541 22.3633 9.81152 21.1123 7.99316 21.1123ZM13.749 35.126C13.9609 35.3379 14.3164 35.3379 14.5215 35.126C14.7266 34.9072 14.7334 34.5723 14.5215 34.3535L2.46973 22.3154C2.25781 22.1035 1.90918 22.0967 1.69043 22.3154C1.48535 22.5205 1.48535 22.876 1.69043 23.0811L13.749 35.126ZM4.79395 34.7227H11.1992C11.5 34.7227 11.7598 34.6816 11.9785 34.5928L10.8711 33.4922C10.8096 33.499 10.7549 33.5059 10.6865 33.5059H4.99219C4.69141 33.5059 4.54102 33.3623 4.54102 33V28.2559C4.54102 27.9004 4.68457 27.7637 4.97852 27.7637H5.14258L4.04883 26.6631C3.48828 26.8818 3.21484 27.3809 3.21484 28.208V33.0479C3.21484 34.1963 3.73438 34.7227 4.79395 34.7227Z"})})},769619:(e,t,o)=>{o.d(t,{T:()=>r});o(667294);var i=o(745238),n=o(785893);const r=(0,i.IU)("unsync",{viewBox:"0 0 30 30",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.768 23.295l1.353 1.351a11.298 11.298 0 01-6.118 1.81c-5.862 0-10.781-4.538-11.387-10.254h-1.55c-.809 0-1.011-.55-.573-1.168l2.516-3.572c.37-.527.91-.516 1.269 0l2.515 3.583c.427.606.225 1.157-.572 1.157H5.536a9.496 9.496 0 009.467 8.344c1.74 0 3.366-.454 4.765-1.251zM10.233 6.723l-1.361-1.36a11.26 11.26 0 016.131-1.818c5.851 0 10.782 4.548 11.388 10.265h1.539c.808 0 1.021.539.572 1.167l-2.504 3.572c-.37.528-.91.516-1.27 0l-2.515-3.583c-.427-.617-.224-1.156.573-1.156h1.673a9.503 9.503 0 00-9.456-8.356 9.55 9.55 0 00-4.77 1.27z"}),(0,n.jsx)("path",{d:"M27.067 28.551c.41.41 1.094.41 1.49 0 .41-.41.41-1.08 0-1.49L2.937 1.454a1.06 1.06 0 00-1.505 0c-.396.396-.396 1.08 0 1.49l25.635 25.607z"})]})})}}]);